<h1> Class EncryptedCookieMiddleware  </h1> <div class="description"> <p>Middleware for encrypting &amp; decrypting cookies.</p> <p>This middleware layer will encrypt/decrypt the named cookies with the given key and cipher type. To support multiple keys/cipher types use this middleware multiple times.</p> <p>Cookies in request data will be decrypted, while cookies in response headers will be encrypted automatically. If the response is a {@link \Cake\Http\Response}, the cookie data set with <code>withCookie()</code> and `cookie()`` will also be encrypted.</p> <p>The encryption types and padding are compatible with those used by CookieComponent for backwards compatibility.</p> </div> <div class="info"> <b>Namespace:</b> <a href="namespace-cake.http.middleware.html">Cake\Http\Middleware</a><br> </div> <div class="section"> <h2>Property Summary</h2> <ul class="member-summary properties"> <li class="clearfix"> <div class="name"> <a href="#%24_validCiphers">$_validCiphers</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>array&lt;string&gt;</code></div> <div class="description"> <p>Valid cipher names for encrypted cookies.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24cipherType">$cipherType</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>string</code></div> <div class="description"> <p>Encryption type.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24cookieNames">$cookieNames</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>array&lt;string&gt;</code></div> <div class="description"> <p>The list of cookies to encrypt/decrypt</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24key">$key</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>string</code></div> <div class="description"> <p>Encryption key to use.</p> </div> </li> </ul> </div> <div class="section"> <h2>Method Summary</h2> <ul class="member-summary"> <li class="clearfix"> <h5 class="function-name"> <a href="#__construct()">__construct()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Constructor</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_checkCipher()">_checkCipher()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Helper method for validating encryption cipher names.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_decode()">_decode()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Decodes and decrypts a single value.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_decrypt()">_decrypt()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Decrypts $value using public $type method in Security class</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_encrypt()">_encrypt()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Encrypts $value using public $type method in Security class</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_explode()">_explode()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Explode method to return array from string set in CookieComponent::_implode() Maintains reading backwards compatibility with 1.x CookieComponent::_implode().</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_getCookieEncryptionKey()">_getCookieEncryptionKey()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Fetch the cookie encryption key.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_implode()">_implode()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Implode method to keep keys are multidimensional arrays</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#decodeCookies()">decodeCookies()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Decode cookies from the request.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#encodeCookies()">encodeCookies()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Encode cookies from a response's CookieCollection.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#encodeSetCookieHeader()">encodeSetCookieHeader()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Encode cookies from a response's Set-Cookie header</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#process()">process()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Apply cookie encryption/decryption.</p> </div> </li> </ul> <div class="section"> <h2>Method Detail</h2> <div class="method-detail">  <h3 class="method-name" id="__construct()"> __construct()   <span class="label">public</span> </h3> <pre data-language="php">__construct(array&lt;string&gt; $cookieNames, string $key, string $cipherType = 'aes')</pre> <div class="description detailed"> <p>Constructor</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>array&lt;string&gt;</code> <var>$cookieNames</var> </dt> <dd><p>The list of cookie names that should have their values encrypted.</p></dd> <dt> <code>string</code> <var>$key</var> </dt> <dd><p>The encryption key to use.</p></dd> <dt> <code>string</code> <var>$cipherType</var> <span class="label">optional</span> </dt> <dd><p>The cipher type to use. Defaults to 'aes'.</p></dd> </dl> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_checkCipher()"> _checkCipher()   <span class="label">protected</span> </h3> <pre data-language="php">_checkCipher(string $encrypt): void</pre> <div class="description detailed"> <p>Helper method for validating encryption cipher names.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>string</code> <var>$encrypt</var> </dt> <dd><p>The cipher name.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>void</code><br> </div> <h4>Throws</h4> <div class="list"> <code>RuntimeException</code><br> When an invalid cipher is provided. </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_decode()"> _decode()   <span class="label">protected</span> </h3> <pre data-language="php">_decode(string $value, string|false $encrypt, string|null $key): array|string</pre> <div class="description detailed"> <p>Decodes and decrypts a single value.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>string</code> <var>$value</var> </dt> <dd><p>The value to decode &amp; decrypt.</p></dd> <dt> <code>string|false</code> <var>$encrypt</var> </dt> <dd><p>The encryption cipher to use.</p></dd> <dt> <code>string|null</code> <var>$key</var> </dt> <dd><p>Used as the security salt if specified.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>array|string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_decrypt()"> _decrypt()   <span class="label">protected</span> </h3> <pre data-language="php">_decrypt(array&lt;string&gt;|string $values, string|false $mode, string|null $key = null): array|string</pre> <div class="description detailed"> <p>Decrypts $value using public $type method in Security class</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>array&lt;string&gt;|string</code> <var>$values</var> </dt> <dd><p>Values to decrypt</p></dd> <dt> <code>string|false</code> <var>$mode</var> </dt> <dd><p>Encryption mode</p></dd> <dt> <code>string|null</code> <var>$key</var> <span class="label">optional</span> </dt> <dd><p>Used as the security salt if specified.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>array|string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_encrypt()"> _encrypt()   <span class="label">protected</span> </h3> <pre data-language="php">_encrypt(array|string $value, string|false $encrypt, string|null $key = null): string</pre> <div class="description detailed"> <p>Encrypts $value using public $type method in Security class</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>array|string</code> <var>$value</var> </dt> <dd><p>Value to encrypt</p></dd> <dt> <code>string|false</code> <var>$encrypt</var> </dt> <dd><p>Encryption mode to use. False disabled encryption.</p></dd> <dt> <code>string|null</code> <var>$key</var> <span class="label">optional</span> </dt> <dd><p>Used as the security salt if specified.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_explode()"> _explode()   <span class="label">protected</span> </h3> <pre data-language="php">_explode(string $string): array|string</pre> <div class="description detailed"> <p>Explode method to return array from string set in CookieComponent::_implode() Maintains reading backwards compatibility with 1.x CookieComponent::_implode().</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>string</code> <var>$string</var> </dt> <dd><p>A string containing JSON encoded data, or a bare string.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>array|string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_getCookieEncryptionKey()"> _getCookieEncryptionKey()   <span class="label">protected</span> </h3> <pre data-language="php">_getCookieEncryptionKey(): string</pre> <div class="description detailed"> <p>Fetch the cookie encryption key.</p> <p>Part of the CookieCryptTrait implementation.</p> <h4>Returns</h4> <div class="list"> <code>string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_implode()"> _implode()   <span class="label">protected</span> </h3> <pre data-language="php">_implode(array $array): string</pre> <div class="description detailed"> <p>Implode method to keep keys are multidimensional arrays</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>array</code> <var>$array</var> </dt> <dd><p>Map of key and values</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="decodeCookies()"> decodeCookies()   <span class="label">protected</span> </h3> <pre data-language="php">decodeCookies(Psr\Http\Message\ServerRequestInterface $request): Psr\Http\Message\ServerRequestInterface</pre> <div class="description detailed"> <p>Decode cookies from the request.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Psr\Http\Message\ServerRequestInterface</code> <var>$request</var> </dt> <dd><p>The request to decode cookies from.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>Psr\Http\Message\ServerRequestInterface</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="encodeCookies()"> encodeCookies()   <span class="label">protected</span> </h3> <pre data-language="php">encodeCookies(Cake\Http\Response $response): Cake\Http\Response</pre> <div class="description detailed"> <p>Encode cookies from a response's CookieCollection.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Cake\Http\Response</code> <var>$response</var> </dt> <dd><p>The response to encode cookies in.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>Cake\Http\Response</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="encodeSetCookieHeader()"> encodeSetCookieHeader()   <span class="label">protected</span> </h3> <pre data-language="php">encodeSetCookieHeader(Psr\Http\Message\ResponseInterface $response): Psr\Http\Message\ResponseInterface</pre> <div class="description detailed"> <p>Encode cookies from a response's Set-Cookie header</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Psr\Http\Message\ResponseInterface</code> <var>$response</var> </dt> <dd><p>The response to encode cookies in.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>Psr\Http\Message\ResponseInterface</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="process()"> process()   <span class="label">public</span> </h3> <pre data-language="php">process(ServerRequestInterface $request, RequestHandlerInterface $handler): Psr\Http\Message\ResponseInterface</pre> <div class="description detailed"> <p>Apply cookie encryption/decryption.</p> <p>Processes an incoming server request in order to produce a response. If unable to produce the response itself, it may delegate to the provided request handler to do so.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>ServerRequestInterface</code> <var>$request</var> </dt> <dd><p>The request.</p></dd> <dt> <code>RequestHandlerInterface</code> <var>$handler</var> </dt> <dd><p>The request handler.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>Psr\Http\Message\ResponseInterface</code><br> </div> </div> </div> </div> <div class="section"> <h2>Property Detail</h2> <div class="property-detail">  <h3 class="property-name" id="$_validCiphers"> <var>$_validCiphers</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>Valid cipher names for encrypted cookies.</p> <h4>Type</h4> <div class="list"> <code>array&lt;string&gt;</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$cipherType"> <var>$cipherType</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>Encryption type.</p> <h4>Type</h4> <div class="list"> <code>string</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$cookieNames"> <var>$cookieNames</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>The list of cookies to encrypt/decrypt</p> <h4>Type</h4> <div class="list"> <code>array&lt;string&gt;</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$key"> <var>$key</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>Encryption key to use.</p> <h4>Type</h4> <div class="list"> <code>string</code><br> </div> </div> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;present The Cake Software Foundation, Inc.<br>Licensed under the MIT License.<br>CakePHP is a registered trademark of Cake Software Foundation, Inc.<br>We are not endorsed by or affiliated with CakePHP.<br>
    <a href="https://api.cakephp.org/4.4/class-Cake.Http.Middleware.EncryptedCookieMiddleware.html" class="_attribution-link">https://api.cakephp.org/4.4/class-Cake.Http.Middleware.EncryptedCookieMiddleware.html</a>
  </p>
</div>
