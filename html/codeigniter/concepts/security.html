<h1 id="security-guidelines">Security Guidelines</h1> <p>We take security seriously. CodeIgniter incorporates a number of features and techniques to either enforce good security practices, or to enable you to do so easily.</p> <p>We respect the <a class="reference external" href="https://owasp.org">Open Web Application Security Project (OWASP)</a> and follow their recommendations as much as possible.</p> <p>The following comes from <a class="reference external" href="https://owasp.org/www-project-top-ten/">OWASP Top Ten Cheat Sheet</a>, identifying the top vulnerabilities for web applications. For each, we provide a brief description, the OWASP recommendations, and then the CodeIgniter provisions to address the problem.</p>  <h2 id="a1-injection">A1 Injection</h2> <p>An injection is the inappropriate insertion of partial or complete data via the input data from the client to the application. Attack vectors include SQL, XML, ORM, code &amp; buffer overflows.</p>  <h3 id="owasp-recommendations">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: set correct content type, character set &amp; locale</li> <li>Submission: validate fields and provide feedback</li> <li>Controller: sanitize input; positive input validation using correct character set</li> <li>Model: parameterized queries</li> </ul>   <h3 id="codeigniter-provisions">CodeIgniter provisions</h3> <ul class="simple"> <li>
<a class="reference external" href="../incoming/incomingrequest.html">HTTP library</a> provides for input field filtering &amp; content metadata</li> <li>Form validation library</li> </ul>    <h2 id="a2-weak-authentication-and-session-management">A2 Weak authentication and session management</h2> <p>Inadequate authentication or improper session management can lead to a user getting more privileges than they are entitled to.</p>  <h3 id="id1">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: validate authentication &amp; role; send CSRF token with forms</li> <li>Design: only use built-in session management</li> <li>Controller: validate user, role, CSRF token</li> <li>Model: validate role</li> <li>Tip: consider the use of a request governor</li> </ul>   <h3 id="id2">CodeIgniter provisions</h3> <ul class="simple"> <li>
<a class="reference external" href="../libraries/sessions.html">Session</a> library</li> <li>
<a class="reference internal" href="../libraries/security.html"><span class="doc">Security</span></a> library provides for CSRF validation</li> <li>Easy to add third party authentication</li> </ul>    <h2 id="a3-cross-site-scripting-xss">A3 Cross Site Scripting (XSS)</h2> <p>Insufficient input validation where one user can add content to a web site that can be malicious when viewed by other users to the web site.</p>  <h3 id="id3">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: output encode all user data as per output context; set input constraints</li> <li>Controller: positive input validation</li> <li>Tips: only process trustworthy data; do not store data HTML encoded in DB</li> </ul>   <h3 id="id4">CodeIgniter provisions</h3> <ul class="simple"> <li>esc function</li> <li>Form validation library</li> </ul>    <h2 id="a4-insecure-direct-object-reference">A4 Insecure Direct Object Reference</h2> <p>Insecure Direct Object References occur when an application provides direct access to objects based on user-supplied input. As a result of this vulnerability attackers can bypass authorization and access resources in the system directly, for example database records or files.</p>  <h3 id="id5">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: don’t expose internal data; use random reference maps</li> <li>Controller: obtain data from trusted sources or random reference maps</li> <li>Model: validate user roles before updating data</li> </ul>   <h3 id="id6">CodeIgniter provisions</h3> <ul class="simple"> <li>Form validation library</li> <li>Easy to add third party authentication</li> </ul>    <h2 id="a5-security-misconfiguration">A5 Security Misconfiguration</h2> <p>Improper configuration of an application architecture can lead to mistakes that might compromise the security of the whole architecture.</p>  <h3 id="id7">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: harden web and application servers; use HTTP strict transport security</li> <li>Controller: harden web and application servers; protect your XML stack</li> <li>Model: harden database servers</li> </ul>   <h3 id="id8">CodeIgniter provisions</h3> <ul class="simple"> <li>Sanity checks during bootstrap</li> </ul>    <h2 id="a6-sensitive-data-exposure">A6 Sensitive Data Exposure</h2> <p>Sensitive data must be protected when it is transmitted through the network. Such data can include user credentials and credit cards. As a rule of thumb, if data must be protected when it is stored, it must be protected also during transmission.</p>  <h3 id="id9">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: use TLS1.2; use strong ciphers and hashes; do not send keys or hashes to browser</li> <li>Controller: use strong ciphers and hashes</li> <li>Model: mandate strong encrypted communications with servers</li> </ul>   <h3 id="id10">CodeIgniter provisions</h3> <ul class="simple"> <li>Session keys stored encrypted</li> </ul>    <h2 id="a7-missing-function-level-access-control">A7 Missing Function Level Access Control</h2> <p>Sensitive data must be protected when it is transmitted through the network. Such data can include user credentials and credit cards. As a rule of thumb, if data must be protected when it is stored, it must be protected also during transmission.</p>  <h3 id="id11">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: ensure that non-web data is outside the web root; validate users and roles; send CSRF tokens</li> <li>Controller: validate users and roles; validate CSRF tokens</li> <li>Model: validate roles</li> </ul>   <h3 id="id12">CodeIgniter provisions</h3> <ul class="simple"> <li>Public folder, with application and system outside</li> <li>
<a class="reference internal" href="../libraries/security.html"><span class="doc">Security</span></a> library provides for CSRF validation</li> </ul>    <h2 id="a8-cross-site-request-forgery-csrf">A8 Cross Site Request Forgery (CSRF)</h2> <p>CSRF is an attack that forces an end user to execute unwanted actions on a web application in which he/she is currently authenticated.</p>  <h3 id="id13">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: validate users and roles; send CSRF tokens</li> <li>Controller: validate users and roles; validate CSRF tokens</li> <li>Model: validate roles</li> </ul>   <h3 id="id14">CodeIgniter provisions</h3> <ul class="simple"> <li>
<a class="reference internal" href="../libraries/security.html"><span class="doc">Security</span></a> library provides for CSRF validation</li> </ul>    <h2 id="a9-using-components-with-known-vulnerabilities">A9 Using Components with Known Vulnerabilities</h2> <p>Many applications have known vulnerabilities and known attack strategies that can be exploited in order to gain remote control or to exploit data.</p>  <h3 id="id15">OWASP recommendations</h3> <ul class="simple"> <li>Don’t use any of these</li> </ul>   <h3 id="id16">CodeIgniter provisions</h3> <ul class="simple"> <li>Third party libraries incorporated must be vetted</li> </ul>    <h2 id="a10-unvalidated-redirects-and-forwards">A10 Unvalidated Redirects and Forwards</h2> <p>Faulty business logic or injected actionable code could redirect the user inappropriately.</p>  <h3 id="id17">OWASP recommendations</h3> <ul class="simple"> <li>Presentation: don’t use URL redirection; use random indirect references</li> <li>Controller: don’t use URL redirection; use random indirect references</li> <li>Model: validate roles</li> </ul>   <h3 id="id18">CodeIgniter provisions</h3> <ul class="simple"> <li>
<a class="reference external" href="../incoming/incomingrequest.html">HTTP library</a> provides for …</li> <li>
<a class="reference external" href="../libraries/sessions.html">Session</a> library provides flashdata</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2014&ndash;2020 British Columbia Institute of Technology<br>Licensed under the MIT License.<br>
    <a href="https://codeigniter.com/user_guide/concepts/security.html" class="_attribution-link">https://codeigniter.com/user_guide/concepts/security.html</a>
  </p>
</div>
