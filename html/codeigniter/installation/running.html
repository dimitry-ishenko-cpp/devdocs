<h1 id="running-your-app">Running Your App</h1>  <ul class="simple"> <li><a class="reference internal" href="#initial-configuration-set-up" id="id2">Initial Configuration &amp; Set Up</a></li> <li><a class="reference internal" href="#local-development-server" id="id3">Local Development Server</a></li> <li><a class="reference internal" href="#hosting-with-apache" id="id4">Hosting with Apache</a></li> <li><a class="reference internal" href="#hosting-with-nginx" id="id5">Hosting with Nginx</a></li> <li><a class="reference internal" href="#hosting-with-vagrant" id="id6">Hosting with Vagrant</a></li> <li><a class="reference internal" href="#bootstrapping-the-app" id="id7">Bootstrapping the App</a></li> </ul>  <p>A CodeIgniter 4 app can be run in a number of different ways: hosted on a web server, using virtualization, or using CodeIgniter’s command line tool for testing. This section addresses how to use each technique, and explains some of the pros and cons of them.</p> <p>If you’re new to CodeIgniter, please read the <a class="reference internal" href="../intro/index.html"><span class="doc">Getting Started</span></a> section of the User Guide to begin learning how to build dynamic PHP applications. Enjoy!</p>  <h2 id="initial-configuration-set-up">Initial Configuration &amp; Set Up</h2> <ol class="arabic simple"> <li>Open the <strong>app/Config/App.php</strong> file with a text editor and set your base URL. If you need more flexibility, the baseURL may be set within the <strong>.env</strong> file as <code>app.baseURL="http://example.com/"</code>. (Always use a trailing slash on your base URL!)</li> <li>If you intend to use a database, open the <strong>app/Config/Database.php</strong> file with a text editor and set your database settings. Alternately, these could be set in your <strong>.env</strong> file.</li> </ol> <p>One additional measure to take in production environments is to disable PHP error reporting and any other development-only functionality. In CodeIgniter, this can be done by setting the <code>ENVIRONMENT</code> constant, which is more fully described on the <a class="reference internal" href="../general/environments.html"><span class="doc">environments page</span></a>. By default, the application will run using the “production” environment. To take advantage of the debugging tools provided, you should set the environment to “development”.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">If you will be running your site using a web server (e.g., Apache or Nginx), you will need to modify the permissions for the <code>writable</code> folder inside your project, so that it is writable by the user or account used by your web server.</p> </div>   <h2 id="local-development-server">Local Development Server</h2> <p>CodeIgniter 4 comes with a local development server, leveraging PHP’s built-in web server with CodeIgniter routing. You can use the <code>serve</code> script to launch it, with the following command line in the main directory:</p> <pre data-language="php">php spark serve
</pre> <p>This will launch the server and you can now view your application in your browser at <a class="reference external" href="http://localhost:8080">http://localhost:8080</a>.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The built-in development server should only be used on local development machines. It should NEVER be used on a production server.</p> </div> <p>If you need to run the site on a host other than simply localhost, you’ll first need to add the host to your <code>hosts</code> file. The exact location of the file varies in each of the main operating systems, though all unix-type systems (include OS X) will typically keep the file at <strong>/etc/hosts</strong>.</p> <p>The local development server can be customized with three command line options:</p> <ul> <li>
<p class="first">You can use the <code>--host</code> CLI option to specify a different host to run the application at:</p> <pre data-language="php">php spark serve --host example.dev
</pre> </li> <li>
<p class="first">By default, the server runs on port 8080 but you might have more than one site running, or already have another application using that port. You can use the <code>--port</code> CLI option to specify a different one:</p> <pre data-language="php">php spark serve --port 8081
</pre> </li> <li>
<p class="first">You can also specify a specific version of PHP to use, with the <code>--php</code> CLI option, with its value set to the path of the PHP executable you want to use:</p> <pre data-language="php">php spark serve --php /usr/bin/php7.6.5.4
</pre> </li> </ul>   <h2 id="hosting-with-apache">Hosting with Apache</h2> <p>A CodeIgniter4 webapp is normally hosted on a web server. Apache’s <code>httpd</code> is the “standard” platform, and assumed in much of our documentation.</p> <p>Apache is bundled with many platforms, but can also be downloaded in a bundle with a database engine and PHP from <a class="reference external" href="https://bitnami.com/stacks/infrastructure">Bitnami</a>.</p>  <h3 id="htaccess">.htaccess</h3> <p>The “mod_rewrite” module enables URLs without “index.php” in them, and is assumed in our user guide.</p> <p>Make sure that the rewrite module is enabled (uncommented) in the main configuration file, e.g., <code>apache2/conf/httpd.conf</code>:</p> <pre data-language="php">LoadModule rewrite_module modules/mod_rewrite.so
</pre> <p>Also make sure that the default document root’s &lt;Directory&gt; element enables this too, in the “AllowOverride” setting:</p> <pre data-language="php">&lt;Directory "/opt/lamp/apache2/htdocs"&gt;
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
&lt;/Directory&gt;
</pre>   <h3 id="virtual-hosting">Virtual Hosting</h3> <p>We recommend using “virtual hosting” to run your apps. You can set up different aliases for each of the apps you work on,</p> <p>Make sure that the virtual hosting module is enabled (uncommented) in the main configuration file, e.g., <code>apache2/conf/httpd.conf</code>:</p> <pre data-language="php">LoadModule vhost_alias_module modules/mod_vhost_alias.so
</pre> <p>Add a host alias in your “hosts” file, typically <code>/etc/hosts</code> on unix-type platforms, or <code>c:/Windows/System32/drivers/etc/hosts</code> on Windows. Add a line to the file. This could be “myproject.local” or “myproject.test”, for instance:</p> <pre data-language="php">127.0.0.1 myproject.local
</pre> <p>Add a &lt;VirtualHost&gt; element for your webapp inside the virtual hosting configuration, e.g., <code>apache2/conf/extra/httpd-vhost.conf</code>:</p> <pre data-language="php">&lt;VirtualHost *:80&gt;
    DocumentRoot "/opt/lamp/apache2/htdocs/myproject/public"
    ServerName myproject.local
    ErrorLog "logs/myproject-error_log"
    CustomLog "logs/myproject-access_log" common
&lt;/VirtualHost&gt;
</pre> <p>If your project folder is not a subfolder of the Apache document root, then your &lt;VirtualHost&gt; element may need a nested &lt;Directory&gt; element to grant the web server access to the files.</p>   <h3 id="testing">Testing</h3> <p>With the above configuration, your webapp would be accessed with the URL <code>http://myproject.local</code> in your browser.</p> <p>Apache needs to be restarted whenever you change its configuration.</p>    <h2 id="hosting-with-nginx">Hosting with Nginx</h2> <p>Nginx is the second most widely used HTTP server for web hosting. Here you can find an example configuration using PHP 7.3 FPM (unix sockets) under Ubuntu Server.</p> <p>This configuration enables URLs without “index.php” in them and using CodeIgniter’s “404 - File Not Found” for URLs ending with “.php”.</p> <pre data-language="nginx">server {
    listen 80;
    listen [::]:80;

    server_name example.com;

    root  /var/www/example.com/public;
    index index.php index.html index.htm;

    location / {
        try_files $uri $uri/ /index.php$is_args$args;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;

        # With php-fpm:
        fastcgi_pass unix:/run/php/php7.3-fpm.sock;
        # With php-cgi:
        # fastcgi_pass 127.0.0.1:9000;
    }

    error_page 404 /index.php;

    # deny access to hidden files such as .htaccess
    location ~ /\. {
        deny all;
    }
}
</pre>   <h2 id="hosting-with-vagrant">Hosting with Vagrant</h2> <p>Virtualization is an effective way to test your webapp in the environment you plan to deploy on, even if you develop on a different one. Even if you are using the same platform for both, virtualization provides an isolated environment for testing.</p> <p>The codebase comes with a <code>VagrantFile.dist</code>, that can be copied to <code>VagrantFile</code> and tailored for your system, for instance enabling access to specific database or caching engines.</p>  <h3 id="setting-up">Setting Up</h3> <p>It assumes that you have installed <a class="reference external" href="https://www.virtualbox.org/wiki/Downloads">VirtualBox</a> and <a class="reference external" href="https://www.vagrantup.com/downloads.html">Vagrant</a> for your platform.</p> <p>The Vagrant configuration file assumes you have set up a <a class="reference external" href="https://app.vagrantup.com/ubuntu/boxes/bionic64">ubuntu/bionic64 Vagrant box</a> on your system:</p> <pre data-language="php">vagrant box add ubuntu/bionic64
</pre>   <h3 id="id1">Testing</h3> <p>Once set up, you can then launch your webapp inside a VM, with the command:</p> <pre data-language="php">vagrant up
</pre> <p>Your webapp will be accessible at <code>http://localhost:8080</code>, with the code coverage report for your build at <code>http://localhost:8081</code> and the user guide for it at <code>http://localhost:8082</code>.</p>    <h2 id="bootstrapping-the-app">Bootstrapping the App</h2> <p>In some scenarios you will want to load the framework without actually running the whole application. This is particularly useful for unit testing your project, but may also be handy for using third-party tools to analyze and modify your code. The framework comes with a separate bootstrap script specifically for this scenario: <code>system/Test/bootstrap.php</code>.</p> <p>Most of the paths to your project are defined during the bootstrap process. You may use pre-defined constants to override these, but when using the defaults be sure that your paths align with the expected directory structure for your installation method.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2014&ndash;2020 British Columbia Institute of Technology<br>Licensed under the MIT License.<br>
    <a href="https://codeigniter.com/user_guide/installation/running.html" class="_attribution-link">https://codeigniter.com/user_guide/installation/running.html</a>
  </p>
</div>
