<h1 class="type-name"> class StringPool </h1> <ul class="superclass-hierarchy">
<li class="superclass"><a href="stringpool.html">StringPool</a></li>
<li class="superclass"><a href="reference.html">Reference</a></li>
<li class="superclass"><a href="object.html">Object</a></li>
</ul> <h2>  Overview </h2> <p>A string pool is a collection of strings. It allows a runtime to save memory by preserving strings in a pool, allowing to reuse an instance of a common string instead of creating a new one.</p> <p>NOTE To use <code><a href="stringpool.html">StringPool</a></code>, you must explicitly import it with <code>require "string_pool"</code></p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
a = "foo" + "bar"
b = "foo" + "bar"
a.object_id # =&gt; 136294360
b.object_id # =&gt; 136294336
a = pool.get(a)
b = pool.get(b)
a.object_id # =&gt; 136294312
b.object_id # =&gt; 136294312</pre> <h2>  Defined in: </h2> <a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L20" target="_blank"> string_pool.cr </a> <br> <h2>  Constructors </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#new%28initial_capacity%3D8%29-class-method" class="signature"><strong>.new</strong>(initial_capacity = 8)</a> <div class="summary"><p>Creates a new empty string pool.</p></div> </li> </ul> <h2>  Instance Method Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#empty%3F%3ABool-instance-method" class="signature"><strong>#empty?</strong> : Bool</a> <div class="summary"><p>Returns <code>true</code> if the <code><a href="stringpool.html">StringPool</a></code> has no element otherwise returns <code>false</code>.</p></div> </li> <li class="entry-summary"> <a href="#get%28str%3APointer%28UInt8%29%2Clen%29%3AString-instance-method" class="signature"><strong>#get</strong>(str : Pointer(UInt8), len) : String</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents given by the pointer <em>str</em> of size <em>len</em>.</p></div> </li> <li class="entry-summary"> <a href="#get%28slice%3ABytes%29%3AString-instance-method" class="signature"><strong>#get</strong>(slice : Bytes) : String</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <em>slice</em>.</p></div> </li> <li class="entry-summary"> <a href="#get%28str%3AIO%3A%3AMemory%29%3AString-instance-method" class="signature"><strong>#get</strong>(str : IO::Memory) : String</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <code><a href="io/memory.html">IO::Memory</a></code>.</p></div> </li> <li class="entry-summary"> <a href="#get%28str%3AString%29%3AString-instance-method" class="signature"><strong>#get</strong>(str : String) : String</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents of the given string.</p></div> </li> <li class="entry-summary"> <a href="#get%3F%28str%3APointer%28UInt8%29%2Clen%29%3AString%7CNil-instance-method" class="signature"><strong>#get?</strong>(str : Pointer(UInt8), len) : String | Nil</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents given by the pointer <em>str</em> of size <em>len</em>, or <code>nil</code> if no such string exists in the pool.</p></div> </li> <li class="entry-summary"> <a href="#get%3F%28slice%3ABytes%29%3AString%7CNil-instance-method" class="signature"><strong>#get?</strong>(slice : Bytes) : String | Nil</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <em>slice</em>, or <code>nil</code> if no such string exists in the pool.</p></div> </li> <li class="entry-summary"> <a href="#get%3F%28str%3AIO%3A%3AMemory%29%3AString%7CNil-instance-method" class="signature"><strong>#get?</strong>(str : IO::Memory) : String | Nil</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <code><a href="io/memory.html">IO::Memory</a></code>, or <code>nil</code> if no such string exists in the pool.</p></div> </li> <li class="entry-summary"> <a href="#get%3F%28str%3AString%29%3AString%7CNil-instance-method" class="signature"><strong>#get?</strong>(str : String) : String | Nil</a> <div class="summary"><p>Returns a <code><a href="string.html">String</a></code> with the contents of the given string, or <code>nil</code> if no such string exists in the pool.</p></div> </li> <li class="entry-summary"> <a href="#rehash%3ANil-instance-method" class="signature"><strong>#rehash</strong> : Nil</a> <div class="summary"><p>Rebuilds the hash based on the current hash values for each key, if values of key objects have changed since they were inserted.</p></div> </li> <li class="entry-summary"> <a href="#size%3AInt32-instance-method" class="signature"><strong>#size</strong> : Int32</a> <div class="summary"><p>Returns the size</p></div> </li> </ul> <div class="methods-inherited"> <h3>Instance methods inherited from class <code><a href="reference.html">Reference</a></code>
</h3> <a href="reference.html#%3D%3D%28other%3Aself%29-instance-method" class="tooltip"> ==(other : self)<br>==(other : JSON::Any)<br>==(other : YAML::Any)<br>==(other) ==</a>, <a href="reference.html#dup-instance-method" class="tooltip"> dup dup</a>, <a href="reference.html#hash%28hasher%29-instance-method" class="tooltip"> hash(hasher) hash</a>, <a href="reference.html#initialize-instance-method" class="tooltip"> initialize initialize</a>, <a href="reference.html#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip"> inspect(io : IO) : Nil inspect</a>, <a href="reference.html#object_id%3AUInt64-instance-method" class="tooltip"> object_id : UInt64 object_id</a>, <a href="reference.html#pretty_print%28pp%29%3ANil-instance-method" class="tooltip"> pretty_print(pp) : Nil pretty_print</a>, <a href="reference.html#same%3F%28other%3AReference%29%3ABool-instance-method" class="tooltip"> same?(other : Reference) : Bool<br>same?(other : Nil) same?</a>, <a href="reference.html#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_s(io : IO) : Nil to_s</a> <h3>Constructor methods inherited from class <code><a href="reference.html">Reference</a></code>
</h3> <a href="reference.html#new-class-method" class="tooltip"> new new</a>, <a href="reference.html#unsafe_construct%28address%3APointer%2C%2Aargs%2C%2A%2Aopts%29%3Aself-class-method" class="tooltip"> unsafe_construct(address : Pointer, *args, **opts) : self unsafe_construct</a> <h3>Class methods inherited from class <code><a href="reference.html">Reference</a></code>
</h3> <a href="reference.html#pre_initialize%28address%3APointer%29-class-method" class="tooltip"> pre_initialize(address : Pointer) pre_initialize</a> <h3>Instance methods inherited from class <code><a href="object.html">Object</a></code>
</h3> <a href="object.html#%21%3ABool-instance-method" class="tooltip"> ! : Bool !</a>, <a href="object.html#%21%3D%28other%29-instance-method" class="tooltip"> !=(other) !=</a>, <a href="object.html#%21~%28other%29-instance-method" class="tooltip"> !~(other) !~</a>, <a href="object.html#%3D%3D%28other%29-instance-method" class="tooltip"> ==(other) ==</a>, <a href="object.html#%3D%3D%3D%28other%3AJSON%3A%3AAny%29-instance-method" class="tooltip"> ===(other : JSON::Any)<br>===(other : YAML::Any)<br>===(other) ===</a>, <a href="object.html#%3D~%28other%29-instance-method" class="tooltip"> =~(other) =~</a>, <a href="object.html#as%28type%3AClass%29-instance-method" class="tooltip"> as(type : Class) as</a>, <a href="object.html#as%3F%28type%3AClass%29-instance-method" class="tooltip"> as?(type : Class) as?</a>, <a href="object.html#class-instance-method" class="tooltip"> class class</a>, <a href="object.html#dup-instance-method" class="tooltip"> dup dup</a>, <a href="object.html#hash%28hasher%29-instance-method" class="tooltip"> hash(hasher)<br>hash hash</a>, <a href="object.html#in%3F%28collection%3AObject%29%3ABool-instance-method" class="tooltip"> in?(collection : Object) : Bool<br>in?(*values : Object) : Bool in?</a>, <a href="object.html#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip"> inspect(io : IO) : Nil<br>inspect : String inspect</a>, <a href="object.html#is_a%3F%28type%3AClass%29%3ABool-instance-method" class="tooltip"> is_a?(type : Class) : Bool is_a?</a>, <a href="object.html#itself-instance-method" class="tooltip"> itself itself</a>, <a href="object.html#nil%3F%3ABool-instance-method" class="tooltip"> nil? : Bool nil?</a>, <a href="object.html#not_nil%21%28message%29-instance-method" class="tooltip"> not_nil!(message)<br>not_nil! not_nil!</a>, <a href="object.html#pretty_inspect%28width%3D79%2Cnewline%3D%22%5Cn%22%2Cindent%3D0%29%3AString-instance-method" class="tooltip"> pretty_inspect(width = 79, newline = "\n", indent = 0) : String pretty_inspect</a>, <a href="object.html#pretty_print%28pp%3APrettyPrint%29%3ANil-instance-method" class="tooltip"> pretty_print(pp : PrettyPrint) : Nil pretty_print</a>, <a href="object.html#responds_to%3F%28name%3ASymbol%29%3ABool-instance-method" class="tooltip"> responds_to?(name : Symbol) : Bool responds_to?</a>, <a href="object.html#tap%28%26%29-instance-method" class="tooltip"> tap(&amp;) tap</a>, <a href="object.html#to_json%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_json(io : IO) : Nil<br>to_json : String to_json</a>, <a href="object.html#to_pretty_json%28indent%3AString%3D%22%22%29%3AString-instance-method" class="tooltip"> to_pretty_json(indent : String = " ") : String<br>to_pretty_json(io : IO, indent : String = " ") : Nil to_pretty_json</a>, <a href="object.html#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_s(io : IO) : Nil<br>to_s : String to_s</a>, <a href="object.html#to_yaml%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_yaml(io : IO) : Nil<br>to_yaml : String to_yaml</a>, <a href="object.html#try%28%26%29-instance-method" class="tooltip"> try(&amp;) try</a>, <a href="object.html#unsafe_as%28type%3AT.class%29forallT-instance-method" class="tooltip"> unsafe_as(type : T.class) forall T unsafe_as</a> <h3>Class methods inherited from class <code><a href="object.html">Object</a></code>
</h3> <a href="object.html#from_json%28string_or_io%2Croot%3AString%29-class-method" class="tooltip"> from_json(string_or_io, root : String)<br>from_json(string_or_io) from_json</a>, <a href="object.html#from_yaml%28string_or_io%3AString%7CIO%29-class-method" class="tooltip"> from_yaml(string_or_io : String | IO) from_yaml</a> <h3>Macros inherited from class <code><a href="object.html">Object</a></code>
</h3> <a href="object.html#class_getter%28%2Anames%2C%26block%29-macro" class="tooltip"> class_getter(*names, &amp;block) class_getter</a>, <a href="object.html#class_getter%21%28%2Anames%29-macro" class="tooltip"> class_getter!(*names) class_getter!</a>, <a href="object.html#class_getter%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> class_getter?(*names, &amp;block) class_getter?</a>, <a href="object.html#class_property%28%2Anames%2C%26block%29-macro" class="tooltip"> class_property(*names, &amp;block) class_property</a>, <a href="object.html#class_property%21%28%2Anames%29-macro" class="tooltip"> class_property!(*names) class_property!</a>, <a href="object.html#class_property%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> class_property?(*names, &amp;block) class_property?</a>, <a href="object.html#class_setter%28%2Anames%29-macro" class="tooltip"> class_setter(*names) class_setter</a>, <a href="object.html#def_clone-macro" class="tooltip"> def_clone def_clone</a>, <a href="object.html#def_equals%28%2Afields%29-macro" class="tooltip"> def_equals(*fields) def_equals</a>, <a href="object.html#def_equals_and_hash%28%2Afields%29-macro" class="tooltip"> def_equals_and_hash(*fields) def_equals_and_hash</a>, <a href="object.html#def_hash%28%2Afields%29-macro" class="tooltip"> def_hash(*fields) def_hash</a>, <a href="object.html#delegate%28%2Amethods%2Ctoobject%29-macro" class="tooltip"> delegate(*methods, to object) delegate</a>, <a href="object.html#forward_missing_to%28delegate%29-macro" class="tooltip"> forward_missing_to(delegate) forward_missing_to</a>, <a href="object.html#getter%28%2Anames%2C%26block%29-macro" class="tooltip"> getter(*names, &amp;block) getter</a>, <a href="object.html#getter%21%28%2Anames%29-macro" class="tooltip"> getter!(*names) getter!</a>, <a href="object.html#getter%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> getter?(*names, &amp;block) getter?</a>, <a href="object.html#property%28%2Anames%2C%26block%29-macro" class="tooltip"> property(*names, &amp;block) property</a>, <a href="object.html#property%21%28%2Anames%29-macro" class="tooltip"> property!(*names) property!</a>, <a href="object.html#property%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> property?(*names, &amp;block) property?</a>, <a href="object.html#setter%28%2Anames%29-macro" class="tooltip"> setter(*names) setter</a> </div> <h2>  Constructor Detail </h2> <div class="entry-detail" id="new(initial_capacity=8)-class-method"> <h3 class="signature">def self.<strong>new</strong>(initial_capacity = 8)<a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L49" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Creates a new empty string pool.</p> <p>The <em>initial_capacity</em> is useful to avoid unnecessary reallocations of the internal buffers in case of growth. If you have an estimate of the maximum number of elements the pool will hold it should be initialized with that capacity for improved performance. Inputs lower than 8 are ignored.</p> <pre data-language="crystal">pool = StringPool.new(256)
pool.size # =&gt; 0</pre> </div>   </div> <h2>  Instance Method Detail </h2> <div class="entry-detail" id="empty?:Bool-instance-method"> <h3 class="signature">def <strong>empty?</strong> : <a href="bool.html">Bool</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L66" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns <code>true</code> if the <code><a href="stringpool.html">StringPool</a></code> has no element otherwise returns <code>false</code>.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
pool.empty? # =&gt; true
pool.get("crystal")
pool.empty? # =&gt; false</pre> </div>   </div> <div class="entry-detail" id="get(str:Pointer(UInt8),len):String-instance-method"> <h3 class="signature">def <strong>get</strong>(str : <a href="pointer.html">Pointer</a>(<a href="uint8.html">UInt8</a>), len) : <a href="string.html">String</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L119" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents given by the pointer <em>str</em> of size <em>len</em>.</p> <p>If a string with those contents was already present in the pool, that one is returned. Otherwise a new string is created, put in the pool and returned.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
pool.get("hey".to_unsafe, 3)
pool.size # =&gt; 1</pre> </div>   </div> <div class="entry-detail" id="get(slice:Bytes):String-instance-method"> <h3 class="signature">def <strong>get</strong>(slice : <a href="bytes.html">Bytes</a>) : <a href="string.html">String</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L85" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <em>slice</em>.</p> <p>If a string with those contents was already present in the pool, that one is returned. Otherwise a new string is created, put in the pool and returned.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
ptr = Pointer.malloc(9) { |i| ('a'.ord + i).to_u8 }
slice = Slice.new(ptr, 3)
pool.empty? # =&gt; true
pool.get(slice)
pool.empty? # =&gt; false</pre> </div>   </div> <div class="entry-detail" id="get(str:IO::Memory):String-instance-method"> <h3 class="signature">def <strong>get</strong>(str : <a href="io/memory.html">IO::Memory</a>) : <a href="string.html">String</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L193" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <code><a href="io/memory.html">IO::Memory</a></code>.</p> <p>If a string with those contents was already present in the pool, that one is returned. Otherwise a new string is created, put in the pool and returned.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
io = IO::Memory.new "crystal"
pool.empty? # =&gt; true
pool.get(io)
pool.empty? # =&gt; false</pre> </div>   </div> <div class="entry-detail" id="get(str:String):String-instance-method"> <h3 class="signature">def <strong>get</strong>(str : <a href="string.html">String</a>) : <a href="string.html">String</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L229" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents of the given string.</p> <p>If a string with those contents was already present in the pool, that one is returned. Otherwise a new string is created, put in the pool and returned.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
string = "crystal"
pool.empty? # =&gt; true
pool.get(string)
pool.empty? # =&gt; false</pre> </div>   </div> <div class="entry-detail" id="get?(str:Pointer(UInt8),len):String|Nil-instance-method"> <h3 class="signature">def <strong>get?</strong>(str : <a href="pointer.html">Pointer</a>(<a href="uint8.html">UInt8</a>), len) : <a href="string.html">String</a> | <a href="nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L144" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents given by the pointer <em>str</em> of size <em>len</em>, or <code>nil</code> if no such string exists in the pool.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
pool.get?("hey".to_unsafe, 3) # =&gt; nil
pool.empty?                   # =&gt; true
pool.get("hey".to_unsafe, 3)  # =&gt; "hey"
pool.empty?                   # =&gt; false
pool.get?("hey".to_unsafe, 3) # =&gt; "hey"</pre> </div>   </div> <div class="entry-detail" id="get?(slice:Bytes):String|Nil-instance-method"> <h3 class="signature">def <strong>get?</strong>(slice : <a href="bytes.html">Bytes</a>) : <a href="string.html">String</a> | <a href="nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L103" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <em>slice</em>, or <code>nil</code> if no such string exists in the pool.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
bytes = "abc".to_slice
pool.get?(bytes) # =&gt; nil
pool.empty?      # =&gt; true
pool.get(bytes)  # =&gt; "abc"
pool.empty?      # =&gt; false
pool.get?(bytes) # =&gt; "abc"</pre> </div>   </div> <div class="entry-detail" id="get?(str:IO::Memory):String|Nil-instance-method"> <h3 class="signature">def <strong>get?</strong>(str : <a href="io/memory.html">IO::Memory</a>) : <a href="string.html">String</a> | <a href="nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L211" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents of the given <code><a href="io/memory.html">IO::Memory</a></code>, or <code>nil</code> if no such string exists in the pool.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
io = IO::Memory.new "crystal"
pool.get?(io) # =&gt; nil
pool.empty?   # =&gt; true
pool.get(io)  # =&gt; "crystal"
pool.empty?   # =&gt; false
pool.get?(io) # =&gt; "crystal"</pre> </div>   </div> <div class="entry-detail" id="get?(str:String):String|Nil-instance-method"> <h3 class="signature">def <strong>get?</strong>(str : <a href="string.html">String</a>) : <a href="string.html">String</a> | <a href="nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L247" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns a <code><a href="string.html">String</a></code> with the contents of the given string, or <code>nil</code> if no such string exists in the pool.</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
string = "crystal"
pool.get?(string) # =&gt; nil
pool.empty?       # =&gt; true
pool.get(string)  # =&gt; "crystal"
pool.empty?       # =&gt; false
pool.get?(string) # =&gt; "crystal"</pre> </div>   </div> <div class="entry-detail" id="rehash:Nil-instance-method"> <h3 class="signature">def <strong>rehash</strong> : <a href="nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L255" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Rebuilds the hash based on the current hash values for each key, if values of key objects have changed since they were inserted.</p> <p>Call this method if you modified a string submitted to the pool.</p> </div>   </div> <div class="entry-detail" id="size:Int32-instance-method"> <h3 class="signature">def <strong>size</strong> : <a href="int32.html">Int32</a><a href="https://github.com/crystal-lang/crystal/blob/89944bf17/src/string_pool.cr#L35" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Returns the size</p> <pre data-language="crystal">require "string_pool"

pool = StringPool.new
pool.size # =&gt; 0</pre> </div>   </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2025 Manas Technology Solutions.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://crystal-lang.org/api/1.15.1/StringPool.html" class="_attribution-link">https://crystal-lang.org/api/1.15.1/StringPool.html</a>
  </p>
</div>
