<h1 class="type-name"> class Crypto::<wbr>Bcrypt </wbr>
</h1> <ul class="superclass-hierarchy">
<li class="superclass"><a href="bcrypt.html">Crypto::Bcrypt</a></li>
<li class="superclass"><a href="../reference.html">Reference</a></li>
<li class="superclass"><a href="../object.html">Object</a></li>
</ul> <h2>  Overview </h2> <p>Pure Crystal implementation of the Bcrypt algorithm by Niels Provos and David Mazi√®res, as <a href="https://www.usenix.org/legacy/events/usenix99/provos/provos_html/index.html">presented at USENIX in 1999</a>.</p> <p>The algorithm has a maximum password length limit of 71 characters (see <a href="https://security.stackexchange.com/questions/39849/does-bcrypt-have-a-maximum-password-length#answer-39851">this comment</a> on stackoverflow).</p> <p>Refer to <code><a href="bcrypt/password.html">Crypto::Bcrypt::Password</a></code> for a higher level interface.</p> <p>About the Cost</p> <p>Bcrypt, like the PBKDF2 or scrypt ciphers, are designed to be slow, so generating rainbow tables or cracking passwords is nearly impossible. Yet, computers are always getting faster and faster, so the actual cost must be incremented every once in a while. Always use the maximum cost that is tolerable, performance wise, for your application. Be sure to test and select this based on your server, not your home computer.</p> <p>This implementation of Bcrypt is currently 50% slower than pure C solutions, so keep this in mind when selecting your cost. It may be wise to test with Ruby's <a href="https://github.com/codahale/bcrypt-ruby">bcrypt gem</a> which is a binding to OpenBSD's implementation.</p> <p>Last but not least: beware of denial of services! Always protect your application using an external strategy (eg: rate limiting), otherwise endpoints that verifies bcrypt hashes will be an easy target.</p> <p>NOTE To use <code><a href="bcrypt.html">Bcrypt</a></code>, you must explicitly import it with <code>require "crypto/bcrypt"</code></p> <h2>  Defined in: </h2> <a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L34" target="_blank"> crypto/bcrypt.cr </a> <br> <h2>  Constant Summary </h2> <dl> <dt class="entry-const" id="COST_RANGE"> <strong>COST_RANGE</strong> = <code>4..31</code> </dt> <dt class="entry-const" id="DEFAULT_COST"> <strong>DEFAULT_COST</strong> = <code>11</code> </dt> <dt class="entry-const" id="PASSWORD_RANGE"> <strong>PASSWORD_RANGE</strong> = <code>1..72</code> </dt> <dt class="entry-const" id="SALT_SIZE"> <strong>SALT_SIZE</strong> = <code>16</code> </dt> </dl> <h2>  Constructors </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#new%28password%3AString%2Csalt%3AString%2Ccost%3DDEFAULT_COST%29-class-method" class="signature"><strong>.new</strong>(password : String, salt : String, cost = DEFAULT_COST)</a> <div class="summary"><p>Creates a new <code><a href="bcrypt.html">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> and <em>cost</em>.</p></div> </li> <li class="entry-summary"> <a href="#new%28password%3ABytes%2Csalt%3ABytes%2Ccost%3AInt32%3DDEFAULT_COST%29-class-method" class="signature"><strong>.new</strong>(password : Bytes, salt : Bytes, cost : Int32 = DEFAULT_COST)</a> <div class="summary"><p>Creates a new <code><a href="bcrypt.html">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> in bytes and <em>cost</em>.</p></div> </li> </ul> <h2>  Class Method Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#hash_secret%28password%2Ccost%3DDEFAULT_COST%29%3AString-class-method" class="signature"><strong>.hash_secret</strong>(password, cost = DEFAULT_COST) : String</a> <div class="summary"><p>Hashes the <em>password</em> using bcrypt algorithm using salt obtained via <code><a href="../random/secure.html#random_bytes%28buf%3ABytes%29%3ANil-instance-method">Random::Secure.random_bytes(SALT_SIZE)</a></code>.</p></div> </li> </ul> <h2>  Instance Method Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#cost%3AInt32-instance-method" class="signature"><strong>#cost</strong> : Int32</a> </li> <li class="entry-summary"> <a href="#digest%3ABytes-instance-method" class="signature"><strong>#digest</strong> : Bytes</a> </li> <li class="entry-summary"> <a href="#inspect%28io%3AIO%29%3ANil-instance-method" class="signature"><strong>#inspect</strong>(io : IO) : Nil</a> <div class="summary"><p>Appends a String representation of this object which includes its class name, its object address and the values of all instance variables.</p></div> </li> <li class="entry-summary"> <a href="#password%3ABytes-instance-method" class="signature"><strong>#password</strong> : Bytes</a> </li> <li class="entry-summary"> <a href="#salt%3ABytes-instance-method" class="signature"><strong>#salt</strong> : Bytes</a> </li> <li class="entry-summary"> <a href="#to_s%28io%3AIO%29%3ANil-instance-method" class="signature"><strong>#to_s</strong>(io : IO) : Nil</a> <div class="summary"><p>Appends a short String representation of this object which includes its class name and its object address.</p></div> </li> <li class="entry-summary"> <a href="#to_s%3AString-instance-method" class="signature"><strong>#to_s</strong> : String</a> <div class="summary"><p>Returns a nicely readable and concise string representation of this object, typically intended for users.</p></div> </li> <li class="entry-summary"> <a href="#to_slice%28%2Aargs%2C%2A%2Aoptions%29-instance-method" class="signature"><strong>#to_slice</strong>(*args, **options)</a> </li> <li class="entry-summary"> <a href="#to_slice%28%2Aargs%2C%2A%2Aoptions%2C%26%29-instance-method" class="signature"><strong>#to_slice</strong>(*args, **options, &amp;)</a> </li> </ul> <div class="methods-inherited"> <h3>Instance methods inherited from class <code><a href="../reference.html">Reference</a></code>
</h3> <a href="../reference.html#%3D%3D%28other%3Aself%29-instance-method" class="tooltip"> ==(other : self)<br>==(other : JSON::Any)<br>==(other : YAML::Any)<br>==(other) ==</a>, <a href="../reference.html#dup-instance-method" class="tooltip"> dup dup</a>, <a href="../reference.html#hash%28hasher%29-instance-method" class="tooltip"> hash(hasher) hash</a>, <a href="../reference.html#initialize-instance-method" class="tooltip"> initialize initialize</a>, <a href="../reference.html#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip"> inspect(io : IO) : Nil inspect</a>, <a href="../reference.html#object_id%3AUInt64-instance-method" class="tooltip"> object_id : UInt64 object_id</a>, <a href="../reference.html#pretty_print%28pp%29%3ANil-instance-method" class="tooltip"> pretty_print(pp) : Nil pretty_print</a>, <a href="../reference.html#same%3F%28other%3AReference%29%3ABool-instance-method" class="tooltip"> same?(other : Reference) : Bool<br>same?(other : Nil) same?</a>, <a href="../reference.html#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_s(io : IO) : Nil to_s</a> <h3>Constructor methods inherited from class <code><a href="../reference.html">Reference</a></code>
</h3> <a href="../reference.html#new-class-method" class="tooltip"> new new</a>, <a href="../reference.html#unsafe_construct%28address%3APointer%2C%2Aargs%2C%2A%2Aopts%29%3Aself-class-method" class="tooltip"> unsafe_construct(address : Pointer, *args, **opts) : self unsafe_construct</a> <h3>Class methods inherited from class <code><a href="../reference.html">Reference</a></code>
</h3> <a href="../reference.html#pre_initialize%28address%3APointer%29-class-method" class="tooltip"> pre_initialize(address : Pointer) pre_initialize</a> <h3>Instance methods inherited from class <code><a href="../object.html">Object</a></code>
</h3> <a href="../object.html#%21%3ABool-instance-method" class="tooltip"> ! : Bool !</a>, <a href="../object.html#%21%3D%28other%29-instance-method" class="tooltip"> !=(other) !=</a>, <a href="../object.html#%21~%28other%29-instance-method" class="tooltip"> !~(other) !~</a>, <a href="../object.html#%3D%3D%28other%29-instance-method" class="tooltip"> ==(other) ==</a>, <a href="../object.html#%3D%3D%3D%28other%3AJSON%3A%3AAny%29-instance-method" class="tooltip"> ===(other : JSON::Any)<br>===(other : YAML::Any)<br>===(other) ===</a>, <a href="../object.html#%3D~%28other%29-instance-method" class="tooltip"> =~(other) =~</a>, <a href="../object.html#as%28type%3AClass%29-instance-method" class="tooltip"> as(type : Class) as</a>, <a href="../object.html#as%3F%28type%3AClass%29-instance-method" class="tooltip"> as?(type : Class) as?</a>, <a href="../object.html#class-instance-method" class="tooltip"> class class</a>, <a href="../object.html#dup-instance-method" class="tooltip"> dup dup</a>, <a href="../object.html#hash%28hasher%29-instance-method" class="tooltip"> hash(hasher)<br>hash hash</a>, <a href="../object.html#in%3F%28collection%3AObject%29%3ABool-instance-method" class="tooltip"> in?(collection : Object) : Bool<br>in?(*values : Object) : Bool in?</a>, <a href="../object.html#inspect%28io%3AIO%29%3ANil-instance-method" class="tooltip"> inspect(io : IO) : Nil<br>inspect : String inspect</a>, <a href="../object.html#is_a%3F%28type%3AClass%29%3ABool-instance-method" class="tooltip"> is_a?(type : Class) : Bool is_a?</a>, <a href="../object.html#itself-instance-method" class="tooltip"> itself itself</a>, <a href="../object.html#nil%3F%3ABool-instance-method" class="tooltip"> nil? : Bool nil?</a>, <a href="../object.html#not_nil%21%28message%29-instance-method" class="tooltip"> not_nil!(message)<br>not_nil! not_nil!</a>, <a href="../object.html#pretty_inspect%28width%3D79%2Cnewline%3D%22%5Cn%22%2Cindent%3D0%29%3AString-instance-method" class="tooltip"> pretty_inspect(width = 79, newline = "\n", indent = 0) : String pretty_inspect</a>, <a href="../object.html#pretty_print%28pp%3APrettyPrint%29%3ANil-instance-method" class="tooltip"> pretty_print(pp : PrettyPrint) : Nil pretty_print</a>, <a href="../object.html#responds_to%3F%28name%3ASymbol%29%3ABool-instance-method" class="tooltip"> responds_to?(name : Symbol) : Bool responds_to?</a>, <a href="../object.html#tap%28%26%29-instance-method" class="tooltip"> tap(&amp;) tap</a>, <a href="../object.html#to_json%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_json(io : IO) : Nil<br>to_json : String to_json</a>, <a href="../object.html#to_pretty_json%28indent%3AString%3D%22%22%29%3AString-instance-method" class="tooltip"> to_pretty_json(indent : String = " ") : String<br>to_pretty_json(io : IO, indent : String = " ") : Nil to_pretty_json</a>, <a href="../object.html#to_s%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_s(io : IO) : Nil<br>to_s : String to_s</a>, <a href="../object.html#to_yaml%28io%3AIO%29%3ANil-instance-method" class="tooltip"> to_yaml(io : IO) : Nil<br>to_yaml : String to_yaml</a>, <a href="../object.html#try%28%26%29-instance-method" class="tooltip"> try(&amp;) try</a>, <a href="../object.html#unsafe_as%28type%3AT.class%29forallT-instance-method" class="tooltip"> unsafe_as(type : T.class) forall T unsafe_as</a> <h3>Class methods inherited from class <code><a href="../object.html">Object</a></code>
</h3> <a href="../object.html#from_json%28string_or_io%2Croot%3AString%29-class-method" class="tooltip"> from_json(string_or_io, root : String)<br>from_json(string_or_io) from_json</a>, <a href="../object.html#from_yaml%28string_or_io%3AString%7CIO%29-class-method" class="tooltip"> from_yaml(string_or_io : String | IO) from_yaml</a> <h3>Macros inherited from class <code><a href="../object.html">Object</a></code>
</h3> <a href="../object.html#class_getter%28%2Anames%2C%26block%29-macro" class="tooltip"> class_getter(*names, &amp;block) class_getter</a>, <a href="../object.html#class_getter%21%28%2Anames%29-macro" class="tooltip"> class_getter!(*names) class_getter!</a>, <a href="../object.html#class_getter%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> class_getter?(*names, &amp;block) class_getter?</a>, <a href="../object.html#class_property%28%2Anames%2C%26block%29-macro" class="tooltip"> class_property(*names, &amp;block) class_property</a>, <a href="../object.html#class_property%21%28%2Anames%29-macro" class="tooltip"> class_property!(*names) class_property!</a>, <a href="../object.html#class_property%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> class_property?(*names, &amp;block) class_property?</a>, <a href="../object.html#class_setter%28%2Anames%29-macro" class="tooltip"> class_setter(*names) class_setter</a>, <a href="../object.html#def_clone-macro" class="tooltip"> def_clone def_clone</a>, <a href="../object.html#def_equals%28%2Afields%29-macro" class="tooltip"> def_equals(*fields) def_equals</a>, <a href="../object.html#def_equals_and_hash%28%2Afields%29-macro" class="tooltip"> def_equals_and_hash(*fields) def_equals_and_hash</a>, <a href="../object.html#def_hash%28%2Afields%29-macro" class="tooltip"> def_hash(*fields) def_hash</a>, <a href="../object.html#delegate%28%2Amethods%2Ctoobject%29-macro" class="tooltip"> delegate(*methods, to object) delegate</a>, <a href="../object.html#forward_missing_to%28delegate%29-macro" class="tooltip"> forward_missing_to(delegate) forward_missing_to</a>, <a href="../object.html#getter%28%2Anames%2C%26block%29-macro" class="tooltip"> getter(*names, &amp;block) getter</a>, <a href="../object.html#getter%21%28%2Anames%29-macro" class="tooltip"> getter!(*names) getter!</a>, <a href="../object.html#getter%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> getter?(*names, &amp;block) getter?</a>, <a href="../object.html#property%28%2Anames%2C%26block%29-macro" class="tooltip"> property(*names, &amp;block) property</a>, <a href="../object.html#property%21%28%2Anames%29-macro" class="tooltip"> property!(*names) property!</a>, <a href="../object.html#property%3F%28%2Anames%2C%26block%29-macro" class="tooltip"> property?(*names, &amp;block) property?</a>, <a href="../object.html#setter%28%2Anames%29-macro" class="tooltip"> setter(*names) setter</a> </div> <h2>  Constructor Detail </h2> <div class="entry-detail" id="new(password:String,salt:String,cost=DEFAULT_COST)-class-method"> <h3 class="signature">def self.<strong>new</strong>(password : <a href="../string.html">String</a>, salt : <a href="../string.html">String</a>, cost = DEFAULT_COST)<a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L74" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Creates a new <code><a href="bcrypt.html">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> and <em>cost</em>.</p> <pre data-language="crystal">require "crypto/bcrypt"

password = Crypto::Bcrypt.new "secret", "salt_of_16_chars"
password.digest</pre> </div>   </div> <div class="entry-detail" id="new(password:Bytes,salt:Bytes,cost:Int32=DEFAULT_COST)-class-method"> <h3 class="signature">def self.<strong>new</strong>(password : <a href="../bytes.html">Bytes</a>, salt : <a href="../bytes.html">Bytes</a>, cost : <a href="../int32.html">Int32</a> = DEFAULT_COST)<a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L93" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Creates a new <code><a href="bcrypt.html">Crypto::Bcrypt</a></code> object from the given <em>password</em> with <em>salt</em> in bytes and <em>cost</em>.</p> <pre data-language="crystal">require "crypto/bcrypt"

password = Crypto::Bcrypt.new "secret".to_slice, "salt_of_16_chars".to_slice
password.digest</pre> </div>   </div> <h2>  Class Method Detail </h2> <div class="entry-detail" id="hash_secret(password,cost=DEFAULT_COST):String-class-method"> <h3 class="signature">def self.<strong>hash_secret</strong>(password, cost = DEFAULT_COST) : <a href="../string.html">String</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L59" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Hashes the <em>password</em> using bcrypt algorithm using salt obtained via <code><a href="../random/secure.html#random_bytes%28buf%3ABytes%29%3ANil-instance-method">Random::Secure.random_bytes(SALT_SIZE)</a></code>.</p> <pre data-language="crystal">require "crypto/bcrypt"

Crypto::Bcrypt.hash_secret "secret"</pre> </div>   </div> <h2>  Instance Method Detail </h2> <div class="entry-detail" id="cost:Int32-instance-method"> <h3 class="signature">def <strong>cost</strong> : <a href="../int32.html">Int32</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L83" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="digest:Bytes-instance-method"> <h3 class="signature">def <strong>digest</strong> : <a href="../bytes.html">Bytes</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L101" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="inspect(io:IO):Nil-instance-method"> <h3 class="signature">def <strong>inspect</strong>(io : <a href="../io.html">IO</a>) : <a href="../nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L119" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <div class="doc-inherited"> Description copied from class <a href="../reference.html">Reference</a> </div> <p>Appends a String representation of this object which includes its class name, its object address and the values of all instance variables.</p> <pre data-language="crystal">class Person
  def initialize(@name : String, @age : Int32)
  end
end

Person.new("John", 32).inspect # =&gt; #&lt;Person:0x10fd31f20 @name="John", @age=32&gt;</pre> </div>   </div> <div class="entry-detail" id="password:Bytes-instance-method"> <h3 class="signature">def <strong>password</strong> : <a href="../bytes.html">Bytes</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L81" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="salt:Bytes-instance-method"> <h3 class="signature">def <strong>salt</strong> : <a href="../bytes.html">Bytes</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L82" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="to_s(io:IO):Nil-instance-method"> <h3 class="signature">def <strong>to_s</strong>(io : <a href="../io.html">IO</a>) : <a href="../nil.html">Nil</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L115" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <div class="doc-inherited"> Description copied from class <a href="../reference.html">Reference</a> </div> <p>Appends a short String representation of this object which includes its class name and its object address.</p> <pre data-language="crystal">class Person
  def initialize(@name : String, @age : Int32)
  end
end

Person.new("John", 32).to_s # =&gt; #&lt;Person:0x10a199f20&gt;</pre> </div>   </div> <div class="entry-detail" id="to_s:String-instance-method"> <h3 class="signature">def <strong>to_s</strong> : <a href="../string.html">String</a><a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L107" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <div class="doc-inherited"> Description copied from class <a href="../object.html">Object</a> </div> <p>Returns a nicely readable and concise string representation of this object, typically intended for users.</p> <p>This method should usually <strong>not</strong> be overridden. It delegates to <code><a href="bcrypt.html#to_s%28io%3AIO%29%3ANil-instance-method">#to_s(IO)</a></code> which can be overridden for custom implementations.</p> <p>Also see <code><a href="bcrypt.html#inspect%28io%3AIO%29%3ANil-instance-method">#inspect</a></code>.</p> </div>   </div> <div class="entry-detail" id="to_slice(*args,**options)-instance-method"> <h3 class="signature">def <strong>to_slice</strong>(*args, **options)<a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L123" target="_blank" class="view-source">Source</a>
</h3>   </div> <div class="entry-detail" id="to_slice(*args,**options,&amp;)-instance-method"> <h3 class="signature">def <strong>to_slice</strong>(*args, **options, &amp;)<a href="https://github.com/crystal-lang/crystal/blob/0cef61e51/src/crypto/bcrypt.cr#L123" target="_blank" class="view-source">Source</a>
</h3>   </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2024 Manas Technology Solutions.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://crystal-lang.org/api/1.13.1/Crypto/Bcrypt.html" class="_attribution-link">https://crystal-lang.org/api/1.13.1/Crypto/Bcrypt.html</a>
  </p>
</div>
