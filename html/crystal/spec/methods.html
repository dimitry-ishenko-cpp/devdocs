<h1 class="type-name"> module Spec::<wbr>Methods </wbr>
</h1> <h2>  Defined in: </h2> <a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/iterate.cr#L1" target="_blank"> spec/helpers/iterate.cr </a> <br> <a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/string.cr#L1" target="_blank"> spec/helpers/string.cr </a> <br> <a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L1" target="_blank"> spec/methods.cr </a> <br> <h2>  Macro Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#assert_iterates_iterator%28expected%2Cmethod%2C%2A%2Cinfinite%3Dfalse%29-macro" class="signature"><strong>assert_iterates_iterator</strong>(expected, method, *, infinite = false)</a> <div class="summary"><p>Calls <em>method</em> expecting an iterator and compares iterated values with <em>expected</em>.</p></div> </li> <li class="entry-summary"> <a href="#assert_iterates_yielding%28expected%2Cmethod%2C%2A%2Cinfinite%3Dfalse%2Ctuple%3Dfalse%29-macro" class="signature"><strong>assert_iterates_yielding</strong>(expected, method, *, infinite = false, tuple = false)</a> <div class="summary"><p>Calls <em>method</em> with a block and compares yielded values with <em>expected</em>.</p></div> </li> <li class="entry-summary"> <a href="#assert_prints%28call%2C%2A%2Cshouldexpectation%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-macro" class="signature"><strong>assert_prints</strong>(call, *, should expectation, file = __FILE__, line = __LINE__)</a> <div class="summary"><p>Asserts that the given <em>call</em> and its <code><a href="../io.html">IO</a></code>-accepting variant both match the given <em>expectation</em>, used to test string printing.</p></div> </li> <li class="entry-summary"> <a href="#assert_prints%28call%2Cstr%2C%2A%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-macro" class="signature"><strong>assert_prints</strong>(call, str, *, file = __FILE__, line = __LINE__)</a> <div class="summary"><p>Asserts that the given <em>call</em> and its <code><a href="../io.html">IO</a></code>-accepting variant both produce the given string <em>str</em>.</p></div> </li> <li class="entry-summary"> <a href="#it_iterates%28description%2Cexpected%2Cmethod%2C%2A%2Cinfinite%3Dfalse%2Ctuple%3Dfalse%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-macro" class="signature"><strong>it_iterates</strong>(description, expected, method, *, infinite = false, tuple = false, file = __FILE__, line = __LINE__)</a> <div class="summary"><p>Spec helper for generic iteration methods which tests both yielding and iterator overloads.</p></div> </li> </ul> <h2>  Instance Method Summary </h2> <ul class="list-summary"> <li class="entry-summary"> <a href="#after_all%28%26block%29-instance-method" class="signature"><strong>#after_all</strong>(&amp;block)</a> <div class="summary"><p>Executes the given block after the last spec in the current context runs.</p></div> </li> <li class="entry-summary"> <a href="#after_each%28%26block%29-instance-method" class="signature"><strong>#after_each</strong>(&amp;block)</a> <div class="summary"><p>Executes the given block after each spec in the current context runs.</p></div> </li> <li class="entry-summary"> <a href="#around_all%28%26block%3AExampleGroup%3A%3AProcsy-%3E%29-instance-method" class="signature"><strong>#around_all</strong>(&amp;block : ExampleGroup::Procsy -&gt; )</a> <div class="summary"><p>Executes the given block when the current context runs.</p></div> </li> <li class="entry-summary"> <a href="#around_each%28%26block%3AExample%3A%3AProcsy-%3E%29-instance-method" class="signature"><strong>#around_each</strong>(&amp;block : Example::Procsy -&gt; )</a> <div class="summary"><p>Executes the given block when each spec in the current context runs.</p></div> </li> <li class="entry-summary"> <a href="#before_all%28%26block%29-instance-method" class="signature"><strong>#before_all</strong>(&amp;block)</a> <div class="summary"><p>Executes the given block before the first spec in the current context runs.</p></div> </li> <li class="entry-summary"> <a href="#before_each%28%26block%29-instance-method" class="signature"><strong>#before_each</strong>(&amp;block)</a> <div class="summary"><p>Executes the given block before each spec in the current context runs.</p></div> </li> <li class="entry-summary"> <a href="#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method" class="signature"><strong>#context</strong>(description = nil, file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : Bool = false, tags : String | Enumerable(String) | Nil = nil, &amp;block)</a> <div class="summary"><p>Defines an example group that establishes a specific context, like <em>empty array</em> versus <em>array with elements</em>.</p></div> </li> <li class="entry-summary"> <a href="#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method" class="signature"><strong>#describe</strong>(description = nil, file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : Bool = false, tags : String | Enumerable(String) | Nil = nil, &amp;block)</a> <div class="summary"><p>Defines an example group that describes a unit to be tested.</p></div> </li> <li class="entry-summary"> <a href="#fail%28msg%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-instance-method" class="signature"><strong>#fail</strong>(msg, file = __FILE__, line = __LINE__)</a> <div class="summary"><p>Fails an example.</p></div> </li> <li class="entry-summary"> <a href="#it%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method" class="signature"><strong>#it</strong>(description = "assert", file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : Bool = false, tags : String | Enumerable(String) | Nil = nil, &amp;block)</a> <div class="summary"><p>Defines a concrete test case.</p></div> </li> <li class="entry-summary"> <a href="#pending%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26%29-instance-method" class="signature"><strong>#pending</strong>(description = "assert", file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : Bool = false, tags : String | Enumerable(String) | Nil = nil, &amp;)</a> <div class="summary"><p>Defines a pending test case.</p></div> </li> <li class="entry-summary"> <a href="#pending%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%29-instance-method" class="signature"><strong>#pending</strong>(description = "assert", file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : Bool = false, tags : String | Enumerable(String) | Nil = nil)</a> <div class="summary"><p>Defines a yet-to-be-implemented pending test case</p></div> </li> <li class="entry-summary"> <a href="#pending%21%28msg%3D%22Cannotrunexample%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-instance-method" class="signature"><strong>#pending!</strong>(msg = "Cannot run example", file = __FILE__, line = __LINE__)</a> <div class="summary"><p>Marks the current example pending</p></div> </li> </ul>  <h2>  Macro Detail </h2> <div class="entry-detail" id="assert_iterates_iterator(expected,method,*,infinite=false)-macro"> <h3 class="signature">macro <strong>assert_iterates_iterator</strong>(expected, method, *, infinite = false)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/iterate.cr#L75" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Calls <em>method</em> expecting an iterator and compares iterated values with <em>expected</em>.</p> <p>See <code><a href="methods.html#it_iterates%28description%2Cexpected%2Cmethod%2C%2A%2Cinfinite%3Dfalse%2Ctuple%3Dfalse%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-macro">.it_iterates</a></code> for details.</p> </div>   </div> <div class="entry-detail" id="assert_iterates_yielding(expected,method,*,infinite=false,tuple=false)-macro"> <h3 class="signature">macro <strong>assert_iterates_yielding</strong>(expected, method, *, infinite = false, tuple = false)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/iterate.cr#L48" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Calls <em>method</em> with a block and compares yielded values with <em>expected</em>.</p> <p>See <code><a href="methods.html#it_iterates%28description%2Cexpected%2Cmethod%2C%2A%2Cinfinite%3Dfalse%2Ctuple%3Dfalse%2Cfile%3D__FILE__%2Cline%3D__LINE__%29-macro">.it_iterates</a></code> for details.</p> </div>   </div> <div class="entry-detail" id="assert_prints(call,*,shouldexpectation,file=__FILE__,line=__LINE__)-macro"> <h3 class="signature">macro <strong>assert_prints</strong>(call, *, should expectation, file = __FILE__, line = __LINE__)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/string.cr#L18" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Asserts that the given <em>call</em> and its <code><a href="../io.html">IO</a></code>-accepting variant both match the given <em>expectation</em>, used to test string printing.</p> <p>Given a call of the form <code>foo.bar(*args, **opts)</code>, this tests the following cases:</p> <ul> <li>The call itself. Additionally this call must return a <code><a href="../string.html">String</a></code>.</li> <li>
<code><a href="../string.html#build%28capacity%3D64%2C%26%29%3Aself-class-method">String.build</a> { |io| foo.bar(io, *args, **opts) }</code>, which constructs a <code><a href="../string.html">String</a></code> via an <code><a href="../io.html">IO</a></code> overload.</li> <li>
<code>io = ...; foo.bar(io, *args, **opts); io.to_s</code>, where <code>io</code> is an <code><a href="../io.html">IO</a></code> configured to use the UTF-16 encoding, and contents written to it are decoded back into a UTF-8 <code><a href="../string.html">String</a></code>. This case ensures that the <code><a href="../io.html">IO</a></code> overload does not produce malformed UTF-8 byte sequences via a non-default encoding. This case is skipped if the <code>without_iconv</code> flag is set.</li> </ul> <p>The overload that accepts a <em>str</em> argument is usually easier to work with.</p> </div>   </div> <div class="entry-detail" id="assert_prints(call,str,*,file=__FILE__,line=__LINE__)-macro"> <h3 class="signature">macro <strong>assert_prints</strong>(call, str, *, file = __FILE__, line = __LINE__)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/string.cr#L85" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Asserts that the given <em>call</em> and its <code><a href="../io.html">IO</a></code>-accepting variant both produce the given string <em>str</em>.</p> <p>Equivalent to <code>assert_prints call, should: eq(str)</code>. <em>str</em> must be validly encoded in UTF-8.</p> <pre data-language="crystal">require "spec"
require "spec/helpers/string"

it "prints integers with `Int#to_s`" do
  assert_prints 123.to_s, "123"
  assert_prints 123.to_s(16), "7b"
end</pre> <p>Methods that do not follow the convention of <code><a href="../io.html">IO</a></code>-accepting and <code><a href="../string.html">String</a></code>-returning overloads can also be tested as long as suitable wrapper methods are defined:</p> <pre data-language="crystal">require "spec"
require "spec/helpers/string"

private def fprintf(format, *args)
  sprintf(format, *args)
end

private def fprintf(io : IO, format, *args)
  io.printf(format, *args)
end

it "prints with `sprintf` and `IO#printf`" do
  assert_prints fprintf("%d", 123), "123"
  assert_prints fprintf("%x %b", 123, 6), "7b 110"
end</pre> </div>   </div> <div class="entry-detail" id="it_iterates(description,expected,method,*,infinite=false,tuple=false,file=__FILE__,line=__LINE__)-macro"> <h3 class="signature">macro <strong>it_iterates</strong>(description, expected, method, *, infinite = false, tuple = false, file = __FILE__, line = __LINE__)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/helpers/iterate.cr#L36" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Spec helper for generic iteration methods which tests both yielding and iterator overloads.</p> <p>This helper creates two spec examples named <em>description</em> with suffixes <code>" yielding"</code> and <code>" iterator"</code>. The yielding example calls <em>method</em> with a block and expects the iteration elements to be yielded to the block. The iterator example calls <em>method</em> without a block and expects it to return an <code><a href="../iterator.html">Iterator</a></code> which it then consumes.</p> <p>The iterated elements are collected in an array and compared to <em>expected</em>, ensuring type-equality of the elements.</p> <p>By default, both examples make sure that the iteration is finished after iterating all elements from <em>expected</em>. If the iteration is infinite, passing <code>infinite: true</code> skips that check and allows to test a finite sample of an infinite iteration.</p> <pre data-language="crystal">require "spec/helpers/iterate"

it_iterates "Array#each", [1, 2, 3], (1..3).each
it_iterates "infinite #cycle", [1, 2, 3, 1, 2, 3, 1], (1..3).cycle, infinite: true</pre> <p>If the iteration elements are tuples (i.e. multiple values), the yielding variant by default only catches the first value because of the block argument mechanics. Passing <code>tuple: true</code> ensures all yielded arguments are collected using a splat.</p> <pre data-language="crystal">require "spec/helpers/iterate"

it_iterates "Array#each_with_index", [{1, 0}, {2, 1}, {3, 2}], (1..3).each_with_index, tuple: true</pre> </div>   </div> <h2>  Instance Method Detail </h2> <div class="entry-detail" id="after_all(&amp;block)-instance-method"> <h3 class="signature">def <strong>after_all</strong>(&amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L216" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Executes the given block after the last spec in the current context runs.</p> <p>A context is defined by <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> blocks, or outside of them it's the root context. This is independent of the source location the specs and this hook are defined.</p> <p>If multiple blocks are registered on the same context, they are executed in order of definition.</p> <pre data-language="crystal">require "spec"

it "sample_a" { }

describe "nested_context" do
  after_all do
    puts "runs at end of nested_context"
  end

  it "sample_b" { }
end</pre> </div>   </div> <div class="entry-detail" id="after_each(&amp;block)-instance-method"> <h3 class="signature">def <strong>after_each</strong>(&amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L156" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Executes the given block after each spec in the current context runs.</p> <p>A context is defined by <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> blocks, or outside of them it's the root context. Nested contexts inherit the <code>*_each</code> blocks of their ancestors.</p> <p>If multiple blocks are registered for the same spec, the blocks defined in the outermost context go first. Blocks on the same context are executed in order of definition.</p> <pre data-language="crystal">require "spec"

it "sample_a" { }

describe "nested_context" do
  after_each do
    puts "runs after sample_b"
  end

  it "sample_b" { }
end</pre> </div>   </div> <div class="entry-detail" id="around_all(&amp;block:ExampleGroup::Procsy-&gt;)-instance-method"> <h3 class="signature">def <strong>around_all</strong>(&amp;block : <a href="examplegroup/procsy.html">ExampleGroup::Procsy</a> -&gt; )<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L299" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Executes the given block when the current context runs.</p> <p>The block must call <code>run</code> on the given <code>Context::Procsy</code> object.</p> <p>This is essentially a <code><a href="methods.html#before_all%28%26block%29-instance-method">#before_all</a></code> and <code><a href="methods.html#after_all%28%26block%29-instance-method">#after_all</a></code> hook combined into one. It is useful for example when setup and teardown steps need shared state.</p> <p>A context is defined by <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> blocks. This hook does not work outside such a block (i.e. in the root context).</p> <p>If multiple blocks are registered for the same spec, the blocks defined in the outermost context go first. Blocks on the same context are executed in order of definition.</p> <pre data-language="crystal">require "spec"

describe "main_context" do
  around_each do |example|
    puts "runs at beginning of main_context"
    example.run
    puts "runs at end of main_context"
  end

  it "sample_a" { }

  describe "nested_context" do
    around_each do |example|
      puts "runs at beginning of nested_context"
      example.run
      puts "runs at end of nested_context"
    end

    it "sample_b" { }
  end
end</pre> </div>   </div> <div class="entry-detail" id="around_each(&amp;block:Example::Procsy-&gt;)-instance-method"> <h3 class="signature">def <strong>around_each</strong>(&amp;block : <a href="example/procsy.html">Example::Procsy</a> -&gt; )<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L254" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Executes the given block when each spec in the current context runs.</p> <p>The block must call <code>run</code> on the given <code><a href="example/procsy.html">Example::Procsy</a></code> object.</p> <p>This is essentially a <code><a href="methods.html#before_each%28%26block%29-instance-method">#before_each</a></code> and <code><a href="methods.html#after_each%28%26block%29-instance-method">#after_each</a></code> hook combined into one. It is useful for example when setup and teardown steps need shared state.</p> <p>A context is defined by <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> blocks, or outside of them it's the root context. Nested contexts inherit the <code>*_each</code> blocks of their ancestors.</p> <p>If multiple blocks are registered for the same spec, the blocks defined in the outermost context go first. Blocks on the same context are executed in order of definition.</p> <pre data-language="crystal">require "spec"

it "sample_a" { }

describe "nested_context" do
  around_each do |example|
    puts "runs before sample_b"
    example.run
    puts "runs after sample_b"
  end

  it "sample_b" { }
end</pre> </div>   </div> <div class="entry-detail" id="before_all(&amp;block)-instance-method"> <h3 class="signature">def <strong>before_all</strong>(&amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L186" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Executes the given block before the first spec in the current context runs.</p> <p>A context is defined by <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> blocks, or outside of them it's the root context. This is independent of the source location the specs and this hook are defined.</p> <p>If multiple blocks are registered on the same context, they are executed in order of definition.</p> <pre data-language="crystal">require "spec"

it "sample_a" { }

describe "nested_context" do
  before_all do
    puts "runs at start of nested_context"
  end

  it "sample_b" { }
end</pre> </div>   </div> <div class="entry-detail" id="before_each(&amp;block)-instance-method"> <h3 class="signature">def <strong>before_each</strong>(&amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L126" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Executes the given block before each spec in the current context runs.</p> <p>A context is defined by <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> blocks, or outside of them it's the root context. Nested contexts inherit the <code>*_each</code> blocks of their ancestors.</p> <p>If multiple blocks are registered for the same spec, the blocks defined in the outermost context go first. Blocks on the same context are executed in order of definition.</p> <pre data-language="crystal">require "spec"

it "sample_a" { }

describe "nested_context" do
  before_each do
    puts "runs before sample_b"
  end

  it "sample_b" { }
end</pre> </div>   </div> <div class="entry-detail" id="context(description=nil,file=__FILE__,line=__LINE__,end_line=__END_LINE__,focus:Bool=false,tags:String|Enumerable(String)|Nil=nil,&amp;block)-instance-method"> <h3 class="signature">def <strong>context</strong>(description = nil, file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : <a href="../bool.html">Bool</a> = false, tags : <a href="../string.html">String</a> | <a href="../enumerable.html">Enumerable</a>(<a href="../string.html">String</a>) | <a href="../nil.html">Nil</a> = nil, &amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L30" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Defines an example group that establishes a specific context, like <em>empty array</em> versus <em>array with elements</em>. Inside <em>&amp;block</em> examples are defined by <code><a href="methods.html#it%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#it</a></code> or <code><a href="methods.html#pending%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26%29-instance-method">#pending</a></code>.</p> <p>It is functionally equivalent to <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code>.</p> <p>If <code>focus</code> is <code>true</code>, only this <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code>, and others marked with <code>focus: true</code>, will run.</p> </div>   </div> <div class="entry-detail" id="describe(description=nil,file=__FILE__,line=__LINE__,end_line=__END_LINE__,focus:Bool=false,tags:String|Enumerable(String)|Nil=nil,&amp;block)-instance-method"> <h3 class="signature">def <strong>describe</strong>(description = nil, file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : <a href="../bool.html">Bool</a> = false, tags : <a href="../string.html">String</a> | <a href="../enumerable.html">Enumerable</a>(<a href="../string.html">String</a>) | <a href="../nil.html">Nil</a> = nil, &amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L19" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Defines an example group that describes a unit to be tested. Inside <em>&amp;block</em> examples are defined by <code><a href="methods.html#it%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#it</a></code> or <code><a href="methods.html#pending%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26%29-instance-method">#pending</a></code>.</p> <p>Several <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> blocks can be nested.</p> <p>Example:</p> <pre data-language="crystal">require "spec"

describe "Int32" do
  describe "+" do
    it "adds" { (1 + 1).should eq 2 }
  end
end</pre> <p>If <code>focus</code> is <code>true</code>, only this <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code>, and others marked with <code>focus: true</code>, will run.</p> </div>   </div> <div class="entry-detail" id="fail(msg,file=__FILE__,line=__LINE__)-instance-method"> <h3 class="signature">def <strong>fail</strong>(msg, file = __FILE__, line = __LINE__)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L81" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Fails an example.</p> <p>This method can be used to manually fail an example defined in an <code><a href="methods.html#it%28description%3D%22assert%22%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#it</a></code> block.</p> </div>   </div> <div class="entry-detail" id='it(description="assert",file=__FILE__,line=__LINE__,end_line=__END_LINE__,focus:Bool=false,tags:String|Enumerable(String)|Nil=nil,&amp;block)-instance-method'> <h3 class="signature">def <strong>it</strong>(description = "assert", file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : <a href="../bool.html">Bool</a> = false, tags : <a href="../string.html">String</a> | <a href="../enumerable.html">Enumerable</a>(<a href="../string.html">String</a>) | <a href="../nil.html">Nil</a> = nil, &amp;block)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L48" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Defines a concrete test case.</p> <p>The test is performed by the block supplied to <em>&amp;block</em>.</p> <p>Example:</p> <pre data-language="crystal">require "spec"

it "adds" { (1 + 1).should eq 2 }</pre> <p>It is usually used inside a <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> section.</p> <p>If <code>focus</code> is <code>true</code>, only this test, and others marked with <code>focus: true</code>, will run.</p> </div>   </div> <div class="entry-detail" id='pending(description="assert",file=__FILE__,line=__LINE__,end_line=__END_LINE__,focus:Bool=false,tags:String|Enumerable(String)|Nil=nil,&amp;)-instance-method'> <h3 class="signature">def <strong>pending</strong>(description = "assert", file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : <a href="../bool.html">Bool</a> = false, tags : <a href="../string.html">String</a> | <a href="../enumerable.html">Enumerable</a>(<a href="../string.html">String</a>) | <a href="../nil.html">Nil</a> = nil, &amp;)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L67" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Defines a pending test case.</p> <p><em>&amp;block</em> is never evaluated. It can be used to describe behaviour that is not yet implemented.</p> <p>Example:</p> <pre data-language="crystal">require "spec"

pending "check cat" { cat.alive? }</pre> <p>It is usually used inside a <code><a href="methods.html#describe%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#describe</a></code> or <code><a href="methods.html#context%28description%3Dnil%2Cfile%3D__FILE__%2Cline%3D__LINE__%2Cend_line%3D__END_LINE__%2Cfocus%3ABool%3Dfalse%2Ctags%3AString%7CEnumerable%28String%29%7CNil%3Dnil%2C%26block%29-instance-method">#context</a></code> section.</p> <p>If <code>focus</code> is <code>true</code>, only this test, and others marked with <code>focus: true</code>, will run.</p> </div>   </div> <div class="entry-detail" id='pending(description="assert",file=__FILE__,line=__LINE__,end_line=__END_LINE__,focus:Bool=false,tags:String|Enumerable(String)|Nil=nil)-instance-method'> <h3 class="signature">def <strong>pending</strong>(description = "assert", file = __FILE__, line = __LINE__, end_line = __END_LINE__, focus : <a href="../bool.html">Bool</a> = false, tags : <a href="../string.html">String</a> | <a href="../enumerable.html">Enumerable</a>(<a href="../string.html">String</a>) | <a href="../nil.html">Nil</a> = nil)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L74" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Defines a yet-to-be-implemented pending test case</p> <p>If <code>focus</code> is <code>true</code>, only this test, and others marked with <code>focus: true</code>, will run.</p> </div>   </div> <div class="entry-detail" id='pending!(msg="Cannotrunexample",file=__FILE__,line=__LINE__)-instance-method'> <h3 class="signature">def <strong>pending!</strong>(msg = "Cannot run example", file = __FILE__, line = __LINE__)<a href="https://github.com/crystal-lang/crystal/blob/0aa30372c/src/spec/methods.cr#L99" target="_blank" class="view-source">Source</a>
</h3> <div class="doc"> <p>Marks the current example pending</p> <p>In case an example needs to be pending on some condition that requires executing it, this allows to mark it as such rather than letting it fail or never run.</p> <pre data-language="crystal">require "spec"

it "test git" do
  cmd = Process.find_executable("git")
  pending!("git is not available") unless cmd
  cmd.should end_with("git")
end</pre> </div>   </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2024 Manas Technology Solutions.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://crystal-lang.org/api/1.11.1/Spec/Methods.html" class="_attribution-link">https://crystal-lang.org/api/1.11.1/Spec/Methods.html</a>
  </p>
</div>
