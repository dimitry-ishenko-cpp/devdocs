  <h1 id="getting-started-with-ngoptimizedimage">Getting started with NgOptimizedImage</h1> <p>The <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> directive makes it easy to adopt performance best practices for loading images.</p> <p>The directive ensures that the loading of the <a href="http://web.dev/lcp">Largest Contentful Paint (LCP)</a> image is prioritized by:</p> <ul> <li>Automatically setting the <code>fetchpriority</code> attribute on the <code>&lt;<a href="../api/common/ngoptimizedimage.html" class="code-anchor">img</a>&gt;</code> tag</li> <li>Lazy loading other images by default</li> <li>Automatically generating a preconnect link tag in the document head</li> <li>Automatically generating a <code>srcset</code> attribute</li> <li>Generating a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload">preload hint</a> if app is using SSR</li> </ul> <p>In addition to optimizing the loading of the LCP image, <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> enforces a number of image best practices, such as:</p> <ul> <li>Using <a href="https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options">image CDN URLs to apply image optimizations</a>
</li> <li>Preventing layout shift by requiring <code>width</code> and <code>height</code>
</li> <li>Warning if <code>width</code> or <code>height</code> have been set incorrectly</li> <li>Warning if the image will be visually distorted when rendered</li> </ul> <p><strong>Note: Although the <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> directive was made a stable feature in Angular version 15, it has been backported and is available as a stable feature in versions 13.4.0 and 14.3.0 as well. </strong></p> <h2 id="getting-started">Getting Started</h2> <h4 id="step-1-import-ngoptimizedimage">Step 1: Import NgOptimizedImage</h4> <pre format="typescript" data-language="typescript">import { NgOptimizedImage } from '@angular/common'</pre> <p>The directive is defined as a <a href="standalone-components.html">standalone directive</a>, so components should import it directly.</p> <h4 id="step-2-optional-set-up-a-loader">Step 2: (Optional) Set up a Loader</h4> <p>An image loader is not <strong>required</strong> in order to use NgOptimizedImage, but using one with an image CDN enables powerful performance features, including automatic <code>srcset</code>s for your images.</p> <p>A brief guide for setting up a loader can be found in the <a href="image-directive.html#configuring-an-image-loader-for-ngoptimizedimage">Configuring an Image Loader</a> section at the end of this page.</p> <h4 id="step-3-enable-the-directive">Step 3: Enable the directive</h4> <p>To activate the <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> directive, replace your image's <code>src</code> attribute with <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">ngSrc</a></code>.</p> <pre format="typescript" data-language="typescript">&lt;img ngSrc="cat.jpg"&gt;</pre> <p>If you're using a <a href="image-directive.html#built-in-loaders">built-in third-party loader</a>, make sure to omit the base URL path from <code>src</code>, as that will be prepended automatically by the loader.</p> <h4 id="step-4-mark-images-as-priority">Step 4: Mark images as <code>priority</code>
</h4> <p>Always mark the <a href="https://web.dev/lcp/#what-elements-are-considered">LCP image</a> on your page as <code>priority</code> to prioritize its loading.</p> <pre format="typescript" data-language="typescript">&lt;img ngSrc="cat.jpg" width="400" height="200" priority&gt;</pre> <p>Marking an image as <code>priority</code> applies the following optimizations:</p> <ul> <li>Sets <code>fetchpriority=high</code> (read more about priority hints <a href="https://web.dev/priority-hints">here</a>)</li> <li>Sets <code>loading=eager</code> (read more about native lazy loading <a href="https://web.dev/browser-level-image-lazy-loading">here</a>)</li> <li>Automatically generates a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Link_types/preload">preload link element</a> if <a href="ssr.html">rendering on the server</a>.</li> </ul> <p>Angular logs an error during development if the LCP element is an image that does not have the <code>priority</code> attribute, as this can hurt loading performance significantly. A pageâ€™s LCP element can vary based on a number of factors - such as the dimensions of a user's screen, so a page may have multiple images that should be marked <code>priority</code>. See <a href="https://web.dev/css-web-vitals/#images-and-largest-contentful-paint-lcp">CSS for Web Vitals</a> for more details.</p> <h4 id="step-5-include-height-and-width">Step 5: Include Height and Width</h4> <p>In order to prevent <a href="https://web.dev/css-web-vitals/#images-and-layout-shifts">image-related layout shifts</a>, NgOptimizedImage requires that you specify a height and width for your image, as follows:</p> <pre format="typescript" data-language="typescript">&lt;img ngSrc="cat.jpg" width="400" height="200"&gt;</pre> <p>For <strong>responsive images</strong> (images which you've styled to grow and shrink relative to the viewport), the <code>width</code> and <code>height</code> attributes should be the intrinsic size of the image file. For responsive images it's also important to <a href="image-directive.html#responsive-images">set a value for <code>sizes</code>.</a></p> <p>For <strong>fixed size images</strong>, the <code>width</code> and <code>height</code> attributes should reflect the desired rendered size of the image. The aspect ratio of these attributes should always match the intrinsic aspect ratio of the image.</p> <p>Note: If you don't know the size of your images, consider using "fill mode" to inherit the size of the parent container, as described below:</p> <h3 id="using-fill-mode">Using <code>fill</code> mode</h3> <p>In cases where you want to have an image fill a containing element, you can use the <code>fill</code> attribute. This is often useful when you want to achieve a "background image" behavior. It can also be helpful when you don't know the exact width and height of your image, but you do have a parent container with a known size that you'd like to fit your image into (see "object-fit" below).</p> <p>When you add the <code>fill</code> attribute to your image, you do not need and should not include a <code>width</code> and <code>height</code>, as in this example:</p> <pre format="typescript" data-language="typescript">&lt;img ngSrc="cat.jpg" fill&gt;</pre> <p>You can use the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit">object-fit</a> CSS property to change how the image will fill its container. If you style your image with <code>object-fit: "contain"</code>, the image will maintain its aspect ratio and be "letterboxed" to fit the element. If you set <code>object-fit: "cover"</code>, the element will retain its aspect ratio, fully fill the element, and some content may be "cropped" off.</p> <p>See visual examples of the above at the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/object-fit">MDN object-fit documentation.</a></p> <p>You can also style your image with the <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/object-position">object-position property</a> to adjust its position within its containing element.</p> <p><strong>Important note:</strong> For the "fill" image to render properly, its parent element <strong>must</strong> be styled with <code>position: "relative"</code>, <code>position: "fixed"</code>, or <code>position: "absolute"</code>.</p> <h3 id="adjusting-image-styling">Adjusting image styling</h3> <p>Depending on the image's styling, adding <code>width</code> and <code>height</code> attributes may cause the image to render differently. <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> warns you if your image styling renders the image at a distorted aspect ratio.</p> <p>You can typically fix this by adding <code>height: auto</code> or <code>width: auto</code> to your image styles. For more information, see the <a href="https://web.dev/patterns/web-vitals-patterns/images/img-tag">web.dev article on the <code>&lt;img&gt;</code> tag</a>.</p> <p>If the <code>height</code> and <code>width</code> attribute on the image are preventing you from sizing the image the way you want with CSS, consider using "fill" mode instead, and styling the image's parent element.</p> <h2 id="performance-features">Performance Features</h2> <p>NgOptimizedImage includes a number of features designed to improve loading performance in your app. These features are described in this section.</p> <h3 id="resource-hints">Resource hints</h3> <p>A <a href="https://web.dev/preconnect-and-dns-prefetch"><code>preconnect</code> resource hint</a> for your image origin ensures that the LCP image loads as quickly as possible.</p> <p>Preconnect links are automatically generated for domains provided as an argument to a <a href="image-directive.html#configuring-an-image-loader-for-ngoptimizedimage">loader</a>. If an image origin cannot be automatically identified, and no preconnect link is detected for the LCP image, <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> will warn during development. In that case, you should manually add a resource hint to <code>index.html</code>. Within the <code>&lt;head&gt;</code> of the document, add a <code>link</code> tag with <code>rel="preload"</code>, as shown below:</p> <pre format="html" data-language="html">&lt;link rel="preconnect" href="https://my.cdn.origin" /&gt;</pre> <p>To disable preconnect warnings, inject the <code><a href="../api/common/preconnect_check_blocklist.html" class="code-anchor">PRECONNECT_CHECK_BLOCKLIST</a></code> token:</p> <pre format="typescript" data-language="typescript">providers: [
  {provide: PRECONNECT_CHECK_BLOCKLIST, useValue: 'https://your-domain.com'}
],

See more information on automatic preconnect generation [here](#why-is-a-preconnect-element-not-being-generated-for-my-image-domain).</pre> <h3 id="request-images-at-the-correct-size-with-automatic-srcset">Request images at the correct size with automatic <code>srcset</code>
</h3> <p>Defining a <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/srcset"><code>srcset</code> attribute</a> ensures that the browser requests an image at the right size for your user's viewport, so it doesn't waste time downloading an image that's too large. <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> generates an appropriate <code>srcset</code> for the image, based on the presence and value of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes"><code>sizes</code> attribute</a> on the image tag.</p> <h4 id="fixed-size-images">Fixed-size images</h4> <p>If your image should be "fixed" in size (i.e. the same size across devices, except for <a href="https://web.dev/codelab-density-descriptors/">pixel density</a>), there is no need to set a <code>sizes</code> attribute. A <code>srcset</code> can be generated automatically from the image's width and height attributes with no further input required.</p> <p>Example srcset generated: <code>&lt;<a href="../api/common/ngoptimizedimage.html" class="code-anchor">img</a> ... srcset="image-400w.jpg 1x, image-800w.jpg 2x"&gt;</code></p> <h4 id="responsive-images">Responsive images</h4> <p>If your image should be responsive (i.e. grow and shrink according to viewport size), then you will need to define a <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes"><code>sizes</code> attribute</a> to generate the <code>srcset</code>.</p> <p>If you haven't used <code>sizes</code> before, a good place to start is to set it based on viewport width. For example, if your CSS causes the image to fill 100% of viewport width, set <code>sizes</code> to <code>100vw</code> and the browser will select the image in the <code>srcset</code> that is closest to the viewport width (after accounting for pixel density). If your image is only likely to take up half the screen (ex: in a sidebar), set <code>sizes</code> to <code>50vw</code> to ensure the browser selects a smaller image. And so on.</p> <p>If you find that the above does not cover your desired image behavior, see the documentation on <a href="image-directive.html#advanced-sizes-values">advanced sizes values</a>.</p> <p>By default, the responsive breakpoints are:</p> <p><code>[16, 32, 48, 64, 96, 128, 256, 384, 640, 750, 828, 1080, 1200, 1920, 2048, 3840]</code></p> <p>If you would like to customize these breakpoints, you can do so using the <code><a href="../api/common/image_config.html" class="code-anchor">IMAGE_CONFIG</a></code> provider:</p> <pre format="typescript" data-language="typescript">providers: [
  {
    provide: IMAGE_CONFIG,
    useValue: {
      breakpoints: [16, 48, 96, 128, 384, 640, 750, 828, 1080, 1200, 1920]
    }
  },
],</pre> <p>If you would like to manually define a <code>srcset</code> attribute, you can provide your own using the <code>ngSrcset</code> attribute:</p> <pre format="html" data-language="html">&lt;img ngSrc="hero.jpg" ngSrcset="100w, 200w, 300w"&gt;</pre> <p>If the <code>ngSrcset</code> attribute is present, <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> generates and sets the <code>srcset</code> based on the sizes included. Do not include image file names in <code>ngSrcset</code> - the directive infers this information from <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">ngSrc</a></code>. The directive supports both width descriptors (e.g. <code>100w</code>) and density descriptors (e.g. <code>1x</code>).</p> <pre format="html" data-language="html">&lt;img ngSrc="hero.jpg" ngSrcset="100w, 200w, 300w" sizes="50vw"&gt;</pre> <h3 id="disabling-automatic-srcset-generation">Disabling automatic srcset generation</h3> <p>To disable srcset generation for a single image, you can add the <code>disableOptimizedSrcset</code> attribute on the image:</p> <pre format="html" data-language="html">&lt;img ngSrc="about.jpg" disableOptimizedSrcset&gt;</pre> <h3 id="disabling-image-lazy-loading">Disabling image lazy loading</h3> <p>By default, <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> sets <code>loading=lazy</code> for all images that are not marked <code>priority</code>. You can disable this behavior for non-priority images by setting the <code>loading</code> attribute. This attribute accepts values: <code>eager</code>, <code>auto</code>, and <code>lazy</code>. <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/loading#value">See the documentation for the standard image <code>loading</code> attribute for details</a>.</p> <pre format="html" data-language="html">&lt;img ngSrc="cat.jpg" width="400" height="200" loading="eager"&gt;</pre> <h3 id="advanced-sizes-values">Advanced 'sizes' values</h3> <p>You may want to have images displayed at varying widths on differently-sized screens. A common example of this pattern is a grid- or column-based layout that renders a single column on mobile devices, and two columns on larger devices. You can capture this behavior in the <code>sizes</code> attribute, using a "media query" syntax, such as the following:</p> <pre format="html" data-language="html">&lt;img ngSrc="cat.jpg" width="400" height="200" sizes="(max-width: 768px) 100vw, 50vw"&gt;</pre> <p>The <code>sizes</code> attribute in the above example says "I expect this image to be 100 percent of the screen width on devices under 768px wide. Otherwise, I expect it to be 50 percent of the screen width.</p> <p>For additional information about the <code>sizes</code> attribute, see <a href="https://web.dev/learn/design/responsive-images/#sizes">web.dev</a> or <a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLImageElement/sizes">MDN</a>.</p> <h2 id="configuring-an-image-loader-for-ngoptimizedimage">Configuring an image loader for <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code>
</h2> <p>A "loader" is a function that generates an <a href="https://web.dev/image-cdns/#how-image-cdns-use-urls-to-indicate-optimization-options">image transformation URL</a> for a given image file. When appropriate, <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> sets the size, format, and image quality transformations for an image.</p> <p><code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> provides both a generic loader that applies no transformations, as well as loaders for various third-party image services. It also supports writing your own custom loader.</p> <table> <thead> <tr> <th align="left">Loader type</th> <th align="left">Behavior</th> </tr> </thead> <tbody> <tr> <td align="left">Generic loader</td> <td align="left">The URL returned by the generic loader will always match the value of <code>src</code>. In other words, this loader applies no transformations. Sites that use Angular to serve images are the primary intended use case for this loader.</td> </tr> <tr> <td align="left">Loaders for third-party image services</td> <td align="left">The URL returned by the loaders for third-party image services will follow API conventions used by that particular image service.</td> </tr> <tr> <td align="left">Custom loaders</td> <td align="left">A custom loader's behavior is defined by its developer. You should use a custom loader if your image service isn't supported by the loaders that come preconfigured with <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code>.</td> </tr> </tbody> </table> <p>Based on the image services commonly used with Angular applications, <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> provides loaders preconfigured to work with the following image services:</p> <table> <thead> <tr> <th align="left">Image Service</th> <th align="left">Angular API</th> <th align="left">Documentation</th> </tr> </thead> <tbody> <tr> <td align="left">Cloudflare Image Resizing</td> <td align="left"><code><a href="../api/common/providecloudflareloader.html" class="code-anchor">provideCloudflareLoader</a></code></td> <td align="left"><a href="https://developers.cloudflare.com/images/image-resizing/">Documentation</a></td> </tr> <tr> <td align="left">Cloudinary</td> <td align="left"><code><a href="../api/common/providecloudinaryloader.html" class="code-anchor">provideCloudinaryLoader</a></code></td> <td align="left"><a href="https://cloudinary.com/documentation/resizing_and_cropping">Documentation</a></td> </tr> <tr> <td align="left">ImageKit</td> <td align="left"><code><a href="../api/common/provideimagekitloader.html" class="code-anchor">provideImageKitLoader</a></code></td> <td align="left"><a href="https://docs.imagekit.io/">Documentation</a></td> </tr> <tr> <td align="left">Imgix</td> <td align="left"><code><a href="../api/common/provideimgixloader.html" class="code-anchor">provideImgixLoader</a></code></td> <td align="left"><a href="https://docs.imgix.com/">Documentation</a></td> </tr> </tbody> </table> <p>To use the <strong>generic loader</strong> no additional code changes are necessary. This is the default behavior.</p> <h3 id="built-in-loaders">Built-in Loaders</h3> <p>To use an existing loader for a <strong>third-party image service</strong>, add the provider factory for your chosen service to the <code>providers</code> array. In the example below, the Imgix loader is used:</p> <pre format="typescript" data-language="typescript">providers: [
  provideImgixLoader('https://my.base.url/'),
],</pre> <p>The base URL for your image assets should be passed to the provider factory as an argument. For most sites, this base URL should match one of the following patterns:</p> <ul> <li><a href="https://yoursite.yourcdn.com">https://yoursite.yourcdn.com</a></li> <li><a href="https://subdomain.yoursite.com">https://subdomain.yoursite.com</a></li> <li><a href="https://subdomain.yourcdn.com/yoursite">https://subdomain.yourcdn.com/yoursite</a></li> </ul> <p>You can learn more about the base URL structure in the docs of a corresponding CDN provider.</p> <h3 id="custom-loaders">Custom Loaders</h3> <p>To use a <strong>custom loader</strong>, provide your loader function as a value for the <code><a href="../api/common/image_loader.html" class="code-anchor">IMAGE_LOADER</a></code> DI token. In the example below, the custom loader function returns a URL starting with <code>https://example.com</code> that includes <code>src</code> and <code>width</code> as URL parameters.</p> <pre format="typescript" data-language="typescript">providers: [
  {
    provide: IMAGE_LOADER,
    useValue: (config: ImageLoaderConfig) =&gt; {
      return `https://example.com/images?src=${config.src}&amp;width=${config.width}`;
    },
  },
],</pre> <p>A loader function for the <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> directive takes an object with the <code><a href="../api/common/imageloaderconfig.html" class="code-anchor">ImageLoaderConfig</a></code> type (from <code>@angular/common</code>) as its argument and returns the absolute URL of the image asset. The <code><a href="../api/common/imageloaderconfig.html" class="code-anchor">ImageLoaderConfig</a></code> object contains the <code>src</code> property, and optional <code>width</code> and <code>loaderParams</code> properties.</p> <p>Note: even though the <code>width</code> property may not always be present, a custom loader must use it to support requesting images at various widths in order for <code>ngSrcset</code> to work properly.</p> <h3 id="the-loaderparams-property">The <code>loaderParams</code> Property</h3> <p>There is an additional attribute supported by the <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> directive, called <code>loaderParams</code>, which is specifically designed to support the use of custom loaders. The <code>loaderParams</code> attribute take an object with any properties as a value, and does not do anything on its own. The data in <code>loaderParams</code> is added to the <code><a href="../api/common/imageloaderconfig.html" class="code-anchor">ImageLoaderConfig</a></code> object passed to your custom loader, and can be used to control the behavior of the loader.</p> <p>A common use for <code>loaderParams</code> is controlling advanced image CDN features.</p> <h3 id="example-custom-loader">Example custom loader</h3> <p>The following shows an example of a custom loader function. This example function concatenates <code>src</code> and <code>width</code>, and uses <code>loaderParams</code> to control a custom CDN feature for rounded corners:</p> <pre format="typescript" data-language="typescript">const myCustomLoader = (config: ImageLoaderConfig) =&gt; {
  let url = `https://example.com/images/${config.src}?`;
  let queryParams = [];
  if (config.width) {
    queryParams.push(`w=${config.width}`);
  }
  if (config.loaderParams?.roundedCorners) {
    queryParams.push('mask=corners&amp;corner-radius=5');
  }
  return url + queryParams.join('&amp;');
};</pre> <p>Note that in the above example, we've invented the 'roundedCorners' property name to control a feature of our custom loader. We could then use this feature when creating an image, as follows:</p> <pre format="html" data-language="html">&lt;img ngSrc="profile.jpg" width="300" height="300" [loaderParams]="{roundedCorners: true}"&gt;</pre> <h2 id="frequently-asked-questions">Frequently Asked Questions</h2> <h3 id="does-ngoptimizedimage-support-the-background-image-css-property">Does NgOptimizedImage support the <code>background-image</code> css property?</h3> <p>The NgOptimizedImage does not directly support the <code>background-image</code> css property, but it is designed to easily accommodate the use case of having an image as the background of another element.</p> <p>Here's a simple step-by-step process for migrating from <code>background-image</code> to <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code>. For these steps, we'll refer to the element that has an image background as the "containing element":</p> <p>1) Remove the <code>background-image</code> style from the containing element. 2) Ensure that the containing element has <code>position: "relative"</code>, <code>position: "fixed"</code>, or <code>position: "absolute"</code>. 3) Create a new image element as a child of the containing element, using <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">ngSrc</a></code> to enable the <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code> directive. 4) Give that element the <code>fill</code> attribute. Do not include a <code>height</code> and <code>width</code>. 5) If you believe this image might be your <a href="https://web.dev/lcp/">LCP element</a>, add the <code>priority</code> attribute to the image element.</p> <p>You can adjust how the background image fills the container as described in the <a href="image-directive.html#using-fill-mode">Using fill mode</a> section.</p> <h3 id="why-cant-i-use-src-with-ngoptimizedimage">Why can't I use <code>src</code> with <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">NgOptimizedImage</a></code>?</h3> <p>The <code><a href="../api/common/ngoptimizedimage.html" class="code-anchor">ngSrc</a></code> attribute was chosen as the trigger for NgOptimizedImage due to technical considerations around how images are loaded by the browser. NgOptimizedImage makes programmatic changes to the <code>loading</code> attribute--if the browser sees the <code>src</code> attribute before those changes are made, it will begin eagerly downloading the image file, and the loading changes will be ignored.</p> <h3 id="can-i-use-two-different-image-domains-in-the-same-page">Can I use two different image domains in the same page?</h3> <p>The <a href="image-directive.html#configuring-an-image-loader-for-ngoptimizedimage">image loaders</a> provider pattern is designed to be as simple as possible for the common use case of having only a single image CDN used within a component. However, it's still very possible to manage multiple image CDNs using a single provider.</p> <p>To do this, we recommend writing a <a href="image-directive.html#custom-loaders">custom image loader</a> which uses the <a href="image-directive.html#the-loaderparams-property"><code>loaderParams</code> property</a> to pass a flag that specifies which image CDN should be used, and then invokes the appropriate loader based on that flag.</p> <h3 id="why-is-a-preconnect-element-not-being-generated-for-my-image-domain">Why is a preconnect element not being generated for my image domain?</h3> <p>Preconnect generation is performed based on static analysis of your application. That means that the image domain must be directly included in the loader parameter, as in the following example:</p> <pre format="typescript" data-language="typescript">providers: [
  provideImgixLoader('https://my.base.url/'),
],</pre> <p>If you use a variable to pass the domain string to the loader, or you're not using a loader, the static analysis will not be able to identify the domain, and no preconnect link will be generated. In this case you should manually add a preconnect link to the document head, as <a href="image-directive.html#resource-hints">described above.</a>.</p>    <div class="reviewed">Last reviewed on Tue Jul 18 2023</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2023 Google, Inc.<br>Licensed under the Creative Commons Attribution License 4.0.<br>
    <a href="https://angular.io/guide/image-directive" class="_attribution-link">https://angular.io/guide/image-directive</a>
  </p>
</div>
