<h1>dojo/_base/kernel.i18n</h1>  <h2 id="summary">Summary</h2> <p>This module implements the <a href="../i18n.html">dojo/i18n</a>! plugin and the v1.6- i18n API</p>  <p>We choose to include our own plugin to leverage functionality already contained in dojo and thereby reduce the size of the plugin compared to various loader implementations. Also, this allows foreign AMD loaders to be used without their plugins.</p>             <h2 id="properties">Properties</h2>    <h3 id="1_10dojo__base_kernel_i18n_cache">cache </h3> <p class="jsdoc-inheritance">Defined by: <a href="../i18n.html">dojo/i18n</a> </p>     <h3 id="1_10dojo__base_kernel_i18n_dynamic">dynamic </h3> <p class="jsdoc-inheritance">Defined by: <a href="../i18n.html">dojo/i18n</a> </p>     <h3 id="1_10dojo__base_kernel_i18n_unitTests">unitTests </h3> <p class="jsdoc-inheritance">Defined by: <a href="../i18n.html">dojo/i18n</a> </p>    <h2 id="methods">Methods</h2>     <h3 id="1_10dojo__base_kernel_i18n_getL10nName">
<code class="functionIcon">getL10nName</code><code class="parameters">(moduleName,bundleName,locale)</code> </h3> <p class="jsdoc-inheritance">Defined by <a href="../i18n.html">dojo/i18n</a> </p>  <table> <tr> <th>Parameter</th> <th>Type</th> <th>Description</th> </tr> <tr> <td>moduleName</td> <td>undefined</td> <td> </td> </tr> <tr> <td>bundleName</td> <td>undefined</td> <td> </td> </tr> <tr> <td>locale</td> <td>undefined</td> <td> </td> </tr> </table> <p class="returnsInfo"><strong>Returns: </strong>string</p>     <h3 id="1_10dojo__base_kernel_i18n_getLocalization">
<code class="functionIcon">getLocalization</code><code class="parameters">(moduleName,bundleName,locale)</code> </h3> <p class="jsdoc-inheritance">Defined by <a href="../i18n.html">dojo/i18n</a> </p>  <table> <tr> <th>Parameter</th> <th>Type</th> <th>Description</th> </tr> <tr> <td>moduleName</td> <td>undefined</td> <td> </td> </tr> <tr> <td>bundleName</td> <td>undefined</td> <td> </td> </tr> <tr> <td>locale</td> <td>undefined</td> <td> </td> </tr> </table> <p class="returnsInfo"><strong>Returns: </strong>undefined</p>     <h3 id="1_10dojo__base_kernel_i18n_load">
<code class="functionIcon">load</code><code class="parameters">(id,require,load)</code> </h3> <p class="jsdoc-inheritance">Defined by <a href="../i18n.html">dojo/i18n</a> </p> <p>id is in one of the following formats </p> <ol> <li>
<p><path>/nls/<bundle> =&gt; load the bundle, localized to config.locale; load all bundles localized to config.extraLocale (if any); return the loaded bundle localized to config.locale.</bundle></path></p> </li> <li>
<p><path>/nls/<locale>/<bundle> =&gt; load then return the bundle localized to </bundle></locale></path></p> </li> <li>
<p><em>preload</em><path>/nls/<module>*<json array of available locales> =&gt; for config.locale and all config.extraLocale, load all bundles found in the best-matching bundle rollup. A value of 1 is returned, which is meaningless other than to say the plugin is executing the requested preloads</json></module></path></p> </li> </ol> <p>In cases 1 and 2, <path> is always normalized to an absolute module id upon entry; see normalize. In case 3, it <path> is assumed to be absolute; this is arranged by the builder. </path></path></p> <p>To load a bundle means to insert the bundle into the plugin's cache and publish the bundle value to the loader. Given <path>, <bundle>, and a particular <locale>, the cache key </locale></bundle></path></p> <pre data-language="markup"><code>&lt;path&gt;/nls/&lt;bundle&gt;/&lt;locale&gt;</code></pre> <p>will hold the value. Similarly, then plugin will publish this value to the loader by </p> <pre data-language="javascript"><code>define("&lt;path&gt;/nls/&lt;bundle&gt;/&lt;locale&gt;", &lt;bundle-value&gt;);</code></pre> <p>Given this algorithm, other machinery can provide fast load paths be preplacing values in the plugin's cache, which is public. When a load is demanded the cache is inspected before starting any loading. Explicitly placing values in the plugin cache is an advanced/experimental feature that should not be needed; use at your own risk. </p> <p>For the normal AMD algorithm, the root bundle is loaded first, which instructs the plugin what additional localized bundles are required for a particular locale. These additional locales are loaded and a mix of the root and each progressively-specific locale is returned. For example: </p> <ol> <li>
<p>The client demands "dojo/i18n!some/path/nls/someBundle</p> </li> <li>
<p>The loader demands load(some/path/nls/someBundle)</p> </li> <li>
<p>This plugin require's "some/path/nls/someBundle", which is the root bundle.</p> </li> <li>
<p>Assuming config.locale is "ab-cd-ef" and the root bundle indicates that localizations are available for "ab" and "ab-cd-ef" (note the missing "ab-cd", then the plugin requires "some/path/nls/ab/someBundle" and "some/path/nls/ab-cd-ef/someBundle"</p> </li> <li>
<p>Upon receiving all required bundles, the plugin constructs the value of the bundle ab-cd-ef as...</p> <pre data-language="javascript"><code> mixin(mixin(mixin({}, require("some/path/nls/someBundle"),
     require("some/path/nls/ab/someBundle")),
     require("some/path/nls/ab-cd-ef/someBundle"));</code></pre> </li> </ol> <p>This value is inserted into the cache and published to the loader at the key/module-id some/path/nls/someBundle/ab-cd-ef. </p> <p>The special preload signature (case 3) instructs the plugin to stop servicing all normal requests (further preload requests will be serviced) until all ongoing preloading has completed. </p> <p>The preload signature instructs the plugin that a special rollup module is available that contains one or more flattened, localized bundles. The JSON array of available locales indicates which locales are available. Here is an example: </p> <pre data-language="javascript"><code>*preload*some/path/nls/someModule*["root", "ab", "ab-cd-ef"]</code></pre> <p>This indicates the following rollup modules are available: </p> <pre data-language="javascript"><code>some/path/nls/someModule_ROOT
some/path/nls/someModule_ab
some/path/nls/someModule_ab-cd-ef</code></pre> <p>Each of these modules is a normal AMD module that contains one or more flattened bundles in a hash. For example, assume someModule contained the bundles some/bundle/path/someBundle and some/bundle/path/someOtherBundle, then some/path/nls/someModule_ab would be expressed as follows: </p> <pre data-language="javascript"><code>define({
    some/bundle/path/someBundle:&lt;value of someBundle, flattened with respect to locale ab&gt;,
    some/bundle/path/someOtherBundle:&lt;value of someOtherBundle, flattened with respect to locale ab&gt;,
});</code></pre> <p>E.g., given this design, preloading for locale=="ab" can execute the following algorithm: </p> <pre data-language="javascript"><code>require(["some/path/nls/someModule_ab"], function(rollup){
    for(var p in rollup){
        var id = p + "/ab",
        cache[id] = rollup[p];
        define(id, rollup[p]);
    }
});</code></pre> <p>Similarly, if "ab-cd" is requested, the algorithm can determine that "ab" is the best available and load accordingly. </p> <p>The builder will write such rollups for every layer if a non-empty localeList profile property is provided. Further, the builder will include the following cache entry in the cache associated with any layer. </p> <pre data-language="javascript"><code>"*now":function(r){r(['dojo/i18n!*preload*&lt;path&gt;/nls/&lt;module&gt;*&lt;JSON array of available locales&gt;']);}</code></pre> <p>The *now special cache module instructs the loader to apply the provided function to context-require with respect to the particular layer being defined. This causes the plugin to hold all normal service requests until all preloading is complete. </p> <p>Notice that this algorithm is rarely better than the standard AMD load algorithm. Consider the normal case where the target locale has a single segment and a layer depends on a single bundle: </p> <p>Without Preloads: </p> <ol> <li>Layer loads root bundle.</li> <li>bundle is demanded; plugin loads single localized bundle.</li> </ol> <p>With Preloads: </p> <ol> <li>Layer causes preloading of target bundle.</li> <li>bundle is demanded; service is delayed until preloading complete; bundle is returned.</li> </ol> <p>In each case a single transaction is required to load the target bundle. In cases where multiple bundles are required and/or the locale has multiple segments, preloads still requires a single transaction whereas the normal path requires an additional transaction for each additional bundle/locale-segment. However all of these additional transactions can be done concurrently. Owing to this analysis, the entire preloading algorithm can be discard during a build by setting the has feature dojo-preload-i18n-Api to false.</p>  <table> <tr> <th>Parameter</th> <th>Type</th> <th>Description</th> </tr> <tr> <td>id</td> <td>undefined</td> <td> </td> </tr> <tr> <td>require</td> <td>undefined</td> <td> </td> </tr> <tr> <td>load</td> <td>undefined</td> <td> </td> </tr> </table>     <h3 id="1_10dojo__base_kernel_i18n_normalize">
<code class="functionIcon">normalize</code><code class="parameters">(id,toAbsMid)</code> </h3> <p class="jsdoc-inheritance">Defined by <a href="../i18n.html">dojo/i18n</a> </p> <p>id may be relative. preload has form <code>*preload*&lt;path&gt;/nls/&lt;module&gt;*&lt;flattened locales&gt;</code> and therefore never looks like a relative</p>  <table> <tr> <th>Parameter</th> <th>Type</th> <th>Description</th> </tr> <tr> <td>id</td> <td>undefined</td> <td> </td> </tr> <tr> <td>toAbsMid</td> <td>undefined</td> <td> </td> </tr> </table> <p class="returnsInfo"><strong>Returns: </strong>undefined</p>     <h3 id="1_10dojo__base_kernel_i18n_normalizeLocale">
<code class="functionIcon">normalizeLocale</code><code class="parameters">(locale)</code> </h3> <p class="jsdoc-inheritance">Defined by <a href="../i18n.html">dojo/i18n</a> </p>  <table> <tr> <th>Parameter</th> <th>Type</th> <th>Description</th> </tr> <tr> <td>locale</td> <td>undefined</td> <td> </td> </tr> </table> <p class="returnsInfo"><strong>Returns: </strong>undefined</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2017 JS Foundation<br>Licensed under the AFL 2.1 and BSD 3-Clause licenses.<br>
    <a href="http://dojotoolkit.org/api/1.10/dojo/_base/kernel.i18n.html" class="_attribution-link">http://dojotoolkit.org/api/1.10/dojo/_base/kernel.i18n.html</a>
  </p>
</div>
