<h1>5.3. Identity Columns </h1>    <p>An identity column is a special column that is generated automatically from an implicit sequence. It can be used to generate key values.</p> <p>To create an identity column, use the <code class="literal">GENERATED ... AS IDENTITY</code> clause in <code class="command">CREATE TABLE</code>, for example:</p> <pre data-language="sql">
CREATE TABLE people (
    id bigint <strong>GENERATED ALWAYS AS IDENTITY</strong>,
    ...,
);
</pre> <p>or alternatively</p> <pre data-language="sql">
CREATE TABLE people (
    id bigint <strong>GENERATED BY DEFAULT AS IDENTITY</strong>,
    ...,
);
</pre> <p>See <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a> for more details.</p> <p>If an <code class="command">INSERT</code> command is executed on the table with the identity column and no value is explicitly specified for the identity column, then a value generated by the implicit sequence is inserted. For example, with the above definitions and assuming additional appropriate columns, writing</p> <pre data-language="sql">
INSERT INTO people (name, address) VALUES ('A', 'foo');
INSERT INTO people (name, address) VALUES ('B', 'bar');
</pre> <p>would generate values for the <code class="literal">id</code> column starting at 1 and result in the following table data:</p> <pre>
 id | name | address
----+------+---------
  1 | A    | foo
  2 | B    | bar
</pre> <p>Alternatively, the keyword <code class="literal">DEFAULT</code> can be specified in place of a value to explicitly request the sequence-generated value, like</p> <pre data-language="sql">
INSERT INTO people (id, name, address) VALUES (<strong>DEFAULT</strong>, 'C', 'baz');
</pre> <p>Similarly, the keyword <code class="literal">DEFAULT</code> can be used in <code class="command">UPDATE</code> commands.</p> <p>Thus, in many ways, an identity column behaves like a column with a default value.</p> <p>The clauses <code class="literal">ALWAYS</code> and <code class="literal">BY DEFAULT</code> in the column definition determine how explicitly user-specified values are handled in <code class="command">INSERT</code> and <code class="command">UPDATE</code> commands. In an <code class="command">INSERT</code> command, if <code class="literal">ALWAYS</code> is selected, a user-specified value is only accepted if the <code class="command">INSERT</code> statement specifies <code class="literal">OVERRIDING SYSTEM VALUE</code>. If <code class="literal">BY DEFAULT</code> is selected, then the user-specified value takes precedence. Thus, using <code class="literal">BY DEFAULT</code> results in a behavior more similar to default values, where the default value can be overridden by an explicit value, whereas <code class="literal">ALWAYS</code> provides some more protection against accidentally inserting an explicit value.</p> <p>The data type of an identity column must be one of the data types supported by sequences. (See <a class="xref" href="sql-createsequence.html" title="CREATE SEQUENCE">CREATE SEQUENCE</a>.) The properties of the associated sequence may be specified when creating an identity column (see <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a>) or changed afterwards (see <a class="xref" href="sql-altertable.html" title="ALTER TABLE">ALTER TABLE</a>).</p> <p>An identity column is automatically marked as <code class="literal">NOT NULL</code>. An identity column, however, does not guarantee uniqueness. (A sequence normally returns unique values, but a sequence could be reset, or values could be inserted manually into the identity column, as discussed above.) Uniqueness would need to be enforced using a <code class="literal">PRIMARY KEY</code> or <code class="literal">UNIQUE</code> constraint.</p> <p>In table inheritance hierarchies, identity columns and their properties in a child table are independent of those in its parent tables. A child table does not inherit identity columns or their properties automatically from the parent. During <code class="command">INSERT</code> or <code class="command">UPDATE</code>, a column is treated as an identity column if that column is an identity column in the table named in the statement, and the corresponding identity properties are applied.</p> <p>Partitions inherit identity columns from the partitioned table. They cannot have their own identity columns. The properties of a given identity column are consistent across all the partitions in the partition hierarchy.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996&ndash;2024 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/17/ddl-identity-columns.html" class="_attribution-link">https://www.postgresql.org/docs/17/ddl-identity-columns.html</a>
  </p>
</div>
