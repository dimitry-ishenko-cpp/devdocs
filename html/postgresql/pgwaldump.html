<h1>pg_waldump</h1> <p>pg_waldump — display a human-readable rendering of the write-ahead log of a PostgreSQL database cluster</p>   <h2>Synopsis</h2> <div class="cmdsynopsis"> <p id="id-1.9.5.14.4.1"><code class="command">pg_waldump</code> [<code class="option">option</code>...] [<code class="option">startseg</code> [<code class="option">endseg</code>]]</p> </div>  <div class="refsect1" id="R1-APP-PGWALDUMP-1"> <h2>Description</h2> <p><code class="command">pg_waldump</code> displays the write-ahead log (WAL) and is mainly useful for debugging or educational purposes.</p> <p>This utility can only be run by the user who installed the server, because it requires read-only access to the data directory.</p> </div> <div class="refsect1" id="id-1.9.5.14.6"> <h2>Options</h2> <p>The following command-line options control the location and format of the output:</p> <div class="variablelist"> <dl class="variablelist"> <dt><code>startseg</code></dt> <dd> <p>Start reading at the specified WAL segment file. This implicitly determines the path in which files will be searched for, and the timeline to use.</p> </dd> <dt><code>endseg</code></dt> <dd> <p>Stop after reading the specified WAL segment file.</p> </dd> <dt>
<code class="option">-b</code><code class="option">--bkp-details</code>
</dt> <dd> <p>Output detailed information about backup blocks.</p> </dd> <dt>
<code class="option">-B block</code><code class="option">--block=block</code>
</dt> <dd> <p>Only display records that modify the given block. The relation must also be provided with <code class="option">--relation</code> or <code class="option">-R</code>.</p> </dd> <dt>
<code class="option">-e end</code><code class="option">--end=end</code>
</dt> <dd> <p>Stop reading at the specified WAL location, instead of reading to the end of the log stream.</p> </dd> <dt>
<code class="option">-f</code><code class="option">--follow</code>
</dt> <dd> <p>After reaching the end of valid WAL, keep polling once per second for new WAL to appear.</p> </dd> <dt>
<code class="option">-F fork</code><code class="option">--fork=fork</code>
</dt> <dd> <p>Only display records that modify blocks in the given fork. The valid values are <code class="literal">main</code> for the main fork, <code class="literal">fsm</code> for the free space map, <code class="literal">vm</code> for the visibility map, and <code class="literal">init</code> for the init fork.</p> </dd> <dt>
<code class="option">-n limit</code><code class="option">--limit=limit</code>
</dt> <dd> <p>Display the specified number of records, then stop.</p> </dd> <dt>
<code class="option">-p path</code><code class="option">--path=path</code>
</dt> <dd> <p>Specifies a directory to search for WAL segment files or a directory with a <code class="literal">pg_wal</code> subdirectory that contains such files. The default is to search in the current directory, the <code class="literal">pg_wal</code> subdirectory of the current directory, and the <code class="literal">pg_wal</code> subdirectory of <code class="envar">PGDATA</code>.</p> </dd> <dt>
<code class="option">-q</code><code class="option">--quiet</code>
</dt> <dd> <p>Do not print any output, except for errors. This option can be useful when you want to know whether a range of WAL records can be successfully parsed but don't care about the record contents.</p> </dd> <dt>
<code class="option">-r rmgr</code><code class="option">--rmgr=rmgr</code>
</dt> <dd> <p>Only display records generated by the specified resource manager. You can specify the option multiple times to select multiple resource managers. If <code class="literal">list</code> is passed as name, print a list of valid resource manager names, and exit.</p> <p>Extensions may define custom resource managers, but pg_waldump does not load the extension module and therefore does not recognize custom resource managers by name. Instead, you can specify the custom resource managers as <code class="literal">custom###</code> where <code>###</code> is the three-digit resource manager ID. Names of this form will always be considered valid.</p> </dd> <dt>
<code class="option">-R tblspc/db/rel</code><code class="option">--relation=tblspc/db/rel</code>
</dt> <dd> <p>Only display records that modify blocks in the given relation. The relation is specified with tablespace OID, database OID, and relfilenode separated by slashes, for example <code class="literal">1234/12345/12345</code>. This is the same format used for relations in the program's output.</p> </dd> <dt>
<code class="option">-s start</code><code class="option">--start=start</code>
</dt> <dd> <p>WAL location at which to start reading. The default is to start reading the first valid WAL record found in the earliest file found.</p> </dd> <dt>
<code class="option">-t timeline</code><code class="option">--timeline=timeline</code>
</dt> <dd> <p>Timeline from which to read WAL records. The default is to use the value in <code>startseg</code>, if that is specified; otherwise, the default is 1. The value can be specified in decimal or hexadecimal, for example <code class="literal">17</code> or <code class="literal">0x11</code>.</p> </dd> <dt>
<code class="option">-V</code><code class="option">--version</code>
</dt> <dd> <p>Print the pg_waldump version and exit.</p> </dd> <dt>
<code class="option">-w</code><code class="option">--fullpage</code>
</dt> <dd> <p>Only display records that include full page images.</p> </dd> <dt>
<code class="option">-x xid</code><code class="option">--xid=xid</code>
</dt> <dd> <p>Only display records marked with the given transaction ID.</p> </dd> <dt>
<code class="option">-z</code><code class="option">--stats[=record]</code>
</dt> <dd> <p>Display summary statistics (number and size of records and full-page images) instead of individual records. Optionally generate statistics per-record instead of per-rmgr.</p> <p>If pg_waldump is terminated by signal <span class="systemitem">SIGINT</span> (<span class="keycap"><strong>Control</strong></span>+<span class="keycap"><strong>C</strong></span>), the summary of the statistics computed is displayed up to the termination point. This operation is not supported on Windows.</p> </dd> <dt><code class="option">--save-fullpage=save_path</code></dt> <dd> <p>Save full page images found in the WAL records to the <code>save_path</code> directory. The images saved are subject to the same filtering and limiting criteria as the records displayed.</p> <p>The full page images are saved with the following file name format: <code class="literal">TIMELINE-LSN.RELTABLESPACE.DATOID.RELNODE.BLKNO_FORK</code> The file names are composed of the following parts:</p> <div class="informaltable"> <table class="informaltable"> <colgroup> <col> <col> </colgroup> <thead> <tr> <th>Component</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>TIMELINE</td> <td>The timeline of the WAL segment file where the record is located formatted as one 8-character hexadecimal number <code class="literal">%08X</code>
</td> </tr> <tr> <td>LSN</td> <td>The LSN of the record with this image, formatted as two 8-character hexadecimal numbers <code class="literal">%08X-%08X</code>
</td> </tr> <tr> <td>RELTABLESPACE</td> <td>tablespace OID of the block</td> </tr> <tr> <td>DATOID</td> <td>database OID of the block</td> </tr> <tr> <td>RELNODE</td> <td>filenode of the block</td> </tr> <tr> <td>BLKNO</td> <td>block number of the block</td> </tr> <tr> <td>FORK</td> <td>The name of the fork the full page image came from, such as <code class="literal">main</code>, <code class="literal">fsm</code>, <code class="literal">vm</code>, or <code class="literal">init</code>.</td> </tr> </tbody> </table> </div> </dd> <dt>
<code class="option">-?</code><code class="option">--help</code>
</dt> <dd> <p>Show help about pg_waldump command line arguments, and exit.</p> </dd> </dl> </div> </div> <div class="refsect1" id="id-1.9.5.14.7"> <h2>Environment</h2> <div class="variablelist"> <dl class="variablelist"> <dt><code class="envar">PGDATA</code></dt> <dd> <p>Data directory; see also the <code class="option">-p</code> option.</p> </dd> <dt><code class="envar">PG_COLOR</code></dt> <dd> <p>Specifies whether to use color in diagnostic messages. Possible values are <code class="literal">always</code>, <code class="literal">auto</code> and <code class="literal">never</code>.</p> </dd> </dl> </div> </div> <div class="refsect1" id="id-1.9.5.14.8"> <h2>Notes</h2> <p>Can give wrong results when the server is running.</p> <p>Only the specified timeline is displayed (or the default, if none is specified). Records in other timelines are ignored.</p> <p>pg_waldump cannot read WAL files with suffix <code class="literal">.partial</code>. If those files need to be read, <code class="literal">.partial</code> suffix needs to be removed from the file name.</p> </div> <div class="refsect1" id="id-1.9.5.14.9"> <h2>See Also</h2>
<span class="simplelist"><a class="xref" href="wal-internals.html" title="28.6. WAL Internals">Section 28.6</a></span> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996&ndash;2024 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/17/pgwaldump.html" class="_attribution-link">https://www.postgresql.org/docs/17/pgwaldump.html</a>
  </p>
</div>
