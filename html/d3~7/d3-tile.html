<h1 dir="auto" id="d3-tile">
d3-tile</h1> <p dir="auto">Quadtree tiles are common for representing large, multi-resolution geometry and images, as in “slippy” maps. d3.tile provides a convenient mechanism for computing which tile coordinates should be visible in the given viewport. Unlike dedicated libraries for slippy maps, such as <a href="https://leafletjs.com/" rel="nofollow">Leaflet</a>, d3.tile’s tiny, low-level API is agnostic about how the tiles are presented and offers greater flexibility. d3.tile works well with <a href="d3-geo.html">d3-geo</a> for geographic maps and <a href="d3-zoom.html">d3-zoom</a> for interaction.</p> <p dir="auto">For examples, see the <a href="https://observablehq.com/collection/@d3/d3-tile" rel="nofollow">d3-tile collection</a> on Observable.</p> <h2 dir="auto" id="installing">
Installing</h2> <p dir="auto">If you use NPM, <code>npm install d3-tile</code>. Otherwise, download the <a href="https://github.com/d3/d3-tile/releases/latest">latest release</a>. You can also load directly as a <a href="https://cdn.jsdelivr.net/npm/d3-tile" rel="nofollow">standalone library</a>. ES modules, AMD, CommonJS, and vanilla environments are supported. In vanilla, a <code>d3</code> global is exported:</p> <pre data-language="markup">&lt;script src="https://cdn.jsdelivr.net/npm/d3-tile@1"&gt;&lt;/script&gt;
&lt;script&gt;

const tile = d3.tile();
const tiles = tile({k: 256, x: 480, y: 250});

&lt;/script&gt;</pre> <h2 dir="auto" id="api-reference">
API Reference</h2> <h6 dir="auto" id="tile"> d3.<b>tile</b>() · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>, <a href="https://observablehq.com/collection/@d3/d3-tile" rel="nofollow" class="source">Examples</a>
</h6> <p dir="auto">Constructs a new tile layout with the default settings.</p> <pre data-language="javascript">const tile = d3.tile();</pre> <h6 dir="auto" id="_tile"> <i>tile</i>(…<em>arguments</em>) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>, <a href="https://observablehq.com/collection/@d3/d3-tile" rel="nofollow" class="source">Examples</a>
</h6> <p dir="auto">Computes the set of tiles to display given the current settings, computing the <a href="#tile_scale">scale</a> and <a href="#tile_translate">translate</a> by invoking the corresponding accessors with the given <em>arguments</em>. Returns an array of [<em>x</em>, <em>y</em>, <em>z</em>] arrays representing the <em>x</em>- (horizontal), <em>y</em>- (vertical) and <em>z</em>- (zoom) integer coordinates of any tiles which intersect the current viewport; these are the “visible” tiles. The returned tiles array also has tiles.<em>scale</em> and tiles.<em>translate</em> properties which together with an individual tile’s <em>x</em> and <em>y</em> determine the intended location of the tile in the viewport.</p> <p dir="auto">For example, the following function computes the pixel coordinates of the top-left corner of the given tile in the current viewport:</p> <pre data-language="javascript">function position(tile, tiles) {
  const [x, y] = tile;
  const {translate: [tx, ty], scale: k} = tiles;
  return [(x + tx) * k, (y + ty) * k];
}</pre> <p dir="auto">And in use:</p> <pre data-language="javascript">const tile = d3.tile();
const tiles = tile({k: 256, x: 480, y: 250});
for (const t of tiles) {
  console.log(`tile ${t} is at ${position(t, tiles)}`);
}</pre> <p dir="auto">See <a href="https://observablehq.com/@d3/zoomable-tiles" rel="nofollow">Zoomable Tiles</a> for more information on tile coordinates.</p> <h6 dir="auto" id="tile_extent"> <i>tile</i>.<b>extent</b>([<i>extent</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>
</h6> <p dir="auto">If <em>extent</em> is specified, sets this tile layout’s viewport extent to the specified array [[<em>x0</em>, <em>y0</em>], [<em>x1</em>, <em>y1</em>]], where [<em>x0</em>, <em>y0</em>] is the top-left corner and [<em>x1</em>, <em>y1</em>] is the bottom-right corner, and returns this tile layout. If <em>extent</em> is not specified, returns the current viewport extent, which defaults to [[0, 0], [960, 500]].</p> <pre data-language="javascript">const tile = d3.tile().extent([[100, 200], [300, 400]]);</pre> <p dir="auto">Setting the viewport extent implicitly sets the <a href="#tile_size">viewport size</a>.</p> <h6 dir="auto" id="tile_size"> <i>tile</i>.<b>size</b>([<i>size</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>
</h6> <p dir="auto">If <em>size</em> is specified, sets this tile layout’s viewport size to the specified array of numbers [<em>width</em>, <em>height</em>] and returns this tile layout. If <em>size</em> is not specified, returns the current viewport size, which defaults to [960, 500].</p> <pre data-language="javascript">const tile = d3.tile().size([200, 200]);</pre> <p dir="auto">This is a convenience method for setting the <a href="#tile_extent">viewport extent</a> to [[0, 0], [<em>width</em>, <em>height</em>]].</p> <h6 dir="auto" id="tile_scale"> <i>tile</i>.<b>scale</b>([<i>scale</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>
</h6> <p dir="auto">If <em>scale</em> is specified, sets this tile layout’s scale function and returns this tile layout. If <em>scale</em> is a function, it is invoked when the <a href="#_tile">tile layout</a> is invoked, being passed the same arguments as the tile layout; this function must return a number indicating the desired width and height of the world tile [0, 0, 0].</p> <pre data-language="javascript">const tile = d3.tile().scale(t =&gt; t.scale).translate(t =&gt; t.translate);
const tiles = tile({scale: 1024, translate: [100, 200]});</pre> <p dir="auto">If <em>scale</em> is not a function, it assumed to be a constant number, and is wrapped in a function.</p> <pre data-language="javascript">const tile = d3.tile().scale(1024).translate([100, 200]);</pre> <p dir="auto">If <em>scale</em> is not specified, returns the current layout scale function, which defaults to:</p> <pre data-language="javascript">function scale(transform) {
  return transform.k;
}</pre> <p dir="auto">This default is compatible with a <a href="d3-zoom.html#zoom-transforms">d3-zoom transform</a>.</p> <h6 dir="auto" id="tile_translate"> <i>tile</i>.<b>translate</b>([<i>translate</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>
</h6> <p dir="auto">If <em>translate</em> is specified, sets this tile layout’s translate function and returns this tile layout. If <em>translate</em> is a function, it is invoked when the <a href="#_tile">tile layout</a> is invoked, being passed the same arguments as the tile layout; this function must return an array of numbers [<em>x</em>, <em>y</em>] indicating the desired coordinates the center of the world tile [0, 0, 0].</p> <pre data-language="javascript">const tile = d3.tile().scale(t =&gt; t.scale).translate(t =&gt; t.translate);
const tiles = tile({scale: 1024, translate: [100, 200]});</pre> <p dir="auto">If <em>translate</em> is not a function, it is assumed to be a constant array [<em>x</em>, <em>y</em>] and is wrapped in a function.</p> <pre data-language="javascript">const tile = d3.tile().scale(1024).translate([100, 200]);</pre> <p dir="auto">If <em>translate</em> is not specified, returns the current layout translate function, which defaults to:</p> <pre data-language="javascript">function translate(transform) {
  return [transform.x, transform.y];
}</pre> <p dir="auto">This default is compatible with a <a href="d3-zoom.html#zoom-transforms">d3-zoom transform</a>.</p> <h6 dir="auto" id="tile_clampx"> <i>tile</i>.<b>clampX</b>([<i>clamp</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>, <a href="https://observablehq.com/@d3/wrapped-tiles" rel="nofollow" class="source">Examples</a>
</h6> <p dir="auto">If <em>clamp</em> is specified, sets whether or not the visible tiles will be clamped in the <em>x</em>-dimension and returns this tile layout. If <em>clamp</em> is not specified, returns whether <em>x</em>-clamping is enabled, which defaults to true. If <em>x</em>-clamping is disabled, then the tile layout may return tiles that are outside the normal bounds 0 ≤ <em>x</em> &lt; 2^<em>z</em> of the “world” tile [0, 0, 0].</p> <pre data-language="javascript">const tile = d3.tile().clampX(false);</pre> <p dir="auto">See <a href="#tileWrap">d3.tileWrap</a> for converting these coordinates to wrapped in-world coordinates, and <a href="https://observablehq.com/@d3/wrapped-tiles" rel="nofollow">Wrapped Tiles</a> for example.</p> <h6 dir="auto" id="tile_clampy"> <i>tile</i>.<b>clampY</b>([<i>clamp</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>
</h6> <p dir="auto">If <em>clamp</em> is specified, sets whether or not the visible tiles will be clamped in the <em>y</em>-dimension and returns this tile layout. If <em>clamp</em> is not specified, returns whether <em>y</em>-clamping is enabled, which defaults to true. If <em>y</em>-clamping is disabled, then the tile layout may return tiles that are outside the normal bounds 0 ≤ <em>y</em> &lt; 2^<em>z</em> of the “world” tile [0, 0, 0].</p> <pre data-language="javascript">const tile = d3.tile().clampY(false);</pre> <p dir="auto">See <a href="#tileWrap">d3.tileWrap</a> for converting these coordinates to wrapped in-world coordinates, and <a href="https://observablehq.com/@d3/wrapped-tiles" rel="nofollow">Wrapped Tiles</a> for example. See also <a href="#tile_clampX"><em>tile</em>.clampX</a>.</p> <h6 dir="auto" id="tile_clamp"> <i>tile</i>.<b>clamp</b>([<i>clamp</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>
</h6> <p dir="auto">If <em>clamp</em> is specified, sets <a href="#tile_clampX"><em>tile</em>.clampX</a> and <a href="#tile_clampY"><em>tile</em>.clampY</a> to the specified boolean <em>clamp</em> and returns this tile layout. If <em>clamp</em> is not specified, returns true if <em>tile</em>.clampX and <em>tile</em>.clampY are both true, and false otherwise.</p> <pre data-language="javascript">const tile = d3.tile().clamp(false);</pre> <h6 dir="auto" id="tile_tilesize"> <i>tile</i>.<b>tileSize</b>([<i>tileSize</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>, <a href="https://observablehq.com/@d3/tile-tilesize" rel="nofollow" class="source">Examples</a>
</h6> <p dir="auto">If <em>tileSize</em> is specified, sets this tile layout’s tile width and height to the specified number <em>tileSize</em> and returns this tile layout. If <em>tileSize</em> is not specified, returns the current layout tile size, which defaults to 256. 256 and 512 are the most common tile sizes.</p> <pre data-language="javascript">const tile = d3.tile().tileSize(512);</pre> <h6 dir="auto" id="tile_zoomdelta"> <i>tile</i>.<b>zoomDelta</b>([<i>zoomDelta</i>]) · <a href="https://github.com/d3/d3-tile/blob/master/src/tile.js" class="source">Source</a>, <a href="https://observablehq.com/@d3/tile-zoomdelta" rel="nofollow" class="source">Examples</a>
</h6> <p dir="auto">If <em>zoomDelta</em> is specified, sets this tile layout’s zoom offset to the specified number <em>zoomDelta</em> and returns this tile layout. If <em>zoomDelta</em> is not specified, returns the current zoom offset, which defaults to 0. The zoom offset affects which <em>z</em>-coordinate is chosen based on the current <a href="#tile_scale">scale</a>; the default zoom offset of 0 will choose the <em>z</em> that is closest the displayed size; a zoom offset of -1 will use <em>z</em> - 1, giving tiles that are twice as big (lower resolution); a zoom offset of +1 will use <em>z</em> + 1, giving tiles that are twice as small (higher resolution). The latter might be appropriate for showing 256×256 tiles in a 128×128 space on a high-resolution screen.</p> <pre data-language="javascript">const tile = d3.tile().zoomDelta(2);</pre> <h6 dir="auto" id="tilewrap"> d3.<b>tileWrap</b>(<em>tile</em>) · <a href="https://github.com/d3/d3-tile/blob/master/src/wrap.js" class="source">Source</a>, <a href="https://observablehq.com/@d3/wrapped-tiles" rel="nofollow" class="source">Examples</a>
</h6> <p dir="auto">Given <em>tile</em> coordinates [<em>x</em>, <em>y</em>, <em>z</em>], where <em>x</em> and <em>y</em> may be outside the “world” tile [0, 0, 0], returns the wrapped tile coordinates [<em>x′</em>, <em>y′</em>, <em>z</em>] where <em>j</em> = 2 ^ <em>z</em>, <em>x′</em> = <em>x</em> - ⌊<em>x</em> / <em>j</em>⌋ * <em>j</em> and <em>y′</em> = <em>y</em> - ⌊<em>y</em> / <em>j</em>⌋ * <em>j</em>. This function is most commonly used in conjunction with <a href="#tile_clampX"><em>tile</em>.clampX</a> to allow horizontal wrapping of web Mercator tiles.</p> <pre data-language="javascript">d3.tileWrap([-1, 0, 1]) // [1, 0, 1]
d3.tileWrap([-1, 0, 2]) // [3, 0, 2]</pre> <p dir="auto">See <a href="https://observablehq.com/@d3/wrapped-tiles" rel="nofollow">Wrapped Tiles</a> for example.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2023 Michael Bostock<br>Licensed under the BSD License.<br>
    <a href="https://github.com/d3/d3-tile" class="_attribution-link">https://github.com/d3/d3-tile</a>
  </p>
</div>
