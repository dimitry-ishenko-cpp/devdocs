<h1 id="policy:CMP0114">CMP0114</h1> <div class="versionadded"> <p><span class="versionmodified added">New in version 3.19.</span></p> </div> <p><a class="reference internal" href="../module/externalproject.html#module:ExternalProject" title="ExternalProject" id="index-0-module:ExternalProject"><code>ExternalProject</code></a> step targets fully adopt their steps.</p> <p>The <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-0-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>STEP_TARGETS</code> option, and the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add_steptargets" title="externalproject_add_steptargets" id="index-0-command:externalproject_add_steptargets"><code>ExternalProject_Add_StepTargets()</code></a> function, can be used to create build targets for individual steps of an external project.</p> <p>In CMake 3.18 and below, step targets have some limitations:</p> <ul> <li>Step targets always depend on targets named by the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-1-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>DEPENDS</code> option even though not all steps need them. In order to allow step targets to be created without those dependencies, the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-2-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>INDEPENDENT_STEP_TARGETS</code> option or the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add_steptargets" title="externalproject_add_steptargets" id="index-1-command:externalproject_add_steptargets"><code>ExternalProject_Add_StepTargets()</code></a> <code>NO_DEPENDS</code> option may be used. However, adding such "independent" step targets makes sense only for specific steps such as <code>download</code>, <code>update</code>, and <code>patch</code> because they do not need any of the external project's build dependencies. Furthermore, it does not make sense to create independent step targets for steps that depend on non-independent steps. Such rules are not enforced, and projects that do not follow them can generate build systems with confusing and generator-specific behavior.</li> <li>
<p>Step targets hold copies of the custom commands implementing their steps that are separate from the copies in the primary target created by <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-3-command:externalproject_add"><code>ExternalProject_Add()</code></a>, and the primary target does not depend on the step targets. In parallel builds that drive the primary target and step targets concurrently, multiple copies of the steps' commands may run concurrently and race each other.</p> <p>Also, prior to policy <a class="reference internal" href="cmp0113.html#policy:CMP0113" title="CMP0113" id="index-0-policy:CMP0113"><code>CMP0113</code></a>, the step targets generated by <a class="reference internal" href="../manual/cmake-generators.7.html#makefile-generators"><span class="std std-ref">Makefile Generators</span></a> also contain all the custom commands on which their step depends. This can lead to repeated execution of those steps even in serial builds.</p> </li> </ul> <p>In CMake 3.19 and above, the <a class="reference internal" href="../module/externalproject.html#module:ExternalProject" title="ExternalProject" id="index-1-module:ExternalProject"><code>ExternalProject</code></a> module prefers a revised design to address these problems:</p> <ul> <li>
<p>Each step is classified as "independent" if it does not depend on other targets named by the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-4-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>DEPENDS</code>. The predefined steps are automatically classified by default:</p> <ul class="simple"> <li>The <code>download</code>, <code>update</code>, and <code>patch</code> steps are independent.</li> <li>The <code>configure</code>, <code>build</code>, <code>test</code>, and <code>install</code> steps are not.</li> </ul> <p>For custom steps, the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add_step" title="externalproject_add_step" id="index-0-command:externalproject_add_step"><code>ExternalProject_Add_Step()</code></a> command provides an <code>INDEPENDENT</code> option to mark them as independent. It is an error to mark a step as independent if it depends on other steps that are not. Note that this use of the term "independent" refers only to independence from external targets and is orthogonal to a step's dependencies on other steps.</p> </li> <li>Step targets created by the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-5-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>STEP_TARGETS</code> option or the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add_step" title="externalproject_add_step" id="index-1-command:externalproject_add_step"><code>ExternalProject_Add_Step()</code></a> function are now independent if and only if their steps are marked as independent. The <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-6-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>INDEPENDENT_STEP_TARGETS</code> option and <a class="reference internal" href="../module/externalproject.html#command:externalproject_add_steptargets" title="externalproject_add_steptargets" id="index-2-command:externalproject_add_steptargets"><code>ExternalProject_Add_StepTargets()</code></a> <code>NO_DEPENDS</code> option are no longer allowed.</li> <li>
<p>Step targets, when created, are fully responsible for holding the custom commands implementing their steps. The primary target created by <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-7-command:externalproject_add"><code>ExternalProject_Add()</code></a> depends on the step targets, and the step targets depend on each other. The target-level dependencies match the file-level dependencies used by the custom commands for each step.</p> <p>When the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add" title="externalproject_add" id="index-8-command:externalproject_add"><code>ExternalProject_Add()</code></a> <code>UPDATE_DISCONNECTED</code> or <code>TEST_EXCLUDE_FROM_MAIN</code> option is used, or the <a class="reference internal" href="../module/externalproject.html#command:externalproject_add_step" title="externalproject_add_step" id="index-2-command:externalproject_add_step"><code>ExternalProject_Add_Step()</code></a> <code>EXCLUDE_FROM_MAIN</code> option is used for a custom step, some step targets may be created automatically. These are needed to hold the steps commonly depended upon by the primary target and the disconnected step targets.</p> </li> </ul> <p>Policy <code>CMP0114</code> provides compatibility for projects that have not been updated to expect the new behavior. The <code>OLD</code> behavior for this policy is to use the above-documented behavior from 3.18 and below. The <code>NEW</code> behavior for this policy is to use the above-documented behavior preferred by 3.19 and above.</p> <p>This policy was introduced in CMake version 3.19. CMake version 3.26.0-rc3 warns when the policy is not set and uses <code>OLD</code> behavior. Use the <a class="reference internal" href="../command/cmake_policy.html#command:cmake_policy" title="cmake_policy" id="index-0-command:cmake_policy"><code>cmake_policy()</code></a> command to set it to <code>OLD</code> or <code>NEW</code> explicitly.</p>  <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2000&ndash;2023 Kitware, Inc. and Contributors<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://cmake.org/cmake/help/v3.26/policy/CMP0114.html" class="_attribution-link">https://cmake.org/cmake/help/v3.26/policy/CMP0114.html</a>
  </p>
</div>
