<h1>socket(7) — Linux manual page</h1>   <pre>
<span class="headline"><i>socket</i>(7)           Miscellaneous Information Manual           <i>socket</i>(7)</span>
</pre> <h2>
NAME </h2>
<pre>
       socket - Linux socket interface
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;sys/socket.h&gt;</b>

       <i>sockfd</i> <b>= socket(int </b><i>socket_family</i><b>, int </b><i>socket_type</i><b>, int </b><i>protocol</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       This manual page describes the Linux networking socket layer user
       interface.  The BSD compatible sockets are the uniform interface
       between the user process and the network protocol stacks in the
       kernel.  The protocol modules are grouped into <i>protocol families</i>
       such as <b>AF_INET</b>, <b>AF_IPX</b>, and <b>AF_PACKET</b>, and <i>socket types</i> such as
       <b>SOCK_STREAM </b>or <b>SOCK_DGRAM</b>.  See <a href="../man2/socket.2.html">socket(2)</a> for more information on
       families and types.

   <b>Socket-layer functions</b>
       These functions are used by the user process to send or receive
       packets and to do other socket operations.  For more information,
       see their respective manual pages.

       <a href="../man2/socket.2.html">socket(2)</a> creates a socket, <a href="../man2/connect.2.html">connect(2)</a> connects a socket to a
       remote socket address, the <a href="../man2/bind.2.html">bind(2)</a> function binds a socket to a
       local socket address, <a href="../man2/listen.2.html">listen(2)</a> tells the socket that new
       connections shall be accepted, and <a href="../man2/accept.2.html">accept(2)</a> is used to get a new
       socket with a new incoming connection.  <a href="../man2/socketpair.2.html">socketpair(2)</a> returns two
       connected anonymous sockets (implemented only for a few local
       families like <b>AF_UNIX</b>)

       <a href="../man2/send.2.html">send(2)</a>, <a href="../man2/sendto.2.html">sendto(2)</a>, and <a href="../man2/sendmsg.2.html">sendmsg(2)</a> send data over a socket, and
       <a href="../man2/recv.2.html">recv(2)</a>, <a href="../man2/recvfrom.2.html">recvfrom(2)</a>, <a href="../man2/recvmsg.2.html">recvmsg(2)</a> receive data from a socket.
       <a href="../man2/poll.2.html">poll(2)</a> and <a href="../man2/select.2.html">select(2)</a> wait for arriving data or a readiness to
       send data.  In addition, the standard I/O operations like
       <a href="../man2/write.2.html">write(2)</a>, <a href="../man2/writev.2.html">writev(2)</a>, <a href="../man2/sendfile.2.html">sendfile(2)</a>, <a href="../man2/read.2.html">read(2)</a>, and <a href="../man2/readv.2.html">readv(2)</a> can be
       used to read and write data.

       <a href="../man2/getsockname.2.html">getsockname(2)</a> returns the local socket address and
       <a href="../man2/getpeername.2.html">getpeername(2)</a> returns the remote socket address.  <a href="../man2/getsockopt.2.html">getsockopt(2)</a>
       and <a href="../man2/setsockopt.2.html">setsockopt(2)</a> are used to set or get socket layer or protocol
       options.  <a href="../man2/ioctl.2.html">ioctl(2)</a> can be used to set or read some other options.

       <a href="../man2/close.2.html">close(2)</a> is used to close a socket.  <a href="../man2/shutdown.2.html">shutdown(2)</a> closes parts of
       a full-duplex socket connection.

       Seeking, or calling <a href="../man2/pread.2.html">pread(2)</a> or <a href="../man2/pwrite.2.html">pwrite(2)</a> with a nonzero position
       is not supported on sockets.

       It is possible to do nonblocking I/O on sockets by setting the
       <b>O_NONBLOCK </b>flag on a socket file descriptor using <a href="../man2/fcntl.2.html">fcntl(2)</a>.  Then
       all operations that would block will (usually) return with <b>EAGAIN</b>
       (operation should be retried later); <a href="../man2/connect.2.html">connect(2)</a> will return
       <b>EINPROGRESS </b>error.  The user can then wait for various events via
       <a href="../man2/poll.2.html">poll(2)</a> or <a href="../man2/select.2.html">select(2)</a>.
       ┌───────────────────────────────────────────────────────────────┐
       │                          I/O events                           │
       ├────────────┬───────────┬──────────────────────────────────────┤
       │ Event      │ Poll flag │ Occurrence                           │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read       │ POLLIN    │ New data arrived.                    │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read       │ POLLIN    │ A connection setup has been          │
       │            │           │ completed (for connection-oriented   │
       │            │           │ sockets)                             │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read       │ POLLHUP   │ A disconnection request has been     │
       │            │           │ initiated by the other end.          │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read       │ POLLHUP   │ A connection is broken (only for     │
       │            │           │ connection-oriented protocols).      │
       │            │           │ When the socket is written <b>SIGPIPE   </b>│
       │            │           │ is also sent.                        │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Write      │ POLLOUT   │ Socket has enough send buffer space  │
       │            │           │ for writing new data.                │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read/Write │ POLLIN |  │ An outgoing <a href="../man2/connect.2.html">connect(2)</a> finished.     │
       │            │ POLLOUT   │                                      │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read/Write │ POLLERR   │ An asynchronous error occurred.      │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Read/Write │ POLLHUP   │ The other end has shut down one      │
       │            │           │ direction.                           │
       ├────────────┼───────────┼──────────────────────────────────────┤
       │ Exception  │ POLLPRI   │ Urgent data arrived.  <b>SIGURG </b>is sent │
       │            │           │ then.                                │
       └────────────┴───────────┴──────────────────────────────────────┘

       An alternative to <a href="../man2/poll.2.html">poll(2)</a> and <a href="../man2/select.2.html">select(2)</a> is to let the kernel
       inform the application about events via a <b>SIGIO </b>signal.  For that
       the <b>O_ASYNC </b>flag must be set on a socket file descriptor via
       <a href="../man2/fcntl.2.html">fcntl(2)</a> and a valid signal handler for <b>SIGIO </b>must be installed
       via <a href="../man2/sigaction.2.html">sigaction(2)</a>.  See the <i>Signals</i> discussion below.

   <b>Socket address structures</b>
       Each socket domain has its own format for socket addresses, with
       a domain-specific address structure.  Each of these structures
       begins with an integer "family" field (typed as <i>sa_family_t</i>) that
       indicates the type of the address structure.  This allows the
       various system calls (e.g., <a href="../man2/connect.2.html">connect(2)</a>, <a href="../man2/bind.2.html">bind(2)</a>, <a href="../man2/accept.2.html">accept(2)</a>,
       <a href="../man2/getsockname.2.html">getsockname(2)</a>, <a href="../man2/getpeername.2.html">getpeername(2)</a>), which are generic to all socket
       domains, to determine the domain of a particular socket address.

       To allow any type of socket address to be passed to interfaces in
       the sockets API, the type <i>struct sockaddr</i> is defined.  The
       purpose of this type is purely to allow casting of domain-
       specific socket address types to a "generic" type, so as to avoid
       compiler warnings about type mismatches in calls to the sockets
       API.

       In addition, the sockets API provides the data type <i>struct</i>
       <i>sockaddr_storage</i>.  This type is suitable to accommodate all
       supported domain-specific socket address structures; it is large
       enough and is aligned properly.  (In particular, it is large
       enough to hold IPv6 socket addresses.)  The structure includes
       the following field, which can be used to identify the type of
       socket address actually stored in the structure:

               sa_family_t ss_family;

       The <i>sockaddr_storage</i> structure is useful in programs that must
       handle socket addresses in a generic way (e.g., programs that
       must deal with both IPv4 and IPv6 socket addresses).

   <b>Socket options</b>
       The socket options listed below can be set by using <a href="../man2/setsockopt.2.html">setsockopt(2)</a>
       and read with <a href="../man2/getsockopt.2.html">getsockopt(2)</a> with the socket level set to
       <b>SOL_SOCKET </b>for all sockets.  Unless otherwise noted, <i>optval</i> is a
       pointer to an <i>int</i>.

       <b>SO_ACCEPTCONN</b>
              Returns a value indicating whether or not this socket has
              been marked to accept connections with <a href="../man2/listen.2.html">listen(2)</a>.  The
              value 0 indicates that this is not a listening socket, the
              value 1 indicates that this is a listening socket.  This
              socket option is read-only.

       <b>SO_ATTACH_FILTER </b>(since Linux 2.2)
       <b>SO_ATTACH_BPF </b>(since Linux 3.19)
              Attach a classic BPF (<b>SO_ATTACH_FILTER</b>) or an extended BPF
              (<b>SO_ATTACH_BPF</b>) program to the socket for use as a filter
              of incoming packets.  A packet will be dropped if the
              filter program returns zero.  If the filter program
              returns a nonzero value which is less than the packet's
              data length, the packet will be truncated to the length
              returned.  If the value returned by the filter is greater
              than or equal to the packet's data length, the packet is
              allowed to proceed unmodified.

              The argument for <b>SO_ATTACH_FILTER </b>is a <i>sock_fprog</i>
              structure, defined in <i>&lt;linux/filter.h&gt;</i>:

                  struct sock_fprog {
                      unsigned short      len;
                      struct sock_filter *filter;
                  };

              The argument for <b>SO_ATTACH_BPF </b>is a file descriptor
              returned by the <a href="../man2/bpf.2.html">bpf(2)</a> system call and must refer to a
              program of type <b>BPF_PROG_TYPE_SOCKET_FILTER</b>.

              These options may be set multiple times for a given
              socket, each time replacing the previous filter program.
              The classic and extended versions may be called on the
              same socket, but the previous filter will always be
              replaced such that a socket never has more than one filter
              defined.

              Both classic and extended BPF are explained in the kernel
              source file <i>Documentation/networking/filter.txt</i>

       <b>SO_ATTACH_REUSEPORT_CBPF</b>
       <b>SO_ATTACH_REUSEPORT_EBPF</b>
              For use with the <b>SO_REUSEPORT </b>option, these options allow
              the user to set a classic BPF (<b>SO_ATTACH_REUSEPORT_CBPF</b>)
              or an extended BPF (<b>SO_ATTACH_REUSEPORT_EBPF</b>) program
              which defines how packets are assigned to the sockets in
              the reuseport group (that is, all sockets which have
              <b>SO_REUSEPORT </b>set and are using the same local address to
              receive packets).

              The BPF program must return an index between 0 and N-1
              representing the socket which should receive the packet
              (where N is the number of sockets in the group).  If the
              BPF program returns an invalid index, socket selection
              will fall back to the plain <b>SO_REUSEPORT </b>mechanism.

              Sockets are numbered in the order in which they are added
              to the group (that is, the order of <a href="../man2/bind.2.html">bind(2)</a> calls for UDP
              sockets or the order of <a href="../man2/listen.2.html">listen(2)</a> calls for TCP sockets).
              New sockets added to a reuseport group will inherit the
              BPF program.  When a socket is removed from a reuseport
              group (via <a href="../man2/close.2.html">close(2)</a>), the last socket in the group will be
              moved into the closed socket's position.

              These options may be set repeatedly at any time on any
              socket in the group to replace the current BPF program
              used by all sockets in the group.

              <b>SO_ATTACH_REUSEPORT_CBPF </b>takes the same argument type as
              <b>SO_ATTACH_FILTER </b>and <b>SO_ATTACH_REUSEPORT_EBPF </b>takes the
              same argument type as <b>SO_ATTACH_BPF</b>.

              UDP support for this feature is available since Linux 4.5;
              TCP support is available since Linux 4.6.

       <b>SO_BINDTODEVICE</b>
              Bind this socket to a particular device like “eth0”, as
              specified in the passed interface name.  If the name is an
              empty string or the option length is zero, the socket
              device binding is removed.  The passed option is a
              variable-length null-terminated interface name string with
              the maximum size of <b>IFNAMSIZ</b>.  If a socket is bound to an
              interface, only packets received from that particular
              interface are processed by the socket.  Note that this
              works only for some socket types, particularly <b>AF_INET</b>
              sockets.  It is not supported for packet sockets (use
              normal <a href="../man2/bind.2.html">bind(2)</a> there).

              Before Linux 3.8, this socket option could be set, but
              could not retrieved with <a href="../man2/getsockopt.2.html">getsockopt(2)</a>.  Since Linux 3.8,
              it is readable.  The <i>optlen</i> argument should contain the
              buffer size available to receive the device name and is
              recommended to be <b>IFNAMSIZ </b>bytes.  The real device name
              length is reported back in the <i>optlen</i> argument.

       <b>SO_BROADCAST</b>
              Set or get the broadcast flag.  When enabled, datagram
              sockets are allowed to send packets to a broadcast
              address.  This option has no effect on stream-oriented
              sockets.

       <b>SO_BSDCOMPAT</b>
              Enable BSD bug-to-bug compatibility.  This is used by the
              UDP protocol module in Linux 2.0 and 2.2.  If enabled,
              ICMP errors received for a UDP socket will not be passed
              to the user program.  In later kernel versions, support
              for this option has been phased out: Linux 2.4 silently
              ignores it, and Linux 2.6 generates a kernel warning
              (printk()) if a program uses this option.  Linux 2.0 also
              enabled BSD bug-to-bug compatibility options (random
              header changing, skipping of the broadcast flag) for raw
              sockets with this option, but that was removed in Linux
              2.2.

       <b>SO_DEBUG</b>
              Enable socket debugging.  Allowed only for processes with
              the <b>CAP_NET_ADMIN </b>capability or an effective user ID of 0.

       <b>SO_DETACH_FILTER </b>(since Linux 2.2)
       <b>SO_DETACH_BPF </b>(since Linux 3.19)
              These two options, which are synonyms, may be used to
              remove the classic or extended BPF program attached to a
              socket with either <b>SO_ATTACH_FILTER </b>or <b>SO_ATTACH_BPF</b>.  The
              option value is ignored.

       <b>SO_DOMAIN </b>(since Linux 2.6.32)
              Retrieves the socket domain as an integer, returning a
              value such as <b>AF_INET6</b>.  See <a href="../man2/socket.2.html">socket(2)</a> for details.  This
              socket option is read-only.

       <b>SO_ERROR</b>
              Get and clear the pending socket error.  This socket
              option is read-only.  Expects an integer.

       <b>SO_DONTROUTE</b>
              Don't send via a gateway, send only to directly connected
              hosts.  The same effect can be achieved by setting the
              <b>MSG_DONTROUTE </b>flag on a socket <a href="../man2/send.2.html">send(2)</a> operation.  Expects
              an integer boolean flag.

       <b>SO_INCOMING_CPU </b>(gettable since Linux 3.19, settable since Linux
       4.4)
              Sets or gets the CPU affinity of a socket.  Expects an
              integer flag.

                  int cpu = 1;
                  setsockopt(fd, SOL_SOCKET, SO_INCOMING_CPU, &amp;cpu,
                             sizeof(cpu));

              Because all of the packets for a single stream (i.e., all
              packets for the same 4-tuple) arrive on the single RX
              queue that is associated with a particular CPU, the
              typical use case is to employ one listening process per RX
              queue, with the incoming flow being handled by a listener
              on the same CPU that is handling the RX queue.  This
              provides optimal NUMA behavior and keeps CPU caches hot.

       <b>SO_INCOMING_NAPI_ID </b>(gettable since Linux 4.12)
              Returns a system-level unique ID called NAPI ID that is
              associated with a RX queue on which the last packet
              associated with that socket is received.

              This can be used by an application to split the incoming
              flows among worker threads based on the RX queue on which
              the packets associated with the flows are received.  It
              allows each worker thread to be associated with a NIC HW
              receive queue and service all the connection requests
              received on that RX queue.  This mapping between an app
              thread and a HW NIC queue streamlines the flow of data
              from the NIC to the application.

       <b>SO_KEEPALIVE</b>
              Enable sending of keep-alive messages on connection-
              oriented sockets.  Expects an integer boolean flag.

       <b>SO_LINGER</b>
              Sets or gets the <b>SO_LINGER </b>option.  The argument is a
              <i>linger</i> structure.

                  struct linger {
                      int l_onoff;    /* linger active */
                      int l_linger;   /* how many seconds to linger for */
                  };

              When enabled, a <a href="../man2/close.2.html">close(2)</a> or <a href="../man2/shutdown.2.html">shutdown(2)</a> will not return
              until all queued messages for the socket have been
              successfully sent or the linger timeout has been reached.
              Otherwise, the call returns immediately and the closing is
              done in the background.  When the socket is closed as part
              of <a href="../man2/exit.2.html">exit(2)</a>, it always lingers in the background.

       <b>SO_LOCK_FILTER</b>
              When set, this option will prevent changing the filters
              associated with the socket.  These filters include any set
              using the socket options <b>SO_ATTACH_FILTER</b>, <b>SO_ATTACH_BPF</b>,
              <b>SO_ATTACH_REUSEPORT_CBPF</b>, and <b>SO_ATTACH_REUSEPORT_EBPF</b>.

              The typical use case is for a privileged process to set up
              a raw socket (an operation that requires the <b>CAP_NET_RAW</b>
              capability), apply a restrictive filter, set the
              <b>SO_LOCK_FILTER </b>option, and then either drop its privileges
              or pass the socket file descriptor to an unprivileged
              process via a UNIX domain socket.

              Once the <b>SO_LOCK_FILTER </b>option has been enabled, attempts
              to change or remove the filter attached to a socket, or to
              disable the <b>SO_LOCK_FILTER </b>option will fail with the error
              <b>EPERM</b>.

       <b>SO_MARK </b>(since Linux 2.6.25)
              Set the mark for each packet sent through this socket
              (similar to the netfilter MARK target but socket-based).
              Changing the mark can be used for mark-based routing
              without netfilter or for packet filtering.  Setting this
              option requires the <b>CAP_NET_ADMIN </b>or <b>CAP_NET_RAW </b>(since
              Linux 5.17) capability.

       <b>SO_OOBINLINE</b>
              If this option is enabled, out-of-band data is directly
              placed into the receive data stream.  Otherwise, out-of-
              band data is passed only when the <b>MSG_OOB </b>flag is set
              during receiving.

       <b>SO_PASSCRED</b>
              Enable or disable the receiving of the <b>SCM_CREDENTIALS</b>
              control message.  For more information, see <a href="unix.7.html">unix(7)</a>.

       <b>SO_PASSSEC</b>
              Enable or disable the receiving of the <b>SCM_SECURITY</b>
              control message.  For more information, see <a href="unix.7.html">unix(7)</a>.

       <b>SO_PEEK_OFF </b>(since Linux 3.4)
              This option, which is currently supported only for <a href="unix.7.html">unix(7)</a>
              sockets, sets the value of the "peek offset" for the
              <a href="../man2/recv.2.html">recv(2)</a> system call when used with <b>MSG_PEEK </b>flag.

              When this option is set to a negative value (it is set to
              -1 for all new sockets), traditional behavior is provided:
              <a href="../man2/recv.2.html">recv(2)</a> with the <b>MSG_PEEK </b>flag will peek data from the
              front of the queue.

              When the option is set to a value greater than or equal to
              zero, then the next peek at data queued in the socket will
              occur at the byte offset specified by the option value.
              At the same time, the "peek offset" will be incremented by
              the number of bytes that were peeked from the queue, so
              that a subsequent peek will return the next data in the
              queue.

              If data is removed from the front of the queue via a call
              to <a href="../man2/recv.2.html">recv(2)</a> (or similar) without the <b>MSG_PEEK </b>flag, the
              "peek offset" will be decreased by the number of bytes
              removed.  In other words, receiving data without the
              <b>MSG_PEEK </b>flag will cause the "peek offset" to be adjusted
              to maintain the correct relative position in the queued
              data, so that a subsequent peek will retrieve the data
              that would have been retrieved had the data not been
              removed.

              For datagram sockets, if the "peek offset" points to the
              middle of a packet, the data returned will be marked with
              the <b>MSG_TRUNC </b>flag.

              The following example serves to illustrate the use of
              <b>SO_PEEK_OFF</b>.  Suppose a stream socket has the following
              queued input data:

                  aabbccddeeff

              The following sequence of <a href="../man2/recv.2.html">recv(2)</a> calls would have the
              effect noted in the comments:

                  int ov = 4;                  // Set peek offset to 4
                  setsockopt(fd, SOL_SOCKET, SO_PEEK_OFF, &amp;ov, sizeof(ov));

                  recv(fd, buf, 2, MSG_PEEK);  // Peeks "cc"; offset set to 6
                  recv(fd, buf, 2, MSG_PEEK);  // Peeks "dd"; offset set to 8
                  recv(fd, buf, 2, 0);         // Reads "aa"; offset set to 6
                  recv(fd, buf, 2, MSG_PEEK);  // Peeks "ee"; offset set to 8

       <b>SO_PEERCRED</b>
              Return the credentials of the peer process connected to
              this socket.  For further details, see <a href="unix.7.html">unix(7)</a>.

       <b>SO_PEERSEC </b>(since Linux 2.6.2)
              Return the security context of the peer socket connected
              to this socket.  For further details, see <a href="unix.7.html">unix(7)</a> and
              <a href="ip.7.html">ip(7)</a>.

       <b>SO_PRIORITY</b>
              Set the protocol-defined priority for all packets to be
              sent on this socket.  Linux uses this value to order the
              networking queues: packets with a higher priority may be
              processed first depending on the selected device queueing
              discipline.  Setting a priority outside the range 0 to 6
              requires the <b>CAP_NET_ADMIN </b>capability.

       <b>SO_PROTOCOL </b>(since Linux 2.6.32)
              Retrieves the socket protocol as an integer, returning a
              value such as <b>IPPROTO_SCTP</b>.  See <a href="../man2/socket.2.html">socket(2)</a> for details.
              This socket option is read-only.

       <b>SO_RCVBUF</b>
              Sets or gets the maximum socket receive buffer in bytes.
              The kernel doubles this value (to allow space for
              bookkeeping overhead) when it is set using <a href="../man2/setsockopt.2.html">setsockopt(2)</a>,
              and this doubled value is returned by <a href="../man2/getsockopt.2.html">getsockopt(2)</a>.  The
              default value is set by the
              <i>/proc/sys/net/core/rmem_default</i> file, and the maximum
              allowed value is set by the <i>/proc/sys/net/core/rmem_max</i>
              file.  The minimum (doubled) value for this option is 256.

       <b>SO_RCVBUFFORCE </b>(since Linux 2.6.14)
              Using this socket option, a privileged (<b>CAP_NET_ADMIN</b>)
              process can perform the same task as <b>SO_RCVBUF</b>, but the
              <i>rmem_max</i> limit can be overridden.

       <b>SO_RCVLOWAT </b>and <b>SO_SNDLOWAT</b>
              Specify the minimum number of bytes in the buffer until
              the socket layer will pass the data to the protocol
              (<b>SO_SNDLOWAT</b>) or the user on receiving (<b>SO_RCVLOWAT</b>).
              These two values are initialized to 1.  <b>SO_SNDLOWAT </b>is not
              changeable on Linux (<a href="../man2/setsockopt.2.html">setsockopt(2)</a> fails with the error
              <b>ENOPROTOOPT</b>).  <b>SO_RCVLOWAT </b>is changeable only since Linux
              2.4.

              Before Linux 2.6.28 <a href="../man2/select.2.html">select(2)</a>, <a href="../man2/poll.2.html">poll(2)</a>, and <a href="epoll.7.html">epoll(7)</a> did
              not respect the <b>SO_RCVLOWAT </b>setting on Linux, and
              indicated a socket as readable when even a single byte of
              data was available.  A subsequent read from the socket
              would then block until <b>SO_RCVLOWAT </b>bytes are available.
              Since Linux 2.6.28, <a href="../man2/select.2.html">select(2)</a>, <a href="../man2/poll.2.html">poll(2)</a>, and <a href="epoll.7.html">epoll(7)</a>
              indicate a socket as readable only if at least <b>SO_RCVLOWAT</b>
              bytes are available.

       <b>SO_RCVTIMEO </b>and <b>SO_SNDTIMEO</b>
              Specify the receiving or sending timeouts until reporting
              an error.  The argument is a <i>struct timeval</i>.  If an input
              or output function blocks for this period of time, and
              data has been sent or received, the return value of that
              function will be the amount of data transferred; if no
              data has been transferred and the timeout has been
              reached, then -1 is returned with <i><a href="../man3/errno.3.html">errno</a></i> set to <b>EAGAIN </b>or
              <b>EWOULDBLOCK</b>, or <b>EINPROGRESS </b>(for <a href="../man2/connect.2.html">connect(2)</a>) just as if
              the socket was specified to be nonblocking.  If the
              timeout is set to zero (the default), then the operation
              will never timeout.  Timeouts only have effect for system
              calls that perform socket I/O (e.g., <a href="../man2/accept.2.html">accept(2)</a>,
              <a href="../man2/connect.2.html">connect(2)</a>, <a href="../man2/read.2.html">read(2)</a>, <a href="../man2/recvmsg.2.html">recvmsg(2)</a>, <a href="../man2/send.2.html">send(2)</a>, <a href="../man2/sendmsg.2.html">sendmsg(2)</a>);
              timeouts have no effect for <a href="../man2/select.2.html">select(2)</a>, <a href="../man2/poll.2.html">poll(2)</a>,
              <a href="../man2/epoll_wait.2.html">epoll_wait(2)</a>, and so on.

       <b>SO_REUSEADDR</b>
              Indicates that the rules used in validating addresses
              supplied in a <a href="../man2/bind.2.html">bind(2)</a> call should allow reuse of local
              addresses.  For <b>AF_INET </b>sockets this means that a socket
              may bind, except when there is an active listening socket
              bound to the address.  When the listening socket is bound
              to <b>INADDR_ANY </b>with a specific port then it is not possible
              to bind to this port for any local address.  Argument is
              an integer boolean flag.

       <b>SO_REUSEPORT </b>(since Linux 3.9)
              Permits multiple <b>AF_INET </b>or <b>AF_INET6 </b>sockets to be bound
              to an identical socket address.  This option must be set
              on each socket (including the first socket) prior to
              calling <a href="../man2/bind.2.html">bind(2)</a> on the socket.  To prevent port hijacking,
              all of the processes binding to the same address must have
              the same effective UID.  This option can be employed with
              both TCP and UDP sockets.

              For TCP sockets, this option allows <a href="../man2/accept.2.html">accept(2)</a> load
              distribution in a multi-threaded server to be improved by
              using a distinct listener socket for each thread.  This
              provides improved load distribution as compared to
              traditional techniques such using a single <a href="../man2/accept.2.html">accept(2)</a>ing
              thread that distributes connections, or having multiple
              threads that compete to <a href="../man2/accept.2.html">accept(2)</a> from the same socket.

              For UDP sockets, the use of this option can provide better
              distribution of incoming datagrams to multiple processes
              (or threads) as compared to the traditional technique of
              having multiple processes compete to receive datagrams on
              the same socket.

       <b>SO_RXQ_OVFL </b>(since Linux 2.6.33)
              Indicates that an unsigned 32-bit value ancillary message
              (cmsg) should be attached to received skbs indicating the
              number of packets dropped by the socket since its
              creation.

       <b>SO_SELECT_ERR_QUEUE </b>(since Linux 3.10)
              When this option is set on a socket, an error condition on
              a socket causes notification not only via the <i>exceptfds</i>
              set of <a href="../man2/select.2.html">select(2)</a>.  Similarly, <a href="../man2/poll.2.html">poll(2)</a> also returns a
              <b>POLLPRI </b>whenever an <b>POLLERR </b>event is returned.

              Background: this option was added when waking up on an
              error condition occurred only via the <i>readfds</i> and <i>writefds</i>
              sets of <a href="../man2/select.2.html">select(2)</a>.  The option was added to allow
              monitoring for error conditions via the <i>exceptfds</i> argument
              without simultaneously having to receive notifications
              (via <i>readfds</i>) for regular data that can be read from the
              socket.  After changes in Linux 4.16, the use of this flag
              to achieve the desired notifications is no longer
              necessary.  This option is nevertheless retained for
              backwards compatibility.

       <b>SO_SNDBUF</b>
              Sets or gets the maximum socket send buffer in bytes.  The
              kernel doubles this value (to allow space for bookkeeping
              overhead) when it is set using <a href="../man2/setsockopt.2.html">setsockopt(2)</a>, and this
              doubled value is returned by <a href="../man2/getsockopt.2.html">getsockopt(2)</a>.  The default
              value is set by the <i>/proc/sys/net/core/wmem_default</i> file
              and the maximum allowed value is set by the
              <i>/proc/sys/net/core/wmem_max</i> file.  The minimum (doubled)
              value for this option is 2048.

       <b>SO_SNDBUFFORCE </b>(since Linux 2.6.14)
              Using this socket option, a privileged (<b>CAP_NET_ADMIN</b>)
              process can perform the same task as <b>SO_SNDBUF</b>, but the
              <i>wmem_max</i> limit can be overridden.

       <b>SO_TIMESTAMP</b>
              Enable or disable the receiving of the <b>SO_TIMESTAMP</b>
              control message.  The timestamp control message is sent
              with level <b>SOL_SOCKET </b>and a <i>cmsg_type</i> of <b>SCM_TIMESTAMP</b>.
              The <i>cmsg_data</i> field is a <i>struct timeval</i> indicating the
              reception time of the last packet passed to the user in
              this call.  See <a href="../man3/cmsg.3.html">cmsg(3)</a> for details on control messages.

       <b>SO_TIMESTAMPNS </b>(since Linux 2.6.22)
              Enable or disable the receiving of the <b>SO_TIMESTAMPNS</b>
              control message.  The timestamp control message is sent
              with level <b>SOL_SOCKET </b>and a <i>cmsg_type</i> of <b>SCM_TIMESTAMPNS</b>.
              The <i>cmsg_data</i> field is a <i>struct timespec</i> indicating the
              reception time of the last packet passed to the user in
              this call.  The clock used for the timestamp is
              <b>CLOCK_REALTIME</b>.  See <a href="../man3/cmsg.3.html">cmsg(3)</a> for details on control
              messages.

              A socket cannot mix <b>SO_TIMESTAMP </b>and <b>SO_TIMESTAMPNS</b>: the
              two modes are mutually exclusive.

       <b>SO_TYPE</b>
              Gets the socket type as an integer (e.g., <b>SOCK_STREAM</b>).
              This socket option is read-only.

       <b>SO_BUSY_POLL </b>(since Linux 3.11)
              Sets the approximate time in microseconds to busy poll on
              a blocking receive when there is no data.  Increasing this
              value requires <b>CAP_NET_ADMIN</b>.  The default for this option
              is controlled by the <i>/proc/sys/net/core/busy_read</i> file.

              The value in the <i>/proc/sys/net/core/busy_poll</i> file
              determines how long <a href="../man2/select.2.html">select(2)</a> and <a href="../man2/poll.2.html">poll(2)</a> will busy poll
              when they operate on sockets with <b>SO_BUSY_POLL </b>set and no
              events to report are found.

              In both cases, busy polling will only be done when the
              socket last received data from a network device that
              supports this option.

              While busy polling may improve latency of some
              applications, care must be taken when using it since this
              will increase both CPU utilization and power usage.

   <b>Signals</b>
       When writing onto a connection-oriented socket that has been shut
       down (by the local or the remote end) <b>SIGPIPE </b>is sent to the
       writing process and <b>EPIPE </b>is returned.  The signal is not sent
       when the write call specified the <b>MSG_NOSIGNAL </b>flag.

       When requested with the <b>FIOSETOWN fcntl</b>(2) or <b>SIOCSPGRP ioctl</b>(2),
       <b>SIGIO </b>is sent when an I/O event occurs.  It is possible to use
       <a href="../man2/poll.2.html">poll(2)</a> or <a href="../man2/select.2.html">select(2)</a> in the signal handler to find out which
       socket the event occurred on.  An alternative (in Linux 2.2) is
       to set a real-time signal using the <b>F_SETSIG fcntl</b>(2); the
       handler of the real time signal will be called with the file
       descriptor in the <i>si_fd</i> field of its <i>siginfo_t</i>.  See <a href="../man2/fcntl.2.html">fcntl(2)</a> for
       more information.

       Under some circumstances (e.g., multiple processes accessing a
       single socket), the condition that caused the <b>SIGIO </b>may have
       already disappeared when the process reacts to the signal.  If
       this happens, the process should wait again because Linux will
       resend the signal later.

   <b>/proc interfaces</b>
       The core socket networking parameters can be accessed via files
       in the directory <i>/proc/sys/net/core/</i>.

       <i>rmem_default</i>
              contains the default setting in bytes of the socket
              receive buffer.

       <i>rmem_max</i>
              contains the maximum socket receive buffer size in bytes
              which a user may set by using the <b>SO_RCVBUF </b>socket option.

       <i>wmem_default</i>
              contains the default setting in bytes of the socket send
              buffer.

       <i>wmem_max</i>
              contains the maximum socket send buffer size in bytes
              which a user may set by using the <b>SO_SNDBUF </b>socket option.

       <i>message_cost</i> and <i>message_burst</i>
              configure the token bucket filter used to load limit
              warning messages caused by external network events.

       <i>netdev_max_backlog</i>
              Maximum number of packets in the global input queue.

       <i>optmem_max</i>
              Maximum length of ancillary data and user control data
              like the iovecs per socket.

   <b>Ioctls</b>
       These operations can be accessed using <a href="../man2/ioctl.2.html">ioctl(2)</a>:

           <i>error</i> <b>= ioctl(</b><i>ip_socket</i><b>, </b><i>ioctl_type</i><b>, </b><i>&amp;value_result</i><b>);</b>

       <b>SIOCGSTAMP</b>
              Return a <i>struct timeval</i> with the receive timestamp of the
              last packet passed to the user.  This is useful for
              accurate round trip time measurements.  See <a href="../man2/setitimer.2.html">setitimer(2)</a>
              for a description of <i>struct timeval</i>.  This ioctl should be
              used only if the socket options <b>SO_TIMESTAMP </b>and
              <b>SO_TIMESTAMPNS </b>are not set on the socket.  Otherwise, it
              returns the timestamp of the last packet that was received
              while <b>SO_TIMESTAMP </b>and <b>SO_TIMESTAMPNS </b>were not set, or it
              fails if no such packet has been received, (i.e., <a href="../man2/ioctl.2.html">ioctl(2)</a>
              returns -1 with <i><a href="../man3/errno.3.html">errno</a></i> set to <b>ENOENT</b>).

       <b>SIOCSPGRP</b>
              Set the process or process group that is to receive <b>SIGIO</b>
              or <b>SIGURG </b>signals when I/O becomes possible or urgent data
              is available.  The argument is a pointer to a <i>pid_t</i>.  For
              further details, see the description of <b>F_SETOWN </b>in
              <a href="../man2/fcntl.2.html">fcntl(2)</a>.

       <b>FIOASYNC</b>
              Change the <b>O_ASYNC </b>flag to enable or disable asynchronous
              I/O mode of the socket.  Asynchronous I/O mode means that
              the <b>SIGIO </b>signal or the signal set with <b>F_SETSIG </b>is raised
              when a new I/O event occurs.

              Argument is an integer boolean flag.  (This operation is
              synonymous with the use of <a href="../man2/fcntl.2.html">fcntl(2)</a> to set the <b>O_ASYNC</b>
              flag.)

       <b>SIOCGPGRP</b>
              Get the current process or process group that receives
              <b>SIGIO </b>or <b>SIGURG </b>signals, or 0 when none is set.

       Valid <a href="../man2/fcntl.2.html">fcntl(2)</a> operations:

       <b>FIOGETOWN</b>
              The same as the <b>SIOCGPGRP ioctl</b>(2).

       <b>FIOSETOWN</b>
              The same as the <b>SIOCSPGRP ioctl</b>(2).
</pre> <h2>
VERSIONS </h2>
<pre>
       <b>SO_BINDTODEVICE </b>was introduced in Linux 2.0.30.  <b>SO_PASSCRED </b>is
       new in Linux 2.2.  The <i>/proc</i> interfaces were introduced in Linux
       2.2.  <b>SO_RCVTIMEO </b>and <b>SO_SNDTIMEO </b>are supported since Linux
       2.3.41.  Earlier, timeouts were fixed to a protocol-specific
       setting, and could not be read or written.
</pre> <h2>
NOTES </h2>
<pre>
       Linux assumes that half of the send/receive buffer is used for
       internal kernel structures; thus the values in the corresponding
       <i>/proc</i> files are twice what can be observed on the wire.

       Linux will allow port reuse only with the <b>SO_REUSEADDR </b>option
       when this option was set both in the previous program that
       performed a <a href="../man2/bind.2.html">bind(2)</a> to the port and in the program that wants to
       reuse the port.  This differs from some implementations (e.g.,
       FreeBSD) where only the later program needs to set the
       <b>SO_REUSEADDR </b>option.  Typically this difference is invisible,
       since, for example, a server program is designed to always set
       this option.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <b>wireshark</b>(1), <a href="../man2/bpf.2.html">bpf(2)</a>, <a href="../man2/connect.2.html">connect(2)</a>, <a href="../man2/getsockopt.2.html">getsockopt(2)</a>, <a href="../man2/setsockopt.2.html">setsockopt(2)</a>,
       <a href="../man2/socket.2.html">socket(2)</a>, <b>pcap</b>(3), <a href="address_families.7.html">address_families(7)</a>, <a href="capabilities.7.html">capabilities(7)</a>, <a href="ddp.7.html">ddp(7)</a>,
       <a href="ip.7.html">ip(7)</a>, <a href="ipv6.7.html">ipv6(7)</a>, <a href="packet.7.html">packet(7)</a>, <a href="tcp.7.html">tcp(7)</a>, <a href="udp.7.html">udp(7)</a>, <a href="unix.7.html">unix(7)</a>, <a href="../man8/tcpdump.8.html">tcpdump(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>man-pages</i> (Linux kernel and C library
       user-space interface documentation) project.  Information about
       the project can be found at 
       ⟨<a href="https://www.kernel.org/doc/man-pages/">https://www.kernel.org/doc/man-pages/</a>⟩.  If you have a bug report
       for this manual page, see
       ⟨<a href="https://git.kernel.org/pub/scm/docs/man-pages/man-pages.git/tree/CONTRIBUTING">https://git.kernel.org/pub/scm/docs/man-pages/man-pages.git/tree/CONTRIBUTING</a>⟩.
       This page was obtained from the tarball man-pages-6.9.1.tar.gz
       fetched from
       ⟨<a href="https://mirrors.edge.kernel.org/pub/linux/docs/man-pages/">https://mirrors.edge.kernel.org/pub/linux/docs/man-pages/</a>⟩ on
       2024-06-26.  If you discover any rendering problems in this HTML
       version of the page, or you believe there is a better or more up-
       to-date source for the page, or you have corrections or
       improvements to the information in this COLOPHON (which is <i>not</i>
       part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Linux man-pages 6.9.1          2024-05-02                      <i>socket</i>(7)</span>
</pre>  <p>Pages that refer to this page: <a href="../man2/accept.2.html">accept(2)</a>, <a href="../man2/bind.2.html">bind(2)</a>, <a href="../man2/bpf.2.html">bpf(2)</a>, <a href="../man2/getpeername.2.html">getpeername(2)</a>, <a href="../man2/getsockname.2.html">getsockname(2)</a>, <a href="../man2/getsockopt.2.html">getsockopt(2)</a>, <a href="../man2/intro.2.html">intro(2)</a>, <a href="../man2/listen.2.html">listen(2)</a>, <a href="../man2/recv.2.html">recv(2)</a>, <a href="../man2/recvmmsg.2.html">recvmmsg(2)</a>, <a href="../man2/seccomp.2.html">seccomp(2)</a>, <a href="../man2/send.2.html">send(2)</a>, <a href="../man2/sendmmsg.2.html">sendmmsg(2)</a>, <a href="../man2/shutdown.2.html">shutdown(2)</a>, <a href="../man2/socket.2.html">socket(2)</a>, <a href="../man2/socketpair.2.html">socketpair(2)</a>, <a href="../man3/cmsg.3.html">cmsg(3)</a>, <a href="../man3/sd_is_fifo.3.html">sd_is_fifo(3)</a>, <a href="../man3/sd_journal_print.3.html">sd_journal_print(3)</a>, <a href="../man3/sockaddr.3type.html">sockaddr(3type)</a>, <a href="../man5/systemd.exec.5.html">systemd.exec(5)</a>, <a href="../man5/systemd.network.5.html">systemd.network(5)</a>, <a href="../man5/systemd.socket.5.html">systemd.socket(5)</a>, <a href="address_families.7.html">address_families(7)</a>, <a href="bpf-helpers.7.html">bpf-helpers(7)</a>, <a href="ddp.7.html">ddp(7)</a>, <a href="ip.7.html">ip(7)</a>, <a href="ipv6.7.html">ipv6(7)</a>, <a href="packet.7.html">packet(7)</a>, <a href="raw.7.html">raw(7)</a>, <a href="sctp.7.html">sctp(7)</a>, <a href="tcp.7.html">tcp(7)</a>, <a href="udp.7.html">udp(7)</a>, <a href="udplite.7.html">udplite(7)</a>, <a href="unix.7.html">unix(7)</a>, <a href="x25.7.html">x25(7)</a>, <a href="../man8/ping.8.html">ping(8)</a>, <a href="../man8/tc-etf.8.html">tc-etf(8)</a>, <a href="../man8/tc-fq.8.html">tc-fq(8)</a>, <a href="../man8/tc-mqprio.8.html">tc-mqprio(8)</a>, <a href="../man8/tc-prio.8.html">tc-prio(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man7/socket.7.html" class="_attribution-link">https://man7.org/linux/man-pages/man7/socket.7.html</a>
  </p>
</div>
