<h1>pcap_set_protocol_linux(3pcap) — Linux manual page</h1>   <pre>
<span class="headline"><i>PCAP_SET_PROTOCOL_LINUX</i>(3PCAP)            <i>PCAP_SET_PROTOCOL_LINUX</i>(3PCAP)</span>
</pre> <h2>
NAME </h2>
<pre>
       pcap_set_protocol_linux - set capture protocol for a not-yet-
       activated capture handle
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;pcap/pcap.h&gt;</b>

       <b>int pcap_set_protocol_linux(pcap_t *p, int protocol);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       On network interface devices on Linux, <b>pcap_set_protocol_linux</b>()
       sets the protocol to be used in the <a href="../man2/socket.2.html">socket(2)</a> call to create a
       capture socket when the handle is activated.  The argument is a
       link-layer protocol value, such as the values in the
       <b>&lt;linux/if_ether.h&gt; </b>header file, specified in host byte order.  If
       <i>protocol</i> is non-zero, packets of that protocol will be captured
       when the handle is activated, otherwise, all packets will be
       captured.  This function is only provided on Linux, and, if it is
       used on any device other than a network interface, it will have
       no effect.

       It should not be used in portable code; instead, a filter should
       be specified with <b>pcap_setfilter</b>(3PCAP).

       If a given network interface provides a standard link-layer
       header, with a standard packet type, but provides some packet
       types with a different socket-layer protocol type from the one in
       the link-layer header, that packet type cannot be filtered with a
       filter specified with <b>pcap_setfilter</b>() but can be filtered by
       specifying the socket-layer protocol type using
       <b>pcap_set_protocol_linux</b>().
</pre> <h2>
RETURN VALUE </h2>
<pre>
       <b>pcap_set_protocol_linux</b>() returns <b>0 </b>on success or
       <b>PCAP_ERROR_ACTIVATED </b>if called on a capture handle that has been
       activated.
</pre> <h2>
BACKWARD COMPATIBILITY </h2>
<pre>
       This function became available in libpcap release 1.9.0.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <b>pcap</b>(3PCAP), <b>pcap_create</b>(3PCAP), <b>pcap_activate</b>(3PCAP)
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libpcap</i> (packet capture library)
       project.  Information about the project can be found at 
       ⟨<a href="http://www.tcpdump.org/">http://www.tcpdump.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="http://www.tcpdump.org/#patches">http://www.tcpdump.org/#patches</a>⟩.  This page
       was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/the-tcpdump-group/libpcap.git">https://github.com/the-tcpdump-group/libpcap.git</a>⟩ on 2024-06-14.
       (At that time, the date of the most recent commit that was found
       in the repository was 2024-06-04.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                             22 August 2018<i>PCAP_SET_PROTOCOL_LINUX</i>(3PCAP)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pcap_set_protocol_linux.3pcap.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pcap_set_protocol_linux.3pcap.html</a>
  </p>
</div>
