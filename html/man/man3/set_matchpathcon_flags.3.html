<h1>set_matchpathcon_flags(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>set_matc...on_flags</i>(3)  SELinux API documentation <i>set_matc...on_flags</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       set_matchpathcon_flags, set_matchpathcon_invalidcon,
       set_matchpathcon_printf - set flags controlling the operation of
       matchpathcon or matchpathcon_index and configure the behaviour of
       validity checking and error displaying
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;selinux/selinux.h&gt;</b>

       <b>void set_matchpathcon_flags(unsigned int </b><i>flags</i><b>);</b>

       <b>void set_matchpathcon_invalidcon(int (*</b><i>f</i><b>)(const char *</b><i>path</i><b>,</b>
       <b>unsigned </b><i>lineno</i><b>, char *</b><i>context</i><b>));</b>

       <b>void set_matchpathcon_printf(void (*</b><i>f</i><b>)(const char *</b><i>fmt</i><b>, ...));</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>set_matchpathcon_flags</b>() sets the flags controlling the operation
       of <a href="matchpathcon_init.3.html">matchpathcon_init(3)</a> and subsequently <a href="matchpathcon_index.3.html">matchpathcon_index(3)</a> or
       <a href="matchpathcon.3.html">matchpathcon(3)</a>.  If the <b>MATCHPATHCON_BASEONLY </b>flag is set, then
       only the base file contexts configuration file will be processed,
       not any dynamically generated entries or local customizations.

       <b>set_matchpathcon_invalidcon</b>() sets the function used by
       <a href="matchpathcon_init.3.html">matchpathcon_init(3)</a> when checking the validity of a context in
       the file contexts configuration.  If not set, then this defaults
       to a test based on <a href="security_check_context.3.html">security_check_context(3)</a>, which checks
       validity against the active policy on a SELinux system.  This can
       be set to instead perform checking based on a binary policy file,
       e.g. using <a href="sepol_check_context.3.html">sepol_check_context(3)</a>, as is done by <b>setfiles -c.</b>
       The function is also responsible for reporting any such error,
       and may include the <i>path</i> and <i>lineno</i> in such error messages.

       <b>set_matchpathcon_printf</b>() sets the function used by
       <a href="matchpathcon_init.3.html">matchpathcon_init(3)</a> when displaying errors about the file
       contexts configuration.  If not set, then this defaults to
       fprintf(stderr, fmt, ...).  This can be set to redirect error
       reporting to a different destination.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Returns zero on success or -1 otherwise.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man8/selinux.8.html">selinux(8)</a>, <a href="matchpathcon.3.html">matchpathcon(3)</a>, <a href="matchpathcon_index.3.html">matchpathcon_index(3)</a>,
       <a href="set_matchpathcon_invalidcon.3.html">set_matchpathcon_invalidcon(3)</a>, <a href="set_matchpathcon_printf.3.html">set_matchpathcon_printf(3)</a>,
       <a href="freecon.3.html">freecon(3)</a>, <a href="setfilecon.3.html">setfilecon(3)</a>, <a href="setfscreatecon.3.html">setfscreatecon(3)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">sds@tycho.nsa.gov           21 November 2009      <i>set_matc...on_flags</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="matchpathcon.3.html">matchpathcon(3)</a>, <a href="set_matchpathcon_flags.3.html">set_matchpathcon_flags(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/set_matchpathcon_flags.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/set_matchpathcon_flags.3.html</a>
  </p>
</div>
