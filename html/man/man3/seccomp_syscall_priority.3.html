<h1>seccomp_syscall_priority(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>seccomp_...priority</i>(3)  libseccomp Documentation  <i>seccomp_...priority</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       seccomp_syscall_priority - Prioritize syscalls in the seccomp
       filter
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;seccomp.h&gt;</b>

       <b>typedef void * scmp_filter_ctx;</b>

       <b>int SCMP_SYS(</b><i>syscall_name</i><b>);</b>

       <b>int seccomp_syscall_priority(scmp_filter_ctx </b><i>ctx</i><b>,</b>
                                    <b>int </b><i>syscall</i><b>, uint8_t </b><i>priority</i><b>);</b>

       Link with <i>-lseccomp</i>.
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>seccomp_syscall_priority</b>() function provides a priority hint
       to the seccomp filter generator in libseccomp such that higher
       priority syscalls are placed earlier in the seccomp filter code
       so that they incur less overhead at the expense of lower priority
       syscalls.  A syscall's priority can be set regardless of if any
       rules currently exist for that syscall; the library will remember
       the priority and it will be assigned to the syscall if and when a
       rule for that syscall is created.

       While it is possible to specify the <i>syscall</i> value directly using
       the standard <b>__NR_syscall </b>values, in order to ensure proper
       operation across multiple architectures it is highly recommended
       to use the <b>SCMP_SYS</b>() macro instead.  See the EXAMPLES section
       below.

       The <i>priority</i> parameter takes an 8-bit value ranging from 0 - 255;
       a higher value represents a higher priority.

       The filter context <i>ctx</i> is the value returned by the call to
       <b>seccomp_init</b>().
</pre> <h2>
RETURN VALUE </h2>
<pre>
       The <b>SCMP_SYS</b>() macro returns a value suitable for use as the
       <i>syscall</i> value in <b>seccomp_syscall_priority</b>().

       The <b>seccomp_syscall_priority</b>() function returns zero on success
       or one of the following error codes on failure:

       <b>-EDOM  </b>Architecture specific failure.

       <b>-EFAULT</b>
              Internal libseccomp failure.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is
              invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.
</pre> <h2>
EXAMPLES </h2>
<pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            rc = seccomp_syscall_priority(ctx, SCMP_SYS(read), 200);
            if (rc &lt; 0)
                 goto out;

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }
</pre> <h2>
NOTES </h2>
<pre>
       While the seccomp filter can be generated independent of the
       kernel, kernel support is required to load and enforce the
       seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the source
       code repository, can be found at
       <a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>.  This tool, as well as the
       libseccomp library, is currently under development, please report
       any bugs at the project site or directly to the author.
</pre> <h2>
AUTHOR </h2>
<pre>
       Paul Moore &lt;paul@paul-moore.com&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="seccomp_rule_add.3.html">seccomp_rule_add(3)</a>, <a href="seccomp_rule_add_exact.3.html">seccomp_rule_add_exact(3)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libseccomp</i> (high-level API to the Linux
       Kernel's seccomp filter) project.  Information about the project
       can be found at ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩.  If you
       have a bug report for this manual page, see
       ⟨<a href="https://groups.google.com/d/forum/libseccomp">https://groups.google.com/d/forum/libseccomp</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-04-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">paul@paul-moore.com            30 May 2020        <i>seccomp_...priority</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="seccomp_attr_set.3.html">seccomp_attr_set(3)</a>, <a href="seccomp_rule_add.3.html">seccomp_rule_add(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/seccomp_syscall_priority.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/seccomp_syscall_priority.3.html</a>
  </p>
</div>
