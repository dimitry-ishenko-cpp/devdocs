<h1>seccomp_merge(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>seccomp_merge</i>(3)        libseccomp Documentation        <i>seccomp_merge</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       seccomp_merge - Merge two seccomp filters
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;seccomp.h&gt;</b>

       <b>typedef void * scmp_filter_ctx;</b>

       <b>int seccomp_merge(scmp_filter_ctx </b><i>dst</i><b>, scmp_filter_ctx </b><i>src</i><b>);</b>

       Link with <i>-lseccomp</i>.
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>seccomp_merge</b>() function merges the seccomp filter in <i>src</i>
       with the filter in <i>dst</i> and stores the resulting in the <i>dst</i>
       filter.  If successful, the <i>src</i> seccomp filter is released and
       all internal memory associated with the filter is freed; there is
       no need to call <a href="seccomp_release.3.html">seccomp_release(3)</a> on <i>src</i> and the caller should
       discard any references to the filter.

       In order to merge two seccomp filters, both filters must have the
       same attribute values and no overlapping architectures.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Returns zero on success or one of the following error codes on
       failure:

       <b>-EDOM  </b>Unable to merge the filters due to architecture issues,
              e.g. byte endian mismatches.

       <b>-EEXIST</b>
              The architecture already exists in the filter.

       <b>-EINVAL</b>
              One of the filters is invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.
</pre> <h2>
EXAMPLES </h2>
<pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx_32, ctx_64;

            ctx_32 = seccomp_init(SCMP_ACT_KILL);
            if (ctx_32 == NULL)
                 goto out_all;
            ctx_64 = seccomp_init(SCMP_ACT_KILL);
            if (ctx_64 == NULL)
                 goto out_all;

            if (seccomp_arch_exist(ctx_32, SCMP_ARCH_X86) == -EEXIST) {
                 rc = seccomp_arch_add(ctx_32, SCMP_ARCH_X86);
                 if (rc != 0)
                      goto out_all;
                 rc = seccomp_arch_remove(ctx_32, SCMP_ARCH_NATIVE);
                 if (rc != 0)
                      goto out_all;
            }
            if (seccomp_arch_exist(ctx_64, SCMP_ARCH_X86_64) == -EEXIST) {
                 rc = seccomp_arch_add(ctx_64, SCMP_ARCH_X86_64);
                 if (rc != 0)
                      goto out_all;
                 rc = seccomp_arch_remove(ctx_64, SCMP_ARCH_NATIVE);
                 if (rc != 0)
                      goto out_all;
            }

            /* ... */

            rc = seccomp_merge(ctx_64, ctx_32);
            if (rc != 0)
                 goto out_all;

            /* NOTE: the 'ctx_32' filter is no longer valid at this point */

            /* ... */

       out:
            seccomp_release(ctx_64);
            return -rc;
       out_all:
            seccomp_release(ctx_32);
            goto out;
       }
</pre> <h2>
NOTES </h2>
<pre>
       While the seccomp filter can be generated independent of the
       kernel, kernel support is required to load and enforce the
       seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the source
       code repository, can be found at
       <a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>.  This tool, as well as the
       libseccomp library, is currently under development, please report
       any bugs at the project site or directly to the author.
</pre> <h2>
AUTHOR </h2>
<pre>
       Paul Moore &lt;paul@paul-moore.com&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="seccomp_init.3.html">seccomp_init(3)</a>, <a href="seccomp_reset.3.html">seccomp_reset(3)</a>, <a href="seccomp_arch_add.3.html">seccomp_arch_add(3)</a>,
       <a href="seccomp_arch_remove.3.html">seccomp_arch_remove(3)</a>, <a href="seccomp_attr_get.3.html">seccomp_attr_get(3)</a>, <a href="seccomp_attr_set.3.html">seccomp_attr_set(3)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libseccomp</i> (high-level API to the Linux
       Kernel's seccomp filter) project.  Information about the project
       can be found at ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩.  If you
       have a bug report for this manual page, see
       ⟨<a href="https://groups.google.com/d/forum/libseccomp">https://groups.google.com/d/forum/libseccomp</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-04-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">paul@paul-moore.com            30 May 2020              <i>seccomp_merge</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="seccomp_arch_add.3.html">seccomp_arch_add(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/seccomp_merge.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/seccomp_merge.3.html</a>
  </p>
</div>
