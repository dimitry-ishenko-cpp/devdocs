<h1>seccomp_export_bpf(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>seccomp_export_bpf</i>(3)   libseccomp Documentation   <i>seccomp_export_bpf</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       seccomp_export_bpf, seccomp_export_pfc - Export the seccomp
       filter
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;seccomp.h&gt;</b>

       <b>typedef void * scmp_filter_ctx;</b>

       <b>int seccomp_export_bpf(const scmp_filter_ctx </b><i>ctx</i><b>, int </b><i>fd</i><b>);</b>
       <b>int seccomp_export_pfc(const scmp_filter_ctx </b><i>ctx</i><b>, int </b><i>fd</i><b>);</b>
       <b>int seccomp_export_bpf_mem(const scmp_filter_ctx </b><i>ctx</i><b>, void *</b><i>buf</i><b>, size_t *</b><i>len</i><b>);</b>

       Link with <i>-lseccomp</i>.
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>seccomp_export_bpf</b>() and <b>seccomp_export_pfc</b>() functions
       generate and output the current seccomp filter in either BPF
       (Berkeley Packet Filter) or PFC (Pseudo Filter Code).  The output
       of <b>seccomp_export_bpf</b>() is suitable for loading into the kernel,
       while the output of <b>seccomp_export_pfc</b>() is human readable and is
       intended primarily as a debugging tool for developers using
       libseccomp.  Both functions write the filter to the <i>fd</i> file
       descriptor.

       The filter context <i>ctx</i> is the value returned by the call to
       <a href="seccomp_init.3.html">seccomp_init(3)</a>.

       While the two output formats are guaranteed to be functionally
       equivalent for the given seccomp filter configuration, the filter
       instructions, and their ordering, are not guaranteed to be the
       same in both the BPF and PFC formats.

       The <b>seccomp_export_bpf_mem</b>() function is largely the same as
       <b>seccomp_export_bpf</b>(), but instead of writing to a file
       descriptor, the program will be written to the <i>buf</i> pointer
       provided by the caller.  The <i>len</i> argument must be initialized
       with the size of the <i>buf</i> buffer.  If the program was valid, <i>len</i>
       will be updated with its size in bytes.  If <i>buf</i> was too small to
       hold the program, <i>len</i> can be consulted to determine the required
       size.  Passing a NULL <i>buf</i> may also be used to query the required
       size ahead of time.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Return zero on success or one of the following error codes on
       failure:

       <b>-ECANCELED</b>
              There was a system failure beyond the control of the
              library.

       <b>-EFAULT</b>
              Internal libseccomp failure.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is
              invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

       <b>-ERANGE</b>
              The provided buffer was too small.

       If the <i>SCMP_FLTATR_API_SYSRAWRC</i> filter attribute is non-zero then
       additional error codes may be returned to the caller; these
       additional error codes are the negative <i><a href="errno.3.html">errno</a></i> values returned by
       the system.  Unfortunately libseccomp can make no guarantees
       about these return values.
</pre> <h2>
EXAMPLES </h2>
<pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;
            int filter_fd;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            filter_fd = open("/tmp/seccomp_filter.bpf", O_WRONLY);
            if (filter_fd == -1) {
                 rc = -errno;
                 goto out;
            }

            rc = seccomp_export_bpf(ctx, filter_fd);
            if (rc &lt; 0) {
                 close(filter_fd);
                 goto out;
            }
            close(filter_fd);

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }
</pre> <h2>
NOTES </h2>
<pre>
       While the seccomp filter can be generated independent of the
       kernel, kernel support is required to load and enforce the
       seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the source
       code repository, can be found at
       <a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>.  This tool, as well as the
       libseccomp library, is currently under development, please report
       any bugs at the project site or directly to the author.
</pre> <h2>
AUTHOR </h2>
<pre>
       Paul Moore &lt;paul@paul-moore.com&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="seccomp_init.3.html">seccomp_init(3)</a>, <a href="seccomp_release.3.html">seccomp_release(3)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libseccomp</i> (high-level API to the Linux
       Kernel's seccomp filter) project.  Information about the project
       can be found at ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩.  If you
       have a bug report for this manual page, see
       ⟨<a href="https://groups.google.com/d/forum/libseccomp">https://groups.google.com/d/forum/libseccomp</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-04-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">paul@paul-moore.com            30 May 2020         <i>seccomp_export_bpf</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="../man2/seccomp.2.html">seccomp(2)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/seccomp_export_bpf.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/seccomp_export_bpf.3.html</a>
  </p>
</div>
