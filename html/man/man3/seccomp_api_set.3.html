<h1>seccomp_api_get(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>seccomp_api_get</i>(3)      libseccomp Documentation      <i>seccomp_api_get</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       seccomp_api_get, seccomp_api_set - Manage the libseccomp API
       level
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;seccomp.h&gt;</b>

       <b>const unsigned int seccomp_api_get(</b><i>void</i><b>);</b>
       <b>int seccomp_api_set(unsigned int </b><i>level</i><b>);</b>

       Link with <i>-lseccomp</i>.
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>seccomp_api_get</b>() function returns an integer representing
       the functionality ("API level") provided by the current running
       kernel.  It is important to note that while <b>seccomp_api_get</b>() can
       be called multiple times, the kernel is only probed the first
       time to see what functionality is supported, all following calls
       to <b>seccomp_api_get</b>() return a cached value.

       The <b>seccomp_api_set</b>() function allows callers to force the API
       level to the provided value; however, this is almost always a bad
       idea and use of this function is strongly discouraged.

       The different API level values are described below:

       <b>0      </b>Reserved value, not currently used.

       <b>1      </b>Base level support.

       <b>2      </b>The SCMP_FLTATR_CTL_TSYNC filter attribute is supported
              and libseccomp uses the <a href="../man2/seccomp.2.html">seccomp(2)</a> syscall to load the
              seccomp filter into the kernel.

       <b>3      </b>The SCMP_FLTATR_CTL_LOG filter attribute and the
              SCMP_ACT_LOG action are supported.

       <b>4      </b>The SCMP_FLTATR_CTL_SSB filter attribute is supported.

       <b>5      </b>The SCMP_ACT_NOTIFY action and the notify APIs are
              supported.

       <b>6      </b>The simultaneous use of SCMP_FLTATR_CTL_TSYNC and the
              notify APIs are supported.

       <b>7      </b>The SCMP_FLTATR_CTL_WAITKILL filter attribute is
              supported.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       The <b>seccomp_api_get</b>() function returns an integer representing
       the supported API level.  The <b>seccomp_api_set</b>() function returns
       zero on success, negative values on failure.
</pre> <h2>
EXAMPLES </h2>
<pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            unsigned int api;

            api = seccomp_api_get();
            switch (api) {
            case 2:
                 /* ... */
            default:
                 /* ... */
            }

            return 0;

       err:
            return 1;
       }
</pre> <h2>
NOTES </h2>
<pre>
       While the seccomp filter can be generated independent of the
       kernel, kernel support is required to load and enforce the
       seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the source
       code repository, can be found at
       <a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>.  This tool, as well as the
       libseccomp library, is currently under development, please report
       any bugs at the project site or directly to the author.
</pre> <h2>
AUTHOR </h2>
<pre>
       Paul Moore &lt;paul@paul-moore.com&gt;
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libseccomp</i> (high-level API to the Linux
       Kernel's seccomp filter) project.  Information about the project
       can be found at ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩.  If you
       have a bug report for this manual page, see
       ⟨<a href="https://groups.google.com/d/forum/libseccomp">https://groups.google.com/d/forum/libseccomp</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-04-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">paul@paul-moore.com         22 September 2022         <i>seccomp_api_get</i>(3)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/seccomp_api_set.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/seccomp_api_set.3.html</a>
  </p>
</div>
