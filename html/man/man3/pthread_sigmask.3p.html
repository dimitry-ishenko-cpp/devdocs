<h1>pthread_sigmask(3p) — Linux manual page</h1>   <pre>
<span class="headline"><i>PTHREAD_SIGMASK</i>(3P)     POSIX Programmer's Manual    <i>PTHREAD_SIGMASK</i>(3P)</span>
</pre> <h2>
PROLOG </h2>
<pre>
       This manual page is part of the POSIX Programmer's Manual.  The
       Linux implementation of this interface may differ (consult the
       corresponding Linux manual page for details of Linux behavior),
       or the interface may not be implemented on Linux.
</pre> <h2>
NAME </h2>
<pre>
       pthread_sigmask, sigprocmask — examine and change blocked signals
</pre> <h2>
SYNOPSIS </h2>
<pre>
       #include &lt;signal.h&gt;

       int pthread_sigmask(int <i>how</i>, const sigset_t *restrict <i>set</i>,
           sigset_t *restrict <i>oset</i>);
       int sigprocmask(int <i>how</i>, const sigset_t *restrict <i>set</i>,
           sigset_t *restrict <i>oset</i>);
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <i>pthread_sigmask</i>() function shall examine or change (or both)
       the calling thread's signal mask, regardless of the number of
       threads in the process. The function shall be equivalent to
       <i>sigprocmask</i>(), without the restriction that the call be made in a
       single-threaded process.

       In a single-threaded process, the <i>sigprocmask</i>() function shall
       examine or change (or both) the signal mask of the calling
       thread.

       If the argument <i>set</i> is not a null pointer, it points to a set of
       signals to be used to change the currently blocked set.

       The argument <i>how</i> indicates the way in which the set is changed,
       and the application shall ensure it consists of one of the
       following values:

       SIG_BLOCK   The resulting set shall be the union of the current
                   set and the signal set pointed to by <i>set</i>.

       SIG_SETMASK The resulting set shall be the signal set pointed to
                   by <i>set</i>.

       SIG_UNBLOCK The resulting set shall be the intersection of the
                   current set and the complement of the signal set
                   pointed to by <i>set</i>.

       If the argument <i>oset</i> is not a null pointer, the previous mask
       shall be stored in the location pointed to by <i>oset</i>.  If <i>set</i> is a
       null pointer, the value of the argument <i>how</i> is not significant
       and the thread's signal mask shall be unchanged; thus the call
       can be used to enquire about currently blocked signals.

       If there are any pending unblocked signals after the call to
       <i>sigprocmask</i>(), at least one of those signals shall be delivered
       before the call to <i>sigprocmask</i>() returns.

       It is not possible to block those signals which cannot be
       ignored.  This shall be enforced by the system without causing an
       error to be indicated.

       If any of the SIGFPE, SIGILL, SIGSEGV, or SIGBUS signals are
       generated while they are blocked, the result is undefined, unless
       the signal was generated by the action of another process, or by
       one of the functions <i>kill</i>(), <i>pthread_kill</i>(), <i>raise</i>(), or
       <i>sigqueue</i>().

       If <i>sigprocmask</i>() fails, the thread's signal mask shall not be
       changed.

       The use of the <i>sigprocmask</i>() function is unspecified in a multi-
       threaded process.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Upon successful completion <i>pthread_sigmask</i>() shall return 0;
       otherwise, it shall return the corresponding error number.

       Upon successful completion, <i>sigprocmask</i>() shall return 0;
       otherwise, -1 shall be returned, <i><a href="errno.3.html">errno</a></i> shall be set to indicate
       the error, and the signal mask of the process shall be unchanged.
</pre> <h2>
ERRORS </h2>
<pre>
       The <i>pthread_sigmask</i>() and <i>sigprocmask</i>() functions shall fail if:

       <b>EINVAL </b>The value of the <i>how</i> argument is not equal to one of the
              defined values.

       The <i>pthread_sigmask</i>() function shall not return an error code of
       <b>[EINTR]</b>.

       <i>The following sections are informative.</i>
</pre> <h2>
EXAMPLES </h2>
<pre>
   <b>Signaling in a Multi-Threaded Process</b>
       This example shows the use of <i>pthread_sigmask</i>() in order to deal
       with signals in a multi-threaded process. It provides a fairly
       general framework that could be easily adapted/extended.

           #include &lt;stdio.h&gt;
           #include &lt;stdlib.h&gt;
           #include &lt;pthread.h&gt;
           #include &lt;signal.h&gt;
           #include &lt;string.h&gt;
           #include &lt;errno.h&gt;
           ...

           static sigset_t   signal_mask;  /* signals to block         */

           int main (int argc, char *argv[])
           {
               pthread_t  sig_thr_id;      /* signal handler thread ID */
               int        rc;              /* return code              */

               sigemptyset (&amp;signal_mask);
               sigaddset (&amp;signal_mask, SIGINT);
               sigaddset (&amp;signal_mask, SIGTERM);
               rc = pthread_sigmask (SIG_BLOCK, &amp;signal_mask, NULL);
               if (rc != 0) {
                   /* handle error */
                   ...
               }
               /* any newly created threads inherit the signal mask */

               rc = pthread_create (&amp;sig_thr_id, NULL, signal_thread, NULL);
               if (rc != 0) {
                   /* handle error */
                   ...
               }

               /* APPLICATION CODE */
               ...
           }

           void *signal_thread (void *arg)
           {
               int       sig_caught;    /* signal caught       */
               int       rc;            /* returned code       */

               rc = sigwait (&amp;signal_mask, &amp;sig_caught);
               if (rc != 0) {
                   /* handle error */
               }
               switch (sig_caught)
               {
               case SIGINT:     /* process SIGINT  */
                   ...
                   break;
               case SIGTERM:    /* process SIGTERM */
                   ...
                   break;
               default:         /* should normally not happen */
                   fprintf (stderr, "\nUnexpected signal %d\n", sig_caught);
                   break;
               }
           }
</pre> <h2>
APPLICATION USAGE </h2>
<pre>
       None.
</pre> <h2>
RATIONALE </h2>
<pre>
       When a thread's signal mask is changed in a signal-catching
       function that is installed by <i>sigaction</i>(), the restoration of the
       signal mask on return from the signal-catching function overrides
       that change (see <i>sigaction</i>()).  If the signal-catching function
       was installed with <i>signal</i>(), it is unspecified whether this
       occurs.

       See <i>kill</i>() for a discussion of the requirement on delivery of
       signals.
</pre> <h2>
FUTURE DIRECTIONS </h2>
<pre>
       None.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man1/exec.1p.html">exec(1p)</a>, <a href="kill.3p.html">kill(3p)</a>, <a href="sigaction.3p.html">sigaction(3p)</a>, <a href="sigaddset.3p.html">sigaddset(3p)</a>, <a href="sigdelset.3p.html">sigdelset(3p)</a>,
       <a href="sigemptyset.3p.html">sigemptyset(3p)</a>, <a href="sigfillset.3p.html">sigfillset(3p)</a>, <a href="sigismember.3p.html">sigismember(3p)</a>, <a href="sigpending.3p.html">sigpending(3p)</a>,
       <a href="sigqueue.3p.html">sigqueue(3p)</a>, <a href="sigsuspend.3p.html">sigsuspend(3p)</a>

       The Base Definitions volume of POSIX.1‐2017, <a href="../man0/signal.h.0p.html">signal.h(0p)</a>
</pre> <h2>
COPYRIGHT </h2>
<pre>
       Portions of this text are reprinted and reproduced in electronic
       form from IEEE Std 1003.1-2017, Standard for Information
       Technology -- Portable Operating System Interface (POSIX), The
       Open Group Base Specifications Issue 7, 2018 Edition, Copyright
       (C) 2018 by the Institute of Electrical and Electronics
       Engineers, Inc and The Open Group.  In the event of any
       discrepancy between this version and the original IEEE and The
       Open Group Standard, the original IEEE and The Open Group
       Standard is the referee document. The original Standard can be
       obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any typographical or formatting errors that appear in this page
       are most likely to have been introduced during the conversion of
       the source files to man page format. To report such errors, see
       <a href="https://www.kernel.org/doc/man-pages/reporting_bugs.html">https://www.kernel.org/doc/man-pages/reporting_bugs.html</a> .

<span class="footline">IEEE/The Open Group               2017               <i>PTHREAD_SIGMASK</i>(3P)</span>
</pre>  <p>Pages that refer to this page: <a href="../man0/signal.h.0p.html">signal.h(0p)</a>, <a href="exec.3p.html">exec(3p)</a>, <a href="sigaction.3p.html">sigaction(3p)</a>, <a href="sigaddset.3p.html">sigaddset(3p)</a>, <a href="sigdelset.3p.html">sigdelset(3p)</a>, <a href="sigemptyset.3p.html">sigemptyset(3p)</a>, <a href="sigfillset.3p.html">sigfillset(3p)</a>, <a href="sighold.3p.html">sighold(3p)</a>, <a href="sigismember.3p.html">sigismember(3p)</a>, <a href="siglongjmp.3p.html">siglongjmp(3p)</a>, <a href="sigpending.3p.html">sigpending(3p)</a>, <a href="sigprocmask.3p.html">sigprocmask(3p)</a>, <a href="sigsetjmp.3p.html">sigsetjmp(3p)</a>, <a href="sigtimedwait.3p.html">sigtimedwait(3p)</a>, <a href="sigwait.3p.html">sigwait(3p)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pthread_sigmask.3p.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pthread_sigmask.3p.html</a>
  </p>
</div>
