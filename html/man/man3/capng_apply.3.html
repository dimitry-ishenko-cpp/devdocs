<h1>capng_apply(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>CAPNG_APPLY</i>(3)                Libcap-ng API               <i>CAPNG_APPLY</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       capng_apply - apply the stored capabilities settings
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;cap-ng.h&gt;</b>

       int capng_apply(capng_select_t set);
</pre> <h2>
DESCRIPTION </h2>
<pre>
       capng_apply will transfer the specified internal POSIX
       capabilities settings to the kernel. The options are
       CAPNG_SELECT_CAPS for the traditional capabilities,
       CAPNG_SELECT_BOUNDS for the bounding set, CAPNG_SELECT_BOTH if
       transferring both is desired, CAPNG_SELECT_AMBIENT if only
       operating on the ambient capabilities, or CAPNG_SELECT_ALL if
       applying all is desired.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       This returns 0 on success and a negative value on failure. The
       values are:

              -1 not initialized

              -2 CAPNG_SELECT_BOUNDS and failure to drop a bounding set
              capability

              -3 CAPNG_SELECT_BOUNDS and failure to re-read bounding set

              -4 CAPNG_SELECT_BOUNDS and process does not have
              CAP_SETPCAP

              -5 CAPNG_SELECT_CAPS and failure in capset syscall

              -6 CAPNG_SELECT_AMBIENT and process has no capabilities
              and failed clearing ambient capabilities

              -7 CAPNG_SELECT_AMBIENT and process has capabilities and
              failed clearing ambient capabilities

              -8 CAPNG_SELECT_AMBIENT and process has capabilities and
              failed setting an ambient capability

              -9 Unable to acquire process capabilities to check if
              CAP_SETPCAP is set.
</pre> <h2>
NOTES </h2>
<pre>
       If you are doing multi-threaded programming, calling this
       function will only set capabilities on the calling thread. All
       other threads are unaffected. If you want to set overall
       capabilities for a multi-threaded process, you will need to do
       that before creating any threads. See the capset syscall for more
       information on this topic.

       Also, bits in the bounding set can only be dropped. You cannot
       set them. After dropping bounding set capabilities, the bounding
       set is synchronized with the kernel to reflect the true state in
       the kernel.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man2/capset.2.html">capset(2)</a>, <a href="capng_update.3.html">capng_update(3)</a>, <a href="../man7/capabilities.7.html">capabilities(7)</a>
</pre> <h2>
AUTHOR </h2>
<pre>
       Steve Grubb
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libcap-ng</i> (capabilities commands and
       library (NG)) project.  Information about the project can be
       found at ⟨<a href="https://people.redhat.com/sgrubb/libcap-ng/">https://people.redhat.com/sgrubb/libcap-ng/</a>⟩.  It is
       not known how to report bugs for this man page; if you know,
       please send a mail to man-pages@man7.org.  This page was obtained
       from the tarball libcap-ng-0.8.5.tar.gz fetched from
       ⟨<a href="https://people.redhat.com/sgrubb/libcap-ng/index.html">https://people.redhat.com/sgrubb/libcap-ng/index.html</a>⟩ on
       2024-06-14.  If you discover any rendering problems in this HTML
       version of the page, or you believe there is a better or more up-
       to-date source for the page, or you have corrections or
       improvements to the information in this COLOPHON (which is <i>not</i>
       part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Red Hat                         Sept 2023                 <i>CAPNG_APPLY</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="capng_change_id.3.html">capng_change_id(3)</a>, <a href="capng_fill.3.html">capng_fill(3)</a>, <a href="capng_lock.3.html">capng_lock(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/capng_apply.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/capng_apply.3.html</a>
  </p>
</div>
