<h1>keyctl_get_security(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>KEYCTL_GET_SECURITY</i>(3) Linux Key Management Calls <i>KEYCTL_GET_SECURITY</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       keyctl_get_security - retrieve a key's security context
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;keyutils.h&gt;</b>

       <b>long keyctl_get_security(key_serial_t </b><i>key</i><b>, char *</b><i>buffer</i><b>,</b>
       <b>size_t </b><i>buflen</i><b>);</b>

       <b>long keyctl_get_security_alloc(key_serial_t </b><i>key</i><b>, char **</b><i>_buffer</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>keyctl_get_security</b>() retrieves the security context of a key as
       a NUL-terminated string.  This will be rendered in a form
       appropriate to the LSM in force - for instance, with SELinux, it
       may look like

              <b>unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</b>

       The caller must have <b>view </b>permission on a key to be able to get
       its security context.

       <i>buffer</i> and <i>buflen</i> specify the buffer into which the string will
       be placed.  If the buffer is too small, the full size of the
       string will be returned, and no copy will take place.

       <b>keyctl_get_security_alloc</b>() is similar to <b>keyctl_get_security</b>()
       except that it allocates a buffer big enough to hold the string
       and copies the string into it.  If successful, A pointer to the
       buffer is placed in <i>*_buffer</i>.  The caller must free the buffer.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       On success <b>keyctl_get_security</b>() returns the amount of data
       placed into the buffer.  If the buffer was too small, then the
       size of buffer required will be returned, but no data will be
       transferred.  On error, the value <b>-1 </b>will be returned and <i><a href="errno.3.html">errno</a></i>
       will have been set to an appropriate error.

       On success <b>keyctl_get_security_alloc</b>() returns the amount of data
       in the buffer, less the NUL terminator.  On error, the value <b>-1</b>
       will be returned and <i><a href="errno.3.html">errno</a></i> will have been set to an appropriate
       error.
</pre> <h2>
ERRORS </h2>
<pre>
       <b>ENOKEY </b>The key specified is invalid.

       <b>EKEYEXPIRED</b>
              The key specified has expired.

       <b>EKEYREVOKED</b>
              The key specified had been revoked.

       <b>EACCES </b>The key exists, but is not <b>viewable </b>by the calling
              process.
</pre> <h2>
LINKING </h2>
<pre>
       This is a library function that can be found in <i>libkeyutils</i>.
       When linking, <b>-lkeyutils </b>should be specified to the linker.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man1/keyctl.1.html">keyctl(1)</a>, <a href="../man2/add_key.2.html">add_key(2)</a>, <a href="../man2/keyctl.2.html">keyctl(2)</a>, <a href="../man2/request_key.2.html">request_key(2)</a>, <a href="keyctl.3.html">keyctl(3)</a>,
       <a href="../man7/keyrings.7.html">keyrings(7)</a>, <a href="../man7/keyutils.7.html">keyutils(7)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>keyutils</i> (key management utilities)
       project.  Information about the project can be found at [unknown
       -- if you know, please contact man-pages@man7.org] If you have a
       bug report for this manual page, send it to
       keyrings@linux-nfs.org.  This page was obtained from the
       project's upstream Git repository
       ⟨<a href="http://git.kernel.org/pub/scm/linux/kernel/git/dhowells/keyutils.git">http://git.kernel.org/pub/scm/linux/kernel/git/dhowells/keyutils.git</a>⟩
       on 2024-06-14.  (At that time, the date of the most recent commit
       that was found in the repository was 2023-03-20.)  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">Linux                          26 Feb 2010        <i>KEYCTL_GET_SECURITY</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="../man2/keyctl.2.html">keyctl(2)</a>, <a href="keyctl.3.html">keyctl(3)</a>, <a href="../man7/keyrings.7.html">keyrings(7)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/keyctl_get_security.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/keyctl_get_security.3.html</a>
  </p>
</div>
