<h1>audit_encode_nv_string(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>AUDIT_ENCODE_NV_STRING</i>(3)    Linux Audit API   <i>AUDIT_ENCODE_NV_STRING</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       audit_encode_nv_string - encode a name/value pair in a string
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;libaudit.h&gt;</b>

       <b>char *audit_encode_nv_string(const char *name, const char *value,</b>
       <b>unsigned int vlen)</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       This function is used to encode a name/value pair. This should be
       used on any field being logged that potentially contains a space,
       a double-quote, or a control character. Any value containing
       those have to be specially encoded for the auparse library to
       correctly handle the value. The encoding method is designed to
       prevent log injection attacks where malicious values could cause
       parsing errors.

       To use this function, pass the name string and value strings on
       their respective arguments. If the value is likely to have a NUL
       value embedded within it, you will need to pass a value length
       that tells in bytes how big the value is. Otherwise, you can pass
       a 0 for vlen and the function will simply use strlen against the
       value pointer. Also be aware that the name of the field will
       cause auparse to do certain things when interpreting the value.
       If the name is uid, a user id value in decimal is expected. Make
       sure that well known names are used for their intended purpose or
       that there is no chance of name collision with something new.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Returns a freshly malloc'ed string that the caller must free or
       NULL on error.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="audit_log_user_message.3.html">audit_log_user_message(3)</a>, <a href="audit_log_user_comm_message.3.html">audit_log_user_comm_message(3)</a>,
       <a href="audit_log_user_avc_message.3.html">audit_log_user_avc_message(3)</a>, <a href="audit_log_semanage_message.3.html">audit_log_semanage_message(3)</a>.
</pre> <h2>
AUTHOR </h2>
<pre>
       Steve Grubb
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>audit</i> (Linux Audit) project.
       Information about the project can be found at 
       ⟨<a href="http://people.redhat.com/sgrubb/audit/">http://people.redhat.com/sgrubb/audit/</a>⟩.  If you have a bug
       report for this manual page, send it to linux-audit@redhat.com.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/linux-audit/audit-userspace.git">https://github.com/linux-audit/audit-userspace.git</a>⟩ on
       2024-06-14.  (At that time, the date of the most recent commit
       that was found in the repository was 2024-06-12.)  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">Red Hat                         Oct 2010       <i>AUDIT_ENCODE_NV_STRING</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="audit_encode_value.3.html">audit_encode_value(3)</a>, <a href="audit_value_needs_encoding.3.html">audit_value_needs_encoding(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/audit_encode_nv_string.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/audit_encode_nv_string.3.html</a>
  </p>
</div>
