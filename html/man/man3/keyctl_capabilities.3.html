<h1>keyctl_capabilities(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>KEYCTL_CAPABILITIES</i>(3) Linux Key Management Calls <i>KEYCTL_CAPABILITIES</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       keyctl_capabilities - Query subsystem capabilities
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;keyutils.h&gt;</b>

       <b>long keyctl_capabilities(unsigned char *</b><i>buffer</i><b>, size_t </b><i>buflen</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>keyctl_capabilities</b>() queries the keyrings subsystem in the
       kernel to ask about its capabilities and fills in the array in
       the buffer with bits that indicate the presence or absence of
       specific features in the keyrings subsystem.

       The function returns the amount of data the kernel has available,
       irrespective of the amount of buffer space available.  If the
       buffer is shorter than the data, a short copy will be made; if
       the buffer is larger than the data, the excess space will be
       cleared.

       If this operation is not available in the kernel, the keyutils
       library will emulate it as best it can and the capability bit
       that indicates if the kernel operation is available will be
       cleared.

       In <i>buffer[0]</i>, the following capabilities exist:

       <b>KEYCTL_CAPS0_CAPABILITIES</b>
              This is set if the kernel supports this operation and
              cleared otherwise.  If it is cleared, the rest of the
              flags are emulated.

       <b>KEYCTL_CAPS0_PERSISTENT_KEYRINGS</b>
              This is set if the kernel supports persistent keyrings and
              cleared otherwise.  See <b>keyctl_get_persistent</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_DIFFIE_HELLMAN</b>
              This is set if the kernel supports Diffie-Hellman
              calculation and cleared otherwise.  See
              <b>keyctl_dh_compute</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_PUBLIC_KEY</b>
              This is set if the kernel supports public-key operations
              and cleared otherwise.  See <b>keyctl_pkey_query</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_BIG_KEY</b>
              This is set if the kernel supports the big_key key type
              and cleared otherwise.

       <b>KEYCTL_CAPS0_INVALIDATE</b>
              This is set if the kernel supports key invalidation and
              cleared otherwise.  See <b>keyctl_invalidate</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_RESTRICT_KEYRING</b>
              This is set if the kernel supports restrictions on
              keyrings and cleared otherwise.  See
              <b>keyctl_restrict_keyring</b>(<b>3</b>).

       <b>KEYCTL_CAPS0_MOVE</b>
              This is set if the kernel supports the move key operation
              and cleared otherwise.  See <b>keyctl_move</b>(<b>3</b>).

       In <i>buffer[1]</i>, the following capabilities exist:

       <b>KEYCTL_CAPS1_NS_KEYRING_NAME</b>
              This is set if the keyring names are segregated according
              to the user-namespace in which a keyring is created.

       <b>KEYCTL_CAPS1_NS_KEY_TAG</b>
              This is set if a key or keyring may get tagged with a
              namespace, thereby allowing multiple keys with the same
              type and description, but different namespace tags, to
              coexist within the same keyring.  Tagging may be automatic
              depending on the key type.  Only network-namespace tagging
              is currently used.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       On success <b>keyctl_capabilities</b>() returns the size of the data it
       has available, irrespective of the size of the buffer.  On error,
       the value <b>-1 </b>will be returned and <i><a href="errno.3.html">errno</a></i> will have been set to an
       appropriate error.
</pre> <h2>
ERRORS </h2>
<pre>
       <b>EFAULT </b>The buffer cannot be written to.
</pre> <h2>
LINKING </h2>
<pre>
       This is a library function that can be found in <i>libkeyutils</i>.
       When linking, <b>-lkeyutils </b>should be specified to the linker.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man1/keyctl.1.html">keyctl(1)</a>, <a href="../man2/add_key.2.html">add_key(2)</a>, <a href="../man2/keyctl.2.html">keyctl(2)</a>, <a href="../man2/request_key.2.html">request_key(2)</a>, <a href="keyctl.3.html">keyctl(3)</a>,
       <a href="../man7/keyrings.7.html">keyrings(7)</a>, <a href="../man7/keyutils.7.html">keyutils(7)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>keyutils</i> (key management utilities)
       project.  Information about the project can be found at [unknown
       -- if you know, please contact man-pages@man7.org] If you have a
       bug report for this manual page, send it to
       keyrings@linux-nfs.org.  This page was obtained from the
       project's upstream Git repository
       ⟨<a href="http://git.kernel.org/pub/scm/linux/kernel/git/dhowells/keyutils.git">http://git.kernel.org/pub/scm/linux/kernel/git/dhowells/keyutils.git</a>⟩
       on 2024-06-14.  (At that time, the date of the most recent commit
       that was found in the repository was 2023-03-20.)  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">Linux                          30 May 2019        <i>KEYCTL_CAPABILITIES</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="keyctl.3.html">keyctl(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/keyctl_capabilities.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/keyctl_capabilities.3.html</a>
  </p>
</div>
