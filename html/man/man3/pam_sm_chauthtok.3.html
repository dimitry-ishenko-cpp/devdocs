<h1>pam_sm_chauthtok(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>PAM_SM_CHAUTHTOK</i>(3)         Linux-PAM Manual         <i>PAM_SM_CHAUTHTOK</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       pam_sm_chauthtok - PAM service function for authentication token
       management
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;security/pam_modules.h&gt;</b>

       <b>int pam_sm_chauthtok(pam_handle_t *</b><i>pamh</i><b>, int </b><i>flags</i><b>, int </b><i>argc</i><b>,</b>
                            <b>const char **</b><i>argv</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>pam_sm_chauthtok </b>function is the service module's
       implementation of the <a href="pam_chauthtok.3.html">pam_chauthtok(3)</a> interface.

       This function is used to (re-)set the authentication token of the
       user.

       Valid flags, which may be logically OR'd with <i>PAM_SILENT</i>, are:

       PAM_SILENT
           Do not emit any messages.

       PAM_CHANGE_EXPIRED_AUTHTOK
           This argument indicates to the module that the user's
           authentication token (password) should only be changed if it
           has expired. This flag is optional and <i>must</i> be combined with
           one of the following two flags. Note, however, the following
           two options are <i>mutually exclusive</i>.

       PAM_PRELIM_CHECK
           This indicates that the modules are being probed as to their
           ready status for altering the user's authentication token. If
           the module requires access to another system over some
           network it should attempt to verify it can connect to this
           system on receiving this flag. If a module cannot establish
           it is ready to update the user's authentication token it
           should return <b>PAM_TRY_AGAIN</b>, this information will be passed
           back to the application.

           If the control value <i>sufficient</i> is used in the password
           stack, the <i>PAM_PRELIM_CHECK</i> section of the modules following
           that control value is not always executed.

       PAM_UPDATE_AUTHTOK
           This informs the module that this is the call it should
           change the authorization tokens. If the flag is logically
           OR'd with <b>PAM_CHANGE_EXPIRED_AUTHTOK</b>, the token is only
           changed if it has actually expired.

       The PAM library calls this function twice in succession. The
       first time with <b>PAM_PRELIM_CHECK </b>and then, if the module does not
       return <b>PAM_TRY_AGAIN</b>, subsequently with <b>PAM_UPDATE_AUTHTOK</b>. It is
       only on the second call that the authorization token is
       (possibly) changed.
</pre> <h2>
RETURN VALUES </h2>
<pre>
       PAM_AUTHTOK_ERR
           The module was unable to obtain the new authentication token.

       PAM_AUTHTOK_RECOVERY_ERR
           The module was unable to obtain the old authentication token.

       PAM_AUTHTOK_LOCK_BUSY
           Cannot change the authentication token since it is currently
           locked.

       PAM_AUTHTOK_DISABLE_AGING
           Authentication token aging has been disabled.

       PAM_PERM_DENIED
           Permission denied.

       PAM_TRY_AGAIN
           Preliminary check was unsuccessful. Signals an immediate
           return to the application is desired.

       PAM_SUCCESS
           The authentication token was successfully updated.

       PAM_USER_UNKNOWN
           User unknown to password service.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="pam.3.html">pam(3)</a>, <a href="pam_chauthtok.3.html">pam_chauthtok(3)</a>, <a href="pam_sm_chauthtok.3.html">pam_sm_chauthtok(3)</a>, <a href="pam_strerror.3.html">pam_strerror(3)</a>,
       <a href="../man8/pam.8.html">PAM(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>linux-pam</i> (Pluggable Authentication
       Modules for Linux) project.  Information about the project can be
       found at ⟨<a href="http://www.linux-pam.org/">http://www.linux-pam.org/</a>⟩.  If you have a bug report
       for this manual page, see ⟨//www.linux-pam.org/⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/linux-pam/linux-pam.git">https://github.com/linux-pam/linux-pam.git</a>⟩ on 2023-12-22.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-12-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Linux-PAM Manual               12/22/2023            <i>PAM_SM_CHAUTHTOK</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="pam_get_authtok.3.html">pam_get_authtok(3)</a>, <a href="pam_get_item.3.html">pam_get_item(3)</a>, <a href="pam_set_item.3.html">pam_set_item(3)</a>, <a href="pam_sm_acct_mgmt.3.html">pam_sm_acct_mgmt(3)</a>, <a href="pam_sm_chauthtok.3.html">pam_sm_chauthtok(3)</a>, <a href="../man8/pam_debug.8.html">pam_debug(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pam_sm_chauthtok.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pam_sm_chauthtok.3.html</a>
  </p>
</div>
