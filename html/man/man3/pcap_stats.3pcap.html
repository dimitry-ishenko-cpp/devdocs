<h1>pcap_stats(3pcap) — Linux manual page</h1>   <pre>
<span class="headline"><i>PCAP_STATS</i>(3PCAP)                                      <i>PCAP_STATS</i>(3PCAP)</span>
</pre> <h2>
NAME </h2>
<pre>
       pcap_stats - get capture statistics
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;pcap/pcap.h&gt;</b>

       <b>int pcap_stats(pcap_t *p, struct pcap_stat *ps);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>pcap_stats</b>() fills in the <b>struct pcap_stat </b>pointed to by its
       second argument.  The values represent packet statistics from the
       start of the run to the time of the call.

       <b>pcap_stats</b>() is supported only on live captures, not on
       ``savefiles''; no statistics are stored in ``savefiles'', so no
       statistics are available when reading from a ``savefile''.

       A <b>struct pcap_stat </b>has the following members:

              <b>ps_recv</b>
                     number of packets received;

              <b>ps_drop</b>
                     number of packets dropped because there was no room
                     in the operating system's buffer when they arrived,
                     because packets weren't being read fast enough;

              <b>ps_ifdrop</b>
                     number of packets dropped by the network interface
                     or its driver.

       The statistics do not behave the same way on all platforms.
       <b>ps_recv </b>might count packets whether they passed any filter set
       with <b>pcap_setfilter</b>(3PCAP) or not, or it might count only packets
       that pass the filter.  It also might, or might not, count packets
       dropped because there was no room in the operating system's
       buffer when they arrived.  <b>ps_drop </b>is not available on all
       platforms; it is zero on platforms where it's not available.  If
       packet filtering is done in libpcap, rather than in the operating
       system, it would count packets that don't pass the filter.  Both
       <b>ps_recv </b>and <b>ps_drop </b>might, or might not, count packets not yet
       read from the operating system and thus not yet seen by the
       application.  <b>ps_ifdrop </b>might, or might not, be implemented; if
       it's zero, that might mean that no packets were dropped by the
       interface, or it might mean that the statistic is unavailable, so
       it should not be treated as an indication that the interface did
       not drop any packets.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       <b>pcap_stats</b>() returns <b>0 </b>on success, <b>PCAP_ERROR_NOT_ACTIVATED </b>if
       called on a capture handle that has been created but not
       activated, or <b>PCAP_ERROR </b>if there is another error or if <i>p</i>
       doesn't support packet statistics. If <b>PCAP_ERROR </b>is returned,
       <b>pcap_geterr</b>(3PCAP) or <b>pcap_perror</b>(3PCAP) may be called with <i>p</i> as
       an argument to fetch or display the error text.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <b>pcap</b>(3PCAP)
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libpcap</i> (packet capture library)
       project.  Information about the project can be found at 
       ⟨<a href="http://www.tcpdump.org/">http://www.tcpdump.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="http://www.tcpdump.org/#patches">http://www.tcpdump.org/#patches</a>⟩.  This page
       was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/the-tcpdump-group/libpcap.git">https://github.com/the-tcpdump-group/libpcap.git</a>⟩ on 2024-06-14.
       (At that time, the date of the most recent commit that was found
       in the repository was 2024-06-04.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                              5 March 2022             <i>PCAP_STATS</i>(3PCAP)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pcap_stats.3pcap.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pcap_stats.3pcap.html</a>
  </p>
</div>
