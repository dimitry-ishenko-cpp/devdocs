<h1>pam_acct_mgmt(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>PAM_ACCT_MGMT</i>(3)            Linux-PAM Manual            <i>PAM_ACCT_MGMT</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       pam_acct_mgmt - PAM account validation management
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;security/pam_appl.h&gt;</b>

       <b>int pam_acct_mgmt(pam_handle_t *</b><i>pamh</i><b>, int </b><i>flags</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>pam_acct_mgmt </b>function is used to determine if the user's
       account is valid. It checks for authentication token and account
       expiration and verifies access restrictions. It is typically
       called after the user has been authenticated.

       The <i>pamh</i> argument is an authentication handle obtained by a prior
       call to pam_start(). The flags argument is the binary or of zero
       or more of the following values:

       PAM_SILENT
           Do not emit any messages.

       PAM_DISALLOW_NULL_AUTHTOK
           The PAM module service should return PAM_NEW_AUTHTOK_REQD if
           the user has a null authentication token.
</pre> <h2>
RETURN VALUES </h2>
<pre>
       PAM_ACCT_EXPIRED
           User account has expired.

       PAM_AUTH_ERR
           Authentication failure.

       PAM_NEW_AUTHTOK_REQD
           The user account is valid but their authentication token is
           <i>expired</i>. The correct response to this return-value is to
           require that the user satisfies the <b>pam_chauthtok() </b>function
           before obtaining service. It may not be possible for some
           applications to do this. In such cases, the user should be
           denied access until such time as they can update their
           password.

       PAM_PERM_DENIED
           Permission denied.

       PAM_SUCCESS
           The authentication token was successfully updated.

       PAM_USER_UNKNOWN
           User unknown to password service.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="pam_start.3.html">pam_start(3)</a>, <a href="pam_authenticate.3.html">pam_authenticate(3)</a>, <a href="pam_chauthtok.3.html">pam_chauthtok(3)</a>,
       <a href="pam_strerror.3.html">pam_strerror(3)</a>, <a href="../man8/pam.8.html">pam(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>linux-pam</i> (Pluggable Authentication
       Modules for Linux) project.  Information about the project can be
       found at ⟨<a href="http://www.linux-pam.org/">http://www.linux-pam.org/</a>⟩.  If you have a bug report
       for this manual page, see ⟨//www.linux-pam.org/⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/linux-pam/linux-pam.git">https://github.com/linux-pam/linux-pam.git</a>⟩ on 2023-12-22.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-12-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Linux-PAM Manual               12/22/2023               <i>PAM_ACCT_MGMT</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="pam.3.html">pam(3)</a>, <a href="pam_sm_acct_mgmt.3.html">pam_sm_acct_mgmt(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pam_acct_mgmt.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pam_acct_mgmt.3.html</a>
  </p>
</div>
