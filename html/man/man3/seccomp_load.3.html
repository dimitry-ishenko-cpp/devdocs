<h1>seccomp_load(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>seccomp_load</i>(3)         libseccomp Documentation         <i>seccomp_load</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       seccomp_load - Load the current seccomp filter into the kernel
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;seccomp.h&gt;</b>

       <b>typedef void * scmp_filter_ctx;</b>

       <b>int seccomp_load(scmp_filter_ctx </b><i>ctx</i><b>);</b>

       Link with <i>-lseccomp</i>.
</pre> <h2>
DESCRIPTION </h2>
<pre>
       Loads the seccomp filter provided by <i>ctx</i> into the kernel; if the
       function succeeds the new seccomp filter will be active when the
       function returns.  If <a href="seccomp_precompute.3.html">seccomp_precompute(3)</a> was called prior to
       attempting to load the seccomp filter, and no changes have been
       made to the filter, <b>seccomp_load</b>() can be considered to be async-
       signal-safe.

       As it is possible to have multiple stacked seccomp filters for a
       given task (defined as either a process or a thread), it is
       important to remember that each of the filters loaded for a given
       task are executed when a syscall is made and the "strictest" rule
       is the rule that is applied.  In the case of seccomp, "strictest"
       is defined as the action with the lowest value (e.g.
       <i>SCMP_ACT_KILL</i> is "stricter" than <i>SCMP_ACT_ALLOW</i>).
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Returns zero on success or one of the following error codes on
       failure:

       <b>-ECANCELED</b>
              There was a system failure beyond the control of the
              library.

       <b>-EFAULT</b>
              Internal libseccomp failure.

       <b>-EINVAL</b>
              Invalid input, either the context or architecture token is
              invalid.

       <b>-ENOMEM</b>
              The library was unable to allocate enough memory.

       <b>-ESRCH </b>Unable to load the filter due to thread issues.

       If the <i>SCMP_FLTATR_API_SYSRAWRC</i> filter attribute is non-zero then
       additional error codes may be returned to the caller; these
       additional error codes are the negative <i><a href="errno.3.html">errno</a></i> values returned by
       the system.  Unfortunately libseccomp can make no guarantees
       about these return values.
</pre> <h2>
EXAMPLES </h2>
<pre>
       #include &lt;seccomp.h&gt;

       int main(int argc, char *argv[])
       {
            int rc = -1;
            scmp_filter_ctx ctx;

            ctx = seccomp_init(SCMP_ACT_KILL);
            if (ctx == NULL)
                 goto out;

            /* ... */

            rc = seccomp_load(ctx);
            if (rc &lt; 0)
                 goto out;

            /* ... */

       out:
            seccomp_release(ctx);
            return -rc;
       }
</pre> <h2>
NOTES </h2>
<pre>
       While the seccomp filter can be generated independent of the
       kernel, kernel support is required to load and enforce the
       seccomp filter generated by libseccomp.

       The libseccomp project site, with more information and the source
       code repository, can be found at
       <a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>.  This tool, as well as the
       libseccomp library, is currently under development, please report
       any bugs at the project site or directly to the author.
</pre> <h2>
AUTHOR </h2>
<pre>
       Paul Moore &lt;paul@paul-moore.com&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="seccomp_init.3.html">seccomp_init(3)</a>, <a href="seccomp_reset.3.html">seccomp_reset(3)</a>, <a href="seccomp_release.3.html">seccomp_release(3)</a>,
       <a href="seccomp_rule_add.3.html">seccomp_rule_add(3)</a>, <a href="seccomp_rule_add_exact.3.html">seccomp_rule_add_exact(3)</a>
       <a href="seccomp_precompute.3.html">seccomp_precompute(3)</a> <a href="../man7/signal-safety.7.html">signal-safety(7)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libseccomp</i> (high-level API to the Linux
       Kernel's seccomp filter) project.  Information about the project
       can be found at ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩.  If you
       have a bug report for this manual page, see
       ⟨<a href="https://groups.google.com/d/forum/libseccomp">https://groups.google.com/d/forum/libseccomp</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/seccomp/libseccomp">https://github.com/seccomp/libseccomp</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-04-18.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">paul@paul-moore.com            30 May 2020               <i>seccomp_load</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="../man2/seccomp.2.html">seccomp(2)</a>, <a href="seccomp_attr_set.3.html">seccomp_attr_set(3)</a>, <a href="seccomp_precompute.3.html">seccomp_precompute(3)</a>, <a href="seccomp_rule_add.3.html">seccomp_rule_add(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/seccomp_load.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/seccomp_load.3.html</a>
  </p>
</div>
