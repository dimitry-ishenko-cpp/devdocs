<h1>security_load_policy(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>security_load_policy</i>(3) SELinux API documentation<i>security_load_policy</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       security_load_policy - load a new SELinux policy
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;selinux/selinux.h&gt;</b>

       <b>int security_load_policy(const void *</b><i>data</i><b>, size_t </b><i>len</i><b>);</b>

       <b>int selinux_mkload_policy(int </b><i>preservebools</i><b>);</b>

       <b>int selinux_init_load_policy(int *</b><i>enforce</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>security_load_policy</b>() loads a new policy, returns 0 for success
       and -1 for error.

       <b>selinux_mkload_policy</b>() makes a policy image and loads it. This
       function provides a higher level interface for loading policy
       than <b>security_load_policy</b>(), internally determining the right
       policy version, locating and opening the policy file, mapping it
       into memory, manipulating it as needed for current boolean
       settings and/or local definitions, and then calling
       security_load_policy to load it.  <i>preservebools</i> is a boolean flag
       indicating whether current policy boolean values should be
       preserved into the new policy (if 1) or reset to the saved policy
       settings (if 0). The former case is the default for policy
       reloads, while the latter case is an option for policy reloads
       but is primarily used for the initial policy load.
       <b>selinux_init_load_policy</b>() performs the initial policy load. This
       function determines the desired enforcing mode, sets the <i>enforce</i>
       argument accordingly for the caller to use, sets the SELinux
       kernel enforcing status to match it, and loads the policy. It
       also internally handles the initial selinuxfs mount required to
       perform these actions.

       It should also be noted that after the initial policy load, the
       SELinux kernel code cannot anymore be disabled and the selinuxfs
       cannot be unmounted using a call to <a href="security_disable.3.html">security_disable(3)</a>.
       Therefore, after the initial policy load, the only operational
       changes are those permitted by <a href="security_setenforce.3.html">security_setenforce(3)</a> (i.e.
       eventually setting the framework in permissive mode rather than
       in enforcing one).
</pre> <h2>
RETURN VALUE </h2>
<pre>
       Returns zero on success or -1 on error.
</pre> <h2>
AUTHOR </h2>
<pre>
       This manual page has been written by Guido Trentalancia
       &lt;guido@trentalancia.com&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man8/selinux.8.html">selinux(8)</a>, <a href="security_disable.3.html">security_disable(3)</a>, <a href="../man8/setenforce.8.html">setenforce(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">guido@trentalancia.com       3 November 2009     <i>security_load_policy</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="../man5/selinux_config.5.html">selinux_config(5)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/security_mkload_policy.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/security_mkload_policy.3.html</a>
  </p>
</div>
