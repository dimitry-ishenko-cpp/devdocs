<h1>pcap_compile(3pcap) — Linux manual page</h1>   <pre>
<span class="headline"><i>PCAP_COMPILE</i>(3PCAP)                                  <i>PCAP_COMPILE</i>(3PCAP)</span>
</pre> <h2>
NAME </h2>
<pre>
       pcap_compile - compile a filter expression
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;pcap/pcap.h&gt;</b>

       <b>int pcap_compile(pcap_t *p, struct bpf_program *fp,</b>
           <b>const char *str, int optimize, bpf_u_int32 netmask);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>pcap_compile</b>() is used to compile the string <i>str</i> into a filter
       program.  See <b>pcap-filter</b>(7) for the syntax of that string.  <i>fp</i>
       is a pointer to a <i>bpf_program</i> struct and is filled in by
       <b>pcap_compile</b>().  <i>optimize</i> controls whether optimization on the
       resulting code is performed.  <i>netmask</i> specifies the IPv4 netmask
       of the network on which packets are being captured; it is used
       only when checking for IPv4 broadcast addresses in the filter
       program.  If the netmask of the network on which packets are
       being captured isn't known to the program, or if packets are
       being captured on the Linux "any" pseudo-interface that can
       capture on more than one network, a value of <b>PCAP_NETMASK_UNKNOWN</b>
       can be supplied; tests for IPv4 broadcast addresses will fail to
       compile, but all other tests in the filter program will be OK.

       NOTE: in libpcap 1.8.0 and later, <b>pcap_compile</b>() can be used in
       multiple threads within a single process.  However, in earlier
       versions of libpcap, it is <i>not</i> safe to use <b>pcap_compile</b>() in
       multiple threads in a single process without some form of mutual
       exclusion allowing only one thread to call it at any given time.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       <b>pcap_compile</b>() returns <b>0 </b>on success and <b>PCAP_ERROR </b>on failure. If
       <b>PCAP_ERROR </b>is returned, <b>pcap_geterr</b>(3PCAP) or <b>pcap_perror</b>(3PCAP)
       may be called with <i>p</i> as an argument to fetch or display the error
       text.
</pre> <h2>
BACKWARD COMPATIBILITY </h2>
<pre>
       The <b>PCAP_NETMASK_UNKNOWN </b>constant became available in libpcap
       release 1.1.0.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <b>pcap</b>(3PCAP), <b>pcap_setfilter</b>(3PCAP), <b>pcap_freecode</b>(3PCAP)
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libpcap</i> (packet capture library)
       project.  Information about the project can be found at 
       ⟨<a href="http://www.tcpdump.org/">http://www.tcpdump.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="http://www.tcpdump.org/#patches">http://www.tcpdump.org/#patches</a>⟩.  This page
       was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/the-tcpdump-group/libpcap.git">https://github.com/the-tcpdump-group/libpcap.git</a>⟩ on 2024-06-14.
       (At that time, the date of the most recent commit that was found
       in the repository was 2024-06-04.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                             22 August 2018          <i>PCAP_COMPILE</i>(3PCAP)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pcap_compile.3pcap.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pcap_compile.3pcap.html</a>
  </p>
</div>
