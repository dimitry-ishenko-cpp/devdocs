<h1>tep_parse_saved_cmdlines(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>LIBTRACEEVENT</i>(3)          libtraceevent Manual          <i>LIBTRACEEVENT</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       tep_parse_saved_cmdlines, tep_parse_printk_formats,
       tep_parse_kallsyms - Parsing functions to load mappings
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;event-parse.h&gt;</b>

       int <b>tep_parse_saved_cmdlines</b>(struct tep_handle *<i>tep</i>, const char *<i>buf</i>);
       int <b>tep_parse_printk_formats</b>(struct tep_handle *<i>tep</i>, const char *<i>buf</i>);
       int <b>tep_parse_kallsyms</b>(struct tep_handle *<i>tep</i>, const char *<i>buf</i>);
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>tep_parse_saved_cmdlines() </b>is a helper function to parse content
       in the tracefs file system of the "saved_cmdlines" file (stored
       in a string buffer passed in by <i>buf</i>) and loads the mapping of the
       process IDs (pid) to the comm names in the <i>tep</i> handler. The
       events store the pid and this is used to be able to show the
       process names associated to those process ids. It parses the
       string <i>buf</i> that holds the content of saved_cmdlines and ends with
       a nul character (<i>\0</i>).

       <b>tep_parse_printk_formats() </b>is a helper function to parse content
       in the tracefs file system of the "printk_formats" file (stored
       in a string buffer passed in by <i>buf</i>) and loads the mapping of
       addresses of strings that may be referenced by events. Events
       only store the address of constant strings in the kernel, and the
       mapping of their address to the string is exported to user space
       in the printk_formats file. It parses the string <i>buf</i> that holds
       the content of printk_formats and ends with a nul character (<i>\0</i>).

       <b>tep_parse_kallsyms() </b>is a helper function to parse the Linux
       kernel /proc/kallsyms format (stored in a string buffer passed in
       by <i>buf</i>) and load the functions into the <i>tep</i> handler such that
       function IP addresses can be mapped to their name when parsing
       events with %pS in the print format field. It parses the string
       <i>buf</i> that holds the content of /proc/kallsyms and ends with a nul
       character (<i>\0</i>).
</pre> <h2>
RETURN VALUE </h2>
<pre>
       The <b>tep_parse_saved_cmdlines</b>() function returns 0 in case of
       success, or -1 in case of an error.

       The <b>tep_parse_printk_formats</b>() function returns 0 in case of
       success, or -1 in case of an error.

       The <b>tep_parse_kallsyms</b>() function returns 0 in case of success,
       or -1 in case of an error.
</pre> <h2>
EXAMPLE </h2>
<pre>
           ...
           #include &lt;event-parse.h&gt;
           #include &lt;tracefs.h&gt;
           #include &lt;stdlib.h&gt;

           int load_cmdlines(struct tep_handle *tep)
           {
                   char *buf = NULL;
                   int r;

                   buf = tracefs_instance_file_read(NULL, "saved_cmdlines", NULL);
                   if (!buf)
                           return -1;
                   r = tep_parse_saved_cmdlines(tep, buf);
                   free(buf);
                   return r;
           }

           int load_print_strings(struct tep_handle *tep)
           {
                   char *buf = NULL;
                   int r;

                   buf = tracefs_instance_file_read(NULL, "printk_formats", NULL);
                   if (!buf)
                           return -1;
                   r = tep_parse_printk_formats(tep, buf);
                   free(buf);
                   return r;
           }

           int load_kallsyms(struct tep_handle *tep)
           {
                   char *line = NULL;
                   char *buf = NULL;
                   size_t sz = 0;
                   FILE *fp;
                   int len = 0;
                   int r;

                   fp = fopen("/proc/kallsyms", "r");
                   while ((r = getline(&amp;line, &amp;sz, fp)) &gt;= 0) {
                           buf = realloc(buf, len + r + 1);
                           memcpy(buf + len, line, r);
                           len += r;
                   }
                   free(line);
                   fclose(fp);
                   if (!buf)
                           return -1;
                   buf[len] = 0;

                   r = tep_parse_kallsyms(tep, buf);
                   free(buf);
                   return r;
           }
           ...
</pre> <h2>
FILES </h2>
<pre>
           <b>event-parse.h</b>
                   Header file to include in order to have access to the library APIs.
           <b>-ltraceevent</b>
                   Linker switch to add when building a program that uses the library.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="libtraceevent.3.html">libtraceevent(3)</a>, <a href="../man1/trace-cmd.1.html">trace-cmd(1)</a>, <a href="tep_register_comm.3.html">tep_register_comm(3)</a>,
       <a href="tep_register_function.3.html">tep_register_function(3)</a>, <a href="tep_register_print_string.3.html">tep_register_print_string(3)</a>
</pre> <h2>
AUTHOR </h2>
<pre>
           <b>Steven Rostedt </b>&lt;<b>rostedt@goodmis.org</b>[1]&gt;, author of <b>libtraceevent</b>.
           <b>Tzvetomir Stoyanov </b>&lt;<b>tz.stoyanov@gmail.com</b>[2]&gt;, coauthor of <b>libtraceevent</b>.
</pre> <h2>
REPORTING BUGS </h2>
<pre>
       Report bugs to &lt;<b>linux-trace-devel@vger.kernel.org</b>[3]&gt;
</pre> <h2>
LICENSE </h2>
<pre>
       libtraceevent is Free Software licensed under the GNU LGPL 2.1
</pre> <h2>
RESOURCES </h2>
<pre>
       <b><a href="https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git/">https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git/</a> </b>
</pre> <h2>
NOTES </h2>
<pre>
        1. rostedt@goodmis.org
           mailto:rostedt@goodmis.org

        2. tz.stoyanov@gmail.com
           mailto:tz.stoyanov@gmail.com

        3. linux-trace-devel@vger.kernel.org
           mailto:linux-trace-devel@vger.kernel.org
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libtraceevent</i> (Linux kernel trace event
       library) project.  Information about the project can be found at
       ⟨<a href="https://www.trace-cmd.org/">https://www.trace-cmd.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="https://www.trace-cmd.org/">https://www.trace-cmd.org/</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git">https://git.kernel.org/pub/scm/libs/libtrace/libtraceevent.git</a>⟩
       on 2024-06-14.  (At that time, the date of the most recent commit
       that was found in the repository was 2024-05-17.)  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">libtraceevent 1.7.3            09/24/2023               <i>LIBTRACEEVENT</i>(3)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/tep_parse_kallsyms.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/tep_parse_kallsyms.3.html</a>
  </p>
</div>
