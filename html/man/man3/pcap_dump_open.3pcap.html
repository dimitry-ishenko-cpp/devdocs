<h1>pcap_dump_open(3pcap) — Linux manual page</h1>   <pre>
<span class="headline"><i>PCAP_DUMP_OPEN</i>(3PCAP)                              <i>PCAP_DUMP_OPEN</i>(3PCAP)</span>
</pre> <h2>
NAME </h2>
<pre>
       pcap_dump_open, pcap_dump_open_append, pcap_dump_fopen - open a
       file to which to write packets
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;pcap/pcap.h&gt;</b>

       <b>pcap_dumper_t *pcap_dump_open(pcap_t *p, const char *fname);</b>
       <b>pcap_dumper_t *pcap_dump_open_append(pcap_t *p, const char *fname);</b>
       <b>pcap_dumper_t *pcap_dump_fopen(pcap_t *p, FILE *fp);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>pcap_dump_open</b>() is called to open a ``savefile'' for writing.
       <i>fname</i> specifies the name of the file to open. The file will have
       the same format as those used by <a href="../man1/tcpdump.1.html">tcpdump(1)</a> and <b>tcpslice</b>(1).  If
       the file does not exist, it will be created; if the file exists,
       it will be truncated and overwritten.  The name "-" is a synonym
       for <b>stdout</b>.

       <b>pcap_dump_fopen</b>() is called to write data to an existing open
       stream <i>fp</i>; this stream will be closed by a subsequent call to
       <b>pcap_dump_close</b>(3PCAP).  The stream is assumed to be at the
       beginning of a file that has been newly created or truncated, so
       that writes will start at the beginning of the file.  Note that
       on Windows, that stream should be opened in binary mode.

       <i>p</i> is a capture or ``savefile'' handle returned by an earlier call
       to <b>pcap_create</b>(3PCAP) and activated by an earlier call to
       <b>pcap_activate</b>(3PCAP), or returned by an earlier call to
       <b>pcap_open_offline</b>(3PCAP), <b>pcap_open_live</b>(3PCAP), or
       <b>pcap_open_dead</b>(3PCAP).  The time stamp precision, link-layer
       type, and snapshot length from <i>p</i> are used as the link-layer type
       and snapshot length of the output file.

       <b>pcap_dump_open_append</b>() is like <b>pcap_dump_open</b>() but, if the file
       already exists, and is a pcap file with the same byte order as
       the host opening the file, and has the same time stamp precision,
       link-layer header type, and snapshot length as <i>p</i>, it will write
       new packets at the end of the file.
</pre> <h2>
RETURN VALUE </h2>
<pre>
       A pointer to a <b>pcap_dumper_t </b>structure to use in subsequent
       <b>pcap_dump</b>(3PCAP) and <b>pcap_dump_close</b>(3PCAP) calls is returned on
       success.  <b>NULL </b>is returned on failure.  If <b>NULL </b>is returned,
       <b>pcap_geterr</b>(3PCAP) can be used to get the error text.
</pre> <h2>
BACKWARD COMPATIBILITY </h2>
<pre>
       The <b>pcap_dump_open_append</b>() function became available in libpcap
       release 1.7.2.  In previous releases, there is no support for
       appending packets to an existing savefile.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <b>pcap</b>(3PCAP), <b>pcap-savefile</b>(5)
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libpcap</i> (packet capture library)
       project.  Information about the project can be found at 
       ⟨<a href="http://www.tcpdump.org/">http://www.tcpdump.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="http://www.tcpdump.org/#patches">http://www.tcpdump.org/#patches</a>⟩.  This page
       was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/the-tcpdump-group/libpcap.git">https://github.com/the-tcpdump-group/libpcap.git</a>⟩ on 2024-06-14.
       (At that time, the date of the most recent commit that was found
       in the repository was 2024-06-04.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                               3 July 2020         <i>PCAP_DUMP_OPEN</i>(3PCAP)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/pcap_dump_open.3pcap.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/pcap_dump_open.3pcap.html</a>
  </p>
</div>
