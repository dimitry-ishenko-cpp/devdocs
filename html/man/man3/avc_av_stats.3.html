<h1>avc_cache_stats(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>avc_cache_stats</i>(3)      SELinux API documentation     <i>avc_cache_stats</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       avc_cache_stats, avc_av_stats, avc_sid_stats - obtain userspace
       SELinux AVC statistics
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;selinux/selinux.h&gt;</b>
       <b>#include &lt;selinux/avc.h&gt;</b>

       <b>void avc_av_stats(void);</b>

       <b>void avc_sid_stats(void);</b>

       <b>void avc_cache_stats(struct avc_cache_stats *</b><i>stats</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The userspace AVC maintains two internal hash tables, one to
       store security ID's and one to cache access decisions.

       <b>avc_av_stats</b>() and <b>avc_sid_stats</b>() produce log messages
       indicating the status of the access decision and SID tables,
       respectively.  The messages contain the number of entries in the
       table, number of hash buckets and number of buckets used, and
       maximum number of entries in a single bucket.

       <b>avc_cache_stats</b>() populates a structure whose fields reflect
       cache activity:

              struct avc_cache_stats {
                  unsigned  entry_lookups;
                  unsigned  entry_hits;
                  unsigned  entry_misses;
                  unsigned  entry_discards;
                  unsigned  cav_lookups;
                  unsigned  cav_hits;
                  unsigned  cav_probes;
                  unsigned  cav_misses;
              };

       <i>entry_lookups</i>
              Number of queries made.

       <i>entry_hits</i>
              Number of times a decision was found in the <i>aeref</i>
              argument.

       <i>entry_misses</i>
              Number of times a decision was not found in the <i>aeref</i>
              argument.

       <i>entry_discards</i>
              Number of times a decision was not found in the <i>aeref</i>
              argument and the <i>aeref</i> argument was non-NULL.

       <i>cav_lookups</i>
              Number of cache lookups.

       <i>cav_hits</i>
              Number of cache hits.

       <i>cav_misses</i>
              Number of cache misses.

       <i>cav_probes</i>
              Number of entries examined while searching the cache.
</pre> <h2>
NOTES </h2>
<pre>
       When the cache is flushed as a result of a call to <b>avc_reset</b>() or
       a policy change notification, the statistics returned by
       <b>avc_cache_stats</b>() are reset to zero.  The SID table, however, is
       left unchanged.

       When a policy change notification is received, a call to
       <b>avc_av_stats</b>() is made before the cache is flushed.
</pre> <h2>
AUTHOR </h2>
<pre>
       Eamon Walsh &lt;ewalsh@tycho.nsa.gov&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="avc_init.3.html">avc_init(3)</a>, <a href="avc_has_perm.3.html">avc_has_perm(3)</a>, <a href="avc_context_to_sid.3.html">avc_context_to_sid(3)</a>,
       <a href="avc_add_callback.3.html">avc_add_callback(3)</a>, <a href="../man8/selinux.8.html">selinux(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                               27 May 2004            <i>avc_cache_stats</i>(3)</span>
</pre>  <p>Pages that refer to this page: <a href="avc_add_callback.3.html">avc_add_callback(3)</a>, <a href="avc_context_to_sid.3.html">avc_context_to_sid(3)</a>, <a href="avc_has_perm.3.html">avc_has_perm(3)</a>, <a href="avc_open.3.html">avc_open(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/avc_av_stats.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/avc_av_stats.3.html</a>
  </p>
</div>
