<h1>gnutls_certificate_verify_peers(3) — Linux manual page</h1>   <pre>
<span class="headline"><i>gnutls_certi..._verify_peers</i>(3)  gnutls  <i>gnutls_certi..._verify_peers</i>(3)</span>
</pre> <h2>
NAME </h2>
<pre>
       gnutls_certificate_verify_peers - API function
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;gnutls/gnutls.h&gt;</b>

       <b>int gnutls_certificate_verify_peers(gnutls_session_t </b><i>session</i><b>,</b>
       <b>gnutls_typed_vdata_st * </b><i>data</i><b>, unsigned int </b><i>elements</i><b>, unsigned int</b>
       <b>* </b><i>status</i><b>);</b>
</pre> <h2>
ARGUMENTS </h2>
<pre>
       gnutls_session_t session
                   is a gnutls session

       gnutls_typed_vdata_st * data
                   an array of typed data

       unsigned int elements
                   the number of data elements

       unsigned int * status
                   is the output of the verification
</pre> <h2>
DESCRIPTION </h2>
<pre>
       This function will verify the peer's certificate and store the
       the status in the  <i>status</i> variable as a bitwise OR of
       gnutls_certificate_status_t values or zero if the certificate is
       trusted. Note that value in  <i>status</i> is set only when the return
       value of this function is success (i.e, failure to trust a
       certificate does not imply a negative return value).  The default
       verification flags used by this function can be overridden using
       <b>gnutls_certificate_set_verify_flags()</b>. See the documentation of
       <b>gnutls_certificate_verify_peers2() </b>for details in the
       verification process.

       This function will take into account the stapled OCSP responses
       sent by the server, as well as the following X.509 certificate
       extensions: Name Constraints, Key Usage, and Basic Constraints
       (pathlen).

       The acceptable  <i>data</i> types are <b>GNUTLS_DT_DNS_HOSTNAME</b>,
       <b>GNUTLS_DT_RFC822NAME </b>and <b>GNUTLS_DT_KEY_PURPOSE_OID</b>.  The former
       two accept as data a null-terminated hostname or email address,
       and the latter a null-terminated object identifier (e.g.,
       <b>GNUTLS_KP_TLS_WWW_SERVER</b>).

       If a DNS hostname is provided then this function will compare the
       hostname in the certificate against the given. If names do not
       match the <b>GNUTLS_CERT_UNEXPECTED_OWNER </b>status flag will be set.
       If a key purpose OID is provided and the end-certificate contains
       the extended key usage PKIX extension, it will be required to be
       have the provided key purpose or be marked for any purpose,
       otherwise verification status will have the
       <b>GNUTLS_CERT_SIGNER_CONSTRAINTS_FAILURE </b>flag set.

       To avoid denial of service attacks some default upper limits
       regarding the certificate key size and chain size are set. To
       override them use <b>gnutls_certificate_set_verify_limits()</b>.

       Note that when using raw public-keys verification will not work
       because there is no corresponding certificate body belonging to
       the raw key that can be verified. In that case this function will
       return <b>GNUTLS_E_INVALID_REQUEST</b>.
</pre> <h2>
RETURNS </h2>
<pre>
       <b>GNUTLS_E_SUCCESS </b>(0) when the validation is performed, or a
       negative error code otherwise.  A successful error code means
       that the  <i>status</i> parameter must be checked to obtain the
       validation status.
</pre> <h2>
SINCE </h2>
<pre>
       3.3.0
</pre> <h2>
REPORTING BUGS </h2>
<pre>
       Report bugs to &lt;bugs@gnutls.org&gt;.
       Home page: <a href="https://www.gnutls.org">https://www.gnutls.org</a>
</pre> <h2>
COPYRIGHT </h2>
<pre>
       Copyright © 2001-2023 Free Software Foundation, Inc., and others.
       Copying and distribution of this file, with or without
       modification, are permitted in any medium without royalty
       provided the copyright notice and this notice are preserved.
</pre> <h2>
SEE ALSO </h2>
<pre>
       The full documentation for <b>gnutls </b>is maintained as a Texinfo
       manual.  If the /usr/share/doc/gnutls/ directory does not contain
       the HTML form visit

       <a href="https://www.gnutls.org/manual/">https://www.gnutls.org/manual/</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>GnuTLS</i> (GnuTLS Transport Layer Security
       Library) project.  Information about the project can be found at
       ⟨<a href="http://www.gnutls.org/">http://www.gnutls.org/</a>⟩.  If you have a bug report for this
       manual page, send it to bugs@gnutls.org.  This page was obtained
       from the tarball gnutls-3.8.5.tar.xz fetched from
       ⟨<a href="http://www.gnutls.org/download.html">http://www.gnutls.org/download.html</a>⟩ on 2024-06-14.  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">gnutls                            3.8.5  <i>gnutls_certi..._verify_peers</i>(3)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man3/gnutls_certificate_verify_peers.3.html" class="_attribution-link">https://man7.org/linux/man-pages/man3/gnutls_certificate_verify_peers.3.html</a>
  </p>
</div>
