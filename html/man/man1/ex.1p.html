<h1>ex(1p) — Linux manual page</h1>   <pre>
<span class="headline"><i>EX</i>(1P)                  POSIX Programmer's Manual                 <i>EX</i>(1P)</span>
</pre> <h2>
PROLOG </h2>
<pre>
       This manual page is part of the POSIX Programmer's Manual.  The
       Linux implementation of this interface may differ (consult the
       corresponding Linux manual page for details of Linux behavior),
       or the interface may not be implemented on Linux.
</pre> <h2>
NAME </h2>
<pre>
       ex — text editor
</pre> <h2>
SYNOPSIS </h2>
<pre>
       ex <b>[</b>-rR<b>] [</b>-s|-v<b>] [</b>-c <i>command</i><b>] [</b>-t <i>tagstring</i><b>] [</b>-w <i>size</i><b>] [</b><i>file</i>...<b>]</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <i>ex</i> utility is a line-oriented text editor. There are two
       other modes of the editor—open and visual—in which screen-
       oriented editing is available. This is described more fully by
       the <i>ex</i> <b>open </b>and <b>visual </b>commands and in <a href="vi.1p.html">vi(1p)</a>.

       If an operand is <b>'-'</b>, the results are unspecified.

       This section uses the term <i>edit buffer</i> to describe the current
       working text. No specific implementation is implied by this term.
       All editing changes are performed on the edit buffer, and no
       changes to it shall affect any file until an editor command
       writes the file.

       Certain terminals do not have all the capabilities necessary to
       support the complete <i>ex</i> definition, such as the full-screen
       editing commands (<i>visual mode</i> or <i>open mode</i>).  When these commands
       cannot be supported on such terminals, this condition shall not
       produce an error message such as ``not an editor command'' or
       report a syntax error. The implementation may either accept the
       commands and produce results on the screen that are the result of
       an unsuccessful attempt to meet the requirements of this volume
       of POSIX.1‐2017 or report an error describing the terminal-
       related deficiency.
</pre> <h2>
OPTIONS </h2>
<pre>
       The <i>ex</i> utility shall conform to the Base Definitions volume of
       POSIX.1‐2017, <i>Section 12.2</i>, <i>Utility Syntax Guidelines</i>, except for
       the unspecified usage of <b>'-'</b>, and that <b>'+' </b>may be recognized as
       an option delimiter as well as <b>'-'</b>.

       The following options shall be supported:

       <b>-c </b><i>command</i>
                 Specify an initial command to be executed in the first
                 edit buffer loaded from an existing file (see the
                 EXTENDED DESCRIPTION section).  Implementations may
                 support more than a single <b>-c </b>option. In such
                 implementations, the specified commands shall be
                 executed in the order specified on the command line.

       <b>-r        </b>Recover the named files (see the EXTENDED DESCRIPTION
                 section).  Recovery information for a file shall be
                 saved during an editor or system crash (for example,
                 when the editor is terminated by a signal which the
                 editor can catch), or after the use of an <i>ex</i> <b>preserve</b>
                 command.

                 A <i>crash</i> in this context is an unexpected failure of the
                 system or utility that requires restarting the failed
                 system or utility. A system crash implies that any
                 utilities running at the time also crash. In the case
                 of an editor or system crash, the number of changes to
                 the edit buffer (since the most recent <b>preserve</b>
                 command) that will be recovered is unspecified.

                 If no <i>file</i> operands are given and the <b>-t </b>option is not
                 specified, all other options, the <i>EXINIT</i> variable, and
                 any <b>.exrc </b>files shall be ignored; a list of all
                 recoverable files available to the invoking user shall
                 be written, and the editor shall exit normally without
                 further action.

       <b>-R        </b>Set <b>readonly </b>edit option.

       <b>-s        </b>Prepare <i>ex</i> for batch use by taking the following
                 actions:

                  *  Suppress writing prompts and informational (but not
                     diagnostic) messages.

                  *  Ignore the value of <i>TERM</i> and any implementation
                     default terminal type and assume the terminal is a
                     type incapable of supporting open or visual modes;
                     see the <b>visual </b>command and the description of
                     <a href="vi.1p.html">vi(1p)</a>.

                  *  Suppress the use of the <i>EXINIT</i> environment variable
                     and the reading of any <b>.exrc </b>file; see the EXTENDED
                     DESCRIPTION section.

                  *  Suppress autoindentation, ignoring the value of the
                     <b>autoindent </b>edit option.

       <b>-t </b><i>tagstring</i>
                 Edit the file containing the specified <i>tagstring</i>; see
                 <a href="ctags.1p.html">ctags(1p)</a>.  The tags feature represented by <b>-t</b>
                 <i>tagstring</i> and the <b>tag </b>command is optional. It shall be
                 provided on any system that also provides a conforming
                 implementation of <i>ctags</i>; otherwise, the use of <b>-t</b>
                 produces undefined results. On any system, it shall be
                 an error to specify more than a single <b>-t </b>option.

       <b>-v        </b>Begin in visual mode (see <a href="vi.1p.html">vi(1p)</a>).

       <b>-w </b><i>size</i>   Set the value of the <i>window</i> editor option to <i>size</i>.
</pre> <h2>
OPERANDS </h2>
<pre>
       The following operand shall be supported:

       <i>file</i>      A pathname of a file to be edited.
</pre> <h2>
STDIN </h2>
<pre>
       The standard input consists of a series of commands and input
       text, as described in the EXTENDED DESCRIPTION section. The
       implementation may limit each line of standard input to a length
       of {LINE_MAX}.

       If the standard input is not a terminal device, it shall be as if
       the <b>-s </b>option had been specified.

       If a read from the standard input returns an error, or if the
       editor detects an end-of-file condition from the standard input,
       it shall be equivalent to a SIGHUP asynchronous event.
</pre> <h2>
INPUT FILES </h2>
<pre>
       Input files shall be text files or files that would be text files
       except for an incomplete last line that is not longer than
       {LINE_MAX}-1 bytes in length and contains no NUL characters. By
       default, any incomplete last line shall be treated as if it had a
       trailing &lt;newline&gt;.  The editing of other forms of files may
       optionally be allowed by <i>ex</i> implementations.

       The <b>.exrc </b>files and source files shall be text files consisting
       of <i>ex</i> commands; see the EXTENDED DESCRIPTION section.

       By default, the editor shall read lines from the files to be
       edited without interpreting any of those lines as any form of
       editor command.
</pre> <h2>
ENVIRONMENT VARIABLES </h2>
<pre>
       The following environment variables shall affect the execution of
       <i>ex</i>:

       <i>COLUMNS</i>   Override the system-selected horizontal screen size.
                 See the Base Definitions volume of POSIX.1‐2017,
                 <i>Chapter 8</i>, <i>Environment Variables</i> for valid values and
                 results when it is unset or null.

       <i>EXINIT</i>    Determine a list of <i>ex</i> commands that are executed on
                 editor start-up. See the EXTENDED DESCRIPTION section
                 for more details of the initialization phase.

       <i>HOME</i>      Determine a pathname of a directory that shall be
                 searched for an editor start-up file named <b>.exrc</b>; see
                 the EXTENDED DESCRIPTION section.

       <i>LANG</i>      Provide a default value for the internationalization
                 variables that are unset or null. (See the Base
                 Definitions volume of POSIX.1‐2017, <i>Section 8.2</i>,
                 <i>Internationalization Variables</i> for the precedence of
                 internationalization variables used to determine the
                 values of locale categories.)

       <i>LC_ALL</i>    If set to a non-empty string value, override the values
                 of all the other internationalization variables.

       <i>LC_COLLATE</i>
                 Determine the locale for the behavior of ranges,
                 equivalence classes, and multi-character collating
                 elements within regular expressions.

       <i>LC_CTYPE</i>  Determine the locale for the interpretation of
                 sequences of bytes of text data as characters (for
                 example, single-byte as opposed to multi-byte
                 characters in arguments and input files), the behavior
                 of character classes within regular expressions, the
                 classification of characters as uppercase or lowercase
                 letters, the case conversion of letters, and the
                 detection of word boundaries.

       <i>LC_MESSAGES</i>
                 Determine the locale that should be used to affect the
                 format and contents of diagnostic messages written to
                 standard error.

       <i>LINES</i>     Override the system-selected vertical screen size, used
                 as the number of lines in a screenful and the vertical
                 screen size in visual mode.  See the Base Definitions
                 volume of POSIX.1‐2017, <i>Chapter 8</i>, <i>Environment</i>
                 <i>Variables</i> for valid values and results when it is unset
                 or null.

       <i>NLSPATH</i>   Determine the location of message catalogs for the
                 processing of <i>LC_MESSAGES</i>.

       <i>PATH</i>      Determine the search path for the shell command
                 specified in the <i>ex</i> editor commands <b>!</b>, <b>shell</b>, <b>read</b>, and
                 <b>write</b>, and the open and visual mode command <b>!</b>; see the
                 description of command search and execution in <i>Section</i>
                 <i>2.9.1.1</i>, <i>Command Search and Execution</i>.

       <i>SHELL</i>     Determine the preferred command line interpreter for
                 use as the default value of the <b>shell </b>edit option.

       <i>TERM</i>      Determine the name of the terminal type. If this
                 variable is unset or null, an unspecified default
                 terminal type shall be used.
</pre> <h2>
ASYNCHRONOUS EVENTS </h2>
<pre>
       The following term is used in this and following sections to
       specify command and asynchronous event actions:

       <i>complete write</i>
                 A complete write is a write of the entire contents of
                 the edit buffer to a file of a type other than a
                 terminal device, or the saving of the edit buffer
                 caused by the user executing the <i>ex</i> <b>preserve </b>command.
                 Writing the contents of the edit buffer to a temporary
                 file that will be removed when the editor exits shall
                 not be considered a complete write.

       The following actions shall be taken upon receipt of signals:

       SIGINT    If the standard input is not a terminal device, <i>ex</i>
                 shall not write the file or return to command or text
                 input mode, and shall exit with a non-zero exit status.

                 Otherwise, if executing an open or visual text input
                 mode command, <i>ex</i> in receipt of SIGINT shall behave
                 identically to its receipt of the &lt;ESC&gt; character.

                 Otherwise:

                  1. If executing an <i>ex</i> text input mode command, all
                     input lines that have been completely entered shall
                     be resolved into the edit buffer, and any partially
                     entered line shall be discarded.

                  2. If there is a currently executing command, it shall
                     be aborted and a message displayed. Unless
                     otherwise specified by the <i>ex</i> or <i>vi</i> command
                     descriptions, it is unspecified whether any lines
                     modified by the executing command appear modified,
                     or as they were before being modified by the
                     executing command, in the buffer.

                     If the currently executing command was a motion
                     command, its associated command shall be discarded.

                  3. If in open or visual command mode, the terminal
                     shall be alerted.

                  4. The editor shall then return to command mode.

       SIGCONT   The screen shall be refreshed if in open or visual
                 mode.

       SIGHUP    If the edit buffer has been modified since the last
                 complete write, <i>ex</i> shall attempt to save the edit
                 buffer so that it can be recovered later using the <b>-r</b>
                 option or the <i>ex</i> <b>recover </b>command. The editor shall not
                 write the file or return to command or text input mode,
                 and shall terminate with a non-zero exit status.

       SIGTERM   Refer to SIGHUP.

       The action taken for all other signals is unspecified.
</pre> <h2>
STDOUT </h2>
<pre>
       The standard output shall be used only for writing prompts to the
       user, for informational messages, and for writing lines from the
       file.
</pre> <h2>
STDERR </h2>
<pre>
       The standard error shall be used only for diagnostic messages.
</pre> <h2>
OUTPUT FILES </h2>
<pre>
       The output from <i>ex</i> shall be text files.
</pre> <h2>
EXTENDED DESCRIPTION </h2>
<pre>
       Only the <i>ex</i> mode of the editor is described in this section. See
       <a href="vi.1p.html">vi(1p)</a> for additional editing capabilities available in <i>ex</i>.

       When an error occurs, <i>ex</i> shall write a message. If the terminal
       supports a standout mode (such as inverse video), the message
       shall be written in standout mode. If the terminal does not
       support a standout mode, and the edit option <b>errorbells </b>is set,
       an alert action shall precede the error message.

       By default, <i>ex</i> shall start in command mode, which shall be
       indicated by a <b>: </b>prompt; see the <b>prompt </b>command. Text input mode
       can be entered by the <b>append</b>, <b>insert</b>, or <b>change </b>commands; it can
       be exited (and command mode re-entered) by typing a &lt;period&gt;
       (<b>'.'</b>)  alone at the beginning of a line.

   <b>Initialization in ex and vi</b>
       The following symbols are used in this and following sections to
       specify locations in the edit buffer:

       <i>alternate and current pathnames</i>
             Two pathnames, named <i>current</i> and <i>alternate</i>, are maintained
             by the editor. Any <i>ex</i> commands that take filenames as
             arguments shall set them as follows:

              1. If a <i>file</i> argument is specified to the <i>ex</i> <b>edit</b>, <b>ex</b>, or
                 <b>recover </b>commands, or if an <i>ex</i> <b>tag </b>command replaces the
                 contents of the edit buffer.

                  a. If the command replaces the contents of the edit
                     buffer, the current pathname shall be set to the
                     <i>file</i> argument or the file indicated by the tag, and
                     the alternate pathname shall be set to the previous
                     value of the current pathname.

                  b. Otherwise, the alternate pathname shall be set to
                     the <i>file</i> argument.

              2. If a <i>file</i> argument is specified to the <i>ex</i> <b>next </b>command:

                  a. If the command replaces the contents of the edit
                     buffer, the current pathname shall be set to the
                     first <i>file</i> argument, and the alternate pathname
                     shall be set to the previous value of the current
                     pathname.

              3. If a <i>file</i> argument is specified to the <i>ex</i> <b>file </b>command,
                 the current pathname shall be set to the <i>file</i> argument,
                 and the alternate pathname shall be set to the previous
                 value of the current pathname.

              4. If a <i>file</i> argument is specified to the <i>ex</i> <b>read </b>and
                 <b>write </b>commands (that is, when reading or writing a
                 file, and not to the program named by the <b>shell </b>edit
                 option), or a <i>file</i> argument is specified to the <i>ex</i> <b>xit</b>
                 command:

                  a. If the current pathname has no value, the current
                     pathname shall be set to the <i>file</i> argument.

                  b. Otherwise, the alternate pathname shall be set to
                     the <i>file</i> argument.

             If the alternate pathname is set to the previous value of
             the current pathname when the current pathname had no
             previous value, then the alternate pathname shall have no
             value as a result.

       <i>current line</i>
             The line of the edit buffer referenced by the cursor. Each
             command description specifies the current line after the
             command has been executed, as the <i>current line value</i>.  When
             the edit buffer contains no lines, the current line shall
             be zero; see <i>Addressing in ex</i>.

       <i>current column</i>
             The current display line column occupied by the cursor.
             (The columns shall be numbered beginning at 1.) Each
             command description specifies the current column after the
             command has been executed, as the <i>current column</i> value.
             This column is an <i>ideal</i> column that is remembered over the
             lifetime of the editor. The actual display line column upon
             which the cursor rests may be different from the current
             column; see the cursor positioning discussion in <i>Command</i>
             <i>Descriptions in vi</i>.

       <i>set to non-&lt;blank&gt;</i>
             A description for a current column value, meaning that the
             current column shall be set to the last display line column
             on which is displayed any part of the first non-&lt;blank&gt; of
             the line. If the line has no non-&lt;blank&gt; non-&lt;newline&gt;
             characters, the current column shall be set to the last
             display line column on which is displayed any part of the
             last non-&lt;newline&gt; character in the line. If the line is
             empty, the current column shall be set to column position
             1.

       The length of lines in the edit buffer may be limited to
       {LINE_MAX} bytes. In open and visual mode, the length of lines in
       the edit buffer may be limited to the number of characters that
       will fit in the display. If either limit is exceeded during
       editing, an error message shall be written. If either limit is
       exceeded by a line read in from a file, an error message shall be
       written and the edit session may be terminated.

       If the editor stops running due to any reason other than a user
       command, and the edit buffer has been modified since the last
       complete write, it shall be equivalent to a SIGHUP asynchronous
       event. If the system crashes, it shall be equivalent to a SIGHUP
       asynchronous event.

       During initialization (before the first file is copied into the
       edit buffer or any user commands from the terminal are processed)
       the following shall occur:

        1. If the environment variable <i>EXINIT</i> is set, the editor shall
           execute the <i>ex</i> commands contained in that variable.

        2. If the <i>EXINIT</i> variable is not set, and all of the following
           are true:

            a. The <i>HOME</i> environment variable is not null and not empty.

            b. The file <b>.exrc </b>in the directory referred to by the <i>HOME</i>
               environment variable:

                i.  Exists

               ii.  Is owned by the same user ID as the real user ID of
                    the process or the process has appropriate
                    privileges

               iii. Is not writable by anyone other than the owner

           the editor shall execute the <i>ex</i> commands contained in that
           file.

        3. If and only if all of the following are true:

            a. The current directory is not referred to by the <i>HOME</i>
               environment variable.

            b. A command in the <i>EXINIT</i> environment variable or a command
               in the <b>.exrc </b>file in the directory referred to by the
               <i>HOME</i> environment variable sets the editor option <b>exrc</b>.

            c. The <b>.exrc </b>file in the current directory:

                i.  Exists

               ii.  Is owned by the same user ID as the real user ID of
                    the process, or by one of a set of implementation-
                    defined user IDs

               iii. Is not writable by anyone other than the owner

           the editor shall attempt to execute the <i>ex</i> commands contained
           in that file.

       Lines in any <b>.exrc </b>file that are blank lines shall be ignored. If
       any <b>.exrc </b>file exists, but is not read for ownership or
       permission reasons, it shall be an error.

       After the <i>EXINIT</i> variable and any <b>.exrc </b>files are processed, the
       first file specified by the user shall be edited, as follows:

        1. If the user specified the <b>-t </b>option, the effect shall be as
           if the <i>ex</i> <b>tag </b>command was entered with the specified
           argument, with the exception that if tag processing does not
           result in a file to edit, the effect shall be as described in
           step 3. below.

        2. Otherwise, if the user specified any command line <i>file</i>
           arguments, the effect shall be as if the <i>ex</i> <b>edit </b>command was
           entered with the first of those arguments as its <i>file</i>
           argument.

        3. Otherwise, the effect shall be as if the <i>ex</i> <b>edit </b>command was
           entered with a nonexistent filename as its <i>file</i> argument. It
           is unspecified whether this action shall set the current
           pathname. In an implementation where this action does not set
           the current pathname, any editor command using the current
           pathname shall fail until an editor command sets the current
           pathname.

       If the <b>-r </b>option was specified, the first time a file in the
       initial argument list or a file specified by the <b>-t </b>option is
       edited, if recovery information has previously been saved about
       it, that information shall be recovered and the editor shall
       behave as if the contents of the edit buffer have already been
       modified. If there are multiple instances of the file to be
       recovered, the one most recently saved shall be recovered, and an
       informational message that there are previous versions of the
       file that can be recovered shall be written. If no recovery
       information about a file is available, an informational message
       to this effect shall be written, and the edit shall proceed as
       usual.

       If the <b>-c </b>option was specified, the first time a file that
       already exists (including a file that might not exist but for
       which recovery information is available, when the <b>-r </b>option is
       specified) replaces or initializes the contents of the edit
       buffer, the current line shall be set to the last line of the
       edit buffer, the current column shall be set to non-&lt;blank&gt;, and
       the <i>ex</i> commands specified with the <b>-c </b>option shall be executed.
       In this case, the current line and current column shall not be
       set as described for the command associated with the replacement
       or initialization of the edit buffer contents. However, if the <b>-t</b>
       option or a <b>tag </b>command is associated with this action, the <b>-c</b>
       option commands shall be executed and then the movement to the
       tag shall be performed.

       The current argument list shall initially be set to the filenames
       specified by the user on the command line. If no filenames are
       specified by the user, the current argument list shall be empty.
       If the <b>-t </b>option was specified, it is unspecified whether any
       filename resulting from tag processing shall be prepended to the
       current argument list. In the case where the filename is added as
       a prefix to the current argument list, the current argument list
       reference shall be set to that filename. In the case where the
       filename is not added as a prefix to the current argument list,
       the current argument list reference shall logically be located
       before the first of the filenames specified on the command line
       (for example, a subsequent <i>ex</i> <b>next </b>command shall edit the first
       filename from the command line). If the <b>-t </b>option was not
       specified, the current argument list reference shall be to the
       first of the filenames on the command line.

   <b>Addressing in ex</b>
       Addressing in <i>ex</i> relates to the current line and the current
       column; the address of a line is its 1-based line number, the
       address of a column is its 1-based count from the beginning of
       the line. Generally, the current line is the last line affected
       by a command. The current line number is the address of the
       current line. In each command description, the effect of the
       command on the current line number and the current column is
       described.

       Addresses are constructed as follows:

        1. The character <b>'.'  </b>(period) shall address the current line.

        2. The character <b>'$' </b>shall address the last line of the edit
           buffer.

        3. The positive decimal number <i>n</i> shall address the <i>n</i>th line of
           the edit buffer.

        4. The address <b>"'x" </b>refers to the line marked with the mark name
           character <b>'x'</b>, which shall be a lowercase letter from the
           portable character set, the backquote character, or the
           single-quote character. It shall be an error if the line that
           was marked is not currently present in the edit buffer or the
           mark has not been set. Lines can be marked with the <i>ex</i> <b>mark</b>
           or <b>k </b>commands, or the <i>vi</i> <b>m </b>command.

        5. A regular expression enclosed by &lt;slash&gt; characters (<b>'/'</b>)
           shall address the first line found by searching forwards from
           the line following the current line toward the end of the
           edit buffer and stopping at the first line for which the line
           excluding the terminating &lt;newline&gt; matches the regular
           expression. As stated in <i>Regular Expressions in ex</i>, an
           address consisting of a null regular expression delimited by
           &lt;slash&gt; characters (<b>"//"</b>) shall address the next line for
           which the line excluding the terminating &lt;newline&gt; matches
           the last regular expression encountered. In addition, the
           second &lt;slash&gt; can be omitted at the end of a command line.
           If the <b>wrapscan </b>edit option is set, the search shall wrap
           around to the beginning of the edit buffer and continue up to
           and including the current line, so that the entire edit
           buffer is searched. Within the regular expression, the
           sequence <b>"\/" </b>shall represent a literal &lt;slash&gt; instead of
           the regular expression delimiter.

        6. A regular expression enclosed in &lt;question-mark&gt; characters
           (<b>'?'</b>)  shall address the first line found by searching
           backwards from the line preceding the current line toward the
           beginning of the edit buffer and stopping at the first line
           for which the line excluding the terminating &lt;newline&gt;
           matches the regular expression. An address consisting of a
           null regular expression delimited by &lt;question-mark&gt;
           characters (<b>"??"</b>) shall address the previous line for which
           the line excluding the terminating &lt;newline&gt; matches the last
           regular expression encountered. In addition, the second
           &lt;question-mark&gt; can be omitted at the end of a command line.
           If the <b>wrapscan </b>edit option is set, the search shall wrap
           around from the beginning of the edit buffer to the end of
           the edit buffer and continue up to and including the current
           line, so that the entire edit buffer is searched. Within the
           regular expression, the sequence <b>"\?" </b>shall represent a
           literal &lt;question-mark&gt; instead of the RE delimiter.

        7. A &lt;plus-sign&gt; (<b>'+'</b>) or a &lt;hyphen-minus&gt; (<b>'-'</b>) followed by a
           decimal number shall address the current line plus or minus
           the number. A <b>'+' </b>or <b>'-' </b>not followed by a decimal number
           shall address the current line plus or minus 1.

       Addresses can be followed by zero or more address offsets,
       optionally &lt;blank&gt;-separated.  Address offsets are constructed as
       follows:

        1. A <b>'+' </b>or <b>'-' </b>immediately followed by a decimal number shall
           add (subtract) the indicated number of lines to (from) the
           address. A <b>'+' </b>or <b>'-' </b>not followed by a decimal number shall
           add (subtract) 1 to (from) the address.

        2. A decimal number shall add the indicated number of lines to
           the address.

       It shall not be an error for an intermediate address value to be
       less than zero or greater than the last line in the edit buffer.
       It shall be an error for the final address value to be less than
       zero or greater than the last line in the edit buffer.

       Commands take zero, one, or two addresses; see the descriptions
       of <i>1addr</i> and <i>2addr</i> in <i>Command Descriptions in ex</i>.  If more than
       the required number of addresses are provided to a command that
       requires zero addresses, it shall be an error. Otherwise, if more
       than the required number of addresses are provided to a command,
       the addresses specified first shall be evaluated and then
       discarded until the maximum number of valid addresses remain.

       Addresses shall be separated from each other by a &lt;comma&gt; (<b>','</b>)
       or a &lt;semicolon&gt; (<b>';'</b>).  If no address is specified before or
       after a &lt;comma&gt; or &lt;semicolon&gt; separator, it shall be as if the
       address of the current line was specified before or after the
       separator. In the case of a &lt;semicolon&gt; separator, the current
       line (<b>'.'</b>)  shall be set to the first address, and only then will
       the next address be calculated. This feature can be used to
       determine the starting line for forwards and backwards searches
       (see rules 5. and 6.).

       A &lt;percent-sign&gt; (<b>'%'</b>) shall be equivalent to entering the two
       addresses <b>"1,$"</b>.

       Any delimiting &lt;blank&gt; characters between addresses, address
       separators, or address offsets shall be discarded.

   <b>Command Line Parsing in ex</b>
       The following symbol is used in this and following sections to
       describe parsing behavior:

       <i>escape</i>    If a character is referred to as
                 ``&lt;backslash&gt;-escaped'' or ``&lt;control&gt;‐V-escaped'', it
                 shall mean that the character acquired or lost a
                 special meaning by virtue of being preceded,
                 respectively, by a &lt;backslash&gt; or &lt;control&gt;‐V
                 character. Unless otherwise specified, the escaping
                 character shall be discarded at that time and shall not
                 be further considered for any purpose.

       Command-line parsing shall be done in the following steps. For
       each step, characters already evaluated shall be ignored; that
       is, the phrase ``leading character'' refers to the next character
       that has not yet been evaluated.

        1. Leading &lt;colon&gt; characters shall be skipped.

        2. Leading &lt;blank&gt; characters shall be skipped.

        3. If the leading character is a double-quote character, the
           characters up to and including the next
           non-&lt;backslash&gt;-escaped &lt;newline&gt; shall be discarded, and any
           subsequent characters shall be parsed as a separate command.

        4. Leading characters that can be interpreted as addresses shall
           be evaluated; see <i>Addressing in ex</i>.

        5. Leading &lt;blank&gt; characters shall be skipped.

        6. If the next character is a &lt;vertical-line&gt; character or a
           &lt;newline&gt;:

            a. If the next character is a &lt;newline&gt;:

                i.  If <i>ex</i> is in open or visual mode, the current line
                    shall be set to the last address specified, if any.

               ii.  Otherwise, if the last command was terminated by a
                    &lt;vertical-line&gt; character, no action shall be taken;
                    for example, the command <b>"||&lt;newline&gt;" </b>shall execute
                    two implied commands, not three.

               iii. Otherwise, step 6.b. shall apply.

            b. Otherwise, the implied command shall be the <b>print</b>
               command. The last <b>#</b>, <b>p</b>, and <b>l </b>flags specified to any <i>ex</i>
               command shall be remembered and shall apply to this
               implied command.  Executing the <i>ex</i> <b>number</b>, <b>print</b>, or <b>list</b>
               command shall set the remembered flags to <b>#</b>, nothing, and
               <b>l</b>, respectively, plus any other flags specified for that
               execution of the <b>number</b>, <b>print</b>, or <b>list </b>command.

               If <i>ex</i> is not currently performing a <b>global </b>or <b>v </b>command,
               and no address or count is specified, the current line
               shall be incremented by 1 before the command is executed.
               If incrementing the current line would result in an
               address past the last line in the edit buffer, the
               command shall fail, and the increment shall not happen.

            c. The &lt;newline&gt; or &lt;vertical-line&gt; character shall be
               discarded and any subsequent characters shall be parsed
               as a separate command.

        7. The command name shall be comprised of the next character (if
           the character is not alphabetic), or the next character and
           any subsequent alphabetic characters (if the character is
           alphabetic), with the following exceptions:

            a. Commands that consist of any prefix of the characters in
               the command name <b>delete</b>, followed immediately by any of
               the characters <b>'l'</b>, <b>'p'</b>, <b>'+'</b>, <b>'-'</b>, or <b>'#' </b>shall be
               interpreted as a <b>delete </b>command, followed by a &lt;blank&gt;,
               followed by the characters that were not part of the
               prefix of the <b>delete </b>command. The maximum number of
               characters shall be matched to the command name <b>delete</b>;
               for example, <b>"del" </b>shall not be treated as <b>"de" </b>followed
               by the flag <b>l</b>.

            b. Commands that consist of the character <b>'k'</b>, followed by a
               character that can be used as the name of a mark, shall
               be equivalent to the mark command followed by a &lt;blank&gt;,
               followed by the character that followed the <b>'k'</b>.

            c. Commands that consist of the character <b>'s'</b>, followed by
               characters that could be interpreted as valid options to
               the <b>s </b>command, shall be the equivalent of the <b>s </b>command,
               without any pattern or replacement values, followed by a
               &lt;blank&gt;, followed by the characters after the <b>'s'</b>.

        8. The command name shall be matched against the possible
           command names, and a command name that contains a prefix
           matching the characters specified by the user shall be the
           executed command. In the case of commands where the
           characters specified by the user could be ambiguous, the
           executed command shall be as follows:
                    ┌────┬────────┬┬───┬───────┬┬───┬───────┐
                    │ <b>a  </b>│ <b>append </b>││<b>n  </b>│ <b>next  </b>││<b>t  </b>│ <b>t     </b>│
                    │ <b>c  </b>│ <b>change </b>││<b>p  </b>│ <b>print </b>││<b>u  </b>│ <b>undo  </b>│
                    │ <b>ch </b>│ <b>change </b>││<b>pr </b>│ <b>print </b>││<b>un </b>│ <b>undo  </b>│
                    │ <b>e  </b>│ <b>edit   </b>││<b>r  </b>│ <b>read  </b>││<b>v  </b>│ <b>v     </b>│
                    │ <b>m  </b>│ <b>move   </b>││<b>re </b>│ <b>read  </b>││<b>w  </b>│ <b>write </b>│
                    │ <b>ma </b>│ <b>mark   </b>││<b>s  </b>│ <b>s     </b>││   │       │
                    └────┴────────┴┴───┴───────┴┴───┴───────┘

           Implementation extensions with names causing similar
           ambiguities shall not be checked for a match until all
           possible matches for commands specified by POSIX.1‐2008 have
           been checked.

        9. If the command is a <b>!  </b>command, or if the command is a <b>read</b>
           command followed by zero or more &lt;blank&gt; characters and a <b>!</b>,
           or if the command is a <b>write </b>command followed by one or more
           &lt;blank&gt; characters and a <b>!</b>, the rest of the command shall
           include all characters up to a non-&lt;backslash&gt;-escaped
           &lt;newline&gt;.  The &lt;newline&gt; shall be discarded and any
           subsequent characters shall be parsed as a separate <i>ex</i>
           command.

       10. Otherwise, if the command is an <b>edit</b>, <b>ex</b>, or <b>next </b>command, or
           a <b>visual </b>command while in open or visual mode, the next part
           of the command shall be parsed as follows:

            a. Any <b>'!'  </b>character immediately following the command
               shall be skipped and be part of the command.

            b. Any leading &lt;blank&gt; characters shall be skipped and be
               part of the command.

            c. If the next character is a <b>'+'</b>, characters up to the
               first non-&lt;backslash&gt;-escaped &lt;newline&gt; or
               non-&lt;backslash&gt;-escaped &lt;blank&gt; shall be skipped and be
               part of the command.

            d. The rest of the command shall be determined by the steps
               specified in paragraph 12.

       11. Otherwise, if the command is a <b>global</b>, <b>open</b>, <b>s</b>, or <b>v </b>command,
           the next part of the command shall be parsed as follows:

            a. Any leading &lt;blank&gt; characters shall be skipped and be
               part of the command.

            b. If the next character is not an alphanumeric, double-
               quote, &lt;newline&gt;, &lt;backslash&gt;, or &lt;vertical-line&gt;
               character:

                i.  The next character shall be used as a command
                    delimiter.

               ii.  If the command is a <b>global</b>, <b>open</b>, or <b>v </b>command,
                    characters up to the first non-&lt;backslash&gt;-escaped
                    &lt;newline&gt;, or first non-&lt;backslash&gt;-escaped
                    delimiter character, shall be skipped and be part of
                    the command.

               iii. If the command is an <b>s </b>command, characters up to the
                    first non-&lt;backslash&gt;-escaped &lt;newline&gt;, or second
                    non-&lt;backslash&gt;-escaped delimiter character, shall
                    be skipped and be part of the command.

            c. If the command is a <b>global </b>or <b>v </b>command, characters up to
               the first non-&lt;backslash&gt;-escaped &lt;newline&gt; shall be
               skipped and be part of the command.

            d. Otherwise, the rest of the command shall be determined by
               the steps specified in paragraph 12.

       12. Otherwise:

            a. If the command was a <b>map</b>, <b>unmap</b>, <b>abbreviate</b>, or
               <b>unabbreviate </b>command, characters up to the first
               non-&lt;control&gt;‐V-escaped &lt;newline&gt;, &lt;vertical-line&gt;, or
               double-quote character shall be skipped and be part of
               the command.

            b. Otherwise, characters up to the first
               non-&lt;backslash&gt;-escaped &lt;newline&gt;, &lt;vertical-line&gt;, or
               double-quote character shall be skipped and be part of
               the command.

            c. If the command was an <b>append</b>, <b>change</b>, or <b>insert </b>command,
               and the step 12.b. ended at a &lt;vertical-line&gt; character,
               any subsequent characters, up to the next
               non-&lt;backslash&gt;-escaped &lt;newline&gt; shall be used as input
               text to the command.

            d. If the command was ended by a double-quote character, all
               subsequent characters, up to the next
               non-&lt;backslash&gt;-escaped &lt;newline&gt;, shall be discarded.

            e. The terminating &lt;newline&gt; or &lt;vertical-line&gt; character
               shall be discarded and any subsequent characters shall be
               parsed as a separate <i>ex</i> command.

       Command arguments shall be parsed as described by the Synopsis
       and Description of each individual <i>ex</i> command. This parsing shall
       not be &lt;blank&gt;-sensitive, except for the <b>!  </b>argument, which must
       follow the command name without intervening &lt;blank&gt; characters,
       and where it would otherwise be ambiguous. For example, <i>count</i> and
       <i>flag</i> arguments need not be &lt;blank&gt;-separated because <b>"d22p" </b>is
       not ambiguous, but <i>file</i> arguments to the <i>ex</i> <b>next </b>command must be
       separated by one or more &lt;blank&gt; characters. Any &lt;blank&gt; in
       command arguments for the <b>abbreviate</b>, <b>unabbreviate</b>, <b>map</b>, and
       <b>unmap </b>commands can be &lt;control&gt;‐V-escaped, in which case the
       &lt;blank&gt; shall not be used as an argument delimiter. Any &lt;blank&gt;
       in the command argument for any other command can be
       &lt;backslash&gt;-escaped, in which case that &lt;blank&gt; shall not be used
       as an argument delimiter.

       Within command arguments for the <b>abbreviate</b>, <b>unabbreviate</b>, <b>map</b>,
       and <b>unmap </b>commands, any character can be &lt;control&gt;‐V-escaped.
       All such escaped characters shall be treated literally and shall
       have no special meaning. Within command arguments for all other
       <i>ex</i> commands that are not regular expressions or replacement
       strings, any character that would otherwise have a special
       meaning can be &lt;backslash&gt;-escaped.  Escaped characters shall be
       treated literally, without special meaning as shell expansion
       characters or <b>'!'</b>, <b>'%'</b>, and <b>'#' </b>expansion characters. See <i>Regular</i>
       <i>Expressions in ex</i> and <i>Replacement Strings in ex</i> for descriptions
       of command arguments that are regular expressions or replacement
       strings.

       Non-&lt;backslash&gt;-escaped <b>'%' </b>characters appearing in <i>file</i>
       arguments to any <i>ex</i> command shall be replaced by the current
       pathname; unescaped <b>'#' </b>characters shall be replaced by the
       alternate pathname. It shall be an error if <b>'%' </b>or <b>'#' </b>characters
       appear unescaped in an argument and their corresponding values
       are not set.

       Non-&lt;backslash&gt;-escaped <b>'!'  </b>characters in the arguments to
       either the <i>ex</i> <b>!  </b>command or the open and visual mode <b>!  </b>command,
       or in the arguments to the <i>ex</i> <b>read </b>command, where the first
       non-&lt;blank&gt; after the command name is a <b>'!'  </b>character, or in the
       arguments to the <i>ex</i> <b>write </b>command where the command name is
       followed by one or more &lt;blank&gt; characters and the first
       non-&lt;blank&gt; after the command name is a <b>'!'  </b>character, shall be
       replaced with the arguments to the last of those three commands
       as they appeared after all unescaped <b>'%'</b>, <b>'#'</b>, and <b>'!'</b>
       characters were replaced. It shall be an error if <b>'!'  </b>characters
       appear unescaped in one of these commands and there has been no
       previous execution of one of these commands.

       If an error occurs during the parsing or execution of an <i>ex</i>
       command:

        *  An informational message to this effect shall be written.
           Execution of the <i>ex</i> command shall stop, and the cursor (for
           example, the current line and column) shall not be further
           modified.

        *  If the <i>ex</i> command resulted from a map expansion, all
           characters from that map expansion shall be discarded, except
           as otherwise specified by the <b>map </b>command.

        *  Otherwise, if the <i>ex</i> command resulted from the processing of
           an <i>EXINIT</i> environment variable, a <b>.exrc </b>file, a <b>:source</b>
           command, a <b>-c </b>option, or a <b>+</b><i>command</i> specified to an <i>ex</i> <b>edit</b>,
           <b>ex</b>, <b>next</b>, or <b>visual </b>command, no further commands from the
           source of the commands shall be executed.

        *  Otherwise, if the <i>ex</i> command resulted from the execution of a
           buffer or a <b>global </b>or <b>v </b>command, no further commands caused
           by the execution of the buffer or the <b>global </b>or <b>v </b>command
           shall be executed.

        *  Otherwise, if the <i>ex</i> command was not terminated by a
           &lt;newline&gt;, all characters up to and including the next
           non-&lt;backslash&gt;-escaped &lt;newline&gt; shall be discarded.

   <b>Input Editing in ex</b>
       The following symbol is used in this and the following sections
       to specify command actions:

       <i>word</i>      In the POSIX locale, a word consists of a maximal
                 sequence of letters, digits, and underscores, delimited
                 at both ends by characters other than letters, digits,
                 or underscores, or by the beginning or end of a line or
                 the edit buffer.

       When accepting input characters from the user, in either <i>ex</i>
       command mode or <i>ex</i> text input mode, <i>ex</i> shall enable canonical
       mode input processing, as defined in the System Interfaces volume
       of POSIX.1‐2017.

       If in <i>ex</i> text input mode:

        1. If the <b>number </b>edit option is set, <i>ex</i> shall prompt for input
           using the line number that would be assigned to the line if
           it is entered, in the format specified for the <i>ex</i> <b>number</b>
           command.

        2. If the <b>autoindent </b>edit option is set, <i>ex</i> shall prompt for
           input using <b>autoindent </b>characters, as described by the
           <b>autoindent </b>edit option.  <b>autoindent </b>characters shall follow
           the line number, if any.

       If in <i>ex</i> command mode:

        1. If the <b>prompt </b>edit option is set, input shall be prompted for
           using a single <b>':' </b>character; otherwise, there shall be no
           prompt.

       The input characters in the following sections shall have the
       following effects on the input line.

   <b>Scroll</b>
       <i>Synopsis</i>:

                     eof

       See the description of the <i>stty eof</i> character in <a href="stty.1p.html">stty(1p)</a>.

       If in <i>ex</i> command mode:

              If the <i>eof</i> character is the first character entered on the
              line, the line shall be evaluated as if it contained two
              characters: a &lt;control&gt;‐D and a &lt;newline&gt;.

              Otherwise, the <i>eof</i> character shall have no special
              meaning.

       If in <i>ex</i> text input mode:

              If the cursor follows an <b>autoindent </b>character, the
              <b>autoindent </b>characters in the line shall be modified so
              that a part of the next text input character will be
              displayed on the first column in the line after the
              previous <b>shiftwidth </b>edit option column boundary, and the
              user shall be prompted again for input for the same line.

              Otherwise, if the cursor follows a <b>'0'</b>, which follows an
              <b>autoindent </b>character, and the <b>'0' </b>was the previous text
              input character, the <b>'0' </b>and all <b>autoindent </b>characters in
              the line shall be discarded, and the user shall be
              prompted again for input for the same line.

              Otherwise, if the cursor follows a <b>'^'</b>, which follows an
              <b>autoindent </b>character, and the <b>'^' </b>was the previous text
              input character, the <b>'^' </b>and all <b>autoindent </b>characters in
              the line shall be discarded, and the user shall be
              prompted again for input for the same line. In addition,
              the <b>autoindent </b>level for the next input line shall be
              derived from the same line from which the <b>autoindent </b>level
              for the current input line was derived.

              Otherwise, if there are no <b>autoindent </b>or text input
              characters in the line, the <i>eof</i> character shall be
              discarded.

              Otherwise, the <i>eof</i> character shall have no special
              meaning.

   <b>&lt;newline&gt;</b>
       <i>Synopsis</i>:

                     &lt;newline&gt;
                     &lt;control&gt;-J

       If in <i>ex</i> command mode:

              Cause the command line to be parsed; &lt;control&gt;‐J shall be
              mapped to the &lt;newline&gt; for this purpose.

       If in <i>ex</i> text input mode:

              Terminate the current line. If there are no characters
              other than <b>autoindent </b>characters on the line, all
              characters on the line shall be discarded.

              Prompt for text input on a new line after the current
              line. If the <b>autoindent </b>edit option is set, an appropriate
              number of <b>autoindent </b>characters shall be added as a prefix
              to the line as described by the <i>ex</i> <b>autoindent </b>edit option.

   <b>&lt;backslash&gt;</b>
       <i>Synopsis</i>:

                     &lt;backslash&gt;

       Allow the entry of a subsequent &lt;newline&gt; or &lt;control&gt;‐J as a
       literal character, removing any special meaning that it may have
       to the editor during text input mode. The &lt;backslash&gt; character
       shall be retained and evaluated when the command line is parsed,
       or retained and included when the input text becomes part of the
       edit buffer.

   <b>&lt;control&gt;‐V</b>
       <i>Synopsis</i>:

                     &lt;control&gt;-V

       Allow the entry of any subsequent character as a literal
       character, removing any special meaning that it may have to the
       editor during text input mode. The &lt;control&gt;‐V character shall be
       discarded before the command line is parsed or the input text
       becomes part of the edit buffer.

       If the ``literal next'' functionality is performed by the
       underlying system, it is implementation-defined whether a
       character other than &lt;control&gt;‐V performs this function.

   <b>&lt;control&gt;‐W</b>
       <i>Synopsis</i>:

                     &lt;control&gt;-W

       Discard the &lt;control&gt;‐W, and the word previous to it in the input
       line, including any &lt;blank&gt; characters following the word and
       preceding the &lt;control&gt;‐W.  If the ``word erase'' functionality
       is performed by the underlying system, it is implementation-
       defined whether a character other than &lt;control&gt;‐W performs this
       function.

   <b>Command Descriptions in ex</b>
       The following symbols are used in this section to represent
       command modifiers. Some of these modifiers can be omitted, in
       which case the specified defaults shall be used.

       <i>1addr</i>     A single line address, given in any of the forms
                 described in <i>Addressing in ex</i>; the default shall be the
                 current line (<b>'.'</b>), unless otherwise specified.

                 If the line address is zero, it shall be an error,
                 unless otherwise specified in the following command
                 descriptions.

                 If the edit buffer is empty, and the address is
                 specified with a command other than <b>=</b>, <b>append</b>, <b>insert</b>,
                 <b>open</b>, <b>put</b>, <b>read</b>, or <b>visual</b>, or the address is not zero,
                 it shall be an error.

       <i>2addr</i>     Two addresses specifying an inclusive range of lines.
                 If no addresses are specified, the default for <i>2addr</i>
                 shall be the current line only (<b>".,."</b>), unless
                 otherwise specified in the following command
                 descriptions. If one address is specified, <i>2addr</i> shall
                 specify that line only, unless otherwise specified in
                 the following command descriptions.

                 It shall be an error if the first address is greater
                 than the second address.

                 If the edit buffer is empty, and the two addresses are
                 specified with a command other than the <b>!</b>, <b>write</b>, <b>wq</b>,
                 or <b>xit </b>commands, or either address is not zero, it
                 shall be an error.

       <i>count</i>     A positive decimal number. If <i>count</i> is specified, it
                 shall be equivalent to specifying an additional address
                 to the command, unless otherwise specified by the
                 following command descriptions. The additional address
                 shall be equal to the last address specified to the
                 command (either explicitly or by default) plus <i>count</i>-1.

                 If this would result in an address greater than the
                 last line of the edit buffer, it shall be corrected to
                 equal the last line of the edit buffer.

       <i>flags</i>     One or more of the characters <b>'+'</b>, <b>'-'</b>, <b>'#'</b>, <b>'p'</b>, or
                 <b>'l' </b>(ell). The flag characters can be
                 &lt;blank&gt;-separated, and in any order or combination. The
                 characters <b>'#'</b>, <b>'p'</b>, and <b>'l' </b>shall cause lines to be
                 written in the format specified by the <b>print </b>command
                 with the specified <i>flags</i>.

                 The lines to be written are as follows:

                  1. All edit buffer lines written during the execution
                     of the <i>ex</i> <b>&amp;</b>, <b>~</b>, <b>list</b>, <b>number</b>, <b>open</b>, <b>print</b>, <b>s</b>,
                     <b>visual</b>, and <b>z </b>commands shall be written as
                     specified by <i>flags</i>.

                  2. After the completion of an <i>ex</i> command with a flag
                     as an argument, the current line shall be written
                     as specified by <i>flags</i>, unless the current line was
                     the last line written by the command.

                 The characters <b>'+' </b>and <b>'-' </b>cause the value of the
                 current line after the execution of the <i>ex</i> command to
                 be adjusted by the offset address as described in
                 <i>Addressing in ex</i>.  This adjustment shall occur before
                 the current line is written as described in 2. above.

                 The default for <i>flags</i> shall be none.

       <i>buffer</i>    One of a number of named areas for holding text. The
                 named buffers are specified by the alphanumeric
                 characters of the POSIX locale. There shall also be one
                 ``unnamed'' buffer. When no buffer is specified for
                 editor commands that use a buffer, the unnamed buffer
                 shall be used.  Commands that store text into buffers
                 shall store the text as it was before the command took
                 effect, and shall store text occurring earlier in the
                 file before text occurring later in the file,
                 regardless of how the text region was specified.
                 Commands that store text into buffers shall store the
                 text into the unnamed buffer as well as any specified
                 buffer.

                 In <i>ex</i> commands, buffer names are specified as the name
                 by itself. In open or visual mode commands the name is
                 preceded by a double-quote (<b>'"'</b>) character.

                 If the specified buffer name is an uppercase character,
                 and the buffer contents are to be modified, the buffer
                 shall be appended to rather than being overwritten. If
                 the buffer is not being modified, specifying the buffer
                 name in lowercase and uppercase shall have identical
                 results.

                 There shall also be buffers named by the numbers 1
                 through 9. In open and visual mode, if a region of text
                 including characters from more than a single line is
                 being modified by the <i>vi</i> <b>c </b>or <b>d </b>commands, the motion
                 character associated with the <b>c </b>or <b>d </b>commands specifies
                 that the buffer text shall be in line mode, or the
                 commands <b>%</b>, <b>`</b>, <b>/</b>, <b>?</b>, <b>(</b>, <b>)</b>, <b>N</b>, <b>n</b>, <b>{</b>, or <b>} </b>are used to
                 define a region of text for the <b>c </b>or <b>d </b>commands, the
                 contents of buffers 1 through 8 shall be moved into the
                 buffer named by the next numerically greater value, the
                 contents of buffer 9 shall be discarded, and the region
                 of text shall be copied into buffer 1. This shall be in
                 addition to copying the text into a user-specified
                 buffer or unnamed buffer, or both. Numeric buffers can
                 be specified as a source buffer for open and visual
                 mode commands; however, specifying a numeric buffer as
                 the write target of an open or visual mode command
                 shall have unspecified results.

                 The text of each buffer shall have the characteristic
                 of being in either line or character mode. Appending
                 text to a non-empty buffer shall set the mode to match
                 the characteristic of the text being appended.
                 Appending text to a buffer shall cause the creation of
                 at least one additional line in the buffer. All text
                 stored into buffers by <i>ex</i> commands shall be in line
                 mode. The <i>ex</i> commands that use buffers as the source of
                 text specify individually how buffers of different
                 modes are handled. Each open or visual mode command
                 that uses buffers for any purpose specifies
                 individually the mode of the text stored into the
                 buffer and how buffers of different modes are handled.

       <i>file</i>      Command text used to derive a pathname. The default
                 shall be the current pathname, as defined previously,
                 in which case, if no current pathname has yet been
                 established it shall be an error, except where
                 specifically noted in the individual command
                 descriptions that follow.  If the command text contains
                 any of the characters <b>'~'</b>, <b>'{'</b>, <b>'['</b>, <b>'*'</b>, <b>'?'</b>, <b>'$'</b>,
                 <b>'"'</b>, backquote, single-quote, and &lt;backslash&gt;, it shall
                 be subjected to the process of ``shell expansions'', as
                 described below; if more than a single pathname results
                 and the command expects only one, it shall be an error.

                 The process of shell expansions in the editor shall be
                 done as follows. The <i>ex</i> utility shall pass two
                 arguments to the program named by the shell edit
                 option; the first shall be <b>-c</b>, and the second shall be
                 the string <b>"echo" </b>and the command text as a single
                 argument. The standard output and standard error of
                 that command shall replace the command text.

       <b>!         </b>A character that can be appended to the command name to
                 modify its operation, as detailed in the individual
                 command descriptions. With the exception of the <i>ex</i>
                 <b>read</b>, <b>write</b>, and <b>!  </b>commands, the <b>'!'  </b>character shall
                 only act as a modifier if there are no &lt;blank&gt;
                 characters between it and the command name.

       <i>remembered search direction</i>
                 The <i>vi</i> commands <b>N </b>and <b>n </b>begin searching in a forwards
                 or backwards direction in the edit buffer based on a
                 remembered search direction, which is initially unset,
                 and is set by the <i>ex</i> <b>global</b>, <b>v</b>, <b>s</b>, and <b>tag </b>commands,
                 and the <i>vi</i> <b>/ </b>and <b>?  </b>commands.

   <b>Abbreviate</b>
       <i>Synopsis</i>:

                     ab<b>[</b><i>breviate</i><b>][</b><i>lhs rhs</i><b>]</b>

       If <i>lhs</i> and <i>rhs</i> are not specified, write the current list of
       abbreviations and do nothing more.

       Implementations may restrict the set of characters accepted in
       <i>lhs</i> or <i>rhs</i>, except that printable characters and &lt;blank&gt;
       characters shall not be restricted. Additional restrictions shall
       be implementation-defined.

       In both <i>lhs</i> and <i>rhs</i>, any character may be escaped with a
       &lt;control&gt;‐V, in which case the character shall not be used to
       delimit <i>lhs</i> from <i>rhs</i>, and the escaping &lt;control&gt;‐V shall be
       discarded.

       In open and visual text input mode, if a non-word or &lt;ESC&gt;
       character that is not escaped by a &lt;control&gt;‐V character is
       entered after a word character, a check shall be made for a set
       of characters matching <i>lhs</i>, in the text input entered during this
       command. If it is found, the effect shall be as if <i>rhs</i> was
       entered instead of <i>lhs</i>.

       The set of characters that are checked is defined as follows:

        1. If there are no characters inserted before the word and non-
           word or &lt;ESC&gt; characters that triggered the check, the set of
           characters shall consist of the word character.

        2. If the character inserted before the word and non-word or
           &lt;ESC&gt; characters that triggered the check is a word
           character, the set of characters shall consist of the
           characters inserted immediately before the triggering
           characters that are word characters, plus the triggering word
           character.

        3. If the character inserted before the word and non-word or
           &lt;ESC&gt; characters that triggered the check is not a word
           character, the set of characters shall consist of the
           characters that were inserted before the triggering
           characters that are neither &lt;blank&gt; characters nor word
           characters, plus the triggering word character.

       It is unspecified whether the <i>lhs</i> argument entered for the <i>ex</i>
       <b>abbreviate </b>and <b>unabbreviate </b>commands is replaced in this fashion.
       Regardless of whether or not the replacement occurs, the effect
       of the command shall be as if the replacement had not occurred.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Append</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>a<b>[</b>ppend<b>][</b>!<b>]</b>

       Enter <i>ex</i> text input mode; the input text shall be placed after
       the specified line. If line zero is specified, the text shall be
       placed at the beginning of the edit buffer.

       This command shall be affected by the <b>number </b>and <b>autoindent </b>edit
       options; following the command name with <b>'!'  </b>shall cause the
       <b>autoindent </b>edit option setting to be toggled for the duration of
       this command only.

       <i>Current line</i>: Set to the last input line; if no lines were input,
       set to the specified line, or to the first line of the edit
       buffer if a line of zero was specified, or zero if the edit
       buffer is empty.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Arguments</b>
       <i>Synopsis</i>:

                     ar<b>[</b><i>gs</i><b>]</b>

       Write the current argument list, with the current argument-list
       entry, if any, between <b>'[' </b>and <b>']' </b>characters.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Change</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>c<b>[</b>hange<b>][</b>!<b>][</b><i>count</i><b>]</b>

       Enter <i>ex</i> text input mode; the input text shall replace the
       specified lines. The specified lines shall be copied into the
       unnamed buffer, which shall become a line mode buffer.

       This command shall be affected by the <b>number </b>and <b>autoindent </b>edit
       options; following the command name with <b>'!'  </b>shall cause the
       <b>autoindent </b>edit option setting to be toggled for the duration of
       this command only.

       <i>Current line</i>: Set to the last input line; if no lines were input,
       set to the line before the first address, or to the first line of
       the edit buffer if there are no lines preceding the first
       address, or to zero if the edit buffer is empty.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Change Directory</b>
       <i>Synopsis</i>:

                     chd<b>[</b>ir<b>][</b>!<b>][</b><i>directory</i><b>]</b>
                     cd<b>[</b>!<b>][</b><i>directory</i><b>]</b>

       Change the current working directory to <i>directory</i>.

       If no <i>directory</i> argument is specified, and the <i>HOME</i> environment
       variable is set to a non-null and non-empty value, <i>directory</i>
       shall default to the value named in the <i>HOME</i> environment
       variable. If the <i>HOME</i> environment variable is empty or is
       undefined, the default value of <i>directory</i> is implementation-
       defined.

       If no <b>'!'  </b>is appended to the command name, and the edit buffer
       has been modified since the last complete write, and the current
       pathname does not begin with a <b>'/'</b>, it shall be an error.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Copy</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>co<b>[</b>py<b>] </b><i>1addr</i> <b>[</b><i>flags</i><b>]</b>
                     <b>[</b><i>2addr</i><b>] </b>t <i>1addr</i> <b>[</b><i>flags</i><b>]</b>

       Copy the specified lines after the specified destination line;
       line zero specifies that the lines shall be placed at the
       beginning of the edit buffer.

       <i>Current line</i>: Set to the last line copied.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Delete</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>d<b>[</b>elete<b>][</b><i>buffer</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       Delete the specified lines into a buffer (defaulting to the
       unnamed buffer), which shall become a line-mode buffer.

       Flags can immediately follow the command name; see <i>Command Line</i>
       <i>Parsing in ex</i>.

       <i>Current line</i>: Set to the line following the deleted lines, or to
       the last line in the edit buffer if that line is past the end of
       the edit buffer, or to zero if the edit buffer is empty.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Edit</b>
       <i>Synopsis</i>:

                     e<b>[</b>dit<b>][</b>!<b>][</b>+<i>command</i><b>][</b><i>file</i><b>]</b>
                     ex<b>[</b>!<b>][</b>+<i>command</i><b>][</b><i>file</i><b>]</b>

       If no <b>'!'  </b>is appended to the command name, and the edit buffer
       has been modified since the last complete write, it shall be an
       error.

       If <i>file</i> is specified, replace the current contents of the edit
       buffer with the current contents of <i>file</i>, and set the current
       pathname to <i>file</i>.  If <i>file</i> is not specified, replace the current
       contents of the edit buffer with the current contents of the file
       named by the current pathname. If for any reason the current
       contents of the file cannot be accessed, the edit buffer shall be
       empty.

       The <b>+</b><i>command</i> option shall be &lt;blank&gt;-delimited; &lt;blank&gt;
       characters within the <b>+</b><i>command</i> can be escaped by preceding them
       with a &lt;backslash&gt; character. The <b>+</b><i>command</i> shall be interpreted
       as an <i>ex</i> command immediately after the contents of the edit
       buffer have been replaced and the current line and column have
       been set.

       If the edit buffer is empty:

       <i>Current line</i>: Set to 0.

       <i>Current column</i>: Set to 1.

       Otherwise, if executed while in <i>ex</i> command mode or if the
       <b>+</b><i>command</i> argument is specified:

       <i>Current line</i>: Set to the last line of the edit buffer.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

       Otherwise, if <i>file</i> is omitted or results in the current pathname:

       <i>Current line</i>: Set to the first line of the edit buffer.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

       Otherwise, if <i>file</i> is the same as the last file edited, the line
       and column shall be set as follows; if the file was previously
       edited, the line and column may be set as follows:

       <i>Current line</i>: Set to the last value held when that file was last
       edited. If this value is not a valid line in the new edit buffer,
       set to the first line of the edit buffer.

       <i>Current column</i>: If the current line was set to the last value
       held when the file was last edited, set to the last value held
       when the file was last edited.  Otherwise, or if the last value
       is not a valid column in the new edit buffer, set to non-&lt;blank&gt;.

       Otherwise:

       <i>Current line</i>: Set to the first line of the edit buffer.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>File</b>
       <i>Synopsis</i>:

                     f<b>[</b>ile<b>][</b><i>file</i><b>]</b>

       If a <i>file</i> argument is specified, the alternate pathname shall be
       set to the current pathname, and the current pathname shall be
       set to <i>file</i>.

       Write an informational message. If the file has a current
       pathname, it shall be included in this message; otherwise, the
       message shall indicate that there is no current pathname. If the
       edit buffer contains lines, the current line number and the
       number of lines in the edit buffer shall be included in this
       message; otherwise, the message shall indicate that the edit
       buffer is empty. If the edit buffer has been modified since the
       last complete write, this fact shall be included in this message.
       If the <b>readonly </b>edit option is set, this fact shall be included
       in this message. The message may contain other unspecified
       information.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Global</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>g<b>[</b>lobal<b>] </b>/<i>pattern</i>/ <b>[</b><i>commands</i><b>]</b>
                     <b>[</b><i>2addr</i><b>] </b>v /<i>pattern</i>/ <b>[</b><i>commands</i><b>]</b>

       The optional <b>'!'  </b>character after the <b>global </b>command shall be the
       same as executing the <b>v </b>command.

       If <i>pattern</i> is empty (for example, <b>"//"</b>) or not specified, the
       last regular expression used in the editor command shall be used
       as the <i>pattern</i>.  The <i>pattern</i> can be delimited by &lt;slash&gt;
       characters (shown in the Synopsis), as well as any non-
       alphanumeric or non-&lt;blank&gt; other than &lt;backslash&gt;, &lt;vertical-
       line&gt;, &lt;newline&gt;, or double-quote.

       If no lines are specified, the lines shall default to the entire
       file.

       The <b>global </b>and <b>v </b>commands are logically two-pass operations.
       First, mark the lines within the specified lines for which the
       line excluding the terminating &lt;newline&gt; matches (<b>global</b>) or does
       not match (<b>v </b>or <b>global!</b>)  the specified pattern. Second, execute
       the <i>ex</i> commands given by <i>commands</i>, with the current line (<b>'.'</b>)
       set to each marked line. If an error occurs during this process,
       or the contents of the edit buffer are replaced (for example, by
       the <i>ex</i> <b>:edit </b>command) an error message shall be written and no
       more commands resulting from the execution of this command shall
       be processed.

       Multiple <i>ex</i> commands can be specified by entering multiple
       commands on a single line using a &lt;vertical-line&gt; to delimit
       them, or one per line, by escaping each &lt;newline&gt; with a
       &lt;backslash&gt;.

       If no commands are specified:

        1. If in <i>ex</i> command mode, it shall be as if the <b>print </b>command
           were specified.

        2. Otherwise, no command shall be executed.

       For the <b>append</b>, <b>change</b>, and <b>insert </b>commands, the input text shall
       be included as part of the command, and the terminating &lt;period&gt;
       can be omitted if the command ends the list of commands. The <b>open</b>
       and <b>visual </b>commands can be specified as one of the commands, in
       which case each marked line shall cause the editor to enter open
       or visual mode. If open or visual mode is exited using the <i>vi</i> <b>Q</b>
       command, the current line shall be set to the next marked line,
       and open or visual mode reentered, until the list of marked lines
       is exhausted.

       The <b>global</b>, <b>v</b>, and <b>undo </b>commands cannot be used in <i>commands</i>.
       Marked lines may be deleted by commands executed for lines
       occurring earlier in the file than the marked lines. In this
       case, no commands shall be executed for the deleted lines.

       If the remembered search direction is not set, the <b>global </b>and <b>v</b>
       commands shall set it to forward.

       The <b>autoprint </b>and <b>autoindent </b>edit options shall be inhibited for
       the duration of the <b>g </b>or <b>v </b>command.

       <i>Current line</i>: If no commands executed, set to the last marked
       line. Otherwise, as specified for the executed <i>ex</i> commands.

       <i>Current column</i>: If no commands are executed, set to non-&lt;blank&gt;;
       otherwise, as specified for the individual <i>ex</i> commands.

   <b>Insert</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>i<b>[</b>nsert<b>][</b>!<b>]</b>

       Enter <i>ex</i> text input mode; the input text shall be placed before
       the specified line. If the line is zero or 1, the text shall be
       placed at the beginning of the edit buffer.

       This command shall be affected by the <b>number </b>and <b>autoindent </b>edit
       options; following the command name with <b>'!'  </b>shall cause the
       <b>autoindent </b>edit option setting to be toggled for the duration of
       this command only.

       <i>Current line</i>: Set to the last input line; if no lines were input,
       set to the line before the specified line, or to the first line
       of the edit buffer if there are no lines preceding the specified
       line, or zero if the edit buffer is empty.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Join</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>j<b>[</b>oin<b>][</b>!<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       If <i>count</i> is specified:

              If no address was specified, the <b>join </b>command shall behave
              as if <i>2addr</i> were the current line and the current line
              plus <i>count</i> (.,. + <i>count</i>).

              If one address was specified, the <b>join </b>command shall
              behave as if <i>2addr</i> were the specified address and the
              specified address plus <i>count</i> (<i>addr</i>,<i>addr</i> + <i>count</i>).

              If two addresses were specified, the <b>join </b>command shall
              behave as if an additional address, equal to the last
              address plus <i>count</i> -1 (<i>addr1</i>,<i>addr2</i>,<i>addr2</i> + <i>count</i> -1), was
              specified.

              If this would result in a second address greater than the
              last line of the edit buffer, it shall be corrected to be
              equal to the last line of the edit buffer.

       If no <i>count</i> is specified:

              If no address was specified, the <b>join </b>command shall behave
              as if <i>2addr</i> were the current line and the next line (.,.
              +1).

              If one address was specified, the <b>join </b>command shall
              behave as if <i>2addr</i> were the specified address and the next
              line (<i>addr</i>,<i>addr</i> +1).

       Join the text from the specified lines together into a single
       line, which shall replace the specified lines.

       If a <b>'!'  </b>character is appended to the command name, the <b>join</b>
       shall be without modification of any line, independent of the
       current locale.

       Otherwise, in the POSIX locale, set the current line to the first
       of the specified lines, and then, for each subsequent line,
       proceed as follows:

        1. Discard leading &lt;space&gt; characters from the line to be
           joined.

        2. If the line to be joined is now empty, delete it, and skip
           steps 3 through 5.

        3. If the current line ends in a &lt;blank&gt;, or the first character
           of the line to be joined is a <b>')' </b>character, join the lines
           without further modification.

        4. If the last character of the current line is a <b>'.'</b>, join the
           lines with two &lt;space&gt; characters between them.

        5. Otherwise, join the lines with a single &lt;space&gt; between them.

       <i>Current line</i>: Set to the first line specified.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>List</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>l<b>[</b>ist<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       This command shall be equivalent to the <i>ex</i> command:

           <b>[</b><i>2addr</i><b>] </b>p<b>[</b>rint<b>][</b><i>count</i><b>] </b>l<b>[</b><i>flags</i><b>]</b>

       See <i>Print</i>.

   <b>Map</b>
       <i>Synopsis</i>:

                     map<b>[</b>!<b>][</b><i>lhs rhs</i><b>]</b>

       If <i>lhs</i> and <i>rhs</i> are not specified:

        1. If <b>'!'  </b>is specified, write the current list of text input
           mode maps.

        2. Otherwise, write the current list of command mode maps.

        3. Do nothing more.

       Implementations may restrict the set of characters accepted in
       <i>lhs</i> or <i>rhs</i>, except that printable characters and &lt;blank&gt;
       characters shall not be restricted. Additional restrictions shall
       be implementation-defined. In both <i>lhs</i> and <i>rhs</i>, any character can
       be escaped with a &lt;control&gt;‐V, in which case the character shall
       not be used to delimit <i>lhs</i> from <i>rhs</i>, and the escaping &lt;control&gt;‐V
       shall be discarded.

       If the character <b>'!'  </b>is appended to the <b>map </b>command name, the
       mapping shall be effective during open or visual text input mode
       rather than <b>open </b>or <b>visual </b>command mode. This allows <i>lhs</i> to have
       two different <b>map </b>definitions at the same time: one for command
       mode and one for text input mode.

       For command mode mappings:

              When the <i>lhs</i> is entered as any part of a <i>vi</i> command in
              open or visual mode (but not as part of the arguments to
              the command), the action shall be as if the corresponding
              <i>rhs</i> had been entered.

              If any character in the command, other than the first, is
              escaped using a &lt;control&gt;‐V character, that character
              shall not be part of a match to an <i>lhs</i>.

              It is unspecified whether implementations shall support
              <b>map </b>commands where the <i>lhs</i> is more than a single character
              in length, where the first character of the <i>lhs</i> is
              printable.

              If <i>lhs</i> contains more than one character and the first
              character is <b>'#'</b>, followed by a sequence of digits
              corresponding to a numbered function key, then when this
              function key is typed it shall be mapped to <i>rhs</i>.
              Characters other than digits following a <b>'#' </b>character
              also represent the function key named by the characters in
              the <i>lhs</i> following the <b>'#' </b>and may be mapped to <i>rhs</i>.  It is
              unspecified how function keys are named or what function
              keys are supported.

       For text input mode mappings:

              When the <i>lhs</i> is entered as any part of text entered in
              open or visual text input modes, the action shall be as if
              the corresponding <i>rhs</i> had been entered.

              If any character in the input text is escaped using a
              &lt;control&gt;‐V character, that character shall not be part of
              a match to an <i>lhs</i>.

              It is unspecified whether the <i>lhs</i> text entered for
              subsequent <b>map </b>or <b>unmap </b>commands is replaced with the <i>rhs</i>
              text for the purposes of the screen display; regardless of
              whether or not the display appears as if the corresponding
              <i>rhs</i> text was entered, the effect of the command shall be
              as if the <i>lhs</i> text was entered.

       If only part of the <i>lhs</i> is entered, it is unspecified how long
       the editor will wait for additional, possibly matching characters
       before treating the already entered characters as not matching
       the <i>lhs</i>.

       The <i>rhs</i> characters shall themselves be subject to remapping,
       unless otherwise specified by the <b>remap </b>edit option, except that
       if the characters in <i>lhs</i> occur as prefix characters in <i>rhs</i>, those
       characters shall not be remapped.

       On block-mode terminals, the mapping need not occur immediately
       (for example, it may occur after the terminal transmits a group
       of characters to the system), but it shall achieve the same
       results as if it occurred immediately.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Mark</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>ma<b>[</b>rk<b>] </b><i>character</i>
                     <b>[</b><i>1addr</i><b>] </b>k <i>character</i>

       Implementations shall support <i>character</i> values of a single
       lowercase letter of the POSIX locale and the backquote and
       single-quote characters; support of other characters is
       implementation-defined.

       If executing the <i>vi</i> <b>m </b>command, set the specified mark to the
       current line and 1-based numbered character referenced by the
       current column, if any; otherwise, column position 1.

       Otherwise, set the specified mark to the specified line and
       1-based numbered first non-&lt;blank&gt; non-&lt;newline&gt; in the line, if
       any; otherwise, the last non-&lt;newline&gt; in the line, if any;
       otherwise, column position 1.

       The mark shall remain associated with the line until the mark is
       reset or the line is deleted. If a deleted line is restored by a
       subsequent <b>undo </b>command, any marks previously associated with the
       line, which have not been reset, shall be restored as well. Any
       use of a mark not associated with a current line in the edit
       buffer shall be an error.

       The marks <b>` </b>and <b>' </b>shall be set as described previously,
       immediately before the following events occur in the editor:

        1. The use of <b>'$' </b>as an <i>ex</i> address

        2. The use of a positive decimal number as an <i>ex</i> address

        3. The use of a search command as an <i>ex</i> address

        4. The use of a mark reference as an <i>ex</i> address

        5. The use of the following open and visual mode commands:
           &lt;control&gt;‐], <b>%</b>, <b>(</b>, <b>)</b>, <b>[</b>, <b>]</b>, <b>{</b>, <b>}</b>

        6. The use of the following open and visual mode commands: <b>'</b>, <b>G</b>,
           <b>H</b>, <b>L</b>, <b>M</b>, <b>z </b>if the current line will change as a result of the
           command

        7. The use of the open and visual mode commands: <b>/</b>, <b>?</b>, <b>N</b>, <b>`</b>, <b>n</b>
           if the current line or column will change as a result of the
           command

        8. The use of the <i>ex</i> mode commands: <b>z</b>, <b>undo</b>, <b>global</b>, <b>v</b>

       For rules 1., 2., 3., and 4., the <b>` </b>and <b>' </b>marks shall not be set
       if the <i>ex</i> command is parsed as specified by rule 6.a. in <i>Command</i>
       <i>Line Parsing in ex</i>.

       For rules 5., 6., and 7., the <b>` </b>and <b>' </b>marks shall not be set if
       the commands are used as motion commands in open and visual mode.

       For rules 1., 2., 3., 4., 5., 6., 7., and 8., the <b>` </b>and <b>' </b>marks
       shall not be set if the command fails.

       The <b>` </b>and <b>' </b>marks shall be set as described previously, each time
       the contents of the edit buffer are replaced (including the
       editing of the initial buffer), if in open or visual mode, or if
       in <b>ex </b>mode and the edit buffer is not empty, before any commands
       or movements (including commands or movements specified by the <b>-c</b>
       or <b>-t </b>options or the <b>+</b><i>command</i> argument) are executed on the edit
       buffer. If in open or visual mode, the marks shall be set as if
       executing the <i>vi</i> <b>m </b>command; otherwise, as if executing the <i>ex</i>
       <b>mark </b>command.

       When changing from <b>ex </b>mode to open or visual mode, if the <b>` </b>and <b>'</b>
       marks are not already set, the <b>` </b>and <b>' </b>marks shall be set as
       described previously.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Move</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>m<b>[</b>ove<b>] </b><i>1addr</i> <b>[</b><i>flags</i><b>]</b>

       Move the specified lines after the specified destination line. A
       destination of line zero specifies that the lines shall be placed
       at the beginning of the edit buffer. It shall be an error if the
       destination line is within the range of lines to be moved.

       <i>Current line</i>: Set to the last of the moved lines.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Next</b>
       <i>Synopsis</i>:

                     n<b>[</b>ext<b>][</b>!<b>][</b>+<i>command</i><b>][</b><i>file</i> ...<b>]</b>

       If no <b>'!'  </b>is appended to the command name, and the edit buffer
       has been modified since the last complete write, it shall be an
       error, unless the file is successfully written as specified by
       the <b>autowrite </b>option.

       If one or more files is specified:

        1. Set the argument list to the specified filenames.

        2. Set the current argument list reference to be the first entry
           in the argument list.

        3. Set the current pathname to the first filename specified.

       Otherwise:

        1. It shall be an error if there are no more filenames in the
           argument list after the filename currently referenced.

        2. Set the current pathname and the current argument list
           reference to the filename after the filename currently
           referenced in the argument list.

       Replace the contents of the edit buffer with the contents of the
       file named by the current pathname. If for any reason the
       contents of the file cannot be accessed, the edit buffer shall be
       empty.

       This command shall be affected by the <b>autowrite </b>and <b>writeany </b>edit
       options.

       The <b>+</b><i>command</i> option shall be &lt;blank&gt;-delimited; &lt;blank&gt;
       characters can be escaped by preceding them with a &lt;backslash&gt;
       character. The <b>+</b><i>command</i> shall be interpreted as an <i>ex</i> command
       immediately after the contents of the edit buffer have been
       replaced and the current line and column have been set.

       <i>Current line</i>: Set as described for the <b>edit </b>command.

       <i>Current column</i>: Set as described for the <b>edit </b>command.

   <b>Number</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>nu<b>[</b>mber<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>
                     <b>[</b><i>2addr</i><b>] </b>#<b>[</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       These commands shall be equivalent to the <i>ex</i> command:

           <b>[</b><i>2addr</i><b>] </b>p<b>[</b>rint<b>][</b><i>count</i><b>] </b>#<b>[</b><i>flags</i><b>]</b>

       See <i>Print</i>.

   <b>Open</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>o<b>[</b>pen<b>] </b>/<i>pattern</i>/ <b>[</b><i>flags</i><b>]</b>

       This command need not be supported on block-mode terminals or
       terminals with insufficient capabilities. If standard input,
       standard output, or standard error are not terminal devices, the
       results are unspecified.

       Enter open mode.

       The trailing delimiter can be omitted from <i>pattern</i> at the end of
       the command line. If <i>pattern</i> is empty (for example, <b>"//"</b>) or not
       specified, the last regular expression used in the editor shall
       be used as the pattern. The pattern can be delimited by &lt;slash&gt;
       characters (shown in the Synopsis), as well as any alphanumeric,
       or non-&lt;blank&gt; other than &lt;backslash&gt;, &lt;vertical-line&gt;,
       &lt;newline&gt;, or double-quote.

       <i>Current line</i>: Set to the specified line.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Preserve</b>
       <i>Synopsis</i>:

                     pre<b>[</b>serve<b>]</b>

       Save the edit buffer in a form that can later be recovered by
       using the <b>-r </b>option or by using the <i>ex</i> <b>recover </b>command. After the
       file has been preserved, a mail message shall be sent to the
       user. This message shall be readable by invoking the <i>mailx</i>
       utility. The message shall contain the name of the file, the time
       of preservation, and an <i>ex</i> command that could be used to recover
       the file. Additional information may be included in the mail
       message.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Print</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>p<b>[</b>rint<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       Write the addressed lines. The behavior is unspecified if the
       number of columns on the display is less than the number of
       columns required to write any single character in the lines being
       written.

       Non-printable characters, except for the &lt;tab&gt;, shall be written
       as implementation-defined multi-character sequences.

       If the <b># </b>flag is specified or the <b>number </b>edit option is set, each
       line shall be preceded by its line number in the following
       format:

           "%6d  ", &lt;<i>line number</i>&gt;

       If the <b>l </b>flag is specified or the <b>list </b>edit option is set:

        1. The characters listed in the Base Definitions volume of
           POSIX.1‐2017, <i>Table 5-1</i>, <i>Escape Sequences and Associated</i>
           <i>Actions</i> shall be written as the corresponding escape
           sequence.

        2. Non-printable characters not in the Base Definitions volume
           of POSIX.1‐2017, <i>Table 5-1</i>, <i>Escape Sequences and Associated</i>
           <i>Actions</i> shall be written as one three-digit octal number
           (with a preceding &lt;backslash&gt;) for each byte in the character
           (most significant byte first).

        3. The end of each line shall be marked with a <b>'$'</b>, and literal
           <b>'$' </b>characters within the line shall be written with a
           preceding &lt;backslash&gt;.

       Long lines shall be folded; the length at which folding occurs is
       unspecified, but should be appropriate for the output terminal,
       considering the number of columns of the terminal.

       If a line is folded, and the <b>l </b>flag is not specified and the <b>list</b>
       edit option is not set, it is unspecified whether a multi-column
       character at the folding position is separated; it shall not be
       discarded.

       <i>Current line</i>: Set to the last written line.

       <i>Current column</i>: Unchanged if the current line is unchanged;
       otherwise, set to non-&lt;blank&gt;.

   <b>Put</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>pu<b>[</b>t<b>][</b><i>buffer</i><b>]</b>

       Append text from the specified buffer (by default, the unnamed
       buffer) to the specified line; line zero specifies that the text
       shall be placed at the beginning of the edit buffer. Each portion
       of a line in the buffer shall become a new line in the edit
       buffer, regardless of the mode of the buffer.

       <i>Current line</i>: Set to the last line entered into the edit buffer.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Quit</b>
       <i>Synopsis</i>:

                     q<b>[</b>uit<b>][</b>!<b>]</b>

       If no <b>'!'  </b>is appended to the command name:

        1. If the edit buffer has been modified since the last complete
           write, it shall be an error.

        2. If there are filenames in the argument list after the
           filename currently referenced, and the last command was not a
           <b>quit</b>, <b>wq</b>, <b>xit</b>, or <b>ZZ </b>(see <i>Exit</i>) command, it shall be an
           error.

       Otherwise, terminate the editing session.

   <b>Read</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>r<b>[</b>ead<b>][</b>!<b>][</b><i>file</i><b>]</b>

       If <b>'!'  </b>is not the first non-&lt;blank&gt; to follow the command name,
       a copy of the specified file shall be appended into the edit
       buffer after the specified line; line zero specifies that the
       copy shall be placed at the beginning of the edit buffer. The
       number of lines and bytes read shall be written. If no <i>file</i> is
       named, the current pathname shall be the default. If there is no
       current pathname, then <i>file</i> shall become the current pathname. If
       there is no current pathname or <i>file</i> operand, it shall be an
       error. Specifying a <i>file</i> that is not of type regular shall have
       unspecified results.

       Otherwise, if <i>file</i> is preceded by <b>'!'</b>, the rest of the line after
       the <b>'!'  </b>shall have <b>'%'</b>, <b>'#'</b>, and <b>'!'  </b>characters expanded as
       described in <i>Command Line Parsing in ex</i>.

       The <i>ex</i> utility shall then pass two arguments to the program named
       by the shell edit option; the first shall be <b>-c </b>and the second
       shall be the expanded arguments to the <b>read </b>command as a single
       argument. The standard input of the program shall be set to the
       standard input of the <i>ex</i> program when it was invoked. The
       standard error and standard output of the program shall be
       appended into the edit buffer after the specified line.

       Each line in the copied file or program output (as delimited by
       &lt;newline&gt; characters or the end of the file or output if it is
       not immediately preceded by a &lt;newline&gt;), shall be a separate
       line in the edit buffer. Any occurrences of &lt;carriage-return&gt; and
       &lt;newline&gt; pairs in the output shall be treated as single
       &lt;newline&gt; characters.

       The special meaning of the <b>'!'  </b>following the <b>read </b>command can be
       overridden by escaping it with a &lt;backslash&gt; character.

       <i>Current line</i>: If no lines are added to the edit buffer,
       unchanged. Otherwise, if in open or visual mode, set to the first
       line entered into the edit buffer. Otherwise, set to the last
       line entered into the edit buffer.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Recover</b>
       <i>Synopsis</i>:

                     rec<b>[</b>over<b>][</b>!<b>] </b><i>file</i>

       If no <b>'!'  </b>is appended to the command name, and the edit buffer
       has been modified since the last complete write, it shall be an
       error.

       If no <i>file</i> operand is specified, then the current pathname shall
       be used. If there is no current pathname or <i>file</i> operand, it
       shall be an error.

       If no recovery information has previously been saved about <i>file</i>,
       the <b>recover </b>command shall behave identically to the <b>edit </b>command,
       and an informational message to this effect shall be written.

       Otherwise, set the current pathname to <i>file</i>, and replace the
       current contents of the edit buffer with the recovered contents
       of <i>file</i>.  If there are multiple instances of the file to be
       recovered, the one most recently saved shall be recovered, and an
       informational message that there are previous versions of the
       file that can be recovered shall be written. The editor shall
       behave as if the contents of the edit buffer have already been
       modified.

       <i>Current file</i>: Set as described for the <b>edit </b>command.

       <i>Current column</i>: Set as described for the <b>edit </b>command.

   <b>Rewind</b>
       <i>Synopsis</i>:

                     rew<b>[</b>ind<b>][</b>!<b>]</b>

       If no <b>'!'  </b>is appended to the command name, and the edit buffer
       has been modified since the last complete write, it shall be an
       error, unless the file is successfully written as specified by
       the <b>autowrite </b>option.

       If the argument list is empty, it shall be an error.

       The current argument list reference and the current pathname
       shall be set to the first filename in the argument list.

       Replace the contents of the edit buffer with the contents of the
       file named by the current pathname. If for any reason the
       contents of the file cannot be accessed, the edit buffer shall be
       empty.

       This command shall be affected by the <b>autowrite </b>and <b>writeany </b>edit
       options.

       <i>Current line</i>: Set as described for the <b>edit </b>command.

       <i>Current column</i>: Set as described for the <b>edit </b>command.

   <b>Set</b>
       <i>Synopsis</i>:

                     se<b>[</b>t<b>][</b><i>option</i><b>[</b>=<b>[</b><i>value</i><b>]] </b>...<b>][</b>no<i>option</i> ...<b>][</b><i>option</i>? ...<b>][</b>all<b>]</b>

       When no arguments are specified, write the value of the <b>term </b>edit
       option and those options whose values have been changed from the
       default settings; when the argument <i>all</i> is specified, write all
       of the option values.

       Giving an option name followed by the character <b>'?'  </b>shall cause
       the current value of that option to be written. The <b>'?'  </b>can be
       separated from the option name by zero or more &lt;blank&gt;
       characters. The <b>'?'  </b>shall be necessary only for Boolean valued
       options. Boolean options can be given values by the form <b>set</b>
       <i>option</i> to turn them on or <b>set no</b><i>option</i> to turn them off; string
       and numeric options can be assigned by the form <b>set </b><i>option</i>=<i>value</i>.
       Any &lt;blank&gt; characters in strings can be included as is by
       preceding each &lt;blank&gt; with an escaping &lt;backslash&gt;.  More than
       one option can be set or listed by a single set command by
       specifying multiple arguments, each separated from the next by
       one or more &lt;blank&gt; characters.

       See <i>Edit Options in ex</i> for details about specific options.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Shell</b>
       <i>Synopsis</i>:

                     sh<b>[</b>ell<b>]</b>

       Invoke the program named in the <b>shell </b>edit option with the single
       argument <b>-i </b>(interactive mode). Editing shall be resumed when the
       program exits.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Source</b>
       <i>Synopsis</i>:

                     so<b>[</b>urce<b>] </b><i>file</i>

       Read and execute <i>ex</i> commands from <i>file</i>.  Lines in the file that
       are blank lines shall be ignored.

       <i>Current line</i>: As specified for the individual <i>ex</i> commands.

       <i>Current column</i>: As specified for the individual <i>ex</i> commands.

   <b>Substitute</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>s<b>[</b>ubstitute<b>][</b>/<i>pattern</i>/<i>repl</i>/<b>[</b><i>options</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]]</b>
                     <b>[</b><i>2addr</i><b>] </b>&amp;<b>[</b><i>options</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]]</b>
                     <b>[</b><i>2addr</i><b>] </b>~<b>[</b><i>options</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]]</b>

       Replace the first instance of the pattern <i>pattern</i> by the string
       <i>repl</i> on each specified line. (See <i>Regular Expressions in ex</i> and
       <i>Replacement Strings in ex</i>.)  Any non-alphabetic, non-&lt;blank&gt;
       delimiter other than &lt;backslash&gt;, <b>'|'</b>, &lt;newline&gt;, or double-quote
       can be used instead of <b>'/'</b>.  &lt;backslash&gt; characters can be used
       to escape delimiters, &lt;backslash&gt; characters, and other special
       characters.

       The trailing delimiter can be omitted from <i>pattern</i> or from <i>repl</i>
       at the end of the command line. If both <i>pattern</i> and <i>repl</i> are not
       specified or are empty (for example, <b>"//"</b>), the last <b>s </b>command
       shall be repeated. If only <i>pattern</i> is not specified or is empty,
       the last regular expression used in the editor shall be used as
       the pattern. If only <i>repl</i> is not specified or is empty, the
       pattern shall be replaced by nothing.  If the entire replacement
       pattern is <b>'%'</b>, the last replacement pattern to an <b>s </b>command
       shall be used.

       Entering a &lt;carriage-return&gt; in <i>repl</i> (which requires an escaping
       &lt;backslash&gt; in <i>ex</i> mode and an escaping &lt;control&gt;‐V in open or <i>vi</i>
       mode) shall split the line at that point, creating a new line in
       the edit buffer. The &lt;carriage-return&gt; shall be discarded.

       If <i>options</i> includes the letter <b>'g' </b>(<b>global</b>), all non-overlapping
       instances of the pattern in the line shall be replaced.

       If <i>options</i> includes the letter <b>'c' </b>(<b>confirm</b>), then before each
       substitution the line shall be written; the written line shall
       reflect all previous substitutions. On the following line,
       &lt;space&gt; characters shall be written beneath the characters from
       the line that are before the <i>pattern</i> to be replaced, and <b>'^'</b>
       characters written beneath the characters included in the <i>pattern</i>
       to be replaced. The <i>ex</i> utility shall then wait for a response
       from the user. An affirmative response shall cause the
       substitution to be done, while any other input shall not make the
       substitution. An affirmative response shall consist of a line
       with the affirmative response (as defined by the current locale)
       at the beginning of the line. This line shall be subject to
       editing in the same way as the <i>ex</i> command line.

       If interrupted (see the ASYNCHRONOUS EVENTS section), any
       modifications confirmed by the user shall be preserved in the
       edit buffer after the interrupt.

       If the remembered search direction is not set, the <b>s </b>command
       shall set it to forward.

       In the second Synopsis, the <b>&amp; </b>command shall repeat the previous
       substitution, as if the <b>&amp; </b>command were replaced by:

           s/<i>pattern</i>/<i>repl</i>/

       where <i>pattern</i> and <i>repl</i> are as specified in the previous <b>s</b>, <b>&amp;</b>, or
       <b>~ </b>command.

       In the third Synopsis, the <b>~ </b>command shall repeat the previous
       substitution, as if the <b>'~' </b>were replaced by:

           s/<i>pattern</i>/<i>repl</i>/

       where <i>pattern</i> shall be the last regular expression specified to
       the editor, and <i>repl</i> shall be from the previous substitution
       (including <b>&amp; </b>and <b>~</b>) command.

       These commands shall be affected by the <i>LC_MESSAGES</i> environment
       variable.

       <i>Current line</i>: Set to the last line in which a substitution
       occurred, or, unchanged if no substitution occurred.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Suspend</b>
       <i>Synopsis</i>:

                     su<b>[</b>spend<b>][</b>!<b>]</b>
                     st<b>[</b>op<b>][</b>!<b>]</b>

       Allow control to return to the invoking process; <i>ex</i> shall suspend
       itself as if it had received the SIGTSTP signal. The suspension
       shall occur only if job control is enabled in the invoking shell
       (see the description of <i>set</i> <b>-m</b>).

       These commands shall be affected by the <b>autowrite </b>and <b>writeany</b>
       edit options.

       The current <b>susp </b>character (see <a href="stty.1p.html">stty(1p)</a>) shall be equivalent to
       the <b>suspend </b>command.

   <b>Tag</b>
       <i>Synopsis</i>:

                     ta<b>[</b>g<b>][</b>!<b>] </b><i>tagstring</i>

       The results are unspecified if the format of a tags file is not
       as specified by the <i>ctags</i> utility (see <a href="ctags.1p.html">ctags(1p)</a>) description.

       The <b>tag </b>command shall search for <i>tagstring</i> in the tag files
       referred to by the <b>tag </b>edit option, in the order they are
       specified, until a reference to <i>tagstring</i> is found. Files shall
       be searched from beginning to end. If no reference is found, it
       shall be an error and an error message to this effect shall be
       written. If the reference is not found, or if an error occurs
       while processing a file referred to in the <b>tag </b>edit option, it
       shall be an error, and an error message shall be written at the
       first occurrence of such an error.

       Otherwise, if the tags file contained a pattern, the pattern
       shall be treated as a regular expression used in the editor; for
       example, for the purposes of the <b>s </b>command.

       If the <i>tagstring</i> is in a file with a different name than the
       current pathname, set the current pathname to the name of that
       file, and replace the contents of the edit buffer with the
       contents of that file. In this case, if no <b>'!'  </b>is appended to
       the command name, and the edit buffer has been modified since the
       last complete write, it shall be an error, unless the file is
       successfully written as specified by the <b>autowrite </b>option.

       This command shall be affected by the <b>autowrite</b>, <b>tag</b>, <b>taglength</b>,
       and <b>writeany </b>edit options.

       <i>Current line</i>: If the tags file contained a line number, set to
       that line number. If the line number is larger than the last line
       in the edit buffer, an error message shall be written and the
       current line shall be set as specified for the <b>edit </b>command.

       If the tags file contained a pattern, set to the first occurrence
       of the pattern in the file. If no matching pattern is found, an
       error message shall be written and the current line shall be set
       as specified for the <b>edit </b>command.

       <i>Current column</i>: If the tags file contained a line-number
       reference and that line-number was not larger than the last line
       in the edit buffer, or if the tags file contained a pattern and
       that pattern was found, set to non-&lt;blank&gt;.  Otherwise, set as
       specified for the <b>edit </b>command.

   <b>Unabbreviate</b>
       <i>Synopsis</i>:

                     una<b>[</b>bbrev<b>] </b><i>lhs</i>

       If <i>lhs</i> is not an entry in the current list of abbreviations (see
       <i>Abbreviate</i>), it shall be an error. Otherwise, delete <i>lhs</i> from the
       list of abbreviations.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Undo</b>
       <i>Synopsis</i>:

                     u<b>[</b>ndo<b>]</b>

       Reverse the changes made by the last command that modified the
       contents of the edit buffer, including <b>undo</b>.  For this purpose,
       the <b>global</b>, <b>v</b>, <b>open</b>, and <b>visual </b>commands, and commands resulting
       from buffer executions and mapped character expansions, are
       considered single commands.

       If no action that can be undone preceded the <b>undo </b>command, it
       shall be an error.

       If the <b>undo </b>command restores lines that were marked, the mark
       shall also be restored unless it was reset subsequent to the
       deletion of the lines.

       <i>Current line</i>:

        1. If lines are added or changed in the file, set to the first
           line added or changed.

        2. Set to the line before the first line deleted, if it exists.

        3. Set to 1 if the edit buffer is not empty.

        4. Set to zero.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Unmap</b>
       <i>Synopsis</i>:

                     unm<b>[</b>ap<b>][</b>!<b>] </b><i>lhs</i>

       If <b>'!'  </b>is appended to the command name, and if <i>lhs</i> is not an
       entry in the list of text input mode map definitions, it shall be
       an error. Otherwise, delete <i>lhs</i> from the list of text input mode
       map definitions.

       If no <b>'!'  </b>is appended to the command name, and if <i>lhs</i> is not an
       entry in the list of command mode map definitions, it shall be an
       error. Otherwise, delete <i>lhs</i> from the list of command mode map
       definitions.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Version</b>
       <i>Synopsis</i>:

                     ve<b>[</b>rsion<b>]</b>

       Write a message containing version information for the editor.
       The format of the message is unspecified.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Visual</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>vi<b>[</b>sual<b>][</b><i>type</i><b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       If <i>ex</i> is currently in open or visual mode, the Synopsis and
       behavior of the visual command shall be the same as the <b>edit</b>
       command, as specified by <i>Edit</i>.

       Otherwise, this command need not be supported on block-mode
       terminals or terminals with insufficient capabilities. If
       standard input, standard output, or standard error are not
       terminal devices, the results are unspecified.

       If <i>count</i> is specified, the value of the <b>window </b>edit option shall
       be set to <i>count</i> (as described in <i>window</i>).  If the <b>'^' </b>type
       character was also specified, the <b>window </b>edit option shall be set
       before being used by the type character.

       Enter visual mode. If <i>type</i> is not specified, it shall be as if a
       <i>type</i> of <b>'+' </b>was specified. The <i>type</i> shall cause the following
       effects:

       +     Place the beginning of the specified line at the top of the
             display.

       -     Place the end of the specified line at the bottom of the
             display.

       .     Place the beginning of the specified line in the middle of
             the display.

       ^     If the specified line is less than or equal to the value of
             the <b>window </b>edit option, set the line to 1; otherwise,
             decrement the line by the value of the <b>window </b>edit option
             minus 1. Place the beginning of this line as close to the
             bottom of the displayed lines as possible, while still
             displaying the value of the <b>window </b>edit option number of
             lines.

       <i>Current line</i>: Set to the specified line.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Write</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>w<b>[</b>rite<b>][</b>!<b>][</b>&gt;&gt;<b>][</b><i>file</i><b>]</b>
                     <b>[</b><i>2addr</i><b>] </b>w<b>[</b>rite<b>][</b>!<b>][</b><i>file</i><b>]</b>
                     <b>[</b><i>2addr</i><b>] </b>wq<b>[</b>!<b>][</b>&gt;&gt;<b>][</b><i>file</i><b>]</b>

       If no lines are specified, the lines shall default to the entire
       file.

       The command <b>wq </b>shall be equivalent to a <b>write </b>command followed by
       a <b>quit </b>command; <b>wq!  </b>shall be equivalent to <b>write!  </b>followed by
       <b>quit</b>.  In both cases, if the <b>write </b>command fails, the <b>quit </b>shall
       not be attempted.

       If the command name is not followed by one or more &lt;blank&gt;
       characters, or <i>file</i> is not preceded by a <b>'!'  </b>character, the
       <b>write </b>shall be to a file.

        1. If the <b>&gt;&gt; </b>argument is specified, and the file already exists,
           the lines shall be appended to the file instead of replacing
           its contents. If the <b>&gt;&gt; </b>argument is specified, and the file
           does not already exist, it is unspecified whether the write
           shall proceed as if the <b>&gt;&gt; </b>argument had not been specified or
           if the write shall fail.

        2. If the <b>readonly </b>edit option is set (see <i>readonly</i>), the <b>write</b>
           shall fail.

        3. If <i>file</i> is specified, and is not the current pathname, and
           the file exists, the <b>write </b>shall fail.

        4. If <i>file</i> is not specified, the current pathname shall be used.
           If there is no current pathname, the <b>write </b>command shall
           fail.

        5. If the current pathname is used, and the current pathname has
           been changed by the <b>file </b>or <b>read </b>commands, and the file
           exists, the <b>write </b>shall fail. If the <b>write </b>is successful,
           subsequent <b>write</b>s shall not fail for this reason (unless the
           current pathname is changed again).

        6. If the whole edit buffer is not being written, and the file
           to be written exists, the <b>write </b>shall fail.

       For rules 1., 2., 3., and 5., the <b>write </b>can be forced by
       appending the character <b>'!'  </b>to the command name.

       For rules 2., 3., and 5., the <b>write </b>can be forced by setting the
       <b>writeany </b>edit option.

       Additional, implementation-defined tests may cause the <b>write </b>to
       fail.

       If the edit buffer is empty, a file without any contents shall be
       written.

       An informational message shall be written noting the number of
       lines and bytes written.

       Otherwise, if the command is followed by one or more &lt;blank&gt;
       characters, and the file is preceded by <b>'!'</b>, the rest of the line
       after the <b>'!'  </b>shall have <b>'%'</b>, <b>'#'</b>, and <b>'!'  </b>characters expanded
       as described in <i>Command Line Parsing in ex</i>.

       The <i>ex</i> utility shall then pass two arguments to the program named
       by the <b>shell </b>edit option; the first shall be <b>-c </b>and the second
       shall be the expanded arguments to the <b>write </b>command as a single
       argument. The specified lines shall be written to the standard
       input of the command. The standard error and standard output of
       the program, if any, shall be written as described for the <b>print</b>
       command. If the last character in that output is not a &lt;newline&gt;,
       a &lt;newline&gt; shall be written at the end of the output.

       The special meaning of the <b>'!'  </b>following the <b>write </b>command can
       be overridden by escaping it with a &lt;backslash&gt; character.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Write and Exit</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>x<b>[</b>it<b>][</b>!<b>][</b><i>file</i><b>]</b>

       If the edit buffer has not been modified since the last complete
       <b>write</b>, <b>xit </b>shall be equivalent to the <b>quit </b>command, or if a <b>'!'</b>
       is appended to the command name, to <b>quit!</b>.

       Otherwise, <b>xit </b>shall be equivalent to the <b>wq </b>command, or if a <b>'!'</b>
       is appended to the command name, to <b>wq!</b>.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Yank</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>ya<b>[</b>nk<b>][</b><i>buffer</i><b>][</b><i>count</i><b>]</b>

       Copy the specified lines to the specified buffer (by default, the
       unnamed buffer), which shall become a line-mode buffer.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Adjust Window</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>z<b>[</b>!<b>][</b><i>type</i> ...<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       If no line is specified, the current line shall be the default;
       if <i>type</i> is omitted as well, the current line value shall first be
       incremented by 1. If incrementing the current line would cause it
       to be greater than the last line in the edit buffer, it shall be
       an error.

       If there are &lt;blank&gt; characters between the <i>type</i> argument and the
       preceding <b>z </b>command name or optional <b>'!'  </b>character, it shall be
       an error.

       If <i>count</i> is specified, the value of the <b>window </b>edit option shall
       be set to <i>count</i> (as described in <i>window</i>).  If <i>count</i> is omitted,
       it shall default to 2 times the value of the <b>scroll </b>edit option,
       or if <b>!  </b>was specified, the number of lines in the display minus
       1.

       If <i>type</i> is omitted, then <i>count</i> lines starting with the specified
       line shall be written. Otherwise, <i>count</i> lines starting with the
       line specified by the <i>type</i> argument shall be written.

       The <i>type</i> argument shall change the lines to be written. The
       possible values of <i>type</i> are as follows:

       -     The specified line shall be decremented by the following
             value:

                 (((number of '-' characters) x <i>count</i>) -1)

             If the calculation would result in a number less than 1, it
             shall be an error. Write lines from the edit buffer,
             starting at the new value of line, until <i>count</i> lines or the
             last line in the edit buffer has been written.

       +     The specified line shall be incremented by the following
             value:

                 (((number of '+' characters) -1) x <i>count</i>) +1

             If the calculation would result in a number greater than
             the last line in the edit buffer, it shall be an error.
             Write lines from the edit buffer, starting at the new value
             of line, until <i>count</i> lines or the last line in the edit
             buffer has been written.

       =,.   If more than a single <b>'.'  </b>or <b>'=' </b>is specified, it shall be
             an error. The following steps shall be taken:

              1. If <i>count</i> is zero, nothing shall be written.

              2. Write as many of the <i>N</i> lines before the current line in
                 the edit buffer as exist. If <i>count</i> or <b>'!'  </b>was
                 specified, <i>N</i> shall be:

                     (<i>count</i> -1) /2

                 Otherwise, <i>N</i> shall be:

                     (<i>count</i> -3) /2

                 If <i>N</i> is a number less than 3, no lines shall be
                 written.

              3. If <b>'=' </b>was specified as the type character, write a
                 line consisting of the smaller of the number of columns
                 in the display divided by two, or 40 <b>'-' </b>characters.

              4. Write the current line.

              5. Repeat step 3.

              6. Write as many of the <i>N</i> lines after the current line in
                 the edit buffer as exist.  <i>N</i> shall be defined as in
                 step 2. If <i>N</i> is a number less than 3, no lines shall be
                 written. If <i>count</i> is less than 3, no lines shall be
                 written.

       ^     The specified line shall be decremented by the following
             value:

                 (((number of '^' characters) +1) x <i>count</i>) -1

             If the calculation would result in a number less than 1, it
             shall be an error. Write lines from the edit buffer,
             starting at the new value of line, until <i>count</i> lines or the
             last line in the edit buffer has been written.

       <i>Current line</i>: Set to the last line written, unless the type is <b>=</b>,
       in which case, set to the specified line.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Escape</b>
       <i>Synopsis</i>:

                     ! <i>command</i>
                     <b>[</b><i>addr</i><b>]</b>! <i>command</i>

       The contents of the line after the <b>'!'  </b>shall have <b>'%'</b>, <b>'#'</b>, and
       <b>'!'  </b>characters expanded as described in <i>Command Line Parsing in</i>
       <i>ex</i>.  If the expansion causes the text of the line to change, it
       shall be redisplayed, preceded by a single <b>'!'  </b>character.

       The <i>ex</i> utility shall execute the program named by the <b>shell </b>edit
       option. It shall pass two arguments to the program; the first
       shall be <b>-c</b>, and the second shall be the expanded arguments to
       the <b>!  </b>command as a single argument.

       If no lines are specified, the standard input, standard output,
       and standard error of the program shall be set to the standard
       input, standard output, and standard error of the <i>ex</i> program when
       it was invoked. In addition, a warning message shall be written
       if the edit buffer has been modified since the last complete
       write, and the <b>warn </b>edit option is set.

       If lines are specified, they shall be passed to the program as
       standard input, and the standard output and standard error of the
       program shall replace those lines in the edit buffer. Each line
       in the program output (as delimited by &lt;newline&gt; characters or
       the end of the output if it is not immediately preceded by a
       &lt;newline&gt;), shall be a separate line in the edit buffer. Any
       occurrences of &lt;carriage-return&gt; and &lt;newline&gt; pairs in the
       output shall be treated as single &lt;newline&gt; characters. The
       specified lines shall be copied into the unnamed buffer before
       they are replaced, and the unnamed buffer shall become a line-
       mode buffer.

       If in <i>ex</i> mode, a single <b>'!'  </b>character shall be written when the
       program completes.

       This command shall be affected by the <b>shell </b>and <b>warn </b>edit
       options. If no lines are specified, this command shall be
       affected by the <b>autowrite </b>and <b>writeany </b>edit options. If lines are
       specified, this command shall be affected by the <b>autoprint </b>edit
       option.

       <i>Current line</i>:

        1. If no lines are specified, unchanged.

        2. Otherwise, set to the last line read in, if any lines are
           read in.

        3. Otherwise, set to the line before the first line of the lines
           specified, if that line exists.

        4. Otherwise, set to the first line of the edit buffer if the
           edit buffer is not empty.

        5. Otherwise, set to zero.

       <i>Current column</i>: If no lines are specified, unchanged. Otherwise,
       set to non-&lt;blank&gt;.

   <b>Shift Left</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>&lt;<b>[</b>&lt; ...<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       Shift the specified lines to the start of the line; the number of
       column positions to be shifted shall be the number of command
       characters times the value of the <b>shiftwidth </b>edit option. Only
       leading &lt;blank&gt; characters shall be deleted or changed into other
       &lt;blank&gt; characters in shifting; other characters shall not be
       affected.

       Lines to be shifted shall be copied into the unnamed buffer,
       which shall become a line-mode buffer.

       This command shall be affected by the <b>autoprint </b>edit option.

       <i>Current line</i>: Set to the last line in the lines specified.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Shift Right</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>&gt;<b>[</b>&gt; ...<b>][</b><i>count</i><b>][</b><i>flags</i><b>]</b>

       Shift the specified lines away from the start of the line; the
       number of column positions to be shifted shall be the number of
       command characters times the value of the <b>shiftwidth </b>edit option.
       The shift shall be accomplished by adding &lt;blank&gt; characters as a
       prefix to the line or changing leading &lt;blank&gt; characters into
       other &lt;blank&gt; characters. Empty lines shall not be changed.

       Lines to be shifted shall be copied into the unnamed buffer,
       which shall become a line-mode buffer.

       This command shall be affected by the <b>autoprint </b>edit option.

       <i>Current line</i>: Set to the last line in the lines specified.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>&lt;control&gt;‐D</b>
       <i>Synopsis</i>:

                     &lt;control&gt;-D

       Write the next <i>n</i> lines, where <i>n</i> is the minimum of the values of
       the <b>scroll </b>edit option and the number of lines after the current
       line in the edit buffer. If the current line is the last line of
       the edit buffer it shall be an error.

       <i>Current line</i>: Set to the last line written.

       <i>Current column</i>: Set to non-&lt;blank&gt;.

   <b>Write Line Number</b>
       <i>Synopsis</i>:

                     <b>[</b><i>1addr</i><b>] </b>= <b>[</b><i>flags</i><b>]</b>

       If <i>line</i> is not specified, it shall default to the last line in
       the edit buffer.  Write the line number of the specified line.

       <i>Current line</i>: Unchanged.

       <i>Current column</i>: Unchanged.

   <b>Execute</b>
       <i>Synopsis</i>:

                     <b>[</b><i>2addr</i><b>] </b>@ <i>buffer</i>
                     <b>[</b><i>2addr</i><b>] </b>* <i>buffer</i>

       If no buffer is specified or is specified as <b>'@' </b>or <b>'*'</b>, the last
       buffer executed shall be used. If no previous buffer has been
       executed, it shall be an error.

       For each line specified by the addresses, set the current line
       (<b>'.'</b>)  to the specified line, and execute the contents of the
       named <i>buffer</i> (as they were at the time the <b>@ </b>command was
       executed) as <i>ex</i> commands. For each line of a line-mode buffer,
       and all but the last line of a character-mode buffer, the <i>ex</i>
       command parser shall behave as if the line was terminated by a
       &lt;newline&gt;.

       If an error occurs during this process, or a line specified by
       the addresses does not exist when the current line would be set
       to it, or more than a single line was specified by the addresses,
       and the contents of the edit buffer are replaced (for example, by
       the <i>ex</i> <b>:edit </b>command) an error message shall be written, and no
       more commands resulting from the execution of this command shall
       be processed.

       <i>Current line</i>: As specified for the individual <i>ex</i> commands.

       <i>Current column</i>: As specified for the individual <i>ex</i> commands.

   <b>Regular Expressions in ex</b>
       The <i>ex</i> utility shall support regular expressions that are a
       superset of the basic regular expressions described in the Base
       Definitions volume of POSIX.1‐2017, <i>Section 9.3</i>, <i>Basic Regular</i>
       <i>Expressions</i>.  A null regular expression (<b>"//"</b>) shall be
       equivalent to the last regular expression encountered.

       Regular expressions can be used in addresses to specify lines
       and, in some commands (for example, the <b>substitute </b>command), to
       specify portions of a line to be substituted.

       The following constructs can be used to enhance the basic regular
       expressions:

       \&lt;    Match the beginning of a <i>word</i>.  (See the definition of <i>word</i>
             at the beginning of <i>Command Descriptions in ex</i>.)

       \&gt;    Match the end of a <i>word</i>.

       ~     Match the replacement part of the last <b>substitute </b>command.
             The &lt;tilde&gt; (<b>'~'</b>) character can be escaped in a regular
             expression to become a normal character with no special
             meaning. The &lt;backslash&gt; shall be discarded.

       When the editor option <b>magic </b>is not set, the only characters with
       special meanings shall be <b>'^' </b>at the beginning of a pattern, <b>'$'</b>
       at the end of a pattern, and &lt;backslash&gt;.  The characters <b>'.'</b>,
       <b>'*'</b>, <b>'['</b>, and <b>'~' </b>shall be treated as ordinary characters unless
       preceded by a &lt;backslash&gt;; when preceded by a &lt;backslash&gt; they
       shall regain their special meaning, or in the case of
       &lt;backslash&gt;, be handled as a single &lt;backslash&gt;.  &lt;backslash&gt;
       characters used to escape other characters shall be discarded.

   <b>Replacement Strings in ex</b>
       The character <b>'&amp;' </b>(<b>'\&amp;' </b>if the editor option <b>magic </b>is not set) in
       the replacement string shall stand for the text matched by the
       pattern to be replaced. The character <b>'~' </b>(<b>'\~' </b>if <b>magic </b>is not
       set) shall be replaced by the replacement part of the previous
       <b>substitute </b>command. The sequence <b>'\n'</b>, where <i>n</i> is an integer,
       shall be replaced by the text matched by the corresponding back-
       reference expression. If the corresponding back-reference
       expression does not match, then the characters <b>'\n' </b>shall be
       replaced by the empty string.

       The strings <b>'\l'</b>, <b>'\u'</b>, <b>'\L'</b>, and <b>'\U' </b>can be used to modify the
       case of elements in the replacement string (using the <b>'\&amp;' </b>or
       <b>"\"</b>digit) notation. The string <b>'\l' </b>(<b>'\u'</b>) shall cause the
       character that follows to be converted to lowercase (uppercase).
       The string <b>'\L' </b>(<b>'\U'</b>) shall cause all characters subsequent to
       it to be converted to lowercase (uppercase) as they are inserted
       by the substitution until the string <b>'\e' </b>or <b>'\E'</b>, or the end of
       the replacement string, is encountered.

       Otherwise, any character following a &lt;backslash&gt; shall be treated
       as that literal character, and the escaping &lt;backslash&gt; shall be
       discarded.

       An example of case conversion with the <b>s </b>command is as follows:

           <b>:</b>p
           <b>The cat sat on the mat.</b>
           <b>:</b>s/\&lt;.at\&gt;/\u&amp;/gp
           <b>The Cat Sat on the Mat.</b>
           <b>:</b>s/S\(.*\)M/S\U\1\eM/p
           <b>The Cat SAT ON THE Mat.</b>

   <b>Edit Options in ex</b>
       The <i>ex</i> utility has a number of options that modify its behavior.
       These options have default settings, which can be changed using
       the <b>set </b>command.

       Options are Boolean unless otherwise specified.

   <b>autoindent, ai</b>
       [Default <i>unset</i>]

       If <b>autoindent </b>is set, each line in input mode shall be indented
       (using first as many &lt;tab&gt; characters as possible, as determined
       by the editor option <b>tabstop</b>, and then using &lt;space&gt; characters)
       to align with another line, as follows:

        1. If in open or visual mode and the text input is part of a
           line-oriented command (see the EXTENDED DESCRIPTION in
           <a href="vi.1p.html">vi(1p)</a>), align to the first column.

        2. Otherwise, if in open or visual mode, indentation for each
           line shall be set as follows:

            a. If a line was previously inserted as part of this
               command, it shall be set to the indentation of the last
               inserted line by default, or as otherwise specified for
               the &lt;control&gt;‐D character in <i>Input Mode Commands in vi</i>.

            b. Otherwise, it shall be set to the indentation of the
               previous current line, if any; otherwise, to the first
               column.

        3. For the <i>ex</i> <b>a</b>, <b>i</b>, and <b>c </b>commands, indentation for each line
           shall be set as follows:

            a. If a line was previously inserted as part of this
               command, it shall be set to the indentation of the last
               inserted line by default, or as otherwise specified for
               the <i>eof</i> character in <i>Scroll</i>.

            b. Otherwise, if the command is the <i>ex</i> <b>a </b>command, it shall
               be set to the line appended after, if any; otherwise to
               the first column.

            c. Otherwise, if the command is the <i>ex</i> <b>i </b>command, it shall
               be set to the line inserted before, if any; otherwise to
               the first column.

            d. Otherwise, if the command is the <i>ex</i> <b>c </b>command, it shall
               be set to the indentation of the line replaced.

   <b>autoprint, ap</b>
       [Default <i>set</i>]

       If <b>autoprint </b>is set, the current line shall be written after each
       <i>ex</i> command that modifies the contents of the current edit buffer,
       and after each <b>tag </b>command for which the tag search pattern was
       found or tag line number was valid, unless:

        1. The command was executed while in open or visual mode.

        2. The command was executed as part of a <b>global </b>or <b>v </b>command or
           <b>@ </b>buffer execution.

        3. The command was the form of the <b>read </b>command that reads a
           file into the edit buffer.

        4. The command was the <b>append</b>, <b>change</b>, or <b>insert </b>command.

        5. The command was not terminated by a &lt;newline&gt;.

        6. The current line shall be written by a flag specified to the
           command; for example, <b>delete # </b>shall write the current line
           as specified for the flag modifier to the <b>delete </b>command, and
           not as specified by the <b>autoprint </b>edit option.

   <b>autowrite, aw</b>
       [Default <i>unset</i>]

       If <b>autowrite </b>is set, and the edit buffer has been modified since
       it was last completely written to any file, the contents of the
       edit buffer shall be written as if the <i>ex</i> <b>write </b>command had been
       specified without arguments, before each command affected by the
       <b>autowrite </b>edit option is executed. Appending the character <b>'!'</b>
       to the command name of any of the <i>ex</i> commands except <b>'!'  </b>shall
       prevent the write. If the write fails, it shall be an error and
       the command shall not be executed.

   <b>beautify, bf</b>
       [Default <i>unset</i>]

       If <b>beautify </b>is set, all non-printable characters, other than
       &lt;tab&gt;, &lt;newline&gt;, and &lt;form-feed&gt; characters, shall be discarded
       from text read in from files.

   <b>directory, dir</b>
       [Default <i>implementation-defined</i>]

       The value of this option specifies the directory in which the
       editor buffer is to be placed. If this directory is not writable
       by the user, the editor shall quit.

   <b>edcompatible, ed</b>
       [Default <i>unset</i>]

       Causes the presence of <b>g </b>and <b>c </b>suffixes on substitute commands to
       be remembered, and toggled by repeating the suffixes.

   <b>errorbells, eb</b>
       [Default <i>unset</i>]

       If the editor is in <i>ex</i> mode, and the terminal does not support a
       standout mode (such as inverse video), and <b>errorbells </b>is set,
       error messages shall be preceded by alerting the terminal.

   <b>exrc</b>
       [Default <i>unset</i>]

       If <b>exrc </b>is set, <i>ex</i> shall access any <b>.exrc </b>file in the current
       directory, as described in <i>Initialization in ex and vi</i>.  If <b>exrc</b>
       is not set, <i>ex</i> shall ignore any <b>.exrc </b>file in the current
       directory during initialization, unless the current directory is
       that named by the <i>HOME</i> environment variable.

   <b>ignorecase, ic</b>
       [Default <i>unset</i>]

       If <b>ignorecase </b>is set, characters that have uppercase and
       lowercase representations shall have those representations
       considered as equivalent for purposes of regular expression
       comparison.

       The <b>ignorecase </b>edit option shall affect all remembered regular
       expressions; for example, unsetting the <b>ignorecase </b>edit option
       shall cause a subsequent <i>vi</i> <b>n </b>command to search for the last
       basic regular expression in a case-sensitive fashion.

   <b>list</b>
       [Default <i>unset</i>]

       If <b>list </b>is set, edit buffer lines written while in <i>ex</i> command
       mode shall be written as specified for the <b>print </b>command with the
       <b>l </b>flag specified. In open or visual mode, each edit buffer line
       shall be displayed as specified for the <i>ex</i> <b>print </b>command with the
       <b>l </b>flag specified. In open or visual text input mode, when the
       cursor does not rest on any character in the line, it shall rest
       on the <b>'$' </b>marking the end of the line.

   <b>magic</b>
       [Default <i>set</i>]

       If <b>magic </b>is set, modify the interpretation of characters in
       regular expressions and substitution replacement strings (see
       <i>Regular Expressions in ex</i> and <i>Replacement Strings in ex</i>).

   <b>mesg</b>
       [Default <i>set</i>]

       If <b>mesg </b>is set, the permission for others to use the <b>write </b>or
       <b>talk </b>commands to write to the terminal shall be turned on while
       in open or visual mode. The shell-level command <i>mesg</i> <b>n </b>shall take
       precedence over any setting of the <i>ex</i> <b>mesg </b>option; that is, if
       <b>mesg y </b>was issued before the editor started (or in a shell
       escape), such as:

           :!mesg y

       the <b>mesg </b>option in <i>ex</i> shall suppress incoming messages, but the
       <b>mesg </b>option shall not enable incoming messages if <b>mesg n </b>was
       issued.

   <b>number, nu</b>
       [Default <i>unset</i>]

       If <b>number </b>is set, edit buffer lines written while in <i>ex</i> command
       mode shall be written with line numbers, in the format specified
       by the <b>print </b>command with the <b># </b>flag specified. In <i>ex</i> text input
       mode, each line shall be preceded by the line number it will have
       in the file.

       In open or visual mode, each edit buffer line shall be displayed
       with a preceding line number, in the format specified by the <i>ex</i>
       <b>print </b>command with the <b># </b>flag specified. This line number shall
       not be considered part of the line for the purposes of evaluating
       the current column; that is, column position 1 shall be the first
       column position after the format specified by the <b>print </b>command.

   <b>paragraphs, para</b>
       [Default in the POSIX locale IPLPPPQPP LIpplpipbp]

       The <b>paragraphs </b>edit option shall define additional paragraph
       boundaries for the open and visual mode commands. The <b>paragraphs</b>
       edit option can be set to a character string consisting of zero
       or more character pairs. It shall be an error to set it to an odd
       number of characters.

   <b>prompt</b>
       [Default <i>set</i>]

       If <b>prompt </b>is set, <i>ex</i> command mode input shall be prompted for
       with a &lt;colon&gt; (<b>':'</b>); when unset, no prompt shall be written.

   <b>readonly</b>
       [Default <i>see text</i>]

       If the <b>readonly </b>edit option is set, read-only mode shall be
       enabled (see <i>Write</i>).  The <b>readonly </b>edit option shall be
       initialized to set if either of the following conditions are
       true:

        *  The command-line option -R was specified.

        *  Performing actions equivalent to the <i>access</i>() function called
           with the following arguments indicates that the file lacks
           write permission:

            1. The current pathname is used as the <i>path</i> argument.

            2. The constant <b>W_OK </b>is used as the <i>amode</i> argument.

       The <b>readonly </b>edit option may be initialized to set for other,
       implementation-defined reasons. The <b>readonly </b>edit option shall
       not be initialized to unset based on any special privileges of
       the user or process. The <b>readonly </b>edit option shall be
       reinitialized each time that the contents of the edit buffer are
       replaced (for example, by an <b>edit </b>or <b>next </b>command) unless the
       user has explicitly set it, in which case it shall remain set
       until the user explicitly unsets it. Once unset, it shall again
       be reinitialized each time that the contents of the edit buffer
       are replaced.

   <b>redraw</b>
       [Default <i>unset</i>]

       The editor simulates an intelligent terminal on a dumb terminal.
       (Since this is likely to require a large amount of output to the
       terminal, it is useful only at high transmission speeds.)

   <b>remap</b>
       [Default <i>set</i>]

       If <b>remap </b>is set, map translation shall allow for maps defined in
       terms of other maps; translation shall continue until a final
       product is obtained. If unset, only a one-step translation shall
       be done.

   <b>report</b>
       [Default 5]

       The value of this <b>report </b>edit option specifies what number of
       lines being added, copied, deleted, or modified in the edit
       buffer will cause an informational message to be written to the
       user. The following conditions shall cause an informational
       message. The message shall contain the number of lines added,
       copied, deleted, or modified, but is otherwise unspecified.

        *  An <i>ex</i> or <i>vi</i> editor command, other than <b>open</b>, <b>undo</b>, or <b>visual</b>,
           that modifies at least the value of the <b>report </b>edit option
           number of lines, and which is not part of an <i>ex</i> <b>global </b>or <b>v</b>
           command, or <i>ex</i> or <i>vi</i> buffer execution, shall cause an
           informational message to be written.

        *  An <i>ex</i> <b>yank </b>or <i>vi</i> <b>y </b>or <b>Y </b>command, that copies at least the
           value of the <b>report </b>edit option plus 1 number of lines, and
           which is not part of an <i>ex</i> <b>global </b>or <b>v </b>command, or <i>ex</i> or <i>vi</i>
           buffer execution, shall cause an informational message to be
           written.

        *  An <i>ex</i> <b>global</b>, <b>v</b>, <b>open</b>, <b>undo</b>, or <b>visual </b>command or <i>ex</i> or <i>vi</i>
           buffer execution, that adds or deletes a total of at least
           the value of the <b>report </b>edit option number of lines, and
           which is not part of an <i>ex</i> <b>global </b>or <b>v </b>command, or <i>ex</i> or <i>vi</i>
           buffer execution, shall cause an informational message to be
           written.  (For example, if 3 lines were added and 8 lines
           deleted during an <i>ex</i> <b>visual </b>command, 5 would be the number
           compared against the <b>report </b>edit option after the command
           completed.)

   <b>scroll, scr</b>
       [Default (number of lines in the display -1)/2]

       The value of the <b>scroll </b>edit option shall determine the number of
       lines scrolled by the <i>ex</i> &lt;control&gt;‐D and <b>z </b>commands. For the <i>vi</i>
       &lt;control&gt;‐D and &lt;control&gt;‐U commands, it shall be the initial
       number of lines to scroll when no previous &lt;control&gt;‐D or
       &lt;control&gt;‐U command has been executed.

   <b>sections</b>
       [Default in the POSIX locale NHSHH HUnhsh]

       The <b>sections </b>edit option shall define additional section
       boundaries for the open and visual mode commands. The <b>sections</b>
       edit option can be set to a character string consisting of zero
       or more character pairs; it shall be an error to set it to an odd
       number of characters.

   <b>shell, sh</b>
       [Default from the environment variable <i>SHELL</i>]

       The value of this option shall be a string. The default shall be
       taken from the <i>SHELL</i> environment variable. If the <i>SHELL</i>
       environment variable is null or empty, the <i>sh</i> (see <a href="sh.1p.html">sh(1p)</a>)
       utility shall be the default.

   <b>shiftwidth, sw</b>
       [Default 8]

       The value of this option shall give the width in columns of an
       indentation level used during autoindentation and by the shift
       commands (<b>&lt; </b>and <b>&gt;</b>).

   <b>showmatch, sm</b>
       [Default <i>unset</i>]

       The functionality described for the <b>showmatch </b>edit option need
       not be supported on block-mode terminals or terminals with
       insufficient capabilities.

       If <b>showmatch </b>is set, in open or visual mode, when a <b>')' </b>or <b>'}' </b>is
       typed, if the matching <b>'(' </b>or <b>'{' </b>is currently visible on the
       display, the matching <b>'(' </b>or <b>'{' </b>shall be flagged moving the
       cursor to its location for an unspecified amount of time.

   <b>showmode</b>
       [Default <i>unset</i>]

       If <b>showmode </b>is set, in open or visual mode, the current mode that
       the editor is in shall be displayed on the last line of the
       display. Command mode and text input mode shall be
       differentiated; other unspecified modes and implementation-
       defined information may be displayed.

   <b>slowopen</b>
       [Default <i>unset</i>]

       If <b>slowopen </b>is set during open and visual text input modes, the
       editor shall not update portions of the display other than those
       display line columns that display the characters entered by the
       user (see <i>Input Mode Commands in vi</i>).

   <b>tabstop, ts</b>
       [Default 8]

       The value of this edit option shall specify the column boundary
       used by a &lt;tab&gt; in the display (see <i>autoprint</i>, <i>ap</i> and <i>Input Mode</i>
       <i>Commands in vi</i>).

   <b>taglength, tl</b>
       [Default zero]

       The value of this edit option shall specify the maximum number of
       characters that are considered significant in the user-specified
       tag name and in the tag name from the tags file. If the value is
       zero, all characters in both tag names shall be significant.

   <b>tags</b>
       [Default <i>see text</i>]

       The value of this edit option shall be a string of
       &lt;blank&gt;-delimited pathnames of files used by the <b>tag </b>command. The
       default value is unspecified.

   <b>term</b>
       [Default from the environment variable <i>TERM</i>]

       The value of this edit option shall be a string. The default
       shall be taken from the <i>TERM</i> variable in the environment. If the
       <i>TERM</i> environment variable is empty or null, the default is
       unspecified. The editor shall use the value of this edit option
       to determine the type of the display device.

       The results are unspecified if the user changes the value of the
       term edit option after editor initialization.

   <b>terse</b>
       [Default <i>unset</i>]

       If <b>terse </b>is set, error messages may be less verbose. However,
       except for this caveat, error messages are unspecified.
       Furthermore, not all error messages need change for different
       settings of this option.

   <b>warn</b>
       [Default <i>set</i>]

       If <b>warn </b>is set, and the contents of the edit buffer have been
       modified since they were last completely written, the editor
       shall write a warning message before certain <b>!  </b>commands (see
       <i>Escape</i>).

   <b>window</b>
       [Default <i>see text</i>]

       A value used in open and visual mode, by the &lt;control&gt;‐B and
       &lt;control&gt;‐F commands, and, in visual mode, to specify the number
       of lines displayed when the screen is repainted.

       If the <b>-w </b>command-line option is not specified, the default value
       shall be set to the value of the <i>LINES</i> environment variable. If
       the <i>LINES</i> environment variable is empty or null, the default
       shall be the number of lines in the display minus 1.

       Setting the <b>window </b>edit option to zero or to a value greater than
       the number of lines in the display minus 1 (either explicitly or
       based on the <b>-w </b>option or the <i>LINES</i> environment variable) shall
       cause the <b>window </b>edit option to be set to the number of lines in
       the display minus 1.

       The baud rate of the terminal line may change the default in an
       implementation-defined manner.

   <b>wrapmargin, wm</b>
       [Default 0]

       If the value of this edit option is zero, it shall have no
       effect.

       If not in the POSIX locale, the effect of this edit option is
       implementation-defined.

       Otherwise, it shall specify a number of columns from the ending
       margin of the terminal.

       During open and visual text input modes, for each character for
       which any part of the character is displayed in a column that is
       less than <b>wrapmargin </b>columns from the ending margin of the
       display line, the editor shall behave as follows:

        1. If the character triggering this event is a &lt;blank&gt;, it, and
           all immediately preceding &lt;blank&gt; characters on the current
           line entered during the execution of the current text input
           command, shall be discarded, and the editor shall behave as
           if the user had entered a single &lt;newline&gt; instead. In
           addition, if the next user-entered character is a &lt;space&gt;, it
           shall be discarded as well.

        2. Otherwise, if there are one or more &lt;blank&gt; characters on the
           current line immediately preceding the last group of inserted
           non-&lt;blank&gt; characters which was entered during the execution
           of the current text input command, the &lt;blank&gt; characters
           shall be replaced as if the user had entered a single
           &lt;newline&gt; instead.

       If the <b>autoindent </b>edit option is set, and the events described in
       1. or 2. are performed, any &lt;blank&gt; characters at or after the
       cursor in the current line shall be discarded.

       The ending margin shall be determined by the system or overridden
       by the user, as described for <i>COLUMNS</i> in the ENVIRONMENT
       VARIABLES section and the Base Definitions volume of
       POSIX.1‐2017, <i>Chapter 8</i>, <i>Environment Variables</i>.

   <b>wrapscan, ws</b>
       [Default <i>set</i>]

       If <b>wrapscan </b>is set, searches (the <i>ex</i> <b>/ </b>or <b>?  </b>addresses, or open
       and visual mode <b>/</b>, <b>?</b>, <b>N</b>, and <b>n </b>commands) shall wrap around the
       beginning or end of the edit buffer; when unset, searches shall
       stop at the beginning or end of the edit buffer.

   <b>writeany, wa</b>
       [Default <i>unset</i>]

       If <b>writeany </b>is set, some of the checks performed when executing
       the <i>ex</i> <b>write </b>commands shall be inhibited, as described in editor
       option <b>autowrite</b>.
</pre> <h2>
EXIT STATUS </h2>
<pre>
       The following exit values shall be returned:

        0    Successful completion.

       &gt;0    An error occurred.
</pre> <h2>
CONSEQUENCES OF ERRORS </h2>
<pre>
       When any error is encountered and the standard input is not a
       terminal device file, <i>ex</i> shall not write the file or return to
       command or text input mode, and shall terminate with a non-zero
       exit status.

       Otherwise, when an unrecoverable error is encountered, it shall
       be equivalent to a SIGHUP asynchronous event.

       Otherwise, when an error is encountered, the editor shall behave
       as specified in <i>Command Line Parsing in ex</i>.

       <i>The following sections are informative.</i>
</pre> <h2>
APPLICATION USAGE </h2>
<pre>
       If a SIGSEGV signal is received while <i>ex</i> is saving a file, the
       file might not be successfully saved.

       The <b>next </b>command can accept more than one file, so usage such as:

           next `ls [abc]*`

       is valid; it would not be valid for the <b>edit </b>or <b>read </b>commands,
       for example, because they expect only one file and unspecified
       results occur.
</pre> <h2>
EXAMPLES </h2>
<pre>
       None.
</pre> <h2>
RATIONALE </h2>
<pre>
       The <i>ex</i>/<i>vi</i> specification is based on the historical practice found
       in the 4 BSD and System V implementations of <i>ex</i> and <i>vi</i>.

       A <i>restricted editor</i> (both the historical <i>red</i> utility and
       modifications to <i>ex</i>) were considered and rejected for inclusion.
       Neither option provided the level of security that users might
       expect.

       It is recognized that <i>ex</i> visual mode and related features would
       be difficult, if not impossible, to implement satisfactorily on a
       block-mode terminal, or a terminal without any form of cursor
       addressing; thus, it is not a mandatory requirement that such
       features should work on all terminals. It is the intention,
       however, that an <i>ex</i> implementation should provide the full set of
       capabilities on all terminals capable of supporting them.

   <b>Options</b>
       The <b>-c </b>replacement for <b>+</b><i>command</i> was inspired by the <b>-e </b>option of
       <i>sed</i>.  Historically, all such commands (see <b>edit </b>and <b>next </b>as well)
       were executed from the last line of the edit buffer. This meant,
       for example, that <b>"+/pattern" </b>would fail unless the <b>wrapscan</b>
       option was set. POSIX.1‐2008 requires conformance to historical
       practice. The <b>+</b><i>command</i> option is no longer specified by
       POSIX.1‐2008 but may be present in some implementations.
       Historically, some implementations restricted the <i>ex</i> commands
       that could be listed as part of the command line arguments.  For
       consistency, POSIX.1‐2008 does not permit these restrictions.

       In historical implementations of the editor, the <b>-R </b>option (and
       the <b>readonly </b>edit option) only prevented overwriting of files;
       appending to files was still permitted, mapping loosely into the
       <i>csh</i> <b>noclobber </b>variable. Some implementations, however, have not
       followed this semantic, and <b>readonly </b>does not permit appending
       either. POSIX.1‐2008 follows the latter practice, believing that
       it is a more obvious and intuitive meaning of <b>readonly</b>.

       The <b>-s </b>option suppresses all interactive user feedback and is
       useful for editing scripts in batch jobs. The list of specific
       effects is historical practice. The terminal type ``incapable of
       supporting open and visual modes'' has historically been named
       ``dumb''.

       The <b>-t </b>option was required because the <i>ctags</i> utility appears in
       POSIX.1‐2008 and the option is available in all historical
       implementations of <i>ex</i>.

       Historically, the <i>ex</i> and <i>vi</i> utilities accepted a <b>-x </b>option, which
       did encryption based on the algorithm found in the historical
       <i>crypt</i> utility. The <b>-x </b>option for encryption, and the associated
       <i>crypt</i> utility, were omitted because the algorithm used was not
       specifiable and the export control laws of some nations make it
       difficult to export cryptographic technology. In addition, it did
       not historically provide the level of security that users might
       expect.

   <b>Standard Input</b>
       An end-of-file condition is not equivalent to an end-of-file
       character.  A common end-of-file character, &lt;control&gt;‐D, is
       historically an <i>ex</i> command.

       There was no maximum line length in historical implementations of
       <i>ex</i>.  Specifically, as it was parsed in chunks, the addresses had
       a different maximum length than the filenames. Further, the
       maximum line buffer size was declared as BUFSIZ, which was
       different lengths on different systems. This version selected the
       value of {LINE_MAX} to impose a reasonable restriction on
       portable usage of <i>ex</i> and to aid test suite writers in their
       development of realistic tests that exercise this limit.

   <b>Input Files</b>
       It was an explicit decision by the standard developers that a
       &lt;newline&gt; be added to any file lacking one. It was believed that
       this feature of <i>ex</i> and <i>vi</i> was relied on by users in order to make
       text files lacking a trailing &lt;newline&gt; more portable. It is
       recognized that this will require a user-specified option or
       extension for implementations that permit <i>ex</i> and <i>vi</i> to edit files
       of type other than text if such files are not otherwise
       identified by the system. It was agreed that the ability to edit
       files of arbitrary type can be useful, but it was not considered
       necessary to mandate that an <i>ex</i> or <i>vi</i> implementation be required
       to handle files other than text files.

       The paragraph in the INPUT FILES section, ``By default, ...'', is
       intended to close a long-standing security problem in <i>ex</i> and <i>vi</i>;
       that of the ``modeline'' or ``modelines'' edit option. This
       feature allows any line in the first or last five lines of the
       file containing the strings <b>"ex:" </b>or <b>"vi:" </b>(and, apparently,
       <b>"ei:" </b>or <b>"vx:"</b>) to be a line containing editor commands, and <i>ex</i>
       interprets all the text up to the next <b>':' </b>or &lt;newline&gt; as a
       command. Consider the consequences, for example, of an
       unsuspecting user using <i>ex</i> or <i>vi</i> as the editor when replying to a
       mail message in which a line such as:

           ex:! rm -rf :

       appeared in the signature lines. The standard developers believed
       strongly that an editor should not by default interpret any lines
       of a file. Vendors are strongly urged to delete this feature from
       their implementations of <i>ex</i> and <i>vi</i>.

   <b>Asynchronous Events</b>
       The intention of the phrase ``complete write'' is that the entire
       edit buffer be written to stable storage. The note regarding
       temporary files is intended for implementations that use
       temporary files to back edit buffers unnamed by the user.

       Historically, SIGQUIT was ignored by <i>ex</i>, but was the equivalent
       of the <b>Q </b>command in visual mode; that is, it exited visual mode
       and entered <i>ex</i> mode. POSIX.1‐2008 permits, but does not require,
       this behavior. Historically, SIGINT was often used by <i>vi</i> users to
       terminate text input mode (&lt;control&gt;‐C is often easier to enter
       than &lt;ESC&gt;).  Some implementations of <i>vi</i> alerted the terminal on
       this event, and some did not. POSIX.1‐2008 requires that SIGINT
       behave identically to &lt;ESC&gt;, and that the terminal not be
       alerted.

       Historically, suspending the <i>ex</i> editor during text input mode was
       similar to SIGINT, as completed lines were retained, but any
       partial line discarded, and the editor returned to command mode.
       POSIX.1‐2008 is silent on this issue; implementations are
       encouraged to follow historical practice, where possible.

       Historically, the <i>vi</i> editor did not treat SIGTSTP as an
       asynchronous event, and it was therefore impossible to suspend
       the editor in visual text input mode.  There are two major
       reasons for this. The first is that SIGTSTP is a broadcast signal
       on UNIX systems, and the chain of events where the shell <i>exec</i>s an
       application that then <i>exec</i>s <i>vi</i> usually caused confusion for the
       terminal state if SIGTSTP was delivered to the process group in
       the default manner. The second was that most implementations of
       the UNIX <i>curses</i> package did not handle SIGTSTP safely, and the
       receipt of SIGTSTP at the wrong time would cause them to crash.
       POSIX.1‐2008 is silent on this issue; implementations are
       encouraged to treat suspension as an asynchronous event if
       possible.

       Historically, modifications to the edit buffer made before SIGINT
       interrupted an operation were retained; that is, anywhere from
       zero to all of the lines to be modified might have been modified
       by the time the SIGINT arrived. These changes were not discarded
       by the arrival of SIGINT. POSIX.1‐2008 permits this behavior,
       noting that the <b>undo </b>command is required to be able to undo these
       partially completed commands.

       The action taken for signals other than SIGINT, SIGCONT, SIGHUP,
       and SIGTERM is unspecified because some implementations attempt
       to save the edit buffer in a useful state when other signals are
       received.

   <b>Standard Error</b>
       For <i>ex</i>/<i>vi</i>, diagnostic messages are those messages reported as a
       result of a failed attempt to invoke <i>ex</i> or <i>vi</i>, such as invalid
       options or insufficient resources, or an abnormal termination
       condition. Diagnostic messages should not be confused with the
       error messages generated by inappropriate or illegal user
       commands.

   <b>Initialization in ex and vi</b>
       If an <i>ex</i> command (other than <b>cd</b>, <b>chdir</b>, or <b>source</b>) has a filename
       argument, one or both of the alternate and current pathnames will
       be set. Informally, they are set as follows:

        1. If the <i>ex</i> command is one that replaces the contents of the
           edit buffer, and it succeeds, the current pathname will be
           set to the filename argument (the first filename argument in
           the case of the <b>next </b>command) and the alternate pathname will
           be set to the previous current pathname, if there was one.

        2. In the case of the file read/write forms of the <b>read </b>and
           <b>write </b>commands, if there is no current pathname, the current
           pathname will be set to the filename argument.

        3. Otherwise, the alternate pathname will be set to the filename
           argument.

       For example, <b>:edit foo </b>and <b>:recover foo</b>, when successful, set the
       current pathname, and, if there was a previous current pathname,
       the alternate pathname. The commands <b>:write</b>, <b>!command</b>, and <b>:edit</b>
       set neither the current or alternate pathnames. If the <b>:edit foo</b>
       command were to fail for some reason, the alternate pathname
       would be set. The <b>read </b>and <b>write </b>commands set the alternate
       pathname to their <i>file</i> argument, unless the current pathname is
       not set, in which case they set the current pathname to their
       <i>file</i> arguments. The alternate pathname was not historically set
       by the <b>:source </b>command. POSIX.1‐2008 requires conformance to
       historical practice.  Implementations adding commands that take
       filenames as arguments are encouraged to set the alternate
       pathname as described here.

       Historically, <i>ex</i> and <i>vi</i> read the <b>.exrc </b>file in the <i>$HOME</i>
       directory twice, if the editor was executed in the <i>$HOME</i>
       directory. POSIX.1‐2008 prohibits this behavior.

       Historically, the 4 BSD <i>ex</i> and <i>vi</i> read the <i>$HOME</i> and local <b>.exrc</b>
       files if they were owned by the real ID of the user, or the
       <b>sourceany </b>option was set, regardless of other considerations.
       This was a security problem because it is possible to put normal
       UNIX system commands inside a <b>.exrc </b>file. POSIX.1‐2008 does not
       specify the <b>sourceany </b>option, and historical implementations are
       encouraged to delete it.

       The <b>.exrc </b>files must be owned by the real ID of the user, and not
       writable by anyone other than the owner. The appropriate
       privileges exception is intended to permit users to acquire
       special privileges, but continue to use the <b>.exrc </b>files in their
       home directories.

       System V Release 3.2 and later <i>vi</i> implementations added the
       option <b>[no]exrc</b>.  The behavior is that local <b>.exrc </b>files are
       read-only if the <b>exrc </b>option is set. The default for the <b>exrc</b>
       option was off, so by default, local <b>.exrc </b>files were not read.
       The problem this was intended to solve was that System V
       permitted users to give away files, so there is no possible
       ownership or writeability test to ensure that the file is safe.
       This is still a security problem on systems where users can give
       away files, but there is nothing additional that POSIX.1‐2008 can
       do. The implementation-defined exception is intended to permit
       groups to have local <b>.exrc </b>files that are shared by users, by
       creating pseudo-users to own the shared files.

       POSIX.1‐2008 does not mention system-wide <i>ex</i> and <i>vi</i> start-up
       files. While they exist in several implementations of <i>ex</i> and <i>vi</i>,
       they are not present in any implementations considered historical
       practice by POSIX.1‐2008. Implementations that have such files
       should use them only if they are owned by the real user ID or an
       appropriate user (for example, root on UNIX systems) and if they
       are not writable by any user other than their owner. System-wide
       start-up files should be read before the <i>EXINIT</i> variable,
       <b>$HOME/.exrc</b>, or local <b>.exrc </b>files are evaluated.

       Historically, any <i>ex</i> command could be entered in the <i>EXINIT</i>
       variable or the <b>.exrc </b>file, although ones requiring that the edit
       buffer already contain lines of text generally caused historical
       implementations of the editor to drop <b>core</b>.  POSIX.1‐2008
       requires that any <i>ex</i> command be permitted in the <i>EXINIT</i> variable
       and <b>.exrc </b>files, for simplicity of specification and consistency,
       although many of them will obviously fail under many
       circumstances.

       The initialization of the contents of the edit buffer uses the
       phrase ``the effect shall be'' with regard to various <i>ex</i>
       commands. The intent of this phrase is that edit buffer contents
       loaded during the initialization phase not be lost; that is,
       loading the edit buffer should fail if the <b>.exrc </b>file read in the
       contents of a file and did not subsequently write the edit
       buffer. An additional intent of this phrase is to specify that
       the initial current line and column is set as specified for the
       individual <i>ex</i> commands.

       Historically, the <b>-t </b>option behaved as if the tag search were a
       <b>+</b><i>command</i>; that is, it was executed from the last line of the file
       specified by the tag. This resulted in the search failing if the
       pattern was a forward search pattern and the <b>wrapscan </b>edit option
       was not set. POSIX.1‐2008 does not permit this behavior,
       requiring that the search for the tag pattern be performed on the
       entire file, and, if not found, that the current line be set to a
       more reasonable location in the file.

       Historically, the empty edit buffer presented for editing when a
       file was not specified by the user was unnamed. This is permitted
       by POSIX.1‐2008; however, implementations are encouraged to
       provide users a temporary filename for this buffer because it
       permits them the use of <i>ex</i> commands that use the current pathname
       during temporary edit sessions.

       Historically, the file specified using the <b>-t </b>option was not part
       of the current argument list. This practice is permitted by
       POSIX.1‐2008; however, implementations are encouraged to include
       its name in the current argument list for consistency.

       Historically, the <b>-c </b>command was generally not executed until a
       file that already exists was edited. POSIX.1‐2008 requires
       conformance to this historical practice.  Commands that could
       cause the <b>-c </b>command to be executed include the <i>ex</i> commands <b>edit</b>,
       <b>next</b>, <b>recover</b>, <b>rewind</b>, and <b>tag</b>, and the <i>vi</i> commands &lt;control&gt;‐^
       and &lt;control&gt;‐].  Historically, reading a file into an edit
       buffer did not cause the <b>-c </b>command to be executed (even though
       it might set the current pathname) with the exception that it did
       cause the <b>-c </b>command to be executed if: the editor was in <i>ex</i>
       mode, the edit buffer had no current pathname, the edit buffer
       was empty, and no read commands had yet been attempted. For
       consistency and simplicity of specification, POSIX.1‐2008 does
       not permit this behavior.

       Historically, the <b>-r </b>option was the same as a normal edit session
       if there was no recovery information available for the file. This
       allowed users to enter:

           vi -r *.c

       and recover whatever files were recoverable. In some
       implementations, recovery was attempted only on the first file
       named, and the file was not entered into the argument list; in
       others, recovery was attempted for each file named. In addition,
       some historical implementations ignored <b>-r </b>if <b>-t </b>was specified or
       did not support command line <i>file</i> arguments with the <b>-t </b>option.
       For consistency and simplicity of specification, POSIX.1‐2008
       disallows these special cases, and requires that recovery be
       attempted the first time each file is edited.

       Historically, <i>vi</i> initialized the <b>` </b>and <b>' </b>marks, but <i>ex</i> did not.
       This meant that if the first command in <i>ex</i> mode was <b>visual </b>or if
       an <i>ex</i> command was executed first (for example, <i>vi</i> +10 <i>file</i>), <i>vi</i>
       was entered without the marks being initialized. Because the
       standard developers believed the marks to be generally useful,
       and for consistency and simplicity of specification, POSIX.1‐2008
       requires that they always be initialized if in open or visual
       mode, or if in <i>ex</i> mode and the edit buffer is not empty. Not
       initializing it in <i>ex</i> mode if the edit buffer is empty is
       historical practice; however, it has always been possible to set
       (and use) marks in empty edit buffers in open and visual mode
       edit sessions.

   <b>Addressing</b>
       Historically, <i>ex</i> and <i>vi</i> accepted the additional addressing forms
       <b>'\/' </b>and <b>'\?'</b>.  They were equivalent to <b>"//" </b>and <b>"??"</b>,
       respectively. They are not required by POSIX.1‐2008, mostly
       because nobody can remember whether they ever did anything
       different historically.

       Historically, <i>ex</i> and <i>vi</i> permitted an address of zero for several
       commands, and permitted the <b>% </b>address in empty files for others.
       For consistency, POSIX.1‐2008 requires support for the former in
       the few commands where it makes sense, and disallows it
       otherwise. In addition, because POSIX.1‐2008 requires that <b>% </b>be
       logically equivalent to <b>"1,$"</b>, it is also supported where it
       makes sense and disallowed otherwise.

       Historically, the <b>% </b>address could not be followed by further
       addresses. For consistency and simplicity of specification,
       POSIX.1‐2008 requires that additional addresses be supported.

       All of the following are valid <i>addresses</i>:

       +++       Three lines after the current line.

       /<i>re</i>/-     One line before the next occurrence of <i>re</i>.

       -2        Two lines before the current line.

       3 ---- 2  Line one (note intermediate negative address).

       1 2 3     Line six.

       Any number of addresses can be provided to commands taking
       addresses; for example, <b>"1,2,3,4,5p" </b>prints lines 4 and 5,
       because two is the greatest valid number of addresses accepted by
       the <b>print </b>command. This, in combination with the &lt;semicolon&gt;
       delimiter, permits users to create commands based on ordered
       patterns in the file. For example, the command <b>3;/foo/;+2print</b>
       will display the first line after line 3 that contains the
       pattern <i>foo</i>, plus the next two lines. Note that the address <b>3;</b>
       must be evaluated before being discarded because the search
       origin for the <b>/foo/ </b>command depends on this.

       Historically, values could be added to addresses by including
       them after one or more &lt;blank&gt; characters; for example, <b>3 - 5p</b>
       wrote the seventh line of the file, and <b>/foo/ 5 </b>was the same as
       <b>/foo/+5</b>.  However, only absolute values could be added; for
       example, <b>5 /foo/ </b>was an error. POSIX.1‐2008 requires conformance
       to historical practice.  Address offsets are separately specified
       from addresses because they could historically be provided to
       visual mode search commands.

       Historically, any missing addresses defaulted to the current
       line. This was true for leading and trailing &lt;comma&gt;-delimited
       addresses, and for trailing &lt;semicolon&gt;-delimited addresses. For
       consistency, POSIX.1‐2008 requires it for leading &lt;semicolon&gt;
       addresses as well.

       Historically, <i>ex</i> and <i>vi</i> accepted the <b>'^' </b>character as both an
       address and as a flag offset for commands. In both cases it was
       identical to the <b>'-' </b>character. POSIX.1‐2008 does not require or
       prohibit this behavior.

       Historically, the enhancements to basic regular expressions could
       be used in addressing; for example, <b>'~'</b>, <b>'\&lt;'</b>, and <b>'\&gt;'</b>.
       POSIX.1‐2008 requires conformance to historical practice; that
       is, that regular expression usage be consistent, and that regular
       expression enhancements be supported wherever regular expressions
       are used.

   <b>Command Line Parsing in ex</b>
       Historical <i>ex</i> command parsing was even more complex than that
       described here. POSIX.1‐2008 requires the subset of the command
       parsing that the standard developers believed was documented and
       that users could reasonably be expected to use in a portable
       fashion, and that was historically consistent between
       implementations. (The discarded functionality is obscure, at
       best.)  Historical implementations will require changes in order
       to comply with POSIX.1‐2008; however, users are not expected to
       notice any of these changes.  Most of the complexity in <i>ex</i>
       parsing is to handle three special termination cases:

        1. The <b>!</b>, <b>global</b>, <b>v</b>, and the filter versions of the <b>read </b>and
           <b>write </b>commands are delimited by &lt;newline&gt; characters (they
           can contain &lt;vertical-line&gt; characters that are usually shell
           pipes).

        2. The <b>ex</b>, <b>edit</b>, <b>next</b>, and <b>visual </b>in open and visual mode
           commands all take <i>ex</i> commands, optionally containing
           &lt;vertical-line&gt; characters, as their first arguments.

        3. The <b>s </b>command takes a regular expression as its first
           argument, and uses the delimiting characters to delimit the
           command.

       Historically, &lt;vertical-line&gt; characters in the <b>+</b><i>command</i> argument
       of the <b>ex</b>, <b>edit</b>, <b>next</b>, <b>vi</b>, and <b>visual </b>commands, and in the
       <i>pattern</i> and <i>replacement</i> parts of the <b>s </b>command, did not delimit
       the command, and in the filter cases for <b>read </b>and <b>write</b>, and the
       <b>!</b>, <b>global</b>, and <b>v </b>commands, they did not delimit the command at
       all. For example, the following commands are all valid:

           <b>:</b>edit +25 | s/abc/ABC/ file.c
           <b>:</b>s/ | /PIPE/
           <b>:</b>read !spell % | columnate
           <b>:</b>global/pattern/p | l
           <b>:</b>s/a/b/ | s/c/d | set

       Historically, empty or &lt;blank&gt; filled lines in <b>.exrc </b>files and
       <b>source</b>d files (as well as <i>EXINIT</i> variables and <i>ex</i> command
       scripts) were treated as default commands; that is, <b>print</b>
       commands. POSIX.1‐2008 specifically requires that they be ignored
       when encountered in <b>.exrc </b>and <b>source</b>d files to eliminate a common
       source of new user error.

       Historically, <i>ex</i> commands with multiple adjacent (or
       &lt;blank&gt;-separated) vertical lines were handled oddly when
       executed from <i>ex</i> mode. For example, the command <b>||| </b>&lt;carriage-
       return&gt;, when the cursor was on line 1, displayed lines 2, 3, and
       5 of the file.  In addition, the command <b>| </b>would only display the
       line after the next line, instead of the next two lines. The
       former worked more logically when executed from <i>vi</i> mode, and
       displayed lines 2, 3, and 4. POSIX.1‐2008 requires the <i>vi</i>
       behavior; that is, a single default command and line number
       increment for each command separator, and trailing &lt;newline&gt;
       characters after &lt;vertical-line&gt; separators are discarded.

       Historically, <i>ex</i> permitted a single extra &lt;colon&gt; as a leading
       command character; for example, <b>:g/pattern/:p </b>was a valid
       command. POSIX.1‐2008 generalizes this to require that any number
       of leading &lt;colon&gt; characters be stripped.

       Historically, any prefix of the <b>delete </b>command could be followed
       without intervening &lt;blank&gt; characters by a flag character
       because in the command <b>d p</b>, <i>p</i> is interpreted as the buffer <i>p</i>.
       POSIX.1‐2008 requires conformance to historical practice.

       Historically, the <b>k </b>command could be followed by the mark name
       without intervening &lt;blank&gt; characters. POSIX.1‐2008 requires
       conformance to historical practice.

       Historically, the <b>s </b>command could be immediately followed by flag
       and option characters; for example, <b>s/e/E/|s|sgc3p </b>was a valid
       command. However, flag characters could not stand alone; for
       example, the commands <b>sp </b>and <b>s l </b>would fail, while the command
       <b>sgp </b>and <b>s gl </b>would succeed. (Obviously, the <b>'#' </b>flag character
       was used as a delimiter character if it followed the command.)
       Another issue was that option characters had to precede flag
       characters even when the command was fully specified; for
       example, the command <b>s/e/E/pg </b>would fail, while the command
       <b>s/e/E/gp </b>would succeed. POSIX.1‐2008 requires conformance to
       historical practice.

       Historically, the first command name that had a prefix matching
       the input from the user was the executed command; for example,
       <b>ve</b>, <b>ver</b>, and <b>vers </b>all executed the <b>version </b>command. Commands were
       in a specific order, however, so that <b>a </b>matched <b>append</b>, not
       <b>abbreviate</b>.  POSIX.1‐2008 requires conformance to historical
       practice. The restriction on command search order for
       implementations with extensions is to avoid the addition of
       commands such that the historical prefixes would fail to work
       portably.

       Historical implementations of <i>ex</i> and <i>vi</i> did not correctly handle
       multiple <i>ex</i> commands, separated by &lt;vertical-line&gt; characters,
       that entered or exited visual mode or the editor. Because
       implementations of <i>vi</i> exist that do not exhibit this failure
       mode, POSIX.1‐2008 does not permit it.

       The requirement that alphabetic command names consist of all
       following alphabetic characters up to the next non-alphabetic
       character means that alphabetic command names must be separated
       from their arguments by one or more non-alphabetic characters,
       normally a &lt;blank&gt; or <b>'!'  </b>character, except as specified for the
       exceptions, the <b>delete</b>, <b>k</b>, and <b>s </b>commands.

       Historically, the repeated execution of the <i>ex</i> default <b>print</b>
       commands (&lt;control&gt;‐D, <i>eof</i>, &lt;newline&gt;, &lt;carriage-return&gt;) erased
       any prompting character and displayed the next lines without
       scrolling the terminal; that is, immediately below any previously
       displayed lines. This provided a cleaner presentation of the
       lines in the file for the user. POSIX.1‐2008 does not require
       this behavior because it may be impossible in some situations;
       however, implementations are strongly encouraged to provide this
       semantic if possible.

       Historically, it was possible to change files in the middle of a
       command, and have the rest of the command executed in the new
       file; for example:

           :edit +25 file.c | s/abc/ABC/ | 1

       was a valid command, and the substitution was attempted in the
       newly edited file. POSIX.1‐2008 requires conformance to
       historical practice. The following commands are examples that
       exercise the <i>ex</i> parser:

           echo 'foo | bar' &gt; file1; echo 'foo/bar' &gt; file2;
           vi
           :edit +1 | s/|/PIPE/ | w file1 | e file2 | 1 | s/\//SLASH/ | wq

       Historically, there was no protection in editor implementations
       to avoid <i>ex</i> <b>global</b>, <b>v</b>, <b>@</b>, or <b>* </b>commands changing edit buffers
       during execution of their associated commands. Because this would
       almost invariably result in catastrophic failure of the editor,
       and implementations exist that do exhibit these problems,
       POSIX.1‐2008 requires that changing the edit buffer during a
       <b>global </b>or <b>v </b>command, or during a <b>@ </b>or <b>* </b>command for which there
       will be more than a single execution, be an error.
       Implementations supporting multiple edit buffers simultaneously
       are strongly encouraged to apply the same semantics to switching
       between buffers as well.

       The <i>ex</i> command quoting required by POSIX.1‐2008 is a superset of
       the quoting in historical implementations of the editor. For
       example, it was not historically possible to escape a &lt;blank&gt; in
       a filename; for example, <b>:edit foo\\\ bar </b>would report that too
       many filenames had been entered for the edit command, and there
       was no method of escaping a &lt;blank&gt; in the first argument of an
       <b>edit</b>, <b>ex</b>, <b>next</b>, or <b>visual </b>command at all. POSIX.1‐2008 extends
       historical practice, requiring that quoting behavior be made
       consistent across all <i>ex</i> commands, except for the <b>map</b>, <b>unmap</b>,
       <b>abbreviate</b>, and <b>unabbreviate </b>commands, which historically used
       &lt;control&gt;‐V instead of &lt;backslash&gt; characters for quoting. For
       those four commands, POSIX.1‐2008 requires conformance to
       historical practice.

       Backslash quoting in <i>ex</i> is non-intuitive.  &lt;backslash&gt;-escapes
       are ignored unless they escape a special character; for example,
       when performing <i>file</i> argument expansion, the string <b>"\\%" </b>is
       equivalent to <b>'\%'</b>, not "\&lt;<i>current pathname</i>&gt;".  This can be
       confusing for users because &lt;backslash&gt; is usually one of the
       characters that causes shell expansion to be performed, and
       therefore shell quoting rules must be taken into consideration.
       Generally, quoting characters are only considered if they escape
       a special character, and a quoting character must be provided for
       each layer of parsing for which the character is special. As
       another example, only a single &lt;backslash&gt; is necessary for the
       <b>'\l' </b>sequence in substitute replacement patterns, because the
       character <b>'l' </b>is not special to any parsing layer above it.

       &lt;control&gt;‐V quoting in <i>ex</i> is slightly different from backslash
       quoting. In the four commands where &lt;control&gt;‐V quoting applies
       (<b>abbreviate</b>, <b>unabbreviate</b>, <b>map</b>, and <b>unmap</b>), any character may be
       escaped by a &lt;control&gt;‐V whether it would have a special meaning
       or not. POSIX.1‐2008 requires conformance to historical practice.

       Historical implementations of the editor did not require
       delimiters within character classes to be escaped; for example,
       the command <b>:s/[/]// </b>on the string <b>"xxx/yyy" </b>would delete the <b>'/'</b>
       from the string. POSIX.1‐2008 disallows this historical practice
       for consistency and because it places a large burden on
       implementations by requiring that knowledge of regular
       expressions be built into the editor parser.

       Historically, quoting &lt;newline&gt; characters in <i>ex</i> commands was
       handled inconsistently. In most cases, the &lt;newline&gt; character
       always terminated the command, regardless of any preceding escape
       character, because &lt;backslash&gt; characters did not escape
       &lt;newline&gt; characters for most <i>ex</i> commands. However, some <i>ex</i>
       commands (for example, <b>s</b>, <b>map</b>, and <b>abbreviation</b>) permitted
       &lt;newline&gt; characters to be escaped (although in the case of <b>map</b>
       and <b>abbreviation</b>, &lt;control&gt;‐V characters escaped them instead of
       &lt;backslash&gt; characters). This was true in not only the command
       line, but also <b>.exrc </b>and <b>source</b>d files. For example, the command:

           map = foo&lt;control-V&gt;&lt;newline&gt;bar

       would succeed, although it was sometimes difficult to get the
       &lt;control&gt;‐V and the inserted &lt;newline&gt; passed to the <i>ex</i> parser.
       For consistency and simplicity of specification, POSIX.1‐2008
       requires that it be possible to escape &lt;newline&gt; characters in <i>ex</i>
       commands at all times, using &lt;backslash&gt; characters for most <i>ex</i>
       commands, and using &lt;control&gt;‐V characters for the <b>map </b>and
       <b>abbreviation </b>commands. For example, the command
       <b>print</b>&lt;newline&gt;<b>list </b>is required to be parsed as the single command
       <b>print</b>&lt;newline&gt;<b>list</b>.  While this differs from historical practice,
       POSIX.1‐2008 developers believed it unlikely that any script or
       user depended on the historical behavior.

       Historically, an error in a command specified using the <b>-c </b>option
       did not cause the rest of the <b>-c </b>commands to be discarded.
       POSIX.1‐2008 disallows this for consistency with mapped keys, the
       <b>@</b>, <b>global</b>, <b>source</b>, and <b>v </b>commands, the <i>EXINIT</i> environment
       variable, and the <b>.exrc </b>files.

   <b>Input Editing in ex</b>
       One of the common uses of the historical <i>ex</i> editor is over slow
       network connections. Editors that run in canonical mode can
       require far less traffic to and from, and far less processing on,
       the host machine, as well as more easily supporting block-mode
       terminals. For these reasons, POSIX.1‐2008 requires that <i>ex</i> be
       implemented using canonical mode input processing, as was done
       historically.

       POSIX.1‐2008 does not require the historical 4 BSD input editing
       characters ``word erase'' or ``literal next''. For this reason,
       it is unspecified how they are handled by <i>ex</i>, although they must
       have the required effect. Implementations that resolve them after
       the line has been ended using a &lt;newline&gt; or &lt;control&gt;‐M
       character, and implementations that rely on the underlying system
       terminal support for this processing, are both conforming.
       Implementations are strongly urged to use the underlying system
       functionality, if at all possible, for compatibility with other
       system text input interfaces.

       Historically, when the <i>eof</i> character was used to decrement the
       <b>autoindent </b>level, the cursor moved to display the new end of the
       <b>autoindent </b>characters, but did not move the cursor to a new line,
       nor did it erase the &lt;control&gt;‐D character from the line.
       POSIX.1‐2008 does not specify that the cursor remain on the same
       line or that the rest of the line is erased; however,
       implementations are strongly encouraged to provide the best
       possible user interface; that is, the cursor should remain on the
       same line, and any &lt;control&gt;‐D character on the line should be
       erased.

       POSIX.1‐2008 does not require the historical 4 BSD input editing
       character ``reprint'', traditionally &lt;control&gt;‐R, which
       redisplayed the current input from the user. For this reason, and
       because the functionality cannot be implemented after the line
       has been terminated by the user, POSIX.1‐2008 makes no
       requirements about this functionality. Implementations are
       strongly urged to make this historical functionality available,
       if possible.

       Historically, &lt;control&gt;‐Q did not perform a literal next function
       in <i>ex</i>, as it did in <i>vi</i>.  POSIX.1‐2008 requires conformance to
       historical practice to avoid breaking historical <i>ex</i> scripts and
       <b>.exrc </b>files.

   <b>eof</b>
       Whether the <i>eof</i> character immediately modifies the <b>autoindent</b>
       characters in the prompt is left unspecified so that
       implementations can conform in the presence of systems that do
       not support this functionality. Implementations are encouraged to
       modify the line and redisplay it immediately, if possible.

       The specification of the handling of the <i>eof</i> character differs
       from historical practice only in that <i>eof</i> characters are not
       discarded if they follow normal characters in the text input.
       Historically, they were always discarded.

   <b>Command Descriptions in ex</b>
       Historically, several commands (for example, <b>global</b>, <b>v</b>, <b>visual</b>,
       <b>s</b>, <b>write</b>, <b>wq</b>, <b>yank</b>, <b>!</b>, <b>&lt;</b>, <b>&gt;</b>, <b>&amp;</b>, and <b>~</b>) were executable in empty
       files (that is, the default address(es) were 0), or permitted
       explicit addresses of 0 (for example, 0 was a valid address, or
       0,0 was a valid range). Addresses of 0, or command execution in
       an empty file, make sense only for commands that add new text to
       the edit buffer or write commands (because users may wish to
       write empty files). POSIX.1‐2008 requires this behavior for such
       commands and disallows it otherwise, for consistency and
       simplicity of specification.

       A count to an <i>ex</i> command has been historically corrected to be no
       greater than the last line in a file; for example, in a five-line
       file, the command <b>1,6print </b>would fail, but the command <b>1print300</b>
       would succeed. POSIX.1‐2008 requires conformance to historical
       practice.

       Historically, the use of flags in <i>ex</i> commands could be obscure.
       General historical practice was as described by POSIX.1‐2008, but
       there were some special cases. For instance, the <b>list</b>, <b>number</b>,
       and <b>print </b>commands ignored trailing address offsets; for example,
       <b>3p +++# </b>would display line 3, and 3 would be the current line
       after the execution of the command. The <b>open </b>and <b>visual </b>commands
       ignored both the trailing offsets and the trailing flags.  Also,
       flags specified to the <b>open </b>and <b>visual </b>commands interacted badly
       with the <b>list </b>edit option, and setting and then unsetting it
       during the open/visual session would cause <i>vi</i> to stop displaying
       lines in the specified format. For consistency and simplicity of
       specification, POSIX.1‐2008 does not permit any of these
       exceptions to the general rule.

       POSIX.1‐2008 uses the word <i>copy</i> in several places when discussing
       buffers. This is not intended to imply implementation.

       Historically, <i>ex</i> users could not specify numeric buffers because
       of the ambiguity this would cause; for example, in the command
       <b>3 delete 2</b>, it is unclear whether 2 is a buffer name or a <i>count</i>.
       POSIX.1‐2008 requires conformance to historical practice by
       default, but does not preclude extensions.

       Historically, the contents of the unnamed buffer were frequently
       discarded after commands that did not explicitly affect it; for
       example, when using the <b>edit </b>command to switch files. For
       consistency and simplicity of specification, POSIX.1‐2008 does
       not permit this behavior.

       The <i>ex</i> utility did not historically have access to the numeric
       buffers, and, furthermore, deleting lines in <i>ex</i> did not modify
       their contents. For example, if, after doing a delete in <i>vi</i>, the
       user switched to <i>ex</i>, did another delete, and then switched back
       to <i>vi</i>, the contents of the numeric buffers would not have
       changed. POSIX.1‐2008 requires conformance to historical
       practice. Numeric buffers are described in the <i>ex</i> utility in
       order to confine the description of buffers to a single location
       in POSIX.1‐2008.

       The metacharacters that trigger shell expansion in <i>file</i> arguments
       match historical practice, as does the method for doing shell
       expansion. Implementations wishing to provide users with the
       flexibility to alter the set of metacharacters are encouraged to
       provide a <b>shellmeta </b>string edit option.

       Historically, <i>ex</i> commands executed from <i>vi</i> refreshed the screen
       when it did not strictly need to do so; for example,
       <b>:!date &gt; /dev/null </b>does not require a screen refresh because the
       output of the UNIX <i>date</i> command requires only a single line of
       the screen. POSIX.1‐2008 requires that the screen be refreshed if
       it has been overwritten, but makes no requirements as to how an
       implementation should make that determination. Implementations
       may prompt and refresh the screen regardless.

   <b>Abbreviate</b>
       Historical practice was that characters that were entered as part
       of an abbreviation replacement were subject to <b>map </b>expansions,
       the <b>showmatch </b>edit option, further abbreviation expansions, and
       so on; that is, they were logically pushed onto the terminal
       input queue, and were not a simple replacement. POSIX.1‐2008
       requires conformance to historical practice.  Historical practice
       was that whenever a non-word character (that had not been escaped
       by a &lt;control&gt;‐V) was entered after a word character, <i>vi</i> would
       check for abbreviations. The check was based on the type of the
       character entered before the word character of the word/non-word
       pair that triggered the check. The word character of the
       word/non-word pair that triggered the check and all characters
       entered before the trigger pair that were of that type were
       included in the check, with the exception of &lt;blank&gt; characters,
       which always delimited the abbreviation.

       This means that, for the abbreviation to work, the <i>lhs</i> must end
       with a word character, there can be no transitions from word to
       non-word characters (or <i>vice versa</i>) other than between the last
       and next-to-last characters in the <i>lhs</i>, and there can be no
       &lt;blank&gt; characters in the <i>lhs</i>.  In addition, because of the
       historical quoting rules, it was impossible to enter a literal
       &lt;control&gt;‐V in the <i>lhs</i>.  POSIX.1‐2008 requires conformance to
       historical practice. Historical implementations did not inform
       users when abbreviations that could never be used were entered;
       implementations are strongly encouraged to do so.

       For example, the following abbreviations will work:

           :ab (p  REPLACE
           :ab p   REPLACE
           :ab ((p REPLACE

       The following abbreviations will not work:

           :ab (   REPLACE
           :ab (pp REPLACE

       Historical practice is that words on the <i>vi</i> colon command line
       were subject to abbreviation expansion, including the arguments
       to the <b>abbrev </b>(and more interestingly) the <b>unabbrev </b>command.
       Because there are implementations that do not do abbreviation
       expansion for the first argument to those commands, this is
       permitted, but not required, by POSIX.1‐2008. However, the
       following sequence:

           :ab foo bar
           :ab foo baz

       resulted in the addition of an abbreviation of <b>"baz" </b>for the
       string <b>"bar" </b>in historical <i>ex</i>/<i>vi</i>, and the sequence:

           :ab foo1 bar
           :ab foo2 bar
           :unabbreviate foo2

       deleted the abbreviation <b>"foo1"</b>, not <b>"foo2"</b>.  These behaviors are
       not permitted by POSIX.1‐2008 because they clearly violate the
       expectations of the user.

       It was historical practice that &lt;control&gt;‐V, not &lt;backslash&gt;,
       characters be interpreted as escaping subsequent characters in
       the <b>abbreviate </b>command. POSIX.1‐2008 requires conformance to
       historical practice; however, it should be noted that an
       abbreviation containing a &lt;blank&gt; will never work.

   <b>Append</b>
       Historically, any text following a &lt;vertical-line&gt; command
       separator after an <b>append</b>, <b>change</b>, or <b>insert </b>command became part
       of the insert text. For example, in the command:

           :g/pattern/append|stuff1

       a line containing the text <b>"stuff1" </b>would be appended to each
       line matching pattern. It was also historically valid to enter:

           :append|stuff1
           stuff2
           .

       and the text on the <i>ex</i> command line would be appended along with
       the text inserted after it.  There was an historical bug,
       however, that the user had to enter two terminating lines (the
       <b>'.'  </b>lines) to terminate text input mode in this case.
       POSIX.1‐2008 requires conformance to historical practice, but
       disallows the historical need for multiple terminating lines.

   <b>Change</b>
       See the RATIONALE for the <b>append </b>command. Historical practice for
       cursor positioning after the change command when no text is
       input, is as described in POSIX.1‐2008. However, one System V
       implementation is known to have been modified such that the
       cursor is positioned on the first address specified, and not on
       the line before the first address. POSIX.1‐2008 disallows this
       modification for consistency.

       Historically, the <b>change </b>command did not support buffer
       arguments, although some implementations allow the specification
       of an optional buffer. This behavior is neither required nor
       disallowed by POSIX.1‐2008.

   <b>Change Directory</b>
       A common extension in <i>ex</i> implementations is to use the elements
       of a <b>cdpath </b>edit option as prefix directories for <i>path</i> arguments
       to <b>chdir </b>that are relative pathnames and that do not have <b>'.'  </b>or
       <b>".." </b>as their first component. Elements in the <b>cdpath </b>edit option
       are &lt;colon&gt;-separated.  The initial value of the <b>cdpath </b>edit
       option is the value of the shell <i>CDPATH</i> environment variable.
       This feature was not included in POSIX.1‐2008 because it does not
       exist in any of the implementations considered historical
       practice.

   <b>Copy</b>
       Historical implementations of <i>ex</i> permitted copies to lines inside
       of the specified range; for example, <b>:2,5copy3 </b>was a valid
       command. POSIX.1‐2008 requires conformance to historical
       practice.

   <b>Delete</b>
       POSIX.1‐2008 requires support for the historical parsing of a
       <b>delete </b>command followed by flags, without any intervening &lt;blank&gt;
       characters. For example:

       <b>1dp     </b>Deletes the first line and prints the line that was
               second.

       <b>1delep  </b>As for <b>1dp</b>.

       <b>1d      </b>Deletes the first line, saving it in buffer <i>p</i>.

       <b>1d p1l  </b>(Pee-one-ell.) Deletes the first line, saving it in
               buffer <i>p</i>, and listing the line that was second.

   <b>Edit</b>
       Historically, any <i>ex</i> command could be entered as a <b>+</b><i>command</i>
       argument to the <b>edit </b>command, although some (for example, <b>insert</b>
       and <b>append</b>) were known to confuse historical implementations. For
       consistency and simplicity of specification, POSIX.1‐2008
       requires that any command be supported as an argument to the <b>edit</b>
       command.

       Historically, the command argument was executed with the current
       line set to the last line of the file, regardless of whether the
       <b>edit </b>command was executed from visual mode or not. POSIX.1‐2008
       requires conformance to historical practice.

       Historically, the <b>+</b><i>command</i> specified to the <b>edit </b>and <b>next</b>
       commands was delimited by the first &lt;blank&gt;, and there was no way
       to quote them. For consistency, POSIX.1‐2008 requires that the
       usual <i>ex</i> backslash quoting be provided.

       Historically, specifying the <b>+</b><i>command</i> argument to the edit
       command required a filename to be specified as well; for example,
       <b>:edit +100 </b>would always fail. For consistency and simplicity of
       specification, POSIX.1‐2008 does not permit this usage to fail
       for that reason.

       Historically, only the cursor position of the last file edited
       was remembered by the editor. POSIX.1‐2008 requires that this be
       supported; however, implementations are permitted to remember and
       restore the cursor position for any file previously edited.

   <b>File</b>
       Historical versions of the <i>ex</i> editor <b>file </b>command displayed a
       current line and number of lines in the edit buffer of 0 when the
       file was empty, while the <i>vi</i> &lt;control&gt;‐G command displayed a
       current line and number of lines in the edit buffer of 1 in the
       same situation. POSIX.1‐2008 does not permit this discrepancy,
       instead requiring that a message be displayed indicating that the
       file is empty.

   <b>Global</b>
       The two-pass operation of the <b>global </b>and <b>v </b>commands is not
       intended to imply implementation, only the required result of the
       operation.

       The current line and column are set as specified for the
       individual <i>ex</i> commands. This requirement is cumulative; that is,
       the current line and column must track across all the commands
       executed by the <b>global </b>or <b>v </b>commands.

   <b>Insert</b>
       See the RATIONALE for the <b>append </b>command.

       Historically, <b>insert </b>could not be used with an address of zero;
       that is, not when the edit buffer was empty. POSIX.1‐2008
       requires that this command behave consistently with the <b>append</b>
       command.

   <b>Join</b>
       The action of the <b>join </b>command in relation to the special
       characters is only defined for the POSIX locale because the
       correct amount of white space after a period varies; in Japanese
       none is required, in French only a single space, and so on.

   <b>List</b>
       The historical output of the <b>list </b>command was potentially
       ambiguous. The standard developers believed correcting this to be
       more important than adhering to historical practice, and
       POSIX.1‐2008 requires unambiguous output.

   <b>Map</b>
       Historically, command mode maps only applied to command names;
       for example, if the character <b>'x' </b>was mapped to <b>'y'</b>, the command
       <b>fx </b>searched for the <b>'x' </b>character, not the <b>'y' </b>character.
       POSIX.1‐2008 requires this behavior. Historically, entering
       &lt;control&gt;‐V as the first character of a <i>vi</i> command was an error.
       Several implementations have extended the semantics of <i>vi</i> such
       that &lt;control&gt;‐V means that the subsequent command character is
       not mapped. This is permitted, but not required, by POSIX.1‐2008.
       Regardless, using &lt;control&gt;‐V to escape the second or later
       character in a sequence of characters that might match a <b>map</b>
       command, or any character in text input mode, is historical
       practice, and stops the entered keys from matching a map.
       POSIX.1‐2008 requires conformance to historical practice.

       Historical implementations permitted digits to be used as a <b>map</b>
       command <i>lhs</i>, but then ignored the map. POSIX.1‐2008 requires that
       the mapped digits not be ignored.

       The historical implementation of the <b>map </b>command did not permit
       <b>map </b>commands that were more than a single character in length if
       the first character was printable. This behavior is permitted,
       but not required, by POSIX.1‐2008.

       Historically, mapped characters were remapped unless the <b>remap</b>
       edit option was not set, or the prefix of the mapped characters
       matched the mapping characters; for example, in the <b>map</b>:

           :map ab abcd

       the characters <b>"ab" </b>were used as is and were not remapped, but
       the characters <b>"cd" </b>were mapped if appropriate. This can cause
       infinite loops in the <i>vi</i> mapping mechanisms. POSIX.1‐2008
       requires conformance to historical practice, and that such loops
       be interruptible.

       Text input maps had the same problems with expanding the <i>lhs</i> for
       the <i>ex</i> <b>map!  </b>and <b>unmap!  </b>command as did the <i>ex</i> <b>abbreviate </b>and
       <b>unabbreviate </b>commands. See the RATIONALE for the <i>ex</i> <b>abbreviate</b>
       command. POSIX.1‐2008 requires similar modification of some
       historical practice for the <b>map </b>and <b>unmap </b>commands, as described
       for the <b>abbreviate </b>and <b>unabbreviate </b>commands.

       Historically, <b>map</b>s that were subsets of other <b>map</b>s behaved
       differently depending on the order in which they were defined.
       For example:

           :map! ab     short
           :map! abc    long

       would always translate the characters <b>"ab" </b>to <b>"short"</b>, regardless
       of how fast the characters <b>"abc" </b>were entered. If the entry order
       was reversed:

           :map! abc    long
           :map! ab     short

       the characters <b>"ab" </b>would cause the editor to pause, waiting for
       the completing <b>'c' </b>character, and the characters might never be
       mapped to <b>"short"</b>.  For consistency and simplicity of
       specification, POSIX.1‐2008 requires that the shortest match be
       used at all times.

       The length of time the editor spends waiting for the characters
       to complete the <i>lhs</i> is unspecified because the timing
       capabilities of systems are often inexact and variable, and it
       may depend on other factors such as the speed of the connection.
       The time should be long enough for the user to be able to
       complete the sequence, but not long enough for the user to have
       to wait. Some implementations of <i>vi</i> have added a <b>keytime </b>option,
       which permits users to set the number of 0,1 seconds the editor
       waits for the completing characters. Because mapped terminal
       function and cursor keys tend to start with an &lt;ESC&gt; character,
       and &lt;ESC&gt; is the key ending <i>vi</i> text input mode, <b>map</b>s starting
       with &lt;ESC&gt; characters are generally exempted from this timeout
       period, or, at least timed out differently.

   <b>Mark</b>
       Historically, users were able to set the ``previous context''
       marks explicitly. In addition, the <i>ex</i> commands <b>'' </b>and <b>'` </b>and the
       <i>vi</i> commands <b>''</b>, <b>``</b>, <b>`'</b>, and <b>'` </b>all referred to the same mark. In
       addition, the previous context marks were not set if the command,
       with which the address setting the mark was associated, failed.
       POSIX.1‐2008 requires conformance to historical practice.
       Historically, if marked lines were deleted, the mark was also
       deleted, but would reappear if the change was undone.
       POSIX.1‐2008 requires conformance to historical practice.

       The description of the special events that set the <b>` </b>and <b>' </b>marks
       matches historical practice. For example, historically the
       command <b>/a/,/b/ </b>did not set the <b>` </b>and <b>' </b>marks, but the command
       <b>/a/,/b/delete </b>did.

   <b>Next</b>
       Historically, any <i>ex</i> command could be entered as a <b>+</b><i>command</i>
       argument to the <b>next </b>command, although some (for example, <b>insert</b>
       and <b>append</b>) were known to confuse historical implementations.
       POSIX.1‐2008 requires that any command be permitted and that it
       behave as specified. The <b>next </b>command can accept more than one
       file, so usage such as:

           next `ls [abc] `

       is valid; it need not be valid for the <b>edit </b>or <b>read </b>commands, for
       example, because they expect only one filename.

       Historically, the <b>next </b>command behaved differently from the
       <b>:rewind </b>command in that it ignored the force flag if the
       <b>autowrite </b>flag was set. For consistency, POSIX.1‐2008 does not
       permit this behavior.

       Historically, the <b>next </b>command positioned the cursor as if the
       file had never been edited before, regardless. POSIX.1‐2008 does
       not permit this behavior, for consistency with the <b>edit </b>command.

       Implementations wanting to provide a counterpart to the <b>next</b>
       command that edited the previous file have used the command
       <b>prev[ious], </b>which takes no <i>file</i> argument. POSIX.1‐2008 does not
       require this command.

   <b>Open</b>
       Historically, the <b>open </b>command would fail if the <b>open </b>edit option
       was not set. POSIX.1‐2008 does not mention the <b>open </b>edit option
       and does not require this behavior. Some historical
       implementations do not permit entering open mode from open or
       visual mode, only from <i>ex</i> mode. For consistency, POSIX.1‐2008
       does not permit this behavior.

       Historically, entering open mode from the command line (that is,
       <i>vi</i> <b>+open</b>) resulted in anomalous behaviors; for example, the <i>ex</i>
       file and <i>set</i> commands, and the <i>vi</i> command &lt;control&gt;‐G did not
       work. For consistency, POSIX.1‐2008 does not permit this
       behavior.

       Historically, the <b>open </b>command only permitted <b>'/' </b>characters to
       be used as the search pattern delimiter. For consistency,
       POSIX.1‐2008 requires that the search delimiters used by the <b>s</b>,
       <b>global</b>, and <b>v </b>commands be accepted as well.

   <b>Preserve</b>
       The <b>preserve </b>command does not historically cause the file to be
       considered unmodified for the purposes of future commands that
       may exit the editor. POSIX.1‐2008 requires conformance to
       historical practice.

       Historical documentation stated that mail was not sent to the
       user when preserve was executed; however, historical
       implementations did send mail in this case. POSIX.1‐2008 requires
       conformance to the historical implementations.

   <b>Print</b>
       The writing of NUL by the <b>print </b>command is not specified as a
       special case because the standard developers did not want to
       require <i>ex</i> to support NUL characters. Historically, characters
       were displayed using the ARPA standard mappings, which are as
       follows:

        1. Printable characters are left alone.

        2. Control characters less than \177 are represented as <b>'^'</b>
           followed by the character offset from the <b>'@' </b>character in
           the ASCII map; for example, \007 is represented as <b>'^G'</b>.

        3. \177 is represented as <b>'^' </b>followed by <b>'?'</b>.

       The display of characters having their eighth bit set was less
       standard. Existing implementations use hex (0x00), octal (\000),
       and a meta-bit display. (The latter displayed bytes that had
       their eighth bit set as the two characters <b>"M-" </b>followed by the
       seven-bit display as described above.) The latter probably has
       the best claim to historical practice because it was used for the
       <b>-v </b>option of 4 BSD and 4 BSD-derived versions of the <i>cat</i> utility
       since 1980.

       No specific display format is required by POSIX.1‐2008.

       Explicit dependence on the ASCII character set has been avoided
       where possible, hence the use of the phrase an ``implementation-
       defined multi-character sequence'' for the display of non-
       printable characters in preference to the historical usage of,
       for instance, <b>"^I" </b>for the &lt;tab&gt;.  Implementations are encouraged
       to conform to historical practice in the absence of any strong
       reason to diverge.

       Historically, all <i>ex</i> commands beginning with the letter <b>'p' </b>could
       be entered using capitalized versions of the commands; for
       example, <b>P[rint]</b>, <b>Pre[serve]</b>, and <b>Pu[t] </b>were all valid command
       names. POSIX.1‐2008 permits, but does not require, this
       historical practice because capital forms of the commands are
       used by some implementations for other purposes.

   <b>Put</b>
       Historically, an <i>ex</i> <b>put </b>command, executed from open or visual
       mode, was the same as the open or visual mode <b>P </b>command, if the
       buffer was named and was cut in character mode, and the same as
       the <b>p </b>command if the buffer was named and cut in line mode. If
       the unnamed buffer was the source of the text, the entire line
       from which the text was taken was usually <b>put</b>, and the buffer was
       handled as if in line mode, but it was possible to get extremely
       anomalous behavior. In addition, using the <b>Q </b>command to switch
       into <i>ex</i> mode, and then doing a <b>put </b>often resulted in errors as
       well, such as appending text that was unrelated to the (supposed)
       contents of the buffer. For consistency and simplicity of
       specification, POSIX.1‐2008 does not permit these behaviors. All
       <i>ex</i> <b>put </b>commands are required to operate in line mode, and the
       contents of the buffers are not altered by changing the mode of
       the editor.

   <b>Read</b>
       Historically, an <i>ex</i> <b>read </b>command executed from open or visual
       mode, executed in an empty file, left an empty line as the first
       line of the file. For consistency and simplicity of
       specification, POSIX.1‐2008 does not permit this behavior.
       Historically, a <b>read </b>in open or visual mode from a program left
       the cursor at the last line read in, not the first. For
       consistency, POSIX.1‐2008 does not permit this behavior.

       Historical implementations of <i>ex</i> were unable to undo <b>read</b>
       commands that read from the output of a program. For consistency,
       POSIX.1‐2008 does not permit this behavior.

       Historically, the <i>ex</i> and <i>vi</i> message after a successful <b>read </b>or
       <b>write </b>command specified ``characters'', not ``bytes''.
       POSIX.1‐2008 requires that the number of bytes be displayed, not
       the number of characters, because it may be difficult in multi-
       byte implementations to determine the number of characters read.
       Implementations are encouraged to clarify the message displayed
       to the user.

       Historically, reads were not permitted on files other than type
       regular, except that FIFO files could be read (probably only
       because they did not exist when <i>ex</i> and <i>vi</i> were originally
       written). Because the historical <i>ex</i> evaluated <b>read!  </b>and <b>read !</b>
       equivalently, there can be no optional way to force the read.
       POSIX.1‐2008 permits, but does not require, this behavior.

   <b>Recover</b>
       Some historical implementations of the editor permitted users to
       recover the edit buffer contents from a previous edit session,
       and then exit without saving those contents (or explicitly
       discarding them). The intent of POSIX.1‐2008 in requiring that
       the edit buffer be treated as already modified is to prevent this
       user error.

   <b>Rewind</b>
       Historical implementations supported the <b>rewind </b>command when the
       user was editing the first file in the list; that is, the file
       that the <b>rewind </b>command would edit. POSIX.1‐2008 requires
       conformance to historical practice.

   <b>Substitute</b>
       Historically, <i>ex</i> accepted an <b>r </b>option to the <b>s </b>command. The
       effect of the <b>r </b>option was to use the last regular expression
       used in any command as the pattern, the same as the <b>~ </b>command.
       The <b>r </b>option is not required by POSIX.1‐2008. Historically, the <b>c</b>
       and <b>g </b>options were toggled; for example, the command <b>:s/abc/def/</b>
       was the same as <b>s/abc/def/ccccgggg</b>.  For simplicity of
       specification, POSIX.1‐2008 does not permit this behavior.

       The tilde command is often used to replace the last search RE.
       For example, in the sequence:

           s/red/blue/
           /green
           ~

       the <b>~ </b>command is equivalent to:

           s/green/blue/

       Historically, <i>ex</i> accepted all of the following forms:

           s/abc/def/
           s/abc/def
           s/abc/
           s/abc

       POSIX.1‐2008 requires conformance to this historical practice.

       The <b>s </b>command presumes that the <b>'^' </b>character only occupies a
       single column in the display. Much of the <i>ex</i> and <i>vi</i> specification
       presumes that the &lt;space&gt; only occupies a single column in the
       display. There are no known character sets for which this is not
       true.

       Historically, the final column position for the substitute
       commands was based on previous column movements; a search for a
       pattern followed by a substitution would leave the column
       position unchanged, while a 0 command followed by a substitution
       would change the column position to the first non-&lt;blank&gt;.  For
       consistency and simplicity of specification, POSIX.1‐2008
       requires that the final column position always be set to the
       first non-&lt;blank&gt;.

   <b>Set</b>
       Historical implementations redisplayed all of the options for
       each occurrence of the <b>all </b>keyword. POSIX.1‐2008 permits, but
       does not require, this behavior.

   <b>Tag</b>
       No requirement is made as to where <i>ex</i> and <i>vi</i> shall look for the
       file referenced by the tag entry. Historical practice has been to
       look for the path found in the <b>tags </b>file, based on the current
       directory. A useful extension found in some implementations is to
       look based on the directory containing the tags file that held
       the entry, as well. No requirement is made as to which reference
       for the tag in the tags file is used. This is deliberate, in
       order to permit extensions such as multiple entries in a tags
       file for a tag.

       Because users often specify many different tags files, some of
       which need not be relevant or exist at any particular time,
       POSIX.1‐2008 requires that error messages about problem tags
       files be displayed only if the requested tag is not found, and
       then, only once for each time that the <b>tag </b>edit option is
       changed.

       The requirement that the current edit buffer be unmodified is
       only necessary if the file indicated by the tag entry is not the
       same as the current file (as defined by the current pathname).
       Historically, the file would be reloaded if the filename had
       changed, as well as if the filename was different from the
       current pathname. For consistency and simplicity of
       specification, POSIX.1‐2008 does not permit this behavior,
       requiring that the name be the only factor in the decision.

       Historically, <i>vi</i> only searched for tags in the current file from
       the current cursor to the end of the file, and therefore, if the
       <b>wrapscan </b>option was not set, tags occurring before the current
       cursor were not found. POSIX.1‐2008 considers this a bug, and
       implementations are required to search for the first occurrence
       in the file, regardless.

   <b>Undo</b>
       The <b>undo </b>description deliberately uses the word ``modified''. The
       <b>undo </b>command is not intended to undo commands that replace the
       contents of the edit buffer, such as <b>edit</b>, <b>next</b>, <b>tag</b>, or <b>recover</b>.

       Cursor positioning after the <b>undo </b>command was inconsistent in the
       historical <i>vi</i>, sometimes attempting to restore the original
       cursor position (<b>global</b>, <b>undo</b>, and <b>v </b>commands), and sometimes, in
       the presence of maps, placing the cursor on the last line added
       or changed instead of the first. POSIX.1‐2008 requires a
       simplified behavior for consistency and simplicity of
       specification.

   <b>Version</b>
       The <b>version </b>command cannot be exactly specified since there is no
       widely-accepted definition of what the version information should
       contain.  Implementations are encouraged to do something
       reasonably intelligent.

   <b>Write</b>
       Historically, the <i>ex</i> and <i>vi</i> message after a successful <b>read </b>or
       <b>write </b>command specified ``characters'', not ``bytes''.
       POSIX.1‐2008 requires that the number of bytes be displayed, not
       the number of characters because it may be difficult in multi-
       byte implementations to determine the number of characters
       written. Implementations are encouraged to clarify the message
       displayed to the user.

       Implementation-defined tests are permitted so that
       implementations can make additional checks; for example, for
       locks or file modification times.

       Historically, attempting to append to a nonexistent file caused
       an error. It has been left unspecified in POSIX.1‐2008 to permit
       implementations to let the <b>write </b>succeed, so that the append
       semantics are similar to those of the historical <i>csh</i>.

       Historical <i>vi</i> permitted empty edit buffers to be written.
       However, since the way <i>vi</i> got around dealing with ``empty'' files
       was to always have a line in the edit buffer, no matter what, it
       wrote them as files of a single, empty line. POSIX.1‐2008 does
       not permit this behavior.

       Historically, <i>ex</i> restored standard output and standard error to
       their values as of when <i>ex</i> was invoked, before writes to programs
       were performed. This could disturb the terminal configuration as
       well as be a security issue for some terminals. POSIX.1‐2008 does
       not permit this, requiring that the program output be captured
       and displayed as if by the <i>ex</i> <b>print </b>command.

   <b>Adjust Window</b>
       Historically, the line count was set to the value of the <b>scroll</b>
       option if the type character was end-of-file. This feature was
       broken on most historical implementations long ago, however, and
       is not documented anywhere. For this reason, POSIX.1‐2008 is
       resolutely silent.

       Historically, the <b>z </b>command was &lt;blank&gt;-sensitive and <b>z + </b>and <b>z -</b>
       did different things than <b>z+ </b>and <b>z- </b>because the type could not be
       distinguished from a flag. (The commands <b>z .  </b>and <b>z = </b>were
       historically invalid.) POSIX.1‐2008 requires conformance to this
       historical practice.

       Historically, the <b>z </b>command was further &lt;blank&gt;-sensitive in that
       the <i>count</i> could not be &lt;blank&gt;-delimited; for example, the
       commands <b>z= 5 </b>and <b>z- 5 </b>were also invalid. Because the <i>count</i> is
       not ambiguous with respect to either the type character or the
       flags, this is not permitted by POSIX.1‐2008.

   <b>Escape</b>
       Historically, <i>ex</i> filter commands only read the standard output of
       the commands, letting standard error appear on the terminal as
       usual. The <i>vi</i> utility, however, read both standard output and
       standard error. POSIX.1‐2008 requires the latter behavior for
       both <i>ex</i> and <i>vi</i>, for consistency.

   <b>Shift Left and Shift Right</b>
       Historically, it was possible to add shift characters to increase
       the effect of the command; for example, <b>&lt;&lt;&lt; </b>outdented (or <b>&gt;&gt;&gt;</b>
       indented) the lines 3 levels of indentation instead of the
       default 1.  POSIX.1‐2008 requires conformance to historical
       practice.

   <b>&lt;control&gt;‐D</b>
       Historically, the &lt;control&gt;‐D command erased the prompt,
       providing the user with an unbroken presentation of lines from
       the edit buffer. This is not required by POSIX.1‐2008;
       implementations are encouraged to provide it if possible.
       Historically, the &lt;control&gt;‐D command took, and then ignored, a
       <i>count</i>.  POSIX.1‐2008 does not permit this behavior.

   <b>Write Line Number</b>
       Historically, the <i>ex</i> <b>= </b>command, when executed in <i>ex</i> mode in an
       empty edit buffer, reported 0, and from open or visual mode,
       reported 1. For consistency and simplicity of specification,
       POSIX.1‐2008 does not permit this behavior.

   <b>Execute</b>
       Historically, <i>ex</i> did not correctly handle the inclusion of text
       input commands (that is, <b>append</b>, <b>insert</b>, and <b>change</b>) in executed
       buffers. POSIX.1‐2008 does not permit this exclusion for
       consistency.

       Historically, the logical contents of the buffer being executed
       did not change if the buffer itself were modified by the commands
       being executed; that is, buffer execution did not support self-
       modifying code. POSIX.1‐2008 requires conformance to historical
       practice.

       Historically, the <b>@ </b>command took a range of lines, and the <b>@</b>
       buffer was executed once per line, with the current line (<b>'.'</b>)
       set to each specified line. POSIX.1‐2008 requires conformance to
       historical practice.

       Some historical implementations did not notice if errors occurred
       during buffer execution. This, coupled with the ability to
       specify a range of lines for the <i>ex</i> <b>@ </b>command, makes it trivial
       to cause them to drop <b>core</b>.  POSIX.1‐2008 requires that
       implementations stop buffer execution if any error occurs, if the
       specified line doesn't exist, or if the contents of the edit
       buffer itself are replaced (for example, the buffer executes the
       <i>ex</i> <b>:edit </b>command).

   <b>Regular Expressions in ex</b>
       Historical practice is that the characters in the replacement
       part of the last <b>s </b>command—that is, those matched by entering a
       <b>'~' </b>in the regular expression—were not further expanded by the
       regular expression engine. So, if the characters contained the
       string <b>"a.," </b>they would match <b>'a' </b>followed by <b>".," </b>and not <b>'a'</b>
       followed by any character. POSIX.1‐2008 requires conformance to
       historical practice.

   <b>Edit Options in ex</b>
       The following paragraphs describe the historical behavior of some
       edit options that were not, for whatever reason, included in
       POSIX.1‐2008.  Implementations are strongly encouraged to only
       use these names if the functionality described here is fully
       supported.

       <b>extended  </b>The <b>extended </b>edit option has been used in some
                 implementations of <i>vi</i> to provide extended regular
                 expressions instead of basic regular expressions This
                 option was omitted from POSIX.1‐2008 because it is not
                 widespread historical practice.

       <b>flash     </b>The <b>flash </b>edit option historically caused the screen to
                 flash instead of beeping on error. This option was
                 omitted from POSIX.1‐2008 because it is not found in
                 some historical implementations.

       <b>hardtabs  </b>The <b>hardtabs </b>edit option historically defined the
                 number of columns between hardware tab settings. This
                 option was omitted from POSIX.1‐2008 because it was
                 believed to no longer be generally useful.

       <b>modeline  </b>The <b>modeline </b>(sometimes named <b>modelines</b>) edit option
                 historically caused <i>ex</i> or <i>vi</i> to read the five first and
                 last lines of the file for editor commands.  This
                 option is a security problem, and vendors are strongly
                 encouraged to delete it from historical
                 implementations.

       <b>open      </b>The <b>open </b>edit option historically disallowed the <i>ex</i>
                 <b>open </b>and <b>visual </b>commands. This edit option was omitted
                 because these commands are required by POSIX.1‐2008.

       <b>optimize  </b>The <b>optimize </b>edit option historically expedited text
                 throughput by setting the terminal to not do automatic
                 &lt;carriage-return&gt; characters when printing more than
                 one logical line of output. This option was omitted
                 from POSIX.1‐2008 because it was intended for terminals
                 without addressable cursors, which are rarely, if ever,
                 still used.

       <b>ruler     </b>The <b>ruler </b>edit option has been used in some
                 implementations of <i>vi</i> to present a current row/column
                 ruler for the user. This option was omitted from
                 POSIX.1‐2008 because it is not widespread historical
                 practice.

       <b>sourceany </b>The <b>sourceany </b>edit option historically caused <i>ex</i> or <i>vi</i>
                 to source start-up files that were owned by users other
                 than the user running the editor. This option is a
                 security problem, and vendors are strongly encouraged
                 to remove it from their implementations.

       <b>timeout   </b>The <b>timeout </b>edit option historically enabled the (now
                 standard) feature of only waiting for a short period
                 before returning keys that could be part of a macro.
                 This feature was omitted from POSIX.1‐2008 because its
                 behavior is now standard, it is not widely useful, and
                 it was rarely documented.

       <b>verbose   </b>The <b>verbose </b>edit option has been used in some
                 implementations of <i>vi</i> to cause <i>vi</i> to output error
                 messages for common errors; for example, attempting to
                 move the cursor past the beginning or end of the line
                 instead of only alerting the screen. (The historical <i>vi</i>
                 only alerted the terminal and presented no message for
                 such errors. The historical editor option <b>terse </b>did not
                 select when to present error messages, it only made
                 existing error messages more or less verbose.) This
                 option was omitted from POSIX.1‐2008 because it is not
                 widespread historical practice; however, implementors
                 are encouraged to use it if they wish to provide error
                 messages for naive users.

       <b>wraplen   </b>The <b>wraplen </b>edit option has been used in some
                 implementations of <i>vi</i> to specify an automatic margin
                 measured from the left margin instead of from the right
                 margin. This is useful when multiple screen sizes are
                 being used to edit a single file. This option was
                 omitted from POSIX.1‐2008 because it is not widespread
                 historical practice; however, implementors are
                 encouraged to use it if they add this functionality.

   <b>autoindent, ai</b>
       Historically, the command <b>0a </b>did not do any autoindentation,
       regardless of the current indentation of line 1. POSIX.1‐2008
       requires that any indentation present in line 1 be used.

   <b>autoprint, ap</b>
       Historically, the <b>autoprint </b>edit option was not completely
       consistent or based solely on modifications to the edit buffer.
       Exceptions were the <b>read </b>command (when reading from a file, but
       not from a filter), the <b>append</b>, <b>change</b>, <b>insert</b>, <b>global</b>, and <b>v</b>
       commands, all of which were not affected by <b>autoprint</b>, and the
       <b>tag </b>command, which was affected by <b>autoprint</b>.  POSIX.1‐2008
       requires conformance to historical practice.

       Historically, the <b>autoprint </b>option only applied to the last of
       multiple commands entered using &lt;vertical-line&gt; delimiters; for
       example, <b>delete </b>&lt;newline&gt; was affected by <b>autoprint</b>, but
       <b>delete|version </b>&lt;newline&gt; was not. POSIX.1‐2008 requires
       conformance to historical practice.

   <b>autowrite, aw</b>
       Appending the <b>'!'  </b>character to the <i>ex</i> <b>next </b>command to avoid
       performing an automatic write was not supported in historical
       implementations. POSIX.1‐2008 requires that the behavior match
       the other <i>ex</i> commands for consistency.

   <b>ignorecase, ic</b>
       Historical implementations of case-insensitive matching (the
       <b>ignorecase </b>edit option) lead to counter-intuitive situations when
       uppercase characters were used in range expressions.
       Historically, the process was as follows:

        1. Take a line of text from the edit buffer.

        2. Convert uppercase to lowercase in text line.

        3. Convert uppercase to lowercase in regular expressions, except
           in character class specifications.

        4. Match regular expressions against text.

       This would mean that, with <b>ignorecase </b>in effect, the text:

           The cat sat on the mat

       would be matched by

           /^the/

       but not by:

           /^[A-Z]he/

       For consistency with other commands implementing regular
       expressions, POSIX.1‐2008 does not permit this behavior.

   <b>paragraphs, para</b>
       The ISO POSIX‐2:1993 standard made the default <b>paragraphs </b>and
       <b>sections </b>edit options implementation-defined, arguing they were
       historically oriented to the UNIX system <i>troff</i> text formatter,
       and a ``portable user'' could use the <b>{</b>, <b>}</b>, <b>[[</b>, <b>]]</b>, <b>(</b>, and <b>)</b>
       commands in open or visual mode and have the cursor stop in
       unexpected places. POSIX.1‐2008 specifies their values in the
       POSIX locale because the unusual grouping (they only work when
       grouped into two characters at a time) means that they cannot be
       used for general-purpose movement, regardless.

   <b>readonly</b>
       Implementations are encouraged to provide the best possible
       information to the user as to the read-only status of the file,
       with the exception that they should not consider the current
       special privileges of the process. This provides users with a
       safety net because they must force the overwrite of read-only
       files, even when running with additional privileges.

       The <b>readonly </b>edit option specification largely conforms to
       historical practice. The only difference is that historical
       implementations did not notice that the user had set the <b>readonly</b>
       edit option in cases where the file was already marked read-only
       for some reason, and would therefore reinitialize the <b>readonly</b>
       edit option the next time the contents of the edit buffer were
       replaced. This behavior is disallowed by POSIX.1‐2008.

   <b>report</b>
       The requirement that lines copied to a buffer interact
       differently than deleted lines is historical practice. For
       example, if the <b>report </b>edit option is set to 3, deleting 3 lines
       will cause a report to be written, but 4 lines must be copied
       before a report is written.

       The requirement that the <i>ex</i> <b>global</b>, <b>v</b>, <b>open</b>, <b>undo</b>, and <b>visual</b>
       commands present reports based on the total number of lines added
       or deleted during the command execution, and that commands
       executed by the <b>global </b>and <b>v </b>commands not present reports, is
       historical practice. POSIX.1‐2008 extends historical practice by
       requiring that buffer execution be treated similarly. The reasons
       for this are two-fold. Historically, only the report by the last
       command executed from the buffer would be seen by the user, as
       each new report would overwrite the last. In addition, the
       standard developers believed that buffer execution had more in
       common with <b>global </b>and <b>v </b>commands than it did with other <i>ex</i>
       commands, and should behave similarly, for consistency and
       simplicity of specification.

   <b>showmatch, sm</b>
       The length of time the cursor spends on the matching character is
       unspecified because the timing capabilities of systems are often
       inexact and variable. The time should be long enough for the user
       to notice, but not long enough for the user to become annoyed.
       Some implementations of <i>vi</i> have added a <b>matchtime </b>option that
       permits users to set the number of 0,1 second intervals the
       cursor pauses on the matching character.

   <b>showmode</b>
       The <b>showmode </b>option has been used in some historical
       implementations of <i>ex</i> and <i>vi</i> to display the current editing mode
       when in open or visual mode. The editing modes have generally
       included ``command'' and ``input'', and sometimes other modes
       such as ``replace'' and ``change''. The string was usually
       displayed on the bottom line of the screen at the far right-hand
       corner. In addition, a preceding <b>'*' </b>character often denoted
       whether the contents of the edit buffer had been modified. The
       latter display has sometimes been part of the <b>showmode </b>option,
       and sometimes based on another option. This option was not
       available in the 4 BSD historical implementation of <i>vi</i>, but was
       viewed as generally useful, particularly to novice users, and is
       required by POSIX.1‐2008.

       The <b>smd </b>shorthand for the <b>showmode </b>option was not present in all
       historical implementations of the editor.  POSIX.1‐2008 requires
       it, for consistency.

       Not all historical implementations of the editor displayed a mode
       string for command mode, differentiating command mode from text
       input mode by the absence of a mode string. POSIX.1‐2008 permits
       this behavior for consistency with historical practice, but
       implementations are encouraged to provide a display string for
       both modes.

   <b>slowopen</b>
       Historically, the <b>slowopen </b>option was automatically set if the
       terminal baud rate was less than 1200 baud, or if the baud rate
       was 1200 baud and the <b>redraw </b>option was not set. The <b>slowopen</b>
       option had two effects. First, when inserting characters in the
       middle of a line, characters after the cursor would not be pushed
       ahead, but would appear to be overwritten. Second, when creating
       a new line of text, lines after the current line would not be
       scrolled down, but would appear to be overwritten. In both cases,
       ending text input mode would cause the screen to be refreshed to
       match the actual contents of the edit buffer. Finally, terminals
       that were sufficiently intelligent caused the editor to ignore
       the <b>slowopen </b>option. POSIX.1‐2008 permits most historical
       behavior, extending historical practice to require <b>slowopen</b>
       behaviors if the edit option is set by the user.

   <b>tags</b>
       The default path for tags files is left unspecified as
       implementations may have their own <b>tags </b>implementations that do
       not correspond to the historical ones. The default <b>tags </b>option
       value should probably at least include the file <b>./tags</b>.

   <b>term</b>
       Historical implementations of <i>ex</i> and <i>vi</i> ignored changes to the
       <b>term </b>edit option after the initial terminal information was
       loaded. This is permitted by POSIX.1‐2008; however,
       implementations are encouraged to permit the user to modify their
       terminal type at any time.

   <b>terse</b>
       Historically, the <b>terse </b>edit option optionally provided a
       shorter, less descriptive error message, for some error messages.
       This is permitted, but not required, by POSIX.1‐2008.
       Historically, most common visual mode errors (for example, trying
       to move the cursor past the end of a line) did not result in an
       error message, but simply alerted the terminal. Implementations
       wishing to provide messages for novice users are urged to do so
       based on the <b>edit </b>option <b>verbose</b>, and not <b>terse</b>.

   <b>window</b>
       In historical implementations, the default for the <b>window </b>edit
       option was based on the baud rate as follows:

        1. If the baud rate was less than 1200, the <b>edit </b>option <b>w300 </b>set
           the window value; for example, the line:

               set w300=12

           would set the window option to 12 if the baud rate was less
           than 1200.

        2. If the baud rate was equal to 1200, the <b>edit </b>option <b>w1200 </b>set
           the window value.

        3. If the baud rate was greater than 1200, the <b>edit </b>option <b>w9600</b>
           set the window value.

       The <b>w300</b>, <b>w1200</b>, and <b>w9600 </b>options do not appear in POSIX.1‐2008
       because of their dependence on specific baud rates.

       In historical implementations, the size of the window displayed
       by various commands was related to, but not necessarily the same
       as, the <b>window </b>edit option. For example, the size of the window
       was set by the <i>ex</i> command <b>visual 10</b>, but it did not change the
       value of the <b>window </b>edit option. However, changing the value of
       the <b>window </b>edit option did change the number of lines that were
       displayed when the screen was repainted. POSIX.1‐2008 does not
       permit this behavior in the interests of consistency and
       simplicity of specification, and requires that all commands that
       change the number of lines that are displayed do it by setting
       the value of the <b>window </b>edit option.

   <b>wrapmargin, wm</b>
       Historically, the <b>wrapmargin </b>option did not affect maps inserting
       characters that also had associated <i>count</i>s; for example
       <b>:map K 5aABC DEF</b>.  Unfortunately, there are widely used maps that
       depend on this behavior.  For consistency and simplicity of
       specification, POSIX.1‐2008 does not permit this behavior.

       Historically, <b>wrapmargin </b>was calculated using the column display
       width of all characters on the screen. For example, an
       implementation using <b>"^I" </b>to represent &lt;tab&gt; characters when the
       <b>list </b>edit option was set, where <b>'^' </b>and <b>'I' </b>each took up a single
       column on the screen, would calculate the <b>wrapmargin </b>based on a
       value of 2 for each &lt;tab&gt;.  The <b>number </b>edit option similarly
       changed the effective length of the line as well.  POSIX.1‐2008
       requires conformance to historical practice.

       Earlier versions of this standard allowed for implementations
       with bytes other than eight bits, but this has been modified in
       this version.
</pre> <h2>
FUTURE DIRECTIONS </h2>
<pre>
       None.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <i>Section 2.9.1.1</i>, <i>Command Search and Execution</i>, <a href="ctags.1p.html">ctags(1p)</a>, <a href="ed.1p.html">ed(1p)</a>,
       <a href="sed.1p.html">sed(1p)</a>, <a href="sh.1p.html">sh(1p)</a>, <a href="stty.1p.html">stty(1p)</a>, <a href="vi.1p.html">vi(1p)</a>

       The Base Definitions volume of POSIX.1‐2017, <i>Table 5-1</i>, <i>Escape</i>
       <i>Sequences and Associated Actions</i>, <i>Chapter 8</i>, <i>Environment</i>
       <i>Variables</i>, <i>Section 9.3</i>, <i>Basic Regular Expressions</i>, <i>Section 12.2</i>,
       <i>Utility Syntax Guidelines</i>

       The System Interfaces volume of POSIX.1‐2017, <a href="../man3/access.3p.html">access(3p)</a>
</pre> <h2>
COPYRIGHT </h2>
<pre>
       Portions of this text are reprinted and reproduced in electronic
       form from IEEE Std 1003.1-2017, Standard for Information
       Technology -- Portable Operating System Interface (POSIX), The
       Open Group Base Specifications Issue 7, 2018 Edition, Copyright
       (C) 2018 by the Institute of Electrical and Electronics
       Engineers, Inc and The Open Group.  In the event of any
       discrepancy between this version and the original IEEE and The
       Open Group Standard, the original IEEE and The Open Group
       Standard is the referee document. The original Standard can be
       obtained online at <a href="http://www.opengroup.org/unix/online.html">http://www.opengroup.org/unix/online.html</a> .

       Any typographical or formatting errors that appear in this page
       are most likely to have been introduced during the conversion of
       the source files to man page format. To report such errors, see
       <a href="https://www.kernel.org/doc/man-pages/reporting_bugs.html">https://www.kernel.org/doc/man-pages/reporting_bugs.html</a> .

<span class="footline">IEEE/The Open Group               2017                            <i>EX</i>(1P)</span>
</pre>  <p>Pages that refer to this page: <a href="ed.1p.html">ed(1p)</a>, <a href="more.1p.html">more(1p)</a>, <a href="vi.1p.html">vi(1p)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man1/ex.1p.html" class="_attribution-link">https://man7.org/linux/man-pages/man1/ex.1p.html</a>
  </p>
</div>
