<h1>PR_SET_MM_EXE_FILE(2const) — Linux manual page</h1>   <pre>
<span class="headline"><i>PR_SET_MM_EXE_FILE</i>(2const)                    <i>PR_SET_MM_EXE_FILE</i>(2const)</span>
</pre> <h2>
NAME </h2>
<pre>
       PR_SET_MM_EXE_FILE - modify kernel memory map descriptor fields
</pre> <h2>
LIBRARY </h2>
<pre>
       Standard C library (<i>libc</i>, <i>-lc</i>)
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;linux/prctl.h&gt;  </b>/* Definition of <b>PR_* </b>constants */
       <b>#include &lt;sys/prctl.h&gt;</b>

       <b>int prctl(PR_SET_MM, PR_SET_MM_EXE_FILE, long </b><i>fd</i><b>, 0L, 0L);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       Supersede the <i>/proc/</i>pid<i>/exe</i> symbolic link with a new one pointing
       to a new executable file identified by the file descriptor
       provided in the <i>fd</i> argument.  The file descriptor should be
       obtained with a regular <a href="open.2.html">open(2)</a> call.

       To change the symbolic link, one needs to unmap all existing
       executable memory areas, including those created by the kernel
       itself (for example the kernel usually creates at least one
       executable memory area for the ELF <i>.text</i> section).
</pre> <h2>
RETURN VALUE </h2>
<pre>
       On success, 0 is returned.  On error, -1 is returned, and <i><a href="../man3/errno.3.html">errno</a></i>
       is set to indicate the error.
</pre> <h2>
ERRORS </h2>
<pre>
       <b>EACCES </b>The file is not executable.

       <b>EBADF  </b>The file descriptor passed in <i>fd</i> is not valid.

       <b>EBUSY  </b>This the second attempt to change the <i>/proc/</i>pid<i>/exe</i>
              symbolic link.
</pre> <h2>
FILES </h2>
<pre>
       <i>/proc/</i>pid<i>/exe</i>
</pre> <h2>
STANDARDS </h2>
<pre>
       Linux.
</pre> <h2>
HISTORY </h2>
<pre>
       Linux 3.5.

       In Linux 4.9 and earlier, the <b>PR_SET_MM_EXE_FILE </b>operation can be
       performed only once in a process's lifetime; attempting to
       perform the operation a second time results in the error <b>EPERM</b>.
       This restriction was enforced for security reasons that were
       subsequently deemed specious, and the restriction was removed in
       Linux 4.10 because some user-space applications needed to perform
       this operation more than once.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="prctl.2.html">prctl(2)</a>, <a href="pr_set_mm.2const.html">PR_SET_MM(2const)</a>, <a href="../man5/proc_pid_exe.5.html">proc_pid_exe(5)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>man-pages</i> (Linux kernel and C library
       user-space interface documentation) project.  Information about
       the project can be found at 
       ⟨<a href="https://www.kernel.org/doc/man-pages/">https://www.kernel.org/doc/man-pages/</a>⟩.  If you have a bug report
       for this manual page, see
       ⟨<a href="https://git.kernel.org/pub/scm/docs/man-pages/man-pages.git/tree/CONTRIBUTING">https://git.kernel.org/pub/scm/docs/man-pages/man-pages.git/tree/CONTRIBUTING</a>⟩.
       This page was obtained from the tarball man-pages-6.9.1.tar.gz
       fetched from
       ⟨<a href="https://mirrors.edge.kernel.org/pub/linux/docs/man-pages/">https://mirrors.edge.kernel.org/pub/linux/docs/man-pages/</a>⟩ on
       2024-06-26.  If you discover any rendering problems in this HTML
       version of the page, or you believe there is a better or more up-
       to-date source for the page, or you have corrections or
       improvements to the information in this COLOPHON (which is <i>not</i>
       part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Linux man-pages 6.9.1          2024-06-01     <i>PR_SET_MM_EXE_FILE</i>(2const)</span>
</pre>  <p>Pages that refer to this page: <a href="pr_set_mm.2const.html">PR_SET_MM(2const)</a>, <a href="pr_set_mm_map.2const.html">PR_SET_MM_MAP(2const)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man2/PR_SET_MM_EXE_FILE.2const.html" class="_attribution-link">https://man7.org/linux/man-pages/man2/PR_SET_MM_EXE_FILE.2const.html</a>
  </p>
</div>
