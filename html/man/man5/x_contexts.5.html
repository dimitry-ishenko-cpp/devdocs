<h1>selabel_x(5) — Linux manual page</h1>   <pre>
<span class="headline"><i>selabel_x</i>(5)            SELinux API documentation           <i>selabel_x</i>(5)</span>
</pre> <h2>
NAME </h2>
<pre>
       selabel_x - userspace SELinux labeling interface and
       configuration file format for the X Window System contexts
       backend. This backend is also used to determine the default
       context for labeling remotely connected X clients
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;selinux/label.h&gt;</b>

       <b>int selabel_lookup(struct selabel_handle *</b><i>hnd</i><b>,</b>
                          <b>char **</b><i>context</i><b>,</b>
                          <b>const char *</b><i>object_name</i><b>, int </b><i>object_type</i><b>);</b>

       <b>int selabel_lookup_raw(struct selabel_handle *</b><i>hnd</i><b>,</b>
                          <b>char **</b><i>context</i><b>,</b>
                          <b>const char *</b><i>object_name</i><b>, int </b><i>object_type</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The X contexts backend maps from X Window System object names
       into security contexts. It is used to find the appropriate
       context for X Window System objects whose significance and/or
       usage semantics are determined primarily by name. The returned
       <i>context</i> must be freed using <a href="../man3/freecon.3.html">freecon(3)</a>.
       <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> describes the function with its return and
       error codes.

       This backend is also used to determine the default context for
       labeling remotely connected X clients.

       The <i>object_type</i> argument should be set to one of the following
       values:

              <b>SELABEL_X_PROP</b>
                     The <i>object_name</i> argument specifies the name of a
                     window property, such as "WM_NAME".

              <b>SELABEL_X_SELN</b>
                     The <i>object_name</i> argument specifies the name of a
                     selection, such as "PRIMARY".

              <b>SELABEL_X_EXT</b>
                     The <i>object_name</i> argument specifies the name of a
                     protocol extension, such as "RENDER".

              <b>SELABEL_X_EVENT</b>
                     The <i>object_name</i> argument specifies the name of an
                     event type, such as "X11:ButtonPress".

              <b>SELABEL_X_CLIENT</b>
                     The <i>object_name</i> argument is ignored, however it
                     should be set to either <i>*</i> (an asterisk or
                     'wildcard' that will select the default entry) or a
                     specific entry such as "remote" in the X contexts
                     file as shown in the <b>EXAMPLE </b>section. The default
                     context for labeling remote X clients is then
                     returned.

              <b>SELABEL_X_POLYPROP</b>
                     Like <b>SELABEL_X_PROP</b>, but checks if the property was
                     marked as being polyinstantiated. See <b>NOTES </b>below.

              <b>SELABEL_X_POLYSELN</b>
                     Like <b>SELABEL_X_SELN</b>, but checks if the selection
                     was marked as being polyinstantiated. See <b>NOTES</b>
                     below.

       Any messages generated by <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> are sent to <i>stderr</i> by
       default, although this can be changed by <a href="../man3/selinux_set_callback.3.html">selinux_set_callback(3)</a>.

       <b>selabel_lookup_raw </b>behaves identically to <b>selabel_lookup </b>but does
       not perform context translation.

       The <b>FILES </b>section details the configuration files used to
       determine the X object context.
</pre> <h2>
OPTIONS </h2>
<pre>
       In addition to the global options described in <a href="../man3/selabel_open.3.html">selabel_open(3)</a>,
       this backend recognizes the following options:

              <b>SELABEL_OPT_PATH</b>
                     A non-null value for this option specifies a path
                     to a file that will be opened in lieu of the
                     standard X contexts file (see the <b>FILES </b>section for
                     details).
</pre> <h2>
FILES </h2>
<pre>
       The X context file used to retrieve a default context depends on
       the <b>SELABEL_OPT_PATH </b>parameter passed to <a href="../man3/selabel_open.3.html">selabel_open(3)</a>. If
       <i>NULL</i>, then the <b>SELABEL_OPT_PATH </b>value will default to the active
       policy X contexts location (as returned by
       <a href="../man3/selinux_x_context_path.3.html">selinux_x_context_path(3)</a>), otherwise the actual <b>SELABEL_OPT_PATH</b>
       value specified is used.

       The default X object contexts file is:
              <i>/etc/selinux/{SELINUXTYPE}/contexts/x_contexts</i>

       Where <i>{SELINUXTYPE}</i> is the entry from the selinux configuration
       file <i>config</i> (see <a href="selinux_config.5.html">selinux_config(5)</a>).

       The entries within the X contexts file are shown in the <b>Object</b>
       <b>Name String Values </b>and <b>FILE FORMAT </b>sections.
</pre> <h2>
Object Name String Values </h2>
<pre>
       The string name assigned to each <i>object_type</i> argument that can be
       present in the X contexts file are:
                   ┌────────────────────┬────────────────┐
                   │ <i>object_type</i>        │ <b>Text Name      </b>│
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_PROP     </b>│ property       │
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_SELN     </b>│ selection      │
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_EXT      </b>│ extension      │
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_EVENT    </b>│ event          │
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_CLIENT   </b>│ client         │
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_POLYPROP </b>│ poly_property  │
                   ├────────────────────┼────────────────┤
                   │ <b>SELABEL_X_POLYSELN </b>│ poly_selection │
                   └────────────────────┴────────────────┘
</pre> <h2>
FILE FORMAT </h2>
<pre>
       Each line within the X contexts file is as follows:
              <i>object_type object_name context</i>

       Where:
              <i>object_type</i>
                     This is the string representation of the object
                     type shown in the <b>Object Name String Values</b>
                     section.  There can be multiple lines with the same
                     <i>object_type</i> string that will form a block of
                     entries (each with a different <i>object_name</i> entry).
              <i>object_name</i>
                     These are the object names of the specific X-server
                     resource such as <b>PRIMARY</b>, <b>CUT_BUFFER0 </b>etc. They are
                     generally defined in the X-server source code
                     (<i>protocol.txt</i> and <i>BuiltInAtoms</i> in the dix directory
                     of the xorg-server source package).  The entry can
                     contain '*' for wildcard matching or '?' for
                     substitution.  Note that if the '*' is used, then
                     be aware that the order of entries in the file is
                     important. The '*' on its own is used to ensure a
                     default fallback context is assigned and should be
                     the last entry in the <i>object_type</i> block.
              <i>context</i>
                     The security context that will be applied to the
                     object.

       Example 1:

       # object_type  object_name  context
       selection      PRIMARY      system_u:object_r:clipboard_xselection_t:s0
       selection      *            system_u:object_r:xselection_t:s0

       Example 2 - This example shows how a client entry can be
       configured to ensure an entry is always found:

       # object_type  object_name  context
       client         *            system_u:object_r:remote_t:s0
</pre> <h2>
NOTES </h2>
<pre>
       1.  Properties and selections are marked as either
           polyinstantiated or not. For these name types, the "POLY"
           option searches only the names marked as being
           polyinstantiated, while the other option searches only the
           names marked as not being polyinstantiated. Users of the
           interface should check both mappings, optionally taking
           action based on the result (e.g. polyinstantiating the
           object).

       2.  If contexts are to be validated, then the global option
           <b>SELABEL_OPT_VALIDATE </b>must be set before calling
           <a href="../man3/selabel_open.3.html">selabel_open(3)</a>. If this is not set, then it is possible for
           an invalid context to be returned.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man8/selinux.8.html">selinux(8)</a>, <a href="../man3/selabel_open.3.html">selabel_open(3)</a>, <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a>, <a href="../man3/selabel_stats.3.html">selabel_stats(3)</a>,
       <a href="../man3/selabel_close.3.html">selabel_close(3)</a>, <a href="../man3/selinux_set_callback.3.html">selinux_set_callback(3)</a>,
       <a href="../man3/selinux_x_context_path.3.html">selinux_x_context_path(3)</a>, <a href="../man3/freecon.3.html">freecon(3)</a>, <a href="selinux_config.5.html">selinux_config(5)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Security Enhanced Linux        29 Nov 2011                  <i>selabel_x</i>(5)</span>
</pre>  <p>Pages that refer to this page: <a href="../man3/selabel_open.3.html">selabel_open(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man5/x_contexts.5.html" class="_attribution-link">https://man7.org/linux/man-pages/man5/x_contexts.5.html</a>
  </p>
</div>
