<h1>slapo-ppolicy(5) — Linux manual page</h1>   <pre>
<span class="headline"><i>SLAPO_PPOLICY</i>(5)           File Formats Manual          <i>SLAPO_PPOLICY</i>(5)</span>
</pre> <h2>
NAME </h2>
<pre>
       slapo-ppolicy - Password Policy overlay to slapd
</pre> <h2>
SYNOPSIS </h2>
<pre>
       ETCDIR/slapd.conf
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>ppolicy </b>overlay is an implementation of the most recent IETF
       Password Policy proposal for LDAP.   When instantiated, it
       intercepts, decodes and applies specific password policy controls
       to overall use of a backend database, changes to user password
       fields, etc.

       The overlay provides a variety of password control mechanisms.
       They include password aging -- both minimum and maximum ages,
       password reuse and duplication control, account time-outs,
       mandatory password resets, acceptable password content, and even
       grace logins.  Different groups of users may be associated with
       different password policies, and there is no limit to the number
       of password policies that may be created.

       Note that some of the policies do not take effect when the
       operation is performed with the <b>rootdn </b>identity; all the
       operations, when performed with any other identity, may be
       subjected to constraints, like access control.  This overlay
       requires a rootdn to be configured on the database.

       During password update, an identity with <b>manage </b>access to the
       userPassword attribute is considered a password administrator
       where relevant to the IETF Password Policy proposal.

       Note that the IETF Password Policy proposal for LDAP makes sense
       when considering a single-valued password attribute, while the
       userPassword attribute allows multiple values.  This
       implementation enforces a single value for the userPassword
       attribute, despite its specification.

       In addition to supporting the IETF Password Policy, this module
       supports the SunDS Account Usability control
       (1.3.6.1.4.1.42.2.27.9.5.8) on search requests and can send the
       Netscape Password validity controls when configured to do so.
</pre> <h2>
CONFIGURATION </h2>
<pre>
       These <b>slapd.conf </b>configuration options apply to the ppolicy
       overlay. They should appear after the <b>overlay </b>directive.

       <b>ppolicy_forward_updates</b>
              Specify that policy state changes that result from Bind
              operations (such as recording failures, lockout, etc.) on
              a consumer should be forwarded to a provider instead of
              being written directly into the consumer's local database.
              This setting is only useful on a replication consumer, and
              also requires the <b>updateref </b>setting and <b>chain </b>overlay to
              be appropriately configured.

       <b>ppolicy_hash_cleartext</b>
              Specify that cleartext passwords present in Add and Modify
              requests should be hashed before being stored in the
              database. This violates the X.500/LDAP information model,
              but may be needed to compensate for LDAP clients that
              don't use the Password Modify extended operation to manage
              passwords.  It is recommended that when this option is
              used that compare, search, and read access be denied to
              all directory users.

       <b>ppolicy_use_lockout</b>
              A client will always receive an LDAP <b>InvalidCredentials</b>
              response when Binding to a locked account. By default,
              when a Password Policy control was provided on the Bind
              request, a Password Policy response will be included with
              no special error code set. This option changes the
              Password Policy response to include the <b>AccountLocked</b>
              error code. Note that sending the <b>AccountLocked </b>error code
              provides useful information to an attacker; sites that are
              sensitive to security issues should not enable this
              option.

       <b>ppolicy_send_netscape_controls</b>
              If set, ppolicy will send the password policy expired
              (2.16.840.1.113730.3.4.4) and password policy expiring
              (2.16.840.1.113730.3.4.5) controls when appropriate. The
              controls are not sent for bind requests where the Password
              policy control has already been requested. Default is not
              to send the controls.

       <b>ppolicy_check_module &lt;path&gt;</b>
              Specify the path of a loadable module containing a
              <b>check_password() </b>function for additional password quality
              checks. The use of this module is described further below
              in the description of the <b>pwdPolicyChecker </b>objectclass.

              Note: The user-defined loadable module must be in <b>slapd's</b>
              standard executable search PATH, or an absolute path must
              be provided.

              Note: Use of a <b>ppolicy_check_module </b>is a non-standard
              extension to the LDAP password policy proposal.

       <b>ppolicy_rules [dn[.&lt;dnstyle&gt;]=&lt;DN/regex&gt;]</b>
              <b>[require_password=yes|no] [filter=&lt;filter str&gt;]</b>
              <b>[group[.expand][/&lt;objectclass&gt;[/&lt;attribute&gt;]]=&lt;DN/pattern&gt;]</b>
              <b>no_policy|policy_dn=&lt;policyDN&gt;|policy_dn.expand=&lt;pattern&gt;</b>
              <b>[stop|continue]</b>
              Specify which pwdPolicy object to use when no specific
              policy is set on a given user's entry. The rules are
              checked in order and the first one to match will apply
              (but see the <b>continue </b>action). If a rule that specifies
              <b>no_policy </b>is selected or the selected <b>policyDN </b>is an entry
              with objectclass <b>pwdPolicy </b>but its contents are not valid,
              then no policies will be enforced.

              When checking whether a rule applies, <b>ppolicy </b>checks:

                     • The entry's DN against the <b>dn[.&lt;dnstyle&gt;]</b>

                     • If <b>require_password </b>is <b>yes </b>(the default),
                       presence of the password attribute (currently
                       only <b>userPassword</b>)

                     • The entry's contents against the <b>filter</b>

                     • Whether it is considered a member of the group
                       specified in <b>group[.expand]</b>

              All of which are optional. Matching and meaning of
              <b>&lt;dnstyle&gt; </b>and <b>expand </b>loosely follow that described in
              <a href="slapd.access.5.html">slapd.access(5)</a> except that the expansions in the pattern
              space are slightly more limited, only the <b>$&lt;digit&gt; </b>form is
              supported at the moment and only if <b>dnstyle </b>is <b>regex</b>.  It
              then tries to retrieve <b>policyDN </b>and check that its
              objectclass is <b>pwdPolicy</b>.

              If all of the rule checks pass, behaviour depends on the
              <b>action </b>keyword (<b>stop</b>|<b>continue</b>).  If <b>action </b>is <b>stop </b>(the
              default), processing ends here with policy that was just
              chosen (or the <b>no_policy </b>decision). If <b>action </b>is <b>continue</b>,
              the decision is remembered, processing continues and can
              be overriden by later rules.

              The way to configure this in <b>cn=config </b>is through child
              entries under the overlay entry with objectclass
              <b>olcPPolicyRegexRule </b>for regex-based DN matching and
              <b>olcPPolicyScopedRule </b>for any other <b>&lt;dnstyle&gt;</b>.

       <b>ppolicy_default &lt;policyDN&gt;</b>
              Specify the DN of the pwdPolicy object to use when no
              specific policy is set on a given user's entry and none of
              the <b>ppolicy_rules </b>matched. If there is no specific policy
              for an entry and no default is given, then no policies
              will be enforced. This option is deprecated in favour of
              <b>ppolicy_rules </b>and support for it will be removed in a
              future release. It behaves as if the following rule was
              the first rule in <b>ppolicy_rules</b>:

                  ppolicy_rules policyDN=&lt;policyDN&gt; continue
</pre> <h2>
OBJECT CLASS </h2>
<pre>
       The <b>ppolicy </b>overlay depends on the <b>pwdPolicy </b>object class.  The
       definition of that class is as follows:

           (  1.3.6.1.4.1.42.2.27.8.2.1
               NAME 'pwdPolicy'
               AUXILIARY
               SUP top
               MUST ( pwdAttribute )
               MAY (
                   pwdMinAge $ pwdMaxAge $ pwdInHistory $
                   pwdCheckQuality $ pwdMinLength $ pwdMaxLength $
                   pwdExpireWarning $ pwdGraceAuthnLimit $
                   pwdGraceExpiry $ pwdLockout $ pwdLockoutDuration $
                   pwdMaxFailure $ pwdFailureCountInterval $
                   pwdMustChange $ pwdAllowUserChange $
                   pwdSafeModify $ pwdMaxRecordedFailure $
                   pwdMinDelay $ pwdMaxDelay $ pwdMaxIdle ) )

       The <b>pwdPolicy </b>class is not structural, and so entries using it
       require another, structural, object class.  The <b>namedPolicy</b>
       object class is a good choice.  <b>namedPolicy </b>requires a <b>cn</b>
       attribute, suitable as the policy entry's rDN.

       This implementation also provides an additional <b>pwdPolicyChecker</b>
       objectclass, used for password quality checking (see specific
       attributes below for usage).

           (  1.3.6.1.4.1.4754.2.99.1
               NAME 'pwdPolicyChecker'
               AUXILIARY
               SUP top
               MAY ( pwdCheckModule $ pwdCheckModuleArg $
           pwdUseCheckModule ) )

       Every account that should be subject to password policy control
       should have a <b>pwdPolicySubentry </b>attribute containing the DN of a
       valid <b>pwdPolicy </b>entry, or they can simply use the configured
       default.  In this way different users may be managed according to
       different policies.
</pre> <h2>
OBJECT CLASS ATTRIBUTES </h2>
<pre>
       Each one of the sections below details the meaning and use of a
       particular attribute of this <b>pwdPolicy </b>object class.

       <b>pwdAttribute</b>

       This attribute contains the name of the attribute to which the
       password policy is applied. For example, the password policy may
       be applied to the <b>userPassword </b>attribute.

       Note: in this implementation, the only value accepted for
       <b>pwdAttribute </b>is  <i>userPassword</i> .

           (  1.3.6.1.4.1.42.2.27.8.1.1
              NAME 'pwdAttribute'
              EQUALITY objectIdentifierMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.38 )

       <b>pwdMinAge</b>

       This attribute contains the number of seconds that must elapse
       between modifications allowed to the password. If this attribute
       is not present, zero seconds is assumed (i.e. the password may be
       modified whenever and however often is desired).

           (  1.3.6.1.4.1.42.2.27.8.1.2
              NAME 'pwdMinAge'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMaxAge</b>

       This attribute contains the number of seconds after which a
       modified password will expire.  If this attribute is not present,
       or if its value is zero (0), then passwords will not expire.

           (  1.3.6.1.4.1.42.2.27.8.1.3
              NAME 'pwdMaxAge'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdInHistory</b>

       This attribute is used to specify the maximum number of used
       passwords that will be stored in the <b>pwdHistory </b>attribute.  If
       the <b>pwdInHistory </b>attribute is not present, or if its value is
       zero (0), used passwords will not be stored in <b>pwdHistory </b>and
       thus any previously-used password may be reused.  No history
       checking occurs if the password is being modified by the <b>rootdn</b>,
       although the password is saved in the history.

           (  1.3.6.1.4.1.42.2.27.8.1.4
              NAME 'pwdInHistory'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdCheckQuality</b>

       This attribute indicates if and how password syntax will be
       checked while a password is being modified or added. If this
       attribute is not present, or its value is zero (0), no syntax
       checking will be done. If its value is one (1), the server will
       check the syntax, and if the server is unable to check the
       syntax, whether due to a client-side hashed password or some
       other reason, it will be accepted. If its value is two (2), the
       server will check the syntax, and if the server is unable to
       check the syntax it will return an error refusing the password.

           (  1.3.6.1.4.1.42.2.27.8.1.5
              NAME 'pwdCheckQuality'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMinLength</b>

       When syntax checking is enabled (see also the <b>pwdCheckQuality</b>
       attribute), this attribute contains the minimum length in bytes
       that will be accepted in a password. If this attribute is not
       present, minimum password length is not enforced. If the server
       is unable to check the length of the password, whether due to a
       client-side hashed password or some other reason, the server
       will, depending on the value of <b>pwdCheckQuality</b>, either accept
       the password without checking it (if <b>pwdCheckQuality </b>is zero (0)
       or one (1)) or refuse it (if <b>pwdCheckQuality </b>is two (2)). If the
       number of characters should be enforced with regards to a
       particular encoding, the use of an appropriate
       <b>ppolicy_check_module </b>is required.

           (  1.3.6.1.4.1.42.2.27.8.1.6
              NAME 'pwdMinLength'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMaxLength</b>

       When syntax checking is enabled (see also the <b>pwdCheckQuality</b>
       attribute), this attribute contains the maximum length in bytes
       that will be accepted in a password. If this attribute is not
       present, maximum password length is not enforced. If the server
       is unable to check the length of the password, whether due to a
       client-side hashed password or some other reason, the server
       will, depending on the value of <b>pwdCheckQuality</b>, either accept
       the password without checking it (if <b>pwdCheckQuality </b>is zero (0)
       or one (1)) or refuse it (if <b>pwdCheckQuality </b>is two (2)). If the
       number of characters should be enforced with regards to a
       particular encoding, the use of an appropriate
       <b>ppolicy_check_module </b>is required.

           (  1.3.6.1.4.1.42.2.27.8.1.31
              NAME 'pwdMaxLength'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdExpireWarning</b>

       This attribute contains the maximum number of seconds before a
       password is due to expire that expiration warning messages will
       be returned to a user who is authenticating to the directory.  If
       this attribute is not present, or if the value is zero (0), no
       warnings will be sent.

           (  1.3.6.1.4.1.42.2.27.8.1.7
              NAME 'pwdExpireWarning'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdGraceAuthnLimit</b>

       This attribute contains the number of times that an expired
       password may be used to authenticate a user to the directory. If
       this attribute is not present or if its value is zero (0), users
       with expired passwords will not be allowed to authenticate to the
       directory.

           (  1.3.6.1.4.1.42.2.27.8.1.8
              NAME 'pwdGraceAuthnLimit'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdGraceExpiry</b>

       This attribute specifies the number of seconds the grace
       authentications are valid.  If this attribute is not present or
       if the value is zero (0), there is no time limit on the grace
       authentications.

           (  1.3.6.1.4.1.42.2.27.8.1.30
              NAME 'pwdGraceExpiry'
              EQUALITY integerMatch
              ORDERING integerOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdLockout</b>

       This attribute specifies the action that should be taken by the
       directory when a user has made a number of failed attempts to
       authenticate to the directory.  If <b>pwdLockout </b>is set (its value
       is "TRUE"), the user will not be allowed to attempt to
       authenticate to the directory after there have been a specified
       number of consecutive failed bind attempts.  The maximum number
       of consecutive failed bind attempts allowed is specified by the
       <b>pwdMaxFailure </b>attribute.  If <b>pwdLockout </b>is not present, or if its
       value is "FALSE", the password may be used to authenticate no
       matter how many consecutive failed bind attempts have been made.

           (  1.3.6.1.4.1.42.2.27.8.1.9
              NAME 'pwdLockout'
              EQUALITY booleanMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
              SINGLE-VALUE )

       <b>pwdLockoutDuration</b>

       This attribute contains the number of seconds during which the
       password cannot be used to authenticate the user to the directory
       due to too many consecutive failed bind attempts.  (See also
       <b>pwdLockout </b>and <b>pwdMaxFailure</b>.)  If <b>pwdLockoutDuration </b>is not
       present, or if its value is zero (0), the password cannot be used
       to authenticate the user to the directory again until it is reset
       by an administrator.

           (  1.3.6.1.4.1.42.2.27.8.1.10
              NAME 'pwdLockoutDuration'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMaxFailure</b>

       This attribute contains the number of consecutive failed bind
       attempts after which the password may not be used to authenticate
       a user to the directory.  If <b>pwdMaxFailure </b>is not present, or its
       value is zero (0), then a user will be allowed to continue to
       attempt to authenticate to the directory, no matter how many
       consecutive failed bind attempts have occurred with that user's
       DN.  (See also <b>pwdLockout </b>and <b>pwdLockoutDuration</b>.)

           (  1.3.6.1.4.1.42.2.27.8.1.11
              NAME 'pwdMaxFailure'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMaxRecordedFailure</b>

       This attribute contains the maximum number of failed bind
       attempts to store in a user's entry.  If <b>pwdMaxRecordedFailure </b>is
       not present, or its value is zero (0), then it defaults to the
       value of <b>pwdMaxFailure</b>.  If that value is also 0, the default is
       5.

           (  1.3.6.1.4.1.42.2.27.8.1.32
              NAME 'pwdMaxRecordedFailure'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdFailureCountInterval</b>

       This attribute contains the number of seconds after which old
       consecutive failed bind attempts are purged from the failure
       counter, even though no successful authentication has occurred.
       If <b>pwdFailureCountInterval </b>is not present, or its value is zero
       (0), the failure counter will only be reset by a successful
       authentication.

           (  1.3.6.1.4.1.42.2.27.8.1.12
              NAME 'pwdFailureCountInterval'
              EQUALITY integerMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMustChange</b>

       This attribute specifies whether users must change their
       passwords when they first bind to the directory after a password
       is set or reset by the administrator, or not.  If <b>pwdMustChange</b>
       has a value of "TRUE", users must change their passwords when
       they first bind to the directory after a password is set or reset
       by the administrator.  If <b>pwdMustChange </b>is not present, or its
       value is "FALSE", users are not required to change their password
       upon binding after the administrator sets or resets the password.

           (  1.3.6.1.4.1.42.2.27.8.1.13
             NAME 'pwdMustChange'
             EQUALITY booleanMatch
             SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
             SINGLE-VALUE )

       <b>pwdAllowUserChange</b>

       This attribute specifies whether users are allowed to change
       their own passwords or not.  If <b>pwdAllowUserChange </b>is set to
       "TRUE", or if the attribute is not present, users will be allowed
       to change their own passwords.  If its value is "FALSE", users
       will not be allowed to change their own passwords.

       Note: this implies that when <b>pwdAllowUserChange </b>is set to "TRUE",
       users will still be able to change the password of another user,
       subjected to access control.  This restriction only applies to
       modifications of ones's own password.  It should also be noted
       that <b>pwdAllowUserChange </b>was defined in the specification to
       provide rough access control to the password attribute in
       implementations that do not allow fine-grain access control.
       Since OpenLDAP provides fine-grain access control, the use of
       this attribute is discouraged; ACLs should be used instead (see
       <a href="slapd.access.5.html">slapd.access(5)</a> for details).

           (  1.3.6.1.4.1.42.2.27.8.1.14
              NAME 'pwdAllowUserChange'
              EQUALITY booleanMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
              SINGLE-VALUE )

       <b>pwdSafeModify</b>

       This attribute denotes whether the user's existing password must
       be sent along with their new password when changing a password.
       If <b>pwdSafeModify </b>is set to "TRUE", the existing password must be
       sent along with the new password.  If the attribute is not
       present, or its value is "FALSE", the existing password need not
       be sent along with the new password.

           (  1.3.6.1.4.1.42.2.27.8.1.15
              NAME 'pwdSafeModify'
              EQUALITY booleanMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
              SINGLE-VALUE )

       <b>pwdMinDelay</b>

       This attribute specifies the number of seconds to delay
       responding to the first failed authentication attempt.  If this
       attribute is not set or is zero (0), no delays will be used.
       <b>pwdMaxDelay </b>must also be specified if <b>pwdMinDelay </b>is set.

       Note that this implementation uses a variable lockout instead of
       delaying the bind response.

           (  1.3.6.1.4.1.42.2.27.8.1.24
              NAME 'pwdMinDelay'
              EQUALITY integerMatch
              ORDERING integerOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMaxDelay</b>

       This attribute specifies the maximum number of seconds to delay
       when responding to a failed authentication attempt.  The time
       specified in <b>pwdMinDelay </b>is used as the starting time and is then
       doubled on each failure until the delay time is greater than or
       equal to <b>pwdMaxDelay </b>(or a successful authentication occurs,
       which resets the failure counter).  <b>pwdMinDelay </b>must also be
       specified if <b>pwdMaxDelay </b>is set.

       Note that this implementation uses a variable lockout instead of
       delaying the bind response.

           (  1.3.6.1.4.1.42.2.27.8.1.25
              NAME 'pwdMaxDelay'
              EQUALITY integerMatch
              ORDERING integerOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdMaxIdle</b>

       This attribute specifies the number of seconds an account may
       remain unused before it becomes locked.  If this attribute is not
       set or is zero (0), no check is performed. For this to be
       enforced, <b>lastbind </b>functionality needs to be enabled on the
       database, that is <b>olcLastBind </b>is set to <b>TRUE</b>.

           (  1.3.6.1.4.1.42.2.27.8.1.26
              NAME 'pwdMaxIdle'
              EQUALITY integerMatch
              ORDERING integerOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
              SINGLE-VALUE )

       <b>pwdUseCheckModule</b>/<b>pwdCheckModuleArg</b>

       The <b>pwdUseCheckModule </b>attribute enables use of a loadable module
       previously configured with <b>ppolicy_check_module </b>for the current
       policy. The module must instantiate the check_password()
       function.  This function will be called to further check a new
       password if <b>pwdCheckQuality </b>is set to one (1) or two (2), after
       all of the built-in password compliance checks have been passed.
       This function will be called according to this function
       prototype:
           int <i>check_password</i> (char *pPasswd, struct berval *pErrmsg,
           Entry *pEntry, struct berval *pArg);
       The <b>pPasswd </b>parameter contains the clear-text user password, the
       <b>pErrmsg </b>parameter points to a <b>struct berval </b>containing space to
       return human-readable details about any error it encounters.  The
       <b>bv_len </b>field must contain the size of the space provided by the
       <b>bv_val </b>field.

       The <b>pEntry </b>parameter is optional, if non-NULL, carries a pointer
       to the entry whose password is being checked.

       The optional <b>pArg </b>parameter points to a <b>struct berval </b>containing
       the value of <b>pwdCheckModuleArg </b>in the effective password policy,
       if set, otherwise NULL.

       If <b>pErrmsg </b>is NULL, then <i>funcName</i> must NOT attempt to use it.  A
       return value of LDAP_SUCCESS from the called function indicates
       that the password is ok, any other value indicates that the
       password is unacceptable.  If the password is unacceptable, the
       server will return an error to the client, and <b>pErrmsg </b>may be
       used to return a human-readable textual explanation of the error.
       If the space passed in by the caller is too small, the function
       may replace it with a dynamically allocated buffer, which will be
       free()'d by slapd.

       The <b>pwdCheckModule </b>attribute is now obsolete and is ignored.

           (  1.3.6.1.4.1.4754.1.99.1
              NAME 'pwdCheckModule'
              EQUALITY caseExactIA5Match
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.26
              OBSOLETE
              SINGLE-VALUE )

           ( 1.3.6.1.4.1.4754.1.99.2
              NAME 'pwdCheckModuleArg'
              EQUALITY octetStringMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
              DESC 'Argument to pass to check_password() function'
              SINGLE-VALUE )

           (  1.3.6.1.4.1.4754.1.99.3
              NAME 'pwdUseCheckModule'
              EQUALITY booleanMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
              SINGLE-VALUE )
</pre> <h2>
OPERATIONAL ATTRIBUTES </h2>
<pre>
       The operational attributes used by the <b>ppolicy </b>module are stored
       in the user's entry.  Most of these attributes are not intended
       to be changed directly by users; they are there to track user
       activity.  They have been detailed here so that administrators
       and users can both understand the workings of the <b>ppolicy </b>module.

       Note that the current IETF Password Policy proposal does not
       define how these operational attributes are expected to behave in
       a replication environment. In general, authentication attempts on
       a replica server only affect the copy of the operational
       attributes on that replica and will not affect any attributes for
       a user's entry on the provider. Operational attribute changes
       resulting from authentication attempts on a provider will usually
       replicate to the replicas (and also overwrite any changes that
       originated on the replica).  These behaviors are not guaranteed
       and are subject to change when a formal specification emerges.

       <b>userPassword</b>

       The <b>userPassword </b>attribute is not strictly part of the <b>ppolicy</b>
       module.  It is, however, the attribute that is tracked and
       controlled by the module.  Please refer to the standard OpenLDAP
       schema for its definition.

       <b>pwdPolicySubentry</b>

       This attribute refers directly to the <b>pwdPolicy </b>subentry that is
       to be used for this particular directory user.  Every account
       that should be subject to password policy control will have a
       <b>pwdPolicySubentry </b>attribute containing the DN of a <b>pwdPolicy</b>
       entry. The module will use the one stored in the DB if it exists,
       otherwise it will attempt to derive the correct policy to apply
       based on the rules it has been configured with, see
       <b>ppolicy_rules</b>/<b>olcPPolicyScopedRule</b>/<b>olcPPolicyRegexRule</b>
       configuration options. In this way different users may be managed
       according to configurable policies. The value of the effective
       policy DN will be returned if requested in a search request but
       this is a virtual attribute and is <b>not </b>usable in a filter.
       Modifying/adding this attribute directly is <b>deprecated </b>and the
       ability to do so will be removed in a future release.

           (  1.3.6.1.4.1.42.2.27.8.1.23
              NAME 'pwdPolicySubentry'
              DESC 'The pwdPolicy subentry in effect for
                  this object'
              EQUALITY distinguishedNameMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.12
              SINGLE-VALUE
              USAGE directoryOperation)

       <b>pwdChangedTime</b>

       This attribute denotes the last time that the entry's password
       was changed.  This value is used by the password expiration
       policy to determine whether the password is too old to be allowed
       to be used for user authentication.  If <b>pwdChangedTime </b>does not
       exist, the user's password will not expire.

           (  1.3.6.1.4.1.42.2.27.8.1.16
              NAME 'pwdChangedTime'
              DESC 'The time the password was last changed'
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              EQUALITY generalizedTimeMatch
              ORDERING generalizedTimeOrderingMatch
              SINGLE-VALUE
              NO-USER-MODIFICATION
              USAGE directoryOperation)

       <b>pwdAccountLockedTime</b>

       This attribute contains the time that the user's account was
       locked.  If the account has been locked, the password may no
       longer be used to authenticate the user to the directory.  If
       <b>pwdAccountLockedTime </b>is set to 000001010000Z, the user's account
       has been permanently locked and may only be unlocked by an
       administrator. Note that account locking only takes effect when
       the <b>pwdLockout </b>password policy attribute is set to "TRUE".

           (  1.3.6.1.4.1.42.2.27.8.1.17
              NAME 'pwdAccountLockedTime'
              DESC 'The time an user account was locked'
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              EQUALITY generalizedTimeMatch
              ORDERING generalizedTimeOrderingMatch
              SINGLE-VALUE
              USAGE directoryOperation)

       <b>pwdFailureTime</b>

       This attribute contains the timestamps of each of the consecutive
       authentication failures made upon attempted authentication to
       this DN (i.e. account).  If too many timestamps accumulate here
       (refer to the <b>pwdMaxFailure </b>password policy attribute for
       details), and the <b>pwdLockout </b>password policy attribute is set to
       "TRUE", the account may be locked.  (Please also refer to the
       <b>pwdLockout </b>password policy attribute.)  Excess timestamps beyond
       those allowed by <b>pwdMaxFailure </b>or <b>pwdMaxRecordedFailure </b>may also
       be purged.  If a successful authentication is made to this DN
       (i.e. to this user account), then <b>pwdFailureTime </b>will be cleansed
       of entries.

           (  1.3.6.1.4.1.42.2.27.8.1.19
              NAME 'pwdFailureTime'
              DESC 'The timestamps of the last consecutive
                  authentication failures'
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              EQUALITY generalizedTimeMatch
              ORDERING generalizedTimeOrderingMatch
              NO-USER-MODIFICATION
              USAGE directoryOperation )

       <b>pwdHistory</b>

       This attribute contains the history of previously used passwords
       for this DN (i.e. for this user account).  The values of this
       attribute are stored in string format as follows:

           pwdHistory=
               time "#" syntaxOID "#" length "#" data

           time=
               GeneralizedTime as specified in section 3.3.13 of
               [RFC4517]

           syntaxOID = numericoid
               This is the string representation of the dotted-decimal
               OID that defines the syntax used to store the password.
               numericoid is described in section 1.4 of [RFC4512].

           length = NumericString
               The number of octets in the data.  NumericString is
               described in section 3.3.23 of [RFC4517].

           data =
               Octets representing the password in the format specified
               by syntaxOID.

       This format allows the server to store and transmit a history of
       passwords that have been used.  In order for equality matching on
       the values in this attribute to function properly, the time field
       is in GMT format.

           (  1.3.6.1.4.1.42.2.27.8.1.20
              NAME 'pwdHistory'
              DESC 'The history of user passwords'
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
              EQUALITY octetStringMatch
              NO-USER-MODIFICATION
              USAGE directoryOperation)

       <b>pwdGraceUseTime</b>

       This attribute contains the list of timestamps of logins made
       after the user password in the DN has expired.  These post-
       expiration logins are known as "<i>grace logins</i>".  If too many <i>grace</i>
       <i>logins</i> have been used (please refer to the <b>pwdGraceAuthnLimit</b>
       password policy attribute), then the DN will no longer be allowed
       to be used to authenticate the user to the directory until the
       administrator changes the DN's <b>userPassword </b>attribute.

           (  1.3.6.1.4.1.42.2.27.8.1.21
              NAME 'pwdGraceUseTime'
              DESC 'The timestamps of the grace login once the password
           has expired'
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              EQUALITY generalizedTimeMatch
              NO-USER-MODIFICATION
              USAGE directoryOperation)

       <b>pwdReset</b>

       This attribute indicates whether the user's password has been
       reset by the administrator and thus must be changed upon first
       use of this DN for authentication to the directory.  If <b>pwdReset</b>
       is set to "TRUE", then the password was reset and the user must
       change it upon first authentication.  If the attribute does not
       exist, or is set to "FALSE", the user need not change their
       password due to administrative reset.

           (  1.3.6.1.4.1.42.2.27.8.1.22
              NAME 'pwdReset'
              DESC 'The indication that the password has
                  been reset'
              EQUALITY booleanMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
              SINGLE-VALUE
              USAGE directoryOperation)

       <b>pwdStartTime</b>

       This attribute specifies the time the entry's password becomes
       valid for authentication.  Authentication attempts made before
       this time will fail.  If this attribute does not exist, then no
       restriction applies.

           (  1.3.6.1.4.1.42.2.27.8.1.27
              NAME 'pwdStartTime'
              DESC 'The time the password becomes enabled'
              EQUALITY generalizedTimeMatch
              ORDERING generalizedTimeOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              SINGLE-VALUE
              USAGE directoryOperation )

       <b>pwdEndTime</b>

       This attribute specifies the time the entry's password becomes
       invalid for authentication.  Authentication attempts made after
       this time will fail, regardless of expiration or grace settings.
       If this attribute does not exist, then this restriction does not
       apply.

           (  1.3.6.1.4.1.42.2.27.8.1.28
              NAME 'pwdEndTime'
              DESC 'The time the password becomes disabled'
              EQUALITY generalizedTimeMatch
              ORDERING generalizedTimeOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              SINGLE-VALUE
              USAGE directoryOperation )

       Note that pwdStartTime may be set to a time greater than or equal
       to pwdEndTime; this simply disables the account.

       <b>pwdAccountTmpLockoutEnd</b>

       This attribute that the user's password has been locked out
       temporarily according to the <b>pwdMinDelay </b>policy option and when
       the lockout ends.

           (  1.3.6.1.4.1.42.2.27.8.1.33
              NAME 'pwdAccountTmpLockoutEnd'
              DESC 'Temporary lockout end'
              EQUALITY generalizedTimeMatch
              ORDERING generalizedTimeOrderingMatch
              SYNTAX 1.3.6.1.4.1.1466.115.121.1.24
              SINGLE-VALUE
              NO-USER-MODIFICATION
              USAGE directoryOperation )
</pre> <h2>
SUNDS ACCOUNT USABILITY CONTROL </h2>
<pre>
       If the SunDS Account Usability control is used with a search
       request, the overlay will attach validity information to each
       entry provided all of the following are met:

       • There is a password policy that applies to the entry

       • The user has <b>compare </b>access to the entry's password attribute.

       • The configured password attribute is present in the entry
</pre> <h2>
EXAMPLES </h2>
<pre>
              database mdb
              suffix dc=example,dc=com
              ...
              overlay ppolicy
              ppolicy_default "cn=Standard,ou=Policies,dc=example,dc=com"
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man3/ldap.3.html">ldap(3)</a>, <a href="slapd.conf.5.html">slapd.conf(5)</a>, <a href="slapd-config.5.html">slapd-config(5)</a>, <a href="slapo-chain.5.html">slapo-chain(5)</a>.

       "OpenLDAP Administrator's Guide"
       (<a href="http://www.OpenLDAP.org/doc/admin/">http://www.OpenLDAP.org/doc/admin/</a>)

       IETF LDAP password policy proposal by P. Behera, L.  Poitou and
       J.  Sermersheim:  documented in IETF document "draft-behera-ldap-
       password-policy-10.txt".
</pre> <h2>
BUGS </h2>
<pre>
       The LDAP Password Policy specification is not yet an approved
       standard, and it is still evolving. This code will continue to be
       in flux until the specification is finalized.
</pre> <h2>
ACKNOWLEDGEMENTS </h2>
<pre>
       This module was written in 2004 by Howard Chu of Symas
       Corporation with significant input from Neil Dunbar and Kartik
       Subbarao of Hewlett-Packard.

       This manual page borrows heavily and shamelessly from the
       specification upon which the password policy module it describes
       is based.  This source is the IETF LDAP password policy proposal
       by P. Behera, L.  Poitou and J. Sermersheim.  The proposal is
       fully documented in the IETF document named draft-behera-ldap-
       password-policy-10.txt, written in August of 2009.

       <b>OpenLDAP Software </b>is developed and maintained by The OpenLDAP
       Project &lt;<a href="http://www.openldap.org/">http://www.openldap.org/</a>&gt;.  <b>OpenLDAP Software </b>is derived
       from the University of Michigan LDAP 3.3 Release.
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>OpenLDAP</i> (an open source implementation
       of the Lightweight Directory Access Protocol) project.
       Information about the project can be found at 
       ⟨<a href="http://www.openldap.org/">http://www.openldap.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="http://www.openldap.org/its/">http://www.openldap.org/its/</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://git.openldap.org/openldap/openldap.git">https://git.openldap.org/openldap/openldap.git</a>⟩ on 2024-06-14.
       (At that time, the date of the most recent commit that was found
       in the repository was 2024-06-13.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">OpenLDAP LDVERSION             RELEASEDATE              <i>SLAPO_PPOLICY</i>(5)</span>
</pre>  <p>Pages that refer to this page: <a href="slapd.overlays.5.html">slapd.overlays(5)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man5/slapo-ppolicy.5.html" class="_attribution-link">https://man7.org/linux/man-pages/man5/slapo-ppolicy.5.html</a>
  </p>
</div>
