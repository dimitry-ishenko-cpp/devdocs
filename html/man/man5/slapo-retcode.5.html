<h1>slapo-retcode(5) — Linux manual page</h1>   <pre>
<span class="headline"><i>SLAPO-RETCODE</i>(5)           File Formats Manual          <i>SLAPO-RETCODE</i>(5)</span>
</pre> <h2>
NAME </h2>
<pre>
       slapo-retcode - return code overlay to slapd
</pre> <h2>
SYNOPSIS </h2>
<pre>
       ETCDIR/slapd.conf
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>retcode </b>overlay to <a href="../man8/slapd.8.html">slapd(8)</a> is useful to test the behavior of
       clients when server-generated erroneous and/or unusual responses
       occur, e.g. error codes, referrals, excessive response times and
       so on.

       The error responses are generated according to different
       strategies.

       In the first case, all operations targeted at a specific
       configurable subtree cause the object related to the request DN
       to be looked up and checked for return code data: a response
       code, plus an optional textual message, an optional configurable
       delay, an optional matched DN field, and, when the response code
       is "referral", a (list of) referral(s).

       Well-known response codes from standard track documents are
       provided in <b>retcode.conf</b>, which can be included after
       instantiating the overlay.

       In the second case, objects of classes inherited from the
       <b>errAbsObject</b>, like <b>errObject </b>or <b>errAuxObject</b>, when returned as
       intermediate responses of a search request, are changed into the
       response dictated by their content.

       A third mode causes objects to be looked up from the underlying
       database to discover if their class inherits from <b>errABsObject</b>;
       in that case, their content is used to compute the corresponding
       response.

       The behavior is disabled by using the <b>manageDSAit </b>control (RFC
       3296); in that case, the resulting object, either present in the
       directory or dynamically generated by the overlay, or contained
       in the request, is handled as usual.

       The config directives that are specific to the <b>retcode </b>overlay
       must be prefixed by <b>retcode-</b>, to avoid conflicts with directives
       specific to the underlying database or to other stacked overlays.
       The following specific directives can be used to configure the
       retcode overlay:

       <b>retcode-parent &lt;DN&gt;</b>
              This directive defines the parent DN where dynamically
              generated entries reside.  If not defined, the suffix of
              the database is used.

       <b>retcode-item &lt;RDN&gt; &lt;errCode&gt; [op=&lt;oplist&gt;] [text=&lt;message&gt;]</b>
              <b>[ref=&lt;referral&gt;] [sleeptime=&lt;sec&gt;] [matched=&lt;DN&gt;]</b>
              <b>[unsolicited=&lt;OID&gt;[:&lt;data&gt;]]</b>
              <b>[flags=[pre|post-]disconnect[,...]]</b>
              A dynamically generated entry, located below
              <b>retcode-parent</b>.  The <b>errCode </b>is the number of the response
              code; it can be in any format supported by <a href="../man3/strtol.3.html">strtol(3)</a>.  The
              optional <b>oplist </b>is a list of operations that cause
              response code generation; if absent, all operations are
              affected.  The <b>matched </b>field is the matched DN that is
              returned along with the error, while the <b>text </b>field is an
              optional diagnostics message.  The <b>ref </b>field is only
              allowed for the <b>referral </b>response code.  The <b>sleeptime</b>
              field causes <a href="../man8/slapd.8.html">slapd(8)</a> to sleep the specified number of
              seconds before proceeding with the operation.  The
              <b>unsolicited </b>field can be used to cause the return of an
              RFC 4511 unsolicited response message; if <b>OID </b>is not "0",
              an extended response is generated, with the optional <b>data</b>
              appended.  If <b>flags </b>contains <b>disconnect</b>, or
              <b>pre-disconnect</b>, <a href="../man8/slapd.8.html">slapd(8)</a> disconnects abruptly, without
              notice; <b>post-disconnect </b>causes disconnection right after
              sending response as appropriate.

       <b>retcode-indir</b>
              Enables exploitation of in-directory stored errAbsObject.
              May result in a lot of unnecessary overhead.

       <b>retcode-sleep [-]&lt;n&gt;</b>
              Defines a sleep time in seconds that is spent before
              actually handling any operation.  If negative, a random
              time between 0 and the absolute value of the argument is
              used.
</pre> <h2>
SCHEMA </h2>
<pre>
       The <b>retcode </b>overlay utilizes the "return code" schema described
       herein.  This schema is specifically designed for use with this
       overlay and is not intended to be used otherwise.  It is also
       noted that the schema described here is <i>a work in progress</i>, and
       hence subject to change without notice.  The schema is loaded
       automatically by the overlay.

       The schema includes a number of object classes and associated
       attribute types as described below.

       The error code:
           (  1.3.6.1.4.1.4203.666.11.4.1.1
               NAME ( 'errCode' )
               DESC 'LDAP error code'
               EQUALITY integerMatch
               ORDERING integerOrderingMatch
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
               SINGLE-VALUE )

       The operations that trigger the response code:
           ( 1.3.6.1.4.1.4203.666.11.4.1.2
               NAME ( 'errOp' )
               DESC 'Operations the errObject applies to'
               EQUALITY caseIgnoreMatch
               SUBSTR caseIgnoreSubstringsMatch
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.15 )

       The text message:
           ( 1.3.6.1.4.1.4203.666.11.4.1.3
               NAME ( 'errText' )
               DESC 'LDAP error textual description'
               EQUALITY caseIgnoreMatch
               SUBSTR caseIgnoreSubstringsMatch
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.15
               SINGLE-VALUE )

       The sleep time before the response is actually returned to the
       client:
           ( 1.3.6.1.4.1.4203.666.11.4.1.4
               NAME ( 'errSleepTime' )
               DESC 'Time to wait before returning the error'
               EQUALITY integerMatch
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.27
               SINGLE-VALUE )

       The matched DN returned to the client:
           ( 1.3.6.1.4.1.4203.666.11.4.1.5
               NAME ( 'errMatchedDN' )
               DESC 'Value to be returned as matched DN'
               EQUALITY distinguishedNameMatch
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.12
               SINGLE-VALUE )

       The OID to be returned as extended response OID in RFC 4511
       unsolicited responses ("0" generates a regular response with
       msgid set to 0):
           ( 1.3.6.1.4.1.4203.666.11.4.1.6
               NAME ( 'errUnsolicitedOID' )
               DESC 'OID to be returned within unsolicited response'
               EQUALITY objectIdentifierMatch
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.38
               SINGLE-VALUE )

       The octet string to be returned as extended response data in RFC
       4511 unsolicited response:
           ( 1.3.6.1.4.1.4203.666.11.4.1.7
               NAME ( 'errUnsolicitedData' )
               DESC 'Data to be returned within unsolicited response'
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.40
               SINGLE-VALUE )

       If TRUE, <a href="../man8/slapd.8.html">slapd(8)</a> disconnects abruptly without notice; if FALSE,
       it disconnects after sending response as appropriate:
           ( 1.3.6.1.4.1.4203.666.11.4.1.8
               NAME ( 'errDisconnect' )
               DESC 'Disconnect without notice'
               SYNTAX 1.3.6.1.4.1.1466.115.121.1.7
               SINGLE-VALUE )

       The abstract class that triggers the overlay:
           ( 1.3.6.1.4.1.4203.666.11.4.3.0
               NAME ( 'errAbsObject' )
               SUP top ABSTRACT
               MUST ( errCode )
               MAY ( cn $ description $ errOp $ errText $ errSleepTime
                   $ errMatchedDN ) )

       The standalone structural objectclass for specifically created
       data:
           ( 1.3.6.1.4.1.4203.666.11.4.3.1
               NAME ( 'errObject' )
               SUP errAbsObject STRUCTURAL )

       The auxiliary objectclass to alter the behavior of existing
       objects:
           ( 1.3.6.1.4.1.4203.666.11.4.3.2
               NAME ( 'errAuxObject' )
               SUP errAbsObject AUXILIARY )
</pre> <h2>
EXAMPLE </h2>
<pre>
              overlay         retcode
              retcode-parent  "ou=RetCodes,dc=example,dc=com"

              # retcode.conf is found in tests/data/ of the source tree
              include         ./retcode.conf

              # Wait 10 seconds, then return success (0x00)
              retcode-item    "cn=Success after 10 seconds" 0x00 sleeptime=10
              # Wait 10 seconds, then return timelimitExceeded (0x03)
              retcode-item    "cn=Timelimit after 10 seconds" 0x03 sleeptime=10
</pre> <h2>
FILES </h2>
<pre>
       ETCDIR/slapd.conf
              default slapd configuration file
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="slapd.conf.5.html">slapd.conf(5)</a>, <a href="slapd-config.5.html">slapd-config(5)</a>, <a href="../man8/slapd.8.html">slapd(8)</a>.  The <a href="slapo-retcode.5.html">slapo-retcode(5)</a>
       overlay supports dynamic configuration via <b>back-config</b>.
</pre> <h2>
ACKNOWLEDGEMENTS </h2>
<pre>
       This module was written in 2005 by Pierangelo Masarati for SysNet
       s.n.c.
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>OpenLDAP</i> (an open source implementation
       of the Lightweight Directory Access Protocol) project.
       Information about the project can be found at 
       ⟨<a href="http://www.openldap.org/">http://www.openldap.org/</a>⟩.  If you have a bug report for this
       manual page, see ⟨<a href="http://www.openldap.org/its/">http://www.openldap.org/its/</a>⟩.  This page was
       obtained from the project's upstream Git repository
       ⟨<a href="https://git.openldap.org/openldap/openldap.git">https://git.openldap.org/openldap/openldap.git</a>⟩ on 2024-06-14.
       (At that time, the date of the most recent commit that was found
       in the repository was 2024-06-13.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">OpenLDAP LDVERSION             RELEASEDATE              <i>SLAPO-RETCODE</i>(5)</span>
</pre>  <p>Pages that refer to this page: <a href="slapd.overlays.5.html">slapd.overlays(5)</a>, <a href="slapo-retcode.5.html">slapo-retcode(5)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man5/slapo-retcode.5.html" class="_attribution-link">https://man7.org/linux/man-pages/man5/slapo-retcode.5.html</a>
  </p>
</div>
