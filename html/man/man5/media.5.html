<h1>selabel_media(5) — Linux manual page</h1>   <pre>
<span class="headline"><i>selabel_media</i>(5)        SELinux API documentation       <i>selabel_media</i>(5)</span>
</pre> <h2>
NAME </h2>
<pre>
       selabel_media - userspace SELinux labeling interface and
       configuration file format for the media contexts backend
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>#include &lt;selinux/label.h&gt;</b>

       <b>int selabel_lookup(struct selabel_handle *</b><i>hnd</i><b>,</b>
                          <b>char **</b><i>context</i><b>,</b>
                          <b>const char *</b><i>device_name</i><b>, int </b><i>unused</i><b>);</b>

       <b>int selabel_lookup_raw(struct selabel_handle *</b><i>hnd</i><b>,</b>
                          <b>char **</b><i>context</i><b>,</b>
                          <b>const char *</b><i>device_name</i><b>, int </b><i>unused</i><b>);</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The media contexts backend maps from media device names such as
       "cdrom" or "floppy" into security contexts. It is used to find
       the appropriate context for establishing context mounts on these
       devices. The returned <i>context</i> must be freed using <a href="../man3/freecon.3.html">freecon(3)</a>.
       <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> describes the function with its return and
       error codes.

       The integer lookup argument is currently unused and should be set
       to zero.

       Any messages generated by <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a> are sent to <i>stderr</i> by
       default, although this can be changed by <a href="../man3/selinux_set_callback.3.html">selinux_set_callback(3)</a>.

       <a href="../man3/selabel_lookup_raw.3.html">selabel_lookup_raw(3)</a> behaves identically to <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a>
       but does not perform context translation.

       The <b>FILES </b>section details the configuration files used to
       determine the media context.
</pre> <h2>
OPTIONS </h2>
<pre>
       In addition to the global options described in <a href="../man3/selabel_open.3.html">selabel_open(3)</a>,
       this backend recognizes the following options:

       <b>SELABEL_OPT_PATH</b>
              A non-null value for this option specifies a path to a
              file that will be opened in lieu of the standard <i>media</i>
              contexts file.
</pre> <h2>
FILES </h2>
<pre>
       The media context file used to retrieve a default context depends
       on the <b>SELABEL_OPT_PATH </b>parameter passed to <b>selabel_open(3). If</b>
       <i>NULL</i>, then the <b>SELABEL_OPT_PATH </b>value will default to the active
       policy media contexts location (as returned by
       <a href="../man3/selinux_media_context_path.3.html">selinux_media_context_path(3)</a>), otherwise the actual
       <b>SELABEL_OPT_PATH </b>value specified is used.

       The default media contexts file is:
              <i>/etc/selinux/{SELINUXTYPE}/contexts/files/media</i>

       Where <i>{SELINUXTYPE}</i> is the entry from the selinux configuration
       file <i>config</i> (see <a href="selinux_config.5.html">selinux_config(5)</a>).
</pre> <h2>
FILE FORMAT </h2>
<pre>
       Each line within the <i>media</i> file is as follows:
              <i>device_name context</i>

       Where:
              <i>device_name</i>
                     The media identifier (e.g. cdrom, floppy, disk and
                     usb).
              <i>context</i>
                     The context to be used for labeling the device.

       Example:
              # contexts/files/media
              cdrom system_u:object_r:removable_device_t
              floppy system_u:object_r:removable_device_t
              disk system_u:object_r:fixed_disk_device_t
</pre> <h2>
NOTES </h2>
<pre>
       If contexts are to be validated, then the global option
       <b>SELABEL_OPT_VALIDATE </b>must be set before calling <a href="../man3/selabel_open.3.html">selabel_open(3)</a>.
       If this is not set, then it is possible for an invalid context to
       be returned.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man8/selinux.8.html">selinux(8)</a>, <a href="../man3/selabel_open.3.html">selabel_open(3)</a>, <a href="../man3/selabel_lookup.3.html">selabel_lookup(3)</a>, <a href="../man3/selabel_stats.3.html">selabel_stats(3)</a>,
       <a href="../man3/selabel_close.3.html">selabel_close(3)</a>, <a href="../man3/selinux_set_callback.3.html">selinux_set_callback(3)</a>,
       <a href="../man3/selinux_media_context_path.3.html">selinux_media_context_path(3)</a>, <a href="../man3/freecon.3.html">freecon(3)</a>, <a href="selinux_config.5.html">selinux_config(5)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Security Enhanced Linux        29 Nov 2011              <i>selabel_media</i>(5)</span>
</pre>  <p>Pages that refer to this page: <a href="../man3/selabel_open.3.html">selabel_open(3)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man5/media.5.html" class="_attribution-link">https://man7.org/linux/man-pages/man5/media.5.html</a>
  </p>
</div>
