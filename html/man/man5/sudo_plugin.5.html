<h1>sudo_plugin(5) — Linux manual page</h1>   <pre>
<span class="headline"><i>SUDO_PLUGIN</i>(5)             File Formats Manual            <i>SUDO_PLUGIN</i>(5)</span>
</pre> <h2>
NAME </h2>
<pre>
       <b>sudo_plugin </b>— Sudo Plugin API
</pre> <h2>
DESCRIPTION </h2>
<pre>
       Starting with version 1.8, <b>sudo </b>supports a plugin API for policy
       and session logging.  Plugins may be compiled as dynamic shared
       objects (the default on systems that support them) or compiled
       statically into the <b>sudo </b>binary itself.  By default, the <b>sudoers</b>
       plugin provides audit, security policy and I/O logging
       capabilities.  Via the plugin API, <b>sudo </b>can be configured to use
       alternate plugins provided by third parties.  The plugins to be
       used are specified in the <i>sudo.conf</i>(5) file.

       The API is versioned with a major and minor number.  The minor
       version number is incremented when additions are made.  The major
       number is incremented when incompatible changes are made.  A
       plugin should be check the version passed to it and make sure
       that the major version matches.

       The plugin API is defined by the &lt;<i>sudo_plugin.h</i>&gt; header file.

   <b>Policy plugin API</b>
       A policy plugin must declare and populate a <i>struct policy_plugin</i>
       in the global scope.  This structure contains pointers to the
       functions that implement the <b>sudo </b>policy checks.  The name of the
       symbol should be specified in <i>sudo.conf</i>(5) along with a path to
       the plugin so that <b>sudo </b>can load it.

       struct policy_plugin {
       #define SUDO_POLICY_PLUGIN     1
           unsigned int type; /* always SUDO_POLICY_PLUGIN */
           unsigned int version; /* always SUDO_API_VERSION */
           int (*open)(unsigned int version, sudo_conv_t conversation,
               sudo_printf_t sudo_plugin_printf, char * const settings[],
               char * const user_info[], char * const user_env[],
               char * const plugin_options[], const char **errstr);
           void (*close)(int exit_status, int error);
           int (*show_version)(int verbose);
           int (*check_policy)(int argc, char * const argv[],
               char *env_add[], char **command_info[],
               char **argv_out[], char **user_env_out[], const char **errstr);
           int (*list)(int argc, char * const argv[], int verbose,
               const char *user, const char **errstr);
           int (*validate)(const char **errstr);
           void (*invalidate)(int rmcred);
           int (*init_session)(struct passwd *pwd, char **user_env[],
               const char **errstr);
           void (*register_hooks)(int version,
              int (*register_hook)(struct sudo_hook *hook));
           void (*deregister_hooks)(int version,
              int (*deregister_hook)(struct sudo_hook *hook));
           struct sudo_plugin_event * (*event_alloc)(void);
       };

       A <i>struct policy_plugin</i> has the following fields:

       <i>type</i>  The <i>type</i> field should always be set to SUDO_POLICY_PLUGIN.

       <i>version</i>
             The <i>version</i> field should be set to SUDO_API_VERSION.

             This allows <b>sudo </b>to determine the API version the plugin
             was built against.

       <i>open</i>
             int (*open)(unsigned int version, sudo_conv_t conversation,
                 sudo_printf_t sudo_plugin_printf, char * const settings[],
                 char * const user_info[], char * const user_env[],
                 char * const plugin_options[], const char **errstr);

             Returns 1 on success, 0 on failure, -1 if a general error
             occurred, or -2 if there was a usage error.  In the latter
             case, <b>sudo </b>will print a usage message before it exits.  If
             an error occurs, the plugin may optionally call the
             <b>conversation</b>() or <b>sudo_plugin_printf</b>() function with
             SUDO_CONF_ERROR_MSG to present additional error information
             to the user.

             The function arguments are as follows:

             <i>version</i>
                   The version passed in by <b>sudo </b>allows the plugin to
                   determine the major and minor version number of the
                   plugin API supported by <b>sudo</b>.

             <i>conversation</i>
                   A pointer to the <b>conversation</b>() function that can be
                   used by the plugin to interact with the user (see
                   “Conversation API” for details).  Returns 0 on
                   success and -1 on failure.

             <i>sudo_plugin_printf</i>
                   A pointer to a <b>printf</b>()-style function that may be
                   used to display informational or error messages (see
                   “Conversation API” for details).  Returns the number
                   of characters printed on success and -1 on failure.

             <i>settings</i>
                   A vector of user-supplied <b>sudo </b>settings in the form
                   of “name=value” strings.  The vector is terminated by
                   a NULL pointer.  These settings correspond to options
                   the user specified when running <b>sudo</b>.  As such, they
                   will only be present when the corresponding option
                   has been specified on the command line.

                   When parsing <i>settings</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   The following values may be set by <b>sudo</b>:

                   bsdauth_type=string
                         Authentication type, if specified by the <b>-a</b>
                         option, to use on systems where BSD
                         authentication is supported.

                   closefrom=number
                         If specified, the user has requested via the <b>-C</b>
                         option that <b>sudo </b>close all files descriptors
                         with a value of <i>number</i> or higher.  The plugin
                         may optionally pass this, or another value,
                         back in the <i>command_info</i> list.

                   cmnd_chroot=string
                         The root directory (see <i>chroot</i>(2)) to run the
                         command in, as specified by the user via the <b>-R</b>
                         option.  The plugin may ignore or restrict the
                         user's ability to specify a new root directory.
                         Only available starting with API version 1.16.

                   cmnd_cwd=string
                         The working directory to run the command in, as
                         specified by the user via the <b>-D </b>option.  The
                         plugin may ignore or restrict the user's
                         ability to specify a new working directory.
                         Only available starting with API version 1.16.

                   debug_flags=string
                         A debug file path name followed by a space and
                         a comma-separated list of debug flags that
                         correspond to the plugin's <i>Debug</i> entry in
                         <i>sudo.conf</i>(5), if there is one.  The flags are
                         passed to the plugin exactly as they appear in
                         <i>sudo.conf</i>(5).  The syntax used by <b>sudo </b>and the
                         <b>sudoers </b>plugin is <i>subsystem</i>@<i>priority</i> but a
                         plugin is free to use a different format so
                         long as it does not include a comma (‘,’).
                         Prior to <b>sudo </b>1.8.12, there was no way to
                         specify plugin-specific <i>debug_flags</i> so the
                         value was always the same as that used by the
                         <b>sudo </b>front-end and did not include a path name,
                         only the flags themselves.  As of version 1.7
                         of the plugin interface, <b>sudo </b>will only pass
                         <i>debug_flags</i> if <i>sudo.conf</i>(5) contains a plugin-
                         specific <i>Debug</i> entry.

                   ignore_ticket=bool
                         Set to true if the user specified the <b>-k </b>option
                         along with a command, indicating that the user
                         wishes to ignore any cached authentication
                         credentials.  <i>implied_shell</i> to true.  This
                         allows <b>sudo </b>with no arguments to be used
                         similarly to <i>su</i>(1).  If the plugin does not to
                         support this usage, it may return a value of -2
                         from the <b>check_policy</b>() function, which will
                         cause <b>sudo </b>to print a usage message and exit.

                   implied_shell=bool
                         If the user does not specify a program on the
                         command line, <b>sudo </b>will pass the plugin the
                         path to the user's shell and set <i>implied_shell</i>.

                   intercept_ptrace=bool
                         Indicates whether or not the system supports
                         intercept mode using <i>ptrace</i>(2).  This is
                         currently only true for Linux systems that
                         support <i>seccomp</i>(2) filtering and the “trap”
                         action.  Other systems will use a dynamic
                         shared object to implement intercept.  Only
                         available starting with API version 1.19.

                   intercept_setid=bool
                         Indicates whether or not the system supports
                         running set-user-ID and set-group-ID binaries
                         in intercept mode.  This is currently only true
                         for Linux systems that support <i>seccomp</i>(2)
                         filtering and the “trap” action.  On systems
                         that use a dynamic shared object to implement
                         intercept, the dynamic linker (ld.so or the
                         equivalent) will disable preloading of shared
                         objects when executing a set-user-ID or set-
                         group-ID binary.  This will disable intercept
                         mode for that program and any other programs
                         that it executes.  The policy plugin may refuse
                         to execute a set-user-ID or set-group-ID binary
                         in intercept mode to avoid this.  Only
                         available starting with API version 1.19.

                   login_class=string
                         BSD login class to use when setting resource
                         limits and nice value, if specified by the <b>-c</b>
                         option.

                   login_shell=bool
                         Set to true if the user specified the <b>-i</b>
                         option, indicating that the user wishes to run
                         a login shell.

                   max_groups=int
                         The maximum number of groups a user may belong
                         to.  This will only be present if there is a
                         corresponding setting in <i>sudo.conf</i>(5).

                   network_addrs=list
                         A space-separated list of IP network addresses
                         and netmasks in the form “addr/netmask”, e.g.,
                         “192.168.1.2/255.255.255.0”.  The address and
                         netmask pairs may be either IPv4 or IPv6,
                         depending on what the operating system
                         supports.  If the address contains a colon
                         (‘:’), it is an IPv6 address, else it is IPv4.

                   noninteractive=bool
                         Set to true if the user specified the <b>-n</b>
                         option, indicating that <b>sudo </b>should operate in
                         non-interactive mode.  The plugin may reject a
                         command run in non-interactive mode if user
                         interaction is required.

                   plugin_dir=string
                         The default plugin directory used by the <b>sudo</b>
                         front-end.  This is the default directory set
                         at compile time and may not correspond to the
                         directory the running plugin was loaded from.
                         It may be used by a plugin to locate support
                         files.

                   plugin_path=string
                         The path name of plugin loaded by the <b>sudo</b>
                         front-end.  The path name will be a fully-
                         qualified unless the plugin was statically
                         compiled into <b>sudo</b>.

                   preserve_environment=bool
                         Set to true if the user specified the <b>-E</b>
                         option, indicating that the user wishes to
                         preserve the environment.

                   preserve_groups=bool
                         Set to true if the user specified the <b>-P</b>
                         option, indicating that the user wishes to
                         preserve the group vector instead of setting it
                         based on the runas user.

                   progname=string
                         The command name that sudo was run as,
                         typically “sudo” or “sudoedit”.

                   prompt=string
                         The prompt to use when requesting a password,
                         if specified via the <b>-p </b>option.

                   remote_host=string
                         The name of the remote host to run the command
                         on, if specified via the <b>-h </b>option.  Support
                         for running the command on a remote host is
                         meant to be implemented via a helper program
                         that is executed in place of the user-specified
                         command.  The <b>sudo </b>front-end is only capable of
                         executing commands on the local host.  Only
                         available starting with API version 1.4.

                   run_shell=bool
                         Set to true if the user specified the <b>-s</b>
                         option, indicating that the user wishes to run
                         a shell.

                   runas_group=string
                         The group name or group-ID to run the command
                         as, if specified via the <b>-g </b>option.

                   runas_user=string
                         The user name or user-ID to run the command as,
                         if specified via the <b>-u </b>option.

                   selinux_role=string
                         SELinux role to use when executing the command,
                         if specified by the <b>-r </b>option.

                   selinux_type=string
                         SELinux type to use when executing the command,
                         if specified by the <b>-t </b>option.

                   set_home=bool
                         Set to true if the user specified the <b>-H</b>
                         option.  If true, set the HOME environment
                         variable to the target user's home directory.

                   sudoedit=bool
                         Set to true when the <b>-e </b>option is specified or
                         if invoked as <b>sudoedit</b>.  The plugin shall
                         substitute an editor into <i>argv</i> in the
                         <b>check_policy</b>() function or return -2 with a
                         usage error if the plugin does not support
                         <i>sudoedit</i>.  For more information, see the
                         <b>check_policy</b>() section.

                   timeout=string
                         Command timeout specified by the user via the
                         <b>-T </b>option.  Not all plugins support command
                         timeouts and the ability of the user to set a
                         timeout may be restricted by policy.  The
                         format of the timeout string is plugin-
                         specific.

                   update_ticket=bool
                         Set to false if the user specified the <b>-N</b>
                         option, indicating that the user wishes to
                         avoid updating any cached authentication
                         credentials.  Only available starting with API
                         version 1.20.

                   Additional settings may be added in the future so the
                   plugin should silently ignore settings that it does
                   not recognize.

             <i>user_info</i>
                   A vector of information about the user running the
                   command in the form of “name=value” strings.  The
                   vector is terminated by a NULL pointer.

                   When parsing <i>user_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   The following values may be set by <b>sudo</b>:

                   cols=int
                         The number of columns the user's terminal
                         supports.  If there is no terminal device
                         available, a default value of 80 is used.

                   cwd=string
                         The user's current working directory.

                   egid=gid_t
                         The effective group-ID of the user invoking
                         <b>sudo</b>.

                   euid=uid_t
                         The effective user-ID of the user invoking
                         <b>sudo</b>.

                   gid=gid_t
                         The real group-ID of the user invoking <b>sudo</b>.

                   groups=list
                         The user's supplementary group list formatted
                         as a string of comma-separated group-IDs.

                   host=string
                         The local machine's hostname as returned by the
                         <i>gethostname</i>(2) system call.

                   lines=int
                         The number of lines the user's terminal
                         supports.  If there is no terminal device
                         available, a default value of 24 is used.

                   pgid=int
                         The ID of the process group that the running
                         <b>sudo </b>process is a member of.  Only available
                         starting with API version 1.2.

                   pid=int
                         The process ID of the running <b>sudo </b>process.
                         Only available starting with API version 1.2.

                   ppid=int
                         The parent process ID of the running <b>sudo</b>
                         process.  Only available starting with API
                         version 1.2.

                   rlimit_as=soft,hard
                         The maximum size to which the process's address
                         space may grow (in bytes), if supported by the
                         operating system.  The soft and hard limits are
                         separated by a comma.  A value of “infinity”
                         indicates that there is no limit.  Only
                         available starting with API version 1.16.

                   rlimit_core=soft,hard
                         The largest size core dump file that may be
                         created (in bytes).  The soft and hard limits
                         are separated by a comma.  A value of
                         “infinity” indicates that there is no limit.
                         Only available starting with API version 1.16.

                   rlimit_cpu=soft,hard
                         The maximum amount of CPU time that the process
                         may use (in seconds).  The soft and hard limits
                         are separated by a comma.  A value of
                         “infinity” indicates that there is no limit.
                         Only available starting with API version 1.16.

                   rlimit_data=soft,hard
                         The maximum size of the data segment for the
                         process (in bytes).  The soft and hard limits
                         are separated by a comma.  A value of
                         “infinity” indicates that there is no limit.
                         Only available starting with API version 1.16.

                   rlimit_fsize=soft,hard
                         The largest size file that the process may
                         create (in bytes).  The soft and hard limits
                         are separated by a comma.  A value of
                         “infinity” indicates that there is no limit.
                         Only available starting with API version 1.16.

                   rlimit_locks=soft,hard
                         The maximum number of locks that the process
                         may establish, if supported by the operating
                         system.  The soft and hard limits are separated
                         by a comma.  A value of “infinity” indicates
                         that there is no limit.  Only available
                         starting with API version 1.16.

                   rlimit_memlock=soft,hard
                         The maximum size that the process may lock in
                         memory (in bytes), if supported by the
                         operating system.  The soft and hard limits are
                         separated by a comma.  A value of “infinity”
                         indicates that there is no limit.  Only
                         available starting with API version 1.16.

                   rlimit_nofile=soft,hard
                         The maximum number of files that the process
                         may have open.  The soft and hard limits are
                         separated by a comma.  A value of “infinity”
                         indicates that there is no limit.  Only
                         available starting with API version 1.16.

                   rlimit_nproc=soft,hard
                         The maximum number of processes that the user
                         may run simultaneously.  The soft and hard
                         limits are separated by a comma.  A value of
                         “infinity” indicates that there is no limit.
                         Only available starting with API version 1.16.

                   rlimit_rss=soft,hard
                         The maximum size to which the process's
                         resident set size may grow (in bytes).  The
                         soft and hard limits are separated by a comma.
                         A value of “infinity” indicates that there is
                         no limit.  Only available starting with API
                         version 1.16.

                   rlimit_stack=soft,hard
                         The maximum size to which the process's stack
                         may grow (in bytes).  The soft and hard limits
                         are separated by a comma.  A value of
                         “infinity” indicates that there is no limit.
                         Only available starting with API version 1.16.

                   sid=int
                         The session ID of the running <b>sudo </b>process or 0
                         if <b>sudo </b>is not part of a POSIX job control
                         session.  Only available starting with API
                         version 1.2.

                   tcpgid=int
                         The ID of the foreground process group
                         associated with the terminal device associated
                         with the <b>sudo </b>process or 0 if there is no
                         terminal present.  Only available starting with
                         API version 1.2.

                   tty=string
                         The path to the user's terminal device, if one
                         exists.  This entry is only present if the user
                         has a terminal device associated with the
                         session.

                   ttydev=dev_t
                         The number of the user's terminal device, if
                         one exists, in the form of a <i>dev_t</i>.  This entry
                         is only present if the user has a terminal
                         device associated with the session.  Only
                         available starting with API version 1.22.

                   uid=uid_t
                         The real user-ID of the user invoking <b>sudo</b>.

                   umask=octal
                         The invoking user's file creation mask.  Only
                         available starting with API version 1.10.

                   user=string
                         The name of the user invoking <b>sudo</b>.

             <i>user_env</i>
                   The user's environment in the form of a
                   NULL-terminated vector of “name=value” strings.

                   When parsing <i>user_env</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>plugin_options</i>
                   Any (non-comment) strings immediately after the
                   plugin path are passed as arguments to the plugin.
                   These arguments are split on a white space boundary
                   and are passed to the plugin in the form of a
                   NULL-terminated array of strings.  If no arguments
                   were specified, <i>plugin_options</i> will be the NULL
                   pointer.

                   The <i>plugin_options</i> parameter is only available
                   starting with API version 1.2.  A plugin <b>must </b>check
                   the API version specified by the <b>sudo </b>front-end
                   before using <i>plugin_options</i>.  Failure to do so may
                   result in a crash.

             <i>errstr</i>
                   If the <b>open</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>close</i>
             void (*close)(int exit_status, int error);

             The <b>close</b>() function is called when <b>sudo </b>is finished,
             shortly before it exits.  Starting with API version 1.15,
             <b>close</b>() is called regardless of whether or not a command
             was actually executed.  This makes it possible for plugins
             to perform cleanup even when a command was not run.  It is
             not possible to tell whether a command was run based solely
             on the arguments passed to the <b>close</b>() function.  To
             determine if a command was actually run, the plugin must
             keep track of whether or not the <b>check_policy</b>() function
             returned successfully.

             The function arguments are as follows:

             <i>exit_status</i>
                   The command's exit status, as returned by the <i>wait</i>(2)
                   system call, or zero if no command was run.  The
                   value of <i>exit_status</i> is undefined if <i>error</i> is non-
                   zero.

             <i>error</i>
                   If the command could not be executed, this is set to
                   the value of <i><a href="../man3/errno.3.html">errno</a></i> set by the <i>execve</i>(2) system call.
                   The plugin is responsible for displaying error
                   information via the <b>conversation</b>() or
                   <b>sudo_plugin_printf</b>() function.  If the command was
                   successfully executed, the value of <i>error</i> is zero.

             If no <b>close</b>() function is defined, no I/O logging plugins
             are loaded, and neither the <i>timeout</i> nor <i>use_pty</i> options are
             set in the <i>command_info</i> list, the <b>sudo </b>front-end may
             execute the command directly instead of running it as a
             child process.

       <i>show_version</i>
             int (*show_version)(int verbose);

             The <b>show_version</b>() function is called by <b>sudo </b>when the user
             specifies the <b>-V </b>option.  The plugin may display its
             version information to the user via the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function using SUDO_CONV_INFO_MSG.  If
             the user requests detailed version information, the <i>verbose</i>
             flag will be non-zero.

             Returns 1 on success, 0 on failure, -1 if a general error
             occurred, or -2 if there was a usage error, although the
             return value is currently ignored.

       <i>check_policy</i>
             int (*check_policy)(int argc, char * const argv[], char *env_add[],
                 char **command_info[], char **argv_out[], char **user_env_out[],
                 const char **errstr);

             The <b>check_policy</b>() function is called by <b>sudo </b>to determine
             whether the user is allowed to run the specified commands.

             If the <i>sudoedit</i> option was enabled in the <i>settings</i> array
             passed to the <b>open</b>() function, the user has requested
             <i>sudoedit</i> mode.  <i>sudoedit</i> is a mechanism for editing one or
             more files where an editor is run with the user's
             credentials instead of with elevated privileges.  <b>sudo</b>
             achieves this by creating user-writable temporary copies of
             the files to be edited and then overwriting the originals
             with the temporary copies after editing is complete.  If
             the plugin supports <i>sudoedit</i>, it must set <i>sudoedit=true</i> in
             the <i>command_info</i> list.  The plugin is responsible for
             choosing the editor to be used, potentially from a variable
             in the user's environment, such as EDITOR, and should be
             stored in <i>argv_out</i> (environment variables may include
             command line options).  The files to be edited should be
             copied from <i>argv</i> to <i>argv_out</i>, separated from the editor and
             its arguments by a ‘--’ element.  The ‘--’ will be removed
             by <b>sudo </b>before the editor is executed.  The plugin may also
             set <i>sudoedit_nfiles</i> to the number of files to be edited in
             the <i>command_info</i> list; this will only be used by the <b>sudo</b>
             front-end starting with API version 1.21.

             The <b>check_policy</b>() function returns 1 if the command is
             allowed, 0 if not allowed, -1 for a general error, or -2
             for a usage error or if <i>sudoedit</i> was specified but is
             unsupported by the plugin.  In the latter case, <b>sudo </b>will
             print a usage message before it exits.  If an error occurs,
             the plugin may optionally call the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             The function arguments are as follows:

             <i>argc</i>  The number of elements in <i>argv</i>, not counting the
                   final NULL pointer.

             <i>argv</i>  The argument vector describing the command the user
                   wishes to run, in the same form as what would be
                   passed to the <i>execve</i>(2) system call.  The vector is
                   terminated by a NULL pointer.

             <i>env_add</i>
                   Additional environment variables specified by the
                   user on the command line in the form of a
                   NULL-terminated vector of “name=value” strings.  The
                   plugin may reject the command if one or more
                   variables are not allowed to be set, or it may
                   silently ignore such variables.

                   When parsing <i>env_add</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>command_info</i>
                   Information about the command being run in the form
                   of “name=value” strings.  These values are used by
                   <b>sudo </b>to set the execution environment when running a
                   command.  The plugin is responsible for creating and
                   populating the vector, which must be terminated with
                   a NULL pointer.  The following values are recognized
                   by <b>sudo</b>:

                   apparmor_profile=string
                         AppArmor profile to transition to when
                         executing the command.  Only available starting
                         with API version 1.19.

                   chroot=string
                         The root directory to use when running the
                         command.

                   closefrom=number
                         If specified, <b>sudo </b>will close all files
                         descriptors with a value of <i>number</i> or higher.

                   command=string
                         Fully qualified path to the command to be
                         executed.

                   cwd=string
                         The current working directory to change to when
                         executing the command.  If <b>sudo </b>is unable to
                         change to the new working directory, the
                         command will not be run unless <i>cwd_optional</i> is
                         also set (see below).

                   cwd_optional=bool
                         If set, <b>sudo </b>will treat an inability to change
                         to the new working directory as a non-fatal
                         error.  This setting has no effect unless <i>cwd</i>
                         is also set.

                   exec_background=bool
                         By default, <b>sudo </b>runs a command as the
                         foreground process as long as <b>sudo </b>itself is
                         running in the foreground.  When
                         <i>exec_background</i> is enabled and the command is
                         being run in a pseudo-terminal (due to I/O
                         logging or the <i>use_pty</i> setting), the command
                         will be run as a background process.  Attempts
                         to read from the controlling terminal (or to
                         change terminal settings) will result in the
                         command being suspended with the SIGTTIN signal
                         (or SIGTTOU in the case of terminal settings).
                         If this happens when <b>sudo </b>is a foreground
                         process, the command will be granted the
                         controlling terminal and resumed in the
                         foreground with no user intervention required.
                         The advantage of initially running the command
                         in the background is that <b>sudo </b>need not read
                         from the terminal unless the command explicitly
                         requests it.  Otherwise, any terminal input
                         must be passed to the command, whether it has
                         required it or not (the kernel buffers
                         terminals so it is not possible to tell whether
                         the command really wants the input).  This is
                         different from historic <b>sudo </b>behavior or when
                         the command is not being run in a pseudo-
                         terminal.

                         For this to work seamlessly, the operating
                         system must support the automatic restarting of
                         system calls.  Unfortunately, not all operating
                         systems do this by default, and even those that
                         do may have bugs.  For example, macOS fails to
                         restart the <b>tcgetattr</b>() and <b>tcsetattr</b>() system
                         calls (this is a bug in macOS).  Furthermore,
                         because this behavior depends on the command
                         stopping with the SIGTTIN or SIGTTOU signals,
                         programs that catch these signals and suspend
                         themselves with a different signal (usually
                         SIGTOP) will not be automatically foregrounded.
                         Some versions of the linux <i>su</i>(1) command behave
                         this way.  Because of this, a plugin should not
                         set <i>exec_background</i> unless it is explicitly
                         enabled by the administrator and there should
                         be a way to enabled or disable it on a per-
                         command basis.

                         This setting has no effect unless I/O logging
                         is enabled or <i>use_pty</i> is enabled.

                   execfd=number
                         If specified, <b>sudo </b>will use the <i>fexecve</i>(2)
                         system call to execute the command instead of
                         <i>execve</i>(2).  The specified <i>number</i> must refer to
                         an open file descriptor.

                   intercept=bool
                         If set, <b>sudo </b>will intercept attempts to execute
                         a subsequent command and perform a policy check
                         via the policy plugin's <b>check_policy</b>() function
                         to determine whether or not the command is
                         permitted.  This can be used to prevent shell
                         escapes on supported platforms but it has a
                         number of limitations.  See <b>Preventing shell</b>
                         <b>escapes </b>in <i>sudoers</i>(5) for details.  Only
                         available starting with API version 1.18.

                   intercept_verify=bool
                         If set, <b>sudo </b>will attempt to verify that a
                         command run in intercept mode has the expected
                         path name, command line arguments and
                         environment.  This setting has no effect unless
                         <i>use_ptrace</i> is also enabled.  Only available
                         starting with API version 1.20.

                   iolog_compress=bool
                         Set to true if the I/O logging plugins, if any,
                         should compress the log data.  This is a hint
                         to the I/O logging plugin which may choose to
                         ignore it.

                   iolog_group=string
                         The group that will own newly created I/O log
                         files and directories.  This is a hint to the
                         I/O logging plugin which may choose to ignore
                         it.

                   iolog_mode=octal
                         The file permission mode to use when creating
                         I/O log files and directories.  This is a hint
                         to the I/O logging plugin which may choose to
                         ignore it.

                   iolog_user=string
                         The user that will own newly created I/O log
                         files and directories.  This is a hint to the
                         I/O logging plugin which may choose to ignore
                         it.

                   iolog_path=string
                         Fully qualified path to the file or directory
                         in which I/O log is to be stored.  This is a
                         hint to the I/O logging plugin which may choose
                         to ignore it.  If no I/O logging plugin is
                         loaded, this setting has no effect.

                   iolog_stdin=bool
                         Set to true if the I/O logging plugins, if any,
                         should log the standard input if it is not
                         connected to a terminal device.  This is a hint
                         to the I/O logging plugin which may choose to
                         ignore it.

                   iolog_stdout=bool
                         Set to true if the I/O logging plugins, if any,
                         should log the standard output if it is not
                         connected to a terminal device.  This is a hint
                         to the I/O logging plugin which may choose to
                         ignore it.

                   iolog_stderr=bool
                         Set to true if the I/O logging plugins, if any,
                         should log the standard error if it is not
                         connected to a terminal device.  This is a hint
                         to the I/O logging plugin which may choose to
                         ignore it.

                   iolog_ttyin=bool
                         Set to true if the I/O logging plugins, if any,
                         should log all terminal input.  This only
                         includes input typed by the user and not from a
                         pipe or redirected from a file.  This is a hint
                         to the I/O logging plugin which may choose to
                         ignore it.

                   iolog_ttyout=bool
                         Set to true if the I/O logging plugins, if any,
                         should log all terminal output.  This only
                         includes output to the screen, not output to a
                         pipe or file.  This is a hint to the I/O
                         logging plugin which may choose to ignore it.

                   login_class=string
                         BSD login class to use when setting resource
                         limits and nice value (optional).  This option
                         is only set on systems that support login
                         classes.

                   nice=int
                         Nice value (priority) to use when executing the
                         command.  The nice value, if specified,
                         overrides the priority associated with the
                         <i>login_class</i> on BSD systems.

                   log_subcmds=bool
                         If set, <b>sudo </b>will call the audit plugin's
                         <b>accept</b>() function to log when the command runs
                         a subsequent command, if supported by the
                         system.  If <i>intercept</i> is also specified,
                         <i>log_subcmds</i> will be ignored.  See <b>Preventing</b>
                         <b>shell escapes </b>in <i>sudoers</i>(5) for more
                         information.  Only available starting with API
                         version 1.18.

                   noexec=bool
                         If set, prevent the command from executing
                         other programs.

                   preserve_fds=list
                         A comma-separated list of file descriptors that
                         should be preserved, regardless of the value of
                         the <i>closefrom</i> setting.  Only available starting
                         with API version 1.5.

                   preserve_groups=bool
                         If set, <b>sudo </b>will preserve the user's group
                         vector instead of initializing the group vector
                         based on <i>runas_user</i>.

                   rlimit_as=soft,hard
                         The maximum size to which the process's address
                         space may grow (in bytes), if supported by the
                         operating system.  The soft and hard limits are
                         separated by a comma.  If only a single value
                         is specified, both the hard and soft limits are
                         set.  A value of “infinity” indicates that
                         there is no limit.  A value of “user” will
                         cause the invoking user's resource limit to be
                         preserved.  A value of “default” will cause the
                         target user's default resource limit to be used
                         on systems that allow per-user resource limits
                         to be configured.  Only available starting with
                         API version 1.18.

                   rlimit_core=soft,hard
                         The largest size core dump file that may be
                         created (in bytes).  The soft and hard limits
                         are separated by a comma.  If only a single
                         value is specified, both the hard and soft
                         limits are set.  A value of “infinity”
                         indicates that there is no limit.  A value of
                         “user” will cause the invoking user's resource
                         limit to be preserved.  A value of “default”
                         will cause the target user's default resource
                         limit to be used on systems that allow per-user
                         resource limits to be configured.  Only
                         available starting with API version 1.18.

                   rlimit_cpu=soft,hard
                         The maximum amount of CPU time that the process
                         may use (in seconds).  The soft and hard limits
                         are separated by a comma.  If only a single
                         value is specified, both the hard and soft
                         limits are set.  A value of “infinity”
                         indicates that there is no limit.  A value of
                         “user” will cause the invoking user's resource
                         limit to be preserved.  A value of “default”
                         will cause the target user's default resource
                         limit to be used on systems that allow per-user
                         resource limits to be configured.  Only
                         available starting with API version 1.18.

                   rlimit_data=soft,hard
                         The maximum size of the data segment for the
                         process (in bytes).  The soft and hard limits
                         are separated by a comma.  If only a single
                         value is specified, both the hard and soft
                         limits are set.  A value of “infinity”
                         indicates that there is no limit.  A value of
                         “user” will cause the invoking user's resource
                         limit to be preserved.  A value of “default”
                         will cause the target user's default resource
                         limit to be used on systems that allow per-user
                         resource limits to be configured.  Only
                         available starting with API version 1.18.

                   rlimit_fsize=soft,hard
                         The largest size file that the process may
                         create (in bytes).  The soft and hard limits
                         are separated by a comma.  If only a single
                         value is specified, both the hard and soft
                         limits are set.  A value of “infinity”
                         indicates that there is no limit.  A value of
                         “user” will cause the invoking user's resource
                         limit to be preserved.  A value of “default”
                         will cause the target user's default resource
                         limit to be used on systems that allow per-user
                         resource limits to be configured.  Only
                         available starting with API version 1.18.

                   rlimit_locks=soft,hard
                         The maximum number of locks that the process
                         may establish, if supported by the operating
                         system.  The soft and hard limits are separated
                         by a comma.  If only a single value is
                         specified, both the hard and soft limits are
                         set.  A value of “infinity” indicates that
                         there is no limit.  A value of “user” will
                         cause the invoking user's resource limit to be
                         preserved.  A value of “default” will cause the
                         target user's default resource limit to be used
                         on systems that allow per-user resource limits
                         to be configured.  Only available starting with
                         API version 1.18.

                   rlimit_memlock=soft,hard
                         The maximum size that the process may lock in
                         memory (in bytes), if supported by the
                         operating system.  The soft and hard limits are
                         separated by a comma.  If only a single value
                         is specified, both the hard and soft limits are
                         set.  A value of “infinity” indicates that
                         there is no limit.  A value of “user” will
                         cause the invoking user's resource limit to be
                         preserved.  A value of “default” will cause the
                         target user's default resource limit to be used
                         on systems that allow per-user resource limits
                         to be configured.  Only available starting with
                         API version 1.18.

                   rlimit_nofile=soft,hard
                         The maximum number of files that the process
                         may have open.  The soft and hard limits are
                         separated by a comma.  If only a single value
                         is specified, both the hard and soft limits are
                         set.  A value of “infinity” indicates that
                         there is no limit.  A value of “user” will
                         cause the invoking user's resource limit to be
                         preserved.  A value of “default” will cause the
                         target user's default resource limit to be used
                         on systems that allow per-user resource limits
                         to be configured.  Only available starting with
                         API version 1.18.

                   rlimit_nproc=soft,hard
                         The maximum number of processes that the user
                         may run simultaneously.  The soft and hard
                         limits are separated by a comma.  If only a
                         single value is specified, both the hard and
                         soft limits are set.  A value of “infinity”
                         indicates that there is no limit.  A value of
                         “user” will cause the invoking user's resource
                         limit to be preserved.  A value of “default”
                         will cause the target user's default resource
                         limit to be used on systems that allow per-user
                         resource limits to be configured.  Only
                         available starting with API version 1.18.

                   rlimit_rss=soft,hard
                         The maximum size to which the process's
                         resident set size may grow (in bytes).  The
                         soft and hard limits are separated by a comma.
                         If only a single value is specified, both the
                         hard and soft limits are set.  A value of
                         “infinity” indicates that there is no limit.  A
                         value of “user” will cause the invoking user's
                         resource limit to be preserved.  A value of
                         “default” will cause the target user's default
                         resource limit to be used on systems that allow
                         per-user resource limits to be configured.
                         Only available starting with API version 1.18.

                   rlimit_stack=soft,hard
                         The maximum size to which the process's stack
                         may grow (in bytes).  The soft and hard limits
                         are separated by a comma.  If only a single
                         value is specified, both the hard and soft
                         limits are set.  A value of “infinity”
                         indicates that there is no limit.  A value of
                         “user” will cause the invoking user's resource
                         limit to be preserved.  A value of “default”
                         will cause the target user's default resource
                         limit to be used on systems that allow per-user
                         resource limits to be configured.  Only
                         available starting with API version 1.18.

                   runas_egid=gid
                         Effective group-ID to run the command as.  If
                         not specified, the value of <i>runas_gid</i> is used.

                   runas_euid=uid
                         Effective user-ID to run the command as.  If
                         not specified, the value of <i>runas_uid</i> is used.

                   runas_gid=gid
                         Group-ID to run the command as.

                   runas_group=string
                         The name of the group the command will run as,
                         if it is different from the <i>runas_user</i>'s
                         default group.  This value is provided for
                         auditing purposes only, the <b>sudo </b>front-end uses
                         <i>runas_egid</i> and <i>runas_gid</i> when executing the
                         command.

                   runas_groups=list
                         The supplementary group vector to use for the
                         command in the form of a comma-separated list
                         of group-IDs.  If <i>preserve_groups</i> is set, this
                         option is ignored.

                   runas_uid=uid
                         User-ID to run the command as.

                   runas_user=string
                         The name of the user the command will run as,
                         which should correspond to <i>runas_euid</i> (or
                         <i>runas_uid</i> if <i>runas_euid</i> is not set).  This
                         value is provided for auditing purposes only,
                         the <b>sudo </b>front-end uses <i>runas_euid</i> and
                         <i>runas_uid</i> when executing the command.

                   selinux_role=string
                         SELinux role to use when executing the command.

                   selinux_type=string
                         SELinux type to use when executing the command.

                   set_utmp=bool
                         Create a utmp (or utmpx) entry when a pseudo-
                         terminal is allocated.  By default, the new
                         entry will be a copy of the user's existing
                         utmp entry (if any), with the tty, time, type,
                         and pid fields updated.

                   sudoedit=bool
                         Set to true when in <i>sudoedit</i> mode.  The plugin
                         may enable <i>sudoedit</i> mode even if <b>sudo </b>was not
                         invoked as <b>sudoedit</b>.  This allows the plugin to
                         perform command substitution and transparently
                         enable <i>sudoedit</i> when the user attempts to run
                         an editor.

                   sudoedit_checkdir=bool
                         Set to false to disable directory writability
                         checks in <b>sudoedit</b>.  By default, <b>sudoedit</b>
                         1.8.16 and higher will check all directory
                         components of the path to be edited for
                         writability by the invoking user.  Symbolic
                         links will not be followed in writable
                         directories and <b>sudoedit </b>will refuse to edit a
                         file located in a writable directory.  These
                         restrictions are not enforced when <b>sudoedit </b>is
                         run by root.  The <i>sudoedit_checkdir</i> option can
                         be set to false to disable this check.  Only
                         available starting with API version 1.8.

                   sudoedit_follow=bool
                         Set to true to allow <b>sudoedit </b>to edit files
                         that are symbolic links.  By default, <b>sudoedit</b>
                         1.8.15 and higher will refuse to open a
                         symbolic link.  The <i>sudoedit_follow</i> option can
                         be used to restore the older behavior and allow
                         <b>sudoedit </b>to open symbolic links.  Only
                         available starting with API version 1.8.

                   sudoedit_nfiles=number
                         The number of files to be edited by the user.
                         If present, this is will be used by the <b>sudo</b>
                         front-end to determine which elements of the
                         <i>argv_out</i> vector are files to be edited.  The
                         ‘--’ element must immediately precede the first
                         file to be edited.  If <i>sudoedit_nfiles</i> is not
                         specified, the <b>sudo </b>front-end will use the
                         position of the ‘--’ element to determine where
                         the file list begins.  Only available starting
                         with API version 1.21.

                   timeout=int
                         Command timeout.  If non-zero then when the
                         timeout expires the command will be killed.

                   umask=octal
                         The file creation mask to use when executing
                         the command.  This value may be overridden by
                         PAM or login.conf on some systems unless the
                         <i>umask_override</i> option is also set.

                   umask_override=bool
                         Force the value specified by the <i>umask</i> option
                         to override any umask set by PAM or login.conf.

                   use_ptrace=bool
                         If set, <b>sudo </b>will use <i>ptrace</i>(2) to implement
                         intercept mode if supported by the system.
                         This setting has no effect unless <i>intercept</i> is
                         also set.  Only available starting with API
                         version 1.19.

                   use_pty=bool
                         Allocate a pseudo-terminal to run the command
                         in, regardless of whether or not I/O logging is
                         in use.  By default, <b>sudo </b>will only run the
                         command in a pseudo-terminal when an I/O log
                         plugin is loaded.

                   utmp_user=string
                         User name to use when constructing a new utmp
                         (or utmpx) entry when <i>set_utmp</i> is enabled.
                         This option can be used to set the user field
                         in the utmp entry to the user the command runs
                         as rather than the invoking user.  If not set,
                         <b>sudo </b>will base the new entry on the invoking
                         user's existing entry.

                   Unsupported values will be ignored.

             <i>argv_out</i>
                   The NULL-terminated argument vector to pass to the
                   <i>execve</i>(2) system call when executing the command.
                   The plugin is responsible for allocating and
                   populating the vector.

             <i>user_env_out</i>
                   The NULL-terminated environment vector to use when
                   executing the command.  The plugin is responsible for
                   allocating and populating the vector.

             <i>errstr</i>
                   If the <b>check_policy</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>list</i>
             int (*list)(int argc, char * const argv[], int verbose,
                 const char *user, const char **errstr);

             List available privileges for the invoking user.  Returns 1
             on success, 0 on failure, and -1 on error.  On error, the
             plugin may optionally call the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             Privileges should be output via the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function using SUDO_CONV_INFO_MSG.

             The function arguments are as follows:

             <i>argc</i>  The number of elements in <i>argv</i>, not counting the
                   final NULL pointer.

             <i>argv</i>  If non-NULL, an argument vector describing a command
                   the user wishes to check against the policy in the
                   same form as what would be passed to the <i>execve</i>(2)
                   system call.  If the command is permitted by the
                   policy, the fully-qualified path to the command
                   should be displayed along with any command line
                   arguments.

             <i>verbose</i>
                   Flag indicating whether to list in verbose mode or
                   not.

             <i>user</i>  The name of a different user to list privileges for
                   if the policy allows it.  If NULL, the plugin should
                   list the privileges of the invoking user.

             <i>errstr</i>
                   If the <b>list</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>validate</i>
             int (*validate)(const char **errstr);

             The <b>validate</b>() function is called when <b>sudo </b>is run with the
             <b>-v </b>option.  For policy plugins such as <b>sudoers </b>that cache
             authentication credentials, this function will validate and
             cache the credentials.

             The <b>validate</b>() function should be NULL if the plugin does
             not support credential caching.

             Returns 1 on success, 0 on failure, and -1 on error.  On
             error, the plugin may optionally call the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             The function arguments are as follows:

             <i>errstr</i>
                   If the <b>validate</b>() function returns a value other than
                   1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>invalidate</i>
             void (*invalidate)(int rmcred);

             The <b>invalidate</b>() function is called when <b>sudo </b>is run with
             the <b>-k </b>or <b>-K </b>option.  For policy plugins such as <b>sudoers</b>
             that cache authentication credentials, this function will
             invalidate the credentials.  If the <i>rmcred</i> flag is non-
             zero, the plugin may remove the credentials instead of
             simply invalidating them.

             The <b>invalidate</b>() function should be NULL if the plugin does
             not support credential caching.

       <i>init_session</i>
             int (*init_session)(struct passwd *pwd, char **user_env[],
                 const char **errstr);

             The <b>init_session</b>() function is called before <b>sudo </b>sets up
             the execution environment for the command.  It is run in
             the parent <b>sudo </b>process before any user-ID or group-ID
             changes.  This can be used to perform session setup that is
             not supported by <i>command_info</i>, such as opening the PAM
             session.  The <b>close</b>() function can be used to tear down the
             session that was opened by <b>init_session</b>().

             Returns 1 on success, 0 on failure, and -1 on error.  On
             error, the plugin may optionally call the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             The function arguments are as follows:

             <i>pwd</i>   If the user-ID the command will run as was found in
                   the password database, <i>pwd</i> will describe that user,
                   otherwise it will be NULL.

             <i>user_env_out</i>
                   The NULL-terminated environment vector to use when
                   executing the command.  This is the same string
                   passed back to the front-end via the Policy Plugin's
                   <i>user_env_out</i> parameter.  If the <b>init_session</b>()
                   function needs to modify the user environment, it
                   should update the pointer stored in <i>user_env_out</i>.
                   The expected use case is to merge the contents of the
                   PAM environment (if any) with the contents of
                   <i>user_env_out</i>.  The <i>user_env_out</i> parameter is only
                   available starting with API version 1.2.  A plugin
                   <b>must </b>check the API version specified by the <b>sudo</b>
                   front-end before using <i>user_env_out</i>.  Failure to do
                   so may result in a crash.

             <i>errstr</i>
                   If the <b>init_session</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>register_hooks</i>
             void (*register_hooks)(int version,
                int (*register_hook)(struct sudo_hook *hook));

             The <b>register_hooks</b>() function is called by the sudo front-
             end to register any hooks the plugin needs.  If the plugin
             does not support hooks, <i>register_hooks</i> should be set to the
             NULL pointer.

             The <i>version</i> argument describes the version of the hooks API
             supported by the <b>sudo </b>front-end.

             The <b>register_hook</b>() function should be used to register any
             supported hooks the plugin needs.  It returns 0 on success,
             1 if the hook type is not supported, and -1 if the major
             version in <i>struct sudo_hook</i> does not match the front-end's
             major hook API version.

             See the “Hook function API” section below for more
             information about hooks.

             The <b>register_hooks</b>() function is only available starting
             with API version 1.2.  If the <b>sudo </b>front-end doesn't
             support API version 1.2 or higher, <b>register_hooks</b>() will
             not be called.

       <i>deregister_hooks</i>
             void (*deregister_hooks)(int version,
                int (*deregister_hook)(struct sudo_hook *hook));

             The <b>deregister_hooks</b>() function is called by the sudo
             front-end to deregister any hooks the plugin has
             registered.  If the plugin does not support hooks,
             <i>deregister_hooks</i> should be set to the NULL pointer.

             The <i>version</i> argument describes the version of the hooks API
             supported by the <b>sudo </b>front-end.

             The <b>deregister_hook</b>() function should be used to deregister
             any hooks that were put in place by the <b>register_hook</b>()
             function.  If the plugin tries to deregister a hook that
             the front-end does not support, <b>deregister_hook</b>() will
             return an error.

             See the “Hook function API” section below for more
             information about hooks.

             The <b>deregister_hooks</b>() function is only available starting
             with API version 1.2.  If the <b>sudo </b>front-end doesn't
             support API version 1.2 or higher, <b>deregister_hooks</b>() will
             not be called.

       <i>event_alloc</i>
             struct sudo_plugin_event * (*event_alloc)(void);

             The <b>event_alloc</b>() function is used to allocate a <i>struct</i>
             <i>sudo_plugin_event</i> which provides access to the main <b>sudo</b>
             event loop.  Unlike the other fields, the <i>event_alloc</i>
             pointer is filled in by the <b>sudo </b>front-end, not by the
             plugin.

             See the “Event API” section below for more information
             about events.

             The <b>event_alloc</b>() function is only available starting with
             API version 1.15.  If the <b>sudo </b>front-end doesn't support
             API version 1.15 or higher, <i>event_alloc</i> will not be set.

       <i>Policy Plugin Version Macros</i>

       /* Plugin API version major/minor. */
       #define SUDO_API_VERSION_MAJOR 1
       #define SUDO_API_VERSION_MINOR 13
       #define SUDO_API_MKVERSION(x, y) ((x &lt;&lt; 16) | y)
       #define SUDO_API_VERSION SUDO_API_MKVERSION(SUDO_API_VERSION_MAJOR,\
                                                   SUDO_API_VERSION_MINOR)

       /* Getters and setters for API version */
       #define SUDO_API_VERSION_GET_MAJOR(v) ((v) &gt;&gt; 16)
       #define SUDO_API_VERSION_GET_MINOR(v) ((v) &amp; 0xffff)
       #define SUDO_API_VERSION_SET_MAJOR(vp, n) do { \
           *(vp) = (*(vp) &amp; 0x0000ffff) | ((n) &lt;&lt; 16); \
       } while(0)
       #define SUDO_API_VERSION_SET_MINOR(vp, n) do { \
           *(vp) = (*(vp) &amp; 0xffff0000) | (n); \
       } while(0)

   <b>I/O plugin API</b>
       struct io_plugin {
       #define SUDO_IO_PLUGIN 2
           unsigned int type; /* always SUDO_IO_PLUGIN */
           unsigned int version; /* always SUDO_API_VERSION */
           int (*open)(unsigned int version, sudo_conv_t conversation,
               sudo_printf_t sudo_plugin_printf, char * const settings[],
               char * const user_info[], char * const command_info[],
               int argc, char * const argv[], char * const user_env[],
               char * const plugin_options[], const char **errstr);
           void (*close)(int exit_status, int error); /* wait status or error */
           int (*show_version)(int verbose);
           int (*log_ttyin)(const char *buf, unsigned int len,
               const char **errstr);
           int (*log_ttyout)(const char *buf, unsigned int len,
               const char **errstr);
           int (*log_stdin)(const char *buf, unsigned int len,
               const char **errstr);
           int (*log_stdout)(const char *buf, unsigned int len,
               const char **errstr);
           int (*log_stderr)(const char *buf, unsigned int len,
               const char **errstr);
           void (*register_hooks)(int version,
              int (*register_hook)(struct sudo_hook *hook));
           void (*deregister_hooks)(int version,
              int (*deregister_hook)(struct sudo_hook *hook));
           int (*change_winsize)(unsigned int lines, unsigned int cols,
               const char **errstr);
           int (*log_suspend)(int signo, const char **errstr);
           struct sudo_plugin_event * (*event_alloc)(void);
       };

       When an I/O plugin is loaded, <b>sudo </b>runs the command in a pseudo-
       terminal.  This makes it possible to log the input and output
       from the user's session.  If any of the standard input, standard
       output, or standard error do not correspond to a tty, <b>sudo </b>will
       open a pipe to capture the I/O for logging before passing it on.

       The <b>log_ttyin</b>() function receives the raw user input from the
       terminal device (this will include input even when echo is
       disabled, such as when a password is read).  The <b>log_ttyout</b>()
       function receives output from the pseudo-terminal that is
       suitable for replaying the user's session at a later time.  The
       <b>log_stdin</b>(), <b>log_stdout</b>(), and <b>log_stderr</b>() functions are only
       called if the standard input, standard output, or standard error
       respectively correspond to something other than a tty.

       Any of the logging functions may be set to the NULL pointer if no
       logging is to be performed.  If the open function returns 0, no
       I/O will be sent to the plugin.

       If a logging function returns an error (-1), the running command
       will be terminated and all of the plugin's logging functions will
       be disabled.  Other I/O logging plugins will still receive any
       remaining input or output that has not yet been processed.

       If an input logging function rejects the data by returning 0, the
       command will be terminated and the data will not be passed to the
       command, though it will still be sent to any other I/O logging
       plugins.  If an output logging function rejects the data by
       returning 0, the command will be terminated and the data will not
       be written to the terminal, though it will still be sent to any
       other I/O logging plugins.

       A <i>struct audit_plugin</i> has the following fields:

       <i>type</i>  The <i>type</i> field should always be set to SUDO_IO_PLUGIN.

       <i>version</i>
             The <i>version</i> field should be set to SUDO_API_VERSION.

             This allows <b>sudo </b>to determine the API version the plugin
             was built against.

       <i>open</i>
             int (*open)(unsigned int version, sudo_conv_t conversation,
                 sudo_printf_t sudo_plugin_printf, char * const settings[],
                 char * const user_info[], char * const command_info[],
                 int argc, char * const argv[], char * const user_env[],
                 char * const plugin_options[]);

             The <b>open</b>() function is run before the <b>log_ttyin</b>(),
             <b>log_ttyout</b>(), <b>log_stdin</b>(), <b>log_stdout</b>(), <b>log_stderr</b>(),
             <b>log_suspend</b>(), <b>change_winsize</b>(), or <b>show_version</b>()
             functions are called.  It is only called if the version is
             being requested or if the policy plugin's <b>check_policy</b>()
             function has returned successfully.  It returns 1 on
             success, 0 on failure, -1 if a general error occurred, or
             -2 if there was a usage error.  In the latter case, <b>sudo</b>
             will print a usage message before it exits.  If an error
             occurs, the plugin may optionally call the <b>conversation</b>()
             or <b>sudo_plugin_printf</b>() function with SUDO_CONF_ERROR_MSG
             to present additional error information to the user.

             The function arguments are as follows:

             <i>version</i>
                   The version passed in by <b>sudo </b>allows the plugin to
                   determine the major and minor version number of the
                   plugin API supported by <b>sudo</b>.

             <i>conversation</i>
                   A pointer to the <b>conversation</b>() function that may be
                   used by the <b>Fa</b>(<i>show_version</i>) function to display
                   version information (see <b>show_version</b>() below).  The
                   <b>conversation</b>() function may also be used to display
                   additional error message to the user.  The
                   <b>conversation</b>() function returns 0 on success and -1
                   on failure.

             <i>sudo_plugin_printf</i>
                   A pointer to a <b>printf</b>()-style function that may be
                   used by the <b>show_version</b>() function to display
                   version information (see show_version below).  The
                   <b>sudo_plugin_printf</b>() function may also be used to
                   display additional error message to the user.  The
                   <b>sudo_plugin_printf</b>() function returns number of
                   characters printed on success and -1 on failure.

             <i>settings</i>
                   A vector of user-supplied <b>sudo </b>settings in the form
                   of “name=value” strings.  The vector is terminated by
                   a NULL pointer.  These settings correspond to options
                   the user specified when running <b>sudo</b>.  As such, they
                   will only be present when the corresponding option
                   has been specified on the command line.

                   When parsing <i>settings</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible settings.

             <i>user_info</i>
                   A vector of information about the user running the
                   command in the form of “name=value” strings.  The
                   vector is terminated by a NULL pointer.

                   When parsing <i>user_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>command_info</i>
                   A vector of information describing the command being
                   run in the form of “name=value” strings.  The vector
                   is terminated by a NULL pointer.

                   When parsing <i>command_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>argc</i>  The number of elements in <i>argv</i>, not counting the
                   final NULL pointer.  It can be zero, such as when
                   <b>sudo </b>is called with the <b>-V </b>option.

             <i>argv</i>  If non-NULL, an argument vector describing a command
                   the user wishes to run in the same form as what would
                   be passed to the <i>execve</i>(2) system call.

             <i>user_env</i>
                   The user's environment in the form of a
                   NULL-terminated vector of “name=value” strings.

                   When parsing <i>user_env</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>plugin_options</i>
                   Any (non-comment) strings immediately after the
                   plugin path are treated as arguments to the plugin.
                   These arguments are split on a white space boundary
                   and are passed to the plugin in the form of a
                   NULL-terminated array of strings.  If no arguments
                   were specified, <i>plugin_options</i> will be the NULL
                   pointer.

                   The <i>plugin_options</i> parameter is only available
                   starting with API version 1.2.  A plugin <b>must </b>check
                   the API version specified by the <b>sudo </b>front-end
                   before using <i>plugin_options</i>.  Failure to do so may
                   result in a crash.

             <i>errstr</i>
                   If the <b>open</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>close</i>
             void (*close)(int exit_status, int error);

             The <b>close</b>() function is called when <b>sudo </b>is finished,
             shortly before it exits.

             The function arguments are as follows:

             <i>exit_status</i>
                   The command's exit status, as returned by the <i>wait</i>(2)
                   system call, or zero if no command was run.  The
                   value of <i>exit_status</i> is undefined if <i>error</i> is non-
                   zero.

             <i>error</i>
                   If the command could not be executed, this is set to
                   the value of <i><a href="../man3/errno.3.html">errno</a></i> set by the <i>execve</i>(2) system call.
                   If the command was successfully executed, the value
                   of <i>error</i> is zero.

       <i>show_version</i>
             int (*show_version)(int verbose);

             The <b>show_version</b>() function is called by <b>sudo </b>when the user
             specifies the <b>-V </b>option.  The plugin may display its
             version information to the user via the <b>conversation</b>() or
             <b>sudo_plugin_printf</b>() function using SUDO_CONV_INFO_MSG.  If
             the user requests detailed version information, the <i>verbose</i>
             flag will be non-zero.

             Returns 1 on success, 0 on failure, -1 if a general error
             occurred, or -2 if there was a usage error, although the
             return value is currently ignored.

       <i>log_ttyin</i>
             int (*log_ttyin)(const char *buf, unsigned int len,
                 const char **errstr);

             The <b>log_ttyin</b>() function is called whenever data can be
             read from the user but before it is passed to the running
             command.  This allows the plugin to reject data if it
             chooses to (for instance if the input contains banned
             content).  Returns 1 if the data should be passed to the
             command, 0 if the data is rejected (which will terminate
             the running command), or -1 if an error occurred.

             The function arguments are as follows:

             <i>buf</i>   The buffer containing user input.

             <i>len</i>   The length of <i>buf</i> in bytes.

             <i>errstr</i>
                   If the <b>log_ttyin</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>log_ttyout</i>
             int (*log_ttyout)(const char *buf, unsigned int len,
                 const char **errstr);

             The <b>log_ttyout</b>() function is called whenever data can be
             read from the command but before it is written to the
             user's terminal.  This allows the plugin to reject data if
             it chooses to (for instance if the output contains banned
             content).  Returns 1 if the data should be passed to the
             user, 0 if the data is rejected (which will terminate the
             running command), or -1 if an error occurred.

             The function arguments are as follows:

             <i>buf</i>   The buffer containing command output.

             <i>len</i>   The length of <i>buf</i> in bytes.

             <i>errstr</i>
                   If the <b>log_ttyout</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>log_stdin</i>
             int (*log_stdin)(const char *buf, unsigned int len,
                 const char **errstr);

             The <b>log_stdin</b>() function is only used if the standard input
             does not correspond to a tty device.  It is called whenever
             data can be read from the standard input but before it is
             passed to the running command.  This allows the plugin to
             reject data if it chooses to (for instance if the input
             contains banned content).  Returns 1 if the data should be
             passed to the command, 0 if the data is rejected (which
             will terminate the running command), or -1 if an error
             occurred.

             The function arguments are as follows:

             <i>buf</i>   The buffer containing user input.

             <i>len</i>   The length of <i>buf</i> in bytes.

             <i>errstr</i>
                   If the <b>log_stdin</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>log_stdout</i>
             int (*log_stdout)(const char *buf, unsigned int len,
                 const char **errstr);

             The <b>log_stdout</b>() function is only used if the standard
             output does not correspond to a tty device.  It is called
             whenever data can be read from the command but before it is
             written to the standard output.  This allows the plugin to
             reject data if it chooses to (for instance if the output
             contains banned content).  Returns 1 if the data should be
             passed to the user, 0 if the data is rejected (which will
             terminate the running command), or -1 if an error occurred.

             The function arguments are as follows:

             <i>buf</i>   The buffer containing command output.

             <i>len</i>   The length of <i>buf</i> in bytes.

             <i>errstr</i>
                   If the <b>log_stdout</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>log_stderr</i>
             int (*log_stderr)(const char *buf, unsigned int len,
                 const char **errstr);

             The <b>log_stderr</b>() function is only used if the standard
             error does not correspond to a tty device.  It is called
             whenever data can be read from the command but before it is
             written to the standard error.  This allows the plugin to
             reject data if it chooses to (for instance if the output
             contains banned content).  Returns 1 if the data should be
             passed to the user, 0 if the data is rejected (which will
             terminate the running command), or -1 if an error occurred.

             The function arguments are as follows:

             <i>buf</i>   The buffer containing command output.

             <i>len</i>   The length of <i>buf</i> in bytes.

             <i>errstr</i>
                   If the <b>log_stderr</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>register_hooks</i>
             See the “Policy plugin API” section for a description of
             <b>register_hooks</b>().

       <i>deregister_hooks</i>
             See the “Policy plugin API” section for a description of
             <b>deregister_hooks</b>().

       <i>change_winsize</i>
             int (*change_winsize)(unsigned int lines, unsigned int cols,
                 const char **errstr);

             The <b>change_winsize</b>() function is called whenever the window
             size of the terminal changes from the initial values
             specified in the <i>user_info</i> list.  Returns -1 if an error
             occurred, in which case no further calls to
             <b>change_winsize</b>() will be made,

             The function arguments are as follows:

             <i>lines</i>
                   The number of lines (rows) in the re-sized terminal.

             <i>cols</i>  The number of columns in the re-sized terminal.

             <i>errstr</i>
                   If the <b>change_winsize</b>() function returns a value
                   other than 1, the plugin may store a message
                   describing the failure or error in <i>errstr</i>.  The <b>sudo</b>
                   front-end will then pass this value to any registered
                   audit plugins.  The string stored in <i>errstr</i> must
                   remain valid until the plugin's <b>close</b>() function is
                   called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

       <i>log_suspend</i>
             int (*log_suspend)(int signo, const char **errstr);

             The <b>log_suspend</b>() function is called whenever a command is
             suspended or resumed.  Logging this information makes it
             possible to skip the period of time when the command was
             suspended during playback of a session.  Returns -1 if an
             error occurred, in which case no further calls to
             <b>log_suspend</b>() will be made,

             The function arguments are as follows:

             <i>signo</i>
                   The signal that caused the command to be suspended,
                   or SIGCONT if the command was resumed.

             <i>errstr</i>
                   If the <b>log_suspend</b>() function returns a value other
                   than 1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

                   The <i>errstr</i> parameter is only available starting with
                   API version 1.15.  A plugin <b>must </b>check the API
                   version specified by the <b>sudo </b>front-end before using
                   <i>errstr</i>.  Failure to do so may result in a crash.

             <i>event_alloc</i>
                   struct sudo_plugin_event * (*event_alloc)(void);

                   The <b>event_alloc</b>() function is used to allocate a
                   <i>struct sudo_plugin_event</i> which provides access to the
                   main <b>sudo </b>event loop.  Unlike the other fields, the
                   <b>event_alloc</b>() pointer is filled in by the <b>sudo </b>front-
                   end, not by the plugin.

                   See the “Event API” section below for more
                   information about events.

                   The <b>event_alloc</b>() function is only available starting
                   with API version 1.15.  If the <b>sudo </b>front-end doesn't
                   support API version 1.15 or higher, <b>event_alloc</b>()
                   will not be set.

             <i>I/O Plugin Version Macros</i>

             Same as for the “Policy plugin API”.

   <b>Audit plugin API</b>
       /* Audit plugin close function status types. */
       #define SUDO_PLUGIN_NO_STATUS           0
       #define SUDO_PLUGIN_WAIT_STATUS         1
       #define SUDO_PLUGIN_EXEC_ERROR          2
       #define SUDO_PLUGIN_SUDO_ERROR          3

       #define SUDO_AUDIT_PLUGIN 3
       struct audit_plugin {
           unsigned int type; /* always SUDO_AUDIT_PLUGIN */
           unsigned int version; /* always SUDO_API_VERSION */
           int (*open)(unsigned int version, sudo_conv_t conversation,
               sudo_printf_t sudo_plugin_printf, char * const settings[],
               char * const user_info[], int submit_optind,
               char * const submit_argv[], char * const submit_envp[],
               char * const plugin_options[], const char **errstr);
           void (*close)(int status_type, int status);
           int (*accept)(const char *plugin_name,
               unsigned int plugin_type, char * const command_info[],
               char * const run_argv[], char * const run_envp[],
               const char **errstr);
           int (*reject)(const char *plugin_name, unsigned int plugin_type,
               const char *audit_msg, char * const command_info[],
               const char **errstr);
           int (*error)(const char *plugin_name, unsigned int plugin_type,
               const char *audit_msg, char * const command_info[],
               const char **errstr);
           int (*show_version)(int verbose);
           void (*register_hooks)(int version,
               int (*register_hook)(struct sudo_hook *hook));
           void (*deregister_hooks)(int version,
               int (*deregister_hook)(struct sudo_hook *hook));
           struct sudo_plugin_event * (*event_alloc)(void);
       }

       An audit plugin can be used to log successful and unsuccessful
       attempts to run <b>sudo </b>independent of the policy or any I/O
       plugins.  Multiple audit plugins may be specified in
       <i>sudo.conf</i>(5).

       A <i>struct audit_plugin</i> has the following fields:

       <i>type</i>  The <i>type</i> field should always be set to SUDO_AUDIT_PLUGIN.

       <i>version</i>
             The <i>version</i> field should be set to SUDO_API_VERSION.

             This allows <b>sudo </b>to determine the API version the plugin
             was built against.

       <i>open</i>
             int (*open)(unsigned int version, sudo_conv_t conversation,
                 sudo_printf_t sudo_plugin_printf, char * const settings[],
                 char * const user_info[], int submit_optind,
                 char * const submit_argv[], char * const submit_envp[],
                 char * const plugin_options[], const char **errstr);

             The audit <b>open</b>() function is run before any other <b>sudo</b>
             plugin API functions.  This makes it possible to audit
             failures in the other plugins.  It returns 1 on success, 0
             on failure, -1 if a general error occurred, or -2 if there
             was a usage error.  In the latter case, <b>sudo </b>will print a
             usage message before it exits.  If an error occurs, the
             plugin may optionally call the <b>conversation</b>() or
             <b>plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             The function arguments are as follows:

             <i>version</i>
                   The version passed in by <b>sudo </b>allows the plugin to
                   determine the major and minor version number of the
                   plugin API supported by <b>sudo</b>.

             <i>conversation</i>
                   A pointer to the <b>conversation</b>() function that may be
                   used by the <b>show_version</b>() function to display
                   version information (see <b>show_version</b>() below).  The
                   <b>conversation</b>() function may also be used to display
                   additional error message to the user.  The
                   <b>conversation</b>() function returns 0 on success, and -1
                   on failure.

             <i>plugin_printf</i>
                   A pointer to a <b>printf</b>()-style function that may be
                   used by the <b>show_version</b>() function to display
                   version information (see show_version below).  The
                   <b>plugin_printf</b>() function may also be used to display
                   additional error message to the user.  The
                   <b>plugin_printf</b>() function returns number of characters
                   printed on success and -1 on failure.

             <i>settings</i>
                   A vector of user-supplied <b>sudo </b>settings in the form
                   of “name=value” strings.  The vector is terminated by
                   a NULL pointer.  These settings correspond to options
                   the user specified when running <b>sudo</b>.  As such, they
                   will only be present when the corresponding option
                   has been specified on the command line.

                   When parsing <i>settings</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible settings.

             <i>user_info</i>
                   A vector of information about the user running the
                   command in the form of “name=value” strings.  The
                   vector is terminated by a NULL pointer.

                   When parsing <i>user_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>submit_optind</i>
                   The index into <i>submit_argv</i> that corresponds to the
                   first entry that is not a command line option.  If
                   <i>submit_argv</i> only consists of options, which may be
                   the case with the <b>-l </b>or <b>-v </b>options,
                   <i>submit_argv</i>[<i>submit_optind</i>] will evaluate to the NULL
                   pointer.

             <i>submit_argv</i>
                   The argument vector <b>sudo </b>was invoked with, including
                   all command line options.  The <i>submit_optind</i> argument
                   can be used to determine the end of the command line
                   options.

             <i>submit_envp</i>
                   The invoking user's environment in the form of a
                   NULL-terminated vector of “name=value” strings.

                   When parsing <i>submit_envp</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>plugin_options</i>
                   Any (non-comment) strings immediately after the
                   plugin path are treated as arguments to the plugin.
                   These arguments are split on a white space boundary
                   and are passed to the plugin in the form of a
                   NULL-terminated array of strings.  If no arguments
                   were specified, <i>plugin_options</i> will be the NULL
                   pointer.

             <i>errstr</i>
                   If the <b>open</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

       <i>close</i>
             void (*close)(int status_type, int status);

             The <b>close</b>() function is called when <b>sudo </b>is finished,
             shortly before it exits.

             The function arguments are as follows:

             <i>status_type</i>
                   The type of status being passed.  One of
                   SUDO_PLUGIN_NO_STATUS, SUDO_PLUGIN_WAIT_STATUS,
                   SUDO_PLUGIN_EXEC_ERROR or SUDO_PLUGIN_SUDO_ERROR.

             <i>status</i>
                   Depending on the value of <i>status_type</i>, this value is
                   either ignored, the command's exit status as returned
                   by the <i>wait</i>(2) system call, the value of <i><a href="../man3/errno.3.html">errno</a></i> set by
                   the <i>execve</i>(2) system call, or the value of <i><a href="../man3/errno.3.html">errno</a></i>
                   resulting from an error in the <b>sudo </b>front-end.

       <i>accept</i>
             int (*accept)(const char *plugin_name, unsigned int plugin_type,
                 char * const command_info[], char * const run_argv[],
                 char * const run_envp[], const char **errstr);

             The <b>accept</b>() function is called when a command or action is
             accepted by a policy or approval plugin.  The function
             arguments are as follows:

             <i>plugin_name</i>
                   The name of the plugin that accepted the command or
                   “sudo” for the <b>sudo </b>front-end.

             <i>plugin_type</i>
                   The type of plugin that accepted the command,
                   currently either SUDO_POLICY_PLUGIN,
                   SUDO_POLICY_APPROVAL, or SUDO_FRONT_END.  The
                   <b>accept</b>() function is called multiple times--once for
                   each policy or approval plugin that succeeds and once
                   for the sudo front-end.  When called on behalf of the
                   sudo front-end, <i>command_info</i> may include information
                   from an I/O logging plugin as well.

                   Typically, an audit plugin is interested in either
                   the accept status from the <b>sudo </b>front-end or from the
                   various policy and approval plugins, but not both.
                   It is possible for the policy plugin to accept a
                   command that is later rejected by an approval plugin,
                   in which case the audit plugin's <b>accept</b>() and
                   <b>reject</b>() functions will <i>both</i> be called.

             <i>command_info</i>
                   An optional vector of information describing the
                   command being run in the form of “name=value”
                   strings.  The vector is terminated by a NULL pointer.

                   When parsing <i>command_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>run_argv</i>
                   A NULL-terminated argument vector describing a
                   command that will be run in the same form as what
                   would be passed to the <i>execve</i>(2) system call.

             <i>run_envp</i>
                   The environment the command will be run with in the
                   form of a NULL-terminated vector of “name=value”
                   strings.

                   When parsing <i>run_envp</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>errstr</i>
                   If the <b>accept</b>() function returns a value other than
                   1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

       <i>reject</i>
             int (*reject)(const char *plugin_name, unsigned int plugin_type,
                 const char *audit_msg, char * const command_info[],
                 const char **errstr);

             The <b>reject</b>() function is called when a command or action is
             rejected by a plugin.  The function arguments are as
             follows:

             <i>plugin_name</i>
                   The name of the plugin that rejected the command.

             <i>plugin_type</i>
                   The type of plugin that rejected the command,
                   currently either SUDO_POLICY_PLUGIN,
                   SUDO_APPROVAL_PLUGIN, or SUDO_IO_PLUGIN.

                   Unlike the <b>accept</b>() function, the <b>reject</b>() function
                   is not called on behalf of the <b>sudo </b>front-end.

             <i>audit_msg</i>
                   An optional string describing the reason the command
                   was rejected by the plugin.  If the plugin did not
                   provide a reason, <i>audit_msg</i> will be the NULL pointer.

             <i>command_info</i>
                   An optional vector of information describing the
                   command being run in the form of “name=value”
                   strings.  The vector is terminated by a NULL pointer.

                   When parsing <i>command_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>errstr</i>
                   If the <b>reject</b>() function returns a value other than
                   1, the plugin may store a message describing the
                   failure or error in <i>errstr</i>.  The <b>sudo </b>front-end will
                   then pass this value to any registered audit plugins.
                   The string stored in <i>errstr</i> must remain valid until
                   the plugin's <b>close</b>() function is called.

       <i>error</i>
             int (*error)(const char *plugin_name, unsigned int plugin_type,
                 const char *audit_msg, char * const command_info[],
                 const char **errstr);

             The <b>error</b>() function is called when a plugin or the <b>sudo</b>
             front-end returns an error.  The function arguments are as
             follows:

             <i>plugin_name</i>
                   The name of the plugin that generated the error or
                   “sudo” for the <b>sudo </b>front-end.

             <i>plugin_type</i>
                   The type of plugin that generated the error, or
                   SUDO_FRONT_END for the <b>sudo </b>front-end.

             <i>audit_msg</i>
                   An optional string describing the plugin error.  If
                   the plugin did not provide a description, <i>audit_msg</i>
                   will be the NULL pointer.

             <i>command_info</i>
                   An optional vector of information describing the
                   command being run in the form of “name=value”
                   strings.  The vector is terminated by a NULL pointer.

                   When parsing <i>command_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>errstr</i>
                   If the <b>error</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

       <i>show_version</i>
             int (*show_version)(int verbose);

             The <b>show_version</b>() function is called by <b>sudo </b>when the user
             specifies the <b>-V </b>option.  The plugin may display its
             version information to the user via the <b>conversation</b>() or
             <b>plugin_printf</b>() function using SUDO_CONV_INFO_MSG.  If the
             user requests detailed version information, the verbose
             flag will be set.

             Returns 1 on success, 0 on failure, -1 if a general error
             occurred, or -2 if there was a usage error, although the
             return value is currently ignored.

       <i>register_hooks</i>
             See the “Policy plugin API” section for a description of
             <b>register_hooks</b>().

       <i>deregister_hooks</i>
             See the “Policy plugin API” section for a description of
             <b>deregister_hooks</b>().

       <i>event_alloc</i>
             struct sudo_plugin_event * (*event_alloc)(void);

             The <b>event_alloc</b>() function is used to allocate a <i>struct</i>
             <i>sudo_plugin_event</i> which provides access to the main <b>sudo</b>
             event loop.  Unlike the other fields, the <i>event_alloc</i>
             pointer is filled in by the <b>sudo </b>front-end, not by the
             plugin.

             See the “Event API” section below for more information
             about events.

             The <b>event_alloc</b>() function is only available starting with
             API version 1.17.  If the <b>sudo </b>front-end doesn't support
             API version 1.17 or higher, <b>event_alloc</b>() will not be set.

   <b>Approval plugin API</b>
       struct approval_plugin {
       #define SUDO_APPROVAL_PLUGIN 4
           unsigned int type; /* always SUDO_APPROVAL_PLUGIN */
           unsigned int version; /* always SUDO_API_VERSION */
           int (*open)(unsigned int version, sudo_conv_t conversation,
               sudo_printf_t sudo_plugin_printf, char * const settings[],
               char * const user_info[], int submit_optind,
               char * const submit_argv[], char * const submit_envp[],
               char * const plugin_options[], const char **errstr);
           void (*close)(void);
           int (*check)(char * const command_info[], char * const run_argv[],
               char * const run_envp[], const char **errstr);
           int (*show_version)(int verbose);
       };

       An approval plugin can be used to apply extra constraints after a
       command has been accepted by the policy plugin.  Unlike the other
       plugin types, it does not remain open until the command
       completes.  The plugin is opened before a call to <b>check</b>() or
       <b>show_version</b>() and closed shortly thereafter (audit plugin
       functions must be called before the plugin is closed).  Multiple
       approval plugins may be specified in <i>sudo.conf</i>(5).

       A <i>struct approval_plugin</i> has the following fields:

       <i>type</i>  The <i>type</i> field should always be set to
             SUDO_APPROVAL_PLUGIN.

       <i>version</i>
             The <i>version</i> field should be set to SUDO_API_VERSION.

             This allows <b>sudo </b>to determine the API version the plugin
             was built against.

       <i>open</i>
             int (*open)(unsigned int version, sudo_conv_t conversation,
                 sudo_printf_t sudo_plugin_printf, char * const settings[],
                 char * const user_info[], int submit_optind,
                 char * const submit_argv[], char * const submit_envp[],
                 char * const plugin_options[], const char **errstr);

             The approval <b>open</b>() function is run immediately before a
             call to the plugin's <b>check</b>() or <b>show_version</b>() functions.
             It is only called if the version is being requested or if
             the policy plugin's <b>check_policy</b>() function has returned
             successfully.  It returns 1 on success, 0 on failure, -1 if
             a general error occurred, or -2 if there was a usage error.
             In the latter case, <b>sudo </b>will print a usage message before
             it exits.  If an error occurs, the plugin may optionally
             call the <b>conversation</b>() or <b>plugin_printf</b>() function with
             SUDO_CONF_ERROR_MSG to present additional error information
             to the user.

             The function arguments are as follows:

             <i>version</i>
                   The version passed in by <b>sudo </b>allows the plugin to
                   determine the major and minor version number of the
                   plugin API supported by <b>sudo</b>.

             <i>conversation</i>
                   A pointer to the <b>conversation</b>() function that can be
                   used by the plugin to interact with the user (see
                   “Conversation API” for details).  Returns 0 on
                   success and -1 on failure.

             <i>plugin_printf</i>
                   A pointer to a <b>printf</b>()-style function that may be
                   used to display informational or error messages (see
                   “Conversation API” for details).  Returns the number
                   of characters printed on success and -1 on failure.

             <i>settings</i>
                   A vector of user-supplied <b>sudo </b>settings in the form
                   of “name=value” strings.  The vector is terminated by
                   a NULL pointer.  These settings correspond to options
                   the user specified when running <b>sudo</b>.  As such, they
                   will only be present when the corresponding option
                   has been specified on the command line.

                   When parsing <i>settings</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible settings.

             <i>user_info</i>
                   A vector of information about the user running the
                   command in the form of “name=value” strings.  The
                   vector is terminated by a NULL pointer.

                   When parsing <i>user_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>submit_optind</i>
                   The index into <i>submit_argv</i> that corresponds to the
                   first entry that is not a command line option.  If
                   <i>submit_argv</i> only consists of options, which may be
                   the case with the <b>-l </b>or <b>-v </b>options,
                   <i>submit_argv</i>[<i>submit_optind</i>] will evaluate to the NULL
                   pointer.

             <i>submit_argv</i>
                   The argument vector <b>sudo </b>was invoked with, including
                   all command line options.  The <i>submit_optind</i> argument
                   can be used to determine the end of the command line
                   options.

             <i>submit_envp</i>
                   The invoking user's environment in the form of a
                   NULL-terminated vector of “name=value” strings.

                   When parsing <i>submit_envp</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>plugin_options</i>
                   Any (non-comment) strings immediately after the
                   plugin path are treated as arguments to the plugin.
                   These arguments are split on a white space boundary
                   and are passed to the plugin in the form of a
                   NULL-terminated array of strings.  If no arguments
                   were specified, <i>plugin_options</i> will be the NULL
                   pointer.

             <i>errstr</i>
                   If the <b>open</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

       <i>close</i>
             void (*close)(void);

             The <b>close</b>() function is called after the approval plugin's
             <b>check</b>() or <b>show_version</b>() functions have been called.  It
             takes no arguments.  The <b>close</b>() function is typically used
             to perform plugin-specific cleanup, such as the freeing of
             memory objects allocated by the plugin.  If the plugin does
             not need to perform any cleanup, <b>close</b>() may be set to the
             NULL pointer.

       <i>check</i>
             int (*check)(char * const command_info[], char * const run_argv[],
                 char * const run_envp[], const char **errstr);

             The approval <b>check</b>() function is run after the policy
             plugin <b>check_policy</b>() function and before any I/O logging
             plugins.  If multiple approval plugins are loaded, they
             must all succeed for the command to be allowed.  It returns
             1 on success, 0 on failure, -1 if a general error occurred,
             or -2 if there was a usage error.  In the latter case, <b>sudo</b>
             will print a usage message before it exits.  If an error
             occurs, the plugin may optionally call the <b>conversation</b>()
             or <b>plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             The function arguments are as follows:

             <i>command_info</i>
                   A vector of information describing the command being
                   run in the form of “name=value” strings.  The vector
                   is terminated by a NULL pointer.

                   When parsing <i>command_info</i>, the plugin should split on
                   the <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

                   See the “Policy plugin API” section for a list of all
                   possible strings.

             <i>run_argv</i>
                   A NULL-terminated argument vector describing a
                   command that will be run in the same form as what
                   would be passed to the <i>execve</i>(2) system call.

             <i>run_envp</i>
                   The environment the command will be run with in the
                   form of a NULL-terminated vector of “name=value”
                   strings.

                   When parsing <i>run_envp</i>, the plugin should split on the
                   <b>first </b>equal sign (‘=’) since the <i>name</i> field will
                   never include one itself but the <i>value</i> might.

             <i>errstr</i>
                   If the <b>open</b>() function returns a value other than 1,
                   the plugin may store a message describing the failure
                   or error in <i>errstr</i>.  The <b>sudo </b>front-end will then
                   pass this value to any registered audit plugins.  The
                   string stored in <i>errstr</i> must remain valid until the
                   plugin's <b>close</b>() function is called.

       <i>show_version</i>
             int (*show_version)(int verbose);

             The <b>show_version</b>() function is called by <b>sudo </b>when the user
             specifies the <b>-V </b>option.  The plugin may display its
             version information to the user via the <b>conversation</b>() or
             <b>plugin_printf</b>() function using SUDO_CONV_INFO_MSG.  If the
             user requests detailed version information, the verbose
             flag will be set.

             Returns 1 on success, 0 on failure, -1 if a general error
             occurred, or -2 if there was a usage error, although the
             return value is currently ignored.

   <b>Signal handlers</b>
       The <b>sudo </b>front-end installs default signal handlers to trap
       common signals while the plugin functions are run.  The following
       signals are trapped by default before the command is executed:

       <b>•  </b>SIGALRM
       <b>•  </b>SIGHUP
       <b>•  </b>SIGINT
       <b>•  </b>SIGPIPE
       <b>•  </b>SIGQUIT
       <b>•  </b>SIGTERM
       <b>•  </b>SIGTSTP
       <b>•  </b>SIGUSR1
       <b>•  </b>SIGUSR2

       If a fatal signal is received before the command is executed,
       <b>sudo </b>will call the plugin's <b>close</b>() function with an exit status
       of 128 plus the value of the signal that was received.  This
       allows for consistent logging of commands killed by a signal for
       plugins that log such information in their <b>close</b>() function.  An
       exception to this is SIGPIPE, which is ignored until the command
       is executed.

       A plugin may temporarily install its own signal handlers but must
       restore the original handler before the plugin function returns.

   <b>Hook function API</b>
       Beginning with plugin API version 1.2, it is possible to install
       hooks for certain functions called by the <b>sudo </b>front-end.

       Currently, the only supported hooks relate to the handling of
       environment variables.  Hooks can be used to intercept attempts
       to get, set, or remove environment variables so that these
       changes can be reflected in the version of the environment that
       is used to execute a command.  A future version of the API will
       support hooking internal <b>sudo </b>front-end functions as well.

       <i>Hook structure</i>

       Hooks in <b>sudo </b>are described by the following structure:

       typedef int (*sudo_hook_fn_t)();

       struct sudo_hook {
           unsigned int hook_version;
           unsigned int hook_type;
           sudo_hook_fn_t hook_fn;
           void *closure;
       };

       A <i>struct sudo_hook</i> has the following fields:

       <i>hook_version</i>
             The <i>hook_version</i> field should be set to SUDO_HOOK_VERSION.

       <i>hook_type</i>
             The <i>hook_type</i> field may be one of the following supported
             hook types:

             SUDO_HOOK_SETENV
                   The C library <i>setenv</i>(3) function.  Any registered
                   hooks will run before the C library implementation.
                   The <i>hook_fn</i> field should be a function that matches
                   the following typedef:

                   typedef int (*sudo_hook_fn_setenv_t)(const char *name,
                      const char *value, int overwrite, void *closure);

                   If the registered hook does not match the typedef the
                   results are unspecified.

             SUDO_HOOK_UNSETENV
                   The C library <i>unsetenv</i>(3) function.  Any registered
                   hooks will run before the C library implementation.
                   The <i>hook_fn</i> field should be a function that matches
                   the following typedef:

                   typedef int (*sudo_hook_fn_unsetenv_t)(const char *name,
                      void *closure);

             SUDO_HOOK_GETENV
                   The C library <i>getenv</i>(3) function.  Any registered
                   hooks will run before the C library implementation.
                   The <i>hook_fn</i> field should be a function that matches
                   the following typedef:

                   typedef int (*sudo_hook_fn_getenv_t)(const char *name,
                      char **value, void *closure);

                   If the registered hook does not match the typedef the
                   results are unspecified.

             SUDO_HOOK_PUTENV
                   The C library <i>putenv</i>(3) function.  Any registered
                   hooks will run before the C library implementation.
                   The <i>hook_fn</i> field should be a function that matches
                   the following typedef:

                   typedef int (*sudo_hook_fn_putenv_t)(char *string,
                      void *closure);

                   If the registered hook does not match the typedef the
                   results are unspecified.

       <i>hook_fn</i>
             sudo_hook_fn_t hook_fn;

             The <i>hook_fn</i> field should be set to the plugin's hook
             implementation.  The actual function arguments will vary
             depending on the <i>hook_type</i> (see <i>hook_type</i> above).  In all
             cases, the <i>closure</i> field of <i>struct sudo_hook</i> is passed as
             the last function parameter.  This can be used to pass
             arbitrary data to the plugin's hook implementation.

             The function return value may be one of the following:

             SUDO_HOOK_RET_ERROR
                   The hook function encountered an error.

             SUDO_HOOK_RET_NEXT
                   The hook completed without error, go on to the next
                   hook (including the system implementation if
                   applicable).  For example, a <i>getenv</i>(3) hook might
                   return SUDO_HOOK_RET_NEXT if the specified variable
                   was not found in the private copy of the environment.

             SUDO_HOOK_RET_STOP
                   The hook completed without error, stop processing
                   hooks for this invocation.  This can be used to
                   replace the system implementation.  For example, a
                   <i>setenv</i> hook that operates on a private copy of the
                   environment but leaves <i>environ</i> unchanged.

       Care must be taken when hooking C library functions, it is very
       easy to create an infinite loop.  For example, a <i>getenv</i>(3) hook
       that calls the <i>snprintf</i>(3) function may create a loop if the
       <i>snprintf</i>(3) implementation calls <i>getenv</i>(3) to check the locale.
       To prevent this, you may wish to use a static variable in the
       hook function to guard against nested calls.  For example:

             static int in_progress = 0; /* avoid recursion */
             if (in_progress)
                 return SUDO_HOOK_RET_NEXT;
             in_progress = 1;
             ...
             in_progress = 0;
             return SUDO_HOOK_RET_STOP;

       <i>Hook API Version Macros</i>

       /* Hook API version major/minor */
       #define SUDO_HOOK_VERSION_MAJOR 1
       #define SUDO_HOOK_VERSION_MINOR 0
       #define SUDO_HOOK_VERSION SUDO_API_MKVERSION(SUDO_HOOK_VERSION_MAJOR,\
                                                     SUDO_HOOK_VERSION_MINOR)

       For getters and setters see the “Policy plugin API”.

   <b>Event API</b>
       When <b>sudo </b>runs a command, it uses an event loop to service
       signals and I/O.  Events may be triggered based on time, a file
       or socket descriptor becoming ready, or due to receipt of a
       signal.  Starting with API version 1.15, it is possible for a
       plugin to participate in this event loop by calling the
       <b>event_alloc</b>() function.

       <i>Event structure</i>

       Events are described by the following structure:

       typedef void (*sudo_plugin_ev_callback_t)(int fd, int what, void *closure);

       struct sudo_plugin_event {
           int (*set)(struct sudo_plugin_event *pev, int fd, int events,
               sudo_plugin_ev_callback_t callback, void *closure);
           int (*add)(struct sudo_plugin_event *pev, struct timespec *timeout);
           int (*del)(struct sudo_plugin_event *pev);
           int (*pending)(struct sudo_plugin_event *pev, int events,
               struct timespec *ts);
           int (*fd)(struct sudo_plugin_event *pev);
           void (*setbase)(struct sudo_plugin_event *pev, void *base);
           void (*loopbreak)(struct sudo_plugin_event *pev);
           void (*free)(struct sudo_plugin_event *pev);
       };

       A <i>struct sudo_plugin_event</i> contains the following function
       pointers:

       <i>set</i>
             int (*set)(struct sudo_plugin_event *pev, int fd, int events,
                 sudo_plugin_ev_callback_t callback, void *closure);

             The <b>set</b>() function takes the following arguments:

             <i>struct sudo_plugin_event *pev</i>
                   A pointer to the <i>struct sudo_plugin_event</i> itself.

             <i>fd</i>    The file or socket descriptor for I/O-based events or
                   the signal number for signal events.  For time-based
                   events, <i>fd</i> must be -1.

             <i>events</i>
                   The following values determine what will trigger the
                   event callback:

                   SUDO_PLUGIN_EV_TIMEOUT
                         callback is run after the specified timeout
                         expires

                   SUDO_PLUGIN_EV_READ
                         callback is run when the file descriptor is
                         readable

                   SUDO_PLUGIN_EV_WRITE
                         callback is run when the file descriptor is
                         writable

                   SUDO_PLUGIN_EV_PERSIST
                         event is persistent and remains enabled until
                         explicitly deleted

                   SUDO_PLUGIN_EV_SIGNAL
                         callback is run when the specified signal is
                         received

                   The SUDO_PLUGIN_EV_PERSIST flag may be ORed with any
                   of the event types.  It is also possible to OR
                   SUDO_PLUGIN_EV_READ and SUDO_PLUGIN_EV_WRITE together
                   to run the callback when a descriptor is ready to be
                   either read from or written to.  All other event
                   values are mutually exclusive.

             <i>sudo_plugin_ev_callback_t callback</i>
                   typedef void (*sudo_plugin_ev_callback_t)(int fd, int what,
                       void *closure);

                   The function to call when an event is triggered.  The
                   <b>callback</b>() function is run with the following
                   arguments:

                   <i>fd</i>    The file or socket descriptor for I/O-based
                         events or the signal number for signal events.

                   <i>what</i>  The event type that triggered that callback.
                         For events that have multiple event types (for
                         example SUDO_PLUGIN_EV_READ and
                         SUDO_PLUGIN_EV_WRITE) or have an associated
                         timeout, <i>what</i> can be used to determine why the
                         callback was run.

                   <i>closure</i>
                         The generic pointer that was specified in the
                         <b>set</b>() function.

             <i>closure</i>
                   A generic pointer that will be passed to the callback
                   function.

             The <b>set</b>() function returns 1 on success, and -1 if a error
             occurred.

       <i>add</i>
             int (*add)(struct sudo_plugin_event *pev, struct timespec *timeout);

             The <b>add</b>() function adds the event <i>pev</i> to <b>sudo</b>'s event loop.
             The event must have previously been initialized via the
             <b>set</b>() function.  If the <i>timeout</i> argument is not NULL, it
             should specify a (relative) timeout after which the event
             will be triggered if the main event criteria has not been
             met.  This is often used to implement an I/O timeout where
             the event will fire if a descriptor is not ready within a
             certain time period.  If the event is already present in
             the event loop, its <i>timeout</i> will be adjusted to match the
             new value, if any.

             The <b>add</b>() function returns 1 on success, and -1 if a error
             occurred.

       <i>del</i>
             int (*del)(struct sudo_plugin_event *pev);

             The <b>del</b>() function deletes the event <i>pev</i> from <b>sudo</b>'s event
             loop.  Deleted events can be added back via the <b>add</b>()
             function.

             The <b>del</b>() function returns 1 on success, and -1 if a error
             occurred.

       <i>pending</i>
             int (*pending)(struct sudo_plugin_event *pev, int events,
                 struct timespec *ts);

             The <b>pending</b>() function can be used to determine whether one
             or more events is pending.  The <i>events</i> argument specifies
             which events to check for.  See the <b>set</b>() function for a
             list of valid event types.  If SUDO_PLUGIN_EV_TIMEOUT is
             specified in <i>events</i>, the event has an associated timeout
             and the <i>ts</i> pointer is non-NULL, it will be filled in with
             the remaining time.

       <i>fd</i>
             int (*fd)(struct sudo_plugin_event *pev);

             The <b>fd</b>() function returns the descriptor or signal number
             associated with the event <i>pev</i>.

       <i>setbase</i>
             void (*setbase)(struct sudo_plugin_event *pev, void *base);

             The <b>setbase</b>() function sets the underlying event <i>base</i> for
             <i>pev</i> to the specified value.  This can be used to move an
             event created via <b>event_alloc</b>() to a new event loop
             allocated by sudo's event subsystem.  If <i>base</i> is NULL,
             <i>pev</i>'s event base is reset to the default value, which
             corresponds to <b>sudo</b>'s main event loop.  Using this function
             requires linking the plugin with the sudo_util library.  It
             is unlikely to be used outside of the <b>sudoers </b>plugin.

       <i>loopbreak</i>
             void (*loopbreak)(struct sudo_plugin_event *pev);

             The <b>loopbreak</b>() function causes <b>sudo</b>'s event loop to exit
             immediately and the running command to be terminated.

       <i>free</i>
             void (*free)(struct sudo_plugin_event *pev);

             The <b>free</b>() function deletes the event <i>pev</i> from the event
             loop and frees the memory associated with it.

   <b>Remote command execution</b>
       The <b>sudo </b>front-end does not support running remote commands.
       However, starting with <b>sudo </b>1.8.8, the <b>-h </b>option may be used to
       specify a remote host that is passed to the policy plugin.  A
       plugin may also accept a <i>runas_user</i> in the form of
       “user@hostname” which will work with older versions of <b>sudo</b>.  It
       is anticipated that remote commands will be supported by
       executing a “helper” program.  The policy plugin should setup the
       execution environment such that the <b>sudo </b>front-end will run the
       helper which, in turn, will connect to the remote host and run
       the command.

       For example, the policy plugin could utilize <b>ssh </b>to perform
       remote command execution.  The helper program would be
       responsible for running <b>ssh </b>with the proper options to use a
       private key or certificate that the remote host will accept and
       run a program on the remote host that would setup the execution
       environment accordingly.

       Remote <b>sudoedit </b>functionality must be handled by the policy
       plugin, not <b>sudo </b>itself as the front-end has no knowledge that a
       remote command is being executed.  This may be addressed in a
       future revision of the plugin API.

   <b>Conversation API</b>
       If the plugin needs to interact with the user, it may do so via
       the <b>conversation</b>() function.  A plugin should not attempt to read
       directly from the standard input or the user's terminal (neither
       of which are guaranteed to exist).  The caller must include a
       trailing newline in <i>msg</i> if one is to be printed.

       A <b>printf</b>()-style function is also available that can be used to
       display informational or error messages to the user, which is
       usually more convenient for simple messages where no use input is
       required.

       <i>Conversation function structures</i>

       The conversation function takes as arguments pointers to the
       following structures:

       struct sudo_conv_message {
       #define SUDO_CONV_PROMPT_ECHO_OFF  0x0001 /* do not echo user input */
       #define SUDO_CONV_PROMPT_ECHO_ON   0x0002 /* echo user input */
       #define SUDO_CONV_ERROR_MSG        0x0003 /* error message */
       #define SUDO_CONV_INFO_MSG         0x0004 /* informational message */
       #define SUDO_CONV_PROMPT_MASK      0x0005 /* mask user input */
       #define SUDO_CONV_PROMPT_ECHO_OK   0x1000 /* flag: allow echo if no tty */
       #define SUDO_CONV_PREFER_TTY       0x2000 /* flag: use tty if possible */
           int msg_type;
           int timeout;
           const char *msg;
       };

       #define SUDO_CONV_REPL_MAX      1023

       struct sudo_conv_reply {
           char *reply;
       };

       typedef int (*sudo_conv_callback_fn_t)(int signo, void *closure);
       struct sudo_conv_callback {
           unsigned int version;
           void *closure;
           sudo_conv_callback_fn_t on_suspend;
           sudo_conv_callback_fn_t on_resume;
       };

       Pointers to the <b>conversation</b>() and <b>printf</b>()-style functions are
       passed in to the plugin's <b>open</b>() function when the plugin is
       initialized.  The following type definitions can be used in the
       declaration of the <b>open</b>() function:

       typedef int (*sudo_conv_t)(int num_msgs,
           const struct sudo_conv_message msgs[],
           struct sudo_conv_reply replies[], struct sudo_conv_callback *callback);

       typedef int (*sudo_printf_t)(int msg_type, const char * restrict fmt, ...);

       To use the <b>conversation</b>() function, the plugin must pass an array
       of <i>struct sudo_conv_message</i> and <i>struct sudo_conv_reply</i>.  There
       must be a <i>struct sudo_conv_message</i> and <i>struct sudo_conv_reply</i> for
       each message in the conversation, that is, both arrays must have
       the same number of elements.  Each <i>struct sudo_conv_reply</i> must
       have its <i>reply</i> member initialized to NULL.  The <i>struct</i>
       <i>sudo_conv_callback</i> pointer, if not NULL, should contain function
       pointers to be called when the <b>sudo </b>process is suspended and/or
       resumed during conversation input.  The <i>on_suspend</i> and <i>on_resume</i>
       functions are called with the signal that caused <b>sudo </b>to be
       suspended and the <i>closure</i> pointer from the <i>struct</i>
       <i>sudo_conv_callback</i>.  These functions should return 0 on success
       and -1 on error.  On error, the conversation will end and the
       conversation function will return a value of -1.  The intended
       use is to allow the plugin to release resources, such as locks,
       that should not be held indefinitely while suspended and then
       reacquire them when the process is resumed.  The functions are
       not actually invoked from within a signal handler.

       The <i>msg_type</i> must be set to one of the following values:

       SUDO_CONV_PROMPT_ECHO_OFF
             Prompt the user for input with echo disabled; this is
             generally used for passwords.  The reply will be stored in
             the <i>replies</i> array, and it will never be NULL.

       SUDO_CONV_PROMPT_ECHO_ON
             Prompt the user for input with echo enabled.  The reply
             will be stored in the <i>replies</i> array, and it will never be
             NULL.

       SUDO_CONV_ERROR_MSG
             Display an error message.  The message is written to the
             standard error unless the SUDO_CONV_PREFER_TTY flag is set,
             in which case it is written to the user's terminal if
             possible.

       SUDO_CONV_INFO_MSG
             Display a message.  The message is written to the standard
             output unless the SUDO_CONV_PREFER_TTY flag is set, in
             which case it is written to the user's terminal if
             possible.

       SUDO_CONV_PROMPT_MASK
             Prompt the user for input but echo an asterisk character
             for each character read.  The reply will be stored in the
             <i>replies</i> array, and it will never be NULL.  This can be used
             to provide visual feedback to the user while reading
             sensitive information that should not be displayed.

       In addition to the above values, the following flag bits may also
       be set:

       SUDO_CONV_PROMPT_ECHO_OK
             Allow input to be read when echo cannot be disabled when
             the message type is SUDO_CONV_PROMPT_ECHO_OFF or
             SUDO_CONV_PROMPT_MASK.  By default, <b>sudo </b>will refuse to
             read input if the echo cannot be disabled for those message
             types.

       SUDO_CONV_PREFER_TTY
             When displaying a message via SUDO_CONV_ERROR_MSG or
             SUDO_CONV_INFO_MSG, try to write the message to the user's
             terminal.  If the terminal is unavailable, the standard
             error or standard output will be used, depending upon
             whether SUDO_CONV_ERROR_MSG or SUDO_CONV_INFO_MSG was used.
             The user's terminal is always used when possible for input,
             this flag is only used for output.

       The <i>timeout</i> in seconds until the prompt will wait for no more
       input.  A zero value implies an infinite timeout.

       The plugin is responsible for freeing the reply buffer located in
       each <i>struct sudo_conv_reply</i>, if it is not NULL.
       SUDO_CONV_REPL_MAX represents the maximum length of the reply
       buffer (not including the trailing NUL character).  In practical
       terms, this is the longest password <b>sudo </b>will support.

       The <b>printf</b>()-style function uses the same underlying mechanism as
       the <b>conversation</b>() function but only supports SUDO_CONV_INFO_MSG
       and SUDO_CONV_ERROR_MSG for the <i>msg_type</i> parameter.  It can be
       more convenient than using the <b>conversation</b>() function if no user
       reply is needed and supports standard <b>printf</b>() escape sequences.

       See the sample plugin for an example of the <b>conversation</b>()
       function usage.

   <b>Plugin invocation order</b>
       As of <b>sudo </b>1.9.0, the plugin <b>open</b>() and <b>close</b>() functions are
       called in the following order:

       1.   audit open

       2.   policy open

       3.   approval open

       4.   approval close

       5.   I/O log open

       6.   command runs

       7.   command exits

       8.   I/O log close

       9.   policy close

       10.  audit close

       11.  sudo exits

       Prior to <b>sudo </b>1.9.0, the I/O log <b>close</b>() function was called
       <i>after</i> the policy <b>close</b>() function.

   <b>Sudoers group plugin API</b>
       The <b>sudoers </b>plugin supports its own plugin interface to allow
       non-Unix group lookups.  This can be used to query a group source
       other than the standard Unix group database.  Two sample group
       plugins are bundled with <b>sudo</b>, <i>group_file</i>, and <i>system_group</i>, are
       detailed in <i>sudoers</i>(5).  Third party group plugins include a QAS
       AD plugin available from Quest Software.

       A group plugin must declare and populate a <i>struct</i>
       <i>sudoers_group_plugin</i> in the global scope.  This structure
       contains pointers to the functions that implement plugin
       initialization, cleanup, and group lookup.

       struct sudoers_group_plugin {
           unsigned int version;
           int (*init)(int version, sudo_printf_t sudo_plugin_printf,
               char *const argv[]);
           void (*cleanup)(void);
           int (*query)(const char *user, const char *group,
               const struct passwd *pwd);
       };

       A <i>struct sudoers_group_plugin</i> has the following fields:

       <i>version</i>
             The <i>version</i> field should be set to GROUP_API_VERSION.

             This allows <b>sudoers </b>to determine the API version the group
             plugin was built against.

       <i>init</i>
             int (*init)(int version, sudo_printf_t sudo_plugin_printf,
                 char *const argv[]);

             The <b>init</b>() function is called after <i>sudoers</i> has been parsed
             but before any policy checks.  It returns 1 on success, 0
             on failure (or if the plugin is not configured), and -1 if
             a error occurred.  If an error occurs, the plugin may call
             the <b>plugin_printf</b>() function with SUDO_CONF_ERROR_MSG to
             present additional error information to the user.

             The function arguments are as follows:

             <i>version</i>
                   The version passed in by <b>sudoers </b>allows the plugin to
                   determine the major and minor version number of the
                   group plugin API supported by <b>sudoers</b>.

             <i>plugin_printf</i>
                   A pointer to a <b>printf</b>()-style function that may be
                   used to display informational or error message to the
                   user.  Returns the number of characters printed on
                   success and -1 on failure.

             <i>argv</i>  A NULL-terminated array of arguments generated from
                   the <i>group_plugin</i> option in <i>sudoers</i>.  If no arguments
                   were given, <i>argv</i> will be NULL.

       <i>cleanup</i>
             void (*cleanup)();

             The <b>cleanup</b>() function is called when <b>sudoers </b>has finished
             its group checks.  The plugin should free any memory it has
             allocated and close open file handles.

       <i>query</i>
             int (*query)(const char *user, const char *group,
                 const struct passwd *pwd);

             The <b>query</b>() function is used to ask the group plugin
             whether <i>user</i> is a member of <i>group</i>.

             The function arguments are as follows:

             <i>user</i>  The name of the user being looked up in the external
                   group database.

             <i>group</i>
                   The name of the group being queried.

             <i>pwd</i>   The password database entry for <i>user</i>, if any.  If
                   <i>user</i> is not present in the password database, <i>pwd</i>
                   will be NULL.

       <i>Group API Version Macros</i>

       /* Sudoers group plugin version major/minor */
       #define GROUP_API_VERSION_MAJOR 1
       #define GROUP_API_VERSION_MINOR 0
       #define GROUP_API_VERSION ((GROUP_API_VERSION_MAJOR &lt;&lt; 16) | \
                                  GROUP_API_VERSION_MINOR)
       For getters and setters see the “Policy plugin API”.
</pre> <h2>
PLUGIN API CHANGELOG </h2>
<pre>
       The following revisions have been made to the Sudo Plugin API.

       Version 1.0
             Initial API version.

       Version 1.1 (sudo 1.8.0)
             The I/O logging plugin's <b>open</b>() function was modified to
             take the <i>command_info</i> list as an argument.

       Version 1.2 (sudo 1.8.5)
             The Policy and I/O logging plugins' <b>open</b>() functions are
             now passed a list of plugin parameters if any are specified
             in <i>sudo.conf</i>(5).

             A simple hooks API has been introduced to allow plugins to
             hook in to the system's environment handling functions.

             The <b>init_session</b>() Policy plugin function is now passed a
             pointer to the user environment which can be updated as
             needed.  This can be used to merge in environment variables
             stored in the PAM handle before a command is run.

       Version 1.3 (sudo 1.8.7)
             Support for the <i>exec_background</i> entry has been added to the
             <i>command_info</i> list.

             The <i>max_groups</i> and <i>plugin_dir</i> entries were added to the
             <i>settings</i> list.

             The <b>version</b>() and <b>close</b>() functions are now optional.
             Previously, a missing <b>version</b>() or <b>close</b>() function would
             result in a crash.  If no policy plugin <b>close</b>() function is
             defined, a default <b>close</b>() function will be provided by the
             <b>sudo </b>front-end that displays a warning if the command could
             not be executed.

             The <b>sudo </b>front-end now installs default signal handlers to
             trap common signals while the plugin functions are run.

       Version 1.4 (sudo 1.8.8)
             The <i>remote_host</i> entry was added to the <i>settings</i> list.

       Version 1.5 (sudo 1.8.9)
             The <i>preserve_fds</i> entry was added to the <i>command_info</i> list.

       Version 1.6 (sudo 1.8.11)
             The behavior when an I/O logging plugin returns an error
             (-1) has changed.  Previously, the <b>sudo </b>front-end took no
             action when the <b>log_ttyin</b>(), <b>log_ttyout</b>(), <b>log_stdin</b>(),
             <b>log_stdout</b>(), or <b>log_stderr</b>() function returned an error.

             The behavior when an I/O logging plugin returns 0 has
             changed.  Previously, output from the command would be
             displayed to the terminal even if an output logging
             function returned 0.

       Version 1.7 (sudo 1.8.12)
             The <i>plugin_path</i> entry was added to the <i>settings</i> list.

             The <i>debug_flags</i> entry now starts with a debug file path
             name and may occur multiple times if there are multiple
             plugin-specific Debug lines in the <i>sudo.conf</i>(5) file.

       Version 1.8 (sudo 1.8.15)
             The <i>sudoedit_checkdir</i> and <i>sudoedit_follow</i> entries were
             added to the <i>command_info</i> list.  The default value of
             <i>sudoedit_checkdir</i> was changed to true in sudo 1.8.16.

             The sudo <b>conversation</b>() function now takes a pointer to a
             <i>struct sudo_conv_callback</i> as its fourth argument.  The
             <i>sudo_conv_t</i> definition has been updated to match.  The
             plugin must specify that it supports plugin API version 1.8
             or higher to receive a conversation function pointer that
             supports this argument.

       Version 1.9 (sudo 1.8.16)
             The <i>execfd</i> entry was added to the <i>command_info</i> list.

       Version 1.10 (sudo 1.8.19)
             The <i>umask</i> entry was added to the <i>user_info</i> list.  The
             <i>iolog_group</i>, <i>iolog_mode</i>, and <i>iolog_user</i> entries were added
             to the <i>command_info</i> list.

       Version 1.11 (sudo 1.8.20)
             The <i>timeout</i> entry was added to the <i>settings</i> list.

       Version 1.12 (sudo 1.8.21)
             The <b>change_winsize</b>() function was added to <i>struct</i>
             <i>io_plugin</i>.

       Version 1.13 (sudo 1.8.26)
             The <b>log_suspend</b>() function was added to <i>struct io_plugin</i>.

       Version 1.14 (sudo 1.8.29)
             The <i>umask_override</i> entry was added to the <i>command_info</i>
             list.

       Version 1.15 (sudo 1.9.0)
             The <i>cwd_optional</i> entry was added to the <i>command_info</i> list.

             The <b>event_alloc</b>() function was added to <i>struct</i>
             <i>policy_plugin</i> and <i>struct io_plugin</i>.

             The <i>errstr</i> argument was added to the policy and I/O plugin
             functions which the plugin function can use to return an
             error string.  This string may be used by the audit plugin
             to report failure or error conditions set by the other
             plugins.

             The <b>close</b>() function is now is called regardless of whether
             or not a command was actually executed.  This makes it
             possible for plugins to perform cleanup even when a command
             was not run.

             SUDO_CONV_REPL_MAX has increased from 255 to 1023 bytes.

             Support for audit and approval plugins was added.

       Version 1.16 (sudo 1.9.3)
             Initial resource limit values were added to the <i>user_info</i>
             list.

             The <i>cmnd_chroot</i> and <i>cmnd_cwd</i> entries were added to the
             <i>settings</i> list.

       Version 1.17 (sudo 1.9.4)
             The <b>event_alloc</b>() function was added to <i>struct audit_plugin</i>
             and <i>struct approval_plugin</i>.

       Version 1.18 (sudo 1.9.9)
             The policy may now set resource limit values in the
             <i>command_info</i> list.  The <i>intercept</i> and <i>log_subcmds</i> entries
             were added to the <i>command_info</i> list.

       Version 1.19 (sudo 1.9.11)
             The <i>intercept_ptrace</i> and <i>intercept_setid</i> entries were added
             to the <i>settings</i> list.  The <i>apparmor_profile</i> and <i>use_ptrace</i>
             entries were added to the <i>command_info</i> list.

       Version 1.20 (sudo 1.9.12)
             The <i>update_ticket</i> entry was added to the <i>settings</i> list.
             The <i>intercept_verify</i> entry was added to the <i>command_info</i>
             list.

       Version 1.21 (sudo 1.9.13)
             The <i>sudoedit_nfiles</i> entry was added to the <i>command_info</i>
             list.

       Version 1.22 (sudo 1.9.16)
             The <i>ttydev</i> entry was added to the <i>user_info</i> list.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <i>sudo.conf</i>(5), <i>sudoers</i>(5), <i>sudo</i>(8)
</pre> <h2>
AUTHORS </h2>
<pre>
       Many people have worked on <b>sudo </b>over the years; this version
       consists of code written primarily by:

             Todd C. Miller

       See the CONTRIBUTORS.md file in the <b>sudo </b>distribution
       (<a href="https://www.sudo.ws/about/contributors/">https://www.sudo.ws/about/contributors/</a>) for an exhaustive list
       of people who have contributed to <b>sudo</b>.
</pre> <h2>
BUGS </h2>
<pre>
       If you believe you have found a bug in , you can either file a
       bug report in the sudo bug database, <a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>,
       or open an issue at <a href="https://github.com/sudo-project/sudo/issues">https://github.com/sudo-project/sudo/issues</a>.
       If you would prefer to use email, messages may be sent to the
       sudo-workers mailing list,
       <a href="https://www.sudo.ws/mailman/listinfo/sudo-workers">https://www.sudo.ws/mailman/listinfo/sudo-workers</a> (public) or
       &lt;sudo@sudo.ws&gt; (private).

       Please not report security vulnerabilities through public GitHub
       issues, Bugzilla or mailing lists.  Instead, report them via
       email to &lt;Todd.Miller@sudo.ws&gt;.  You may encrypt your message
       with PGP if you would like, using the key found at
       <a href="https://www.sudo.ws/dist/PGPKEYS">https://www.sudo.ws/dist/PGPKEYS</a>.
</pre> <h2>
SUPPORT </h2>
<pre>
       Limited free support is available via the sudo-users mailing
       list, see <a href="https://www.sudo.ws/mailman/listinfo/sudo-users">https://www.sudo.ws/mailman/listinfo/sudo-users</a> to
       subscribe or search the archives.
</pre> <h2>
DISCLAIMER </h2>
<pre>
       <b>sudo </b>is provided “AS IS” and any express or implied warranties,
       including, but not limited to, the implied warranties of
       merchantability and fitness for a particular purpose are
       disclaimed.  See the LICENSE.md file distributed with <b>sudo </b>or
       <a href="https://www.sudo.ws/about/license/">https://www.sudo.ws/about/license/</a> for complete details.
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>sudo</i> (execute a command as another user)
       project.  Information about the project can be found at
       <a href="https://www.sudo.ws/">https://www.sudo.ws/</a>.  If you have a bug report for this manual
       page, see ⟨<a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>⟩.  This page was obtained
       from the project's upstream Git repository
       ⟨<a href="https://github.com/sudo-project/sudo">https://github.com/sudo-project/sudo</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-06-08.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Sudo 1.9.16                 November 25, 2023             <i>SUDO_PLUGIN</i>(5)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man5/sudo_plugin.5.html" class="_attribution-link">https://man7.org/linux/man-pages/man5/sudo_plugin.5.html</a>
  </p>
</div>
