<h1>sudoers(5) — Linux manual page</h1>   <pre>
<span class="headline"><i>SUDOERS</i>(5)                 File Formats Manual                <i>SUDOERS</i>(5)</span>
</pre> <h2>
NAME </h2>
<pre>
       <b>sudoers </b>— default sudo security policy plugin
</pre> <h2>
DESCRIPTION </h2>
<pre>
       The <b>sudoers </b>policy plugin determines a user's <b>sudo </b>privileges.
       It is the default <b>sudo </b>policy plugin.  The policy is driven by
       the <i>/etc/sudoers</i> file or, optionally, in LDAP.  The policy format
       is described in detail in the “SUDOERS FILE FORMAT” section.  For
       information on storing <b>sudoers </b>policy information in LDAP, see
       <i>sudoers.ldap</i>(5).

   <b>Configuring sudo.conf for sudoers</b>
       <b>sudo </b>consults the <i>sudo.conf</i>(5) file to determine which plugins to
       load.  If no <i>sudo.conf</i>(5) file is present, or if it contains no
       <i>Plugin</i> lines, <b>sudoers </b>will be used for auditing, policy decisions
       and I/O logging.  To explicitly configure <i>sudo.conf</i>(5) to use the
       <b>sudoers </b>plugin, the following configuration can be used.

           Plugin sudoers_audit sudoers.so
           Plugin sudoers_policy sudoers.so
           Plugin sudoers_io sudoers.so

       Starting with <b>sudo </b>1.8.5, it is possible to specify optional
       arguments to the <b>sudoers </b>plugin in the <i>sudo.conf</i>(5) file.  Plugin
       arguments, if any, should be listed after the path to the plugin
       (i.e., after <i>sudoers.so</i>).  The arguments are only effective for
       the plugin that opens (and parses) the <i>sudoers</i> file.

       For <b>sudo </b>version 1.9.1 and higher, this is the <i>sudoers_audit</i>
       plugin.  For older versions, it is the <i>sudoers_policy</i> plugin.
       Multiple arguments may be specified, separated by white space.
       For example:

           Plugin sudoers_audit sudoers.so sudoers_mode=0400 error_recovery=false

       The following plugin arguments are supported:

       error_recovery=bool
             The <i>error_recovery</i> argument can be used to control whether
             <b>sudoers </b>should attempt to recover from syntax errors in the
             <i>sudoers</i> file.  If set to <i>true</i> (the default), <b>sudoers </b>will
             try to recover from a syntax error by discarding the
             portion of the line that contains the error until the end
             of the line.  A value of <i>false</i> will disable error recovery.
             Prior to version 1.9.3, no error recovery was performed.

       ignore_perms=bool
             The <i>ignore_perms</i> argument can be used to disable security
             checks when loading the <i>sudoers</i> file.  If enabled, the
             <i>sudoers</i> file will be loaded regardless of the owner or file
             mode.  This argument is intended to be used for testing
             purposes and should not be enabled on production systems.

       ldap_conf=pathname
             The <i>ldap_conf</i> argument can be used to override the default
             path to the <i>ldap.conf</i> file.

       ldap_secret=pathname
             The <i>ldap_secret</i> argument can be used to override the
             default path to the <i>ldap.secret</i> file.

       sudoers_file=pathname
             The <i>sudoers_file</i> argument can be used to override the
             default path to the <i>sudoers</i> file.

       sudoers_uid=user-ID
             The <i>sudoers_uid</i> argument can be used to override the
             default owner of the sudoers file.  It should be specified
             as a numeric user-ID.

       sudoers_gid=group-ID
             The <i>sudoers_gid</i> argument can be used to override the
             default group of the sudoers file.  It must be specified as
             a numeric group-ID (not a group name).

       sudoers_mode=mode
             The <i>sudoers_mode</i> argument can be used to override the
             default file mode for the sudoers file.  It should be
             specified as an octal value.

       For more information on configuring <i>sudo.conf</i>(5), refer to its
       manual.

   <b>User Authentication</b>
       The <b>sudoers </b>security policy requires that most users authenticate
       themselves before they can use <b>sudo</b>.  A password is not required
       if the invoking user is <b>root</b>, if the target user is the same as
       the invoking user, or if the policy has disabled authentication
       for the user or command.  Unlike <i>su</i>(1), when <b>sudoers </b>requires
       authentication, it validates the invoking user's credentials, not
       the target user's (or <b>root</b>'s) credentials.  This can be changed
       via the <i>rootpw</i>, <i>targetpw</i> and <i>runaspw</i> flags, described later.

       If a user who is not listed in the policy tries to run a command
       via <b>sudo</b>, mail is sent to the proper authorities.  The address
       used for such mail is configurable via the <i>mailto</i> Defaults entry
       (described later) and defaults to <i>root</i>.

       No mail will be sent if an unauthorized user tries to run <b>sudo</b>
       with the <b>-l </b>or <b>-v </b>option unless there is an authentication error
       and either the <i>mail_always</i> or <i>mail_badpass</i> flags are enabled.
       This allows users to determine for themselves whether or not they
       are allowed to use <b>sudo</b>.  By default, all attempts to run <b>sudo</b>
       (successful or not) are logged, regardless of whether or not mail
       is sent.

       If <b>sudo </b>is run by <b>root </b>and the SUDO_USER environment variable is
       set, the <b>sudoers </b>policy will use this value to determine who the
       actual user is.  This can be used by a user to log commands
       through sudo even when a <b>root </b>shell has been invoked.  It also
       allows the <b>-e </b>option to remain useful even when invoked via a
       sudo-run script or program.  Note, however, that the <i>sudoers</i> file
       lookup is still done for <b>root</b>, not the user specified by
       SUDO_USER.

       <b>sudoers </b>uses per-user time stamp files for credential caching.
       Once a user has been authenticated, a record is written
       containing the user-ID that was used to authenticate, the
       terminal session ID, the start time of the session leader (or
       parent process) and a time stamp (using a monotonic clock if one
       is available).  The user may then use <b>sudo </b>without a password for
       a short period of time (5 minutes unless overridden by the
       <i>timestamp_timeout</i> option).  By default, <b>sudoers </b>uses a separate
       record for each terminal, which means that a user's login
       sessions are authenticated separately.  The <i>timestamp_type</i> option
       can be used to select the type of time stamp record <b>sudoers </b>will
       use.

       The <b>tsdump </b>utility, included with the sudo source distribution,
       can be used to display the contents of a time stamp file.  See
       <i>sudoers_timestamp</i>(5) for details of the time stamp file format.

   <b>Logging</b>
       By default, <b>sudoers </b>logs both successful and unsuccessful
       attempts (as well as errors).  The <i>log_allowed</i> and <i>log_denied</i>
       flags can be used to control this behavior.  Messages can be
       logged to <i>syslog</i>(3), a log file, or both.  The default is to log
       to <i>syslog</i>(3) but this is configurable via the <i>syslog</i> and <i>logfile</i>
       settings.  See “EVENT LOGGING” for a description of the log file
       format.

       <b>sudoers </b>is also capable of running a command in a pseudo-terminal
       and logging input and/or output.  The standard input, standard
       output, and standard error can be logged even when not associated
       with a terminal.  For more information about I/O logging, see the
       “I/O LOGGING” section.

       Starting with version 1.9, the <i>log_servers</i> setting may be used to
       send event and I/O log data to a remote server running
       <b>sudo_logsrvd </b>or another service that implements the protocol
       described by <i>sudo_logsrv.proto</i>(5).

   <b>Command environment</b>
       Since environment variables can influence program behavior,
       <b>sudoers </b>provides a means to restrict which variables from the
       user's environment are inherited by the command to be run.  There
       are two distinct ways <b>sudoers </b>can deal with environment
       variables.

       By default, the <i>env_reset</i> flag is enabled.  This causes commands
       to be executed with a new, minimal environment.  On AIX (and
       Linux systems without PAM), the environment is initialized with
       the contents of the <i>/etc/environment</i> file.  The HOME, MAIL,
       SHELL, LOGNAME and USER environment variables are initialized
       based on the target user and the SUDO_* variables are set based
       on the invoking user.  Additional variables, such as DISPLAY,
       PATH and TERM, are preserved from the invoking user's environment
       if permitted by the <i>env_check</i>, or <i>env_keep</i> options.  A few
       environment variables are treated specially.  If the PATH and
       TERM variables are not preserved from the user's environment,
       they will be set to default values.  The LOGNAME and USER are
       handled as a single entity.  If one of them is preserved (or
       removed) from the user's environment, the other will be as well.
       If LOGNAME and USER are to be preserved but only one of them is
       present in the user's environment, the other will be set to the
       same value.  This avoids an inconsistent environment where one of
       the variables describing the user name is set to the invoking
       user and one is set to the target user.  Environment variables
       with a value beginning with ‘()’ are removed unless both the name
       and value parts are matched by <i>env_keep</i> or <i>env_check</i>, as they may
       be interpreted as functions by the <b>bash </b>shell.  Prior to version
       1.8.11, such variables were always removed.

       If, however, the <i>env_reset</i> flag is disabled, any variables not
       explicitly denied by the <i>env_check</i> and <i>env_delete</i> options are
       allowed and their values are inherited from the invoking process.
       Prior to version 1.8.21, environment variables with a value
       beginning with ‘()’ were always removed.  Beginning with version
       1.8.21, a pattern in <i>env_delete</i> is used to match <b>bash </b>shell
       functions instead.  Since it is not possible to block all
       potentially dangerous environment variables, use of the default
       <i>env_reset</i> behavior is encouraged.

       Environment variables specified by <i>env_check</i>, <i>env_delete</i>, or
       <i>env_keep</i> may include one or more ‘*’ characters which will match
       zero or more characters.  No other wildcard characters are
       supported.

       By default, environment variables are matched by name.  However,
       if the pattern includes an equal sign (‘=’), both the variables
       name and value must match.  For example, a <b>bash </b>shell function
       could be matched as follows:

           env_keep += "BASH_FUNC_my_func%%=()*"

       Without the ‘=()*’ suffix, this would not match, as <b>bash </b>shell
       functions are not preserved by default.

       The complete list of environment variables that are preserved or
       removed, as modified by global Defaults parameters in <i>sudoers</i>, is
       displayed when <b>sudo </b>is run by <b>root </b>with the <b>-V </b>option.  The list
       of environment variables to remove varies based on the operating
       system <b>sudo </b>is running on.

       Other settings may influence the command environment:

       <b>•  sudoers </b>options such as <i>always_set_home</i>, <i>secure_path</i>,
          <i>set_logname</i>, <i>set_home</i>, and <i>setenv</i>.

       <b>•  </b>Command tags, such as SETENV and NOSETENV.  Note that SETENV
          is implied if the command matched is <b>ALL</b>.

       <b>•  sudo </b>options, such as <b>-E </b>and <b>-i</b>.

       On systems that support PAM where the <b>pam_env </b>module is enabled
       for <b>sudo</b>, variables in the PAM environment may be merged in to
       the environment.  If a variable in the PAM environment is already
       present in the user's environment, the value will only be
       overridden if the variable was not preserved by <b>sudoers</b>.  When
       <i>env_reset</i> is enabled, variables preserved from the invoking
       user's environment by the <i>env_keep</i> list take precedence over
       those in the PAM environment.  When <i>env_reset</i> is disabled,
       variables present the invoking user's environment take precedence
       over those in the PAM environment unless they match a pattern in
       the <i>env_delete</i> list.

       The dynamic linker on most operating systems will remove
       variables that can control dynamic linking from the environment
       of set-user-ID executables, including <b>sudo</b>.  Depending on the
       operating system this may include _RLD*, DYLD_*, LD_*, LDR_*,
       LIBPATH, SHLIB_PATH, and others.  These type of variables are
       removed from the environment before <b>sudo </b>even begins execution
       and, as such, it is not possible for <b>sudo </b>to preserve them.

       As a special case, if the <b>-i </b>option (initial login) is specified,
       <b>sudoers </b>will initialize the environment regardless of the value
       of <i>env_reset</i>.  The DISPLAY, PATH and TERM variables remain
       unchanged; HOME, MAIL, SHELL, USER, and LOGNAME are set based on
       the target user.  On AIX (and Linux systems without PAM), the
       contents of <i>/etc/environment</i> are also included.  All other
       environment variables are removed unless permitted by <i>env_keep</i> or
       <i>env_check</i>, described above.

       Finally, the <i>restricted_env_file</i> and <i>env_file</i> files are applied,
       if present.  The variables in <i>restricted_env_file</i> are applied
       first and are subject to the same restrictions as the invoking
       user's environment, as detailed above.  The variables in <i>env_file</i>
       are applied last and are not subject to these restrictions.  In
       both cases, variables present in the files will only be set to
       their specified values if they would not conflict with an
       existing environment variable.
</pre> <h2>
SUDOERS FILE FORMAT </h2>
<pre>
       The <i>sudoers</i> file is composed of two types of entries: aliases
       (basically variables) and user specifications (which specify who
       may run what).

       When multiple entries match for a user, they are applied in
       order.  Where there are multiple matches, the last match is used
       (which is not necessarily the most specific match).

       The <i>sudoers</i> file grammar will be described below in Extended
       Backus-Naur Form (EBNF).  Don't despair if you are unfamiliar
       with EBNF; it is fairly simple, and the definitions below are
       annotated.

   <b>Resource limits</b>
       By default, <b>sudoers </b>uses the operating system's native method of
       setting resource limits for the target user.  On Linux systems,
       resource limits are usually set by the <i>pam_limits.so</i> PAM module.
       On some BSD systems, the <i>/etc/login.conf</i> file specifies resource
       limits for the user.  On AIX systems, resource limits are
       configured in the <i>/etc/security/limits</i> file.  If there is no
       system mechanism to set per-user resource limits, the command
       will run with the same limits as the invoking user.  The one
       exception to this is the core dump file size, which is set by
       <b>sudoers </b>to 0 by default.  Disabling core dumps by default makes
       it possible to avoid potential security problems where the core
       file is treated as trusted input.

       Resource limits may also be set in the <i>sudoers</i> file itself, in
       which case they override those set by the system.  See the
       <i>rlimit_as, rlimit_core, rlimit_cpu, rlimit_data, rlimit_fsize,</i>
       <i>rlimit_locks, rlimit_memlock, rlimit_nofile, rlimit_nproc,</i>
       <i>rlimit_rss, rlimit_stack</i> options described below.  Resource
       limits in <b>sudoers </b>may be specified in one of the following
       formats:

       “value”
               Both the soft and hard resource limits are set to the
               same value.  The special value “infinity” can be used to
               indicate that the value is unlimited.

       “soft,hard”
               Two comma-separated values.  The soft limit is set to the
               first value and the hard limit is set to the second.
               Both values must either be enclosed in a set of double
               quotes, or the comma must be escaped with a backslash
               (‘\’).  The special value “infinity” may be used in place
               of either value.

       “default”
               The default resource limit for the user will be used.
               This may be a user-specific value (see above) or the
               value of the resource limit when <b>sudo </b>was invoked for
               systems that don't support per-user limits.

       “user”  The invoking user's resource limits will be preserved
               when running the command.

       For example, to restore the historic core dump file size
       behavior, a line like the following may be used.

             <b>Defaults rlimit_core=default</b>

       Resource limits in <b>sudoers </b>are only supported by version 1.8.7 or
       higher.

   <b>Quick guide to EBNF</b>
       EBNF is a concise and exact way of describing the grammar of a
       language.  Each EBNF definition is made up of <i>production rules</i>.
       For example:

           symbol ::= definition | alternate1 | alternate2 ...

       Each <i>production rule</i> references others and thus makes up a
       grammar for the language.  EBNF also contains the following
       operators, which many readers will recognize from regular
       expressions.  Do not, however, confuse them with “wildcard”
       characters, which have different meanings.

       ?     Means that the preceding symbol (or group of symbols) is
             optional.  That is, it may appear once or not at all.

       *     Means that the preceding symbol (or group of symbols) may
             appear zero or more times.

       +     Means that the preceding symbol (or group of symbols) may
             appear one or more times.

       Parentheses may be used to group symbols together.  For clarity,
       we will use single quotes ('') to designate what is a verbatim
       character string (as opposed to a symbol name).

   <b>Aliases</b>
       There are four kinds of aliases: <i>User_Alias</i>, <i>Runas_Alias</i>,
       <i>Host_Alias</i> and <i>Cmnd_Alias</i>.  Beginning with <b>sudo </b>1.9.0, <i>Cmd_Alias</i>
       may be used in place of <i>Cmnd_Alias</i> if desired.

       Alias ::= 'User_Alias'  User_Alias_Spec (':' User_Alias_Spec)* |
                 'Runas_Alias' Runas_Alias_Spec (':' Runas_Alias_Spec)* |
                 'Host_Alias'  Host_Alias_Spec (':' Host_Alias_Spec)* |
                 'Cmnd_Alias'  Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)* |
                 'Cmd_Alias'   Cmnd_Alias_Spec (':' Cmnd_Alias_Spec)*

       User_Alias ::= NAME

       User_Alias_Spec ::= User_Alias '=' User_List

       Runas_Alias ::= NAME

       Runas_Alias_Spec ::= Runas_Alias '=' Runas_List

       Host_Alias ::= NAME

       Host_Alias_Spec ::= Host_Alias '=' Host_List

       Cmnd_Alias ::= NAME

       Cmnd_Alias_Spec ::= Cmnd_Alias '=' Cmnd_List

       NAME ::= [A-Z]([A-Z][0-9]_)*

       Each <i>alias</i> definition is of the form

       Alias_Type NAME = item1, item2, ...

       where <i>Alias_Type</i> is one of <i>User_Alias</i>, <i>Runas_Alias</i>, <i>Host_Alias</i>,
       or <i>Cmnd_Alias</i>.  A NAME is a string of uppercase letters, numbers,
       and underscore characters (‘_’).  A NAME <b>must </b>start with an
       uppercase letter.  It is possible to put several alias
       definitions of the same type on a single line, joined by a colon
       (‘:’).  For example:

       Alias_Type NAME = item1, item2, item3 : NAME = item4, item5

       It is a syntax error to redefine an existing <i>alias</i>.  It is
       possible to use the same name for <i>aliases</i> of different types, but
       this is not recommended.

       The definitions of what constitutes a valid <i>alias</i> member follow.

       User_List ::= User |
                     User ',' User_List

       User ::= '!'* user name |
                '!'* #user-ID |
                '!'* %group |
                '!'* %#group-ID |
                '!'* +netgroup |
                '!'* %:nonunix_group |
                '!'* %:#nonunix_gid |
                '!'* User_Alias

       A <i>User_List</i> is made up of one or more user names, user-IDs
       (prefixed with ‘#’), system group names and IDs (prefixed with
       ‘%’ and ‘%#’ respectively), netgroups (prefixed with ‘+’), non-
       Unix group names and IDs (prefixed with ‘%:’ and ‘%:#’
       respectively), and <i>User_Alias</i>es. Each list item may be prefixed
       with zero or more ‘!’ operators.  An odd number of ‘!’ operators
       negate the value of the item; an even number just cancel each
       other out.  User netgroups are matched using the user and domain
       members only; the host member is not used when matching.

       A <i>user name</i>, <i>user-ID</i>, <i>group</i>, <i>group-ID</i>, <i>netgroup</i>, <i>nonunix_group</i> or
       <i>nonunix_gid</i> may be enclosed in double quotes to avoid the need
       for escaping special characters.  Alternately, special characters
       may be specified in escaped hex mode, e.g., \x20 for space.  When
       using double quotes, any prefix characters must be included
       inside the quotes.

       The actual <i>nonunix_group</i> and <i>nonunix_gid</i> syntax depends on the
       underlying group provider plugin.  For instance, the QAS AD
       plugin supports the following formats:

       <b>•  </b>Group in the same domain: "%:Group Name"

       <b>•  </b>Group in any domain: "%:Group Name@FULLY.QUALIFIED.DOMAIN"

       <b>•  </b>Group SID: "%:S-1-2-34-5678901234-5678901234-5678901234-567"

       See “GROUP PROVIDER PLUGINS” for more information.

       Quotes around group names are optional.  Unquoted strings must
       use a backslash (‘\’) to escape spaces and special characters.
       See “Other special characters and reserved words” for a list of
       characters that need to be escaped.

       Runas_List ::= Runas_Member |
                      Runas_Member ',' Runas_List

       Runas_Member ::= '!'* user name |
                        '!'* #user-ID |
                        '!'* %group |
                        '!'* %#group-ID |
                        '!'* %:nonunix_group |
                        '!'* %:#nonunix_gid |
                        '!'* +netgroup |
                        '!'* Runas_Alias |
                        '!'* ALL

       A <i>Runas_List</i> is similar to a <i>User_List</i> except that instead of
       <i>User_Alias</i>es it can contain <i>Runas_Alias</i>es.  User names and groups
       are matched as strings.  In other words, two users (groups) with
       the same user (group) ID are considered to be distinct.  If you
       wish to match all user names with the same user-ID (e.g., <b>root</b>
       and <b>toor</b>), you can use a user-ID instead of a name (#0 in the
       example given).  The user-ID or group-ID specified in a
       <i>Runas_Member</i> need not be listed in the password or group
       database.

       Host_List ::= Host |
                     Host ',' Host_List

       Host ::= '!'* host name |
                '!'* ip_addr |
                '!'* network(/netmask)? |
                '!'* +netgroup |
                '!'* Host_Alias |
                '!'* ALL

       A <i>Host_List</i> is made up of one or more host names, IP addresses,
       network numbers, netgroups (prefixed with ‘+’), and other
       aliases.  Again, the value of an item may be negated with the ‘!’
       operator.  Host netgroups are matched using the host (both
       qualified and unqualified) and domain members only; the user
       member is not used when matching.  If you specify a network
       number without a netmask, <b>sudo </b>will query each of the local
       host's network interfaces and, if the network number corresponds
       to one of the hosts's network interfaces, will use the netmask of
       that interface.  The netmask may be specified either in standard
       IP address notation (e.g., 255.255.255.0 or
       ffff:ffff:ffff:ffff::), or CIDR notation (number of bits, e.g.,
       24 or 64).  A host name may include shell-style wildcards (see
       the “Wildcards” section below), but unless the <i>hostname</i> command
       on your machine returns the fully qualified host name, you'll
       need to use the <i>fqdn</i> flag for wildcards to be useful.  <b>sudo </b>only
       inspects actual network interfaces; this means that IP address
       127.0.0.1 (localhost) will never match.  Also, the host name
       “localhost” will only match if that is the actual host name,
       which is usually only the case for non-networked systems.

       digest ::= [A-Fa-f0-9]+ |
                  [A-Za-z0-9\+/=]+

       Digest_Spec ::= "sha224" ':' digest |
                       "sha256" ':' digest |
                       "sha384" ':' digest |
                       "sha512" ':' digest

       Digest_List ::= Digest_Spec |
                       Digest_Spec ',' Digest_List

       Cmnd_List ::= Cmnd |
                     Cmnd ',' Cmnd_List

       command name ::= regex |
                        file name

       command ::= command name |
                   command name args |
                   command name regex |
                   command name '""' |
                   ALL

       Edit_Spec ::= "sudoedit" file name+ |
                     "sudoedit" regex |
                     "sudoedit"

       List_Spec ::= "list"

       Cmnd ::= Digest_List? '!'* command |
                '!'* directory |
                '!'* Edit_Spec |
                '!'* List_Spec |
                '!'* Cmnd_Alias

       A <i>Cmnd_List</i> is a list of one or more commands, directories, or
       aliases.  A command is a fully qualified file name, which may
       include shell-style wildcards (see the “Wildcards” section
       below), or a regular expression that starts with ‘^’ and ends
       with ‘$’ (see the “Regular expressions” section below).  A
       directory is a fully qualified path name ending in a ‘/’.  When
       you specify a directory in a <i>Cmnd_List</i>, the user will be able to
       run any file within that directory (but not in any sub-
       directories therein).  If no command line arguments are
       specified, the user may run the command with any arguments they
       choose.  Command line arguments can include wildcards or be a
       regular expression that starts with ‘^’ and ends with ‘$’.  If
       the command line arguments consist of ‘""’, the command may only
       be run with <i>no</i> arguments.

       If a <i>Cmnd</i> has associated command line arguments, the arguments in
       the <i>Cmnd</i> must match those given by the user on the command line.
       If the arguments in a <i>Cmnd</i> begin with the ‘^’ character, they
       will be interpreted as a regular expression and matched
       accordingly.  Otherwise, shell-style wildcards are used when
       matching.  Unless a regular expression is specified, the
       following characters must be escaped with a ‘\’ if they are used
       in command arguments: ‘,’, ‘:’, ‘=’, ‘\’.  To prevent arguments
       in a <i>Cmnd</i> that begin with a ‘^’ character from being interpreted
       as a regular expression, the ‘^’ must be escaped with a ‘\’.

       There are two commands built into <b>sudo </b>itself: “list” and
       “sudoedit”.  Unlike other commands, these two must be specified
       in the <i>sudoers</i> file <i>without</i> a leading path.

       The “list” built-in can be used to permit a user to list another
       user's privileges with <b>sudo</b>'s <b>-U </b>option.  For example, “sudo -l
       -U otheruser”.  A user with the “list” privilege is able to list
       another user's privileges even if they don't have permission to
       run commands as that user.  By default, only root or a user with
       the ability to run any command as either root or the specified
       <i>user</i> on the current host may use the <b>-U </b>option.  No command line
       arguments may be specified with the “list” built-in.

       The “sudoedit” built-in is used to permit a user to run <b>sudo </b>with
       the <b>-e </b>option (or as <b>sudoedit</b>).  It may take command line
       arguments just as a normal command does.  Unlike other commands,
       “sudoedit” is built into <b>sudo </b>itself and must be specified in the
       <i>sudoers</i> file <i>without</i> a leading path.  If a leading path is
       present, for example <i>/usr/bin/sudoedit</i>, the path name will be
       silently converted to “sudoedit”.  A fully-qualified path for
       <b>sudoedit </b>is treated as an error by <b>visudo</b>.

       A <i>command</i> may be preceded by a <i>Digest_List</i>, a comma-separated
       list of one or more <i>Digest_Spec</i> entries.  If a <i>Digest_List</i> is
       present, the command will only match successfully if it can be
       verified using one of the SHA-2 digests in the list.  Starting
       with version 1.9.0, the <b>ALL </b>reserved word can be used in
       conjunction with a <i>Digest_List</i>.  The following digest formats are
       supported: sha224, sha256, sha384, and sha512.  The string may be
       specified in either hex or base64 format (base64 is more
       compact).  There are several utilities capable of generating
       SHA-2 digests in hex format such as openssl, shasum, sha224sum,
       sha256sum, sha384sum, sha512sum.

       For example, using openssl:

       $ openssl dgst -sha224 /bin/ls
       SHA224(/bin/ls)= 118187da8364d490b4a7debbf483004e8f3e053ec954309de2c41a25

       It is also possible to use openssl to generate base64 output:

       $ openssl dgst -binary -sha224 /bin/ls | openssl base64
       EYGH2oNk1JC0p9679IMATo8+BT7JVDCd4sQaJQ==

       Warning, if the user has write access to the command itself
       (directly or via a <b>sudo </b>command), it may be possible for the user
       to replace the command after the digest check has been performed
       but before the command is executed.  A similar race condition
       exists on systems that lack the <i>fexecve</i>(2) system call when the
       directory in which the command is located is writable by the
       user.  See the description of the <i>fdexec</i> setting for more
       information on how <b>sudo </b>executes commands that have an associated
       digest.

       Command digests are only supported by version 1.8.7 or higher.

   <b>Defaults</b>
       Certain configuration options may be changed from their default
       values at run-time via one or more <i>Default_Entry</i> lines.  These
       may affect all users on any host (‘Defaults’), all users on a
       specific host (‘Defaults@host’), a specific user
       (‘Defaults:user’), a specific command (‘Defaults!cmnd’), or
       commands being run as a specific user (‘Defaults&gt;runasuser’).

       White space is not permitted between ‘Defaults’ and the ‘@’, ‘:’,
       ‘!’, or ‘&gt;’ characters.  While a comma-separated list may be used
       in place of a single value after the ‘@’, ‘:’, ‘!’, or ‘&gt;’
       character, using an alias instead of a list is often improve
       readability.  Per-command entries may not include command line
       arguments.  If you need to specify arguments, define a <i>Cmnd_Alias</i>
       and reference that instead.

       Default_Type ::= 'Defaults' |
                        'Defaults@' Host_List |
                        'Defaults:' User_List |
                        'Defaults!' Cmnd_List |
                        'Defaults&gt;' Runas_List

       Default_Entry ::= Default_Type Parameter_List

       Parameter_List ::= Parameter |
                          Parameter ',' Parameter_List

       Parameter ::= Parameter '=' Value |
                     Parameter '+=' Value |
                     Parameter '-=' Value |
                     '!'* Parameter

       Parameters may be <b>flags</b>, <b>integer </b>values, <b>strings</b>, or <b>lists</b>.
       Flags are implicitly boolean and can be turned off via the ‘!’
       operator.  Some integer, string and list parameters may also be
       used in a boolean context to disable them.  Values may be
       enclosed in double quotes ("") when they contain multiple words.
       Special characters may be escaped with a backslash (‘\’).

       To include a literal backslash character in a command line
       argument you must escape the backslash twice.  For example, to
       match ‘\n’ as part of a command line argument, you must use
       ‘\\\\n’ in the <i>sudoers</i> file.  This is due to there being two
       levels of escaping, one in the <i>sudoers</i> parser itself and another
       when command line arguments are matched by the <i>fnmatch</i>(3) or
       <i>regexec</i>(3) function.

       Lists have two additional assignment operators, ‘+=’ and ‘-=’.
       These operators are used to add to and delete from a list
       respectively.  It is not an error to use the ‘-=’ operator to
       remove an element that does not exist in a list.

       Defaults entries are parsed in the following order: global, host,
       user, and runas Defaults first, then command defaults.  If there
       are multiple Defaults settings of the same type, the last
       matching setting is used.  The following Defaults settings are
       parsed before all others since they may affect subsequent
       entries: <i>fqdn</i>, <i>group_plugin</i>, <i>runas_default</i>, <i>sudoers_locale</i>.

       See “SUDOERS OPTIONS” for a list of supported Defaults
       parameters.

   <b>User specification</b>
       User_Spec ::= User_List Host_List '=' Cmnd_Spec_List \
                     (':' Host_List '=' Cmnd_Spec_List)*

       Cmnd_Spec_List ::= Cmnd_Spec |
                          Cmnd_Spec ',' Cmnd_Spec_List

       Cmnd_Spec ::= Runas_Spec? Option_Spec* (Tag_Spec ':')* Cmnd

       Runas_Spec ::= '(' Runas_List? (':' Runas_List)? ')'

       Option_Spec ::= (Date_Spec | Timeout_Spec | Chdir_Spec | Chroot_Spec)

       Date_Spec ::= ('NOTBEFORE=timestamp' | 'NOTAFTER=timestamp')

       Timeout_Spec ::= 'TIMEOUT=timeout'

       Chdir_Spec ::= 'CWD=directory'

       Chroot_Spec ::= 'CHROOT=directory'

       Tag_Spec ::= ('EXEC' | 'NOEXEC' | 'FOLLOW' | 'NOFOLLOW' |
                     'LOG_INPUT' | 'NOLOG_INPUT' | 'LOG_OUTPUT' |
                     'NOLOG_OUTPUT' | 'MAIL' | 'NOMAIL' | 'INTERCEPT' |
                     'NOINTERCEPT' | 'PASSWD' | 'NOPASSWD' | 'SETENV' |
                     'NOSETENV')

       A <b>user specification </b>determines which commands a user may run
       (and as what user) on specified hosts.  By default, commands are
       run as <b>root </b>(unless <i>runas_default</i> has been set to a different
       value) but this can also be changed on a per-command basis.

       The basic structure of a user specification is “who where =
       (as_whom) what”.  Let's break that down into its constituent
       parts:

   <b>Runas_Spec</b>
       A <i>Runas_Spec</i> determines the user and/or the group that a command
       may be run as.  A fully-specified <i>Runas_Spec</i> consists of two
       <i>Runas_List</i>s (as defined above) separated by a colon (‘:’) and
       enclosed in a set of parentheses.  The first <i>Runas_List</i> indicates
       which users the command may be run as via the <b>-u </b>option.  The
       second defines a list of groups that may be specified via the <b>-g</b>
       option (in addition to any of the target user's groups).  If both
       <i>Runas_List</i>s are specified, the command may be run with any
       combination of users and groups listed in their respective
       <i>Runas_List</i>s. If only the first is specified, the command may be
       run as any user in the list and, optionally, with any group the
       target user belongs to.  If the first <i>Runas_List</i> is empty but the
       second is specified, the command may be run as the invoking user
       with the group set to any listed in the <i>Runas_List</i>.  If both
       <i>Runas_List</i>s are empty, the command may only be run as the
       invoking user and the group, if specified, must be one that the
       invoking user is a member of.  If no <i>Runas_Spec</i> is specified, the
       command may only be run as the <i>runas_default</i> user (<b>root </b>by
       default) and the group, if specified, must be one that the
       <i>runas_default</i> user is a member of.

       A <i>Runas_Spec</i> sets the default for the commands that follow it.
       What this means is that for the entry:

       dgb     boulder = (operator) /bin/ls, /bin/kill, /usr/bin/lprm

       The user <b>dgb </b>may run <i>/bin/ls</i>, <i>/bin/kill</i>, and <i>/usr/bin/lprm</i> on the
       host boulder—but only as <b>operator</b>.  For example:

       $ sudo -u operator /bin/ls

       It is also possible to override a <i>Runas_Spec</i> later on in an
       entry.  If we modify the entry like so:

       dgb     boulder = (operator) /bin/ls, (root) /bin/kill, /usr/bin/lprm

       Then user <b>dgb </b>is now allowed to run <i>/bin/ls</i> as <b>operator</b>, but
       <i>/bin/kill</i> and <i>/usr/bin/lprm</i> as <b>root</b>.

       We can extend this to allow <b>dgb </b>to run <i>/bin/ls</i> with either the
       user or group set to <b>operator</b>:

       dgb     boulder = (operator : operator) /bin/ls, (root) /bin/kill,\
               /usr/bin/lprm

       While the group portion of the <i>Runas_Spec</i> permits the user to run
       as command with that group, it does not force the user to do so.
       If no group is specified on the command line, the command will
       run with the group listed in the target user's password database
       entry.  The following would all be permitted by the sudoers entry
       above:

       $ sudo -u operator /bin/ls
       $ sudo -u operator -g operator /bin/ls
       $ sudo -g operator /bin/ls

       In the following example, user <b>tcm </b>may run commands that access a
       modem device file with the dialer group.

       tcm     boulder = (:dialer) /usr/bin/tip, /usr/bin/cu,\
               /usr/local/bin/minicom

       In this example only the group will be set, the command still
       runs as user <b>tcm</b>.  For example:

       $ sudo -g dialer /usr/bin/cu

       Multiple users and groups may be present in a <i>Runas_Spec</i>, in
       which case the user may select any combination of users and
       groups via the <b>-u </b>and <b>-g </b>options.  In this example:

       alan    ALL = (root, bin : operator, system) ALL

       user <b>alan </b>may run any command as either user <b>root </b>or <b>bin</b>,
       optionally setting the group to operator or system.

   <b>Option_Spec</b>
       A <i>Cmnd</i> may have zero or more options associated with it.  Options
       may consist of start and/or end dates and command timeouts.  Once
       an option is set for a <i>Cmnd</i>, subsequent <i>Cmnd</i>s in the
       <i>Cmnd_Spec_List</i>, inherit that option unless it is overridden by
       another option.  Option names are reserved words in <i>sudoers</i>.
       This means that none of the valid option names (see below) can be
       used when declaring an alias.

   <b>Date_Spec</b>
       <b>sudoers </b>rules can be specified with a start and end date via the
       NOTBEFORE and NOTAFTER settings.  The time stamp must be
       specified in “Generalized Time” as defined by RFC 4517.  The
       format is effectively ‘yyyymmddHHMMSSZ’ where the minutes and
       seconds are optional.  The ‘Z’ suffix indicates that the time
       stamp is in Coordinated Universal Time (UTC).  It is also
       possible to specify a timezone offset from UTC in hours and
       minutes instead of a ‘Z’.  For example, ‘-0500’ would correspond
       to Eastern Standard time in the US.  As an extension, if no ‘Z’
       or timezone offset is specified, local time will be used.

       The following are all valid time stamps:

           20170214083000Z
           2017021408Z
           20160315220000-0500
           20151201235900

   <b>Timeout_Spec</b>
       A command may have a timeout associated with it.  If the timeout
       expires before the command has exited, the command will be
       terminated.  The timeout may be specified in combinations of
       days, hours, minutes, and seconds with a single-letter case-
       insensitive suffix that indicates the unit of time.  For example,
       a timeout of 7 days, 8 hours, 30 minutes, and 10 seconds would be
       written as ‘7d8h30m10s’.  If a number is specified without a
       unit, seconds are assumed.  Any of the days, minutes, hours, or
       seconds may be omitted.  The order must be from largest to
       smallest unit and a unit may not be specified more than once.

       The following are all <i>valid</i> timeout values: ‘7d8h30m10s’, ‘14d’,
       ‘8h30m’, ‘600s’, ‘3600’.  The following are <i>invalid</i> timeout
       values: ‘12m2w1d’, ‘30s10m4h’, ‘1d2d3h’.

       This setting is only supported by version 1.8.20 or higher.

   <b>Chdir_Spec</b>
       The working directory that the command will be run in can be
       specified using the CWD setting.  The <i>directory</i> must be a fully-
       qualified path name beginning with a ‘/’ or ‘~’ character, or the
       special value “*”.  A value of “*” indicates that the user may
       specify the working directory by running <b>sudo </b>with the <b>-D </b>option.
       By default, commands are run from the invoking user's current
       working directory, unless the <b>-i </b>option is given.  Path names of
       the form <i>~user/path/name</i> are interpreted as being relative to the
       named user's home directory.  If the user name is omitted, the
       path will be relative to the runas user's home directory.

       This setting is only supported by version 1.9.3 or higher.

   <b>Chroot_Spec</b>
       The root directory that the command will be run in can be
       specified using the CHROOT setting.  The <i>directory</i> must be a
       fully-qualified path name beginning with a ‘/’ or ‘~’ character,
       or the special value “*”.  A value of “*” indicates that the user
       may specify the root directory by running <b>sudo </b>with the <b>-R</b>
       option.  This setting can be used to run the command in a
       <i>chroot</i>(2) “sandbox” similar to the <i>chroot</i>(8) utility.  Path names
       of the form <i>~user/path/name</i> are interpreted as being relative to
       the named user's home directory.  If the user name is omitted,
       the path will be relative to the runas user's home directory.

       This setting is only supported by version 1.9.3 or higher.

   <b>Tag_Spec</b>
       A command may have zero or more tags associated with it.  The
       following tag values are supported: EXEC, NOEXEC, FOLLOW,
       NOFOLLOW, LOG_INPUT, NOLOG_INPUT, LOG_OUTPUT, NOLOG_OUTPUT, MAIL,
       NOMAIL, INTERCEPT, NOINTERCEPT, PASSWD, NOPASSWD, SETENV, and
       NOSETENV.  Once a tag is set on a <i>Cmnd</i>, subsequent <i>Cmnd</i>s in the
       <i>Cmnd_Spec_List</i>, inherit the tag unless it is overridden by the
       opposite tag (in other words, PASSWD overrides NOPASSWD and
       NOEXEC overrides EXEC).

       EXEC and NOEXEC

         If <b>sudo </b>has been compiled with <i>noexec</i> support and the
         underlying operating system supports it, the NOEXEC tag can be
         used to prevent a dynamically-linked executable from running
         further commands itself.

         In the following example, user <b>aaron </b>may run <i>/usr/bin/more</i> and
         <i>/usr/bin/vi</i> on the host shanty, but shell escapes will be
         disabled.

         aaron   shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

         See the “Preventing shell escapes” section below for more
         details on how NOEXEC works and whether or not it will work on
         your system.

       FOLLOW and NOFOLLOW

         Starting with version 1.8.15, <b>sudoedit </b>will not open a file
         that is a symbolic link unless the <i>sudoedit_follow</i> flag is
         enabled.  The FOLLOW and NOFOLLOW tags override the value of
         <i>sudoedit_follow</i> and can be used to permit (or deny) the editing
         of symbolic links on a per-command basis.  These tags are only
         effective for the <i>sudoedit</i> command and are ignored for all
         other commands.

       LOG_INPUT and NOLOG_INPUT

         These tags override the value of the <i>log_input</i> flag on a per-
         command basis.  For more information, see “I/O LOGGING”.

       LOG_OUTPUT and NOLOG_OUTPUT

         These tags override the value of the <i>log_output</i> flag on a per-
         command basis.  For more information, see “I/O LOGGING”.

       MAIL and NOMAIL

         These tags provide fine-grained control over whether mail will
         be sent when a user runs a command by overriding the value of
         the <i>mail_all_cmnds</i> flag on a per-command basis.  They have no
         effect when <b>sudo </b>is run with the <b>-l </b>or <b>-v </b>options.  A NOMAIL
         tag will also override the <i>mail_always</i> and <i>mail_no_perms</i>
         options.  For more information, see the descriptions of
         <i>mail_all_cmnds</i>, <i>mail_always</i>, and <i>mail_no_perms</i> in the “SUDOERS
         OPTIONS” section below.

       PASSWD and NOPASSWD

         By default, <b>sudo </b>requires that a user authenticate before
         running a command.  This behavior can be modified via the
         NOPASSWD tag.  Like a <i>Runas_Spec</i>, the NOPASSWD tag sets a
         default for the commands that follow it in the <i>Cmnd_Spec_List</i>.
         Conversely, the PASSWD tag can be used to reverse things.  For
         example:

         ray     rushmore = NOPASSWD: /bin/kill, /bin/ls, /usr/bin/lprm

         would allow the user <b>ray </b>to run <i>/bin/kill</i>, <i>/bin/ls</i>, and
         <i>/usr/bin/lprm</i> as <b>root </b>on the machine “rushmore” without
         authenticating himself.  If we only want <b>ray </b>to be able to run
         <i>/bin/kill</i> without a password the entry would be:

         ray     rushmore = NOPASSWD: /bin/kill, PASSWD: /bin/ls, /usr/bin/lprm

         Note, however, that the PASSWD tag has no effect on users who
         are in the group specified by the <i>exempt_group</i> setting.

         By default, if the NOPASSWD tag is applied to any of a user's
         entries for the current host, the user will be able to run
         ‘sudo -l’ without a password.  Additionally, a user may only
         run ‘sudo -v’ without a password if all of the user's entries
         for the current host have the NOPASSWD tag.  This behavior may
         be overridden via the <i>verifypw</i> and <i>listpw</i> options.

       SETENV and NOSETENV

         These tags override the value of the <i>setenv</i> flag on a per-
         command basis.  If SETENV has been set for a command, the user
         may disable the <i>env_reset</i> flag from the command line via the <b>-E</b>
         option.  Additionally, environment variables set on the command
         line are not subject to the restrictions imposed by <i>env_check</i>,
         <i>env_delete</i>, or <i>env_keep</i>.  As such, only trusted users should be
         allowed to set variables in this manner.  If the command
         matched is <b>ALL</b>, the SETENV tag is implied for that command;
         this default may be overridden by use of the NOSETENV tag.

       INTERCEPT and NOINTERCEPT

         If <b>sudo </b>has been compiled with <i>intercept</i> support and the
         underlying operating system supports it, the INTERCEPT tag can
         be used to cause programs spawned by a command to be validated
         against <i>sudoers</i> and logged just like they would be if run
         through <b>sudo </b>directly.  This is useful in conjunction with
         commands that allow shell escapes such as editors, shells, and
         paginators.  There is additional overhead due to the policy
         check that may add latency when running commands such as shell
         scripts that execute a large number of sub-commands.  For
         interactive commands, such as a shell or editor, the overhead
         is not usually noticeable.

         In the following example, user <b>chuck </b>may run any command on the
         machine “research” in intercept mode.

         chuck   research = INTERCEPT: ALL

         See the “Preventing shell escapes” section below for more
         details on how INTERCEPT works and whether or not it will work
         on your system.

   <b>Wildcards</b>
       <b>sudo </b>allows shell-style <i>wildcards</i> (aka meta or glob characters)
       to be used in host names, path names, and command line arguments
       in the <i>sudoers</i> file.  Wildcard matching is done via the <i>glob</i>(3)
       and <i>fnmatch</i>(3) functions as specified by IEEE Std 1003.1
       (“POSIX.1”).

       *       Matches any set of zero or more characters (including
               white space).

       ?       Matches any single character (including white space).

       [...]   Matches any character in the specified range.

       [!...]  Matches any character <i>not</i> in the specified range.

       \x      For any character ‘x’, evaluates to ‘x’.  This is used to
               escape special characters such as: ‘*’, ‘?’, ‘[’, and
               ‘]’.

       <b>These are not regular expressions.  </b>Unlike a regular expression
       there is no way to match one or more characters within a range.

       Character classes may be used if your system's <i>glob</i>(3) and
       <i>fnmatch</i>(3) functions support them.  However, because the ‘:’
       character has special meaning in <i>sudoers</i>, it must be escaped.
       For example:

           /bin/ls [[\:alpha\:]]*

       Would match any file name beginning with a letter.

       A forward slash (‘/’) will <i>not</i> be matched by wildcards used in
       the file name portion of the command.  This is to make a path
       like:

           /usr/bin/*

       match <i>/usr/bin/who</i> but not <i>/usr/bin/X11/xterm</i>.

       When matching the command line arguments, however, a slash <i>does</i>
       get matched by wildcards since command line arguments may contain
       arbitrary strings and not just path names.

       <b>Wildcards in command line arguments should be used with care.</b>
       Wildcards can match any character, including white space.  In
       most cases, it is safer to use a regular expression to match
       command line arguments.  For more information, see “Wildcards in
       command arguments” below.

   <b>Exceptions to wildcard rules</b>
       The following exceptions apply to the above rules:

       ""        If the empty string ‘""’ is the only command line
                 argument in the <i>sudoers</i> file entry it means that
                 command is not allowed to be run with <i>any</i> arguments.

       sudoedit  Command line arguments to the <i>sudoedit</i> built-in command
                 should always be path names, so a forward slash (‘/’)
                 will not be matched by a wildcard.

   <b>Regular expressions</b>
       Starting with version 1.9.10, it is possible to use regular
       expressions for path names and command line arguments.  Regular
       expressions are more expressive than shell-style <i>wildcards</i> and
       are usually safer because they provide a greater degree of
       control when matching.  The type of regular expressions supported
       by <b>sudoers </b>are POSIX extended regular expressions, similar to
       those used by the <i>egrep</i>(1) utility.  They are usually documented
       in the <i>regex</i>(7) or <i>re_format</i>(7) manual, depending on the system.
       As an extension, if the regular expression begins with “(?i)”, it
       will be matched in a case-insensitive manner.

       In <i>sudoers</i>, regular expressions must start with a ‘^’ character
       and end with a ‘$’.  This makes it explicit what is, or is not, a
       regular expression.  Either the path name, the command line
       arguments or both may be regular expressions.  Because the path
       name and arguments are matched separately, it is even possible to
       use wildcards for the path name and regular expressions for the
       arguments.  It is not possible to use a single regular expression
       to match both the command and its arguments.  Regular expressions
       in <i>sudoers</i> are limited to 1024 characters.

       There is no need to escape <i>sudoers</i> special characters in a
       regular expression other than the pound sign (‘#’).

       In the following example, user <b>john </b>can run the <i>passwd</i>(1) command
       as <b>root </b>on any host but is not allowed to change <b>root</b>'s password.
       This kind of rule is impossible to express safely using
       wildcards.

           john    ALL = /usr/bin/passwd ^[a-zA-Z0-9_]+$,\
                         !/usr/bin/passwd root

       It is also possible to use a regular expression in conjunction
       with <b>sudoedit </b>rules.  The following rule would give user bob the
       ability to edit the <i>/etc/motd</i>, <i>/etc/issue</i>, and <i>/etc/hosts</i> files
       only.

           bob    ALL = sudoedit ^/etc/(motd|issue|hosts)$

       Regular expressions may also be used to match the command itself.
       In this example, a regular expression is used to allow user <b>sid</b>
       to run the <i>/usr/sbin/groupadd</i>, <i>/usr/sbin/groupmod</i>,
       <i>/usr/sbin/groupdel</i>, <i>/usr/sbin/useradd</i>, <i>/usr/sbin/usermod</i>, and
       <i>/usr/sbin/userdel</i> commands as <b>root</b>.

           sid    ALL = ^/usr/sbin/(group|user)(add|mod|del)$

       One disadvantage of using a regular expression to match the
       command name is that it is not possible to match relative paths
       such as <i>./useradd</i> or <i>../sbin/useradd</i>.  This has security
       implications when a regular expression is used for the command
       name in conjunction with the negation operator, ‘!’, as such
       rules can be trivially bypassed.  Because of this, using a
       negated regular expression for the command name is <b>strongly</b>
       <b>discouraged</b>.  This does not apply to negated commands that only
       use a regular expression to match the command arguments.  See
       “Regular expressions in command names” below for more
       information.

   <b>Including other files from within sudoers</b>
       It is possible to include other <i>sudoers</i> files from within the
       <i>sudoers</i> file currently being parsed using the <i>@include</i> and
       <i>@includedir</i> directives.  For compatibility with sudo versions
       prior to 1.9.1, <i>#include</i> and <i>#includedir</i> are also accepted.

       An include file can be used, for example, to keep a site-wide
       <i>sudoers</i> file in addition to a local, per-machine file.  For the
       sake of this example the site-wide <i>sudoers</i> file will be
       <i>/etc/sudoers</i> and the per-machine one will be <i>/etc/sudoers.local</i>.
       To include <i>/etc/sudoers.local</i> from within <i>/etc/sudoers</i> one would
       use the following line in <i>/etc/sudoers</i>:

           @include /etc/sudoers.local

       When <b>sudo </b>reaches this line it will suspend processing of the
       current file (<i>/etc/sudoers</i>) and switch to <i>/etc/sudoers.local</i>.
       Upon reaching the end of <i>/etc/sudoers.local</i>, the rest of
       <i>/etc/sudoers</i> will be processed.  Files that are included may
       themselves include other files.  A hard limit of 128 nested
       include files is enforced to prevent include file loops.

       Starting with version 1.9.1, the path to the include file may
       contain white space if it is escaped with a backslash (‘\’).
       Alternately, the entire path may be enclosed in double quotes
       (""), in which case no escaping is necessary.  To include a
       literal backslash in the path, ‘\\’ should be used.

       If the path to the include file is not fully-qualified (does not
       begin with a ‘/’), it must be located in the same directory as
       the sudoers file it was included from.  For example, if
       <i>/etc/sudoers</i> contains the line:

           @include sudoers.local

       the file that will be included is <i>/etc/sudoers.local</i>.

       The file name may also include the ‘%h’ escape, signifying the
       short form of the host name.  In other words, if the machine's
       host name is “xerxes”, then

           @include /etc/sudoers.%h

       will cause <b>sudo </b>to include the file <i>/etc/sudoers.xerxes</i>.  Any
       path name separator characters (‘/’) present in the host name
       will be replaced with an underbar (‘_’) during expansion.

       The <i>@includedir</i> directive can be used to create a <i>sudoers.d</i>
       directory that the system package manager can drop <i>sudoers</i> file
       rules into as part of package installation.  For example, given:

           @includedir /etc/sudoers.d

       <b>sudo </b>will suspend processing of the current file and read each
       file in <i>/etc/sudoers.d</i>, skipping file names that end in ‘~’ or
       contain a ‘.’ character to avoid causing problems with package
       manager or editor temporary/backup files.

       Files are parsed in sorted lexical order.  That is,
       <i>/etc/sudoers.d/01_first</i> will be parsed before
       <i>/etc/sudoers.d/10_second</i>.  Be aware that because the sorting is
       lexical, not numeric, <i>/etc/sudoers.d/1_whoops</i> would be loaded
       <i>after /etc/sudoers.d/10_second</i>.  Using a consistent number of
       leading zeroes in the file names can be used to avoid such
       problems.  After parsing the files in the directory, control
       returns to the file that contained the <i>@includedir</i> directive.

       Unlike files included via <i>@include</i>, <b>visudo </b>will not edit the
       files in a <i>@includedir</i> directory unless one of them contains a
       syntax error.  It is still possible to run <b>visudo </b>with the <b>-f</b>
       flag to edit the files directly, but this will not catch the
       redefinition of an <i>alias</i> that is also present in a different
       file.

   <b>Other special characters and reserved words</b>
       The pound sign (‘#’) is used to indicate a comment (unless it is
       part of a #include directive or unless it occurs in the context
       of a user name and is followed by one or more digits, in which
       case it is treated as a user-ID).  Both the comment character and
       any text after it, up to the end of the line, are ignored.

       The reserved word <b>ALL </b>is a built-in <i>alias</i> that always causes a
       match to succeed.  It can be used wherever one might otherwise
       use a <i>Cmnd_Alias</i>, <i>User_Alias</i>, <i>Runas_Alias</i>, or <i>Host_Alias</i>.
       Attempting to define an <i>alias</i> named <b>ALL </b>will result in a syntax
       error.  Using <b>ALL </b>can be dangerous since in a command context, it
       allows the user to run <i>any</i> command on the system.

       The following option names permitted in an <i>Option_Spec</i> are also
       considered reserved words: CHROOT, TIMEOUT, CWD, NOTBEFORE and
       NOTAFTER.  Attempting to define an <i>alias</i> with the same name as
       one of the options will result in a syntax error.

       An exclamation point (‘!’) can be used as a logical <i>not</i> operator
       in a list or <i>alias</i> as well as in front of a <i>Cmnd</i>.  This allows
       one to exclude certain values.  For the ‘!’ operator to be
       effective, there must be something for it to exclude.  For
       example, to match all users except for <b>root </b>one would use:

           ALL, !root

       If the <b>ALL</b>, is omitted, as in:

           !root

       it would explicitly deny <b>root </b>but not match any other users.
       This is different from a true “negation” operator.

       Note, however, that using a ‘!’ in conjunction with the built-in
       <b>ALL </b>alias to allow a user to run “all but a few” commands rarely
       works as intended (see “SECURITY NOTES” below).

       Long lines can be continued with a backslash (‘\’) as the last
       character on the line.

       White space between elements in a list as well as special
       syntactic characters in a <i>User Specification</i> (‘=’, ‘:’, ‘(’, ‘)’)
       is optional.

       The following characters must be escaped with a backslash (‘\’)
       when used as part of a word (e.g., a user name or host name):
       ‘!’, ‘=’, ‘:’, ‘,’, ‘(’, ‘)’, ‘\’.
</pre> <h2>
SUDOERS OPTIONS </h2>
<pre>
       <b>sudo</b>'s behavior can be modified by <i>Default_Entry</i> lines, as
       explained earlier.  A list of all supported Defaults parameters,
       grouped by type, are listed below.

       <b>Boolean Flags</b>:

       always_query_group_plugin
                         If a <i>group_plugin</i> is configured, use it to
                         resolve groups of the form ‘%group’ as long as
                         there is not also a system group of the same
                         name.  Normally, only groups of the form
                         ‘%:group’ are passed to the <i>group_plugin</i>.  This
                         flag is <i>off</i> by default.

       always_set_home   If enabled, <b>sudo </b>will set the HOME environment
                         variable to the home directory of the target
                         user (which is the <i>runas_default</i> user unless
                         the <b>-u </b>option is used).  This flag is largely
                         obsolete and has no effect unless the <i>env_reset</i>
                         flag has been disabled or HOME is present in
                         the <i>env_keep</i> list, both of which are strongly
                         discouraged.  This flag is <i>off</i> by default.

       authenticate      If set, users must authenticate themselves via
                         a password (or other means of authentication)
                         before they may run commands.  This default may
                         be overridden via the PASSWD and NOPASSWD tags.
                         This flag is <i>on</i> by default.

       case_insensitive_group
                         If enabled, group names in <i>sudoers</i> will be
                         matched in a case insensitive manner.  This may
                         be necessary when users are stored in LDAP or
                         AD.  This flag is <i>on</i> by default.

       case_insensitive_user
                         If enabled, user names in <i>sudoers</i> will be
                         matched in a case insensitive manner.  This may
                         be necessary when groups are stored in LDAP or
                         AD.  This flag is <i>on</i> by default.

       closefrom_override
                         If set, the user may use the <b>-C </b>option which
                         overrides the default starting point at which
                         <b>sudo </b>begins closing open file descriptors.
                         This flag is <i>off</i> by default.

       compress_io       If set, and <b>sudo </b>is configured to log a
                         command's input or output, the I/O logs will be
                         compressed using <b>zlib</b>.  This flag is <i>on</i> by
                         default when <b>sudo </b>is compiled with <b>zlib</b>
                         support.

       exec_background   By default, <b>sudo </b>runs a command as the
                         foreground process as long as <b>sudo </b>itself is
                         running in the foreground.  When the
                         <i>exec_background</i> flag is enabled and the command
                         is being run in a pseudo-terminal (due to I/O
                         logging or the <i>use_pty</i> flag), the command will
                         be run as a background process.  Attempts to
                         read from the controlling terminal (or to
                         change terminal settings) will result in the
                         command being suspended with the SIGTTIN signal
                         (or SIGTTOU in the case of terminal settings).
                         If this happens when <b>sudo </b>is a foreground
                         process, the command will be granted the
                         controlling terminal and resumed in the
                         foreground with no user intervention required.
                         The advantage of initially running the command
                         in the background is that <b>sudo </b>need not read
                         from the terminal unless the command explicitly
                         requests it.  Otherwise, any terminal input
                         must be passed to the command, whether it has
                         required it or not (the kernel buffers
                         terminals so it is not possible to tell whether
                         the command really wants the input).  This is
                         different from historic <i>sudo</i> behavior or when
                         the command is not being run in a pseudo-
                         terminal.

                         For this to work seamlessly, the operating
                         system must support the automatic restarting of
                         system calls.  Unfortunately, not all operating
                         systems do this by default, and even those that
                         do may have bugs.  For example, macOS fails to
                         restart the <i>tcgetattr</i>(3) and <i>tcsetattr</i>(3)
                         functions (this is a bug in macOS).
                         Furthermore, because this behavior depends on
                         the command stopping with the SIGTTIN or
                         SIGTTOU signals, programs that catch these
                         signals and suspend themselves with a different
                         signal (usually SIGTOP) will not be
                         automatically foregrounded.  Some versions of
                         the linux <i>su</i>(1) command behave this way.  This
                         flag is <i>off</i> by default.

                         This setting is only supported by version 1.8.7
                         or higher.  It has no effect unless I/O logging
                         is enabled or the <i>use_pty</i> flag is enabled.

       env_editor        If set, <b>visudo </b>will use the value of the
                         SUDO_EDITOR, VISUAL or EDITOR environment
                         variables before falling back on the default
                         editor list.  <b>visudo </b>is typically run as <b>root</b>
                         so this flag may allow a user with <b>visudo</b>
                         privileges to run arbitrary commands as <b>root</b>
                         without logging.  An alternative is to place a
                         colon-separated list of “safe” editors int the
                         <i>editor</i> setting.  <b>visudo </b>will then only use
                         SUDO_EDITOR, VISUAL or EDITOR if they match a
                         value specified in <i>editor</i>.  If the <i>env_reset</i>
                         flag is enabled, the SUDO_EDITOR, VISUAL and/or
                         EDITOR environment variables must be present in
                         the <i>env_keep</i> list for the <i>env_editor</i> flag to
                         function when <b>visudo </b>is invoked via <b>sudo</b>.  This
                         flag is <i>on</i> by default.

       env_reset         If set, <b>sudo </b>will run the command in a minimal
                         environment containing the TERM, PATH, HOME,
                         MAIL, SHELL, LOGNAME, USER and SUDO_*
                         variables.  Any variables in the caller's
                         environment or in the file specified by the
                         <i>restricted_env_file</i> setting that match the
                         <i>env_keep</i> and <i>env_check</i> lists are then added,
                         followed by any variables present in the file
                         specified by the <i>env_file</i> setting (if any).
                         The contents of the <i>env_keep</i> and <i>env_check</i>
                         lists, as modified by global Defaults
                         parameters in <i>sudoers</i>, are displayed when <b>sudo</b>
                         is run by <b>root </b>with the <b>-V </b>option.  If the
                         <i>secure_path</i> setting is enabled, its value will
                         be used for the PATH environment variable.
                         This flag is <i>on</i> by default.

       fast_glob         Normally, <b>sudo </b>uses the <i>glob</i>(3) function to do
                         shell-style globbing when matching path names.
                         However, since it accesses the file system,
                         <i>glob</i>(3) can take a long time to complete for
                         some patterns, especially when the pattern
                         references a network file system that is
                         mounted on demand (auto mounted).  The
                         <i>fast_glob</i> flag causes <b>sudo </b>to use the
                         <i>fnmatch</i>(3) function, which does not access the
                         file system to do its matching.  The
                         disadvantage of <i>fast_glob</i> is that it is unable
                         to match relative paths such as <i>./ls</i> or
                         <i>../bin/ls</i>.  This has security implications when
                         path names that include globbing characters are
                         used with the negation operator, ‘!’, as such
                         rules can be trivially bypassed.  As such, this
                         flag should not be used when the <i>sudoers</i> file
                         contains rules that contain negated path names
                         which include globbing characters.  This flag
                         is <i>off</i> by default.

       log_passwords     Most programs that require a user's password
                         will disable echo before reading the password
                         to avoid displaying the plaintext password on
                         the screen.  However, if terminal input is
                         being logged (see “I/O LOGGING”), the password
                         will still be present in the I/O log.  If the
                         <i>log_passwords</i> option is disabled, <b>sudoers </b>will
                         attempt to prevent passwords from being logged.
                         It does this by using the regular expressions
                         in <i>passprompt_regex</i> to match a password prompt
                         in the terminal output buffer.  When a match is
                         found, input characters in the I/O log will be
                         replaced with ‘*’ until either a line feed or
                         carriage return is found in the terminal input
                         or a new terminal output buffer is received.
                         If, however, a program displays characters as
                         the user types (such as <b>sudo </b>when <i>pwfeedback</i> is
                         set), only the first character of the password
                         will be replaced in the I/O log.  This option
                         has no effect unless <i>log_input</i> or <i>log_ttyin</i> are
                         also set.  This flag is <i>on</i> by default.

                         This setting is only supported by version
                         1.9.10 or higher.

       fqdn              Set this flag if you want to put fully
                         qualified host names in the <i>sudoers</i> file when
                         the local host name (as returned by the
                         ‘hostname’ command) does not contain the domain
                         name.  In other words, instead of myhost you
                         would use myhost.mydomain.edu.  You may still
                         use the short form if you wish (and even mix
                         the two).  This flag is only effective when the
                         “canonical” host name, as returned by the
                         <i>getaddrinfo</i>(3) or <i>gethostbyname</i>(3) function, is
                         a fully-qualified domain name.  This is usually
                         the case when the system is configured to use
                         DNS for host name resolution.

                         If the system is configured to use the
                         <i>/etc/hosts</i> file in preference to DNS, the
                         “canonical” host name may not be fully-
                         qualified.  The order that sources are queried
                         for host name resolution is usually specified
                         in the <i>/etc/nsswitch.conf</i>, <i>/etc/netsvc.conf</i>,
                         <i>/etc/host.conf</i>, or, in some cases,
                         <i>/etc/resolv.conf</i> file.  In the <i>/etc/hosts</i> file,
                         the first host name of the entry is considered
                         to be the “canonical” name; subsequent names
                         are aliases that are not used by <b>sudoers</b>.  For
                         example, the following hosts file line for the
                         machine “xyzzy” has the fully-qualified domain
                         name as the “canonical” host name, and the
                         short version as an alias.

                               <b>192.168.1.1 xyzzy.sudo.ws xyzzy</b>

                         If the machine's hosts file entry is not
                         formatted properly, the <i>fqdn</i> flag will not be
                         effective if it is queried before DNS.

                         Beware that when using DNS for host name
                         resolution, turning on <i>fqdn</i> requires <b>sudoers </b>to
                         make DNS lookups which renders <b>sudo </b>unusable if
                         DNS stops working (for example if the machine
                         is disconnected from the network).  Just like
                         with the hosts file, you must use the
                         “canonical” name as DNS knows it.  That is, you
                         may not use a host alias (CNAME entry) due to
                         performance issues and the fact that there is
                         no way to get all aliases from DNS.

                         This flag is <i>off</i> by default.

       ignore_audit_errors
                         Allow commands to be run even if <b>sudoers </b>cannot
                         write to the audit log.  If enabled, an audit
                         log write failure is not treated as a fatal
                         error.  If disabled, a command may only be run
                         after the audit event is successfully written.
                         This flag is only effective on systems for
                         which <b>sudoers </b>supports audit logging, including
                         FreeBSD, Linux, macOS, and Solaris.  This flag
                         is <i>on</i> by default.

       ignore_dot        If set, <b>sudo </b>will ignore "." or "" (both
                         denoting the current directory) in the PATH
                         environment variable; the PATH itself is not
                         modified.  This flag is <i>off</i> by default.

       ignore_iolog_errors
                         Allow commands to be run even if <b>sudoers </b>cannot
                         write to the I/O log (local or remote).  If
                         enabled, an I/O log write failure is not
                         treated as a fatal error.  If disabled, the
                         command will be terminated if the I/O log
                         cannot be written to.  This flag is <i>off</i> by
                         default.

       ignore_logfile_errors
                         Allow commands to be run even if <b>sudoers </b>cannot
                         write to the log file.  If enabled, a log file
                         write failure is not treated as a fatal error.
                         If disabled, a command may only be run after
                         the log file entry is successfully written.
                         This flag only has an effect when <b>sudoers </b>is
                         configured to use file-based logging via the
                         <i>logfile</i> setting.  This flag is <i>on</i> by default.

       ignore_local_sudoers
                         If set via LDAP, parsing of <i>/etc/sudoers</i> will
                         be skipped.  This is intended for sites that
                         wish to prevent the usage of local sudoers
                         files so that only LDAP is used.  This thwarts
                         the efforts of rogue operators who would
                         attempt to add roles to <i>/etc/sudoers</i>.  When
                         this flag is enabled, <i>/etc/sudoers</i> does not
                         even need to exist.  Since this flag tells <b>sudo</b>
                         how to behave when no specific LDAP entries
                         have been matched, this sudoOption is only
                         meaningful for the ‘cn=defaults’ section.  This
                         flag is <i>off</i> by default.

       ignore_unknown_defaults
                         If set, <b>sudo </b>will not produce a warning if it
                         encounters an unknown Defaults entry in the
                         <i>sudoers</i> file or an unknown sudoOption in LDAP.
                         This flag is <i>off</i> by default.

       insults           If set, <b>sudo </b>will insult users when they enter
                         an incorrect password.  This flag is <i>off</i> by
                         default.

       log_allowed       If set, <b>sudoers </b>will log commands allowed by
                         the policy to the system audit log (where
                         supported) as well as to syslog and/or a log
                         file.  This flag is <i>on</i> by default.

                         This setting is only supported by version
                         1.8.29 or higher.

       log_denied        If set, <b>sudoers </b>will log commands denied by the
                         policy to the system audit log (where
                         supported) as well as to syslog and/or a log
                         file.  This flag is <i>on</i> by default.

                         This setting is only supported by version
                         1.8.29 or higher.

       log_exit_status   If set, <b>sudoers </b>will log the exit value of
                         commands that are run to syslog and/or a log
                         file.  If a command was terminated by a signal,
                         the signal name is logged as well.  This flag
                         is <i>off</i> by default.

                         This setting is only supported by version 1.9.8
                         or higher.

       log_host          If set, the host name will be included in log
                         entries written to the file configured by the
                         <i>logfile</i> setting.  This flag is <i>off</i> by default.

       log_input         If set, <b>sudo </b>will run the command in a pseudo-
                         terminal (if <b>sudo </b>was run from a terminal) and
                         log all user input.  If the standard input is
                         not connected to the user's terminal, due to
                         I/O redirection or because the command is part
                         of a pipeline, that input is also logged.  For
                         more information about I/O logging, see the
                         “I/O LOGGING” section.  This flag is <i>off</i> by
                         default.

       log_output        If set, <b>sudo </b>will run the command in a pseudo-
                         terminal (if <b>sudo </b>was run from a terminal) and
                         log all output that is sent to the user's
                         terminal, the standard output or the standard
                         error.  If the standard output or standard
                         error is not connected to the user's terminal,
                         due to I/O redirection or because the command
                         is part of a pipeline, that output is also
                         logged.  For more information about I/O
                         logging, see the “I/O LOGGING” section.  This
                         flag is <i>off</i> by default.

       log_server_keepalive
                         If set, <b>sudo </b>will enable the TCP keepalive
                         socket option on the connection to the log
                         server.  This enables the periodic transmission
                         of keepalive messages to the server.  If the
                         server does not respond to a message, the
                         connection will be closed and the running
                         command will be terminated unless the
                         <i>ignore_iolog_errors</i> flag (I/O logging enabled)
                         or the <i>ignore_log_errors</i> flag (I/O logging
                         disabled) is set.  This flag is <i>on</i> by default.

                         This setting is only supported by version 1.9.0
                         or higher.

       log_server_verify
                         If set, the server certificate received during
                         the TLS handshake must be valid and it must
                         contain either the server name (from
                         <i>log_servers</i>) or its IP address.  If either of
                         these conditions is not met, the TLS handshake
                         will fail.  This flag is <i>on</i> by default.

                         This setting is only supported by version 1.9.0
                         or higher.

       log_stderr        If set, <b>sudo </b>will log the standard error if it
                         is not connected to the user's terminal.  This
                         can be used to log output to a pipe or
                         redirected to a file.  This flag is <i>off</i> by
                         default but is enabled when either the
                         <i>log_output</i> flag or the LOG_OUTPUT command tag
                         is set.

       log_stdin         If set, <b>sudo </b>will log the standard input if it
                         is not connected to the user's terminal.  This
                         can be used to log input from a pipe or
                         redirected from a file.  This flag is <i>off</i> by
                         default but is enabled when either the
                         <i>log_input</i> flag or the LOG_INPUT command tag is
                         set.

       log_stdout        If set, <b>sudo </b>will log the standard output if it
                         is not connected to the user's terminal.  This
                         can be used to log output to a pipe or
                         redirected to a file.  This flag is <i>off</i> by
                         default but is enabled when either the
                         <i>log_output</i> flag or the LOG_OUTPUT command tag
                         is set.

       log_subcmds       If set, <b>sudoers </b>will log when a command spawns
                         a child process and executes a program using
                         the <i>execve</i>(2), <i>execl</i>(3), <i>execle</i>(3), <i>execlp</i>(3),
                         <i>execv</i>(3), <i>execvp</i>(3), <i>execvpe</i>(3), or <i>system</i>(3)
                         library functions.  For example, if a shell is
                         run by <b>sudo</b>, the individual commands run via
                         the shell will be logged.  This flag is <i>off</i> by
                         default.

                         The <i>log_subcmds</i> flag uses the same underlying
                         mechanism as the <i>intercept</i> setting.  Some
                         commands may not work properly when <i>log_subcmds</i>
                         is enabled, due to the way it intercepts sub-
                         commands.  See “Preventing shell escapes” for
                         more information on what systems support this
                         option and its limitations.  This setting is
                         only supported by version 1.9.8 or higher and
                         is incompatible with SELinux RBAC support
                         unless the system supports <i>seccomp</i>(2) filter
                         mode.

       log_ttyin         If set, <b>sudo </b>will run the command in a pseudo-
                         terminal and log user keystrokes sent to the
                         user's terminal, if one is present.  This flag
                         is <i>off</i> by default but is enabled when either
                         the <i>log_input</i> flag or the LOG_INPUT command tag
                         is set.  If no terminal is present, for example
                         when running a remote command using <i>ssh</i>(1),
                         this flag will have no effect.

       log_ttyout        If set, <b>sudo </b>will run the command in a pseudo-
                         terminal and log all output displayed on the
                         user's terminal, if one is present.  This flag
                         is <i>off</i> by default but is enabled when either
                         the <i>log_output</i> flag or the LOG_OUTPUT command
                         tag is set.  If no terminal is present, for
                         example when running a remote command using
                         <i>ssh</i>(1), this flag will have no effect.

       log_year          If set, the four-digit year will be logged in
                         the (non-syslog) <b>sudo </b>log file.  This flag is
                         <i>off</i> by default.

       long_otp_prompt   When validating with a One Time Password (OTP)
                         scheme such as <b>S/Key </b>or <b>OPIE</b>, a two-line prompt
                         is used to make it easier to cut and paste the
                         challenge to a local window.  It's not as
                         pretty as the default but some people find it
                         more convenient.  This flag is <i>off</i> by default.

       mail_all_cmnds    Send mail to the <i>mailto</i> user every time a user
                         attempts to run a command via <b>sudo </b>(this
                         includes <b>sudoedit</b>).  No mail will be sent if
                         the user runs <b>sudo </b>with the <b>-l </b>or <b>-v </b>option
                         unless there is an authentication error and the
                         <i>mail_badpass</i> flag is also set.  This flag is
                         <i>off</i> by default.

       mail_always       Send mail to the <i>mailto</i> user every time a user
                         runs <b>sudo</b>.  This flag is <i>off</i> by default.

       mail_badpass      Send mail to the <i>mailto</i> user if the user
                         running <b>sudo </b>does not enter the correct
                         password.  If the command the user is
                         attempting to run is not permitted by <b>sudoers</b>
                         and one of the <i>mail_all_cmnds</i>, <i>mail_always</i>,
                         <i>mail_no_host</i>, <i>mail_no_perms</i> or <i>mail_no_user</i>
                         flags are set, this flag will have no effect.
                         This flag is <i>off</i> by default.

       mail_no_host      If set, mail will be sent to the <i>mailto</i> user if
                         the invoking user exists in the <i>sudoers</i> file,
                         but is not allowed to run commands on the
                         current host.  This flag is <i>off</i> by default.

       mail_no_perms     If set, mail will be sent to the <i>mailto</i> user if
                         the invoking user is allowed to use <b>sudo </b>but
                         the command they are trying is not listed in
                         their <i>sudoers</i> file entry or is explicitly
                         denied.  This flag is <i>off</i> by default.

       mail_no_user      If set, mail will be sent to the <i>mailto</i> user if
                         the invoking user is not in the <i>sudoers</i> file.
                         This flag is <i>on</i> by default.

       match_group_by_gid
                         By default, <b>sudoers </b>will look up each group the
                         user is a member of by group-ID to determine
                         the group name (this is only done once).  The
                         resulting list of the user's group names is
                         used when matching groups listed in the <i>sudoers</i>
                         file.  This works well on systems where the
                         number of groups listed in the <i>sudoers</i> file is
                         larger than the number of groups a typical user
                         belongs to.  On systems where group lookups are
                         slow, where users may belong to a large number
                         of groups, or where the number of groups listed
                         in the <i>sudoers</i> file is relatively small, it may
                         be prohibitively expensive and running commands
                         via <b>sudo </b>may take longer than normal.  On such
                         systems it may be faster to use the
                         <i>match_group_by_gid</i> flag to avoid resolving the
                         user's group-IDs to group names.  In this case,
                         <b>sudoers </b>must look up any group name listed in
                         the <i>sudoers</i> file and use the group-ID instead
                         of the group name when determining whether the
                         user is a member of the group.

                         If <i>match_group_by_gid</i> is enabled, group
                         database lookups performed by <b>sudoers </b>will be
                         keyed by group name as opposed to group-ID.  On
                         systems where there are multiple sources for
                         the group database, it is possible to have
                         conflicting group names or group-IDs in the
                         local <i>/etc/group</i> file and the remote group
                         database.  On such systems, enabling or
                         disabling <i>match_group_by_gid</i> can be used to
                         choose whether group database queries are
                         performed by name (enabled) or ID (disabled),
                         which may aid in working around group entry
                         conflicts.

                         The <i>match_group_by_gid</i> flag has no effect when
                         <i>sudoers</i> data is stored in LDAP.  This flag is
                         <i>off</i> by default.

                         This setting is only supported by version
                         1.8.18 or higher.

       intercept         If set, all commands run via <b>sudo </b>will behave
                         as if the INTERCEPT tag has been set, unless
                         overridden by an NOINTERCEPT tag.  Some
                         commands may not work properly when <i>intercept</i>
                         is enabled, due to the way it intercept sub-
                         commands.  See the description of INTERCEPT and
                         NOINTERCEPT above as well as the “Preventing
                         shell escapes” section at the end of this
                         manual.  This flag is <i>off</i> by default.

                         This setting is only supported by version 1.9.8
                         or higher and is incompatible with SELinux RBAC
                         support unless the system supports <i>seccomp</i>(2)
                         filter mode.

       intercept_allow_setid
                         On most systems, the dynamic loader will ignore
                         LD_PRELOAD (or the equivalent) when running
                         set-user-ID and set-group-ID programs,
                         effectively disabling intercept mode.  To
                         prevent this from happening, <b>sudoers </b>will not
                         permit a set-user-ID or set-group-ID program to
                         be run in intercept mode unless
                         <i>intercept_allow_setid</i> is enable.  This flag has
                         no effect unless the <i>intercept</i> flag is enabled
                         or the INTERCEPT tag has been set for the
                         command.  This flag is <i>on</i> by default when the
                         <i>intercept_type</i> option is set to <i>trace</i>,
                         otherwise it default to <i>off</i>.

                         This setting is only supported by version 1.9.8
                         or higher.

       intercept_authenticate
                         If set, commands run by an intercepted process
                         must be authenticated when the user's time
                         stamp is not current.  For example, if a shell
                         is run with <i>intercept</i> enabled, as soon as the
                         invoking user's time stamp is out of date,
                         subsequent commands will need to be
                         authenticated.  This flag has no effect unless
                         the <i>intercept</i> flag is enabled or the INTERCEPT
                         tag has been set for the command.  This flag is
                         <i>off</i> by default.

                         This setting is only supported by version 1.9.8
                         or higher.

       intercept_verify  If set, <b>sudo </b>will attempt to verify that a
                         command run in intercept mode has the expected
                         path name, command line arguments and
                         environment.

                         The process will be stopped after <i>execve</i>(2) has
                         completed but before the new command has had a
                         chance to run.  To verify the command, <b>sudo</b>
                         will read the command's path from
                         <i>/proc/PID/exe</i>, the command line arguments and
                         environment from the process's memory, and
                         compare them against the arguments that were
                         passed to <i>execve</i>(2).  In the event of a
                         mismatch, the command will be sent a SIGKILL
                         signal and terminated.

                         This can help prevent a time of check versus
                         time of use issue with intercept mode where the
                         <i>execve</i>(2) arguments could be altered after the
                         <b>sudoers </b>policy check.  The checks can only be
                         performed if the <i>proc</i>(5) file system is
                         available.  This flag has no effect unless the
                         <i>intercept</i> flag is enabled or the INTERCEPT tag
                         has been set for the command and the
                         <i>intercept_type</i> option is set to <i>trace</i>.

                         This setting is incompatible with programs that
                         change their root directory via <i>chroot</i>(2).  If
                         a program changes its root directory, path
                         names will no longer match those seen by the
                         <b>sudo </b>parent process and sub-commands will be
                         terminated before they have a chance to run.
                         This flag is <i>on</i> by default.

                         This setting is only supported by version
                         1.9.12 or higher.

       netgroup_tuple    If set, netgroup lookups will be performed
                         using the full netgroup tuple: host name, user
                         name, and domain (if one is set).
                         Historically, <b>sudo </b>only matched the user name
                         and domain for netgroups used in a <i>User_List</i>
                         and only matched the host name and domain for
                         netgroups used in a <i>Host_List</i>.  This flag is
                         <i>off</i> by default.

       noexec            If set, all commands run via <b>sudo </b>will behave
                         as if the NOEXEC tag has been set, unless
                         overridden by an EXEC tag.  See the description
                         of EXEC and NOEXEC above as well as the
                         “Preventing shell escapes” section at the end
                         of this manual.  This flag is <i>off</i> by default.

       noninteractive_auth
                         If set, authentication will be attempted even
                         in non-interactive mode (when <b>sudo</b>'s <b>-n </b>option
                         is specified).  This allows authentication
                         methods that don't require user interaction to
                         succeed.  Authentication methods that require
                         input from the user's terminal will still fail.
                         If disabled, authentication will not be
                         attempted in non-interactive mode.  This flag
                         is <i>off</i> by default.

                         This setting is only supported by version
                         1.9.10 or higher.

       pam_acct_mgmt     On systems that use PAM for authentication,
                         <b>sudo </b>will perform PAM account validation for
                         the invoking user by default.  The actual
                         checks performed depend on which PAM modules
                         are configured.  If enabled, account validation
                         will be performed regardless of whether or not
                         a password is required.  This flag is <i>on</i> by
                         default.

                         This setting is only supported by version
                         1.8.28 or higher.

       pam_rhost         On systems that use PAM for authentication,
                         <b>sudo </b>will set the PAM remote host value to the
                         name of the local host when the <i>pam_rhost</i> flag
                         is enabled.  On Linux systems, enabling
                         <i>pam_rhost</i> may result in DNS lookups of the
                         local host name when PAM is initialized.  On
                         Solaris versions prior to Solaris 8, <i>pam_rhost</i>
                         must be enabled if <i>pam_ruser</i> is also enabled to
                         avoid a crash in the Solaris PAM
                         implementation.

                         This flag is <i>off</i> by default on systems other
                         than Solaris.

                         This setting is only supported by version 1.9.0
                         or higher.

       pam_ruser         On systems that use PAM for authentication,
                         <b>sudo </b>will set the PAM remote user value to the
                         name of the user that invoked sudo when the
                         <i>pam_ruser</i> flag is enabled.  This flag is <i>on</i> by
                         default.

                         This setting is only supported by version 1.9.0
                         or higher.

       pam_session       On systems that use PAM for authentication,
                         <b>sudo </b>will create a new PAM session for the
                         command to be run in.  Unless <b>sudo </b>is given the
                         <b>-i </b>or <b>-s </b>options, PAM session modules are run
                         with the “silent” flag enabled.  This prevents
                         last login information from being displayed for
                         every command on some systems.  Disabling
                         <i>pam_session</i> may be needed on older PAM
                         implementations or on operating systems where
                         opening a PAM session changes the utmp or wtmp
                         files.  If PAM session support is disabled,
                         resource limits may not be updated for the
                         command being run.  If <i>pam_session</i>,
                         <i>pam_setcred</i>, and <i>use_pty</i> are disabled,
                         <i>log_servers</i> has not been set and I/O logging
                         has not been configured, <b>sudo </b>will execute the
                         command directly instead of running it as a
                         child process.  This flag is <i>on</i> by default.

                         This setting is only supported by version 1.8.7
                         or higher.

       pam_setcred       On systems that use PAM for authentication,
                         <b>sudo </b>will attempt to establish credentials for
                         the target user by default, if supported by the
                         underlying authentication system.  One example
                         of a credential is a Kerberos ticket.  If
                         <i>pam_session</i>, <i>pam_setcred</i>, and <i>use_pty</i> are
                         disabled, <i>log_servers</i> has not been set and I/O
                         logging has not been configured, <b>sudo </b>will
                         execute the command directly instead of running
                         it as a child process.  This flag is <i>on</i> by
                         default.

                         This setting is only supported by version 1.8.8
                         or higher.

       pam_silent        If set, PAM authentication will be performed in
                         silent mode.  This prevents PAM authentication
                         modules from generating output.  In some cases,
                         this may suppress important information about
                         why authentication failed.  For example, PAM
                         modules such as <i>pam_faillock</i> will only display
                         a warning if <i>pam_silent</i> is disabled.  This flag
                         is <i>on</i> by default.

                         This setting is only supported by version
                         1.8.16 or higher.

       passprompt_override
                         If set, the prompt specified by <i>passprompt</i> or
                         the SUDO_PROMPT environment variable will
                         always be used and will replace the prompt
                         provided by a PAM module or other
                         authentication method.  This flag is <i>off</i> by
                         default.

       path_info         Normally, <b>sudo </b>will tell the user when a
                         command could not be found in their PATH
                         environment variable.  Some sites may wish to
                         disable this as it could be used to gather
                         information on the location of executables that
                         the normal user does not have access to.  The
                         disadvantage is that if the executable is
                         simply not in the user's PATH, <b>sudo </b>will tell
                         the user that they are not allowed to run it,
                         which can be confusing.  This flag is <i>on</i> by
                         default.

       preserve_groups   By default, <b>sudo </b>will initialize the group
                         vector to the list of groups the target user is
                         in.  When <i>preserve_groups</i> is set, the user's
                         existing group vector is left unaltered.  The
                         real and effective group-IDs, however, are
                         still set to match the target user.  This flag
                         is <i>off</i> by default.

       pwfeedback        By default, <b>sudo </b>reads the password like most
                         other Unix programs, by turning off echo until
                         the user hits the return (or enter) key.  Some
                         users become confused by this as it appears to
                         them that <b>sudo </b>has hung at this point.  When
                         <i>pwfeedback</i> is set, <b>sudo </b>will provide visual
                         feedback when the user presses a key.  This
                         does have a security impact as an onlooker may
                         be able to determine the length of the password
                         being entered.  This flag is <i>off</i> by default.

       requiretty        If set, <b>sudo </b>will only run when the user is
                         logged in to a real tty.  When this flag is
                         set, <b>sudo </b>can only be run from a login session
                         and not via other means such as <i>cron</i>(8) or cgi-
                         bin scripts.  This flag is <i>off</i> by default.

       root_sudo         If set, <b>root </b>is allowed to run <b>sudo </b>too.
                         Disabling this prevents users from “chaining”
                         <b>sudo </b>commands to get a <b>root </b>shell by doing
                         something like ‘sudo sudo /bin/sh’.  Note,
                         however, that turning off <i>root_sudo</i> will also
                         prevent <b>root </b>from running <b>sudoedit</b>.  Disabling
                         <i>root_sudo</i> provides no real additional security;
                         it exists purely for historical reasons.  This
                         flag is <i>on</i> by default.

       rootpw            If set, <b>sudo </b>will prompt for the <b>root </b>password
                         instead of the password of the invoking user
                         when running a command or editing a file.  This
                         flag is <i>off</i> by default.

       runas_allow_unknown_id
                         If enabled, allow matching of runas user and
                         group IDs that are not present in the password
                         or group databases.  In addition to explicitly
                         matching unknown user or group IDs in a
                         <i>Runas_List</i>, this option also allows the <b>ALL</b>
                         alias to match unknown IDs.  This flag is <i>off</i>
                         by default.

                         This setting is only supported by version
                         1.8.30 or higher.  Older versions of <b>sudo</b>
                         always allowed matching of unknown user and
                         group IDs.

       runas_check_shell
                         If enabled, <b>sudo </b>will only run commands as a
                         user whose shell appears in the <i>/etc/shells</i>
                         file, even if the invoking user's <i>Runas_List</i>
                         would otherwise permit it.  If no <i>/etc/shells</i>
                         file is present, a system-dependent list of
                         built-in default shells is used.  On many
                         operating systems, system users such as “bin”,
                         do not have a valid shell and this flag can be
                         used to prevent commands from being run as
                         those users.  This flag is <i>off</i> by default.

                         This setting is only supported by version
                         1.8.30 or higher.

       runaspw           If set, <b>sudo </b>will prompt for the password of
                         the user defined by the <i>runas_default</i> option
                         (defaults to <b>root</b>) instead of the password of
                         the invoking user when running a command or
                         editing a file.  This flag is <i>off</i> by default.

       set_home          If enabled and <b>sudo </b>is invoked with the <b>-s</b>
                         option, the HOME environment variable will be
                         set to the home directory of the target user
                         (which is the <i>runas_default</i> user unless the <b>-u</b>
                         option is used).  This flag is largely obsolete
                         and has no effect unless the <i>env_reset</i> flag has
                         been disabled or HOME is present in the
                         <i>env_keep</i> list, both of which are strongly
                         discouraged.  This flag is <i>off</i> by default.

       set_logname       Normally, <b>sudo </b>will set the LOGNAME and USER
                         environment variables to the name of the target
                         user (the user specified by <i>runas_default</i>
                         unless the <b>-u </b>option is given).  However, since
                         some programs (including the RCS revision
                         control system) use LOGNAME to determine the
                         real identity of the user, it may be desirable
                         to change this behavior.  This can be done by
                         negating the set_logname option.  The
                         <i>set_logname</i> option will have no effect if the
                         <i>env_reset</i> option has not been disabled and the
                         <i>env_keep</i> list contains LOGNAME or USER.  This
                         flag is <i>on</i> by default.

       set_utmp          When enabled, <b>sudo </b>will create an entry in the
                         utmp (or utmpx) file when a pseudo-terminal is
                         allocated.  A pseudo-terminal is allocated by
                         <b>sudo </b>when it is running in a terminal and one
                         or more of the <i>log_input</i>, <i>log_output</i>,
                         <i>log_stdin</i>, <i>log_stdout</i>, <i>log_stderr</i>, <i>log_ttyin</i>,
                         <i>log_ttyout</i>, or <i>use_pty</i> flags is enabled.  By
                         default, the new entry will be a copy of the
                         user's existing utmp entry (if any), with the
                         tty, time, type, and pid fields updated.  This
                         flag is <i>on</i> by default.

       setenv            Allow the user to disable the <i>env_reset</i> option
                         from the command line via the <b>-E </b>option.
                         Additionally, environment variables set via the
                         command line are not subject to the
                         restrictions imposed by <i>env_check</i>, <i>env_delete</i>,
                         or <i>env_keep</i>.  As such, only trusted users
                         should be allowed to set variables in this
                         manner.  This flag is <i>off</i> by default.

       shell_noargs      If set and <b>sudo </b>is invoked with no arguments it
                         acts as if the <b>-s </b>option had been given.  That
                         is, it runs a shell as <b>root </b>(the shell is
                         determined by the SHELL environment variable if
                         it is set, falling back on the shell listed in
                         the invoking user's /etc/passwd entry if not).
                         This flag is <i>off</i> by default.

       stay_setuid       Normally, when <b>sudo </b>executes a command the real
                         and effective user-IDs are set to the target
                         user (<b>root </b>by default).  This option changes
                         that behavior such that the real user-ID is
                         left as the invoking user's user-ID.  In other
                         words, this makes <b>sudo </b>act as a set-user-ID
                         wrapper.  This can be useful on systems that
                         disable some potentially dangerous
                         functionality when a program is run set-user-
                         ID.  This option is only effective on systems
                         that support either the <i>setreuid</i>(2) or
                         <i>setresuid</i>(2) system call.  This flag is <i>off</i> by
                         default.

       sudoedit_checkdir
                         If set, <b>sudoedit </b>will check all directory
                         components of the path to be edited for
                         writability by the invoking user.  Symbolic
                         links will not be followed in writable
                         directories and <b>sudoedit </b>will refuse to edit a
                         file located in a writable directory.  These
                         restrictions are not enforced when <b>sudoedit </b>is
                         run by <b>root</b>.  On some systems, if all directory
                         components of the path to be edited are not
                         readable by the target user, <b>sudoedit </b>will be
                         unable to edit the file.  This flag is <i>on</i> by
                         default.

                         This setting was first introduced in version
                         1.8.15 but initially suffered from a race
                         condition.  The check for symbolic links in
                         writable intermediate directories was added in
                         version 1.8.16.

       sudoedit_follow   By default, <b>sudoedit </b>will not follow symbolic
                         links when opening files.  The <i>sudoedit_follow</i>
                         option can be enabled to allow <b>sudoedit </b>to open
                         symbolic links.  It may be overridden on a per-
                         command basis by the FOLLOW and NOFOLLOW tags.
                         This flag is <i>off</i> by default.

                         This setting is only supported by version
                         1.8.15 or higher.

       syslog_pid        When logging via <i>syslog</i>(3), include the process
                         ID in the log entry.  This flag is <i>off</i> by
                         default.

                         This setting is only supported by version
                         1.8.21 or higher.

       targetpw          If set, <b>sudo </b>will prompt for the password of
                         the user specified by the <b>-u </b>option (defaults
                         to the value of <i>runas_default</i>) instead of the
                         password of the invoking user when running a
                         command or editing a file.  This flag precludes
                         the use of a user-ID not listed in the passwd
                         database as an argument to the <b>-u </b>option.  This
                         flag is <i>off</i> by default.

       tty_tickets       If set, users must authenticate on a per-tty
                         basis.  With this flag enabled, <b>sudo </b>will use a
                         separate record in the time stamp file for each
                         terminal.  If disabled, a single record is used
                         for all login sessions.

                         This option has been superseded by the
                         <i>timestamp_type</i> option.

       umask_override    If set, <b>sudo </b>will set the umask as specified in
                         the <i>sudoers</i> file without modification.  This
                         makes it possible to specify a umask in the
                         <i>sudoers</i> file that is more permissive than the
                         user's own umask and matches historical
                         behavior.  If <i>umask_override</i> is not set, <b>sudo</b>
                         will set the umask to be the union of the
                         user's umask and what is specified in <i>sudoers</i>.
                         This flag is <i>off</i> by default.

       use_netgroups     If set, netgroups (prefixed with ‘+’), may be
                         used in place of a user or host.  For LDAP-
                         based sudoers, netgroup support requires an
                         expensive sub-string match on the server unless
                         the <b>NETGROUP_BASE </b>directive is present in the
                         <i>/etc/ldap.conf</i> file.  If netgroups are not
                         needed, this option can be disabled to reduce
                         the load on the LDAP server.  This flag is <i>on</i>
                         by default.

       use_pty           If set, and <b>sudo </b>is running in a terminal, the
                         command will be run in a new pseudo-terminal.
                         If the <b>sudo </b>process is not attached to a
                         terminal, <i>use_pty</i> has no effect.

                         A malicious program run under <b>sudo </b>may be
                         capable of injecting commands into the user's
                         terminal or running a background process that
                         retains access to the user's terminal device
                         even after the main program has finished
                         executing.  By running the command in a
                         separate pseudo-terminal, this attack is no
                         longer possible.

                         A side effect of running the command in a new
                         pseudo-terminal is that input will be passed to
                         the command even if it is non-interactive.
                         This means that, for example, keys pressed
                         while a non-interactive command is running will
                         be consumed by <b>sudo </b>instead of being passed to
                         the shell after the command exits.

                         This flag is <i>on</i> by default for <b>sudo </b>1.9.14 and
                         above.

       user_command_timeouts
                         If set, the user may specify a timeout on the
                         command line.  If the timeout expires before
                         the command has exited, the command will be
                         terminated.  If a timeout is specified both in
                         the <i>sudoers</i> file and on the command line, the
                         smaller of the two timeouts will be used.  See
                         the <i>Timeout_Spec</i> section for a description of
                         the timeout syntax.  This flag is <i>off</i> by
                         default.

                         This setting is only supported by version
                         1.8.20 or higher.

       utmp_runas        If set, <b>sudo </b>will store the name of the runas
                         user when updating the utmp (or utmpx) file.
                         By default, <b>sudo </b>stores the name of the
                         invoking user.  This flag is <i>off</i> by default.

       visiblepw         By default, <b>sudo </b>will refuse to run if the user
                         must enter a password but it is not possible to
                         disable echo on the terminal.  If the <i>visiblepw</i>
                         flag is set, <b>sudo </b>will prompt for a password
                         even when it would be visible on the screen.
                         This makes it possible to run things like ‘ssh
                         somehost sudo ls’ since by default, <i>ssh</i>(1) does
                         not allocate a tty when running a command.
                         This flag is <i>off</i> by default.

       <b>Integers</b>:

       closefrom         Before it executes a command, <b>sudo </b>will close
                         all open file descriptors other than standard
                         input, standard output, and standard error
                         (file descriptors 0-2).  The <i>closefrom</i> option
                         can be used to specify a different file
                         descriptor at which to start closing.  The
                         default is 3.

       command_timeout   The maximum amount of time a command is allowed
                         to run before it is terminated.  See the
                         <i>Timeout_Spec</i> section for a description of the
                         timeout syntax.

                         This setting is only supported by version
                         1.8.20 or higher.

       log_server_timeout
                         The maximum amount of time to wait when
                         connecting to a log server or waiting for a
                         server response.  See the <i>Timeout_Spec</i> section
                         for a description of the timeout syntax.  The
                         default value is 30 seconds.

                         This setting is only supported by version 1.9.0
                         or higher.

       maxseq            The maximum sequence number that will be
                         substituted for the ‘%{seq}’ escape in the I/O
                         log file (see the <i>iolog_dir</i> description below
                         for more information).  While the value
                         substituted for ‘%{seq}’ is in base 36, <i>maxseq</i>
                         itself should be expressed in decimal.  Values
                         larger than 2176782336 (which corresponds to
                         the base 36 sequence number “ZZZZZZ”) will be
                         silently truncated to 2176782336.  The default
                         value is 2176782336.

                         Once the local sequence number reaches the
                         value of <i>maxseq</i>, it will “roll over” to zero,
                         after which <b>sudoers </b>will truncate and reuse any
                         existing I/O log path names.

                         This setting is only supported by version 1.8.7
                         or higher.

       passwd_tries      The number of tries a user gets to enter
                         his/her password before <b>sudo </b>logs the failure
                         and exits.  The default is 3.

       syslog_maxlen     On many systems, <i>syslog</i>(3) has a relatively
                         small log buffer.  IETF RFC 5424 states that
                         syslog servers must support messages of at
                         least 480 bytes and should support messages up
                         to 2048 bytes.  By default, <b>sudoers </b>creates log
                         messages up to 980 bytes which corresponds to
                         the historic BSD syslog implementation which
                         used a 1024 byte buffer to store the message,
                         date, hostname, and program name.  To prevent
                         syslog messages from being truncated, <b>sudoers</b>
                         will split up log messages that are larger than
                         <i>syslog_maxlen</i> bytes.  When a message is split,
                         additional parts will include the string
                         “(command continued)” after the user name and
                         before the continued command line arguments.

                         This setting is only supported by version
                         1.8.19 or higher.

       <b>Integers that can be used in a boolean context</b>:

       loglinelen        Number of characters per line for the file log.
                         This value is used to decide when to wrap lines
                         for nicer log files.  This has no effect on the
                         syslog log file, only the file log.  The
                         default is 80 (use 0 or negate the option to
                         disable word wrap).

       passwd_timeout    Number of minutes before the <b>sudo </b>password
                         prompt times out, or 0 for no timeout.  The
                         timeout may include a fractional component if
                         minute granularity is insufficient, for example
                         2.5.  The default is 5.

       timestamp_timeout
                         Number of minutes that can elapse before <b>sudo</b>
                         will ask for a password again.  The timeout may
                         include a fractional component if minute
                         granularity is insufficient, for example 2.5.
                         The default is 5.  Set this to 0 to always
                         prompt for a password.  If set to a value less
                         than 0 the user's time stamp will not expire
                         until the system is rebooted.  This can be used
                         to allow users to create or delete their own
                         time stamps via ‘sudo -v’ and ‘sudo -k’
                         respectively.

       umask             File mode creation mask to use when running the
                         command.  Negate this option or set it to 0777
                         to prevent <b>sudoers </b>from changing the umask.
                         Unless the <i>umask_override</i> flag is set, the
                         actual umask will be the union of the user's
                         umask and the value of the <i>umask</i> setting, which
                         defaults to 0022.  This guarantees that <b>sudo</b>
                         never lowers the umask when running a command.

                         If <i>umask</i> is explicitly set in <i>sudoers</i>, it will
                         override any umask setting in PAM or
                         login.conf.  If <i>umask</i> is not set in <i>sudoers</i>,
                         the umask specified by PAM or login.conf will
                         take precedence.  The umask setting in PAM is
                         not used for <b>sudoedit</b>, which does not create a
                         new PAM session.

       <b>Strings</b>:

       cmddenial_message
                         It set, <b>sudo </b>will display this message when a
                         user is denied access to run the specified
                         command, but is listed in the <i>sudoers</i> file for
                         the host.  This can be used to provide
                         additional, site-specific information to the
                         user when a command is denied by the security
                         policy.  It does not override the standard
                         warning the user receives when a command is
                         denied.

       authfail_message  Message that is displayed after a user fails to
                         authenticate.  The message may include the ‘%d’
                         escape which will expand to the number of
                         failed password attempts.  If set, it overrides
                         the default message, “%d incorrect password
                         attempt(s)”.

       badpass_message   Message that is displayed if a user enters an
                         incorrect password.  The default is “Sorry, try
                         again.” unless insults are enabled.

       editor            A colon (‘:’) separated list of editor path
                         names used by <b>sudoedit </b>and <b>visudo</b>.  For
                         <b>sudoedit</b>, this list is used to find an editor
                         when none of the SUDO_EDITOR, VISUAL or EDITOR
                         environment variables are set to an editor that
                         exists and is executable.  For <b>visudo</b>, it is
                         used as a white list of allowed editors; <b>visudo</b>
                         will choose the editor that matches the user's
                         SUDO_EDITOR, VISUAL or EDITOR environment
                         variable if possible, or the first editor in
                         the list that exists and is executable if not.
                         Unless invoked as <b>sudoedit</b>, <b>sudo </b>does not
                         preserve the SUDO_EDITOR, VISUAL or EDITOR
                         environment variables unless they are present
                         in the <i>env_keep</i> list or the <i>env_reset</i> option is
                         disabled.  The default is <i>/usr/bin/vi</i>.

       intercept_type    The underlying mechanism used by the <i>intercept</i>
                         and <i>log_subcmds</i> options.  It has the following
                         possible values:

                         dso     Preload a dynamic shared object (shared
                                 library) that intercepts the <i>execve</i>(2),
                                 <i>execl</i>(3), <i>execle</i>(3), <i>execlp</i>(3),
                                 <i>execv</i>(3), <i>execvp</i>(3), <i>execvpe</i>(3), and
                                 <i>system</i>(3) library functions.  A value
                                 of <i>dso</i> is incompatible with <b>sudo</b>'s
                                 SELinux RBAC support.

                         trace   Use <i>ptrace</i>(2) to intercept the
                                 <i>execve</i>(2) system call.  This is only
                                 supported on Linux systems where
                                 <i>seccomp</i>(2) filtering is enabled.  If
                                 the
                                 <i>/proc/sys/kernel/seccomp/actions_avail</i>
                                 file is missing or does not contain a
                                 “trap” element, setting <i>intercept_type</i>
                                 to <i>trace</i> will have no effect and <i>dso</i>
                                 will be used instead.

                         The default is to use <i>trace</i> if it is supported
                         by the system and <i>dso</i> if it is not.

       iolog_dir         The top-level directory to use when
                         constructing the path name for the input/output
                         log directory.  Only used if the <i>log_input</i> or
                         <i>log_output</i> options are enabled or when the
                         LOG_INPUT or LOG_OUTPUT tags are present for a
                         command.  The session sequence number, if any,
                         is stored in the directory.  The default is
                         <i>/var/log/sudo-io</i>.

                         The following percent (‘%’) escape sequences
                         are supported:

                         %{seq}
                               expanded to a monotonically increasing
                               base-36 sequence number, such as 0100A5,
                               where every two digits are used to form a
                               new directory, e.g., <i>01/00/A5</i>

                         %{user}
                               expanded to the invoking user's login
                               name

                         %{group}
                               expanded to the name of the invoking
                               user's real group-ID

                         %{runas_user}
                               expanded to the login name of the user
                               the command will be run as (e.g., <b>root</b>)

                         %{runas_group}
                               expanded to the group name of the user
                               the command will be run as (e.g., <b>wheel</b>)

                         %{hostname}
                               expanded to the local host name without
                               the domain name

                         %{command}
                               expanded to the base name of the command
                               being run

                         In addition, any escape sequences supported by
                         the system's <i>strftime</i>(3) function will be
                         expanded.

                         To include a literal ‘%’ character, the string
                         ‘%%’ should be used.

                         Any path name separator characters (‘/’)
                         present in the user, group or host name will be
                         replaced with an underbar (‘_’) during
                         expansion.

       iolog_file        The path name, relative to <i>iolog_dir</i>, in which
                         to store input/output logs when the <i>log_input</i>
                         or <i>log_output</i> options are enabled or when the
                         LOG_INPUT or LOG_OUTPUT tags are present for a
                         command.  <i>iolog_file</i> may contain directory
                         components.  The default is ‘%{seq}’.

                         See the <i>iolog_dir</i> option above for a list of
                         supported percent (‘%’) escape sequences.

                         In addition to the escape sequences, path names
                         that end in six or more <i>X</i>s will have the <i>X</i>s
                         replaced with a unique combination of digits
                         and letters, similar to the <i>mktemp</i>(3) function.

                         If the path created by concatenating <i>iolog_dir</i>
                         and <i>iolog_file</i> already exists, the existing I/O
                         log file will be truncated and overwritten
                         unless <i>iolog_file</i> ends in six or more <i>X</i>s.

       iolog_flush       If set, <b>sudo </b>will flush I/O log data to disk
                         after each write instead of buffering it.  This
                         makes it possible to view the logs in real-time
                         as the program is executing but may
                         significantly reduce the effectiveness of I/O
                         log compression.  This flag is <i>off</i> by default.

                         This setting is only supported by version
                         1.8.20 or higher.

       iolog_group       The group name to look up when setting the
                         group-ID on new I/O log files and directories.
                         If <i>iolog_group</i> is not set, the primary group-ID
                         of the user specified by <i>iolog_user</i> is used.
                         If neither <i>iolog_group</i> nor <i>iolog_user</i> are set,
                         I/O log files and directories are created with
                         group-ID 0.

                         This setting is only supported by version
                         1.8.19 or higher.

       iolog_mode        The file mode to use when creating I/O log
                         files.  Mode bits for read and write
                         permissions for owner, group, or other are
                         honored, everything else is ignored.  The file
                         permissions will always include the owner read
                         and write bits, even if they are not present in
                         the specified mode.  When creating I/O log
                         directories, search (execute) bits are added to
                         match the read and write bits specified by
                         <i>iolog_mode</i>.  Defaults to 0600 (read and write
                         by user only).

                         This setting is only supported by version
                         1.8.19 or higher.

       iolog_user        The user name to look up when setting the user
                         and group-IDs on new I/O log files and
                         directories.  If <i>iolog_group</i> is set, it will be
                         used instead of the user's primary group-ID.
                         By default, I/O log files and directories are
                         created with user and group-ID 0.

                         This setting can be useful when the I/O logs
                         are stored on a Network File System (NFS)
                         share.  Having a dedicated user own the I/O log
                         files means that <b>sudoers </b>does not write to the
                         log files as user-ID 0, which is usually not
                         permitted by NFS.

                         This setting is only supported by version
                         1.8.19 or higher.

       lecture_status_dir
                         The directory in which <b>sudo </b>stores per-user
                         lecture status files.  Once a user has received
                         the lecture, a zero-length file is created in
                         this directory so that <b>sudo </b>will not lecture
                         the user again.  This directory should <i>not</i> be
                         cleared when the system reboots.  The default
                         is <i>/var/db/sudo/lectured</i>.

       log_server_cabundle
                         The path to a certificate authority bundle
                         file, in PEM format, to use instead of the
                         system's default certificate authority database
                         when authenticating the log server.  The
                         default is to use the system's default
                         certificate authority database.  This setting
                         has no effect unless <i>log_servers</i> is set and the
                         remote log server is secured with TLS.

                         This setting is only supported by version 1.9.0
                         or higher.

       log_server_peer_cert
                         The path to the <b>sudo </b>client's certificate file,
                         in PEM format.  This setting is required when
                         the remote log server is secured with TLS and
                         client certificate validation is enabled.  For
                         <b>sudo_logsrvd</b>, client certificate validation is
                         controlled by the <i>tls_checkpeer</i> option, which
                         defaults to <i>false</i>.

                         This setting is only supported by version 1.9.0
                         or higher.

       log_server_peer_key
                         The path to the <b>sudo </b>client's private key file,
                         in PEM format.  This setting is required when
                         the remote log server is secured with TLS and
                         client certificate validation is enabled.  For
                         <b>sudo_logsrvd</b>, client certificate validation is
                         controlled by the <i>tls_checkpeer</i> flag, which
                         defaults to <i>false</i>.

                         This setting is only supported by version 1.9.0
                         or higher.

       mailsub           Subject of the mail sent to the <i>mailto</i> user.
                         The escape ‘%h’ will expand to the host name of
                         the machine.  Default is “*** SECURITY
                         information for %h ***”.

       noexec_file       As of <b>sudo </b>version 1.8.1 this option is no
                         longer supported.  The path to the noexec file
                         should now be set in the <i>sudo.conf</i>(5) file.

       pam_askpass_service
                         On systems that use PAM for authentication,
                         this is the service name used when the <b>-A</b>
                         option is specified.  The default value is
                         either ‘sudo’ or ‘sudo’, depending on whether
                         or not the <b>-i </b>option is also specified.  See
                         the description of <i>pam_service</i> for more
                         information.

                         This setting is only supported by version 1.9.9
                         or higher.

       pam_login_service
                         On systems that use PAM for authentication,
                         this is the service name used when the <b>-i</b>
                         option is specified.  The default value is
                         ‘sudo’.  See the description of <i>pam_service</i> for
                         more information.

                         This setting is only supported by version 1.8.8
                         or higher.

       pam_service       On systems that use PAM for authentication, the
                         service name specifies the PAM policy to apply.
                         This usually corresponds to an entry in the
                         <i>pam.conf</i> file or a file in the <i>/etc/pam.d</i>
                         directory.  The default value is ‘sudo’.

                         This setting is only supported by version 1.8.8
                         or higher.

       passprompt        The default prompt to use when asking for a
                         password; can be overridden via the <b>-p </b>option
                         or the SUDO_PROMPT environment variable.  The
                         following percent (‘%’) escape sequences are
                         supported:

                         %H    expanded to the local host name including
                               the domain name (only if the machine's
                               host name is fully qualified or the <i>fqdn</i>
                               option is set)

                         %h    expanded to the local host name without
                               the domain name

                         %p    expanded to the user whose password is
                               being asked for (respects the <i>rootpw</i>,
                               <i>targetpw</i> and <i>runaspw</i> flags in <i>sudoers</i>)

                         %U    expanded to the login name of the user
                               the command will be run as (defaults to
                               <b>root</b>)

                         %u    expanded to the invoking user's login
                               name

                         %%    two consecutive ‘%’ characters are
                               collapsed into a single ‘%’ character

                         On systems that use PAM for authentication,
                         <i>passprompt</i> will only be used if the prompt
                         provided by the PAM module matches the string
                         “Password: ” or “username's Password: ”.  This
                         ensures that the <i>passprompt</i> setting does not
                         interfere with challenge-response style
                         authentication.  The <i>passprompt_override</i> flag
                         can be used to change this behavior.

                         The default value is ‘Password: ’.

       runas_default     The default user to run commands as if the <b>-u</b>
                         option is not specified on the command line.
                         This defaults to <b>root</b>.

       sudoers_locale    Locale to use when parsing the sudoers file,
                         logging commands, and sending email.  Changing
                         the locale may affect how sudoers is
                         interpreted.  Defaults to ‘C’.

       timestamp_type    <b>sudoers </b>uses per-user time stamp files for
                         credential caching.  The <i>timestamp_type</i> option
                         can be used to specify the type of time stamp
                         record used.  It has the following possible
                         values:

                         global  A single time stamp record is used for
                                 all of a user's login sessions,
                                 regardless of the terminal or parent
                                 process ID.  An additional record is
                                 used to serialize password prompts when
                                 <b>sudo </b>is used multiple times in a
                                 pipeline, but this does not affect
                                 authentication.

                         ppid    A single time stamp record is used for
                                 all processes with the same parent
                                 process ID (usually the shell).
                                 Commands run from the same shell (or
                                 other common parent process) will not
                                 require a password for
                                 <i>timestamp_timeout</i> minutes (5 by
                                 default).  Commands run via <b>sudo </b>with a
                                 different parent process ID, for
                                 example from a shell script, will be
                                 authenticated separately.

                         tty     One time stamp record is used for each
                                 terminal, which means that a user's
                                 login sessions are authenticated
                                 separately.  If no terminal is present,
                                 the behavior is the same as <i>ppid</i>.
                                 Commands run from the same terminal
                                 will not require a password for
                                 <i>timestamp_timeout</i> minutes (5 by
                                 default).

                         kernel  The time stamp is stored in the kernel
                                 as an attribute of the terminal device.
                                 If no terminal is present, the behavior
                                 is the same as <i>ppid</i>.  Negative
                                 <i>timestamp_timeout</i> values are not
                                 supported and positive values are
                                 limited to a maximum of 60 minutes.
                                 This is currently only supported on
                                 OpenBSD.

                         The default value is <i>tty</i>.

                         This setting is only supported by version
                         1.8.21 or higher.

       timestampdir      The directory in which <b>sudo </b>stores its time
                         stamp files.  This directory should be cleared
                         when the system reboots.  The default is
                         <i>/run/sudo/ts</i>.

       timestampowner    The owner of the lecture status directory, time
                         stamp directory and all files stored therein.
                         The default is <b>root</b>.

       <b>Strings that can be used in a boolean context</b>:

       admin_flag    The <i>admin_flag</i> option specifies the path to a file
                     that is created the first time a user that is a
                     member of the <i>sudo</i> or <i>admin</i> groups runs <b>sudo</b>.  Only
                     available if <b>sudo </b>is configured with the
                     <b>--enable-admin-flag </b>option.  The default value is
                     <i>~/.sudo_as_admin_successful</i>.

       env_file      The <i>env_file</i> option specifies the fully qualified
                     path to a file containing variables to be set in
                     the environment of the program being run.  Entries
                     in this file should either be of the form
                     ‘VARIABLE=value’ or ‘export VARIABLE=value’.  The
                     value may optionally be enclosed in single or
                     double quotes.  Variables in this file are only
                     added if the variable does not already exist in the
                     environment.  This file is considered to be part of
                     the security policy, its contents are not subject
                     to other <b>sudo </b>environment restrictions such as
                     <i>env_keep</i> and <i>env_check</i>.

       exempt_group  Users in this group are exempt from password and
                     PATH requirements.  The group name specified should
                     not include a ‘%’ prefix.  This is not set by
                     default.

       fdexec        Determines whether <b>sudo </b>will execute a command by
                     its path or by an open file descriptor.  It has the
                     following possible values:

                     always  Always execute by file descriptor.

                     never   Never execute by file descriptor.

                     digest_only
                             Only execute by file descriptor if the
                             command has an associated digest in the
                             <i>sudoers</i> file.

                     The default value is <i>digest_only</i>.  This avoids a
                     time of check versus time of use race condition
                     when the command is located in a directory writable
                     by the invoking user.

                     <i>fdexec</i> will change the first element of the
                     argument vector for scripts ($0 in the shell) due
                     to the way the kernel runs script interpreters.
                     Instead of being a normal path, it will refer to a
                     file descriptor.  For example, <i>/dev/fd/4</i> on Solaris
                     and <i>/proc/self/fd/4</i> on Linux.  A workaround is to
                     use the SUDO_COMMAND environment variable instead.

                     The <i>fdexec</i> setting is only used when the command is
                     matched by path name.  It has no effect if the
                     command is matched by the built-in <b>ALL </b>alias.

                     This setting is only supported by version 1.8.20 or
                     higher.  If the operating system does not support
                     the <i>fexecve</i>(2) system call, this setting has no
                     effect.

       group_plugin  A string containing a <b>sudoers </b>group plugin with
                     optional arguments.  The string should consist of
                     the plugin path, either fully-qualified or relative
                     to the <i>/usr/local/libexec/sudo</i> directory, followed
                     by any configuration arguments the plugin requires.
                     These arguments (if any) will be passed to the
                     plugin's initialization function.  If arguments are
                     present, the string must be enclosed in double
                     quotes ("").

                     On 64-bit systems, if the plugin is present but
                     cannot be loaded, <b>sudoers </b>will look for a 64-bit
                     version and, if it exists, load that as a fallback.
                     The exact rules for this vary by system.  On
                     Solaris, if the plugin is stored in a directory
                     ending in “lib”, <b>sudoers </b>will create a fallback
                     path by appending “/64” to the directory name;
                     <i>/usr/local/lib/group_plugin.so</i> becomes
                     <i>/usr/local/lib/64/group_plugin.so</i>.  On Linux, a
                     directory ending in “lib” will be transformed to
                     “lib64” as the fallback path;
                     <i>/usr/local/lib/group_plugin.so</i> becomes
                     <i>/usr/local/lib64/group_plugin.so</i>.  On all other
                     systems, the fallback path is generated by adding a
                     “64” before the file extension; <i>group_plugin.so</i>
                     becomes <i>group_plugin64.so</i>.

                     On AIX systems, the plugin may be either a shared
                     object ending in ‘.so’ or an archive file
                     containing a shared object ending in ‘.a’ with the
                     name of the shared object in parentheses at the
                     end.

                     For more information see “GROUP PROVIDER PLUGINS”.

       lecture       This option controls when a short lecture will be
                     printed along with the password prompt.  It has the
                     following possible values:

                     always  Always lecture the user.

                     never   Never lecture the user.

                     once    Only lecture the user the first time they
                             run <b>sudo</b>.

                     If no value is specified, a value of <i>once</i> is
                     implied.  Negating the option results in a value of
                     <i>never</i> being used.  The default value is <i>once</i>.

       lecture_file  Path to a file containing an alternate <b>sudo </b>lecture
                     that will be used in place of the standard lecture
                     if the named file exists.  By default, <b>sudo </b>uses a
                     built-in lecture.

       listpw        This option controls when a password will be
                     required when a user runs <b>sudo </b>with the <b>-l </b>option.
                     It has the following possible values:

                     all   All the user's <i>sudoers</i> file entries for the
                           current host must have the NOPASSWD flag set
                           to avoid entering a password.

                     always
                           The user must always enter a password to use
                           the <b>-l </b>option.

                     any   At least one of the user's <i>sudoers</i> file
                           entries for the current host must have the
                           NOPASSWD flag set to avoid entering a
                           password.

                     never
                           The user need never enter a password to use
                           the <b>-l </b>option.

                     If no value is specified, a value of <i>any</i> is
                     implied.  Negating the option results in a value of
                     <i>never</i> being used.  The default value is <i>any</i>.

       log_format    The event log format.  Supported log formats are:

                     json  Currently, this is an alias for <i>json_pretty</i>.
                           In a future version of <b>sudo</b>, <i>json</i> will be
                           equivalent to <i>json_compact</i>.  JSON log entries
                           contain the full user details as well as the
                           execution environment if the command was
                           allowed.

                     json_compact
                           Log events in “compact” (minified) JSON
                           format.  Each event is written as a separate
                           JSON object on single line without extraneous
                           white space.  Due to limitations of the
                           protocol, JSON events sent via <i>syslog</i> may be
                           truncated.

                     json_pretty
                           Log events in “pretty” JSON format.  When
                           logging to a file, the entire file is treated
                           as a single JSON object consisting of
                           multiple events, each event spanning multiple
                           lines.  When logging via <i>syslog</i>, there is no
                           difference between the <i>json_pretty</i> and
                           <i>json_compact</i> formats.

                     sudo  Log events in traditional sudo-style format,
                           see “EVENT LOGGING” for details.

                     This setting affects logs sent via <i>syslog</i>(3) as
                     well as the file specified by the <i>logfile</i> setting,
                     if any.  The default value is <i>sudo</i>.

       logfile       Path to the <b>sudo </b>log file (not the syslog log
                     file).  Setting a path turns on logging to a file;
                     negating this option turns it off.  By default,
                     <b>sudo </b>logs via syslog.

       mailerflags   Flags to use when invoking mailer.  Defaults to <b>-t</b>.

       mailerpath    Path to mail program used to send warning mail
                     (negate to prevent <b>sudo </b>from sending mail).
                     Defaults to the path to sendmail found at configure
                     time.

       mailfrom      Address to use for the “from” address when sending
                     warning and error mail.  The address should be
                     enclosed in double quotes ("") to protect against
                     <b>sudo </b>interpreting the ‘@’ sign.  Defaults to the
                     name of the user running <b>sudo</b>.

       mailto        Address to send warning and error mail to (negate
                     to prevent <b>sudo </b>from sending mail).  The address
                     should be enclosed in double quotes ("") to protect
                     against <b>sudo </b>interpreting the ‘@’ sign.  Defaults
                     to root.

       rlimit_as     The maximum size to which the process's address
                     space may grow (in bytes), if supported by the
                     operating system.  See “Resource limits” for more
                     information.

       rlimit_core   The largest size core dump file that may be created
                     (in bytes).  See “Resource limits” for more
                     information.  Defaults to 0 (no core dump created).

       rlimit_cpu    The maximum amount of CPU time that the process may
                     use (in seconds).  See “Resource limits” for more
                     information.

       rlimit_data   The maximum size of the data segment for the
                     process (in bytes).  See “Resource limits” for more
                     information.

       rlimit_fsize  The largest size file that the process may create
                     (in bytes).  See “Resource limits” for more
                     information.

       rlimit_locks  The maximum number of locks that the process may
                     establish, if supported by the operating system.
                     See “Resource limits” for more information.

       rlimit_memlock
                     The maximum size that the process may lock in
                     memory (in bytes), if supported by the operating
                     system.  See “Resource limits” for more
                     information.

       rlimit_nofile
                     The maximum number of files that the process may
                     have open.  See “Resource limits” for more
                     information.

       rlimit_nproc  The maximum number of processes that the user may
                     run simultaneously.  See “Resource limits” for more
                     information.

       rlimit_rss    The maximum size to which the process's resident
                     set size may grow (in bytes).  See “Resource
                     limits” for more information.

       rlimit_stack  The maximum size to which the process's stack may
                     grow (in bytes).  See “Resource limits” for more
                     information.

       restricted_env_file
                     The <i>restricted_env_file</i> option specifies the fully
                     qualified path to a file containing variables to be
                     set in the environment of the program being run.
                     Entries in this file should either be of the form
                     ‘VARIABLE=value’ or ‘export VARIABLE=value’.  The
                     value may optionally be enclosed in single or
                     double quotes.  Variables in this file are only
                     added if the variable does not already exist in the
                     environment.  Unlike <i>env_file</i>, the file's contents
                     are not trusted and are processed in a manner
                     similar to that of the invoking user's environment.
                     If <i>env_reset</i> is enabled, variables in the file will
                     only be added if they are matched by either the
                     <i>env_check</i> or <i>env_keep</i> list.  If <i>env_reset</i> is
                     disabled, variables in the file are added as long
                     as they are not matched by the <i>env_delete</i> list.  In
                     either case, the contents of <i>restricted_env_file</i>
                     are processed before the contents of <i>env_file</i>.

       runchroot     If set, <b>sudo </b>will use this value for the root
                     directory when running a command.  The special
                     value “*” will allow the user to specify the root
                     directory via <b>sudo</b>'s <b>-R </b>option.  See the
                     “Chroot_Spec” section for more details.

                     It is only possible to use <i>runchroot</i> as a command-
                     specific Defaults setting if the command exists
                     with the same path both inside and outside the
                     chroot jail.  This restriction does not apply to
                     global, host, or user-based Defaults settings or to
                     a <i>Cmnd_Spec</i> that includes a <i>Chroot_Spec</i>.

                     This setting is only supported by version 1.9.3 or
                     higher.

       runcwd        If set, <b>sudo </b>will use this value for the working
                     directory when running a command.  The special
                     value “*” will allow the user to specify the
                     working directory via <b>sudo</b>'s <b>-D </b>option.  See the
                     “Chdir_Spec” section for more details.

                     This setting is only supported by version 1.9.3 or
                     higher.

       secure_path   If set, <b>sudo </b>will use this value in place of the
                     user's PATH environment variable.  This option can
                     be used to reset the PATH to a known good value
                     that contains directories for system administrator
                     commands such as <i>/usr/sbin</i>.

                     Users in the group specified by the <i>exempt_group</i>
                     option are not affected by <i>secure_path</i>.  This
                     option is not set by default.

       syslog        Syslog facility if syslog is being used for logging
                     (negate to disable syslog logging).  Defaults to
                     authpriv.

                     The following syslog facilities are supported:
                     <b>authpriv </b>(if your OS supports it), <b>auth</b>, <b>daemon</b>,
                     <b>user</b>, <b>local0</b>, <b>local1</b>, <b>local2</b>, <b>local3</b>, <b>local4</b>,
                     <b>local5</b>, <b>local6</b>, and <b>local7</b>.

       syslog_badpri
                     Syslog priority to use when the user is not allowed
                     to run a command or when authentication is
                     unsuccessful.  Defaults to alert.

                     The following syslog priorities are supported:
                     <b>alert</b>, <b>crit</b>, <b>debug</b>, <b>emerg</b>, <b>err</b>, <b>info</b>, <b>notice</b>,
                     <b>warning</b>, and <b>none</b>.  Negating the option or setting
                     it to a value of <b>none </b>will disable logging of
                     unsuccessful commands.

       syslog_goodpri
                     Syslog priority to use when the user is allowed to
                     run a command and authentication is successful.
                     Defaults to notice.

                     See <i>syslog_badpri</i> for the list of supported syslog
                     priorities.  Negating the option or setting it to a
                     value of <b>none </b>will disable logging of successful
                     commands.

       verifypw      This option controls when a password will be
                     required when a user runs <b>sudo </b>with the <b>-v </b>option.
                     It has the following possible values:

                     all     All the user's <i>sudoers</i> file entries for the
                             current host must have the NOPASSWD flag
                             set to avoid entering a password.

                     always  The user must always enter a password to
                             use the <b>-v </b>option.

                     any     At least one of the user's <i>sudoers</i> file
                             entries for the current host must have the
                             NOPASSWD flag set to avoid entering a
                             password.

                     never   The user need never enter a password to use
                             the <b>-v </b>option.

                     If no value is specified, a value of <i>all</i> is
                     implied.  Negating the option results in a value of
                     <i>never</i> being used.  The default value is <i>all</i>.

       <b>Lists that can be used in a boolean context</b>:

       env_check         Environment variables to be removed from the
                         user's environment unless they are considered
                         “safe”.  For all variables except TZ, “safe”
                         means that the variable's value does not
                         contain any ‘%’ or ‘/’ characters.  This can be
                         used to guard against printf-style format
                         vulnerabilities in poorly-written programs.
                         The TZ variable is considered unsafe if any of
                         the following are true:

                         <b>•  </b>It consists of a fully-qualified path name,
                            optionally prefixed with a colon (‘:’), that
                            does not match the location of the <i>zoneinfo</i>
                            directory.

                         <b>•  </b>It contains a <i>..</i> path element.

                         <b>•  </b>It contains white space or non-printable
                            characters.

                         <b>•  </b>It is longer than the value of PATH_MAX.

                         The argument may be a double-quoted, space-
                         separated list or a single value without
                         double-quotes.  The list can be replaced, added
                         to, deleted from, or disabled by using the ‘=’,
                         ‘+=’, ‘-=’, and ‘!’ operators respectively.
                         Regardless of whether the <i>env_reset</i> option is
                         enabled or disabled, variables specified by
                         <i>env_check</i> will be preserved in the environment
                         if they pass the aforementioned check.  The
                         global list of environment variables to check
                         is displayed when <b>sudo </b>is run by <b>root </b>with the
                         <b>-V </b>option.

       env_delete        Environment variables to be removed from the
                         user's environment when the <i>env_reset</i> option is
                         not in effect.  The argument may be a double-
                         quoted, space-separated list or a single value
                         without double-quotes.  The list can be
                         replaced, added to, deleted from, or disabled
                         by using the ‘=’, ‘+=’, ‘-=’, and ‘!’ operators
                         respectively.  The global list of environment
                         variables to remove is displayed when <b>sudo </b>is
                         run by <b>root </b>with the <b>-V </b>option.  Many operating
                         systems will remove potentially dangerous
                         variables from the environment of any set-user-
                         ID process (such as <b>sudo</b>).

       env_keep          Environment variables to be preserved in the
                         user's environment when the <i>env_reset</i> option is
                         in effect.  This allows fine-grained control
                         over the environment <b>sudo</b>-spawned processes
                         will receive.  The argument may be a double-
                         quoted, space-separated list or a single value
                         without double-quotes.  The list can be
                         replaced, added to, deleted from, or disabled
                         by using the ‘=’, ‘+=’, ‘-=’, and ‘!’ operators
                         respectively.  The global list of variables to
                         keep is displayed when <b>sudo </b>is run by <b>root </b>with
                         the <b>-V </b>option.

                         Preserving the HOME environment variable has
                         security implications since many programs use
                         it when searching for configuration or data
                         files.  Adding HOME to <i>env_keep</i> may enable a
                         user to run unrestricted commands via <b>sudo </b>and
                         is strongly discouraged.  Users wishing to edit
                         files with <b>sudo </b>should run <b>sudoedit </b>(or <b>sudo</b>
                         <b>-e</b>) to get their accustomed editor
                         configuration instead of invoking the editor
                         directly.

       log_servers       A list of one or more servers to use for remote
                         event and I/O log storage, separated by white
                         space.  Log servers must be running
                         <b>sudo_logsrvd </b>or another service that implements
                         the protocol described by <i>sudo_logsrv.proto</i>(5).

                         Server addresses should be of the form
                         “host[:port][(tls)]”.  The host portion may be
                         a host name, an IPv4 address, or an IPv6
                         address in square brackets.

                         If the optional <i>tls</i> flag is present, the
                         connection will be secured with Transport Layer
                         Security (TLS) version 1.2 or 1.3.  Versions of
                         TLS prior to 1.2 are not supported.

                         If a port is specified, it may either be a port
                         number or a well-known service name as defined
                         by the system service name database.  If no
                         port is specified, port 30343 will be used for
                         plaintext connections and port 30344 will be
                         used for TLS connections.

                         When <i>log_servers</i> is set, event log data will be
                         logged both locally (see the <i>syslog</i> and
                         <i>log_file</i> settings) as well as remotely, but I/O
                         log data will only be logged remotely.  If
                         multiple hosts are specified, they will be
                         attempted in reverse order.  If no log servers
                         are available, the user will not be able to run
                         a command unless either the <i>ignore_iolog_errors</i>
                         flag (I/O logging enabled) or the
                         <i>ignore_log_errors</i> flag (I/O logging disabled)
                         is set.  Likewise, if the connection to the log
                         server is interrupted while <b>sudo </b>is running,
                         the command will be terminated unless the
                         <i>ignore_iolog_errors</i> flag (I/O logging enabled)
                         or the <i>ignore_log_errors</i> flag (I/O logging
                         disabled) is set.

                         This setting is only supported by version 1.9.0
                         or higher.

       passprompt_regex  A list of POSIX extended regular expressions
                         used to match password prompts in the terminal
                         output.  As an extension, if the regular
                         expression begins with “(?i)”, it will be
                         matched in a case-insensitive manner.  Each
                         regular expression is limited to 1024
                         characters.  This option is only used when
                         <i>log_passwords</i> has been disabled.  The default
                         value is “[Pp]assword[: ]*”

                         This setting is only supported by version
                         1.9.10 or higher.
</pre> <h2>
GROUP PROVIDER PLUGINS </h2>
<pre>
       The <b>sudoers </b>plugin supports its own plugin interface to allow
       non-Unix group lookups which can query a group source other than
       the standard Unix group database.  This can be used to implement
       support for the <i>nonunix_group</i> syntax described earlier.

       Group provider plugins are specified via the <i>group_plugin</i>
       setting.  The argument to <i>group_plugin</i> should consist of the
       plugin path, either fully-qualified or relative to the
       <i>/usr/local/libexec/sudo</i> directory, followed by any configuration
       options the plugin requires.  These options (if specified) will
       be passed to the plugin's initialization function.  If options
       are present, the string must be enclosed in double quotes ("").

       The following group provider plugins are installed by default:

       group_file
             The <i>group_file</i> plugin supports an alternate group file that
             uses the same syntax as the <i>/etc/group</i> file.  The path to
             the group file should be specified as an option to the
             plugin.  For example, if the group file to be used is
             <i>/etc/sudo-group</i>:

             Defaults group_plugin="group_file.so /etc/sudo-group"

       system_group
             The <i>system_group</i> plugin supports group lookups via the
             standard C library functions <i>getgrnam</i>(3) and <i>getgrid</i>(3).
             This plugin can be used in instances where the user belongs
             to groups not present in the user's supplemental group
             vector.  This plugin takes no options:

             Defaults group_plugin=system_group.so

       The group provider plugin API is described in detail in
       <i>sudo_plugin</i>(5).
</pre> <h2>
EVENT LOGGING </h2>
<pre>
       <b>sudoers </b>can log events in either JSON or <i>sudo</i> format, this
       section describes the <i>sudo</i> log format.  Depending on <i>sudoers</i>
       configuration, <b>sudoers </b>can log events via <i>syslog</i>(3), to a local
       log file, or both.  The log format is almost identical in both
       cases.  Any control characters present in the log data are
       formatted in octal with a leading ‘#’ character.  For example, a
       horizontal tab is stored as ‘#011’ and an embedded carriage
       return is stored as ‘#015’.  In addition, space characters in the
       command path are stored as ‘#040’.  Command line arguments that
       contain spaces are enclosed in single quotes ('').  This makes it
       possible to distinguish multiple command line arguments from a
       single argument that contains spaces.  Literal single quotes and
       backslash characters (‘\’) in command line arguments are escaped
       with a backslash.

   <b>Accepted command log entries</b>
       Commands that sudo runs are logged using the following format
       (split into multiple lines for readability):

           date hostname progname: username : TTY=ttyname ; CHROOT=chroot ; \
               PWD=cwd ; USER=runasuser ; GROUP=runasgroup ; TSID=logid ; \
               ENV=env_vars COMMAND=command

       Where the fields are as follows:

       date          The date the command was run.  Typically, this is
                     in the format “MMM, DD, HH:MM:SS”.  If logging via
                     <i>syslog</i>(3), the actual date format is controlled by
                     the syslog daemon.  If logging to a file and the
                     <i>log_year</i> option is enabled, the date will also
                     include the year.

       hostname      The name of the host <b>sudo </b>was run on.  This field
                     is only present when logging via <i>syslog</i>(3).

       progname      The name of the program, usually <i>sudo</i> or <i>sudoedit</i>.
                     This field is only present when logging via
                     <i>syslog</i>(3).

       username      The login name of the user who ran <b>sudo</b>.

       ttyname       The short name of the terminal (e.g., “console”,
                     “tty01”, or “pts/0”) <b>sudo </b>was run on, or “unknown”
                     if there was no terminal present.

       chroot        The root directory that the command was run in, if
                     one was specified.

       cwd           The current working directory that <b>sudo </b>was run in.

       runasuser     The user the command was run as.

       runasgroup    The group the command was run as if one was
                     specified on the command line.

       logid         An I/O log identifier that can be used to replay
                     the command's output.  This is only present when
                     the <i>log_input</i> or <i>log_output</i> option is enabled.

       env_vars      A list of environment variables specified on the
                     command line, if specified.

       command       The actual command that was executed, including any
                     command line arguments.

       Messages are logged using the locale specified by <i>sudoers_locale</i>,
       which defaults to the ‘C’ locale.

   <b>Denied command log entries</b>
       If the user is not allowed to run the command, the reason for the
       denial will follow the user name.  Possible reasons include:

       user NOT in sudoers
         The user is not listed in the <i>sudoers</i> file.

       user NOT authorized on host
         The user is listed in the <i>sudoers</i> file but is not allowed to
         run commands on the host.

       command not allowed
         The user is listed in the <i>sudoers</i> file for the host but they
         are not allowed to run the specified command.

       3 incorrect password attempts
         The user failed to enter their password after 3 tries.  The
         actual number of tries will vary based on the number of failed
         attempts and the value of the <i>passwd_tries</i> option.

       a password is required
         The <b>-n </b>option was specified but a password was required.

       sorry, you are not allowed to set the following environment
         variables
         The user specified environment variables on the command line
         that were not allowed by <i>sudoers</i>.

   <b>Error log entries</b>
       If an error occurs, <b>sudoers </b>will log a message and, in most
       cases, send a message to the administrator via email.  Possible
       errors include:

       parse error in /etc/sudoers near line N
         <b>sudoers </b>encountered an error when parsing the specified file.
         In some cases, the actual error may be one line above or below
         the line number listed, depending on the type of error.

       problem with defaults entries
         The <i>sudoers</i> file contains one or more unknown Defaults
         settings.  This does not prevent <b>sudo </b>from running, but the
         <i>sudoers</i> file should be checked using <b>visudo</b>.

       timestamp owner (username): No such user
         The time stamp directory owner, as specified by the
         <i>timestampowner</i> setting, could not be found in the password
         database.

       unable to open/read /etc/sudoers
         The <i>sudoers</i> file could not be opened for reading.  This can
         happen when the <i>sudoers</i> file is located on a remote file system
         that maps user-ID 0 to a different value.  Normally, <b>sudoers</b>
         tries to open the <i>sudoers</i> file using group permissions to avoid
         this problem.  Consider either changing the ownership of
         <i>/etc/sudoers</i> or adding an argument like “sudoers_uid=N” (where
         ‘N’ is the user-ID that owns the <i>sudoers</i> file) to the end of
         the <b>sudoers </b><i>Plugin</i> line in the <i>sudo.conf</i>(5) file.

       unable to open /etc/sudoers
         The <i>/etc/sudoers</i> file is missing.

       /etc/sudoers is not a regular file
         The <i>/etc/sudoers</i> file exists but is not a regular file or
         symbolic link.

       /etc/sudoers is owned by uid N, should be 0
         The <i>sudoers</i> file has the wrong owner.  If you wish to change
         the <i>sudoers</i> file owner, add “sudoers_uid=N” (where ‘N’ is the
         user-ID that owns the <i>sudoers</i> file) to the <b>sudoers </b><i>Plugin</i> line
         in the <i>sudo.conf</i>(5) file.

       /etc/sudoers is world writable
         The permissions on the <i>sudoers</i> file allow all users to write to
         it.  The <i>sudoers</i> file must not be world-writable, the default
         file mode is 0440 (readable by owner and group, writable by
         none).  The default mode may be changed via the “sudoers_mode”
         option to the <b>sudoers </b><i>Plugin</i> line in the <i>sudo.conf</i>(5) file.

       /etc/sudoers is owned by gid N, should be 1
         The <i>sudoers</i> file has the wrong group ownership.  If you wish to
         change the <i>sudoers</i> file group ownership, add “sudoers_gid=N”
         (where ‘N’ is the group-ID that owns the <i>sudoers</i> file) to the
         <b>sudoers </b><i>Plugin</i> line in the <i>sudo.conf</i>(5) file.

       unable to open /run/sudo/ts/user-ID
         <b>sudoers </b>was unable to read or create the user's time stamp
         file.  This can happen when <i>timestampowner</i> is set to a user
         other than <b>root </b>and the mode on <i>/run/sudo</i> is not searchable by
         group or other.  The default mode for <i>/run/sudo</i> is 0711.

       unable to write to /run/sudo/ts/user-ID
         <b>sudoers </b>was unable to write to the user's time stamp file.

       /run/sudo/ts is owned by uid X, should be Y
         The time stamp directory is owned by a user other than
         <i>timestampowner</i>.  This can occur when the value of
         <i>timestampowner</i> has been changed.  <b>sudoers </b>will ignore the time
         stamp directory until the owner is corrected.

       /run/sudo/ts is group writable
         The time stamp directory is group-writable; it should be
         writable only by <i>timestampowner</i>.  The default mode for the time
         stamp directory is 0700.  <b>sudoers </b>will ignore the time stamp
         directory until the mode is corrected.

   <b>Notes on logging via syslog</b>
       By default, <b>sudoers </b>logs messages via <i>syslog</i>(3).  The <i>date</i>,
       <i>hostname</i>, and <i>progname</i> fields are added by the system's <i>syslog</i>(3)
       function, not <b>sudoers </b>itself.  As such, they may vary in format
       on different systems.

       The maximum size of syslog messages varies from system to system.
       The <i>syslog_maxlen</i> setting can be used to change the maximum
       syslog message size from the default value of 980 bytes.  For
       more information, see the description of <i>syslog_maxlen</i>.

   <b>Notes on logging to a file</b>
       If the <i>logfile</i> option is set, <b>sudoers </b>will log to a local file,
       such as <i>/var/log/sudo</i>.  When logging to a file, <b>sudoers </b>uses a
       format similar to <i>syslog</i>(3), with a few important differences:

       1.   The <i>progname</i> field is not present.

       2.   The <i>hostname</i> is only logged if the <i>log_host</i> option is
            enabled.

       3.   The date does not include the year unless the <i>log_year</i>
            option is enabled.

       4.   Lines that are longer than <i>loglinelen</i> characters (80 by
            default) are word-wrapped and continued on the next line
            with a four character indent.  This makes entries easier to
            read for a human being, but makes it more difficult to use
            <i>grep</i>(1) on the log files.  If the <i>loglinelen</i> option is set
            to 0 (or negated with a ‘!’), word wrap will be disabled.
</pre> <h2>
I/O LOGGING </h2>
<pre>
       When I/O logging is enabled, <b>sudo </b>will runs the command in a
       pseudo-terminal, logging user input and/or output, depending on
       which <b>sudoers </b>flags are enabled.  There are five distinct types
       of I/O that can be logged, each with a corresponding <b>sudoers</b>
       flag.

       <b>Type               Flag          Description</b>
       terminal input     log_ttyin     keystrokes entered by the user
       terminal output    log_ttyout    command output displayed to the
                                                                                  screen
       standard input     log_stdin     input from a pipe or a file
       standard output    log_stdout    output to a pipe or a file
       standard error     log_stderr    output to a pipe or a file

       In addition to flags described the above, the <i>log_input</i> flag and
       LOG_INPUT command tag set both <i>log_ttyin</i> and <i>log_stdin</i>.  The
       <i>log_output</i> flag and LOG_OUTPUT command tag set <i>log_ttyout</i>,
       <i>log_stdout</i>, and <i>log_stderr</i>.

       To capture terminal input and output, <b>sudo </b>run the command in a
       pseudo-terminal, logging the input and output before passing it
       on to the user.  To capture the standard input, standard output
       or standard error, <b>sudo </b>uses a pipe to interpose itself between
       the input or output stream, logging the I/O before passing it to
       the other end of the pipe.

       I/O can be logged either to the local machine or to a remote log
       server.  For local logs, I/O is logged to the directory specified
       by the <i>iolog_dir</i> option (<i>/var/log/sudo-io</i> by default) using a
       unique session ID that is included in the <b>sudo </b>log line, prefixed
       with ‘TSID=’.  The <i>iolog_file</i> option may be used to control the
       format of the session ID.  For remote logs, the <i>log_servers</i>
       setting is used to specify one or more log servers running
       <b>sudo_logsrvd </b>or another server that implements the protocol
       described by <i>sudo_logsrv.proto</i>(5).

   <b>I/O logging pitfals</b>
       When logging standard input, anything sent to the standard input
       will be consumed, regardless of whether or not the command run
       via <b>sudo </b>is actively reading the standard input.  This may have
       unexpected results when using <b>sudo </b>in a shell script that expects
       to process the standard input.  For example, given the following
       shell script:

           #!/bin/sh
           sudo echo testing
           echo done

       It will behave as expected when the script is passed to the shell
       as a an argument:

           $ sh test.sh
           testing
           done

       However, if the script is passed to the shell on the standard
       input, the ‘sudo echo testing’ command will consume the rest of
       the script.  This means that the ‘echo done’ statement is never
       executed.

           $ sh -s &lt; test.sh
           testing

       There are several ways to work around this problem:

       1.   Redirect the standard input from <i>/dev/null</i> when running a
            command via <b>sudo </b>that does not need to read the standard
            input.

                sudo echo testing &lt; /dev/null

       2.   Pass the script to the shell by path name instead of via the
            standard input.

                sh test.sh

       3.   Disable logging the standard input for commands that do not
            need to read the standard input.

                Defaults!/bin/echo !log_stdin

       Depending on the command, it may not be desirable to log the
       standard input or standard output.  For example, I/O logging of
       commands that send or receive large amount of data via the
       standard output or standard input such as <i>rsync</i>(1) and <i>tar</i>(1)
       could fill up the log file system with superfluous data.  It is
       possible to disable logging of the standard input and standard
       output for such commands as follows:

           Cmnd_Alias COPY_CMDS = /usr/bin/tar, /usr/bin/cpio, /usr/bin/rsync

           # Log input and output but omit stdin and stdout when copying files.
           Defaults log_input, log_output
           Defaults!COPY_CMDS !log_stdin, !log_stdout

       However, be aware that using the <i>log_input</i> flag or the LOG_INPUT
       command tag will also enable <i>log_stdin</i>.  Likewise, the <i>log_ouput</i>
       flag or the LOG_OUTPUT command tag will enable <i>log_stdout</i> and
       <i>log_stderr.</i> Careful ordering of rules may be necessary to achieve
       the results that you expect.

   <b>I/O log format</b>
       For both local and remote I/O logs, each log is stored in a
       separate directory that contains the following files:

       <i>log</i>       A text file containing information about the command.
                 The first line consists of the following colon-
                 delimited fields: the time the command was run, the
                 name of the user who ran <b>sudo</b>, the name of the target
                 user, the name of the target group (optional), the
                 terminal that <b>sudo </b>was run from, and the number of
                 lines and columns of the terminal.  The second and
                 third lines contain the working directory the command
                 was run from and the path name of the command itself
                 (with arguments if present).

       <i>log.json</i>  A JSON-formatted file containing information about the
                 command.  This is similar to the <i>log</i> file but contains
                 additional information and is easily extensible.  The
                 <i>log.json</i> file will be used by <i>sudoreplay</i>(8) in
                 preference to the <i>log</i> file if it exists.  The file may
                 contain the following elements:

                 timestamp
                       A JSON object containing time the command was
                       run.  It consists of two values, <i>seconds</i> and
                       <i>nanoseconds</i>.

                 columns
                       The number of columns of the terminal the command
                       ran on, or zero if no terminal was present.

                 command
                       The fully-qualified path of the command that was
                       run.

                 lines
                       The number of lines of the terminal the command
                       ran on, or zero if no terminal was present.

                 runargv
                       A JSON array representing the command's argument
                       vector as passed to the <i>execve</i>(2) system call.

                 runenv
                       A JSON array representing the command's
                       environment as passed to the <i>execve</i>(2) system
                       call.

                 rungid
                       The group ID the command ran as.  This element is
                       only present when the user specifies a group on
                       the command line.

                 rungroup
                       The name of the group the command ran as.  This
                       element is only present when the user specifies a
                       group on the command line.

                 runuid
                       The user ID the command ran as.

                 runuser
                       The name of the user the command ran as.

                 submitcwd
                       The current working directory at the time <b>sudo</b>
                       was run.

                 submithost
                       The name of the host the command was run on.

                 submituser
                       The name of the user who ran the command via
                       <b>sudo</b>.

                 ttyname
                       The path name of the terminal the user invoked
                       <b>sudo </b>from.  If the command was run in a pseudo-
                       terminal, <i>ttyname</i> will be different from the
                       terminal the command actually ran in.

       <i>timing</i>    Timing information used to replay the session.  Each
                 line consists of the I/O log entry type and amount of
                 time since the last entry, followed by type-specific
                 data.  The I/O log entry types and their corresponding
                 type-specific data are:

                 0     standard input, number of bytes in the entry
                 1     standard output, number of bytes in the entry
                 2     standard error, number of bytes in the entry
                 3     terminal input, number of bytes in the entry
                 4     terminal output, number of bytes in the entry
                 5     window change, new number lines and columns
                 6     bug compatibility for <b>sudo </b>1.8.7 terminal output
                 7     command suspend or resume, signal received

       <i>ttyin</i>     Raw input from the user's terminal, exactly as it was
                 received.  This file is only present if the <i>log_input</i>
                 or <i>log_ttyin</i> flags are set and <b>sudo </b>was run from a
                 terminal.  No post-processing is performed.  For manual
                 viewing, you may wish to convert carriage return
                 characters in the log to line feeds.  For example:
                 ‘gunzip -c ttyin | tr "\r" "\n"’

       <i>stdin</i>     The standard input when no terminal is present, or
                 input redirected from a pipe or file.  This file is
                 only present if the <i>log_input</i> or <i>log_stdin</i> flags are
                 set and the standard input is not connected to a
                 terminal.

       <i>ttyout</i>    Output from the pseudo-terminal (what the command
                 writes to the screen).  Terminal-specific post-
                 processing is performed before the data is logged.
                 This means that, for example, line feeds are usually
                 converted to line feed/carriage return pairs and tabs
                 may be expanded to spaces.  This file is only present
                 if the <i>log_output</i> or <i>log_ttyout</i> flags are set and <b>sudo</b>
                 was run from a terminal.

       <i>stdout</i>    The standard output when no terminal is present, or
                 output redirected to a pipe or file.  This file is only
                 present if the <i>log_output</i> or <i>log_stdout</i> flags are set
                 and the standard output is not connected to a terminal.

       <i>stderr</i>    The standard error when no terminal is present, or
                 output redirected to a pipe or file.  This file is only
                 present if the <i>log_output</i> or <i>log_stderr</i> flags are set
                 and the standard error is not connected to a terminal.

       All files other than <i>log</i> are compressed in gzip format unless the
       <i>compress_io</i> flag has been disabled.  Due to buffering, it is not
       normally possible to display the I/O logs in real-time as the
       program is executing.  The I/O log data will not be complete
       until the program run by <b>sudo </b>has exited or has been terminated
       by a signal.  The <i>iolog_flush</i> flag can be used to disable
       buffering, in which case I/O log data is written to disk as soon
       as it is available.  The output portion of an I/O log file can be
       viewed with the <i>sudoreplay</i>(8) utility, which can also be used to
       list or search the available logs.

       User input may contain sensitive information such as passwords
       (even if they are not echoed to the screen), which will be stored
       in the log file unencrypted.  In most cases, logging the command
       output via <i>log_output</i> or LOG_OUTPUT is all that is required.
       When logging input, consider disabling the <i>log_passwords</i> flag.

       Since each session's I/O logs are stored in a separate directory,
       traditional log rotation utilities cannot be used to limit the
       number of I/O logs.  The simplest way to limit the number of I/O
       is by setting the <i>maxseq</i> option to the maximum number of logs you
       wish to store.  Once the I/O log sequence number reaches <i>maxseq</i>,
       it will be reset to zero and <b>sudoers </b>will truncate and reuse any
       existing I/O logs.
</pre> <h2>
FILES </h2>
<pre>
       <i>/etc/sudo.conf</i>            Sudo front-end configuration

       <i>/etc/sudoers</i>              List of who can run what

       <i>/etc/group</i>                Local groups file

       <i>/etc/netgroup</i>             List of network groups

       <i>/var/log/sudo-io</i>          I/O log files

       <i>/run/sudo/ts</i>              Directory containing time stamps for
                                 the <b>sudoers </b>security policy

       <i>/var/db/sudo/lectured</i>     Directory containing lecture status
                                 files for the <b>sudoers </b>security policy

       <i>/etc/environment</i>          Initial environment for <b>-i </b>mode on AIX
                                 and Linux systems
</pre> <h2>
EXAMPLES </h2>
<pre>
       Below are example <i>sudoers</i> file entries.  Admittedly, some of
       these are a bit contrived.  First, we allow a few environment
       variables to pass and then define our <i>aliases</i>:

       # Run X applications through sudo; HOME is used to find the
       # .Xauthority file.  Other programs use HOME to locate configuration
       # files and this may lead to privilege escalation!
       Defaults env_keep += "DISPLAY HOME"

       # User alias specification
       User_Alias      FULLTIMERS = millert, mikef, dowdy
       User_Alias      PARTTIMERS = bostley, jwfox, crawl
       User_Alias      WEBADMIN = will, wendy, wim

       # Runas alias specification
       Runas_Alias     OP = root, operator
       Runas_Alias     DB = oracle, sybase
       Runas_Alias     ADMINGRP = adm, oper

       # Host alias specification
       Host_Alias      SPARC = bigtime, eclipse, moet, anchor :\
                       SGI = grolsch, dandelion, black :\
                       ALPHA = widget, thalamus, foobar :\
                       HPPA = boa, nag, python
       Host_Alias      CUNETS = 128.138.0.0/255.255.0.0
       Host_Alias      CSNETS = 128.138.243.0, 128.138.204.0/24, 128.138.242.0
       Host_Alias      SERVERS = primary, mail, www, ns
       Host_Alias      CDROM = orion, perseus, hercules

       # Cmnd alias specification
       Cmnd_Alias      DUMPS = /usr/bin/mt, /usr/sbin/dump, /usr/sbin/rdump,\
                               /usr/sbin/restore, /usr/sbin/rrestore,\
                               sha224:0GomF8mNN3wlDt1HD9XldjJ3SNgpFdbjO1+NsQ== \
                               /home/operator/bin/start_backups
       Cmnd_Alias      KILL = /usr/bin/kill
       Cmnd_Alias      PRINTING = /usr/sbin/lpc, /usr/bin/lprm
       Cmnd_Alias      SHUTDOWN = /usr/sbin/shutdown
       Cmnd_Alias      HALT = /usr/sbin/halt
       Cmnd_Alias      REBOOT = /usr/sbin/reboot
       Cmnd_Alias      SHELLS = /usr/bin/sh, /usr/bin/csh, /usr/bin/ksh,\
                                /usr/local/bin/tcsh, /usr/bin/rsh,\
                                /usr/local/bin/zsh
       Cmnd_Alias      SU = /usr/bin/su
       Cmnd_Alias      PAGERS = /usr/bin/more, /usr/bin/pg, /usr/bin/less

       Here we override some of the compiled in default values.  We want
       <b>sudo </b>to log via <i>syslog</i>(3) using the <i>auth</i> facility in all cases
       and for commands to be run with the target user's home directory
       as the working directory.  We don't want to subject the full time
       staff to the <b>sudo </b>lecture and we want to allow them to run
       commands in a <i>chroot</i>(2) “sandbox” via the <b>-R </b>option.  User
       <b>millert </b>need not provide a password and we don't want to reset
       the LOGNAME or USER environment variables when running commands
       as <b>root</b>.  Additionally, on the machines in the SERVERS
       <i>Host_Alias</i>, we keep an additional local log file and make sure we
       log the year in each log line since the log entries will be kept
       around for several years.  Lastly, we disable shell escapes for
       the commands in the PAGERS <i>Cmnd_Alias</i> (<i>/usr/bin/more</i>, <i>/usr/bin/pg</i>
       and <i>/usr/bin/less</i>).  This will not effectively constrain users
       with <b>sudo ALL </b>privileges.

       # Override built-in defaults
       Defaults                syslog=auth,runcwd=~
       Defaults&gt;root           !set_logname
       Defaults:FULLTIMERS     !lecture,runchroot=*
       Defaults:millert        !authenticate
       Defaults@SERVERS        log_year, logfile=/var/log/sudo.log
       Defaults!PAGERS         noexec

       The <i>User specification</i> is the part that actually determines who
       may run what.

       root            ALL = (ALL) ALL
       %wheel          ALL = (ALL) ALL

       We let <b>root </b>and any user in group <b>wheel </b>run any command on any
       host as any user.

       FULLTIMERS      ALL = NOPASSWD: ALL

       Full time sysadmins (<b>millert</b>, <b>mikef</b>, and <b>dowdy</b>) may run any
       command on any host without authenticating themselves.

       PARTTIMERS      ALL = ALL

       Part time sysadmins <b>bostley</b>, <b>jwfox</b>, and <b>crawl</b>) may run any
       command on any host but they must authenticate themselves first
       (since the entry lacks the NOPASSWD tag).

       jack            CSNETS = ALL

       The user <b>jack </b>may run any command on the machines in the CSNETS
       alias (the networks 128.138.243.0, 128.138.204.0, and
       128.138.242.0).  Of those networks, only 128.138.204.0 has an
       explicit netmask (in CIDR notation) indicating it is a class C
       network.  For the other networks in CSNETS, the local machine's
       netmask will be used during matching.

       lisa            CUNETS = ALL

       The user <b>lisa </b>may run any command on any host in the CUNETS alias
       (the class B network 128.138.0.0).

       operator        ALL = DUMPS, KILL, SHUTDOWN, HALT, REBOOT, PRINTING,\
                       sudoedit /etc/printcap, /usr/oper/bin/

       The <b>operator </b>user may run commands limited to simple maintenance.
       Here, those are commands related to backups, killing processes,
       the printing system, shutting down the system, and any commands
       in the directory <i>/usr/oper/bin/</i>.  One command in the DUMPS
       Cmnd_Alias includes a sha224 digest,
       <i>/home/operator/bin/start_backups</i>.  This is because the directory
       containing the script is writable by the operator user.  If the
       script is modified (resulting in a digest mismatch) it will no
       longer be possible to run it via <b>sudo</b>.

       joe             ALL = /usr/bin/su operator

       The user <b>joe </b>may only <i>su</i>(1) to operator.

       pete            HPPA = /usr/bin/passwd [A-Za-z]*, !/usr/bin/passwd *root*

       %opers          ALL = (: ADMINGRP) /usr/sbin/

       Users in the <b>opers </b>group may run commands in <i>/usr/sbin/</i> as
       themselves with any group in the ADMINGRP <i>Runas_Alias</i> (the <b>adm</b>
       and <b>oper </b>groups).

       The user <b>pete </b>is allowed to change anyone's password except for
       <b>root </b>on the HPPA machines.  Because command line arguments are
       matched as a single, concatenated string, the ‘*’ wildcard will
       match <i>multiple</i> words.  This example assumes that <i>passwd</i>(1) does
       not take multiple user names on the command line.  On systems
       with GNU <i>getopt</i>(3), options to <i>passwd</i>(1) may be specified after
       the user argument.  As a result, this rule will also allow:

           passwd username --expire

       which may not be desirable.

       bob             SPARC = (OP) ALL : SGI = (OP) ALL

       The user <b>bob </b>may run anything on the SPARC and SGI machines as
       any user listed in the OP <i>Runas_Alias</i> (<b>root </b>and <b>operator</b>.)

       jim             +biglab = ALL

       The user <b>jim </b>may run any command on machines in the <i>biglab</i>
       netgroup.  <b>sudo </b>knows that “biglab” is a netgroup due to the ‘+’
       prefix.

       +secretaries    ALL = PRINTING, /usr/bin/adduser, /usr/bin/rmuser

       Users in the <b>secretaries </b>netgroup need to help manage the
       printers as well as add and remove users, so they are allowed to
       run those commands on all machines.

       fred            ALL = (DB) NOPASSWD: ALL

       The user <b>fred </b>can run commands as any user in the DB <i>Runas_Alias</i>
       (<b>oracle </b>or <b>sybase</b>) without giving a password.

       john            ALPHA = /usr/bin/su [!-]*, !/usr/bin/su *root*

       On the ALPHA machines, user <b>john </b>may su to anyone except <b>root </b>but
       he is not allowed to specify any options to the <i>su</i>(1) command.

       jen             ALL, !SERVERS = ALL

       The user <b>jen </b>may run any command on any machine except for those
       in the SERVERS <i>Host_Alias</i> (primary, mail, www, and ns).

       jill            SERVERS = /usr/bin/, !SU, !SHELLS

       For any machine in the SERVERS <i>Host_Alias</i>, <b>jill </b>may run any
       commands in the directory <i>/usr/bin/</i> except for those commands
       belonging to the SU and SHELLS <i>Cmnd_Aliases</i>.  While not
       specifically mentioned in the rule, the commands in the PAGERS
       <i>Cmnd_Alias</i> all reside in <i>/usr/bin</i> and have the <i>noexec</i> option set.

       steve           CSNETS = (operator) /usr/local/op_commands/

       The user <b>steve </b>may run any command in the directory
       /usr/local/op_commands/ but only as user operator.

       matt            valkyrie = KILL

       On his personal workstation, valkyrie, <b>matt </b>needs to be able to
       kill hung processes.

       WEBADMIN        www = (www) ALL, (root) /usr/bin/su www

       On the host www, any user in the WEBADMIN <i>User_Alias</i> (will,
       wendy, and wim), may run any command as user www (which owns the
       web pages) or simply <i>su</i>(1) to www.

       ALL             CDROM = NOPASSWD: /sbin/umount /CDROM,\
                       /sbin/mount -o nosuid\,nodev /dev/cd0a /CDROM

       Any user may mount or unmount a CD-ROM on the machines in the
       CDROM <i>Host_Alias</i> (orion, perseus, hercules) without entering a
       password.  This is a bit tedious for users to type, so it is a
       prime candidate for encapsulating in a shell script.
</pre> <h2>
SECURITY NOTES </h2>
<pre>
   <b>Limitations of the </b>‘!’ operator
       It is generally not effective to “subtract” commands from <b>ALL</b>
       using the ‘!’ operator.  A user can trivially circumvent this by
       copying the desired command to a different name and then
       executing that.  For example:

       bill    ALL = ALL, !SU, !SHELLS

       Doesn't really prevent <b>bill </b>from running the commands listed in
       SU or SHELLS since he can simply copy those commands to a
       different name, or use a shell escape from an editor or other
       program.  Therefore, these kind of restrictions should be
       considered advisory at best (and reinforced by policy).

       In general, if a user has sudo <b>ALL </b>there is nothing to prevent
       them from creating their own program that gives them a <b>root </b>shell
       (or making their own copy of a shell) regardless of any ‘!’
       elements in the user specification.

   [1mSecurity implications of <i>fast_glob</i>
       If the <i>fast_glob</i> option is in use, it is not possible to reliably
       negate commands where the path name includes globbing (aka
       wildcard) characters.  This is because the C library's <i>fnmatch</i>(3)
       function cannot resolve relative paths.  While this is typically
       only an inconvenience for rules that grant privileges, it can
       result in a security issue for rules that subtract or revoke
       privileges.

       For example, given the following <i>sudoers</i> file entry:

       john    ALL = /usr/bin/passwd [a-zA-Z0-9]*, /usr/bin/chsh [a-zA-Z0-9]*,\
                     /usr/bin/chfn [a-zA-Z0-9]*, !/usr/bin/* root

       User <b>john </b>can still run ‘/usr/bin/passwd root’ if <i>fast_glob</i> is
       enabled by changing to <i>/usr/bin</i> and running ‘./passwd root’
       instead.

       Another potential issue is that when <b>sudo </b>executes the command,
       it must use the command or path specified by the user instead of
       a path listed in the <i>sudoers</i> file.  This may lead to a time of
       check versus time of use race condition.

   <b>Wildcards in command arguments</b>
       Command line arguments are matched as a single, concatenated
       string.  This mean a wildcard character such as ‘?’ or ‘*’ will
       match across word boundaries, which may be unexpected.  For
       example, while a sudoers entry like:

           %operator ALL = /bin/cat /var/log/messages*

       will allow command like:

           $ sudo cat /var/log/messages.1

       It will also allow:

           $ sudo cat /var/log/messages /etc/shadow

       which is probably not what was intended.  A safer alternative is
       to use a regular expression for matching command line arguments.
       The above example can be rewritten as a regular expression:

           %operator ALL = /bin/cat ^/var/log/messages[^[:space:]]*$

       The regular expression will only match a single file with a name
       that begins with <i>/var/log/messages</i> and does not include any white
       space in the name.  It is often better to do command line
       processing outside of the <i>sudoers</i> file in a scripting language
       for anything non-trivial.

   <b>Regular expressions in command names</b>
       Using a regular expression to match a command name has the same
       security implications as using the <i>fast_glob</i> option:

       <b>•  </b>It is not possible to reliably negate commands when the path
          name is a regular expression.

       <b>•  </b>When <b>sudo </b>executes the command, it must use the command or
          path specified by the user instead of a path listed in the
          <i>sudoers</i> file.  This may lead to a time of check versus time of
          use race condition.

       These issues do not apply to rules where only the command line
       options are matched using a regular expression.

   <b>Preventing shell escapes</b>
       Once <b>sudo </b>executes a program, that program is free to do whatever
       it pleases, including run other programs.  This can be a security
       issue since it is not uncommon for a program to allow shell
       escapes, which lets a user bypass <b>sudo</b>'s access control and
       logging.  Common programs that permit shell escapes include
       shells (obviously), editors, paginators, mail, and terminal
       programs.

       There are four basic approaches to this problem:

       restrict   Avoid giving users access to commands that allow the
                  user to run arbitrary commands.  Many editors have a
                  restricted mode where shell escapes are disabled,
                  though <b>sudoedit </b>is a better solution to running
                  editors via <b>sudo</b>.  Due to the large number of programs
                  that offer shell escapes, restricting users to the set
                  of programs that do not is often unworkable.

       intercept  On most systems, <b>sudo</b>'s <i>intercept</i> functionality can be
                  used to transparently intercept an attempt to run a
                  new command, allow or deny it based on <i>sudoers</i> rules,
                  and log the result.  For example, this can be used to
                  restrict the commands run from within a privileged
                  shell or editor.  However, not all programs operate
                  correctly when <i>intercept</i> is enabled.

                  There are two underlying mechanisms that may be used
                  to implement <i>intercept</i> mode: <i>dso</i> and <i>trace</i>.  The
                  <i>intercept_type</i> setting can be used to select between
                  them.

                  The first mechanism, <i>dso</i>, overrides the standard C
                  library functions that are used to execute a command.
                  It does this by setting an environment variable
                  (usually LD_PRELOAD) to the path of a dynamic shared
                  object, or shared library, containing custom versions
                  of the <i>execve</i>(2), <i>execl</i>(3), <i>execle</i>(3), <i>execlp</i>(3),
                  <i>execv</i>(3), <i>execvp</i>(3), <i>execvpe</i>(3), and <i>system</i>(3) library
                  functions that connect back to <b>sudo </b>for a policy
                  decision.  Note, however, that this applies only to
                  dynamically-linked executables.  It is not possible to
                  intercept commands for statically-linked executables
                  or executables that run under binary emulation this
                  way.  Because most dynamic loaders ignore LD_PRELOAD
                  (or the equivalent) when running set-user-ID and set-
                  group-ID programs, <b>sudoers </b>will not permit such
                  programs to be run in <i>intercept</i> mode by default.  The
                  <i>dso</i> mechanism is incompatible with <b>sudo</b>'s SELinux RBAC
                  support (but see below).  SELinux disables LD_PRELOAD
                  by default and interferes with file descriptor
                  inheritance, which <b>sudo </b>relies on.

                  The second mechanism, <i>trace</i>, is available on Linux
                  systems that support <i>seccomp</i>(2) filtering.  It uses
                  <i>ptrace</i>(2) and <i>seccomp</i>(2) to intercept the <i>execve</i>(2)
                  system call instead of pre-loading a dynamic shared
                  object.  Both static and dynamic executables are
                  supported and it is compatible with <b>sudo</b>'s SELinux
                  RBAC mode.  Functions utilizing the <i>execveat</i>(2) system
                  call, such as <i>fexecve</i>(3), are not currently
                  intercepted.  Programs that rely on <i>ptrace</i>(2)
                  themselves, such as debuggers and system call tracers
                  (such as <i>strace</i>(1) and <i>truss</i>(1)) will be unable to
                  function if <i>intercept</i> is enabled in <i>trace</i> mode.  This
                  same restriction applies to the <i>log_subcmds</i> sudoers
                  option.

                  The <i>intercept</i> feature is known to work on Solaris,
                  *BSD, Linux, macOS, HP-UX 11.x and AIX 5.3 and above.
                  It should be supported on most operating systems that
                  support the LD_PRELOAD environment variable or an
                  equivalent.  It is not possible to intercept shell
                  built-in commands or restrict the ability to read or
                  write sensitive files from within a shell.

                  To enable intercept mode on a per-command basis, use
                  the INTERCEPT tag as documented in the User
                  Specification section above.  Here is that example
                  again:

                  chuck   research = INTERCEPT: ALL

                  This allows user <b>chuck </b>to run any command on the
                  machine “research” in intercept mode.  Any commands
                  run via shell escapes will be validated and logged by
                  <b>sudo</b>.  If you are unsure whether or not your system is
                  capable of supporting <i>intercept</i>, you can always just
                  try it out and check whether or not external commands
                  run via a shell are logged when <i>intercept</i> is enabled.

                  There is an inherent race condition between when a
                  command is checked against <b>sudoers </b>rules and when it
                  is actually executed.  If a user is allowed to run
                  arbitrary commands, they may be able to change the
                  <i>execve</i>(2) arguments in the program after the <b>sudoers</b>
                  policy check has completed but before the new command
                  is executed.  Starting with version 1.9.12, the <i>trace</i>
                  method will verify that the command and its arguments
                  have not changed after <i>execve</i>(2) has completed but
                  before execution of the new program has had a chance
                  to run.  This is not the case with the <i>dso</i> method.
                  See the description of the <i>intercept_verify</i> setting
                  for more information.

       log        There are two separate but related ways to log
                  additional commands.  The first is to enable I/O
                  logging using the <i>log_output</i> flag.  This will log the
                  command's output but will not create an event log
                  entry when the additional command is run.  The second
                  is to enable the <i>log_subcmds</i> flag in <i>sudoers</i> which
                  will create an event log entry every time a new
                  command is run.  If I/O logging is also enabled, the
                  log entry will include a time offset into the I/O log
                  to indicate when the command was run.  This offset can
                  be passed to the <i>sudoreplay</i>(8) utility to replay the
                  I/O log at the exact moment when the command was run.
                  The <i>log_subcmds</i> flag uses the same mechanism as
                  <i>intercept</i> (see above) and has the same limitations.

       noexec     <b>sudo</b>'s <i>noexec</i> functionality can be used to prevent a
                  program run by <b>sudo </b>from executing any other programs.
                  On most systems, it uses the same LD_PRELOAD mechanism
                  as <i>intercept</i> (see above) and thus the same caveats
                  apply.  The <i>noexec</i> functionality is capable of
                  blocking execution of commands run via the <i>execve</i>(2),
                  <i>execl</i>(3), <i>execle</i>(3), <i>execlp</i>(3), <i>exect</i>(3), <i>execv</i>(3),
                  <i>execveat</i>(3), <i>execvP</i>(3), <i>execvp</i>(3), <i>execvpe</i>(3),
                  <i>fexecve</i>(3), <i>popen</i>(3), <i>posix_spawn</i>(3), <i>posix_spawnp</i>(3),
                  <i>system</i>(3), and <i>wordexp</i>(3) functions.  On Linux, a
                  <i>seccomp</i>(2) filter is used to implement <i>noexec</i>.  On
                  Solaris 10 and higher, <i>noexec</i> uses Solaris privileges
                  instead of the LD_PRELOAD environment variable.

                  To enable <i>noexec</i> for a command, use the NOEXEC tag as
                  documented in the User Specification section above.
                  Here is that example again:

                  aaron   shanty = NOEXEC: /usr/bin/more, /usr/bin/vi

                  This allows user <b>aaron </b>to run <i>/usr/bin/more</i> and
                  <i>/usr/bin/vi</i> with <i>noexec</i> enabled.  This will prevent
                  those two commands from executing other commands (such
                  as a shell).  If you are unsure whether or not your
                  system is capable of supporting <i>noexec</i> you can always
                  just try it out and check whether shell escapes work
                  when <i>noexec</i> is enabled.

       Restricting shell escapes is not a panacea.  Programs running as
       <b>root </b>are still capable of many potentially hazardous operations
       (such as changing or overwriting files) that could lead to
       unintended privilege escalation.  In the specific case of an
       editor, a safer approach is to give the user permission to run
       <b>sudoedit </b>(see below).

   <b>Secure editing</b>
       The <b>sudoers </b>plugin includes <b>sudoedit </b>support which allows users
       to securely edit files with the editor of their choice.  As
       <b>sudoedit </b>is a built-in command, it must be specified in the
       <i>sudoers</i> file without a leading path.  However, it may take
       command line arguments just as a normal command does.  Wildcards
       used in <i>sudoedit</i> command line arguments are expected to be path
       names, so a forward slash (‘/’) will not be matched by a
       wildcard.

       Unlike other <b>sudo </b>commands, the editor is run with the
       permissions of the invoking user and with the environment
       unmodified.  More information may be found in the description of
       the <b>-e </b>option in <i>sudo</i>(8).

       For example, to allow user operator to edit the “message of the
       day” file on any machine:

           operator ALL = sudoedit /etc/motd

       The operator user then runs <b>sudoedit </b>as follows:

           $ sudoedit /etc/motd

       The editor will run as the operator user, not <b>root</b>, on a
       temporary copy of <i>/etc/motd</i>.  After the file has been edited,
       <i>/etc/motd</i> will be updated with the contents of the temporary
       copy.

       Users should <i>never</i> be granted <b>sudoedit </b>permission to edit a file
       that resides in a directory the user has write access to, either
       directly or via a wildcard.  If the user has write access to the
       directory it is possible to replace the legitimate file with a
       link to another file, allowing the editing of arbitrary files.
       To prevent this, starting with version 1.8.16, symbolic links
       will not be followed in writable directories and <b>sudoedit </b>will
       refuse to edit a file located in a writable directory unless the
       <i>sudoedit_checkdir</i> option has been disabled or the invoking user
       is <b>root</b>.  Additionally, in version 1.8.15 and higher, <b>sudoedit</b>
       will refuse to open a symbolic link unless either the
       <i>sudoedit_follow</i> option is enabled or the <i>sudoedit</i> command is
       prefixed with the FOLLOW tag in the <i>sudoers</i> file.

   <b>Time stamp file checks</b>
       <b>sudoers </b>will check the ownership of its time stamp directory
       (<i>/run/sudo/ts</i> by default) and ignore the directory's contents if
       it is not owned by <b>root </b>or if it is writable by a user other than
       <b>root</b>.  Older versions of <b>sudo </b>stored time stamp files in <i>/tmp</i>;
       this is no longer recommended as it may be possible for a user to
       create the time stamp themselves on systems that allow
       unprivileged users to change the ownership of files they create.

       While the time stamp directory <i>should</i> be cleared at reboot time,
       not all systems contain a <i>/run</i> or <i>/var/run</i> directory.  To avoid
       potential problems, <b>sudoers </b>will ignore time stamp files that
       date from before the machine booted on systems where the boot
       time is available.

       Some systems with graphical desktop environments allow
       unprivileged users to change the system clock.  Since <b>sudoers</b>
       relies on the system clock for time stamp validation, it may be
       possible on such systems for a user to run <b>sudo </b>for longer than
       <i>timestamp_timeout</i> by setting the clock back.  To combat this,
       <b>sudoers </b>uses a monotonic clock (which never moves backwards) for
       its time stamps if the system supports it.

       <b>sudoers </b>will not honor time stamps set far in the future.  Time
       stamps with a date greater than current_time + 2 * TIMEOUT will
       be ignored and <b>sudoers </b>will log and complain.

       If the <i>timestamp_type</i> option is set to “tty”, the time stamp
       record includes the device number of the terminal the user
       authenticated with.  This provides per-terminal granularity but
       time stamp records may still outlive the user's session.

       Unless the <i>timestamp_type</i> option is set to “global”, the time
       stamp record also includes the session ID of the process that
       last authenticated.  This prevents processes in different
       terminal sessions from using the same time stamp record.  On
       systems where a process's start time can be queried, the start
       time of the session leader is recorded in the time stamp record.
       If no terminal is present or the <i>timestamp_type</i> option is set to
       “ppid”, the start time of the parent process is used instead.  In
       most cases this will prevent a time stamp record from being
       reused without the user entering a password when logging out and
       back in again.
</pre> <h2>
DEBUGGING </h2>
<pre>
       Versions 1.8.4 and higher of the <b>sudoers </b>plugin support a
       flexible debugging framework that can help track down what the
       plugin is doing internally if there is a problem.  This can be
       configured in the <i>sudo.conf</i>(5) file.

       The <b>sudoers </b>plugin uses the same debug flag format as the <b>sudo</b>
       front-end: <i>subsystem</i>@<i>priority</i>.

       The priorities used by <b>sudoers</b>, in order of decreasing severity,
       are: <i>crit</i>, <i>err</i>, <i>warn</i>, <i>notice</i>, <i>diag</i>, <i>info</i>, <i>trace</i>, and <i>debug</i>.  Each
       priority, when specified, also includes all priorities higher
       than it.  For example, a priority of <i>notice</i> would include debug
       messages logged at <i>notice</i> and higher.

       The following subsystems are used by the <b>sudoers </b>plugin:

       <i>alias</i>     <i>User_Alias</i>, <i>Runas_Alias</i>, <i>Host_Alias</i> and <i>Cmnd_Alias</i>
                 processing

       <i>all</i>       matches every subsystem

       <i>audit</i>     BSM and Linux audit code

       <i>auth</i>      user authentication

       <i>defaults</i>  <i>sudoers</i> file <i>Defaults</i> settings

       <i>env</i>       environment handling

       <i>ldap</i>      LDAP-based sudoers

       <i>logging</i>   logging support

       <i>match</i>     matching of users, groups, hosts, and netgroups in the
                 <i>sudoers</i> file

       <i>netif</i>     network interface handling

       <i>nss</i>       network service switch handling in <b>sudoers</b>

       <i>parser</i>    <i>sudoers</i> file parsing

       <i>perms</i>     permission setting

       <i>plugin</i>    The equivalent of <i>main</i> for the plugin.

       <i>pty</i>       pseudo-terminal related code

       <i>rbtree</i>    redblack tree internals

       <i>sssd</i>      SSSD-based sudoers

       <i>util</i>      utility functions

       For example:

       Debug sudoers.so /var/log/sudoers_debug match@info,nss@info

       For more information, see the <i>sudo.conf</i>(5) manual.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <i>ssh</i>(1), <i>su</i>(1), <i>fnmatch</i>(3), <i>glob</i>(3), <i>mktemp</i>(3), <i>strftime</i>(3),
       <i>sudo.conf</i>(5), <i>sudo_plugin</i>(5), <i>sudoers.ldap</i>(5),
       <i>sudoers_timestamp</i>(5), <i>sudo</i>(8), <i>visudo</i>(8)
</pre> <h2>
AUTHORS </h2>
<pre>
       Many people have worked on <b>sudo </b>over the years; this version
       consists of code written primarily by:

             Todd C. Miller

       See the CONTRIBUTORS.md file in the <b>sudo </b>distribution
       (<a href="https://www.sudo.ws/about/contributors/">https://www.sudo.ws/about/contributors/</a>) for an exhaustive list
       of people who have contributed to <b>sudo</b>.
</pre> <h2>
CAVEATS </h2>
<pre>
       The <i>sudoers</i> file should <b>always </b>be edited by the <b>visudo </b>utility
       which locks the file and checks for syntax errors.  If <i>sudoers</i>
       contains syntax errors, <b>sudo </b>may refuse to run, which is a
       serious problem if <b>sudo </b>is your only method of obtaining
       superuser privileges.  Recent versions of <b>sudoers </b>will attempt to
       recover after a syntax error by ignoring the rest of the line
       after encountering an error.  Older versions of <b>sudo </b>will not run
       if <i>sudoers</i> contains a syntax error.

       When using netgroups of machines (as opposed to users), if you
       store fully qualified host name in the netgroup (as is usually
       the case), you either need to have the machine's host name be
       fully qualified as returned by the <i>hostname</i> command or use the
       <i>fqdn</i> option in <i>sudoers</i>.
</pre> <h2>
BUGS </h2>
<pre>
       If you believe you have found a bug in <b>sudoers</b>, you can either
       file a bug report in the sudo bug database,
       <a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>, or open an issue at
       <a href="https://github.com/sudo-project/sudo/issues">https://github.com/sudo-project/sudo/issues</a>.  If you would prefer
       to use email, messages may be sent to the sudo-workers mailing
       list, <a href="https://www.sudo.ws/mailman/listinfo/sudo-workers">https://www.sudo.ws/mailman/listinfo/sudo-workers</a> (public)
       or &lt;sudo@sudo.ws&gt; (private).

       Please not report security vulnerabilities through public GitHub
       issues, Bugzilla or mailing lists.  Instead, report them via
       email to &lt;Todd.Miller@sudo.ws&gt;.  You may encrypt your message
       with PGP if you would like, using the key found at
       <a href="https://www.sudo.ws/dist/PGPKEYS">https://www.sudo.ws/dist/PGPKEYS</a>.
</pre> <h2>
SUPPORT </h2>
<pre>
       Limited free support is available via the sudo-users mailing
       list, see <a href="https://www.sudo.ws/mailman/listinfo/sudo-users">https://www.sudo.ws/mailman/listinfo/sudo-users</a> to
       subscribe or search the archives.
</pre> <h2>
DISCLAIMER </h2>
<pre>
       <b>sudo </b>is provided “AS IS” and any express or implied warranties,
       including, but not limited to, the implied warranties of
       merchantability and fitness for a particular purpose are
       disclaimed.  See the LICENSE.md file distributed with <b>sudo </b>or
       <a href="https://www.sudo.ws/about/license/">https://www.sudo.ws/about/license/</a> for complete details.
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>sudo</i> (execute a command as another user)
       project.  Information about the project can be found at
       <a href="https://www.sudo.ws/">https://www.sudo.ws/</a>.  If you have a bug report for this manual
       page, see ⟨<a href="https://bugzilla.sudo.ws/">https://bugzilla.sudo.ws/</a>⟩.  This page was obtained
       from the project's upstream Git repository
       ⟨<a href="https://github.com/sudo-project/sudo">https://github.com/sudo-project/sudo</a>⟩ on 2024-06-14.  (At that
       time, the date of the most recent commit that was found in the
       repository was 2024-06-08.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Sudo 1.9.16                  April 17, 2024                   <i>SUDOERS</i>(5)</span>
</pre>  <p>Pages that refer to this page: <a href="proc.5.html">proc(5)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man5/sudoers.5.html" class="_attribution-link">https://man7.org/linux/man-pages/man5/sudoers.5.html</a>
  </p>
</div>
