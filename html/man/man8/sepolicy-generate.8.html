<h1>sepolicy-generate(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>sepolicy-generate</i>(8)                                <i>sepolicy-generate</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       sepolicy-generate - Generate an initial SELinux policy module
       template.
</pre> <h2>
SYNOPSIS </h2>
<pre>
       Common options

       <b>sepolicy generate [-h ] [-p PATH]</b>

       Confined Applications

       <b>sepolicy generate --application [-n NAME] [-u USER ]command [-w</b>
       <b>WRITE_PATH ]</b>
       <b>sepolicy generate --cgi [-n NAME] command [-w WRITE_PATH ]</b>
       <b>sepolicy generate --dbus [-n NAME] command [-w WRITE_PATH ]</b>
       <b>sepolicy generate --inetd [-n NAME] command [-w WRITE_PATH ]</b>
       <b>sepolicy generate --init [-n NAME] command [-w WRITE_PATH ]</b>

       Confined Users

       <b>sepolicy generate --admin_user [-r TRANSITION_ROLE] -n NAME</b>
       <b>sepolicy generate --confined_admin -n NAME [-a ADMIN_DOMAIN] [-u</b>
       <b>USER] [-n NAME] [-w WRITE_PATH]</b>
       <b>sepolicy generate --desktop_user -n NAME [-w WRITE_PATH]</b>
       <b>sepolicy generate --term_user -n NAME [-w WRITE_PATH]</b>
       <b>sepolicy generate --x_user -n NAME [-w WRITE_PATH]</b>

       Miscellaneous Policy

       <b>sepolicy generate --customize -d DOMAIN -n NAME [-a ADMIN_DOMAIN]</b>
       <b>sepolicy generate --newtype -t type -n NAME</b>
       <b>sepolicy generate --sandbox -n NAME</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       Use <b>sepolicy generate </b>to generate an SELinux policy Module.

       <b>sepolicy generate </b>will create 5 files.

       When specifying a <b>confined application </b>you must specify a path.
       <b>sepolicy generate </b>will use the rpm payload of the application
       along with <b>nm -D APPLICATION </b>to help it generate types and policy
       rules for your policy files.

       <b>Type Enforcing File NAME.te</b>
       This file can be used to define all the types rules for a
       particular domain.

       <i>Note:</i> Policy generated by <b>sepolicy generate </b>will automatically
       add a permissive DOMAIN to your te file.  When you are satisfied
       that your policy works, you need to remove the permissive line
       from the te file to run your domain in enforcing mode.

       <b>Interface File NAME.if</b>
       This file defines the interfaces for the types generated in the
       te file, which can be used by other policy domains.

       <b>File Context NAME.fc</b>
       This file defines the default file context for the system, it
       takes the file types created in the te file and associates file
       paths to the types.  Tools like restorecon and RPM will use these
       paths to put down labels.

       <b>RPM Spec File NAME_selinux.spec</b>
       This file is an RPM SPEC file that can be used to install the
       SELinux policy on to machines and setup the labeling. The spec
       file also installs the interface file and a man page describing
       the policy.  You can use <b>sepolicy manpage -d NAME </b>to generate the
       man page.

       <b>Shell File NAME.sh</b>
       This is a helper shell script to compile, install and fix the
       labeling on your test system.  It will also generate a man page
       based on the installed policy, and compile and build an RPM
       suitable to be installed on other machines

       If a generate is possible, this tool will print out all generate
       paths from the source domain to the target domain
</pre> <h2>
OPTIONS </h2>
<pre>
       <i>-h, --help</i>
              Display help message

       <i>-d, --domain</i>
              Enter domain type(s) which you will be extending

       <i>-n, --name</i>
              Specify alternate name of policy. The policy will default
              to the executable or name specified

       <i>-p, --path</i>
              Specify the directory to store the created policy files.
              (Default to current working directory ) optional
              arguments:

       <i>-r, --role</i>
              Enter role(s) to which this admin user will transition.

       <i>-t, --type</i>
              Enter type(s) for which you will generate new definition
              and rule(s)

       <i>-u, --user</i>
              SELinux user(s) which will transition to this domain

       <i>-w, --writepath</i>
              Path(s) which the confined processes need to write

       <i>-a, --admin</i>
              Domain(s) which the confined admin will administrate

       <i>--admin_user</i>
              Generate Policy for Administrator Login User Role

       <i>--application</i>
              Generate Policy for User Application

       <i>--cgi</i>  Generate Policy for Web Application/Script (CGI)

       <i>--confined_admin</i>
              Generate Policy for Confined Root Administrator Role

       <i>--customize</i>
              Generate Policy for Existing Domain Type

       <i>--dbus</i> Generate Policy for DBUS System Daemon

       <i>--desktop_user</i>
              Generate Policy for Desktop Login User Role

       <i>--inetd</i>
              Generate Policy for Internet Services Daemon

       <i>--init</i> Generate Policy for Standard Init Daemon (Default)

       <i>--newtype</i>
              Generate new policy for new types to add to an existing
              policy.

       <i>--sandbox</i>
              Generate Policy for Sandbox

       <i>--term_user</i>
              Generate Policy for Minimal Terminal Login User Role

       <i>--x_user</i>
              Generate Policy for Minimal X Windows Login User Role
</pre> <h2>
EXAMPLE </h2>
<pre>
       <b>&gt; sepolicy generate --init /usr/sbin/rwhod</b>
       Generating Policy for /usr/sbin/rwhod named rwhod
       Created the following files:
       rwhod.te # Type Enforcement file
       rwhod.if # Interface file
       rwhod.fc # File Contexts file
       rwhod_selinux.spec # Spec file
       rwhod.sh # Setup Script
</pre> <h2>
AUTHOR </h2>
<pre>
       This man page was written by Daniel Walsh &lt;dwalsh@redhat.com&gt;
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="sepolicy.8.html">sepolicy(8)</a>, <a href="selinux.8.html">selinux(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                                20121005            <i>sepolicy-generate</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="selinux-polgengui.8.html">selinux-polgengui(8)</a>, <a href="sepolicy.8.html">sepolicy(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/sepolicy-generate.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/sepolicy-generate.8.html</a>
  </p>
</div>
