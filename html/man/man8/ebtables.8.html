<h1>ebtables-nft(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>EBTABLES</i>(8)              System Manager's Manual             <i>EBTABLES</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       ebtables — Ethernet bridge frame table administration (nft-based)
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>ebtables </b>[<b>-t </b>table ] <b>-</b>[<b>ACDI</b>] chain rule specification [match
       extensions] [watcher extensions] target
       <b>ebtables </b>[<b>-t </b>table ] <b>-P </b>chain <b>ACCEPT </b>| <b>DROP </b>| <b>RETURN</b>
       <b>ebtables </b>[<b>-t </b>table ] <b>-F </b>[chain]
       <b>ebtables </b>[<b>-t </b>table ] <b>-Z </b>[chain]
       <b>ebtables </b>[<b>-t </b>table ] <b>-L </b>[<b>-Z</b>] [chain] [ [<b>--Ln</b>] | [<b>--Lx</b>] ] [<b>--Lc</b>]
       [<b>--Lmac2</b>]
       <b>ebtables </b>[<b>-t </b>table ] <b>-N </b>chain [<b>-P ACCEPT </b>| <b>DROP </b>| <b>RETURN</b>]
       <b>ebtables </b>[<b>-t </b>table ] <b>-X </b>[chain]
       <b>ebtables </b>[<b>-t </b>table ] <b>-E </b>old-chain-name new-chain-name
       <b>ebtables </b>[<b>-t </b>table ] <b>--init-table</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>ebtables </b>is an application program used to set up and maintain
       the tables of rules (inside the Linux kernel) that inspect
       Ethernet frames.  It is analogous to the <b>iptables </b>application,
       but less complicated, due to the fact that the Ethernet protocol
       is much simpler than the IP protocol.

   <b>CHAINS</b>
       There are three ebtables tables with built-in chains in the Linux
       kernel. These tables are used to divide functionality into
       different sets of rules. Each set of rules is called a chain.
       Each chain is an ordered list of rules that can match Ethernet
       frames. If a rule matches an Ethernet frame, then a processing
       specification tells what to do with that matching frame. The
       processing specification is called a 'target'. However, if the
       frame does not match the current rule in the chain, then the next
       rule in the chain is examined and so forth.  The user can create
       new (user-defined) chains that can be used as the 'target' of a
       rule. User-defined chains are very useful to get better
       performance over the linear traversal of the rules and are also
       essential for structuring the filtering rules into well-organized
       and maintainable sets of rules.

   <b>TARGETS</b>
       A firewall rule specifies criteria for an Ethernet frame and a
       frame processing specification called a target.  When a frame
       matches a rule, then the next action performed by the kernel is
       specified by the target.  The target can be one of these values:
       <b>ACCEPT</b>, <b>DROP</b>, <b>CONTINUE</b>, <b>RETURN</b>, an 'extension' (see below) or a
       jump to a user-defined chain.

       <b>ACCEPT </b>means to let the frame through.  <b>DROP </b>means the frame has
       to be dropped. In the <b>BROUTING </b>chain however, the <b>ACCEPT </b>and <b>DROP</b>
       target have different meanings (see the info provided for the <b>-t</b>
       option).  <b>CONTINUE </b>means the next rule has to be checked. This
       can be handy, f.e., to know how many frames pass a certain point
       in the chain, to log those frames or to apply multiple targets on
       a frame.  <b>RETURN </b>means stop traversing this chain and resume at
       the next rule in the previous (calling) chain.  For the extension
       targets please refer to the <b>TARGET EXTENSIONS </b>section of this man
       page.

   <b>TABLES</b>
       As stated earlier, the table names are <b>filter</b>, <b>nat </b>and <b>broute</b>.
       Of these tables, the filter table is the default table that the
       command operates on.  If you are working with a table other than
       filter, you will need to provide the -t argument.  Moreover, the
       -t argument must be the first argument on the ebtables command
       line, if used.

       <b>-t, --table</b>
              <b>filter </b>is the default table and contains three built-in
              chains: <b>INPUT </b>(for frames destined for the bridge itself,
              on the level of the MAC destination address), <b>OUTPUT </b>(for
              locally-generated or (b)routed frames) and <b>FORWARD </b>(for
              frames being forwarded by the bridge).
              <b>nat </b>is mostly used to change the mac addresses and
              contains three built-in chains: <b>PREROUTING </b>(for altering
              frames as soon as they come in), <b>OUTPUT </b>(for altering
              locally generated or (b)routed frames before they are
              bridged) and <b>POSTROUTING </b>(for altering frames as they are
              about to go out). A small note on the naming of chains
              PREROUTING and POSTROUTING: it would be more accurate to
              call them PREFORWARDING and POSTFORWARDING, but for all
              those who come from the iptables world to ebtables it is
              easier to have the same names. Note that you can change
              the name (<b>-E</b>) if you don't like the default.
              <b>broute </b>is used to make a brouter, it has one built-in
              chain: <b>BROUTING</b>.  The targets <b>DROP </b>and <b>ACCEPT </b>have a
              special meaning in the broute table (these names are used
              for compatibility reasons with ebtables-legacy).  <b>DROP</b>
              actually means the frame has to be routed, while <b>ACCEPT</b>
              means the frame has to be bridged. The <b>BROUTING </b>chain is
              traversed very early.  Normally those frames would be
              bridged, but you can decide otherwise here.
</pre> <h2>
EBTABLES COMMAND LINE ARGUMENTS </h2>
<pre>
       After the initial ebtables '-t table' command line argument, the
       remaining arguments can be divided into several groups.  These
       groups are commands, miscellaneous commands, rule specifications,
       match extensions, watcher extensions and target extensions.

   <b>COMMANDS</b>
       The ebtables command arguments specify the actions to perform on
       the table defined with the -t argument.  If you do not use the -t
       argument to name a table, the commands apply to the default
       filter table.  Only one command may be used on the command line
       at a time, except when the commands <b>-L </b>and <b>-Z </b>are combined or the
       commands <b>-N </b>and <b>-P </b>are combined.

       <b>-A, --append</b>
              Append a rule to the end of the selected chain.

       <b>-D, --delete</b>
              Delete the specified rule or rules from the selected
              chain. There are two ways to use this command. The first
              is by specifying an interval of rule numbers to delete
              (directly after <b>-D</b>).  Syntax: <i>start_nr</i>[<i>:end_nr</i>] (use <b>-L</b>
              <b>--Ln </b>to list the rules with their rule number). When
              <i>end_nr</i> is omitted, all rules starting from <i>start_nr</i> are
              deleted. Using negative numbers is allowed, for more
              details about using negative numbers, see the <b>-I </b>command.
              The second usage is by specifying the complete rule as it
              would have been specified when it was added. Only the
              first encountered rule that is the same as this specified
              rule, in other words the matching rule with the lowest
              (positive) rule number, is deleted.

       <b>-C, --change-counters</b>
              Change the counters of the specified rule or rules from
              the selected chain. There are two ways to use this
              command. The first is by specifying an interval of rule
              numbers to do the changes on (directly after <b>-C</b>).  Syntax:
              <i>start_nr</i>[<i>:end_nr</i>] (use <b>-L --Ln </b>to list the rules with
              their rule number). The details are the same as for the <b>-D</b>
              command. The second usage is by specifying the complete
              rule as it would have been specified when it was added.
              Only the counters of the first encountered rule that is
              the same as this specified rule, in other words the
              matching rule with the lowest (positive) rule number, are
              changed.  In the first usage, the counters are specified
              directly after the interval specification, in the second
              usage directly after <b>-C</b>.  First the packet counter is
              specified, then the byte counter. If the specified
              counters start with a '+', the counter values are added to
              the respective current counter values.  If the specified
              counters start with a '-', the counter values are
              decreased from the respective current counter values. No
              bounds checking is done. If the counters don't start with
              '+' or '-', the current counters are changed to the
              specified counters.

       <b>-I, --insert</b>
              Insert the specified rule into the selected chain at the
              specified rule number. If the rule number is not
              specified, the rule is added at the head of the chain.  If
              the current number of rules equals <i>N</i>, then the specified
              number can be between <i>-N</i> and <i>N+1</i>.  For a positive number
              <i>i</i>, it holds that <i>i</i> and <i>i-N-1</i> specify the same place in the
              chain where the rule should be inserted. The rule number 0
              specifies the place past the last rule in the chain and
              using this number is therefore equivalent to using the <b>-A</b>
              command.  Rule numbers structly smaller than 0 can be
              useful when more than one rule needs to be inserted in a
              chain.

       <b>-P, --policy</b>
              Set the policy for the chain to the given target. The
              policy can be <b>ACCEPT</b>, <b>DROP </b>or <b>RETURN</b>.

       <b>-F, --flush</b>
              Flush the selected chain. If no chain is selected, then
              every chain will be flushed. Flushing a chain does not
              change the policy of the chain, however.

       <b>-Z, --zero</b>
              Set the counters of the selected chain to zero. If no
              chain is selected, all the counters are set to zero. The
              <b>-Z </b>command can be used in conjunction with the <b>-L </b>command.
              When both the <b>-Z </b>and <b>-L </b>commands are used together in this
              way, the rule counters are printed on the screen before
              they are set to zero.

       <b>-L, --list</b>
              List all rules in the selected chain. If no chain is
              selected, all chains are listed.
              The following options change the output of the <b>-L </b>command.
              <b>--Ln</b>
              Places the rule number in front of every rule. This option
              is incompatible with the <b>--Lx </b>option.
              <b>--Lc</b>
              Shows the counters at the end of each rule displayed by
              the <b>-L </b>command. Both a frame counter (pcnt) and a byte
              counter (bcnt) are displayed.  The frame counter shows how
              many frames have matched the specific rule, the byte
              counter shows the sum of the frame sizes of these matching
              frames. Using this option in combination with the <b>--Lx</b>
              option causes the counters to be written out in the '<b>-c</b>
              &lt;pcnt&gt; &lt;bcnt&gt;' option format.
              <b>--Lx</b>
              Changes the output so that it produces a set of ebtables
              commands that construct the contents of the chain, when
              specified.  If no chain is specified, ebtables commands to
              construct the contents of the table are given, including
              commands for creating the user-defined chains (if any).
              You can use this set of commands in an ebtables boot or
              reload script.  For example the output could be used at
              system startup.  The <b>--Lx </b>option is incompatible with the
              <b>--Ln </b>listing option. Using the <b>--Lx </b>option together with
              the <b>--Lc </b>option will cause the counters to be written out
              in the '<b>-c </b>&lt;pcnt&gt; &lt;bcnt&gt;' option format.
              <b>--Lmac2</b>
              Shows all MAC addresses with the same length, adding
              leading zeroes if necessary. The default representation
              omits leading zeroes in the addresses.

       <b>-N, --new-chain</b>
              Create a new user-defined chain with the given name. The
              number of user-defined chains is limited only by the
              number of possible chain names.  A user-defined chain name
              has a maximum length of 31 characters. The standard policy
              of the user-defined chain is ACCEPT. The policy of the new
              chain can be initialized to a different standard target by
              using the <b>-P </b>command together with the <b>-N </b>command. In this
              case, the chain name does not have to be specified for the
              <b>-P </b>command.

       <b>-X, --delete-chain</b>
              Delete the specified user-defined chain. There must be no
              remaining references (jumps) to the specified chain,
              otherwise ebtables will refuse to delete it. If no chain
              is specified, all user-defined chains that aren't
              referenced will be removed.

       <b>-E, --rename-chain</b>
              Rename the specified chain to a new name.  Besides
              renaming a user-defined chain, you can rename a standard
              chain to a name that suits your taste. For example, if you
              like PREFORWARDING more than PREROUTING, then you can use
              the -E command to rename the PREROUTING chain. If you do
              rename one of the standard ebtables chain names, please be
              sure to mention this fact should you post a question on
              the ebtables mailing lists.  It would be wise to use the
              standard name in your post. Renaming a standard ebtables
              chain in this fashion has no effect on the structure or
              functioning of the ebtables kernel table.

       <b>--init-table</b>
              Replace the current table data by the initial table data.

   <b>MISCELLANEOUS COMMANDS</b>
       <b>-v, --verbose</b>
              Verbose mode.  For appending, insertion, deletion and
              replacement, this causes detailed information on the rule
              or rules to be printed. <b>-v </b>may be specified multiple times
              to possibly emit more detailed debug statements.

       <b>-V, --version</b>
              Show the version of the ebtables userspace program.

       <b>-h, --help </b>[<i>list of module names</i>]
              Give a brief description of the command syntax. Here you
              can also specify names of extensions and ebtables will try
              to write help about those extensions. E.g.  <i>ebtables -h</i>
              <i>snat log ip arp</i>.  Specify <i>list_extensions</i> to list all
              extensions supported by the userspace utility.

       <b>-j, --jump </b><i>target</i>
              The target of the rule. This is one of the following
              values: <b>ACCEPT</b>, <b>DROP</b>, <b>CONTINUE</b>, <b>RETURN</b>, a target extension
              (see <b>TARGET EXTENSIONS</b>) or a user-defined chain name.

       <b>-M, --modprobe </b><i>program</i>
              When talking to the kernel, use this <i>program</i> to try to
              automatically load missing kernel modules.

       <b>--concurrent</b>
              Use a file lock to support concurrent scripts updating the
              ebtables kernel tables.

   <b>RULE SPECIFICATIONS</b>
       The following command line arguments make up a rule specification
       (as used in the add and delete commands). A "!" option before the
       specification inverts the test for that specification. Apart from
       these standard rule specifications there are some other command
       line arguments of interest.  See both the <b>MATCH EXTENSIONS </b>and
       the <b>WATCHER EXTENSIONS </b>below.

       [<b>!</b>] <b>-p</b>, <b>--protocol </b><i>protocol</i>
              The protocol that was responsible for creating the frame.
              This can be a hexadecimal number, above <i>0x0600</i>, a name
              (e.g.  <i>ARP</i> ) or <b>LENGTH</b>.  The protocol field of the
              Ethernet frame can be used to denote the length of the
              header (802.2/802.3 networks). When the value of that
              field is below or equals <i>0x0600</i>, the value equals the size
              of the header and shouldn't be used as a protocol number.
              Instead, all frames where the protocol field is used as
              the length field are assumed to be of the same 'protocol'.
              The protocol name used in ebtables for these frames is
              <b>LENGTH</b>.
              The file <b>/etc/ethertypes </b>can be used to show readable
              characters instead of hexadecimal numbers for the
              protocols. For example, <i>0x0800</i> will be represented by
              <i>IPV4</i>.  The use of this file is not case sensitive.  See
              that file for more information. The flag <b>--proto </b>is an
              alias for this option.

       [<b>!</b>] <b>-i</b>, <b>--in-interface </b><i>name</i>
              The interface (bridge port) via which a frame is received
              (this option is useful in the <b>INPUT</b>, <b>FORWARD</b>, <b>PREROUTING</b>
              and <b>BROUTING </b>chains). If the interface name ends with '+',
              then any interface name that begins with this name
              (disregarding '+') will match.  The flag <b>--in-if </b>is an
              alias for this option.

       [<b>!</b>] <b>--logical-in </b><i>name</i>
              The (logical) bridge interface via which a frame is
              received (this option is useful in the <b>INPUT</b>, <b>FORWARD</b>,
              <b>PREROUTING </b>and <b>BROUTING </b>chains).  If the interface name
              ends with '+', then any interface name that begins with
              this name (disregarding '+') will match.

       [<b>!</b>] <b>-o</b>, <b>--out-interface </b><i>name</i>
              The interface (bridge port) via which a frame is going to
              be sent (this option is useful in the <b>OUTPUT</b>, <b>FORWARD </b>and
              <b>POSTROUTING </b>chains). If the interface name ends with '+',
              then any interface name that begins with this name
              (disregarding '+') will match.  The flag <b>--out-if </b>is an
              alias for this option.

       [<b>!</b>] <b>--logical-out </b><i>name</i>
              The (logical) bridge interface via which a frame is going
              to be sent (this option is useful in the <b>OUTPUT</b>, <b>FORWARD</b>
              and <b>POSTROUTING </b>chains).  If the interface name ends with
              '+', then any interface name that begins with this name
              (disregarding '+') will match.

       [<b>!</b>] <b>-s</b>, <b>--source </b><i>address</i>[<b>/</b><i>mask</i>]
              The source MAC address. Both mask and address are written
              as 6 hexadecimal numbers separated by colons.
              Alternatively one can specify Unicast, Multicast,
              Broadcast or BGA (Bridge Group Address):
              <i>Unicast</i>=00:00:00:00:00:00/01:00:00:00:00:00,
              <i>Multicast</i>=01:00:00:00:00:00/01:00:00:00:00:00,
              <i>Broadcast</i>=ff:ff:ff:ff:ff:ff/ff:ff:ff:ff:ff:ff or
              <i>BGA</i>=01:80:c2:00:00:00/ff:ff:ff:ff:ff:ff.  Note that a
              broadcast address will also match the multicast
              specification. The flag <b>--src </b>is an alias for this option.

       [<b>!</b>] <b>-d</b>, <b>--destination </b><i>address</i>[<b>/</b><i>mask</i>]
              The destination MAC address. See <b>-s </b>(above) for more
              details on MAC addresses. The flag <b>--dst </b>is an alias for
              this option.

       <b>-c, --set-counter </b><i>pcnt bcnt</i>
              If used with <b>-A </b>or <b>-I</b>, then the packet and byte counters
              of the new rule will be set to <i>pcnt</i>, resp. <i>bcnt</i>.  If used
              with the <b>-C </b>or <b>-D </b>commands, only rules with a packet and
              byte count equal to <i>pcnt</i>, resp. <i>bcnt</i> will match.

   <b>MATCH EXTENSIONS</b>
       Ebtables extensions are dynamically loaded into the userspace
       tool, there is therefore no need to explicitly load them with a
       -m option like is done in iptables.  These extensions deal with
       functionality supported by kernel modules supplemental to the
       core ebtables code.

   <b>802_3</b>
       Specify 802.3 DSAP/SSAP fields or SNAP type.  The protocol must
       be specified as <i>LENGTH</i> (see the option  <i>-p</i> above).

       [<b>!</b>] <b>--802_3-sap </b><i>sap</i>
              DSAP and SSAP are two one byte 802.3 fields.  The bytes
              are always equal, so only one byte (hexadecimal) is needed
              as an argument.

       [<b>!</b>] <b>--802_3-type </b><i>type</i>
              If the 802.3 DSAP and SSAP values are 0xaa then the SNAP
              type field must be consulted to determine the payload
              protocol.  This is a two byte (hexadecimal) argument.
              Only 802.3 frames with DSAP/SSAP 0xaa are checked for
              type.

   <b>among</b>
       Match a MAC address or MAC/IP address pair versus a list of MAC
       addresses and MAC/IP address pairs.  A list entry has the
       following format: <i>xx:xx:xx:xx:xx:xx[=ip.ip.ip.ip][,]</i>. Multiple
       list entries are separated by a comma, specifying an IP address
       corresponding to the MAC address is optional. Multiple MAC/IP
       address pairs with the same MAC address but different IP address
       (and vice versa) can be specified. If the MAC address doesn't
       match any entry from the list, the frame doesn't match the rule
       (unless "!" was used).

       [<b>!</b>] <b>--among-dst </b><i>list</i>
              Compare the MAC destination to the given list. If the
              Ethernet frame has type <i>IPv4</i> or <i>ARP</i>, then comparison with
              MAC/IP destination address pairs from the list is
              possible.

       [<b>!</b>] <b>--among-src </b><i>list</i>
              Compare the MAC source to the given list. If the Ethernet
              frame has type <i>IPv4</i> or <i>ARP</i>, then comparison with MAC/IP
              source address pairs from the list is possible.

       [<b>!</b>] <b>--among-dst-file </b><i>file</i>
              Same as <b>--among-dst </b>but the list is read in from the
              specified file.

       [<b>!</b>] <b>--among-src-file </b><i>file</i>
              Same as <b>--among-src </b>but the list is read in from the
              specified file.

   <b>arp</b>
       Specify (R)ARP fields. The protocol must be specified as <i>ARP</i> or
       <i>RARP</i>.

       [<b>!</b>] <b>--arp-opcode </b><i>opcode</i>
              The (R)ARP opcode (decimal or a string, for more details
              see <b>ebtables -h arp</b>).

       [<b>!</b>] <b>--arp-htype </b><i>hardware-type</i>
              The hardware type, this can be a decimal or the string
              <i>Ethernet</i> (which sets <i>type</i> to 1). Most (R)ARP packets have
              Eternet as hardware type.

       [<b>!</b>] <b>--arp-ptype </b><i>protocol-type</i>
              The protocol type for which the (r)arp is used
              (hexadecimal or the string <i>IPv4</i>, denoting 0x0800).  Most
              (R)ARP packets have protocol type IPv4.

       [<b>!</b>] <b>--arp-ip-src </b><i>address</i>[<b>/</b><i>mask</i>]
              The (R)ARP IP source address specification.

       [<b>!</b>] <b>--arp-ip-dst </b><i>address</i>[<b>/</b><i>mask</i>]
              The (R)ARP IP destination address specification.

       [<b>!</b>] <b>--arp-mac-src </b><i>address</i>[<b>/</b><i>mask</i>]
              The (R)ARP MAC source address specification.

       [<b>!</b>] <b>--arp-mac-dst </b><i>address</i>[<b>/</b><i>mask</i>]
              The (R)ARP MAC destination address specification.

       [<b>!</b>] <b>--arp-gratuitous</b>
              Checks for ARP gratuitous packets: checks equality of IPv4
              source address and IPv4 destination address inside the ARP
              header.

   <b>ip</b>
       Specify IPv4 fields. The protocol must be specified as <i>IPv4</i>.

       [<b>!</b>] <b>--ip-source </b><i>address</i>[<b>/</b><i>mask</i>]
              The source IP address.  The flag <b>--ip-src </b>is an alias for
              this option.

       [<b>!</b>] <b>--ip-destination </b><i>address</i>[<b>/</b><i>mask</i>]
              The destination IP address.  The flag <b>--ip-dst </b>is an alias
              for this option.

       [<b>!</b>] <b>--ip-tos </b><i>tos</i>
              The IP type of service, in hexadecimal numbers.  <b>IPv4</b>.

       [<b>!</b>] <b>--ip-protocol </b><i>protocol</i>
              The IP protocol.  The flag <b>--ip-proto </b>is an alias for this
              option.

       [<b>!</b>] <b>--ip-source-port </b><i>port1</i>[<b>:</b><i>port2</i>]
              The source port or port range for the IP protocols 6
              (TCP), 17 (UDP), 33 (DCCP) or 132 (SCTP). The <b>--ip-</b>
              <b>protocol </b>option must be specified as <i>TCP</i>, <i>UDP</i>, <i>DCCP</i> or
              <i>SCTP</i>.  If <i>port1</i> is omitted, <i>0:port2</i> is used; if <i>port2</i> is
              omitted but a colon is specified, <i>port1:65535</i> is used.
              The flag <b>--ip-sport </b>is an alias for this option.

       [<b>!</b>] <b>--ip-destination-port </b><i>port1</i>[<b>:</b><i>port2</i>]
              The destination port or port range for ip protocols 6
              (TCP), 17 (UDP), 33 (DCCP) or 132 (SCTP). The <b>--ip-</b>
              <b>protocol </b>option must be specified as <i>TCP</i>, <i>UDP</i>, <i>DCCP</i> or
              <i>SCTP</i>.  If <i>port1</i> is omitted, <i>0:port2</i> is used; if <i>port2</i> is
              omitted but a colon is specified, <i>port1:65535</i> is used.
              The flag <b>--ip-dport </b>is an alias for this option.

   <b>ip6</b>
       Specify IPv6 fields. The protocol must be specified as <i>IPv6</i>.

       [<b>!</b>] <b>--ip6-source </b><i>address</i>[<b>/</b><i>mask</i>]
              The source IPv6 address.  The flag <b>--ip6-src </b>is an alias
              for this option.

       [<b>!</b>] <b>--ip6-destination </b><i>address</i>[<b>/</b><i>mask</i>]
              The destination IPv6 address.  The flag <b>--ip6-dst </b>is an
              alias for this option.

       [<b>!</b>] <b>--ip6-tclass </b><i>tclass</i>
              The IPv6 traffic class, in hexadecimal numbers.

       [<b>!</b>] <b>--ip6-protocol </b><i>protocol</i>
              The IP protocol.  The flag <b>--ip6-proto </b>is an alias for
              this option.

       [<b>!</b>] <b>--ip6-source-port </b><i>port1</i>[<b>:</b><i>port2</i>]
              The source port or port range for the IPv6 protocols 6
              (TCP), 17 (UDP), 33 (DCCP) or 132 (SCTP). The
              <b>--ip6-protocol </b>option must be specified as <i>TCP</i>, <i>UDP</i>, <i>DCCP</i>
              or <i>SCTP</i>.  If <i>port1</i> is omitted, <i>0:port2</i> is used; if <i>port2</i>
              is omitted but a colon is specified, <i>port1:65535</i> is used.
              The flag <b>--ip6-sport </b>is an alias for this option.

       [<b>!</b>] <b>--ip6-destination-port </b><i>port1</i>[<b>:</b><i>port2</i>]
              The destination port or port range for IPv6 protocols 6
              (TCP), 17 (UDP), 33 (DCCP) or 132 (SCTP). The
              <b>--ip6-protocol </b>option must be specified as <i>TCP</i>, <i>UDP</i>, <i>DCCP</i>
              or <i>SCTP</i>.  If <i>port1</i> is omitted, <i>0:port2</i> is used; if <i>port2</i>
              is omitted but a colon is specified, <i>port1:65535</i> is used.
              The flag <b>--ip6-dport </b>is an alias for this option.

       [<b>!</b>] <b>--ip6-icmp-type </b>{<i>type</i>[<b>:</b><i>type</i>]<b>/</b><i>code</i>[<b>:</b><i>code</i>]|<i>typename</i>}
              Specify ipv6-icmp type and code to match.  Ranges for both
              type and code are supported. Type and code are separated
              by a slash. Valid numbers for type and range are 0 to 255.
              To match a single type including all valid codes, symbolic
              names can be used instead of numbers. The list of known
              type names is shown by the command
                ebtables --help ip6
              This option is only valid for --ip6-prococol ipv6-icmp.

   <b>limit</b>
       This module matches at a limited rate using a token bucket
       filter.  A rule using this extension will match until this limit
       is reached.  It can be used with the <b>--log </b>watcher to give
       limited logging, for example. Its use is the same as the limit
       match of iptables.

       <b>--limit </b>[<i>value</i>]
              Maximum average matching rate: specified as a number, with
              an optional <i>/second</i>, <i>/minute</i>, <i>/hour</i>, or <i>/day</i> suffix; the
              default is <i>3/hour</i>.

       <b>--limit-burst </b>[<i>number</i>]
              Maximum initial number of packets to match: this number
              gets recharged by one every time the limit specified above
              is not reached, up to this number; the default is <i>5</i>.

   <b>mark_m</b>
       [<b>!</b>] <b>--mark </b>[<i>value</i>][<b>/</b><i>mask</i>]
              Matches frames with the given unsigned mark value. If a
              <i>value</i> and <i>mask</i> are specified, the logical AND of the mark
              value of the frame and the user-specified <i>mask</i> is taken
              before comparing it with the user-specified mark <i>value</i>.
              When only a mark <i>value</i> is specified, the packet only
              matches when the mark value of the frame equals the user-
              specified mark <i>value</i>.  If only a <i>mask</i> is specified, the
              logical AND of the mark value of the frame and the user-
              specified <i>mask</i> is taken and the frame matches when the
              result of this logical AND is non-zero. Only specifying a
              <i>mask</i> is useful to match multiple mark values.

   <b>pkttype</b>
       [<b>!</b>] <b>--pkttype-type </b><i>type</i>
              Matches on the Ethernet "class" of the frame, which is
              determined by the generic networking code. Possible
              values: <i>broadcast</i> (MAC destination is the broadcast
              address), <i>multicast</i> (MAC destination is a multicast
              address), <i>host</i> (MAC destination is the receiving network
              device), or <i>otherhost</i> (none of the above).

   <b>stp</b>
       Specify stp BPDU (bridge protocol data unit) fields. The
       destination address (<b>-d</b>) must be specified as the bridge group
       address (<i>BGA</i>).  For all options for which a range of values can
       be specified, it holds that if the lower bound is omitted (but
       the colon is not), then the lowest possible lower bound for that
       option is used, while if the upper bound is omitted (but the
       colon again is not), the highest possible upper bound for that
       option is used.

       [<b>!</b>] <b>--stp-type </b><i>type</i>
              The BPDU type (0–255), recognized non-numerical types are
              <i>config</i>, denoting a configuration BPDU (=0), and <i>tcn</i>,
              denothing a topology change notification BPDU (=128).

       [<b>!</b>] <b>--stp-flags </b><i>flag</i>
              The BPDU flag (0–255), recognized non-numerical flags are
              <i>topology-change</i>, denoting the topology change flag (=1),
              and <i>topology-change-ack</i>, denoting the topology change
              acknowledgement flag (=128).

       [<b>!</b>] <b>--stp-root-prio </b>[<i>prio</i>][<b>:</b><i>prio</i>]
              The root priority (0–65535) range.

       [<b>!</b>] <b>--stp-root-addr </b>[<i>address</i>][<b>/</b><i>mask</i>]
              The root mac address, see the option <b>-s </b>for more details.

       [<b>!</b>] <b>--stp-root-cost </b>[<i>cost</i>][<b>:</b><i>cost</i>]
              The root path cost (0–4294967295) range.

       [<b>!</b>] <b>--stp-sender-prio </b>[<i>prio</i>][<b>:</b><i>prio</i>]
              The BPDU's sender priority (0–65535) range.

       [<b>!</b>] <b>--stp-sender-addr </b>[<i>address</i>][<b>/</b><i>mask</i>]
              The BPDU's sender mac address, see the option <b>-s </b>for more
              details.

       [<b>!</b>] <b>--stp-port </b>[<i>port</i>][<b>:</b><i>port</i>]
              The port identifier (0–65535) range.

       [<b>!</b>] <b>--stp-msg-age </b>[<i>age</i>][<b>:</b><i>age</i>]
              The message age timer (0–65535) range.

       [<b>!</b>] <b>--stp-max-age </b>[<i>age</i>][<b>:</b><i>age</i>]
              The max age timer (0–65535) range.

       [<b>!</b>] <b>--stp-hello-time </b>[<i>time</i>][<b>:</b><i>time</i>]
              The hello time timer (0–65535) range.

       [<b>!</b>] <b>--stp-forward-delay </b>[<i>delay</i>][<b>:</b><i>delay</i>]
              The forward delay timer (0–65535) range.

   <b>vlan</b>
       Specify 802.1Q Tag Control Information fields.  The protocol must
       be specified as <i>802_1Q</i> (0x8100).

       [<b>!</b>] <b>--vlan-id </b><i>id</i>
              The VLAN identifier field (VID). Decimal number from 0 to
              4095.

       [<b>!</b>] <b>--vlan-prio </b><i>prio</i>
              The user priority field, a decimal number from 0 to 7.
              The VID should be set to 0 ("null VID") or unspecified (in
              the latter case the VID is deliberately set to 0).

       [<b>!</b>] <b>--vlan-encap </b><i>type</i>
              The encapsulated Ethernet frame type/length.  Specified as
              a hexadecimal number from 0x0000 to 0xFFFF or as a
              symbolic name from <b>/etc/ethertypes</b>.

   <b>WATCHER EXTENSIONS</b>
       Watchers only look at frames passing by, they don't modify them
       nor decide to accept the frames or not. These watchers only see
       the frame if the frame matches the rule, and they see it before
       the target is executed.

   <b>log</b>
       The log watcher writes descriptive data about a frame to the
       syslog.

       <b>--log</b>
              Log with the default logging options: log-level= <i>info</i>,
              log-prefix="", no ip logging, no arp logging.

       <b>--log-level </b><i>level</i>
              Defines the logging level. For the possible values, see
              <b>ebtables -h log</b>.  The default level is <i>info</i>.

       <b>--log-prefix </b><i>text</i>
              Defines the prefix <i>text</i> to be printed at the beginning of
              the line with the logging information.

       <b>--log-ip</b>
              Will log the ip information when a frame made by the ip
              protocol matches the rule. The default is no ip
              information logging.

       <b>--log-ip6</b>
              Will log the ipv6 information when a frame made by the
              ipv6 protocol matches the rule. The default is no ipv6
              information logging.

       <b>--log-arp</b>
              Will log the (r)arp information when a frame made by the
              (r)arp protocols matches the rule. The default is no
              (r)arp information logging.

   <b>nflog</b>
       The nflog watcher passes the packet to the loaded logging backend
       in order to log the packet. This is usually used in combination
       with nfnetlink_log as logging backend, which will multicast the
       packet through a <i>netlink</i> socket to the specified multicast group.
       One or more userspace processes may subscribe to the group to
       receive the packets.

       <b>--nflog</b>
              Log with the default logging options

       <b>--nflog-group </b><i>nlgroup</i>
              The netlink group (1–2^32-1) to which packets are (only
              applicable for nfnetlink_log). The default value is 1.

       <b>--nflog-prefix </b><i>prefix</i>
              A prefix string to include in the log message, up to 30
              characters long, useful for distinguishing messages in the
              logs.

       <b>--nflog-range </b><i>size</i>
              The number of bytes to be copied to userspace (only
              applicable for nfnetlink_log). nfnetlink_log instances may
              specify their own range, this option overrides it.

       <b>--nflog-threshold </b><i>size</i>
              Number of packets to queue inside the kernel before
              sending them to userspace (only applicable for
              nfnetlink_log). Higher values result in less overhead per
              packet, but increase delay until the packets reach
              userspace. The default value is 1.

   <b>ulog</b>
       The ulog watcher passes the packet to a userspace logging daemon
       using netlink multicast sockets. This differs from the log
       watcher in the sense that the complete packet is sent to
       userspace instead of a descriptive text and that netlink
       multicast sockets are used instead of the syslog.  This watcher
       enables parsing of packets with userspace programs, the physical
       bridge in and out ports are also included in the netlink
       messages.  The ulog watcher module accepts 2 parameters when the
       module is loaded into the kernel (e.g. with modprobe): <b>nlbufsiz</b>
       specifies how big the buffer for each netlink multicast group is.
       If you say <i>nlbufsiz=8192</i>, for example, up to eight kB of packets
       will get accumulated in the kernel until they are sent to
       userspace. It is not possible to allocate more than 128kB. Please
       also keep in mind that this buffer size is allocated for each
       nlgroup you are using, so the total kernel memory usage increases
       by that factor. The default is 4096.  <b>flushtimeout </b>specifies
       after how many hundredths of a second the queue should be
       flushed, even if it is not full yet. The default is 10 (one tenth
       of a second).

       <b>--ulog</b>
              Use the default settings: ulog-prefix="", ulog-nlgroup=1,
              ulog-cprange=4096, ulog-qthreshold=1.

       <b>--ulog-prefix </b><i>text</i>
              Defines the prefix included with the packets sent to
              userspace.

       <b>--ulog-nlgroup </b><i>group</i>
              Defines which netlink group number to use (a number from 1
              to 32).  Make sure the netlink group numbers used for the
              iptables ULOG target differ from those used for the
              ebtables ulog watcher.  The default group number is 1.

       <b>--ulog-cprange </b><i>range</i>
              Defines the maximum copy range to userspace, for packets
              matching the rule. The default range is 0, which means the
              maximum copy range is given by <b>nlbufsiz</b>.  A maximum copy
              range larger than 128*1024 is meaningless as the packets
              sent to userspace have an upper size limit of 128*1024.

       <b>--ulog-qthreshold </b><i>threshold</i>
              Queue at most <i>threshold</i> number of packets before sending
              them to userspace with a netlink socket. Note that packets
              can be sent to userspace before the queue is full, this
              happens when the ulog kernel timer goes off (the frequency
              of this timer depends on <b>flushtimeout</b>).

   <b>TARGET EXTENSIONS</b>
   <b>arpreply</b>
       The <b>arpreply </b>target can be used in the <b>PREROUTING </b>chain of the
       <b>nat </b>table.  If this target sees an ARP request it will
       automatically reply with an ARP reply. The used MAC address for
       the reply can be specified.  The protocol must be specified as
       <i>ARP</i>.  When the ARP message is not an ARP request or when the ARP
       request isn't for an IP address on an Ethernet network, it is
       ignored by this target (<b>CONTINUE</b>).  When the ARP request is
       malformed, it is dropped (<b>DROP</b>).

       <b>--arpreply-mac </b><i>address</i>
              Specifies the MAC address to reply with: the Ethernet
              source MAC and the ARP payload source MAC will be filled
              in with this address.

       <b>--arpreply-target </b><i>target</i>
              Specifies the standard target. After sending the ARP
              reply, the rule still has to give a standard target so
              ebtables knows what to do with the ARP request.  The
              default target is <b>DROP</b>.

   <b>dnat</b>
       The <b>dnat </b>target can only be used in the <b>PREROUTING </b>and <b>OUTPUT</b>
       chains of the <b>nat </b>table.  It specifies that the destination MAC
       address has to be changed.

       <b>--to-destination </b><i>address</i>
              Change the destination MAC address to the specified
              <i>address</i>.  The flag <b>--to-dst </b>is an alias for this option.

       <b>--dnat-target </b><i>target</i>
              Specifies the standard target. After doing the dnat, the
              rule still has to give a standard target so ebtables knows
              what to do with the dnated frame.  The default target is
              <b>ACCEPT</b>.  Making it <b>CONTINUE </b>could let you use multiple
              target extensions on the same frame. Making it <b>DROP </b>only
              makes sense in the <b>BROUTING </b>chain but using the <b>redirect</b>
              target is more logical there. <b>RETURN </b>is also allowed. Note
              that using <b>RETURN </b>in a base chain is not allowed (for
              obvious reasons).

   <b>mark</b>
       The <b>mark </b>target can be used in every chain of every table. It is
       possible to use the marking of a frame/packet in both ebtables
       and iptables, if the bridge-nf code is compiled into the kernel.
       Both put the marking at the same place. This allows for a form of
       communication between ebtables and iptables.

       <b>--mark-set </b><i>value</i>
              Mark the frame with the specified non-negative <i>value</i>.

       <b>--mark-or </b><i>value</i>
              Or the frame with the specified non-negative <i>value</i>.

       <b>--mark-and </b><i>value</i>
              And the frame with the specified non-negative <i>value</i>.

       <b>--mark-xor </b><i>value</i>
              Xor the frame with the specified non-negative <i>value</i>.

       <b>--mark-target </b><i>target</i>
              Specifies the standard target. After marking the frame,
              the rule still has to give a standard target so ebtables
              knows what to do.  The default target is <b>ACCEPT</b>. Making it
              <b>CONTINUE </b>can let you do other things with the frame in
              subsequent rules of the chain.

   <b>redirect</b>
       The <b>redirect </b>target will change the MAC target address to that of
       the bridge device the frame arrived on. This target can only be
       used in the <b>PREROUTING </b>chain of the <b>nat </b>table.  The MAC address
       of the bridge is used as destination address."

       <b>--redirect-target </b><i>target</i>
              Specifies the standard target. After doing the MAC
              redirect, the rule still has to give a standard target so
              ebtables knows what to do.  The default target is <b>ACCEPT</b>.
              Making it <b>CONTINUE </b>could let you use multiple target
              extensions on the same frame. Making it <b>DROP </b>in the
              <b>BROUTING </b>chain will let the frames be routed. <b>RETURN </b>is
              also allowed. Note that using <b>RETURN </b>in a base chain is
              not allowed.

   <b>snat</b>
       The <b>snat </b>target can only be used in the <b>POSTROUTING </b>chain of the
       <b>nat </b>table.  It specifies that the source MAC address has to be
       changed.

       <b>--to-source </b><i>address</i>
              Changes the source MAC address to the specified <i>address</i>.
              The flag <b>--to-src </b>is an alias for this option.

       <b>--snat-target </b><i>target</i>
              Specifies the standard target. After doing the snat, the
              rule still has to give a standard target so ebtables knows
              what to do.  The default target is <b>ACCEPT</b>. Making it
              <b>CONTINUE </b>could let you use multiple target extensions on
              the same frame. Making it <b>DROP </b>doesn't make sense, but you
              could do that too. <b>RETURN </b>is also allowed. Note that using
              <b>RETURN </b>in a base chain is not allowed.

       <b>--snat-arp</b>
              Also change the hardware source address inside the arp
              header if the packet is an arp message and the hardware
              address length in the arp header is 6 bytes.
</pre> <h2>
FILES </h2>
<pre>
       <i>/etc/ethertypes</i>
</pre> <h2>
MAILINGLISTS </h2>
<pre>
       See <b><a href="http://netfilter.org/mailinglists.html">http://netfilter.org/mailinglists.html</a> </b>
</pre> <h2>
BUGS </h2>
<pre>
       The version of ebtables this man page ships with does not support
       the <b>string </b>match. Further, support for atomic-options (<b>--atomic-</b>
       <b>file</b>, <b>--atomic-init</b>, <b>--atomic-save</b>, <b>--atomic-commit</b>) has not been
       implemented, although <b>ebtables-save </b>and <b>ebtables-restore </b>might
       replace them entirely given the inherent atomicity of nftables.
       Finally, this list is probably not complete.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="xtables-nft.8.html">xtables-nft(8)</a>, <a href="iptables.8.html">iptables(8)</a>, <a href="ip.8.html">ip(8)</a>

       See <b><a href="https://wiki.nftables.org">https://wiki.nftables.org</a> </b>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>iptables</i> (administer and maintain packet
       filter rules) project.  Information about the project can be
       found at ⟨<a href="http://www.netfilter.org/">http://www.netfilter.org/</a>⟩.  If you have a bug report
       for this manual page, see ⟨<a href="http://bugzilla.netfilter.org/">http://bugzilla.netfilter.org/</a>⟩.  This
       page was obtained from the project's upstream Git repository
       ⟨git://git.netfilter.org/iptables⟩ on 2024-06-14.  (At that time,
       the date of the most recent commit that was found in the
       repository was 2024-06-12.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                              December 2011                  <i>EBTABLES</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="arptables-nft.8.html">arptables-nft(8)</a>, <a href="xtables-nft.8.html">xtables-nft(8)</a>, <a href="xtables-translate.8.html">xtables-translate(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/ebtables.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/ebtables.8.html</a>
  </p>
</div>
