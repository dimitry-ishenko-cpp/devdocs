<h1>xfs_metadump(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>xfs_metadump</i>(8)          System Manager's Manual         <i>xfs_metadump</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       xfs_metadump - copy XFS filesystem metadata to a file
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>xfs_metadump </b>[ <b>-aefFgow </b>] [ <b>-m </b><i>max_extents</i> ] [ <b>-l </b><i>logdev</i> ] [ <b>-v</b>
       <i>version</i> ] <i>source target</i>
       <b>xfs_metadump -V</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>xfs_metadump </b>is a debugging tool that copies the metadata from an
       XFS filesystem to a file.  The <i>source</i> argument must be the
       pathname of the device or file containing the XFS filesystem and
       the <i>target</i> argument specifies the destination file name.  If
       <i>target</i> is -, then the output is sent to stdout. This allows the
       output to be redirected to another program such as a compression
       application.

       <b>xfs_metadump </b>may only be used to copy unmounted filesystems, or
       read-only mounted filesystems.

       <b>xfs_metadump </b>does not alter the source filesystem in any way. The
       <i>target</i> image is a contiguous (non-sparse) file containing all the
       filesystem's metadata and indexes to where the blocks were copied
       from.

       By default, <b>xfs_metadump </b>obfuscates most file (regular file,
       directory and symbolic link) names and extended attribute names
       to allow the dumps to be sent without revealing confidential
       information. Extended attribute values are zeroed and no data is
       copied. The only exceptions are file or attribute names that are
       4 or less characters in length. Also file names that span extents
       (this can only occur with the <b>mkfs.xfs</b>(8) options where <b>-n </b><i>size</i> &gt;
       <b>-b </b><i>size</i>) are not obfuscated. Names between 5 and 8 characters in
       length inclusively are partially obfuscated.

       <b>xfs_metadump </b>cannot obfuscate metadata in the filesystem log.
       Log recovery of an obfuscated metadump image may expose clear-
       text metadata and/or cause filesystem corruption in the restored
       image.  It is recommended that the source filesystem first be
       mounted and unmounted, if possible, to ensure that the log is
       clean.  A subsequent invocation of <b>xfs_metadump </b>will capture a
       clean log and obfuscate all metadata correctly.

       If a metadump must be produced from a filesystem with a dirty
       log, it is recommended that obfuscation be turned off with -o
       option, if metadata such as filenames is not considered
       sensitive.  If obfuscation is required on a metadump with a dirty
       log, please inform the recipient of the metadump image about this
       situation.

       The contents of an external log device can be dumped only when
       using the v2 format.  Metadump in v2 format can be generated by
       passing the "-v 2" option.  Metadump in v2 format is generated by
       default if the filesystem has an external log and the metadump
       version to use is not explicitly mentioned.

       <b>xfs_metadump </b>should not be used for any purposes other than for
       debugging and reporting filesystem problems. The most common
       usage scenario for this tool is when <a href="xfs_repair.8.html">xfs_repair(8)</a> fails to
       repair a filesystem and a metadump image can be sent for
       analysis.

       The file generated by <b>xfs_metadump </b>can be restored to filesystem
       image (minus the data) using the <a href="xfs_mdrestore.8.html">xfs_mdrestore(8)</a> tool.
</pre> <h2>
OPTIONS </h2>
<pre>
       <b>-a     </b>Copies entire metadata blocks.  Normally, <b>xfs_metadump</b>
              will zero any stale bytes interspersed with in-use
              metadata.  Use this option to copy full metadata blocks,
              to provide more debugging information for a corrupted
              filesystem.  Note that the extra data will be
              unobfuscated.

       <b>-e     </b>Stops the dump on a read error. Normally, it will ignore
              read errors and copy all the metadata that is accessible.

       <b>-f     </b>Specifies that the filesystem image to be processed is
              stored in a regular file (see the <b>mkfs.xfs -d </b>file
              option). This can also happen if an image copy of a
              filesystem has been made into an ordinary file with
              <a href="xfs_copy.8.html">xfs_copy(8)</a>.

       <b>-F     </b>Specifies that we want to continue even if the superblock
              magic is not correct.  If the source is truly not an XFS
              filesystem, the resulting image will be useless, and
              xfs_metadump may crash.

       <b>-g     </b>Shows dump progress. This is sent to stdout if the <i>target</i>
              is a file or to stderr if the <i>target</i> is stdout.

       <b>-l </b><i>logdev</i>
              For filesystems which use an external log, this specifies
              the device where the external log resides.  If the v2
              metadump format is selected, the contents of the external
              log will be copied to the metadump.  The v2 metadump
              format will be selected automatically if this option is
              specified.

       <b>-m     </b>Set the maximum size of an allowed metadata extent.
              Extremely large metadata extents are likely to be corrupt,
              and will be skipped if they exceed this value.  The
              default size is 2097151 blocks.

       <b>-o     </b>Disables obfuscation of file names and extended
              attributes.

       <b>-v     </b>The format of the metadump file to be produced.  Valid
              values are 1 and 2.  The default metadump format is 1.

       <b>-w     </b>Prints warnings of inconsistent metadata encountered to
              stderr. Bad metadata is still copied.

       <b>-V     </b>Prints the version number and exits.
</pre> <h2>
DIAGNOSTICS </h2>
<pre>
       <b>xfs_metadump </b>returns an exit code of 0 if all readable metadata
       is successfully copied or 1 if a write error occurs or a read
       error occurs and the <b>-e </b>option used.
</pre> <h2>
NOTES </h2>
<pre>
       As <b>xfs_metadump </b>copies metadata only, it does not matter if the
       <i>source</i> filesystem has a realtime section or not. If the
       filesystem has an external log, it is not copied. Internal logs
       are copied and any outstanding log transactions are not
       obfuscated if they contain names.

       <b>xfs_metadump </b>is a shell wrapper around the <a href="xfs_db.8.html">xfs_db(8)</a> <b>metadump</b>
       command.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="xfs_repair.8.html">xfs_repair(8)</a>, <a href="xfs_mdrestore.8.html">xfs_mdrestore(8)</a>, <a href="xfs_freeze.8.html">xfs_freeze(8)</a>, <a href="xfs_db.8.html">xfs_db(8)</a>,
       <a href="xfs_copy.8.html">xfs_copy(8)</a>, <a href="../man5/xfs.5.html">xfs(5)</a>
</pre> <h2>
BUGS </h2>
<pre>
       Email bug reports to <b>linux-xfs@vger.kernel.org</b>.
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>xfsprogs</i> (utilities for XFS filesystems)
       project.  Information about the project can be found at 
       ⟨<a href="http://xfs.org/">http://xfs.org/</a>⟩.  If you have a bug report for this manual page,
       send it to linux-xfs@vger.kernel.org.  This page was obtained
       from the project's upstream Git repository
       ⟨<a href="https://git.kernel.org/pub/scm/fs/xfs/xfsprogs-dev.git">https://git.kernel.org/pub/scm/fs/xfs/xfsprogs-dev.git</a>⟩ on
       2024-06-14.  (At that time, the date of the most recent commit
       that was found in the repository was 2024-05-17.)  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">                                                         <i>xfs_metadump</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="xfs_db.8.html">xfs_db(8)</a>, <a href="xfs_mdrestore.8.html">xfs_mdrestore(8)</a>, <a href="xfs_repair.8.html">xfs_repair(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/xfs_metadump.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/xfs_metadump.8.html</a>
  </p>
</div>
