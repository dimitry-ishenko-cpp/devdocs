<h1>btrfs-image(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>BTRFS-IMAGE</i>(8)                Btrfs Manual                <i>BTRFS-IMAGE</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       btrfs-image - create/restore an image of the filesystem
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>btrfs-image </b>[options] <i>&lt;source&gt; &lt;target&gt;</i>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>btrfs-image </b>is used to create an image of a btrfs filesystem. All
       data will be zeroed, but metadata and the like is preserved.
       Mainly used for debugging purposes.

       In the dump mode, source is the btrfs device/file and target is
       the output file (use <i>-</i> for stdout).

       In the restore mode (option -r), source is the dumped image and
       target is the btrfs device/file.
</pre> <h2>
OPTIONS </h2>
<pre>
       -r
           Restore metadump image. By default, this fixes super’s chunk
           tree, by using 1 stripe pointing to primary device, so that
           file system can be restored by running tree log reply if
           possible. To restore without changing number of stripes in
           chunk tree check -o option.

       -c <i>&lt;value&gt;</i>
           Compression level (0 ~ 9).

       -t <i>&lt;value&gt;</i>
           Number of threads (1 ~ 32) to be used to process the image
           dump or restore.

       -o
           Use the old restore method, this does not fixup the chunk
           tree so the restored file system will not be able to be
           mounted.

       -s
           Sanitize the file names when generating the image. One -s
           means just generate random garbage, which means that the
           directory indexes won’t match up since the hashes won’t match
           with the garbage filenames. Using -ss will calculate a
           collision for the filename so that the hashes match, and if
           it can’t calculate a collision then it will just generate
           garbage. The collision calculator is very time and CPU
           intensive so only use it if you are having problems with your
           file system tree and need to have it mostly working.

       -w
           Walk all the trees manually and copy any blocks that are
           referenced. Use this option if your extent tree is corrupted
           to make sure that all of the metadata is captured.

       -m
           Restore for multiple devices, more than 1 device should be
           provided.
</pre> <h2>
EXIT STATUS </h2>
<pre>
       <b>btrfs-image </b>will return 0 if no error happened. If any problems
       happened, 1 will be returned.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="mkfs.btrfs.8.html">mkfs.btrfs(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>btrfs-progs</i> (btrfs filesystem tools)
       project.  Information about the project can be found at 
       ⟨<a href="https://btrfs.wiki.kernel.org/index.php/Btrfs_source_repositories">https://btrfs.wiki.kernel.org/index.php/Btrfs_source_repositories</a>⟩.
       If you have a bug report for this manual page, see
       ⟨<a href="https://btrfs.wiki.kernel.org/index.php/Problem_FAQ#How_do_I_report_bugs_and_issues.3F">https://btrfs.wiki.kernel.org/index.php/Problem_FAQ#How_do_I_report_bugs_and_issues.3F</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨git://git.kernel.org/pub/scm/linux/kernel/git/kdave/btrfs-progs.git⟩
       on 2024-06-14.  (At that time, the date of the most recent commit
       that was found in the repository was 2024-05-02.)  If you
       discover any rendering problems in this HTML version of the page,
       or you believe there is a better or more up-to-date source for
       the page, or you have corrections or improvements to the
       information in this COLOPHON (which is <i>not</i> part of the original
       manual page), send a mail to man-pages@man7.org

<span class="footline">Btrfs v5.16.1                  02/06/2022                 <i>BTRFS-IMAGE</i>(8)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/btrfs-image.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/btrfs-image.8.html</a>
  </p>
</div>
