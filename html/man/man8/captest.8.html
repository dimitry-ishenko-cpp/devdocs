<h1>captest(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>CAPTEST:</i>(8)          System Administration Utilities         <i>CAPTEST:</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       captest - a program to demonstrate capabilities
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>captest [ --ambient --drop-all | --drop-caps | --id ] [ --init-</b>
       <b>grp ] [ --lock ] [ --text ]</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>captest </b>is a program that demonstrates and prints out the current
       process capabilities. Each option prints the same report. It will
       output current capabilities. then it will try to access
       /etc/shadow directly to show if that can be done. Then it creates
       a child process that attempts to read /etc/shadow and outputs the
       results of that. Then it outputs the capabilities that a child
       process would have.

       You can also apply file system capabilities to this program to
       study how they work. For example, filecap /usr/bin/captest chown.
       Then run captest as a normal user. Another interesting test is to
       make captest suid root so that you can see what the interaction
       is between root's credentials and capabilities. For example,
       chmod 4755 /usr/bin/captest. When run as a normal user, the
       program will see if privilege escalation is possible. But do not
       leave this app setuid root after you are don testing so that an
       attacker cannot take advantage of it.
</pre> <h2>
OPTIONS </h2>
<pre>
       <b>--ambient</b>
              This attempts to add CAP_CHOWN ambient capability.

       <b>--drop-all</b>
              This drops all capabilities including ambient and clears
              the bounding set.

       <b>--drop-caps</b>
              This drops just traditional capabilities.

       <b>--id   </b>This changes to uid and gid 99, drops supplemental groups,
              and clears the bounding set.

       <b>--init-grp</b>
              This changes to uid and gid 99 and then adds any
              supplemental groups that comes with that account. You
              would have add them prior to testing because by default
              there are no supplemental groups on account 99.

       <b>--text </b>This option outputs the effective capabilities in text
              rather than numerically.

       <b>--lock </b>This prevents the ability for child processes to regain
              privileges if the uid is 0.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="filecap.8.html">filecap(8)</a>, <a href="../man7/capabilities.7.html">capabilities(7)</a>
</pre> <h2>
AUTHOR </h2>
<pre>
       Steve Grubb
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>libcap-ng</i> (capabilities commands and
       library (NG)) project.  Information about the project can be
       found at ⟨<a href="https://people.redhat.com/sgrubb/libcap-ng/">https://people.redhat.com/sgrubb/libcap-ng/</a>⟩.  It is
       not known how to report bugs for this man page; if you know,
       please send a mail to man-pages@man7.org.  This page was obtained
       from the tarball libcap-ng-0.8.5.tar.gz fetched from
       ⟨<a href="https://people.redhat.com/sgrubb/libcap-ng/index.html">https://people.redhat.com/sgrubb/libcap-ng/index.html</a>⟩ on
       2024-06-14.  If you discover any rendering problems in this HTML
       version of the page, or you believe there is a better or more up-
       to-date source for the page, or you have corrections or
       improvements to the information in this COLOPHON (which is <i>not</i>
       part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">Red Hat                         Sept 2020                    <i>CAPTEST:</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="../man7/capabilities.7.html">capabilities(7)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/captest.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/captest.8.html</a>
  </p>
</div>
