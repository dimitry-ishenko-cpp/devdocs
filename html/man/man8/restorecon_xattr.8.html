<h1>restorecon_xattr(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>restorecon_xattr</i>(8)       SELinux User Command       <i>restorecon_xattr</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       restorecon_xattr - manage <i>security.sehash</i> extended attribute
       entries added by <a href="setfiles.8.html">setfiles(8)</a> or <a href="restorecon.8.html">restorecon(8)</a>.
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>restorecon_xattr </b>[<b>-d</b>] [<b>-D</b>] [<b>-m</b>] [<b>-n</b>] [<b>-r</b>] [<b>-v</b>] [<b>-e </b><i>directory</i>] [<b>-f</b>
       <i>specfile</i>] <i>pathname</i>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>restorecon_xattr </b>will display the SHA1 digests added to extended
       attributes <i>security.sehash</i> or delete the attribute completely.
       These attributes are set by <a href="restorecon.8.html">restorecon(8)</a> or <a href="setfiles.8.html">setfiles(8)</a> to
       specified directories when relabeling recursively.

       <b>restorecon_xattr </b>is useful for managing the extended attribute
       entries particularly when users forget what directories they ran
       <a href="restorecon.8.html">restorecon(8)</a> or <a href="setfiles.8.html">setfiles(8)</a> from.

       <b>RAMFS </b>and <b>TMPFS </b>filesystems do not support the <i>security.sehash</i>
       extended attribute and are automatically excluded from searches.

       By default <b>restorecon_xattr </b>will display the SHA1 digests with
       "Match" appended if they match the default specfile set or the
       <i>specfile</i> set used with the <b>-f </b>option. Non-matching SHA1 digests
       will be displayed with "No Match" appended.  This feature can be
       disabled by the <b>-n </b>option.
</pre> <h2>
OPTIONS </h2>
<pre>
       <b>-d     </b>delete all non-matching <i>security.sehash</i> directory digest
              entries.

       <b>-D     </b>delete all <i>security.sehash</i> directory digest entries.

       <b>-m     </b>do not read <b>/proc/mounts </b>to obtain a list of non-seclabel
              mounts to be excluded from relabeling checks.
              Setting <b>-m </b>is useful where there is a non-seclabel fs
              mounted with a seclabel fs mounted on a directory below
              this.

       <b>-n     </b>Do not append "Match" or "No Match" to displayed digests.

       <b>-r     </b>recursively descend directories.

       <b>-v     </b>display SHA1 digest generated by specfile set (Note that
              this digest is not used to match the <i>security.sehash</i>
              directory digest entries, and is shown for reference
              only).

       <b>-e     </b><i>directory</i>
              directory to exclude (repeat option for more than one
              directory).

       <b>-f     </b><i>specfile</i>
              an optional <i>specfile</i> containing file context entries as
              described in <a href="../man5/file_contexts.5.html">file_contexts(5)</a>.  If the option is not
              specified, then the default file_contexts will be used.
</pre> <h2>
ARGUMENTS </h2>
<pre>
       <i>pathname</i>
              the pathname of the directory tree to be searched.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="restorecon.8.html">restorecon(8)</a>, <a href="setfiles.8.html">setfiles(8)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>selinux</i> (Security-Enhanced Linux user-
       space libraries and tools) project.  Information about the
       project can be found at 
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki">https://github.com/SELinuxProject/selinux/wiki</a>⟩.  If you have a
       bug report for this manual page, see
       ⟨<a href="https://github.com/SELinuxProject/selinux/wiki/Contributing">https://github.com/SELinuxProject/selinux/wiki/Contributing</a>⟩.
       This page was obtained from the project's upstream Git repository
       ⟨<a href="https://github.com/SELinuxProject/selinux">https://github.com/SELinuxProject/selinux</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2023-05-11.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">                              24 Sept 2016           <i>restorecon_xattr</i>(8)</span>
</pre>          <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/restorecon_xattr.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/restorecon_xattr.8.html</a>
  </p>
</div>
