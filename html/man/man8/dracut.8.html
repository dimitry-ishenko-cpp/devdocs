<h1>dracut(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>DRACUT</i>(8)                        dracut                        <i>DRACUT</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       dracut - low-level tool for generating an initramfs/initrd image
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>dracut </b>[<i>OPTION...</i>] [<i>&lt;image&gt;</i> [<i>&lt;kernel version&gt;</i>]]
</pre> <h2>
DESCRIPTION </h2>
<pre>
       Create an initramfs &lt;image&gt; for the kernel with the version
       &lt;kernel version&gt;. If &lt;kernel version&gt; is omitted, then the
       version of the actual running kernel is used. If &lt;image&gt; is
       omitted or empty, depending on bootloader specification, the
       default location can be
       <i>/efi/&lt;machine-id&gt;/&lt;kernel-version&gt;/initrd</i>,
       <i>/boot/&lt;machine-id&gt;/&lt;kernel-version&gt;/initrd</i>,
       <i>/boot/efi/&lt;machine-id&gt;/&lt;kernel-version&gt;/initrd</i>,
       <i>/lib/modules/&lt;kernel-version&gt;/initrd</i> or
       <i>/boot/initramfs-&lt;kernel-version&gt;.img</i>.

       dracut creates an initial image used by the kernel for preloading
       the block device modules (such as IDE, SCSI or RAID) which are
       needed to access the root filesystem, mounting the root
       filesystem and booting into the real system.

       At boot time, the kernel unpacks that archive into RAM disk,
       mounts and uses it as initial root file system. All finding of
       the root device happens in this early userspace.

       Initramfs images are also called "initrd".

       For a complete list of kernel command line options see
       <a href="../man7/dracut.cmdline.7.html">dracut.cmdline(7)</a>.

       If you are dropped to an emergency shell, while booting your
       initramfs, the file <i>/run/initramfs/rdsosreport.txt</i> is created,
       which can be saved to a (to be mounted by hand) partition
       (usually /boot) or a USB stick. Additional debugging info can be
       produced by adding <b>rd.debug </b>to the kernel command line.
       <i>/run/initramfs/rdsosreport.txt</i> contains all logs and the output
       of some tools. It should be attached to any report about dracut
       problems.
</pre> <h2>
USAGE </h2>
<pre>
       To create a initramfs image, the most simple command is:

           # dracut

       This will generate a general purpose initramfs image, with all
       possible functionality resulting of the combination of the
       installed dracut modules and system tools. The image, depending
       on bootloader specification, can be
       <i>/efi/</i>&lt;machine-id&gt;<i>/</i>&lt;kernel-version&gt;<i>/initrd</i>,
       <i>/boot/</i>&lt;machine-id&gt;<i>/</i>&lt;kernel-version&gt;<i>/initrd</i>,
       <i>/boot/efi/</i>&lt;machine-id&gt;<i>/</i>&lt;kernel-version&gt;<i>/initrd</i>,
       <i>/lib/modules/</i>&lt;kernel-version&gt;<i>/initrd</i> or
       <i>/boot/initramfs-</i>&lt;kernel-version&gt;<i>.img</i> and contains the kernel
       modules of the currently active kernel with version
       <i>&lt;kernel-version&gt;</i>.

       If the initramfs image already exists, dracut will display an
       error message, and to overwrite the existing image, you have to
       use the --force option.

           # dracut --force

       If you want to specify another filename for the resulting image
       you would issue a command like:

           # dracut foobar.img

       To generate an image for a specific kernel version, the command
       would be:

           # dracut foobar.img 2.6.40-1.rc5.f20

       A shortcut to generate the image at the default location for a
       specific kernel version is:

           # dracut --kver 2.6.40-1.rc5.f20

       If you want to create lighter, smaller initramfs images, you may
       want to specify the --hostonly or -H option. Using this option,
       the resulting image will contain only those dracut modules,
       kernel modules and filesystems, which are needed to boot this
       specific machine. This has the drawback, that you can’t put the
       disk on another controller or machine, and that you can’t switch
       to another root filesystem, without recreating the initramfs
       image. The usage of the --hostonly option is only for experts and
       you will have to keep the broken pieces. At least keep a copy of
       a general purpose image (and corresponding kernel) as a fallback
       to rescue your system.

   <b>Inspecting the Contents</b>
       To see the contents of the image created by dracut, you can use
       the lsinitrd tool.

           # lsinitrd | less

       To display the contents of a file in the initramfs also use the
       lsinitrd tool:

           # lsinitrd -f /etc/ld.so.conf
           include ld.so.conf.d/*.conf

   <b>Adding dracut Modules</b>
       Some dracut modules are turned off by default and have to be
       activated manually. You can do this by adding the dracut modules
       to the configuration file <i>/etc/dracut.conf</i> or
       <i>/etc/dracut.conf.d/myconf.conf</i>. See <a href="../man5/dracut.conf.5.html">dracut.conf(5)</a>. You can also
       add dracut modules on the command line by using the -a or --add
       option:

           # dracut --add module initramfs-module.img

       To see a list of available dracut modules, use the --list-modules
       option:

           # dracut --list-modules

   <b>Omitting dracut Modules</b>
       Sometimes you don’t want a dracut module to be included for
       reasons of speed, size or functionality. To do this, either
       specify the omit_dracutmodules variable in the <i>dracut.conf</i> or
       <i>/etc/dracut.conf.d/myconf.conf</i> configuration file (see
       <a href="../man5/dracut.conf.5.html">dracut.conf(5)</a>), or use the -o or --omit option on the command
       line:

           # dracut -o "multipath lvm" no-multipath-lvm.img

   <b>Adding Kernel Modules</b>
       If you need a special kernel module in the initramfs, which is
       not automatically picked up by dracut, you have the use the
       --add-drivers option on the command line or the drivers variable
       in the <i>/etc/dracut.conf</i> or <i>/etc/dracut.conf.d/myconf.conf</i>
       configuration file (see <a href="../man5/dracut.conf.5.html">dracut.conf(5)</a>):

           # dracut --add-drivers mymod initramfs-with-mymod.img

   <b>Boot parameters</b>
       An initramfs generated without the "hostonly" mode, does not
       contain any system configuration files (except for some special
       exceptions), so the configuration has to be done on the kernel
       command line. With this flexibility, you can easily boot from a
       changed root partition, without the need to recompile the
       initramfs image. So, you could completely change your root
       partition (move it inside a md raid with encryption and LVM on
       top), as long as you specify the correct filesystem LABEL or UUID
       on the kernel command line for your root device, dracut will find
       it and boot from it.

       The kernel command line can also be provided by the dhcp server
       with the root-path option. See the section called “Network Boot”.

       For a full reference of all kernel command line parameters, see
       <a href="../man7/dracut.cmdline.7.html">dracut.cmdline(7)</a>.

       To get a quick start for the suitable kernel command line on your
       system, use the <i>--print-cmdline</i> option:

           # dracut --print-cmdline
            root=UUID=8b8b6f91-95c7-4da2-831b-171e12179081 rootflags=rw,relatime,discard,data=ordered rootfstype=ext4

       <b>Specifying the root Device</b>

           This is the only option dracut really needs to boot from your
           root partition. Because your root partition can live in
           various environments, there are a lot of formats for the
           root= option. The most basic one is root=<i>&lt;path to device</i>
           <i>node&gt;</i>:

               root=/dev/sda2

           Because device node names can change, dependent on the drive
           ordering, you are encouraged to use the filesystem identifier
           (UUID) or filesystem label (LABEL) to specify your root
           partition:

               root=UUID=19e9dda3-5a38-484d-a9b0-fa6b067d0331

           or

               root=LABEL=myrootpartitionlabel

           To see all UUIDs or LABELs on your system, do:

               # ls -l /dev/disk/by-uuid

           or

               # ls -l /dev/disk/by-label

           If your root partition is on the network see the section
           called “Network Boot”.

       <b>Keyboard Settings</b>

           If you have to input passwords for encrypted disk volumes,
           you might want to set the keyboard layout and specify a
           display font.

           A typical german kernel command line would contain:

               rd.vconsole.font=eurlatgr rd.vconsole.keymap=de-latin1-nodeadkeys rd.locale.LANG=de_DE.UTF-8

           Setting these options can override the setting stored on your
           system, if you use a modern init system, like systemd.

       <b>Blacklisting Kernel Modules</b>

           Sometimes it is required to prevent the automatic kernel
           module loading of a specific kernel module. To do this, just
           add rd.driver.blacklist=<i>&lt;kernel module name&gt;</i>, with <i>&lt;kernel</i>
           <i>module name&gt;</i> not containing the <i>.ko</i> suffix, to the kernel
           command line. For example:

               rd.driver.blacklist=mptsas rd.driver.blacklist=nouveau

           The option can be specified multiple times on the kernel
           command line.

       <b>Speeding up the Boot Process</b>

           If you want to speed up the boot process, you can specify as
           much information for dracut on the kernel command as
           possible. For example, you can tell dracut, that you root
           partition is not on a LVM volume or not on a raid partition,
           or that it lives inside a specific crypto LUKS encrypted
           volume. By default, dracut searches everywhere. A typical
           dracut kernel command line for a plain primary or logical
           partition would contain:

               rd.luks=0 rd.lvm=0 rd.md=0 rd.dm=0

           This turns off every automatic assembly of LVM, MD raids, DM
           raids and crypto LUKS.

           Of course, you could also omit the dracut modules in the
           initramfs creation process, but then you would lose the
           possibility to turn it on on demand.

   <b>Injecting custom Files</b>
       To add your own files to the initramfs image, you have several
       possibilities.

       The --include option let you specify a source path and a target
       path. For example

           # dracut --include cmdline-preset /etc/cmdline.d/mycmdline.conf initramfs-cmdline-pre.img

       will create an initramfs image, where the file cmdline-preset
       will be copied inside the initramfs to
       <i>/etc/cmdline.d/mycmdline.conf</i>. --include can only be specified
       once.

           # mkdir -p rd.live.overlay/etc/cmdline.d
           # mkdir -p rd.live.overlay/etc/conf.d
           # echo "ip=dhcp" &gt;&gt; rd.live.overlay/etc/cmdline.d/mycmdline.conf
           # echo export FOO=testtest &gt;&gt; rd.live.overlay/etc/conf.d/testvar.conf
           # echo export BAR=testtest &gt;&gt; rd.live.overlay/etc/conf.d/testvar.conf
           # tree rd.live.overlay/
           rd.live.overlay/
           `-- etc
               |-- cmdline.d
               |   `-- mycmdline.conf
               `-- conf.d
                   `-- testvar.conf

           # dracut --include rd.live.overlay / initramfs-rd.live.overlay.img

       This will put the contents of the rd.live.overlay directory into
       the root of the initramfs image.

       The --install option let you specify several files, which will
       get installed in the initramfs image at the same location, as
       they are present on initramfs creation time.

           # dracut --install 'strace fsck.ext4 ssh' initramfs-dbg.img

       This will create an initramfs with the strace, fsck.ext4 and ssh
       executables, together with the libraries needed to start those.
       The --install option can be specified multiple times.

   <b>Network Boot</b>
       If your root partition is on a network drive, you have to have
       the network dracut modules installed to create a network aware
       initramfs image.

       If you specify ip=dhcp on the kernel command line, then dracut
       asks a dhcp server about the ip address for the machine. The dhcp
       server can also serve an additional root-path, which will set the
       root device for dracut. With this mechanism, you have static
       configuration on your client machine and a centralized boot
       configuration on your TFTP/DHCP server. If you can’t pass a
       kernel command line, then you can inject
       <i>/etc/cmdline.d/mycmdline.conf</i>, with a method described in the
       section called “Injecting custom Files”.

       <b>Reducing the Image Size</b>

           To reduce the size of the initramfs, you should create it
           with by omitting all dracut modules, which you know, you
           don’t need to boot the machine.

           You can also specify the exact dracut and kernel modules to
           produce a very tiny initramfs image.

           For example for a NFS image, you would do:

               # dracut -m "nfs network base" initramfs-nfs-only.img

           Then you would boot from this image with your target machine
           and reduce the size once more by creating it on the target
           machine with the --host-only option:

               # dracut -m "nfs network base" --host-only initramfs-nfs-host-only.img

           This will reduce the size of the initramfs image
           significantly.
</pre> <h2>
TROUBLESHOOTING </h2>
<pre>
       If the boot process does not succeed, you have several options to
       debug the situation.

   <b>Identifying your problem area</b>
        1. Remove <i>'rhgb</i>' and <i>'quiet</i>' from the kernel command line

        2. Add <i>'rd.shell</i>' to the kernel command line. This will present
           a shell should dracut be unable to locate your root device

        3. Add <i>'rd.shell rd.debug log_buf_len=1M</i>' to the kernel command
           line so that dracut shell commands are printed as they are
           executed

        4. The file /run/initramfs/rdsosreport.txt is generated, which
           contains all the logs and the output of all significant
           tools, which are mentioned later.

       If you want to save that output, simply mount /boot by hand or
       insert an USB stick and mount that. Then you can store the output
       for later inspection.

   <b>Information to include in your report</b>
       <b>All bug reports</b>

           In all cases, the following should be mentioned and attached
           to your bug report:

           •   The exact kernel command-line used. Typically from the
               bootloader configuration file (e.g.
               <i>/boot/grub2/grub.cfg</i>) or from <i>/proc/cmdline</i>.

           •   A copy of your disk partition information from
               <i>/etc/fstab</i>, which might be obtained booting an old
               working initramfs or a rescue medium.

           •   Turn on dracut debugging (see <i>the debugging dracut</i>
               <i>section</i>), and attach the file
               /run/initramfs/rdsosreport.txt.

           •   If you use a dracut configuration file, please include
               <i>/etc/dracut.conf</i> and all files in
               <i>/etc/dracut.conf.d/*.conf</i>

       <b>Network root device related problems</b>

           This section details information to include when experiencing
           problems on a system whose root device is located on a
           network attached volume (e.g. iSCSI, NFS or NBD). As well as
           the information from the section called “All bug reports”,
           include the following information:

           •   Please include the output of

                   # /sbin/ifup &lt;interfacename&gt;
                   # ip addr show

   <b>Debugging dracut</b>
       <b>Configure a serial console</b>

           Successfully debugging dracut will require some form of
           console logging during the system boot. This section
           documents configuring a serial console connection to record
           boot messages.

            1. First, enable serial console output for both the kernel
               and the bootloader.

            2. Open the file <i>/boot/grub2/grub.cfg</i> for editing. Below the
               line <i>'timeout=5</i>', add the following:

                   serial --unit=0 --speed=9600
                   terminal --timeout=5 serial console

            3. Also in <i>/boot/grub2/grub.cfg</i>, add the following boot
               arguments to the <i>'kernel</i>' line:

                   console=tty0 console=ttyS0,9600

            4. When finished, the <i>/boot/grub2/grub.cfg</i> file should look
               similar to the example below.

                   default=0
                   timeout=5
                   serial --unit=0 --speed=9600
                   terminal --timeout=5 serial console
                   title Fedora (2.6.29.5-191.fc11.x86_64)
                     root (hd0,0)
                     kernel /vmlinuz-2.6.29.5-191.fc11.x86_64 ro root=/dev/mapper/vg_uc1-lv_root console=tty0 console=ttyS0,9600
                     initrd /dracut-2.6.29.5-191.fc11.x86_64.img

            5. More detailed information on how to configure the kernel
               for console output can be found at
               <b><a href="http://www.faqs.org/docs/Linux-HOWTO/Remote-Serial-Console-HOWTO.html#CONFIGURE-KERNEL">http://www.faqs.org/docs/Linux-HOWTO/Remote-Serial-Console-HOWTO.html#CONFIGURE-KERNEL</a> </b>.

            6. Redirecting non-interactive output

                   <b>Note</b>
                   You can redirect all non-interactive output to
                   <i>/dev/kmsg</i> and the kernel will put it out on the
                   console when it reaches the kernel buffer by doing

                   # exec &gt;/dev/kmsg 2&gt;&amp;1 &lt;/dev/console

       <b>Using the dracut shell</b>

           dracut offers a shell for interactive debugging in the event
           dracut fails to locate your root filesystem. To enable the
           shell:

            1. Add the boot parameter <i>'rd.shell</i>' to your bootloader
               configuration file (e.g.  <i>/boot/grub2/grub.cfg</i>)

            2. Remove the boot arguments <i>'rhgb</i>' and <i>'quiet</i>'

               A sample <i>/boot/grub2/grub.cfg</i> bootloader configuration
               file is listed below.

                   default=0
                   timeout=5
                   serial --unit=0 --speed=9600
                   terminal --timeout=5 serial console
                   title Fedora (2.6.29.5-191.fc11.x86_64)
                     root (hd0,0)
                     kernel /vmlinuz-2.6.29.5-191.fc11.x86_64 ro root=/dev/mapper/vg_uc1-lv_root console=tty0 rd.shell
                     initrd /dracut-2.6.29.5-191.fc11.x86_64.img

            3. If system boot fails, you will be dropped into a shell as
               seen in the example below.

                   No root device found
                   Dropping to debug shell.

                   #

            4. Use this shell prompt to gather the information requested
               above (see the section called “All bug reports”).

       <b>Accessing the root volume from the dracut shell</b>

           From the dracut debug shell, you can manually perform the
           task of locating and preparing your root volume for boot. The
           required steps will depend on how your root volume is
           configured. Common scenarios include:

           •   A block device (e.g.  <i>/dev/sda7</i>)

           •   A LVM logical volume (e.g.  <i>/dev/VolGroup00/LogVol00</i>)

           •   An encrypted device (e.g.
               <i>/dev/mapper/luks-4d5972ea-901c-4584-bd75-1da802417d83</i>)

           •   A network attached device (e.g.
               <i>netroot=iscsi:@192.168.0.4::3260::iqn.2009-02.org.example:for.all</i>)

           The exact method for locating and preparing will vary.
           However, to continue with a successful boot, the objective is
           to locate your root volume and create a symlink <i>/dev/root</i>
           which points to the file system. For example, the following
           example demonstrates accessing and booting a root volume that
           is an encrypted LVM Logical volume.

            1. Inspect your partitions using parted

                   # parted /dev/sda -s p
                   Model: ATA HTS541060G9AT00 (scsi)
                   Disk /dev/sda: 60.0GB
                   Sector size (logical/physical): 512B/512B
                   Partition Table: msdos
                   Number  Start   End     Size    Type      File system  Flags
                   1      32.3kB  10.8GB  107MB   primary   ext4         boot
                   2      10.8GB  55.6GB  44.7GB  logical                lvm

            2. You recall that your root volume was a LVM logical
               volume. Scan and activate any logical volumes.

                   # lvm vgscan
                   # lvm vgchange -ay

            3. You should see any logical volumes now using the command
               blkid:

                   # blkid
                   /dev/sda1: UUID="3de247f3-5de4-4a44-afc5-1fe179750cf7" TYPE="ext4"
                   /dev/sda2: UUID="Ek4dQw-cOtq-5MJu-OGRF-xz5k-O2l8-wdDj0I" TYPE="LVM2_member"
                   /dev/mapper/linux-root: UUID="def0269e-424b-4752-acf3-1077bf96ad2c" TYPE="crypto_LUKS"
                   /dev/mapper/linux-home: UUID="c69127c1-f153-4ea2-b58e-4cbfa9257c5e" TYPE="ext4"
                   /dev/mapper/linux-swap: UUID="47b4d329-975c-4c08-b218-f9c9bf3635f1" TYPE="swap"

            4. From the output above, you recall that your root volume
               exists on an encrypted block device. Following the
               guidance disk encryption guidance from the Installation
               Guide, you unlock your encrypted root volume.

                   # UUID=$(cryptsetup luksUUID /dev/mapper/linux-root)
                   # cryptsetup luksOpen /dev/mapper/linux-root luks-$UUID
                   Enter passphrase for /dev/mapper/linux-root:
                   Key slot 0 unlocked.

            5. Next, make a symbolic link to the unlocked root volume

                   # ln -s /dev/mapper/luks-$UUID /dev/root

            6. With the root volume available, you may continue booting
               the system by exiting the dracut shell

                   # exit

       <b>Additional dracut boot parameters</b>

           For more debugging options, see <a href="../man7/dracut.cmdline.7.html">dracut.cmdline(7)</a>.

       <b>Debugging dracut on shutdown</b>

           To debug the shutdown sequence on systemd systems, you can
           <i>rd.break</i> on <i>pre-shutdown</i> or <i>shutdown</i>.

           To do this from an already booted system:

               # mkdir -p /run/initramfs/etc/cmdline.d
               # echo "rd.debug rd.break=pre-shutdown rd.break=shutdown" &gt; /run/initramfs/etc/cmdline.d/debug.conf
               # touch /run/initramfs/.need_shutdown

           This will give you a dracut shell after the system pivot’ed
           back in the initramfs.
</pre> <h2>
OPTIONS </h2>
<pre>
       <b>--kver </b><i>&lt;kernel version&gt;</i>
           Set the kernel version. This enables to specify the kernel
           version, without specifying the location of the initramfs
           image. For example:

           # dracut --kver 3.5.0-0.rc7.git1.2.fc18.x86_64

       <b>-f, --force</b>
           Overwrite existing initramfs file.

       <i>&lt;output file&gt;</i> <b>--rebuild</b>
           Append the current arguments to those with which the input
           initramfs image was built. This option helps in incrementally
           building the initramfs for testing. If optional <i>&lt;output file&gt;</i>
           is not provided, the input initramfs provided to rebuild will
           be used as output file.

       <b>-a, --add </b><i>&lt;list of dracut modules&gt;</i>
           Add a space-separated list of dracut modules to the default
           set of modules. This parameter can be specified multiple
           times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --add "module1 module2"  ...

       <b>--force-add </b><i>&lt;list of dracut modules&gt;</i>
           Force to add a space-separated list of dracut modules to the
           default set of modules, when -H is specified. This parameter
           can be specified multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --force-add "module1 module2"  ...

       <b>-o, --omit </b><i>&lt;list of dracut modules&gt;</i>
           Omit a space-separated list of dracut modules. This parameter
           can be specified multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --omit "module1 module2"  ...

       <b>-m, --modules </b><i>&lt;list of dracut modules&gt;</i>
           Specify a space-separated list of dracut modules to call when
           building the initramfs. Modules are located in
           <i>/usr/lib/dracut/modules.d</i>. This parameter can be specified
           multiple times. This option forces dracut to only include the
           specified dracut modules. In most cases the "--add" option is
           what you want to use.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --modules "module1 module2"  ...

       <b>-d, --drivers </b><i>&lt;list of kernel modules&gt;</i>
           Specify a space-separated list of kernel modules to
           exclusively include in the initramfs. The kernel modules have
           to be specified without the ".ko" suffix. This parameter can
           be specified multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --drivers "kmodule1 kmodule2"  ...

       <b>--add-drivers </b><i>&lt;list of kernel modules&gt;</i>
           Specify a space-separated list of kernel modules to add to
           the initramfs. The kernel modules have to be specified
           without the ".ko" suffix. This parameter can be specified
           multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --add-drivers "kmodule1 kmodule2"  ...

       <b>--force-drivers </b><i>&lt;list of kernel modules&gt;</i>
           See add-drivers above. But in this case it is ensured that
           the drivers are tried to be loaded early via modprobe.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --force-drivers "kmodule1 kmodule2"  ...

       <b>--omit-drivers </b><i>&lt;list of kernel modules&gt;</i>
           Specify a space-separated list of kernel modules not to add
           to the initramfs. The kernel modules have to be specified
           without the ".ko" suffix. This parameter can be specified
           multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --omit-drivers "kmodule1 kmodule2"  ...

       <b>--filesystems </b><i>&lt;list of filesystems&gt;</i>
           Specify a space-separated list of kernel filesystem modules
           to exclusively include in the generic initramfs. This
           parameter can be specified multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --filesystems "filesystem1 filesystem2"  ...

       <b>-k, --kmoddir </b><i>&lt;kernel directory&gt;</i>
           Specify the directory, where to look for kernel modules.

       <b>--fwdir </b><i>&lt;dir&gt;[:&lt;dir&gt;...]++</i>
           Specify additional directories, where to look for firmwares.
           This parameter can be specified multiple times.

       <b>--libdirs </b><i>&lt;list of directories&gt;</i>
           Specify a space-separated list of directories to look for
           libraries to include in the generic initramfs. This parameter
           can be specified multiple times.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --libdirs "dir1 dir2"  ...

       <b>--kernel-cmdline &lt;parameters&gt;</b>
           Specify default kernel command line parameters.

       <b>--kernel-only</b>
           Only install kernel drivers and firmware files.

       <b>--no-kernel</b>
           Do not install kernel drivers and firmware files.

       <b>--early-microcode</b>
           Combine early microcode with ramdisk.

       <b>--no-early-microcode</b>
           Do not combine early microcode with ramdisk.

       <b>--print-cmdline</b>
           Print the kernel command line for the current disk layout.

       <b>--mdadmconf</b>
           Include local <i>/etc/mdadm.conf</i> file.

       <b>--nomdadmconf</b>
           Do not include local <i>/etc/mdadm.conf</i> file.

       <b>--lvmconf</b>
           Include local <i>/etc/lvm/lvm.conf</i> file.

       <b>--nolvmconf</b>
           Do not include local <i>/etc/lvm/lvm.conf</i> file.

       <b>--fscks </b><i>&lt;list of fsck tools&gt;</i>
           Add a space-separated list of fsck tools, in addition to
           <i>dracut.conf</i>'s specification; the installation is
           opportunistic (non-existing tools are ignored).

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --fscks "fsck.foo barfsck"  ...

       <b>--nofscks</b>
           Inhibit installation of any fsck tools.

       <b>--strip</b>
           Strip binaries in the initramfs (default).

       <b>--aggressive-strip</b>
           Strip more than just debug symbol and sections, for a smaller
           initramfs build. The --strip option must also be specified.

       <b>--nostrip</b>
           Do not strip binaries in the initramfs.

       <b>--hardlink</b>
           Hardlink files in the initramfs (default).

       <b>--nohardlink</b>
           Do not hardlink files in the initramfs.

       <b>--prefix </b><i>&lt;dir&gt;</i>
           Prefix initramfs files with the specified directory.

       <b>--noprefix</b>
           Do not prefix initramfs files (default).

       <b>-h, --help</b>
           Display help text and exit.

       <b>--debug</b>
           Output debug information of the build process.

       <b>-v, --verbose</b>
           Increase verbosity level (default is info(4)).

       <b>--version</b>
           Display version and exit.

       <b>-q, --quiet</b>
           Decrease verbosity level (default is info(4)).

       <b>-c, --conf </b><i>&lt;dracut configuration file&gt;</i>
           Specify configuration file to use.

           Default: <i>/etc/dracut.conf</i>

       <b>--confdir </b><i>&lt;configuration directory&gt;</i>
           Specify configuration directory to use.

           Default: <i>/etc/dracut.conf.d</i>

       <b>--tmpdir </b><i>&lt;temporary directory&gt;</i>
           Specify temporary directory to use.

           Default: <i>/var/tmp</i>

       <b>-r, --sysroot </b><i>&lt;sysroot directory&gt;</i>
           Specify the sysroot directory to collect files from. This is
           useful to create the initramfs image from a cross-compiled
           sysroot directory. For the extra helper variables, see
           <b>ENVIRONMENT </b>below.

           Default: <i>empty</i>

       <b>--sshkey </b><i>&lt;sshkey file&gt;</i>
           SSH key file used with ssh-client module.

       <b>--logfile </b><i>&lt;logfile&gt;</i>
           Logfile to use; overrides any setting from the configuration
           files.

           Default: <i>/var/log/dracut.log</i>

       <b>-l, --local</b>
           Activates the local mode. dracut will use modules from the
           current working directory instead of the system-wide
           installed modules in <i>/usr/lib/dracut/modules.d</i>. This is
           useful when running dracut from a git checkout.

       <b>-H, --hostonly</b>
           Host-only mode: Install only what is needed for booting the
           local host instead of a generic host and generate
           host-specific configuration.

               <b>Warning</b>
               If chrooted to another root other than the real root
               device, use "--fstab" and provide a valid <i>/etc/fstab</i>.

       <b>-N, --no-hostonly</b>
           Disable host-only mode.

       <b>--hostonly-mode </b><i>&lt;mode&gt;</i>
           Specify the host-only mode to use.  <i>&lt;mode&gt;</i> could be one of
           "sloppy" or "strict". In "sloppy" host-only mode, extra
           drivers and modules will be installed, so minor hardware
           change won’t make the image unbootable (e.g. changed
           keyboard), and the image is still portable among similar
           hosts. With "strict" mode enabled, anything not necessary for
           booting the local host in its current state will not be
           included, and modules may do some extra job to save more
           space. Minor change of hardware or environment could make the
           image unbootable.

           Default: <i>sloppy</i>

       <b>--hostonly-cmdline</b>
           Store kernel command line arguments needed in the initramfs.

       <b>--no-hostonly-cmdline</b>
           Do not store kernel command line arguments needed in the
           initramfs.

       <b>--no-hostonly-default-device</b>
           Do not generate implicit host devices like root, swap, fstab,
           etc. Use "--mount" or "--add-device" to explicitly add
           devices as needed.

       <b>--hostonly-i18n</b>
           Install only needed keyboard and font files according to the
           host configuration (default).

       <b>--no-hostonly-i18n</b>
           Install all keyboard and font files available.

       <b>--hostonly-nics </b><i>&lt;list of nics&gt;</i>
           Only enable listed NICs in the initramfs. The list can be
           empty, so other modules can install only the necessary
           network drivers.

       <b>--persistent-policy </b><i>&lt;policy&gt;</i>
           Use <i>&lt;policy&gt;</i> to address disks and partitions.  <i>&lt;policy&gt;</i> can
           be any directory name found in /dev/disk (e.g. "by-uuid",
           "by-label"), or "mapper" to use /dev/mapper device names
           (default).

       <b>--fstab</b>
           Use <i>/etc/fstab</i> instead of <i>/proc/self/mountinfo</i>.

       <b>--add-fstab </b><i>&lt;filename&gt;</i>
           Add entries of <i>&lt;filename&gt;</i> to the initramfs /etc/fstab.

       <b>--mount </b>"<i>&lt;device&gt; &lt;mountpoint&gt; &lt;filesystem type&gt;</i> [<i>&lt;filesystem</i>
       <i>options&gt;</i> [<i>&lt;dump frequency&gt;</i> [<i>&lt;fsck order&gt;</i>]]]"
           Mount <i>&lt;device&gt;</i> on <i>&lt;mountpoint&gt;</i> with <i>&lt;filesystem type&gt;</i> in the
           initramfs.  <i>&lt;filesystem options&gt;</i>, <i>&lt;dump options&gt;</i> and <i>&lt;fsck</i>
           <i>order&gt;</i> can be specified, see fstab manpage for the details.
           The default <i>&lt;filesystem options&gt;</i> is "defaults". The default
           <i>&lt;dump frequency&gt;</i> is "0". The default <i>&lt;fsck order&gt;</i> is "2".

       <b>--mount </b>"<i>&lt;mountpoint&gt;</i>"
           Like above, but <i>&lt;device&gt;</i>, <i>&lt;filesystem type&gt;</i> and <i>&lt;filesystem</i>
           <i>options&gt;</i> are determined by looking at the current mounts.

       <b>--add-device </b><i>&lt;device&gt;</i>
           Bring up <i>&lt;device&gt;</i> in initramfs, <i>&lt;device&gt;</i> should be the device
           name. This can be useful in host-only mode for resume support
           when your swap is on LVM or an encrypted partition. [NB
           --device can be used for compatibility with earlier releases]

       <b>-i, --include </b><i>&lt;SOURCE&gt; &lt;TARGET&gt;</i>
           Include the files in the SOURCE directory into the TARGET
           directory in the final initramfs. If SOURCE is a file, it
           will be installed to TARGET in the final initramfs. This
           parameter can be specified multiple times.

       <b>-I, --install </b><i>&lt;file list&gt;</i>
           Install the space separated list of files into the initramfs.

               <b>Note</b>
               If the list has multiple arguments, then you have to put
               these in quotes. For example:

                   # dracut --install "/bin/foo /sbin/bar"  ...

       <b>--install-optional </b><i>&lt;file list&gt;</i>
           Install the space separated list of files into the initramfs,
           if they exist.

       <b>--gzip</b>
           Compress the generated initramfs using gzip. This will be
           done by default, unless another compression option or
           --no-compress is passed. Equivalent to "--compress=gzip -9".

       <b>--bzip2</b>
           Compress the generated initramfs using bzip2.

               <b>Warning</b>
               Make sure your kernel has bzip2 decompression support
               compiled in, otherwise you will not be able to boot.
               Equivalent to "--compress=bzip2 -9".

       <b>--lzma</b>
           Compress the generated initramfs using lzma.

               <b>Warning</b>
               Make sure your kernel has lzma decompression support
               compiled in, otherwise you will not be able to boot.
               Equivalent to "--compress=lzma -9 -T0".

       <b>--xz</b>
           Compress the generated initramfs using xz.

               <b>Warning</b>
               Make sure your kernel has xz decompression support
               compiled in, otherwise you will not be able to boot.
               Equivalent to "--compress=xz --check=crc32
               --lzma2=dict=1MiB -T0".

       <b>--lzo</b>
           Compress the generated initramfs using lzop.

               <b>Warning</b>
               Make sure your kernel has lzo decompression support
               compiled in, otherwise you will not be able to boot.
               Equivalent to "--compress=lzop -9".

       <b>--lz4</b>
           Compress the generated initramfs using lz4.

               <b>Warning</b>
               Make sure your kernel has lz4 decompression support
               compiled in, otherwise you will not be able to boot.
               Equivalent to "--compress=lz4 -l -9".

       <b>--zstd</b>
           Compress the generated initramfs using Zstandard.

               <b>Warning</b>
               Make sure your kernel has zstd decompression support
               compiled in, otherwise you will not be able to boot.
               Equivalent to "--compress=zstd -15 -q -T0".

       <b>--compress </b><i>&lt;compressor&gt;</i>
           Compress the generated initramfs using the passed compression
           program. If you pass it just the name of a compression
           program, it will call that program with known-working
           arguments. If you pass a quoted string with arguments, it
           will be called with exactly those arguments. Depending on
           what you pass, this may result in an initramfs that the
           kernel cannot decompress. The default value can also be set
           via the <i>INITRD_COMPRESS</i> environment variable.

       <b>--squash-compressor </b><i>&lt;compressor&gt;</i>
           Compress the squashfs image using the passed compressor and
           compressor specific options for mksquashfs. You can refer to
           mksquashfs manual for supported compressors and compressor
           specific options. If squash module is not called when
           building the initramfs, this option will not take effect.

       <b>--no-compress</b>
           Do not compress the generated initramfs. This will override
           any other compression options.

       <b>--reproducible</b>
           Create reproducible images.

       <b>--no-reproducible</b>
           Do not create reproducible images.

       <b>--list-modules</b>
           List all available dracut modules.

       <b>-M, --show-modules</b>
           Print included module’s name to standard output during build.

       <b>--keep</b>
           Keep the initramfs temporary directory for debugging
           purposes.

       <b>--printsize</b>
           Print out the module install size.

       <b>--profile</b>
           Output profile information of the build process.

       <b>--ro-mnt</b>
           Mount / and /usr read-only by default.

       <b>-L, --stdlog </b><i>&lt;level&gt;</i>
           [0-6] Specify logging level (to standard error).

                     0 - suppress any messages
                     1 - only fatal errors
                     2 - all errors
                     3 - warnings
                     4 - info
                     5 - debug info (here starts lots of output)
                     6 - trace info (and even more)

       <b>--regenerate-all</b>
           Regenerate all initramfs images at the default location with
           the kernel versions found on the system. Additional
           parameters are passed through.

       <b>-p, --parallel</b>
           Try to execute tasks in parallel. Currently only supported
           with <b>--regenerate-all </b>(build initramfs images for all kernel
           versions simultaneously).

       <b>--noimageifnotneeded</b>
           Do not create an image in host-only mode, if no kernel driver
           is needed and no /etc/cmdline/*.conf will be generated into
           the initramfs.

       <b>--loginstall </b><i>&lt;directory&gt;</i>
           Log all files installed from the host to <i>&lt;directory&gt;</i>.

       <b>--uefi</b>
           Instead of creating an initramfs image, dracut will create an
           UEFI executable, which can be executed by an UEFI BIOS. The
           default output filename is
           <i>&lt;EFI&gt;/EFI/Linux/linux-$kernel$-&lt;MACHINE_ID&gt;-&lt;BUILD_ID&gt;.efi</i>.
           &lt;EFI&gt; might be <i>/efi</i>, <i>/boot</i> or <i>/boot/efi</i> depending on where
           the ESP partition is mounted. The &lt;BUILD_ID&gt; is taken from
           BUILD_ID in <i>/usr/lib/os-release</i> or if it exists
           <i>/etc/os-release</i> and is left out, if BUILD_ID is non-existent
           or empty.

       <b>--no-uefi</b>
           Disables UEFI mode.

       <b>--no-machineid</b>
           Affects the default output filename of <b>--uefi </b>and will
           discard the &lt;MACHINE_ID&gt; part.

       <b>--uefi-stub </b><i>&lt;file&gt;</i>
           Specifies the UEFI stub loader, which will load the attached
           kernel, initramfs and kernel command line and boots the
           kernel. The default is
           <i>$prefix/lib/systemd/boot/efi/linux&lt;EFI-MACHINE-TYPE-NAME&gt;.efi.stub</i>.

       <b>--uefi-splash-image </b><i>&lt;file&gt;</i>
           Specifies the UEFI stub loader’s splash image. Requires
           bitmap (<b>.bmp</b>) image format.

       <b>--kernel-image </b><i>&lt;file&gt;</i>
           Specifies the kernel image, which to include in the UEFI
           executable. The default is
           <i>/lib/modules/&lt;KERNEL-VERSION&gt;/vmlinuz</i> or
           <i>/boot/vmlinuz-&lt;KERNEL-VERSION&gt;</i>.

       <b>--sbat &lt;parameters&gt;</b>
           Specifies the SBAT parameters, which to include in the UEFI
           executable. By default the default SBAT string added is
           "sbat,1,SBAT Version,sbat,1,
           <b><a href="https://github.com/rhboot/shim/blob/main/SBAT.md">https://github.com/rhboot/shim/blob/main/SBAT.md</a> </b>".

       <b>--enhanced-cpio</b>
           Attempt to use the dracut-cpio binary, which optimizes
           archive creation for copy-on-write filesystems by using the
           copy_file_range(2) syscall via Rust’s io::copy(). When
           specified, initramfs archives are also padded to ensure
           optimal data alignment for extent sharing. To retain reflink
           data deduplication benefits, this should be used alongside
           the <b>--no-compress </b>and <b>--nostrip </b>parameters, with initramfs
           source files, <b>--tmpdir </b>staging area and destination all on
           the same copy-on-write capable filesystem.
</pre> <h2>
ENVIRONMENT </h2>
<pre>
       <i>INITRD_COMPRESS</i>
           sets the default compression program. See <b>--compress</b>.

       <i>DRACUT_LDCONFIG</i>
           sets the <i>ldconfig</i> program path and options. Optional. Used
           for <b>--sysroot</b>.

           Default: <i>ldconfig</i>

       <i>DRACUT_LDD</i>
           sets the <i>ldd</i> program path and options. Optional. Used for
           <b>--sysroot</b>.

           Default: <i>ldd</i>

       <i>DRACUT_TESTBIN</i>
           sets the initially tested binary for detecting library paths.
           Optional. Used for <b>--sysroot</b>. In the cross-compiled sysroot,
           the default value (<i>/bin/sh</i>) is unusable, as it is an absolute
           symlink and points outside the sysroot directory.

           Default: <i>/bin/sh</i>

       <i>DRACUT_INSTALL</i>
           overrides path and options for executing <i>dracut-install</i>
           internally. Optional. Can be used to debug <i>dracut-install</i>
           while running the main dracut script.

           Default: <i>dracut-install</i>

           Example: DRACUT_INSTALL="valgrind dracut-install"

       <i>DRACUT_COMPRESS_BZIP2</i>, <i>DRACUT_COMPRESS_LBZIP2</i>,
       <i>DRACUT_COMPRESS_LZMA</i>, <i>DRACUT_COMPRESS_XZ</i>, <i>DRACUT_COMPRESS_GZIP</i>,
       <i>DRACUT_COMPRESS_PIGZ</i>, <i>DRACUT_COMPRESS_LZOP</i>, <i>DRACUT_COMPRESS_ZSTD</i>,
       <i>DRACUT_COMPRESS_LZ4</i>, <i>DRACUT_COMPRESS_CAT</i>
           overrides for compression utilities to support using them
           from non-standard paths.

           Default values are the default compression utility names to
           be found in <b>PATH</b>.

       <i>DRACUT_ARCH</i>
           overrides the value of <b>uname -m</b>. Used for <b>--sysroot</b>.

           Default: <i>empty</i> (the value of <b>uname -m </b>on the host system)

       <i>SYSTEMD_VERSION</i>
           overrides systemd version. Used for <b>--sysroot</b>.

       <i>SYSTEMCTL</i>
           overrides the systemctl binary. Used for <b>--sysroot</b>.

       <i>NM_VERSION</i>
           overrides the NetworkManager version. Used for <b>--sysroot</b>.

       <i>DRACUT_INSTALL_PATH</i>
           overrides <b>PATH </b>environment for <b>dracut-install </b>to look for
           binaries relative to <b>--sysroot</b>. In a cross-compiled
           environment (e.g. Yocto), PATH points to natively built
           binaries that are not in the host’s /bin, /usr/bin, etc.
           <b>dracut-install </b>still needs plain /bin and /usr/bin that are
           relative to the cross-compiled sysroot.

           Default: <i>PATH</i>

       <i>DRACUT_INSTALL_LOG_TARGET</i>
           overrides <b>DRACUT_LOG_TARGET </b>for <b>dracut-install</b>. It allows
           running <b>dracut-install* to run with different log target that</b>
           dracut** runs with.

           Default: <i>DRACUT_LOG_TARGET</i>

       <i>DRACUT_INSTALL_LOG_LEVEL</i>
           overrides <b>DRACUT_LOG_LEVEL </b>for <b>dracut-install</b>. It allows
           running <b>dracut-install* to run with different log level that</b>
           dracut** runs with.

           Default: <i>DRACUT_LOG_LEVEL</i>
</pre> <h2>
FILES </h2>
<pre>
       <i>/var/log/dracut.log</i>
           logfile of initramfs image creation

       <i>/tmp/dracut.log</i>
           logfile of initramfs image creation, if <i>/var/log/dracut.log</i>
           is not writable

       <i>/etc/dracut.conf</i>
           see dracut.conf5

       <i>/etc/dracut.conf.d/*.conf</i>
           see dracut.conf5

       <i>/usr/lib/dracut/dracut.conf.d/*.conf</i>
           see dracut.conf5

   <b>Configuration in the initramfs</b>
       <i>/etc/conf.d/</i>
           Any files found in <i>/etc/conf.d/</i> will be sourced in the
           initramfs to set initial values. Command line options will
           override these values set in the configuration files.

       <i>/etc/cmdline</i>
           Can contain additional command line options. Deprecated,
           better use /etc/cmdline.d/*.conf.

       <i>/etc/cmdline.d/*.conf</i>
           Can contain additional command line options.
</pre> <h2>
AVAILABILITY </h2>
<pre>
       The dracut command is part of the dracut package and is available
       from <b><a href="https://github.com/dracutdevs/dracut">https://github.com/dracutdevs/dracut</a> </b>
</pre> <h2>
AUTHORS </h2>
<pre>
       Harald Hoyer

       Victor Lowther

       Amadeusz Żołnowski

       Hannes Reinecke

       Daniel Molkentin

       Will Woods

       Philippe Seewer

       Warren Togami
</pre> <h2>
SEE ALSO </h2>
<pre>
       <a href="../man7/dracut.cmdline.7.html">dracut.cmdline(7)</a> <a href="../man5/dracut.conf.5.html">dracut.conf(5)</a> <a href="../man1/lsinitrd.1.html">lsinitrd(1)</a>
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>dracut</i> (event driven initramfs
       infrastructure) project.  Information about the project can be
       found at ⟨<a href="https://dracut.wiki.kernel.org/index.php/Main_Page">https://dracut.wiki.kernel.org/index.php/Main_Page</a>⟩.
       If you have a bug report for this manual page, send it to
       initramfs@vger.kernel.org.  This page was obtained from the
       project's upstream Git repository
       ⟨<a href="https://github.com/dracutdevs/dracut.git">https://github.com/dracutdevs/dracut.git</a>⟩ on 2024-06-14.  (At
       that time, the date of the most recent commit that was found in
       the repository was 2024-03-21.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">dracut 059-204-g6acfecae       09/13/2023                      <i>DRACUT</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="../man1/lsinitrd.1.html">lsinitrd(1)</a>, <a href="../man5/dracut.conf.5.html">dracut.conf(5)</a>, <a href="../man7/dracut.bootup.7.html">dracut.bootup(7)</a>, <a href="../man7/dracut.cmdline.7.html">dracut.cmdline(7)</a>, <a href="../man7/dracut.modules.7.html">dracut.modules(7)</a>, <a href="dracut-catimages.8.html">dracut-catimages(8)</a>, <a href="systemd-network-generator.service.8.html">systemd-network-generator.service(8)</a>, <a href="systemtap-service.8.html">systemtap-service(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/dracut.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/dracut.8.html</a>
  </p>
</div>
