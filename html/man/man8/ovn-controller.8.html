<h1>ovn-controller(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>ovn-controller</i>(8)              OVN Manual              <i>ovn-controller</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       ovn-controller - Open Virtual Network local controller
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>ovn-controller </b>[<i>options</i>] [<i>ovs-database</i>]
</pre> <h2>
DESCRIPTION </h2>
<pre>
       <b>ovn-controller </b>is the local controller daemon for OVN, the Open
       Virtual Network. It connects up to the OVN Southbound database
       (see <a href="../man5/ovn-sb.5.html">ovn-sb(5)</a>) over the OVSDB protocol, and down to the Open
       vSwitch database (see <a href="../man5/ovs-vswitchd.conf.db.5.html">ovs-vswitchd.conf.db(5)</a>) over the OVSDB
       protocol and to <a href="ovs-vswitchd.8.html">ovs-vswitchd(8)</a> via OpenFlow. Each hypervisor and
       software gateway in an OVN deployment runs its own independent
       copy of <b>ovn-controller</b>; thus, <b>ovn-controller</b>’s downward
       connections are machine-local and do not run over a physical
       network.
</pre> <h2>
ACL LOGGING </h2>
<pre>
       ACL log messages are logged through <b>ovn-controller</b>’s logging
       mechanism. ACL log entries have the module <b>acl_log </b>at log level
       <b>info</b>. Configuring logging is described below in the <b>Logging</b>
       <b>Options </b>section.
</pre> <h2>
OPTIONS </h2>
<pre>
   <b>Daemon Options</b>
       <b>--pidfile</b>[<b>=</b><i>pidfile</i>]
              Causes a file (by default, <i>program</i><b>.pid</b>) to be created
              indicating the PID of the running process. If the <i>pidfile</i>
              argument is not specified, or if it does not begin with <b>/</b>,
              then it is created in .

              If <b>--pidfile </b>is not specified, no pidfile is created.

       <b>--overwrite-pidfile</b>
              By default, when <b>--pidfile </b>is specified and the specified
              pidfile already exists and is locked by a running process,
              the daemon refuses to start. Specify <b>--overwrite-pidfile</b>
              to cause it to instead overwrite the pidfile.

              When <b>--pidfile </b>is not specified, this option has no
              effect.

       <b>--detach</b>
              Runs this program as a background process. The process
              forks, and in the child it starts a new session, closes
              the standard file descriptors (which has the side effect
              of disabling logging to the console), and changes its
              current directory to the root (unless <b>--no-chdir </b>is
              specified). After the child completes its initialization,
              the parent exits.

       <b>--monitor</b>
              Creates an additional process to monitor this program. If
              it dies due to a signal that indicates a programming error
              (<b>SIGABRT</b>, <b>SIGALRM</b>, <b>SIGBUS</b>, <b>SIGFPE</b>, <b>SIGILL</b>, <b>SIGPIPE</b>,
              <b>SIGSEGV</b>, <b>SIGXCPU</b>, or <b>SIGXFSZ</b>) then the monitor process
              starts a new copy of it. If the daemon dies or exits for
              another reason, the monitor process exits.

              This option is normally used with <b>--detach</b>, but it also
              functions without it.

       <b>--no-chdir</b>
              By default, when <b>--detach </b>is specified, the daemon changes
              its current working directory to the root directory after
              it detaches. Otherwise, invoking the daemon from a
              carelessly chosen directory would prevent the
              administrator from unmounting the file system that holds
              that directory.

              Specifying <b>--no-chdir </b>suppresses this behavior, preventing
              the daemon from changing its current working directory.
              This may be useful for collecting core files, since it is
              common behavior to write core dumps into the current
              working directory and the root directory is not a good
              directory to use.

              This option has no effect when <b>--detach </b>is not specified.

       <b>--no-self-confinement</b>
              By default this daemon will try to self-confine itself to
              work with files under well-known directories determined at
              build time. It is better to stick with this default
              behavior and not to use this flag unless some other Access
              Control is used to confine daemon. Note that in contrast
              to other access control implementations that are typically
              enforced from kernel-space (e.g. DAC or MAC), self-
              confinement is imposed from the user-space daemon itself
              and hence should not be considered as a full confinement
              strategy, but instead should be viewed as an additional
              layer of security.

       <b>--user=</b><i>user</i><b>:</b><i>group</i>
              Causes this program to run as a different user specified
              in <i>user</i><b>:</b><i>group</i>, thus dropping most of the root privileges.
              Short forms <i>user</i> and <b>:</b><i>group</i> are also allowed, with current
              user or group assumed, respectively. Only daemons started
              by the root user accepts this argument.

              On Linux, daemons will be granted <b>CAP_IPC_LOCK </b>and
              <b>CAP_NET_BIND_SERVICES </b>before dropping root privileges.
              Daemons that interact with a datapath, such as
              <b>ovs-vswitchd</b>, will be granted three additional
              capabilities, namely <b>CAP_NET_ADMIN</b>, <b>CAP_NET_BROADCAST </b>and
              <b>CAP_NET_RAW</b>. The capability change will apply even if the
              new user is root.

              On Windows, this option is not currently supported. For
              security reasons, specifying this option will cause the
              daemon process not to start.

   <b>Logging Options</b>
       <b>-v</b>[<i>spec</i>]
       <b>--verbose=</b>[<i>spec</i>]
            Sets logging levels. Without any <i>spec</i>, sets the log level
            for every module and destination to <b>dbg</b>. Otherwise, <i>spec</i> is
            a list of words separated by spaces or commas or colons, up
            to one from each category below:

            •      A valid module name, as displayed by the <b>vlog/list</b>
                   command on <a href="ovs-appctl.8.html">ovs-appctl(8)</a>, limits the log level change
                   to the specified module.

            •      <b>syslog</b>, <b>console</b>, or <b>file</b>, to limit the log level
                   change to only to the system log, to the console, or
                   to a file, respectively. (If <b>--detach </b>is specified,
                   the daemon closes its standard file descriptors, so
                   logging to the console will have no effect.)

                   On Windows platform, <b>syslog </b>is accepted as a word and
                   is only useful along with the <b>--syslog-target </b>option
                   (the word has no effect otherwise).

            •      <b>off</b>, <b>emer</b>, <b>err</b>, <b>warn</b>, <b>info</b>, or <b>dbg</b>, to control the
                   log level. Messages of the given severity or higher
                   will be logged, and messages of lower severity will
                   be filtered out. <b>off </b>filters out all messages. See
                   <a href="ovs-appctl.8.html">ovs-appctl(8)</a> for a definition of each log level.

            Case is not significant within <i>spec</i>.

            Regardless of the log levels set for <b>file</b>, logging to a file
            will not take place unless <b>--log-file </b>is also specified (see
            below).

            For compatibility with older versions of OVS, <b>any </b>is
            accepted as a word but has no effect.

       <b>-v</b>
       <b>--verbose</b>
            Sets the maximum logging verbosity level, equivalent to
            <b>--verbose=dbg</b>.

       <b>-vPATTERN:</b><i>destination</i><b>:</b><i>pattern</i>
       <b>--verbose=PATTERN:</b><i>destination</i><b>:</b><i>pattern</i>
            Sets the log pattern for <i>destination</i> to <i>pattern</i>. Refer to
            <a href="ovs-appctl.8.html">ovs-appctl(8)</a> for a description of the valid syntax for
            <i>pattern</i>.

       <b>-vFACILITY:</b><i>facility</i>
       <b>--verbose=FACILITY:</b><i>facility</i>
            Sets the RFC5424 facility of the log message. <i>facility</i> can
            be one of <b>kern</b>, <b>user</b>, <b>mail</b>, <b>daemon</b>, <b>auth</b>, <b>syslog</b>, <b>lpr</b>, <b>news</b>,
            <b>uucp</b>, <b>clock</b>, <b>ftp</b>, <b>ntp</b>, <b>audit</b>, <b>alert</b>, <b>clock2</b>, <b>local0</b>, <b>local1</b>,
            <b>local2</b>, <b>local3</b>, <b>local4</b>, <b>local5</b>, <b>local6 </b>or <b>local7</b>. If this
            option is not specified, <b>daemon </b>is used as the default for
            the local system syslog and <b>local0 </b>is used while sending a
            message to the target provided via the <b>--syslog-target</b>
            option.

       <b>--log-file</b>[<b>=</b><i>file</i>]
            Enables logging to a file. If <i>file</i> is specified, then it is
            used as the exact name for the log file. The default log
            file name used if <i>file</i> is omitted is
            <b>/usr/local/var/log/ovn/</b><i>program</i><b>.log</b>.

       <b>--syslog-target=</b><i>host</i><b>:</b><i>port</i>
            Send syslog messages to UDP <i>port</i> on <i>host</i>, in addition to the
            system syslog. The <i>host</i> must be a numerical IP address, not
            a hostname.

       <b>--syslog-method=</b><i>method</i>
            Specify <i>method</i> as how syslog messages should be sent to
            syslog daemon. The following forms are supported:

            •      <b>libc</b>, to use the libc <b>syslog() </b>function. Downside of
                   using this options is that libc adds fixed prefix to
                   every message before it is actually sent to the
                   syslog daemon over <b>/dev/log </b>UNIX domain socket.

            •      <b>unix:</b><i>file</i>, to use a UNIX domain socket directly. It
                   is possible to specify arbitrary message format with
                   this option. However, <b>rsyslogd 8.9 </b>and older versions
                   use hard coded parser function anyway that limits
                   UNIX domain socket use. If you want to use arbitrary
                   message format with older <b>rsyslogd </b>versions, then use
                   UDP socket to localhost IP address instead.

            •      <b>udp:</b><i>ip</i><b>:</b><i>port</i>, to use a UDP socket. With this method it
                   is possible to use arbitrary message format also with
                   older <b>rsyslogd</b>. When sending syslog messages over UDP
                   socket extra precaution needs to be taken into
                   account, for example, syslog daemon needs to be
                   configured to listen on the specified UDP port,
                   accidental iptables rules could be interfering with
                   local syslog traffic and there are some security
                   considerations that apply to UDP sockets, but do not
                   apply to UNIX domain sockets.

            •      <b>null</b>, to discard all messages logged to syslog.

            The default is taken from the <b>OVS_SYSLOG_METHOD </b>environment
            variable; if it is unset, the default is <b>libc</b>.

   <b>PKI Options</b>
       PKI configuration is required in order to use SSL for the
       connections to the Northbound and Southbound databases.

              <b>-p </b><i>privkey.pem</i>
              <b>--private-key=</b><i>privkey.pem</i>
                   Specifies a PEM file containing the private key used
                   as identity for outgoing SSL connections.

              <b>-c </b><i>cert.pem</i>
              <b>--certificate=</b><i>cert.pem</i>
                   Specifies a PEM file containing a certificate that
                   certifies the private key specified on <b>-p </b>or
                   <b>--private-key </b>to be trustworthy. The certificate must
                   be signed by the certificate authority (CA) that the
                   peer in SSL connections will use to verify it.

              <b>-C </b><i>cacert.pem</i>
              <b>--ca-cert=</b><i>cacert.pem</i>
                   Specifies a PEM file containing the CA certificate
                   for verifying certificates presented to this program
                   by SSL peers. (This may be the same certificate that
                   SSL peers use to verify the certificate specified on
                   <b>-c </b>or <b>--certificate</b>, or it may be a different one,
                   depending on the PKI design in use.)

              <b>-C none</b>
              <b>--ca-cert=none</b>
                   Disables verification of certificates presented by
                   SSL peers. This introduces a security risk, because
                   it means that certificates cannot be verified to be
                   those of known trusted hosts.

              <b>--bootstrap-ca-cert=</b><i>cacert.pem</i>
                     When <i>cacert.pem</i> exists, this option has the same
                     effect as <b>-C </b>or <b>--ca-cert</b>. If it does not exist,
                     then the executable will attempt to obtain the CA
                     certificate from the SSL peer on its first SSL
                     connection and save it to the named PEM file. If it
                     is successful, it will immediately drop the
                     connection and reconnect, and from then on all SSL
                     connections must be authenticated by a certificate
                     signed by the CA certificate thus obtained.

                     This option exposes the SSL connection to a man-in-
                     the-middle attack obtaining the initial CA
                     certificate, but it may be useful for
                     bootstrapping.

                     This option is only useful if the SSL peer sends
                     its CA certificate as part of the SSL certificate
                     chain. The SSL protocol does not require the server
                     to send the CA certificate.

                     This option is mutually exclusive with <b>-C </b>and
                     <b>--ca-cert</b>.

              <b>--peer-ca-cert=</b><i>peer-cacert.pem</i>
                     Specifies a PEM file that contains one or more
                     additional certificates to send to SSL peers. <i>peer-</i>
                     <i>cacert.pem</i> should be the CA certificate used to
                     sign the program’s own certificate, that is, the
                     certificate specified on <b>-c </b>or <b>--certificate</b>. If
                     the program’s certificate is self-signed, then
                     <b>--certificate </b>and <b>--peer-ca-cert </b>should specify the
                     same file.

                     This option is not useful in normal operation,
                     because the SSL peer must already have the CA
                     certificate for the peer to have any confidence in
                     the program’s identity. However, this offers a way
                     for a new installation to bootstrap the CA
                     certificate on its first SSL connection.

   <b>Other Options</b>
       <b>-h</b>
       <b>--help</b>
            Prints a brief help message to the console.

       <b>-V</b>
       <b>--version</b>
            Prints version information to the console.
</pre> <h2>
CONFIGURATION </h2>
<pre>
       <b>ovn-controller </b>retrieves most of its configuration information
       from the local Open vSwitch’s ovsdb-server instance. The default
       location is <b>db.sock </b>in the local Open vSwitch’s "run" directory.
       It may be overridden by specifying the <i>ovs-database</i> argument as
       an OVSDB active or passive connection method, as described in
       <a href="../man7/ovsdb.7.html">ovsdb(7)</a>.

       <b>ovn-controller </b>assumes it gets configuration information from the
       following keys in the <b>Open_vSwitch </b>table of the local OVS
       instance:

              <b>external_ids:system-id</b>
                     The chassis name to use in the Chassis table.
                     Changing the <b>system-id </b>while <b>ovn-controller </b>is
                     running is not directly supported. Users have two
                     options: either first gracefully stop
                     <b>ovn-controller </b>or manually delete the stale <b>Chassis</b>
                     and <b>Chassis_Private </b>records after changing the
                     <b>system-id</b>. Note that the chassis name can also be
                     provided via the <b>system-id-override </b>file in the
                     local OVN "etc" directory or via the <b>-n </b>command-
                     line option. The following precedence is used:
                     first, the command-line option is read; if not
                     present, the <b>system-id-override </b>file is read; if
                     not present, then the name configured in the
                     database is used.

              <b>external_ids:hostname</b>
                     The hostname to use in the Chassis table.

              <b>external_ids:ovn-bridge</b>
                     The integration bridge to which logical ports are
                     attached. The default is <b>br-int</b>. If this bridge
                     does not exist when ovn-controller starts, it will
                     be created automatically with the default
                     configuration suggested in <a href="../man7/ovn-architecture.7.html">ovn-architecture(7)</a>.
                     When more than one controllers are running on the
                     same host, <b>external_ids:ovn-bridge-CHASSIS_NAME</b>
                     should be set for each of them, pointing to a
                     unique bridge. This is required to avoid
                     controllers stepping on each others’ feet.

              <b>external_ids:ovn-bridge-datapath-type</b>
                     This configuration is optional. If set, then the
                     datapath type of the integration bridge will be set
                     to the configured value. If this option is not set,
                     then <b>ovn-controller </b>will not modify the existing
                     <b>datapath-type </b>of the integration bridge.

              <b>external_ids:ovn-remote</b>
                     The OVN database that this system should connect to
                     for its configuration, in one of the same forms
                     documented above for the <i>ovs-database</i>.

              <b>external_ids:ovn-monitor-all</b>
                     A boolean value that tells if <b>ovn-controller </b>should
                     monitor all records of tables in <i>ovs-database</i>. If
                     set to <b>false</b>, it will conditionally monitor the
                     records that is needed in the current chassis.

                     It is more efficient to set it to <b>true </b>in use cases
                     where the chassis would anyway need to monitor most
                     of the records in <i>OVN Southbound</i> database, which
                     would save the overhead of conditions processing,
                     especially for server side. Typically, set it to
                     <b>true </b>for environments that all workloads need to be
                     reachable from each other.

                     NOTE: for efficiency and scalability in common
                     scenarios <b>ovn-controller </b>unconditionally monitors
                     all sub-ports (ports with <b>parent_port </b>set)
                     regardless of the <b>ovn-monitor-all </b>value.

                     Default value is <i>false</i>.

              <b>external_ids:ovn-remote-probe-interval</b>
                     The inactivity probe interval of the connection to
                     the OVN database, in milliseconds. If the value is
                     zero, it disables the connection keepalive feature.

                     If the value is nonzero, then it will be forced to
                     a value of at least 1000 ms.

              <b>external_ids:ovn-encap-type</b>
                     The encapsulation type that a chassis should use to
                     connect to this node. Multiple encapsulation types
                     may be specified with a comma-separated list. Each
                     listed encapsulation type will be paired with
                     <b>ovn-encap-ip</b>.

                     Supported tunnel types for connecting hypervisors
                     and gateways are <b>geneve</b>, <b>vxlan</b>, and <b>stt</b>.

                     Due to the limited amount of metadata in <b>vxlan</b>, the
                     capabilities and performance of connected gateways
                     and hypervisors will be reduced versus other tunnel
                     formats.

              <b>external_ids:ovn-encap-ip</b>
                     The IP address that a chassis should use to connect
                     to this node using encapsulation types specified by
                     <b>external_ids:ovn-encap-type</b>. Multiple encapsulation
                     IPs may be specified with a comma-separated list.

                     In scenarios where multiple encapsulation IPs are
                     present, distinct tunnels are established for each
                     remote chassis. These tunnels are differentiated by
                     setting unique <b>options:local_ip </b>and
                     <b>options:remote_ip </b>values in the tunnel interface.
                     When transmitting a packet to a remote chassis, the
                     selection of local_ip is guided by the
                     <b>Interface:external_ids:encap-ip </b>from the local
                     OVSDB, corresponding to the VIF originating the
                     packet, if specified. The
                     <b>Interface:external_ids:encap-ip </b>setting of the VIF
                     is also populated to the <b>Port_Binding </b>table in the
                     OVN SB database via the <b>encap </b>column. Consequently,
                     when a remote chassis needs to send a packet to a
                     port-binding associated with this VIF, it utilizes
                     the tunnel with the appropriate <b>options:remote_ip</b>
                     that matches the <b>ip </b>in <b>Port_Binding:encap</b>. This
                     mechanism is particularly beneficial for chassis
                     with multiple physical interfaces designated for
                     tunneling, where each interface is optimized for
                     handling specific traffic associated with
                     particular VIFs.

              <b>external_ids:ovn-encap-df_default</b>
                     indicates the DF flag handling of the encapulation.
                     Set to <b>true </b>to set the DF flag for new data paths
                     or <b>false </b>to clear the DF flag.

              <b>external_ids:ovn-bridge-mappings</b>
                     A list of key-value pairs that map a physical
                     network name to a local ovs bridge that provides
                     connectivity to that network. An example value
                     mapping two physical network names to two ovs
                     bridges would be:
                     <b>physnet1:br-eth0,physnet2:br-eth1</b>.

              <b>external_ids:ovn-encap-csum</b>
                     <b>ovn-encap-csum </b>indicates that encapsulation
                     checksums can be transmitted and received with
                     reasonable performance. It is a hint to senders
                     transmitting data to this chassis that they should
                     use checksums to protect OVN metadata. Set to <b>true</b>
                     to enable or <b>false </b>to disable. Depending on the
                     capabilities of the network interface card,
                     enabling encapsulation checksum may incur
                     performance loss. In such cases, encapsulation
                     checksums can be disabled.

              <b>external_ids:ovn-encap-tos</b>
                     <b>ovn-encap-tos </b>indicates the value to be applied to
                     OVN tunnel interface’s option:tos as specified in
                     the Open_vSwitch database Interface table. Please
                     refer to Open VSwitch Manual for details.

              <b>external_ids:ovn-cms-options</b>
                     A list of options that will be consumed by the CMS
                     Plugin and which specific to this particular
                     chassis. An example would be:
                     <b>cms_option1,cms_option2:foo</b>.

              <b>external_ids:ovn-transport-zones</b>
                     The transport zone(s) that this chassis belongs to.
                     Transport zones is a way to group different chassis
                     so that tunnels are only formed between members of
                     the same group(s). Multiple transport zones may be
                     specified with a comma-separated list. For example:
                     tz1,tz2,tz3.

                     If not set, the Chassis will be considered part of
                     a default transport zone.

              <b>external_ids:ovn-chassis-mac-mappings</b>
                     A list of key-value pairs that map a chassis
                     specific mac to a physical network name. An example
                     value mapping two chassis macs to two physical
                     network names would be:
                     <b>physnet1:aa:bb:cc:dd:ee:ff,physnet2:a1:b2:c3:d4:e5:f6</b>.
                     These are the macs that ovn-controller will replace
                     a router port mac with, if packet is going from a
                     distributed router port on vlan type logical
                     switch.

              <b>external_ids:ovn-is-interconn</b>
                     The boolean flag indicates if the chassis is used
                     as an interconnection gateway.

              <b>external_ids:ovn-match-northd-version</b>
                     The boolean flag indicates if <b>ovn-controller </b>needs
                     to check <b>ovn-northd </b>version. If this flag is set to
                     true and the <b>ovn-northd’s </b>version (reported in the
                     Southbound database) doesn’t match with the
                     <b>ovn-controller’s </b>internal version, then it will
                     stop processing the southbound and local Open
                     vSwitch database changes. The default value is
                     considered false if this option is not defined.

              <b>external_ids:ovn-ofctrl-wait-before-clear</b>
                     The time, in milliseconds, to wait before clearing
                     flows in OVS after OpenFlow connection/reconnection
                     during <b>ovn-controller </b>initialization. The purpose
                     of this wait is to give time for <b>ovn-controller </b>to
                     compute the new flows before clearing existing
                     ones, to avoid data plane down time during
                     <b>ovn-controller </b>restart/upgrade at large scale
                     environments where recomputing the flows takes more
                     than a few seconds or even longer. It is difficult
                     for <b>ovn-controller </b>to determine when the new flows
                     computing is completed, because of the dynamics in
                     the cloud environments, which is why this
                     configuration is provided for users to adjust based
                     on the scale of the environment. By default, it is
                     0, which means clearing existing flows without
                     waiting. Not setting the value, or setting it too
                     small, may result in data plane down time during
                     upgrade/restart, while setting it too big may
                     result in unnecessary extra control plane latency
                     of applying new changes of CMS during
                     upgrade/restart. In most cases, a slightly bigger
                     value is not harmful, because the extra control
                     plane latency happens only once during the OpenFlow
                     connection. To get a reasonable range of the value
                     setting, it is recommended to run the below
                     commands on a node in the target environment and
                     then set this configuration to twice the value of
                     <b>Maximum </b>shown in the output of the second command.

                     •      <b>ovn-appctl -t ovn-controller</b>
                            <b>inc-engine/recompute</b>

                     •      <b>ovn-appctl -t ovn-controller stopwatch/show</b>
                            <b>flow-generation</b>

              <b>external_ids:ovn-enable-lflow-cache</b>
                     The boolean flag indicates if <b>ovn-controller </b>should
                     enable/disable the logical flow in-memory cache it
                     uses when processing Southbound database logical
                     flow changes. By default caching is enabled.

              <b>external_ids:ovn-limit-lflow-cache</b>
                     When used, this configuration value determines the
                     maximum number of logical flow cache entries
                     <b>ovn-controller </b>may create when the logical flow
                     cache is enabled. By default the size of the cache
                     is unlimited.

              <b>external_ids:ovn-memlimit-lflow-cache-kb</b>
                     When used, this configuration value determines the
                     maximum size of the logical flow cache (in KB)
                     <b>ovn-controller </b>may create when the logical flow
                     cache is enabled. By default the size of the cache
                     is unlimited.

              <b>external_ids:ovn-trim-limit-lflow-cache</b>
                     When used, this configuration value sets the
                     minimum number of entries in the logical flow cache
                     starting with which automatic memory trimming is
                     performed. By default this is set to 10000 entries.

              <b>external_ids:ovn-trim-wmark-perc-lflow-cache</b>
                     When used, this configuration value sets the
                     percentage from the high watermark number of
                     entries in the logical flow cache under which
                     automatic memory trimming is performed. E.g., if
                     the trim watermark percentage is set to 50%,
                     automatic memory trimming happens only when the
                     number of entries in the logical flow cache gets
                     reduced to less than half of the last measured high
                     watermark. By default this is set to 50.

              <b>external_ids:ovn-trim-timeout-ms</b>
                     When used, this configuration value specifies the
                     time, in milliseconds, since the last logical flow
                     cache operation after which <b>ovn-controller </b>performs
                     memory trimming regardless of how many entries
                     there are in the cache. By default this is set to
                     30000 (30 seconds).

              <b>external_ids:garp-max-timeout-sec</b>
                     When used, this configuration value specifies the
                     maximum timeout (in seconds) between two
                     consecutive GARP packets sent by <b>ovn-controller</b>.
                     <b>ovn-controller </b>by default sends just 4 GARP packets
                     with an exponential backoff timeout. Setting
                     <b>external_ids:garp-max-timeout-sec </b>allows to cap for
                     the exponential backoff used by <b>ovn-controller </b>to
                     send GARPs packets.

              <b>external_ids:ovn-bridge-remote</b>
                     Connection to the OVN management bridge in OvS. It
                     defaults to <b>unix:</b><i>br-int</i><b>.mgmt </b>when not specified.

              <b>external_ids:ovn-bridge-remote-probe-interval</b>
                     The inactivity probe interval of the connection to
                     the OVN management bridge, in milliseconds. It
                     defaults to zero. If the value is zero, it disables
                     the inactivity probe.

       Most of configuration options listed above can also be set for a
       particular chassis name (see <b>external_ids:system-id  </b>for more
       information). This can be achieved by setting
       <b>external_ids:option-[chassis] </b>instead of <b>external_ids:option</b>. For
       example, set <b>external_ids:ovn-encap-ip-otherhv </b>to use a
       particular IP address for the controller instance named <b>otherhv</b>.
       Name specific configuration options always override any global
       options set in the database.

       Chassis-specific configuration options in the database plus the
       ability to configure the chassis name to use via the
       <b>system-id-override </b>file or command line allows to run multiple
       <b>ovn-controller </b>instances with unique chassis names on the same
       host using the same <b>vswitchd </b>instance. This may be useful when
       running a hybrid setup with more than one CMS managing ports on
       the host, or to use different datapath types on the same host.
       Also note that this ability is highly experimental and has known
       limitations (for example, stateful ACLs are not supported). Use
       at your own risk.

       <b>ovn-controller </b>reads the following values from the <b>Open_vSwitch</b>
       database of the local OVS instance:

              <b>datapath-type </b>from <b>Bridge </b>table
                     This value is read from local OVS integration
                     bridge row of <b>Bridge </b>table and populated in
                     <b>other_config:datapath-type </b>of the <b>Chassis </b>table in
                     the OVN_Southbound database.

              <b>iface-types </b>from <b>Open_vSwitch </b>table
                     This value is populated in <b>external_ids:iface-types</b>
                     of the <b>Chassis </b>table in the OVN_Southbound
                     database.

              <b>private_key</b>, <b>certificate</b>, <b>ca_cert</b>, and <b>bootstrap_ca_cert</b>
              from <b>SSL </b>table
                     These values provide the SSL configuration used for
                     connecting to the OVN southbound database server
                     when an SSL connection type is configured via
                     <b>external_ids:ovn-remote</b>. Note that this SSL
                     configuration can also be provided via command-line
                     options, the configuration in the database takes
                     precedence if both are present.
</pre> <h2>
OPEN VSWITCH DATABASE USAGE </h2>
<pre>
       <b>ovn-controller </b>uses a number of <b>external_ids </b>keys in the Open
       vSwitch database to keep track of ports and interfaces. For
       proper operation, users should not change or clear these keys:

              <b>external_ids:ovn-chassis-id </b>in the <b>Port </b>table
                     The presence of this key identifies a tunnel port
                     within the integration bridge as one created by
                     <b>ovn-controller </b>to reach a remote chassis. Its value
                     is the chassis ID of the remote chassis.

              <b>external_ids:ct-zone-* </b>in the <b>Bridge </b>table
                     Logical ports and gateway routers are assigned a
                     connection tracking zone by <b>ovn-controller </b>for
                     stateful services. To keep state across restarts of
                     <b>ovn-controller</b>, these keys are stored in the
                     integration bridge’s Bridge table. The name
                     contains a prefix of <b>ct-zone- </b>followed by the name
                     of the logical port or gateway router’s zone key.
                     The value for this key identifies the zone used for
                     this port.

              <b>external_ids:ovn-localnet-port </b>in the <b>Port </b>table
                     The presence of this key identifies a patch port as
                     one created by <b>ovn-controller </b>to connect the
                     integration bridge and another bridge to implement
                     a <b>localnet </b>logical port. Its value is the name of
                     the logical port with <b>type </b>set to <b>localnet </b>that the
                     port implements. See
                     <b>external_ids:ovn-bridge-mappings</b>, above, for more
                     information.

                     Each <b>localnet </b>logical port is implemented as a pair
                     of patch ports, one in the integration bridge, one
                     in a different bridge, with the same
                     <b>external_ids:ovn-localnet-port </b>value.

              <b>external_ids:ovn-l2gateway-port </b>in the <b>Port </b>table
                     The presence of this key identifies a patch port as
                     one created by <b>ovn-controller </b>to connect the
                     integration bridge and another bridge to implement
                     a <b>l2gateway </b>logical port. Its value is the name of
                     the logical port with <b>type </b>set to <b>l2gateway </b>that
                     the port implements. See
                     <b>external_ids:ovn-bridge-mappings</b>, above, for more
                     information.

                     Each <b>l2gateway </b>logical port is implemented as a
                     pair of patch ports, one in the integration bridge,
                     one in a different bridge, with the same
                     <b>external_ids:ovn-l2gateway-port </b>value.

              <b>external-ids:ovn-l3gateway-port </b>in the <b>Port </b>table
                     This key identifies a patch port as one created by
                     <b>ovn-controller </b>to implement a <b>l3gateway </b>logical
                     port. Its value is the name of the logical port
                     with type set to <b>l3gateway</b>. This patch port is
                     similar to the OVN logical patch port, except that
                     <b>l3gateway </b>port can only be bound to a particular
                     chassis.

              <b>external-ids:ovn-logical-patch-port </b>in the <b>Port </b>table
                     This key identifies a patch port as one created by
                     <b>ovn-controller </b>to implement an OVN logical patch
                     port within the integration bridge. Its value is
                     the name of the OVN logical patch port that it
                     implements.

              <b>external-ids:ovn-startup-ts </b>in the <b>Bridge </b>table
                     This key represents the timestamp (in milliseconds)
                     at which <b>ovn-controller </b>process was started.

              <b>external-ids:ovn-nb-cfg </b>in the <b>Bridge </b>table
                     This key represents the last known
                     <b>OVN_Southbound.SB_Global.nb_cfg </b>value for which all
                     flows have been successfully installed in OVS.

              <b>external-ids:ovn-nb-cfg-ts </b>in the <b>Bridge </b>table
                     This key represents the timestamp (in milliseconds)
                     of the last known <b>OVN_Southbound.SB_Global.nb_cfg</b>
                     value for which all flows have been successfully
                     installed in OVS.

              <b>external_ids:ovn-installed </b>and
              <b>external_ids:ovn-installed-ts </b>in the <b>Interface </b>table
                     This key is set after all openflow operations
                     corresponding to the OVS interface have been
                     processed by ovs-vswitchd. At the same time a
                     timestamp, in milliseconds since the epoch, is
                     stored in <b>external_ids:ovn-installed-ts</b>.
</pre> <h2>
OVN SOUTHBOUND DATABASE USAGE </h2>
<pre>
       <b>ovn-controller </b>reads from much of the <b>OVN_Southbound </b>database to
       guide its operation. <b>ovn-controller </b>also writes to the following
       tables:

              <b>Chassis</b>
                     Upon startup, <b>ovn-controller </b>creates a row in this
                     table to represent its own chassis. Upon graceful
                     termination, e.g. with <b>ovs-appctl -t ovn-controller</b>
                     <b>exit </b>(but not <b>SIGTERM</b>), <b>ovn-controller </b>removes its
                     row.

              <b>Encap  </b>Upon startup, <b>ovn-controller </b>creates a row or rows
                     in this table that represent the tunnel
                     encapsulations by which its chassis can be reached,
                     and points its <b>Chassis </b>row to them. Upon graceful
                     termination, <b>ovn-controller </b>removes these rows.

              <b>Port_Binding</b>
                     At runtime, <b>ovn-controller </b>sets the <b>chassis </b>columns
                     of ports that are resident on its chassis to point
                     to its <b>Chassis </b>row, and, conversely, clears the
                     <b>chassis </b>column of ports that point to its <b>Chassis</b>
                     row but are no longer resident on its chassis. The
                     <b>chassis </b>column has a weak reference type, so when
                     <b>ovn-controller </b>gracefully exits and removes its
                     <b>Chassis </b>row, the database server automatically
                     clears any remaining references to that row.

              <b>MAC_Binding</b>
                     At runtime, <b>ovn-controller </b>updates the <b>MAC_Binding</b>
                     table as instructed by <b>put_arp </b>and <b>put_nd </b>logical
                     actions. These changes persist beyond the lifetime
                     of <b>ovn-controller</b>.
</pre> <h2>
RUNTIME MANAGEMENT COMMANDS </h2>
<pre>
       <b>ovs-appctl </b>can send commands to a running <b>ovn-controller </b>process.
       The currently supported commands are described below.

              <b>exit   </b>Causes <b>ovn-controller </b>to gracefully terminate.

              <b>ct-zone-list</b>
                     Lists each local logical port and its connection
                     tracking zone.

              <b>meter-table-list</b>
                     Lists each meter table entry and its local meter
                     id.

              <b>group-table-list</b>
                     Lists each group table entry and its local group
                     id.

              <b>inject-pkt </b><i>microflow</i>
                     Injects <i>microflow</i> into the connected Open vSwitch
                     instance. <i>microflow</i> must contain an ingress logical
                     port (<b>inport </b>argument) that is present on the Open
                     vSwitch instance.

                     The <i>microflow</i> argument describes the packet whose
                     forwarding is to be simulated, in the syntax of an
                     OVN logical expression, as described in <a href="../man5/ovn-sb.5.html">ovn-sb(5)</a>,
                     to express constraints. The parser understands
                     prerequisites; for example, if the expression
                     refers to <b>ip4.src</b>, there is no need to explicitly
                     state <b>ip4 </b>or <b>eth.type == 0x800</b>.

              <b>connection-status</b>
                     Show OVN SBDB connection status for the chassis.

              <b>recompute</b>
                     Trigger a full compute iteration in <b>ovn-controller</b>
                     based on the contents of the Southbound database
                     and local OVS database.

                     This command is intended to use only in the event
                     of a bug in the incremental processing engine in
                     <b>ovn-controller </b>to avoid inconsistent states. It
                     should therefore be used with care as full
                     recomputes are cpu intensive.

              <b>sb-cluster-state-reset</b>
                     Reset southbound database cluster status when
                     databases are destroyed and rebuilt.

                     If all databases in a clustered southbound database
                     are removed from disk, then the stored index of all
                     databases will be reset to zero. This will cause
                     ovn-controller to be unable to read or write to the
                     southbound database, because it will always detect
                     the data as stale. In such a case, run this command
                     so that ovn-controller will reset its local index
                     so that it can interact with the southbound
                     database again.

              <b>debug/delay-nb-cfg-report </b><i>seconds</i>
                     This command is used to delay ovn-controller
                     updating the <b>nb_cfg </b>back to <b>OVN_Southbound</b>
                     database. This is useful when <b>ovn-nbctl --wait=hv</b>
                     is used to measure end-to-end latency in a large
                     scale environment. See <a href="ovn-nbctl.8.html">ovn-nbctl(8)</a> for more
                     details.

              <b>lflow-cache/flush</b>
                     Flushes the <b>ovn-controller </b>logical flow cache.

              <b>lflow-cache/show-stats</b>
                     Displays logical flow cache statistics:
                     enabled/disabled, per cache type entry counts.

              <b>inc-engine/show-stats</b>
                     Display <b>ovn-controller </b>engine counters. For each
                     engine node the following counters have been added:

                     •      <b>recompute</b>

                     •      <b>compute</b>

                     •      <b>cancel</b>

              <b>inc-engine/show-stats </b><i>engine_node_name counter_name</i>
                     Display the <b>ovn-controller </b>engine counter(s) for
                     the specified <i>engine_node_name</i>. <i>counter_name</i> is
                     optional and can be one of <b>recompute</b>, <b>compute </b>or
                     <b>cancel</b>.

              <b>inc-engine/clear-stats</b>
                     Reset <b>ovn-controller </b>engine counters.
</pre> <h2>
COLOPHON </h2>
<pre>
       This page is part of the <i>Open Virtual Network</i> (Daemons for Open
       vSwitch that translate virtual network configurations into
       OpenFlow) project.  Information about the project can be found at
       ⟨<a href="https://www.ovn.org/">https://www.ovn.org/</a>⟩.  If you have a bug report for this manual
       page, send it to bugs@openvswitch.org.  This page was obtained
       from the project's upstream Git repository
       ⟨<a href="https://github.com/ovn-org/ovn">https://github.com/ovn-org/ovn</a>⟩ on 2024-06-14.  (At that time,
       the date of the most recent commit that was found in the
       repository was 2024-06-12.)  If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">OVN 24.03.90                 ovn-controller            <i>ovn-controller</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="../man5/ovn-nb.5.html">ovn-nb(5)</a>, <a href="../man5/ovn-sb.5.html">ovn-sb(5)</a>, <a href="../man7/ovn-architecture.7.html">ovn-architecture(7)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/ovn-controller.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/ovn-controller.8.html</a>
  </p>
</div>
