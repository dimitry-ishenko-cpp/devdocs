<h1>cryptsetup(8) — Linux manual page</h1>   <pre>
<span class="headline"><i>CRYPTSETUP</i>(8)             Maintenance Commands             <i>CRYPTSETUP</i>(8)</span>
</pre> <h2>
NAME </h2>
<pre>
       cryptsetup - manage plain dm-crypt, LUKS, and other encrypted
       volumes
</pre> <h2>
SYNOPSIS </h2>
<pre>
       <b>cryptsetup &lt;action&gt; [&lt;options&gt;] &lt;action args&gt;</b>
</pre> <h2>
DESCRIPTION </h2>
<pre>
       cryptsetup is used to conveniently setup dm-crypt managed
       device-mapper mappings. These include plain dm-crypt volumes and
       LUKS volumes. The difference is that LUKS uses a metadata header
       and can hence offer more features than plain dm-crypt. On the
       other hand, the header is visible and vulnerable to damage.

       In addition, cryptsetup provides limited support for the use of
       loop-AES volumes, TrueCrypt, VeraCrypt, BitLocker and FileVault2
       compatible volumes, and for hardware-based encryption on OPAL
       capable drives.

       For more information about specific cryptsetup action see
       <b>cryptsetup-&lt;action&gt;</b>(8), where <b>&lt;action&gt; </b>is the name of the
       cryptsetup action.
</pre> <h2>
BASIC ACTIONS </h2>
<pre>
       The following are valid actions for all supported device types.

   <b>OPEN</b>
       <b>open &lt;device&gt; &lt;name&gt; --type &lt;device_type&gt;</b>

       Opens (creates a mapping with) &lt;name&gt; backed by device &lt;device&gt;.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.

   <b>CLOSE</b>
       <b>close &lt;name&gt;</b>

       Removes the existing mapping &lt;name&gt; and wipes the key from kernel
       memory.
       See <a href="cryptsetup-close.8.html">cryptsetup-close(8)</a>.

   <b>STATUS</b>
       <b>status &lt;name&gt;</b>

       Reports the status for the mapping &lt;name&gt;.
       See <a href="cryptsetup-status.8.html">cryptsetup-status(8)</a>.

   <b>RESIZE</b>
       <b>resize &lt;name&gt;</b>

       Resizes an active mapping &lt;name&gt;.
       See <a href="cryptsetup-resize.8.html">cryptsetup-resize(8)</a>.

   <b>REFRESH</b>
       <b>refresh &lt;name&gt;</b>

       Refreshes parameters of active mapping &lt;name&gt;.
       See <a href="cryptsetup-refresh.8.html">cryptsetup-refresh(8)</a>.

   <b>REENCRYPT</b>
       <b>reencrypt &lt;device&gt; or --active-name &lt;name&gt; [&lt;new_name&gt;]</b>

       Run LUKS device reencryption.
       See <a href="cryptsetup-reencrypt.8.html">cryptsetup-reencrypt(8)</a>.
</pre> <h2>
PLAIN MODE </h2>
<pre>
       Plain dm-crypt encrypts the device sector-by-sector with a
       single, non-salted hash of the passphrase. No checks are
       performed, no metadata is used. There is no formatting operation.
       When the raw device is mapped (opened), the usual device
       operations can be used on the mapped device, including filesystem
       creation. Mapped devices usually reside in /dev/mapper/&lt;name&gt;.

       The following are valid plain device type actions:

   <b>OPEN</b>
       <b>open --type plain &lt;device&gt; &lt;name&gt;</b>
       create &lt;name&gt; &lt;device&gt; (<b>OBSOLETE syntax</b>)

       Opens (creates a mapping with) &lt;name&gt; backed by device &lt;device&gt;.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.
</pre> <h2>
LUKS EXTENSION </h2>
<pre>
       LUKS, the Linux Unified Key Setup, is a standard for disk
       encryption. It adds a standardized header at the start of the
       device, a key-slot area directly behind the header and the bulk
       data area behind that. The whole set is called a 'LUKS
       container'. The device that a LUKS container resides on is called
       a 'LUKS device'. For most purposes, both terms can be used
       interchangeably. But note that when the LUKS header is at a
       nonzero offset in a device, then the device is not a LUKS device
       anymore, but has a LUKS container stored in it at an offset.

       LUKS can manage multiple passphrases that can be individually
       revoked or changed and that can be securely scrubbed from
       persistent media due to the use of anti-forensic stripes.
       Passphrases are protected against brute-force and dictionary
       attacks by Password-Based Key Derivation Function (PBKDF).

       LUKS2 is a new version of header format that allows additional
       extensions like different PBKDF algorithm or authenticated
       encryption. You can format device with LUKS2 header if you
       specify <b>--type luks2 </b>in <b>luksFormat </b>command. For activation, the
       format is already recognized automatically.

       Each passphrase, also called a <b>key </b>in this document, is
       associated with one of 8 key-slots. Key operations that do not
       specify a slot affect the first slot that matches the supplied
       passphrase or the first empty slot if a new passphrase is added.

       The <b>&lt;device&gt; </b>parameter can also be specified by a LUKS UUID in
       the format UUID=&lt;uuid&gt;. Translation to real device name uses
       symlinks in /dev/disk/by-uuid directory.

       To specify a detached header, the <b>--header </b>parameter can be used
       in all LUKS commands and always takes precedence over the
       positional <b>&lt;device&gt; </b>parameter.

       The following are valid LUKS actions:

   <b>FORMAT</b>
       <b>luksFormat &lt;device&gt; [&lt;key file&gt;]</b>

       Initializes a LUKS partition and sets the initial passphrase (for
       key-slot 0).
       See <a href="cryptsetup-luksformat.8.html">cryptsetup-luksFormat(8)</a>.

   <b>OPEN</b>
       <b>open --type luks &lt;device&gt; &lt;name&gt;</b>
       luksOpen &lt;device&gt; &lt;name&gt; (<b>old syntax</b>)

       Opens the LUKS device &lt;device&gt; and sets up a mapping &lt;name&gt; after
       successful verification of the supplied passphrase.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.

   <b>SUSPEND</b>
       <b>luksSuspend &lt;name&gt;</b>

       Suspends an active device (all IO operations will block and
       accesses to the device will wait indefinitely) and wipes the
       encryption key from kernel memory.
       See <a href="cryptsetup-lukssuspend.8.html">cryptsetup-luksSuspend(8)</a>.

   <b>RESUME</b>
       <b>luksResume &lt;name&gt;</b>

       Resumes a suspended device and reinstates the encryption key.
       See <a href="cryptsetup-luksresume.8.html">cryptsetup-luksResume(8)</a>.

   <b>ADD KEY</b>
       <b>luksAddKey &lt;device&gt; [&lt;key file with new key&gt;]</b>

       Adds a new passphrase using an existing passphrase.
       See <a href="cryptsetup-luksaddkey.8.html">cryptsetup-luksAddKey(8)</a>.

   <b>REMOVE KEY</b>
       <b>luksRemoveKey &lt;device&gt; [&lt;key file with passphrase to be removed&gt;]</b>

       Removes the supplied passphrase from the LUKS device.
       See <a href="cryptsetup-luksremovekey.8.html">cryptsetup-luksRemoveKey(8)</a>.

   <b>CHANGE KEY</b>
       <b>luksChangeKey &lt;device&gt; [&lt;new key file&gt;]</b>

       Changes an existing passphrase.
       See <a href="cryptsetup-lukschangekey.8.html">cryptsetup-luksChangeKey(8)</a>.

   <b>CONVERT KEY</b>
       <b>luksConvertKey &lt;device&gt;</b>

       Converts an existing LUKS2 keyslot to new PBKDF parameters.
       See <a href="cryptsetup-luksconvertkey.8.html">cryptsetup-luksConvertKey(8)</a>.

   <b>KILL SLOT</b>
       <b>luksKillSlot &lt;device&gt; &lt;key slot number&gt;</b>

       Wipe the key-slot number &lt;key slot&gt; from the LUKS device.
       See <a href="cryptsetup-lukskillslot.8.html">cryptsetup-luksKillSlot(8)</a>.

   <b>ERASE</b>
       <b>erase &lt;device&gt;</b>
       luksErase &lt;device&gt; (<b>old syntax</b>)

       Erase all keyslots and make the LUKS container permanently
       inaccessible.
       See <a href="cryptsetup-erase.8.html">cryptsetup-erase(8)</a>.

   <b>UUID</b>
       <b>luksUUID &lt;device&gt;</b>

       Print or set the UUID of a LUKS device.
       See <a href="cryptsetup-luksuuid.8.html">cryptsetup-luksUUID(8)</a>.

   <b>IS LUKS</b>
       <b>isLuks &lt;device&gt;</b>

       Returns true, if &lt;device&gt; is a LUKS device, false otherwise.
       See <a href="cryptsetup-isluks.8.html">cryptsetup-isLuks(8)</a>.

   <b>DUMP</b>
       <b>luksDump &lt;device&gt;</b>

       Dump the header information of a LUKS device.
       See <a href="cryptsetup-luksdump.8.html">cryptsetup-luksDump(8)</a>.

   <b>HEADER BACKUP</b>
       <b>luksHeaderBackup &lt;device&gt; --header-backup-file &lt;file&gt;</b>

       Stores a binary backup of the LUKS header and keyslot area.
       See <a href="cryptsetup-luksheaderbackup.8.html">cryptsetup-luksHeaderBackup(8)</a>.

   <b>HEADER RESTORE</b>
       <b>luksHeaderRestore &lt;device&gt; --header-backup-file &lt;file&gt;</b>

       Restores a binary backup of the LUKS header and keyslot area from
       the specified file.
       See <a href="cryptsetup-luksheaderrestore.8.html">cryptsetup-luksHeaderRestore(8)</a>.

   <b>TOKEN</b>
       <b>token &lt;add|remove|import|export&gt; &lt;device&gt;</b>

       Manipulate token objects used for obtaining passphrases.
       See <a href="cryptsetup-token.8.html">cryptsetup-token(8)</a>.

   <b>CONVERT</b>
       <b>convert &lt;device&gt; --type &lt;format&gt;</b>

       Converts the device between LUKS1 and LUKS2 format (if possible).
       See <a href="cryptsetup-convert.8.html">cryptsetup-convert(8)</a>.

   <b>CONFIG</b>
       <b>config &lt;device&gt;</b>

       Set permanent configuration options (store to LUKS header).
       See <a href="cryptsetup-config.8.html">cryptsetup-config(8)</a>.
</pre> <h2>
LOOP-AES EXTENSION </h2>
<pre>
       cryptsetup supports mapping loop-AES encrypted partition using a
       compatibility mode.

   <b>OPEN</b>
       <b>open --type loopaes &lt;device&gt; &lt;name&gt; --key-file &lt;keyfile&gt;</b>
       loopaesOpen &lt;device&gt; &lt;name&gt; --key-file &lt;keyfile&gt; (<b>old syntax</b>)

       Opens the loop-AES &lt;device&gt; and sets up a mapping &lt;name&gt;.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.

       See also section 7 of the FAQ and loop-AES
       &lt;<a href="http://loop-aes.sourceforge.net">http://loop-aes.sourceforge.net</a>&gt; for more information regarding
       loop-AES.
</pre> <h2>
TCRYPT (TRUECRYPT AND VERACRYPT COMPATIBLE) EXTENSION </h2>
<pre>
       cryptsetup supports mapping of TrueCrypt, tcplay or VeraCrypt
       encrypted partition using a native Linux kernel API. Header
       formatting and TCRYPT header change is not supported, cryptsetup
       never changes TCRYPT header on-device.

       TCRYPT extension requires kernel userspace crypto API to be
       available (introduced in Linux kernel 2.6.38). If you are
       configuring kernel yourself, enable "User-space interface for
       symmetric key cipher algorithms" in "Cryptographic API" section
       (CRYPTO_USER_API_SKCIPHER .config option).

       Because TCRYPT header is encrypted, you have to always provide
       valid passphrase and keyfiles.

       Cryptsetup should recognize all header variants, except legacy
       cipher chains using LRW encryption mode with 64 bits encryption
       block (namely Blowfish in LRW mode is not recognized, this is
       limitation of kernel crypto API).

       VeraCrypt is extension of TrueCrypt header with increased
       iteration count so unlocking can take quite a lot of time.

       To open a VeraCrypt device with a custom Personal Iteration
       Multiplier (PIM) value, use either the <b>--veracrypt-pim=&lt;PIM&gt;</b>
       option to directly specify the PIM on the command- line or use
       <b>--veracrypt-query-pim </b>to be prompted for the PIM.

       The PIM value affects the number of iterations applied during key
       derivation. Please refer to PIM
       &lt;<a href="https://www.veracrypt.fr/en/Personal%20Iterations%20Multiplier%20%28PIM%29.html">https://www.veracrypt.fr/en/Personal%20Iterations%20Multiplier%20%28PIM%29.html</a>&gt;
       for more detailed information.

       If you need to disable VeraCrypt device support, use
       <b>--disable-veracrypt </b>option.

       <b>NOTE: </b>Activation with <b>tcryptOpen </b>is supported only for cipher
       chains using LRW or XTS encryption modes.

       The <b>tcryptDump </b>command should work for all recognized TCRYPT
       devices and doesn’t require superuser privilege.

       To map system device (device with boot loader where the whole
       encrypted system resides) use <b>--tcrypt-system </b>option. You can use
       partition device as the parameter (parameter must be real
       partition device, not an image in a file), then only this
       partition is mapped.

       If you have the whole TCRYPT device as a file image and you want
       to map multiple partition encrypted with system encryption,
       please create loopback mapping with partitions first (<b>losetup -P</b>,
       see <a href="losetup.8.html">losetup(8)</a> man page for more info), and use loop partition as
       the device parameter.

       If you use the whole base device as a parameter, one device for
       the whole system encryption is mapped. This mode is available
       only for backward compatibility with older cryptsetup versions
       which mapped TCRYPT system encryption using the whole device.

       To use hidden header (and map hidden device, if available), use
       <b>--tcrypt-hidden </b>option.

       To explicitly use backup (secondary) header, use <b>--tcrypt-backup</b>
       option.

       <b>NOTE: </b>There is no protection for a hidden volume if the outer
       volume is mounted. The reason is that if there were any
       protection, it would require some metadata describing what to
       protect in the outer volume and the hidden volume would become
       detectable.

   <b>OPEN</b>
       <b>open --type tcrypt &lt;device&gt; &lt;name&gt;</b>
       tcryptOpen_ &lt;device&gt; &lt;name&gt; (<b>old syntax</b>)

       Opens the TCRYPT (a TrueCrypt-compatible) &lt;device&gt; and sets up a
       mapping &lt;name&gt;.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.

   <b>DUMP</b>
       <b>tcryptDump &lt;device&gt;</b>

       Dump the header information of a TCRYPT device.
       See <a href="cryptsetup-tcryptdump.8.html">cryptsetup-tcryptDump(8)</a>.

       See also <b>TrueCrypt </b>&lt;<a href="https://en.wikipedia.org/wiki/TrueCrypt">https://en.wikipedia.org/wiki/TrueCrypt</a>&gt; and
       <b>VeraCrypt </b>&lt;<a href="https://en.wikipedia.org/wiki/VeraCrypt">https://en.wikipedia.org/wiki/VeraCrypt</a>&gt; pages for
       more information.

       Please note that cryptsetup does not use TrueCrypt or VeraCrypt
       code, please report all problems related to this compatibility
       extension to the cryptsetup project.
</pre> <h2>
BITLK (WINDOWS BITLOCKER COMPATIBLE) EXTENSION </h2>
<pre>
       cryptsetup supports mapping of BitLocker and BitLocker to Go
       encrypted partition using a native Linux kernel API. Header
       formatting and BITLK header changes are not supported, cryptsetup
       never changes BITLK header on-device.

       BITLK extension requires kernel userspace crypto API to be
       available (for details see TCRYPT section).

       Cryptsetup should recognize all BITLK header variants, except
       legacy header used in Windows Vista systems and partially
       decrypted BitLocker devices. Activation of legacy devices
       encrypted in CBC mode requires at least Linux kernel version 5.3
       and for devices using Elephant diffuser kernel 5.6.

       The <b>bitlkDump </b>command should work for all recognized BITLK
       devices and doesn’t require superuser privilege.

       For unlocking with the <b>open </b>a password or a recovery passphrase
       or a startup key must be provided.

       Additionally unlocking using volume key is supported. You must
       provide BitLocker Full Volume Encryption Key (FVEK) using the
       --volume-key-file option. The key must be decrypted and without
       the header (only 128/256/512 bits of key data depending on used
       cipher and mode).

       Other unlocking methods (TPM, SmartCard) are not supported.

   <b>OPEN</b>
       <b>open --type bitlk &lt;device&gt; &lt;name&gt;</b>
       bitlkOpen &lt;device&gt; &lt;name&gt; (<b>old syntax</b>)

       Opens the BITLK (a BitLocker-compatible) &lt;device&gt; and sets up a
       mapping &lt;name&gt;.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.

   <b>DUMP</b>
       <b>bitlkDump &lt;device&gt;</b>

       Dump the header information of a BITLK device.
       See <a href="cryptsetup-bitlkdump.8.html">cryptsetup-bitlkDump(8)</a>.

       Please note that cryptsetup does not use any Windows BitLocker
       code, please report all problems related to this compatibility
       extension to the cryptsetup project.
</pre> <h2>
FVAULT2 (APPLE MACOS FILEVAULT2 COMPATIBLE) EXTENSION </h2>
<pre>
       cryptsetup supports the mapping of FileVault2 (FileVault2
       full-disk encryption) by Apple for the macOS operating system
       using a native Linux kernel API.

       <b>NOTE: </b>cryptsetup supports only FileVault2 based on Core Storage
       and HFS+ filesystem (introduced in MacOS X 10.7 Lion). It does
       NOT support the new version of FileVault based on the APFS
       filesystem used in recent macOS versions.

       Header formatting and FVAULT2 header changes are not supported;
       cryptsetup never changes the FVAULT2 header on-device.

       FVAULT2 extension requires kernel userspace crypto API to be
       available (for details, see TCRYPT section) and kernel driver for
       HFS+ (hfsplus) filesystem.

       Cryptsetup should recognize the basic configuration for portable
       drives.

       The <b>fvault2Dump </b>command should work for all recognized FVAULT2
       devices and doesn’t require superuser privilege.

       For unlocking with the <b>open</b>, a password must be provided. Other
       unlocking methods are not supported.

   <b>OPEN</b>
       <b>open --type fvault2 &lt;device&gt; &lt;name&gt;</b>
       fvault2Open &lt;device&gt; &lt;name&gt; (<b>old syntax</b>)

       Opens the FVAULT2 (a FileVault2-compatible) &lt;device&gt; (usually the
       second partition on the device) and sets up a mapping &lt;name&gt;.
       See <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>.
</pre> <h2>
SED (SELF ENCRYPTING DRIVE) OPAL EXTENSION </h2>
<pre>
       cryptsetup supports using native hardware encryption on drives
       that provide an <b>OPAL </b>interface, both nested with <b>dm-crypt </b>and
       standalone. Passphrases, tokens and metadata are stored using the
       LUKS2 header format, and are thus compatible with any software or
       system that uses LUKS2 (e.g.: tokens).

       <b>WARNING: </b>this support is new and experimental, and requires at
       least kernel v6.4. Resizing devices is not supported.

       <b>--hw-opal </b>can be specified for OPAL + dm-crypt, and
       <b>--hw-opal-only </b>can be specified to use OPAL only, without a
       dm-crypt layer.

       Opening, closing and enrolling tokens work in the same way as
       with LUKS2 and dm-crypt. The new parameters are only necessary
       when formatting, the LUKS2 metadata will ensure the right setup
       is performed when opening or closing. If no <b>subsystem </b>is
       specified, it will be automatically set to <b>HW-OPAL </b>so that it is
       immediately apparent when a device uses OPAL.

   <b>FORMAT</b>
       <b>luksFormat --type luks2 --hw-opal &lt;device&gt; [&lt;key file&gt;]</b>

       Additionally specify <b>--hw-opal-only </b>instead of <b>--hw-opal </b>to avoid
       the dm-crypt layer. Other than the usual passphrase, an admin
       password will have to be specified when formatting the first
       partition of the drive, and will have to be re-supplied when
       formatting any other partition until a factory reset is
       performed.

   <b>ERASE</b>
       <b>erase &lt;device&gt;</b>

       Securely erase a partition or device. Requires admin password.
       Additionally specify <b>--hw-opal-factory-reset </b>for a FULL factory
       reset of the drive, using the drive’s <b>PSID </b>(typically printed on
       the label) instead of the admin password. <b>WARNING</b>: a factory
       reset will cause ALL data on the device to be lost, regardless of
       the partition it is ran on, if any, and regardless of any LUKS2
       header backup.
</pre> <h2>
MISCELLANEOUS ACTIONS </h2>
<pre>
   <b>REPAIR</b>
       <b>repair &lt;device&gt;</b>

       Tries to repair the device metadata if possible. Currently
       supported only for LUKS device type.
       See <a href="cryptsetup-repair.8.html">cryptsetup-repair(8)</a>.

   <b>BENCHMARK</b>
       <b>benchmark &lt;options&gt;</b>

       Benchmarks ciphers and KDF (key derivation function).
       See <a href="cryptsetup-benchmark.8.html">cryptsetup-benchmark(8)</a>.
</pre> <h2>
PLAIN DM-CRYPT OR LUKS? </h2>
<pre>
       Unless you understand the cryptographic background well, use
       LUKS. With plain dm-crypt there are a number of possible user
       errors that massively decrease security. While LUKS cannot fix
       them all, it can lessen the impact for many of them.
</pre> <h2>
WARNINGS </h2>
<pre>
       A lot of good information on the risks of using encrypted
       storage, on handling problems and on security aspects can be
       found in the Cryptsetup FAQ. Read it. Nonetheless, some risks
       deserve to be mentioned here.

       <b>Backup: </b>Storage media die. Encryption has no influence on that.
       Backup is mandatory for encrypted data as well, if the data has
       any worth. See the Cryptsetup FAQ for advice on how to do a
       backup of an encrypted volume.

       <b>Character encoding: </b>If you enter a passphrase with special
       symbols, the passphrase can change depending on character
       encoding. Keyboard settings can also change, which can make blind
       input hard or impossible. For example, switching from some ASCII
       8-bit variant to UTF-8 can lead to a different binary encoding
       and hence different passphrase seen by cryptsetup, even if what
       you see on the terminal is exactly the same. It is therefore
       highly recommended to select passphrase characters only from
       7-bit ASCII, as the encoding for 7-bit ASCII stays the same for
       all ASCII variants and UTF-8.

       <b>LUKS header: </b>If the header of a LUKS volume gets damaged, all
       data is permanently lost unless you have a header-backup. If a
       key-slot is damaged, it can only be restored from a header-backup
       or if another active key-slot with known passphrase is undamaged.
       Damaging the LUKS header is something people manage to do with
       surprising frequency. This risk is the result of a trade-off
       between security and safety, as LUKS is designed for fast and
       secure wiping by just overwriting header and key-slot area.

       <b>Previously used partitions: </b>If a partition was previously used,
       it is a very good idea to wipe filesystem signatures, data, etc.
       before creating a LUKS or plain dm-crypt container on it. For a
       quick removal of filesystem signatures, use <a href="wipefs.8.html">wipefs(8)</a>. Take care
       though that this may not remove everything. In particular, MD
       RAID signatures at the end of a device may survive. It also does
       not remove data. For a full wipe, overwrite the whole partition
       before container creation. If you do not know how to do that, the
       cryptsetup FAQ describes several options.
</pre> <h2>
EXAMPLES </h2>
<pre>
       Example 1: Create LUKS 2 container on block device /dev/sdX.
           sudo cryptsetup --type luks2 luksFormat /dev/sdX

       Example 2: Add an additional passphrase to key slot 5.
           sudo cryptsetup luksAddKey --key-slot 5 /dev/sdX

       Example 3: Create LUKS header backup and save it to file.
           sudo cryptsetup luksHeaderBackup /dev/sdX
           --header-backup-file /var/tmp/NameOfBackupFile

       Example 4: Open LUKS container on /dev/sdX and map it to
       sdX_crypt.
           sudo cryptsetup open /dev/sdX sdX_crypt

       <b>WARNING: The command in example 5 will erase all key slots.</b>
           Your cannot use your LUKS container afterward anymore unless
           you have a backup to restore.

       Example 5: Erase all key slots on /dev/sdX.
           sudo cryptsetup erase /dev/sdX

       Example 6: Restore LUKS header from backup file.
           sudo cryptsetup luksHeaderRestore /dev/sdX
           --header-backup-file /var/tmp/NameOfBackupFile
</pre> <h2>
RETURN CODES </h2>
<pre>
       Cryptsetup returns <b>0 </b>on success and a non-zero value on error.

       Error codes are: <b>1 </b>wrong parameters, <b>2 </b>no permission (bad
       passphrase), <b>3 </b>out of memory, <b>4 </b>wrong device specified, <b>5 </b>device
       already exists or device is busy.
</pre> <h2>
NOTES </h2>
<pre>
   <b>Passphrase processing for PLAIN mode</b>
       Note that no iterated hashing or salting is done in plain mode.
       If hashing is done, it is a single direct hash. This means that
       low-entropy passphrases are easy to attack in plain mode.

       <b>From a terminal</b>: The passphrase is read until the first newline,
       i.e. '\n'. The input without the newline character is processed
       with the default hash or the hash specified with --hash. The hash
       result will be truncated to the key size of the used cipher, or
       the size specified with -s.

       <b>From stdin</b>: Reading will continue until a newline (or until the
       maximum input size is reached), with the trailing newline
       stripped. The maximum input size is defined by the same
       compiled-in default as for the maximum key file size and can be
       overwritten using --keyfile-size option.

       The data read will be hashed with the default hash or the hash
       specified with --hash. The hash result will be truncated to the
       key size of the used cipher, or the size specified with -s.

       Note that if --key-file=- is used for reading the key from stdin,
       trailing newlines are not stripped from the input.

       If "plain" is used as argument to --hash, the input data will not
       be hashed. Instead, it will be zero padded (if shorter than the
       key size) or truncated (if longer than the key size) and used
       directly as the binary key. This is useful for directly
       specifying a binary key. No warning will be given if the amount
       of data read from stdin is less than the key size.

       <b>From a key file</b>: It will be truncated to the key size of the used
       cipher or the size given by -s and directly used as a binary key.

       <b>WARNING</b>: The --hash argument is being ignored. The --hash option
       is usable only for stdin input in plain mode.

       If the key file is shorter than the key, cryptsetup will quit
       with an error. The maximum input size is defined by the same
       compiled-in default as for the maximum key file size and can be
       overwritten using --keyfile-size option.

   <b>Passphrase processing for LUKS</b>
       LUKS uses PBKDF to protect against dictionary attacks and to give
       some protection to low-entropy passphrases (see cryptsetup FAQ).

       <b>From a terminal</b>: The passphrase is read until the first newline
       and then processed by PBKDF2 without the newline character.

       <b>From stdin</b>: LUKS will read passphrases from stdin up to the first
       newline character or the compiled-in maximum key file length. If
       --keyfile-size is given, it is ignored.

       <b>From key file</b>: The complete keyfile is read up to the compiled-in
       maximum size. Newline characters do not terminate the input. The
       --keyfile-size option can be used to limit what is read.

       <b>Passphrase processing</b>: Whenever a passphrase is added to a LUKS
       header (luksAddKey, luksFormat), the user may specify how much
       the time the passphrase processing should consume. The time is
       used to determine the iteration count for PBKDF2 and higher times
       will offer better protection for low-entropy passphrases, but
       open will take longer to complete. For passphrases that have
       entropy higher than the used key length, higher iteration times
       will not increase security.

       The default setting of one or two seconds is sufficient for most
       practical cases. The only exception is a low-entropy passphrase
       used on a device with a slow CPU, as this will result in a low
       iteration count. On a slow device, it may be advisable to
       increase the iteration time using the --iter-time option in order
       to obtain a higher iteration count. This does slow down all later
       luksOpen operations accordingly.

   <b>Incoherent behavior for invalid passphrases/keys</b>
       LUKS checks for a valid passphrase when an encrypted partition is
       unlocked. The behavior of plain dm-crypt is different. It will
       always decrypt with the passphrase given. If the given passphrase
       is wrong, the device mapped by plain dm-crypt will essentially
       still contain encrypted data and will be unreadable.

   <b>Supported ciphers, modes, hashes and key sizes</b>
       The available combinations of ciphers, modes, hashes and key
       sizes depend on kernel support. See /proc/crypto for a list of
       available options. You might need to load additional kernel
       crypto modules in order to get more options.

       For the --hash option, if the crypto backend is libgcrypt, then
       all algorithms supported by the gcrypt library are available. For
       other crypto backends, some algorithms may be missing.

   <b>Notes on passphrases</b>
       Mathematics can’t be bribed. Make sure you keep your passphrases
       safe. There are a few nice tricks for constructing a fallback,
       when suddenly out of the blue, your brain refuses to cooperate.
       These fallbacks need LUKS, as it’s only possible with LUKS to
       have multiple passphrases. Still, if your attacker model does not
       prevent it, storing your passphrase in a sealed envelope
       somewhere may be a good idea as well.

   <b>Notes on Random Number Generators</b>
       Random Number Generators (RNG) used in cryptsetup are always the
       kernel RNGs without any modifications or additions to data stream
       produced.

       There are two types of randomness cryptsetup/LUKS needs. One type
       (which always uses /dev/urandom) is used for salts, the AF
       splitter and for wiping deleted keyslots.

       The second type is used for the volume key. You can switch
       between using /dev/random and /dev/urandom here, see <b>--use-random</b>
       and <b>--use-urandom </b>options. Using /dev/random on a system without
       enough entropy sources can cause <b>luksFormat </b>to block until the
       requested amount of random data is gathered. In a low-entropy
       situation (embedded system), this can take a very long time and
       potentially forever. At the same time, using /dev/urandom in a
       low-entropy situation will produce low-quality keys. This is a
       serious problem, but solving it is out of scope for a mere
       man-page. See <a href="../man4/urandom.4.html">urandom(4)</a> for more information.

   <b>Authenticated disk encryption (EXPERIMENTAL)</b>
       Since Linux kernel version 4.12 dm-crypt supports authenticated
       disk encryption.

       Normal disk encryption modes are length-preserving (plaintext
       sector is of the same size as a ciphertext sector) and can
       provide only confidentiality protection, but not
       cryptographically sound data integrity protection.

       Authenticated modes require additional space per-sector for
       authentication tag and use Authenticated Encryption with
       Additional Data (AEAD) algorithms.

       If you configure LUKS2 device with data integrity protection,
       there will be an underlying dm-integrity device, which provides
       additional per-sector metadata space and also provide data
       journal protection to ensure atomicity of data and metadata
       update. Because there must be additional space for metadata and
       journal, the available space for the device will be smaller than
       for length-preserving modes.

       The dm-crypt device then resides on top of such a dm-integrity
       device. All activation and deactivation of this device stack is
       performed by cryptsetup, there is no difference in using <b>luksOpen</b>
       for integrity protected devices. If you want to format LUKS2
       device with data integrity protection, use <b>--integrity </b>option
       (see <a href="cryptsetup-luksformat.8.html">cryptsetup-luksFormat(8)</a>).

       Albeit Linux kernel 5.7 added TRIM support for standalone
       dm-integrity devices, <a href="cryptsetup.8.html">cryptsetup(8)</a> can’t offer support for
       discards (TRIM) in authenticated encryption mode, because the
       underlying dm-crypt kernel module does not support this
       functionality when dm-integrity is used as auth tag space
       allocator (see <b>--allow-discards </b>in <a href="cryptsetup-luksformat.8.html">cryptsetup-luksFormat(8)</a>).

       Some integrity modes requires two independent keys (key for
       encryption and for authentication). Both these keys are stored in
       one LUKS keyslot.

       <b>WARNING: </b>All support for authenticated modes is experimental and
       there are only some modes available for now. Note that there are
       a very few authenticated encryption algorithms that are suitable
       for disk encryption. You also cannot use CRC32 or any other
       non-cryptographic checksums (other than the special integrity
       mode "none"). If for some reason you want to have integrity
       control without using authentication mode, then you should
       separately configure dm-integrity independently of LUKS2.

   <b>Notes on loopback device use</b>
       Cryptsetup is usually used directly on a block device (disk
       partition or LVM volume). However, if the device argument is a
       file, cryptsetup tries to allocate a loopback device and map it
       into this file. This mode requires Linux kernel 2.6.25 or more
       recent which supports the loop autoclear flag (loop device is
       cleared on the last close automatically). Of course, you can
       always map a file to a loop-device manually. See the cryptsetup
       FAQ for an example.

       When device mapping is active, you can see the loop backing file
       in the status command output. Also see losetup(8).

   <b>LUKS2 header locking</b>
       The LUKS2 on-disk metadata is updated in several steps and to
       achieve proper atomic update, there is a locking mechanism. For
       an image in file, code uses <a href="../man2/flock.2.html">flock(2)</a> system call. For a block
       device, lock is performed over a special file stored in a locking
       directory (by default <b>/run/cryptsetup</b>). The locking directory
       should be created with the proper security context by the
       distribution during the boot-up phase. Only LUKS2 uses locks,
       other formats do not use this mechanism.

   <b>LUKS on-disk format specification</b>
       For LUKS on-disk metadata specification see <b>LUKS1</b>
       &lt;<a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/Specification">https://gitlab.com/cryptsetup/cryptsetup/wikis/Specification</a>&gt;
       and <b>LUKS2 </b>&lt;<a href="https://gitlab.com/cryptsetup/LUKS2-docs">https://gitlab.com/cryptsetup/LUKS2-docs</a>&gt;.
</pre> <h2>
AUTHORS </h2>
<pre>
       Cryptsetup is originally written by Jana Saout &lt;jana@saout.de&gt;.
       The LUKS extensions and original man page were written by Clemens
       Fruhwirth &lt;clemens@endorphin.org&gt;.
       Man page extensions by Milan Broz &lt;gmazyland@gmail.com&gt;.
       Man page rewrite and extension by Arno Wagner &lt;arno@wagner.name&gt;.
</pre> <h2>
REPORTING BUGS </h2>
<pre>
       Report bugs at <b>cryptsetup mailing list</b>
       &lt;cryptsetup@lists.linux.dev&gt; or in <b>Issues project section</b>
       &lt;<a href="https://gitlab.com/cryptsetup/cryptsetup/-/issues/new">https://gitlab.com/cryptsetup/cryptsetup/-/issues/new</a>&gt;.

       Please attach output of the failed command with --debug option
       added.
</pre> <h2>
SEE ALSO </h2>
<pre>
       <b>Cryptsetup FAQ</b>
       &lt;<a href="https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions">https://gitlab.com/cryptsetup/cryptsetup/wikis/FrequentlyAskedQuestions</a>&gt;

       <a href="cryptsetup.8.html">cryptsetup(8)</a>, <a href="integritysetup.8.html">integritysetup(8)</a> and <a href="veritysetup.8.html">veritysetup(8)</a>
</pre> <h2>
CRYPTSETUP </h2>
<pre>
       Part of <b>cryptsetup project</b>
       &lt;<a href="https://gitlab.com/cryptsetup/cryptsetup/">https://gitlab.com/cryptsetup/cryptsetup/</a>&gt;. This page is part of
       the <i>Cryptsetup</i> ((open-source disk encryption)) project.
       Information about the project can be found at 
       ⟨<a href="https://gitlab.com/cryptsetup/cryptsetup">https://gitlab.com/cryptsetup/cryptsetup</a>⟩. If you have a bug
       report for this manual page, send it to dm-crypt@saout.de. This
       page was obtained from the project's upstream Git repository
       ⟨<a href="https://gitlab.com/cryptsetup/cryptsetup.git">https://gitlab.com/cryptsetup/cryptsetup.git</a>⟩ on 2024-06-14. (At
       that time, the date of the most recent commit that was found in
       the repository was 2024-06-11.) If you discover any rendering
       problems in this HTML version of the page, or you believe there
       is a better or more up-to-date source for the page, or you have
       corrections or improvements to the information in this COLOPHON
       (which is <i>not</i> part of the original manual page), send a mail to
       man-pages@man7.org

<span class="footline">cryptsetup 2.8.0-git           2023-12-22                  <i>CRYPTSETUP</i>(8)</span>
</pre>  <p>Pages that refer to this page: <a href="../man1/homectl.1.html">homectl(1)</a>, <a href="../man1/systemd-cryptenroll.1.html">systemd-cryptenroll(1)</a>, <a href="../man5/crypttab.5.html">crypttab(5)</a>, <a href="cryptsetup.8.html">cryptsetup(8)</a>, <a href="cryptsetup-benchmark.8.html">cryptsetup-benchmark(8)</a>, <a href="cryptsetup-bitlkdump.8.html">cryptsetup-bitlkDump(8)</a>, <a href="cryptsetup-close.8.html">cryptsetup-close(8)</a>, <a href="cryptsetup-config.8.html">cryptsetup-config(8)</a>, <a href="cryptsetup-convert.8.html">cryptsetup-convert(8)</a>, <a href="cryptsetup-erase.8.html">cryptsetup-erase(8)</a>, <a href="cryptsetup-fvault2dump.8.html">cryptsetup-fvault2Dump(8)</a>, <a href="cryptsetup-isluks.8.html">cryptsetup-isLuks(8)</a>, <a href="cryptsetup-luksaddkey.8.html">cryptsetup-luksAddKey(8)</a>, <a href="cryptsetup-lukschangekey.8.html">cryptsetup-luksChangeKey(8)</a>, <a href="cryptsetup-luksconvertkey.8.html">cryptsetup-luksConvertKey(8)</a>, <a href="cryptsetup-luksdump.8.html">cryptsetup-luksDump(8)</a>, <a href="cryptsetup-luksformat.8.html">cryptsetup-luksFormat(8)</a>, <a href="cryptsetup-luksheaderbackup.8.html">cryptsetup-luksHeaderBackup(8)</a>, <a href="cryptsetup-luksheaderrestore.8.html">cryptsetup-luksHeaderRestore(8)</a>, <a href="cryptsetup-lukskillslot.8.html">cryptsetup-luksKillSlot(8)</a>, <a href="cryptsetup-luksremovekey.8.html">cryptsetup-luksRemoveKey(8)</a>, <a href="cryptsetup-luksresume.8.html">cryptsetup-luksResume(8)</a>, <a href="cryptsetup-lukssuspend.8.html">cryptsetup-luksSuspend(8)</a>, <a href="cryptsetup-luksuuid.8.html">cryptsetup-luksUUID(8)</a>, <a href="cryptsetup-open.8.html">cryptsetup-open(8)</a>, <a href="cryptsetup-reencrypt.8.html">cryptsetup-reencrypt(8)</a>, <a href="cryptsetup-refresh.8.html">cryptsetup-refresh(8)</a>, <a href="cryptsetup-repair.8.html">cryptsetup-repair(8)</a>, <a href="cryptsetup-resize.8.html">cryptsetup-resize(8)</a>, <a href="cryptsetup-ssh.8.html">cryptsetup-ssh(8)</a>, <a href="cryptsetup-status.8.html">cryptsetup-status(8)</a>, <a href="cryptsetup-tcryptdump.8.html">cryptsetup-tcryptDump(8)</a>, <a href="cryptsetup-token.8.html">cryptsetup-token(8)</a>, <a href="fsadm.8.html">fsadm(8)</a>, <a href="integritysetup.8.html">integritysetup(8)</a>, <a href="losetup.8.html">losetup(8)</a>, <a href="systemd-cryptsetup.8.html">systemd-cryptsetup(8)</a>, <a href="systemd-cryptsetup-generator.8.html">systemd-cryptsetup-generator(8)</a>, <a href="systemd-gpt-auto-generator.8.html">systemd-gpt-auto-generator(8)</a>, <a href="systemd-makefs@.service.8.html">systemd-makefs@.service(8)</a>, <a href="veritysetup.8.html">veritysetup(8)</a> </p> <hr>         <div class="_attribution">
  <p class="_attribution-p">
    ...<br>
    <a href="https://man7.org/linux/man-pages/man8/cryptsetup.8.html" class="_attribution-link">https://man7.org/linux/man-pages/man8/cryptsetup.8.html</a>
  </p>
</div>
