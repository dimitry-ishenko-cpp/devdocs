<h1 id="fixtures-explanation">Fixtures</h1> <div class="admonition seealso" id="s-fixtures"> <p class="first admonition-title">See also</p> <ul class="last simple"> <li><a class="reference internal" href="../../howto/initial-data.html"><span class="doc">How to provide initial data for models</span></a></li> </ul> </div>  <h2 id="what-is-a-fixture">What is a fixture?</h2> <p id="s-what-is-a-fixture">A <em>fixture</em> is a collection of files that contain the serialized contents of the database. Each fixture has a unique name, and the files that comprise the fixture can be distributed over multiple directories, in multiple applications.</p>   <h2 id="how-to-produce-a-fixture">How to produce a fixture?</h2> <p id="s-how-to-produce-a-fixture">Fixtures can be generated by <a class="reference internal" href="../../ref/django-admin.html#django-admin-dumpdata"><code>manage.py dumpdata</code></a>. It’s also possible to generate custom fixtures by directly using <a class="reference internal" href="../serialization.html"><span class="doc">serialization documentation</span></a> tools or even by handwriting them.</p>   <h2 id="what-to-use-a-fixture-for">What to use a fixture for?</h2> <p id="s-what-to-use-a-fixture-for">Fixtures can be used to pre-populate database with data for <a class="reference internal" href="../testing/tools.html#topics-testing-fixtures"><span class="std std-ref">tests</span></a> or to provide some <a class="reference internal" href="../../howto/initial-data.html#initial-data-via-fixtures"><span class="std std-ref">initial data</span></a>.</p>   <h2 id="were-django-looks-for-fixtures">Were Django looks for fixtures?</h2> <p id="s-were-django-looks-for-fixtures">Django will search in three locations for fixtures:</p> <ol class="arabic simple"> <li>In the <code>fixtures</code> directory of every installed application</li> <li>In any directory named in the <a class="reference internal" href="../../ref/settings.html#std-setting-FIXTURE_DIRS"><code>FIXTURE_DIRS</code></a> setting</li> <li>In the literal path named by the fixture</li> </ol> <p>Django will load any and all fixtures it finds in these locations that match the provided fixture names.</p> <p>If the named fixture has a file extension, only fixtures of that type will be loaded. For example:</p> <pre data-language="shell">django-admin loaddata mydata.json
</pre> <p>would only load JSON fixtures called <code>mydata</code>. The fixture extension must correspond to the registered name of a <a class="reference internal" href="../serialization.html#serialization-formats"><span class="std std-ref">serializer</span></a> (e.g., <code>json</code> or <code>xml</code>).</p> <p>If you omit the extensions, Django will search all available fixture types for a matching fixture. For example:</p> <pre data-language="shell">django-admin loaddata mydata
</pre> <p>would look for any fixture of any fixture type called <code>mydata</code>. If a fixture directory contained <code>mydata.json</code>, that fixture would be loaded as a JSON fixture.</p> <p>The fixtures that are named can include directory components. These directories will be included in the search path. For example:</p> <pre data-language="shell">django-admin loaddata foo/bar/mydata.json
</pre> <p>would search <code>&lt;app_label&gt;/fixtures/foo/bar/mydata.json</code> for each installed application, <code>&lt;dirname&gt;/foo/bar/mydata.json</code> for each directory in <a class="reference internal" href="../../ref/settings.html#std-setting-FIXTURE_DIRS"><code>FIXTURE_DIRS</code></a>, and the literal path <code>foo/bar/mydata.json</code>.</p>   <h2 id="how-fixtures-are-saved-to-the-database">How fixtures are saved to the database?</h2> <p id="s-how-fixtures-are-saved-to-the-database">When fixture files are processed, the data is saved to the database as is. Model defined <a class="reference internal" href="../../ref/models/instances.html#django.db.models.Model.save" title="django.db.models.Model.save"><code>save()</code></a> methods are not called, and any <a class="reference internal" href="../../ref/signals.html#django.db.models.signals.pre_save" title="django.db.models.signals.pre_save"><code>pre_save</code></a> or <a class="reference internal" href="../../ref/signals.html#django.db.models.signals.post_save" title="django.db.models.signals.post_save"><code>post_save</code></a> signals will be called with <code>raw=True</code> since the instance only contains attributes that are local to the model. You may, for example, want to disable handlers that access related fields that aren’t present during fixture loading and would otherwise raise an exception:</p> <pre data-language="python">from django.db.models.signals import post_save
from .models import MyModel


def my_handler(**kwargs):
    # disable the handler during fixture loading
    if kwargs["raw"]:
        return
    ...


post_save.connect(my_handler, sender=MyModel)
</pre> <p>You could also write a decorator to encapsulate this logic:</p> <pre data-language="python">from functools import wraps


def disable_for_loaddata(signal_handler):
    """
    Decorator that turns off signal handlers when loading fixture data.
    """

    @wraps(signal_handler)
    def wrapper(*args, **kwargs):
        if kwargs["raw"]:
            return
        signal_handler(*args, **kwargs)

    return wrapper


@disable_for_loaddata
def my_handler(**kwargs):
    ...
</pre> <p>Just be aware that this logic will disable the signals whenever fixtures are deserialized, not just during <code>loaddata</code>.</p> <p>Note that the order in which fixture files are processed is undefined. However, all fixture data is installed as a single transaction, so data in one fixture can reference data in another fixture. If the database backend supports row-level constraints, these constraints will be checked at the end of the transaction.</p>   <h2 id="compressed-fixtures">Compressed fixtures</h2> <p id="s-compressed-fixtures">Fixtures may be compressed in <code>zip</code>, <code>gz</code>, <code>bz2</code>, <code>lzma</code>, or <code>xz</code> format. For example:</p> <pre data-language="shell">django-admin loaddata mydata.json
</pre> <p>would look for any of <code>mydata.json</code>, <code>mydata.json.zip</code>, <code>mydata.json.gz</code>, <code>mydata.json.bz2</code>, <code>mydata.json.lzma</code>, or <code>mydata.json.xz</code>. The first file contained within a compressed archive is used.</p> <p>Note that if two fixtures with the same name but different fixture type are discovered (for example, if <code>mydata.json</code> and <code>mydata.xml.gz</code> were found in the same fixture directory), fixture installation will be aborted, and any data installed in the call to <code>loaddata</code> will be removed from the database.</p> <div class="admonition-mysql-with-myisam-and-fixtures admonition"> <p class="first admonition-title">MySQL with MyISAM and fixtures</p> <p class="last">The MyISAM storage engine of MySQL doesn’t support transactions or constraints, so if you use MyISAM, you won’t get validation of fixture data, or a rollback if multiple transaction files are found.</p> </div>   <h2 id="database-specific-fixtures">Database-specific fixtures</h2> <p id="s-database-specific-fixtures">If you’re in a multi-database setup, you might have fixture data that you want to load onto one database, but not onto another. In this situation, you can add a database identifier into the names of your fixtures.</p> <p>For example, if your <a class="reference internal" href="../../ref/settings.html#std-setting-DATABASES"><code>DATABASES</code></a> setting has a <code>users</code> database defined, name the fixture <code>mydata.users.json</code> or <code>mydata.users.json.gz</code> and the fixture will only be loaded when you specify you want to load data into the <code>users</code> database.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; Django Software Foundation and individual contributors<br>Licensed under the BSD License.<br>
    <a href="https://docs.djangoproject.com/en/4.2/topics/db/fixtures/" class="_attribution-link">https://docs.djangoproject.com/en/4.2/topics/db/fixtures/</a>
  </p>
</div>
