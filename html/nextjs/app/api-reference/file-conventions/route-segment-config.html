<h1 class="break-words">Route Segment Config</h1>
<p>The Route Segment options allows you to configure the behavior of a <a href="../../building-your-application/routing/pages-and-layouts.html">Page</a>, <a href="../../building-your-application/routing/pages-and-layouts.html">Layout</a>, or <a href="../../building-your-application/routing/route-handlers.html">Route Handler</a> by directly exporting the following variables:</p> <div class="overflow-x-auto"><table class="w-full table-auto">
<thead><tr>
<th>Option</th>
<th>Type</th>
<th>Default</th>
</tr></thead>
<tbody>
<tr>
<td><a href="#dynamic"><code>dynamic</code></a></td>
<td><code>'auto' | 'force-dynamic' | 'error' | 'force-static'</code></td>
<td><code>'auto'</code></td>
</tr>
<tr>
<td><a href="#dynamicparams"><code>dynamicParams</code></a></td>
<td><code>boolean</code></td>
<td><code>true</code></td>
</tr>
<tr>
<td><a href="#revalidate"><code>revalidate</code></a></td>
<td><code>false | 0 | number</code></td>
<td><code>false</code></td>
</tr>
<tr>
<td><a href="#fetchcache"><code>fetchCache</code></a></td>
<td><code>'auto' | 'default-cache' | 'only-cache' | 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'</code></td>
<td><code>'auto'</code></td>
</tr>
<tr>
<td><a href="#runtime"><code>runtime</code></a></td>
<td><code>'nodejs' | 'edge'</code></td>
<td><code>'nodejs'</code></td>
</tr>
<tr>
<td><a href="#preferredregion"><code>preferredRegion</code></a></td>
<td><code>'auto' | 'global' | 'home' | string | string[]</code></td>
<td><code>'auto'</code></td>
</tr>
<tr>
<td><a href="#maxduration"><code>maxDuration</code></a></td>
<td><code>number</code></td>
<td>Set by deployment platform</td>
</tr>
</tbody>
</table></div> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const dynamic = 'auto'
export const dynamicParams = true
export const revalidate = false
export const fetchCache = 'auto'
export const runtime = 'nodejs'
export const preferredRegion = 'auto'
export const maxDuration = 5
 
export default function MyComponent() {}</pre></div>  <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>:</p> <ul> <li>The values of the config options currently need be statically analyzable. For example <code>revalidate = 600</code> is valid, but <code>revalidate = 60 * 10</code> is not.</li> </ul> </blockquote> <h2 id="options" data-docs-heading="">Options     </h2> <h3 id="dynamic" data-docs-heading="">dynamic     </h3> <p>Change the dynamic behavior of a layout or page to fully static or fully dynamic.</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const dynamic = 'auto'
// 'auto' | 'force-dynamic' | 'error' | 'force-static'</pre></div>  <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>: The new model in the <code>app</code> directory favors granular caching control at the <code>fetch</code> request level over the binary all-or-nothing model of <code>getServerSideProps</code> and <code>getStaticProps</code> at the page-level in the <code>pages</code> directory. The <code>dynamic</code> option is a way to opt back in to the previous model as a convenience and provides a simpler migration path.</p> </blockquote> <ul> <li> <p><strong><code>'auto'</code></strong> (default): The default option to cache as much as possible without preventing any components from opting into dynamic behavior.</p> </li> <li> <p><strong><code>'force-dynamic'</code></strong>: Force <a href="../../building-your-application/rendering/server-components.html#dynamic-rendering">dynamic rendering</a>, which will result in routes being rendered for each user at request time. This option is equivalent to <code>getServerSideProps()</code> in the <code>pages</code> directory.</p> </li> <li> <p><strong><code>'error'</code></strong>: Force static rendering and cache the data of a layout or page by causing an error if any components use <a href="../../building-your-application/rendering/server-components.html#dynamic-functions">dynamic functions</a> or uncached data. This option is equivalent to:</p> <ul> <li>
<code>getStaticProps()</code> in the <code>pages</code> directory.</li> <li>Setting the option of every <code>fetch()</code> request in a layout or page to <code>{ cache: 'force-cache' }</code>.</li> <li>Setting the segment config to <code>fetchCache = 'only-cache', dynamicParams = false</code>.</li> <li>
<code>dynamic = 'error'</code> changes the default of <code>dynamicParams</code> from <code>true</code> to <code>false</code>. You can opt back into dynamically rendering pages for dynamic params not generated by <code>generateStaticParams</code> by manually setting <code>dynamicParams = true</code>.</li> </ul> </li> <li> <p><strong><code>'force-static'</code></strong>: Force static rendering and cache the data of a layout or page by forcing <a href="../functions/cookies.html"><code>cookies()</code></a>, <a href="../functions/headers.html"><code>headers()</code></a> and <a href="../functions/use-search-params.html"><code>useSearchParams()</code></a> to return empty values.</p> </li> </ul> <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>:</p> <ul> <li>Instructions on <a href="../../building-your-application/upgrading/app-router-migration.html#step-6-migrating-data-fetching-methods">how to migrate</a> from <code>getServerSideProps</code> and <code>getStaticProps</code> to <code>dynamic: 'force-dynamic'</code> and <code>dynamic: 'error'</code> can be found in the <a href="../../building-your-application/upgrading/app-router-migration.html#step-6-migrating-data-fetching-methods">upgrade guide</a>.</li> </ul> </blockquote> <h3 id="dynamicparams" data-docs-heading="">dynamicParams     </h3> <p>Control what happens when a dynamic segment is visited that was not generated with <a href="../functions/generate-static-params.html">generateStaticParams</a>.</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const dynamicParams = true // true | false,</pre></div>  <ul> <li>
<strong><code>true</code></strong> (default): Dynamic segments not included in <code>generateStaticParams</code> are generated on demand.</li> <li>
<strong><code>false</code></strong>: Dynamic segments not included in <code>generateStaticParams</code> will return a 404.</li> </ul> <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>:</p> <ul> <li>This option replaces the <code>fallback: true | false | blocking</code> option of <code>getStaticPaths</code> in the <code>pages</code> directory.</li> <li>When <code>dynamicParams = true</code>, the segment uses <a href="../../building-your-application/routing/loading-ui-and-streaming.html#streaming-with-suspense">Streaming Server Rendering</a>.</li> <li>If the <code>dynamic = 'error'</code> and <code>dynamic = 'force-static'</code> are used, it'll change the default of <code>dynamicParams</code> to <code>false</code>.</li> </ul> </blockquote> <h3 id="revalidate" data-docs-heading="">revalidate     </h3> <p>Set the default revalidation time for a layout or page. This option does not override the <code>revalidate</code> value set by individual <code>fetch</code> requests.</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const revalidate = false
// false | 0 | number</pre></div>  <ul> <li>
<strong><code>false</code></strong> (default): The default heuristic to cache any <code>fetch</code> requests that set their <code>cache</code> option to <code>'force-cache'</code> or are discovered before a <a href="#">dynamic function</a> is used. Semantically equivalent to <code>revalidate: Infinity</code> which effectively means the resource should be cached indefinitely. It is still possible for individual <code>fetch</code> requests to use <code>cache: 'no-store'</code> or <code>revalidate: 0</code> to avoid being cached and make the route dynamically rendered. Or set <code>revalidate</code> to a positive number lower than the route default to increase the revalidation frequency of a route.</li> <li>
<strong><code>0</code></strong>: Ensure a layout or page is always <a href="../../building-your-application/rendering/server-components.html#dynamic-rendering">dynamically rendered</a> even if no dynamic functions or uncached data fetches are discovered. This option changes the default of <code>fetch</code> requests that do not set a <code>cache</code> option to <code>'no-store'</code> but leaves <code>fetch</code> requests that opt into <code>'force-cache'</code> or use a positive <code>revalidate</code> as is.</li> <li>
<strong><code>number</code></strong>: (in seconds) Set the default revalidation frequency of a layout or page to <code>n</code> seconds.</li> </ul> <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>: The <code>revalidate</code> option is only available when using the <a href="../../building-your-application/rendering/edge-and-nodejs-runtimes.html#nodejs-runtime">Node.js Runtime</a>. This means using the <code>revalidate</code> option with <code>runtime = 'edge'</code> will not work.</p> </blockquote> <h4 id="revalidation-frequency" data-docs-heading="">Revalidation Frequency     </h4> <ul> <li>The lowest <code>revalidate</code> across each layout and page of a single route will determine the revalidation frequency of the <em>entire</em> route. This ensures that child pages are revalidated as frequently as their parent layouts.</li> <li>Individual <code>fetch</code> requests can set a lower <code>revalidate</code> than the route's default <code>revalidate</code> to increase the revalidation frequency of the entire route. This allows you to dynamically opt-in to more frequent revalidation for certain routes based on some criteria.</li> </ul> <h3 id="fetchcache" data-docs-heading="">fetchCache     </h3> <details><summary>This is an advanced option that should only be used if you specifically need to override the default behavior.</summary><p>By default, Next.js <strong>will cache</strong> any <code>fetch()</code> requests that are reachable <strong>before</strong> any <a href="#">dynamic functions</a> are used and <strong>will not cache</strong> <code>fetch</code> requests that are discovered <strong>after</strong> dynamic functions are used.</p>
<p><code>fetchCache</code> allows you to override the default <code>cache</code> option of all <code>fetch</code> requests in a layout or page.</p>
<div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const fetchCache = 'auto'
// 'auto' | 'default-cache' | 'only-cache'
// 'force-cache' | 'force-no-store' | 'default-no-store' | 'only-no-store'</pre></div>
<ul> <li>
<strong><code>'auto'</code></strong> (default): The default option to cache <code>fetch</code> requests before dynamic functions with the <code>cache</code> option they provide and not cache <code>fetch</code> requests after dynamic functions.</li> <li>
<strong><code>'default-cache'</code></strong>: Allow any <code>cache</code> option to be passed to <code>fetch</code> but if no option is provided then set the <code>cache</code> option to <code>'force-cache'</code>. This means that even <code>fetch</code> requests after dynamic functions are considered static.</li> <li>
<strong><code>'only-cache'</code></strong>: Ensure all <code>fetch</code> requests opt into caching by changing the default to <code>cache: 'force-cache'</code> if no option is provided and causing an error if any <code>fetch</code> requests use <code>cache: 'no-store'</code>.</li> <li>
<strong><code>'force-cache'</code></strong>: Ensure all <code>fetch</code> requests opt into caching by setting the <code>cache</code> option of all <code>fetch</code> requests to <code>'force-cache'</code>.</li> <li>
<strong><code>'default-no-store'</code></strong>: Allow any <code>cache</code> option to be passed to <code>fetch</code> but if no option is provided then set the <code>cache</code> option to <code>'no-store'</code>. This means that even <code>fetch</code> requests before dynamic functions are considered dynamic.</li> <li>
<strong><code>'only-no-store'</code></strong>: Ensure all <code>fetch</code> requests opt out of caching by changing the default to <code>cache: 'no-store'</code> if no option is provided and causing an error if any <code>fetch</code> requests use <code>cache: 'force-cache'</code>
</li> <li>
<strong><code>'force-no-store'</code></strong>: Ensure all <code>fetch</code> requests opt out of caching by setting the <code>cache</code> option of all <code>fetch</code> requests to <code>'no-store'</code>. This forces all <code>fetch</code> requests to be re-fetched every request even if they provide a <code>'force-cache'</code> option.</li> </ul>
<h4 id="cross-route-segment-behavior" data-docs-heading="">Cross-route segment behavior     </h4>
<ul> <li>Any options set across each layout and page of a single route need to be compatible with each other. <ul> <li>If both the <code>'only-cache'</code> and <code>'force-cache'</code> are provided, then <code>'force-cache'</code> wins. If both <code>'only-no-store'</code> and <code>'force-no-store'</code> are provided, then <code>'force-no-store'</code> wins. The force option changes the behavior across the route so a single segment with <code>'force-*'</code> would prevent any errors caused by <code>'only-*'</code>.</li> <li>The intention of the <code>'only-*'</code> and <code>force-*'</code> options is to guarantee the whole route is either fully static or fully dynamic. This means: <ul> <li>A combination of <code>'only-cache'</code> and <code>'only-no-store'</code> in a single route is not allowed.</li> <li>A combination of <code>'force-cache'</code> and <code>'force-no-store'</code> in a single route is not allowed.</li> </ul> </li> <li>A parent cannot provide <code>'default-no-store'</code> if a child provides <code>'auto'</code> or <code>'*-cache'</code> since that could make the same fetch have different behavior.</li> </ul> </li> <li>It is generally recommended to leave shared parent layouts as <code>'auto'</code> and customize the options where child segments diverge.</li> </ul></details> <h3 id="runtime" data-docs-heading="">runtime     </h3> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const runtime = 'nodejs'
// 'nodejs' | 'edge'</pre></div>  <ul> <li>
<strong><code>'nodejs'</code></strong> (default)</li> <li><strong><code>'edge'</code></strong></li> </ul> <p>Learn more about the <a href="../../building-your-application/rendering/edge-and-nodejs-runtimes.html">Edge and Node.js runtimes</a>.</p> <h3 id="preferredregion" data-docs-heading="">preferredRegion     </h3> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const preferredRegion = 'auto'
// 'auto' | 'global' | 'home' | ['iad1', 'sfo1']</pre></div>  <p>Support for <code>preferredRegion</code>, and regions supported, is dependent on your deployment platform.</p> <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>:</p> <ul> <li>If a <code>preferredRegion</code> is not specified, it will inherit the option of the nearest parent layout.</li> <li>The root layout defaults to <code>all</code> regions.</li> </ul> </blockquote> <h3 id="maxduration" data-docs-heading="">maxDuration     </h3> <p>By default, Next.js does not limit the execution of server-side logic (rendering a page or handling an API). Deployment platforms can use <code>maxDuration</code> from the Next.js build output to add specific execution limits. For example, on <a href="https://vercel.com/docs/functions/serverless-functions/runtimes#max-duration" rel="noopener noreferrer" target="_blank">Vercel</a>.</p> <p><strong>Note</strong>: This settings requires Next.js <code>13.4.10</code> or higher.</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">export const maxDuration = 5</pre></div>  <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>:</p> <ul> <li>If using <a href="../../building-your-application/data-fetching/server-actions-and-mutations.html">Server Actions</a>, set the <code>maxDuration</code> at the page level to change the default timeout of all Server Actions used on the page.</li> </ul> </blockquote> <h3 id="generatestaticparams" data-docs-heading="">generateStaticParams     </h3> <p>The <code>generateStaticParams</code> function can be used in combination with <a href="../../building-your-application/routing/dynamic-routes.html">dynamic route segments</a> to define the list of route segment parameters that will be statically generated at build time instead of on-demand at request time.</p> <p>See the <a href="../functions/generate-static-params.html">API reference</a> for more details.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>
    <a href="https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config" class="_attribution-link">https://nextjs.org/docs/app/api-reference/file-conventions/route-segment-config</a>
  </p>
</div>
