<h1>Using Google Analytics with Next.js (through `next/script`)</h1>
<blockquote class="p-3 text-sm"> <p>Prefer <code>next/script</code> component when using the inline script for Google Analytics.</p> </blockquote> <h2 id="why-this-error-occurred" data-docs-heading="">Why This Error Occurred     </h2> <p>An inline script was used for Google Analytics which might impact your webpage's performance. Instead, we recommend using <code>next/script</code> through the <code>@next/third-parties</code> library.</p> <h2 id="possible-ways-to-fix-it" data-docs-heading="">Possible Ways to Fix It     </h2> <h4 id="use-nextthird-parties-to-add-google-analytics" data-docs-heading="">Use @next/third-parties to add Google Analytics     </h4> <p><strong><code>@next/third-parties</code></strong> is a library that provides a collection of components and utilities that improve the performance and developer experience of loading popular third-party libraries in your Next.js application. It is available with Next.js 14 (install <code>next@latest</code>).</p> <p>The <code>GoogleAnalytics</code> component can be used to include <a href="https://developers.google.com/analytics/devguides/collection/ga4" rel="noopener noreferrer nofollow" target="_blank">Google Analytics 4</a> to your page via the Google tag (<code>gtag.js</code>). By default, it fetches the original scripts after hydration occurs on the page.</p> <blockquote class="p-3 text-sm"> <p><strong>Recommendation</strong>: If Google Tag Manager is already included in your application, you can configure Google Analytics directly using it, rather than including Google Analytics as a separate component. Refer to the <a href="https://developers.google.com/analytics/devguides/collection/ga4/tag-options#what-is-gtm" rel="noopener noreferrer nofollow" target="_blank">documentation</a> to learn more about the differences between Tag Manager and <code>gtag.js</code>.</p> </blockquote> <p>To load Google Analytics for all routes, include the component directly in your root layout and pass in your measurement ID:</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">import { GoogleAnalytics } from '@next/third-parties/google'
 
export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  return (
    &lt;html lang="en"&gt;
      &lt;body&gt;{children}&lt;/body&gt;
      &lt;GoogleAnalytics gaId="G-XYZ" /&gt;
    &lt;/html&gt;
  )
}</pre></div>  <p>To load Google Analytics for a single route, include the component in your page file:</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">import { GoogleAnalytics } from '@next/third-parties/google'
 
export default function Page() {
  return &lt;GoogleAnalytics gaId="G-XYZ" /&gt;
}</pre></div> <blockquote class="p-3 text-sm"> <p><strong>Good to know:</strong></p> <ul> <li>If you are using the Pages Router, please refer to the <a href="../pages/building-your-application/optimizing/third-party-libraries.html"><code>pages/</code> documentation</a>.</li> <li>
<code>@next/third-parties</code> also supports <a href="../app/building-your-application/optimizing/third-party-libraries.html#google-tag-manager">Google Tag Manager</a> and other third parties.</li> <li>Using <code>@next/third-parties</code> is not required. You can also use the <code>next/script</code> component directly. Refer to the <a href="../app/building-your-application/optimizing/scripts.html"><code>next/script</code> documentation</a> to learn more.</li> </ul> </blockquote> <h2 id="useful-links" data-docs-heading="">Useful Links     </h2> <ul> <li><a href="../app/building-your-application/optimizing/third-party-libraries.html"><code>@next/third-parties</code> Documentation</a></li> <li><a href="../app/building-your-application/optimizing/scripts.html"><code>next/script</code> Documentation</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>
    <a href="https://nextjs.org/docs/messages/next-script-for-ga" class="_attribution-link">https://nextjs.org/docs/messages/next-script-for-ga</a>
  </p>
</div>
