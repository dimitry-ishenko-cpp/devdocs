<h1 class="break-words">Automatic Static Optimization</h1>
<p>Next.js automatically determines that a page is static (can be prerendered) if it has no blocking data requirements. This determination is made by the absence of <code>getServerSideProps</code> and <code>getInitialProps</code> in the page.</p> <p>This feature allows Next.js to emit hybrid applications that contain <strong>both server-rendered and statically generated pages</strong>.</p> <blockquote class="p-3 text-sm"> <p>Statically generated pages are still reactive: Next.js will hydrate your application client-side to give it full interactivity.</p> </blockquote> <p>One of the main benefits of this feature is that optimized pages require no server-side computation, and can be instantly streamed to the end-user from multiple CDN locations. The result is an <em>ultra fast</em> loading experience for your users.</p> <h2 id="how-it-works" data-docs-heading="">How it works     </h2> <p>If <code>getServerSideProps</code> or <code>getInitialProps</code> is present in a page, Next.js will switch to render the page on-demand, per-request (meaning <a href="server-side-rendering.html">Server-Side Rendering</a>).</p> <p>If the above is not the case, Next.js will <strong>statically optimize</strong> your page automatically by prerendering the page to static HTML.</p> <p>During prerendering, the router's <code>query</code> object will be empty since we do not have <code>query</code> information to provide during this phase. After hydration, Next.js will trigger an update to your application to provide the route parameters in the <code>query</code> object.</p> <p>The cases where the query will be updated after hydration triggering another render are:</p> <ul> <li>The page is a <a href="../routing/dynamic-routes.html">dynamic-route</a>.</li> <li>The page has query values in the URL.</li> <li>
<a href="../../api-reference/next-config-js/rewrites.html">Rewrites</a> are configured in your <code>next.config.js</code> since these can have parameters that may need to be parsed and provided in the <code>query</code>.</li> </ul> <p>To be able to distinguish if the query is fully updated and ready for use, you can leverage the <code>isReady</code> field on <a href="../../api-reference/functions/use-router.html#router-object"><code>next/router</code></a>.</p> <blockquote class="p-3 text-sm"> <p><strong>Good to know</strong>: Parameters added with <a href="../routing/dynamic-routes.html">dynamic routes</a> to a page that's using <a href="../data-fetching/get-static-props.html"><code>getStaticProps</code></a> will always be available inside the <code>query</code> object.</p> </blockquote> <p><code>next build</code> will emit <code>.html</code> files for statically optimized pages. For example, the result for the page <code>pages/about.js</code> would be:</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">.next/server/pages/about.html</pre></div> <p>And if you add <code>getServerSideProps</code> to the page, it will then be JavaScript, like so:</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">.next/server/pages/about.js</pre></div> <h2 id="caveats" data-docs-heading="">Caveats     </h2> <ul> <li>If you have a <a href="../routing/custom-app.html">custom <code>App</code></a> with <code>getInitialProps</code> then this optimization will be turned off in pages without <a href="../data-fetching/get-static-props.html">Static Generation</a>.</li> <li>If you have a <a href="../routing/custom-document.html">custom <code>Document</code></a> with <code>getInitialProps</code> be sure you check if <code>ctx.req</code> is defined before assuming the page is server-side rendered. <code>ctx.req</code> will be <code>undefined</code> for pages that are prerendered.</li> <li>Avoid using the <code>asPath</code> value on <a href="../../api-reference/functions/use-router.html#router-object"><code>next/router</code></a> in the rendering tree until the router's <code>isReady</code> field is <code>true</code>. Statically optimized pages only know <code>asPath</code> on the client and not the server, so using it as a prop may lead to mismatch errors. The <a href="https://github.com/vercel/next.js/tree/canary/examples/active-class-name" rel="noopener noreferrer" target="_blank"><code>active-class-name</code> example</a> demonstrates one way to use <code>asPath</code> as a prop.</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>
    <a href="https://nextjs.org/docs/pages/building-your-application/rendering/automatic-static-optimization" class="_attribution-link">https://nextjs.org/docs/pages/building-your-application/rendering/automatic-static-optimization</a>
  </p>
</div>
