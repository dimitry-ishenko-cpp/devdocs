<h1 class="break-words">Version 11</h1>
<p>To upgrade to version 11, run the following command:</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">npm i next@11 react@17 react-dom@17</pre></div> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">yarn add next@11 react@17 react-dom@17</pre></div> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">pnpm up next@11 react@17 react-dom@17</pre></div> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD code-block_hideLineNumbers__52YKH not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">bun add next@11 react@17 react-dom@17</pre></div> <blockquote class="p-3 text-sm"> <p><strong>Good to know:</strong> If you are using TypeScript, ensure you also upgrade <code>@types/react</code> and <code>@types/react-dom</code> to their corresponding versions.</p> </blockquote> <h3 id="webpack-5" data-docs-heading="">Webpack 5     </h3> <p>Webpack 5 is now the default for all Next.js applications. If you did not have a custom webpack configuration, your application is already using webpack 5. If you do have a custom webpack configuration, you can refer to the <a href="../../../messages/webpack5.html">Next.js webpack 5 documentation</a> for upgrade guidance.</p> <h3 id="cleaning-the-distdir-is-now-a-default" data-docs-heading="">Cleaning the distDir is now a default     </h3> <p>The build output directory (defaults to <code>.next</code>) is now cleared by default except for the Next.js caches. You can refer to <a href="https://github.com/vercel/next.js/discussions/6009" rel="noopener noreferrer" target="_blank">the cleaning <code>distDir</code> RFC</a> for more information.</p> <p>If your application was relying on this behavior previously you can disable the new default behavior by adding the <code>cleanDistDir: false</code> flag in <code>next.config.js</code>.</p> <h3 id="port-is-now-supported-for-next-dev-and-next-start" data-docs-heading="">PORT is now supported for next dev and next start     </h3> <p>Next.js 11 supports the <code>PORT</code> environment variable to set the port the application runs on. Using <code>-p</code>/<code>--port</code> is still recommended but if you were prohibited from using <code>-p</code> in any way you can now use <code>PORT</code> as an alternative:</p> <p>Example:</p> <div class="code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose">
<pre class="code-block_pre___OLfy" data-language="typescript">PORT=4000 next start
</pre>
</div> <h3 id="nextconfigjs-customization-to-import-images" data-docs-heading="">next.config.js customization to import images     </h3> <p>Next.js 11 supports static image imports with <code>next/image</code>. This new feature relies on being able to process image imports. If you previously added the <code>next-images</code> or <code>next-optimized-images</code> packages you can either move to the new built-in support using <code>next/image</code> or disable the feature:</p> <div class="code-block_wrapper__t6FCO code-block_hasFileName__ezlBD not-prose"><pre class="code-block_pre___OLfy" data-language="typescript">module.exports = {
  images: {
    disableStaticImages: true,
  },
}</pre></div> <h3 id="remove-supercomponentdidcatch-from-pages_appjs" data-docs-heading="">Remove super.componentDidCatch() from pages/_app.js     </h3> <p>The <code>next/app</code> component's <code>componentDidCatch</code> was deprecated in Next.js 9 as it's no longer needed and has since been a no-op. In Next.js 11, it was removed.</p> <p>If your <code>pages/_app.js</code> has a custom <code>componentDidCatch</code> method you can remove <code>super.componentDidCatch</code> as it is no longer needed.</p> <h3 id="remove-container-from-pages_appjs" data-docs-heading="">Remove Container from pages/_app.js     </h3> <p>This export was deprecated in Next.js 9 as it's no longer needed and has since been a no-op with a warning during development. In Next.js 11 it was removed.</p> <p>If your <code>pages/_app.js</code> imports <code>Container</code> from <code>next/app</code> you can remove <code>Container</code> as it was removed. Learn more in <a href="../../../messages/app-container-deprecated.html">the documentation</a>.</p> <h3 id="remove-propsurl-usage-from-page-components" data-docs-heading="">Remove props.url usage from page components     </h3> <p>This property was deprecated in Next.js 4 and has since shown a warning during development. With the introduction of <code>getStaticProps</code> / <code>getServerSideProps</code> these methods already disallowed the usage of <code>props.url</code>. In Next.js 11, it was removed completely.</p> <p>You can learn more in <a href="../../../messages/url-deprecated.html">the documentation</a>.</p> <h3 id="remove-unsized-property-on-nextimage" data-docs-heading="">Remove unsized property on next/image     </h3> <p>The <code>unsized</code> property on <code>next/image</code> was deprecated in Next.js 10.0.1. You can use <code>layout="fill"</code> instead. In Next.js 11 <code>unsized</code> was removed.</p> <h3 id="remove-modules-property-on-nextdynamic" data-docs-heading="">Remove modules property on next/dynamic     </h3> <p>The <code>modules</code> and <code>render</code> option for <code>next/dynamic</code> were deprecated in Next.js 9.5. This was done in order to make the <code>next/dynamic</code> API closer to <code>React.lazy</code>. In Next.js 11, the <code>modules</code> and <code>render</code> options were removed.</p> <p>This option hasn't been mentioned in the documentation since Next.js 8 so it's less likely that your application is using it.</p> <p>If your application does use <code>modules</code> and <code>render</code> you can refer to <a href="../../../messages/next-dynamic-modules.html">the documentation</a>.</p> <h3 id="remove-headrewind" data-docs-heading="">Remove Head.rewind     </h3> <p><code>Head.rewind</code> has been a no-op since Next.js 9.5, in Next.js 11 it was removed. You can safely remove your usage of <code>Head.rewind</code>.</p> <h3 id="momentjs-locales-excluded-by-default" data-docs-heading="">Moment.js locales excluded by default     </h3> <p>Moment.js includes translations for a lot of locales by default. Next.js now automatically excludes these locales by default to optimize bundle size for applications using Moment.js.</p> <p>To load a specific locale use this snippet:</p> <div class="code-block_wrapper__t6FCO not-prose">
<pre class="code-block_pre___OLfy" data-language="typescript">import moment from 'moment'
import 'moment/locale/ja'
 
moment.locale('ja')</pre>
</div> <p>You can opt-out of this new default by adding <code>excludeDefaultMomentLocales: false</code> to <code>next.config.js</code> if you do not want the new behavior, do note it's highly recommended to not disable this new optimization as it significantly reduces the size of Moment.js.</p> <h3 id="update-usage-of-routerevents" data-docs-heading="">Update usage of router.events     </h3> <p>In case you're accessing <code>router.events</code> during rendering, in Next.js 11 <code>router.events</code> is no longer provided during pre-rendering. Ensure you're accessing <code>router.events</code> in <code>useEffect</code>:</p> <div class="code-block_wrapper__t6FCO not-prose">
<pre class="code-block_pre___OLfy" data-language="typescript">useEffect(() =&gt; {
  const handleRouteChange = (url, { shallow }) =&gt; {
    console.log(
      `App is changing to ${url} ${
        shallow ? 'with' : 'without'
      } shallow routing`
    )
  }
 
  router.events.on('routeChangeStart', handleRouteChange)
 
  // If the component is unmounted, unsubscribe
  // from the event with the `off` method:
  return () =&gt; {
    router.events.off('routeChangeStart', handleRouteChange)
  }
}, [router])</pre>
</div> <p>If your application uses <code>router.router.events</code> which was an internal property that was not public please make sure to use <code>router.events</code> as well.</p> <h2 id="react-16-to-17" data-docs-heading="">React 16 to 17     </h2> <p>React 17 introduced a new <a href="https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html" rel="noopener noreferrer nofollow" target="_blank">JSX Transform</a> that brings a long-time Next.js feature to the wider React ecosystem: Not having to <code>import React from 'react'</code> when using JSX. When using React 17 Next.js will automatically use the new transform. This transform does not make the <code>React</code> variable global, which was an unintended side-effect of the previous Next.js implementation. A <a href="codemods.html#add-missing-react-import">codemod is available</a> to automatically fix cases where you accidentally used <code>React</code> without importing it.</p> <p>Most applications already use the latest version of React, with Next.js 11 the minimum React version has been updated to 17.0.2.</p> <p>To upgrade you can run the following command:</p> <div class="code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose">
<pre class="code-block_pre___OLfy" data-language="typescript">npm install react@latest react-dom@latest
</pre>
</div> <p>Or using <code>yarn</code>:</p> <div class="code-block_wrapper__t6FCO code-block_hideLineNumbers__52YKH not-prose">
<pre class="code-block_pre___OLfy" data-language="typescript">yarn add react@latest react-dom@latest
</pre>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024 Vercel, Inc.<br>Licensed under the MIT License.<br>
    <a href="https://nextjs.org/docs/pages/building-your-application/upgrading/version-11" class="_attribution-link">https://nextjs.org/docs/pages/building-your-application/upgrading/version-11</a>
  </p>
</div>
