<div class="sphx-glr-download-link-note admonition note"> <p class="admonition-title">Note</p> <p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-ensemble-plot-gradient-boosting-early-stopping-py"><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p> </div> <section class="sphx-glr-example-title" id="early-stopping-of-gradient-boosting"> <h1 id="sphx-glr-auto-examples-ensemble-plot-gradient-boosting-early-stopping-py">Early stopping of Gradient Boosting</h1> <p>Gradient boosting is an ensembling technique where several weak learners (regression trees) are combined to yield a powerful single model, in an iterative fashion.</p> <p>Early stopping support in Gradient Boosting enables us to find the least number of iterations which is sufficient to build a model that generalizes well to unseen data.</p> <p>The concept of early stopping is simple. We specify a <code>validation_fraction</code> which denotes the fraction of the whole dataset that will be kept aside from training to assess the validation loss of the model. The gradient boosting model is trained using the training set and evaluated using the validation set. When each additional stage of regression tree is added, the validation set is used to score the model. This is continued until the scores of the model in the last <code>n_iter_no_change</code> stages do not improve by at least <code>tol</code>. After that the model is considered to have converged and further addition of stages is “stopped early”.</p> <p>The number of stages of the final model is available at the attribute <code>n_estimators_</code>.</p> <p>This example illustrates how the early stopping can used in the <a class="reference internal" href="../../modules/generated/sklearn.ensemble.gradientboostingclassifier.html#sklearn.ensemble.GradientBoostingClassifier" title="sklearn.ensemble.GradientBoostingClassifier"><code>GradientBoostingClassifier</code></a> model to achieve almost the same accuracy as compared to a model built without early stopping using many fewer estimators. This can significantly reduce training time, memory usage and prediction latency.</p> <pre data-language="python"># Authors: Vighnesh Birodkar &lt;vighneshbirodkar@nyu.edu&gt;
#          Raghav RV &lt;rvraghav93@gmail.com&gt;
# License: BSD 3 clause

import time

import numpy as np
import matplotlib.pyplot as plt

from sklearn import ensemble
from sklearn import datasets
from sklearn.model_selection import train_test_split

data_list = [
    datasets.load_iris(return_X_y=True),
    datasets.make_classification(n_samples=800, random_state=0),
    datasets.make_hastie_10_2(n_samples=2000, random_state=0),
]
names = ["Iris Data", "Classification Data", "Hastie Data"]

n_gb = []
score_gb = []
time_gb = []
n_gbes = []
score_gbes = []
time_gbes = []

n_estimators = 200

for X, y in data_list:
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.2, random_state=0
    )

    # We specify that if the scores don't improve by at least 0.01 for the last
    # 10 stages, stop fitting additional stages
    gbes = ensemble.GradientBoostingClassifier(
        n_estimators=n_estimators,
        validation_fraction=0.2,
        n_iter_no_change=5,
        tol=0.01,
        random_state=0,
    )
    gb = ensemble.GradientBoostingClassifier(n_estimators=n_estimators, random_state=0)
    start = time.time()
    gb.fit(X_train, y_train)
    time_gb.append(time.time() - start)

    start = time.time()
    gbes.fit(X_train, y_train)
    time_gbes.append(time.time() - start)

    score_gb.append(gb.score(X_test, y_test))
    score_gbes.append(gbes.score(X_test, y_test))

    n_gb.append(gb.n_estimators_)
    n_gbes.append(gbes.n_estimators_)

bar_width = 0.2
n = len(data_list)
index = np.arange(0, n * bar_width, bar_width) * 2.5
index = index[0:n]
</pre> <section id="compare-scores-with-and-without-early-stopping"> <h2>Compare scores with and without early stopping</h2> <pre data-language="python">plt.figure(figsize=(9, 5))

bar1 = plt.bar(
    index, score_gb, bar_width, label="Without early stopping", color="crimson"
)
bar2 = plt.bar(
    index + bar_width, score_gbes, bar_width, label="With early stopping", color="coral"
)

plt.xticks(index + bar_width, names)
plt.yticks(np.arange(0, 1.3, 0.1))


def autolabel(rects, n_estimators):
    """
    Attach a text label above each bar displaying n_estimators of each model
    """
    for i, rect in enumerate(rects):
        plt.text(
            rect.get_x() + rect.get_width() / 2.0,
            1.05 * rect.get_height(),
            "n_est=%d" % n_estimators[i],
            ha="center",
            va="bottom",
        )


autolabel(bar1, n_gb)
autolabel(bar2, n_gbes)

plt.ylim([0, 1.3])
plt.legend(loc="best")
plt.grid(True)

plt.xlabel("Datasets")
plt.ylabel("Test score")

plt.show()
</pre> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_gradient_boosting_early_stopping_001.png" alt="plot gradient boosting early stopping" class="sphx-glr-single-img"></section> <section id="compare-fit-times-with-and-without-early-stopping"> <h2>Compare fit times with and without early stopping</h2> <pre data-language="python">plt.figure(figsize=(9, 5))

bar1 = plt.bar(
    index, time_gb, bar_width, label="Without early stopping", color="crimson"
)
bar2 = plt.bar(
    index + bar_width, time_gbes, bar_width, label="With early stopping", color="coral"
)

max_y = np.amax(np.maximum(time_gb, time_gbes))

plt.xticks(index + bar_width, names)
plt.yticks(np.linspace(0, 1.3 * max_y, 13))

autolabel(bar1, n_gb)
autolabel(bar2, n_gbes)

plt.ylim([0, 1.3 * max_y])
plt.legend(loc="best")
plt.grid(True)

plt.xlabel("Datasets")
plt.ylabel("Fit Time")

plt.show()
</pre> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_gradient_boosting_early_stopping_002.png" alt="plot gradient boosting early stopping" class="sphx-glr-single-img"><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 2.364 seconds)</p> <div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-ensemble-plot-gradient-boosting-early-stopping-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/1.1.X?urlpath=lab/tree/notebooks/auto_examples/ensemble/plot_gradient_boosting_early_stopping.ipynb"><img alt="Launch binder" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA5IiBoZWlnaHQ9IjIwIj48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgyPSIwIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYmJiIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9ImEiPjxyZWN0IHdpZHRoPSIxMDkiIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoNjR2MjBIMHoiLz48cGF0aCBmaWxsPSIjNTc5YWNhIiBkPSJNNjQgMGg0NXYyMEg2NHoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMCAwaDEwOXYyMEgweiIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iRGVqYVZ1IFNhbnMsVmVyZGFuYSxHZW5ldmEsc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRmtBQUFCWkNBTUFBQUJpMVhpZEFBQUI4bEJNVkVYLy8vOVhtc3JtWllIMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sSlhtc3JtWllIMW9sTDFvbEwwbkZmMW9sSlhtc3JtWllIMW9sSlhtc3E4ZFpiMW9sSlhtc3JtWllIMW9sSlhtc3BYbXNwWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sTGVhSVZYbXNybVpZSDFvbEwxb2xMMW9sSlhtc3JtWllIMW9sTG5hMzFYbXNyMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xMcW9WcjFvbEpYbXNyMW9sSlhtc3JtWllIMW9sTDFvbEtrZmFQb2JYdnZpR2FiZ2FkWG1zcVRoS3VvZktIbVo0RG9ibnIxb2xKWG1zcjFvbEpYbXNwWG1zcjFvbEpYbXNyZlo0VHVoV24xb2xMMW9sSlhtc3FCaTdYMW9sSlhtc3BabXNsYm1NaGJtc2RlbXNWZmw4Wmdtc05pbThKcGs4RjBtN1I0bTdGNW5MQjZqYmg3amJpRGlyT0VpYk9HbkthTWhxK1BuYUNWZzZxV2c2cWVnS2FmZjZXaG5wS29mS0d0bm9teGVaeTNub0c2ZFppK24zdkNjcFBEY3BQR24zYkxiNC9NYjQ3VWJJclZhNHJZb0dqZGFJYmVhSVhob1dIbVpZSG9iWHZwY0hqcWRIWHJlSExyb1Zyc2ZHL3VoR251aDJid2oySHhrMTd5bDF2em1sanptMWowbmxYMW9sTDNBSlhXQUFBQWJYUlNUbE1BRUJBUUh4OGdJQ0F1TGpBd01EdzlQVUJBUUVwUVVGQlhWMWhnWUdCa2NIQndjWGw4Z0lDQWdvaUlrSkNRbEppY25KMmdvS0NtcUsrd3NMQzR1c0RBd01qUDBORFExTmJXM056ZzRPRGk1KzN2OFBEdzgvVDA5UFgyOXZiMzkvZjUrZnI3Ky96OC9QejkvdjcremN6Q3hnQUFCQzVKUkVGVWVBSE4xdWwzazBVVUJ2Q2IxQ1RWcG1wYWl0QUdTTFNwU3VLQ0xXcGJUS05KRkdsY1NNQUZGNjNpVW1SY2NORzZnTGJ1eGtYVTY2SkFVZWYvOUxTcG1YbnlMcjNUNUFPL3J6bDV6ajEzN3AxMzZCSVN5NDRmS0pYdUdOL2QxOVBVZlllTzY3Wm5xdGYyS0gzM0lkMXBzWG9GZFczMHNQWjFzTXZzMkQwNjBBSHF3czRGSGVKb2pMWnFudzUzY21mdmcrWFI4bUMwT0VqdXhyWEVrWDV5ZGVWSkxWSWxWMGUxMFBYazVrN2RZZUh1N0NqMWorNDl1S2c3dUxVNjF0R0x3MWxxMjd1Z1FZbGNsSEM0Ymd2N1ZRK1RBeWo1WmMvVWpzUHZzMXNkNWNXcnlXT2J0dldUMkVQYTRydG5XVzNKa3BqZ2dFcGJPc1ByN0Y3RXlOZXd0cEJJc2xBN3A0M0hDc253b29YVEVjM1VtUG1DTm41bHJxVEp4eTZuUm1jYXZHWlZ0LzNEYTJwRDVOSHZzT0hKQ3JkYzFHMnIzRElUcFU3eWljN3cvN1J4bmpjMGt0NUdDNGRqaXYyU3ozRmIyaUVaZzQxL2Rkc0ZEb3l1WXJJa21GZWh6MEhSMnRoUGdRcU15UVliMk90QjBXeHNaM0JlRzMrd3BSYjF2emwyVVlCb2c4RmZHaHR0RktqdEFjbG5aWXJSbzlyeUc5dUcvRlpRVTRBRWc4WkU5TGpHTXpUbXFLWFBMbmxXVm5JbFFRVHZ4SmY4aXA3VmdqWmp5VlByancxdGU1b3RNN1JtUDd4bStzSzJHdjlJOEdpKytCUmJFa1I5RUJ3OHpSVWNLeHdwNzN4a2FMaXFRYitrR2R1SlROSEc3MnpjVzlMb0pncVF4cFAzL1RqLy9jM3lCMHRxemFtbDA1LytvckhMa3NWTys5NWtYNy83cWdKdm5qbHJmcjJHZ3N5eDBlb3k5dVB6TjVTUGQ4NmFYZ2dPc0VLVzJQcno3ZHUzVklEMy90enMvc1NSczJ3N292VkhLdGpyWDJwZDdaTWxUeEFZZkJBTDlqaUR3ZkxrcTU1VG03aWZoTWxUR1B5Q0FzN1JGUmhuNDdKbmxjQjlSTTVUOTdBU3VaWEljVk51VURJbmRwRGJkc2ZycXNPcHBlWGw1WStYVktkakZDVGgrekdhVnVqMGQ5enkwNVBQSzNRekJhbXhkd3RUQ3J6eWcvMlJ2ZjJFc3RVam9yZEd3YS9reDltU0pMcjhtTEx0Q1c4SEhHSmMyUjVoUzIxOUlpRjZQblR1c09xY01sNTdnbTBaOGthbktNQVFnMHFTeXVaZm43ekl0c2JHeU85UWxueFkwZUN1RDFYTDJ5cy9Nc3JRaGx0RTdVZzB1Rk96dWZKRkUyUHhCby9ZQXg4WFBQZER3V04wTXJEUllJWkYwbVNNS0NOSGdhSVZGb0JiTm9MSjd0RVFES3hHRjBrY0xRaW1vakNab3B2ME9rTk95V0NDZzlYTVZBaTdBUkp6UWRNMlFVaDBnbUJvempjM1NrZzZkU0JScURHWVNVT3U2NlpnK0kyZk5acy9NMy9mL0dybC9YbnlGMUd3M1ZLQ2V6MFBONUlVZkZMcXZnVU40QzBxTnFZczVZaFBMK2FWWllERTRJcFVrNTdvU0ZuSm00RnlDcXFPRTBqaFkyU015TEZvbzU2enlvNmJlY09TNVVWRGRqN1ZpaDB6cCt0Y01od1JwQmVMeXF0SWpsSktBSVpTYkk4U0dTRjNrMHBBM21SNXRIdXdQRm9hN043cmVvcTJicUNzQWsxSHFDdTV1dkkxbjZKdVJYSStTMU1jbzU0WW1ZVHdjbjZBZWljK2tzc1hpOFhwWEM0VjN0Ny9BRHVUTkthUUpkU2NBQUFBQUVsRlRrU3VRbUNDIi8+IDx0ZXh0IHg9IjQxNSIgeT0iMTUwIiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzcwIj5sYXVuY2g8L3RleHQ+PHRleHQgeD0iNDE1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIzNzAiPmxhdW5jaDwvdGV4dD48dGV4dCB4PSI4NTUiIHk9IjE1MCIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9IjM1MCI+YmluZGVyPC90ZXh0Pjx0ZXh0IHg9Ijg1NSIgeT0iMTQwIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzUwIj5iaW5kZXI8L3RleHQ+PC9nPiA8L3N2Zz4=" width="150px"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/be911e971b87fe80b6899069dbcfb737/plot_gradient_boosting_early_stopping.py"><code>Download Python source code: plot_gradient_boosting_early_stopping.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/8452fc8dfe9850cfdaa1b758e5a2748b/plot_gradient_boosting_early_stopping.ipynb"><code>Download Jupyter notebook: plot_gradient_boosting_early_stopping.ipynb</code></a></p> </div> </div>  </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2022 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.1/auto_examples/ensemble/plot_gradient_boosting_early_stopping.html" class="_attribution-link">https://scikit-learn.org/1.1/auto_examples/ensemble/plot_gradient_boosting_early_stopping.html</a>
  </p>
</div>
