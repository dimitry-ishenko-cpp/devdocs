<h1 id="torch-func-grad-and-value">torch.func.grad_and_value</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.func.grad_and_value">
<code>torch.func.grad_and_value(func, argnums=0, has_aux=False)</code> </dt> <dd>
<p>Returns a function to compute a tuple of the gradient and primal, or forward, computation.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>func</strong> (<em>Callable</em>) – A Python function that takes one or more arguments. Must return a single-element Tensor. If specified <code>has_aux</code> equals <code>True</code>, function can return a tuple of single-element Tensor and other auxiliary objects: <code>(output, aux)</code>.</li> <li>
<strong>argnums</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a><em> or </em><em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a><em>]</em>) – Specifies arguments to compute gradients with respect to. <code>argnums</code> can be single integer or tuple of integers. Default: 0.</li> <li>
<strong>has_aux</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a>) – Flag indicating that <code>func</code> returns a tensor and other auxiliary objects: <code>(output, aux)</code>. Default: False.</li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Function to compute a tuple of gradients with respect to its inputs and the forward computation. By default, the output of the function is a tuple of the gradient tensor(s) with respect to the first argument and the primal computation. If specified <code>has_aux</code> equals <code>True</code>, tuple of gradients and tuple of the forward computation with output auxiliary objects is returned. If <code>argnums</code> is a tuple of integers, a tuple of a tuple of the output gradients with respect to each <code>argnums</code> value and the forward computation is returned.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)">Callable</a></p> </dd> </dl> <p>See <a class="reference internal" href="torch.func.grad.html#torch.func.grad" title="torch.func.grad"><code>grad()</code></a> for examples</p> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.func.grad_and_value.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.func.grad_and_value.html</a>
  </p>
</div>
