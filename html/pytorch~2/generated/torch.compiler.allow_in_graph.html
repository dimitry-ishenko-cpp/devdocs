<h1 id="torch-compiler-allow-in-graph">torch.compiler.allow_in_graph</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.compiler.allow_in_graph">
<code>torch.compiler.allow_in_graph(fn)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/compiler.html#allow_in_graph"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Customize which functions compilation will include in the generated graph. It bypasses all introspection of the symbolic python code in favor of directly writing it to the graph. If fn is a list or tuple of callables it recursively applies <a class="reference internal" href="#torch.compiler.allow_in_graph" title="torch.compiler.allow_in_graph"><code>allow_in_graph()</code></a> to each function and returns a new list or tuple containing the modified functions</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>fn</strong> â€“ A callable representing the function to be included in the graph.</p> </dd> </dl> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p><a class="reference internal" href="#torch.compiler.allow_in_graph" title="torch.compiler.allow_in_graph"><code>allow_in_graph()</code></a> skips TorchDynamo completely on the decorated function skipping all TorchDynamo safety checks (graph breaks, handling closures, etc). Therefore, one has to be very careful with <a class="reference internal" href="#torch.compiler.allow_in_graph" title="torch.compiler.allow_in_graph"><code>allow_in_graph()</code></a> since subsystems like AOT Autograd rely on torchdynamo If not careful, this could lead to soundness and really hard-to-debug issues.</p> </div> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.compiler.allow_in_graph.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.compiler.allow_in_graph.html</a>
  </p>
</div>
