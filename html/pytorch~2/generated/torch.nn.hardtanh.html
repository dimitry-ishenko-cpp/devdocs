<h1 id="hardtanh">Hardtanh</h1> <dl class="py class"> <dt class="sig sig-object py" id="torch.nn.Hardtanh">
<code>class torch.nn.Hardtanh(min_val=-1.0, max_val=1.0, inplace=False, min_value=None, max_value=None)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/activation.html#Hardtanh"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Applies the HardTanh function element-wise.</p> <p>HardTanh is defined as:</p> <div class="math"> <span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>HardTanh</mtext><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>max_val</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>x</mi><mo>&gt;</mo><mtext> max_val </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>min_val</mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>x</mi><mo>&lt;</mo><mtext> min_val </mtext></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mi>x</mi></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext> otherwise </mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\text{HardTanh}(x) = \begin{cases} \text{max\_val} &amp; \text{ if } x &gt; \text{ max\_val } \\ \text{min\_val} &amp; \text{ if } x &lt; \text{ min\_val } \\ x &amp; \text{ otherwise } \\ \end{cases} </annotation></semantics></math></span></span></span>
</div>
<dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>min_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>) – minimum value of the linear region range. Default: -1</li> <li>
<strong>max_val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>) – maximum value of the linear region range. Default: 1</li> <li>
<strong>inplace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a>) – can optionally do the operation in-place. Default: <code>False</code>
</li> </ul> </dd> </dl> <p>Keyword arguments <code>min_value</code> and <code>max_value</code> have been deprecated in favor of <code>min_val</code> and <code>max_val</code>.</p> <dl class="simple"> <dt>Shape:</dt>
<dd>
<ul class="simple"> <li>Input: <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(*)</annotation></semantics></math></span></span></span>, where <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∗</mo></mrow><annotation encoding="application/x-tex">*</annotation></semantics></math></span></span></span> means any number of dimensions.</li> <li>Output: <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mo>∗</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(*)</annotation></semantics></math></span></span></span>, same shape as the input.</li> </ul> </dd> </dl> <img alt="../_images/Hardtanh.png" src="data:image/png;base64,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"> <p>Examples:</p> <pre data-language="python">&gt;&gt;&gt; m = nn.Hardtanh(-2, 2)
&gt;&gt;&gt; input = torch.randn(2)
&gt;&gt;&gt; output = m(input)
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.nn.Hardtanh.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.nn.Hardtanh.html</a>
  </p>
</div>
