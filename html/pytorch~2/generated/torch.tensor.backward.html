<h1 id="torch-tensor-backward">torch.Tensor.backward</h1> <dl class="py method"> <dt class="sig sig-object py" id="torch.Tensor.backward">
<code>Tensor.backward(gradient=None, retain_graph=None, create_graph=False, inputs=None)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/_tensor.html#Tensor.backward"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Computes the gradient of current tensor wrt graph leaves.</p> <p>The graph is differentiated using the chain rule. If the tensor is non-scalar (i.e. its data has more than one element) and requires gradient, the function additionally requires specifying <code>gradient</code>. It should be a tensor of matching type and location, that contains the gradient of the differentiated function w.r.t. <code>self</code>.</p> <p>This function accumulates gradients in the leaves - you might need to zero <code>.grad</code> attributes or set them to <code>None</code> before calling it. See <a class="reference internal" href="../autograd.html#default-grad-layouts"><span class="std std-ref">Default gradient layouts</span></a> for details on the memory layout of accumulated gradients.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If you run any forward ops, create <code>gradient</code>, and/or call <code>backward</code> in a user-specified CUDA stream context, see <a class="reference internal" href="https://pytorch.org/docs/2.1/notes/cuda.html#bwd-cuda-stream-semantics"><span class="std std-ref">Stream semantics of backward passes</span></a>.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>When <code>inputs</code> are provided and a given input is not a leaf, the current implementation will call its grad_fn (though it is not strictly needed to get this gradients). It is an implementation detail on which the user should not rely. See <a class="reference external" href="https://github.com/pytorch/pytorch/pull/60521#issuecomment-867061780">https://github.com/pytorch/pytorch/pull/60521#issuecomment-867061780</a> for more details.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>gradient</strong> (<a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">Tensor</a><em> or </em><em>None</em>) – Gradient w.r.t. the tensor. If it is a tensor, it will be automatically converted to a Tensor that does not require grad unless <code>create_graph</code> is True. None values can be specified for scalar Tensors or ones that don’t require grad. If a None value would be acceptable then this argument is optional.</li> <li>
<strong>retain_graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If <code>False</code>, the graph used to compute the grads will be freed. Note that in nearly all cases setting this option to True is not needed and often can be worked around in a much more efficient way. Defaults to the value of <code>create_graph</code>.</li> <li>
<strong>create_graph</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)">bool</a><em>, </em><em>optional</em>) – If <code>True</code>, graph of the derivative will be constructed, allowing to compute higher order derivative products. Defaults to <code>False</code>.</li> <li>
<strong>inputs</strong> (<em>sequence</em><em> of </em><a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">Tensor</a>) – Inputs w.r.t. which the gradient will be accumulated into <code>.grad</code>. All other Tensors will be ignored. If not provided, the gradient is accumulated into all the leaf Tensors that were used to compute the attr::tensors.</li> </ul> </dd> </dl> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.Tensor.backward.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.Tensor.backward.html</a>
  </p>
</div>
