<h1 id="torch-set-default-device">torch.set_default_device</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.set_default_device">
<code>torch.set_default_device(device)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch.html#set_default_device"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Sets the default <code>torch.Tensor</code> to be allocated on <code>device</code>. This does not affect factory function calls which are called with an explicit <code>device</code> argument. Factory calls will be performed as if they were passed <code>device</code> as an argument.</p> <p>To only temporarily change the default device instead of setting it globally, use <code>with torch.device(device):</code> instead.</p> <p>The default device is initially <code>cpu</code>. If you set the default tensor device to another device (e.g., <code>cuda</code>) without a device index, tensors will be allocated on whatever the current device for the device type, even after <a class="reference internal" href="torch.cuda.set_device.html#torch.cuda.set_device" title="torch.cuda.set_device"><code>torch.cuda.set_device()</code></a> is called.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>This function imposes a slight performance cost on every Python call to the torch API (not just factory functions). If this is causing problems for you, please comment on <a class="reference external" href="https://github.com/pytorch/pytorch/issues/92701">https://github.com/pytorch/pytorch/issues/92701</a></p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>device</strong> (<a class="reference internal" href="../tensor_attributes.html#torch.device" title="torch.device">device</a><em> or </em><em>string</em>) â€“ the device to set as default</p> </dd> </dl> <p>Example:</p> <pre data-language="python">&gt;&gt;&gt; torch.tensor([1.2, 3]).device
device(type='cpu')
&gt;&gt;&gt; torch.set_default_device('cuda')  # current device is 0
&gt;&gt;&gt; torch.tensor([1.2, 3]).device
device(type='cuda', index=0)
&gt;&gt;&gt; torch.set_default_device('cuda:1')
&gt;&gt;&gt; torch.tensor([1.2, 3]).device
device(type='cuda', index=1)
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.set_default_device.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.set_default_device.html</a>
  </p>
</div>
