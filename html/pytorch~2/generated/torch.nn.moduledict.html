<h1 id="moduledict">ModuleDict</h1> <dl class="py class"> <dt class="sig sig-object py" id="torch.nn.ModuleDict">
<code>class torch.nn.ModuleDict(modules=None)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Holds submodules in a dictionary.</p> <p><a class="reference internal" href="#torch.nn.ModuleDict" title="torch.nn.ModuleDict"><code>ModuleDict</code></a> can be indexed like a regular Python dictionary, but modules it contains are properly registered, and will be visible by all <a class="reference internal" href="torch.nn.module.html#torch.nn.Module" title="torch.nn.Module"><code>Module</code></a> methods.</p> <p><a class="reference internal" href="#torch.nn.ModuleDict" title="torch.nn.ModuleDict"><code>ModuleDict</code></a> is an <strong>ordered</strong> dictionary that respects</p> <ul class="simple"> <li>the order of insertion, and</li> <li>in <a class="reference internal" href="#torch.nn.ModuleDict.update" title="torch.nn.ModuleDict.update"><code>update()</code></a>, the order of the merged <code>OrderedDict</code>, <code>dict</code> (started from Python 3.6) or another <a class="reference internal" href="#torch.nn.ModuleDict" title="torch.nn.ModuleDict"><code>ModuleDict</code></a> (the argument to <a class="reference internal" href="#torch.nn.ModuleDict.update" title="torch.nn.ModuleDict.update"><code>update()</code></a>).</li> </ul> <p>Note that <a class="reference internal" href="#torch.nn.ModuleDict.update" title="torch.nn.ModuleDict.update"><code>update()</code></a> with other unordered mapping types (e.g., Python’s plain <code>dict</code> before Python version 3.6) does not preserve the order of the merged mapping.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>modules</strong> (<em>iterable</em><em>, </em><em>optional</em>) – a mapping (dictionary) of (string: module) or an iterable of key-value pairs of type (string, module)</p> </dd> </dl> <p>Example:</p> <pre data-language="python">class MyModule(nn.Module):
    def __init__(self):
        super().__init__()
        self.choices = nn.ModuleDict({
                'conv': nn.Conv2d(10, 10, 3),
                'pool': nn.MaxPool2d(3)
        })
        self.activations = nn.ModuleDict([
                ['lrelu', nn.LeakyReLU()],
                ['prelu', nn.PReLU()]
        ])

    def forward(self, x, choice, act):
        x = self.choices[choice](x)
        x = self.activations[act](x)
        return x
</pre> <dl class="py method"> <dt class="sig sig-object py" id="torch.nn.ModuleDict.clear">
<code>clear()</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict.clear"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Remove all items from the ModuleDict.</p>  </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="torch.nn.ModuleDict.items">
<code>items()</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict.items"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Return an iterable of the ModuleDict key/value pairs.</p> <dl class="field-list simple"> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)">Iterable</a>[<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)">Tuple</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>, <a class="reference internal" href="torch.nn.module.html#torch.nn.Module" title="torch.nn.modules.module.Module">Module</a>]]</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="torch.nn.ModuleDict.keys">
<code>keys()</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict.keys"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Return an iterable of the ModuleDict keys.</p> <dl class="field-list simple"> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)">Iterable</a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>]</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="torch.nn.ModuleDict.pop">
<code>pop(key)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict.pop"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Remove key from the ModuleDict and return its module.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – key to pop from the ModuleDict</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference internal" href="torch.nn.module.html#torch.nn.Module" title="torch.nn.modules.module.Module">Module</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="torch.nn.ModuleDict.update">
<code>update(modules)</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict.update"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Update the <a class="reference internal" href="#torch.nn.ModuleDict" title="torch.nn.ModuleDict"><code>ModuleDict</code></a> with the key-value pairs from a mapping or an iterable, overwriting existing keys.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If <a class="reference internal" href="../nn.html#module-torch.nn.modules" title="torch.nn.modules"><code>modules</code></a> is an <code>OrderedDict</code>, a <a class="reference internal" href="#torch.nn.ModuleDict" title="torch.nn.ModuleDict"><code>ModuleDict</code></a>, or an iterable of key-value pairs, the order of new elements in it is preserved.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>modules</strong> (<em>iterable</em>) – a mapping (dictionary) from string to <a class="reference internal" href="torch.nn.module.html#torch.nn.Module" title="torch.nn.Module"><code>Module</code></a>, or an iterable of key-value pairs of type (string, <a class="reference internal" href="torch.nn.module.html#torch.nn.Module" title="torch.nn.Module"><code>Module</code></a>)</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="torch.nn.ModuleDict.values">
<code>values()</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/nn/modules/container.html#ModuleDict.values"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Return an iterable of the ModuleDict values.</p> <dl class="field-list simple"> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.12)">Iterable</a>[<a class="reference internal" href="torch.nn.module.html#torch.nn.Module" title="torch.nn.modules.module.Module">Module</a>]</p> </dd> </dl> </dd>
</dl> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.nn.ModuleDict.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.nn.ModuleDict.html</a>
  </p>
</div>
