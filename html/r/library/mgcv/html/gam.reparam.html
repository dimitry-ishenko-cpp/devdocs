<div class="container">
<main>  <h2>
<code>gam.reparam</code> Finding stable orthogonal re-parameterization of the square root penalty.</h2> <h3>Description</h3> <p>INTERNAL function for finding an orthogonal re-parameterization which avoids "dominant machine zero leakage" between components of the square root penalty. </p> <h3>Usage</h3> <pre data-language="r"><code class="language-R">gam.reparam(rS, lsp, deriv)
</code></pre> <h3>Arguments</h3> <table> <tr>
<td><code id="rS">rS</code></td> <td> <p>list of the square root penalties: last entry is root of fixed penalty, if <code>fixed.penalty==TRUE</code> (i.e. <code>length(rS)&gt;length(sp)</code>). The assumption here is that <code>rS[[i]]</code> are in a null space of total penalty already; see e.g. <code>totalPenaltySpace</code> and <code>mini.roots</code>.</p> </td>
</tr> <tr>
<td><code id="lsp">lsp</code></td> <td> <p>vector of log smoothing parameters.</p> </td>
</tr> <tr>
<td><code id="deriv">deriv</code></td> <td> <p>if <code>deriv==1</code> also the first derivative of the log-determinant of the penalty matrix is returned, if <code>deriv&gt;1</code> also the second derivative is returned.</p> </td>
</tr> </table> <h3>Value</h3> <p>A list containing </p> <ul> <li>
<p><code>S</code>: the total penalty matrix similarity transformed for stability. </p> </li> <li>
<p><code>rS</code>: the component square roots, transformed in the same way. </p> </li> <li>
<p><code>Qs</code>: the orthogonal transformation matrix <code>S = t(Qs)%*%S0%*%Qs</code>, where <code>S0</code> is the untransformed total penalty implied by <code>sp</code> and <code>rS</code> on input. </p> </li> <li>
<p><code>det</code>: log|S|. </p> </li> <li>
<p><code>det1</code>: dlog|S|/dlog(sp) if <code>deriv &gt;0</code>. </p> </li> <li>
<p><code>det2</code>: hessian of log|S| wrt log(sp) if <code>deriv&gt;1</code>. </p> </li>
</ul> <h3>Author(s)</h3> <p>Simon N. Wood &lt;simon.wood@r-project.org&gt;. </p> </main> </div><div class="_attribution">
  <p class="_attribution-p">
    Copyright (&copy;) 1999â€“2012 R Foundation for Statistical Computing.<br>Licensed under the <a href="https://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>.<br>
    
  </p>
</div>
