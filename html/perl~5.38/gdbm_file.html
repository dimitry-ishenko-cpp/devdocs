<h1>GDBM_File</h1>   <h2><a id="toc">CONTENTS</a></h2> <ul> <li> <a class="text-decoration-none" href="#NAME">NAME</a> </li> <li> <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a> </li> <li> <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a> <ul> <li> <a class="text-decoration-none" href="#Tie">Tie</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#STATIC-METHODS">STATIC METHODS</a> <ul> <li> <a class="text-decoration-none" href="#GDBM_version">GDBM_version</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#ERROR-HANDLING">ERROR HANDLING</a> <ul> <li> <a class="text-decoration-none" href="#$GDBM_File::gdbm_errno">$GDBM_File::gdbm_errno</a> </li> <li> <a class="text-decoration-none" href="#gdbm_check_syserr">gdbm_check_syserr</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#DATABASE-METHODS">DATABASE METHODS</a> <ul> <li> <a class="text-decoration-none" href="#close">close</a> </li> <li> <a class="text-decoration-none" href="#errno">errno</a> </li> <li> <a class="text-decoration-none" href="#syserrno">syserrno</a> </li> <li> <a class="text-decoration-none" href="#strerror">strerror</a> </li> <li> <a class="text-decoration-none" href="#clear_error">clear_error</a> </li> <li> <a class="text-decoration-none" href="#needs_recovery">needs_recovery</a> </li> <li> <a class="text-decoration-none" href="#reorganize">reorganize</a> </li> <li> <a class="text-decoration-none" href="#sync">sync</a> </li> <li> <a class="text-decoration-none" href="#count">count</a> </li> <li> <a class="text-decoration-none" href="#flags">flags</a> </li> <li> <a class="text-decoration-none" href="#dbname">dbname</a> </li> <li> <a class="text-decoration-none" href="#cache_size">cache_size</a> </li> <li> <a class="text-decoration-none" href="#block_size">block_size</a> </li> <li> <a class="text-decoration-none" href="#sync_mode">sync_mode</a> </li> <li> <a class="text-decoration-none" href="#centfree">centfree</a> </li> <li> <a class="text-decoration-none" href="#coalesce">coalesce</a> </li> <li> <a class="text-decoration-none" href="#mmap">mmap</a> </li> <li> <a class="text-decoration-none" href="#mmapsize">mmapsize</a> </li> <li> <a class="text-decoration-none" href="#recover">recover</a> </li> <li> <a class="text-decoration-none" href="#convert">convert</a> </li> <li> <a class="text-decoration-none" href="#dump">dump</a> </li> <li> <a class="text-decoration-none" href="#load">load</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#CRASH-TOLERANCE">CRASH TOLERANCE</a> <ul> <li> <a class="text-decoration-none" href="#crash_tolerance_status">crash_tolerance_status</a> </li> <li> <a class="text-decoration-none" href="#failure_atomic">failure_atomic</a> </li> <li> <a class="text-decoration-none" href="#latest_snapshot">latest_snapshot</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#AVAILABILITY">AVAILABILITY</a> </li> <li> <a class="text-decoration-none" href="#SECURITY-AND-PORTABILITY">SECURITY AND PORTABILITY</a> </li> <li> <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a> </li> </ul> <h2 id="NAME">NAME</h2> <p>GDBM_File - Perl5 access to the gdbm library.</p> <h2 id="SYNOPSIS">SYNOPSIS</h2> <pre data-language="perl"><code>use GDBM_File;
[$db =] tie %hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640
            or die "$GDBM_File::gdbm_errno";
# Use the %hash...

$e = $db-&gt;errno;
$e = $db-&gt;syserrno;
$str = $db-&gt;strerror;
$bool = $db-&gt;needs_recovery;

$db-&gt;clear_error;

$db-&gt;reorganize;
$db-&gt;sync;

$n = $db-&gt;count;

$n = $db-&gt;flags;

$str = $db-&gt;dbname;

$db-&gt;cache_size;
$db-&gt;cache_size($newsize);

$n = $db-&gt;block_size;

$bool = $db-&gt;sync_mode;
$db-&gt;sync_mode($bool);

$bool = $db-&gt;centfree;
$db-&gt;centfree($bool);

$bool = $db-&gt;coalesce;
$db-&gt;coalesce($bool);

$bool = $db-&gt;mmap;

$size = $db-&gt;mmapsize;
$db-&gt;mmapsize($newsize);

$db-&gt;recover(%args);

untie %hash ;</code></pre> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p><b>GDBM_File</b> is a module which allows Perl programs to make use of the facilities provided by the GNU gdbm library. If you intend to use this module you should really have a copy of the <b>GDBM manual</b> at hand. The manual is avaialble online at <a href="https://www.gnu.org.ua/software/gdbm/manual">https://www.gnu.org.ua/software/gdbm/manual</a>.</p> <p>Most of the <b>gdbm</b> functions are available through the <b>GDBM_File</b> interface.</p> <p>Unlike Perl's built-in hashes, it is not safe to <code>delete</code> the current item from a GDBM_File tied hash while iterating over it with <code>each</code>. This is a limitation of the gdbm library.</p> <h3 id="Tie">Tie</h3> <p>Use the Perl built-in <b>tie</b> to associate a <b>GDBM</b> database with a Perl hash:</p> <pre data-language="perl"><code>tie %hash, 'GDBM_File', $filename, $flags, $mode;</code></pre> <p>Here, <i>$filename</i> is the name of the database file to open or create. <i>$flags</i> is a bitwise OR of <i>access mode</i> and optional <i>modifiers</i>. Access mode is one of:</p> <dl> <dt id="GDBM_READER"><b>GDBM_READER</b></dt> <dd> <p>Open existing database file in read-only mode.</p> </dd> <dt id="GDBM_WRITER"><b>GDBM_WRITER</b></dt> <dd> <p>Open existing database file in read-write mode.</p> </dd> <dt id="GDBM_WRCREAT"><b>GDBM_WRCREAT</b></dt> <dd> <p>If the database file exists, open it in read-write mode. If it doesn't, create it first and open read-write.</p> </dd> <dt id="GDBM_NEWDB"><b>GDBM_NEWDB</b></dt> <dd> <p>Create new database and open it read-write. If the database already exists, truncate it first.</p> </dd> </dl> <p>A number of modifiers can be OR'd to the access mode. Most of them are rarely needed (see <a href="https://www.gnu.org.ua/software/gdbm/manual/Open.html">https://www.gnu.org.ua/software/gdbm/manual/Open.html</a> for a complete list), but one is worth mentioning. The <b>GDBM_NUMSYNC</b> modifier, when used with <b>GDBM_NEWDB</b>, instructs <b>GDBM</b> to create the database in <i>extended</i> (so called <i>numsync</i>) format. This format is best suited for crash-tolerant implementations. See <b>CRASH TOLERANCE</b> below for more information.</p> <p>The <i>$mode</i> parameter is the file mode for creating new database file. Use an octal constant or a combination of <code>S_I*</code> constants from the <b>Fcntl</b> module. This parameter is used if <i>$flags</i> is <b>GDBM_NEWDB</b> or <b>GDBM_WRCREAT</b>.</p> <p>On success, <b>tie</b> returns an object of class <b>GDBM_File</b>. On failure, it returns <b>undef</b>. It is recommended to always check the return value, to make sure your hash is successfully associated with the database file. See <b>ERROR HANDLING</b> below for examples.</p> <h2 id="STATIC-METHODS">
STATIC METHODS</h2> <h3 id="GDBM_version">GDBM_version</h3> <pre data-language="perl"><code>$str = GDBM_File-&gt;GDBM_version;
@ar = GDBM_File-&gt;GDBM_version;</code></pre> <p>Returns the version number of the underlying <b>libgdbm</b> library. In scalar context, returns the library version formatted as string:</p> <pre data-language="perl"><code class="plaintext">MINOR.MAJOR[.PATCH][ (GUESS)]</code></pre> <p>where <i>MINOR</i>, <i>MAJOR</i>, and <i>PATCH</i> are version numbers, and <i>GUESS</i> is a guess level (see below).</p> <p>In list context, returns a list:</p> <pre data-language="perl"><code class="plaintext">( MINOR, MAJOR, PATCH [, GUESS] )</code></pre> <p>The <i>GUESS</i> component is present only if <b>libgdbm</b> version is 1.8.3 or earlier. This is because earlier releases of <b>libgdbm</b> did not include information about their version and the <b>GDBM_File</b> module has to implement certain guesswork in order to determine it. <i>GUESS</i> is a textual description in string context, and a positive number indicating how rough the guess is in list context. Possible values are:</p> <dl> <dt id="1-exact-guess">
1 - exact guess</dt> <dd> <p>The major and minor version numbers are guaranteed to be correct. The actual patchlevel is most probably guessed right, but can be 1-2 less than indicated.</p> </dd> <dt id="2-approximate">
2 - approximate</dt> <dd> <p>The major and minor number are guaranteed to be correct. The patchlevel is set to the upper bound.</p> </dd> <dt id="3-rough-guess">
3 - rough guess</dt> <dd> <p>The version is guaranteed to be not newer than <b><i>MAJOR</i>.<i>MINOR</i></b>.</p> </dd> </dl> <h2 id="ERROR-HANDLING">
ERROR HANDLING</h2> <h3 id="$GDBM_File::gdbm_errno">
$GDBM_File::gdbm_errno</h3> <p>When referenced in numeric context, retrieves the current value of the <b>gdbm_errno</b> variable, i.e. a numeric code describing the state of the most recent operation on any <b>gdbm</b> database. Each numeric code has a symbolic name associated with it. For a comprehensive list of these, see <a href="https://www.gnu.org.ua/software/gdbm/manual/Error-codes.html">https://www.gnu.org.ua/software/gdbm/manual/Error-codes.html</a>. Notice, that this list includes all error codes defined for the most recent version of <b>gdbm</b>. Depending on the actual version of the library <b>GDBM_File</b> is built with, some of these may be missing.</p> <p>In string context, <b>$gdbm_errno</b> returns a human-readable description of the error. If necessary, this description includes the value of <b>$!</b>. This makes it possible to use it in diagnostic messages. For example, the usual tying sequence is</p> <pre data-language="perl"><code>tie %hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640
     or die "$GDBM_File::gdbm_errno";</code></pre> <p>The following, more complex, example illustrates how you can fall back to read-only mode if the database file permissions forbid read-write access:</p> <pre data-language="perl"><code>use Errno qw(EACCES);
unless (tie(%hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640)) {
    if ($GDBM_File::gdbm_errno == GDBM_FILE_OPEN_ERROR
        &amp;&amp; $!{EACCES}) {
        if (tie(%hash, 'GDBM_File', $filename, GDBM_READER, 0640)) {
            die "$GDBM_File::gdbm_errno";
        }
    } else {
        die "$GDBM_File::gdbm_errno";
    }
}</code></pre> <h3 id="gdbm_check_syserr">gdbm_check_syserr</h3> <pre data-language="perl"><code class="plaintext">if (gdbm_check_syserr(gdbm_errno)) ...</code></pre> <p>Returns true if the system error number (<b>$!</b>) gives more information on the cause of the error.</p> <h2 id="DATABASE-METHODS">
DATABASE METHODS</h2> <h3 id="close">close</h3> <pre data-language="perl"><code>$db-&gt;close;</code></pre> <p>Closes the database. Normally you would just do <b>untie</b>. However, you will need to use this function if you have explicitly assigned the result of <b>tie</b> to a variable, and wish to release the database to another users. Consider the following code:</p> <pre data-language="perl"><code>$db = tie %hash, 'GDBM_File', $filename, GDBM_WRCREAT, 0640;
# Do something with %hash or $db...
untie %hash;
$db-&gt;close;</code></pre> <p>In this example, doing <b>untie</b> alone is not enough, since the database would remain referenced by <b>$db</b>, and, as a consequence, the database file would remain locked. Calling <b>$db-&gt;close</b> ensures the database file is closed and unlocked.</p> <h3 id="errno">errno</h3> <pre data-language="perl"><code>$db-&gt;errno</code></pre> <p>Returns the last error status associated with this database. In string context, returns a human-readable description of the error. See also <b>$GDBM_File::gdbm_errno</b> variable above.</p> <h3 id="syserrno">syserrno</h3> <pre data-language="perl"><code>$db-&gt;syserrno</code></pre> <p>Returns the last system error status (C <code>errno</code> variable), associated with this database,</p> <h3 id="strerror">strerror</h3> <pre data-language="perl"><code>$db-&gt;strerror</code></pre> <p>Returns textual description of the last error that occurred in this database.</p> <h3 id="clear_error">clear_error</h3> <pre data-language="perl"><code>$db-&gt;clear_error</code></pre> <p>Clear error status.</p> <h3 id="needs_recovery">needs_recovery</h3> <pre data-language="perl"><code>$db-&gt;needs_recovery</code></pre> <p>Returns true if the database needs recovery.</p> <h3 id="reorganize">reorganize</h3> <pre data-language="perl"><code>$db-&gt;reorganize;</code></pre> <p>Reorganizes the database.</p> <h3 id="sync">sync</h3> <pre data-language="perl"><code>$db-&gt;sync;</code></pre> <p>Synchronizes recent changes to the database with its disk copy.</p> <h3 id="count">count</h3> <pre data-language="perl"><code>$n = $db-&gt;count;</code></pre> <p>Returns number of keys in the database.</p> <h3 id="flags">flags</h3> <pre data-language="perl"><code>$db-&gt;flags;</code></pre> <p>Returns flags passed as 4th argument to <b>tie</b>.</p> <h3 id="dbname">dbname</h3> <pre data-language="perl"><code>$db-&gt;dbname;</code></pre> <p>Returns the database name (i.e. 3rd argument to <b>tie</b>.</p> <h3 id="cache_size">cache_size</h3> <pre data-language="perl"><code>$db-&gt;cache_size;
$db-&gt;cache_size($newsize);</code></pre> <p>Returns the size of the internal <b>GDBM</b> cache for that database.</p> <p>Called with argument, sets the size to <i>$newsize</i>.</p> <h3 id="block_size">block_size</h3> <pre data-language="perl"><code>$db-&gt;block_size;</code></pre> <p>Returns the block size of the database.</p> <h3 id="sync_mode">sync_mode</h3> <pre data-language="perl"><code>$db-&gt;sync_mode;
$db-&gt;sync_mode($bool);</code></pre> <p>Returns the status of the automatic synchronization mode. Called with argument, enables or disables the sync mode, depending on whether $bool is <b>true</b> or <b>false</b>.</p> <p>When synchronization mode is on (<b>true</b>), any changes to the database are immediately written to the disk. This ensures database consistency in case of any unforeseen errors (e.g. power failures), at the expense of considerable slowdown of operation.</p> <p>Synchronization mode is off by default.</p> <h3 id="centfree">centfree</h3> <pre data-language="perl"><code>$db-&gt;centfree;
$db-&gt;centfree($bool);</code></pre> <p>Returns status of the central free block pool (<b>0</b> - disabled, <b>1</b> - enabled).</p> <p>With argument, changes its status.</p> <p>By default, central free block pool is disabled.</p> <h3 id="coalesce">coalesce</h3> <pre data-language="perl"><code>$db-&gt;coalesce;
$db-&gt;coalesce($bool);</code></pre> <h3 id="mmap">mmap</h3> <pre data-language="perl"><code>$db-&gt;mmap;</code></pre> <p>Returns true if memory mapping is enabled.</p> <p>This method will <b>croak</b> if the <b>libgdbm</b> library is complied without memory mapping support.</p> <h3 id="mmapsize">mmapsize</h3> <pre data-language="perl"><code>$db-&gt;mmapsize;
$db-&gt;mmapsize($newsize);</code></pre> <p>If memory mapping is enabled, returns the size of memory mapping. With argument, sets the size to <b>$newsize</b>.</p> <p>This method will <b>croak</b> if the <b>libgdbm</b> library is complied without memory mapping support.</p> <h3 id="recover">recover</h3> <pre data-language="perl"><code>$db-&gt;recover(%args);</code></pre> <p>Recovers data from a failed database. <b>%args</b> is optional and can contain following keys:</p> <dl> <dt id="err-=&gt;-sub-{-...-}">
err =&gt; sub { ... }</dt> <dd> <p>Reference to code for detailed error reporting. Upon encountering an error, <b>recover</b> will call this sub with a single argument - a description of the error.</p> </dd> <dt id="backup-=&gt;-\$str">
backup =&gt; \$str</dt> <dd> <p>Creates a backup copy of the database before recovery and returns its filename in <b>$str</b>.</p> </dd> <dt id="max_failed_keys-=&gt;-$n">
max_failed_keys =&gt; $n</dt> <dd> <p>Maximum allowed number of failed keys. If the actual number becomes equal to <i>$n</i>, <b>recover</b> aborts and returns error.</p> </dd> <dt id="max_failed_buckets-=&gt;-$n">
max_failed_buckets =&gt; $n</dt> <dd> <p>Maximum allowed number of failed buckets. If the actual number becomes equal to <i>$n</i>, <b>recover</b> aborts and returns error.</p> </dd> <dt id="max_failures-=&gt;-$n">
max_failures =&gt; $n</dt> <dd> <p>Maximum allowed number of failures during recovery.</p> </dd> <dt id="stat-=&gt;-\%hash">
stat =&gt; \%hash</dt> <dd> <p>Return recovery statistics in <i>%hash</i>. Upon return, the following keys will be present:</p> <dl> <dt id="recovered_keys">recovered_keys</dt> <dd> <p>Number of successfully recovered keys.</p> </dd> <dt id="recovered_buckets">recovered_buckets</dt> <dd> <p>Number of successfully recovered buckets.</p> </dd> <dt id="failed_keys">failed_keys</dt> <dd> <p>Number of keys that failed to be retrieved.</p> </dd> <dt id="failed_buckets">failed_buckets</dt> <dd> <p>Number of buckets that failed to be retrieved.</p> </dd> </dl> </dd> </dl> <h3 id="convert">convert</h3> <pre data-language="perl"><code>$db-&gt;convert($format);</code></pre> <p>Changes the format of the database file referred to by <b>$db</b>.</p> <p>Starting from version 1.20, <b>gdbm</b> supports two database file formats: <i>standard</i> and <i>extended</i>. The former is the traditional database format, used by previous <b>gdbm</b> versions. The <i>extended</i> format contains additional data and is recommended for use in crash tolerant applications.</p> <p><a href="https://www.gnu.org.ua/software/gdbm/manual/Numsync.html">https://www.gnu.org.ua/software/gdbm/manual/Numsync.html</a>, for the discussion of both formats.</p> <p>The <b>$format</b> argument sets the new desired database format. It is <b>GDBM_NUMSYNC</b> to convert the database from standard to extended format, and <b>0</b> to convert it from extended to standard format.</p> <p>If the database is already in the requested format, the function returns success without doing anything.</p> <h3 id="dump">dump</h3> <pre data-language="perl"><code>$db-&gt;dump($filename, %options)</code></pre> <p>Creates a dump of the database file in <i>$filename</i>. Such file can be used as a backup copy or sent over a wire to recreate the database on another machine. To create a database from the dump file, use the <b>load</b> method.</p> <p><b>GDBM</b> supports two dump formats: old <i>binary</i> and new <i>ascii</i>. The binary format is not portable across architectures and is deprecated. It is supported for backward compatibility. The ascii format is portable and stores additional meta-data about the file. It was introduced with the <b>gdbm</b> version 1.11 and is the preferred dump format. The <b>dump</b> method creates ascii dumps by default.</p> <p>If the named file already exists, the function will refuse to overwrite and will croak an error. If it doesn't exist, it will be created with the mode <b>0666</b> modified by the current <b>umask</b>.</p> <p>These defaults can be altered using the following <i>%options</i>:</p> <dl> <dt id="binary-=&gt;-1">
<b>binary</b> =&gt; 1</dt> <dd> <p>Create dump in <i>binary</i> format.</p> </dd> <dt id="mode-=&gt;-MODE">
<b>mode</b> =&gt; <i>MODE</i>
</dt> <dd> <p>Set file mode to <i>MODE</i>.</p> </dd> <dt id="overwrite-=&gt;-1">
<b>overwrite</b> =&gt; 1</dt> <dd> <p>Silently overwrite existing files.</p> </dd> </dl> <h3 id="load">load</h3> <pre data-language="perl"><code>$db-&gt;load($filename, %options)</code></pre> <p>Load the data from the dump file <i>$filename</i> into the database <i>$db</i>. The file must have been previously created using the <b>dump</b> method. File format is recognized automatically. By default, the function will croak if the dump contains a key that already exists in the database. It will silently ignore the failure to restore database mode and/or ownership. These defaults can be altered using the following <i>%options</i>:</p> <dl> <dt id="replace-=&gt;-1">
<b>replace</b> =&gt; 1</dt> <dd> <p>Replace existing keys.</p> </dd> <dt id="restore_mode-=&gt;-0-|-1">
<b>restore_mode</b> =&gt; 0 | 1</dt> <dd> <p>If <i>0</i>, don't try to restore the mode of the database file to that stored in the dump.</p> </dd> <dt id="restore_owner-=&gt;-0-|-1">
<b>restore_owner</b> =&gt; 0 | 1</dt> <dd> <p>If <i>0</i>, don't try to restore the owner of the database file to that stored in the dump.</p> </dd> <dt id="strict_errors-=&gt;-1">
<b>strict_errors</b> =&gt; 1</dt> <dd> <p>Croak if failed to restore ownership and/or mode.</p> </dd> </dl> <p>The usual sequence to recreate a database from the dump file is:</p> <pre data-language="perl"><code>my %hash;
my $db = tie %hash, 'GDBM_File', 'a.db', GDBM_NEWDB, 0640;
$db-&gt;load('a.dump');</code></pre> <h2 id="CRASH-TOLERANCE">
CRASH TOLERANCE</h2> <p>Crash tolerance is a new feature that, given appropriate support from the OS and the filesystem, guarantees that a logically consistent recent state of the database can be recovered following a crash, such as power outage, OS kernel panic, or the like.</p> <p>Crash tolerance support appeared in <b>gdbm</b> version 1.21. The theory behind it is explained in "Crashproofing the Original NoSQL Key-Value Store", by Terence Kelly (<a href="https://queue.acm.org/detail.cfm?id=3487353">https://queue.acm.org/detail.cfm?id=3487353</a>). A detailed discussion of the <b>gdbm</b> implementation is available in the <b>GDBM Manual</b> (<a href="https://www.gnu.org.ua/software/gdbm/manual/Crash-Tolerance.html">https://www.gnu.org.ua/software/gdbm/manual/Crash-Tolerance.html</a>). The information below describes the Perl interface.</p> <p>For maximum robustness, we recommend to use <i>extended database format</i> for crash tolerant databases. To create a database in extended format, use the <b>GDBM_NEWDB|GDBM_NUMSYNC</b> when opening the database, e.g.:</p> <pre data-language="perl"><code>$db = tie %hash, 'GDBM_File', $filename,
          GDBM_NEWDB|GDBM_NUMSYNC, 0640;</code></pre> <p>To convert existing database to the extended format, use the <b>convert</b> method, described above, e.g.:</p> <pre data-language="perl"><code>$db-&gt;convert(GDBM_NUMSYNC);</code></pre> <h3 id="crash_tolerance_status">crash_tolerance_status</h3> <pre data-language="perl"><code>GDBM_File-&gt;crash_tolerance_status;</code></pre> <p>This static method returns the status of crash tolerance support. A non-zero value means crash tolerance is compiled in and supported by the operating system.</p> <h3 id="failure_atomic">failure_atomic</h3> <pre data-language="perl"><code>$db-&gt;failure_atomic($even, $odd)</code></pre> <p>Enables crash tolerance for the database <b>$db</b>, Arguments are the pathnames of two files that will be created and filled with <i>snapshots</i> of the database file. The two files must not exist when this method is called and must reside on the same filesystem as the database file. This filesystem must be support the <i>reflink</i> operation (https://www.gnu.org.ua/software/gdbm/manual/Filesystems-supporting-crash-tolerance.html&gt;.</p> <p>After a successful call to <b>failure_atomic</b>, every call to <b>$db-</b>sync&gt; method will make an efficient reflink snapshot of the database file in one of these files; consecutive calls to <b>sync</b> alternate between the two, hence the names.</p> <p>The most recent of these files can be used to recover the database after a crash. To select the right snapshot, use the <b>latest_snapshot</b> static method.</p> <h3 id="latest_snapshot">latest_snapshot</h3> <pre data-language="perl"><code>$file = GDBM_File-&gt;latest_snapshot($even, $odd);

($file, $error) = GDBM_File-&gt;latest_snapshot($even, $odd);</code></pre> <p>Given the two snapshot names (the ones used previously in a call to <b>failure_atomic</b>), this method selects the one suitable for database recovery, i.e. the file which contains the most recent database snapshot.</p> <p>In scalar context, it returns the selected file name or <b>undef</b> in case of failure.</p> <p>In array context, the returns a list of two elements: the file name and status code. On success, the file name is defined and the code is <b>GDBM_SNAPSHOT_OK</b>. On error, the file name is <b>undef</b>, and the status is one of the following:</p> <dl> <dt id="GDBM_SNAPSHOT_BAD">GDBM_SNAPSHOT_BAD</dt> <dd> <p>Neither snapshot file is applicable. This means that the crash has occurred before a call to <b>failure_atomic</b> completed. In this case, it is best to fall back on a safe backup copy of the data file.</p> </dd> <dt id="GDBM_SNAPSHOT_ERR">GDBM_SNAPSHOT_ERR</dt> <dd> <p>A system error occurred. Examine <b>$!</b> for details. See &lt;https://www.gnu.org.ua/software/gdbm/manual/Crash-recovery.html&gt; for a comprehensive list of error codes and their meaning.</p> </dd> <dt id="GDBM_SNAPSHOT_SAME">GDBM_SNAPSHOT_SAME</dt> <dd> <p>The file modes and modification dates of both snapshot files are exactly the same. This can happen only for databases in standard format.</p> </dd> <dt id="GDBM_SNAPSHOT_SUSPICIOUS">GDBM_SNAPSHOT_SUSPICIOUS</dt> <dd> <p>The <i>numsync</i> counters of the two snapshots differ by more than one. The most probable reason is programmer's error: the two parameters refer to snapshots belonging to different database files.</p> </dd> </dl> <h2 id="AVAILABILITY">AVAILABILITY</h2> <p>gdbm is available from any GNU archive. The master site is <code>ftp.gnu.org</code>, but you are strongly urged to use one of the many mirrors. You can obtain a list of mirror sites from <a href="http://www.gnu.org/order/ftp.html">http://www.gnu.org/order/ftp.html</a>.</p> <h2 id="SECURITY-AND-PORTABILITY">
SECURITY AND PORTABILITY</h2> <p>GDBM files are not portable across platforms. If you wish to transfer a GDBM file over the wire, dump it to a portable format first.</p> <p><b>Do not accept GDBM files from untrusted sources.</b></p> <p>Robustness of GDBM against corrupted databases depends highly on its version. Versions prior to 1.15 did not implement any validity checking, so that a corrupted or maliciously crafted database file could cause perl to crash or even expose a security vulnerability. Versions between 1.15 and 1.20 were progressively strengthened against invalid inputs. Finally, version 1.21 had undergone extensive fuzzy checking which proved its ability to withstand any kinds of inputs without crashing.</p> <h2 id="SEE-ALSO">
SEE ALSO</h2> <p><a href="http://man.he.net/man1/perl">perl(1)</a>, <a href="http://man.he.net/man3/DB_File">DB_File(3)</a>, <a href="perldbmfilter.html">perldbmfilter</a>, <a href="http://man.he.net/man3/gdbm">gdbm(3)</a>, <a href="https://www.gnu.org.ua/software/gdbm/manual.html">https://www.gnu.org.ua/software/gdbm/manual.html</a>.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993&ndash;2023 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.38.0/GDBM_File" class="_attribution-link">https://perldoc.perl.org/5.38.0/GDBM_File</a>
  </p>
</div>
