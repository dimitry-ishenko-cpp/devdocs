<h1>ExtUtils::Typemaps::OutputMap</h1>   <h2><a id="toc">CONTENTS</a></h2> <ul> <li> <a class="text-decoration-none" href="#NAME">NAME</a> </li> <li> <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a> </li> <li> <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a> </li> <li> <a class="text-decoration-none" href="#METHODS">METHODS</a> <ul> <li> <a class="text-decoration-none" href="#new">new</a> </li> <li> <a class="text-decoration-none" href="#code">code</a> </li> <li> <a class="text-decoration-none" href="#xstype">xstype</a> </li> <li> <a class="text-decoration-none" href="#cleaned_code">cleaned_code</a> </li> <li> <a class="text-decoration-none" href="#targetable">targetable</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a> </li> <li> <a class="text-decoration-none" href="#AUTHOR">AUTHOR</a> </li> <li> <a class="text-decoration-none" href="#COPYRIGHT-&amp;-LICENSE">COPYRIGHT &amp; LICENSE</a> </li> </ul> <h2 id="NAME">NAME</h2> <p>ExtUtils::Typemaps::OutputMap - Entry in the OUTPUT section of a typemap</p> <h2 id="SYNOPSIS">SYNOPSIS</h2> <pre data-language="perl"><code>use ExtUtils::Typemaps;
...
my $output = $typemap-&gt;get_output_map('T_NV');
my $code = $output-&gt;code();
$output-&gt;code("...");</code></pre> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p>Refer to <a href="ExtUtils::Typemaps.html">ExtUtils::Typemaps</a> for details.</p> <h2 id="METHODS">METHODS</h2> <h3 id="new">new</h3> <p>Requires <code>xstype</code> and <code>code</code> parameters.</p> <h3 id="code">code</h3> <p>Returns or sets the OUTPUT mapping code for this entry.</p> <h3 id="xstype">xstype</h3> <p>Returns the name of the XS type of the OUTPUT map.</p> <h3 id="cleaned_code">cleaned_code</h3> <p>Returns a cleaned-up copy of the code to which certain transformations have been applied to make it more ANSI compliant.</p> <h3 id="targetable">targetable</h3> <p>This is an obscure but effective optimization that used to live in <code>ExtUtils::ParseXS</code> directly. Not implementing it should never result in incorrect use of typemaps, just less efficient code.</p> <p>In a nutshell, this will check whether the output code involves calling <code>sv_setiv</code>, <code>sv_setuv</code>, <code>sv_setnv</code>, <code>sv_setpv</code> or <code>sv_setpvn</code> to set the special <code>$arg</code> placeholder to a new value <b>AT THE END OF THE OUTPUT CODE</b>. If that is the case, the code is eligible for using the <code>TARG</code>-related macros to optimize this. Thus the name of the method: <code>targetable</code>.</p> <p>If this optimization is applicable, <code>ExtUtils::ParseXS</code> will emit a <code>dXSTARG;</code> definition at the start of the generated XSUB code, and type (see below) dependent code to set <code>TARG</code> and push it on the stack at the end of the generated XSUB code.</p> <p>If the optimization can not be applied, this returns undef. If it can be applied, this method returns a hash reference containing the following information:</p> <pre data-language="perl"><code class="plaintext">type:      Any of the characters i, u, n, p
with_size: Bool indicating whether this is the sv_setpvn variant
what:      The code that actually evaluates to the output scalar
what_size: If "with_size", this has the string length (as code,
           not constant, including leading comma)</code></pre> <h2 id="SEE-ALSO">
SEE ALSO</h2> <p><a href="ExtUtils::Typemaps.html">ExtUtils::Typemaps</a></p> <h2 id="AUTHOR">AUTHOR</h2> <p>Steffen Mueller <code>&lt;smueller@cpan.org</code>&gt;</p> <h2 id="COPYRIGHT-&amp;-LICENSE">
COPYRIGHT &amp; LICENSE</h2> <p>Copyright 2009, 2010, 2011, 2012 Steffen Mueller</p> <p>This program is free software; you can redistribute it and/or modify it under the same terms as Perl itself.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993&ndash;2023 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.38.0/ExtUtils::Typemaps::OutputMap" class="_attribution-link">https://perldoc.perl.org/5.38.0/ExtUtils::Typemaps::OutputMap</a>
  </p>
</div>
