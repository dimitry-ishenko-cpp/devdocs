<h1>Encode::MIME::Header</h1>   <h2><a id="toc">CONTENTS</a></h2> <ul> <li> <a class="text-decoration-none" href="#NAME">NAME</a> </li> <li> <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a> </li> <li> <a class="text-decoration-none" href="#ABSTRACT">ABSTRACT</a> </li> <li> <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a> </li> <li> <a class="text-decoration-none" href="#BUGS">BUGS</a> </li> <li> <a class="text-decoration-none" href="#AUTHORS">AUTHORS</a> </li> <li> <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a> </li> </ul> <h2 id="NAME">NAME</h2> <p>Encode::MIME::Header -- MIME encoding for an unstructured email header</p> <h2 id="SYNOPSIS">SYNOPSIS</h2> <pre data-language="perl"><code>use Encode qw(encode decode);

my $mime_str = encode("MIME-Header", "Sample:Text \N{U+263A}");
# $mime_str is "=?UTF-8?B?U2FtcGxlOlRleHQg4pi6?="

my $mime_q_str = encode("MIME-Q", "Sample:Text \N{U+263A}");
# $mime_q_str is "=?UTF-8?Q?Sample=3AText_=E2=98=BA?="

my $str = decode("MIME-Header",
    "=?ISO-8859-1?B?SWYgeW91IGNhbiByZWFkIHRoaXMgeW8=?=\r\n " .
    "=?ISO-8859-2?B?dSB1bmRlcnN0YW5kIHRoZSBleGFtcGxlLg==?="
);
# $str is "If you can read this you understand the example."

use Encode qw(decode :fallbacks);
use Encode::MIME::Header;
local $Encode::MIME::Header::STRICT_DECODE = 1;
my $strict_string = decode("MIME-Header", $mime_string, FB_CROAK);
# use strict decoding and croak on errors</code></pre> <h2 id="ABSTRACT">ABSTRACT</h2> <p>This module implements <a href="https://tools.ietf.org/html/rfc2047">RFC 2047</a> MIME encoding for an unstructured field body of the email header. It can also be used for <a href="https://tools.ietf.org/html/rfc822">RFC 822</a> 'text' token. However, it cannot be used directly for the whole header with the field name or for the structured header fields like From, To, Cc, Message-Id, etc... There are 3 encoding names supported by this module: <code>MIME-Header</code>, <code>MIME-B</code> and <code>MIME-Q</code>.</p> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p>Decode method takes an unstructured field body of the email header (or <a href="https://tools.ietf.org/html/rfc822">RFC 822</a> 'text' token) as its input and decodes each MIME encoded-word from input string to a sequence of bytes according to <a href="https://tools.ietf.org/html/rfc2047">RFC 2047</a> and <a href="https://tools.ietf.org/html/rfc2231">RFC 2231</a>. Subsequently, each sequence of bytes with the corresponding MIME charset is decoded with <a href="encode.html">the Encode module</a> and finally, one output string is returned. Text parts of the input string which do not contain MIME encoded-word stay unmodified in the output string. Folded newlines between two consecutive MIME encoded-words are discarded, others are preserved in the output string. <code>MIME-B</code> can decode Base64 variant, <code>MIME-Q</code> can decode Quoted-Printable variant and <code>MIME-Header</code> can decode both of them. If <a href="encode.html">Encode module</a> does not support particular MIME charset or chosen variant then an action based on <a href="encode.html#Handling-Malformed-Data">CHECK flags</a> is performed (by default, the MIME encoded-word is not decoded).</p> <p>Encode method takes a scalar string as its input and uses <a href="encode.html#UTF-8-vs.-utf8-vs.-UTF8">strict UTF-8</a> encoder for encoding it to UTF-8 bytes. Then a sequence of UTF-8 bytes is encoded into MIME encoded-words (<code>MIME-Header</code> and <code>MIME-B</code> use a Base64 variant while <code>MIME-Q</code> uses a Quoted-Printable variant) where each MIME encoded-word is limited to 75 characters. MIME encoded-words are separated by <code>CRLF SPACE</code> and joined to one output string. Output string is suitable for unstructured field body of the email header.</p> <p>Both encode and decode methods propagate <a href="encode.html#Handling-Malformed-Data">CHECK flags</a> when encoding and decoding the MIME charset.</p> <h2 id="BUGS">BUGS</h2> <p>Versions prior to 2.22 (part of Encode 2.83) have a malfunctioning decoder and encoder. The MIME encoder infamously inserted additional spaces or discarded white spaces between consecutive MIME encoded-words, which led to invalid MIME headers produced by this module. The MIME decoder had a tendency to discard white spaces, incorrectly interpret data or attempt to decode Base64 MIME encoded-words as Quoted-Printable. These problems were fixed in version 2.22. It is highly recommended not to use any version prior 2.22!</p> <p>Versions prior to 2.24 (part of Encode 2.87) ignored <a href="encode.html#Handling-Malformed-Data">CHECK flags</a>. The MIME encoder used <a href="encode.html#UTF-8-vs.-utf8-vs.-UTF8">not strict utf8</a> encoder for input Unicode strings which could lead to invalid UTF-8 sequences. MIME decoder used also <a href="encode.html#UTF-8-vs.-utf8-vs.-UTF8">not strict utf8</a> decoder and additionally called the decode method with a <code>Encode::FB_PERLQQ</code> flag (thus user-specified <a href="encode.html#Handling-Malformed-Data">CHECK flags</a> were ignored). Moreover, it automatically croaked when a MIME encoded-word contained unknown encoding. Since version 2.24, this module uses <a href="encode.html#UTF-8-vs.-utf8-vs.-UTF8">strict UTF-8</a> encoder and decoder. And <a href="encode.html#Handling-Malformed-Data">CHECK flags</a> are correctly propagated.</p> <p>Since version 2.22 (part of Encode 2.83), the MIME encoder should be fully compliant to <a href="https://tools.ietf.org/html/rfc2047">RFC 2047</a> and <a href="https://tools.ietf.org/html/rfc2231">RFC 2231</a>. Due to the aforementioned bugs in previous versions of the MIME encoder, there is a <i>less strict</i> compatible mode for the MIME decoder which is used by default. It should be able to decode MIME encoded-words encoded by pre 2.22 versions of this module. However, note that this is not correct according to <a href="https://tools.ietf.org/html/rfc2047">RFC 2047</a>.</p> <p>In default <i>not strict</i> mode the MIME decoder attempts to decode every substring which looks like a MIME encoded-word. Therefore, the MIME encoded-words do not need to be separated by white space. To enforce a correct <i>strict</i> mode, set variable <code>$Encode::MIME::Header::STRICT_DECODE</code> to 1 e.g. by localizing:</p> <pre data-language="perl"><code>use Encode::MIME::Header;
local $Encode::MIME::Header::STRICT_DECODE = 1;</code></pre> <h2 id="AUTHORS">AUTHORS</h2> <p>Pali &lt;pali@cpan.org&gt;</p> <h2 id="SEE-ALSO">
SEE ALSO</h2> <p><a href="encode.html">Encode</a>, <a href="https://tools.ietf.org/html/rfc822">RFC 822</a>, <a href="https://tools.ietf.org/html/rfc2047">RFC 2047</a>, <a href="https://tools.ietf.org/html/rfc2231">RFC 2231</a></p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993&ndash;2023 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.38.0/Encode::MIME::Header" class="_attribution-link">https://perldoc.perl.org/5.38.0/Encode::MIME::Header</a>
  </p>
</div>
