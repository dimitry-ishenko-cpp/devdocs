<section id="multimesh"> <h1 id="class-multimesh">MultiMesh</h1> <p><strong>Inherits:</strong> <a href="class_resource.html#class-resource"><span class="std std-ref">Resource</span></a> <strong>&lt;</strong> <a href="class_refcounted.html#class-refcounted"><span class="std std-ref">RefCounted</span></a> <strong>&lt;</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a></p> <p>Provides high-performance drawing of a mesh multiple times using GPU instancing.</p> <section class="classref-introduction-group" id="description"> <h2>Description</h2> <p>MultiMesh provides low-level mesh instancing. Drawing thousands of <a href="class_meshinstance3d.html#class-meshinstance3d"><span class="std std-ref">MeshInstance3D</span></a> nodes can be slow, since each object is submitted to the GPU then drawn individually.</p> <p>MultiMesh is much faster as it can draw thousands of instances with a single draw call, resulting in less API overhead.</p> <p>As a drawback, if the instances are too far away from each other, performance may be reduced as every single instance will always render (they are spatially indexed as one, for the whole object).</p> <p>Since instances may have any behavior, the AABB used for visibility must be provided by the user.</p> <p><strong>Note:</strong> A MultiMesh is a single object, therefore the same maximum lights per object restriction applies. This means, that once the maximum lights are consumed by one or more instances, the rest of the MultiMesh instances will <strong>not</strong> receive any lighting.</p> <p><strong>Note:</strong> Blend Shapes will be ignored if used in a MultiMesh.</p> </section> <section class="classref-introduction-group" id="tutorials"> <h2>Tutorials</h2> <ul class="simple"> <li><a href="https://docs.godotengine.org/en/4.2/tutorials/3d/using_multi_mesh_instance.html"><span class="doc">Using MultiMeshInstance</span></a></li> <li><a href="https://docs.godotengine.org/en/4.2/tutorials/performance/using_multimesh.html"><span class="doc">Optimization using MultiMeshes</span></a></li> <li><a href="https://docs.godotengine.org/en/4.2/tutorials/performance/vertex_animation/animating_thousands_of_fish.html"><span class="doc">Animating thousands of fish with MultiMeshInstance</span></a></li> </ul> </section> <section class="classref-reftable-group" id="properties"> <h2>Properties</h2> <table class="colwidths-auto docutils align-default">  <tr>
<td><p><a href="class_packedfloat32array.html#class-packedfloat32array"><span class="std std-ref">PackedFloat32Array</span></a></p></td> <td><p><a href="#class-multimesh-property-buffer"><span class="std std-ref">buffer</span></a></p></td> <td><p><code>PackedFloat32Array()</code></p></td> </tr> <tr>
<td><p><a href="class_packedcolorarray.html#class-packedcolorarray"><span class="std std-ref">PackedColorArray</span></a></p></td> <td><p><a href="#class-multimesh-property-color-array"><span class="std std-ref">color_array</span></a></p></td> <td></td> </tr> <tr>
<td><p><a href="class_packedcolorarray.html#class-packedcolorarray"><span class="std std-ref">PackedColorArray</span></a></p></td> <td><p><a href="#class-multimesh-property-custom-data-array"><span class="std std-ref">custom_data_array</span></a></p></td> <td></td> </tr> <tr>
<td><p><a href="class_int.html#class-int"><span class="std std-ref">int</span></a></p></td> <td><p><a href="#class-multimesh-property-instance-count"><span class="std std-ref">instance_count</span></a></p></td> <td><p><code>0</code></p></td> </tr> <tr>
<td><p><a href="class_mesh.html#class-mesh"><span class="std std-ref">Mesh</span></a></p></td> <td><p><a href="#class-multimesh-property-mesh"><span class="std std-ref">mesh</span></a></p></td> <td></td> </tr> <tr>
<td><p><a href="class_packedvector2array.html#class-packedvector2array"><span class="std std-ref">PackedVector2Array</span></a></p></td> <td><p><a href="#class-multimesh-property-transform-2d-array"><span class="std std-ref">transform_2d_array</span></a></p></td> <td></td> </tr> <tr>
<td><p><a href="class_packedvector3array.html#class-packedvector3array"><span class="std std-ref">PackedVector3Array</span></a></p></td> <td><p><a href="#class-multimesh-property-transform-array"><span class="std std-ref">transform_array</span></a></p></td> <td></td> </tr> <tr>
<td><p><a href="#enum-multimesh-transformformat"><span class="std std-ref">TransformFormat</span></a></p></td> <td><p><a href="#class-multimesh-property-transform-format"><span class="std std-ref">transform_format</span></a></p></td> <td><p><code>0</code></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-multimesh-property-use-colors"><span class="std std-ref">use_colors</span></a></p></td> <td><p><code>false</code></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-multimesh-property-use-custom-data"><span class="std std-ref">use_custom_data</span></a></p></td> <td><p><code>false</code></p></td> </tr> <tr>
<td><p><a href="class_int.html#class-int"><span class="std std-ref">int</span></a></p></td> <td><p><a href="#class-multimesh-property-visible-instance-count"><span class="std std-ref">visible_instance_count</span></a></p></td> <td><p><code>-1</code></p></td> </tr>  </table> </section> <section class="classref-reftable-group" id="methods"> <h2>Methods</h2> <table class="colwidths-auto docutils align-default">  <tr>
<td><p><a href="class_aabb.html#class-aabb"><span class="std std-ref">AABB</span></a></p></td> <td><p><a href="#class-multimesh-method-get-aabb"><span class="std std-ref">get_aabb</span></a> <strong>(</strong> <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_color.html#class-color"><span class="std std-ref">Color</span></a></p></td> <td><p><a href="#class-multimesh-method-get-instance-color"><span class="std std-ref">get_instance_color</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_color.html#class-color"><span class="std std-ref">Color</span></a></p></td> <td><p><a href="#class-multimesh-method-get-instance-custom-data"><span class="std std-ref">get_instance_custom_data</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_transform3d.html#class-transform3d"><span class="std std-ref">Transform3D</span></a></p></td> <td><p><a href="#class-multimesh-method-get-instance-transform"><span class="std std-ref">get_instance_transform</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_transform2d.html#class-transform2d"><span class="std std-ref">Transform2D</span></a></p></td> <td><p><a href="#class-multimesh-method-get-instance-transform-2d"><span class="std std-ref">get_instance_transform_2d</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-multimesh-method-set-instance-color"><span class="std std-ref">set_instance_color</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> color <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-multimesh-method-set-instance-custom-data"><span class="std std-ref">set_instance_custom_data</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> custom_data <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-multimesh-method-set-instance-transform"><span class="std std-ref">set_instance_transform</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_transform3d.html#class-transform3d"><span class="std std-ref">Transform3D</span></a> transform <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-multimesh-method-set-instance-transform-2d"><span class="std std-ref">set_instance_transform_2d</span></a> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_transform2d.html#class-transform2d"><span class="std std-ref">Transform2D</span></a> transform <strong>)</strong></p></td> </tr>  </table> </section>  <section class="classref-descriptions-group" id="enumerations"> <h2>Enumerations</h2> <h3 id="enum-multimesh-transformformat">enum TransformFormat:</h3> <h3 id="class-multimesh-constant-transform-2d">
<a href="#enum-multimesh-transformformat"><span class="std std-ref">TransformFormat</span></a> TRANSFORM_2D = <code>0</code>
</h3> <p>Use this when using 2D transforms.</p> <h3 id="class-multimesh-constant-transform-3d">
<a href="#enum-multimesh-transformformat"><span class="std std-ref">TransformFormat</span></a> TRANSFORM_3D = <code>1</code>
</h3> <p>Use this when using 3D transforms.</p> </section>  <section class="classref-descriptions-group" id="property-descriptions"> <h2>Property Descriptions</h2> <h3 id="class-multimesh-property-buffer">
<a href="class_packedfloat32array.html#class-packedfloat32array"><span class="std std-ref">PackedFloat32Array</span></a> buffer = <code>PackedFloat32Array()</code>
</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_buffer</strong> <strong>(</strong> <a href="class_packedfloat32array.html#class-packedfloat32array"><span class="std std-ref">PackedFloat32Array</span></a> value <strong>)</strong>
</li> <li>
<a href="class_packedfloat32array.html#class-packedfloat32array"><span class="std std-ref">PackedFloat32Array</span></a> <strong>get_buffer</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <div class="contribute docutils container"> <p>There is currently no description for this property. Please help us by <a href="https://docs.godotengine.org/en/4.2/contributing/documentation/updating_the_class_reference.html#doc-updating-the-class-reference"><span class="std std-ref">contributing one</span></a>!</p> </div>  <h3 id="class-multimesh-property-color-array">
<a href="class_packedcolorarray.html#class-packedcolorarray"><span class="std std-ref">PackedColorArray</span></a> color_array</h3> <p>See <a href="#class-multimesh-method-set-instance-color"><span class="std std-ref">set_instance_color</span></a>.</p>  <h3 id="class-multimesh-property-custom-data-array">
<a href="class_packedcolorarray.html#class-packedcolorarray"><span class="std std-ref">PackedColorArray</span></a> custom_data_array</h3> <p>See <a href="#class-multimesh-method-set-instance-custom-data"><span class="std std-ref">set_instance_custom_data</span></a>.</p>  <h3 id="class-multimesh-property-instance-count">
<a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance_count = <code>0</code>
</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_instance_count</strong> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> value <strong>)</strong>
</li> <li>
<a href="class_int.html#class-int"><span class="std std-ref">int</span></a> <strong>get_instance_count</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <p>Number of instances that will get drawn. This clears and (re)sizes the buffers. Setting data format or flags afterwards will have no effect.</p> <p>By default, all instances are drawn but you can limit this with <a href="#class-multimesh-property-visible-instance-count"><span class="std std-ref">visible_instance_count</span></a>.</p>  <h3 id="class-multimesh-property-mesh">
<a href="class_mesh.html#class-mesh"><span class="std std-ref">Mesh</span></a> mesh</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_mesh</strong> <strong>(</strong> <a href="class_mesh.html#class-mesh"><span class="std std-ref">Mesh</span></a> value <strong>)</strong>
</li> <li>
<a href="class_mesh.html#class-mesh"><span class="std std-ref">Mesh</span></a> <strong>get_mesh</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <p><a href="class_mesh.html#class-mesh"><span class="std std-ref">Mesh</span></a> resource to be instanced.</p> <p>The looks of the individual instances can be modified using <a href="#class-multimesh-method-set-instance-color"><span class="std std-ref">set_instance_color</span></a> and <a href="#class-multimesh-method-set-instance-custom-data"><span class="std std-ref">set_instance_custom_data</span></a>.</p>  <h3 id="class-multimesh-property-transform-2d-array">
<a href="class_packedvector2array.html#class-packedvector2array"><span class="std std-ref">PackedVector2Array</span></a> transform_2d_array</h3> <p>See <a href="#class-multimesh-method-set-instance-transform-2d"><span class="std std-ref">set_instance_transform_2d</span></a>.</p>  <h3 id="class-multimesh-property-transform-array">
<a href="class_packedvector3array.html#class-packedvector3array"><span class="std std-ref">PackedVector3Array</span></a> transform_array</h3> <p>See <a href="#class-multimesh-method-set-instance-transform"><span class="std std-ref">set_instance_transform</span></a>.</p>  <h3 id="class-multimesh-property-transform-format">
<a href="#enum-multimesh-transformformat"><span class="std std-ref">TransformFormat</span></a> transform_format = <code>0</code>
</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_transform_format</strong> <strong>(</strong> <a href="#enum-multimesh-transformformat"><span class="std std-ref">TransformFormat</span></a> value <strong>)</strong>
</li> <li>
<a href="#enum-multimesh-transformformat"><span class="std std-ref">TransformFormat</span></a> <strong>get_transform_format</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <p>Format of transform used to transform mesh, either 2D or 3D.</p>  <h3 id="class-multimesh-property-use-colors">
<a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> use_colors = <code>false</code>
</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_use_colors</strong> <strong>(</strong> <a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> value <strong>)</strong>
</li> <li>
<a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> <strong>is_using_colors</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <p>If <code>true</code>, the <strong>MultiMesh</strong> will use color data (see <a href="#class-multimesh-method-set-instance-color"><span class="std std-ref">set_instance_color</span></a>). Can only be set when <a href="#class-multimesh-property-instance-count"><span class="std std-ref">instance_count</span></a> is <code>0</code> or less. This means that you need to call this method before setting the instance count, or temporarily reset it to <code>0</code>.</p>  <h3 id="class-multimesh-property-use-custom-data">
<a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> use_custom_data = <code>false</code>
</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_use_custom_data</strong> <strong>(</strong> <a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> value <strong>)</strong>
</li> <li>
<a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> <strong>is_using_custom_data</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <p>If <code>true</code>, the <strong>MultiMesh</strong> will use custom data (see <a href="#class-multimesh-method-set-instance-custom-data"><span class="std std-ref">set_instance_custom_data</span></a>). Can only be set when <a href="#class-multimesh-property-instance-count"><span class="std std-ref">instance_count</span></a> is <code>0</code> or less. This means that you need to call this method before setting the instance count, or temporarily reset it to <code>0</code>.</p>  <h3 id="class-multimesh-property-visible-instance-count">
<a href="class_int.html#class-int"><span class="std std-ref">int</span></a> visible_instance_count = <code>-1</code>
</h3> <ul class="classref-property-setget simple"> <li>void <strong>set_visible_instance_count</strong> <strong>(</strong> <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> value <strong>)</strong>
</li> <li>
<a href="class_int.html#class-int"><span class="std std-ref">int</span></a> <strong>get_visible_instance_count</strong> <strong>(</strong> <strong>)</strong>
</li> </ul> <p>Limits the number of instances drawn, -1 draws all instances. Changing this does not change the sizes of the buffers.</p> </section>  <section class="classref-descriptions-group" id="method-descriptions"> <h2>Method Descriptions</h2> <h3 id="class-multimesh-method-get-aabb">
<a href="class_aabb.html#class-aabb"><span class="std std-ref">AABB</span></a> get_aabb ( ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr>
</h3> <p>Returns the visibility axis-aligned bounding box in local space.</p>  <h3 id="class-multimesh-method-get-instance-color">
<a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> get_instance_color ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr>
</h3> <p>Gets a specific instance's color multiplier.</p>  <h3 id="class-multimesh-method-get-instance-custom-data">
<a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> get_instance_custom_data ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr>
</h3> <p>Returns the custom data that has been set for a specific instance.</p>  <h3 id="class-multimesh-method-get-instance-transform">
<a href="class_transform3d.html#class-transform3d"><span class="std std-ref">Transform3D</span></a> get_instance_transform ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr>
</h3> <p>Returns the <a href="class_transform3d.html#class-transform3d"><span class="std std-ref">Transform3D</span></a> of a specific instance.</p>  <h3 id="class-multimesh-method-get-instance-transform-2d">
<a href="class_transform2d.html#class-transform2d"><span class="std std-ref">Transform2D</span></a> get_instance_transform_2d ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr>
</h3> <p>Returns the <a href="class_transform2d.html#class-transform2d"><span class="std std-ref">Transform2D</span></a> of a specific instance.</p>  <h3 id="class-multimesh-method-set-instance-color">void set_instance_color ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> color )</h3> <p>Sets the color of a specific instance by <em>multiplying</em> the mesh's existing vertex colors. This allows for different color tinting per instance.</p> <p>For the color to take effect, ensure that <a href="#class-multimesh-property-use-colors"><span class="std std-ref">use_colors</span></a> is <code>true</code> on the <strong>MultiMesh</strong> and <a href="class_basematerial3d.html#class-basematerial3d-property-vertex-color-use-as-albedo"><span class="std std-ref">BaseMaterial3D.vertex_color_use_as_albedo</span></a> is <code>true</code> on the material. If you intend to set an absolute color instead of tinting, make sure the material's albedo color is set to pure white (<code>Color(1, 1, 1)</code>).</p>  <h3 id="class-multimesh-method-set-instance-custom-data">void set_instance_custom_data ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> custom_data )</h3> <p>Sets custom data for a specific instance. Although <a href="class_color.html#class-color"><span class="std std-ref">Color</span></a> is used, it is just a container for 4 floating point numbers.</p> <p>For the custom data to be used, ensure that <a href="#class-multimesh-property-use-custom-data"><span class="std std-ref">use_custom_data</span></a> is <code>true</code>.</p> <p>This custom instance data has to be manually accessed in your custom shader using <code>INSTANCE_CUSTOM</code>.</p>  <h3 id="class-multimesh-method-set-instance-transform">void set_instance_transform ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_transform3d.html#class-transform3d"><span class="std std-ref">Transform3D</span></a> transform )</h3> <p>Sets the <a href="class_transform3d.html#class-transform3d"><span class="std std-ref">Transform3D</span></a> for a specific instance.</p>  <h3 id="class-multimesh-method-set-instance-transform-2d">void set_instance_transform_2d ( <a href="class_int.html#class-int"><span class="std std-ref">int</span></a> instance, <a href="class_transform2d.html#class-transform2d"><span class="std std-ref">Transform2D</span></a> transform )</h3> <p>Sets the <a href="class_transform2d.html#class-transform2d"><span class="std std-ref">Transform2D</span></a> for a specific instance.</p> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2014&ndash;present Juan Linietsky, Ariel Manzur and the Godot community<br>Licensed under the Creative Commons Attribution Unported License v3.0.<br>
    <a href="https://docs.godotengine.org/en/4.2/classes/class_multimesh.html" class="_attribution-link">https://docs.godotengine.org/en/4.2/classes/class_multimesh.html</a>
  </p>
</div>
