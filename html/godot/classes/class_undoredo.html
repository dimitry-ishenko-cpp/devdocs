<h1 id="class-undoredo">UndoRedo</h1> <p><strong>Inherits:</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a></p> <p>Helper to manage undo/redo operations in the editor or custom tools.</p> <section id="description"> <h2>Description</h2> <p>Helper to manage undo/redo operations in the editor or custom tools. It works by registering methods and property changes inside "actions".</p> <p>Common behavior is to create an action, then add do/undo calls to functions or property changes, then committing the action.</p> <p>Here's an example on how to add an action to the Godot editor's own <code>UndoRedo</code>, from a plugin:</p> <pre data-language="gdscript">var undo_redo = get_undo_redo() # Method of EditorPlugin.

func do_something():
    pass # Put your code here.

func undo_something():
    pass # Put here the code that reverts what's done by "do_something()".

func _on_MyButton_pressed():
    var node = get_node("MyNode2D")
    undo_redo.create_action("Move the node")
    undo_redo.add_do_method(self, "do_something")
    undo_redo.add_undo_method(self, "undo_something")
    undo_redo.add_do_property(node, "position", Vector2(100,100))
    undo_redo.add_undo_property(node, "position", node.position)
    undo_redo.commit_action()
</pre> <p><a href="#class-undoredo-method-create-action"><span class="std std-ref">create_action</span></a>, <a href="#class-undoredo-method-add-do-method"><span class="std std-ref">add_do_method</span></a>, <a href="#class-undoredo-method-add-undo-method"><span class="std std-ref">add_undo_method</span></a>, <a href="#class-undoredo-method-add-do-property"><span class="std std-ref">add_do_property</span></a>, <a href="#class-undoredo-method-add-undo-property"><span class="std std-ref">add_undo_property</span></a>, and <a href="#class-undoredo-method-commit-action"><span class="std std-ref">commit_action</span></a> should be called one after the other, like in the example. Not doing so could lead to crashes.</p> <p>If you don't need to register a method, you can leave <a href="#class-undoredo-method-add-do-method"><span class="std std-ref">add_do_method</span></a> and <a href="#class-undoredo-method-add-undo-method"><span class="std std-ref">add_undo_method</span></a> out; the same goes for properties. You can also register more than one method/property.</p> </section> <section id="methods"> <h2>Methods</h2> <table class="docutils align-default">   <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-add-do-method"><span class="std std-ref">add_do_method</span></a> <strong>(</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> method, ... <strong>)</strong> <abbr title="This method accepts any number of arguments after the ones described here.">vararg</abbr></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-add-do-property"><span class="std std-ref">add_do_property</span></a> <strong>(</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> property, <a href="class_variant.html#class-variant"><span class="std std-ref">Variant</span></a> value <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-add-do-reference"><span class="std std-ref">add_do_reference</span></a> <strong>(</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-add-undo-method"><span class="std std-ref">add_undo_method</span></a> <strong>(</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> method, ... <strong>)</strong> <abbr title="This method accepts any number of arguments after the ones described here.">vararg</abbr></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-add-undo-property"><span class="std std-ref">add_undo_property</span></a> <strong>(</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> property, <a href="class_variant.html#class-variant"><span class="std std-ref">Variant</span></a> value <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-add-undo-reference"><span class="std std-ref">add_undo_reference</span></a> <strong>(</strong> <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-clear-history"><span class="std std-ref">clear_history</span></a> <strong>(</strong> <a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> increase_version=true <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-commit-action"><span class="std std-ref">commit_action</span></a> <strong>(</strong> <strong>)</strong></p></td> </tr> <tr>
<td><p>void</p></td> <td><p><a href="#class-undoredo-method-create-action"><span class="std std-ref">create_action</span></a> <strong>(</strong> <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> name, <a href="#enum-undoredo-mergemode"><span class="std std-ref">MergeMode</span></a> merge_mode=0 <strong>)</strong></p></td> </tr> <tr>
<td><p><a href="class_string.html#class-string"><span class="std std-ref">String</span></a></p></td> <td><p><a href="#class-undoredo-method-get-current-action-name"><span class="std std-ref">get_current_action_name</span></a> <strong>(</strong> <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_int.html#class-int"><span class="std std-ref">int</span></a></p></td> <td><p><a href="#class-undoredo-method-get-version"><span class="std std-ref">get_version</span></a> <strong>(</strong> <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-undoredo-method-has-redo"><span class="std std-ref">has_redo</span></a> <strong>(</strong> <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-undoredo-method-has-undo"><span class="std std-ref">has_undo</span></a> <strong>(</strong> <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-undoredo-method-is-commiting-action"><span class="std std-ref">is_commiting_action</span></a> <strong>(</strong> <strong>)</strong> <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-undoredo-method-redo"><span class="std std-ref">redo</span></a> <strong>(</strong> <strong>)</strong></p></td> </tr> <tr>
<td><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a></p></td> <td><p><a href="#class-undoredo-method-undo"><span class="std std-ref">undo</span></a> <strong>(</strong> <strong>)</strong></p></td> </tr>  </table> </section> <section id="signals"> <h2>Signals</h2> <h3 id="class-undoredo-signal-version-changed"><p>version_changed ( )</p></h3> <p>Called when <a href="#class-undoredo-method-undo"><span class="std std-ref">undo</span></a> or <a href="#class-undoredo-method-redo"><span class="std std-ref">redo</span></a> was called.</p> </section> <section id="enumerations"> <h2>Enumerations</h2> <p id="class-undoredo-constant-merge-all">enum <strong id="enum-undoredo-mergemode">MergeMode</strong>:</p> <ul class="simple"> <li>
<strong>MERGE_DISABLE</strong> = <strong>0</strong> --- Makes "do"/"undo" operations stay in separate actions.</li> <li>
<strong>MERGE_ENDS</strong> = <strong>1</strong> --- Makes so that the action's "do" operation is from the first action created and the "undo" operation is from the last subsequent action with the same name.</li> <li>
<strong>MERGE_ALL</strong> = <strong>2</strong> --- Makes subsequent actions with the same name be merged into one.</li> </ul> </section> <section id="method-descriptions"> <h2>Method Descriptions</h2> <h3 id="class-undoredo-method-add-do-method"><p>void add_do_method ( <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> method, ... ) <abbr title="This method accepts any number of arguments after the ones described here.">vararg</abbr></p></h3> <p>Register a method that will be called when the action is committed.</p>  <h3 id="class-undoredo-method-add-do-property"><p>void add_do_property ( <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> property, <a href="class_variant.html#class-variant"><span class="std std-ref">Variant</span></a> value )</p></h3> <p>Register a property value change for "do".</p>  <h3 id="class-undoredo-method-add-do-reference"><p>void add_do_reference ( <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object )</p></h3> <p>Register a reference for "do" that will be erased if the "do" history is lost. This is useful mostly for new nodes created for the "do" call. Do not use for resources.</p>  <h3 id="class-undoredo-method-add-undo-method"><p>void add_undo_method ( <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> method, ... ) <abbr title="This method accepts any number of arguments after the ones described here.">vararg</abbr></p></h3> <p>Register a method that will be called when the action is undone.</p>  <h3 id="class-undoredo-method-add-undo-property"><p>void add_undo_property ( <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object, <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> property, <a href="class_variant.html#class-variant"><span class="std std-ref">Variant</span></a> value )</p></h3> <p>Register a property value change for "undo".</p>  <h3 id="class-undoredo-method-add-undo-reference"><p>void add_undo_reference ( <a href="class_object.html#class-object"><span class="std std-ref">Object</span></a> object )</p></h3> <p>Register a reference for "undo" that will be erased if the "undo" history is lost. This is useful mostly for nodes removed with the "do" call (not the "undo" call!).</p>  <h3 id="class-undoredo-method-clear-history"><p>void clear_history ( <a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> increase_version=true )</p></h3> <p>Clear the undo/redo history and associated references.</p> <p>Passing <code>false</code> to <code>increase_version</code> will prevent the version number to be increased from this.</p>  <h3 id="class-undoredo-method-commit-action"><p>void commit_action ( )</p></h3> <p>Commit the action. All "do" methods/properties are called/set when this function is called.</p>  <h3 id="class-undoredo-method-create-action"><p>void create_action ( <a href="class_string.html#class-string"><span class="std std-ref">String</span></a> name, <a href="#enum-undoredo-mergemode"><span class="std std-ref">MergeMode</span></a> merge_mode=0 )</p></h3> <p>Create a new action. After this is called, do all your calls to <a href="#class-undoredo-method-add-do-method"><span class="std std-ref">add_do_method</span></a>, <a href="#class-undoredo-method-add-undo-method"><span class="std std-ref">add_undo_method</span></a>, <a href="#class-undoredo-method-add-do-property"><span class="std std-ref">add_do_property</span></a>, and <a href="#class-undoredo-method-add-undo-property"><span class="std std-ref">add_undo_property</span></a>, then commit the action with <a href="#class-undoredo-method-commit-action"><span class="std std-ref">commit_action</span></a>.</p> <p>The way actions are merged is dictated by the <code>merge_mode</code> argument. See <a href="#enum-undoredo-mergemode"><span class="std std-ref">MergeMode</span></a> for details.</p>  <h3 id="class-undoredo-method-get-current-action-name"><p><a href="class_string.html#class-string"><span class="std std-ref">String</span></a> get_current_action_name ( ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></h3> <p>Gets the name of the current action.</p>  <h3 id="class-undoredo-method-get-version"><p><a href="class_int.html#class-int"><span class="std std-ref">int</span></a> get_version ( ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></h3> <p>Gets the version. Every time a new action is committed, the <code>UndoRedo</code>'s version number is increased automatically.</p> <p>This is useful mostly to check if something changed from a saved version.</p>  <h3 id="class-undoredo-method-has-redo"><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> has_redo ( ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></h3> <p>Returns <code>true</code> if a "redo" action is available.</p>  <h3 id="class-undoredo-method-has-undo"><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> has_undo ( ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></h3> <p>Returns <code>true</code> if an "undo" action is available.</p>  <h3 id="class-undoredo-method-is-commiting-action"><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> is_commiting_action ( ) <abbr title="This method has no side effects. It doesn't modify any of the instance's member variables.">const</abbr></p></h3> <p>Returns <code>true</code> if the <code>UndoRedo</code> is currently committing the action, i.e. running its "do" method or property change (see <a href="#class-undoredo-method-commit-action"><span class="std std-ref">commit_action</span></a>).</p>  <h3 id="class-undoredo-method-redo"><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> redo ( )</p></h3> <p>Redo the last action.</p>  <h3 id="class-undoredo-method-undo"><p><a href="class_bool.html#class-bool"><span class="std std-ref">bool</span></a> undo ( )</p></h3> <p>Undo the last action.</p> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2014&ndash;2022 Juan Linietsky, Ariel Manzur, Godot Engine contributors<br>Licensed under the MIT License.<br>
    <a href="https://docs.godotengine.org/en/3.5/classes/class_undoredo.html" class="_attribution-link">https://docs.godotengine.org/en/3.5/classes/class_undoredo.html</a>
  </p>
</div>
