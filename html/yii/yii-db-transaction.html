<h1>Class yii\db\Transaction</h1> <div class="top-nav"> <a href="index.html">All Classes</a> | <a href="#properties">Properties</a> | <a href="#methods">Methods</a> | <a href="#constants">Constants</a> </div> <table> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr>
<th>Inheritance</th>
<td>
<a href="yii-db-transaction.html">yii\db\Transaction</a> Â» <a href="yii-base-object.html">yii\base\Object</a>
</td>
</tr> <tr>
<th>Implements</th>
<td><a href="yii-base-configurable.html">yii\base\Configurable</a></td>
</tr> <tr>
<th>Available since version</th>
<td>2.0</td>
</tr> <tr> <th>Source Code</th> <td><a href="https://github.com/yiisoft/yii2/blob/master/framework/db/Transaction.php">https://github.com/yiisoft/yii2/blob/master/framework/db/Transaction.php</a></td> </tr> </table>  <p><strong>Transaction represents a DB transaction.</strong></p> <p>It is usually created by calling <a href="yii-db-connection.html#beginTransaction()-detail">yii\db\Connection::beginTransaction()</a>.</p> <p>The following code is a typical example of using transactions (note that some DBMS may not support transactions):</p> <pre data-language="php">$transaction = $connection-&gt;beginTransaction();
try {
    $connection-&gt;createCommand($sql1)-&gt;execute();
    $connection-&gt;createCommand($sql2)-&gt;execute();
    //.... other SQL executions
    $transaction-&gt;commit();
} catch (\Exception $e) {
    $transaction-&gt;rollBack();
    throw $e;
} catch (\Throwable $e) {
    $transaction-&gt;rollBack();
    throw $e;
}
</pre> <blockquote class="note">
<p><strong>Note: </strong>in the above code we have two catch-blocks for compatibility with PHP 5.x and PHP 7.x. <code>\Exception</code> implements the <a href="http://php.net/manual/en/class.throwable.php"><code>\Throwable</code> interface</a> since PHP 7.0, so you can skip the part with <code>\Exception</code> if your app uses only PHP 7.0 and higher.</p> </blockquote>    <h2 id="properties">Public Properties</h2>  <table> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="$db"> <td><a href="yii-db-transaction.html#%24db-detail">$db</a></td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>The database connection that this transaction is associated with.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="$isActive"> <td><a href="yii-db-transaction.html#%24isActive-detail">$isActive</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether this transaction is active.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="$isolationLevel"> <td><a href="yii-db-transaction.html#%24isolationLevel-detail">$isolationLevel</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The transaction isolation level to use for this transaction.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="$level"> <td><a href="yii-db-transaction.html#%24level-detail">$level</a></td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>The current nesting level of the transaction.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> </table>    <h2 id="methods">Public Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="__call()"> <td><a href="yii-base-object.html#__call()-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__construct()"> <td><a href="yii-base-object.html#__construct()-detail">__construct()</a></td> <td>Constructor.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__get()"> <td><a href="yii-base-object.html#__get()-detail">__get()</a></td> <td>Returns the value of an object property.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__isset()"> <td><a href="yii-base-object.html#__isset()-detail">__isset()</a></td> <td>Checks if a property is set, i.e. defined and not null.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__set()"> <td><a href="yii-base-object.html#__set()-detail">__set()</a></td> <td>Sets value of an object property.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__unset()"> <td><a href="yii-base-object.html#__unset()-detail">__unset()</a></td> <td>Sets an object property to null.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="begin()"> <td><a href="yii-db-transaction.html#begin()-detail">begin()</a></td> <td>Begins a transaction.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="canGetProperty()"> <td><a href="yii-base-object.html#canGetProperty()-detail">canGetProperty()</a></td> <td>Returns a value indicating whether a property can be read.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="canSetProperty()"> <td><a href="yii-base-object.html#canSetProperty()-detail">canSetProperty()</a></td> <td>Returns a value indicating whether a property can be set.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="className()"> <td><a href="yii-base-object.html#className()-detail">className()</a></td> <td>Returns the fully qualified name of this class.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="commit()"> <td><a href="yii-db-transaction.html#commit()-detail">commit()</a></td> <td>Commits a transaction.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="getIsActive()"> <td><a href="yii-db-transaction.html#getIsActive()-detail">getIsActive()</a></td> <td>Returns a value indicating whether this transaction is active.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="getLevel()"> <td><a href="yii-db-transaction.html#getLevel()-detail">getLevel()</a></td> <td></td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="hasMethod()"> <td><a href="yii-base-object.html#hasMethod()-detail">hasMethod()</a></td> <td>Returns a value indicating whether a method is defined.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="hasProperty()"> <td><a href="yii-base-object.html#hasProperty()-detail">hasProperty()</a></td> <td>Returns a value indicating whether a property is defined.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="init()"> <td><a href="yii-base-object.html#init()-detail">init()</a></td> <td>Initializes the object.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="rollBack()"> <td><a href="yii-db-transaction.html#rollBack()-detail">rollBack()</a></td> <td>Rolls back a transaction.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="setIsolationLevel()"> <td><a href="yii-db-transaction.html#setIsolationLevel()-detail">setIsolationLevel()</a></td> <td>Sets the transaction isolation level for this transaction.</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> </table>     <h2 id="constants">Constants</h2>  <table> <colgroup> <col class="col-const"> <col class="col-value"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Constant</th>
<th>Value</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="READ_COMMITTED"> <td id="READ_COMMITTED-detail">READ_COMMITTED</td> <td>'READ COMMITTED'</td> <td>A constant representing the transaction isolation level <code>READ COMMITTED</code>. </td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="READ_UNCOMMITTED"> <td id="READ_UNCOMMITTED-detail">READ_UNCOMMITTED</td> <td>'READ UNCOMMITTED'</td> <td>A constant representing the transaction isolation level <code>READ UNCOMMITTED</code>. </td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="REPEATABLE_READ"> <td id="REPEATABLE_READ-detail">REPEATABLE_READ</td> <td>'REPEATABLE READ'</td> <td>A constant representing the transaction isolation level <code>REPEATABLE READ</code>. </td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> <tr id="SERIALIZABLE"> <td id="SERIALIZABLE-detail">SERIALIZABLE</td> <td>'SERIALIZABLE'</td> <td>A constant representing the transaction isolation level <code>SERIALIZABLE</code>. </td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> </tr> </table>  <h2>Property Details</h2>  <h3 id="$db-detail"> $db <span class="detail-header-tag small"> public property </span> </h3>  <p>The database connection that this transaction is associated with.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-connection.html">yii\db\Connection</a></span> <a href="yii-db-transaction.html#%24db-detail">$db</a> = null</pre> <h3 id="$isActive-detail"> $isActive <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>Whether this transaction is active. Only an active transaction can <a href="yii-db-transaction.html#commit()-detail">commit()</a> or <a href="yii-db-transaction.html#rollBack()-detail">rollBack()</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <strong><a href="yii-db-transaction.html#getIsActive()-detail">getIsActive</a></strong> ( )</pre> <h3 id="$isolationLevel-detail"> $isolationLevel <span class="detail-header-tag small"> public <em>write-only</em> property </span> </h3>  <p>The transaction isolation level to use for this transaction. This can be one of <a href="yii-db-transaction.html#READ_UNCOMMITTED-detail">READ_UNCOMMITTED</a>, <a href="yii-db-transaction.html#READ_COMMITTED-detail">READ_COMMITTED</a>, <a href="yii-db-transaction.html#REPEATABLE_READ-detail">REPEATABLE_READ</a> and <a href="yii-db-transaction.html#SERIALIZABLE-detail">SERIALIZABLE</a> but also a string containing DBMS specific syntax to be used after <code>SET TRANSACTION ISOLATION LEVEL</code>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type">void</span> <strong><a href="yii-db-transaction.html#setIsolationLevel()-detail">setIsolationLevel</a></strong> ( $level )</pre> <h3 id="$level-detail"> $level <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The current nesting level of the transaction.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.integer">integer</a></span> <strong><a href="yii-db-transaction.html#getLevel()-detail">getLevel</a></strong> ( )</pre>  <h2>Method Details</h2> <div class="method-doc"> <h3 id="begin()-detail"> begin() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Begins a transaction.</strong></p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-transaction.html#begin()-detail">begin</a></strong> ( $isolationLevel = null )</th></tr> <tr> <td>$isolationLevel</td> <td>
<a href="http://www.php.net/language.types.string">string</a>|<a href="http://www.php.net/language.types.null">null</a>
</td> <td>
<p>The <a href="http://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Isolation_levels">isolation level</a> to use for this transaction. This can be one of <a href="yii-db-transaction.html#READ_UNCOMMITTED-detail">READ_UNCOMMITTED</a>, <a href="yii-db-transaction.html#READ_COMMITTED-detail">READ_COMMITTED</a>, <a href="yii-db-transaction.html#REPEATABLE_READ-detail">REPEATABLE_READ</a> and <a href="yii-db-transaction.html#SERIALIZABLE-detail">SERIALIZABLE</a> but also a string containing DBMS specific syntax to be used after <code>SET TRANSACTION ISOLATION LEVEL</code>. If not specified (<code>null</code>) the isolation level will not be set explicitly and the DBMS default will be used.</p> <blockquote class="note">
<p><strong>Note: </strong>This setting does not work for PostgreSQL, where setting the isolation level before the transaction has no effect. You have to call <a href="yii-db-transaction.html#setIsolationLevel()-detail">setIsolationLevel()</a> in this case after the transaction has started.</p> </blockquote> <blockquote class="note">
<p><strong>Note: </strong>Some DBMS allow setting of the isolation level only for the whole connection so subsequent transactions may get the same isolation level even if you did not specify any. When using this feature you may need to set the isolation level for all transactions explicitly to avoid conflicting settings. At the time of this writing affected DBMS are MSSQL and SQLite.</p> </blockquote> </td> </tr> <tr> <td>throws</td> <td><a href="yii-base-invalidconfigexception.html">yii\base\InvalidConfigException</a></td> <td>
<p>if <a href="yii-db-transaction.html#%24db-detail">$db</a> is <code>null</code>.</p> </td> </tr> </table>  <h3 id="commit()-detail"> commit() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Commits a transaction.</strong></p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-transaction.html#commit()-detail">commit</a></strong> ( )</th></tr> <tr> <td>throws</td> <td><a href="yii-db-exception.html">yii\db\Exception</a></td> <td>
<p>if the transaction is not active</p> </td> </tr> </table>  <h3 id="getIsActive()-detail"> getIsActive() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns a value indicating whether this transaction is active.</strong></p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.boolean">boolean</a> <strong><a href="yii-db-transaction.html#getIsActive()-detail">getIsActive</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Whether this transaction is active. Only an active transaction can <a href="yii-db-transaction.html#commit()-detail">commit()</a> or <a href="yii-db-transaction.html#rollBack()-detail">rollBack()</a>.</p> </td> </tr> </table>  <h3 id="getLevel()-detail"> getLevel() <span class="detail-header-tag small"> public method (available since version 2.0.8) </span> </h3>    <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.integer">integer</a> <strong><a href="yii-db-transaction.html#getLevel()-detail">getLevel</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>
<p>The current nesting level of the transaction.</p> </td> </tr> </table>  <h3 id="rollBack()-detail"> rollBack() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Rolls back a transaction.</strong></p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-transaction.html#rollBack()-detail">rollBack</a></strong> ( )</th></tr> <tr> <td>throws</td> <td><a href="yii-db-exception.html">yii\db\Exception</a></td> <td>
<p>if the transaction is not active</p> </td> </tr> </table>  <h3 id="setIsolationLevel()-detail"> setIsolationLevel() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Sets the transaction isolation level for this transaction.</strong></p> <p>This method can be used to set the isolation level while the transaction is already active. However this is not supported by all DBMS so you might rather specify the isolation level directly when calling <a href="yii-db-transaction.html#begin()-detail">begin()</a>.</p> <p>See also <a href="http://en.wikipedia.org/wiki/Isolation_%28database_systems%29#Isolation_levels">http://en.wikipedia.org/wiki/Isolation_(database_systems)#Isolation_levels</a>.</p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-transaction.html#setIsolationLevel()-detail">setIsolationLevel</a></strong> ( $level )</th></tr> <tr> <td>$level</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The transaction isolation level to use for this transaction. This can be one of <a href="yii-db-transaction.html#READ_UNCOMMITTED-detail">READ_UNCOMMITTED</a>, <a href="yii-db-transaction.html#READ_COMMITTED-detail">READ_COMMITTED</a>, <a href="yii-db-transaction.html#REPEATABLE_READ-detail">REPEATABLE_READ</a> and <a href="yii-db-transaction.html#SERIALIZABLE-detail">SERIALIZABLE</a> but also a string containing DBMS specific syntax to be used after <code>SET TRANSACTION ISOLATION LEVEL</code>.</p> </td> </tr> <tr> <td>throws</td> <td><a href="yii-db-exception.html">yii\db\Exception</a></td> <td>
<p>if the transaction is not active</p> </td> </tr> </table>  </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2008&ndash;2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc-2.0/yii-db-transaction.html" class="_attribution-link">http://www.yiiframework.com/doc-2.0/yii-db-transaction.html</a>
  </p>
</div>
