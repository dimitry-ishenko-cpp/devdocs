<h1>Assets 
</h1> <div class="toc"><ol>
<li><a href="#asset-bundles">Asset Bundles</a></li> <li><a href="#defining-asset-bundles">Defining Asset Bundles</a></li> <li><a href="#using-asset-bundles">Using Asset Bundles</a></li> <li><a href="#common-asset-bundles">Commonly Used Asset Bundles</a></li> <li><a href="#asset-conversion">Asset Conversion</a></li> <li><a href="#combining-compressing-assets">Combining and Compressing Assets</a></li>
</ol></div> <p>An asset in Yii is a file that may be referenced in a Web page. It can be a CSS file, a JavaScript file, an image or video file, etc. Assets are located in Web-accessible directories and are directly served by Web servers.</p> <p>It is often preferable to manage assets programmatically. For example, when you use the <a href="yii-jui-datepicker.html">yii\jui\DatePicker</a> widget in a page, it will automatically include the required CSS and JavaScript files, instead of asking you to manually find these files and include them. And when you upgrade the widget to a new version, it will automatically use the new version of the asset files. In this tutorial, we will describe the powerful asset management capability provided in Yii.</p> <h2>Asset Bundles 
</h2>
<p>Yii manages assets in the unit of <em>asset bundle</em>. An asset bundle is simply a collection of assets located in a directory. When you register an asset bundle in a <a href="guide-structure-views.html">view</a>, it will include the CSS and JavaScript files in the bundle in the rendered Web page.</p> <h2>Defining Asset Bundles 
</h2>
<p>Asset bundles are specified as PHP classes extending from <a href="yii-web-assetbundle.html">yii\web\AssetBundle</a>. The name of a bundle is simply its corresponding fully qualified PHP class name (without the leading backslash). An asset bundle class should be <a href="guide-concept-autoloading.html">autoloadable</a>. It usually specifies where the assets are located, what CSS and JavaScript files the bundle contains, and how the bundle depends on other bundles.</p> <p>The following code defines the main asset bundle used by <a href="guide-start-installation.html">the basic project template</a>:</p> <pre data-language="php">&lt;?php

namespace app\assets;

use yii\web\AssetBundle;

class AppAsset extends AssetBundle
{
    public $basePath = '@webroot';
    public $baseUrl = '@web';
    public $css = [
        'css/site.css',
    ];
    public $js = [
    ];
    public $depends = [
        'yii\web\YiiAsset',
        'yii\bootstrap\BootstrapAsset',
    ];
}
</pre> <p>The above <code>AppAsset</code> class specifies that the asset files are located under the <code>@webroot</code> directory which corresponds to the URL <code>@web</code>; the bundle contains a single CSS file <code>css/site.css</code> and no JavaScript file; the bundle depends on two other bundles: <a href="yii-web-yiiasset.html">yii\web\YiiAsset</a> and <a href="yii-bootstrap-bootstrapasset.html">yii\bootstrap\BootstrapAsset</a>. More detailed explanation about the properties of <a href="yii-web-assetbundle.html">yii\web\AssetBundle</a> can be found in the following:</p> <ul> <li>
<a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a>: specifies the root directory that contains the asset files in this bundle. This property should be set if the root directory is not Web accessible. Otherwise, you should set the <a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a> property and <a href="yii-web-assetbundle.html#%24baseUrl-detail">baseUrl</a>, instead. <a href="guide-concept-aliases.html">Path aliases</a> can be used here.</li> <li>
<a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a>: specifies a Web-accessible directory that contains the asset files in this bundle. When you specify the <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a> property, the <a href="#asset-manager">asset manager</a> will publish the assets in this bundle to a Web-accessible directory and overwrite this property accordingly. You should set this property if your asset files are already in a Web-accessible directory and do not need asset publishing. <a href="guide-concept-aliases.html">Path aliases</a> can be used here.</li> <li>
<a href="yii-web-assetbundle.html#%24baseUrl-detail">baseUrl</a>: specifies the URL corresponding to the directory <a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a>. Like <a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a>, if you specify the <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a> property, the <a href="#asset-manager">asset manager</a> will publish the assets and overwrite this property accordingly. <a href="guide-concept-aliases.html">Path aliases</a> can be used here.</li> <li>
<a href="yii-web-assetbundle.html#%24js-detail">js</a>: an array listing the JavaScript files contained in this bundle. Note that only forward slash "/" should be used as directory separators. Each JavaScript file can be specified in one of the following two formats:<ul> <li>a relative path representing a local JavaScript file (e.g. <code>js/main.js</code>). The actual path of the file can be determined by prepending <a href="yii-web-assetmanager.html#%24basePath-detail">yii\web\AssetManager::$basePath</a> to the relative path, and the actual URL of the file can be determined by prepending <a href="yii-web-assetmanager.html#%24baseUrl-detail">yii\web\AssetManager::$baseUrl</a> to the relative path.</li> <li>an absolute URL representing an external JavaScript file. For example, <code>http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</code> or <code>//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js</code>.</li> </ul> </li> <li>
<a href="yii-web-assetbundle.html#%24css-detail">css</a>: an array listing the CSS files contained in this bundle. The format of this array is the same as that of <a href="yii-web-assetbundle.html#%24js-detail">js</a>.</li> <li>
<a href="yii-web-assetbundle.html#%24depends-detail">depends</a>: an array listing the names of the asset bundles that this bundle depends on (to be explained shortly).</li> <li>
<a href="yii-web-assetbundle.html#%24jsOptions-detail">jsOptions</a>: specifies the options that will be passed to the <a href="yii-web-view.html#registerJsFile()-detail">yii\web\View::registerJsFile()</a> method when it is called to register <em>every</em> JavaScript file in this bundle.</li> <li>
<a href="yii-web-assetbundle.html#%24cssOptions-detail">cssOptions</a>: specifies the options that will be passed to the <a href="yii-web-view.html#registerCssFile()-detail">yii\web\View::registerCssFile()</a> method when it is called to register <em>every</em> CSS file in this bundle.</li> <li>
<a href="yii-web-assetbundle.html#%24publishOptions-detail">publishOptions</a>: specifies the options that will be passed to the <a href="yii-web-assetmanager.html#publish()-detail">yii\web\AssetManager::publish()</a> method when it is called to publish source asset files to a Web directory. This is only used if you specify the <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a> property.</li> </ul> <h3>Asset Locations 
</h3>
<p>Assets, based on their location, can be classified as:</p> <ul> <li>source assets: the asset files are located together with PHP source code which cannot be directly accessed via Web. In order to use source assets in a page, they should be copied to a Web directory and turned into the so-called published assets. This process is called <em>asset publishing</em> which will be described in detail shortly.</li> <li>published assets: the asset files are located in a Web directory and can thus be directly accessed via Web.</li> <li>external assets: the asset files are located on a Web server that is different from the one hosting your Web application.</li> </ul> <p>When defining an asset bundle class, if you specify the <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a> property, it means any assets listed using relative paths will be considered as source assets. If you do not specify this property, it means those assets are published assets (you should therefore specify <a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a> and <a href="yii-web-assetbundle.html#%24baseUrl-detail">baseUrl</a> to let Yii know where they are located).</p> <p>It is recommended that you place assets belonging to an application in a Web directory to avoid the unnecessary asset publishing process. This is why <code>AppAsset</code> in the prior example specifies <a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a> instead of <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a>.</p> <p>For <a href="guide-structure-extensions.html">extensions</a>, because their assets are located together with their source code in directories that are not Web accessible, you have to specify the <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a> property when defining asset bundle classes for them.</p> <blockquote class="note">
<p><strong>Note: </strong>Do not use <code>@webroot/assets</code> as the <a href="yii-web-assetbundle.html#%24sourcePath-detail">source path</a>. This directory is used by default by the <a href="yii-web-assetmanager.html">asset manager</a> to save the asset files published from their source location. Any content in this directory is considered temporarily and may be subject to removal.</p> </blockquote> <h3>Asset Dependencies 
</h3>
<p>When you include multiple CSS or JavaScript files in a Web page, they have to follow a certain order to avoid overriding issues. For example, if you are using a jQuery UI widget in a Web page, you have to make sure the jQuery JavaScript file is included before the jQuery UI JavaScript file. We call such ordering the dependencies among assets.</p> <p>Asset dependencies are mainly specified through the <a href="yii-web-assetbundle.html#%24depends-detail">yii\web\AssetBundle::$depends</a> property. In the <code>AppAsset</code> example, the asset bundle depends on two other asset bundles: <a href="yii-web-yiiasset.html">yii\web\YiiAsset</a> and <a href="yii-bootstrap-bootstrapasset.html">yii\bootstrap\BootstrapAsset</a>, which means the CSS and JavaScript files in <code>AppAsset</code> will be included <em>after</em> those files in the two dependent bundles.</p> <p>Asset dependencies are transitive. This means if bundle A depends on B which depends on C, A will depend on C, too.</p> <h3>Asset Options 
</h3>
<p>You can specify the <a href="yii-web-assetbundle.html#%24cssOptions-detail">cssOptions</a> and <a href="yii-web-assetbundle.html#%24jsOptions-detail">jsOptions</a> properties to customize the way that CSS and JavaScript files are included in a page. The values of these properties will be passed to the <a href="yii-web-view.html#registerCssFile()-detail">yii\web\View::registerCssFile()</a> and <a href="yii-web-view.html#registerJsFile()-detail">yii\web\View::registerJsFile()</a> methods, respectively, when they are called by the <a href="guide-structure-views.html">view</a> to include CSS and JavaScript files.</p> <blockquote class="note">
<p><strong>Note: </strong>The options you set in a bundle class apply to <em>every</em> CSS/JavaScript file in the bundle. If you want to use different options for different files, you should create separate asset bundles, and use one set of options in each bundle.</p> </blockquote> <p>For example, to conditionally include a CSS file for browsers that are IE9 or below, you can use the following option:</p> <pre data-language="php">public $cssOptions = ['condition' =&gt; 'lte IE9'];
</pre> <p>This will cause a CSS file in the bundle to be included using the following HTML tags:</p> <pre data-language="php">&lt;!--[if lte IE9]&gt;
&lt;link rel="stylesheet" href="path/to/foo.css.html"&gt;
&lt;![endif]--&gt;
</pre> <p>To wrap the generated CSS link tags within <code>&lt;noscript&gt;</code>, you can configure <code>cssOptions</code> as follows,</p> <pre data-language="php">public $cssOptions = ['noscript' =&gt; true];
</pre> <p>To include a JavaScript file in the head section of a page (by default, JavaScript files are included at the end of the body section), use the following option:</p> <pre data-language="php">public $jsOptions = ['position' =&gt; \yii\web\View::POS_HEAD];
</pre> <p>By default, when an asset bundle is being published, all contents in the directory specified by <a href="yii-web-assetbundle.html#%24sourcePath-detail">yii\web\AssetBundle::$sourcePath</a> will be published. You can customize this behavior by configuring the <a href="yii-web-assetbundle.html#%24publishOptions-detail">publishOptions</a> property. For example, to publish only one or a few subdirectories of <a href="yii-web-assetbundle.html#%24sourcePath-detail">yii\web\AssetBundle::$sourcePath</a>, you can do the following in the asset bundle class:</p> <pre data-language="php">&lt;?php
namespace app\assets;

use yii\web\AssetBundle;

class FontAwesomeAsset extends AssetBundle 
{
    public $sourcePath = '@bower/font-awesome'; 
    public $css = [ 
        'css/font-awesome.min.css', 
    ];
    public $publishOptions = [
        'only' =&gt; [
            'fonts/',
            'css/',
        ]
    ];
}  
</pre> <p>The above example defines an asset bundle for the <a href="http://fontawesome.io/">"fontawesome" package</a>. By specifying the <code>only</code> publishing option, only the <code>fonts</code> and <code>css</code> subdirectories will be published.</p> <h3>Bower and NPM Assets installation 
</h3>
<p>Most JavaScript/CSS packages are managed by <a href="http://bower.io/">Bower</a> and/or <a href="https://www.npmjs.org/">NPM</a> package managers. In PHP world we have Composer, that manages PHP dependencies, but it is possible to load both Bower and NPM packages using <code>composer.json</code> just as PHP packages.</p> <p>To achieve this, we should configure our composer a bit. There are two options to do that:</p> <hr> <h5>Using asset-packagist repository 
</h5>
<p>This way will satisfy requirements of the majority of projects, that need NPM or Bower packages.</p> <blockquote class="note">
<p><strong>Note: </strong>Since 2.0.13 both Basic and Advanced application templates are pre-configured to use asset-packagist by default, so you can skip this section.</p> </blockquote> <p>In the <code>composer.json</code> of your project, add the following lines:</p> <pre data-language="php">"repositories": [
    {
        "type": "composer",
        "url": "https://asset-packagist.org"
    }
]
</pre> <p>Adjust <code>@npm</code> and <code>@bower</code> <a href="guide-concept-aliases.html">aliases</a> in you <a href="guide-concept-configurations.html">application configuration</a>:</p> <pre data-language="php">$config = [
    ...
    'aliases' =&gt; [
        '@bower' =&gt; '@vendor/bower-asset',
        '@npm'   =&gt; '@vendor/npm-asset',
    ],
    ...
];
</pre> <p>Visit <a href="https://asset-packagist.org">asset-packagist.org</a> to know, how it works.</p> <h5>Using fxp/composer-asset-plugin 
</h5>
<p>Comparing to to using asset-packagist, composer-asset-plugin does not require to change application config. Instead, it requires to install a special Composer plugin globally by running the following command:</p> <pre data-language="php">composer global require "fxp/composer-asset-plugin:^1.3.1"
</pre> <p>This command installs <a href="https://github.com/francoispluchino/composer-asset-plugin/">composer asset plugin</a> globally which allows managing Bower and NPM package dependencies through Composer. After the plugin installation, every single project on your computer will support Bower and NPM packages through <code>composer.json</code>. </p> <p>Add the following lines to <code>composer.json</code> of your project to adjust directories where the installed packages will be placed, if you want to publish them using Yii:</p> <pre data-language="php">"extra": {
    "asset-installer-paths": {
        "npm-asset-library": "vendor/npm",
        "bower-asset-library": "vendor/bower"
    }
}
</pre> <blockquote class="note">
<p><strong>Note: </strong><code>fxp/composer-asset-plugin</code> significantly slows down the <code>composer update</code> command in comparison to asset-packagist.</p> </blockquote> <hr> <p>After configuring Composer to support Bower and NPM:</p> <ol> <li>Modify the <code>composer.json</code> file of your application or extension and list the package in the <code>require</code> entry. You should use <code>bower-asset/PackageName</code> (for Bower packages) or <code>npm-asset/PackageName</code> (for NPM packages) to refer to the library.</li> <li>Run <code>composer update</code>
</li> <li>Create an asset bundle class and list the JavaScript/CSS files that you plan to use in your application or extension. You should specify the <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a> property as <code>@bower/PackageName</code> or <code>@npm/PackageName</code>. This is because Composer will install the Bower or NPM package in the directory corresponding to this alias.</li> </ol> <blockquote class="note">
<p><strong>Note: </strong>Some packages may put all their distributed files in a subdirectory. If this is the case, you should specify the subdirectory as the value of <a href="yii-web-assetbundle.html#%24sourcePath-detail">sourcePath</a>. For example, <a href="yii-web-jqueryasset.html">yii\web\JqueryAsset</a> uses <code>@bower/jquery/dist</code> instead of <code>@bower/jquery</code>.</p> </blockquote> <h2>Using Asset Bundles 
</h2>
<p>To use an asset bundle, register it with a <a href="guide-structure-views.html">view</a> by calling the <a href="yii-web-assetbundle.html#register()-detail">yii\web\AssetBundle::register()</a> method. For example, in a view template you can register an asset bundle like the following:</p> <pre data-language="php">use app\assets\AppAsset;
AppAsset::register($this);  // $this represents the view object
</pre> <blockquote class="info">
<p><strong>Info: </strong>The <a href="yii-web-assetbundle.html#register()-detail">yii\web\AssetBundle::register()</a> method returns an asset bundle object containing the information about the published assets, such as <a href="yii-web-assetbundle.html#%24basePath-detail">basePath</a> or <a href="yii-web-assetbundle.html#%24baseUrl-detail">baseUrl</a>.</p> </blockquote> <p>If you are registering an asset bundle in other places, you should provide the needed view object. For example, to register an asset bundle in a <a href="guide-structure-widgets.html">widget</a> class, you can get the view object by <code>$this-&gt;view</code>.</p> <p>When an asset bundle is registered with a view, behind the scenes Yii will register all its dependent asset bundles. And if an asset bundle is located in a directory inaccessible through the Web, it will be published to a Web directory. Later, when the view renders a page, it will generate <code>&lt;link&gt;</code> and <code>&lt;script&gt;</code> tags for the CSS and JavaScript files listed in the registered bundles. The order of these tags is determined by the dependencies among the registered bundles and the order of the assets listed in the <a href="yii-web-assetbundle.html#%24css-detail">yii\web\AssetBundle::$css</a> and <a href="yii-web-assetbundle.html#%24js-detail">yii\web\AssetBundle::$js</a> properties.</p> <h3>Dynamic Asset Bundles 
</h3>
<p>Being a regular PHP class asset bundle can bear some extra logic related to it and may adjust its internal parameters dynamically. For example: you may use some sophisticated JavaScript library, which provides some internationalization packed in separated source files: each per each supported language. Thus you will need to add particular '.js' file to your page in order to make library translation work. This can be achieved overriding <a href="yii-web-assetbundle.html#init()-detail">yii\web\AssetBundle::init()</a> method:</p> <pre data-language="php">namespace app\assets;

use yii\web\AssetBundle;
use Yii;

class SophisticatedAssetBundle extends AssetBundle
{
    public $sourcePath = '/path/to/sophisticated/src';
    public $js = [
        'sophisticated.js' // file, which is always used
    ];

    public function init()
    {
        parent::init();
        $this-&gt;js[] = 'i18n/' . Yii::$app-&gt;language . '.js'; // dynamic file added
    }
}
</pre> <p>Particular asset bundle can also be adjusted via its instance returned by <a href="yii-web-assetbundle.html#register()-detail">yii\web\AssetBundle::register()</a>. For example:</p> <pre data-language="php">use app\assets\SophisticatedAssetBundle;
use Yii;

$bundle = SophisticatedAssetBundle::register(Yii::$app-&gt;view);
$bundle-&gt;js[] = 'i18n/' . Yii::$app-&gt;language . '.js'; // dynamic file added
</pre> <blockquote class="note">
<p><strong>Note: </strong>although dynamic adjustment of the asset bundles is supported, it is a <strong>bad</strong> practice, which may lead to unexpected side effects, and should be avoided if possible.</p> </blockquote> <h3>Customizing Asset Bundles 
</h3>
<p>Yii manages asset bundles through an application component named <code>assetManager</code> which is implemented by <a href="yii-web-assetmanager.html">yii\web\AssetManager</a>. By configuring the <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> property, it is possible to customize the behavior of an asset bundle. For example, the default <a href="yii-web-jqueryasset.html">yii\web\JqueryAsset</a> asset bundle uses the <code>jquery.js</code> file from the installed jquery Bower package. To improve the availability and performance, you may want to use a version hosted by Google. This can be achieved by configuring <code>assetManager</code> in the application configuration like the following:</p> <pre data-language="php">return [
    // ...
    'components' =&gt; [
        'assetManager' =&gt; [
            'bundles' =&gt; [
                'yii\web\JqueryAsset' =&gt; [
                    'sourcePath' =&gt; null,   // do not publish the bundle
                    'js' =&gt; [
                        '//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js',
                    ]
                ],
            ],
        ],
    ],
];
</pre> <p>You can configure multiple asset bundles similarly through <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a>. The array keys should be the class names (without the leading backslash) of the asset bundles, and the array values should be the corresponding <a href="guide-concept-configurations.html">configuration arrays</a>.</p> <blockquote class="tip">
<p><strong>Tip: </strong>You can conditionally choose which assets to use in an asset bundle. The following example shows how to use <code>jquery.js</code> in the development environment and <code>jquery.min.js</code> otherwise:</p> <pre data-language="php">'yii\web\JqueryAsset' =&gt; [
    'js' =&gt; [
        YII_ENV_DEV ? 'jquery.js' : 'jquery.min.js'
    ]
],
</pre> </blockquote> <p>You can disable one or multiple asset bundles by associating <code>false</code> with the names of the asset bundles that you want to disable. When you register a disabled asset bundle with a view, none of its dependent bundles will be registered, and the view also will not include any of the assets in the bundle in the page it renders. For example, to disable <a href="yii-web-jqueryasset.html">yii\web\JqueryAsset</a>, you can use the following configuration:</p> <pre data-language="php">return [
    // ...
    'components' =&gt; [
        'assetManager' =&gt; [
            'bundles' =&gt; [
                'yii\web\JqueryAsset' =&gt; false,
            ],
        ],
    ],
];
</pre> <p>You can also disable <em>all</em> asset bundles by setting <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> as <code>false</code>.</p> <p>Keep in mind that customization made via <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> is applied at the creation of the asset bundle, e.g. at object constructor stage. Thus any adjustments made to the bundle object after that will override the mapping setup at <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> level. In particular: adjustments made inside <a href="yii-web-assetbundle.html#init()-detail">yii\web\AssetBundle::init()</a> method or over the registered bundle object will take precedence over <code>AssetManager</code> configuration. Here are the examples, where mapping set via <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> makes no effect:</p> <pre data-language="php">// Program source code:

namespace app\assets;

use yii\web\AssetBundle;
use Yii;

class LanguageAssetBundle extends AssetBundle
{
    // ...

    public function init()
    {
        parent::init();
        $this-&gt;baseUrl = '@web/i18n/' . Yii::$app-&gt;language; // can NOT be handled by `AssetManager`!
    }
}
// ...

$bundle = \app\assets\LargeFileAssetBundle::register(Yii::$app-&gt;view);
$bundle-&gt;baseUrl = YII_DEBUG ? '@web/large-files': '@web/large-files/minified'; // can NOT be handled by `AssetManager`!


// Application config :

return [
    // ...
    'components' =&gt; [
        'assetManager' =&gt; [
            'bundles' =&gt; [
                'app\assets\LanguageAssetBundle' =&gt; [
                    'baseUrl' =&gt; 'http://some.cdn.com/files/i18n/en' // makes NO effect!
                ],
                'app\assets\LargeFileAssetBundle' =&gt; [
                    'baseUrl' =&gt; 'http://some.cdn.com/files/large-files' // makes NO effect!
                ],
            ],
        ],
    ],
];
</pre> <h3>Asset Mapping 
</h3>
<p>Sometimes you may want to "fix" incorrect/incompatible asset file paths used in multiple asset bundles. For example, bundle A uses <code>jquery.min.js</code> version 1.11.1, and bundle B uses <code>jquery.js</code> version 2.1.1. While you can fix the problem by customizing each bundle, an easier way is to use the <em>asset map</em> feature to map incorrect assets to the desired ones. To do so, configure the <a href="yii-web-assetmanager.html#%24assetMap-detail">yii\web\AssetManager::$assetMap</a> property like the following:</p> <pre data-language="php">return [
    // ...
    'components' =&gt; [
        'assetManager' =&gt; [
            'assetMap' =&gt; [
                'jquery.js' =&gt; '//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js',
            ],
        ],
    ],
];
</pre> <p>The keys of <a href="yii-web-assetmanager.html#%24assetMap-detail">assetMap</a> are the asset names that you want to fix, and the values are the desired asset paths. When you register an asset bundle with a view, each relative asset file in its <a href="yii-web-assetbundle.html#%24css-detail">css</a> and <a href="yii-web-assetbundle.html#%24js-detail">js</a> arrays will be examined against this map. If any of the keys are found to be the last part of an asset file (which is prefixed with <a href="yii-web-assetbundle.html#%24sourcePath-detail">yii\web\AssetBundle::$sourcePath</a> if available), the corresponding value will replace the asset and be registered with the view. For example, the asset file <code>my/path/to/jquery.js</code> matches the key <code>jquery.js</code>.</p> <blockquote class="note">
<p><strong>Note: </strong>Only assets specified using relative paths are subject to asset mapping. The target asset paths should be either absolute URLs or paths relative to <a href="yii-web-assetmanager.html#%24basePath-detail">yii\web\AssetManager::$basePath</a>.</p> </blockquote> <h3>Asset Publishing 
</h3>
<p>As aforementioned, if an asset bundle is located in a directory that is not Web accessible, its assets will be copied to a Web directory when the bundle is being registered with a view. This process is called <em>asset publishing</em>, and is done automatically by the <a href="yii-web-assetmanager.html">asset manager</a>.</p> <p>By default, assets are published to the directory <code>@webroot/assets</code> which corresponds to the URL <code>@web/assets</code>. You may customize this location by configuring the <a href="yii-web-assetmanager.html#%24basePath-detail">basePath</a> and <a href="yii-web-assetmanager.html#%24baseUrl-detail">baseUrl</a> properties.</p> <p>Instead of publishing assets by file copying, you may consider using symbolic links, if your OS and Web server allow. This feature can be enabled by setting <a href="yii-web-assetmanager.html#%24linkAssets-detail">linkAssets</a> to be <code>true</code>.</p> <pre data-language="php">return [
    // ...
    'components' =&gt; [
        'assetManager' =&gt; [
            'linkAssets' =&gt; true,
        ],
    ],
];
</pre> <p>With the above configuration, the asset manager will create a symbolic link to the source path of an asset bundle when it is being published. This is faster than file copying and can also ensure that the published assets are always up-to-date.</p> <h3>Cache Busting 
</h3>
<p>For Web application running in production mode, it is a common practice to enable HTTP caching for assets and other static resources. A drawback of this practice is that whenever you modify an asset and deploy it to production, a user client may still use the old version due to the HTTP caching. To overcome this drawback, you may use the cache busting feature, which was introduced in version 2.0.3, by configuring <a href="yii-web-assetmanager.html">yii\web\AssetManager</a> like the following:</p> <pre data-language="php">return [
    // ...
    'components' =&gt; [
        'assetManager' =&gt; [
            'appendTimestamp' =&gt; true,
        ],
    ],
];
</pre> <p>By doing so, the URL of every published asset will be appended with its last modification timestamp. For example, the URL to <code>yii.js</code> may look like <code>/assets/5515a87c/yii.js?v=1423448645"</code>, where the parameter <code>v</code> represents the last modification timestamp of the <code>yii.js</code> file. Now if you modify an asset, its URL will be changed, too, which causes the client to fetch the latest version of the asset.</p> <h2>Commonly Used Asset Bundles 
</h2>
<p>The core Yii code has defined many asset bundles. Among them, the following bundles are commonly used and may be referenced in your application or extension code.</p> <ul> <li>
<a href="yii-web-yiiasset.html">yii\web\YiiAsset</a>: It mainly includes the <code>yii.js</code> file which implements a mechanism of organizing JavaScript code in modules. It also provides special support for <code>data-method</code> and <code>data-confirm</code> attributes and other useful features. More information about <code>yii.js</code> can be found in the <a href="guide-output-client-scripts.html#yii.js">Client Scripts Section</a>.</li> <li>
<a href="yii-web-jqueryasset.html">yii\web\JqueryAsset</a>: It includes the <code>jquery.js</code> file from the jQuery Bower package.</li> <li>
<a href="yii-bootstrap-bootstrapasset.html">yii\bootstrap\BootstrapAsset</a>: It includes the CSS file from the Twitter Bootstrap framework.</li> <li>
<a href="yii-bootstrap-bootstrappluginasset.html">yii\bootstrap\BootstrapPluginAsset</a>: It includes the JavaScript file from the Twitter Bootstrap framework for supporting Bootstrap JavaScript plugins.</li> <li>
<a href="yii-jui-juiasset.html">yii\jui\JuiAsset</a>: It includes the CSS and JavaScript files from the jQuery UI library.</li> </ul> <p>If your code depends on jQuery, jQuery UI or Bootstrap, you should use these predefined asset bundles rather than creating your own versions. If the default setting of these bundles do not satisfy your needs, you may customize them as described in the <a href="#customizing-asset-bundles">Customizing Asset Bundle</a> subsection. </p> <h2>Asset Conversion 
</h2>
<p>Instead of directly writing CSS and/or JavaScript code, developers often write them in some extended syntax and use special tools to convert it into CSS/JavaScript. For example, for CSS code you may use <a href="http://lesscss.org/">LESS</a> or <a href="http://sass-lang.com/">SCSS</a>; and for JavaScript you may use <a href="http://www.typescriptlang.org/">TypeScript</a>.</p> <p>You can list the asset files in extended syntax in the <a href="yii-web-assetbundle.html#%24css-detail">css</a> and <a href="yii-web-assetbundle.html#%24js-detail">js</a> properties of an asset bundle. For example,</p> <pre data-language="php">class AppAsset extends AssetBundle
{
    public $basePath = '@webroot';
    public $baseUrl = '@web';
    public $css = [
        'css/site.less',
    ];
    public $js = [
        'js/site.ts',
    ];
    public $depends = [
        'yii\web\YiiAsset',
        'yii\bootstrap\BootstrapAsset',
    ];
}
</pre> <p>When you register such an asset bundle with a view, the <a href="yii-web-assetmanager.html">asset manager</a> will automatically run the pre-processor tools to convert assets in recognized extended syntax into CSS/JavaScript. When the view finally renders a page, it will include the CSS/JavaScript files in the page, instead of the original assets in extended syntax.</p> <p>Yii uses the file name extensions to identify which extended syntax an asset is in. By default it recognizes the following syntax and file name extensions:</p> <ul> <li>
<a href="http://lesscss.org/">LESS</a>: <code>.less</code>
</li> <li>
<a href="http://sass-lang.com/">SCSS</a>: <code>.scss</code>
</li> <li>
<a href="http://learnboost.github.io/stylus/">Stylus</a>: <code>.styl</code>
</li> <li>
<a href="http://coffeescript.org/">CoffeeScript</a>: <code>.coffee</code>
</li> <li>
<a href="http://www.typescriptlang.org/">TypeScript</a>: <code>.ts</code>
</li> </ul> <p>Yii relies on the installed pre-processor tools to convert assets. For example, to use <a href="http://lesscss.org/">LESS</a> you should install the <code>lessc</code> pre-processor command.</p> <p>You can customize the pre-processor commands and the supported extended syntax by configuring <a href="yii-web-assetmanager.html#%24converter-detail">yii\web\AssetManager::$converter</a> like the following:</p> <pre data-language="php">return [
    'components' =&gt; [
        'assetManager' =&gt; [
            'converter' =&gt; [
                'class' =&gt; 'yii\web\AssetConverter',
                'commands' =&gt; [
                    'less' =&gt; ['css', 'lessc {from} {to} --no-color'],
                    'ts' =&gt; ['js', 'tsc --out {to} {from}'],
                ],
            ],
        ],
    ],
];
</pre> <p>In the above, we specify the supported extended syntax via the <a href="yii-web-assetconverter.html#%24commands-detail">yii\web\AssetConverter::$commands</a> property. The array keys are the file extension names (without leading dot), and the array values are the resulting asset file extension names and the commands for performing the asset conversion. The tokens <code>{from}</code> and <code>{to}</code> in the commands will be replaced with the source asset file paths and the target asset file paths.</p> <blockquote class="info">
<p><strong>Info: </strong>There are other ways of working with assets in extended syntax, besides the one described above. For example, you can use build tools such as <a href="http://gruntjs.com/">grunt</a> to monitor and automatically convert assets in extended syntax. In this case, you should list the resulting CSS/JavaScript files in asset bundles rather than the original files.</p> </blockquote> <h2>Combining and Compressing Assets 
</h2>
<p>A Web page can include many CSS and/or JavaScript files. To reduce the number of HTTP requests and the overall download size of these files, a common practice is to combine and compress multiple CSS/JavaScript files into one or very few files, and then include these compressed files instead of the original ones in the Web pages. </p> <blockquote class="info">
<p><strong>Info: </strong>Combining and compressing assets are usually needed when an application is in production mode. In development mode, using the original CSS/JavaScript files is often more convenient for debugging purposes.</p> </blockquote> <p>In the following, we introduce an approach to combine and compress asset files without the need to modify your existing application code.</p> <ol> <li>Find all the asset bundles in your application that you plan to combine and compress.</li> <li>Divide these bundles into one or a few groups. Note that each bundle can only belong to a single group.</li> <li>Combine/compress the CSS files in each group into a single file. Do this similarly for the JavaScript files.</li> <li>Define a new asset bundle for each group:<ul> <li>Set the <a href="yii-web-assetbundle.html#%24css-detail">css</a> and <a href="yii-web-assetbundle.html#%24js-detail">js</a> properties to be the combined CSS and JavaScript files, respectively.</li> <li>Customize the asset bundles in each group by setting their <a href="yii-web-assetbundle.html#%24css-detail">css</a> and <a href="yii-web-assetbundle.html#%24js-detail">js</a> properties to be empty, and setting their <a href="yii-web-assetbundle.html#%24depends-detail">depends</a> property to be the new asset bundle created for the group.</li> </ul> </li> </ol> <p>Using this approach, when you register an asset bundle in a view, it causes the automatic registration of the new asset bundle for the group that the original bundle belongs to. And as a result, the combined/compressed asset files are included in the page, instead of the original ones.</p> <h3>An Example 
</h3>
<p>Let's use an example to further explain the above approach. </p> <p>Assume your application has two pages, X and Y. Page X uses asset bundles A, B and C, while Page Y uses asset bundles B, C and D. </p> <p>You have two ways to divide these asset bundles. One is to use a single group to include all asset bundles, the other is to put A in Group X, D in Group Y, and (B, C) in Group S. Which one is better? It depends. The first way has the advantage that both pages share the same combined CSS and JavaScript files, which makes HTTP caching more effective. On the other hand, because the single group contains all bundles, the size of the combined CSS and JavaScript files will be bigger and thus increase the initial file transmission time. For simplicity in this example, we will use the first way, i.e., use a single group to contain all bundles.</p> <blockquote class="info">
<p><strong>Info: </strong>Dividing asset bundles into groups is not trivial task. It usually requires analysis about the real world traffic data of various assets on different pages. At the beginning, you may start with a single group for simplicity. </p> </blockquote> <p>Use existing tools (e.g. <a href="https://developers.google.com/closure/compiler/">Closure Compiler</a>, <a href="https://github.com/yui/yuicompressor/">YUI Compressor</a>) to combine and compress CSS and JavaScript files in all the bundles. Note that the files should be combined in the order that satisfies the dependencies among the bundles. For example, if Bundle A depends on B which depends on both C and D, then you should list the asset files starting from C and D, followed by B and finally A. </p> <p>After combining and compressing, we get one CSS file and one JavaScript file. Assume they are named as <code>all-xyz.css</code> and <code>all-xyz.js</code>, where <code>xyz</code> stands for a timestamp or a hash that is used to make the file name unique to avoid HTTP caching problems.</p> <p>We are at the last step now. Configure the <a href="yii-web-assetmanager.html">asset manager</a> as follows in the application configuration:</p> <pre data-language="php">return [
    'components' =&gt; [
        'assetManager' =&gt; [
            'bundles' =&gt; [
                'all' =&gt; [
                    'class' =&gt; 'yii\web\AssetBundle',
                    'basePath' =&gt; '@webroot/assets',
                    'baseUrl' =&gt; '@web/assets',
                    'css' =&gt; ['all-xyz.css'],
                    'js' =&gt; ['all-xyz.js'],
                ],
                'A' =&gt; ['css' =&gt; [], 'js' =&gt; [], 'depends' =&gt; ['all']],
                'B' =&gt; ['css' =&gt; [], 'js' =&gt; [], 'depends' =&gt; ['all']],
                'C' =&gt; ['css' =&gt; [], 'js' =&gt; [], 'depends' =&gt; ['all']],
                'D' =&gt; ['css' =&gt; [], 'js' =&gt; [], 'depends' =&gt; ['all']],
            ],
        ],
    ],
];
</pre> <p>As explained in the <a href="#customizing-asset-bundles">Customizing Asset Bundles</a> subsection, the above configuration changes the default behavior of each bundle. In particular, Bundle A, B, C and D no longer have any asset files. They now all depend on the <code>all</code> bundle which contains the combined <code>all-xyz.css</code> and <code>all-xyz.js</code> files. Consequently, for Page X, instead of including the original source files from Bundle A, B and C, only these two combined files will be included; the same thing happens to Page Y.</p> <p>There is one final trick to make the above approach work more smoothly. Instead of directly modifying the application configuration file, you may put the bundle customization array in a separate file and conditionally include this file in the application configuration. For example,</p> <pre data-language="php">return [
    'components' =&gt; [
        'assetManager' =&gt; [
            'bundles' =&gt; require(__DIR__ . '/' . (YII_ENV_PROD ? 'assets-prod.php' : 'assets-dev.php')),  
        ],
    ],
];
</pre> <p>That is, the asset bundle configuration array is saved in <code>assets-prod.php</code> for production mode, and <code>assets-dev.php</code> for non-production mode.</p> <blockquote class="note">
<p><strong>Note: </strong>this asset combining mechanism is based on the ability of <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> to override the properties of the registered asset bundles. However, as it already has been said above, this ability does not cover asset bundle adjustments, which are performed at <a href="yii-web-assetbundle.html#init()-detail">yii\web\AssetBundle::init()</a> method or after bundle is registered. You should avoid usage of such dynamic bundles during the asset combining.</p> </blockquote> <h3>Using the <code>asset</code> Command 
</h3>
<p>Yii provides a console command named <code>asset</code> to automate the approach that we just described.</p> <p>To use this command, you should first create a configuration file to describe what asset bundles should be combined and how they should be grouped. You can use the <code>asset/template</code> sub-command to generate a template first and then modify it to fit for your needs.</p> <pre data-language="php">yii asset/template assets.php
</pre> <p>The command generates a file named <code>assets.php</code> in the current directory. The content of this file looks like the following:</p> <pre data-language="php">&lt;?php
/**
 * Configuration file for the "yii asset" console command.
 * Note that in the console environment, some path aliases like '@webroot' and '@web' may not exist.
 * Please define these missing path aliases.
 */
return [
    // Adjust command/callback for JavaScript files compressing:
    'jsCompressor' =&gt; 'java -jar compiler.jar --js {from} --js_output_file {to}',
    // Adjust command/callback for CSS files compressing:
    'cssCompressor' =&gt; 'java -jar yuicompressor.jar --type css {from} -o {to}',
    // Whether to delete asset source after compression:
    'deleteSource' =&gt; false,
    // The list of asset bundles to compress:
    'bundles' =&gt; [
        // 'yii\web\YiiAsset',
        // 'yii\web\JqueryAsset',
    ],
    // Asset bundle for compression output:
    'targets' =&gt; [
        'all' =&gt; [
            'class' =&gt; 'yii\web\AssetBundle',
            'basePath' =&gt; '@webroot/assets',
            'baseUrl' =&gt; '@web/assets',
            'js' =&gt; 'js/all-{hash}.js',
            'css' =&gt; 'css/all-{hash}.css',
        ],
    ],
    // Asset manager configuration:
    'assetManager' =&gt; [
    ],
];
</pre> <p>You should modify this file and specify which bundles you plan to combine in the <code>bundles</code> option. In the <code>targets</code> option you should specify how the bundles should be divided into groups. You can specify one or multiple groups, as aforementioned.</p> <blockquote class="note">
<p><strong>Note: </strong>Because the alias <code>@webroot</code> and <code>@web</code> are not available in the console application, you should explicitly define them in the configuration.</p> </blockquote> <p>JavaScript files are combined, compressed and written to <code>js/all-{hash}.js</code> where {hash} is replaced with the hash of the resulting file.</p> <p>The <code>jsCompressor</code> and <code>cssCompressor</code> options specify the console commands or PHP callbacks for performing JavaScript and CSS combining/compressing. By default, Yii uses <a href="https://developers.google.com/closure/compiler/">Closure Compiler</a> for combining JavaScript files and <a href="https://github.com/yui/yuicompressor/">YUI Compressor</a> for combining CSS files. You should install those tools manually or adjust these options to use your favorite tools.</p> <p>With the configuration file, you can run the <code>asset</code> command to combine and compress the asset files and then generate a new asset bundle configuration file <code>assets-prod.php</code>:</p> <pre data-language="php">yii asset assets.php config/assets-prod.php
</pre> <p>The generated configuration file can be included in the application configuration, like described in the last subsection.</p> <blockquote class="note">
<p><strong>Note: </strong>in case you customize asset bundles for your application via <a href="yii-web-assetmanager.html#%24bundles-detail">yii\web\AssetManager::$bundles</a> or <a href="yii-web-assetmanager.html#%24assetMap-detail">yii\web\AssetManager::$assetMap</a> and want this customization to be applied for the compression source files, you should include these options to the <code>assetManager</code> section inside asset command configuration file.</p> </blockquote> <blockquote class="note">
<p><strong>Note: </strong>while specifying the compression source, you should avoid the use of asset bundles whose parameters may be adjusted dynamically (e.g. at <code>init()</code> method or after registration), since they may work incorrectly after compression.</p> </blockquote> <blockquote class="info">
<p><strong>Info: </strong>Using the <code>asset</code> command is not the only option to automate the asset combining and compressing process. You can use the excellent task runner tool <a href="http://gruntjs.com/">grunt</a> to achieve the same goal.</p> </blockquote> <h3>Grouping Asset Bundles 
</h3>
<p>In the last subsection, we have explained how to combine all asset bundles into a single one in order to minimize the HTTP requests for asset files referenced in an application. This is not always desirable in practice. For example, imagine your application has a "front end" as well as a "back end", each of which uses a different set of JavaScript and CSS files. In this case, combining all asset bundles from both ends into a single one does not make sense, because the asset bundles for the "front end" are not used by the "back end" and it would be a waste of network bandwidth to send the "back end" assets when a "front end" page is requested.</p> <p>To solve the above problem, you can divide asset bundles into groups and combine asset bundles for each group. The following configuration shows how you can group asset bundles: </p> <pre data-language="php">return [
    ...
    // Specify output bundles with groups:
    'targets' =&gt; [
        'allShared' =&gt; [
            'js' =&gt; 'js/all-shared-{hash}.js',
            'css' =&gt; 'css/all-shared-{hash}.css',
            'depends' =&gt; [
                // Include all assets shared between 'backend' and 'frontend'
                'yii\web\YiiAsset',
                'app\assets\SharedAsset',
            ],
        ],
        'allBackEnd' =&gt; [
            'js' =&gt; 'js/all-{hash}.js',
            'css' =&gt; 'css/all-{hash}.css',
            'depends' =&gt; [
                // Include only 'backend' assets:
                'app\assets\AdminAsset'
            ],
        ],
        'allFrontEnd' =&gt; [
            'js' =&gt; 'js/all-{hash}.js',
            'css' =&gt; 'css/all-{hash}.css',
            'depends' =&gt; [], // Include all remaining assets
        ],
    ],
    ...
];
</pre> <p>As you can see, the asset bundles are divided into three groups: <code>allShared</code>, <code>allBackEnd</code> and <code>allFrontEnd</code>. They each depends on an appropriate set of asset bundles. For example, <code>allBackEnd</code> depends on <code>app\assets\AdminAsset</code>. When running <code>asset</code> command with this configuration, it will combine asset bundles according to the above specification.</p> <blockquote class="info">
<p><strong>Info: </strong>You may leave the <code>depends</code> configuration empty for one of the target bundle. By doing so, that particular asset bundle will depend on all of the remaining asset bundles that other target bundles do not depend on.</p> </blockquote> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2008&ndash;2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc-2.0/guide-structure-assets.html" class="_attribution-link">http://www.yiiframework.com/doc-2.0/guide-structure-assets.html</a>
  </p>
</div>
