<h1 class="title">std/asyncfile</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L1" target="_blank">Edit</a>  
<p>This module implements asynchronous file reading and writing.</p> 
<pre class="listing" data-language="nim">import std/[asyncfile, asyncdispatch, os]

proc main() {.async.} =
  var file = openAsync(getTempDir() / "foobar.txt", fmReadWrite)
  await file.write("test")
  file.setFilePos(0)
  let data = await file.readAll()
  doAssert data == "test"
  file.close()

waitFor main()</pre>  <h2 id="6">Imports</h2> <dl> <a href="asyncdispatch.html">asyncdispatch</a>, <a href="os.html">os</a>, <a href="winlean.html">winlean</a> </dl>   <h2 id="7">Types</h2> <dl> <div id="AsyncFile"> <dt><pre>AsyncFile = ref object</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L41" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L41" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="12">Procs</h2> <dl> <div id="close-procs-all"> <div id="close,AsyncFile"> <dt><pre data-language="nim">proc close(f: AsyncFile) {....raises: [OSError], tags: [], forbids: [].}</pre></dt> <dd> Closes the file specified. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L505" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L505" target="_blank">Edit</a> </dd> </div> </div> <div id="getFilePos-procs-all"> <div id="getFilePos,AsyncFile"> <dt><pre data-language="nim">proc getFilePos(f: AsyncFile): int64 {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Retrieves the current position of the file pointer that is used to read from the specified file. The file's first byte has the index zero. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L314" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L314" target="_blank">Edit</a> </dd> </div> </div> <div id="getFileSize-procs-all"> <div id="getFileSize,AsyncFile"> <dt><pre data-language="nim">proc getFileSize(f: AsyncFile): int64 {....raises: [OSError], tags: [], forbids: [].}</pre></dt> <dd> Retrieves the specified file's size. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L78" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L78" target="_blank">Edit</a> </dd> </div> </div> <div id="newAsyncFile-procs-all"> <div id="newAsyncFile,AsyncFD"> <dt><pre data-language="nim">proc newAsyncFile(fd: AsyncFD): AsyncFile {....raises: [OSError], tags: [],
    forbids: [].}</pre></dt> <dd> Creates <code><span class="Identifier">AsyncFile</span></code> with a previously opened file descriptor <code><span class="Identifier">fd</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L92" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L92" target="_blank">Edit</a> </dd> </div> </div> <div id="openAsync-procs-all"> <div id="openAsync,string"> <dt><pre data-language="nim">proc openAsync(filename: string; mode = fmRead): AsyncFile {....raises: [OSError],
    tags: [], forbids: [].}</pre></dt> <dd> Opens a file specified by the path in <code><span class="Identifier">filename</span></code> using the specified FileMode <code><span class="Identifier">mode</span></code> asynchronously. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L98" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L98" target="_blank">Edit</a> </dd> </div> </div> <div id="read-procs-all"> <div id="read,AsyncFile,int"> <dt><pre data-language="nim">proc read(f: AsyncFile; size: int): Future[string] {.
    ...raises: [ValueError, Exception], tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Read <code><span class="Identifier">size</span></code> bytes from the specified file asynchronously starting at the current position of the file pointer. <code><span class="Identifier">size</span></code> should be greater than zero.</p> <p>If the file pointer is past the end of the file then an empty string is returned.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L204" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L204" target="_blank">Edit</a> </dd> </div> </div> <div id="readAll-procs-all"> <div id="readAll,AsyncFile"> <dt><pre data-language="nim">proc readAll(f: AsyncFile): Future[string] {....stackTrace: false,
    raises: [Exception, ValueError], tags: [RootEffect], forbids: [].}</pre></dt> <dd> Reads all data from the specified file. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L329" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L329" target="_blank">Edit</a> </dd> </div> </div> <div id="readBuffer-procs-all"> <div id="readBuffer,AsyncFile,pointer,int"> <dt><pre data-language="nim">proc readBuffer(f: AsyncFile; buf: pointer; size: int): Future[int] {.
    ...raises: [ValueError, Exception], tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Read <code><span class="Identifier">size</span></code> bytes from the specified file asynchronously starting at the current position of the file pointer.</p> <p>If the file pointer is past the end of the file then zero is returned and no bytes are read into <code><span class="Identifier">buf</span></code></p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L127" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L127" target="_blank">Edit</a> </dd> </div> </div> <div id="readLine-procs-all"> <div id="readLine,AsyncFile"> <dt><pre data-language="nim">proc readLine(f: AsyncFile): Future[string] {....stackTrace: false,
    raises: [Exception, ValueError], tags: [RootEffect], forbids: [].}</pre></dt> <dd> Reads a single line from the specified file asynchronously. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L299" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L299" target="_blank">Edit</a> </dd> </div> </div> <div id="readToStream-procs-all"> <div id="readToStream,AsyncFile,FutureStream[string]"> <dt><pre data-language="nim">proc readToStream(f: AsyncFile; fs: FutureStream[string]): owned(
    Future[void]) {....stackTrace: false, raises: [Exception], tags: [RootEffect],
                    forbids: [].}</pre></dt> <dd> Writes data to the specified future stream as the file is read. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L529" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L529" target="_blank">Edit</a> </dd> </div> </div> <div id="setFilePos-procs-all"> <div id="setFilePos,AsyncFile,int64"> <dt><pre data-language="nim">proc setFilePos(f: AsyncFile; pos: int64) {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Sets the position of the file pointer that is used for read/write operations. The file's first byte has the index zero. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L320" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L320" target="_blank">Edit</a> </dd> </div> </div> <div id="setFileSize-procs-all"> <div id="setFileSize,AsyncFile,int64"> <dt><pre data-language="nim">proc setFileSize(f: AsyncFile; length: int64) {....raises: [OSError], tags: [],
    forbids: [].}</pre></dt> <dd> Set a file length. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L488" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L488" target="_blank">Edit</a> </dd> </div> </div> <div id="write-procs-all"> <div id="write,AsyncFile,string"> <dt><pre data-language="nim">proc write(f: AsyncFile; data: string): Future[void] {....raises: [Exception],
    tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Writes <code><span class="Identifier">data</span></code> to the file specified asynchronously.</p> <p>The returned Future will complete once all data has been written to the specified file.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L407" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L407" target="_blank">Edit</a> </dd> </div> </div> <div id="writeBuffer-procs-all"> <div id="writeBuffer,AsyncFile,pointer,int"> <dt><pre data-language="nim">proc writeBuffer(f: AsyncFile; buf: pointer; size: int): Future[void] {.
    ...raises: [Exception], tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Writes <code><span class="Identifier">size</span></code> bytes from <code><span class="Identifier">buf</span></code> to the file specified asynchronously.</p> <p>The returned Future will complete once all data has been written to the specified file.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L338" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L338" target="_blank">Edit</a> </dd> </div> </div> <div id="writeFromStream-procs-all"> <div id="writeFromStream,AsyncFile,FutureStream[string]"> <dt><pre data-language="nim">proc writeFromStream(f: AsyncFile; fs: FutureStream[string]): owned(
    Future[void]) {....stackTrace: false, raises: [Exception], tags: [RootEffect],
                    forbids: [].}</pre></dt> <dd> <p>Reads data from the specified future stream until it is completed. The data which is read is written to the file immediately and freed from memory.</p> <p>This procedure is perfect for saving streamed data to a file without wasting memory.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfile.nim#L515" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L515" target="_blank">Edit</a> </dd> </div> </div> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/asyncfile.html" class="_attribution-link">https://nim-lang.org/docs/asyncfile.html</a>
  </p>
</div>
