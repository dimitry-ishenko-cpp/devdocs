<h1 class="title">asyncfile</h1>  <p class="module-desc">This module implements asynchronous file reading and writing.</p>
<pre class="listing" data-language="nim">import asyncfile, asyncdispatch, os

proc main() {.async.} =
  var file = openAsync(getTempDir() / "foobar.txt", fmReadWrite)
  await file.write("test")
  file.setFilePos(0)
  let data = await file.readAll()
  doAssert data == "test"
  file.close()

waitFor main()</pre>  <h2 id="6">Imports</h2> <dl> <a href="asyncdispatch.html">asyncdispatch</a>, <a href="os.html">os</a>, <a href="winlean.html">winlean</a> </dl>  <h2 id="7">Types</h2> <dl>  <dt><pre id="AsyncFile" data-language="nim">AsyncFile = ref object
  fd: AsyncFD
  offset: int64</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L35" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L35" target="_blank">Edit</a> </dd> </dl>  <h2 id="12">Procs</h2> <dl>  <dt><pre id="getFileSize%2CAsyncFile" data-language="nim">proc getFileSize(f: AsyncFile): int64 {...}{.raises: [OSError], tags: [].}</pre></dt> <dd> Retrieves the specified file's size. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L72" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L72" target="_blank">Edit</a> </dd>  <dt><pre id="newAsyncFile%2CAsyncFD" data-language="nim">proc newAsyncFile(fd: AsyncFD): AsyncFile {...}{.raises: [Exception, OSError],
    tags: [RootEffect].}</pre></dt> <dd> Creates <code>AsyncFile</code> with a previously opened file descriptor <code>fd</code>. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L86" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L86" target="_blank">Edit</a> </dd>  <dt><pre id="openAsync%2Cstring" data-language="nim">proc openAsync(filename: string; mode = fmRead): AsyncFile {...}{.
    raises: [OSError, Exception], tags: [RootEffect].}</pre></dt> <dd> Opens a file specified by the path in <code>filename</code> using the specified FileMode <code>mode</code> asynchronously. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L92" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L92" target="_blank">Edit</a> </dd>  <dt><pre id="readBuffer%2CAsyncFile%2Cpointer%2Cint" data-language="nim">proc readBuffer(f: AsyncFile; buf: pointer; size: int): Future[int] {...}{.
    raises: [ValueError, Exception], tags: [RootEffect].}</pre></dt> <dd> <p>Read <code>size</code> bytes from the specified file asynchronously starting at the current position of the file pointer.</p> <p>If the file pointer is past the end of the file then zero is returned and no bytes are read into <code>buf</code></p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L126" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L126" target="_blank">Edit</a> </dd>  <dt><pre id="read%2CAsyncFile%2Cint" data-language="nim">proc read(f: AsyncFile; size: int): Future[string] {...}{.
    raises: [ValueError, Exception], tags: [RootEffect].}</pre></dt> <dd> <p>Read <code>size</code> bytes from the specified file asynchronously starting at the current position of the file pointer.</p> <p>If the file pointer is past the end of the file then an empty string is returned.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L203" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L203" target="_blank">Edit</a> </dd>  <dt><pre id="readLine%2CAsyncFile" data-language="nim">proc readLine(f: AsyncFile): Future[string] {...}{.raises: [Exception, ValueError],
    tags: [RootEffect].}</pre></dt> <dd> Reads a single line from the specified file asynchronously. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L297" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L297" target="_blank">Edit</a> </dd>  <dt><pre id="getFilePos%2CAsyncFile" data-language="nim">proc getFilePos(f: AsyncFile): int64 {...}{.raises: [], tags: [].}</pre></dt> <dd> Retrieves the current position of the file pointer that is used to read from the specified file. The file's first byte has the index zero. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L310" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L310" target="_blank">Edit</a> </dd>  <dt><pre id="setFilePos%2CAsyncFile%2Cint64" data-language="nim">proc setFilePos(f: AsyncFile; pos: int64) {...}{.raises: [], tags: [].}</pre></dt> <dd> Sets the position of the file pointer that is used for read/write operations. The file's first byte has the index zero. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L316" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L316" target="_blank">Edit</a> </dd>  <dt><pre id="readAll%2CAsyncFile" data-language="nim">proc readAll(f: AsyncFile): Future[string] {...}{.raises: [Exception, ValueError],
    tags: [RootEffect].}</pre></dt> <dd> Reads all data from the specified file. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L325" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L325" target="_blank">Edit</a> </dd>  <dt><pre id="writeBuffer%2CAsyncFile%2Cpointer%2Cint" data-language="nim">proc writeBuffer(f: AsyncFile; buf: pointer; size: int): Future[void] {...}{.
    raises: [Exception], tags: [RootEffect].}</pre></dt> <dd> <p>Writes <code>size</code> bytes from <code>buf</code> to the file specified asynchronously.</p> <p>The returned Future will complete once all data has been written to the specified file.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L334" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L334" target="_blank">Edit</a> </dd>  <dt><pre id="write%2CAsyncFile%2Cstring" data-language="nim">proc write(f: AsyncFile; data: string): Future[void] {...}{.raises: [Exception],
    tags: [RootEffect].}</pre></dt> <dd> <p>Writes <code>data</code> to the file specified asynchronously.</p> <p>The returned Future will complete once all data has been written to the specified file.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L403" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L403" target="_blank">Edit</a> </dd>  <dt><pre id="setFileSize%2CAsyncFile%2Cint64" data-language="nim">proc setFileSize(f: AsyncFile; length: int64) {...}{.raises: [OSError], tags: [].}</pre></dt> <dd> Set a file length. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L484" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L484" target="_blank">Edit</a> </dd>  <dt><pre id="close%2CAsyncFile" data-language="nim">proc close(f: AsyncFile) {...}{.raises: [Exception, OSError], tags: [RootEffect].}</pre></dt> <dd> Closes the file specified. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L501" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L501" target="_blank">Edit</a> </dd>  <dt><pre id="writeFromStream%2CAsyncFile%2CFutureStream%5Bstring%5D" data-language="nim">proc writeFromStream(f: AsyncFile; fs: FutureStream[string]): owned(Future[void]) {...}{.
    raises: [Exception], tags: [RootEffect].}</pre></dt> <dd> <p>Reads data from the specified future stream until it is completed. The data which is read is written to the file immediately and freed from memory.</p> <p>This procedure is perfect for saving streamed data to a file without wasting memory.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L511" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L511" target="_blank">Edit</a> </dd>  <dt><pre id="readToStream%2CAsyncFile%2CFutureStream%5Bstring%5D" data-language="nim">proc readToStream(f: AsyncFile; fs: FutureStream[string]): owned(Future[void]) {...}{.
    raises: [Exception], tags: [RootEffect].}</pre></dt> <dd> Writes data to the specified future stream as the file is read. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/asyncfile.nim#L525" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfile.nim#L525" target="_blank">Edit</a> </dd> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2021 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/asyncfile.html" class="_attribution-link">https://nim-lang.org/docs/asyncfile.html</a>
  </p>
</div>
