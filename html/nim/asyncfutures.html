<h1 class="title">std/asyncfutures</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L1" target="_blank">Edit</a>    <h2 id="6">Imports</h2> <dl> <a href="os.html">os</a>, <a href="tables.html">tables</a>, <a href="strutils.html">strutils</a>, <a href="times.html">times</a>, <a href="heapqueue.html">heapqueue</a>, <a href="options.html">options</a>, <a href="deques.html">deques</a>, <a href="cstrutils.html">cstrutils</a>, <a href="typetraits.html">typetraits</a>, <a href="stacktraces.html">stacktraces</a> </dl>   <h2 id="7">Types</h2> <dl> <div id="Future"> <dt><pre data-language="nim">Future[T] = ref object of FutureBase
  ## Stored value</pre></dt> <dd> Typed future. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L37" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L37" target="_blank">Edit</a> </dd> </div> <div id="FutureBase"> <dt><pre data-language="nim">FutureBase = ref object of RootObj
  error*: ref Exception      ## Stored exception
  errorStackTrace*: string
  when not defined(release) or defined(futureLogging):
    ## For debugging purposes only.</pre></dt> <dd> Untyped future. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L26" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L26" target="_blank">Edit</a> </dd> </div> <div id="FutureError"> <dt><pre data-language="nim">FutureError = object of Defect
  cause*: FutureBase</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L42" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L42" target="_blank">Edit</a> </dd> </div> <div id="FutureVar"> <dt><pre data-language="nim">FutureVar[T] = distinct Future[T]</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L40" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L40" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="10">Consts</h2> <dl> <div id="isFutureLoggingEnabled"> <dt><pre>isFutureLoggingEnabled = false</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L48" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L48" target="_blank">Edit</a> </dd> </div> <div id="NimAsyncContinueSuffix"> <dt><pre data-language="nim">NimAsyncContinueSuffix = "NimAsyncContinue"</pre></dt> <dd> For internal usage. Do not use. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L51" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L51" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="12">Procs</h2> <dl> <div id="$-procs-all"> <div id="$,seq[StackTraceEntry]"> <dt><pre data-language="nim">proc `$`(stackTraceEntries: seq[StackTraceEntry]): string {.
    ...raises: [ValueError], tags: [], forbids: [].}</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L314" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L314" target="_blank">Edit</a> </dd> </div> </div> <div id="addCallback-procs-all"> <div id="addCallback,FutureBase,proc)"> <dt><pre data-language="nim">proc addCallback(future: FutureBase; cb: proc () {.closure, ...gcsafe.}) {.
    ...raises: [Exception], tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Adds the callbacks proc to be called when the future completes.</p> <p>If future has already completed then <code><span class="Identifier">cb</span></code> will be called immediately.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L249" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L249" target="_blank">Edit</a> </dd> </div> <div id="addCallback,Future[T],proc(Future[T])"> <dt><pre data-language="nim">proc addCallback[T](future: Future[T];
                    cb: proc (future: Future[T]) {.closure, ...gcsafe.})</pre></dt> <dd> <p>Adds the callbacks proc to be called when the future completes.</p> <p>If future has already completed then <code><span class="Identifier">cb</span></code> will be called immediately.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L259" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L259" target="_blank">Edit</a> </dd> </div> </div> <div id="all-procs-all"> <div id="all,varargs[Future[T]]"> <dt><pre data-language="nim">proc all[T](futs: varargs[Future[T]]): auto</pre></dt> <dd> <p>Returns a future which will complete once all futures in <code><span class="Identifier">futs</span></code> complete. If the argument is empty, the returned future completes immediately.</p> <p>If the awaited futures are not <code><span class="Identifier">Future</span><span class="Punctuation">[</span><span class="Identifier">void</span><span class="Punctuation">]</span></code>, the returned future will hold the values of all awaited futures in a sequence.</p> <p>If the awaited futures <em>are</em> <code><span class="Identifier">Future</span><span class="Punctuation">[</span><span class="Identifier">void</span><span class="Punctuation">]</span></code>, this proc returns <code><span class="Identifier">Future</span><span class="Punctuation">[</span><span class="Identifier">void</span><span class="Punctuation">]</span></code>.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L470" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L470" target="_blank">Edit</a> </dd> </div> </div> <div id="and-procs-all"> <div id="and,Future[T],Future[Y]"> <dt><pre data-language="nim">proc `and`[T, Y](fut1: Future[T]; fut2: Future[Y]): Future[void]</pre></dt> <dd> Returns a future which will complete once both <code><span class="Identifier">fut1</span></code> and <code><span class="Identifier">fut2</span></code> complete. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L442" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L442" target="_blank">Edit</a> </dd> </div> </div> <div id="asyncCheck-procs-all"> <div id="asyncCheck,Future[T]"> <dt><pre data-language="nim">proc asyncCheck[T](future: Future[T])</pre></dt> <dd> <p>Sets a callback on <code><span class="Identifier">future</span></code> which raises an exception if the future finished with an error.</p> <p>This should be used instead of <code><span class="Keyword">discard</span></code> to discard void futures, or use <code><span class="Identifier">waitFor</span></code> if you need to wait for the future's completion.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L427" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L427" target="_blank">Edit</a> </dd> </div> </div> <div id="callback=-procs-all"> <div id="callback=,FutureBase,proc)"> <dt><pre data-language="nim">proc callback=(future: FutureBase; cb: proc () {.closure, ...gcsafe.}) {.
    ...raises: [Exception], tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Clears the list of callbacks and sets the callback proc to be called when the future completes.</p> <p>If future has already completed then <code><span class="Identifier">cb</span></code> will be called immediately.</p> <p>It's recommended to use <code><span class="Identifier">addCallback</span></code> or <code><span class="Identifier">then</span></code> instead.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L269" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L269" target="_blank">Edit</a> </dd> </div> <div id="callback=,Future[T],proc(Future[T])"> <dt><pre data-language="nim">proc callback=[T](future: Future[T];
                  cb: proc (future: Future[T]) {.closure, ...gcsafe.})</pre></dt> <dd> <p>Sets the callback proc to be called when the future completes.</p> <p>If future has already completed then <code><span class="Identifier">cb</span></code> will be called immediately.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L278" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L278" target="_blank">Edit</a> </dd> </div> </div> <div id="callSoon-procs-all"> <div id="callSoon,proc)"> <dt><pre data-language="nim">proc callSoon(cbproc: proc () {....gcsafe.}) {....raises: [Exception],
    tags: [RootEffect], forbids: [].}</pre></dt> <dd> <p>Call <code><span class="Identifier">cbproc</span></code> "soon".</p> <p>If async dispatcher is running, <code><span class="Identifier">cbproc</span></code> will be executed during next dispatcher tick.</p> <p>If async dispatcher is not running, <code><span class="Identifier">cbproc</span></code> will be executed immediately.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L100" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L100" target="_blank">Edit</a> </dd> </div> </div> <div id="clean-procs-all"> <div id="clean,FutureVar[T]"> <dt><pre data-language="nim">proc clean[T](future: FutureVar[T])</pre></dt> <dd> Resets the <code><span class="Identifier">finished</span></code> status of <code><span class="Identifier">future</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L139" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L139" target="_blank">Edit</a> </dd> </div> </div> <div id="clearCallbacks-procs-all"> <div id="clearCallbacks,FutureBase"> <dt><pre data-language="nim">proc clearCallbacks(future: FutureBase) {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L245" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L245" target="_blank">Edit</a> </dd> </div> </div> <div id="complete-procs-all"> <div id="complete,Future[void]"> <dt><pre data-language="nim">proc complete(future: Future[void]; val = Future[void].default) {.
    ...raises: [Exception], tags: [RootEffect], forbids: [].}</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L210" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L210" target="_blank">Edit</a> </dd> </div> <div id="complete,Future[T],sinkT"> <dt><pre data-language="nim">proc complete[T](future: Future[T]; val: sink T)</pre></dt> <dd> Completes <code><span class="Identifier">future</span></code> with value <code><span class="Identifier">val</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L206" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L206" target="_blank">Edit</a> </dd> </div> <div id="complete,FutureVar[T]"> <dt><pre data-language="nim">proc complete[T](future: FutureVar[T])</pre></dt> <dd> Completes a <code><span class="Identifier">FutureVar</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L213" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L213" target="_blank">Edit</a> </dd> </div> <div id="complete,FutureVar[T],sinkT"> <dt><pre data-language="nim">proc complete[T](future: FutureVar[T]; val: sink T)</pre></dt> <dd> <p>Completes a <code><span class="Identifier">FutureVar</span></code> with value <code><span class="Identifier">val</span></code>.</p> <p>Any previously stored value will be overwritten.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L222" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L222" target="_blank">Edit</a> </dd> </div> </div> <div id="fail-procs-all"> <div id="fail,Future[T],ref.Exception"> <dt><pre data-language="nim">proc fail[T](future: Future[T]; error: ref Exception)</pre></dt> <dd> Completes <code><span class="Identifier">future</span></code> with <code><span class="Identifier">error</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L234" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L234" target="_blank">Edit</a> </dd> </div> </div> <div id="failed-procs-all"> <div id="failed,FutureBase"> <dt><pre data-language="nim">proc failed(future: FutureBase): bool {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Determines whether <code><span class="Identifier">future</span></code> completed with an error. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L423" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L423" target="_blank">Edit</a> </dd> </div> </div> <div id="finished-procs-all"> <div id="finished"> <dt><pre data-language="nim">proc finished(future: FutureBase | FutureVar): bool</pre></dt> <dd> <p>Determines whether <code><span class="Identifier">future</span></code> has completed.</p> <p><code><span class="Identifier">True</span></code> may indicate an error or a value. Use <code><span class="Identifier">failed</span></code> to distinguish.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L414" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L414" target="_blank">Edit</a> </dd> </div> </div> <div id="getCallSoonProc-procs-all"> <div id="getCallSoonProc"> <dt><pre data-language="nim">proc getCallSoonProc(): (proc (cbproc: proc ()) {....gcsafe.}) {....raises: [],
    tags: [], forbids: [].}</pre></dt> <dd> Get current implementation of <code><span class="Identifier">callSoon</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L92" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L92" target="_blank">Edit</a> </dd> </div> </div> <div id="mget-procs-all"> <div id="mget,FutureVar[T]"> <dt><pre data-language="nim">proc mget[T](future: FutureVar[T]): var T</pre></dt> <dd> <p>Returns a mutable value stored in <code><span class="Identifier">future</span></code>.</p> <p>Unlike <code><span class="Identifier">read</span></code>, this function will not raise an exception if the Future has not been finished.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L407" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L407" target="_blank">Edit</a> </dd> </div> </div> <div id="newFuture-procs-all"> <div id="newFuture,string"> <dt><pre data-language="nim">proc newFuture[T](fromProc: string = "unspecified"): owned(Future[T])</pre></dt> <dd> <p>Creates a new future.</p> <p>Specifying <code><span class="Identifier">fromProc</span></code>, which is a string specifying the name of the proc that this future belongs to, is a good habit as it helps with debugging.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L121" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L121" target="_blank">Edit</a> </dd> </div> </div> <div id="newFutureVar-procs-all"> <div id="newFutureVar,string"> <dt><pre data-language="nim">proc newFutureVar[T](fromProc = "unspecified"): owned(FutureVar[T])</pre></dt> <dd> <p>Create a new <code><span class="Identifier">FutureVar</span></code>. This Future type is ideally suited for situations where you want to avoid unnecessary allocations of Futures.</p> <p>Specifying <code><span class="Identifier">fromProc</span></code>, which is a string specifying the name of the proc that this future belongs to, is a good habit as it helps with debugging.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L129" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L129" target="_blank">Edit</a> </dd> </div> </div> <div id="or-procs-all"> <div id="or,Future[T],Future[Y]"> <dt><pre data-language="nim">proc `or`[T, Y](fut1: Future[T]; fut2: Future[Y]): Future[void]</pre></dt> <dd> Returns a future which will complete once either <code><span class="Identifier">fut1</span></code> or <code><span class="Identifier">fut2</span></code> complete. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L458" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L458" target="_blank">Edit</a> </dd> </div> </div> <div id="read-procs-all"> <div id="read_2"> <dt><pre data-language="nim">proc read(future: Future[void] | FutureVar[void])</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L395" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L395" target="_blank">Edit</a> </dd> </div> <div id="read"> <dt><pre data-language="nim">proc read[T](future: Future[T] | FutureVar[T]): lent T</pre></dt> <dd> <p>Retrieves the value of <code><span class="Identifier">future</span></code>. Future must be finished otherwise this function will fail with a <code><span class="Identifier">ValueError</span></code> exception.</p> <p>If the result of the future is an error then that error will be raised.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L388" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L388" target="_blank">Edit</a> </dd> </div> </div> <div id="readError-procs-all"> <div id="readError,Future[T]"> <dt><pre data-language="nim">proc readError[T](future: Future[T]): ref Exception</pre></dt> <dd> <p>Retrieves the exception stored in <code><span class="Identifier">future</span></code>.</p> <p>An <code><span class="Identifier">ValueError</span></code> exception will be thrown if no exception exists in the specified Future.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L398" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L398" target="_blank">Edit</a> </dd> </div> </div> <div id="setCallSoonProc-procs-all"> <div id="setCallSoonProc"> <dt><pre data-language="nim">proc setCallSoonProc(p: (proc (cbproc: proc ()) {....gcsafe.})) {....raises: [],
    tags: [], forbids: [].}</pre></dt> <dd> Change current implementation of <code><span class="Identifier">callSoon</span></code>. This is normally called when dispatcher from <code><span class="Identifier">asyncdispatcher</span></code> is initialized. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/asyncfutures.nim#L96" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/asyncfutures.nim#L96" target="_blank">Edit</a> </dd> </div> </div> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/asyncfutures.html" class="_attribution-link">https://nim-lang.org/docs/asyncfutures.html</a>
  </p>
</div>
