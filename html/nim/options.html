<h1 class="title">std/options</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L1" target="_blank">Edit</a>  
<p>This module implements types which encapsulate an optional value.</p> <p>A value of type <code><span class="Identifier">Option</span><span class="Punctuation">[</span><span class="Identifier">T</span><span class="Punctuation">]</span></code> either contains a value <code><span class="Identifier">x</span></code> (represented as <code><span class="Identifier">some</span><span class="Punctuation">(</span><span class="Identifier">x</span><span class="Punctuation">)</span></code>) or is empty (<code><span class="Identifier">none</span><span class="Punctuation">(</span><span class="Identifier">T</span><span class="Punctuation">)</span></code>).</p> <p>This can be useful when you have a value that can be present or not. The absence of a value is often represented by <code><span class="Keyword">nil</span></code>, but that is not always available, nor is it always a good solution.</p> <h2 id="basic-usage">Basic usage</h2>
<p>Let's start with an example: a procedure that finds the index of a character in a string. </p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">import std/options
proc find(haystack: string, needle: char): Option[int] =
  for i, c in haystack:
    if c == needle:
      return some(i)
  return none(int)  # This line is actually optional,
                    # because the default is empty

let found = "abc".find('c')
assert found.isSome and found.get() == 2</pre>The <code><span class="Identifier">get</span></code> operation demonstrated above returns the underlying value, or raises <code><span class="Identifier">UnpackDefect</span></code> if there is no value. Note that <code><span class="Identifier">UnpackDefect</span></code> inherits from <code><span class="Identifier">system</span><span class="Operator">.</span><span class="Identifier">Defect</span></code> and should therefore never be caught. Instead, rely on checking if the option contains a value with the <a href="#isSome,Option[T]">isSome</a> and <a href="#isNone,Option[T]">isNone</a> procs. <h2 id="pattern-matching">Pattern matching</h2>
<div class="admonition admonition-info">
<span class="admonition-info-text"><b>Note:</b></span> This requires the <a href="https://github.com/nim-lang/fusion">fusion</a> package.</div> <p><a href="https://nim-lang.github.io/fusion/src/fusion/matching.html">fusion/matching</a> supports pattern matching on <code><span class="Identifier">Option</span></code>s, with the <code><span class="Identifier">Some</span><span class="Punctuation">(</span><span class="Operator">&lt;</span><span class="Identifier">pattern</span><span class="Operator">&gt;</span><span class="Punctuation">)</span></code> and <code><span class="Identifier">None</span><span class="Punctuation">(</span><span class="Punctuation">)</span></code> patterns.</p> <pre class="listing" data-language="nim">{.experimental: "caseStmtMacros".}

import fusion/matching

case some(42)
of Some(@a):
  assert a == 42
of None():
  assert false

assertMatch(some(some(none(int))), Some(Some(None())))</pre>  <h2 id="6">Imports</h2> <dl> <a href="typetraits.html">typetraits</a> </dl>   <h2 id="7">Types</h2> <dl> <div id="Option"> <dt><pre data-language="nim">Option[T] = object
  when T is SomePointer:
    
  else:</pre></dt> <dd> An optional type that may or may not contain a value of type <code><span class="Identifier">T</span></code>. When <code><span class="Identifier">T</span></code> is a a pointer type (<code><span class="Keyword">ptr</span></code>, <code><span class="Identifier">pointer</span></code>, <code><span class="Keyword">ref</span></code> or <code><span class="Keyword">proc</span></code>), <code><span class="Identifier">none</span><span class="Punctuation">(</span><span class="Identifier">T</span><span class="Punctuation">)</span></code> is represented as <code><span class="Keyword">nil</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L90" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L90" target="_blank">Edit</a> </dd> </div> <div id="UnpackDefect"> <dt><pre>UnpackDefect = object of Defect</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L100" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L100" target="_blank">Edit</a> </dd> </div> <div id="UnpackError"> <dt><pre data-language="nim">UnpackError {....deprecated: "See corresponding Defect".} = UnpackDefect</pre></dt> <dd> <div class="deprecation-message"> <b>Deprecated:</b> See corresponding Defect </div> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L101" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L101" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="12">Procs</h2> <dl> <div id="$-procs-all"> <div id="$,Option[T]"> <dt><pre data-language="nim">proc `$`[T](self: Option[T]): string</pre></dt> <dd> Get the string representation of the <code><span class="Identifier">Option</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert $some(42) == "some(42)"
assert $none(int) == "none(int)"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L354" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L354" target="_blank">Edit</a> </dd> </div> </div> <div id="==-procs-all"> <div id="==,Option[T],Option[T]"> <dt><pre data-language="nim">proc `==`[T](a, b: Option[T]): bool {.inline.}</pre></dt> <dd> Returns <code><span class="Identifier">true</span></code> if both <code><span class="Identifier">Option</span></code>s are <code><span class="Identifier">none</span></code>, or if they are both <code><span class="Identifier">some</span></code> and have equal values. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let
  a = some(42)
  b = none(int)
  c = some(42)
  d = none(int)

assert a == c
assert b == d
assert not (a == b)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L335" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L335" target="_blank">Edit</a> </dd> </div> </div> <div id="filter-procs-all"> <div id="filter,Option[T],proc(T)"> <dt><pre data-language="nim">proc filter[T](self: Option[T]; callback: proc (input: T): bool): Option[T] {.
    inline, effectsOf: callback.}</pre></dt> <dd> <p>Applies a <code><span class="Identifier">callback</span></code> to the value of the <code><span class="Identifier">Option</span></code>.</p> <p>If the <code><span class="Identifier">callback</span></code> returns <code><span class="Identifier">true</span></code>, the option is returned as <code><span class="Identifier">some</span></code>. If it returns <code><span class="Identifier">false</span></code>, it is returned as <code><span class="Identifier">none</span></code>.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#flatMap,Option[A],proc(A)">flatMap proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">proc isEven(x: int): bool =
  x mod 2 == 0

assert some(42).filter(isEven) == some(42)
assert none(int).filter(isEven) == none(int)
assert some(-11).filter(isEven) == none(int)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L314" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L314" target="_blank">Edit</a> </dd> </div> </div> <div id="flatMap-procs-all"> <div id="flatMap,Option[T],proc(T)"> <dt><pre data-language="nim">proc flatMap[T, R](self: Option[T]; callback: proc (input: T): Option[R]): Option[
    R] {.inline, effectsOf: callback.}</pre></dt> <dd> <p>Applies a <code><span class="Identifier">callback</span></code> function to the value of the <code><span class="Identifier">Option</span></code> and returns the new value.</p> <p>If the <code><span class="Identifier">Option</span></code> has no value, <code><span class="Identifier">none</span><span class="Punctuation">(</span><span class="Identifier">R</span><span class="Punctuation">)</span></code> will be returned.</p> <p>This is similar to <code><span class="Identifier">map</span></code>, with the difference that the <code><span class="Identifier">callback</span></code> returns an <code><span class="Identifier">Option</span></code>, not a raw value. This allows multiple procs with a signature of <code><span class="Identifier">A</span> <span class="Operator">-&gt;</span> <span class="Identifier">Option</span><span class="Punctuation">[</span><span class="Identifier">B</span><span class="Punctuation">]</span></code> to be chained together.</p> <p>See also:</p> <ul class="simple">
<li><a href="#flatten,Option[Option[A]]">flatten proc</a></li> <li><a href="#filter,Option[T],proc(T)">filter proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">proc doublePositives(x: int): Option[int] =
  if x &gt; 0:
    some(2 * x)
  else:
    none(int)

assert some(42).flatMap(doublePositives) == some(84)
assert none(int).flatMap(doublePositives) == none(int)
assert some(-11).flatMap(doublePositives) == none(int)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L288" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L288" target="_blank">Edit</a> </dd> </div> </div> <div id="flatten-procs-all"> <div id="flatten,Option[Option[T]]"> <dt><pre data-language="nim">proc flatten[T](self: Option[Option[T]]): Option[T] {.inline.}</pre></dt> <dd> <p>Remove one level of structure in a nested <code><span class="Identifier">Option</span></code>.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#flatMap,Option[T],proc(T)">flatMap proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert flatten(some(some(42))) == some(42)
assert flatten(none(Option[int])) == none(int)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L274" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L274" target="_blank">Edit</a> </dd> </div> </div> <div id="get-procs-all"> <div id="get,Option[T]"> <dt><pre data-language="nim">proc get[T](self: Option[T]): lent T {.inline.}</pre></dt> <dd> <p>Returns the content of an <code><span class="Identifier">Option</span></code>. If it has no value, an <code><span class="Identifier">UnpackDefect</span></code> exception is raised.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#get,Option[T],T">get proc</a> with a default return value</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert some(42).get == 42
doAssertRaises(UnpackDefect):
  echo none(string).get</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L190" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L190" target="_blank">Edit</a> </dd> </div> <div id="get,Option[T],T"> <dt><pre data-language="nim">proc get[T](self: Option[T]; otherwise: T): T {.inline.}</pre></dt> <dd> Returns the content of the <code><span class="Identifier">Option</span></code> or <code><span class="Identifier">otherwise</span></code> if the <code><span class="Identifier">Option</span></code> has no value. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert some(42).get(9999) == 42
assert none(int).get(9999) == 9999</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L205" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L205" target="_blank">Edit</a> </dd> </div> <div id="get,Option[T]_2"> <dt><pre data-language="nim">proc get[T](self: var Option[T]): var T {.inline.}</pre></dt> <dd> Returns the content of the <code><span class="Keyword">var</span> <span class="Identifier">Option</span></code> mutably. If it has no value, an <code><span class="Identifier">UnpackDefect</span></code> exception is raised. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var
  a = some(42)
  b = none(string)
inc(a.get)
assert a.get == 43
doAssertRaises(UnpackDefect):
  echo b.get</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L217" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L217" target="_blank">Edit</a> </dd> </div> </div> <div id="isNone-procs-all"> <div id="isNone,Option[T]"> <dt><pre data-language="nim">proc isNone[T](self: Option[T]): bool {.inline.}</pre></dt> <dd> <p>Checks if an <code><span class="Identifier">Option</span></code> is empty.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#isSome,Option[T]">isSome proc</a></li> <li><a href="#none,typedesc">none proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert not some(42).isNone
assert none(string).isNone</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L175" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L175" target="_blank">Edit</a> </dd> </div> </div> <div id="isSome-procs-all"> <div id="isSome,Option[T]"> <dt><pre data-language="nim">proc isSome[T](self: Option[T]): bool {.inline.}</pre></dt> <dd> <p>Checks if an <code><span class="Identifier">Option</span></code> contains a value.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#isNone,Option[T]">isNone proc</a></li> <li><a href="#some,T">some proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert some(42).isSome
assert not none(string).isSome</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L160" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L160" target="_blank">Edit</a> </dd> </div> </div> <div id="map-procs-all"> <div id="map,Option[T],proc(T)_2"> <dt><pre data-language="nim">proc map[T, R](self: Option[T]; callback: proc (input: T): R): Option[R] {.
    inline, effectsOf: callback.}</pre></dt> <dd> <p>Applies a <code><span class="Identifier">callback</span></code> function to the value of the <code><span class="Identifier">Option</span></code> and returns an <code><span class="Identifier">Option</span></code> containing the new value.</p> <p>If the <code><span class="Identifier">Option</span></code> has no value, <code><span class="Identifier">none</span><span class="Punctuation">(</span><span class="Identifier">R</span><span class="Punctuation">)</span></code> will be returned.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#map,Option[T],proc(T)">map proc</a></li> <li>
<a href="#flatMap,Option[T],proc(T)">flatMap proc</a> for a version with a callback that returns an <code><span class="Identifier">Option</span></code>
</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">proc isEven(x: int): bool =
  x mod 2 == 0

assert some(42).map(isEven) == some(true)
assert none(int).map(isEven) == none(bool)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L252" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L252" target="_blank">Edit</a> </dd> </div> <div id="map,Option[T],proc(T)"> <dt><pre data-language="nim">proc map[T](self: Option[T]; callback: proc (input: T)) {.inline,
    effectsOf: callback.}</pre></dt> <dd> <p>Applies a <code><span class="Identifier">callback</span></code> function to the value of the <code><span class="Identifier">Option</span></code>, if it has one.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#map,Option[T],proc(T)_2">map proc</a> for a version with a callback which returns a value</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var d = 0
proc saveDouble(x: int) =
  d = 2 * x

none(int).map(saveDouble)
assert d == 0
some(42).map(saveDouble)
assert d == 84</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L233" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L233" target="_blank">Edit</a> </dd> </div> </div> <div id="none-procs-all"> <div id="none,typedesc"> <dt><pre data-language="nim">proc none(T: typedesc): Option[T] {.inline.}</pre></dt> <dd> <p>Returns an <code><span class="Identifier">Option</span></code> for this type that has no value.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#option,T">option proc</a></li> <li><a href="#some,T">some proc</a></li> <li><a href="#isNone,Option[T]">isNone proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert none(int).isNone</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L143" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L143" target="_blank">Edit</a> </dd> </div> <div id="none"> <dt><pre data-language="nim">proc none[T](): Option[T] {.inline.}</pre></dt> <dd> Alias for <a href="#none,typedesc">none(T)</a>. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L156" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L156" target="_blank">Edit</a> </dd> </div> </div> <div id="option-procs-all"> <div id="option,sinkT"> <dt><pre data-language="nim">proc option[T](val: sink T): Option[T] {.inline.}</pre></dt> <dd> <p>Can be used to convert a pointer type (<code><span class="Keyword">ptr</span></code>, <code><span class="Identifier">pointer</span></code>, <code><span class="Keyword">ref</span></code> or <code><span class="Keyword">proc</span></code>) to an option type. It converts <code><span class="Keyword">nil</span></code> to <code><span class="Identifier">none</span><span class="Punctuation">(</span><span class="Identifier">T</span><span class="Punctuation">)</span></code>. When <code><span class="Identifier">T</span></code> is no pointer type, this is equivalent to <code><span class="Identifier">some</span><span class="Punctuation">(</span><span class="Identifier">val</span><span class="Punctuation">)</span></code>.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#some,T">some proc</a></li> <li><a href="#none,typedesc">none proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">type
  Foo = ref object
    a: int
    b: string

assert option[Foo](nil).isNone
assert option(42).isSome</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L103" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L103" target="_blank">Edit</a> </dd> </div> </div> <div id="some-procs-all"> <div id="some,sinkT"> <dt><pre data-language="nim">proc some[T](val: sink T): Option[T] {.inline.}</pre></dt> <dd> <p>Returns an <code><span class="Identifier">Option</span></code> that has the value <code><span class="Identifier">val</span></code>.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#option,T">option proc</a></li> <li><a href="#none,typedesc">none proc</a></li> <li><a href="#isSome,Option[T]">isSome proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let a = some("abc")

assert a.isSome
assert a.get == "abc"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L123" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L123" target="_blank">Edit</a> </dd> </div> </div> <div id="unsafeGet-procs-all"> <div id="unsafeGet,Option[T]"> <dt><pre data-language="nim">proc unsafeGet[T](self: Option[T]): lent T {.inline.}</pre></dt> <dd> <p>Returns the value of a <code><span class="Identifier">some</span></code>. The behavior is undefined for <code><span class="Identifier">none</span></code>.</p> <p><strong>Note:</strong> Use this only when you are <strong>absolutely sure</strong> the value is present (e.g. after checking with <a href="#isSome,Option[T]">isSome</a>). Generally, using the <a href="#get,Option[T]">get proc</a> is preferred.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/options.nim#L373" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L373" target="_blank">Edit</a> </dd> </div> </div> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/options.html" class="_attribution-link">https://nim-lang.org/docs/options.html</a>
  </p>
</div>
