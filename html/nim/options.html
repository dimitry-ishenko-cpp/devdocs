<h1 class="title">options</h1>  
<p>This module implements types which encapsulate an optional value.</p> <p>A value of type <code>Option[T]</code> either contains a value <code>x</code> (represented as <code>some(x)</code>) or is empty (<code>none(T)</code>).</p> <p>This can be useful when you have a value that can be present or not. The absence of a value is often represented by <code>nil</code>, but it is not always available, nor is it always a good solution.</p> <h2 id="basic-usage">Basic usage</h2>
<p>Let's start with an example: a procedure that finds the index of a character in a string.</p> <pre class="listing" data-language="nim">import options

proc find(haystack: string, needle: char): Option[int] =
  for i, c in haystack:
    if c == needle:
      return some(i)
  return none(int)  # This line is actually optional,
                    # because the default is empty</pre>
<pre class="listing" data-language="nim">let found = "abc".find('c')
assert found.isSome and found.get() == 2</pre>
<p>The <code>get</code> operation demonstrated above returns the underlying value, or raises <code>UnpackDefect</code> if there is no value. Note that <code>UnpackDefect</code> inherits from <code>system.Defect</code>, and should therefore never be caught. Instead, rely on checking if the option contains a value with <a href="#isSome,Option%5BT%5D">isSome</a> and <a href="#isNone,Option%5BT%5D">isNone</a> procs.</p> <p>How to deal with an absence of a value:</p> <pre class="listing" data-language="nim">let result = "team".find('i')

# Nothing was found, so the result is `none`.
assert(result == none(int))
# It has no value:
assert(result.isNone)</pre>  <h2 id="6">Imports</h2> <dl> <a href="typetraits.html">typetraits</a> </dl>  <h2 id="7">Types</h2> <dl>  <dt><pre id="Option" data-language="nim">Option[T] = object
  when T is SomePointer:
    val
  else:
      val
      has</pre></dt> <dd> An optional type that stores its value and state separately in a boolean. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L69" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L69" target="_blank">Edit</a> </dd>  <dt><pre id="UnpackDefect">UnpackDefect = object of Defect</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L77" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L77" target="_blank">Edit</a> </dd>  <dt><pre id="UnpackError" data-language="nim">UnpackError {...}{.deprecated: "See corresponding Defect".} = UnpackDefect</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L78" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L78" target="_blank">Edit</a> </dd> </dl>  <h2 id="12">Procs</h2> <dl>  <dt><pre id="option%2CT" data-language="nim">proc option[T](val: T): Option[T] {...}{.inline.}</pre></dt> <dd> <p>Can be used to convert a pointer type (<code>ptr</code> or <code>ref</code> or <code>proc</code>) to an option type. It converts <code>nil</code> to <code>None</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#some,T">some</a></li> <li><a href="#none,typedesc">none</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">type
  Foo = ref object
    a: int
    b: string
var c: Foo
assert c.isNil
var d = option(c)
assert d.isNone</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L80" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L80" target="_blank">Edit</a> </dd>  <dt><pre id="some%2CT" data-language="nim">proc some[T](val: T): Option[T] {...}{.inline.}</pre></dt> <dd> <p>Returns an <code>Option</code> that has the value <code>val</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#option,T">option</a></li> <li><a href="#none,typedesc">none</a></li> <li><a href="#isSome,Option%5BT%5D">isSome</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var
  a = some("abc")
  b = some(42)
assert $type(a) == "Option[system.string]"
assert b.isSome
assert a.get == "abc"
assert $b == "Some(42)"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L101" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L101" target="_blank">Edit</a> </dd>  <dt><pre id="none%2Ctypedesc" data-language="nim">proc none(T: typedesc): Option[T] {...}{.inline.}</pre></dt> <dd> <p>Returns an <code>Option</code> for this type that has no value.</p> <p>See also:</p> <ul class="simple">
<li><a href="#option,T">option</a></li> <li><a href="#some,T">some</a></li> <li><a href="#isNone,Option%5BT%5D">isNone</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var a = none(int)
assert a.isNone
assert $type(a) == "Option[system.int]"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L124" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L124" target="_blank">Edit</a> </dd>  <dt><pre id="none" data-language="nim">proc none[T](): Option[T] {...}{.inline.}</pre></dt> <dd> Alias for <a href="#none,typedesc">none(T) proc</a>. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L139" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L139" target="_blank">Edit</a> </dd>  <dt><pre id="isSome%2COption%5BT%5D" data-language="nim">proc isSome[T](self: Option[T]): bool {...}{.inline.}</pre></dt> <dd> Checks if an <code>Option</code> contains a value. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var
  a = some(42)
  b = none(string)
assert a.isSome
assert not b.isSome</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L143" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L143" target="_blank">Edit</a> </dd>  <dt><pre id="isNone%2COption%5BT%5D" data-language="nim">proc isNone[T](self: Option[T]): bool {...}{.inline.}</pre></dt> <dd> Checks if an <code>Option</code> is empty. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var
  a = some(42)
  b = none(string)
assert not a.isNone
assert b.isNone</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L157" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L157" target="_blank">Edit</a> </dd>  <dt><pre id="get%2COption%5BT%5D" data-language="nim">proc get[T](self: Option[T]): lent T {...}{.inline.}</pre></dt> <dd> <p>Returns contents of an <code>Option</code>. If it is <code>None</code>, then an exception is thrown.</p> <p>See also:</p> <ul class="simple">
<li>
<a href="#get,Option%5BT%5D,T">get proc</a> with the default return value</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let
  a = some(42)
  b = none(string)
assert a.get == 42
doAssertRaises(UnpackDefect):
  echo b.get</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L170" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L170" target="_blank">Edit</a> </dd>  <dt><pre id="get%2COption%5BT%5D%2CT" data-language="nim">proc get[T](self: Option[T]; otherwise: T): T {...}{.inline.}</pre></dt> <dd> Returns the contents of the <code>Option</code> or an <code>otherwise</code> value if the <code>Option</code> is <code>None</code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var
  a = some(42)
  b = none(int)
assert a.get(9999) == 42
assert b.get(9999) == 9999</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L188" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L188" target="_blank">Edit</a> </dd>  <dt><pre id="get%2COption%5BT%5D_2" data-language="nim">proc get[T](self: var Option[T]): var T {...}{.inline.}</pre></dt> <dd> Returns contents of the <code>var Option</code>. If it is <code>None</code>, then an exception is thrown. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let
  a = some(42)
  b = none(string)
assert a.get == 42
doAssertRaises(UnpackDefect):
  echo b.get</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L203" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L203" target="_blank">Edit</a> </dd>  <dt><pre id="map%2COption%5BT%5D%2Cproc%28T%29" data-language="nim">proc map[T](self: Option[T]; callback: proc (input: T)) {...}{.inline.}</pre></dt> <dd> <p>Applies a <code>callback</code> function to the value of the <code>Option</code>, if it has one.</p> <p>See also:</p> <ul class="simple">
<li>
<a href="#map,Option%5BT%5D,proc(T)_2">map proc</a> for a version with a callback which returns a value</li> <li><a href="#filter,Option%5BT%5D,proc(T)">filter proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var d = 0
proc saveDouble(x: int) =
  d = 2*x

let
  a = some(42)
  b = none(int)

b.map(saveDouble)
assert d == 0
a.map(saveDouble)
assert d == 84</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L218" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L218" target="_blank">Edit</a> </dd>  <dt><pre id="map%2COption%5BT%5D%2Cproc%28T%29_2" data-language="nim">proc map[T, R](self: Option[T]; callback: proc (input: T): R): Option[R] {...}{.
    inline.}</pre></dt> <dd> <p>Applies a <code>callback</code> function to the value of the <code>Option</code> and returns an <code>Option</code> containing the new value.</p> <p>If the <code>Option</code> is <code>None</code>, <code>None</code> of the return type of the <code>callback</code> will be returned.</p> <p>See also:</p> <ul class="simple">
<li>
<a href="#flatMap,Option%5BA%5D,proc(A)">flatMap proc</a> for a version with a callback which returns an <code>Option</code>
</li> <li><a href="#filter,Option%5BT%5D,proc(T)">filter proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var
  a = some(42)
  b = none(int)

proc isEven(x: int): bool =
  x mod 2 == 0

assert $(a.map(isEven)) == "Some(true)"
assert $(b.map(isEven)) == "None[bool]"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L242" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L242" target="_blank">Edit</a> </dd>  <dt><pre id="flatten%2COption%5BOption%5BA%5D%5D" data-language="nim">proc flatten[A](self: Option[Option[A]]): Option[A] {...}{.inline.}</pre></dt> <dd> Remove one level of structure in a nested <code>Option</code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let a = some(some(42))
assert $flatten(a) == "Some(42)"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L269" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L269" target="_blank">Edit</a> </dd>  <dt><pre id="flatMap%2COption%5BA%5D%2Cproc%28A%29" data-language="nim">proc flatMap[A, B](self: Option[A]; callback: proc (input: A): Option[B]): Option[
    B] {...}{.inline.}</pre></dt> <dd> <p>Applies a <code>callback</code> function to the value of the <code>Option</code> and returns an <code>Option</code> containing the new value.</p> <p>If the <code>Option</code> is <code>None</code>, <code>None</code> of the return type of the <code>callback</code> will be returned.</p> <p>Similar to <code>map</code>, with the difference that the <code>callback</code> returns an <code>Option</code>, not a raw value. This allows multiple procs with a signature of <code>A -&gt; Option[B]</code> to be chained together.</p> <p>See also:</p> <ul class="simple">
<li><a href="#flatten,Option%5BOption%5BA%5D%5D">flatten proc</a></li> <li><a href="#filter,Option%5BT%5D,proc(T)">filter proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">proc doublePositives(x: int): Option[int] =
  if x &gt; 0:
    return some(2*x)
  else:
    return none(int)
let
  a = some(42)
  b = none(int)
  c = some(-11)
assert a.flatMap(doublePositives) == some(84)
assert b.flatMap(doublePositives) == none(int)
assert c.flatMap(doublePositives) == none(int)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L280" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L280" target="_blank">Edit</a> </dd>  <dt><pre id="filter%2COption%5BT%5D%2Cproc%28T%29" data-language="nim">proc filter[T](self: Option[T]; callback: proc (input: T): bool): Option[T] {...}{.
    inline.}</pre></dt> <dd> <p>Applies a <code>callback</code> to the value of the <code>Option</code>.</p> <p>If the <code>callback</code> returns <code>true</code>, the option is returned as <code>Some</code>. If it returns <code>false</code>, it is returned as <code>None</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#map,Option%5BT%5D,proc(T)_2">map proc</a></li> <li><a href="#flatMap,Option%5BA%5D,proc(A)">flatMap proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">proc isEven(x: int): bool =
  x mod 2 == 0
let
  a = some(42)
  b = none(int)
  c = some(-11)
assert a.filter(isEven) == some(42)
assert b.filter(isEven) == none(int)
assert c.filter(isEven) == none(int)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L311" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L311" target="_blank">Edit</a> </dd>  <dt><pre id="%3D%3D%2COption%2COption" data-language="nim">proc `==`(a, b: Option): bool {...}{.inline.}</pre></dt> <dd> Returns <code>true</code> if both <code>Option</code>s are <code>None</code>, or if they are both <code>Some</code> and have equal values. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let
  a = some(42)
  b = none(int)
  c = some(42)
  d = none(int)

assert a == c
assert b == d
assert not (a == b)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L336" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L336" target="_blank">Edit</a> </dd>  <dt><pre id="%24%2COption%5BT%5D" data-language="nim">proc `$`[T](self: Option[T]): string</pre></dt> <dd> <p>Get the string representation of the <code>Option</code>.</p> <p>If the <code>Option</code> has a value, the result will be <code>Some(x)</code> where <code>x</code> is the string representation of the contained value. If the <code>Option</code> does not have a value, the result will be <code>None[T]</code> where <code>T</code> is the name of the type contained in the <code>Option</code>.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L352" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L352" target="_blank">Edit</a> </dd>  <dt><pre id="unsafeGet%2COption%5BT%5D" data-language="nim">proc unsafeGet[T](self: Option[T]): lent T {...}{.inline.}</pre></dt> <dd> <p>Returns the value of a <code>some</code>. Behavior is undefined for <code>none</code>.</p> <p><strong>Note:</strong> Use it only when you are <strong>absolutely sure</strong> the value is present (e.g. after checking <a href="#isSome,Option%5BT%5D">isSome</a>). Generally, using <a href="#get,Option%5BT%5D">get proc</a> is preferred.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/options.nim#L366" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/options.nim#L366" target="_blank">Edit</a> </dd> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2021 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/options.html" class="_attribution-link">https://nim-lang.org/docs/options.html</a>
  </p>
</div>
