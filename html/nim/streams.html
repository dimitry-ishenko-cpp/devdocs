<h1 class="title">std/streams</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1" target="_blank">Edit</a>  
<p>This module provides a stream interface and two implementations thereof: the <a href="#FileStream">FileStream</a> and the <a href="#StringStream">StringStream</a> which implement the stream interface for Nim file objects (<code><span class="Identifier">File</span></code>) and strings.</p> <p>Other modules may provide other implementations for this standard stream interface.</p> <div class="admonition admonition-warning">
<span class="admonition-warning-text"><b>Warning:</b></span> Due to the use of <code><span class="Identifier">pointer</span></code>, the <code><span class="Identifier">readData</span></code>, <code><span class="Identifier">peekData</span></code> and</div> <p><code><span class="Identifier">writeData</span></code> interfaces are not available on the compile-time VM, and must be cast from a <code><span class="Keyword">ptr</span> <span class="Identifier">string</span></code> on the JS backend. However, <code><span class="Identifier">readDataStr</span></code> is available generally in place of <code><span class="Identifier">readData</span></code>.</p> <h2 id="basic-usage">Basic usage</h2>
<p>The basic flow of using this module is:</p> <ol class="simple">
<li>Open input stream</li> <li>Read or write stream</li> <li>Close stream</li> </ol> <h3 id="basic-usage-stringstream-example">StringStream example</h3>

<pre class="listing" data-language="nim">import std/streams

var strm = newStringStream("""The first line
the second line
the third line""")

var line = ""

while strm.readLine(line):
  echo line

# Output:
# The first line
# the second line
# the third line

strm.close()</pre> <h3 id="basic-usage-filestream-example">FileStream example</h3>
<p>Write file stream example:</p> 
<pre class="listing" data-language="nim">import std/streams

var strm = newFileStream("somefile.txt", fmWrite)
var line = ""

if not isNil(strm):
  strm.writeLine("The first line")
  strm.writeLine("the second line")
  strm.writeLine("the third line")
  strm.close()

# Output (somefile.txt):
# The first line
# the second line
# the third line</pre> <p>Read file stream example:</p> 
<pre class="listing" data-language="nim">import std/streams

var strm = newFileStream("somefile.txt", fmRead)
var line = ""

if not isNil(strm):
  while strm.readLine(line):
    echo line
  strm.close()

# Output:
# The first line
# the second line
# the third line</pre> <h2 id="see-also">See also</h2>
<ul class="simple">
<li><a href="asyncstreams.html">asyncstreams module</a></li> <li>
<a href="syncio.html">io module</a> for <a href="syncio.html#FileMode">FileMode enum</a>
</li> </ul>  <h2 id="6">Imports</h2> <dl> <a href="since.html">since</a> </dl>   <h2 id="7">Types</h2> <dl> <div id="FileStream"> <dt><pre>FileStream = ref FileStreamObj</pre></dt> <dd> <p>A stream that encapsulates a <code><span class="Identifier">File</span></code>.</p> <p><strong>Note:</strong> Not available for JS backend.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1324" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1324" target="_blank">Edit</a> </dd> </div> <div id="FileStreamObj"> <dt><pre>FileStreamObj = object of Stream</pre></dt> <dd> <p>A file stream object.</p> <p><strong>Note:</strong> Not available for JS backend.</p> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1328" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1328" target="_blank">Edit</a> </dd> </div> <div id="Stream"> <dt><pre>Stream = ref StreamObj</pre></dt> <dd> All procedures of this module use this type. Procedures don't directly use <a href="#StreamObj">StreamObj</a>. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L113" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L113" target="_blank">Edit</a> </dd> </div> <div id="StreamObj"> <dt><pre data-language="nim">StreamObj = object of RootObj
  closeImpl*: proc (s: Stream) {.nimcall, ...raises: [IOError, OSError],
                                 tags: [WriteIOEffect], gcsafe.}
  atEndImpl*: proc (s: Stream): bool {.nimcall,
                                       ...raises: [Defect, IOError, OSError],
                                       tags: [], gcsafe.}
  setPositionImpl*: proc (s: Stream; pos: int) {.nimcall,
      ...raises: [Defect, IOError, OSError], tags: [], gcsafe.}
  getPositionImpl*: proc (s: Stream): int {.nimcall,
      ...raises: [Defect, IOError, OSError], tags: [], gcsafe.}
  readDataStrImpl*: proc (s: Stream; buffer: var string; slice: Slice[int]): int {.
      nimcall, ...raises: [Defect, IOError, OSError], tags: [ReadIOEffect], gcsafe.}
  readLineImpl*: proc (s: Stream; line: var string): bool {.nimcall,
      ...raises: [Defect, IOError, OSError], tags: [ReadIOEffect], gcsafe.}
  readDataImpl*: proc (s: Stream; buffer: pointer; bufLen: int): int {.nimcall,
      ...raises: [Defect, IOError, OSError], tags: [ReadIOEffect], gcsafe.}
  peekDataImpl*: proc (s: Stream; buffer: pointer; bufLen: int): int {.nimcall,
      ...raises: [Defect, IOError, OSError], tags: [ReadIOEffect], gcsafe.}
  writeDataImpl*: proc (s: Stream; buffer: pointer; bufLen: int) {.nimcall,
      ...raises: [Defect, IOError, OSError], tags: [WriteIOEffect], gcsafe.}
  flushImpl*: proc (s: Stream) {.nimcall, ...raises: [Defect, IOError, OSError],
                                 tags: [WriteIOEffect], gcsafe.}</pre></dt> <dd> <p>Stream interface that supports writing or reading.</p> <p><strong>Note:</strong></p> <ul class="simple">
<li>That these fields here shouldn't be used directly. They are accessible so that a stream implementation can override them.</li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L116" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L116" target="_blank">Edit</a> </dd> </div> <div id="StringStream"> <dt><pre>StringStream = ref StringStreamObj</pre></dt> <dd> A stream that encapsulates a string. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1147" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1147" target="_blank">Edit</a> </dd> </div> <div id="StringStreamObj"> <dt><pre data-language="nim">StringStreamObj = object of StreamObj
  data*: string              ## A string data.
                             ## This is updated when called `writeLine` etc.</pre></dt> <dd> A string stream object. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1149" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1149" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="12">Procs</h2> <dl> <div id="atEnd-procs-all"> <div id="atEnd,Stream"> <dt><pre data-language="nim">proc atEnd(s: Stream): bool {....raises: [IOError, OSError], tags: [], forbids: [].}</pre></dt> <dd> Checks if more data can be read from <code><span class="Identifier">s</span></code>. Returns <code>true</code> if all data has been read. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
var line = ""
doAssert strm.atEnd() == false
while strm.readLine(line):
  discard
doAssert strm.atEnd() == true
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L197" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L197" target="_blank">Edit</a> </dd> </div> </div> <div id="close-procs-all"> <div id="close,Stream"> <dt><pre data-language="nim">proc close(s: Stream) {....raises: [IOError, OSError], tags: [WriteIOEffect],
                        forbids: [].}</pre></dt> <dd> <p>Closes the stream <code><span class="Identifier">s</span></code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#flush,Stream">flush proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">block:
  let strm = newStringStream("The first line\nthe second line\nthe third line")
  ## do something...
  strm.close()
  
block:
  let strm = newFileStream("amissingfile.txt")
  # deferring works even if newFileStream fails
  defer: strm.close()
  if not isNil(strm):
    ## do something...</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L176" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L176" target="_blank">Edit</a> </dd> </div> </div> <div id="flush-procs-all"> <div id="flush,Stream"> <dt><pre data-language="nim">proc flush(s: Stream) {....raises: [IOError, OSError], tags: [WriteIOEffect],
                        forbids: [].}</pre></dt> <dd> <p>Flushes the buffers that the stream <code><span class="Identifier">s</span></code> might use.</p> <p>This procedure causes any unwritten data for that stream to be delivered to the host environment to be written to the file.</p> <p>See also:</p> <ul class="simple">
<li><a href="#close,Stream">close proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">from std/os import removeFile

var strm = newFileStream("somefile.txt", fmWrite)

doAssert "Before write:" &amp; readFile("somefile.txt") == "Before write:"
strm.write("hello")
doAssert "After  write:" &amp; readFile("somefile.txt") == "After  write:"

strm.flush()
doAssert "After  flush:" &amp; readFile("somefile.txt") == "After  flush:hello"
strm.write("HELLO")
strm.flush()
doAssert "After  flush:" &amp; readFile("somefile.txt") == "After  flush:helloHELLO"

strm.close()
doAssert "After  close:" &amp; readFile("somefile.txt") == "After  close:helloHELLO"
removeFile("somefile.txt")</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L147" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L147" target="_blank">Edit</a> </dd> </div> </div> <div id="getPosition-procs-all"> <div id="getPosition,Stream"> <dt><pre data-language="nim">proc getPosition(s: Stream): int {....raises: [IOError, OSError], tags: [],
                                   forbids: [].}</pre></dt> <dd> Retrieves the current position in the stream <code><span class="Identifier">s</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
doAssert strm.getPosition() == 0
discard strm.readLine()
doAssert strm.getPosition() == 15
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L223" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L223" target="_blank">Edit</a> </dd> </div> </div> <div id="newFileStream-procs-all"> <div id="newFileStream,File"> <dt><pre data-language="nim">proc newFileStream(f: File): owned FileStream {....raises: [], tags: [],
    forbids: [].}</pre></dt> <dd> <p>Creates a new stream from the file <code><span class="Identifier">f</span></code>.</p> <p><strong>Note:</strong> Not available for JS backend.</p> <p>See also:</p> <ul class="simple">
<li>
<a href="#newStringStream,string">newStringStream proc</a> creates a new stream from string.</li> <li>
<a href="#newFileStream,string,FileMode,int">newFileStream proc</a> is the same as using <a href="syncio.html#open,File,string,FileMode,int">open proc</a> on Examples.</li> <li>
<a href="#openFileStream,string,FileMode,int">openFileStream proc</a> creates a file stream from the file name and the mode.</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">## Input (somefile.txt):
## The first line
## the second line
## the third line
var f: File
if open(f, "somefile.txt", fmRead, -1):
  var strm = newFileStream(f)
  var line = ""
  while strm.readLine(line):
    echo line
  ## Output:
  ## The first line
  ## the second line
  ## the third line
  strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1361" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1361" target="_blank">Edit</a> </dd> </div> <div id="newFileStream,string,FileMode,int"> <dt><pre data-language="nim">proc newFileStream(filename: string; mode: FileMode = fmRead; bufSize: int = -1): owned
    FileStream {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Creates a new stream from the file named <code><span class="Identifier">filename</span></code> with the mode <code><span class="Identifier">mode</span></code>.</p> <p>If the file cannot be opened, <code><span class="Keyword">nil</span></code> is returned. See the <a href="syncio.html">io module</a> for a list of available <a href="syncio.html#FileMode">FileMode enums</a>.</p> <p><strong>Note:</strong></p> <ul class="simple">
<li>
<strong>This function returns nil in case of failure.</strong> To prevent unexpected behavior and ensure proper error handling, use <a href="#openFileStream,string,FileMode,int">openFileStream proc</a> instead.</li> <li>Not available for JS backend.</li> </ul> <p>See also:</p> <ul class="simple">
<li>
<a href="#newStringStream,string">newStringStream proc</a> creates a new stream from string.</li> <li>
<a href="#newFileStream,File">newFileStream proc</a> creates a file stream from opened File.</li> <li>
<a href="#openFileStream,string,FileMode,int">openFileStream proc</a> creates a file stream from the file name and the mode.</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">from std/os import removeFile
var strm = newFileStream("somefile.txt", fmWrite)
if not isNil(strm):
  strm.writeLine("The first line")
  strm.writeLine("the second line")
  strm.writeLine("the third line")
  strm.close()
  ## Output (somefile.txt)
  ## The first line
  ## the second line
  ## the third line
  removeFile("somefile.txt")</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1404" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1404" target="_blank">Edit</a> </dd> </div> </div> <div id="newStringStream-procs-all"> <div id="newStringStream,sinkstring"> <dt><pre data-language="nim">proc newStringStream(s: sink string = ""): owned StringStream {....raises: [],
    tags: [], forbids: [].}</pre></dt> <dd> <p>Creates a new stream from the string <code><span class="Identifier">s</span></code>.</p> <p>See also:</p> <ul class="simple">
<li>
<a href="#newFileStream,File">newFileStream proc</a> creates a file stream from opened File.</li> <li>
<a href="#newFileStream,string,FileMode,int">newFileStream proc</a> creates a file stream from the file name and the mode.</li> <li>
<a href="#openFileStream,string,FileMode,int">openFileStream proc</a> creates a file stream from the file name and the mode.</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
doAssert strm.readLine() == "The first line"
doAssert strm.readLine() == "the second line"
doAssert strm.readLine() == "the third line"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1286" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1286" target="_blank">Edit</a> </dd> </div> </div> <div id="openFileStream-procs-all"> <div id="openFileStream,string,FileMode,int"> <dt><pre data-language="nim">proc openFileStream(filename: string; mode: FileMode = fmRead; bufSize: int = -1): owned
    FileStream {....raises: [IOError], tags: [], forbids: [].}</pre></dt> <dd> <p>Creates a new stream from the file named <code><span class="Identifier">filename</span></code> with the mode <code><span class="Identifier">mode</span></code>. If the file cannot be opened, an IO exception is raised.</p> <p><strong>Note:</strong> Not available for JS backend.</p> <p>See also:</p> <ul class="simple">
<li>
<a href="#newStringStream,string">newStringStream proc</a> creates a new stream from string.</li> <li>
<a href="#newFileStream,File">newFileStream proc</a> creates a file stream from opened File.</li> <li>
<a href="#newFileStream,string,FileMode,int">newFileStream proc</a> creates a file stream from the file name and the mode.</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">try:
  ## Input (somefile.txt):
  ## The first line
  ## the second line
  ## the third line
  var strm = openFileStream("somefile.txt")
  echo strm.readLine()
  ## Output:
  ## The first line
  strm.close()
except:
  stderr.write getCurrentExceptionMsg()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1442" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1442" target="_blank">Edit</a> </dd> </div> </div> <div id="peek-procs-all"> <div id="peek,Stream,T"> <dt><pre data-language="nim">proc peek[T](s: Stream; result: var T)</pre></dt> <dd> <p>Generic peek procedure. Peeks <code><span class="Identifier">result</span></code> from the stream <code><span class="Identifier">s</span></code>.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("012")
## peekInt
var i: int8
strm.peek(i)
doAssert i == 48
## peekData
var buffer: array[2, char]
strm.peek(buffer)
doAssert buffer == ['0', '1']
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L433" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L433" target="_blank">Edit</a> </dd> </div> </div> <div id="peekBool-procs-all"> <div id="peekBool,Stream"> <dt><pre data-language="nim">proc peekBool(s: Stream): bool {....raises: [IOError, OSError],
                                 tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks a bool from the stream <code><span class="Identifier">s</span></code>.</p> <p>A bool is one byte long and it is <code><span class="Identifier">true</span></code> for every non-zero (<code><span class="DecNumber">0000_0000</span></code>) value. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(true)
strm.write(false)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekBool() == true
## not false
doAssert strm.peekBool() == true
doAssert strm.readBool() == true
doAssert strm.peekBool() == false
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L516" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L516" target="_blank">Edit</a> </dd> </div> </div> <div id="peekChar-procs-all"> <div id="peekChar,Stream"> <dt><pre data-language="nim">proc peekChar(s: Stream): char {....raises: [IOError, OSError],
                                 tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Peeks a char from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred. Returns '\0' as an EOF marker. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("12\n3")
doAssert strm.peekChar() == '1'
doAssert strm.peekChar() == '1'
discard strm.readAll()
doAssert strm.peekChar() == '\x00'
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L473" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L473" target="_blank">Edit</a> </dd> </div> </div> <div id="peekData-procs-all"> <div id="peekData,Stream,pointer,int"> <dt><pre data-language="nim">proc peekData(s: Stream; buffer: pointer; bufLen: int): int {.
    ...raises: [IOError, OSError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Low level proc that reads data into an untyped <code><span class="Identifier">buffer</span></code> of <code><span class="Identifier">bufLen</span></code> size without moving stream position.</p> <p><strong>JS note:</strong> <code><span class="Identifier">buffer</span></code> is treated as a <code>ptr string</code> and written to between <code>0..&lt;bufLen</code>.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("abcde")
var buffer: array[6, char]
doAssert strm.peekData(addr(buffer), 1024) == 5
doAssert buffer == ['a', 'b', 'c', 'd', 'e', '\x00']
doAssert strm.atEnd() == false
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L313" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L313" target="_blank">Edit</a> </dd> </div> </div> <div id="peekFloat32-procs-all"> <div id="peekFloat32,Stream"> <dt><pre data-language="nim">proc peekFloat32(s: Stream): float32 {....raises: [IOError, OSError],
                                       tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks a float32 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'f32)
strm.write(2'f32)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekFloat32() == 1'f32
## not 2'f32
doAssert strm.peekFloat32() == 1'f32
doAssert strm.readFloat32() == 1'f32
doAssert strm.peekFloat32() == 2'f32
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L883" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L883" target="_blank">Edit</a> </dd> </div> </div> <div id="peekFloat64-procs-all"> <div id="peekFloat64,Stream"> <dt><pre data-language="nim">proc peekFloat64(s: Stream): float64 {....raises: [IOError, OSError],
                                       tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks a float64 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'f64)
strm.write(2'f64)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekFloat64() == 1'f64
## not 2'f64
doAssert strm.peekFloat64() == 1'f64
doAssert strm.readFloat64() == 1'f64
doAssert strm.peekFloat64() == 2'f64
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L923" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L923" target="_blank">Edit</a> </dd> </div> </div> <div id="peekInt8-procs-all"> <div id="peekInt8,Stream"> <dt><pre data-language="nim">proc peekInt8(s: Stream): int8 {....raises: [IOError, OSError],
                                 tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an int8 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i8)
strm.write(2'i8)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekInt8() == 1'i8
## not 2'i8
doAssert strm.peekInt8() == 1'i8
doAssert strm.readInt8() == 1'i8
doAssert strm.peekInt8() == 2'i8
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L562" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L562" target="_blank">Edit</a> </dd> </div> </div> <div id="peekInt16-procs-all"> <div id="peekInt16,Stream"> <dt><pre data-language="nim">proc peekInt16(s: Stream): int16 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an int16 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i16)
strm.write(2'i16)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekInt16() == 1'i16
## not 2'i16
doAssert strm.peekInt16() == 1'i16
doAssert strm.readInt16() == 1'i16
doAssert strm.peekInt16() == 2'i16
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L602" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L602" target="_blank">Edit</a> </dd> </div> </div> <div id="peekInt32-procs-all"> <div id="peekInt32,Stream"> <dt><pre data-language="nim">proc peekInt32(s: Stream): int32 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an int32 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i32)
strm.write(2'i32)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekInt32() == 1'i32
## not 2'i32
doAssert strm.peekInt32() == 1'i32
doAssert strm.readInt32() == 1'i32
doAssert strm.peekInt32() == 2'i32
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L642" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L642" target="_blank">Edit</a> </dd> </div> </div> <div id="peekInt64-procs-all"> <div id="peekInt64,Stream"> <dt><pre data-language="nim">proc peekInt64(s: Stream): int64 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an int64 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i64)
strm.write(2'i64)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekInt64() == 1'i64
## not 2'i64
doAssert strm.peekInt64() == 1'i64
doAssert strm.readInt64() == 1'i64
doAssert strm.peekInt64() == 2'i64
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L682" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L682" target="_blank">Edit</a> </dd> </div> </div> <div id="peekLine-procs-all"> <div id="peekLine,Stream"> <dt><pre data-language="nim">proc peekLine(s: Stream): string {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks a line from a stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> This is not very efficient.</p> <p>See also:</p> <ul class="simple">
<li><a href="#readLine,Stream">readLine(Stream) proc</a></li> <li><a href="#readLine,Stream,string">readLine(Stream, string) proc</a></li> <li><a href="#peekLine,Stream,string">peekLine(Stream, string) proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
doAssert strm.peekLine() == "The first line"
## not "the second line"
doAssert strm.peekLine() == "The first line"
doAssert strm.readLine() == "The first line"
doAssert strm.peekLine() == "the second line"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1105" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1105" target="_blank">Edit</a> </dd> </div> <div id="peekLine,Stream,string"> <dt><pre data-language="nim">proc peekLine(s: Stream; line: var string): bool {....raises: [IOError, OSError],
    tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks a line of text from the stream <code><span class="Identifier">s</span></code> into <code><span class="Identifier">line</span></code>. <code><span class="Identifier">line</span></code> must not be <code>nil</code>! May throw an IO exception.</p> <p>A line of text may be delimited by <code>CR</code>, <code>LF</code> or <code>CRLF</code>. The newline character(s) are not part of the returned string. Returns <code>false</code> if the end of the file has been reached, <code>true</code> otherwise. If <code>false</code> is returned <code><span class="Identifier">line</span></code> contains no new data.</p> <p>See also:</p> <ul class="simple">
<li><a href="#readLine,Stream">readLine(Stream) proc</a></li> <li><a href="#readLine,Stream,string">readLine(Stream, string) proc</a></li> <li><a href="#peekLine,Stream">peekLine(Stream) proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
var line = ""
doAssert strm.peekLine(line) == true
doAssert line == "The first line"
doAssert strm.peekLine(line) == true
## not "the second line"
doAssert line == "The first line"
doAssert strm.readLine(line) == true
doAssert line == "The first line"
doAssert strm.peekLine(line) == true
doAssert line == "the second line"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1044" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1044" target="_blank">Edit</a> </dd> </div> </div> <div id="peekStr-procs-all"> <div id="peekStr,Stream,int"> <dt><pre data-language="nim">proc peekStr(s: Stream; length: int): string {....raises: [IOError, OSError],
    tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Peeks a string of length <code><span class="Identifier">length</span></code> from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("abcde")
doAssert strm.peekStr(2) == "ab"
## not "cd
doAssert strm.peekStr(2) == "ab"
doAssert strm.readStr(2) == "ab"
doAssert strm.peekStr(2) == "cd"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L987" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L987" target="_blank">Edit</a> </dd> </div> <div id="peekStr,Stream,int,string"> <dt><pre data-language="nim">proc peekStr(s: Stream; length: int; str: var string) {.
    ...raises: [IOError, OSError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Peeks a string of length <code><span class="Identifier">length</span></code> from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L982" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L982" target="_blank">Edit</a> </dd> </div> </div> <div id="peekUint8-procs-all"> <div id="peekUint8,Stream"> <dt><pre data-language="nim">proc peekUint8(s: Stream): uint8 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an uint8 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u8)
strm.write(2'u8)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekUint8() == 1'u8
## not 2'u8
doAssert strm.peekUint8() == 1'u8
doAssert strm.readUint8() == 1'u8
doAssert strm.peekUint8() == 2'u8
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L722" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L722" target="_blank">Edit</a> </dd> </div> </div> <div id="peekUint16-procs-all"> <div id="peekUint16,Stream"> <dt><pre data-language="nim">proc peekUint16(s: Stream): uint16 {....raises: [IOError, OSError],
                                     tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an uint16 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u16)
strm.write(2'u16)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekUint16() == 1'u16
## not 2'u16
doAssert strm.peekUint16() == 1'u16
doAssert strm.readUint16() == 1'u16
doAssert strm.peekUint16() == 2'u16
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L762" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L762" target="_blank">Edit</a> </dd> </div> </div> <div id="peekUint32-procs-all"> <div id="peekUint32,Stream"> <dt><pre data-language="nim">proc peekUint32(s: Stream): uint32 {....raises: [IOError, OSError],
                                     tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an uint32 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u32)
strm.write(2'u32)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekUint32() == 1'u32
## not 2'u32
doAssert strm.peekUint32() == 1'u32
doAssert strm.readUint32() == 1'u32
doAssert strm.peekUint32() == 2'u32
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L803" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L803" target="_blank">Edit</a> </dd> </div> </div> <div id="peekUint64-procs-all"> <div id="peekUint64,Stream"> <dt><pre data-language="nim">proc peekUint64(s: Stream): uint64 {....raises: [IOError, OSError],
                                     tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Peeks an uint64 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#peekStr,Stream,int">peekStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u64)
strm.write(2'u64)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.peekUint64() == 1'u64
## not 2'u64
doAssert strm.peekUint64() == 1'u64
doAssert strm.readUint64() == 1'u64
doAssert strm.peekUint64() == 2'u64
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L843" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L843" target="_blank">Edit</a> </dd> </div> </div> <div id="read-procs-all"> <div id="read,Stream,T"> <dt><pre data-language="nim">proc read[T](s: Stream; result: var T)</pre></dt> <dd> <p>Generic read procedure. Reads <code><span class="Identifier">result</span></code> from the stream <code><span class="Identifier">s</span></code>.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("012")
## readInt
var i: int8
strm.read(i)
doAssert i == 48
## readData
var buffer: array[2, char]
strm.read(buffer)
doAssert buffer == ['1', '2']
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L414" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L414" target="_blank">Edit</a> </dd> </div> </div> <div id="readAll-procs-all"> <div id="readAll,Stream"> <dt><pre data-language="nim">proc readAll(s: Stream): string {....raises: [IOError, OSError],
                                  tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Reads all available data. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
doAssert strm.readAll() == "The first line\nthe second line\nthe third line"
doAssert strm.atEnd() == true
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L280" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L280" target="_blank">Edit</a> </dd> </div> </div> <div id="readBool-procs-all"> <div id="readBool,Stream"> <dt><pre data-language="nim">proc readBool(s: Stream): bool {....raises: [IOError, OSError],
                                 tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads a bool from the stream <code><span class="Identifier">s</span></code>.</p> <p>A bool is one byte long and it is <code><span class="Identifier">true</span></code> for every non-zero (<code><span class="DecNumber">0000_0000</span></code>) value. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(true)
strm.write(false)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readBool() == true
doAssert strm.readBool() == false
doAssertRaises(IOError): discard strm.readBool()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L491" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L491" target="_blank">Edit</a> </dd> </div> </div> <div id="readChar-procs-all"> <div id="readChar,Stream"> <dt><pre data-language="nim">proc readChar(s: Stream): char {....raises: [IOError, OSError],
                                 tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads a char from the stream <code><span class="Identifier">s</span></code>.</p> <p>Raises <code><span class="Identifier">IOError</span></code> if an error occurred. Returns '\0' as an EOF marker.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("12\n3")
doAssert strm.readChar() == '1'
doAssert strm.readChar() == '2'
doAssert strm.readChar() == '\n'
doAssert strm.readChar() == '3'
doAssert strm.readChar() == '\x00'
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L452" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L452" target="_blank">Edit</a> </dd> </div> </div> <div id="readData-procs-all"> <div id="readData,Stream,pointer,int"> <dt><pre data-language="nim">proc readData(s: Stream; buffer: pointer; bufLen: int): int {.
    ...raises: [IOError, OSError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Low level proc that reads data into an untyped <code><span class="Identifier">buffer</span></code> of <code><span class="Identifier">bufLen</span></code> size.</p> <p><strong>JS note:</strong> <code><span class="Identifier">buffer</span></code> is treated as a <code>ptr string</code> and written to between <code>0..&lt;bufLen</code>.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("abcde")
var buffer: array[6, char]
doAssert strm.readData(addr(buffer), 1024) == 5
doAssert buffer == ['a', 'b', 'c', 'd', 'e', '\x00']
doAssert strm.atEnd() == true
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L234" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L234" target="_blank">Edit</a> </dd> </div> </div> <div id="readDataStr-procs-all"> <div id="readDataStr,Stream,string,Slice[int]"> <dt><pre data-language="nim">proc readDataStr(s: Stream; buffer: var string; slice: Slice[int]): int {.
    ...raises: [IOError, OSError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Low level proc that reads data into a string <code>buffer</code> at <code>slice</code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("abcde")
var buffer = "12345"
doAssert strm.readDataStr(buffer, 0..3) == 4
doAssert buffer == "abcd5"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L249" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L249" target="_blank">Edit</a> </dd> </div> </div> <div id="readFloat32-procs-all"> <div id="readFloat32,Stream"> <dt><pre data-language="nim">proc readFloat32(s: Stream): float32 {....raises: [IOError, OSError],
                                       tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads a float32 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'f32)
strm.write(2'f32)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readFloat32() == 1'f32
doAssert strm.readFloat32() == 2'f32
doAssertRaises(IOError): discard strm.readFloat32()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L864" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L864" target="_blank">Edit</a> </dd> </div> </div> <div id="readFloat64-procs-all"> <div id="readFloat64,Stream"> <dt><pre data-language="nim">proc readFloat64(s: Stream): float64 {....raises: [IOError, OSError],
                                       tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads a float64 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'f64)
strm.write(2'f64)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readFloat64() == 1'f64
doAssert strm.readFloat64() == 2'f64
doAssertRaises(IOError): discard strm.readFloat64()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L904" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L904" target="_blank">Edit</a> </dd> </div> </div> <div id="readInt8-procs-all"> <div id="readInt8,Stream"> <dt><pre data-language="nim">proc readInt8(s: Stream): int8 {....raises: [IOError, OSError],
                                 tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an int8 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i8)
strm.write(2'i8)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readInt8() == 1'i8
doAssert strm.readInt8() == 2'i8
doAssertRaises(IOError): discard strm.readInt8()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L543" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L543" target="_blank">Edit</a> </dd> </div> </div> <div id="readInt16-procs-all"> <div id="readInt16,Stream"> <dt><pre data-language="nim">proc readInt16(s: Stream): int16 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an int16 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i16)
strm.write(2'i16)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readInt16() == 1'i16
doAssert strm.readInt16() == 2'i16
doAssertRaises(IOError): discard strm.readInt16()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L583" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L583" target="_blank">Edit</a> </dd> </div> </div> <div id="readInt32-procs-all"> <div id="readInt32,Stream"> <dt><pre data-language="nim">proc readInt32(s: Stream): int32 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an int32 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i32)
strm.write(2'i32)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readInt32() == 1'i32
doAssert strm.readInt32() == 2'i32
doAssertRaises(IOError): discard strm.readInt32()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L623" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L623" target="_blank">Edit</a> </dd> </div> </div> <div id="readInt64-procs-all"> <div id="readInt64,Stream"> <dt><pre data-language="nim">proc readInt64(s: Stream): int64 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an int64 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'i64)
strm.write(2'i64)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readInt64() == 1'i64
doAssert strm.readInt64() == 2'i64
doAssertRaises(IOError): discard strm.readInt64()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L663" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L663" target="_blank">Edit</a> </dd> </div> </div> <div id="readLine-procs-all"> <div id="readLine,Stream"> <dt><pre data-language="nim">proc readLine(s: Stream): string {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads a line from a stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> This is not very efficient.</p> <p>See also:</p> <ul class="simple">
<li><a href="#readLine,Stream,string">readLine(Stream, string) proc</a></li> <li><a href="#peekLine,Stream">peekLine(Stream) proc</a></li> <li><a href="#peekLine,Stream,string">peekLine(Stream, string) proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
doAssert strm.readLine() == "The first line"
doAssert strm.readLine() == "the second line"
doAssert strm.readLine() == "the third line"
doAssertRaises(IOError): discard strm.readLine()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1075" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1075" target="_blank">Edit</a> </dd> </div> <div id="readLine,Stream,string"> <dt><pre data-language="nim">proc readLine(s: Stream; line: var string): bool {....raises: [IOError, OSError],
    tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads a line of text from the stream <code><span class="Identifier">s</span></code> into <code><span class="Identifier">line</span></code>. <code><span class="Identifier">line</span></code> must not be <code>nil</code>! May throw an IO exception.</p> <p>A line of text may be delimited by <code>LF</code> or <code>CRLF</code>. The newline character(s) are not part of the returned string. Returns <code>false</code> if the end of the file has been reached, <code>true</code> otherwise. If <code>false</code> is returned <code><span class="Identifier">line</span></code> contains no new data.</p> <p>See also:</p> <ul class="simple">
<li><a href="#readLine,Stream">readLine(Stream) proc</a></li> <li><a href="#peekLine,Stream">peekLine(Stream) proc</a></li> <li><a href="#peekLine,Stream,string">peekLine(Stream, string) proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
var line = ""
doAssert strm.readLine(line) == true
doAssert line == "The first line"
doAssert strm.readLine(line) == true
doAssert line == "the second line"
doAssert strm.readLine(line) == true
doAssert line == "the third line"
doAssert strm.readLine(line) == false
doAssert line == ""
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1001" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1001" target="_blank">Edit</a> </dd> </div> </div> <div id="readStr-procs-all"> <div id="readStr,Stream,int"> <dt><pre data-language="nim">proc readStr(s: Stream; length: int): string {....raises: [IOError, OSError],
    tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Reads a string of length <code><span class="Identifier">length</span></code> from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("abcde")
doAssert strm.readStr(2) == "ab"
doAssert strm.readStr(2) == "cd"
doAssert strm.readStr(2) == "e"
doAssert strm.readStr(2) == ""
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L961" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L961" target="_blank">Edit</a> </dd> </div> <div id="readStr,Stream,int,string"> <dt><pre data-language="nim">proc readStr(s: Stream; length: int; str: var string) {.
    ...raises: [IOError, OSError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Reads a string of length <code><span class="Identifier">length</span></code> from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred. <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L956" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L956" target="_blank">Edit</a> </dd> </div> </div> <div id="readUint8-procs-all"> <div id="readUint8,Stream"> <dt><pre data-language="nim">proc readUint8(s: Stream): uint8 {....raises: [IOError, OSError],
                                   tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an uint8 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u8)
strm.write(2'u8)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readUint8() == 1'u8
doAssert strm.readUint8() == 2'u8
doAssertRaises(IOError): discard strm.readUint8()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L703" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L703" target="_blank">Edit</a> </dd> </div> </div> <div id="readUint16-procs-all"> <div id="readUint16,Stream"> <dt><pre data-language="nim">proc readUint16(s: Stream): uint16 {....raises: [IOError, OSError],
                                     tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an uint16 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u16)
strm.write(2'u16)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readUint16() == 1'u16
doAssert strm.readUint16() == 2'u16
doAssertRaises(IOError): discard strm.readUint16()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L743" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L743" target="_blank">Edit</a> </dd> </div> </div> <div id="readUint32-procs-all"> <div id="readUint32,Stream"> <dt><pre data-language="nim">proc readUint32(s: Stream): uint32 {....raises: [IOError, OSError],
                                     tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an uint32 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u32)
strm.write(2'u32)
strm.flush()
strm.setPosition(0)

## get data
doAssert strm.readUint32() == 1'u32
doAssert strm.readUint32() == 2'u32
doAssertRaises(IOError): discard strm.readUint32()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L783" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L783" target="_blank">Edit</a> </dd> </div> </div> <div id="readUint64-procs-all"> <div id="readUint64,Stream"> <dt><pre data-language="nim">proc readUint64(s: Stream): uint64 {....raises: [IOError, OSError],
                                     tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Reads an uint64 from the stream <code><span class="Identifier">s</span></code>. Raises <code><span class="Identifier">IOError</span></code> if an error occurred.</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#readStr,Stream,int">readStr</a> for now.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream()
## setup for reading data
strm.write(1'u64)
strm.write(2'u64)
strm.flush()
strm.setPosition(0)
## get data
doAssert strm.readUint64() == 1'u64
doAssert strm.readUint64() == 2'u64
doAssertRaises(IOError): discard strm.readUint64()
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L824" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L824" target="_blank">Edit</a> </dd> </div> </div> <div id="setPosition-procs-all"> <div id="setPosition,Stream,int"> <dt><pre data-language="nim">proc setPosition(s: Stream; pos: int) {....raises: [IOError, OSError], tags: [],
                                        forbids: [].}</pre></dt> <dd> Sets the position <code><span class="Identifier">pos</span></code> of the stream <code><span class="Identifier">s</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
strm.setPosition(4)
doAssert strm.readLine() == "first line"
strm.setPosition(0)
doAssert strm.readLine() == "The first line"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L211" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L211" target="_blank">Edit</a> </dd> </div> </div> <div id="write-procs-all"> <div id="write,Stream,varargs[string,]"> <dt><pre data-language="nim">proc write(s: Stream; args: varargs[string, `$`]) {....raises: [IOError, OSError],
    tags: [WriteIOEffect], forbids: [].}</pre></dt> <dd> Writes one or more strings to the the stream. No length fields or terminating zeros are written. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("")
strm.write(1, 2, 3, 4)
strm.setPosition(0)
doAssert strm.readLine() == "1234"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L388" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L388" target="_blank">Edit</a> </dd> </div> <div id="write,Stream,string"> <dt><pre data-language="nim">proc write(s: Stream; x: string) {....raises: [IOError, OSError],
                                   tags: [WriteIOEffect], forbids: [].}</pre></dt> <dd> Writes the string <code><span class="Identifier">x</span></code> to the stream <code><span class="Identifier">s</span></code>. No length field or terminating zero is written. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("")
strm.write("THE FIRST LINE")
strm.setPosition(0)
doAssert strm.readLine() == "THE FIRST LINE"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L368" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L368" target="_blank">Edit</a> </dd> </div> <div id="write,Stream,T"> <dt><pre data-language="nim">proc write[T](s: Stream; x: T)</pre></dt> <dd> <p>Generic write procedure. Writes <code><span class="Identifier">x</span></code> to the stream <code><span class="Identifier">s</span></code>. Implementation:</p> <p><strong>Note:</strong> Not available for JS backend. Use <a href="#write,Stream,string">write(Stream, string)</a> for now.</p> 
<pre class="listing" data-language="nim">s.writeData(s, unsafeAddr(x), sizeof(x))</pre> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("")
strm.write("abcde")
strm.setPosition(0)
doAssert strm.readAll() == "abcde"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L350" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L350" target="_blank">Edit</a> </dd> </div> </div> <div id="writeData-procs-all"> <div id="writeData,Stream,pointer,int"> <dt><pre data-language="nim">proc writeData(s: Stream; buffer: pointer; bufLen: int) {.
    ...raises: [IOError, OSError], tags: [WriteIOEffect], forbids: [].}</pre></dt> <dd> <p>Low level proc that writes an untyped <code><span class="Identifier">buffer</span></code> of <code><span class="Identifier">bufLen</span></code> size to the stream <code><span class="Identifier">s</span></code>.</p> <p><strong>JS note:</strong> <code><span class="Identifier">buffer</span></code> is treated as a <code>ptr string</code> and read between <code>0..&lt;bufLen</code>.</p> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">## writeData
var strm = newStringStream("")
var buffer = ['a', 'b', 'c', 'd', 'e']
strm.writeData(addr(buffer), sizeof(buffer))
doAssert strm.atEnd() == true
## readData
strm.setPosition(0)
var buffer2: array[6, char]
doAssert strm.readData(addr(buffer2), sizeof(buffer2)) == 5
doAssert buffer2 == ['a', 'b', 'c', 'd', 'e', '\x00']
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L329" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L329" target="_blank">Edit</a> </dd> </div> </div> <div id="writeLine-procs-all"> <div id="writeLine,Stream,varargs[string,]"> <dt><pre data-language="nim">proc writeLine(s: Stream; args: varargs[string, `$`]) {.
    ...raises: [IOError, OSError], tags: [WriteIOEffect], forbids: [].}</pre></dt> <dd> Writes one or more strings to the the stream <code><span class="Identifier">s</span></code> followed by a new line. No length field or terminating zero is written. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("")
strm.writeLine(1, 2)
strm.writeLine(3, 4)
strm.setPosition(0)
doAssert strm.readAll() == "12\n34\n"
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L400" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L400" target="_blank">Edit</a> </dd> </div> </div> </dl>   <h2 id="15">Iterators</h2> <dl> <div id="lines-iterators-all"> <div id="lines.i,Stream"> <dt><pre data-language="nim">iterator lines(s: Stream): string {....raises: [IOError, OSError],
                                    tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> <p>Iterates over every line in the stream. The iteration is based on <code>readLine</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#readLine,Stream">readLine(Stream) proc</a></li> <li><a href="#readLine,Stream,string">readLine(Stream, string) proc</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var strm = newStringStream("The first line\nthe second line\nthe third line")
var lines: seq[string]
for line in strm.lines():
  lines.add line
doAssert lines == @["The first line", "the second line", "the third line"]
strm.close()</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/lib/pure/streams.nim#L1127" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/streams.nim#L1127" target="_blank">Edit</a> </dd> </div> </div> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/streams.html" class="_attribution-link">https://nim-lang.org/docs/streams.html</a>
  </p>
</div>
