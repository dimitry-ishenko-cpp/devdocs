<h1 class="title">dynlib</h1>  <p class="module-desc">This module implements the ability to access symbols from shared libraries. On POSIX this uses the <code>dlsym</code> mechanism, on Windows <code>LoadLibrary</code>. </p>
<h2 id="examples">Examples</h2> <h3 id="examples-loading-a-simple-c-function">Loading a simple C function</h3>
<p>The following example demonstrates loading a function called 'greet' from a library that is determined at runtime based upon a language choice. If the library fails to load or the function 'greet' is not found, it quits with a failure error code.</p> <pre class="listing" data-language="nim">import dynlib

type
  greetFunction = proc(): cstring {.gcsafe, stdcall.}

let lang = stdin.readLine()

let lib = case lang
of "french":
  loadLib("french.dll")
else:
  loadLib("english.dll")

if lib == nil:
  echo "Error loading library"
  quit(QuitFailure)

let greet = cast[greetFunction](lib.symAddr("greet"))

if greet == nil:
  echo "Error loading 'greet' function from library"
  quit(QuitFailure)

let greeting = greet()

echo greeting

unloadLib(lib)</pre>  <h2 id="6">Imports</h2> <dl> <a href="strutils.html">strutils</a>, <a href="posix.html">posix</a> </dl>  <h2 id="7">Types</h2> <dl>  <dt><pre id="LibHandle">LibHandle = pointer</pre></dt> <dd> a handle to a dynamically loaded library <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L60" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L60" target="_blank">Edit</a> </dd> </dl>  <h2 id="12">Procs</h2> <dl>  <dt><pre id="raiseInvalidLibrary%2Ccstring" data-language="nim">proc raiseInvalidLibrary(name: cstring) {...}{.noinline, noreturn,
    raises: [LibraryError], tags: [].}</pre></dt> <dd> raises an <code>EInvalidLibrary</code> exception. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L73" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L73" target="_blank">Edit</a> </dd>  <dt><pre id="checkedSymAddr%2CLibHandle%2Ccstring" data-language="nim">proc checkedSymAddr(lib: LibHandle; name: cstring): pointer {...}{.
    raises: [Exception, LibraryError], tags: [RootEffect].}</pre></dt> <dd> retrieves the address of a procedure/variable from <code>lib</code>. Raises <code>EInvalidLibrary</code> if the symbol could not be found. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L81" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L81" target="_blank">Edit</a> </dd>  <dt><pre id="libCandidates%2Cstring%2Cseq%5Bstring%5D" data-language="nim">proc libCandidates(s: string; dest: var seq[string]) {...}{.raises: [], tags: [].}</pre></dt> <dd> given a library name pattern <code>s</code> write possible library names to <code>dest</code>. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L87" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L87" target="_blank">Edit</a> </dd>  <dt><pre id="loadLibPattern%2Cstring" data-language="nim">proc loadLibPattern(pattern: string; globalSymbols = false): LibHandle {...}{.
    raises: [Exception], tags: [RootEffect].}</pre></dt> <dd> loads a library with name matching <code>pattern</code>, similar to what <code>dynlib</code> pragma does. Returns nil if the library could not be loaded. Warning: this proc uses the GC and so cannot be used to load the GC. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L99" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L99" target="_blank">Edit</a> </dd>  <dt><pre id="loadLib%2Cstring" data-language="nim">proc loadLib(path: string; globalSymbols = false): LibHandle {...}{.gcsafe,
    raises: [], tags: [].}</pre></dt> <dd> loads a library from <code>path</code>. Returns nil if the library could not be loaded. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L120" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L120" target="_blank">Edit</a> </dd>  <dt><pre id="loadLib" data-language="nim">proc loadLib(): LibHandle {...}{.gcsafe, raises: [], tags: [].}</pre></dt> <dd> gets the handle from the current executable. Returns nil if the library could not be loaded. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L127" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L127" target="_blank">Edit</a> </dd>  <dt><pre id="unloadLib%2CLibHandle" data-language="nim">proc unloadLib(lib: LibHandle) {...}{.gcsafe, raises: [], tags: [].}</pre></dt> <dd> unloads the library <code>lib</code> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L128" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L128" target="_blank">Edit</a> </dd>  <dt><pre id="symAddr%2CLibHandle%2Ccstring" data-language="nim">proc symAddr(lib: LibHandle; name: cstring): pointer {...}{.gcsafe, raises: [],
    tags: [].}</pre></dt> <dd> retrieves the address of a procedure/variable from <code>lib</code>. Returns nil if the symbol could not be found. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/dynlib.nim#L129" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/dynlib.nim#L129" target="_blank">Edit</a> </dd> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2021 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/dynlib.html" class="_attribution-link">https://nim-lang.org/docs/dynlib.html</a>
  </p>
</div>
