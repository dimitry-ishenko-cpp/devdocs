<h1 class="title">std/uri</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L1" target="_blank">Edit</a>  
<p>This module implements URI parsing as specified by RFC 3986.</p> <p>A Uniform Resource Identifier (URI) provides a simple and extensible means for identifying a resource. A URI can be further classified as a locator, a name, or both. The term "Uniform Resource Locator" (URL) refers to the subset of URIs.</p> <div class="admonition admonition-warning">
<span class="admonition-warning-text"><b>Warning:</b></span> URI parsers in this module do not perform security validation.</div> <h2 id="basic-usage">Basic usage</h2> <h3 id="basic-usage-combine-uris">Combine URIs</h3> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">import std/uri
let host = parseUri("https://nim-lang.org")
assert $host == "https://nim-lang.org"
assert $(host / "/blog.html") == "https://nim-lang.org/blog.html"
assert $(host / "blog2.html") == "https://nim-lang.org/blog2.html"</pre> <h3 id="basic-usage-access-uri-item">Access URI item</h3> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">import std/uri
let res = parseUri("sftp://127.0.0.1:4343")
assert isAbsolute(res)
assert res.port == "4343"</pre> <h3 id="basic-usage-data-uri-base64">Data URI Base64</h3> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">import std/uri
assert getDataUri("Hello World", "text/plain") == "data:text/plain;charset=utf-8;base64,SGVsbG8gV29ybGQ="
assert getDataUri("Nim", "text/plain") == "data:text/plain;charset=utf-8;base64,Tmlt"</pre>  <h2 id="6">Imports</h2> <dl> <a href="strutils.html">strutils</a>, <a href="parseutils.html">parseutils</a>, <a href="base64.html">base64</a>, <a href="since.html">since</a>, <a href="decode_helpers.html">decode_helpers</a> </dl>   <h2 id="7">Types</h2> <dl> <div id="Uri"> <dt><pre data-language="nim">Uri = object
  scheme*, username*, password*: string
  hostname*, port*, path*, query*, anchor*: string
  opaque*: bool
  isIpv6*: bool</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L51" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L51" target="_blank">Edit</a> </dd> </div> <div id="UriParseError"> <dt><pre>UriParseError = object of ValueError</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L57" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L57" target="_blank">Edit</a> </dd> </div> <div id="Url"> <dt><pre>Url = distinct string</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L49" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L49" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="12">Procs</h2> <dl> <div id="$-procs-all"> <div id="$,Uri"> <dt><pre data-language="nim">func `$`(u: Uri): string {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Returns the string representation of the specified URI object. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert $parseUri("https://nim-lang.org") == "https://nim-lang.org"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L495" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L495" target="_blank">Edit</a> </dd> </div> </div> <div id="/-procs-all"> <div id="/,Uri,string"> <dt><pre data-language="nim">func `/`(x: Uri; path: string): Uri {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Concatenates the path specified to the specified URIs path.</p> <p>Contrary to the <a href="#combine,Uri,Uri">combine func</a> you do not have to worry about the slashes at the beginning and end of the path and URIs path respectively.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#combine,Uri,Uri">combine func</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let foo = parseUri("https://nim-lang.org/foo/bar") / "/baz"
assert foo.path == "/foo/bar/baz"
let bar = parseUri("https://nim-lang.org/foo/bar") / "baz"
assert bar.path == "/foo/bar/baz"
let qux = parseUri("https://nim-lang.org/foo/bar/") / "baz"
assert qux.path == "/foo/bar/baz"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L453" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L453" target="_blank">Edit</a> </dd> </div> </div> <div id="?-procs-all"> <div id="?,Uri,openArray[]"> <dt><pre data-language="nim">func `?`(u: Uri; query: openArray[(string, string)]): Uri {....raises: [],
    tags: [], forbids: [].}</pre></dt> <dd> Concatenates the query parameters to the specified URI object. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let foo = parseUri("https://example.com") / "foo" ? {"bar": "qux"}
assert $foo == "https://example.com/foo?bar=qux"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L487" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L487" target="_blank">Edit</a> </dd> </div> </div> <div id="combine-procs-all"> <div id="combine,Uri,Uri"> <dt><pre data-language="nim">func combine(base: Uri; reference: Uri): Uri {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Combines a base URI with a reference URI.</p> <p>This uses the algorithm specified in <a href="http://tools.ietf.org/html/rfc3986#section-5.2.2">section 5.2.2 of RFC 3986</a>.</p> <p>This means that the slashes inside the base URIs path as well as reference URIs path affect the resulting URI.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#/,Uri,string">/ func</a> for building URIs</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let foo = combine(parseUri("https://nim-lang.org/foo/bar"), parseUri("/baz"))
assert foo.path == "/baz"
let bar = combine(parseUri("https://nim-lang.org/foo/bar"), parseUri("baz"))
assert bar.path == "/foo/baz"
let qux = combine(parseUri("https://nim-lang.org/foo/bar/"), parseUri("baz"))
assert qux.path == "/foo/bar/baz"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L381" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L381" target="_blank">Edit</a> </dd> </div> <div id="combine,varargs[Uri]"> <dt><pre data-language="nim">func combine(uris: varargs[Uri]): Uri {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Combines multiple URIs together.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#/,Uri,string">/ func</a> for building URIs</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let foo = combine(parseUri("https://nim-lang.org/"), parseUri("docs/"),
    parseUri("manual.html"))
assert foo.hostname == "nim-lang.org"
assert foo.path == "/docs/manual.html"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L432" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L432" target="_blank">Edit</a> </dd> </div> </div> <div id="decodeUrl-procs-all"> <div id="decodeUrl,string"> <dt><pre data-language="nim">func decodeUrl(s: string; decodePlus = true): string {....raises: [], tags: [],
    forbids: [].}</pre></dt> <dd> <p>Decodes a URL according to RFC3986.</p> <p>This means that any <code><span class="Operator">%</span><span class="Identifier">xx</span></code> (where <code><span class="Identifier">xx</span></code> denotes a hexadecimal value) are converted to the character with ordinal number <code><span class="Identifier">xx</span></code>, and every other character is carried over. If <code><span class="Identifier">xx</span></code> is not a valid hexadecimal value, it is left intact.</p> <p>As a special rule, when the value of <code><span class="Identifier">decodePlus</span></code> is true, <code><span class="Operator">+</span></code> characters are converted to a space.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#encodeUrl,string">encodeUrl func</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert decodeUrl("https%3A%2F%2Fnim-lang.org") == "https://nim-lang.org"
assert decodeUrl("https%3A%2F%2Fnim-lang.org%2Fthis+is+a+test") == "https://nim-lang.org/this is a test"
assert decodeUrl("https%3A%2F%2Fnim-lang.org%2Fthis%20is%20a%20test",
    false) == "https://nim-lang.org/this is a test"
assert decodeUrl("abc%xyz") == "abc%xyz"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L93" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L93" target="_blank">Edit</a> </dd> </div> </div> <div id="encodeQuery-procs-all"> <div id="encodeQuery,openArray[],char"> <dt><pre data-language="nim">func encodeQuery(query: openArray[(string, string)]; usePlus = true;
                 omitEq = true; sep = '&amp;'): string {....raises: [], tags: [],
    forbids: [].}</pre></dt> <dd> <p>Encodes a set of (key, value) parameters into a URL query string.</p> <p>Every (key, value) pair is URL-encoded and written as <code><span class="Identifier">key</span><span class="Operator">=</span><span class="Identifier">value</span></code>. If the value is an empty string then the <code><span class="Operator">=</span></code> is omitted, unless <code><span class="Identifier">omitEq</span></code> is false. The pairs are joined together by the <code><span class="Identifier">sep</span></code> character.</p> <p>The <code><span class="Identifier">usePlus</span></code> parameter is passed down to the <code><span class="Identifier">encodeUrl</span></code> function that is used for the URL encoding of the string values.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#encodeUrl,string">encodeUrl func</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert encodeQuery({: }) == ""
assert encodeQuery({"a": "1", "b": "2"}) == "a=1&amp;b=2"
assert encodeQuery({"a": "1", "b": ""}) == "a=1&amp;b"
assert encodeQuery({"a": "1", "b": ""}, omitEq = false, sep = ';') == "a=1;b="</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L130" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L130" target="_blank">Edit</a> </dd> </div> </div> <div id="encodeUrl-procs-all"> <div id="encodeUrl,string"> <dt><pre data-language="nim">func encodeUrl(s: string; usePlus = true): string {....raises: [], tags: [],
    forbids: [].}</pre></dt> <dd> <p>Encodes a URL according to RFC3986.</p> <p>This means that characters in the set <code><span class="Punctuation">{</span><span class="CharLit">'a'</span><span class="Operator">..</span><span class="CharLit">'z'</span><span class="Punctuation">,</span> <span class="CharLit">'A'</span><span class="Operator">..</span><span class="CharLit">'Z'</span><span class="Punctuation">,</span> <span class="CharLit">'0'</span><span class="Operator">..</span><span class="CharLit">'9'</span><span class="Punctuation">,</span> <span class="CharLit">'-'</span><span class="Punctuation">,</span> <span class="CharLit">'.'</span><span class="Punctuation">,</span> <span class="CharLit">'_'</span><span class="Punctuation">,</span> <span class="CharLit">'~'</span><span class="Punctuation">}</span></code> are carried over to the result. All other characters are encoded as <code><span class="Operator">%</span><span class="Identifier">xx</span></code> where <code><span class="Identifier">xx</span></code> denotes its hexadecimal value.</p> <p>As a special rule, when the value of <code><span class="Identifier">usePlus</span></code> is true, spaces are encoded as <code><span class="Operator">+</span></code> instead of <code><span class="Operator">%</span><span class="DecNumber">20</span></code>.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="#decodeUrl,string">decodeUrl func</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert encodeUrl("https://nim-lang.org") == "https%3A%2F%2Fnim-lang.org"
assert encodeUrl("https://nim-lang.org/this is a test") == "https%3A%2F%2Fnim-lang.org%2Fthis+is+a+test"
assert encodeUrl("https://nim-lang.org/this is a test", false) == "https%3A%2F%2Fnim-lang.org%2Fthis%20is%20a%20test"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L64" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L64" target="_blank">Edit</a> </dd> </div> </div> <div id="getDataUri-procs-all"> <div id="getDataUri,string,string,string"> <dt><pre data-language="nim">proc getDataUri(data, mime: string; encoding = "utf-8"): string {....raises: [],
    tags: [], forbids: [].}</pre></dt> <dd> <p>Convenience proc for <code><span class="Identifier">base64</span><span class="Operator">.</span><span class="Identifier">encode</span></code> returns a standard Base64 Data URI (RFC-2397)</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="mimetypes.html">mimetypes</a> for <code><span class="Identifier">mime</span></code> argument</li> <li><a href="https://tools.ietf.org/html/rfc2397">https://tools.ietf.org/html/rfc2397</a></li> <li><a href="https://en.wikipedia.org/wiki/Data_URI_scheme">https://en.wikipedia.org/wiki/Data_URI_scheme</a></li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">static: assert getDataUri("Nim", "text/plain") == "data:text/plain;charset=utf-8;base64,Tmlt"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L555" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L555" target="_blank">Edit</a> </dd> </div> </div> <div id="initUri-procs-all"> <div id="initUri"> <dt><pre data-language="nim">func initUri(isIpv6 = false): Uri {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Initializes a URI with <code><span class="Identifier">scheme</span></code>, <code><span class="Identifier">username</span></code>, <code><span class="Identifier">password</span></code>, <code><span class="Identifier">hostname</span></code>, <code><span class="Identifier">port</span></code>, <code><span class="Identifier">path</span></code>, <code><span class="Identifier">query</span></code>, <code><span class="Identifier">anchor</span></code> and <code><span class="Identifier">isIpv6</span></code>.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#Uri">Uri type</a> for available fields in the URI type</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var uri2 = initUri(isIpv6 = true)
uri2.scheme = "tcp"
uri2.hostname = "2001:0db8:85a3:0000:0000:8a2e:0370:7334"
uri2.port = "8080"
assert $uri2 == "tcp://[2001:0db8:85a3:0000:0000:8a2e:0370:7334]:8080"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L249" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L249" target="_blank">Edit</a> </dd> </div> </div> <div id="isAbsolute-procs-all"> <div id="isAbsolute,Uri"> <dt><pre data-language="nim">func isAbsolute(uri: Uri): bool {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Returns true if URI is absolute, false otherwise. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">assert parseUri("https://nim-lang.org").isAbsolute
assert not parseUri("nim-lang").isAbsolute</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L446" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L446" target="_blank">Edit</a> </dd> </div> </div> <div id="parseUri-procs-all"> <div id="parseUri,string"> <dt><pre data-language="nim">func parseUri(uri: string): Uri {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Parses a URI and returns it.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#Uri">Uri type</a> for available fields in the URI type</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let res = parseUri("ftp://Username:Password@Hostname")
assert res.username == "Username"
assert res.password == "Password"
assert res.scheme == "ftp"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L319" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L319" target="_blank">Edit</a> </dd> </div> <div id="parseUri,string,Uri"> <dt><pre data-language="nim">func parseUri(uri: string; result: var Uri) {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> <p>Parses a URI. The <code><span class="Identifier">result</span></code> variable will be cleared before.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li>
<a href="#Uri">Uri type</a> for available fields in the URI type</li> <li>
<a href="#initUri">initUri func</a> for initializing a URI</li> </ul> <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var res = initUri()
parseUri("https://nim-lang.org/docs/manual.html", res)
assert res.scheme == "https"
assert res.hostname == "nim-lang.org"
assert res.path == "/docs/manual.html"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L271" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L271" target="_blank">Edit</a> </dd> </div> </div> <div id="uriParseError-procs-all"> <div id="uriParseError,string"> <dt><pre data-language="nim">proc uriParseError(msg: string) {.noreturn, ...raises: [UriParseError], tags: [],
                                  forbids: [].}</pre></dt> <dd> Raises a <code><span class="Identifier">UriParseError</span></code> exception with message <code><span class="Identifier">msg</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L60" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L60" target="_blank">Edit</a> </dd> </div> </div> </dl>   <h2 id="15">Iterators</h2> <dl> <div id="decodeQuery-iterators-all"> <div id="decodeQuery.i,string,char"> <dt><pre data-language="nim">iterator decodeQuery(data: string; sep = '&amp;'): tuple[key, value: string] {.
    ...raises: [], tags: [], forbids: [].}</pre></dt> <dd> Reads and decodes the query string <code><span class="Identifier">data</span></code> and yields the <code><span class="Punctuation">(</span><span class="Identifier">key</span><span class="Punctuation">,</span> <span class="Identifier">value</span><span class="Punctuation">)</span></code> pairs the data consists of. If compiled with <code><span class="Operator">-</span><span class="Identifier">d</span><span class="Punctuation">:</span><span class="Identifier">nimLegacyParseQueryStrict</span></code>, a <code><span class="Identifier">UriParseError</span></code> is raised when there is an unencoded <code><span class="Operator">=</span></code> character in a decoded value, which was the behavior in Nim &lt; 1.5.1. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">import std/sequtils
assert toSeq(decodeQuery("foo=1&amp;bar=2=3")) == @[("foo", "1"), ("bar", "2=3")]
assert toSeq(decodeQuery("foo=1;bar=2=3", ';')) == @[("foo", "1"), ("bar", "2=3")]
assert toSeq(decodeQuery("&amp;a&amp;=b&amp;=&amp;&amp;")) == @[("", ""), ("a", ""), ("", "b"), ("", ""), ("", "")]</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/uri.nim#L159" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/uri.nim#L159" target="_blank">Edit</a> </dd> </div> </div> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/uri.html" class="_attribution-link">https://nim-lang.org/docs/uri.html</a>
  </p>
</div>
