<h1 class="title">std/ropes</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L1" target="_blank">Edit</a>  <p class="module-desc">This module contains support for a <span id="rope_1">rope</span> data type. Ropes can represent very long strings efficiently; in particular, concatenation is done in O(1) instead of O(n). They are essentially concatenation trees that are only flattened when converting to a native Nim string. The empty string is represented by <code><span class="Keyword">nil</span></code>. Ropes are immutable and subtrees can be shared without copying. Leaves can be cached for better memory efficiency at the cost of runtime efficiency.</p>  <h2 id="6">Imports</h2> <dl> <a href="streams.html">streams</a> </dl>   <h2 id="7">Types</h2> <dl> <div id="Rope"> <dt><pre data-language="nim">Rope {.acyclic.} = ref object</pre></dt> <dd> A rope data type. The empty rope is represented by <code><span class="Keyword">nil</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L35" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L35" target="_blank">Edit</a> </dd> </div> </dl>   <h2 id="12">Procs</h2> <dl> <div id="$-procs-all"> <div id="$,Rope"> <dt><pre data-language="nim">proc `$`(r: Rope): string {....gcsafe, extern: "nroToString", raises: [], tags: [],
                            forbids: [].}</pre></dt> <dd> Converts a rope back to a string. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L291" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L291" target="_blank">Edit</a> </dd> </div> </div> <div id="%-procs-all"> <div id="%,string,openArray[Rope]"> <dt><pre data-language="nim">proc `%`(frmt: string; args: openArray[Rope]): Rope {....gcsafe,
    extern: "nroFormat", raises: [ValueError], tags: [], forbids: [].}</pre></dt> <dd> <code><span class="Operator">%</span></code> substitution operator for ropes. Does not support the <code><span class="Operator">$</span><span class="Identifier">identifier</span></code> nor <code><span class="Operator">$</span><span class="Punctuation">{</span><span class="Identifier">identifier</span><span class="Punctuation">}</span></code> notations. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r1 = "$1 $2 $3" % [rope("Nim"), rope("is"), rope("a great language")]
doAssert $r1 == "Nim is a great language"

let r2 = "$# $# $#" % [rope("Nim"), rope("is"), rope("a great language")]
doAssert $r2 == "Nim is a great language"

let r3 = "${1} ${2} ${3}" % [rope("Nim"), rope("is"), rope("a great language")]
doAssert $r3 == "Nim is a great language"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L296" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L296" target="_blank">Edit</a> </dd> </div> </div> <div id="&amp;-procs-all"> <div id="&amp;,Rope,Rope"> <dt><pre data-language="nim">proc `&amp;`(a, b: Rope): Rope {....gcsafe, extern: "nroConcRopeRope", raises: [],
                             tags: [], forbids: [].}</pre></dt> <dd> The concatenation operator for ropes. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope("Hello, ") &amp; rope("Nim!")
doAssert $r == "Hello, Nim!"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L175" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L175" target="_blank">Edit</a> </dd> </div> <div id="&amp;,openArray[Rope]"> <dt><pre data-language="nim">proc `&amp;`(a: openArray[Rope]): Rope {....gcsafe, extern: "nroConcOpenArray",
                                     raises: [], tags: [], forbids: [].}</pre></dt> <dd> The concatenation operator for an <code><span class="Identifier">openArray</span></code> of ropes. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = &amp;[rope("Hello, "), rope("Nim"), rope("!")]
doAssert $r == "Hello, Nim!"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L207" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L207" target="_blank">Edit</a> </dd> </div> <div id="&amp;,Rope,string"> <dt><pre data-language="nim">proc `&amp;`(a: Rope; b: string): Rope {....gcsafe, extern: "nroConcRopeStr",
                                     raises: [], tags: [], forbids: [].}</pre></dt> <dd> The concatenation operator for ropes. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope("Hello, ") &amp; "Nim!"
doAssert $r == "Hello, Nim!"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L191" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L191" target="_blank">Edit</a> </dd> </div> <div id="&amp;,string,Rope"> <dt><pre data-language="nim">proc `&amp;`(a: string; b: Rope): Rope {....gcsafe, extern: "nroConcStrRope",
                                     raises: [], tags: [], forbids: [].}</pre></dt> <dd> The concatenation operator for ropes. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = "Hello, " &amp; rope("Nim!")
doAssert $r == "Hello, Nim!"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L199" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L199" target="_blank">Edit</a> </dd> </div> </div> <div id="[]-procs-all"> <div id="[],Rope,int"> <dt><pre data-language="nim">proc `[]`(r: Rope; i: int): char {....gcsafe, extern: "nroCharAt", raises: [],
                                   tags: [], forbids: [].}</pre></dt> <dd> Returns the character at position <code><span class="Identifier">i</span></code> in the rope <code><span class="Identifier">r</span></code>. This is quite expensive! Worst-case: O(n). If <code><span class="Identifier">i</span> <span class="Operator">&gt;=</span> <span class="Identifier">r</span><span class="Operator">.</span><span class="Identifier">len</span> <span class="Keyword">or</span> <span class="Identifier">i</span> <span class="Operator">&lt;</span> <span class="DecNumber">0</span></code>, <code><span class="Operator">\</span><span class="DecNumber">0</span></code> is returned. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope("Hello, Nim!")

doAssert r[0] == 'H'
doAssert r[7] == 'N'
doAssert r[22] == '\0'</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L233" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L233" target="_blank">Edit</a> </dd> </div> </div> <div id="add-procs-all"> <div id="add,Rope,Rope"> <dt><pre data-language="nim">proc add(a: var Rope; b: Rope) {....gcsafe, extern: "nro$1Rope", raises: [],
                                 tags: [], forbids: [].}</pre></dt> <dd> Adds <code><span class="Identifier">b</span></code> to the rope <code><span class="Identifier">a</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var r = rope("Hello, ")
r.add(rope("Nim!"))
doAssert $r == "Hello, Nim!"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L215" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L215" target="_blank">Edit</a> </dd> </div> <div id="add,Rope,string"> <dt><pre data-language="nim">proc add(a: var Rope; b: string) {....gcsafe, extern: "nro$1Str", raises: [],
                                   tags: [], forbids: [].}</pre></dt> <dd> Adds <code><span class="Identifier">b</span></code> to the rope <code><span class="Identifier">a</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var r = rope("Hello, ")
r.add("Nim!")
doAssert $r == "Hello, Nim!"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L224" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L224" target="_blank">Edit</a> </dd> </div> </div> <div id="addf-procs-all"> <div id="addf,Rope,string,openArray[Rope]"> <dt><pre data-language="nim">proc addf(c: var Rope; frmt: string; args: openArray[Rope]) {....gcsafe,
    extern: "nro$1", raises: [ValueError], tags: [], forbids: [].}</pre></dt> <dd> Shortcut for <code><span class="Identifier">add</span><span class="Punctuation">(</span><span class="Identifier">c</span><span class="Punctuation">,</span> <span class="Identifier">frmt</span> <span class="Operator">%</span> <span class="Identifier">args</span><span class="Punctuation">)</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">var r = rope("Dash: ")
r.addf "$1 $2 $3", [rope("Nim"), rope("is"), rope("a great language")]
doAssert $r == "Dash: Nim is a great language"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L349" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L349" target="_blank">Edit</a> </dd> </div> </div> <div id="disableCache-procs-all"> <div id="disableCache"> <dt><pre data-language="nim">proc disableCache() {....gcsafe, extern: "nro$1", raises: [], tags: [], forbids: [].}</pre></dt> <dd> The cache is discarded and disabled. The GC will reuse its used memory. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L170" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L170" target="_blank">Edit</a> </dd> </div> </div> <div id="enableCache-procs-all"> <div id="enableCache"> <dt><pre data-language="nim">proc enableCache() {....gcsafe, extern: "nro$1", raises: [], tags: [], forbids: [].}</pre></dt> <dd> Enables the caching of leaves. This reduces the memory footprint at the cost of runtime efficiency. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L165" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L165" target="_blank">Edit</a> </dd> </div> </div> <div id="equalsFile-procs-all"> <div id="equalsFile,Rope,File"> <dt><pre data-language="nim">proc equalsFile(r: Rope; f: File): bool {....gcsafe, extern: "nro$1File",
    raises: [IOError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Returns true if the contents of the file <code><span class="Identifier">f</span></code> equal <code><span class="Identifier">r</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L362" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L362" target="_blank">Edit</a> </dd> </div> <div id="equalsFile,Rope,string"> <dt><pre data-language="nim">proc equalsFile(r: Rope; filename: string): bool {....gcsafe, extern: "nro$1Str",
    raises: [IOError], tags: [ReadIOEffect], forbids: [].}</pre></dt> <dd> Returns true if the contents of the file <code><span class="Identifier">f</span></code> equal <code><span class="Identifier">r</span></code>. If <code><span class="Identifier">f</span></code> does not exist, false is returned. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L389" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L389" target="_blank">Edit</a> </dd> </div> </div> <div id="len-procs-all"> <div id="len,Rope"> <dt><pre data-language="nim">proc len(a: Rope): int {....gcsafe, extern: "nro$1", raises: [], tags: [],
                         forbids: [].}</pre></dt> <dd> The rope's length. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L49" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L49" target="_blank">Edit</a> </dd> </div> </div> <div id="rope-procs-all"> <div id="rope,BiggestFloat"> <dt><pre data-language="nim">proc rope(f: BiggestFloat): Rope {....gcsafe, extern: "nro$1BiggestFloat",
                                   raises: [], tags: [], forbids: [].}</pre></dt> <dd> Converts a float to a rope. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope(4.29)
doAssert $r == "4.29"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L157" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L157" target="_blank">Edit</a> </dd> </div> <div id="rope,BiggestInt"> <dt><pre data-language="nim">proc rope(i: BiggestInt): Rope {....gcsafe, extern: "nro$1BiggestInt", raises: [],
                                 tags: [], forbids: [].}</pre></dt> <dd> Converts an int to a rope. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope(429)
doAssert $r == "429"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L149" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L149" target="_blank">Edit</a> </dd> </div> <div id="rope,string"> <dt><pre data-language="nim">proc rope(s: string = ""): Rope {....gcsafe, extern: "nro$1Str", raises: [],
                                  tags: [], forbids: [].}</pre></dt> <dd> Converts a string to a rope. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope("I'm a rope")
doAssert $r == "I'm a rope"</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L130" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L130" target="_blank">Edit</a> </dd> </div> </div> <div id="write-procs-all"> <div id="write,File,Rope"> <dt><pre data-language="nim">proc write(f: File; r: Rope) {....gcsafe, extern: "nro$1", raises: [IOError],
                               tags: [WriteIOEffect], forbids: [].}</pre></dt> <dd> Writes a rope to a file. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L283" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L283" target="_blank">Edit</a> </dd> </div> <div id="write,Stream,Rope"> <dt><pre data-language="nim">proc write(s: Stream; r: Rope) {....gcsafe, extern: "nroWriteStream",
                                 raises: [IOError, OSError],
                                 tags: [WriteIOEffect], forbids: [].}</pre></dt> <dd> Writes a rope to a stream. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L287" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L287" target="_blank">Edit</a> </dd> </div> </div> </dl>   <h2 id="15">Iterators</h2> <dl> <div id="items-iterators-all"> <div id="items.i,Rope"> <dt><pre data-language="nim">iterator items(r: Rope): char {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Iterates over any character in the rope <code><span class="Identifier">r</span></code>. <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L278" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L278" target="_blank">Edit</a> </dd> </div> </div> <div id="leaves-iterators-all"> <div id="leaves.i,Rope"> <dt><pre data-language="nim">iterator leaves(r: Rope): string {....raises: [], tags: [], forbids: [].}</pre></dt> <dd> Iterates over any leaf string in the rope <code><span class="Identifier">r</span></code>. <p><strong class="examples_text">Example:</strong></p> <pre class="listing" data-language="nim">let r = rope("Hello") &amp; rope(", Nim!")
let s = ["Hello", ", Nim!"]
var index = 0
for leave in r.leaves:
  doAssert leave == s[index]
  inc(index)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-2-0/lib/pure/ropes.nim#L257" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/ropes.nim#L257" target="_blank">Edit</a> </dd> </div> </div> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/ropes.html" class="_attribution-link">https://nim-lang.org/docs/ropes.html</a>
  </p>
</div>
