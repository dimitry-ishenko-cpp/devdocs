<h1 class="title">osproc</h1>  
<p>This module implements an advanced facility for executing OS processes and process communication.</p> <p><strong>See also:</strong></p> <ul class="simple">
<li><a href="os.html">os module</a></li> <li><a href="streams.html">streams module</a></li> <li><a href="memfiles.html">memfiles module</a></li> </ul>  <h2 id="6">Imports</h2> <dl> <a href="strutils.html">strutils</a>, <a href="os.html">os</a>, <a href="strtabs.html">strtabs</a>, <a href="streams.html">streams</a>, <a href="cpuinfo.html">cpuinfo</a>, <a href="streamwrapper.html">streamwrapper</a>, <a href="since.html">since</a>, <a href="posix.html">posix</a>, <a href="times.html">times</a> </dl>  <h2 id="7">Types</h2> <dl>  <dt><pre id="ProcessOption" data-language="nim">ProcessOption = enum
  poEchoCmd,                ## Echo the command before execution.
  poUsePath, ## Asks system to search for executable using PATH environment
              ## variable.
              ## On Windows, this is the default.
  poEvalCommand, ## Pass `command` directly to the shell, without quoting.
                  ## Use it only if `command` comes from trusted source.
  poStdErrToStdOut,         ## Merge stdout and stderr to the stdout stream.
  poParentStreams,          ## Use the parent's streams.
  poInteractive, ## Optimize the buffer handling for responsiveness for
                  ## UI applications. Currently this only affects
                  ## Windows: Named pipes are used so that you can peek
                  ## at the process' output streams.
  poDaemon                   ## Windows: The program creates no Window.
                             ## Unix: Start the program as a daemon. This is still
                             ## work in progress!</pre></dt> <dd> Options that can be passed to <a href="#startProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">startProcess proc</a>. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L35" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L35" target="_blank">Edit</a> </dd>  <dt><pre id="Process">Process = ref ProcessObj</pre></dt> <dd> Represents an operating system process. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L67" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L67" target="_blank">Edit</a> </dd> </dl>  <h2 id="10">Consts</h2> <dl>  <dt><pre id="poDemon">poDemon = poDaemon</pre></dt> <dd> Nim versions before 0.20 used the wrong spelling ("demon"). Now <code>ProcessOption</code> uses the correct spelling ("daemon"), and this is needed just for backward compatibility. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L69" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L69" target="_blank">Edit</a> </dd> </dl>  <h2 id="12">Procs</h2> <dl>  <dt><pre id="processID%2CProcess" data-language="nim">proc processID(p: Process): int {...}{.gcsafe, extern: "nosp$1", raises: [], tags: [].}</pre></dt> <dd> <p>Returns <code>p</code>'s process ID.</p> <p>See also:</p> <ul class="simple">
<li><a href="os.html#getCurrentProcessId">os.getCurrentProcessId proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L205" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L205" target="_blank">Edit</a> </dd>  <dt><pre id="inputHandle%2CProcess" data-language="nim">proc inputHandle(p: Process): FileHandle {...}{.gcsafe, extern: "nosp$1", tags: [],
    raises: [].}</pre></dt> <dd> <p>Returns <code>p</code>'s input file handle for writing to.</p> <p><strong>WARNING</strong>: The returned <code>FileHandle</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#outputHandle,Process">outputHandle proc</a></li> <li><a href="#errorHandle,Process">errorHandle proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L290" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L290" target="_blank">Edit</a> </dd>  <dt><pre id="outputHandle%2CProcess" data-language="nim">proc outputHandle(p: Process): FileHandle {...}{.gcsafe, extern: "nosp$1", tags: [],
    raises: [].}</pre></dt> <dd> <p>Returns <code>p</code>'s output file handle for reading from.</p> <p><strong>WARNING</strong>: The returned <code>FileHandle</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#inputHandle,Process">inputHandle proc</a></li> <li><a href="#errorHandle,Process">errorHandle proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L302" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L302" target="_blank">Edit</a> </dd>  <dt><pre id="errorHandle%2CProcess" data-language="nim">proc errorHandle(p: Process): FileHandle {...}{.gcsafe, extern: "nosp$1", tags: [],
    raises: [].}</pre></dt> <dd> <p>Returns <code>p</code>'s error file handle for reading from.</p> <p><strong>WARNING</strong>: The returned <code>FileHandle</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#inputHandle,Process">inputHandle proc</a></li> <li><a href="#outputHandle,Process">outputHandle proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L314" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L314" target="_blank">Edit</a> </dd>  <dt><pre id="countProcessors" data-language="nim">proc countProcessors(): int {...}{.gcsafe, extern: "nosp$1", raises: [], tags: [].}</pre></dt> <dd> Returns the number of the processors/cores the machine has. Returns 0 if it cannot be detected. It is implemented just calling <code>cpuinfo.countProcessors</code>. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L326" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L326" target="_blank">Edit</a> </dd>  <dt><pre id="execProcesses%2CopenArray%5Bstring%5D%2Cproc%28int%29%2Cproc%28int%2CProcess%29" data-language="nim">proc execProcesses(cmds: openArray[string];
                   options = {poStdErrToStdOut, poParentStreams};
                   n = countProcessors(); beforeRunEvent: proc (idx: int) = nil;
                   afterRunEvent: proc (idx: int; p: Process) = nil): int {...}{.
    gcsafe, extern: "nosp$1",
    tags: [ExecIOEffect, TimeEffect, ReadEnvEffect, RootEffect],
    raises: [Exception, OSError].}</pre></dt> <dd> <p>Executes the commands <code>cmds</code> in parallel. Creates <code>n</code> processes that execute in parallel.</p> <p>The highest (absolute) return value of all processes is returned. Runs <code>beforeRunEvent</code> before running each command.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L332" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L332" target="_blank">Edit</a> </dd>  <dt><pre id="readLines%2CProcess" data-language="nim">proc readLines(p: Process): (seq[string], int) {...}{.
    raises: [Exception, IOError, OSError], tags: [ReadIOEffect].}</pre></dt> <dd> <p>Convenience function for working with <code>startProcess</code> to read data from a background process.</p> <p>See also:</p> <ul class="simple">
<li><a href="#lines.i,Process">lines iterator</a></li> </ul> <p>Example:</p> <pre class="listing" data-language="nim">const opts = {poUsePath, poDaemon, poStdErrToStdOut}
var ps: seq[Process]
for prog in ["a", "b"]: # run 2 progs in parallel
  ps.add startProcess("nim", "", ["r", prog], nil, opts)
for p in ps:
  let (lines, exCode) = p.readLines
  if exCode != 0:
    for line in lines: echo line
  p.close</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L478" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L478" target="_blank">Edit</a> </dd>  <dt><pre id="execProcess%2Cstring%2Cstring%2CopenArray%5Bstring%5D%2CStringTableRef%2Cset%5BProcessOption%5D" data-language="nim">proc execProcess(command: string; workingDir: string = "";
                 args: openArray[string] = []; env: StringTableRef = nil;
    options: set[ProcessOption] = {poStdErrToStdOut, poUsePath, poEvalCommand}): TaintedString {...}{.
    gcsafe, extern: "nosp$1", tags: [ExecIOEffect, ReadIOEffect, RootEffect],
    raises: [Exception, IOError, OSError].}</pre></dt> <dd> <p>A convenience procedure that executes <code>command</code> with <code>startProcess</code> and returns its output as a string.</p> <p><strong>WARNING:</strong> This function uses <code>poEvalCommand</code> by default for backwards compatibility. Make sure to pass options explicitly.</p> <p>See also:</p> <ul class="simple">
<li><a href="#startProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">startProcess proc</a></li> <li><a href="#execProcesses,openArray%5Bstring%5D,proc(int),proc(int,Process)">execProcesses proc</a></li> <li><a href="#execCmd,string">execCmd proc</a></li> </ul> <p>Example:</p> <pre class="listing" data-language="nim">let outp = execProcess("nim", args=["c", "-r", "mytestfile.nim"], options={poUsePath})
let outp_shell = execProcess("nim c -r mytestfile.nim")
# Note: outp may have an interleave of text from the nim compile
# and any output from mytestfile when it runs</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L501" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L501" target="_blank">Edit</a> </dd>  <dt><pre id="startProcess%2Cstring%2Cstring%2CopenArray%5Bstring%5D%2CStringTableRef%2Cset%5BProcessOption%5D" data-language="nim">proc startProcess(command: string; workingDir: string = "";
                  args: openArray[string] = []; env: StringTableRef = nil;
                  options: set[ProcessOption] = {poStdErrToStdOut}): owned(
    Process) {...}{.gcsafe, extern: "nosp$1",
               tags: [ExecIOEffect, ReadEnvEffect, RootEffect],
               raises: [OSError, Exception].}</pre></dt> <dd> <p>Starts a process. <code>Command</code> is the executable file, <code>workingDir</code> is the process's working directory. If <code>workingDir == ""</code> the current directory is used (default). <code>args</code> are the command line arguments that are passed to the process. On many operating systems, the first command line argument is the name of the executable. <code>args</code> should <em>not</em> contain this argument! <code>env</code> is the environment that will be passed to the process. If <code>env == nil</code> (default) the environment is inherited of the parent process. <code>options</code> are additional flags that may be passed to <code>startProcess</code>. See the documentation of <a href="#ProcessOption">ProcessOption</a> for the meaning of these flags.</p> <p>You need to <a href="#close,Process">close</a> the process when done.</p> <p>Note that you can't pass any <code>args</code> if you use the option <code>poEvalCommand</code>, which invokes the system shell to run the specified <code>command</code>. In this situation you have to concatenate manually the contents of <code>args</code> to <code>command</code> carefully escaping/quoting any special characters, since it will be passed <em>as is</em> to the system shell. Each system/shell may feature different escaping rules, so try to avoid this kind of shell invocation if possible as it leads to non portable software.</p> <p>Return value: The newly created process object. Nil is never returned, but <code>OSError</code> is raised in case of an error.</p> <p>See also:</p> <ul class="simple">
<li><a href="#execProcesses,openArray%5Bstring%5D,proc(int),proc(int,Process)">execProcesses proc</a></li> <li><a href="#execProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">execProcess proc</a></li> <li><a href="#execCmd,string">execCmd proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L960" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L960" target="_blank">Edit</a> </dd>  <dt><pre id="close%2CProcess" data-language="nim">proc close(p: Process) {...}{.gcsafe, extern: "nosp$1", tags: [WriteIOEffect],
                         raises: [Exception, IOError, OSError].}</pre></dt> <dd> <p>When the process has finished executing, cleanup related handles.</p> <p><strong>WARNING:</strong> If the process has not finished executing, this will forcibly terminate the process. Doing so may result in zombie processes and <a href="http://stackoverflow.com/questions/27021641/how-to-fix-request-failed-on-channel-0">pty leaks</a>.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1184" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1184" target="_blank">Edit</a> </dd>  <dt><pre id="suspend%2CProcess" data-language="nim">proc suspend(p: Process) {...}{.gcsafe, extern: "nosp$1", tags: [], raises: [OSError].}</pre></dt> <dd> <p>Suspends the process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#resume,Process">resume proc</a></li> <li><a href="#terminate,Process">terminate proc</a></li> <li><a href="#kill,Process">kill proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1201" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1201" target="_blank">Edit</a> </dd>  <dt><pre id="resume%2CProcess" data-language="nim">proc resume(p: Process) {...}{.gcsafe, extern: "nosp$1", tags: [], raises: [OSError].}</pre></dt> <dd> <p>Resumes the process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#suspend,Process">suspend proc</a></li> <li><a href="#terminate,Process">terminate proc</a></li> <li><a href="#kill,Process">kill proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1204" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1204" target="_blank">Edit</a> </dd>  <dt><pre id="running%2CProcess" data-language="nim">proc running(p: Process): bool {...}{.gcsafe, extern: "nosp$1", tags: [],
                                 raises: [OSError].}</pre></dt> <dd> Returns true if the process <code>p</code> is still running. Returns immediately. <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1207" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1207" target="_blank">Edit</a> </dd>  <dt><pre id="terminate%2CProcess" data-language="nim">proc terminate(p: Process) {...}{.gcsafe, extern: "nosp$1", tags: [],
                             raises: [OSError].}</pre></dt> <dd> <p>Stop the process <code>p</code>.</p> <p>On Posix OSes the procedure sends <code>SIGTERM</code> to the process. On Windows the Win32 API function <code>TerminateProcess()</code> is called to stop the process.</p> <p>See also:</p> <ul class="simple">
<li><a href="#suspend,Process">suspend proc</a></li> <li><a href="#resume,Process">resume proc</a></li> <li><a href="#kill,Process">kill proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1225" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1225" target="_blank">Edit</a> </dd>  <dt><pre id="kill%2CProcess" data-language="nim">proc kill(p: Process) {...}{.gcsafe, extern: "nosp$1", tags: [], raises: [OSError].}</pre></dt> <dd> <p>Kill the process <code>p</code>.</p> <p>On Posix OSes the procedure sends <code>SIGKILL</code> to the process. On Windows <code>kill</code> is simply an alias for <a href="#terminate,Process">terminate()</a>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#suspend,Process">suspend proc</a></li> <li><a href="#resume,Process">resume proc</a></li> <li><a href="#terminate,Process">terminate proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1229" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1229" target="_blank">Edit</a> </dd>  <dt><pre id="waitForExit%2CProcess%2Cint" data-language="nim">proc waitForExit(p: Process; timeout: int = -1): int {...}{.gcsafe, extern: "nosp$1",
    tags: [], raises: [OSError, OSError, ValueError].}</pre></dt> <dd> <p>Waits for the process to finish and returns <code>p</code>'s error code.</p> <p><strong>WARNING</strong>: Be careful when using <code>waitForExit</code> for processes created without <code>poParentStreams</code> because they may fill output buffers, causing deadlock.</p> <p>On posix, if the process has exited because of a signal, 128 + signal number will be returned.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1362" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1362" target="_blank">Edit</a> </dd>  <dt><pre id="peekExitCode%2CProcess" data-language="nim">proc peekExitCode(p: Process): int {...}{.gcsafe, extern: "nosp$1", tags: [],
                                     raises: [].}</pre></dt> <dd> <p>Return <code>-1</code> if the process is still running. Otherwise the process' exit code.</p> <p>On posix, if the process has exited because of a signal, 128 + signal number will be returned.</p> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1468" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1468" target="_blank">Edit</a> </dd>  <dt><pre id="inputStream%2CProcess" data-language="nim">proc inputStream(p: Process): Stream {...}{.gcsafe, extern: "nosp$1", tags: [],
                                       raises: [OSError].}</pre></dt> <dd> <p>Returns <code>p</code>'s input stream for writing to.</p> <p><strong>WARNING</strong>: The returned <code>Stream</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#outputStream,Process">outputStream proc</a></li> <li><a href="#errorStream,Process">errorStream proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1487" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1487" target="_blank">Edit</a> </dd>  <dt><pre id="outputStream%2CProcess" data-language="nim">proc outputStream(p: Process): Stream {...}{.gcsafe, extern: "nosp$1", tags: [],
                                        raises: [OSError].}</pre></dt> <dd> <p>Returns <code>p</code>'s output stream for reading from.</p> <p>You cannot perform peek/write/setOption operations to this stream. Use <a href="#peekableOutputStream,Process">peekableOutputStream proc</a> if you need to peek stream.</p> <p><strong>WARNING</strong>: The returned <code>Stream</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#inputStream,Process">inputStream proc</a></li> <li><a href="#errorStream,Process">errorStream proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1493" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1493" target="_blank">Edit</a> </dd>  <dt><pre id="errorStream%2CProcess" data-language="nim">proc errorStream(p: Process): Stream {...}{.gcsafe, extern: "nosp$1", tags: [],
                                       raises: [OSError].}</pre></dt> <dd> <p>Returns <code>p</code>'s error stream for reading from.</p> <p>You cannot perform peek/write/setOption operations to this stream. Use <a href="#peekableErrorStream,Process">peekableErrorStream proc</a> if you need to peek stream.</p> <p><strong>WARNING</strong>: The returned <code>Stream</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#inputStream,Process">inputStream proc</a></li> <li><a href="#outputStream,Process">outputStream proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1499" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1499" target="_blank">Edit</a> </dd>  <dt><pre id="peekableOutputStream%2CProcess" data-language="nim">proc peekableOutputStream(p: Process): Stream {...}{.gcsafe, extern: "nosp$1",
    tags: [], raises: [OSError].}</pre></dt> <dd> <p>Returns <code>p</code>'s output stream for reading from.</p> <p>You can peek returned stream.</p> <p><strong>WARNING</strong>: The returned <code>Stream</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#outputStream,Process">outputStream proc</a></li> <li><a href="#peekableErrorStream,Process">peekableErrorStream proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1505" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1505" target="_blank">Edit</a> </dd>  <dt><pre id="peekableErrorStream%2CProcess" data-language="nim">proc peekableErrorStream(p: Process): Stream {...}{.gcsafe, extern: "nosp$1",
    tags: [], raises: [OSError].}</pre></dt> <dd> <p>Returns <code>p</code>'s error stream for reading from.</p> <p>You can run peek operation to returned stream.</p> <p><strong>WARNING</strong>: The returned <code>Stream</code> should not be closed manually as it is closed when closing the Process <code>p</code>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#errorStream,Process">errorStream proc</a></li> <li><a href="#peekableOutputStream,Process">peekableOutputStream proc</a></li> </ul> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1511" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1511" target="_blank">Edit</a> </dd>  <dt><pre id="execCmd%2Cstring" data-language="nim">proc execCmd(command: string): int {...}{.gcsafe, extern: "nosp$1", tags: [
    ExecIOEffect, ReadIOEffect, RootEffect], raises: [].}</pre></dt> <dd> <p>Executes <code>command</code> and returns its error code.</p> <p>Standard input, output, error streams are inherited from the calling process. This operation is also often called <span id="system_1">system</span>.</p> <p>See also:</p> <ul class="simple">
<li><a href="#execCmdEx,string,set%5BProcessOption%5D">execCmdEx proc</a></li> <li><a href="#startProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">startProcess proc</a></li> <li><a href="#execProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">execProcess proc</a></li> </ul> <p>Example:</p> <pre class="listing" data-language="nim">let errC = execCmd("nim c -r mytestfile.nim")</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1520" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1520" target="_blank">Edit</a> </dd>  <dt><pre id="hasData%2CProcess" data-language="nim">proc hasData(p: Process): bool {...}{.raises: [], tags: [].}</pre></dt> <dd> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1560" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1560" target="_blank">Edit</a> </dd>  <dt><pre id="execCmdEx%2Cstring%2Cset%5BProcessOption%5D%2CStringTableRef%2Cstring%2Cstring" data-language="nim">proc execCmdEx(command: string;
               options: set[ProcessOption] = {poStdErrToStdOut, poUsePath};
               env: StringTableRef = nil; workingDir = ""; input = ""): tuple[
    output: TaintedString, exitCode: int] {...}{.
    tags: [ExecIOEffect, ReadIOEffect, RootEffect], gcsafe,
    raises: [OSError, Exception, IOError].}</pre></dt> <dd> <p>A convenience proc that runs the <code>command</code>, and returns its <code>output</code> and <code>exitCode</code>. <code>env</code> and <code>workingDir</code> params behave as for <code>startProcess</code>. If <code>input.len &gt; 0</code>, it is passed as stdin.</p> <p>Note: this could block if <code>input.len</code> is greater than your OS's maximum pipe buffer size.</p> <p>See also:</p> <ul class="simple">
<li><a href="#execCmd,string">execCmd proc</a></li> <li><a href="#startProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">startProcess proc</a></li> <li><a href="#execProcess,string,string,openArray%5Bstring%5D,StringTableRef,set%5BProcessOption%5D">execProcess proc</a></li> </ul> <p>Example:</p> <pre class="listing" data-language="nim">var result = execCmdEx("nim r --hints:off -", options = {}, input = "echo 3*4")
import strutils, strtabs
stripLineEnd(result[0]) ## portable way to remove trailing newline, if any
doAssert result == ("12", 0)
doAssert execCmdEx("ls --nonexistant").exitCode != 0
when defined(posix):
  assert execCmdEx("echo $FO", env = newStringTable({"FO": "B"})) == ("B\n", 0)
  assert execCmdEx("echo $PWD", workingDir = "/") == ("/\n", 0)</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L1570" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L1570" target="_blank">Edit</a> </dd> </dl>  <h2 id="15">Iterators</h2> <dl>  <dt><pre id="lines.i%2CProcess" data-language="nim">iterator lines(p: Process): string {...}{.tags: [ReadIOEffect],
                                     raises: [Exception, IOError, OSError].}</pre></dt> <dd> <p>Convenience iterator for working with <code>startProcess</code> to read data from a background process.</p> <p>See also:</p> <ul class="simple">
<li><a href="#readLines,Process">readLines proc</a></li> </ul> <p>Example:</p> <pre class="listing" data-language="nim">const opts = {poUsePath, poDaemon, poStdErrToStdOut}
var ps: seq[Process]
for prog in ["a", "b"]: # run 2 progs in parallel
  ps.add startProcess("nim", "", ["r", prog], nil, opts)
for p in ps:
  var i = 0
  for line in p.lines:
    echo line
    i.inc
    if i &gt; 100: break
  p.close</pre> <a href="https://github.com/nim-lang/Nim/tree/version-1-4/lib/pure/osproc.nim#L449" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/lib/pure/osproc.nim#L449" target="_blank">Edit</a> </dd> </dl>  <h2 id="19">Exports</h2> <dl> <a href="os.html#quoteShell,string"><span class="Identifier">quoteShell</span></a>, <a href="os.html#quoteShellWindows,string"><span class="Identifier">quoteShellWindows</span></a>, <a href="os.html#quoteShellPosix,string"><span class="Identifier">quoteShellPosix</span></a> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2021 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/osproc.html" class="_attribution-link">https://nim-lang.org/docs/osproc.html</a>
  </p>
</div>
