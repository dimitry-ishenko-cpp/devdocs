<h1 class="title">Nim IDE Integration Guide</h1> <a href="https://github.com/nim-lang/Nim/tree/version-2-2/doc/nimsuggest.md#L1" target="_blank">Source</a> <a href="https://github.com/nim-lang/Nim/edit/devel/doc/nimsuggest.md#L1" target="_blank">Edit</a>  
<p>Nim differs from many other compilers in that it is really fast, and being so fast makes it suited to provide external queries for text editors about the source code being written. Through the <code><span class="program">nimsuggest</span></code> tool, any IDE can query a <code>.nim</code> source file and obtain useful information like definition of symbols or suggestions for completion.</p> <p>This document will guide you through the available options. If you want to look at practical examples of nimsuggest support you can look at the <a href="https://github.com/Araq/Nim/wiki/Editor-Support">various editor integrations</a> already available.</p> <h2 id="installation">Installation</h2>
<p>Nimsuggest is part of Nim's core. Build it via:</p> 
<pre class="listing">koch nimsuggest</pre> <h2 id="nimsuggest-invocation">Nimsuggest invocation</h2>
<p>Run it via <code><span class="program">nimsuggest</span> <span class="option">--stdin</span> <span class="option">--debug</span> <span class="Identifier">myproject.nim</span></code>. Nimsuggest is a server that takes queries that are related to <code><span class="Identifier">myproject</span></code>. There is some support so that you can throw random <code>.nim</code> files which are not part of <code><span class="Identifier">myproject</span></code> at Nimsuggest too, but usually the query refer to modules/files that are part of <code><span class="Identifier">myproject</span></code>.</p> <p><code>--stdin</code> means that Nimsuggest reads the query from <code><span class="Identifier">stdin</span></code>. This is great for testing things out and playing with it but for an editor communication via sockets is more reasonable so that is the default. It listens to port 6000 by default.</p> <p>Nimsuggest is basically a frontend for the nim compiler so <code>--path</code> flags and <a href="nimc.html#compiler-usage-configuration-files">config files</a> can be used to specify additional dependencies like <code><span class="program">nimsuggest</span> <span class="option">--stdin</span> <span class="option">--debug</span> <span class="option">--path:</span><span class="option">"dependencies"</span> <span class="Identifier">myproject.nim</span></code>.</p> <h3 id="nimsuggest-invocation-specifying-the-location-of-the-query">Specifying the location of the query</h3>
<p>Nimsuggest then waits for queries to process. A query consists of a cryptic 3 letter "command" <code><span class="Identifier">def</span></code> or <code><span class="Identifier">con</span></code> or <code><span class="Identifier">sug</span></code> or <code><span class="Identifier">use</span></code> followed by a location. A query location consists of:</p> <dl>
<dt><code>file.nim</code></dt> <dd>This is the name of the module or include file the query refers to.</dd> <dt><code>dirtyfile.nim</code></dt> <dd>
<p>This is optional.</p> <p>The <code><span class="Identifier">file</span></code> parameter is enough for static analysis, but IDEs tend to have <em>unsaved buffers</em> where the user may still be in the middle of typing a line. In such situations the IDE can save the current contents to a temporary file and then use the <code>dirtyfile.nim</code> option to tell Nimsuggest that <code>foobar.nim</code> should be taken from <code>temporary/foobar.nim</code>.</p> </dd> <dt><code>line</code></dt> <dd>An integer with the line you are going to query. For the compiler lines start at <strong>1</strong>.</dd> <dt><code>col</code></dt> <dd>An integer with the column you are going to query. For the compiler columns start at <strong>0</strong>.</dd> </dl> <h3 id="nimsuggest-invocation-definitions">Definitions</h3>
<p>The <code><span class="Identifier">def</span></code> Nimsuggest command performs a query about the definition of a specific symbol. If available, Nimsuggest will answer with the type, source file, line/column information and other accessory data if available like a docstring. With this information an IDE can provide the typical <em>Jump to definition</em> where a user puts the cursor on a symbol or uses the mouse to select it and is redirected to the place where the symbol is located.</p> <p>Since Nim is implemented in Nim, one of the nice things of this feature is that any user with an IDE supporting it can quickly jump around the standard library implementation and see exactly what a proc does, learning about the language and seeing real life examples of how to write/implement specific features.</p> <p>Nimsuggest will always answer with a single definition or none if it can't find any valid symbol matching the position of the query.</p> <h3 id="nimsuggest-invocation-suggestions">Suggestions</h3>
<p>The <code><span class="Identifier">sug</span></code> Nimsuggest command performs a query about possible completion symbols at some point in the file.</p> <p>The typical usage scenario for this option is to call it after the user has typed the dot character for <a href="https://nim-lang.org/docs/tut2.html#object-oriented-programming-method-call-syntax">the object oriented call syntax</a>. Nimsuggest will try to return the suggestions sorted first by scope (from innermost to outermost) and then by item name.</p> <h3 id="nimsuggest-invocation-invocation-context">Invocation context</h3>
<p>The <code><span class="Identifier">con</span></code> Nimsuggest command is very similar to the suggestions command, but instead of being used after the user has typed a dot character, this one is meant to be used after the user has typed an opening brace to start typing parameters.</p> <h3 id="nimsuggest-invocation-symbol-usages">Symbol usages</h3>
<p>The <code><span class="Identifier">use</span></code> Nimsuggest command lists all usages of the symbol at a position. IDEs can use this to find all the places in the file where the symbol is used and offer the user to rename it in all places at the same time.</p> <p>For this kind of query the IDE will most likely ignore all the type/signature info provided by Nimsuggest and concentrate on the filename, line and column position of the multiple returned answers.</p> <h2 id="parsing-nimsuggest-output">Parsing nimsuggest output</h2>
<p>Nimsuggest output is always returned on single lines separated by tab characters (<code>\t</code>). The values of each column are:</p> <ol class="simple">
<li>Three characters indicating the type of returned answer (e.g. <code><span class="Identifier">def</span></code> for definition, <code><span class="Identifier">sug</span></code> for suggestion, etc).</li> <li>Type of the symbol. This can be <code><span class="Identifier">skProc</span></code>, <code><span class="Identifier">skLet</span></code>, and just about any of the enums defined in the module <code>compiler/ast.nim</code>.</li> <li>Fully qualified path of the symbol. If you are querying a symbol defined in the <code>proj.nim</code> file, this would have the form <code><span class="Identifier">proj</span><span class="Operator">.</span><span class="Identifier">symbolName</span></code>.</li> <li>Type/signature. For variables and enums this will contain the type of the symbol, for procs, methods and templates this will contain the full unique signature (e.g. <code><span class="Keyword">proc</span> <span class="Punctuation">(</span><span class="Identifier">File</span><span class="Punctuation">)</span></code>).</li> <li>Full path to the file containing the symbol.</li> <li>Line where the symbol is located in the file. Lines start to count at <strong>1</strong>.</li> <li>Column where the symbol is located in the file. Columns start to count at <strong>0</strong>.</li> <li>
<p>Docstring for the symbol if available or the empty string. To differentiate the docstring from end of answer, the docstring is always provided enclosed in double quotes, and if the docstring spans multiple lines, all following lines of the docstring will start with a blank space to align visually with the starting quote.</p> <p>Also, you won't find raw <code>\n</code> characters breaking the one answer per line format. Instead you will need to parse sequences in the form <code>\xHH</code>, where <em>HH</em> is a hexadecimal value (e.g. newlines generate the sequence <code>\x0A</code>).</p> </li> </ol><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2024 Andreas Rumpf<br>Licensed under the MIT License.<br>
    <a href="https://nim-lang.org/docs/nimsuggest.html" class="_attribution-link">https://nim-lang.org/docs/nimsuggest.html</a>
  </p>
</div>
