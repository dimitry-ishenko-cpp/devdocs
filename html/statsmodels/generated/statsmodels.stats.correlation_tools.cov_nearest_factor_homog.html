<h1 id="statsmodels-stats-correlation-tools-cov-nearest-factor-homog">statsmodels.stats.correlation_tools.cov_nearest_factor_homog</h1> <dl class="function"> <dt id="statsmodels.stats.correlation_tools.cov_nearest_factor_homog">
<code>statsmodels.stats.correlation_tools.cov_nearest_factor_homog(cov, rank)</code> <a class="reference internal" href="http://www.statsmodels.org/stable/_modules/statsmodels/stats/correlation_tools.html#cov_nearest_factor_homog"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Approximate an arbitrary square matrix with a factor-structured matrix of the form k*I + XX’.</p> <table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Parameters:</th>
<td class="field-body">
<ul class="first simple"> <li>
<strong>cov</strong> (<em>array-like</em>) – The input array, must be square but need not be positive semidefinite</li> <li>
<strong>rank</strong> (<em>positive integer</em>) – The rank of the fitted factor structure</li> </ul> </td> </tr> <tr>
<th class="field-name">Returns:</th>
<td class="field-body">
 </td> </tr> <tr>
<th class="field-name">Return type:</th>
<td class="field-body">
<p class="first last">A FactoredPSDMatrix instance containing the fitted matrix</p> </td> </tr>  </table> <h4 class="rubric">Notes</h4> <p>This routine is useful if one has an estimated covariance matrix that is not SPD, and the ultimate goal is to estimate the inverse, square root, or inverse square root of the true covariance matrix. The factor structure allows these tasks to be performed without constructing any n x n matrices.</p> <p>The calculations use the fact that if k is known, then X can be determined from the eigen-decomposition of cov - k*I, which can in turn be easily obtained form the eigen-decomposition of <code>cov</code>. Thus the problem can be reduced to a 1-dimensional search for k that does not require repeated eigen-decompositions.</p> <p>If the input matrix is sparse, then cov - k*I is also sparse, so the eigen-decomposition can be done effciciently using sparse routines.</p> <p>The one-dimensional search for the optimal value of k is not convex, so a local minimum could be obtained.</p> <h4 class="rubric">Examples</h4> <p>Hard thresholding a covariance matrix may result in a matrix that is not positive semidefinite. We can approximate a hard thresholded covariance matrix with a PSD matrix as follows:</p> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; np.random.seed(1234)
&gt;&gt;&gt; b = 1.5 - np.random.rand(10, 1)
&gt;&gt;&gt; x = np.random.randn(100,1).dot(b.T) + np.random.randn(100,10)
&gt;&gt;&gt; cov = np.cov(x)
&gt;&gt;&gt; cov = cov * (np.abs(cov) &gt;= 0.3)
&gt;&gt;&gt; rslt = cov_nearest_factor_homog(cov, 3)
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2009&ndash;2012 Statsmodels Developers<br>&copy; 2006&ndash;2008 Scipy Developers<br>&copy; 2006 Jonathan E. Taylor<br>Licensed under the 3-clause BSD License.<br>
    <a href="http://www.statsmodels.org/stable/generated/statsmodels.stats.correlation_tools.cov_nearest_factor_homog.html" class="_attribution-link">http://www.statsmodels.org/stable/generated/statsmodels.stats.correlation_tools.cov_nearest_factor_homog.html</a>
  </p>
</div>
