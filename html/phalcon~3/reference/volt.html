<h1 id="volt-template-engine">Volt: Template Engine</h1> <p>Volt is an ultra-fast and designer friendly templating language written in C for PHP. It provides you a set of helpers to write views in an easy way. Volt is highly integrated with other components of Phalcon, just as you can use it as a stand-alone component in your applications.</p> <div class="figure align-center"> <img alt="../_images/volt.jpg" src="https://docs.phalconphp.com/en/latest/_images/volt.jpg"> </div> <p>Volt is inspired by <a class="reference external" href="http://jinja.pocoo.org/">Jinja</a>, originally created by <a class="reference external" href="https://github.com/mitsuhiko">Armin Ronacher</a>. Therefore many developers will be in familiar territory using the same syntax they have been using with similar template engines. Volt’s syntax and features have been enhanced with more elements and of course with the performance that developers have been accustomed to while working with Phalcon.</p>  <h2 id="introduction">Introduction</h2> <p>Volt views are compiled to pure PHP code, so basically they save the effort of writing PHP code manually:</p> <pre class="highlight-html+jinja" data-language="html">{# app/views/products/show.volt #}

{% block last_products %}

{% for product in products %}
    * Name: {{ product.name|e }}
    {% if product.status === "Active" %}
       Price: {{ product.price + product.taxes/100 }}
    {% endif  %}
{% endfor  %}

{% endblock %}
</pre>   <h2 id="activating-volt">Activating Volt</h2> <p>As with other templating engines, you may register Volt in the view component, using a new extension or reusing the standard .phtml:</p> <pre class="highlight-php" data-language="php">use Phalcon\Mvc\View;
use Phalcon\Mvc\View\Engine\Volt;

// Register Volt as a service
$di-&gt;set(
    "voltService",
    function ($view, $di) {
        $volt = new Volt($view, $di);

        $volt-&gt;setOptions(
            [
                "compiledPath"      =&gt; "../app/compiled-templates/",
                "compiledExtension" =&gt; ".compiled",
            ]
        );

        return $volt;
    }
);

// Register Volt as template engine
$di-&gt;set(
    "view",
    function () {
        $view = new View();

        $view-&gt;setViewsDir("../app/views/");

        $view-&gt;registerEngines(
            [
                ".volt" =&gt; "voltService",
            ]
        );

        return $view;
    }
);
</pre> <p>Use the standard ”.phtml” extension:</p> <pre class="highlight-php" data-language="php">$view-&gt;registerEngines(
    [
        ".phtml" =&gt; "voltService",
    ]
);
</pre> <p>You don’t have to specify the Volt Service in the DI; you can also use the Volt engine with the default settings:</p> <pre class="highlight-php" data-language="php">$view-&gt;registerEngines(
    [
        ".volt" =&gt; "Phalcon\\Mvc\\View\\Engine\\Volt",
    ]
);
</pre> <p>If you do not want to reuse Volt as a service, you can pass an anonymous function to register the engine instead of a service name:</p> <pre class="highlight-php" data-language="php">use Phalcon\Mvc\View;
use Phalcon\Mvc\View\Engine\Volt;

// Register Volt as template engine with an anonymous function
$di-&gt;set(
    "view",
    function () {
        $view = new \Phalcon\Mvc\View();

        $view-&gt;setViewsDir("../app/views/");

        $view-&gt;registerEngines(
            [
                ".volt" =&gt; function ($view, $di) {
                    $volt = new Volt($view, $di);

                    // Set some options here

                    return $volt;
                }
            ]
        );

        return $view;
    }
);
</pre> <p>The following options are available in Volt:</p> <table class="docutils"> <colgroup> <col width="17%"> <col width="78%"> <col width="6%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Option</th> <th class="head">Description</th> <th class="head">Default</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">compiledPath</span></code></td> <td>A writable path where the compiled PHP templates will be placed</td> <td>./</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">compiledExtension</span></code></td> <td>An additional extension appended to the compiled PHP file</td> <td>.php</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">compiledSeparator</span></code></td> <td>Volt replaces the directory separators / and \ by this separator in order to create a single file in the compiled directory</td> <td>%%</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">stat</span></code></td> <td>Whether Phalcon must check if exists differences between the template file and its compiled path</td> <td>true</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">compileAlways</span></code></td> <td>Tell Volt if the templates must be compiled in each request or only when they change</td> <td>false</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">prefix</span></code></td> <td>Allows to prepend a prefix to the templates in the compilation path</td> <td>null</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">autoescape</span></code></td> <td>Enables globally autoescape of HTML</td> <td>false</td> </tr> </tbody> </table> <p>The compilation path is generated according to the above options, if the developer wants total freedom defining the compilation path, an anonymous function can be used to generate it, this function receives the relative path to the template in the views directory. The following examples show how to change the compilation path dynamically:</p> <pre class="highlight-php" data-language="php">// Just append the .php extension to the template path
// leaving the compiled templates in the same directory
$volt-&gt;setOptions(
    [
        "compiledPath" =&gt; function ($templatePath) {
            return $templatePath . ".php";
        }
    ]
);

// Recursively create the same structure in another directory
$volt-&gt;setOptions(
    [
        "compiledPath" =&gt; function ($templatePath) {
            $dirName = dirname($templatePath);

            if (!is_dir("cache/" . $dirName)) {
                mkdir("cache/" . $dirName);
            }

            return "cache/" . $dirName . "/". $templatePath . ".php";
        }
    ]
);
</pre>   <h2 id="basic-usage">Basic Usage</h2> <p>A view consists of Volt code, PHP and HTML. A set of special delimiters is available to enter into Volt mode. <code class="code docutils literal"><span class="pre">{%</span> <span class="pre">...</span> <span class="pre">%}</span></code> is used to execute statements such as for-loops or assign values and <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">...</span> <span class="pre">}}</span></code>, prints the result of an expression to the template.</p> <p>Below is a minimal template that illustrates a few basics:</p> <pre class="highlight-html+jinja" data-language="html">{# app/views/posts/show.phtml #}
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;{{ title }} - An example blog&lt;/title&gt;
    &lt;/head&gt;
    &lt;body&gt;

        {% if show_navigation %}
            &lt;ul id="navigation"&gt;
                {% for item in menu %}
                    &lt;li&gt;
                        &lt;a href="{{ item.href }}.html"&gt;
                            {{ item.caption }}
                        &lt;/a&gt;
                    &lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        {% endif %}

        &lt;h1&gt;{{ post.title }}&lt;/h1&gt;

        &lt;div class="content"&gt;
            {{ post.content }}
        &lt;/div&gt;

    &lt;/body&gt;
&lt;/html&gt;
</pre> <p>Using <a class="reference internal" href="../api/phalcon_mvc_view.html"><em>Phalcon\Mvc\View</em></a> you can pass variables from the controller to the views. In the above example, four variables were passed to the view: <code class="code docutils literal"><span class="pre">show_navigation</span></code>, <code class="code docutils literal"><span class="pre">menu</span></code>, <code class="code docutils literal"><span class="pre">title</span></code> and <code class="code docutils literal"><span class="pre">post</span></code>:</p> <pre class="highlight-php" data-language="php">use Phalcon\Mvc\Controller;

class PostsController extends Controller
{
    public function showAction()
    {
        $post = Post::findFirst();
        $menu = Menu::findFirst();

        $this-&gt;view-&gt;show_navigation = true;
        $this-&gt;view-&gt;menu            = $menu;
        $this-&gt;view-&gt;title           = $post-&gt;title;
        $this-&gt;view-&gt;post            = $post;

        // Or...

        $this-&gt;view-&gt;setVar("show_navigation", true);
        $this-&gt;view-&gt;setVar("menu",            $menu);
        $this-&gt;view-&gt;setVar("title",           $post-&gt;title);
        $this-&gt;view-&gt;setVar("post",            $post);
    }
}
</pre>   <h2 id="variables">Variables</h2> <p>Object variables may have attributes which can be accessed using the syntax: <code class="code docutils literal"><span class="pre">foo.bar</span></code>. If you are passing arrays, you have to use the square bracket syntax: <code class="code docutils literal"><span class="pre">foo['bar']</span></code></p> <pre class="highlight-jinja" data-language="jinja">{{ post.title }} {# for $post-&gt;title #}
{{ post['title'] }} {# for $post['title'] #}
</pre>   <h2 id="filters">Filters</h2> <p>Variables can be formatted or modified using filters. The pipe operator <code class="code docutils literal"><span class="pre">|</span></code> is used to apply filters to variables:</p> <pre class="highlight-jinja" data-language="jinja">{{ post.title|e }}
{{ post.content|striptags }}
{{ name|capitalize|trim }}
</pre> <p>The following is the list of available built-in filters in Volt:</p> <table class="docutils"> <colgroup> <col width="25%"> <col width="75%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Filter</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">e</span></code></td> <td>Applies <code class="code docutils literal"><span class="pre">Phalcon\Escaper-&gt;escapeHtml()</span></code> to the value</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">escape</span></code></td> <td>Applies <code class="code docutils literal"><span class="pre">Phalcon\Escaper-&gt;escapeHtml()</span></code> to the value</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">escape_css</span></code></td> <td>Applies <code class="code docutils literal"><span class="pre">Phalcon\Escaper-&gt;escapeCss()</span></code> to the value</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">escape_js</span></code></td> <td>Applies <code class="code docutils literal"><span class="pre">Phalcon\Escaper-&gt;escapeJs()</span></code> to the value</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">escape_attr</span></code></td> <td>Applies <code class="code docutils literal"><span class="pre">Phalcon\Escaper-&gt;escapeHtmlAttr()</span></code> to the value</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">trim</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.trim.php">trim</a> PHP function to the value. Removing extra spaces</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">left_trim</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.ltrim.php">ltrim</a> PHP function to the value. Removing extra spaces</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">right_trim</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.rtrim.php">rtrim</a> PHP function to the value. Removing extra spaces</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">striptags</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.striptags.php">striptags</a> PHP function to the value. Removing HTML tags</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">slashes</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.slashes.php">slashes</a> PHP function to the value. Escaping values</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">stripslashes</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.stripslashes.php">stripslashes</a> PHP function to the value. Removing escaped quotes</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">capitalize</span></code></td> <td>Capitalizes a string by applying the <a class="reference external" href="http://php.net/manual/en/function.ucwords.php">ucwords</a> PHP function to the value</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">lower</span></code></td> <td>Change the case of a string to lowercase</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">upper</span></code></td> <td>Change the case of a string to uppercase</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">length</span></code></td> <td>Counts the string length or how many items are in an array or object</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">nl2br</span></code></td> <td>Changes newlines \n by line breaks (&lt;br /&gt;). Uses the PHP function <a class="reference external" href="http://php.net/manual/en/function.nl2br.php">nl2br</a>
</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">sort</span></code></td> <td>Sorts an array using the PHP function <a class="reference external" href="http://php.net/manual/en/function.asort.php">asort</a>
</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">keys</span></code></td> <td>Returns the array keys using <a class="reference external" href="http://php.net/manual/en/function.array-keys.php">array_keys</a>
</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">join</span></code></td> <td>Joins the array parts using a separator <a class="reference external" href="http://php.net/manual/en/function.join.php">join</a>
</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">format</span></code></td> <td>Formats a string using <a class="reference external" href="http://php.net/manual/en/function.sprintf.php">sprintf</a>.</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">json_encode</span></code></td> <td>Converts a value into its <a class="reference external" href="http://php.net/manual/en/function.json-encode.php">JSON</a> representation</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">json_decode</span></code></td> <td>Converts a value from its <a class="reference external" href="http://php.net/manual/en/function.json-encode.php">JSON</a> representation to a PHP representation</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">abs</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.abs.php">abs</a> PHP function to a value.</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">url_encode</span></code></td> <td>Applies the <a class="reference external" href="http://php.net/manual/en/function.urlencode.php">urlencode</a> PHP function to the value</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">default</span></code></td> <td>Sets a default value in case that the evaluated expression is empty (is not set or evaluates to a falsy value)</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">convert_encoding</span></code></td> <td>Converts a string from one charset to another</td> </tr> </tbody> </table> <p>Examples:</p> <pre class="highlight-jinja" data-language="jinja">{# e or escape filter #}
{{ "&lt;h1&gt;Hello&lt;h1&gt;"|e }}
{{ "&lt;h1&gt;Hello&lt;h1&gt;"|escape }}

{# trim filter #}
{{ "   hello   "|trim }}

{# striptags filter #}
{{ "&lt;h1&gt;Hello&lt;h1&gt;"|striptags }}

{# slashes filter #}
{{ "'this is a string'"|slashes }}

{# stripslashes filter #}
{{ "\'this is a string\'"|stripslashes }}

{# capitalize filter #}
{{ "hello"|capitalize }}

{# lower filter #}
{{ "HELLO"|lower }}

{# upper filter #}
{{ "hello"|upper }}

{# length filter #}
{{ "robots"|length }}
{{ [1, 2, 3]|length }}

{# nl2br filter #}
{{ "some\ntext"|nl2br }}

{# sort filter #}
{% set sorted = [3, 1, 2]|sort %}

{# keys filter #}
{% set keys = ['first': 1, 'second': 2, 'third': 3]|keys %}

{# join filter #}
{% set joined = "a".."z"|join(",") %}

{# format filter #}
{{ "My real name is %s"|format(name) }}

{# json_encode filter #}
{% set encoded = robots|json_encode %}

{# json_decode filter #}
{% set decoded = '{"one":1,"two":2,"three":3}'|json_decode %}

{# url_encode filter #}
{{ post.permanent_link|url_encode }}

{# convert_encoding filter #}
{{ "désolé"|convert_encoding('utf8', 'latin1') }}
</pre>   <h2 id="comments">Comments</h2> <p>Comments may also be added to a template using the <code class="code docutils literal"><span class="pre">{#</span> <span class="pre">...</span> <span class="pre">#}</span></code> delimiters. All text inside them is just ignored in the final output:</p> <pre class="highlight-jinja" data-language="jinja">{# note: this is a comment
    {% set price = 100; %}
#}
</pre>   <h2 id="list-of-control-structures">List of Control Structures</h2> <p>Volt provides a set of basic but powerful control structures for use in templates:</p>  <h3 id="for">For</h3> <p>Loop over each item in a sequence. The following example shows how to traverse a set of “robots” and print his/her name:</p> <pre class="highlight-html+jinja" data-language="html">&lt;h1&gt;Robots&lt;/h1&gt;
&lt;ul&gt;
    {% for robot in robots %}
        &lt;li&gt;
            {{ robot.name|e }}
        &lt;/li&gt;
    {% endfor %}
&lt;/ul&gt;
</pre> <p>for-loops can also be nested:</p> <pre class="highlight-html+jinja" data-language="html">&lt;h1&gt;Robots&lt;/h1&gt;
{% for robot in robots %}
    {% for part in robot.parts %}
        Robot: {{ robot.name|e }} Part: {{ part.name|e }} &lt;br /&gt;
    {% endfor %}
{% endfor %}
</pre> <p>You can get the element “keys” as in the PHP counterpart using the following syntax:</p> <pre class="highlight-html+jinja" data-language="html">{% set numbers = ['one': 1, 'two': 2, 'three': 3] %}

{% for name, value in numbers %}
    Name: {{ name }} Value: {{ value }}
{% endfor %}
</pre> <p>An “if” evaluation can be optionally set:</p> <pre class="highlight-html+jinja" data-language="html">{% set numbers = ['one': 1, 'two': 2, 'three': 3] %}

{% for value in numbers if value &lt; 2 %}
    Value: {{ value }}
{% endfor %}

{% for name, value in numbers if name !== 'two' %}
    Name: {{ name }} Value: {{ value }}
{% endfor %}
</pre> <p>If an ‘else’ is defined inside the ‘for’, it will be executed if the expression in the iterator result in zero iterations:</p> <pre class="highlight-html+jinja" data-language="html">&lt;h1&gt;Robots&lt;/h1&gt;
{% for robot in robots %}
    Robot: {{ robot.name|e }} Part: {{ part.name|e }} &lt;br /&gt;
{% else %}
    There are no robots to show
{% endfor %}
</pre> <p>Alternative syntax:</p> <pre class="highlight-html+jinja" data-language="html">&lt;h1&gt;Robots&lt;/h1&gt;
{% for robot in robots %}
    Robot: {{ robot.name|e }} Part: {{ part.name|e }} &lt;br /&gt;
{% elsefor %}
    There are no robots to show
{% endfor %}
</pre>   <h3 id="loop-controls">Loop Controls</h3> <p>The ‘break’ and ‘continue’ statements can be used to exit from a loop or force an iteration in the current block:</p> <pre class="highlight-html+jinja" data-language="html">{# skip the even robots #}
{% for index, robot in robots %}
    {% if index is even %}
        {% continue %}
    {% endif %}
    ...
{% endfor %}
</pre> <pre class="highlight-html+jinja" data-language="html">{# exit the foreach on the first even robot #}
{% for index, robot in robots %}
    {% if index is even %}
        {% break %}
    {% endif %}
    ...
{% endfor %}
</pre>   <h3 id="if">If</h3> <p>As PHP, an “if” statement checks if an expression is evaluated as true or false:</p> <pre class="highlight-html+jinja" data-language="html">&lt;h1&gt;Cyborg Robots&lt;/h1&gt;
&lt;ul&gt;
    {% for robot in robots %}
        {% if robot.type === "cyborg" %}
            &lt;li&gt;{{ robot.name|e }}&lt;/li&gt;
        {% endif %}
    {% endfor %}
&lt;/ul&gt;
</pre> <p>The else clause is also supported:</p> <pre class="highlight-html+jinja" data-language="html">&lt;h1&gt;Robots&lt;/h1&gt;
&lt;ul&gt;
    {% for robot in robots %}
        {% if robot.type === "cyborg" %}
            &lt;li&gt;{{ robot.name|e }}&lt;/li&gt;
        {% else %}
            &lt;li&gt;{{ robot.name|e }} (not a cyborg)&lt;/li&gt;
        {% endif %}
    {% endfor %}
&lt;/ul&gt;
</pre> <p>The ‘elseif’ control flow structure can be used together with if to emulate a ‘switch’ block:</p> <pre class="highlight-html+jinja" data-language="html">{% if robot.type === "cyborg" %}
    Robot is a cyborg
{% elseif robot.type === "virtual" %}
    Robot is virtual
{% elseif robot.type === "mechanical" %}
    Robot is mechanical
{% endif %}
</pre>   <h3 id="loop-context">Loop Context</h3> <p>A special variable is available inside ‘for’ loops providing you information about</p> <table class="docutils"> <colgroup> <col width="28%"> <col width="72%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Variable</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">loop.index</span></code></td> <td>The current iteration of the loop. (1 indexed)</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">loop.index0</span></code></td> <td>The current iteration of the loop. (0 indexed)</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">loop.revindex</span></code></td> <td>The number of iterations from the end of the loop (1 indexed)</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">loop.revindex0</span></code></td> <td>The number of iterations from the end of the loop (0 indexed)</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">loop.first</span></code></td> <td>True if in the first iteration.</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">loop.last</span></code></td> <td>True if in the last iteration.</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">loop.length</span></code></td> <td>The number of items to iterate</td> </tr> </tbody> </table> <pre class="highlight-html+jinja" data-language="html">{% for robot in robots %}
    {% if loop.first %}
        &lt;table&gt;
            &lt;tr&gt;
                &lt;th&gt;#&lt;/th&gt;
                &lt;th&gt;Id&lt;/th&gt;
                &lt;th&gt;Name&lt;/th&gt;
            &lt;/tr&gt;
    {% endif %}
            &lt;tr&gt;
                &lt;td&gt;{{ loop.index }}&lt;/td&gt;
                &lt;td&gt;{{ robot.id }}&lt;/td&gt;
                &lt;td&gt;{{ robot.name }}&lt;/td&gt;
            &lt;/tr&gt;
    {% if loop.last %}
        &lt;/table&gt;
    {% endif %}
{% endfor %}
</pre>    <h2 id="assignments">Assignments</h2> <p>Variables may be changed in a template using the instruction “set”:</p> <pre class="highlight-html+jinja" data-language="html">{% set fruits = ['Apple', 'Banana', 'Orange'] %}

{% set name = robot.name %}
</pre> <p>Multiple assignments are allowed in the same instruction:</p> <pre class="highlight-html+jinja" data-language="html">{% set fruits = ['Apple', 'Banana', 'Orange'], name = robot.name, active = true %}
</pre> <p>Additionally, you can use compound assignment operators:</p> <pre class="highlight-html+jinja" data-language="html">{% set price += 100.00 %}

{% set age *= 5 %}
</pre> <p>The following operators are available:</p> <table class="docutils"> <colgroup> <col width="22%"> <col width="78%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Operator</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td>=</td> <td>Standard Assignment</td> </tr> <tr class="row-odd">
<td>+=</td> <td>Addition assignment</td> </tr> <tr class="row-even">
<td>-=</td> <td>Subtraction assignment</td> </tr> <tr class="row-odd">
<td>*=</td> <td>Multiplication assignment</td> </tr> <tr class="row-even">
<td>/=</td> <td>Division assignment</td> </tr> </tbody> </table>   <h2 id="expressions">Expressions</h2> <p>Volt provides a basic set of expression support, including literals and common operators.</p> <p>A expression can be evaluated and printed using the ‘{{‘ and ‘}}’ delimiters:</p> <pre class="highlight-html+jinja" data-language="html">{{ (1 + 1) * 2 }}
</pre> <p>If an expression needs to be evaluated without be printed the ‘do’ statement can be used:</p> <pre class="highlight-html+jinja" data-language="html">{% do (1 + 1) * 2 %}
</pre>  <h3 id="literals">Literals</h3> <p>The following literals are supported:</p> <table class="docutils"> <colgroup> <col width="22%"> <col width="78%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Filter</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td>“this is a string”</td> <td>Text between double quotes or single quotes are handled as strings</td> </tr> <tr class="row-odd">
<td>100.25</td> <td>Numbers with a decimal part are handled as doubles/floats</td> </tr> <tr class="row-even">
<td>100</td> <td>Numbers without a decimal part are handled as integers</td> </tr> <tr class="row-odd">
<td>false</td> <td>Constant “false” is the boolean false value</td> </tr> <tr class="row-even">
<td>true</td> <td>Constant “true” is the boolean true value</td> </tr> <tr class="row-odd">
<td>null</td> <td>Constant “null” is the Null value</td> </tr> </tbody> </table>   <h3 id="arrays">Arrays</h3> <p>Whether you’re using PHP 5.3 or &gt;= 5.4 you can create arrays by enclosing a list of values in square brackets:</p> <pre class="highlight-html+jinja" data-language="html">{# Simple array #}
{{ ['Apple', 'Banana', 'Orange'] }}

{# Other simple array #}
{{ ['Apple', 1, 2.5, false, null] }}

{# Multi-Dimensional array #}
{{ [[1, 2], [3, 4], [5, 6]] }}

{# Hash-style array #}
{{ ['first': 1, 'second': 4/2, 'third': '3'] }}
</pre> <p>Curly braces also can be used to define arrays or hashes:</p> <pre class="highlight-html+jinja" data-language="html">{% set myArray = {'Apple', 'Banana', 'Orange'} %}
{% set myHash  = {'first': 1, 'second': 4/2, 'third': '3'} %}
</pre>   <h3 id="math">Math</h3> <p>You may make calculations in templates using the following operators:</p> <table class="docutils"> <colgroup> <col width="12%"> <col width="88%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Operator</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">+</span></code></td> <td>Perform an adding operation. <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">2</span> <span class="pre">+</span> <span class="pre">3</span> <span class="pre">}}</span></code> returns 5</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">-</span></code></td> <td>Perform a substraction operation <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">2</span> <span class="pre">-</span> <span class="pre">3</span> <span class="pre">}}</span></code> returns -1</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">*</span></code></td> <td>Perform a multiplication operation <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">3</span> <span class="pre">}}</span></code> returns 6</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">/</span></code></td> <td>Perform a division operation <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">10</span> <span class="pre">/</span> <span class="pre">2</span> <span class="pre">}}</span></code> returns 5</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">%</span></code></td> <td>Calculate the remainder of an integer division <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">10</span> <span class="pre">%</span> <span class="pre">3</span> <span class="pre">}}</span></code> returns 1</td> </tr> </tbody> </table>   <h3 id="comparisons">Comparisons</h3> <p>The following comparison operators are available:</p> <table class="docutils"> <colgroup> <col width="16%"> <col width="84%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Operator</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">==</span></code></td> <td>Check whether both operands are equal</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">!=</span></code></td> <td>Check whether both operands aren’t equal</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">&lt;&gt;</span></code></td> <td>Check whether both operands aren’t equal</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">&gt;</span></code></td> <td>Check whether left operand is greater than right operand</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">&lt;</span></code></td> <td>Check whether left operand is less than right operand</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">&lt;=</span></code></td> <td>Check whether left operand is less or equal than right operand</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">&gt;=</span></code></td> <td>Check whether left operand is greater or equal than right operand</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">===</span></code></td> <td>Check whether both operands are identical</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">!==</span></code></td> <td>Check whether both operands aren’t identical</td> </tr> </tbody> </table>   <h3 id="logic">Logic</h3> <p>Logic operators are useful in the “if” expression evaluation to combine multiple tests:</p> <table class="docutils"> <colgroup> <col width="21%"> <col width="79%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Operator</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">or</span></code></td> <td>Return true if the left or right operand is evaluated as true</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">and</span></code></td> <td>Return true if both left and right operands are evaluated as true</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">not</span></code></td> <td>Negates an expression</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">(</span> <span class="pre">expr</span> <span class="pre">)</span></code></td> <td>Parenthesis groups expressions</td> </tr> </tbody> </table>   <h3 id="other-operators">Other Operators</h3> <p>Additional operators seen the following operators are available:</p> <table class="docutils"> <colgroup> <col width="22%"> <col width="78%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Operator</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">~</span></code></td> <td>Concatenates both operands <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">"hello</span> <span class="pre">"</span> <span class="pre">~</span> <span class="pre">"world"</span> <span class="pre">}}</span></code>
</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">|</span></code></td> <td>Applies a filter in the right operand to the left <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">"hello"|uppercase</span> <span class="pre">}}</span></code>
</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">..</span></code></td> <td>Creates a range <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">'a'..'z'</span> <span class="pre">}}</span></code> <code class="code docutils literal"><span class="pre">{{</span> <span class="pre">1..10</span> <span class="pre">}}</span></code>
</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">is</span></code></td> <td>Same as == (equals), also performs tests</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">in</span></code></td> <td>To check if an expression is contained into other expressions <code class="code docutils literal"><span class="pre">if</span> <span class="pre">"a"</span> <span class="pre">in</span> <span class="pre">"abc"</span></code>
</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">is</span> <span class="pre">not</span></code></td> <td>Same as != (not equals)</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">'a'</span> <span class="pre">?</span> <span class="pre">'b'</span> <span class="pre">:</span> <span class="pre">'c'</span></code></td> <td>Ternary operator. The same as the PHP ternary operator</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">++</span></code></td> <td>Increments a value</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">--</span></code></td> <td>Decrements a value</td> </tr> </tbody> </table> <p>The following example shows how to use operators:</p> <pre class="highlight-html+jinja" data-language="html">{% set robots = ['Voltron', 'Astro Boy', 'Terminator', 'C3PO'] %}

{% for index in 0..robots|length %}
    {% if robots[index] is defined %}
        {{ "Name: " ~ robots[index] }}
    {% endif %}
{% endfor %}
</pre>    <h2 id="tests">Tests</h2> <p>Tests can be used to test if a variable has a valid expected value. The operator “is” is used to perform the tests:</p> <pre class="highlight-html+jinja" data-language="html">{% set robots = ['1': 'Voltron', '2': 'Astro Boy', '3': 'Terminator', '4': 'C3PO'] %}

{% for position, name in robots %}
    {% if position is odd %}
        {{ name }}
    {% endif %}
{% endfor %}
</pre> <p>The following built-in tests are available in Volt:</p> <table class="docutils"> <colgroup> <col width="23%"> <col width="77%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Test</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">defined</span></code></td> <td>Checks if a variable is defined (<code class="code docutils literal"><span class="pre">isset()</span></code>)</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">empty</span></code></td> <td>Checks if a variable is empty</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">even</span></code></td> <td>Checks if a numeric value is even</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">odd</span></code></td> <td>Checks if a numeric value is odd</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">numeric</span></code></td> <td>Checks if value is numeric</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">scalar</span></code></td> <td>Checks if value is scalar (not an array or object)</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">iterable</span></code></td> <td>Checks if a value is iterable. Can be traversed by a “for” statement</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">divisibleby</span></code></td> <td>Checks if a value is divisible by other value</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">sameas</span></code></td> <td>Checks if a value is identical to other value</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">type</span></code></td> <td>Checks if a value is of the specified type</td> </tr> </tbody> </table> <p>More examples:</p> <pre class="highlight-html+jinja" data-language="html">{% if robot is defined %}
    The robot variable is defined
{% endif %}

{% if robot is empty %}
    The robot is null or isn't defined
{% endif %}

{% for key, name in [1: 'Voltron', 2: 'Astroy Boy', 3: 'Bender'] %}
    {% if key is even %}
        {{ name }}
    {% endif %}
{% endfor %}

{% for key, name in [1: 'Voltron', 2: 'Astroy Boy', 3: 'Bender'] %}
    {% if key is odd %}
        {{ name }}
    {% endif %}
{% endfor %}

{% for key, name in [1: 'Voltron', 2: 'Astroy Boy', 'third': 'Bender'] %}
    {% if key is numeric %}
        {{ name }}
    {% endif %}
{% endfor %}

{% set robots = [1: 'Voltron', 2: 'Astroy Boy'] %}
{% if robots is iterable %}
    {% for robot in robots %}
        ...
    {% endfor %}
{% endif %}

{% set world = "hello" %}
{% if world is sameas("hello") %}
    {{ "it's hello" }}
{% endif %}

{% set external = false %}
{% if external is type('boolean') %}
    {{ "external is false or true" }}
{% endif %}
</pre>   <h2 id="macros">Macros</h2> <p>Macros can be used to reuse logic in a template, they act as PHP functions, can receive parameters and return values:</p> <pre class="highlight-html+jinja" data-language="html">{# Macro "display a list of links to related topics" #}
{%- macro related_bar(related_links) %}
    &lt;ul&gt;
        {%- for link in related_links %}
            &lt;li&gt;
                &lt;a href="{{ url(link.url) }}.html" title="{{ link.title|striptags }}"&gt;
                    {{ link.text }}
                &lt;/a&gt;
            &lt;/li&gt;
        {%- endfor %}
    &lt;/ul&gt;
{%- endmacro %}

{# Print related links #}
{{ related_bar(links) }}

&lt;div&gt;This is the content&lt;/div&gt;

{# Print related links again #}
{{ related_bar(links) }}
</pre> <p>When calling macros, parameters can be passed by name:</p> <pre class="highlight-html+jinja" data-language="html">{%- macro error_messages(message, field, type) %}
    &lt;div&gt;
        &lt;span class="error-type"&gt;{{ type }}&lt;/span&gt;
        &lt;span class="error-field"&gt;{{ field }}&lt;/span&gt;
        &lt;span class="error-message"&gt;{{ message }}&lt;/span&gt;
    &lt;/div&gt;
{%- endmacro %}

{# Call the macro #}
{{ error_messages('type': 'Invalid', 'message': 'The name is invalid', 'field': 'name') }}
</pre> <p>Macros can return values:</p> <pre class="highlight-html+jinja" data-language="html">{%- macro my_input(name, class) %}
    {% return text_field(name, 'class': class) %}
{%- endmacro %}

{# Call the macro #}
{{ '&lt;p&gt;' ~ my_input('name', 'input-text') ~ '&lt;/p&gt;' }}
</pre> <p>And receive optional parameters:</p> <pre class="highlight-html+jinja" data-language="html">{%- macro my_input(name, class="input-text") %}
    {% return text_field(name, 'class': class) %}
{%- endmacro %}

{# Call the macro #}
{{ '&lt;p&gt;' ~ my_input('name') ~ '&lt;/p&gt;' }}
{{ '&lt;p&gt;' ~ my_input('name', 'input-text') ~ '&lt;/p&gt;' }}
</pre>   <h2 id="using-tag-helpers">Using Tag Helpers</h2> <p>Volt is highly integrated with <a class="reference internal" href="tags.html"><em>Phalcon\Tag</em></a>, so it’s easy to use the helpers provided by that component in a Volt template:</p> <pre class="highlight-html+jinja" data-language="html">{{ javascript_include("js/jquery.js") }}

{{ form('products/save', 'method': 'post') }}

    &lt;label for="name"&gt;Name&lt;/label&gt;
    {{ text_field("name", "size": 32) }}

    &lt;label for="type"&gt;Type&lt;/label&gt;
    {{ select("type", productTypes, 'using': ['id', 'name']) }}

    {{ submit_button('Send') }}

{{ end_form() }}
</pre> <p>The following PHP is generated:</p> <pre class="highlight-html+php" data-language="html">&lt;?php echo Phalcon\Tag::javascriptInclude("js/jquery.js") ?&gt;

&lt;?php echo Phalcon\Tag::form(array('products/save', 'method' =&gt; 'post')); ?&gt;

    &lt;label for="name"&gt;Name&lt;/label&gt;
    &lt;?php echo Phalcon\Tag::textField(array('name', 'size' =&gt; 32)); ?&gt;

    &lt;label for="type"&gt;Type&lt;/label&gt;
    &lt;?php echo Phalcon\Tag::select(array('type', $productTypes, 'using' =&gt; array('id', 'name'))); ?&gt;

    &lt;?php echo Phalcon\Tag::submitButton('Send'); ?&gt;

{{ end_form() }}
</pre> <p>To call a <a class="reference internal" href="../api/phalcon_tag.html"><em>Phalcon\Tag</em></a> helper, you only need to call an uncamelized version of the method:</p> <table class="docutils"> <colgroup> <col width="59%"> <col width="41%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Method</th> <th class="head">Volt function</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::linkTo</span></code></td> <td><code class="code docutils literal"><span class="pre">link_to</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::textField</span></code></td> <td><code class="code docutils literal"><span class="pre">text_field</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::passwordField</span></code></td> <td><code class="code docutils literal"><span class="pre">password_field</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::hiddenField</span></code></td> <td><code class="code docutils literal"><span class="pre">hidden_field</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::fileField</span></code></td> <td><code class="code docutils literal"><span class="pre">file_field</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::checkField</span></code></td> <td><code class="code docutils literal"><span class="pre">check_field</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::radioField</span></code></td> <td><code class="code docutils literal"><span class="pre">radio_field</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::dateField</span></code></td> <td><code class="code docutils literal"><span class="pre">date_field</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::emailField</span></code></td> <td><code class="code docutils literal"><span class="pre">email_field</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::numericField</span></code></td> <td><code class="code docutils literal"><span class="pre">numeric_field</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::submitButton</span></code></td> <td><code class="code docutils literal"><span class="pre">submit_button</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::selectStatic</span></code></td> <td><code class="code docutils literal"><span class="pre">select_static</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::select</span></code></td> <td><code class="code docutils literal"><span class="pre">select</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::textArea</span></code></td> <td><code class="code docutils literal"><span class="pre">text_area</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::form</span></code></td> <td><code class="code docutils literal"><span class="pre">form</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::endForm</span></code></td> <td><code class="code docutils literal"><span class="pre">end_form</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::getTitle</span></code></td> <td><code class="code docutils literal"><span class="pre">get_title</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::stylesheetLink</span></code></td> <td><code class="code docutils literal"><span class="pre">stylesheet_link</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::javascriptInclude</span></code></td> <td><code class="code docutils literal"><span class="pre">javascript_include</span></code></td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::image</span></code></td> <td><code class="code docutils literal"><span class="pre">image</span></code></td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">Phalcon\Tag::friendlyTitle</span></code></td> <td><code class="code docutils literal"><span class="pre">friendly_title</span></code></td> </tr> </tbody> </table>   <h2 id="functions">Functions</h2> <p>The following built-in functions are available in Volt:</p> <table class="docutils"> <colgroup> <col width="26%"> <col width="74%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Name</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">content</span></code></td> <td>Includes the content produced in a previous rendering stage</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">get_content</span></code></td> <td>Same as <code class="code docutils literal"><span class="pre">content</span></code>
</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">partial</span></code></td> <td>Dynamically loads a partial view in the current template</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">super</span></code></td> <td>Render the contents of the parent block</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">time</span></code></td> <td>Calls the PHP function with the same name</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">date</span></code></td> <td>Calls the PHP function with the same name</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">dump</span></code></td> <td>Calls the PHP function <code class="code docutils literal"><span class="pre">var_dump()</span></code>
</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">version</span></code></td> <td>Returns the current version of the framework</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">constant</span></code></td> <td>Reads a PHP constant</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">url</span></code></td> <td>Generate a URL using the ‘url’ service</td> </tr> </tbody> </table>   <h2 id="view-integration">View Integration</h2> <p>Also, Volt is integrated with <a class="reference internal" href="views.html"><em>Phalcon\Mvc\View</em></a>, you can play with the view hierarchy and include partials as well:</p> <pre class="highlight-html+jinja" data-language="html">{{ content() }}

&lt;!-- Simple include of a partial --&gt;
&lt;div id="footer"&gt;{{ partial("partials/footer") }}&lt;/div&gt;

&lt;!-- Passing extra variables --&gt;
&lt;div id="footer"&gt;{{ partial("partials/footer", ['links': links]) }}&lt;/div&gt;
</pre> <p>A partial is included in runtime, Volt also provides “include”, this compiles the content of a view and returns its contents as part of the view which was included:</p> <pre class="highlight-html+jinja" data-language="html">{# Simple include of a partial #}
&lt;div id="footer"&gt;
    {% include "partials/footer" %}
&lt;/div&gt;

{# Passing extra variables #}
&lt;div id="footer"&gt;
    {% include "partials/footer" with ['links': links] %}
&lt;/div&gt;
</pre>  <h3 id="include">Include</h3> <p>‘include’ has a special behavior that will help us improve performance a bit when using Volt, if you specify the extension when including the file and it exists when the template is compiled, Volt can inline the contents of the template in the parent template where it’s included. Templates aren’t inlined if the ‘include’ have variables passed with ‘with’:</p> <pre class="highlight-html+jinja" data-language="html">{# The contents of 'partials/footer.volt' is compiled and inlined #}
&lt;div id="footer"&gt;
    {% include "partials/footer.volt" %}
&lt;/div&gt;
</pre>   <h3 id="partial-vs-include">Partial vs Include</h3> <p>Keep the following points in mind when choosing to use the “partial” function or “include”:</p> <ul class="simple"> <li>‘Partial’ allows you to include templates made in Volt and in other template engines as well</li> <li>‘Partial’ allows you to pass an expression like a variable allowing to include the content of other view dynamically</li> <li>‘Partial’ is better if the content that you have to include changes frequently</li> <li>‘Include’ copies the compiled content into the view which improves the performance</li> <li>‘Include’ only allows to include templates made with Volt</li> <li>‘Include’ requires an existing template at compile time</li> </ul>    <h2 id="template-inheritance">Template Inheritance</h2> <p>With template inheritance you can create base templates that can be extended by others templates allowing to reuse code. A base template define <em>blocks</em> than can be overridden by a child template. Let’s pretend that we have the following base template:</p> <pre class="highlight-html+jinja" data-language="html">{# templates/base.volt #}
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        {% block head %}
            &lt;link rel="stylesheet" href="style.css.html" /&gt;
        {% endblock %}

        &lt;title&gt;{% block title %}{% endblock %} - My Webpage&lt;/title&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;div id="content"&gt;{% block content %}{% endblock %}&lt;/div&gt;

        &lt;div id="footer"&gt;
            {% block footer %}&amp;copy; Copyright 2015, All rights reserved.{% endblock %}
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre> <p>From other template we could extend the base template replacing the blocks:</p> <pre class="highlight-html+jinja" data-language="html">{% extends "templates/base.volt" %}

{% block title %}Index{% endblock %}

{% block head %}&lt;style type="text/css"&gt;.important { color: #336699; }&lt;/style&gt;{% endblock %}

{% block content %}
    &lt;h1&gt;Index&lt;/h1&gt;
    &lt;p class="important"&gt;Welcome on my awesome homepage.&lt;/p&gt;
{% endblock %}
</pre> <p>Not all blocks must be replaced at a child template, only those that are needed. The final output produced will be the following:</p> <pre class="highlight-html" data-language="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;style type="text/css"&gt;.important { color: #336699; }&lt;/style&gt;

        &lt;title&gt;Index - My Webpage&lt;/title&gt;
    &lt;/head&gt;

    &lt;body&gt;
        &lt;div id="content"&gt;
            &lt;h1&gt;Index&lt;/h1&gt;
            &lt;p class="important"&gt;Welcome on my awesome homepage.&lt;/p&gt;
        &lt;/div&gt;

        &lt;div id="footer"&gt;
            &amp;copy; Copyright 2015, All rights reserved.
        &lt;/div&gt;
    &lt;/body&gt;
&lt;/html&gt;
</pre>  <h3 id="multiple-inheritance">Multiple Inheritance</h3> <p>Extended templates can extend other templates. The following example illustrates this:</p> <pre class="highlight-html+jinja" data-language="html">{# main.volt #}
&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Title&lt;/title&gt;
    &lt;/head&gt;

    &lt;body&gt;
        {% block content %}{% endblock %}
    &lt;/body&gt;
&lt;/html&gt;
</pre> <p>Template “layout.volt” extends “main.volt”</p> <pre class="highlight-html+jinja" data-language="html">{# layout.volt #}
{% extends "main.volt" %}

{% block content %}

    &lt;h1&gt;Table of contents&lt;/h1&gt;

{% endblock %}
</pre> <p>Finally a view that extends “layout.volt”:</p> <pre class="highlight-html+jinja" data-language="html">{# index.volt #}
{% extends "layout.volt" %}

{% block content %}

    {{ super() }}

    &lt;ul&gt;
        &lt;li&gt;Some option&lt;/li&gt;
        &lt;li&gt;Some other option&lt;/li&gt;
    &lt;/ul&gt;

{% endblock %}
</pre> <p>Rendering “index.volt” produces:</p> <pre class="highlight-html" data-language="html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
    &lt;head&gt;
        &lt;title&gt;Title&lt;/title&gt;
    &lt;/head&gt;

    &lt;body&gt;

        &lt;h1&gt;Table of contents&lt;/h1&gt;

        &lt;ul&gt;
            &lt;li&gt;Some option&lt;/li&gt;
            &lt;li&gt;Some other option&lt;/li&gt;
        &lt;/ul&gt;

    &lt;/body&gt;
&lt;/html&gt;
</pre> <p>Note the call to the function <code class="code docutils literal"><span class="pre">super()</span></code>. With that function it’s possible to render the contents of the parent block.</p> <p>As partials, the path set to “extends” is a relative path under the current views directory (i.e. app/views/).</p> <blockquote class="highlights"> <div>By default, and for performance reasons, Volt only checks for changes in the children templates to know when to re-compile to plain PHP again, so it is recommended initialize Volt with the option <code class="code docutils literal"><span class="pre">'compileAlways'</span> <span class="pre">=&gt;</span> <span class="pre">true</span></code>. Thus, the templates are compiled always taking into account changes in the parent templates.</div>
</blockquote>    <h2 id="autoescape-mode">Autoescape mode</h2> <p>You can enable auto-escaping of all variables printed in a block using the autoescape mode:</p> <pre class="highlight-html+jinja" data-language="html">Manually escaped: {{ robot.name|e }}

{% autoescape true %}
    Autoescaped: {{ robot.name }}
    {% autoescape false %}
        No Autoescaped: {{ robot.name }}
    {% endautoescape %}
{% endautoescape %}
</pre>   <h2 id="extending-volt">Extending Volt</h2> <p>Unlike other template engines, Volt itself is not required to run the compiled templates. Once the templates are compiled there is no dependence on Volt. With performance independence in mind, Volt only acts as a compiler for PHP templates.</p> <p>The Volt compiler allow you to extend it adding more functions, tests or filters to the existing ones.</p>  <h3 id="id1">Functions</h3> <p>Functions act as normal PHP functions, a valid string name is required as function name. Functions can be added using two strategies, returning a simple string or using an anonymous function. Always is required that the chosen strategy returns a valid PHP string expression:</p> <pre class="highlight-php" data-language="php">use Phalcon\Mvc\View\Engine\Volt;

$volt = new Volt($view, $di);

$compiler = $volt-&gt;getCompiler();

// This binds the function name 'shuffle' in Volt to the PHP function 'str_shuffle'
$compiler-&gt;addFunction("shuffle", "str_shuffle");
</pre> <p>Register the function with an anonymous function. This case we use <code class="code docutils literal"><span class="pre">$resolvedArgs</span></code> to pass the arguments exactly as were passed in the arguments:</p> <pre class="highlight-php" data-language="php">$compiler-&gt;addFunction(
    "widget",
    function ($resolvedArgs, $exprArgs) {
        return "MyLibrary\\Widgets::get(" . $resolvedArgs . ")";
    }
);
</pre> <p>Treat the arguments independently and unresolved:</p> <pre class="highlight-php" data-language="php">$compiler-&gt;addFunction(
    "repeat",
    function ($resolvedArgs, $exprArgs) use ($compiler) {
        // Resolve the first argument
        $firstArgument = $compiler-&gt;expression($exprArgs[0]['expr']);

        // Checks if the second argument was passed
        if (isset($exprArgs[1])) {
            $secondArgument = $compiler-&gt;expression($exprArgs[1]['expr']);
        } else {
            // Use '10' as default
            $secondArgument = '10';
        }

        return "str_repeat(" . $firstArgument . ", " . $secondArgument . ")";
    }
);
</pre> <p>Generate the code based on some function availability:</p> <pre class="highlight-php" data-language="php">$compiler-&gt;addFunction(
    "contains_text",
    function ($resolvedArgs, $exprArgs) {
        if (function_exists("mb_stripos")) {
            return "mb_stripos(" . $resolvedArgs . ")";
        } else {
            return "stripos(" . $resolvedArgs . ")";
        }
    }
);
</pre> <p>Built-in functions can be overridden adding a function with its name:</p> <pre class="highlight-php" data-language="php">// Replace built-in function dump
$compiler-&gt;addFunction("dump", "print_r");
</pre>   <h3 id="id2">Filters</h3> <p>A filter has the following form in a template: leftExpr|name(optional-args). Adding new filters is similar as seen with the functions:</p> <pre class="highlight-php" data-language="php">// This creates a filter 'hash' that uses the PHP function 'md5'
$compiler-&gt;addFilter("hash", "md5");
</pre> <pre class="highlight-php" data-language="php">$compiler-&gt;addFilter(
    "int",
    function ($resolvedArgs, $exprArgs) {
        return "intval(" . $resolvedArgs . ")";
    }
);
</pre> <p>Built-in filters can be overridden adding a function with its name:</p> <pre class="highlight-php" data-language="php">// Replace built-in filter 'capitalize'
$compiler-&gt;addFilter("capitalize", "lcfirst");
</pre>   <h3 id="extensions">Extensions</h3> <p>With extensions the developer has more flexibility to extend the template engine, and override the compilation of a specific instruction, change the behavior of an expression or operator, add functions/filters, and more.</p> <p>An extension is a class that implements the events triggered by Volt as a method of itself.</p> <p>For example, the class below allows to use any PHP function in Volt:</p> <pre class="highlight-php" data-language="php">class PhpFunctionExtension
{
    /**
     * This method is called on any attempt to compile a function call
     */
    public function compileFunction($name, $arguments)
    {
        if (function_exists($name)) {
            return $name . "(". $arguments . ")";
        }
    }
}
</pre> <p>The above class implements the method ‘compileFunction’ which is invoked before any attempt to compile a function call in any template. The purpose of the extension is to verify if a function to be compiled is a PHP function allowing to call it from the template. Events in extensions must return valid PHP code, this will be used as result of the compilation instead of the one generated by Volt. If an event doesn’t return an string the compilation is done using the default behavior provided by the engine.</p> <p>The following compilation events are available to be implemented in extensions:</p> <table class="docutils"> <colgroup> <col width="21%"> <col width="79%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Event/Method</th> <th class="head">Description</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">compileFunction</span></code></td> <td>Triggered before trying to compile any function call in a template</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">compileFilter</span></code></td> <td>Triggered before trying to compile any filter call in a template</td> </tr> <tr class="row-even">
<td><code class="code docutils literal"><span class="pre">resolveExpression</span></code></td> <td>Triggered before trying to compile any expression. This allows the developer to override operators</td> </tr> <tr class="row-odd">
<td><code class="code docutils literal"><span class="pre">compileStatement</span></code></td> <td>Triggered before trying to compile any expression. This allows the developer to override any statement</td> </tr> </tbody> </table> <p>Volt extensions must be in registered in the compiler making them available in compile time:</p> <pre class="highlight-php" data-language="php">// Register the extension in the compiler
$compiler-&gt;addExtension(
    new PhpFunctionExtension()
);
</pre>    <h2 id="caching-view-fragments">Caching view fragments</h2> <p>With Volt it’s easy cache view fragments. This caching improves performance preventing that the contents of a block from being executed by PHP each time the view is displayed:</p> <pre class="highlight-html+jinja" data-language="html">{% cache "sidebar" %}
    &lt;!-- generate this content is slow so we are going to cache it --&gt;
{% endcache %}
</pre> <p>Setting a specific number of seconds:</p> <pre class="highlight-html+jinja" data-language="html">{# cache the sidebar by 1 hour #}
{% cache "sidebar" 3600 %}
    &lt;!-- generate this content is slow so we are going to cache it --&gt;
{% endcache %}
</pre> <p>Any valid expression can be used as cache key:</p> <pre class="highlight-html+jinja" data-language="html">{% cache ("article-" ~ post.id) 3600 %}

    &lt;h1&gt;{{ post.title }}&lt;/h1&gt;

    &lt;p&gt;{{ post.content }}&lt;/p&gt;

{% endcache %}
</pre> <p>The caching is done by the <a class="reference internal" href="cache.html"><em>Phalcon\Cache</em></a> component via the view component. Learn more about how this integration works in the section <a class="reference internal" href="views.html"><em>“Caching View Fragments”</em></a>.</p>   <h2 id="inject-services-into-a-template">Inject Services into a Template</h2> <p>If a service container (DI) is available for Volt, you can use the services by only accessing the name of the service in the template:</p> <pre class="highlight-html+jinja" data-language="html">{# Inject the 'flash' service #}
&lt;div id="messages"&gt;{{ flash.output() }}&lt;/div&gt;

{# Inject the 'security' service #}
&lt;input type="hidden" name="token" value="{{ security.getToken() }}"&gt;
</pre>   <h2 id="stand-alone-component">Stand-alone component</h2> <p>Using Volt in a stand-alone mode can be demonstrated below:</p> <pre class="highlight-php" data-language="php">use Phalcon\Mvc\View\Engine\Volt\Compiler as VoltCompiler;

// Create a compiler
$compiler = new VoltCompiler();

// Optionally add some options
$compiler-&gt;setOptions(
    [
        // ...
    ]
);

// Compile a template string returning PHP code
echo $compiler-&gt;compileString(
    "{{ 'hello' }}"
);

// Compile a template in a file specifying the destination file
$compiler-&gt;compileFile(
    "layouts/main.volt",
    "cache/layouts/main.volt.php"
);

// Compile a template in a file based on the options passed to the compiler
$compiler-&gt;compile(
    "layouts/main.volt"
);

// Require the compiled templated (optional)
require $compiler-&gt;getCompiledTemplatePath();
</pre>   <h2 id="external-resources">External Resources</h2> <ul class="simple"> <li>A bundle for Sublime/Textmate is available <a class="reference external" href="https://github.com/phalcon/volt-sublime-textmate">here</a>
</li> <li>
<a class="reference external" href="http://album-o-rama.phalconphp.com">Album-O-Rama</a> is a sample application using Volt as template engine, [<a class="reference external" href="https://github.com/phalcon/album-o-rama">Album-O-Rama on Github</a>]</li> <li>
<a class="reference external" href="http://phalconphp.com">Our website</a> is running using Volt as template engine, [<a class="reference external" href="https://github.com/phalcon/website">Our website on Github</a>]</li> <li>
<a class="reference external" href="http://forum.phalconphp.com">Phosphorum</a>, the Phalcon’s forum, also uses Volt, [<a class="reference external" href="https://github.com/phalcon/forum">Phosphorum on Github</a>]</li> <li>
<a class="reference external" href="http://vokuro.phalconphp.com">Vökuró</a>, is another sample application that use Volt, [<a class="reference external" href="https://github.com/phalcon/vokuro">Vökuró on Github</a>]</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2011&ndash;2017 Phalcon Framework Team<br>Licensed under the Creative Commons Attribution License 3.0.<br>
    <a href="https://docs.phalconphp.com/en/latest/reference/volt.html" class="_attribution-link">https://docs.phalconphp.com/en/latest/reference/volt.html</a>
  </p>
</div>
