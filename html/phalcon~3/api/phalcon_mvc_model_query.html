<h1 id="class-phalcon-mvc-model-query">Class <strong>Phalcon\Mvc\Model\Query</strong>
</h1> <p><em>implements</em> <a class="reference internal" href="phalcon_mvc_model_queryinterface.html"><em>Phalcon\Mvc\Model\QueryInterface</em></a>, <a class="reference internal" href="phalcon_di_injectionawareinterface.html"><em>Phalcon\Di\InjectionAwareInterface</em></a></p> <p><span class="raw-html"><a href="https://github.com/phalcon/cphalcon/blob/master/phalcon/mvc/model/query.zep" class="btn btn-default btn-sm">Source on GitHub</a></span></p> <p>This class takes a PHQL intermediate representation and executes it.</p> <pre class="highlight-php" data-language="php">$phql = "SELECT c.price*0.16 AS taxes, c.* FROM Cars AS c JOIN Brands AS b
         WHERE b.name = :name: ORDER BY c.name";

$result = $manager-&gt;executeQuery(
    $phql,
    [
        "name" =&gt; "Lamborghini",
    ]
);

foreach ($result as $row) {
    echo "Name: ",  $row-&gt;cars-&gt;name, "\n";
    echo "Price: ", $row-&gt;cars-&gt;price, "\n";
    echo "Taxes: ", $row-&gt;taxes, "\n";
}
</pre>  <h2 id="constants">Constants</h2> <h3 id="type_select" class="method-signature">
<em>integer</em> <strong>TYPE_SELECT</strong>
</h3> <h3 id="type_insert" class="method-signature">
<em>integer</em> <strong>TYPE_INSERT</strong>
</h3> <h3 id="type_update" class="method-signature">
<em>integer</em> <strong>TYPE_UPDATE</strong>
</h3> <h3 id="type_delete" class="method-signature">
<em>integer</em> <strong>TYPE_DELETE</strong>
</h3>   <h2 id="methods">Methods</h2> <h3 id="__construct" class="method-signature">public <strong>__construct</strong> ([<em>string</em> $phql], [<a class="reference internal" href="phalcon_diinterface.html"><em>Phalcon\DiInterface</em></a> $dependencyInjector], [<em>mixed</em> $options])</h3> <p>Phalcon\Mvc\Model\Query constructor</p> <h3 id="setdi" class="method-signature">public <strong>setDI</strong> (<a class="reference internal" href="phalcon_diinterface.html"><em>Phalcon\DiInterface</em></a> $dependencyInjector)</h3> <p>Sets the dependency injection container</p> <h3 id="getdi" class="method-signature">public <strong>getDI</strong> ()</h3> <p>Returns the dependency injection container</p> <h3 id="setuniquerow" class="method-signature">public <strong>setUniqueRow</strong> (<em>mixed</em> $uniqueRow)</h3> <p>Tells to the query if only the first row in the resultset must be returned</p> <h3 id="getuniquerow" class="method-signature">public <strong>getUniqueRow</strong> ()</h3> <p>Check if the query is programmed to get only the first row in the resultset</p> <h3 id="_getqualified" class="method-signature">final protected <strong>_getQualified</strong> (<em>array</em> $expr)</h3> <p>Replaces the modelâ€™s name to its source name in a qualified-name expression</p> <h3 id="_getcallargument" class="method-signature">final protected <strong>_getCallArgument</strong> (<em>array</em> $argument)</h3> <p>Resolves an expression in a single call argument</p> <h3 id="_getcaseexpression" class="method-signature">final protected <strong>_getCaseExpression</strong> (<em>array</em> $expr)</h3> <p>Resolves an expression in a single call argument</p> <h3 id="_getfunctioncall" class="method-signature">final protected <strong>_getFunctionCall</strong> (<em>array</em> $expr)</h3> <p>Resolves an expression in a single call argument</p> <h3 id="_getexpression" class="method-signature">final protected <em>string</em> <strong>_getExpression</strong> (<em>array</em> $expr, [<em>boolean</em> $quoting])</h3> <p>Resolves an expression from its intermediate code into a string</p> <h3 id="_getselectcolumn" class="method-signature">final protected <strong>_getSelectColumn</strong> (<em>array</em> $column)</h3> <p>Resolves a column from its intermediate representation into an array used to determine if the resultset produced is simple or complex</p> <h3 id="_gettable" class="method-signature">final protected <em>string</em> <strong>_getTable</strong> (<a class="reference internal" href="phalcon_mvc_model_managerinterface.html"><em>Phalcon\Mvc\Model\ManagerInterface</em></a> $manager, <em>array</em> $qualifiedName)</h3> <p>Resolves a table in a SELECT statement checking if the model exists</p> <h3 id="_getjoin" class="method-signature">final protected <strong>_getJoin</strong> (<a class="reference internal" href="phalcon_mvc_model_managerinterface.html"><em>Phalcon\Mvc\Model\ManagerInterface</em></a> $manager, <em>mixed</em> $join)</h3> <p>Resolves a JOIN clause checking if the associated models exist</p> <h3 id="_getjointype" class="method-signature">final protected <em>string</em> <strong>_getJoinType</strong> (<em>array</em> $join)</h3> <p>Resolves a JOIN type</p> <h3 id="_getsinglejoin" class="method-signature">final protected <em>array</em> <strong>_getSingleJoin</strong> (<em>string</em> $joinType, <em>string</em> $joinSource, <em>string</em> $modelAlias, <em>string</em> $joinAlias, <a class="reference internal" href="phalcon_mvc_model_relationinterface.html"><em>Phalcon\Mvc\Model\RelationInterface</em></a> $relation)</h3> <p>Resolves joins involving has-one/belongs-to/has-many relations</p> <h3 id="_getmultijoin" class="method-signature">final protected <em>array</em> <strong>_getMultiJoin</strong> (<em>string</em> $joinType, <em>string</em> $joinSource, <em>string</em> $modelAlias, <em>string</em> $joinAlias, <a class="reference internal" href="phalcon_mvc_model_relationinterface.html"><em>Phalcon\Mvc\Model\RelationInterface</em></a> $relation)</h3> <p>Resolves joins involving many-to-many relations</p> <h3 id="_getjoins" class="method-signature">final protected <em>array</em> <strong>_getJoins</strong> (<em>array</em> $select)</h3> <p>Processes the JOINs in the query returning an internal representation for the database dialect</p> <h3 id="_getorderclause" class="method-signature">final protected <em>array</em> <strong>_getOrderClause</strong> (<em>array</em> | <em>string</em> $order)</h3> <p>Returns a processed order clause for a SELECT statement</p> <h3 id="_getgroupclause" class="method-signature">final protected <strong>_getGroupClause</strong> (<em>array</em> $group)</h3> <p>Returns a processed group clause for a SELECT statement</p> <h3 id="_getlimitclause" class="method-signature">final protected <strong>_getLimitClause</strong> (<em>array</em> $limitClause)</h3> <p>Returns a processed limit clause for a SELECT statement</p> <h3 id="_prepareselect" class="method-signature">final protected <strong>_prepareSelect</strong> ([<em>mixed</em> $ast], [<em>mixed</em> $merge])</h3> <p>Analyzes a SELECT intermediate code and produces an array to be executed later</p> <h3 id="_prepareinsert" class="method-signature">final protected <strong>_prepareInsert</strong> ()</h3> <p>Analyzes an INSERT intermediate code and produces an array to be executed later</p> <h3 id="_prepareupdate" class="method-signature">final protected <strong>_prepareUpdate</strong> ()</h3> <p>Analyzes an UPDATE intermediate code and produces an array to be executed later</p> <h3 id="_preparedelete" class="method-signature">final protected <strong>_prepareDelete</strong> ()</h3> <p>Analyzes a DELETE intermediate code and produces an array to be executed later</p> <h3 id="parse" class="method-signature">public <strong>parse</strong> ()</h3> <p>Parses the intermediate code produced by Phalcon\Mvc\Model\Query\Lang generating another intermediate representation that could be executed by Phalcon\Mvc\Model\Query</p> <h3 id="getcache" class="method-signature">public <strong>getCache</strong> ()</h3> <p>Returns the current cache backend instance</p> <h3 id="_executeselect" class="method-signature">final protected <strong>_executeSelect</strong> (<em>mixed</em> $intermediate, <em>mixed</em> $bindParams, <em>mixed</em> $bindTypes, [<em>mixed</em> $simulate])</h3> <p>Executes the SELECT intermediate representation producing a Phalcon\Mvc\Model\Resultset</p> <h3 id="_executeinsert" class="method-signature">final protected <a class="reference internal" href="phalcon_mvc_model_query_statusinterface.html"><em>Phalcon\Mvc\Model\Query\StatusInterface</em></a> <strong>_executeInsert</strong> (<em>array</em> $intermediate, <em>array</em> $bindParams, <em>array</em> $bindTypes)</h3> <p>Executes the INSERT intermediate representation producing a Phalcon\Mvc\Model\Query\Status</p> <h3 id="_executeupdate" class="method-signature">final protected <a class="reference internal" href="phalcon_mvc_model_query_statusinterface.html"><em>Phalcon\Mvc\Model\Query\StatusInterface</em></a> <strong>_executeUpdate</strong> (<em>array</em> $intermediate, <em>array</em> $bindParams, <em>array</em> $bindTypes)</h3> <p>Executes the UPDATE intermediate representation producing a Phalcon\Mvc\Model\Query\Status</p> <h3 id="_executedelete" class="method-signature">final protected <a class="reference internal" href="phalcon_mvc_model_query_statusinterface.html"><em>Phalcon\Mvc\Model\Query\StatusInterface</em></a> <strong>_executeDelete</strong> (<em>array</em> $intermediate, <em>array</em> $bindParams, <em>array</em> $bindTypes)</h3> <p>Executes the DELETE intermediate representation producing a Phalcon\Mvc\Model\Query\Status</p> <h3 id="_getrelatedrecords" class="method-signature">final protected <a class="reference internal" href="phalcon_mvc_model_resultsetinterface.html"><em>Phalcon\Mvc\Model\ResultsetInterface</em></a> <strong>_getRelatedRecords</strong> (<a class="reference internal" href="phalcon_mvc_modelinterface.html"><em>Phalcon\Mvc\ModelInterface</em></a> $model, <em>array</em> $intermediate, <em>array</em> $bindParams, <em>array</em> $bindTypes)</h3> <p>Query the records on which the UPDATE/DELETE operation well be done</p> <h3 id="execute" class="method-signature">public <em>mixed</em> <strong>execute</strong> ([<em>array</em> $bindParams], [<em>array</em> $bindTypes])</h3> <p>Executes a parsed PHQL statement</p> <h3 id="getsingleresult" class="method-signature">public <a class="reference internal" href="phalcon_mvc_modelinterface.html"><em>Phalcon\Mvc\ModelInterface</em></a> <strong>getSingleResult</strong> ([<em>array</em> $bindParams], [<em>array</em> $bindTypes])</h3> <p>Executes the query returning the first result</p> <h3 id="settype" class="method-signature">public <strong>setType</strong> (<em>mixed</em> $type)</h3> <p>Sets the type of PHQL statement to be executed</p> <h3 id="gettype" class="method-signature">public <strong>getType</strong> ()</h3> <p>Gets the type of PHQL statement executed</p> <h3 id="setbindparams" class="method-signature">public <strong>setBindParams</strong> (<em>array</em> $bindParams, [<em>mixed</em> $merge])</h3> <p>Set default bind parameters</p> <h3 id="getbindparams" class="method-signature">public <em>array</em> <strong>getBindParams</strong> ()</h3> <p>Returns default bind params</p> <h3 id="setbindtypes" class="method-signature">public <strong>setBindTypes</strong> (<em>array</em> $bindTypes, [<em>mixed</em> $merge])</h3> <p>Set default bind parameters</p> <h3 id="setsharedlock" class="method-signature">public <strong>setSharedLock</strong> ([<em>mixed</em> $sharedLock])</h3> <p>Set SHARED LOCK clause</p> <h3 id="getbindtypes" class="method-signature">public <em>array</em> <strong>getBindTypes</strong> ()</h3> <p>Returns default bind types</p> <h3 id="setintermediate" class="method-signature">public <strong>setIntermediate</strong> (<em>array</em> $intermediate)</h3> <p>Allows to set the IR to be executed</p> <h3 id="getintermediate" class="method-signature">public <em>array</em> <strong>getIntermediate</strong> ()</h3> <p>Returns the intermediate representation of the PHQL statement</p> <h3 id="cache" class="method-signature">public <strong>cache</strong> (<em>mixed</em> $cacheOptions)</h3> <p>Sets the cache parameters of the query</p> <h3 id="getcacheoptions" class="method-signature">public <strong>getCacheOptions</strong> ()</h3> <p>Returns the current cache options</p> <h3 id="getsql" class="method-signature">public <strong>getSql</strong> ()</h3> <p>Returns the SQL to be generated by the internal PHQL (only works in SELECT statements)</p> <h3 id="clean" class="method-signature">public static <strong>clean</strong> ()</h3> <p>Destroys the internal PHQL cache</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2011&ndash;2017 Phalcon Framework Team<br>Licensed under the Creative Commons Attribution License 3.0.<br>
    <a href="https://docs.phalconphp.com/en/latest/api/Phalcon_Mvc_Model_Query.html" class="_attribution-link">https://docs.phalconphp.com/en/latest/api/Phalcon_Mvc_Model_Query.html</a>
  </p>
</div>
