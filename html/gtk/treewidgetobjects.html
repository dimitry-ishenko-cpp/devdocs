<h1>Tree, List and Icon Grid Widgets</h1>
<div class="chapter">  <div class="toc"><dl class="toc"> <dt><span class="sect1"><a href="treewidgetobjects.html#TreeWidget">Tree and List Widget Overview</a></span></dt> <dd><dl> <dt><span class="sect2"><a href="treewidgetobjects.html#id-1.4.17.2.6">Creating a model</a></span></dt> <dt><span class="sect2"><a href="treewidgetobjects.html#id-1.4.17.2.7">Creating the view component</a></span></dt> <dt><span class="sect2"><a href="treewidgetobjects.html#id-1.4.17.2.8">Columns and cell renderers</a></span></dt> <dt><span class="sect2"><a href="treewidgetobjects.html#id-1.4.17.2.9">Selection handling</a></span></dt> <dt><span class="sect2"><a href="treewidgetobjects.html#id-1.4.17.2.10">Simple Example</a></span></dt> </dl></dd> <dt> <span class="refentrytitle"><a href="gtktreemodel.html">GtkTreeModel</a></span><span class="refpurpose"> — The tree interface used by GtkTreeView</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreeselection.html">GtkTreeSelection</a></span><span class="refpurpose"> — The selection object for GtkTreeView</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreeviewcolumn.html">GtkTreeViewColumn</a></span><span class="refpurpose"> — A visible column in a GtkTreeView widget</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreeview.html">GtkTreeView</a></span><span class="refpurpose"> — A widget for displaying both trees and lists</span> </dt> <dt> <span class="refentrytitle"><a href="gtk4-gtktreeview-drag-and-drop.html">GtkTreeView drag-and-drop</a></span><span class="refpurpose"> — Interfaces for drag-and-drop support in GtkTreeView</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellview.html">GtkCellView</a></span><span class="refpurpose"> — A widget displaying a single row of a GtkTreeModel</span> </dt> <dt> <span class="refentrytitle"><a href="gtkiconview.html">GtkIconView</a></span><span class="refpurpose"> — A widget which displays a list of icons in a grid</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreesortable.html">GtkTreeSortable</a></span><span class="refpurpose"> — The interface for sortable models used by GtkTreeView</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreemodelsort.html">GtkTreeModelSort</a></span><span class="refpurpose"> — A GtkTreeModel which makes an underlying tree model sortable</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreemodelfilter.html">GtkTreeModelFilter</a></span><span class="refpurpose"> — A GtkTreeModel which hides parts of an underlying tree model</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcelllayout.html">GtkCellLayout</a></span><span class="refpurpose"> — An interface for packing cells</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellarea.html">GtkCellArea</a></span><span class="refpurpose"> — An abstract class for laying out GtkCellRenderers</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellareabox.html">GtkCellAreaBox</a></span><span class="refpurpose"> — A cell area that renders GtkCellRenderers into a row or a column</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellareacontext.html">GtkCellAreaContext</a></span><span class="refpurpose"> — Stores geometrical information for a series of rows in a GtkCellArea</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrenderer.html">GtkCellRenderer</a></span><span class="refpurpose"> — An object for rendering a single cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcelleditable.html">GtkCellEditable</a></span><span class="refpurpose"> — Interface for widgets that can be used for editing cells</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrendereraccel.html">GtkCellRendererAccel</a></span><span class="refpurpose"> — Renders a keyboard accelerator in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrenderercombo.html">GtkCellRendererCombo</a></span><span class="refpurpose"> — Renders a combobox in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrendererpixbuf.html">GtkCellRendererPixbuf</a></span><span class="refpurpose"> — Renders a pixbuf in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrendererprogress.html">GtkCellRendererProgress</a></span><span class="refpurpose"> — Renders numbers as progress bars</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrendererspin.html">GtkCellRendererSpin</a></span><span class="refpurpose"> — Renders a spin button in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrenderertext.html">GtkCellRendererText</a></span><span class="refpurpose"> — Renders text in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrenderertoggle.html">GtkCellRendererToggle</a></span><span class="refpurpose"> — Renders a toggle button in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkcellrendererspinner.html">GtkCellRendererSpinner</a></span><span class="refpurpose"> — Renders a spinning animation in a cell</span> </dt> <dt> <span class="refentrytitle"><a href="gtkliststore.html">GtkListStore</a></span><span class="refpurpose"> — A list-like data structure that can be used with the GtkTreeView</span> </dt> <dt> <span class="refentrytitle"><a href="gtktreestore.html">GtkTreeStore</a></span><span class="refpurpose"> — A tree-like data structure that can be used with the GtkTreeView</span> </dt> </dl></div> <div class="sect1">  <p> To create a tree or list in GTK, use the <a href="gtktreemodel.html#GtkTreeModel-struct"><span class="type">GtkTreeModel</span></a> interface in conjunction with the <a href="gtktreeview.html#GtkTreeView-struct"><span class="type">GtkTreeView</span></a> widget. This widget is designed around a <span class="emphasis"><em>Model/View/Controller</em></span> design and consists of four major parts: </p> <div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: disc; "> <li class="listitem"><p> The tree view widget (GtkTreeView) </p></li> <li class="listitem"><p> The view column (GtkTreeViewColumn) </p></li> <li class="listitem"><p> The cell renderers (GtkCellRenderer etc.) </p></li> <li class="listitem"><p> The model interface (GtkTreeModel) </p></li> </ul></div> <p> The <span class="emphasis"><em>View</em></span> is composed of the first three objects, while the last is the <span class="emphasis"><em>Model</em></span>. One of the prime benefits of the MVC design is that multiple views can be created of a single model. For example, a model mapping the file system could be created for a file manager. Many views could be created to display various parts of the file system, but only one copy need be kept in memory. </p> <p> The purpose of the cell renderers is to provide extensibility to the widget and to allow multiple ways of rendering the same type of data. For example, consider how to render a boolean variable. Should it render it as a string of <span class="quote">“<span class="quote">True</span>”</span> or <span class="quote">“<span class="quote">False</span>”</span>, <span class="quote">“<span class="quote">On</span>”</span> or <span class="quote">“<span class="quote">Off</span>”</span>, or should it be rendered as a checkbox? </p> <div class="sect2"> <div class="titlepage"><div><div><h3 class="title" id="id-1.4.17.2.6"> Creating a model</h3></div></div></div> <p> GTK provides two simple models that can be used: the <a href="gtkliststore.html#GtkListStore-struct"><span class="type">GtkListStore</span></a> and the <a href="gtktreestore.html#GtkTreeStore-struct"><span class="type">GtkTreeStore</span></a>. GtkListStore is used to model list widgets, while the GtkTreeStore models trees. It is possible to develop a new type of model, but the existing models should be satisfactory for all but the most specialized of situations. Creating the model is quite </p> <pre class="programlisting" data-language="c">GtkListStore *store = gtk_list_store_new (2, G_TYPE_STRING, G_TYPE_BOOLEAN);
</pre> <p> This creates a list store with two columns: a string column and a boolean column. Typically the 2 is never passed directly like that; usually an enum is created wherein the different columns are enumerated, followed by a token that represents the total number of columns. The next example will illustrate this, only using a tree store instead of a list store. Creating a tree store operates almost exactly the same. </p> <pre class="programlisting" data-language="c">enum
{
   TITLE_COLUMN,
   AUTHOR_COLUMN,
   CHECKED_COLUMN,
   N_COLUMNS
};

GtkTreeStore *store = gtk_tree_store_new (N_COLUMNS,       /* Total number of columns */
                                          G_TYPE_STRING,   /* Book title              */
                                          G_TYPE_STRING,   /* Author                  */
                                          G_TYPE_BOOLEAN); /* Is checked out?         */
</pre> <p> Adding data to the model is done using <a href="gtktreestore.html#gtk-tree-store-set"><code class="function">gtk_tree_store_set()</code></a> or <a href="gtkliststore.html#gtk-list-store-set"><code class="function">gtk_list_store_set()</code></a>, depending upon which sort of model was created. To do this, a <a href="gtktreemodel.html#GtkTreeIter-struct"><span class="type">GtkTreeIter</span></a> must be acquired. The iterator points to the location where data will be added. </p> <p> Once an iterator has been acquired, <a href="gtktreestore.html#gtk-tree-store-set"><code class="function">gtk_tree_store_set()</code></a> is used to apply data to the part of the model that the iterator points to. Consider the following example: </p> <pre class="programlisting" data-language="c">GtkTreeIter iter;

gtk_tree_store_append (store, &amp;iter, NULL);  /* Acquire an iterator */

gtk_tree_store_set (store, &amp;iter,
                    TITLE_COLUMN, "The Principle of Reason",
                    AUTHOR_COLUMN, "Martin Heidegger",
                    CHECKED_COLUMN, FALSE,
                    -1);
</pre> <p> Notice that the last argument is -1. This is always done because this is a variable-argument function and it needs to know when to stop processing arguments. It can be used to set the data in any or all columns in a given row. </p> <p> The third argument to <a href="gtktreestore.html#gtk-tree-store-append"><code class="function">gtk_tree_store_append()</code></a> is the parent iterator. It is used to add a row to a GtkTreeStore as a child of an existing row. This means that the new row will only be visible when its parent is visible and in its expanded state. Consider the following example: </p> <pre class="programlisting" data-language="c">GtkTreeIter iter1;  /* Parent iter */
GtkTreeIter iter2;  /* Child iter  */

gtk_tree_store_append (store, &amp;iter1, NULL);  /* Acquire a top-level iterator */
gtk_tree_store_set (store, &amp;iter1,
                    TITLE_COLUMN, "The Art of Computer Programming",
                    AUTHOR_COLUMN, "Donald E. Knuth",
                    CHECKED_COLUMN, FALSE,
                    -1);

gtk_tree_store_append (store, &amp;iter2, &amp;iter1);  /* Acquire a child iterator */
gtk_tree_store_set (store, &amp;iter2,
                    TITLE_COLUMN, "Volume 1: Fundamental Algorithms",
                    -1);

gtk_tree_store_append (store, &amp;iter2, &amp;iter1);
gtk_tree_store_set (store, &amp;iter2,
                    TITLE_COLUMN, "Volume 2: Seminumerical Algorithms",
                    -1);

gtk_tree_store_append (store, &amp;iter2, &amp;iter1);
gtk_tree_store_set (store, &amp;iter2,
                    TITLE_COLUMN, "Volume 3: Sorting and Searching",
                    -1);
</pre> </div> <div class="sect2"> <div class="titlepage"><div><div><h3 class="title" id="id-1.4.17.2.7"> Creating the view component</h3></div></div></div> <p> While there are several different models to choose from, there is only one view widget to deal with. It works with either the list or the tree store. Setting up a <a href="gtktreeview.html#GtkTreeView-struct"><span class="type">GtkTreeView</span></a> is not a difficult matter. It needs a <a href="gtktreemodel.html#GtkTreeModel-struct"><span class="type">GtkTreeModel</span></a> to know where to retrieve its data from. </p> <pre class="programlisting" data-language="c">GtkWidget *tree;

tree = gtk_tree_view_new_with_model (GTK_TREE_MODEL (store));
</pre> </div> <div class="sect2"> <div class="titlepage"><div><div><h3 class="title" id="id-1.4.17.2.8"> Columns and cell renderers</h3></div></div></div> <p> Once the <a href="gtktreeview.html#GtkTreeView-struct"><span class="type">GtkTreeView</span></a> widget has a model, it will need to know how to display the model. It does this with columns and cell renderers. </p> <p> Cell renderers are used to draw the data in the tree model in a way. There are a number of cell renderers that come with GTK, including the <a href="gtkcellrenderertext.html#GtkCellRendererText-struct"><span class="type">GtkCellRendererText</span></a>, <a href="gtkcellrendererpixbuf.html#GtkCellRendererPixbuf-struct"><span class="type">GtkCellRendererPixbuf</span></a> and the <a href="gtkcellrenderertoggle.html#GtkCellRendererToggle-struct"><span class="type">GtkCellRendererToggle</span></a>. It is relatively easy to write a custom renderer. </p> <p> A <a href="gtktreeviewcolumn.html#GtkTreeViewColumn-struct"><span class="type">GtkTreeViewColumn</span></a> is the object that GtkTreeView uses to organize the vertical columns in the tree view. It needs to know the name of the column to label for the user, what type of cell renderer to use, and which piece of data to retrieve from the model for a given row. </p> <pre class="programlisting" data-language="c">GtkCellRenderer *renderer;
GtkTreeViewColumn *column;

renderer = gtk_cell_renderer_text_new (&lt;!-- --&gt;);
column = gtk_tree_view_column_new_with_attributes ("Author",
                                                   renderer,
                                                   "text", AUTHOR_COLUMN,
                                                   NULL);
gtk_tree_view_append_column (GTK_TREE_VIEW (tree), column);
</pre> <p> At this point, all the steps in creating a displayable tree have been covered. The model is created, data is stored in it, a tree view is created and columns are added to it. </p> </div> <div class="sect2"> <div class="titlepage"><div><div><h3 class="title" id="id-1.4.17.2.9"> Selection handling</h3></div></div></div> <p> Most applications will need to not only deal with displaying data, but also receiving input events from users. To do this, simply get a reference to a selection object and connect to the <a href="gtktreeselection.html#GtkTreeSelection-changed"><span class="type">“changed”</span></a> signal. </p> <pre class="programlisting" data-language="c">/* Prototype for selection handler callback */
static void tree_selection_changed_cb (GtkTreeSelection *selection, gpointer data);

/* Setup the selection handler */
GtkTreeSelection *select;

select = gtk_tree_view_get_selection (GTK_TREE_VIEW (tree));
gtk_tree_selection_set_mode (select, GTK_SELECTION_SINGLE);
g_signal_connect (G_OBJECT (select), "changed",
                  G_CALLBACK (tree_selection_changed_cb),
                  NULL);
</pre> <p> Then to retrieve data for the row selected: </p> <pre class="programlisting" data-language="c">static void
tree_selection_changed_cb (GtkTreeSelection *selection, gpointer data)
{
  GtkTreeIter iter;
  GtkTreeModel *model;
  char *author;

  if (gtk_tree_selection_get_selected (selection, &amp;model, &amp;iter))
    {
      gtk_tree_model_get (model, &amp;iter, AUTHOR_COLUMN, &amp;author, -1);

      g_print ("You selected a book by s\n", author);

      g_free (author);
    }
}
</pre> </div> <div class="sect2"> <div class="titlepage"><div><div><h3 class="title" id="id-1.4.17.2.10"> Simple Example</h3></div></div></div> <p> Here is a simple example of using a <a href="gtktreeview.html#GtkTreeView-struct"><span class="type">GtkTreeView</span></a> widget in context of the other widgets. It simply creates a simple model and view, and puts them together. Note that the model is never populated with data — that is left as an exercise for the reader. More information can be found on this in the <a href="gtktreemodel.html#GtkTreeModel-struct"><span class="type">GtkTreeModel</span></a> section. </p> <pre class="programlisting" data-language="c">enum
{
   TITLE_COLUMN,
   AUTHOR_COLUMN,
   CHECKED_COLUMN,
   N_COLUMNS
};

void
setup_tree (void)
{
   GtkTreeStore *store;
   GtkWidget *tree;
   GtkTreeViewColumn *column;
   GtkCellRenderer *renderer;

   /* Create a model.  We are using the store model for now, though we
    * could use any other GtkTreeModel */
   store = gtk_tree_store_new (N_COLUMNS,
                               G_TYPE_STRING,
                               G_TYPE_STRING,
                               G_TYPE_BOOLEAN);

   /* custom function to fill the model with data */
   populate_tree_model (store);

   /* Create a view */
   tree = gtk_tree_view_new_with_model (GTK_TREE_MODEL (store));

   /* The view now holds a reference.  We can get rid of our own
    * reference */
   g_object_unref (G_OBJECT (store));

   /* Create a cell render and arbitrarily make it red for demonstration
    * purposes */
   renderer = gtk_cell_renderer_text_new (&lt;!-- --&gt;);
   g_object_set (G_OBJECT (renderer),
                 "foreground", "red",
                 NULL);

   /* Create a column, associating the "text" attribute of the
    * cell_renderer to the first column of the model */
   column = gtk_tree_view_column_new_with_attributes ("Author", renderer,
                                                      "text", AUTHOR_COLUMN,
                                                      NULL);

   /* Add the column to the view. */
   gtk_tree_view_append_column (GTK_TREE_VIEW (tree), column);

   /* Second column.. title of the book. */
   renderer = gtk_cell_renderer_text_new (&lt;!-- --&gt;);
   column = gtk_tree_view_column_new_with_attributes ("Title",
                                                      renderer,
                                                      "text", TITLE_COLUMN,
                                                      NULL);
   gtk_tree_view_append_column (GTK_TREE_VIEW (tree), column);

   /* Last column.. whether a book is checked out. */
   renderer = gtk_cell_renderer_toggle_new (&lt;!-- --&gt;);
   column = gtk_tree_view_column_new_with_attributes ("Checked out",
                                                      renderer,
                                                      "active", CHECKED_COLUMN,
                                                      NULL);
   gtk_tree_view_append_column (GTK_TREE_VIEW (tree), column);

   /* Now we can manipulate the view just like any other GTK widget */
   ...
}
</pre> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2020 The GNOME Project<br>Licensed under the GNU Lesser General Public License version 2.1 or later.<br>
    <a href="https://developer-old.gnome.org/gtk4/4.0/TreeWidgetObjects.html" class="_attribution-link">https://developer-old.gnome.org/gtk4/4.0/TreeWidgetObjects.html</a>
  </p>
</div>
