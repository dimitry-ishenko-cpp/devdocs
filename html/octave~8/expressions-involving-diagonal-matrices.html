<div class="subsection" id="Expressions-Involving-Diagonal-Matrices">   <h1 class="subsection">21.2.1 Expressions Involving Diagonal Matrices</h1>  <p>Assume <var>D</var> is a diagonal matrix. If <var>M</var> is a full matrix, then <code>D*M</code> will scale the rows of <var>M</var>. That means, if <code>S = D*M</code>, then for each pair of indices i,j it holds </p> <pre class="example" data-language="matlab">S(i,j) = D(i,i) * M(i,j).</pre> <p>Similarly, <code>M*D</code> will do a column scaling. </p> <p>The matrix <var>D</var> may also be rectangular, m-by-n where <code>m != n</code>. If <code>m &lt; n</code>, then the expression <code>D*M</code> is equivalent to </p> <pre class="example" data-language="matlab">D(:,1:m) * M(1:m,:),</pre> <p>i.e., trailing <code>n-m</code> rows of <var>M</var> are ignored. If <code>m &gt; n</code>, then <code>D*M</code> is equivalent to </p> <pre class="example" data-language="matlab">[D(1:n,:) * M; zeros(m-n, columns (M))],</pre> <p>i.e., null rows are appended to the result. The situation for right-multiplication <code>M*D</code> is analogous. </p>  <p>The expressions <code>D \ M</code> and <code>M / D</code> perform inverse scaling. They are equivalent to solving a diagonal (or rectangular diagonal) in a least-squares minimum-norm sense. In exact arithmetic, this is equivalent to multiplying by a pseudoinverse. The pseudoinverse of a rectangular diagonal matrix is again a rectangular diagonal matrix with swapped dimensions, where each nonzero diagonal element is replaced by its reciprocal. The matrix division algorithms do, in fact, use division rather than multiplication by reciprocals for better numerical accuracy; otherwise, they honor the above definition. Note that a diagonal matrix is never truncated due to ill-conditioning; otherwise, it would not be of much use for scaling. This is typically consistent with linear algebra needs. A full matrix that only happens to be diagonal (and is thus not a special object) is of course treated normally. </p> <p>Multiplication and division by diagonal matrices work efficiently also when combined with sparse matrices, i.e., <code>D*S</code>, where <var>D</var> is a diagonal matrix and <var>S</var> is a sparse matrix scales the rows of the sparse matrix and returns a sparse matrix. The expressions <code>S*D</code>, <code>D\S</code>, <code>S/D</code> work analogically. </p> <p>If <var>D1</var> and <var>D2</var> are both diagonal matrices, then the expressions </p> <pre class="example" data-language="matlab">D1 + D2
D1 - D2
D1 * D2
D1 / D2
D1 \ D2</pre> <p>again produce diagonal matrices, provided that normal dimension matching rules are obeyed. The relations used are same as described above. </p> <p>Also, a diagonal matrix <var>D</var> can be multiplied or divided by a scalar, or raised to a scalar power if it is square, producing diagonal matrix result in all cases. </p> <p>A diagonal matrix can also be transposed or conjugate-transposed, giving the expected result. Extracting a leading submatrix of a diagonal matrix, i.e., <code>D(1:m,1:n)</code>, will produce a diagonal matrix, other indexing expressions will implicitly convert to full matrix. </p> <p>Adding a diagonal matrix to a full matrix only operates on the diagonal elements. Thus, </p> <pre class="example" data-language="matlab">A = A + eps * eye (n)</pre> <p>is an efficient method of augmenting the diagonal of a matrix. Subtraction works analogically. </p> <p>When involved in expressions with other element-by-element operators, <code>.*</code>, <code>./</code>, <code>.\</code> or <code>.^</code>, an implicit conversion to full matrix will take place. This is not always strictly necessary but chosen to facilitate better consistency with <small>MATLAB</small>. </p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996â€“2023 The Octave Project Developers<br>Permission is granted to make and distribute verbatim copies of this manual provided the copyright notice and this permission notice are preserved on all copies.<br/>Permission is granted to copy and distribute modified versions of this manual under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</br>Permission is granted to copy and distribute translations of this manual into another language, under the above conditions for modified versions.<br>
    <a href="https://docs.octave.org/v8.1.0/Expressions-Involving-Diagonal-Matrices.html" class="_attribution-link">https://docs.octave.org/v8.1.0/Expressions-Involving-Diagonal-Matrices.html</a>
  </p>
</div>
