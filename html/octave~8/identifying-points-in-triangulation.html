<div class="subsection" id="Identifying-Points-in-Triangulation">   <h1 class="subsection">30.1.2 Identifying Points in Triangulation</h1> <p>It is often necessary to identify whether a particular point in the N-dimensional space is within the Delaunay tessellation of a set of points in this N-dimensional space, and if so which N-simplex contains the point and which point in the tessellation is closest to the desired point. The functions <code>tsearch</code> and <code>dsearch</code> perform this function in a triangulation, and <code>tsearchn</code> and <code>dsearchn</code> in an N-dimensional tessellation. </p> <p>To identify whether a particular point represented by a vector <var>p</var> falls within one of the simplices of an N-simplex, we can write the Cartesian coordinates of the point in a parametric form with respect to the N-simplex. This parametric form is called the Barycentric Coordinates of the point. If the points defining the N-simplex are given by <var>N</var> + 1 vectors <code><var>t</var>(<var>i</var>,:)</code>, then the Barycentric coordinates defining the point <var>p</var> are given by </p> <pre class="example" data-language="matlab">p = beta * t</pre> <p>where <var>beta</var> contains <var>N</var> + 1 values that together as a vector represent the Barycentric coordinates of the point <var>p</var>. To ensure a unique solution for the values of <var>beta</var> an additional criteria of </p> <pre class="example" data-language="matlab">sum (beta) == 1</pre> <p>is imposed, and we can therefore write the above as </p> <pre class="example" data-language="matlab">p - t(end, :) = beta(1:end-1) * (t(1:end-1, :)
                - ones (N, 1) * t(end, :)</pre> <p>Solving for <var>beta</var> we can then write </p> <pre class="example" data-language="matlab">beta(1:end-1) = (p - t(end, :)) /
                (t(1:end-1, :) - ones (N, 1) * t(end, :))
beta(end) = sum (beta(1:end-1))</pre> <p>which gives the formula for the conversion of the Cartesian coordinates of the point <var>p</var> to the Barycentric coordinates <var>beta</var>. An important property of the Barycentric coordinates is that for all points in the N-simplex </p> <pre class="example" data-language="matlab">0 &lt;= beta(i) &lt;= 1</pre> <p>Therefore, the test in <code>tsearch</code> and <code>tsearchn</code> essentially only needs to express each point in terms of the Barycentric coordinates of each of the simplices of the N-simplex and test the values of <var>beta</var>. This is exactly the implementation used in <code>tsearchn</code>. <code>tsearch</code> is optimized for 2-dimensions and the Barycentric coordinates are not explicitly formed. </p> <dl class="def"> <dt id="index-tsearch">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>tsearch</strong> <em>(<var>x</var>, <var>y</var>, <var>t</var>, <var>xi</var>, <var>yi</var>)</em><a href="#index-tsearch" class="copiable-anchor"> ¶</a></span>
</dt> <dd>
<p>Search for the enclosing Delaunay convex hull. </p> <p>For <code><var>t</var> = delaunay (<var>x</var>, <var>y</var>)</code>, finds the index in <var>t</var> containing the points <code>(<var>xi</var>, <var>yi</var>)</code>. For points outside the convex hull, <var>idx</var> is NaN. </p> <p><strong>See also:</strong> <a href="delaunay-triangulation.html#XREFdelaunay">delaunay</a>, <a href="delaunay-triangulation.html#XREFdelaunayn">delaunayn</a>. </p>
</dd>
</dl> <dl class="def"> <dt id="index-tsearchn">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>tsearchn</strong> <em>(<var>x</var>, <var>t</var>, <var>xi</var>)</em><a href="#index-tsearchn" class="copiable-anchor"> ¶</a></span>
</dt> <dt id="index-tsearchn-1">
<span class="category">: </span><span><em>[<var>idx</var>, <var>p</var>] =</em> <strong>tsearchn</strong> <em>(<var>x</var>, <var>t</var>, <var>xi</var>)</em><a href="#index-tsearchn-1" class="copiable-anchor"> ¶</a></span>
</dt> <dd>
<p>Search for the enclosing Delaunay convex hull. </p> <p>For <code><var>t</var> = delaunayn (<var>x</var>)</code>, finds the index in <var>t</var> containing the points <var>xi</var>. For points outside the convex hull, <var>idx</var> is NaN. </p> <p>If requested <code>tsearchn</code> also returns the Barycentric coordinates <var>p</var> of the enclosing triangles. </p> <p><strong>See also:</strong> <a href="delaunay-triangulation.html#XREFdelaunay">delaunay</a>, <a href="delaunay-triangulation.html#XREFdelaunayn">delaunayn</a>. </p>
</dd>
</dl> <p>An example of the use of <code>tsearch</code> can be seen with the simple triangulation </p> <pre class="example" data-language="matlab">x = [-1; -1; 1; 1];
y = [-1; 1; -1; 1];
tri = [1, 2, 3; 2, 3, 4];</pre> <p>consisting of two triangles defined by <var>tri</var>. We can then identify which triangle a point falls in like </p> <pre class="example" data-language="matlab">tsearch (x, y, tri, -0.5, -0.5)
⇒ 1
tsearch (x, y, tri, 0.5, 0.5)
⇒ 2</pre> <p>and we can confirm that a point doesn’t lie within one of the triangles like </p> <pre class="example" data-language="matlab">tsearch (x, y, tri, 2, 2)
⇒ NaN</pre> <p>The <code>dsearch</code> and <code>dsearchn</code> find the closest point in a tessellation to the desired point. The desired point does not necessarily have to be in the tessellation, and even if it the returned point of the tessellation does not have to be one of the vertices of the N-simplex within which the desired point is found. </p> <dl class="def"> <dt id="index-dsearch">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>dsearch</strong> <em>(<var>x</var>, <var>y</var>, <var>tri</var>, <var>xi</var>, <var>yi</var>)</em><a href="#index-dsearch" class="copiable-anchor"> ¶</a></span>
</dt> <dt id="index-dsearch-1">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>dsearch</strong> <em>(<var>x</var>, <var>y</var>, <var>tri</var>, <var>xi</var>, <var>yi</var>, <var>s</var>)</em><a href="#index-dsearch-1" class="copiable-anchor"> ¶</a></span>
</dt> <dd>
<p>Return the index <var>idx</var> of the closest point in <code><var>x</var>, <var>y</var></code> to the elements <code>[<var>xi</var>(:), <var>yi</var>(:)]</code>. </p> <p>The variable <var>s</var> is accepted for compatibility but is ignored. </p> <p><strong>See also:</strong> <a href="#XREFdsearchn">dsearchn</a>, <a href="#XREFtsearch">tsearch</a>. </p>
</dd>
</dl> <dl class="def"> <dt id="index-dsearchn">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>dsearchn</strong> <em>(<var>x</var>, <var>tri</var>, <var>xi</var>)</em><a href="#index-dsearchn" class="copiable-anchor"> ¶</a></span>
</dt> <dt id="index-dsearchn-1">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>dsearchn</strong> <em>(<var>x</var>, <var>tri</var>, <var>xi</var>, <var>outval</var>)</em><a href="#index-dsearchn-1" class="copiable-anchor"> ¶</a></span>
</dt> <dt id="index-dsearchn-2">
<span class="category">: </span><span><em><var>idx</var> =</em> <strong>dsearchn</strong> <em>(<var>x</var>, <var>xi</var>)</em><a href="#index-dsearchn-2" class="copiable-anchor"> ¶</a></span>
</dt> <dt id="index-dsearchn-3">
<span class="category">: </span><span><em>[<var>idx</var>, <var>d</var>] =</em> <strong>dsearchn</strong> <em>(…)</em><a href="#index-dsearchn-3" class="copiable-anchor"> ¶</a></span>
</dt> <dd>
<p>Return the index <var>idx</var> of the closest point in <var>x</var> to the elements <var>xi</var>. </p> <p>If <var>outval</var> is supplied, then the values of <var>xi</var> that are not contained within one of the simplices <var>tri</var> are set to <var>outval</var>. Generally, <var>tri</var> is returned from <code>delaunayn (<var>x</var>)</code>. </p> <p>The optional output <var>d</var> contains a column vector of distances between the query points <var>xi</var> and the nearest simplex points <var>x</var>. </p> <p><strong>See also:</strong> <a href="#XREFdsearch">dsearch</a>, <a href="#XREFtsearch">tsearch</a>. </p>
</dd>
</dl> <p>An example of the use of <code>dsearch</code>, using the above values of <var>x</var>, <var>y</var> and <var>tri</var> is </p> <pre class="example" data-language="matlab">dsearch (x, y, tri, -2, -2)
⇒ 1</pre> <p>If you wish the points that are outside the tessellation to be flagged, then <code>dsearchn</code> can be used as </p> <pre class="example" data-language="matlab">dsearchn ([x, y], tri, [-2, -2], NaN)
⇒ NaN
dsearchn ([x, y], tri, [-0.5, -0.5], NaN)
⇒ 1</pre> <p>where the point outside the tessellation are then flagged with <code>NaN</code>. </p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996–2023 The Octave Project Developers<br>Permission is granted to make and distribute verbatim copies of this manual provided the copyright notice and this permission notice are preserved on all copies.<br/>Permission is granted to copy and distribute modified versions of this manual under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</br>Permission is granted to copy and distribute translations of this manual into another language, under the above conditions for modified versions.<br>
    <a href="https://docs.octave.org/v8.1.0/Identifying-Points-in-Triangulation.html" class="_attribution-link">https://docs.octave.org/v8.1.0/Identifying-Points-in-Triangulation.html</a>
  </p>
</div>
