<h1>webNavigation.onReferenceFragmentUpdated</h1>
<div class="section-content"><p>Fired if the <a href="https://en.wikipedia.org/wiki/Fragment_identifier" target="_blank">fragment identifier</a> for a page is changed. For example, if a page implements a table of contents using fragments, and the user clicks an entry in the table of contents, this event will fire. All future events for this frame will use the updated URL.</p></div>
<section aria-labelledby="syntax"><h2 id="syntax">Syntax</h2>
<div class="section-content">
<div class="code-example"><pre data-language="js">browser<span class="token punctuation">.</span>webNavigation<span class="token punctuation">.</span>onReferenceFragmentUpdated<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>
  listener<span class="token punctuation">,</span>                   <span class="token comment">// function</span>
  filter                      <span class="token comment">// optional object</span>
<span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>webNavigation<span class="token punctuation">.</span>onReferenceFragmentUpdated<span class="token punctuation">.</span><span class="token function">removeListener</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span>
browser<span class="token punctuation">.</span>webNavigation<span class="token punctuation">.</span>onReferenceFragmentUpdated<span class="token punctuation">.</span><span class="token function">hasListener</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span>
</pre></div> <p>Events have three functions:</p> <dl> <dt id="addlistenercallback"><code>addListener(callback)</code></dt> <dd> <p>Adds a listener to this event.</p> </dd> <dt id="removelistenerlistener"><code>removeListener(listener)</code></dt> <dd> <p>Stop listening to this event. The <code>listener</code> argument is the listener to remove.</p> </dd> <dt id="haslistenerlistener"><code>hasListener(listener)</code></dt> <dd> <p>Check whether <code>listener</code> is registered for this event. Returns <code>true</code> if it is listening, <code>false</code> otherwise.</p> </dd> </dl>
</div></section><section aria-labelledby="addlistener_syntax"><h2 id="addlistener_syntax">addListener syntax</h2>
</section><section aria-labelledby="parameters"><h3 id="parameters">Parameters</h3>
<div class="section-content"><dl> <dt id="callback"><code>callback</code></dt> <dd> <p>Function that will be called when this event occurs. The function will be passed the following arguments:</p> <dl> <dt id="details"><code>details</code></dt> <dd> <p><code>object</code>. Details about the navigation event. See the <a href="#details_2">details</a> section for more information.</p> </dd> </dl> </dd> <dt id="filter">
<code>filter</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p><code>object</code>. An object containing a single property <code>url</code>, which is an <code>Array</code> of <a href="../events/urlfilter.html"><code>events.UrlFilter</code></a> objects. If you include this parameter, then the event will fire only for transitions to URLs which match at least one <code>UrlFilter</code> in the array. If you omit this parameter, the event will fire for all transitions.</p> </dd> </dl></div></section><section aria-labelledby="additional_objects"><h2 id="additional_objects">Additional objects</h2>
</section><section aria-labelledby="details_2"><h3 id="details_2">details</h3>
<div class="section-content"><dl> <dt id="tabid"><code>tabId</code></dt> <dd> <p><code>integer</code>. The ID of the tab in which the navigation is about to occur.</p> </dd> <dt id="url"><code>url</code></dt> <dd> <p><code>string</code>. The URL to which the given frame will navigate.</p> </dd> <dt id="processid"><code>processId</code></dt> <dd> <p><code>integer</code>. The ID of the process in which this tab is being rendered.</p> </dd> <dt id="frameid"><code>frameId</code></dt> <dd> <p><code>integer</code>. Frame in which the navigation will occur. <code>0</code> indicates that navigation happens in the tab's top-level browsing context, not in a nested <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a>. A positive value indicates that navigation happens in a nested iframe. Frame IDs are unique for a given tab and process.</p> </dd> <dt id="timestamp"><code>timeStamp</code></dt> <dd> <p><code>number</code>. The time that the fragment identifier for the page was changed, in <a href="https://en.wikipedia.org/wiki/Unix_time" target="_blank">milliseconds since the epoch</a>.</p> </dd> <dt id="transitiontype"><code>transitionType</code></dt> <dd> <p><code><a href="transitiontype.html"><code>transitionType</code></a></code>. The reason for the navigation: for example, <code>"link"</code> if the user clicked a link.</p> </dd> <dt id="transitionqualifiers"><code>transitionQualifiers</code></dt> <dd> <p><code>Array</code> of <a href="transitionqualifier.html"><code>transitionQualifier</code></a>. Extra information about the navigation: for example, whether there was a server or client redirect.</p> </dd> </dl></div></section><h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>onReferenceFragmentUpdated</code></th>
<td class="bc-supports-yes"><details><summary>Yes</summary>If the filter parameter is empty, Chrome matches all URLs.</details></td>
<td class="bc-supports-yes"><details><summary>14</summary>Filtering is not supported.</details></td>
<td class="bc-supports-yes"><details><summary>45</summary>["Filtering is supported from version 50.", "If the filter parameter is empty, Firefox raises an exception."]</details></td>
<td>?</td>
<td class="bc-supports-yes"><details><summary>17</summary>If the filter parameter is empty, Opera matches all URLs.</details></td>
<td class="bc-supports-no">No</td>
<td>?</td>
<td>?</td>
<td class="bc-supports-yes"><details><summary>48</summary>["Filtering is supported from version 50.", "If the filter parameter is empty, Firefox raises an exception."]</details></td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td>?</td>
</tr>
<tr>
<th><code>transitionQualifiers</code></th>
<td class="bc-supports-yes">Yes</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-yes">48</td>
<td>?</td>
<td class="bc-supports-yes">17</td>
<td class="bc-supports-no">No</td>
<td>?</td>
<td>?</td>
<td class="bc-supports-yes">48</td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td>?</td>
</tr>
<tr>
<th><code>transitionType</code></th>
<td class="bc-supports-yes">Yes</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-yes">48</td>
<td>?</td>
<td class="bc-supports-yes">17</td>
<td class="bc-supports-no">No</td>
<td>?</td>
<td>?</td>
<td class="bc-supports-yes">48</td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td>?</td>
</tr>
</tbody>
</table></div>
<section aria-labelledby="examples"><h2 id="examples">Examples</h2>
<div class="section-content">
<p>Logs the target URLs and extra transition information for <code>onReferenceFragmentUpdated</code>, if the target URL's hostname contains "example.com" or starts with "developer".</p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> filter <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span>
  <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">hostContains</span><span class="token operator">:</span> <span class="token string">"example.com"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">hostPrefix</span><span class="token operator">:</span> <span class="token string">"developer"</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">logOnReferenceFragmentUpdated</span><span class="token punctuation">(</span><span class="token parameter">details</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">onReferenceFragmentUpdated: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>details<span class="token punctuation">.</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Transition type: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>details<span class="token punctuation">.</span>transitionType<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Transition qualifiers: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>details<span class="token punctuation">.</span>transitionQualifiers<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>webNavigation<span class="token punctuation">.</span>onReferenceFragmentUpdated<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>logOnReferenceFragmentUpdated<span class="token punctuation">,</span> filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <div class="notecard note" id="sect2"> <p><strong>Note:</strong> This API is based on Chromium's <a href="https://developer.chrome.com/docs/extensions/reference/webNavigation/#event-onBeforeNavigate" target="_blank"><code>chrome.webNavigation</code></a> API. This documentation is derived from <a href="https://chromium.googlesource.com/chromium/src/+/master/chrome/common/extensions/api/web_navigation.json" target="_blank"><code>web_navigation.json</code></a> in the Chromium code.</p> </div>
</div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation/onReferenceFragmentUpdated" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/webNavigation/onReferenceFragmentUpdated</a>
  </p>
</div>
