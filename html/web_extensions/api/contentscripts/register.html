<h1>contentScripts.register()</h1>
<div class="section-content">
<p>Use this function to register one or more content scripts.</p> <p>It accepts one parameter, which is an object with similar properties to the objects given in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> manifest key (but note that <code>content_scripts</code> is an array of objects, while the argument to <code>register()</code> is a single object).</p> <p>This is an asynchronous function that returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a>.</p>
</div>
<section aria-labelledby="syntax"><h2 id="syntax">Syntax</h2>
<div class="section-content"><div class="code-example"><pre data-language="js"><span class="token keyword">let</span> registering <span class="token operator">=</span> browser<span class="token punctuation">.</span>contentScripts<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span>
  contentScriptOptions       <span class="token comment">// object</span>
<span class="token punctuation">)</span>
</pre></div></div></section><section aria-labelledby="parameters"><h3 id="parameters">Parameters</h3>
<div class="section-content"><dl> <dt id="contentscriptoptions"><code>contentScriptOptions</code></dt> <dd> <p><code>object</code>. A <code>RegisteredContentScriptOptions</code> object representing the content scripts to register. It has similar syntax to the objects in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> manifest key array. The differences are:</p> <ul> <li>property names use camelCase, rather than underscores (for example, <code>excludeMatches</code>, not <code>exclude_matches</code>
</li> <li>the <code>js</code> and <code>css</code> properties allow you to register strings as well as URLs, so their syntax has to distinguish these types.</li> </ul> <p>The <code>RegisteredContentScriptOptions</code> object has the following properties:</p> <dl> <dt id="allframes">
<code>allFrames</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>Same as <code>all_frames</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> <dt id="cookiestoreid">
<code>cookieStoreId</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>A string or array of strings. Registers the content script in the tabs that belong to one or more cookie store IDs. This enables scripts to be registered for all default or non-contextual identity tabs, private browsing tabs (if the <a href="https://support.mozilla.org/en-US/kb/extensions-private-browsing" target="_blank">extension is enabled in private browsing</a>), the tabs of a <a href="../../work_with_contextual_identities.html">contextual identity</a>, or a combination of these.</p> </dd> <dt id="css">
<code>css</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>An array of objects. Each object has either a property named <code>file</code>, which is a URL starting at the extension's manifest.json and pointing to a CSS file to register, or a property named <code>code</code>, which is some CSS code to register.</p> </dd> <dt id="excludeglobs">
<code>excludeGlobs</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>Same as <code>exclude_globs</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> <dt id="excludematches">
<code>excludeMatches</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>Same as <code>exclude_matches</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> <dt id="includeglobs">
<code>includeGlobs</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>Same as <code>include_globs</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> <dt id="js">
<code>js</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>An array of objects. Each object has either a property named <code>file</code>, which is a URL starting at the extension's manifest.json and pointing to a JavaScript file to register, or a property named <code>code</code>, which is some JavaScript code to register.</p> </dd> <dt id="matchaboutblank">
<code>matchAboutBlank</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>Same as <code>match_about_blank</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> <dt id="matches"><code>matches</code></dt> <dd> <p>Same as <code>matches</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> <dt id="runat">
<code>runAt</code> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>Same as <code>run_at</code> in the <a href="../../manifest.json/content_scripts.html"><code>content_scripts</code></a> key.</p> </dd> </dl> </dd> </dl></div></section><section aria-labelledby="return_value"><h3 id="return_value">Return value</h3>
<div class="section-content">
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> that will be fulfilled with a <a href="registeredcontentscript.html"><code>contentScripts.RegisteredContentScript</code></a> object that you can use to unregister the content scripts.</p> <p>Currently, content scripts are unregistered when the related extension page (from which the content scripts were registered) is unloaded, so you should register a content script from an extension page that persists at least as long as you want the content scripts to stay registered.</p>
</div></section><h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>register</code></th>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">59</td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td>?</td>
<td>?</td>
<td class="bc-supports-yes">59</td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td>?</td>
</tr>
<tr>
<th><code>cookieStoreId</code></th>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">97</td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td>?</td>
<td>?</td>
<td class="bc-supports-yes">97</td>
<td>?</td>
<td class="bc-supports-no">No</td>
<td>?</td>
</tr>
</tbody>
</table></div>
<section aria-labelledby="examples"><h2 id="examples">Examples</h2>
<div class="section-content">
<p>This example registers the <code>defaultCode</code> content script for all <code>.org</code> URLs:</p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> defaultHosts <span class="token operator">=</span> <span class="token string">"*://*.org/*"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> defaultCode <span class="token operator">=</span> <span class="token string">"document.body.innerHTML = '&lt;h1&gt;This page has been eaten&lt;h1&gt;'"</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">register</span><span class="token punctuation">(</span><span class="token parameter">hosts<span class="token punctuation">,</span> code</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">return</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span>contentScripts<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">matches</span><span class="token operator">:</span> <span class="token punctuation">[</span>hosts<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">js</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>code<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">runAt</span><span class="token operator">:</span> <span class="token string">"document_idle"</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>

<span class="token keyword">let</span> registered <span class="token operator">=</span> <span class="token function">register</span><span class="token punctuation">(</span>defaultHosts<span class="token punctuation">,</span> defaultCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>This code registers the JS file at content_scripts/example.js:</p> <div class="code-example"><pre data-language="js"><span class="token keyword">const</span> scriptObj <span class="token operator">=</span> <span class="token keyword">await</span> browser<span class="token punctuation">.</span>contentScripts<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string-property property">"js"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">file</span><span class="token operator">:</span> <span class="token string">"/content_scripts/example.js"</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"&lt;all_urls&gt;"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string-property property">"allFrames"</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token string-property property">"runAt"</span><span class="token operator">:</span> <span class="token string">"document_start"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div>
</div></section><section aria-labelledby="example_extensions"><h3 id="example_extensions">Example extensions</h3>
<div class="section-content"><ul><li><a href="https://github.com/mdn/webextensions-examples/tree/master/content-script-register" target="_blank">content-script-register</a></li></ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts/register" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/API/contentScripts/register</a>
  </p>
</div>
