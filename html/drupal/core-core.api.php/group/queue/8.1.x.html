<h1 id="page-subtitle">Queue operations</h1>      <p>Queue items to allow later processing.</p> <p>The queue system allows placing items in a queue and processing them later. The system tries to ensure that only one consumer can process an item.</p> <p>Before a queue can be used it needs to be created by <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-createqueue/8.1.x.html" title="Creates a queue." class="local">Drupal\Core\Queue\QueueInterface::createQueue</a>().</p> <p>Items can be added to the queue by passing an arbitrary data object to <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-createitem/8.1.x.html" title="Adds a queue item and store it directly to the queue." class="local">Drupal\Core\Queue\QueueInterface::createItem</a>().</p> <p>To process an item, call <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-claimitem/8.1.x.html" title="Claims an item in the queue for processing." class="local">Drupal\Core\Queue\QueueInterface::claimItem</a>() and specify how long you want to have a lease for working on that item. When finished processing, the item needs to be deleted by calling <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-deleteitem/8.1.x.html" title="Deletes a finished item from the queue." class="local">Drupal\Core\Queue\QueueInterface::deleteItem</a>(). If the consumer dies, the item will be made available again by the <a href="../../../core-lib-drupal-core-queue-queueinterface.php/interface/queueinterface/8.1.x.html" title="Interface for a queue." class="local">Drupal\Core\Queue\QueueInterface</a> implementation once the lease expires. Another consumer will then be able to receive it when calling <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-claimitem/8.1.x.html" title="Claims an item in the queue for processing." class="local">Drupal\Core\Queue\QueueInterface::claimItem</a>(). Due to this, the processing code should be aware that an item might be handed over for processing more than once.</p> <p>The $item object used by the <a href="../../../core-lib-drupal-core-queue-queueinterface.php/interface/queueinterface/8.1.x.html" title="Interface for a queue." class="local">Drupal\Core\Queue\QueueInterface</a> can contain arbitrary metadata depending on the implementation. Systems using the interface should only rely on the data property which will contain the information passed to <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-createitem/8.1.x.html" title="Adds a queue item and store it directly to the queue." class="local">Drupal\Core\Queue\QueueInterface::createItem</a>(). The full queue item returned by <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-claimitem/8.1.x.html" title="Claims an item in the queue for processing." class="local">Drupal\Core\Queue\QueueInterface::claimItem</a>() needs to be passed to <a href="../../../core-lib-drupal-core-queue-queueinterface.php/function/queueinterface-deleteitem/8.1.x.html" title="Deletes a finished item from the queue." class="local">Drupal\Core\Queue\QueueInterface::deleteItem</a>() once processing is completed.</p> <p>There are two kinds of queue backends available: reliable, which preserves the order of messages and guarantees that every item will be executed at least once. The non-reliable kind only does a best effort to preserve order in messages and to execute them at least once but there is a small chance that some items get lost. For example, some distributed back-ends like Amazon SQS will be managing jobs for a large set of producers and consumers where a strict FIFO ordering will likely not be preserved. Another example would be an in-memory queue backend which might lose items if it crashes. However, such a backend would be able to deal with significantly more writes than a reliable queue and for many tasks this is more important. See <a href="../../../core-modules-aggregator-aggregator.module/function/aggregator_cron/8.1.x.html" title="Implements hook_cron()." class="local">aggregator_cron</a>() for an example of how to effectively use a non-reliable queue. Another example is doing Twitter statistics -- the small possibility of losing a few items is insignificant next to power of the queue being able to keep up with writes. As described in the processing section, regardless of the queue being reliable or not, the processing code should be aware that an item might be handed over for processing more than once (because the processing code might time out before it finishes).</p> <h3>File</h3> 
<dl> <dt>core/<a href="https://api.drupal.org/api/drupal/core%21core.api.php/8.1.x">core.api.php</a>, line 1768</dt> <dd>Documentation landing page and topics, plus core library hooks.</dd> </dl> <h3>Classes</h3>  <table> <thead> <tr> <th scope="col"> Name </th> <th scope="col"> Location </th> <th scope="col"> Description </th> </tr> </thead> <tbody> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-queue-batch.php/class/batch/8.1.x.html">Batch</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Queue/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Queue%21Batch.php/8.1.x">Batch.php</a> </td> <td data-th="Description"> Defines a batch queue handler used by the Batch API. </td> </tr> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-queue-batchmemory.php/class/batchmemory/8.1.x.html">BatchMemory</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Queue/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Queue%21BatchMemory.php/8.1.x">BatchMemory.php</a> </td> <td data-th="Description"> Defines a batch queue handler used by the Batch API for non-progressive batches. </td> </tr> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-queue-databasequeue.php/class/databasequeue/8.1.x.html">DatabaseQueue</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Queue/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Queue%21DatabaseQueue.php/8.1.x">DatabaseQueue.php</a> </td> <td data-th="Description"> Default queue implementation. </td> </tr> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-queue-memory.php/class/memory/8.1.x.html">Memory</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Queue/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Queue%21Memory.php/8.1.x">Memory.php</a> </td> <td data-th="Description"> Static queue implementation. </td> </tr> </tbody> </table>  <h3>Interfaces</h3>  <table> <thead> <tr> <th scope="col"> Name </th> <th scope="col"> Location </th> <th scope="col"> Description </th> </tr> </thead> <tbody> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-queue-queueinterface.php/interface/queueinterface/8.1.x.html">QueueInterface</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Queue/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Queue%21QueueInterface.php/8.1.x">QueueInterface.php</a> </td> <td data-th="Description"> Interface for a queue. </td> </tr> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-queue-reliablequeueinterface.php/interface/reliablequeueinterface/8.1.x.html">ReliableQueueInterface</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Queue/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Queue%21ReliableQueueInterface.php/8.1.x">ReliableQueueInterface.php</a> </td> <td data-th="Description"> Reliable queue interface. </td> </tr> </tbody> </table><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!core.api.php/group/queue/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!core.api.php/group/queue/8.1.x</a>
  </p>
</div>
