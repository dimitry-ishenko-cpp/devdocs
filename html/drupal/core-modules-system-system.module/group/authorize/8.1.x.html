<h1 id="page-subtitle">Authorized operations</h1>      <p>Functions to run operations with elevated privileges via <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a>.</p> <p>Because of the Update manager functionality included in Drupal core, there is a mechanism for running operations with elevated file system privileges, the top-level <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> script. This script runs at a reduced Drupal bootstrap level so that it is not reliant on the entire site being functional. The operations use a FileTransfer class to manipulate code installed on the system as the user that owns the files, not the user that the httpd is running as.</p> <p>The first setup is to define a callback function that should be authorized to run with the elevated privileges. This callback should take a FileTransfer as its first argument, although you can define an array of other arguments it should be invoked with. The callback should be placed in a separate .inc file that will be included by <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a>.</p> <p>To run the operation, certain data must be saved into the SESSION, and then the flow of control should be redirected to the <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> script. There are two ways to do this, either to call <a href="../../function/system_authorized_run/8.1.x.html" title="Setup and invoke an operation using authorize.php." class="local">system_authorized_run</a>() directly, or to call <a href="../../function/system_authorized_init/8.1.x.html" title="Setup a given callback to run via authorize.php with elevated privileges." class="local">system_authorized_init</a>() and then redirect to <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a>, using the URL from <a href="../../function/system_authorized_get_url/8.1.x.html" title="Return the URL for the authorize.php script." class="local">system_authorized_get_url</a>(). Redirecting yourself is necessary when your authorized operation is being triggered by a form submit handler, since calling redirecting in a submit handler is a bad idea, and you should instead use $form_state-&gt;setRedirect().</p> <p>Once the SESSION is setup for the operation and the user is redirected to <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a>, they will be prompted for their connection credentials (core provides FTP and SSH by default, although other connection classes can be added via contributed modules). With valid credentials, <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> will instantiate the appropriate FileTransfer object, and then invoke the desired operation passing in that object. The <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> script can act as a Batch API processing page, if the operation requires a batch.</p> <h3>See also</h3> <p> <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a></p> <p><a href="../../../core-lib-drupal-core-filetransfer-filetransfer.php/class/filetransfer/8.1.x.html" title="Defines the base FileTransfer class." class="local">\Drupal\Core\FileTransfer\FileTransfer</a></p> <p><a href="../../../core-lib-drupal-core-file-file.api.php/function/hook_filetransfer_info/8.1.x.html" title="Register information about FileTransfer classes provided by a module." class="local">hook_filetransfer_info</a>()</p> <h3>File</h3> 
<dl> <dt>core/modules/system/<a href="../../8.1.x.html">system.module</a>, line 345</dt> <dd>Configuration system that lets administrators modify the workings of the site.</dd> </dl> <h3>Functions</h3>  <table> <thead> <tr> <th scope="col"> Name </th> <th scope="col"> Location </th> <th scope="col"> Description </th> </tr> </thead> <tbody> <tr> <td data-th="Name"> <a href="../../function/system_authorized_batch_process/8.1.x.html">system_authorized_batch_process</a> </td> <td data-th="Location"> core/modules/system/<a href="../../8.1.x.html">system.module</a> </td> <td data-th="Description"> Use <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> to run <a href="../../../core-includes-form.inc/function/batch_process/8.1.x.html" title="Processes the batch." class="local">batch_process</a>(). </td> </tr> <tr> <td data-th="Name"> <a href="../../function/system_authorized_batch_processing_url/8.1.x.html">system_authorized_batch_processing_url</a> </td> <td data-th="Location"> core/modules/system/<a href="../../8.1.x.html">system.module</a> </td> <td data-th="Description"> Returns the URL for the <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> script when it is processing a batch. </td> </tr> <tr> <td data-th="Name"> <a href="../../function/system_authorized_get_url/8.1.x.html">system_authorized_get_url</a> </td> <td data-th="Location"> core/modules/system/<a href="../../8.1.x.html">system.module</a> </td> <td data-th="Description"> Return the URL for the <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> script. </td> </tr> <tr> <td data-th="Name"> <a href="../../function/system_authorized_init/8.1.x.html">system_authorized_init</a> </td> <td data-th="Location"> core/modules/system/<a href="../../8.1.x.html">system.module</a> </td> <td data-th="Description"> Setup a given callback to run via <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a> with elevated privileges. </td> </tr> <tr> <td data-th="Name"> <a href="../../function/system_authorized_run/8.1.x.html">system_authorized_run</a> </td> <td data-th="Location"> core/modules/system/<a href="../../8.1.x.html">system.module</a> </td> <td data-th="Description"> Setup and invoke an operation using <a href="https://api.drupal.org/api/drupal/core%21authorize.php/8.1.x" title="Administrative script for running authorized file operations." class="local">authorize.php</a>. </td> </tr> </tbody> </table><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!modules!system!system.module/group/authorize/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!modules!system!system.module/group/authorize/8.1.x</a>
  </p>
</div>
