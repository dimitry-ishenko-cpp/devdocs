<h1>Offline Cache</h1>

<div class="css-elchao exirf770">
<p>The offline cache is a feature that allows Yarn to work just fine even should the network go down for any reason - whether it's because your employer didn't pay the utility bill or because the place where your packages are hosted becomes unavailable. It's also a critical part of <a href="zero-installs.html">Zero-Installs</a> and doesn't store more than a single file for each package - making it suitable for being stored within a repository, <a href="https://github.com/yarnpkg/berry/tree/master/.yarn/cache">as we actually do in the Yarn repository itself</a>.</p>
<p>The way it works is simple: each time a package is downloaded from a remote location ("remote" as a generic term in this context: dependencies listed through the <code class="language-text">file:</code> protocol also have a remote, even if it will be the local filesystem in their case) a copy will be stored within the cache. The next time this same package will need to be installed, Yarn will leverage the version stored within cache instead of downloading its original source.</p>
<p>The location of the local cache, relative to the root of the project, can be configured with the <a href="../configuration/yarnrc.html#cacheFolder"><code class="language-text">cacheFolder</code></a> configuration option. By default, it is <code class="language-text">.yarn/cache</code>.</p>
<div class="toc"><ul>
<li><a href="#disabling-the-cache">Disabling the cache</a></li>
<li><a href="#cleaning-the-cache">Cleaning the cache</a></li>
<li><a href="#sharing-the-cache">Sharing the cache</a></li>
<li><a href="#cache-integrity">Cache integrity</a></li>
</ul></div>
<h2 id="disabling-the-cache">
Disabling the cache</h2>
<p>Because the offline cache is leveraged to power PnP (files are read directly from within the zip archives), the cache cannot be disabled. That being said it's totally safe to remove the cache folder entirely if needed - it will simply be rebuilt the next time you run <code class="language-text">yarn install</code>.</p>
<p>The local cache can be disabled by <a href="#sharing-the-cache">sharing the cache</a>, in which case the global cache will be used.</p>
<p>The global mirror can be disabled by using the <a href="../configuration/yarnrc.html#enableMirror"><code class="language-text">enableMirror</code></a> configuration option. This is not recommended when using a local cache, as the global mirror is an abstraction between the local cache and the network, storing all downloaded packages for future use, to reduce install times.</p>
<h2 id="cleaning-the-cache">
Cleaning the cache</h2>
<p>Yarn automatically purges your cache from unneeded packages when you remove or upgrade them. In case you need to manually clean the cache, you can use the <a href="../cli/cache/clean.html"><code class="language-text">yarn cache clean</code></a> command.</p>
<p>The global mirror, however, has to be manually cleaned using the <a href="../cli/cache/clean.html"><code class="language-text">yarn cache clean --mirror</code></a> command.</p>
<h2 id="sharing-the-cache">
Sharing the cache</h2>
<p>Starting from Yarn v2, Yarn will by default configure the cache to be local to your project. This is done to make it easier for you to store it as part of your repository, which we believe is the best way to ensure that your projects can still be installed just fine regardless of the availability of your package registries.</p>
<p>Still, this might not make sense in every case. For example, you might be working on a small library and not care enough to bother with checking-in your cache. If that's your case just add the following line into a <code class="language-text">.yarnrc.yml</code> file local to your project. It will instruct Yarn to use a special path that will be shared by all projects that list the same configuration:</p>
<div class="gatsby-highlight" data-language="yaml"><pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">enableGlobalCache</span><span class="token punctuation">:</span> <span class="token boolean important">true</span></code></pre></div>
<p>The location of the shared cache is always <a href="../configuration/yarnrc.html#globalFolder"><code class="language-text">&lt;globalFolder&gt;</code></a><code class="language-text">/cache</code>, which corresponds to the location of the global mirror.</p>
<h2 id="cache-integrity">
Cache integrity</h2>
<p>Because the archive checksums are stored within the lockfile, any cache corruption will be detected at install-time and you'll be asked to resolve the problem - either by removing the corrupted file, or updating the checksum. The latter isn't meant to be done except for advanced users in extremely specific cases.</p>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2016&ndash;present Yarn Contributors<br>Licensed under the BSD License.<br>
    <a href="https://yarnpkg.com/features/offline-cache" class="_attribution-link">https://yarnpkg.com/features/offline-cache</a>
  </p>
</div>
