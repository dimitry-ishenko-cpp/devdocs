<h1>Class yii\db\Connection</h1> <div class="top-nav"> <a href="index.html">All Classes</a> | <a href="#properties">Properties</a> | <a href="#methods">Methods</a> | <a href="#events">Events</a> </div> <table> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr>
<th>Inheritance</th>
<td>
<a href="yii-db-connection.html">yii\db\Connection</a> » <a href="yii-base-component.html">yii\base\Component</a> » <a href="yii-base-object.html">yii\base\Object</a>
</td>
</tr> <tr>
<th>Implements</th>
<td><a href="yii-base-configurable.html">yii\base\Configurable</a></td>
</tr> <tr>
<th>Subclasses</th>
<td><a href="yii-sphinx-connection.html">yii\sphinx\Connection</a></td>
</tr> <tr>
<th>Available since version</th>
<td>2.0</td>
</tr> <tr> <th>Source Code</th> <td><a href="https://github.com/yiisoft/yii2/blob/master/framework/db/Connection.php">https://github.com/yiisoft/yii2/blob/master/framework/db/Connection.php</a></td> </tr> </table>  <p><strong>Connection represents a connection to a database via <a href="http://php.net/manual/en/book.pdo.php">PDO</a>.</strong></p> <p>Connection works together with <a href="yii-db-command.html">yii\db\Command</a>, <a href="yii-db-datareader.html">yii\db\DataReader</a> and <a href="yii-db-transaction.html">yii\db\Transaction</a> to provide data access to various DBMS in a common set of APIs. They are a thin wrapper of the <a href="http://php.net/manual/en/book.pdo.php">PDO PHP extension</a>.</p> <p>Connection supports database replication and read-write splitting. In particular, a Connection component can be configured with multiple <a href="yii-db-connection.html#%24masters-detail">$masters</a> and <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>. It will do load balancing and failover by choosing appropriate servers. It will also automatically direct read operations to the slaves and write operations to the masters.</p> <p>To establish a DB connection, set <a href="yii-db-connection.html#%24dsn-detail">$dsn</a>, <a href="yii-db-connection.html#%24username-detail">$username</a> and <a href="yii-db-connection.html#%24password-detail">$password</a>, and then call <a href="yii-db-connection.html#open()-detail">open()</a> to connect to the database server. The current state of the connection can be checked using <a href="yii-db-connection.html#%24isActive-detail">$isActive</a>.</p> <p>The following example shows how to create a Connection instance and establish the DB connection:</p> <pre data-language="php">$connection = new \yii\db\Connection([
    'dsn' =&gt; $dsn,
    'username' =&gt; $username,
    'password' =&gt; $password,
]);
$connection-&gt;open();
</pre> <p>After the DB connection is established, one can execute SQL statements like the following:</p> <pre data-language="php">$command = $connection-&gt;createCommand('SELECT * FROM post');
$posts = $command-&gt;queryAll();
$command = $connection-&gt;createCommand('UPDATE post SET status=1');
$command-&gt;execute();
</pre> <p>One can also do prepared SQL execution and bind parameters to the prepared SQL. When the parameters are coming from user input, you should use this approach to prevent SQL injection attacks. The following is an example:</p> <pre data-language="php">$command = $connection-&gt;createCommand('SELECT * FROM post WHERE id=:id');
$command-&gt;bindValue(':id', $_GET['id']);
$post = $command-&gt;query();
</pre> <p>For more information about how to perform various DB queries, please refer to <a href="yii-db-command.html">yii\db\Command</a>.</p> <p>If the underlying DBMS supports transactions, you can perform transactional SQL queries like the following:</p> <pre data-language="php">$transaction = $connection-&gt;beginTransaction();
try {
    $connection-&gt;createCommand($sql1)-&gt;execute();
    $connection-&gt;createCommand($sql2)-&gt;execute();
    // ... executing other SQL statements ...
    $transaction-&gt;commit();
} catch (Exception $e) {
    $transaction-&gt;rollBack();
}
</pre> <p>You also can use shortcut for the above like the following:</p> <pre data-language="php">$connection-&gt;transaction(function () {
    $order = new Order($customer);
    $order-&gt;save();
    $order-&gt;addItems($items);
});
</pre> <p>If needed you can pass transaction isolation level as a second parameter:</p> <pre data-language="php">$connection-&gt;transaction(function (Connection $db) {
    //return $db-&gt;...
}, Transaction::READ_UNCOMMITTED);
</pre> <p>Connection is often used as an application component and configured in the application configuration like the following:</p> <pre data-language="php">'components' =&gt; [
    'db' =&gt; [
        'class' =&gt; '\yii\db\Connection',
        'dsn' =&gt; 'mysql:host=127.0.0.1;dbname=demo',
        'username' =&gt; 'root',
        'password' =&gt; '',
        'charset' =&gt; 'utf8',
    ],
],
</pre>    <h2 id="properties">Public Properties</h2>  <table> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="$attributes"> <td><a href="yii-db-connection.html#%24attributes-detail">$attributes</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>PDO attributes (name =&gt; value) that should be set when calling <a href="yii-db-connection.html#open()-detail">open()</a> to establish a DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$behaviors"> <td><a href="yii-base-component.html#%24behaviors-detail">$behaviors</a></td> <td>
<a href="yii-base-behavior.html">yii\base\Behavior</a>[]</td> <td>List of behaviors attached to this component</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="$charset"> <td><a href="yii-db-connection.html#%24charset-detail">$charset</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The charset used for database connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$commandClass"> <td><a href="yii-db-connection.html#%24commandClass-detail">$commandClass</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The class used to create new database <a href="yii-db-command.html">yii\db\Command</a> objects.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$driverName"> <td><a href="yii-db-connection.html#%24driverName-detail">$driverName</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>Name of the DB driver</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$dsn"> <td><a href="yii-db-connection.html#%24dsn-detail">$dsn</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The Data Source Name, or DSN, contains the information required to connect to the database.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$emulatePrepare"> <td><a href="yii-db-connection.html#%24emulatePrepare-detail">$emulatePrepare</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to turn on prepare emulation.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$enableLogging"> <td><a href="yii-db-connection.html#%24enableLogging-detail">$enableLogging</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable logging of database queries.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$enableProfiling"> <td><a href="yii-db-connection.html#%24enableProfiling-detail">$enableProfiling</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable profiling of database queries.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$enableQueryCache"> <td><a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable query caching.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$enableSavepoint"> <td><a href="yii-db-connection.html#%24enableSavepoint-detail">$enableSavepoint</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable [savepoint](<a href="http://en">http://en</a>.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$enableSchemaCache"> <td><a href="yii-db-connection.html#%24enableSchemaCache-detail">$enableSchemaCache</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable schema caching.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$enableSlaves"> <td><a href="yii-db-connection.html#%24enableSlaves-detail">$enableSlaves</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable read/write splitting by using <a href="yii-db-connection.html#%24slaves-detail">$slaves</a> to read data.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$isActive"> <td><a href="yii-db-connection.html#%24isActive-detail">$isActive</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether the DB connection is established</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$lastInsertID"> <td><a href="yii-db-connection.html#%24lastInsertID-detail">$lastInsertID</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The row ID of the last row inserted, or the last value retrieved from the sequence object</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$master"> <td><a href="yii-db-connection.html#%24master-detail">$master</a></td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>The currently active master connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$masterConfig"> <td><a href="yii-db-connection.html#%24masterConfig-detail">$masterConfig</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>The configuration that should be merged with every master configuration listed in <a href="yii-db-connection.html#%24masters-detail">$masters</a>.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$masterPdo"> <td><a href="yii-db-connection.html#%24masterPdo-detail">$masterPdo</a></td> <td><a href="http://www.php.net/class.pdo">PDO</a></td> <td>The PDO instance for the currently active master connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$masters"> <td><a href="yii-db-connection.html#%24masters-detail">$masters</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>List of master connection configurations.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$password"> <td><a href="yii-db-connection.html#%24password-detail">$password</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The password for establishing DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$pdo"> <td><a href="yii-db-connection.html#%24pdo-detail">$pdo</a></td> <td><a href="http://www.php.net/class.pdo">PDO</a></td> <td>The PHP PDO instance associated with this DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$pdoClass"> <td><a href="yii-db-connection.html#%24pdoClass-detail">$pdoClass</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>Custom PDO wrapper class.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$queryBuilder"> <td><a href="yii-db-connection.html#%24queryBuilder-detail">$queryBuilder</a></td> <td><a href="yii-db-querybuilder.html">yii\db\QueryBuilder</a></td> <td>The query builder for the current DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$queryCache"> <td><a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a></td> <td>
<a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.string">string</a>
</td> <td>The cache object or the ID of the cache application component that is used for query caching.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$queryCacheDuration"> <td><a href="yii-db-connection.html#%24queryCacheDuration-detail">$queryCacheDuration</a></td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>The default number of seconds that query results can remain valid in cache.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$schema"> <td><a href="yii-db-connection.html#%24schema-detail">$schema</a></td> <td><a href="yii-db-schema.html">yii\db\Schema</a></td> <td>The schema information for the database opened by this connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$schemaCache"> <td><a href="yii-db-connection.html#%24schemaCache-detail">$schemaCache</a></td> <td>
<a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.string">string</a>
</td> <td>The cache object or the ID of the cache application component that is used to cache the table metadata.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$schemaCacheDuration"> <td><a href="yii-db-connection.html#%24schemaCacheDuration-detail">$schemaCacheDuration</a></td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>Number of seconds that table metadata can remain valid in cache.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$schemaCacheExclude"> <td><a href="yii-db-connection.html#%24schemaCacheExclude-detail">$schemaCacheExclude</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>List of tables whose metadata should NOT be cached.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$schemaMap"> <td><a href="yii-db-connection.html#%24schemaMap-detail">$schemaMap</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>Mapping between PDO driver names and <a href="yii-db-schema.html">yii\db\Schema</a> classes.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$serverRetryInterval"> <td><a href="yii-db-connection.html#%24serverRetryInterval-detail">$serverRetryInterval</a></td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>The retry interval in seconds for dead servers listed in <a href="yii-db-connection.html#%24masters-detail">$masters</a> and <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$serverStatusCache"> <td><a href="yii-db-connection.html#%24serverStatusCache-detail">$serverStatusCache</a></td> <td>
<a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.string">string</a>
</td> <td>The cache object or the ID of the cache application component that is used to store the health status of the DB servers specified in <a href="yii-db-connection.html#%24masters-detail">$masters</a> and <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$shuffleMasters"> <td><a href="yii-db-connection.html#%24shuffleMasters-detail">$shuffleMasters</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to shuffle <a href="yii-db-connection.html#%24masters-detail">$masters</a> before getting one.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$slave"> <td><a href="yii-db-connection.html#%24slave-detail">$slave</a></td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>The currently active slave connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$slaveConfig"> <td><a href="yii-db-connection.html#%24slaveConfig-detail">$slaveConfig</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>The configuration that should be merged with every slave configuration listed in <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$slavePdo"> <td><a href="yii-db-connection.html#%24slavePdo-detail">$slavePdo</a></td> <td><a href="http://www.php.net/class.pdo">PDO</a></td> <td>The PDO instance for the currently active slave connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$slaves"> <td><a href="yii-db-connection.html#%24slaves-detail">$slaves</a></td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>List of slave connection configurations.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$tablePrefix"> <td><a href="yii-db-connection.html#%24tablePrefix-detail">$tablePrefix</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The common prefix or suffix for table names.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$transaction"> <td><a href="yii-db-connection.html#%24transaction-detail">$transaction</a></td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> <td>The currently active transaction.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="$username"> <td><a href="yii-db-connection.html#%24username-detail">$username</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The username for establishing DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> </table>    <h2 id="methods">Public Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="__call()"> <td><a href="yii-base-component.html#__call()-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__clone()"> <td><a href="yii-db-connection.html#__clone()-detail">__clone()</a></td> <td>Reset the connection after cloning.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="__construct()"> <td><a href="yii-base-object.html#__construct()-detail">__construct()</a></td> <td>Constructor.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__get()"> <td><a href="yii-base-component.html#__get()-detail">__get()</a></td> <td>Returns the value of a component property.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__isset()"> <td><a href="yii-base-component.html#__isset()-detail">__isset()</a></td> <td>Checks if a property is set, i.e. defined and not null.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__set()"> <td><a href="yii-base-component.html#__set()-detail">__set()</a></td> <td>Sets the value of a component property.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__sleep()"> <td><a href="yii-db-connection.html#__sleep()-detail">__sleep()</a></td> <td>Close the connection before serializing.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="__unset()"> <td><a href="yii-base-component.html#__unset()-detail">__unset()</a></td> <td>Sets a component property to be null.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="attachBehavior()"> <td><a href="yii-base-component.html#attachBehavior()-detail">attachBehavior()</a></td> <td>Attaches a behavior to this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="attachBehaviors()"> <td><a href="yii-base-component.html#attachBehaviors()-detail">attachBehaviors()</a></td> <td>Attaches a list of behaviors to the component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="beginTransaction()"> <td><a href="yii-db-connection.html#beginTransaction()-detail">beginTransaction()</a></td> <td>Starts a transaction.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="behaviors()"> <td><a href="yii-base-component.html#behaviors()-detail">behaviors()</a></td> <td>Returns a list of behaviors that this component should behave as.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="cache()"> <td><a href="yii-db-connection.html#cache()-detail">cache()</a></td> <td>Uses query cache for the queries performed with the callable.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="canGetProperty()"> <td><a href="yii-base-component.html#canGetProperty()-detail">canGetProperty()</a></td> <td>Returns a value indicating whether a property can be read.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="canSetProperty()"> <td><a href="yii-base-component.html#canSetProperty()-detail">canSetProperty()</a></td> <td>Returns a value indicating whether a property can be set.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="className()"> <td><a href="yii-base-object.html#className()-detail">className()</a></td> <td>Returns the fully qualified name of this class.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="close()"> <td><a href="yii-db-connection.html#close()-detail">close()</a></td> <td>Closes the currently active DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="createCommand()"> <td><a href="yii-db-connection.html#createCommand()-detail">createCommand()</a></td> <td>Creates a command for execution.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="detachBehavior()"> <td><a href="yii-base-component.html#detachBehavior()-detail">detachBehavior()</a></td> <td>Detaches a behavior from the component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="detachBehaviors()"> <td><a href="yii-base-component.html#detachBehaviors()-detail">detachBehaviors()</a></td> <td>Detaches all behaviors from the component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="ensureBehaviors()"> <td><a href="yii-base-component.html#ensureBehaviors()-detail">ensureBehaviors()</a></td> <td>Makes sure that the behaviors declared in <a href="yii-base-component.html#behaviors()-detail">behaviors()</a> are attached to this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="getBehavior()"> <td><a href="yii-base-component.html#getBehavior()-detail">getBehavior()</a></td> <td>Returns the named behavior object.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="getBehaviors()"> <td><a href="yii-base-component.html#getBehaviors()-detail">getBehaviors()</a></td> <td>Returns all behaviors attached to this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="getDriverName()"> <td><a href="yii-db-connection.html#getDriverName()-detail">getDriverName()</a></td> <td>Returns the name of the DB driver. Based on the the current <a href="yii-db-connection.html#%24dsn-detail">$dsn</a>, in case it was not set explicitly by an end user.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getIsActive()"> <td><a href="yii-db-connection.html#getIsActive()-detail">getIsActive()</a></td> <td>Returns a value indicating whether the DB connection is established.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getLastInsertID()"> <td><a href="yii-db-connection.html#getLastInsertID()-detail">getLastInsertID()</a></td> <td>Returns the ID of the last inserted row or sequence value.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getMaster()"> <td><a href="yii-db-connection.html#getMaster()-detail">getMaster()</a></td> <td>Returns the currently active master connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getMasterPdo()"> <td><a href="yii-db-connection.html#getMasterPdo()-detail">getMasterPdo()</a></td> <td>Returns the PDO instance for the currently active master connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getQueryBuilder()"> <td><a href="yii-db-connection.html#getQueryBuilder()-detail">getQueryBuilder()</a></td> <td>Returns the query builder for the current DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getQueryCacheInfo()"> <td><a href="yii-db-connection.html#getQueryCacheInfo()-detail">getQueryCacheInfo()</a></td> <td>Returns the current query cache information.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getSchema()"> <td><a href="yii-db-connection.html#getSchema()-detail">getSchema()</a></td> <td>Returns the schema information for the database opened by this connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getSlave()"> <td><a href="yii-db-connection.html#getSlave()-detail">getSlave()</a></td> <td>Returns the currently active slave connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getSlavePdo()"> <td><a href="yii-db-connection.html#getSlavePdo()-detail">getSlavePdo()</a></td> <td>Returns the PDO instance for the currently active slave connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getTableSchema()"> <td><a href="yii-db-connection.html#getTableSchema()-detail">getTableSchema()</a></td> <td>Obtains the schema information for the named table.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="getTransaction()"> <td><a href="yii-db-connection.html#getTransaction()-detail">getTransaction()</a></td> <td>Returns the currently active transaction.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="hasEventHandlers()"> <td><a href="yii-base-component.html#hasEventHandlers()-detail">hasEventHandlers()</a></td> <td>Returns a value indicating whether there is any handler attached to the named event.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="hasMethod()"> <td><a href="yii-base-component.html#hasMethod()-detail">hasMethod()</a></td> <td>Returns a value indicating whether a method is defined.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="hasProperty()"> <td><a href="yii-base-component.html#hasProperty()-detail">hasProperty()</a></td> <td>Returns a value indicating whether a property is defined for this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="init()"> <td><a href="yii-base-object.html#init()-detail">init()</a></td> <td>Initializes the object.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="noCache()"> <td><a href="yii-db-connection.html#noCache()-detail">noCache()</a></td> <td>Disables query cache temporarily.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="off()"> <td><a href="yii-base-component.html#off()-detail">off()</a></td> <td>Detaches an existing event handler from this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="on()"> <td><a href="yii-base-component.html#on()-detail">on()</a></td> <td>Attaches an event handler to an event.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="open()"> <td><a href="yii-db-connection.html#open()-detail">open()</a></td> <td>Establishes a DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="quoteColumnName()"> <td><a href="yii-db-connection.html#quoteColumnName()-detail">quoteColumnName()</a></td> <td>Quotes a column name for use in a query.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="quoteSql()"> <td><a href="yii-db-connection.html#quoteSql()-detail">quoteSql()</a></td> <td>Processes a SQL statement by quoting table and column names that are enclosed within double brackets.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="quoteTableName()"> <td><a href="yii-db-connection.html#quoteTableName()-detail">quoteTableName()</a></td> <td>Quotes a table name for use in a query.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="quoteValue()"> <td><a href="yii-db-connection.html#quoteValue()-detail">quoteValue()</a></td> <td>Quotes a string value for use in a query.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="setDriverName()"> <td><a href="yii-db-connection.html#setDriverName()-detail">setDriverName()</a></td> <td>Changes the current driver name.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="transaction()"> <td><a href="yii-db-connection.html#transaction()-detail">transaction()</a></td> <td>Executes callback provided in a transaction.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="trigger()"> <td><a href="yii-base-component.html#trigger()-detail">trigger()</a></td> <td>Triggers an event.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="useMaster()"> <td><a href="yii-db-connection.html#useMaster()-detail">useMaster()</a></td> <td>Executes the provided callback by using the master connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> </table>   <h2>Protected Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="createPdoInstance()"> <td><a href="yii-db-connection.html#createPdoInstance()-detail">createPdoInstance()</a></td> <td>Creates the PDO instance.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="initConnection()"> <td><a href="yii-db-connection.html#initConnection()-detail">initConnection()</a></td> <td>Initializes the DB connection.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="openFromPool()"> <td><a href="yii-db-connection.html#openFromPool()-detail">openFromPool()</a></td> <td>Opens the connection to a server in the pool.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="openFromPoolSequentially()"> <td><a href="yii-db-connection.html#openFromPoolSequentially()-detail">openFromPoolSequentially()</a></td> <td>Opens the connection to a server in the pool.</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> </table>    <h2 id="events">Events</h2>  <table> <colgroup> <col class="col-event"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Event</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="EVENT_AFTER_OPEN"> <td><a href="yii-db-connection.html#EVENT_AFTER_OPEN-detail">EVENT_AFTER_OPEN</a></td> <td>\yii\db\Event</td> <td> An event that is triggered after a DB connection is established </td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="EVENT_BEGIN_TRANSACTION"> <td><a href="yii-db-connection.html#EVENT_BEGIN_TRANSACTION-detail">EVENT_BEGIN_TRANSACTION</a></td> <td>\yii\db\Event</td> <td> An event that is triggered right before a top-level transaction is started </td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="EVENT_COMMIT_TRANSACTION"> <td><a href="yii-db-connection.html#EVENT_COMMIT_TRANSACTION-detail">EVENT_COMMIT_TRANSACTION</a></td> <td>\yii\db\Event</td> <td> An event that is triggered right after a top-level transaction is committed </td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> <tr id="EVENT_ROLLBACK_TRANSACTION"> <td><a href="yii-db-connection.html#EVENT_ROLLBACK_TRANSACTION-detail">EVENT_ROLLBACK_TRANSACTION</a></td> <td>\yii\db\Event</td> <td> An event that is triggered right after a top-level transaction is rolled back </td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> </tr> </table>   <h2 id="constants">Property Details</h2>  <h3 id="$attributes-detail"> $attributes <span class="detail-header-tag small"> public property </span> </h3>  <p>PDO attributes (name =&gt; value) that should be set when calling <a href="yii-db-connection.html#open()-detail">open()</a> to establish a DB connection. Please refer to the <a href="http://php.net/manual/en/pdo.setattribute.php">PHP manual</a> for details about available attributes.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24attributes-detail">$attributes</a> = null</pre> <h3 id="$charset-detail"> $charset <span class="detail-header-tag small"> public property </span> </h3>  <p>The charset used for database connection. The property is only used for MySQL, PostgreSQL and CUBRID databases. Defaults to null, meaning using default charset as configured by the database.</p> <p>For Oracle Database, the charset must be specified in the <a href="yii-db-connection.html#%24dsn-detail">$dsn</a>, for example for UTF-8 by appending <code>;charset=UTF-8</code> to the DSN string.</p> <p>The same applies for if you're using GBK or BIG5 charset with MySQL, then it's highly recommended to specify charset via <a href="yii-db-connection.html#%24dsn-detail">$dsn</a> like <code>'mysql:dbname=mydatabase;host=127.0.0.1;charset=GBK;'</code>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24charset-detail">$charset</a> = null</pre> <h3 id="$commandClass-detail"> $commandClass <span class="detail-header-tag small"> public property (available since version 2.0.7) </span> </h3>  <p>The class used to create new database <a href="yii-db-command.html">yii\db\Command</a> objects. If you want to extend the <a href="yii-db-command.html">yii\db\Command</a> class, you may configure this property to use your extended version of the class.</p> <p>See also <a href="yii-db-connection.html#createCommand()-detail">createCommand()</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24commandClass-detail">$commandClass</a> = 'yii\db\Command'</pre> <h3 id="$driverName-detail"> $driverName <span class="detail-header-tag small"> public property </span> </h3>  <p>Name of the DB driver</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <strong><a href="yii-db-connection.html#getDriverName()-detail">getDriverName</a></strong> ( )<br><span class="signature-defs">public</span> <span class="signature-type">void</span> <strong><a href="yii-db-connection.html#setDriverName()-detail">setDriverName</a></strong> ( $driverName )</pre> <h3 id="$dsn-detail"> $dsn <span class="detail-header-tag small"> public property </span> </h3>  <p>The Data Source Name, or DSN, contains the information required to connect to the database. Please refer to the <a href="http://php.net/manual/en/pdo.construct.php">PHP manual</a> on the format of the DSN string.</p> <p>For <a href="http://php.net/manual/en/ref.pdo-sqlite.connection.php">SQLite</a> you may use a <a href="guide-concept-aliases.html">path alias</a> for specifying the database path, e.g. <code>sqlite:@app/data/db.sql</code>.</p> <p>See also <a href="yii-db-connection.html#%24charset-detail">$charset</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24dsn-detail">$dsn</a> = null</pre> <h3 id="$emulatePrepare-detail"> $emulatePrepare <span class="detail-header-tag small"> public property </span> </h3>  <p>Whether to turn on prepare emulation. Defaults to false, meaning PDO will use the native prepare support if available. For some databases (such as MySQL), this may need to be set true so that PDO can emulate the prepare support to bypass the buggy native prepare support. The default value is null, which means the PDO ATTR_EMULATE_PREPARES value will not be changed.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24emulatePrepare-detail">$emulatePrepare</a> = null</pre> <h3 id="$enableLogging-detail"> $enableLogging <span class="detail-header-tag small"> public property (available since version 2.0.12) </span> </h3>  <p>Whether to enable logging of database queries. Defaults to true. You may want to disable this option in a production environment to gain performance if you do not need the information being logged.</p> <p>See also <a href="yii-db-connection.html#%24enableProfiling-detail">$enableProfiling</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24enableLogging-detail">$enableLogging</a> = true</pre> <h3 id="$enableProfiling-detail"> $enableProfiling <span class="detail-header-tag small"> public property (available since version 2.0.12) </span> </h3>  <p>Whether to enable profiling of database queries. Defaults to true. You may want to disable this option in a production environment to gain performance if you do not need the information being logged.</p> <p>See also <a href="yii-db-connection.html#%24enableLogging-detail">$enableLogging</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24enableProfiling-detail">$enableProfiling</a> = true</pre> <h3 id="$enableQueryCache-detail"> $enableQueryCache <span class="detail-header-tag small"> public property </span> </h3>  <p>Whether to enable query caching. Note that in order to enable query caching, a valid cache component as specified by <a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a> must be enabled and <a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a> must be set true. Also, only the results of the queries enclosed within <a href="yii-db-connection.html#cache()-detail">cache()</a> will be cached.</p> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a></li>
<li><a href="yii-db-connection.html#cache()-detail">cache()</a></li>
<li><a href="yii-db-connection.html#noCache()-detail">noCache()</a></li>
</ul>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a> = true</pre> <h3 id="$enableSavepoint-detail"> $enableSavepoint <span class="detail-header-tag small"> public property </span> </h3>  <p>Whether to enable <a href="http://en.wikipedia.org/wiki/Savepoint">savepoint</a>. Note that if the underlying DBMS does not support savepoint, setting this property to be true will have no effect.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24enableSavepoint-detail">$enableSavepoint</a> = true</pre> <h3 id="$enableSchemaCache-detail"> $enableSchemaCache <span class="detail-header-tag small"> public property </span> </h3>  <p>Whether to enable schema caching. Note that in order to enable truly schema caching, a valid cache component as specified by <a href="yii-db-connection.html#%24schemaCache-detail">$schemaCache</a> must be enabled and <a href="yii-db-connection.html#%24enableSchemaCache-detail">$enableSchemaCache</a> must be set true.</p> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24schemaCacheDuration-detail">$schemaCacheDuration</a></li>
<li><a href="yii-db-connection.html#%24schemaCacheExclude-detail">$schemaCacheExclude</a></li>
<li><a href="yii-db-connection.html#%24schemaCache-detail">$schemaCache</a></li>
</ul>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24enableSchemaCache-detail">$enableSchemaCache</a> = false</pre> <h3 id="$enableSlaves-detail"> $enableSlaves <span class="detail-header-tag small"> public property </span> </h3>  <p>Whether to enable read/write splitting by using <a href="yii-db-connection.html#%24slaves-detail">$slaves</a> to read data. Note that if <a href="yii-db-connection.html#%24slaves-detail">$slaves</a> is empty, read/write splitting will NOT be enabled no matter what value this property takes.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24enableSlaves-detail">$enableSlaves</a> = true</pre> <h3 id="$isActive-detail"> $isActive <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>Whether the DB connection is established</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <strong><a href="yii-db-connection.html#getIsActive()-detail">getIsActive</a></strong> ( )</pre> <h3 id="$lastInsertID-detail"> $lastInsertID <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The row ID of the last row inserted, or the last value retrieved from the sequence object</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <strong><a href="yii-db-connection.html#getLastInsertID()-detail">getLastInsertID</a></strong> ( $sequenceName = '' )</pre> <h3 id="$master-detail"> $master <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The currently active master connection. <code>null</code> is returned if there is no master available.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-connection.html">yii\db\Connection</a></span> <strong><a href="yii-db-connection.html#getMaster()-detail">getMaster</a></strong> ( )</pre> <h3 id="$masterConfig-detail"> $masterConfig <span class="detail-header-tag small"> public property </span> </h3>  <p>The configuration that should be merged with every master configuration listed in <a href="yii-db-connection.html#%24masters-detail">$masters</a>. For example,</p> <pre data-language="php">[
    'username' =&gt; 'master',
    'password' =&gt; 'master',
    'attributes' =&gt; [
        // use a smaller connection timeout
        PDO::ATTR_TIMEOUT =&gt; 10,
    ],
]
</pre>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24masterConfig-detail">$masterConfig</a> = []</pre> <h3 id="$masterPdo-detail"> $masterPdo <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The PDO instance for the currently active master connection.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/class.pdo">PDO</a></span> <strong><a href="yii-db-connection.html#getMasterPdo()-detail">getMasterPdo</a></strong> ( )</pre> <h3 id="$masters-detail"> $masters <span class="detail-header-tag small"> public property </span> </h3>  <p>List of master connection configurations. Each configuration is used to create a master DB connection. When <a href="yii-db-connection.html#open()-detail">open()</a> is called, one of these configurations will be chosen and used to create a DB connection which will be used by this object. Note that when this property is not empty, the connection setting (e.g. "dsn", "username") of this object will be ignored.</p> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24masterConfig-detail">$masterConfig</a></li>
<li><a href="yii-db-connection.html#%24shuffleMasters-detail">$shuffleMasters</a></li>
</ul>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24masters-detail">$masters</a> = []</pre> <h3 id="$password-detail"> $password <span class="detail-header-tag small"> public property </span> </h3>  <p>The password for establishing DB connection. Defaults to <code>null</code> meaning no password to use.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24password-detail">$password</a> = null</pre> <h3 id="$pdo-detail"> $pdo <span class="detail-header-tag small"> public property </span> </h3>  <p>The PHP PDO instance associated with this DB connection. This property is mainly managed by <a href="yii-db-connection.html#open()-detail">open()</a> and <a href="yii-db-connection.html#close()-detail">close()</a> methods. When a DB connection is active, this property will represent a PDO instance; otherwise, it will be null.</p> <p>See also <a href="yii-db-connection.html#%24pdoClass-detail">$pdoClass</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/class.pdo">PDO</a></span> <a href="yii-db-connection.html#%24pdo-detail">$pdo</a> = null</pre> <h3 id="$pdoClass-detail"> $pdoClass <span class="detail-header-tag small"> public property </span> </h3>  <p>Custom PDO wrapper class. If not set, it will use <a href="http://www.php.net/class.pdo">PDO</a> or <a href="yii-db-mssql-pdo.html">yii\db\mssql\PDO</a> when MSSQL is used.</p> <p>See also <a href="yii-db-connection.html#%24pdo-detail">$pdo</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24pdoClass-detail">$pdoClass</a> = null</pre> <h3 id="$queryBuilder-detail"> $queryBuilder <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The query builder for the current DB connection.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-querybuilder.html">yii\db\QueryBuilder</a></span> <strong><a href="yii-db-connection.html#getQueryBuilder()-detail">getQueryBuilder</a></strong> ( )</pre> <h3 id="$queryCache-detail"> $queryCache <span class="detail-header-tag small"> public property </span> </h3>  <p>The cache object or the ID of the cache application component that is used for query caching.</p> <p>See also <a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a> = 'cache'</pre> <h3 id="$queryCacheDuration-detail"> $queryCacheDuration <span class="detail-header-tag small"> public property </span> </h3>  <p>The default number of seconds that query results can remain valid in cache. Defaults to 3600, meaning 3600 seconds, or one hour. Use 0 to indicate that the cached data will never expire. The value of this property will be used when <a href="yii-db-connection.html#cache()-detail">cache()</a> is called without a cache duration.</p> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a></li>
<li><a href="yii-db-connection.html#cache()-detail">cache()</a></li>
</ul>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.integer">integer</a></span> <a href="yii-db-connection.html#%24queryCacheDuration-detail">$queryCacheDuration</a> = 3600</pre> <h3 id="$schema-detail"> $schema <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The schema information for the database opened by this connection.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-schema.html">yii\db\Schema</a></span> <strong><a href="yii-db-connection.html#getSchema()-detail">getSchema</a></strong> ( )</pre> <h3 id="$schemaCache-detail"> $schemaCache <span class="detail-header-tag small"> public property </span> </h3>  <p>The cache object or the ID of the cache application component that is used to cache the table metadata.</p> <p>See also <a href="yii-db-connection.html#%24enableSchemaCache-detail">$enableSchemaCache</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24schemaCache-detail">$schemaCache</a> = 'cache'</pre> <h3 id="$schemaCacheDuration-detail"> $schemaCacheDuration <span class="detail-header-tag small"> public property </span> </h3>  <p>Number of seconds that table metadata can remain valid in cache. Use 0 to indicate that the cached data will never expire.</p> <p>See also <a href="yii-db-connection.html#%24enableSchemaCache-detail">$enableSchemaCache</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.integer">integer</a></span> <a href="yii-db-connection.html#%24schemaCacheDuration-detail">$schemaCacheDuration</a> = 3600</pre> <h3 id="$schemaCacheExclude-detail"> $schemaCacheExclude <span class="detail-header-tag small"> public property </span> </h3>  <p>List of tables whose metadata should NOT be cached. Defaults to empty array. The table names may contain schema prefix, if any. Do not quote the table names.</p> <p>See also <a href="yii-db-connection.html#%24enableSchemaCache-detail">$enableSchemaCache</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24schemaCacheExclude-detail">$schemaCacheExclude</a> = []</pre> <h3 id="$schemaMap-detail"> $schemaMap <span class="detail-header-tag small"> public property </span> </h3>  <p>Mapping between PDO driver names and <a href="yii-db-schema.html">yii\db\Schema</a> classes. The keys of the array are PDO driver names while the values the corresponding schema class name or configuration. Please refer to <a href="yii-baseyii.html#createObject()-detail">Yii::createObject()</a> for details on how to specify a configuration.</p> <p>This property is mainly used by <a href="yii-db-connection.html#getSchema()-detail">getSchema()</a> when fetching the database schema information. You normally do not need to set this property unless you want to use your own <a href="yii-db-schema.html">yii\db\Schema</a> class to support DBMS that is not supported by Yii.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24schemaMap-detail">$schemaMap</a> = ['pgsql' =&gt; 'yii\db\pgsql\Schema', 'mysqli' =&gt; 'yii\db\mysql\Schema', 'mysql' =&gt; 'yii\db\mysql\Schema', 'sqlite' =&gt; 'yii\db\sqlite\Schema', 'sqlite2' =&gt; 'yii\db\sqlite\Schema', 'sqlsrv' =&gt; 'yii\db\mssql\Schema', 'oci' =&gt; 'yii\db\oci\Schema', 'mssql' =&gt; 'yii\db\mssql\Schema', 'dblib' =&gt; 'yii\db\mssql\Schema', 'cubrid' =&gt; 'yii\db\cubrid\Schema']</pre> <h3 id="$serverRetryInterval-detail"> $serverRetryInterval <span class="detail-header-tag small"> public property </span> </h3>  <p>The retry interval in seconds for dead servers listed in <a href="yii-db-connection.html#%24masters-detail">$masters</a> and <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>. This is used together with <a href="yii-db-connection.html#%24serverStatusCache-detail">$serverStatusCache</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.integer">integer</a></span> <a href="yii-db-connection.html#%24serverRetryInterval-detail">$serverRetryInterval</a> = 600</pre> <h3 id="$serverStatusCache-detail"> $serverStatusCache <span class="detail-header-tag small"> public property </span> </h3>  <p>The cache object or the ID of the cache application component that is used to store the health status of the DB servers specified in <a href="yii-db-connection.html#%24masters-detail">$masters</a> and <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>. This is used only when read/write splitting is enabled or <a href="yii-db-connection.html#%24masters-detail">$masters</a> is not empty.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24serverStatusCache-detail">$serverStatusCache</a> = 'cache'</pre> <h3 id="$shuffleMasters-detail"> $shuffleMasters <span class="detail-header-tag small"> public property (available since version 2.0.11) </span> </h3>  <p>Whether to shuffle <a href="yii-db-connection.html#%24masters-detail">$masters</a> before getting one.</p> <p>See also <a href="yii-db-connection.html#%24masters-detail">$masters</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-db-connection.html#%24shuffleMasters-detail">$shuffleMasters</a> = true</pre> <h3 id="$slave-detail"> $slave <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The currently active slave connection. <code>null</code> is returned if there is no slave available and <code>$fallbackToMaster</code> is false.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-connection.html">yii\db\Connection</a></span> <strong><a href="yii-db-connection.html#getSlave()-detail">getSlave</a></strong> ( $fallbackToMaster = true )</pre> <h3 id="$slaveConfig-detail"> $slaveConfig <span class="detail-header-tag small"> public property </span> </h3>  <p>The configuration that should be merged with every slave configuration listed in <a href="yii-db-connection.html#%24slaves-detail">$slaves</a>. For example,</p> <pre data-language="php">[
    'username' =&gt; 'slave',
    'password' =&gt; 'slave',
    'attributes' =&gt; [
        // use a smaller connection timeout
        PDO::ATTR_TIMEOUT =&gt; 10,
    ],
]
</pre>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24slaveConfig-detail">$slaveConfig</a> = []</pre> <h3 id="$slavePdo-detail"> $slavePdo <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The PDO instance for the currently active slave connection. <code>null</code> is returned if no slave connection is available and <code>$fallbackToMaster</code> is false.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/class.pdo">PDO</a></span> <strong><a href="yii-db-connection.html#getSlavePdo()-detail">getSlavePdo</a></strong> ( $fallbackToMaster = true )</pre> <h3 id="$slaves-detail"> $slaves <span class="detail-header-tag small"> public property </span> </h3>  <p>List of slave connection configurations. Each configuration is used to create a slave DB connection. When <a href="yii-db-connection.html#%24enableSlaves-detail">$enableSlaves</a> is true, one of these configurations will be chosen and used to create a DB connection for performing read queries only.</p> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24enableSlaves-detail">$enableSlaves</a></li>
<li><a href="yii-db-connection.html#%24slaveConfig-detail">$slaveConfig</a></li>
</ul>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.array">array</a></span> <a href="yii-db-connection.html#%24slaves-detail">$slaves</a> = []</pre> <h3 id="$tablePrefix-detail"> $tablePrefix <span class="detail-header-tag small"> public property </span> </h3>  <p>The common prefix or suffix for table names. If a table name is given as <code>{{%TableName}}</code>, then the percentage character <code>%</code> will be replaced with this property value. For example, <code>{{%post}}</code> becomes <code>{{tbl_post}}</code>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24tablePrefix-detail">$tablePrefix</a> = ''</pre> <h3 id="$transaction-detail"> $transaction <span class="detail-header-tag small"> public <em>read-only</em> property </span> </h3>  <p>The currently active transaction. Null if no active transaction.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-transaction.html">yii\db\Transaction</a></span> <strong><a href="yii-db-connection.html#getTransaction()-detail">getTransaction</a></strong> ( )</pre> <h3 id="$username-detail"> $username <span class="detail-header-tag small"> public property </span> </h3>  <p>The username for establishing DB connection. Defaults to <code>null</code> meaning no username to use.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-db-connection.html#%24username-detail">$username</a> = null</pre>  <h2>Method Details</h2> <div class="method-doc"> <h3 id="__clone()-detail"> __clone() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Reset the connection after cloning.</strong></p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-connection.html#__clone()-detail">__clone</a></strong> ( )</th></tr> </table>  <h3 id="__sleep()-detail"> __sleep() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Close the connection before serializing.</strong></p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.array">array</a> <strong><a href="yii-db-connection.html#__sleep()-detail">__sleep</a></strong> ( )</th></tr> </table>  <h3 id="beginTransaction()-detail"> beginTransaction() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Starts a transaction.</strong></p>  <table> <tr><th colspan="3">public <a href="yii-db-transaction.html">yii\db\Transaction</a> <strong><a href="yii-db-connection.html#beginTransaction()-detail">beginTransaction</a></strong> ( $isolationLevel = null )</th></tr> <tr> <td>$isolationLevel</td> <td>
<a href="http://www.php.net/language.types.string">string</a>|<a href="http://www.php.net/language.types.null">null</a>
</td> <td>
<p>The isolation level to use for this transaction. See <a href="yii-db-transaction.html#begin()-detail">yii\db\Transaction::begin()</a> for details.</p> </td> </tr> <tr> <td>return</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> <td>
<p>The transaction initiated</p> </td> </tr> </table>  <h3 id="cache()-detail"> cache() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Uses query cache for the queries performed with the callable.</strong></p> <p>When query caching is enabled (<a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a> is true and <a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a> refers to a valid cache), queries performed within the callable will be cached and their results will be fetched from cache if available. For example,</p> <pre data-language="php">// The customer will be fetched from cache if available.
// If not, the query will be made against DB and cached for use next time.
$customer = $db-&gt;cache(function (Connection $db) {
    return $db-&gt;createCommand('SELECT * FROM customer WHERE id=1')-&gt;queryOne();
});
</pre> <p>Note that query cache is only meaningful for queries that return results. For queries performed with <a href="yii-db-command.html#execute()-detail">yii\db\Command::execute()</a>, query cache will not be used.</p> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a></li>
<li><a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a></li>
<li><a href="yii-db-connection.html#noCache()-detail">noCache()</a></li>
</ul>  <table> <tr><th colspan="3">public mixed <strong><a href="yii-db-connection.html#cache()-detail">cache</a></strong> ( <a href="http://www.php.net/language.types.callable">callable</a> $callable, $duration = null, $dependency = null )</th></tr> <tr> <td>$callable</td> <td><a href="http://www.php.net/language.types.callable">callable</a></td> <td>
<p>A PHP callable that contains DB queries which will make use of query cache. The signature of the callable is <code>function (Connection $db)</code>.</p> </td> </tr> <tr> <td>$duration</td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>
<p>The number of seconds that query results can remain valid in the cache. If this is not set, the value of <a href="yii-db-connection.html#%24queryCacheDuration-detail">$queryCacheDuration</a> will be used instead. Use 0 to indicate that the cached data will never expire.</p> </td> </tr> <tr> <td>$dependency</td> <td><a href="yii-caching-dependency.html">yii\caching\Dependency</a></td> <td>
<p>The cache dependency associated with the cached query results.</p> </td> </tr> <tr> <td>return</td> <td>mixed</td> <td>
<p>The return result of the callable</p> </td> </tr> <tr> <td>throws</td> <td>\Exception|\Throwable</td> <td>
<p>if there is any exception during query</p> </td> </tr> </table>  <h3 id="close()-detail"> close() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Closes the currently active DB connection.</strong></p> <p>It does nothing if the connection is already closed.</p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-connection.html#close()-detail">close</a></strong> ( )</th></tr> </table>  <h3 id="createCommand()-detail"> createCommand() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Creates a command for execution.</strong></p>  <table> <tr><th colspan="3">public <a href="yii-db-command.html">yii\db\Command</a> <strong><a href="yii-db-connection.html#createCommand()-detail">createCommand</a></strong> ( $sql = null, $params = [] )</th></tr> <tr> <td>$sql</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The SQL statement to be executed</p> </td> </tr> <tr> <td>$params</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The parameters to be bound to the SQL statement</p> </td> </tr> <tr> <td>return</td> <td><a href="yii-db-command.html">yii\db\Command</a></td> <td>
<p>The DB command</p> </td> </tr> </table>  <h3 id="createPdoInstance()-detail"> createPdoInstance() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Creates the PDO instance.</strong></p> <p>This method is called by <a href="yii-db-connection.html#open()-detail">open()</a> to establish a DB connection. The default implementation will create a PHP PDO instance. You may override this method if the default PDO needs to be adapted for certain DBMS.</p>  <table> <tr><th colspan="3">protected <a href="http://www.php.net/class.pdo">PDO</a> <strong><a href="yii-db-connection.html#createPdoInstance()-detail">createPdoInstance</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="http://www.php.net/class.pdo">PDO</a></td> <td>
<p>The pdo instance</p> </td> </tr> </table>  <h3 id="getDriverName()-detail"> getDriverName() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the name of the DB driver. Based on the the current <a href="yii-db-connection.html#%24dsn-detail">$dsn</a>, in case it was not set explicitly by an end user.</strong></p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-db-connection.html#getDriverName()-detail">getDriverName</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Name of the DB driver</p> </td> </tr> </table>  <h3 id="getIsActive()-detail"> getIsActive() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns a value indicating whether the DB connection is established.</strong></p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.boolean">boolean</a> <strong><a href="yii-db-connection.html#getIsActive()-detail">getIsActive</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Whether the DB connection is established</p> </td> </tr> </table>  <h3 id="getLastInsertID()-detail"> getLastInsertID() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the ID of the last inserted row or sequence value.</strong></p> <p>See also <a href="http://php.net/manual/en/pdo.lastinsertid.php">http://php.net/manual/en/pdo.lastinsertid.php</a>.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-db-connection.html#getLastInsertID()-detail">getLastInsertID</a></strong> ( $sequenceName = '' )</th></tr> <tr> <td>$sequenceName</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Name of the sequence object (required by some DBMS)</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The row ID of the last row inserted, or the last value retrieved from the sequence object</p> </td> </tr> </table>  <h3 id="getMaster()-detail"> getMaster() <span class="detail-header-tag small"> public method (available since version 2.0.11) </span> </h3>  <p><strong>Returns the currently active master connection.</strong></p> <p>If this method is called for the first time, it will try to open a master connection.</p>  <table> <tr><th colspan="3">public <a href="yii-db-connection.html">yii\db\Connection</a> <strong><a href="yii-db-connection.html#getMaster()-detail">getMaster</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>
<p>The currently active master connection. <code>null</code> is returned if there is no master available.</p> </td> </tr> </table>  <h3 id="getMasterPdo()-detail"> getMasterPdo() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the PDO instance for the currently active master connection.</strong></p> <p>This method will open the master DB connection and then return <a href="yii-db-connection.html#%24pdo-detail">$pdo</a>.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/class.pdo">PDO</a> <strong><a href="yii-db-connection.html#getMasterPdo()-detail">getMasterPdo</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="http://www.php.net/class.pdo">PDO</a></td> <td>
<p>The PDO instance for the currently active master connection.</p> </td> </tr> </table>  <h3 id="getQueryBuilder()-detail"> getQueryBuilder() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the query builder for the current DB connection.</strong></p>  <table> <tr><th colspan="3">public <a href="yii-db-querybuilder.html">yii\db\QueryBuilder</a> <strong><a href="yii-db-connection.html#getQueryBuilder()-detail">getQueryBuilder</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="yii-db-querybuilder.html">yii\db\QueryBuilder</a></td> <td>
<p>The query builder for the current DB connection.</p> </td> </tr> </table>  <h3 id="getQueryCacheInfo()-detail"> getQueryCacheInfo() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the current query cache information.</strong></p> <p>This method is used internally by <a href="yii-db-command.html">yii\db\Command</a>.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.array">array</a> <strong><a href="yii-db-connection.html#getQueryCacheInfo()-detail">getQueryCacheInfo</a></strong> ( $duration, $dependency )</th></tr> <tr> <td>$duration</td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>
<p>The preferred caching duration. If null, it will be ignored.</p> </td> </tr> <tr> <td>$dependency</td> <td><a href="yii-caching-dependency.html">yii\caching\Dependency</a></td> <td>
<p>The preferred caching dependency. If null, it will be ignored.</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The current query cache information, or null if query cache is not enabled.</p> </td> </tr> </table>  <h3 id="getSchema()-detail"> getSchema() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the schema information for the database opened by this connection.</strong></p>  <table> <tr><th colspan="3">public <a href="yii-db-schema.html">yii\db\Schema</a> <strong><a href="yii-db-connection.html#getSchema()-detail">getSchema</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="yii-db-schema.html">yii\db\Schema</a></td> <td>
<p>The schema information for the database opened by this connection.</p> </td> </tr> <tr> <td>throws</td> <td><a href="yii-base-notsupportedexception.html">yii\base\NotSupportedException</a></td> <td>
<p>if there is no support for the current driver type</p> </td> </tr> </table>  <h3 id="getSlave()-detail"> getSlave() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the currently active slave connection.</strong></p> <p>If this method is called for the first time, it will try to open a slave connection when <a href="yii-db-connection.html#%24enableSlaves-detail">$enableSlaves</a> is true.</p>  <table> <tr><th colspan="3">public <a href="yii-db-connection.html">yii\db\Connection</a> <strong><a href="yii-db-connection.html#getSlave()-detail">getSlave</a></strong> ( $fallbackToMaster = true )</th></tr> <tr> <td>$fallbackToMaster</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Whether to return a master connection in case there is no slave connection available.</p> </td> </tr> <tr> <td>return</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>
<p>The currently active slave connection. <code>null</code> is returned if there is no slave available and <code>$fallbackToMaster</code> is false.</p> </td> </tr> </table>  <h3 id="getSlavePdo()-detail"> getSlavePdo() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the PDO instance for the currently active slave connection.</strong></p> <p>When <a href="yii-db-connection.html#%24enableSlaves-detail">$enableSlaves</a> is true, one of the slaves will be used for read queries, and its PDO instance will be returned by this method.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/class.pdo">PDO</a> <strong><a href="yii-db-connection.html#getSlavePdo()-detail">getSlavePdo</a></strong> ( $fallbackToMaster = true )</th></tr> <tr> <td>$fallbackToMaster</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Whether to return a master PDO in case none of the slave connections is available.</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/class.pdo">PDO</a></td> <td>
<p>The PDO instance for the currently active slave connection. <code>null</code> is returned if no slave connection is available and <code>$fallbackToMaster</code> is false.</p> </td> </tr> </table>  <h3 id="getTableSchema()-detail"> getTableSchema() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Obtains the schema information for the named table.</strong></p>  <table> <tr><th colspan="3">public <a href="yii-db-tableschema.html">yii\db\TableSchema</a> <strong><a href="yii-db-connection.html#getTableSchema()-detail">getTableSchema</a></strong> ( $name, $refresh = false )</th></tr> <tr> <td>$name</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Table name.</p> </td> </tr> <tr> <td>$refresh</td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>
<p>Whether to reload the table schema even if it is found in the cache.</p> </td> </tr> <tr> <td>return</td> <td><a href="yii-db-tableschema.html">yii\db\TableSchema</a></td> <td>
<p>Table schema information. Null if the named table does not exist.</p> </td> </tr> </table>  <h3 id="getTransaction()-detail"> getTransaction() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Returns the currently active transaction.</strong></p>  <table> <tr><th colspan="3">public <a href="yii-db-transaction.html">yii\db\Transaction</a> <strong><a href="yii-db-connection.html#getTransaction()-detail">getTransaction</a></strong> ( )</th></tr> <tr> <td>return</td> <td><a href="yii-db-transaction.html">yii\db\Transaction</a></td> <td>
<p>The currently active transaction. Null if no active transaction.</p> </td> </tr> </table>  <h3 id="initConnection()-detail"> initConnection() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Initializes the DB connection.</strong></p> <p>This method is invoked right after the DB connection is established. The default implementation turns on <code>PDO::ATTR_EMULATE_PREPARES</code> if <a href="yii-db-connection.html#%24emulatePrepare-detail">$emulatePrepare</a> is true, and sets the database <a href="yii-db-connection.html#%24charset-detail">$charset</a> if it is not empty. It then triggers an <a href="yii-db-connection.html#EVENT_AFTER_OPEN-detail">EVENT_AFTER_OPEN</a> event.</p>  <table> <tr><th colspan="3">protected void <strong><a href="yii-db-connection.html#initConnection()-detail">initConnection</a></strong> ( )</th></tr> </table>  <h3 id="noCache()-detail"> noCache() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Disables query cache temporarily.</strong></p> <p>Queries performed within the callable will not use query cache at all. For example,</p> <pre data-language="php">$db-&gt;cache(function (Connection $db) {

    // ... queries that use query cache ...

    return $db-&gt;noCache(function (Connection $db) {
        // this query will not use query cache
        return $db-&gt;createCommand('SELECT * FROM customer WHERE id=1')-&gt;queryOne();
    });
});
</pre> <p>See also:</p>
<ul>
<li><a href="yii-db-connection.html#%24enableQueryCache-detail">$enableQueryCache</a></li>
<li><a href="yii-db-connection.html#%24queryCache-detail">$queryCache</a></li>
<li><a href="yii-db-connection.html#cache()-detail">cache()</a></li>
</ul>  <table> <tr><th colspan="3">public mixed <strong><a href="yii-db-connection.html#noCache()-detail">noCache</a></strong> ( <a href="http://www.php.net/language.types.callable">callable</a> $callable )</th></tr> <tr> <td>$callable</td> <td><a href="http://www.php.net/language.types.callable">callable</a></td> <td>
<p>A PHP callable that contains DB queries which should not use query cache. The signature of the callable is <code>function (Connection $db)</code>.</p> </td> </tr> <tr> <td>return</td> <td>mixed</td> <td>
<p>The return result of the callable</p> </td> </tr> <tr> <td>throws</td> <td>\Exception|\Throwable</td> <td>
<p>if there is any exception during query</p> </td> </tr> </table>  <h3 id="open()-detail"> open() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Establishes a DB connection.</strong></p> <p>It does nothing if a DB connection has already been established.</p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-connection.html#open()-detail">open</a></strong> ( )</th></tr> <tr> <td>throws</td> <td><a href="yii-db-exception.html">yii\db\Exception</a></td> <td>
<p>if connection fails</p> </td> </tr> </table>  <h3 id="openFromPool()-detail"> openFromPool() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Opens the connection to a server in the pool.</strong></p> <p>This method implements the load balancing among the given list of the servers. Connections will be tried in random order.</p>  <table> <tr><th colspan="3">protected <a href="yii-db-connection.html">yii\db\Connection</a> <strong><a href="yii-db-connection.html#openFromPool()-detail">openFromPool</a></strong> ( <a href="http://www.php.net/language.types.array">array</a> $pool, <a href="http://www.php.net/language.types.array">array</a> $sharedConfig )</th></tr> <tr> <td>$pool</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The list of connection configurations in the server pool</p> </td> </tr> <tr> <td>$sharedConfig</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The configuration common to those given in <code>$pool</code>.</p> </td> </tr> <tr> <td>return</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>
<p>The opened DB connection, or <code>null</code> if no server is available</p> </td> </tr> <tr> <td>throws</td> <td><a href="yii-base-invalidconfigexception.html">yii\base\InvalidConfigException</a></td> <td>
<p>if a configuration does not specify "dsn"</p> </td> </tr> </table>  <h3 id="openFromPoolSequentially()-detail"> openFromPoolSequentially() <span class="detail-header-tag small"> protected method (available since version 2.0.11) </span> </h3>  <p><strong>Opens the connection to a server in the pool.</strong></p> <p>This method implements the load balancing among the given list of the servers. Connections will be tried in sequential order.</p>  <table> <tr><th colspan="3">protected <a href="yii-db-connection.html">yii\db\Connection</a> <strong><a href="yii-db-connection.html#openFromPoolSequentially()-detail">openFromPoolSequentially</a></strong> ( <a href="http://www.php.net/language.types.array">array</a> $pool, <a href="http://www.php.net/language.types.array">array</a> $sharedConfig )</th></tr> <tr> <td>$pool</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The list of connection configurations in the server pool</p> </td> </tr> <tr> <td>$sharedConfig</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The configuration common to those given in <code>$pool</code>.</p> </td> </tr> <tr> <td>return</td> <td><a href="yii-db-connection.html">yii\db\Connection</a></td> <td>
<p>The opened DB connection, or <code>null</code> if no server is available</p> </td> </tr> <tr> <td>throws</td> <td><a href="yii-base-invalidconfigexception.html">yii\base\InvalidConfigException</a></td> <td>
<p>if a configuration does not specify "dsn"</p> </td> </tr> </table>  <h3 id="quoteColumnName()-detail"> quoteColumnName() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Quotes a column name for use in a query.</strong></p> <p>If the column name contains prefix, the prefix will also be properly quoted. If the column name is already quoted or contains special characters including '(', '[[' and '{{', then this method will do nothing.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-db-connection.html#quoteColumnName()-detail">quoteColumnName</a></strong> ( $name )</th></tr> <tr> <td>$name</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Column name</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The properly quoted column name</p> </td> </tr> </table>  <h3 id="quoteSql()-detail"> quoteSql() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Processes a SQL statement by quoting table and column names that are enclosed within double brackets.</strong></p> <p>Tokens enclosed within double curly brackets are treated as table names, while tokens enclosed within double square brackets are column names. They will be quoted accordingly. Also, the percentage character "%" at the beginning or ending of a table name will be replaced with <a href="yii-db-connection.html#%24tablePrefix-detail">$tablePrefix</a>.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-db-connection.html#quoteSql()-detail">quoteSql</a></strong> ( $sql )</th></tr> <tr> <td>$sql</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The SQL to be quoted</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The quoted SQL</p> </td> </tr> </table>  <h3 id="quoteTableName()-detail"> quoteTableName() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Quotes a table name for use in a query.</strong></p> <p>If the table name contains schema prefix, the prefix will also be properly quoted. If the table name is already quoted or contains special characters including '(', '[[' and '{{', then this method will do nothing.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-db-connection.html#quoteTableName()-detail">quoteTableName</a></strong> ( $name )</th></tr> <tr> <td>$name</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Table name</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The properly quoted table name</p> </td> </tr> </table>  <h3 id="quoteValue()-detail"> quoteValue() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Quotes a string value for use in a query.</strong></p> <p>Note that if the parameter is not a string, it will be returned without change.</p> <p>See also <a href="http://php.net/manual/en/pdo.quote.php">http://php.net/manual/en/pdo.quote.php</a>.</p>  <table> <tr><th colspan="3">public <a href="http://www.php.net/language.types.string">string</a> <strong><a href="yii-db-connection.html#quoteValue()-detail">quoteValue</a></strong> ( $value )</th></tr> <tr> <td>$value</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>String to be quoted</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The properly quoted string</p> </td> </tr> </table>  <h3 id="setDriverName()-detail"> setDriverName() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Changes the current driver name.</strong></p>  <table> <tr><th colspan="3">public void <strong><a href="yii-db-connection.html#setDriverName()-detail">setDriverName</a></strong> ( $driverName )</th></tr> <tr> <td>$driverName</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>Name of the DB driver</p> </td> </tr> </table>  <h3 id="transaction()-detail"> transaction() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Executes callback provided in a transaction.</strong></p>  <table> <tr><th colspan="3">public mixed <strong><a href="yii-db-connection.html#transaction()-detail">transaction</a></strong> ( <a href="http://www.php.net/language.types.callable">callable</a> $callback, $isolationLevel = null )</th></tr> <tr> <td>$callback</td> <td><a href="http://www.php.net/language.types.callable">callable</a></td> <td>
<p>A valid PHP callback that performs the job. Accepts connection instance as parameter.</p> </td> </tr> <tr> <td>$isolationLevel</td> <td>
<a href="http://www.php.net/language.types.string">string</a>|<a href="http://www.php.net/language.types.null">null</a>
</td> <td>
<p>The isolation level to use for this transaction. See <a href="yii-db-transaction.html#begin()-detail">yii\db\Transaction::begin()</a> for details.</p> </td> </tr> <tr> <td>return</td> <td>mixed</td> <td>
<p>Result of callback function</p> </td> </tr> <tr> <td>throws</td> <td>\Exception|\Throwable</td> <td>
<p>if there is any exception during query. In this case the transaction will be rolled back.</p> </td> </tr> </table>  <h3 id="useMaster()-detail"> useMaster() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Executes the provided callback by using the master connection.</strong></p> <p>This method is provided so that you can temporarily force using the master connection to perform DB operations even if they are read queries. For example,</p> <pre data-language="php">$result = $db-&gt;useMaster(function ($db) {
    return $db-&gt;createCommand('SELECT * FROM user LIMIT 1')-&gt;queryOne();
});
</pre>  <table> <tr><th colspan="3">public mixed <strong><a href="yii-db-connection.html#useMaster()-detail">useMaster</a></strong> ( <a href="http://www.php.net/language.types.callable">callable</a> $callback )</th></tr> <tr> <td>$callback</td> <td><a href="http://www.php.net/language.types.callable">callable</a></td> <td>
<p>A PHP callable to be executed by this method. Its signature is <code>function (Connection $db)</code>. Its return value will be returned by this method.</p> </td> </tr> <tr> <td>return</td> <td>mixed</td> <td>
<p>The return value of the callback</p> </td> </tr> <tr> <td>throws</td> <td>\Exception|\Throwable</td> <td>
<p>if there is any exception thrown from the callback</p> </td> </tr> </table>  </div> <h2>Event Details</h2> <div class="event-doc"> <h3 id="EVENT_AFTER_OPEN-detail"> EVENT_AFTER_OPEN <span class="detail-header-tag small"> event of type \yii\db\Event </span> </h3>  <p>An event that is triggered after a DB connection is established</p>  <h3 id="EVENT_BEGIN_TRANSACTION-detail"> EVENT_BEGIN_TRANSACTION <span class="detail-header-tag small"> event of type \yii\db\Event </span> </h3>  <p>An event that is triggered right before a top-level transaction is started</p>  <h3 id="EVENT_COMMIT_TRANSACTION-detail"> EVENT_COMMIT_TRANSACTION <span class="detail-header-tag small"> event of type \yii\db\Event </span> </h3>  <p>An event that is triggered right after a top-level transaction is committed</p>  <h3 id="EVENT_ROLLBACK_TRANSACTION-detail"> EVENT_ROLLBACK_TRANSACTION <span class="detail-header-tag small"> event of type \yii\db\Event </span> </h3>  <p>An event that is triggered right after a top-level transaction is rolled back</p>  </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2008&ndash;2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc-2.0/yii-db-connection.html" class="_attribution-link">http://www.yiiframework.com/doc-2.0/yii-db-connection.html</a>
  </p>
</div>
