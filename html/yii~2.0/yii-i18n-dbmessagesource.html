<h1>Class yii\i18n\DbMessageSource</h1> <div class="top-nav"> <a href="index.html">All Classes</a> | <a href="#properties">Properties</a> | <a href="#methods">Methods</a> | <a href="#events">Events</a> | <a href="#constants">Constants</a> </div> <table> <colgroup> <col class="col-name"> <col class="col-value"> </colgroup> <tr>
<th>Inheritance</th>
<td>
<a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a> » <a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a> » <a href="yii-base-component.html">yii\base\Component</a> » <a href="yii-base-object.html">yii\base\Object</a>
</td>
</tr> <tr>
<th>Implements</th>
<td><a href="yii-base-configurable.html">yii\base\Configurable</a></td>
</tr> <tr>
<th>Available since version</th>
<td>2.0</td>
</tr> <tr> <th>Source Code</th> <td><a href="https://github.com/yiisoft/yii2/blob/master/framework/i18n/DbMessageSource.php">https://github.com/yiisoft/yii2/blob/master/framework/i18n/DbMessageSource.php</a></td> </tr> </table>  <p><strong>DbMessageSource extends <a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a> and represents a message source that stores translated messages in database.</strong></p> <p>The database must contain the following two tables: source_message and message.</p> <p>The <code>source_message</code> table stores the messages to be translated, and the <code>message</code> table stores the translated messages. The name of these two tables can be customized by setting <a href="yii-i18n-dbmessagesource.html#%24sourceMessageTable-detail">$sourceMessageTable</a> and <a href="yii-i18n-dbmessagesource.html#%24messageTable-detail">$messageTable</a>, respectively.</p> <p>The database connection is specified by <a href="yii-i18n-dbmessagesource.html#%24db-detail">$db</a>. Database schema could be initialized by applying migration:</p> <pre data-language="php">yii migrate --migrationPath=@yii/i18n/migrations/
</pre> <p>If you don't want to use migration and need SQL instead, files for all databases are in migrations directory.</p>    <h2 id="properties">Public Properties</h2>  <table> <colgroup> <col class="col-property"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Property</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="$behaviors"> <td><a href="yii-base-component.html#%24behaviors-detail">$behaviors</a></td> <td>
<a href="yii-base-behavior.html">yii\base\Behavior</a>[]</td> <td>List of behaviors attached to this component</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="$cache"> <td><a href="yii-i18n-dbmessagesource.html#%24cache-detail">$cache</a></td> <td>
<a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.array">array</a>|<a href="http://www.php.net/language.types.string">string</a>
</td> <td>The cache object or the application component ID of the cache object.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="$cachingDuration"> <td><a href="yii-i18n-dbmessagesource.html#%24cachingDuration-detail">$cachingDuration</a></td> <td><a href="http://www.php.net/language.types.integer">integer</a></td> <td>The time in seconds that the messages can remain valid in cache.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="$db"> <td><a href="yii-i18n-dbmessagesource.html#%24db-detail">$db</a></td> <td>
<a href="yii-db-connection.html">yii\db\Connection</a>|<a href="http://www.php.net/language.types.array">array</a>|<a href="http://www.php.net/language.types.string">string</a>
</td> <td>The DB connection object or the application component ID of the DB connection.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="$enableCaching"> <td><a href="yii-i18n-dbmessagesource.html#%24enableCaching-detail">$enableCaching</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to enable caching translated messages</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="$forceTranslation"> <td><a href="yii-i18n-messagesource.html#%24forceTranslation-detail">$forceTranslation</a></td> <td><a href="http://www.php.net/language.types.boolean">boolean</a></td> <td>Whether to force message translation when the source and target languages are the same.</td> <td><a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a></td> </tr> <tr id="$messageTable"> <td><a href="yii-i18n-dbmessagesource.html#%24messageTable-detail">$messageTable</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The name of the translated message table.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="$sourceLanguage"> <td><a href="yii-i18n-messagesource.html#%24sourceLanguage-detail">$sourceLanguage</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The language that the original messages are in.</td> <td><a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a></td> </tr> <tr id="$sourceMessageTable"> <td><a href="yii-i18n-dbmessagesource.html#%24sourceMessageTable-detail">$sourceMessageTable</a></td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>The name of the source message table.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> </table>    <h2 id="methods">Public Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="__call()"> <td><a href="yii-base-component.html#__call()-detail">__call()</a></td> <td>Calls the named method which is not a class method.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__clone()"> <td><a href="yii-base-component.html#__clone()-detail">__clone()</a></td> <td>This method is called after the object is created by cloning an existing one.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__construct()"> <td><a href="yii-base-object.html#__construct()-detail">__construct()</a></td> <td>Constructor.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="__get()"> <td><a href="yii-base-component.html#__get()-detail">__get()</a></td> <td>Returns the value of a component property.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__isset()"> <td><a href="yii-base-component.html#__isset()-detail">__isset()</a></td> <td>Checks if a property is set, i.e. defined and not null.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__set()"> <td><a href="yii-base-component.html#__set()-detail">__set()</a></td> <td>Sets the value of a component property.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="__unset()"> <td><a href="yii-base-component.html#__unset()-detail">__unset()</a></td> <td>Sets a component property to be null.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="attachBehavior()"> <td><a href="yii-base-component.html#attachBehavior()-detail">attachBehavior()</a></td> <td>Attaches a behavior to this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="attachBehaviors()"> <td><a href="yii-base-component.html#attachBehaviors()-detail">attachBehaviors()</a></td> <td>Attaches a list of behaviors to the component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="behaviors()"> <td><a href="yii-base-component.html#behaviors()-detail">behaviors()</a></td> <td>Returns a list of behaviors that this component should behave as.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="canGetProperty()"> <td><a href="yii-base-component.html#canGetProperty()-detail">canGetProperty()</a></td> <td>Returns a value indicating whether a property can be read.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="canSetProperty()"> <td><a href="yii-base-component.html#canSetProperty()-detail">canSetProperty()</a></td> <td>Returns a value indicating whether a property can be set.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="className()"> <td><a href="yii-base-object.html#className()-detail">className()</a></td> <td>Returns the fully qualified name of this class.</td> <td><a href="yii-base-object.html">yii\base\Object</a></td> </tr> <tr id="detachBehavior()"> <td><a href="yii-base-component.html#detachBehavior()-detail">detachBehavior()</a></td> <td>Detaches a behavior from the component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="detachBehaviors()"> <td><a href="yii-base-component.html#detachBehaviors()-detail">detachBehaviors()</a></td> <td>Detaches all behaviors from the component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="ensureBehaviors()"> <td><a href="yii-base-component.html#ensureBehaviors()-detail">ensureBehaviors()</a></td> <td>Makes sure that the behaviors declared in <a href="yii-base-component.html#behaviors()-detail">behaviors()</a> are attached to this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="getBehavior()"> <td><a href="yii-base-component.html#getBehavior()-detail">getBehavior()</a></td> <td>Returns the named behavior object.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="getBehaviors()"> <td><a href="yii-base-component.html#getBehaviors()-detail">getBehaviors()</a></td> <td>Returns all behaviors attached to this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="hasEventHandlers()"> <td><a href="yii-base-component.html#hasEventHandlers()-detail">hasEventHandlers()</a></td> <td>Returns a value indicating whether there is any handler attached to the named event.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="hasMethod()"> <td><a href="yii-base-component.html#hasMethod()-detail">hasMethod()</a></td> <td>Returns a value indicating whether a method is defined.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="hasProperty()"> <td><a href="yii-base-component.html#hasProperty()-detail">hasProperty()</a></td> <td>Returns a value indicating whether a property is defined for this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="init()"> <td><a href="yii-i18n-dbmessagesource.html#init()-detail">init()</a></td> <td>Initializes the DbMessageSource component.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="off()"> <td><a href="yii-base-component.html#off()-detail">off()</a></td> <td>Detaches an existing event handler from this component.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="on()"> <td><a href="yii-base-component.html#on()-detail">on()</a></td> <td>Attaches an event handler to an event.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> <tr id="translate()"> <td><a href="yii-i18n-messagesource.html#translate()-detail">translate()</a></td> <td>Translates a message to the specified language.</td> <td><a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a></td> </tr> <tr id="trigger()"> <td><a href="yii-base-component.html#trigger()-detail">trigger()</a></td> <td>Triggers an event.</td> <td><a href="yii-base-component.html">yii\base\Component</a></td> </tr> </table>   <h2>Protected Methods</h2>  <table> <colgroup> <col class="col-method"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Method</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="createFallbackQuery()"> <td><a href="yii-i18n-dbmessagesource.html#createFallbackQuery()-detail">createFallbackQuery()</a></td> <td>The method builds the <a href="yii-db-query.html">yii\db\Query</a> object for the fallback language messages search.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="loadMessages()"> <td><a href="yii-i18n-dbmessagesource.html#loadMessages()-detail">loadMessages()</a></td> <td>Loads the message translation for the specified language and category.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="loadMessagesFromDb()"> <td><a href="yii-i18n-dbmessagesource.html#loadMessagesFromDb()-detail">loadMessagesFromDb()</a></td> <td>Loads the messages from database.</td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> <tr id="translateMessage()"> <td><a href="yii-i18n-messagesource.html#translateMessage()-detail">translateMessage()</a></td> <td>Translates the specified message.</td> <td><a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a></td> </tr> </table>    <h2 id="events">Events</h2>  <table> <colgroup> <col class="col-event"> <col class="col-type"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Event</th>
<th>Type</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="EVENT_MISSING_TRANSLATION"> <td><a href="yii-i18n-messagesource.html#EVENT_MISSING_TRANSLATION-detail">EVENT_MISSING_TRANSLATION</a></td> <td><a href="yii-i18n-missingtranslationevent.html">yii\i18n\MissingTranslationEvent</a></td> <td> An event that is triggered when a message translation is not found. </td> <td><a href="yii-i18n-messagesource.html">yii\i18n\MessageSource</a></td> </tr> </table>    <h2 id="constants">Constants</h2>  <table> <colgroup> <col class="col-const"> <col class="col-value"> <col class="col-description"> <col class="col-defined"> </colgroup> <tr> <th>Constant</th>
<th>Value</th>
<th>Description</th>
<th>Defined By</th> </tr> <tr id="CACHE_KEY_PREFIX"> <td id="CACHE_KEY_PREFIX-detail">CACHE_KEY_PREFIX</td> <td>'DbMessageSource'</td> <td>Prefix which would be used when generating cache key. <strong>Deprecated This constant has never been used and will be removed in 2.1.0.</strong> </td> <td><a href="yii-i18n-dbmessagesource.html">yii\i18n\DbMessageSource</a></td> </tr> </table>  <h2>Property Details</h2>  <h3 id="$cache-detail"> $cache <span class="detail-header-tag small"> public property </span> </h3>  <p>The cache object or the application component ID of the cache object. The messages data will be cached using this cache object. Note, that to enable caching you have to set <a href="yii-i18n-dbmessagesource.html#%24enableCaching-detail">$enableCaching</a> to <code>true</code>, otherwise setting this property has no effect.</p> <p>After the DbMessageSource object is created, if you want to change this property, you should only assign it with a cache object.</p> <p>Starting from version 2.0.2, this can also be a configuration array for creating the object.</p> <p>See also:</p>
<ul>
<li><a href="yii-i18n-dbmessagesource.html#%24cachingDuration-detail">$cachingDuration</a></li>
<li><a href="yii-i18n-dbmessagesource.html#%24enableCaching-detail">$enableCaching</a></li>
</ul>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-caching-cacheinterface.html">yii\caching\CacheInterface</a>|<a href="http://www.php.net/language.types.array">array</a>|<a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-i18n-dbmessagesource.html#%24cache-detail">$cache</a> = 'cache'</pre> <h3 id="$cachingDuration-detail"> $cachingDuration <span class="detail-header-tag small"> public property </span> </h3>  <p>The time in seconds that the messages can remain valid in cache. Use 0 to indicate that the cached data will never expire.</p> <p>See also <a href="yii-i18n-dbmessagesource.html#%24enableCaching-detail">$enableCaching</a>.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.integer">integer</a></span> <a href="yii-i18n-dbmessagesource.html#%24cachingDuration-detail">$cachingDuration</a> = 0</pre> <h3 id="$db-detail"> $db <span class="detail-header-tag small"> public property </span> </h3>  <p>The DB connection object or the application component ID of the DB connection.</p> <p>After the DbMessageSource object is created, if you want to change this property, you should only assign it with a DB connection object.</p> <p>Starting from version 2.0.2, this can also be a configuration array for creating the object.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="yii-db-connection.html">yii\db\Connection</a>|<a href="http://www.php.net/language.types.array">array</a>|<a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-i18n-dbmessagesource.html#%24db-detail">$db</a> = 'db'</pre> <h3 id="$enableCaching-detail"> $enableCaching <span class="detail-header-tag small"> public property </span> </h3>  <p>Whether to enable caching translated messages</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.boolean">boolean</a></span> <a href="yii-i18n-dbmessagesource.html#%24enableCaching-detail">$enableCaching</a> = false</pre> <h3 id="$messageTable-detail"> $messageTable <span class="detail-header-tag small"> public property </span> </h3>  <p>The name of the translated message table.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-i18n-dbmessagesource.html#%24messageTable-detail">$messageTable</a> = '{{%message}}'</pre> <h3 id="$sourceMessageTable-detail"> $sourceMessageTable <span class="detail-header-tag small"> public property </span> </h3>  <p>The name of the source message table.</p>  <pre><span class="signature-defs">public</span> <span class="signature-type"><a href="http://www.php.net/language.types.string">string</a></span> <a href="yii-i18n-dbmessagesource.html#%24sourceMessageTable-detail">$sourceMessageTable</a> = '{{%source_message}}'</pre>  <h2>Method Details</h2> <div class="method-doc"> <h3 id="createFallbackQuery()-detail"> createFallbackQuery() <span class="detail-header-tag small"> protected method (available since version 2.0.7) </span> </h3>  <p><strong>The method builds the <a href="yii-db-query.html">yii\db\Query</a> object for the fallback language messages search.</strong></p> <p>Normally is called from <a href="yii-i18n-dbmessagesource.html#loadMessagesFromDb()-detail">loadMessagesFromDb()</a>.</p> <p>See also <a href="yii-i18n-dbmessagesource.html#loadMessagesFromDb()-detail">loadMessagesFromDb()</a>.</p>  <table> <tr><th colspan="3">protected <a href="yii-db-query.html">yii\db\Query</a> <strong><a href="yii-i18n-dbmessagesource.html#createFallbackQuery()-detail">createFallbackQuery</a></strong> ( $category, $language, $fallbackLanguage )</th></tr> <tr> <td>$category</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The message category</p> </td> </tr> <tr> <td>$language</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The originally requested language</p> </td> </tr> <tr> <td>$fallbackLanguage</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The target fallback language</p> </td> </tr> </table>  <h3 id="init()-detail"> init() <span class="detail-header-tag small"> public method </span> </h3>  <p><strong>Initializes the DbMessageSource component.</strong></p> <p>This method will initialize the <a href="yii-i18n-dbmessagesource.html#%24db-detail">$db</a> property to make sure it refers to a valid DB connection. Configured <a href="yii-i18n-dbmessagesource.html#%24cache-detail">$cache</a> component would also be initialized.</p>  <table> <tr><th colspan="3">public void <strong><a href="yii-i18n-dbmessagesource.html#init()-detail">init</a></strong> ( )</th></tr> <tr> <td>throws</td> <td><a href="yii-base-invalidconfigexception.html">yii\base\InvalidConfigException</a></td> <td>
<p>if <a href="yii-i18n-dbmessagesource.html#%24db-detail">$db</a> is invalid or <a href="yii-i18n-dbmessagesource.html#%24cache-detail">$cache</a> is invalid.</p> </td> </tr> </table>  <h3 id="loadMessages()-detail"> loadMessages() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Loads the message translation for the specified language and category.</strong></p> <p>If translation for specific locale code such as <code>en-US</code> isn't found it tries more generic <code>en</code>.</p>  <table> <tr><th colspan="3">protected <a href="http://www.php.net/language.types.array">array</a> <strong><a href="yii-i18n-dbmessagesource.html#loadMessages()-detail">loadMessages</a></strong> ( $category, $language )</th></tr> <tr> <td>$category</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The message category</p> </td> </tr> <tr> <td>$language</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The target language</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The loaded messages. The keys are original messages, and the values are translated messages.</p> </td> </tr> </table>  <h3 id="loadMessagesFromDb()-detail"> loadMessagesFromDb() <span class="detail-header-tag small"> protected method </span> </h3>  <p><strong>Loads the messages from database.</strong></p> <p>You may override this method to customize the message storage in the database.</p>  <table> <tr><th colspan="3">protected <a href="http://www.php.net/language.types.array">array</a> <strong><a href="yii-i18n-dbmessagesource.html#loadMessagesFromDb()-detail">loadMessagesFromDb</a></strong> ( $category, $language )</th></tr> <tr> <td>$category</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The message category.</p> </td> </tr> <tr> <td>$language</td> <td><a href="http://www.php.net/language.types.string">string</a></td> <td>
<p>The target language.</p> </td> </tr> <tr> <td>return</td> <td><a href="http://www.php.net/language.types.array">array</a></td> <td>
<p>The messages loaded from database.</p> </td> </tr> </table>  </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2008&ndash;2017 by Yii Software LLC<br>Licensed under the three clause BSD license.<br>
    <a href="http://www.yiiframework.com/doc-2.0/yii-i18n-dbmessagesource.html" class="_attribution-link">http://www.yiiframework.com/doc-2.0/yii-i18n-dbmessagesource.html</a>
  </p>
</div>
