<h1>autodie::exception</h1>   <h2><a id="toc">CONTENTS</a></h2> <ul> <li> <a class="text-decoration-none" href="#NAME">NAME</a> </li> <li> <a class="text-decoration-none" href="#SYNOPSIS">SYNOPSIS</a> </li> <li> <a class="text-decoration-none" href="#DESCRIPTION">DESCRIPTION</a> <ul> <li> <a class="text-decoration-none" href="#Common-Methods">Common Methods</a> <ul> <li> <a class="text-decoration-none" href="#args">args</a> </li> <li> <a class="text-decoration-none" href="#function">function</a> </li> <li> <a class="text-decoration-none" href="#file">file</a> </li> <li> <a class="text-decoration-none" href="#package">package</a> </li> <li> <a class="text-decoration-none" href="#caller">caller</a> </li> <li> <a class="text-decoration-none" href="#line">line</a> </li> <li> <a class="text-decoration-none" href="#context">context</a> </li> <li> <a class="text-decoration-none" href="#return">return</a> </li> <li> <a class="text-decoration-none" href="#errno">errno</a> </li> <li> <a class="text-decoration-none" href="#eval_error">eval_error</a> </li> <li> <a class="text-decoration-none" href="#matches">matches</a> </li> </ul> </li> <li> <a class="text-decoration-none" href="#Advanced-methods">Advanced methods</a> <ul> <li> <a class="text-decoration-none" href="#register">register</a> </li> <li> <a class="text-decoration-none" href="#add_file_and_line">add_file_and_line</a> </li> <li> <a class="text-decoration-none" href="#stringify">stringify</a> </li> <li> <a class="text-decoration-none" href="#format_default">format_default</a> </li> <li> <a class="text-decoration-none" href="#new">new</a> </li> </ul> </li> </ul> </li> <li> <a class="text-decoration-none" href="#SEE-ALSO">SEE ALSO</a> </li> <li> <a class="text-decoration-none" href="#LICENSE">LICENSE</a> </li> <li> <a class="text-decoration-none" href="#AUTHOR">AUTHOR</a> </li> </ul> <h2 id="NAME">NAME</h2> <p>autodie::exception - Exceptions from autodying functions.</p> <h2 id="SYNOPSIS">SYNOPSIS</h2> <pre data-language="perl"><code>eval {
    use autodie;

    open(my $fh, '&lt;', 'some_file.txt');

    ...
};

if (my $E = $@) {
    say "Ooops!  ",$E-&gt;caller," had problems: $@";
}</code></pre> <h2 id="DESCRIPTION">DESCRIPTION</h2> <p>When an <a href="autodie.html">autodie</a> enabled function fails, it generates an <code>autodie::exception</code> object. This can be interrogated to determine further information about the error that occurred.</p> <p>This document is broken into two sections; those methods that are most useful to the end-developer, and those methods for anyone wishing to subclass or get very familiar with <code>autodie::exception</code>.</p> <h3 id="Common-Methods">
Common Methods</h3> <p>These methods are intended to be used in the everyday dealing of exceptions.</p> <p>The following assume that the error has been copied into a separate scalar:</p> <pre data-language="perl"><code>if ($E = $@) {
    ...
}</code></pre> <p>This is not required, but is recommended in case any code is called which may reset or alter <code>$@</code>.</p> <h4 id="args">args</h4> <pre data-language="perl"><code>my $array_ref = $E-&gt;args;</code></pre> <p>Provides a reference to the arguments passed to the subroutine that died.</p> <h4 id="function">function</h4> <pre data-language="perl"><code>my $sub = $E-&gt;function;</code></pre> <p>The subroutine (including package) that threw the exception.</p> <h4 id="file">file</h4> <pre data-language="perl"><code>my $file = $E-&gt;file;</code></pre> <p>The file in which the error occurred (eg, <code>myscript.pl</code> or <code>MyTest.pm</code>).</p> <h4 id="package">package</h4> <pre data-language="perl"><code>my $package = $E-&gt;package;</code></pre> <p>The package from which the exceptional subroutine was called.</p> <h4 id="caller">caller</h4> <pre data-language="perl"><code>my $caller = $E-&gt;caller;</code></pre> <p>The subroutine that <i>called</i> the exceptional code.</p> <h4 id="line">line</h4> <pre data-language="perl"><code>my $line = $E-&gt;line;</code></pre> <p>The line in <code>$E-&gt;file</code> where the exceptional code was called.</p> <h4 id="context">context</h4> <pre data-language="perl"><code>my $context = $E-&gt;context;</code></pre> <p>The context in which the subroutine was called by autodie; usually the same as the context in which you called the autodying subroutine. This can be 'list', 'scalar', or undefined (unknown). It will never be 'void', as <code>autodie</code> always captures the return value in one way or another.</p> <p>For some core functions that always return a scalar value regardless of their context (eg, <code>chown</code>), this may be 'scalar', even if you used a list context.</p> <h4 id="return">return</h4> <pre data-language="perl"><code>my $return_value = $E-&gt;return;</code></pre> <p>The value(s) returned by the failed subroutine. When the subroutine was called in a list context, this will always be a reference to an array containing the results. When the subroutine was called in a scalar context, this will be the actual scalar returned.</p> <h4 id="errno">errno</h4> <pre data-language="perl"><code>my $errno = $E-&gt;errno;</code></pre> <p>The value of <code>$!</code> at the time when the exception occurred.</p> <p><b>NOTE</b>: This method will leave the main <code>autodie::exception</code> class and become part of a role in the future. You should only call <code>errno</code> for exceptions where <code>$!</code> would reasonably have been set on failure.</p> <h4 id="eval_error">eval_error</h4> <pre data-language="perl"><code>my $old_eval_error = $E-&gt;eval_error;</code></pre> <p>The contents of <code>$@</code> immediately after autodie triggered an exception. This may be useful when dealing with modules such as <a href="Text::Balanced.html">Text::Balanced</a> that set (but do not throw) <code>$@</code> on error.</p> <h4 id="matches">matches</h4> <pre data-language="perl"><code>if ( $e-&gt;matches('open') ) { ... }

if ( 'open' ~~ $e ) { ... }</code></pre> <p><code>matches</code> is used to determine whether a given exception matches a particular role.</p> <p>An exception is considered to match a string if:</p> <ul> <li>
<p>For a string not starting with a colon, the string exactly matches the package and subroutine that threw the exception. For example, <code>MyModule::log</code>. If the string does not contain a package name, <code>CORE::</code> is assumed.</p> </li> <li>
<p>For a string that does start with a colon, if the subroutine throwing the exception <i>does</i> that behaviour. For example, the <code>CORE::open</code> subroutine does <code>:file</code>, <code>:io</code> and <code>:all</code>.</p> <p>See <a href="autodie.html#CATEGORIES">"CATEGORIES" in autodie</a> for further information.</p> <p>On Perl 5.10 and above, using smart-match (<code>~~</code>) with an <code>autodie::exception</code> object will use <code>matches</code> underneath. This module used to recommend using smart-match with the exception object on the left hand side, but in future Perls that is likely to stop working. The smart-match facility of this class should only be used with the exception object on the right hand side. Having the exception object on the right is both future-proof and portable to older Perls, back to 5.10. Beware that this facility can only be relied upon when it is certain that the exception object actually is an <code>autodie::exception</code> object; it is no more capable than an explicit call to the <code>matches</code> method.</p> </li> </ul> <h3 id="Advanced-methods">
Advanced methods</h3> <p>The following methods, while usable from anywhere, are primarily intended for developers wishing to subclass <code>autodie::exception</code>, write code that registers custom error messages, or otherwise work closely with the <code>autodie::exception</code> model.</p> <h4 id="register">register</h4> <pre data-language="perl"><code>autodie::exception-&gt;register( 'CORE::open' =&gt; \&amp;mysub );</code></pre> <p>The <code>register</code> method allows for the registration of a message handler for a given subroutine. The full subroutine name including the package should be used.</p> <p>Registered message handlers will receive the <code>autodie::exception</code> object as the first parameter.</p> <h4 id="add_file_and_line">add_file_and_line</h4> <pre data-language="perl"><code>say "Problem occurred",$@-&gt;add_file_and_line;</code></pre> <p>Returns the string <code> at %s line %d</code>, where <code>%s</code> is replaced with the filename, and <code>%d</code> is replaced with the line number.</p> <p>Primarily intended for use by format handlers.</p> <h4 id="stringify">stringify</h4> <pre data-language="perl"><code>say "The error was: ",$@-&gt;stringify;</code></pre> <p>Formats the error as a human readable string. Usually there's no reason to call this directly, as it is used automatically if an <code>autodie::exception</code> object is ever used as a string.</p> <p>Child classes can override this method to change how they're stringified.</p> <h4 id="format_default">format_default</h4> <pre data-language="perl"><code>my $error_string = $E-&gt;format_default;</code></pre> <p>This produces the default error string for the given exception, <i>without using any registered message handlers</i>. It is primarily intended to be called from a message handler when they have been passed an exception they don't want to format.</p> <p>Child classes can override this method to change how default messages are formatted.</p> <h4 id="new">new</h4> <pre data-language="perl"><code>my $error = autodie::exception-&gt;new(
    args =&gt; \@_,
    function =&gt; "CORE::open",
    errno =&gt; $!,
    context =&gt; 'scalar',
    return =&gt; undef,
);</code></pre> <p>Creates a new <code>autodie::exception</code> object. Normally called directly from an autodying function. The <code>function</code> argument is required, its the function we were trying to call that generated the exception. The <code>args</code> parameter is optional.</p> <p>The <code>errno</code> value is optional. In versions of <code>autodie::exception</code> 1.99 and earlier the code would try to automatically use the current value of <code>$!</code>, but this was unreliable and is no longer supported.</p> <p>Atrributes such as package, file, and caller are determined automatically, and cannot be specified.</p> <h2 id="SEE-ALSO">
SEE ALSO</h2> <p><a href="autodie.html">autodie</a>, <a href="autodie::exception::system.html">autodie::exception::system</a></p> <h2 id="LICENSE">LICENSE</h2> <p>Copyright (C)2008 Paul Fenwick</p> <p>This is free software. You may modify and/or redistribute this code under the same terms as Perl 5.10 itself, or, at your option, any later version of Perl 5.</p> <h2 id="AUTHOR">AUTHOR</h2> <p>Paul Fenwick &lt;pjf@perltraining.com.au&gt;</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993&ndash;2023 Larry Wall and others<br>Licensed under the GNU General Public License version 1 or later, or the Artistic License.<br>The Perl logo is a trademark of the Perl Foundation.<br>
    <a href="https://perldoc.perl.org/5.38.0/autodie::exception" class="_attribution-link">https://perldoc.perl.org/5.38.0/autodie::exception</a>
  </p>
</div>
