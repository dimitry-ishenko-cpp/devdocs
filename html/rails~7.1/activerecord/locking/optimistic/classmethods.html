<h1 id="module-ActiveRecord::Locking::Optimistic::ClassMethods" class="module"> module ActiveRecord::Locking::Optimistic::ClassMethods </h1>  <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="DEFAULT_LOCKING_COLUMN">DEFAULT_LOCKING_COLUMN </dt>

</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-locking_column"> <span class="method-name">locking_column</span><span class="attribute-access-type">[R]</span> </div> <div class="method-description"> <p>The version column used for optimistic locking. Defaults to <code>lock_version</code>.</p> </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-locking_column-3D"> <span class="method-name">locking_column=</span><span class="method-args">(value)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="locking_column-3D-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/locking/optimistic.rb, line 165
def locking_column=(value)
  reload_schema_from_cache
  @locking_column = value.to_s
end</pre> </div> <p>Set the column to use for optimistic locking. Defaults to <code>lock_version</code>.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-locking_enabled-3F"> <span class="method-name">locking_enabled?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="locking_enabled-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/locking/optimistic.rb, line 160
def locking_enabled?
  lock_optimistically &amp;&amp; columns_hash[locking_column]
end</pre> </div> <p>Returns true if the <code>lock_optimistically</code> flag is set to true (which it is, by default) and the table includes the <code>locking_column</code> column (defaults to <code>lock_version</code>).</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-reset_locking_column"> <span class="method-name">reset_locking_column</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="reset_locking_column-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/locking/optimistic.rb, line 174
def reset_locking_column
  self.locking_column = DEFAULT_LOCKING_COLUMN
end</pre> </div> <p>Reset the column used for optimistic locking back to the <code>lock_version</code> default.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-update_counters"> <span class="method-name">update_counters</span><span class="method-args">(id, counters)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="update_counters-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/locking/optimistic.rb, line 180
def update_counters(id, counters)
  counters = counters.merge(locking_column =&gt; 1) if locking_enabled?
  super
end</pre> </div> <p>Make sure the lock version column gets updated when counters are updated.</p> <div class="method-calls-super"> Calls superclass method </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2004&ndash;2021 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>
