<h1 id="class-ActiveRecord::ConnectionAdapters::SQLite3Adapter" class="class"> class ActiveRecord::ConnectionAdapters::SQLite3Adapter </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="abstractadapter.html">ActiveRecord::ConnectionAdapters::AbstractAdapter</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><span class="include">ActiveRecord::ConnectionAdapters::SQLite3::DatabaseStatements</span></dd>
</dl> <section class="description"> <h1 id="class-ActiveRecord::ConnectionAdapters::SQLite3Adapter-label-Active+Record+SQLite3+Adapter">Active Record  Adapter</h1> <p>The <span><code>SQLite3</code></span> adapter works with the sqlite3-ruby drivers (available as gem from <a href="https://rubygems.org/gems/sqlite3">rubygems.org/gems/sqlite3</a>).</p> <p>Options:</p> <ul><li> <p><code>:database</code> - Path to the database file.</p> </li></ul> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="ADAPTER_NAME">ADAPTER_NAME </dt>

<dt id="COLLATE_REGEX">COLLATE_REGEX </dt>

<dt id="EXTENDED_TYPE_MAPS">EXTENDED_TYPE_MAPS </dt>

<dt id="NATIVE_DATABASE_TYPES">NATIVE_DATABASE_TYPES </dt>

<dt id="PRIMARY_KEY_AUTOINCREMENT_REGEX">PRIMARY_KEY_AUTOINCREMENT_REGEX </dt>

<dt id="TYPE_MAP">TYPE_MAP </dt>

</dl> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-dbconsole"> <span class="method-name">dbconsole</span><span class="method-args">(config, options = {})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="dbconsole-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 51
def dbconsole(config, options = {})
  args = []

  args &lt;&lt; "-#{options[:mode]}" if options[:mode]
  args &lt;&lt; "-header" if options[:header]
  args &lt;&lt; File.expand_path(config.database, Rails.respond_to?(:root) ? Rails.root : nil)

  find_cmd_and_exec("sqlite3", *args)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(...)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 100
def initialize(...)
  super

  @memory_database = false
  case @config[:database].to_s
  when ""
    raise ArgumentError, "No database file specified. Missing argument: database"
  when ":memory:"
    @memory_database = true
  when /\Afile:/
  else
    # Otherwise we have a path relative to Rails.root
    @config[:database] = File.expand_path(@config[:database], Rails.root) if defined?(Rails.root)
    dirname = File.dirname(@config[:database])
    unless File.directory?(dirname)
      begin
        Dir.mkdir(dirname)
      rescue Errno::ENOENT =&gt; error
        if error.message.include?("No such file or directory")
          raise ActiveRecord::NoDatabaseError.new(connection_pool: @pool)
        else
          raise
        end
      end
    end
  end

  @config[:strict] = ConnectionAdapters::SQLite3Adapter.strict_strings_by_default unless @config.key?(:strict)
  @connection_parameters = @config.merge(database: @config[:database].to_s, results_as_hash: true)
  @use_insert_returning = @config.key?(:insert_returning) ? self.class.type_cast_config_to_boolean(@config[:insert_returning]) : true
end</pre> </div> <div class="method-calls-super"> Calls superclass method <a href="querycache.html#method-c-new"><code>ActiveRecord::ConnectionAdapters::QueryCache::new</code></a> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-new_client"> <span class="method-name">new_client</span><span class="method-args">(config)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="new_client-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 41
def new_client(config)
  ::SQLite3::Database.new(config[:database].to_s, config)
rescue Errno::ENOENT =&gt; error
  if error.message.include?("No such file or directory")
    raise ActiveRecord::NoDatabaseError
  else
    raise
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-strict_strings_by_default"> <span class="method-name">strict_strings_by_default</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="strict_strings_by_default-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 74
class_attribute :strict_strings_by_default, default: false
</pre> </div> <p>Configure the <a href="sqlite3adapter.html"><code>SQLite3Adapter</code></a> to be used in a strict strings mode. This will disable double-quoted string literals, because otherwise typos can silently go unnoticed. For example, it is possible to create an index for a non existing column. If you wish to enable this mode you can add the following line to your application.rb file:</p> <pre class="ruby" data-language="ruby">config.active_record.sqlite3_adapter_strict_strings_by_default = true
</pre>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-active-3F"> <span class="method-name">active?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="active-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 199
def active?
  @raw_connection &amp;&amp; !@raw_connection.closed?
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-add_timestamps"> <span class="method-name">add_timestamps</span><span class="method-args">(table_name, **options)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="add_timestamps-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 350
def add_timestamps(table_name, **options)
  options[:null] = false if options[:null].nil?

  if !options.key?(:precision)
    options[:precision] = 6
  end

  alter_table(table_name) do |definition|
    definition.column :created_at, :datetime, **options
    definition.column :updated_at, :datetime, **options
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-database_exists-3F"> <span class="method-name">database_exists?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="database_exists-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 132
def database_exists?
  @config[:database] == ":memory:" || File.exist?(@config[:database].to_s)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-disconnect-21"> <span class="method-name">disconnect!</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="disconnect-21-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 211
def disconnect!
  super

  @raw_connection&amp;.close rescue nil
  @raw_connection = nil
end</pre> </div> <p>Disconnects from the database if already connected. Otherwise, this method does nothing.</p> <div class="method-calls-super"> Calls superclass method <a href="abstractadapter.html#method-i-disconnect-21"><code>ActiveRecord::ConnectionAdapters::AbstractAdapter#disconnect!</code></a> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-encoding"> <span class="method-name">encoding</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="encoding-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 227
def encoding
  any_raw_connection.encoding.to_s
end</pre> </div> <p>Returns the current database encoding format as a string, e.g. ‘UTF-8’</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-foreign_keys"> <span class="method-name">foreign_keys</span><span class="method-args">(table_name)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="foreign_keys-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 368
def foreign_keys(table_name)
  # SQLite returns 1 row for each column of composite foreign keys.
  fk_info = internal_exec_query("PRAGMA foreign_key_list(#{quote(table_name)})", "SCHEMA")
  grouped_fk = fk_info.group_by { |row| row["id"] }.values.each { |group| group.sort_by! { |row| row["seq"] } }
  grouped_fk.map do |group|
    row = group.first
    options = {
      on_delete: extract_foreign_key_action(row["on_delete"]),
      on_update: extract_foreign_key_action(row["on_update"])
    }

    if group.one?
      options[:column] = row["from"]
      options[:primary_key] = row["to"]
    else
      options[:column] = group.map { |row| row["from"] }
      options[:primary_key] = group.map { |row| row["to"] }
    end
    ForeignKeyDefinition.new(table_name, row["table"], options)
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-rename_table"> <span class="method-name">rename_table</span><span class="method-args">(table_name, new_name, **options)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="rename_table-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 284
def rename_table(table_name, new_name, **options)
  validate_table_length!(new_name) unless options[:_uses_legacy_table_name]
  schema_cache.clear_data_source_cache!(table_name.to_s)
  schema_cache.clear_data_source_cache!(new_name.to_s)
  exec_query "ALTER TABLE #{quote_table_name(table_name)} RENAME TO #{quote_table_name(new_name)}"
  rename_table_indexes(table_name, new_name)
end</pre> </div> <p>Renames a table.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">rename_table('octopuses', 'octopi')
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-requires_reloading-3F"> <span class="method-name">requires_reloading?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="requires_reloading-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 156
def requires_reloading?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_check_constraints-3F"> <span class="method-name">supports_check_constraints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_check_constraints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 164
def supports_check_constraints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_common_table_expressions-3F"> <span class="method-name">supports_common_table_expressions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_common_table_expressions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 180
def supports_common_table_expressions?
  database_version &gt;= "3.8.3"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_concurrent_connections-3F"> <span class="method-name">supports_concurrent_connections?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_concurrent_connections-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 195
def supports_concurrent_connections?
  !@memory_database
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_datetime_with_precision-3F"> <span class="method-name">supports_datetime_with_precision?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_datetime_with_precision-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 172
def supports_datetime_with_precision?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_ddl_transactions-3F"> <span class="method-name">supports_ddl_transactions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_ddl_transactions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 136
def supports_ddl_transactions?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_explain-3F"> <span class="method-name">supports_explain?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_explain-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 231
def supports_explain?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_expression_index-3F"> <span class="method-name">supports_expression_index?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_expression_index-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 152
def supports_expression_index?
  database_version &gt;= "3.9.0"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_foreign_keys-3F"> <span class="method-name">supports_foreign_keys?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_foreign_keys-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 160
def supports_foreign_keys?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_index_sort_order-3F"> <span class="method-name">supports_index_sort_order?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_index_sort_order-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 218
def supports_index_sort_order?
  true
end</pre> </div>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_conflict_target-3F"> <span class="method-name">supports_insert_conflict_target?</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="sqlite3adapter.html#method-i-supports_insert_on_conflict-3F">supports_insert_on_conflict?</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_on_conflict-3F"> <span class="method-name">supports_insert_on_conflict?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_insert_on_conflict-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 188
def supports_insert_on_conflict?
  database_version &gt;= "3.24.0"
end</pre> </div>  </div> <div class="aliases"> Also aliased as: <a href="sqlite3adapter.html#method-i-supports_insert_on_duplicate_skip-3F">supports_insert_on_duplicate_skip?</a>, <a href="sqlite3adapter.html#method-i-supports_insert_on_duplicate_update-3F">supports_insert_on_duplicate_update?</a>, <a href="sqlite3adapter.html#method-i-supports_insert_conflict_target-3F">supports_insert_conflict_target?</a> </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_on_duplicate_skip-3F"> <span class="method-name">supports_insert_on_duplicate_skip?</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="sqlite3adapter.html#method-i-supports_insert_on_conflict-3F">supports_insert_on_conflict?</a> </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_on_duplicate_update-3F"> <span class="method-name">supports_insert_on_duplicate_update?</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="sqlite3adapter.html#method-i-supports_insert_on_conflict-3F">supports_insert_on_conflict?</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_returning-3F"> <span class="method-name">supports_insert_returning?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_insert_returning-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 184
def supports_insert_returning?
  database_version &gt;= "3.35.0"
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_json-3F"> <span class="method-name">supports_json?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_json-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 176
def supports_json?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_lazy_transactions-3F"> <span class="method-name">supports_lazy_transactions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_lazy_transactions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 235
def supports_lazy_transactions?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_partial_index-3F"> <span class="method-name">supports_partial_index?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_partial_index-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 148
def supports_partial_index?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_savepoints-3F"> <span class="method-name">supports_savepoints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_savepoints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 140
def supports_savepoints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_transaction_isolation-3F"> <span class="method-name">supports_transaction_isolation?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_transaction_isolation-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 144
def supports_transaction_isolation?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_views-3F"> <span class="method-name">supports_views?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_views-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 168
def supports_views?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-use_insert_returning-3F"> <span class="method-name">use_insert_returning?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="use_insert_returning-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/sqlite3_adapter.rb, line 413
def use_insert_returning?
  @use_insert_returning
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2004&ndash;2021 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>
