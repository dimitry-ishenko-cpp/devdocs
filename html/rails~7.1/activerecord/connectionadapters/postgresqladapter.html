<h1 id="class-ActiveRecord::ConnectionAdapters::PostgreSQLAdapter" class="class"> class ActiveRecord::ConnectionAdapters::PostgreSQLAdapter </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="abstractadapter.html">ActiveRecord::ConnectionAdapters::AbstractAdapter</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes">
<a class="include" href="postgresql/quoting.html">ActiveRecord::ConnectionAdapters::PostgreSQL::Quoting</a>, <a class="include" href="postgresql/schemastatements.html">ActiveRecord::ConnectionAdapters::PostgreSQL::SchemaStatements</a>, <span class="include">ActiveRecord::ConnectionAdapters::PostgreSQL::DatabaseStatements</span>
</dd>
</dl> <section class="description"> <h1 id="class-ActiveRecord::ConnectionAdapters::PostgreSQLAdapter-label-Active+Record+PostgreSQL+Adapter">Active Record PostgreSQL Adapter</h1> <p>The PostgreSQL adapter works with the native C (<a href="https://github.com/ged/ruby-pg">github.com/ged/ruby-pg</a>) driver.</p> <p>Options:</p> <ul>
<li> <p><code>:host</code> - Defaults to a Unix-domain socket in /tmp. On machines without Unix-domain sockets, the default is to connect to localhost.</p> </li>
<li> <p><code>:port</code> - Defaults to 5432.</p> </li>
<li> <p><code>:username</code> - Defaults to be the same as the operating system name of the user running the application.</p> </li>
<li> <p><code>:password</code> - Password to be used if the server demands password authentication.</p> </li>
<li> <p><code>:database</code> - Defaults to be the same as the username.</p> </li>
<li> <p><code>:schema_search_path</code> - An optional schema search path for the connection given as a string of comma-separated schema names. This is backward-compatible with the <code>:schema_order</code> option.</p> </li>
<li> <p><code>:encoding</code> - An optional client encoding that is used in a <code>SET client_encoding TO &lt;encoding&gt;</code> call on the connection.</p> </li>
<li> <p><code>:min_messages</code> - An optional client min messages that is used in a <code>SET client_min_messages TO &lt;min_messages&gt;</code> call on the connection.</p> </li>
<li> <p><code>:variables</code> - An optional hash of additional parameters that will be used in <code>SET SESSION key = val</code> calls on the connection.</p> </li>
<li> <p><code>:insert_returning</code> - An optional boolean to control the use of <code>RETURNING</code> for <code>INSERT</code> statements defaults to true.</p> </li>
</ul> <p>Any further options are used as connection parameters to libpq. See <a href="https://www.postgresql.org/docs/current/static/libpq-connect.html">www.postgresql.org/docs/current/static/libpq-connect.html</a> for the list of parameters.</p> <p>In addition, default connection parameters of libpq can be set per environment variables. See <a href="https://www.postgresql.org/docs/current/static/libpq-envars.html">www.postgresql.org/docs/current/static/libpq-envars.html</a> .</p> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="ADAPTER_NAME">ADAPTER_NAME </dt>

<dt id="DEADLOCK_DETECTED">DEADLOCK_DETECTED </dt>

<dt id="DUPLICATE_DATABASE">DUPLICATE_DATABASE </dt>

<dt id="FOREIGN_KEY_VIOLATION">FOREIGN_KEY_VIOLATION </dt>

<dt id="LOCK_NOT_AVAILABLE">LOCK_NOT_AVAILABLE </dt>

<dt id="NATIVE_DATABASE_TYPES">NATIVE_DATABASE_TYPES </dt>

<dt id="NOT_NULL_VIOLATION">NOT_NULL_VIOLATION </dt>

<dt id="NUMERIC_VALUE_OUT_OF_RANGE">NUMERIC_VALUE_OUT_OF_RANGE </dt>

<dt id="QUERY_CANCELED">QUERY_CANCELED </dt>

<dt id="SERIALIZATION_FAILURE">SERIALIZATION_FAILURE </dt>

<dt id="UNIQUE_VIOLATION">UNIQUE_VIOLATION </dt>

<dt id="VALUE_LIMIT_VIOLATION">VALUE_LIMIT_VIOLATION </dt>
<dd>
<p>See <a href="https://www.postgresql.org/docs/current/static/errcodes-appendix.html">www.postgresql.org/docs/current/static/errcodes-appendix.html</a></p> </dd>
</dl> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-create_unlogged_tables"> <span class="method-name">create_unlogged_tables</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="create_unlogged_tables-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 116
class_attribute :create_unlogged_tables, default: false
</pre> </div> <p>PostgreSQL allows the creation of “unlogged” tables, which do not record data in the PostgreSQL Write-Ahead Log. This can make the tables faster, but significantly increases the risk of data loss if the database crashes. As a result, this should not be used in production environments. If you would like all created tables to be unlogged in the test environment you can add the following to your test.rb file:</p> <pre class="ruby" data-language="ruby">ActiveSupport.on_load(:active_record_postgresqladapter) do
  self.create_unlogged_tables = true
end
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-datetime_type"> <span class="method-name">datetime_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="datetime_type-source"> <pre class="c" data-language="c"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 134
class_attribute :datetime_type, default: :timestamp
</pre> </div> <p>PostgreSQL supports multiple types for DateTimes. By default, if you use <code>datetime</code> in migrations, Rails will translate this to a PostgreSQL “timestamp without time zone”. Change this in an initializer to use another <a href="postgresqladapter.html#NATIVE_DATABASE_TYPES"><code>NATIVE_DATABASE_TYPES</code></a>. For example, to store DateTimes as “timestamp with time zone”:</p> <pre class="ruby" data-language="ruby">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter.datetime_type = :timestamptz
</pre> <p>Or if you are adding a custom type:</p> <pre class="ruby" data-language="ruby">ActiveRecord::ConnectionAdapters::PostgreSQLAdapter::NATIVE_DATABASE_TYPES[:my_custom_type] = { name: "my_custom_type_name" }
ActiveRecord::ConnectionAdapters::PostgreSQLAdapter.datetime_type = :my_custom_type
</pre> <p>If you’re using <code>:ruby</code> as your <code>config.active_record.schema_format</code> and you change this setting, you should immediately run <code>bin/rails db:migrate</code> to update the types in your schema.rb.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-dbconsole"> <span class="method-name">dbconsole</span><span class="method-args">(config, options = {})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="dbconsole-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 84
def dbconsole(config, options = {})
  pg_config = config.configuration_hash

  ENV["PGUSER"]         = pg_config[:username] if pg_config[:username]
  ENV["PGHOST"]         = pg_config[:host] if pg_config[:host]
  ENV["PGPORT"]         = pg_config[:port].to_s if pg_config[:port]
  ENV["PGPASSWORD"]     = pg_config[:password].to_s if pg_config[:password] &amp;&amp; options[:include_password]
  ENV["PGSSLMODE"]      = pg_config[:sslmode].to_s if pg_config[:sslmode]
  ENV["PGSSLCERT"]      = pg_config[:sslcert].to_s if pg_config[:sslcert]
  ENV["PGSSLKEY"]       = pg_config[:sslkey].to_s if pg_config[:sslkey]
  ENV["PGSSLROOTCERT"]  = pg_config[:sslrootcert].to_s if pg_config[:sslrootcert]
  if pg_config[:variables]
    ENV["PGOPTIONS"] = pg_config[:variables].filter_map do |name, value|
      "-c #{name}=#{value.to_s.gsub(/[ \\]/, '\\\\\0')}" unless value == ":default" || value == :default
    end.join(" ")
  end
  find_cmd_and_exec("psql", config.database)
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-new"> <span class="method-name">new</span><span class="method-args">(...)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 322
def initialize(...)
  super

  conn_params = @config.compact

  # Map ActiveRecords param names to PGs.
  conn_params[:user] = conn_params.delete(:username) if conn_params[:username]
  conn_params[:dbname] = conn_params.delete(:database) if conn_params[:database]

  # Forward only valid config params to PG::Connection.connect.
  valid_conn_param_keys = PG::Connection.conndefaults_hash.keys + [:requiressl]
  conn_params.slice!(*valid_conn_param_keys)

  @connection_parameters = conn_params

  @max_identifier_length = nil
  @type_map = nil
  @raw_connection = nil
  @notice_receiver_sql_warnings = []

  @use_insert_returning = @config.key?(:insert_returning) ? self.class.type_cast_config_to_boolean(@config[:insert_returning]) : true
end</pre> </div> <p>Initializes and connects a PostgreSQL adapter.</p> <div class="method-calls-super"> Calls superclass method <a href="querycache.html#method-c-new"><code>ActiveRecord::ConnectionAdapters::QueryCache::new</code></a> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-new_client"> <span class="method-name">new_client</span><span class="method-args">(conn_params)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="new_client-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 68
def new_client(conn_params)
  PG.connect(**conn_params)
rescue ::PG::Error =&gt; error
  if conn_params &amp;&amp; conn_params[:dbname] == "postgres"
    raise ActiveRecord::ConnectionNotEstablished, error.message
  elsif conn_params &amp;&amp; conn_params[:dbname] &amp;&amp; error.message.include?(conn_params[:dbname])
    raise ActiveRecord::NoDatabaseError.db_error(conn_params[:dbname])
  elsif conn_params &amp;&amp; conn_params[:user] &amp;&amp; error.message.include?(conn_params[:user])
    raise ActiveRecord::DatabaseConnectionError.username_error(conn_params[:user])
  elsif conn_params &amp;&amp; conn_params[:host] &amp;&amp; error.message.include?(conn_params[:host])
    raise ActiveRecord::DatabaseConnectionError.hostname_error(conn_params[:host])
  else
    raise ActiveRecord::ConnectionNotEstablished, error.message
  end
end</pre> </div>  </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-active-3F"> <span class="method-name">active?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="active-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 346
def active?
  @lock.synchronize do
    return false unless @raw_connection
    @raw_connection.query ";"
  end
  true
rescue PG::Error
  false
end</pre> </div> <p>Is this connection alive and ready for queries?</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-add_enum_value"> <span class="method-name">add_enum_value</span><span class="method-args">(type_name, value, options = {})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="add_enum_value-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 570
def add_enum_value(type_name, value, options = {})
  before, after = options.values_at(:before, :after)
  sql = +"ALTER TYPE #{quote_table_name(type_name)} ADD VALUE '#{value}'"

  if before &amp;&amp; after
    raise ArgumentError, "Cannot have both :before and :after at the same time"
  elsif before
    sql &lt;&lt; " BEFORE '#{before}'"
  elsif after
    sql &lt;&lt; " AFTER '#{after}'"
  end

  execute(sql).tap { reload_type_map }
end</pre> </div> <p>Add enum value to an existing enum type.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-create_enum"> <span class="method-name">create_enum</span><span class="method-args">(name, values, **options)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="create_enum-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 525
      def create_enum(name, values, **options)
        sql_values = values.map { |s| quote(s) }.join(", ")
        scope = quoted_scope(name)
        query = &lt;&lt;~SQL
          DO $$
          BEGIN
              IF NOT EXISTS (
                SELECT 1
                FROM pg_type t
                JOIN pg_namespace n ON t.typnamespace = n.oid
                WHERE t.typname = #{scope[:name]}
                  AND n.nspname = #{scope[:schema]}
              ) THEN
                  CREATE TYPE #{quote_table_name(name)} AS ENUM (#{sql_values});
              END IF;
          END
          $$;
        SQL
        internal_exec_query(query).tap { reload_type_map }
      end</pre> </div> <p>Given a name and an array of values, creates an enum type.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-disable_extension"> <span class="method-name">disable_extension</span><span class="method-args">(name, force: false)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="disable_extension-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 483
def disable_extension(name, force: false)
  internal_exec_query("DROP EXTENSION IF EXISTS \"#{name}\"#{' CASCADE' if force == :cascade}").tap {
    reload_type_map
  }
end</pre> </div> <p>Removes an extension from the database.</p> <dl class="rdoc-list label-list">
<dt>
<code>:force</code> </dt>
<dd> <p>Set to <code>:cascade</code> to drop dependent objects as well. Defaults to false.</p> </dd>
</dl>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-disconnect-21"> <span class="method-name">disconnect!</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="disconnect-21-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 383
def disconnect!
  @lock.synchronize do
    super
    @raw_connection&amp;.close rescue nil
    @raw_connection = nil
  end
end</pre> </div> <p>Disconnects from the database if already connected. Otherwise, this method does nothing.</p> <div class="method-calls-super"> Calls superclass method <a href="abstractadapter.html#method-i-disconnect-21"><code>ActiveRecord::ConnectionAdapters::AbstractAdapter#disconnect!</code></a> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-drop_enum"> <span class="method-name">drop_enum</span><span class="method-args">(name, values = nil, **options)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="drop_enum-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 555
      def drop_enum(name, values = nil, **options)
        query = &lt;&lt;~SQL
          DROP TYPE#{' IF EXISTS' if options[:if_exists]} #{quote_table_name(name)};
        SQL
        internal_exec_query(query).tap { reload_type_map }
      end</pre> </div> <p>Drops an enum type.</p> <p>If the <code>if_exists: true</code> option is provided, the enum is dropped only if it exists. Otherwise, if the enum doesn’t exist, an error is raised.</p> <p>The <code>values</code> parameter will be ignored if present. It can be helpful to provide this in a migration’s <code>change</code> method so it can be reverted. In that case, <code>values</code> will be used by <a href="postgresqladapter.html#method-i-create_enum"><code>create_enum</code></a>.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-enable_extension"> <span class="method-name">enable_extension</span><span class="method-args">(name, **)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="enable_extension-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 470
def enable_extension(name, **)
  schema, name = name.to_s.split(".").values_at(-2, -1)
  sql = +"CREATE EXTENSION IF NOT EXISTS \"#{name}\""
  sql &lt;&lt; " SCHEMA #{schema}" if schema

  internal_exec_query(sql).tap { reload_type_map }
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-enum_types"> <span class="method-name">enum_types</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="enum_types-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 502
      def enum_types
        query = &lt;&lt;~SQL
          SELECT
            type.typname AS name,
            type.OID AS oid,
            n.nspname AS schema,
            string_agg(enum.enumlabel, ',' ORDER BY enum.enumsortorder) AS value
          FROM pg_enum AS enum
          JOIN pg_type AS type ON (type.oid = enum.enumtypid)
          JOIN pg_namespace n ON type.typnamespace = n.oid
          WHERE n.nspname = ANY (current_schemas(false))
          GROUP BY type.OID, n.nspname, type.typname;
        SQL

        internal_exec_query(query, "SCHEMA", allow_retry: true, materialize_transactions: false).cast_values.each_with_object({}) do |row, memo|
          name, schema = row[0], row[2]
          schema = nil if schema == current_schema
          full_name = [schema, name].compact.join(".")
          memo[full_name] = row.last
        end.to_a
      end</pre> </div> <p>Returns a list of defined enum types, and their values.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-extension_available-3F"> <span class="method-name">extension_available?</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="extension_available-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 489
def extension_available?(name)
  query_value("SELECT true FROM pg_available_extensions WHERE name = #{quote(name)}", "SCHEMA")
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-extension_enabled-3F"> <span class="method-name">extension_enabled?</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="extension_enabled-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 493
def extension_enabled?(name)
  query_value("SELECT installed_version IS NOT NULL FROM pg_available_extensions WHERE name = #{quote(name)}", "SCHEMA")
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-extensions"> <span class="method-name">extensions</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="extensions-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 497
def extensions
  internal_exec_query("SELECT extname FROM pg_extension", "SCHEMA", allow_retry: true, materialize_transactions: false).cast_values
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-index_algorithms"> <span class="method-name">index_algorithms</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="index_algorithms-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 289
def index_algorithms
  { concurrently: "CONCURRENTLY" }
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-max_identifier_length"> <span class="method-name">max_identifier_length</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="max_identifier_length-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 600
def max_identifier_length
  @max_identifier_length ||= query_value("SHOW max_identifier_length", "SCHEMA").to_i
end</pre> </div> <p>Returns the configured supported identifier length supported by PostgreSQL</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-rename_enum"> <span class="method-name">rename_enum</span><span class="method-args">(name, options = {})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="rename_enum-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 563
def rename_enum(name, options = {})
  to = options.fetch(:to) { raise ArgumentError, ":to is required" }

  exec_query("ALTER TYPE #{quote_table_name(name)} RENAME TO #{to}").tap { reload_type_map }
end</pre> </div> <p>Rename an existing enum type to something else.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-rename_enum_value"> <span class="method-name">rename_enum_value</span><span class="method-args">(type_name, options = {})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="rename_enum_value-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 586
def rename_enum_value(type_name, options = {})
  unless database_version &gt;= 10_00_00 # &gt;= 10.0
    raise ArgumentError, "Renaming enum values is only supported in PostgreSQL 10 or later"
  end

  from = options.fetch(:from) { raise ArgumentError, ":from is required" }
  to = options.fetch(:to) { raise ArgumentError, ":to is required" }

  execute("ALTER TYPE #{quote_table_name(type_name)} RENAME VALUE '#{from}' TO '#{to}'").tap {
    reload_type_map
  }
end</pre> </div> <p>Rename enum value on an existing enum type.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-reset-21"> <span class="method-name">reset!</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="reset-21-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 368
def reset!
  @lock.synchronize do
    return connect! unless @raw_connection

    unless @raw_connection.transaction_status == ::PG::PQTRANS_IDLE
      @raw_connection.query "ROLLBACK"
    end
    @raw_connection.query "DISCARD ALL"

    super
  end
end</pre> </div> <div class="method-calls-super"> Calls superclass method <a href="abstractadapter.html#method-i-reset-21"><code>ActiveRecord::ConnectionAdapters::AbstractAdapter#reset!</code></a> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-session_auth-3D"> <span class="method-name">session_auth=</span><span class="method-args">(user)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="session_auth-3D-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 605
def session_auth=(user)
  clear_cache!
  internal_execute("SET SESSION AUTHORIZATION #{user}", nil, materialize_transactions: true)
end</pre> </div> <p>Set the authorized user for this session</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-set_standard_conforming_strings"> <span class="method-name">set_standard_conforming_strings</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="set_standard_conforming_strings-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 409
def set_standard_conforming_strings
  internal_execute("SET standard_conforming_strings = on")
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_advisory_locks-3F"> <span class="method-name">supports_advisory_locks?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_advisory_locks-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 417
def supports_advisory_locks?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_bulk_alter-3F"> <span class="method-name">supports_bulk_alter?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_bulk_alter-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 190
def supports_bulk_alter?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_check_constraints-3F"> <span class="method-name">supports_check_constraints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_check_constraints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 222
def supports_check_constraints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_comments-3F"> <span class="method-name">supports_comments?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_comments-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 254
def supports_comments?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_common_table_expressions-3F"> <span class="method-name">supports_common_table_expressions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_common_table_expressions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 448
def supports_common_table_expressions?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_datetime_with_precision-3F"> <span class="method-name">supports_datetime_with_precision?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_datetime_with_precision-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 246
def supports_datetime_with_precision?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_ddl_transactions-3F"> <span class="method-name">supports_ddl_transactions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_ddl_transactions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 413
def supports_ddl_transactions?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_deferrable_constraints-3F"> <span class="method-name">supports_deferrable_constraints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_deferrable_constraints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 238
def supports_deferrable_constraints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_exclusion_constraints-3F"> <span class="method-name">supports_exclusion_constraints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_exclusion_constraints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 226
def supports_exclusion_constraints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_explain-3F"> <span class="method-name">supports_explain?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_explain-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 421
def supports_explain?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_expression_index-3F"> <span class="method-name">supports_expression_index?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_expression_index-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 210
def supports_expression_index?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_extensions-3F"> <span class="method-name">supports_extensions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_extensions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 425
def supports_extensions?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_foreign_keys-3F"> <span class="method-name">supports_foreign_keys?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_foreign_keys-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 218
def supports_foreign_keys?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_foreign_tables-3F"> <span class="method-name">supports_foreign_tables?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_foreign_tables-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 433
def supports_foreign_tables?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_index_include-3F"> <span class="method-name">supports_index_include?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_index_include-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 206
def supports_index_include?
  database_version &gt;= 11_00_00 # &gt;= 11.0
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_index_sort_order-3F"> <span class="method-name">supports_index_sort_order?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_index_sort_order-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 194
def supports_index_sort_order?
  true
end</pre> </div>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_conflict_target-3F"> <span class="method-name">supports_insert_conflict_target?</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="postgresqladapter.html#method-i-supports_insert_on_conflict-3F">supports_insert_on_conflict?</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_on_conflict-3F"> <span class="method-name">supports_insert_on_conflict?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_insert_on_conflict-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 270
def supports_insert_on_conflict?
  database_version &gt;= 9_05_00 # &gt;= 9.5
end</pre> </div>  </div> <div class="aliases"> Also aliased as: <a href="postgresqladapter.html#method-i-supports_insert_on_duplicate_skip-3F">supports_insert_on_duplicate_skip?</a>, <a href="postgresqladapter.html#method-i-supports_insert_on_duplicate_update-3F">supports_insert_on_duplicate_update?</a>, <a href="postgresqladapter.html#method-i-supports_insert_conflict_target-3F">supports_insert_conflict_target?</a> </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_on_duplicate_skip-3F"> <span class="method-name">supports_insert_on_duplicate_skip?</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="postgresqladapter.html#method-i-supports_insert_on_conflict-3F">supports_insert_on_conflict?</a> </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_on_duplicate_update-3F"> <span class="method-name">supports_insert_on_duplicate_update?</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="postgresqladapter.html#method-i-supports_insert_on_conflict-3F">supports_insert_on_conflict?</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_insert_returning-3F"> <span class="method-name">supports_insert_returning?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_insert_returning-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 266
def supports_insert_returning?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_json-3F"> <span class="method-name">supports_json?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_json-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 250
def supports_json?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_lazy_transactions-3F"> <span class="method-name">supports_lazy_transactions?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_lazy_transactions-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 452
def supports_lazy_transactions?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_materialized_views-3F"> <span class="method-name">supports_materialized_views?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_materialized_views-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 429
def supports_materialized_views?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_nulls_not_distinct-3F"> <span class="method-name">supports_nulls_not_distinct?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_nulls_not_distinct-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 285
def supports_nulls_not_distinct?
  database_version &gt;= 15_00_00 # &gt;= 15.0
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_optimizer_hints-3F"> <span class="method-name">supports_optimizer_hints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_optimizer_hints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 441
def supports_optimizer_hints?
  unless defined?(@has_pg_hint_plan)
    @has_pg_hint_plan = extension_available?("pg_hint_plan")
  end
  @has_pg_hint_plan
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_partial_index-3F"> <span class="method-name">supports_partial_index?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_partial_index-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 202
def supports_partial_index?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_partitioned_indexes-3F"> <span class="method-name">supports_partitioned_indexes?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_partitioned_indexes-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 198
def supports_partitioned_indexes?
  database_version &gt;= 11_00_00 # &gt;= 11.0
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_pgcrypto_uuid-3F"> <span class="method-name">supports_pgcrypto_uuid?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_pgcrypto_uuid-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 437
def supports_pgcrypto_uuid?
  database_version &gt;= 9_04_00 # &gt;= 9.4
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_restart_db_transaction-3F"> <span class="method-name">supports_restart_db_transaction?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_restart_db_transaction-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 262
def supports_restart_db_transaction?
  database_version &gt;= 12_00_00 # &gt;= 12.0
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_savepoints-3F"> <span class="method-name">supports_savepoints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_savepoints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 258
def supports_savepoints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_transaction_isolation-3F"> <span class="method-name">supports_transaction_isolation?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_transaction_isolation-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 214
def supports_transaction_isolation?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_unique_constraints-3F"> <span class="method-name">supports_unique_constraints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_unique_constraints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 230
def supports_unique_constraints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_validate_constraints-3F"> <span class="method-name">supports_validate_constraints?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_validate_constraints-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 234
def supports_validate_constraints?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_views-3F"> <span class="method-name">supports_views?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_views-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 242
def supports_views?
  true
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-supports_virtual_columns-3F"> <span class="method-name">supports_virtual_columns?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="supports_virtual_columns-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 277
def supports_virtual_columns?
  database_version &gt;= 12_00_00 # &gt;= 12.0
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-use_insert_returning-3F"> <span class="method-name">use_insert_returning?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="use_insert_returning-3F-source"> <pre class="ruby" data-language="ruby"># File activerecord/lib/active_record/connection_adapters/postgresql_adapter.rb, line 610
def use_insert_returning?
  @use_insert_returning
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2004&ndash;2021 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>
