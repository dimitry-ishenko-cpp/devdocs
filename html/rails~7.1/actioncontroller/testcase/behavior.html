<h1 id="module-ActionController::TestCase::Behavior" class="module"> module ActionController::TestCase::Behavior </h1>
<dl class="meta">
<dt>Included modules:</dt>
<dd class="meta-includes">
<span class="include">ActionDispatch::TestProcess</span>, <a class="include" href="../../activesupport/testing/constantlookup.html">ActiveSupport::Testing::ConstantLookup</a>, <span class="include">ActionDispatch::Assertions</span>
</dd>
</dl>  <section id="5Buntitled-5D" class="documentation-section"> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-request"> <span class="method-name">request</span><span class="attribute-access-type">[R]</span> </div>  </div> <div class="method-detail"> <div class="method-heading attribute-method-heading" id="attribute-i-response"> <span class="method-name">response</span><span class="attribute-access-type">[R]</span> </div>  </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-build_response"> <span class="method-name">build_response</span><span class="method-args">(klass)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="build_response-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 564
def build_response(klass)
  klass.create
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-controller_class_name"> <span class="method-name">controller_class_name</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="controller_class_name-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 524
def controller_class_name
  @controller.class.anonymous? ? "anonymous" : @controller.class.controller_path
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-delete"> <span class="method-name">delete</span><span class="method-args">(action, **args)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="delete-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 439
def delete(action, **args)
  process(action, method: "DELETE", **args)
end</pre> </div> <p>Simulate a DELETE request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-generated_path"> <span class="method-name">generated_path</span><span class="method-args">(generated_extras)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="generated_path-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 528
def generated_path(generated_extras)
  generated_extras[0]
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-get"> <span class="method-name">get</span><span class="method-args">(action, **args)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="get-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 413
def get(action, **args)
  res = process(action, method: "GET", **args)
  cookies.update res.cookies
  res
end</pre> </div> <p>Simulate a GET request with the given parameters.</p> <ul>
<li> <p><code>action</code>: The controller action to call.</p> </li>
<li> <p><code>params</code>: The hash with HTTP parameters that you want to pass. This may be <code>nil</code>.</p> </li>
<li> <p><code>body</code>: The request body with a string that is appropriately encoded (<code>application/x-www-form-urlencoded</code> or <code>multipart/form-data</code>).</p> </li>
<li> <p><code>session</code>: A hash of parameters to store in the session. This may be <code>nil</code>.</p> </li>
<li> <p><code>flash</code>: A hash of parameters to store in the flash. This may be <code>nil</code>.</p> </li>
</ul> <p>You can also simulate POST, PATCH, PUT, DELETE, and HEAD requests with <code>post</code>, <code>patch</code>, <code>put</code>, <code>delete</code>, and <code>head</code>. Example sending parameters, session, and setting a flash message:</p> <pre class="ruby" data-language="ruby">get :show,
  params: { id: 7 },
  session: { user_id: 1 },
  flash: { notice: 'This is flash message' }
</pre> <p>Note that the request method is not verified. The different methods are available to make the tests more expressive.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-head"> <span class="method-name">head</span><span class="method-args">(action, **args)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="head-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 445
def head(action, **args)
  process(action, method: "HEAD", **args)
end</pre> </div> <p>Simulate a HEAD request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-patch"> <span class="method-name">patch</span><span class="method-args">(action, **args)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="patch-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 427
def patch(action, **args)
  process(action, method: "PATCH", **args)
end</pre> </div> <p>Simulate a PATCH request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-post"> <span class="method-name">post</span><span class="method-args">(action, **args)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="post-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 421
def post(action, **args)
  process(action, method: "POST", **args)
end</pre> </div> <p>Simulate a POST request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-process"> <span class="method-name">process</span><span class="method-args">(action, method: "GET", params: nil, session: nil, body: nil, flash: {}, format: nil, xhr: false, as: nil)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="process-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 484
def process(action, method: "GET", params: nil, session: nil, body: nil, flash: {}, format: nil, xhr: false, as: nil)
  check_required_ivars
  @controller.clear_instance_variables_between_requests

  action = +action.to_s
  http_method = method.to_s.upcase

  @html_document = nil

  cookies.update(@request.cookies)
  cookies.update_cookies_from_jar
  @request.set_header "HTTP_COOKIE", cookies.to_header
  @request.delete_header "action_dispatch.cookies"

  @request          = TestRequest.new scrub_env!(@request.env), @request.session, @controller.class
  @response         = build_response @response_klass
  @response.request = @request
  @controller.recycle!

  if body
    @request.set_header "RAW_POST_DATA", body
  end

  @request.set_header "REQUEST_METHOD", http_method

  if as
    @request.content_type = Mime[as].to_s
    format ||= as
  end

  parameters = (params || {}).symbolize_keys

  if format
    parameters[:format] = format
  end

  setup_request(controller_class_name, action, parameters, session, flash, xhr)
  process_controller_response(action, cookies, xhr)
end</pre> </div> <p>Simulate an HTTP request to <code>action</code> by specifying request method, parameters and set/volley the response.</p> <ul>
<li> <p><code>action</code>: The controller action to call.</p> </li>
<li> <p><code>method</code>: Request method used to send the HTTP request. Possible values are <code>GET</code>, <code>POST</code>, <code>PATCH</code>, <code>PUT</code>, <code>DELETE</code>, <code>HEAD</code>. Defaults to <code>GET</code>. Can be a symbol.</p> </li>
<li> <p><code>params</code>: The hash with HTTP parameters that you want to pass. This may be <code>nil</code>.</p> </li>
<li> <p><code>body</code>: The request body with a string that is appropriately encoded (<code>application/x-www-form-urlencoded</code> or <code>multipart/form-data</code>).</p> </li>
<li> <p><code>session</code>: A hash of parameters to store in the session. This may be <code>nil</code>.</p> </li>
<li> <p><code>flash</code>: A hash of parameters to store in the flash. This may be <code>nil</code>.</p> </li>
<li> <p><code>format</code>: Request format. Defaults to <code>nil</code>. Can be string or symbol.</p> </li>
<li> <p><code>as</code>: Content type. Defaults to <code>nil</code>. Must be a symbol that corresponds to a mime type.</p> </li>
</ul> <p>Example calling <code>create</code> action and sending two params:</p> <pre class="ruby" data-language="ruby">process :create,
  method: 'POST',
  params: {
    user: { name: 'Gaurish Sharma', email: 'user@example.com' }
  },
  session: { user_id: 1 },
  flash: { notice: 'This is flash message' }
</pre> <p>To simulate <code>GET</code>, <code>POST</code>, <code>PATCH</code>, <code>PUT</code>, <code>DELETE</code>, and <code>HEAD</code> requests prefer using <a href="behavior.html#method-i-get"><code>get</code></a>, <a href="behavior.html#method-i-post"><code>post</code></a>, <a href="behavior.html#method-i-patch"><code>patch</code></a>, <a href="behavior.html#method-i-put"><code>put</code></a>, <a href="behavior.html#method-i-delete"><code>delete</code></a> and <a href="behavior.html#method-i-head"><code>head</code></a> methods respectively which will make tests more expressive.</p> <p>It’s not recommended to make more than one request in the same test. Instance variables that are set in one request will not persist to the next request, but it’s not guaranteed that all Rails internal state will be reset. Prefer <a href="../../actiondispatch/integrationtest.html"><code>ActionDispatch::IntegrationTest</code></a> for making multiple requests in the same test.</p> <p>Note that the request method is not verified.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-put"> <span class="method-name">put</span><span class="method-args">(action, **args)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="put-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 433
def put(action, **args)
  process(action, method: "PUT", **args)
end</pre> </div> <p>Simulate a PUT request with the given parameters and set/volley the response. See <code>get</code> for more details.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-query_parameter_names"> <span class="method-name">query_parameter_names</span><span class="method-args">(generated_extras)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="query_parameter_names-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 532
def query_parameter_names(generated_extras)
  generated_extras[1] + [:controller, :action]
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-setup_controller_request_and_response"> <span class="method-name">setup_controller_request_and_response</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="setup_controller_request_and_response-source"> <pre class="ruby" data-language="ruby"># File actionpack/lib/action_controller/test_case.rb, line 536
def setup_controller_request_and_response
  @controller = nil unless defined? @controller

  @response_klass = ActionDispatch::TestResponse

  if klass = self.class.controller_class
    if klass &lt; ActionController::Live
      @response_klass = LiveTestResponse
    end
    unless @controller
      begin
        @controller = klass.new
      rescue
        warn "could not construct controller #{klass}" if $VERBOSE
      end
    end
  end

  @request          = TestRequest.create(@controller.class)
  @response         = build_response @response_klass
  @response.request = @request

  if @controller
    @controller.request = @request
    @controller.params = {}
  end
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2004&ndash;2021 David Heinemeier Hansson<br>Licensed under the MIT License.<br>
    
  </p>
</div>
