  <div id="layout"> <div id="layout-content"><div id="function.hash-equals" class="refentry"> <div class="refnamediv"> <h1 class="refname">hash_equals</h1> <p class="verinfo">(PHP 5 &gt;= 5.6.0, PHP 7, PHP 8)</p>
<p class="refpurpose"><span class="refname">hash_equals</span> â€” <span class="dc-title">Timing attack safe string comparison</span></p> </div> <div class="refsect1 description" id="refsect1-function.hash-equals-description"> <h3 class="title">Description</h3> <pre class="methodsynopsis dc-description" data-language="php">hash_equals(string $known_string, string $user_string): bool</pre> <p class="para rdfs-comment"> Checks whether two strings are equal without leaking information about the contents of <code class="parameter">known_string</code> via the execution time. </p> <p class="para"> This function can be used to mitigate timing attacks. Performing a regular comparison with <code class="code">===</code> will take more or less time to execute depending on whether the two values are different or not and at which position the first difference can be found, thus leaking information about the contents of the secret <code class="parameter">known_string</code>. </p> <div class="caution">
<strong class="caution">Caution</strong> <p class="para"> It is important to provide the user-supplied string as the second parameter, rather than the first. </p> </div> </div> <div class="refsect1 parameters" id="refsect1-function.hash-equals-parameters"> <h3 class="title">Parameters</h3> <dl> <dt> <code class="parameter">known_string</code>
</dt> <dd> <p class="para"> The known <span class="type">string</span> that must be kept secret. </p> </dd> <dt> <code class="parameter">user_string</code>
</dt> <dd> <p class="para"> The user-supplied <span class="type">string</span> to compare against. </p> </dd> </dl> </div> <div class="refsect1 returnvalues" id="refsect1-function.hash-equals-returnvalues"> <h3 class="title">Return Values</h3> <p class="para"> Returns <strong><code>true</code></strong> when the two strings are equal, <strong><code>false</code></strong> otherwise. </p> </div> <div class="refsect1 examples" id="refsect1-function.hash-equals-examples"> <h3 class="title">Examples</h3> 
<div class="example" id="example-2702"> <p><strong>Example #1 <span class="function"><strong>hash_equals()</strong></span> example</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
$secretKey = '8uRhAeH89naXfFXKGOEj';

// Value and signature are provided by the user, e.g. within the URL
// and retrieved using $_GET.
$value = 'username=rasmuslerdorf';
$signature = '8c35009d3b50caf7f5d2c1e031842e6b7823a1bb781d33c5237cd27b57b5f327';

if (hash_equals(hash_hmac('sha256', $value, $secretKey), $signature)) {
    echo "The value is correctly signed.", PHP_EOL;
} else {
    echo "The value was tampered with.", PHP_EOL;
}
?&gt;</pre> </div> <div class="example-contents"><p>The above example will output:</p></div> <div class="example-contents screen"> <div class="cdata"><pre>
The value is correctly signed.
</pre></div> </div> </div> </div> <div class="refsect1 notes" id="refsect1-function.hash-equals-notes"> <h3 class="title">Notes</h3> <blockquote class="note">
<p><strong class="note">Note</strong>: </p>
<p class="para"> Both arguments must be of the same length to be compared successfully. When arguments of differing length are supplied, <strong><code>false</code></strong> is returned immediately and the length of the known string may be leaked in case of a timing attack. </p> </blockquote> </div> <div class="refsect1 seealso" id="refsect1-function.hash-equals-seealso"> <h3 class="title">See Also</h3> 
<ul class="simplelist"> <li class="member"><span class="function"><a href="function.hash-hmac.html" class="function" rel="rdfs-seeAlso">hash_hmac()</a> - Generate a keyed hash value using the HMAC method</span></li> </ul> </div> </div></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1997&ndash;2023 The PHP Documentation Group<br>Licensed under the Creative Commons Attribution License v3.0 or later.<br>
    <a href="https://www.php.net/manual/en/function.hash-equals.php" class="_attribution-link">https://www.php.net/manual/en/function.hash-equals.php</a>
  </p>
</div>
