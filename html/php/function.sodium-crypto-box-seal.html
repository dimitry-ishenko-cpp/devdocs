  <div id="layout"> <div id="layout-content"><div id="function.sodium-crypto-box-seal" class="refentry"> <div class="refnamediv"> <h1 class="refname">sodium_crypto_box_seal</h1> <p class="verinfo">(PHP 7 &gt;= 7.2.0, PHP 8)</p>
<p class="refpurpose"><span class="refname">sodium_crypto_box_seal</span> â€” <span class="dc-title">Anonymous public-key encryption</span></p> </div> <div class="refsect1 description" id="refsect1-function.sodium-crypto-box-seal-description"> <h3 class="title">Description</h3> <pre class="methodsynopsis dc-description" data-language="php">sodium_crypto_box_seal(#[\SensitiveParameter] string $message, string $public_key): string</pre> <p class="para rdfs-comment"> Encrypt a message such that only the recipient can decrypt it. </p> <p class="para"> Unlike with <span class="function"><a href="function.sodium-crypto-box.html" class="function">sodium_crypto_box()</a></span>, you only need to know the recipient's public key to use <span class="function"><strong>sodium_crypto_box_seal()</strong></span>. One consequence of this convenience, however, is that the ciphertext isn't bound to a static public key, and is therefore not authenticated. Hence, anonymous public-key encryption. </p> <p class="para"> <span class="function"><strong>sodium_crypto_box_seal()</strong></span> still provides ciphertext integrity. Just not sender identity authentication. </p> <p class="para"> If you also need sender authentication, the <span class="function"><a href="function.sodium-crypto-sign.html" class="function">sodium_crypto_sign()</a></span> functions are likely the best place to start. </p> </div> <div class="refsect1 parameters" id="refsect1-function.sodium-crypto-box-seal-parameters"> <h3 class="title">Parameters</h3> <dl> <dt><code class="parameter">message</code></dt> <dd> <p class="para"> The message to encrypt. </p> </dd> <dt><code class="parameter">public_key</code></dt> <dd> <p class="para"> The public key that corresponds to the only key that can decrypt the message. </p> </dd> </dl> </div> <div class="refsect1 returnvalues" id="refsect1-function.sodium-crypto-box-seal-returnvalues"> <h3 class="title">Return Values</h3> <p class="para"> A ciphertext string in the format of (one-time public key, encrypted message, authentication tag). </p> </div> <div class="refsect1 examples" id="refsect1-function.sodium-crypto-box-seal-examples"> <h3 class="title">Examples</h3> <div class="example" id="sodium-crypto-box-seal.example.basic"> <p><strong>Example #1 <span class="function"><strong>sodium_crypto_box_seal()</strong></span> example</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
$keypair = sodium_crypto_box_keypair();
$public_key = sodium_crypto_box_publickey($keypair);

// Obfuscated plaintext to make the example more fun
$plaintext_b64 = "V3JpdGluZyBzb2Z0d2FyZSBpbiBQSFAgY2FuIGJlIGEgZGVsaWdodCE=";
$decoded_plaintext = sodium_base642bin($plaintext_b64, SODIUM_BASE64_VARIANT_ORIGINAL);

$sealed = sodium_crypto_box_seal($decoded_plaintext, $public_key);
var_dump(base64_encode($sealed));

$opened = sodium_crypto_box_seal_open($sealed, $keypair);
var_dump($opened);
?&gt;</pre> </div> <div class="example-contents"><p>The above example will output something similar to:</p></div> <div class="example-contents screen"> <div class="examplescode">
<pre class="examplescode">string(120) "oRBXXAV4iQBrxlV4A21Bord8Yo/D8ZlrIIGNyaRCcGBfpz0map52I3xq6l+CST+1NSgQkbV+HiYyFjXWiWiaCGupGf+zl4bgWj/A9Adtem7Jt3h3emrMsLw="
string(41) "Writing software in PHP can be a delight!"</pre> </div> </div> </div> </div> </div></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1997&ndash;2024 The PHP Documentation Group<br>Licensed under the Creative Commons Attribution License v3.0 or later.<br>
    <a href="https://www.php.net/manual/en/function.sodium-crypto-box-seal.php" class="_attribution-link">https://www.php.net/manual/en/function.sodium-crypto-box-seal.php</a>
  </p>
</div>
