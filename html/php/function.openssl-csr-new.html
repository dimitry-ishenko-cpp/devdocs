  <div id="layout"> <div id="layout-content"><div id="function.openssl-csr-new" class="refentry"> <div class="refnamediv"> <h1 class="refname">openssl_csr_new</h1> <p class="verinfo">(PHP 4 &gt;= 4.2.0, PHP 5, PHP 7, PHP 8)</p>
<p class="refpurpose"><span class="refname">openssl_csr_new</span> â€” <span class="dc-title">Generates a <abbr title="Certificate Signing Request">CSR</abbr></span></p> </div> <div class="refsect1 description" id="refsect1-function.openssl-csr-new-description"> <h3 class="title">Description</h3> <pre class="methodsynopsis dc-description" data-language="php">openssl_csr_new(
 array $distinguished_names,
 #[\SensitiveParameter] ?OpenSSLAsymmetricKey &amp;$private_key,
 ?array $options = null,
 ?array $extra_attributes = null
): OpenSSLCertificateSigningRequest|bool</pre> <p class="para rdfs-comment"> <span class="function"><strong>openssl_csr_new()</strong></span> generates a new <abbr title="Certificate Signing Request">CSR</abbr> based on the information provided by <code class="parameter">distinguished_names</code>. </p> <blockquote class="note"><p><strong class="note">Note</strong>: <span class="simpara"> You need to have a valid <var class="filename">openssl.cnf</var> installed for this function to operate correctly. See the notes under <a href="https://www.php.net/manual/en/openssl.installation.php" class="link">the installation section</a> for more information. </span> </p></blockquote> </div> <div class="refsect1 parameters" id="refsect1-function.openssl-csr-new-parameters"> <h3 class="title">Parameters</h3> 
<dl> <dt><code class="parameter">distinguished_names</code></dt> <dd> <p class="para"> The Distinguished Name or subject fields to be used in the certificate. </p> </dd> <dt><code class="parameter">private_key</code></dt> <dd> <p class="para"> <code class="parameter">private_key</code> should be set to a private key that was previously generated by <span class="function"><a href="function.openssl-pkey-new.html" class="function">openssl_pkey_new()</a></span> (or otherwise obtained from the other openssl_pkey family of functions), or <strong><code><a href="https://www.php.net/manual/en/reserved.constants.php#constant.null">null</a></code></strong> variable. If its value is <strong><code><a href="https://www.php.net/manual/en/reserved.constants.php#constant.null">null</a></code></strong> variable, a new private key is generated based on the supplied <code class="parameter">options</code> and assigned to supplied variable. The corresponding public portion of the key will be used to sign the <abbr title="Certificate Signing Request">CSR</abbr>. </p> </dd> <dt><code class="parameter">options</code></dt> <dd> <p class="para"> By default, the information in your system <code class="literal">openssl.conf</code> is used to initialize the request; you can specify a configuration file section by setting the <code class="literal">config_section_section</code> key in <code class="parameter">options</code>. You can also specify an alternative OpenSSL configuration file by setting the value of the <code class="literal">config</code> key to the path of the file you want to use. The following keys, if present in <code class="parameter">options</code> behave as their equivalents in the <code class="literal">openssl.conf</code>, as listed in the table below. </p>
<table class="doctable table"> <caption><strong>Configuration overrides</strong></caption> <thead> <tr> <th>
<code class="parameter">options</code> key</th> <th>type</th> <th>
<code class="literal">openssl.conf</code> equivalent</th> <th>description</th> </tr> </thead> <tbody class="tbody"> <tr> <td>digest_alg</td> <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td> <td>default_md</td> <td>Digest method or signature hash, usually one of <span class="function"><a href="function.openssl-get-md-methods.html" class="function">openssl_get_md_methods()</a></span>
</td> </tr> <tr> <td>x509_extensions</td> <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td> <td>x509_extensions</td> <td>Selects which extensions should be used when creating an x509 certificate</td> </tr> <tr> <td>req_extensions</td> <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td> <td>req_extensions</td> <td>Selects which extensions should be used when creating a <abbr title="Certificate Signing Request">CSR</abbr>
</td> </tr> <tr> <td>private_key_bits</td> <td><span class="type"><a href="language.types.integer.html" class="type int">int</a></span></td> <td>default_bits</td> <td>Specifies how many bits should be used to generate a private key</td> </tr> <tr> <td>private_key_type</td> <td><span class="type"><a href="language.types.integer.html" class="type int">int</a></span></td> <td>none</td> <td>Specifies the type of private key to create. This can be one of <strong><code><a href="https://www.php.net/manual/en/openssl.key-types.php#constant.openssl-keytype-dsa">OPENSSL_KEYTYPE_DSA</a></code></strong>, <strong><code><a href="https://www.php.net/manual/en/openssl.key-types.php#constant.openssl-keytype-dh">OPENSSL_KEYTYPE_DH</a></code></strong>, <strong><code><a href="https://www.php.net/manual/en/openssl.key-types.php#constant.openssl-keytype-rsa">OPENSSL_KEYTYPE_RSA</a></code></strong> or <strong><code><a href="https://www.php.net/manual/en/openssl.key-types.php#constant.openssl-keytype-ec">OPENSSL_KEYTYPE_EC</a></code></strong>. The default value is <strong><code><a href="https://www.php.net/manual/en/openssl.key-types.php#constant.openssl-keytype-rsa">OPENSSL_KEYTYPE_RSA</a></code></strong>. </td> </tr> <tr> <td>encrypt_key</td> <td><span class="type"><a href="language.types.boolean.html" class="type bool">bool</a></span></td> <td>encrypt_key</td> <td>Should an exported key (with passphrase) be encrypted?</td> </tr> <tr> <td>encrypt_key_cipher</td> <td><span class="type"><a href="language.types.integer.html" class="type int">int</a></span></td> <td>none</td> <td> One of <a href="https://www.php.net/manual/en/openssl.ciphers.php" class="link">cipher constants</a>. </td> </tr> <tr> <td>curve_name</td> <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td> <td>none</td> <td> One of <span class="function"><a href="function.openssl-get-curve-names.html" class="function">openssl_get_curve_names()</a></span>. </td> </tr> <tr> <td>config</td> <td><span class="type"><a href="language.types.string.html" class="type string">string</a></span></td> <td>N/A</td> <td> Path to your own alternative openssl.conf file. </td> </tr> </tbody> </table> </dd> <dt><code class="parameter">extra_attributes</code></dt> <dd> <p class="para"> <code class="parameter">extra_attributes</code> is used to specify additional configuration options for the <abbr title="Certificate Signing Request">CSR</abbr>. Both <code class="parameter">distinguished_names</code> and <code class="parameter">extra_attributes</code> are associative arrays, whose keys are converted to OIDs and applied to the relevant part of the request. </p> </dd> </dl> </div> <div class="refsect1 returnvalues" id="refsect1-function.openssl-csr-new-returnvalues"> <h3 class="title">Return Values</h3> <p class="para"> Returns the <abbr title="Certificate Signing Request">CSR</abbr> on success, <strong><code><a href="https://www.php.net/manual/en/reserved.constants.php#constant.true">true</a></code></strong> if CSR creation is successful but signing fails or <strong><code><a href="https://www.php.net/manual/en/reserved.constants.php#constant.false">false</a></code></strong> on failure. </p> </div> <div class="refsect1 changelog" id="refsect1-function.openssl-csr-new-changelog"> <h3 class="title">Changelog</h3> <table class="doctable informaltable"> <thead> <tr> <th>Version</th> <th>Description</th> </tr> </thead> <tbody class="tbody"> <tr> <td>8.0.0</td> <td> On success, this function returns an <span class="classname"><a href="class.opensslcertificatesigningrequest.html" class="classname">OpenSSLCertificateSigningRequest</a></span> instance now; previously, a <a href="language.types.resource.html" class="link">resource</a> of type <code class="literal">OpenSSL X.509 CSR</code> was returned. </td> </tr> <tr> <td>8.0.0</td> <td> <code class="parameter">private_key</code> accepts an <span class="classname"><a href="class.opensslasymmetrickey.html" class="classname">OpenSSLAsymmetricKey</a></span> instance now; previously, a <a href="language.types.resource.html" class="link">resource</a> of type <code class="literal">OpenSSL key</code> was accepted. </td> </tr> <tr> <td>7.1.0</td> <td> <code class="parameter">options</code> now also supports <code class="literal">curve_name</code>. </td> </tr> </tbody> </table> </div> <div class="refsect1 examples" id="refsect1-function.openssl-csr-new-examples"> <h3 class="title">Examples</h3> 
<div class="example" id="example-952"> <p><strong>Example #1 Creating a self-signed certificate</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
// for SSL server certificates the commonName is the domain name to be secured
// for S/MIME email certificates the commonName is the owner of the email address
// location and identification fields refer to the owner of domain or email subject to be secured
$dn = array(
    "countryName" =&gt; "GB",
    "stateOrProvinceName" =&gt; "Somerset",
    "localityName" =&gt; "Glastonbury",
    "organizationName" =&gt; "The Brain Room Limited",
    "organizationalUnitName" =&gt; "PHP Documentation Team",
    "commonName" =&gt; "Wez Furlong",
    "emailAddress" =&gt; "wez@example.com"
);

// Generate a new private (and public) key pair
$privkey = openssl_pkey_new(array(
    "private_key_bits" =&gt; 2048,
    "private_key_type" =&gt; OPENSSL_KEYTYPE_RSA,
));

// Generate a certificate signing request
$csr = openssl_csr_new($dn, $privkey, array('digest_alg' =&gt; 'sha256'));

// Generate a self-signed cert, valid for 365 days
$x509 = openssl_csr_sign($csr, null, $privkey, $days=365, array('digest_alg' =&gt; 'sha256'));

// Save your private key, CSR and self-signed cert for later use
openssl_csr_export($csr, $csrout) and var_dump($csrout);
openssl_x509_export($x509, $certout) and var_dump($certout);
openssl_pkey_export($privkey, $pkeyout, "mypassword") and var_dump($pkeyout);

// Show any errors that occurred here
while (($e = openssl_error_string()) !== false) {
    echo $e . "\n";
}
?&gt;</pre> </div> </div> <div class="example" id="example-953"> <p><strong>Example #2 Creating a self-signed ECC certificate (as of PHP 7.1.0)</strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
$subject = array(
    "commonName" =&gt; "docs.php.net",
);

// Generate a new private (and public) key pair
$private_key = openssl_pkey_new(array(
    "private_key_type" =&gt; OPENSSL_KEYTYPE_EC,
    "curve_name" =&gt; 'prime256v1',
));

// Generate a certificate signing request
$csr = openssl_csr_new($subject, $private_key, array('digest_alg' =&gt; 'sha384'));

// Generate self-signed EC cert
$x509 = openssl_csr_sign($csr, null, $private_key, $days=365, array('digest_alg' =&gt; 'sha384'));
openssl_x509_export_to_file($x509, 'ecc-cert.pem');
openssl_pkey_export_to_file($private_key, 'ecc-private.key');
?&gt;</pre> </div> </div> </div> <div class="refsect1 seealso" id="refsect1-function.openssl-csr-new-seealso"> <h3 class="title">See Also</h3> 
<ul class="simplelist"> <li><span class="function"><a href="function.openssl-csr-sign.html" class="function" rel="rdfs-seeAlso">openssl_csr_sign()</a> - Sign a CSR with another certificate (or itself) and generate a certificate</span></li> </ul> </div> </div></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1997&ndash;2024 The PHP Documentation Group<br>Licensed under the Creative Commons Attribution License v3.0 or later.<br>
    <a href="https://www.php.net/manual/en/function.openssl-csr-new.php" class="_attribution-link">https://www.php.net/manual/en/function.openssl-csr-new.php</a>
  </p>
</div>
