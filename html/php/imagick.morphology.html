  <div id="layout"> <div id="layout-content"><div id="imagick.morphology" class="refentry"> <div class="refnamediv"> <h1 class="refname">Imagick::morphology</h1> <p class="verinfo">(PECL imagick 3 &gt;= 3.3.0)</p>
<p class="refpurpose"><span class="refname">Imagick::morphology</span> â€” <span class="dc-title">Applies a user supplied kernel to the image according to the given morphology method.</span></p> </div> <div class="refsect1 description" id="refsect1-imagick.morphology-description"> <h3 class="title">Description</h3> <pre class="methodsynopsis dc-description" data-language="php">public Imagick::morphology(
 int $morphologyMethod,
 int $iterations,
 ImagickKernel $ImagickKernel,
 int $channel = Imagick::CHANNEL_DEFAULT
): bool</pre> <p class="para rdfs-comment"> Applies a user supplied kernel to the image according to the given morphology method. </p> </div> <div class="refsect1 parameters" id="refsect1-imagick.morphology-parameters"> <h3 class="title">Parameters</h3> <dl> <dt> <code class="parameter">morphologyMethod</code>
</dt> <dd> <p class="para"> Which morphology method to use one of the \Imagick::MORPHOLOGY_* constants. </p> </dd> <dt> <code class="parameter">iterations</code>
</dt> <dd> <p class="para"> The number of iteration to apply the morphology function. A value of -1 means loop until no change found. How this is applied may depend on the morphology method. Typically this is a value of 1. </p> </dd> <dt> <code class="parameter">ImagickKernel</code>
</dt>  <dt> <code class="parameter">channel</code>
</dt>  </dl> </div> <div class="refsect1 returnvalues" id="refsect1-imagick.morphology-returnvalues"> <h3 class="title">Return Values</h3> <p class="para"> Returns <strong><code>true</code></strong> on success. </p> </div> <div class="refsect1 examples" id="refsect1-imagick.morphology-examples"> <h3 class="title">Examples</h3> 
<div class="example" id=""> <p><strong>Example #1 Convolve <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $imagick = $this-&gt;getCharacter();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_GAUSSIAN, "5,1");
        $imagick-&gt;morphology(\Imagick::MORPHOLOGY_CONVOLVE, 2, $kernel);
        header("Content-Type: image/png");
        echo $imagick-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #2 Correlate <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php

        // Top-left pixel must be black
        // Bottom right pixel must be white
        // We don't care about the rest.
        

        $imagick = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromMatrix(self::$correlateMatrix, [2, 2]);
        $imagick-&gt;morphology(\Imagick::MORPHOLOGY_CORRELATE, 1, $kernel);
        header("Content-Type: image/png");
        echo $imagick-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #3 Erode <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_ERODE, 2, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #4 Erode Intensity <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacter();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "1");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_ERODE_INTENSITY, 2, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #5 Dilate <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_DILATE, 4, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #6 Dilate intensity <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacter();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "1");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_DILATE_INTENSITY, 4, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #7 Distance with Chebyshev kernel <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_CHEBYSHEV, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_DISTANCE, 3, $kernel);
        $canvas-&gt;autoLevelImage();
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #8 Distance with Manhattan kernel <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_MANHATTAN, "5");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_DISTANCE, 3, $kernel);
        $canvas-&gt;autoLevelImage();
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #9 Distance with ocatagonal kernel <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGONAL, "5");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_DISTANCE, 3, $kernel);
        $canvas-&gt;autoLevelImage();
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #10 Distance with Euclidean kernel <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_EUCLIDEAN, "4");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_DISTANCE, 3, $kernel);
        $canvas-&gt;autoLevelImage();
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #11 Edge <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_EDGE, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #12 Open <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        // As a result you will see that 'Open' smoothed the outline, by rounding off any sharp points, and remove any parts that is smaller than the shape used. It will also disconnect or 'open' any thin bridges.
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "6");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_OPEN, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #13 Open intensity <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        // As a result you will see that 'Open' smoothed the outline, by rounding off any sharp points, and remove any parts that is smaller than the shape used. It will also disconnect or 'open' any thin bridges.

        $canvas = $this-&gt;getCharacter();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "6");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_OPEN_INTENSITY, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #14 Close <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        //The basic use of the 'Close' method is to reduce or remove any 'holes' or 'gaps' about the size of the kernel 'Structure Element'. That is 'close' parts of the background that are about that size.
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "6");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_CLOSE, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #15 Close Intensity <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        //The basic use of the 'Close' method is to reduce or remove any 'holes' or 'gaps' about the size of the kernel 'Structure Element'. That is 'close' parts of the background that are about that size.
        $canvas = $this-&gt;getCharacter();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "6");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_CLOSE_INTENSITY, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #16 Smooth <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_SMOOTH, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #17 Edge in <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_EDGE_IN, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #18 Edge out <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_OCTAGON, "3");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_EDGE_OUT, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #19 The 'TopHat' method, or more specifically 'White Top Hat', returns the pixels that were removed by a Opening of the shape, that is the pixels that were removed to round off the points, and the connecting bridged between shapes. <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "5");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_TOP_HAT, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #20 The 'BottomHat' method, also known as 'Black TopHat' is the pixels that a Closing of the shape adds to the image. That is the pixels that were used to fill in the 'holes', 'gaps', and 'bridges'. <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php

        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "5");
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_BOTTOM_HAT, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #21 Hit and Miss <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        //This finds all the pixels with 3 pixels of the right edge
        $matrix = [[1, false, false, 0]];
        $kernel = \ImagickKernel::fromMatrix(
            $matrix,
            [0, 0]
        );
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_HIT_AND_MISS, 1, $kernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #22 Thinning <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $leftEdgeKernel = \ImagickKernel::fromMatrix([[0, 1]], [1, 0]);
        $rightEdgeKernel = \ImagickKernel::fromMatrix([[1, 0]], [0, 0]);
        $leftEdgeKernel-&gt;addKernel($rightEdgeKernel);
        
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_THINNING, 3, $leftEdgeKernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #23 Thicken <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $leftEdgeKernel = \ImagickKernel::fromMatrix([[0, 1]], [1, 0]);
        $rightEdgeKernel = \ImagickKernel::fromMatrix([[1, 0]], [0, 0]);
        $leftEdgeKernel-&gt;addKernel($rightEdgeKernel);

        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_THICKEN, 3, $leftEdgeKernel);
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #24 Thick to generate a convex hull <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $diamondKernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DIAMOND, "1");
        $convexKernel =  \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_CONVEX_HULL, "");

        // The thicken morphology doesn't handle small gaps. We close them
        // with the close morphology.
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_CLOSE, 1, $diamondKernel);
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_THICKEN, -1, $convexKernel);
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_CLOSE, 1, $diamondKernel);

        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #25 Iterative morphology <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
        $canvas = $this-&gt;getCharacterOutline();
        $kernel = \ImagickKernel::fromBuiltIn(\Imagick::KERNEL_DISK, "2");        
        $canvas-&gt;morphology(\Imagick::MORPHOLOGY_ITERATIVE, 3, $kernel);
        $canvas-&gt;autoLevelImage();
        header("Content-Type: image/png");
        echo $canvas-&gt;getImageBlob();

?&gt;</pre> </div> </div> <div class="example" id=""> <p><strong>Example #26 Helper function to get an image silhouette <span class="function"><strong>Imagick::morphology()</strong></span></strong></p> <div class="example-contents"> <pre class="phpcode" data-language="php">&lt;?php
function getCharacterOutline() {
    $imagick = new \Imagick(realpath("./images/character.png"));
    $character = new \Imagick();
    $character-&gt;newPseudoImage(
        $imagick-&gt;getImageWidth(),
        $imagick-&gt;getImageHeight(),
        "canvas:white"
    );
    $canvas = new \Imagick();
    $canvas-&gt;newPseudoImage(
        $imagick-&gt;getImageWidth(),
        $imagick-&gt;getImageHeight(),
        "canvas:black"
    );

    $character-&gt;compositeimage(
        $imagick,
        \Imagick::COMPOSITE_COPYOPACITY,
        0, 0
    );
    $canvas-&gt;compositeimage(
        $character,
        \Imagick::COMPOSITE_ATOP,
        0, 0
    );
    $canvas-&gt;setFormat('png');

    return $canvas;
}
?&gt;</pre> </div> </div> </div> </div></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1997&ndash;2023 The PHP Documentation Group<br>Licensed under the Creative Commons Attribution License v3.0 or later.<br>
    <a href="https://www.php.net/manual/en/imagick.morphology.php" class="_attribution-link">https://www.php.net/manual/en/imagick.morphology.php</a>
  </p>
</div>
