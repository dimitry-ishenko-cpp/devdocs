<h1 data-toc="gradle-configure-project" id="gradle-configure-project.md">Configure a Gradle project</h1>
<p id="c0e5faca">To build a Kotlin project with <a href="https://docs.gradle.org/current/userguide/getting_started.html" id="6f9bb83f" data-external="true" rel="noopener noreferrer">Gradle</a>, you need to add the <a href="#apply-the-plugin" id="e99ee036">Kotlin Gradle plugin</a> to your build script file <code class="code ">build.gradle(.kts)</code> and <a href="#configure-dependencies" id="81ef0ff4">configure the project's dependencies</a> there.</p>
<aside data-type="note" class="prompt" data-title="" id="66328a7e"><p id="2479f476">To learn more about the contents of a build script, visit the <a href="get-started-with-jvm-gradle-project.html#explore-the-build-script" id="f106ada8">Explore the build script</a> section.</p></aside><section class="chapter"><h2 id="apply-the-plugin" data-toc="apply-the-plugin">Apply the plugin</h2>
<p id="18c9c944">To apply the Kotlin Gradle plugin, use the <a href="https://docs.gradle.org/current/userguide/plugins.html#sec:plugins_block" id="99a4ced1" data-external="true" rel="noopener noreferrer"><code class="code ">plugins</code> block</a> from the Gradle plugins DSL:</p>
<div class="tabs" id="e735a19f" data-group="build-script" data-anchors="[4c8c3a2f,a229b7aa,db4e2dc0,2434a040,e735a19f]">
<div class="tabs__content" data-gtm="tab" id="4c8c3a2f" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">// replace `&lt;...&gt;` with the plugin name 
plugins {
    kotlin("&lt;...&gt;") version "1.9.0"
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="db4e2dc0" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">// replace `&lt;...&gt;` with the plugin name
plugins {
    id 'org.jetbrains.kotlin.&lt;...&gt;' version '1.9.0'
}
</pre></div>
</div>
<aside data-type="note" class="prompt" data-title="" id="af986316"><p id="8886b323">The Kotlin Gradle plugin (KGP) and Kotlin share the same version numbering.</p></aside><p id="731cdd99">When configuring your project, check the Kotlin Gradle plugin (KGP) compatibility with available Gradle versions. In the following table, there are the minimum and maximum <b id="d6c86214" class="">fully supported</b> versions of Gradle and Android Gradle plugin (AGP):</p>
<div class="table-wrapper"><table class=" wide" id="54754cb9">
<thead><tr class="ijRowHead" id="bc1a5367">
<th id="cb0cb1ae"><p>KGP version</p></th>
<th id="c845f7fd"><p>Gradle min and max versions</p></th>
<th id="559e6ed"><p>AGP min and max versions</p></th>
</tr></thead>
<tbody>
<tr class="" id="e302d951">
<td id="42f7ccdd"><p>1.9.0</p></td>
<td id="8b4c1079"><p>6.8.3 – 7.6.0</p></td>
<td id="6ffa9e8d"><p>4.2.2 – 7.4.0</p></td>
</tr>
<tr class="" id="a504552">
<td id="6bcae27b"><p>1.8.20</p></td>
<td id="da74cd27"><p>6.8.3 – 7.6.0</p></td>
<td id="8ac5deae"><p>4.1.3 – 7.4.0</p></td>
</tr>
<tr class="" id="50cc1297">
<td id="ede23cab"><p>1.8.0</p></td>
<td id="ef10ec89"><p>6.8.3 – 7.3.3</p></td>
<td id="22caf115"><p>4.1.3 – 7.2.1</p></td>
</tr>
<tr class="" id="42df006a">
<td id="7d0053f3"><p>1.7.20</p></td>
<td id="1c54c0a"><p>6.7.1 – 7.1.1</p></td>
<td id="7549f1ed"><p>3.6.4 – 7.0.4</p></td>
</tr>
<tr class="" id="53bf8dd7">
<td id="675dcc0c"><p>1.7.0</p></td>
<td id="7cf00643"><p>6.7.1 – 7.0.2</p></td>
<td id="5ca2cab4"><p>3.4.3 – 7.0.2</p></td>
</tr>
<tr class="" id="a59a0b93">
<td id="4fbe9f8"><p>1.6.20</p></td>
<td id="ab4ab179"><p>6.1.1 - 7.0.2</p></td>
<td id="89446876"><p>3.4.3 - 7.0.2</p></td>
</tr>
</tbody>
</table></div>
<aside data-type="note" class="prompt" data-title="" id="420d6819"><p id="4d5fd75a">You can also use Gradle and AGP versions up to the latest releases, but if you do, keep in mind that you might encounter deprecation warnings or some new features might not work.</p></aside><p id="a093826a">For example, the Kotlin Gradle plugin and the <code class="code ">kotlin-multiplatform</code> plugin 1.9.0 require the minimum Gradle version of 6.8.3 for your project to compile.</p>
<p id="fc661a16">Similarly, the maximum fully supported version is 7.6.0. It doesn't have deprecated Gradle methods and properties, and supports all the current Gradle features.</p></section><section class="chapter"><h2 id="targeting-the-jvm" data-toc="targeting-the-jvm">Targeting the JVM</h2>
<p id="e56e4701">To target the JVM, apply the Kotlin JVM plugin.</p>
<div class="tabs" id="865f5749" data-group="build-script" data-anchors="[df1c7cc8,19b2cd07,a2844ec5,68d2ef05,865f5749]">
<div class="tabs__content" data-gtm="tab" id="df1c7cc8" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">plugins {
    kotlin("jvm") version "1.9.0"
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="a2844ec5" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">plugins {
    id "org.jetbrains.kotlin.jvm" version "1.9.0"
}
</pre></div>
</div>
<p id="676bd47b">The <code class="code ">version</code> should be literal in this block, and it cannot be applied from another build script.</p>
<section class="chapter"><h3 id="kotlin-and-java-sources" data-toc="kotlin-and-java-sources">Kotlin and Java sources</h3>
<p id="74638a96">Kotlin sources and Java sources can be stored in the same directory, or they can be placed in different directories.</p>
<p id="a621d0d1">The default convention is to use different directories:</p>
<pre class="code" data-language="plaintext">project
    - src
        - main (root)
            - kotlin
            - java
</pre>
<aside data-type="warning" class="prompt" data-title="" id="cfe7a76d"><p id="e254dcd1">Do not store Java <code class="code ">.java</code> files in the <code class="code ">src/*/kotlin</code> directory, as the <code class="code ">.java</code> files will not be compiled.</p>
<p id="5a465fd5">Instead, you can use <code class="code ">src/main/java</code>.</p></aside><p id="a361c544">The corresponding <code class="code ">sourceSets</code> property should be updated if you are not using the default convention:</p>
<div class="tabs" id="dfde5cd6" data-group="build-script" data-anchors="[deed4b0a,b1b1f0f5,75ffb6e7,aec65bf0,dfde5cd6]">
<div class="tabs__content" data-gtm="tab" id="deed4b0a" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">sourceSets.main {
    java.srcDirs("src/main/myJava", "src/main/myKotlin")
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="75ffb6e7" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">sourceSets {
    main.kotlin.srcDirs += 'src/main/myKotlin'
    main.java.srcDirs += 'src/main/myJava'
}
</pre></div>
</div></section><section class="chapter"><h3 id="check-for-jvm-target-compatibility-of-related-compile-tasks" data-toc="check-for-jvm-target-compatibility-of-related-compile-tasks">Check for JVM target compatibility of related compile tasks</h3>
<p id="8da1c707">In the build module, you may have related compile tasks, for example:</p>
<ul class="list _bullet" id="b9ce726f">
<li class="list__item" id="62903693"><p><code class="code ">compileKotlin</code> and <code class="code ">compileJava</code></p></li>
<li class="list__item" id="36fe5a07"><p><code class="code ">compileTestKotlin</code> and <code class="code ">compileTestJava</code></p></li>
</ul>
<aside data-type="note" class="prompt" data-title="" id="5ec66a7b"><p id="44790465"><code class="code ">main</code> and <code class="code ">test</code> source set compile tasks are not related.</p></aside><p id="df6c3eda">For related tasks like these, the Kotlin Gradle plugin checks for JVM target compatibility. Different values of the <a href="gradle-compiler-options.html#attributes-specific-to-jvm" id="59ccc478"><code class="code ">jvmTarget</code> attribute</a> in the <code class="code ">kotlin</code> extension or task and <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java-extension" id="1be4d835" data-external="true" rel="noopener noreferrer"><code class="code ">targetCompatibility</code></a> in the <code class="code ">java</code> extension or task cause JVM target incompatibility. For example: the <code class="code ">compileKotlin</code> task has <code class="code ">jvmTarget=1.8</code>, and the <code class="code ">compileJava</code> task has (or <a href="https://docs.gradle.org/current/userguide/java_plugin.html#sec:java-extension" id="aca6c683" data-external="true" rel="noopener noreferrer">inherits</a>) <code class="code ">targetCompatibility=15</code>.</p>
<p id="dda29ea1">Configure the behavior of this check for the whole project by setting the <code class="code ">kotlin.jvm.target.validation.mode</code> property in the <code class="code ">build.gradle(.kts)</code> file to:</p>
<ul class="list _bullet" id="4302cc73">
<li class="list__item" id="be23233e"><p><code class="code ">error</code> – the plugin fails the build; the default value for projects on Gradle 8.0+.</p></li>
<li class="list__item" id="1c22122d"><p><code class="code ">warning</code> – the plugin prints a warning message; the default value for projects on Gradle less than 8.0.</p></li>
<li class="list__item" id="17280b2"><p><code class="code ">ignore</code> – the plugin skips the check and doesn't produce any messages.</p></li>
</ul>
<p id="e8867798">You can also configure it at task level in your <code class="code ">build.gradle(.kts)</code> file:</p>
<div class="tabs" id="ba8a671f" data-group="build-script" data-anchors="[37689be,e9b5582,87f3199a,c9ed025c,ba8a671f]">
<div class="tabs__content" data-gtm="tab" id="37689be" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">tasks.withType&lt;org.jetbrains.kotlin.gradle.tasks.KotlinJvmCompile&gt;().configureEach {
    jvmTargetValidationMode.set(org.jetbrains.kotlin.gradle.dsl.jvm.JvmTargetValidationMode.WARNING)
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="87f3199a" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">tasks.withType(org.jetbrains.kotlin.gradle.tasks.KotlinJvmCompile.class).configureEach {
    jvmTargetValidationMode = org.jetbrains.kotlin.gradle.dsl.jvm.JvmTargetValidationMode.WARNING
}
</pre></div>
</div>
<p id="a7d912ec">To avoid JVM target incompatibility, <a href="#gradle-java-toolchains-support" id="8d4c97ac">configure a toolchain</a> or align JVM versions manually.</p>
<section class="chapter" data-anchors="[1b4a3fd8,581153e,495a2e2b,3b2db34e,460e9986,b71451be,611059c0,f50f0c9c,cbf7024a,420a8625,77f60946,dd4759ee,4bbfcbe,81e90242,bbeaa8c8,what-can-go-wrong-if-not-checking-targets-compatibility]"><div class="collapse">
<div class="collapse__title"><h4 id="what-can-go-wrong-if-not-checking-targets-compatibility" data-toc="what-can-go-wrong-if-not-checking-targets-compatibility">What can go wrong if not checking targets compatibility</h4></div>
<div class="collapse__content">
<p id="1b4a3fd8">There are two ways of manually setting JVM targets for Kotlin and Java source sets:</p>
<ul class="list _bullet" id="581153e">
<li class="list__item" id="495a2e2b"><p>The implicit way via <a href="#gradle-java-toolchains-support" id="f345f1cd">setting up a Java toolchain</a>.</p></li>
<li class="list__item" id="3b2db34e"><p>The explicit way via setting the <code class="code ">jvmTarget</code> attribute in the <code class="code ">kotlin</code> extension or task and <code class="code ">targetCompatibility</code> in the <code class="code ">java</code> extension or task.</p></li>
</ul>
<p id="460e9986">JVM target incompatibility occurs if you:</p>
<ul class="list _bullet" id="b71451be">
<li class="list__item" id="611059c0"><p>Explicitly set different values of <code class="code ">jvmTarget</code> and <code class="code ">targetCompatibility</code>.</p></li>
<li class="list__item" id="f50f0c9c"><p>Have a default configuration, and your JDK is not equal to <code class="code ">1.8</code>.</p></li>
</ul>
<p id="cbf7024a">Let's consider a default configuration of JVM targets when you have only the Kotlin JVM plugin in your build script and no additional settings for JVM targets:</p>
<div class="tabs" id="420a8625" data-group="build-script" data-anchors="[77f60946,dd4759ee,4bbfcbe,81e90242,420a8625]">
<div class="tabs__content" data-gtm="tab" id="77f60946" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">plugins {
    kotlin("jvm") version "1.9.0"
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="4bbfcbe" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">plugins {
    id "org.jetbrains.kotlin.jvm" version "1.9.0"
}
</pre></div>
</div>
<p id="bbeaa8c8">When there is no explicit information about the <code class="code ">jvmTarget</code> value in the build script, its default value is <code class="code ">null</code>, and the compiler translates it to the default value <code class="code ">1.8</code>. The <code class="code ">targetCompatibility</code> equals the current Gradle's JDK version, which is equal to your JDK version (unless you use a <a href="#gradle-java-toolchains-support" id="db29f14e">Java toolchain approach</a>). Assuming that your JDK version is <code class="code ">17</code>, your published library artifact will <a href="https://docs.gradle.org/current/userguide/publishing_gradle_module_metadata.html" id="76a4f3b5" data-external="true" rel="noopener noreferrer">declare itself compatible</a> with JDK 17+: <code class="code ">org.gradle.jvm.version=17</code>, which is wrong. In this case, you have to use Java 17 in your main project to add this library, even though the bytecode's version is <code class="code ">1.8</code>. <a href="#gradle-java-toolchains-support" id="89b9fdd3">Configure a toolchain</a> to solve this issue.</p>
</div>
</div></section></section><section class="chapter"><h3 id="gradle-java-toolchains-support" data-toc="gradle-java-toolchains-support">Gradle Java toolchains support</h3>
<aside data-type="warning" class="prompt" data-title="" id="df56cb7b"><p id="1431c53e">A warning for Android users. To use Gradle toolchain support, use the Android Gradle plugin (AGP) version 8.1.0-alpha09 or higher.</p>
<p id="4befb9be">Gradle Java toolchain support <a href="https://issuetracker.google.com/issues/194113162" id="4f99fbc" data-external="true" rel="noopener noreferrer">is available</a> only from AGP 7.4.0. Nevertheless, because of <a href="https://issuetracker.google.com/issues/260059413" id="af89fd47" data-external="true" rel="noopener noreferrer">this issue</a>, AGP did not set <code class="code ">targetCompatibility</code> to be equal to the toolchain's JDK until the version 8.1.0-alpha09. If you use versions less than 8.1.0-alpha09, you need to configure <code class="code ">targetCompatibility</code> manually via <code class="code ">compileOptions</code>. Replace the placeholder <code class="code ">&lt;MAJOR_JDK_VERSION&gt;</code> with the JDK version you would like to use:</p>
<pre class="code" data-language="kotlin">android {
    compileOptions {
        sourceCompatibility = &lt;MAJOR_JDK_VERSION&gt;
        targetCompatibility = &lt;MAJOR_JDK_VERSION&gt;
    }
}
</pre></aside><p id="c503e07e">Gradle 6.7 introduced <a href="https://docs.gradle.org/current/userguide/toolchains.html" id="cb0f32ec" data-external="true" rel="noopener noreferrer">Java toolchains support</a>. Using this feature, you can:</p>
<ul class="list _bullet" id="b3de2f84">
<li class="list__item" id="412592ec"><p>Use a JDK and a JRE that are different from the ones in Gradle to run compilations, tests, and executables.</p></li>
<li class="list__item" id="81c34f10"><p>Compile and test code with a not-yet-released language version.</p></li>
</ul>
<p id="536b9c3">With toolchains support, Gradle can autodetect local JDKs and install missing JDKs that Gradle requires for the build. Now Gradle itself can run on any JDK and still reuse the <a href="gradle-compilation-and-caches.html#gradle-build-cache-support" id="7f91af09">remote build cache feature</a> for tasks that depend on a major JDK version.</p>
<p id="d548e2a7">The Kotlin Gradle plugin supports Java toolchains for Kotlin/JVM compilation tasks. JS and Native tasks don't use toolchains. The Kotlin compiler always runs on the JDK the Gradle daemon is running on. A Java toolchain:</p>
<ul class="list _bullet" id="7876aeb1">
<li class="list__item" id="b2342b64"><p>Sets the <a href="compiler-reference.html#jdk-home-path" id="8336f37f"><code class="code ">-jdk-home</code> option</a> available for JVM targets.</p></li>
<li class="list__item" id="253a6965"><p>Sets the <a href="gradle-compiler-options.html#attributes-specific-to-jvm" id="17567a58"><code class="code ">compilerOptions.jvmTarget</code></a> to the toolchain's JDK version if the user doesn't set the <code class="code ">jvmTarget</code> option explicitly. If the user doesn't configure the toolchain, the <code class="code ">jvmTarget</code> field uses the default value. Learn more about <a href="#check-for-jvm-target-compatibility-of-related-compile-tasks" id="4556c8d9">JVM target compatibility</a>.</p></li>
<li class="list__item" id="ae72174d"><p>Sets the toolchain to be used by any Java compile, test and javadoc tasks.</p></li>
<li class="list__item" id="19949d57"><p>Affects which JDK <a href="kapt.html#running-kapt-tasks-in-parallel" id="401b6827"><code class="code ">kapt</code> workers</a> are running on.</p></li>
</ul>
<p id="7680fed7">Use the following code to set a toolchain. Replace the placeholder <code class="code ">&lt;MAJOR_JDK_VERSION&gt;</code> with the JDK version you would like to use:</p>
<div class="tabs" id="106a1476" data-group="build-script" data-anchors="[6a5f3014,8d13ea85,a976bd7b,66b2ec64,106a1476]">
<div class="tabs__content" data-gtm="tab" id="6a5f3014" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    jvmToolchain {
        languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;))
    }
    // Or shorter:
    jvmToolchain(&lt;MAJOR_JDK_VERSION&gt;)
    // For example:
    jvmToolchain(17)
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="a976bd7b" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    jvmToolchain {
        languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;))
    }
    // Or shorter:
    jvmToolchain(&lt;MAJOR_JDK_VERSION&gt;)
    // For example:
    jvmToolchain(17)
}
</pre></div>
</div>
<p id="befb8e6c">Note that setting a toolchain via the <code class="code ">kotlin</code> extension updates the toolchain for Java compile tasks as well.</p>
<p id="78f8d078">You can set a toolchain via the <code class="code ">java</code> extension, and Kotlin compilation tasks will use it:</p>
<div class="tabs" id="7e977974" data-group="build-script" data-anchors="[309c6ac7,15a9e88a,5bd41ece,f1078246,7e977974]">
<div class="tabs__content" data-gtm="tab" id="309c6ac7" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">java {
    toolchain {
        languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) 
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="5bd41ece" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">java {
    toolchain {
        languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;)) 
    }
}
</pre></div>
</div>
<p id="510e1d30">If you use Gradle 8.0.2 or higher, you also need to add a <a href="https://docs.gradle.org/current/userguide/toolchains.html#sub:download_repositories" id="bee42063" data-external="true" rel="noopener noreferrer">toolchain resolver plugin</a>. This type of plugin manages which repositories to download a toolchain from. As an example, add to your <code class="code ">settings.gradle(.kts)</code> the following plugin:</p>
<div class="tabs" id="39970f69" data-group="build-script" data-anchors="[97a58032,648d3760,e69c803d,827ec21f,39970f69]">
<div class="tabs__content" data-gtm="tab" id="97a58032" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">plugins {
  id("org.gradle.toolchains.foojay-resolver-convention") version("0.5.0")
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="e69c803d" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">plugins {
  id 'org.gradle.toolchains.foojay-resolver-convention' version '0.5.0'
}
</pre></div>
</div>
<p id="b15e4481">Check that the version of <code class="code ">foojay-resolver-convention</code> corresponds to your Gradle version on the <a href="https://docs.gradle.org/current/userguide/toolchains.html#sub:download_repositories" id="e39774bd" data-external="true" rel="noopener noreferrer">Gradle site</a>.</p>
<aside data-type="note" class="prompt" data-title="" id="45cb5cfa"><p id="4adc49eb">To understand which toolchain Gradle uses, run your Gradle build with the <a href="https://docs.gradle.org/current/userguide/logging.html#sec:choosing_a_log_level" id="d9cbc78b" data-external="true" rel="noopener noreferrer">log level <code class="code ">--info</code></a> and find a string in the output starting with <code class="code ">[KOTLIN] Kotlin compilation 'jdkHome' argument:</code>. The part after the colon will be the JDK version from the toolchain.</p></aside><p id="9253909c">To set any JDK (even local) for a specific task, use the <a href="#set-jdk-version-with-the-task-dsl" id="f9d70e20">Task DSL</a>.</p>
<p id="63e9387c">Learn more about <a href="https://blog.jetbrains.com/kotlin/2021/11/gradle-jvm-toolchain-support-in-the-kotlin-plugin/" id="86f7cc40" data-external="true" rel="noopener noreferrer">Gradle JVM toolchain support in the Kotlin plugin</a>.</p></section><section class="chapter"><h3 id="set-jdk-version-with-the-task-dsl" data-toc="set-jdk-version-with-the-task-dsl">Set JDK version with the Task DSL</h3>
<p id="fe277a9d">The Task DSL allows setting any JDK version for any task implementing the <code class="code ">UsesKotlinJavaToolchain</code> interface. At the moment, these tasks are <code class="code ">KotlinCompile</code> and <code class="code ">KaptTask</code>. If you want Gradle to search for the major JDK version, replace the <code class="code ">&lt;MAJOR_JDK_VERSION&gt;</code> placeholder in your build script:</p>
<div class="tabs" id="540e9a16" data-group="build-script" data-anchors="[4fb99a9b,f84714e9,88cc4f4,6edf589e,540e9a16]">
<div class="tabs__content" data-gtm="tab" id="4fb99a9b" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">val service = project.extensions.getByType&lt;JavaToolchainService&gt;()
val customLauncher = service.launcherFor {
    languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;))
}
project.tasks.withType&lt;UsesKotlinJavaToolchain&gt;().configureEach {
    kotlinJavaToolchain.toolchain.use(customLauncher)
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="88cc4f4" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">JavaToolchainService service = project.getExtensions().getByType(JavaToolchainService.class)
Provider&lt;JavaLauncher&gt; customLauncher = service.launcherFor {
    it.languageVersion.set(JavaLanguageVersion.of(&lt;MAJOR_JDK_VERSION&gt;))
}
tasks.withType(UsesKotlinJavaToolchain::class).configureEach { task -&gt;
    task.kotlinJavaToolchain.toolchain.use(customLauncher)
}
</pre></div>
</div>
<p id="720ecb96">Or you can specify the path to your local JDK and replace the placeholder <code class="code ">&lt;LOCAL_JDK_VERSION&gt;</code> with this JDK version:</p>
<pre class="code" data-language="kotlin">tasks.withType&lt;UsesKotlinJavaToolchain&gt;().configureEach {
    kotlinJavaToolchain.jdk.use(
        "/path/to/local/jdk", // Put a path to your JDK
        JavaVersion.&lt;LOCAL_JDK_VERSION&gt; // For example, JavaVersion.17
    )
}
</pre></section><section class="chapter"><h3 id="associate-compiler-tasks" data-toc="associate-compiler-tasks">Associate compiler tasks</h3>
<p id="71039822">You can <em id="860755f" class="">associate</em> compilations by setting up such a relationship between them that one compilation uses the compiled outputs of the other. Associating compilations establishes <code class="code ">internal</code> visibility between them.</p>
<p id="85a75821">The Kotlin compiler associates some compilations by default, such as the <code class="code ">test</code> and <code class="code ">main</code> compilations of each target. If you need to express that one of your custom compilations is connected to another, create your own associated compilation.</p>
<p id="d989c51">To make the IDE support associated compilations for inferring visibility between source sets, add the following code to your <code class="code ">build.gradle(.kts)</code>:</p>
<div class="tabs" id="8a5d3ef7" data-group="build-script" data-anchors="[8679db70,fe6e9bfd,bbc16c59,7891d549,8a5d3ef7]">
<div class="tabs__content" data-gtm="tab" id="8679db70" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">val integrationTestCompilation = kotlin.target.compilations.create("integrationTest") {
    associateWith(kotlin.target.compilations.getByName("main"))
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="bbc16c59" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">integrationTestCompilation {
    kotlin.target.compilations.create("integrationTest") {
        associateWith(kotlin.target.compilations.getByName("main"))
    }
}
</pre></div>
</div>
<p id="7bf79eb8">Here, the <code class="code ">integrationTest</code> compilation is associated with the <code class="code ">main</code> compilation that gives access to <code class="code ">internal</code> objects from functional tests.</p></section><section class="chapter"><h3 id="configure-with-java-modules-jpms-enabled" data-toc="configure-with-java-modules-jpms-enabled">Configure with Java Modules (JPMS) enabled</h3>
<p id="e3e74059">To make the Kotlin Gradle plugin work with <a href="https://www.oracle.com/corporate/features/understanding-java-9-modules.html" id="80f6f027" data-external="true" rel="noopener noreferrer">Java Modules</a>, add the following lines to your build script and replace <code class="code ">YOUR_MODULE_NAME</code> with a reference to your JPMS module, for example, <code class="code ">org.company.module</code>:</p>
<div class="tabs" id="414852ac" data-group="build-script" data-anchors="[892449ec,57142489,8d036a15,389d310b,414852ac]">
<div class="tabs__content" data-gtm="tab" id="892449ec" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">// Add the following three lines if you use a Gradle version less than 7.0
java {
    modularity.inferModulePath.set(true)
}

tasks.named("compileJava", JavaCompile::class.java) {
    options.compilerArgumentProviders.add(CommandLineArgumentProvider {
        // Provide compiled Kotlin classes to javac – needed for Java/Kotlin mixed sources to work
        listOf("--patch-module", "YOUR_MODULE_NAME=${sourceSets["main"].output.asPath}")
    })
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="8d036a15" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">// Add the following three lines if you use a Gradle version less than 7.0
java {
    modularity.inferModulePath = true
}

tasks.named("compileJava", JavaCompile.class) {
    options.compilerArgumentProviders.add(new CommandLineArgumentProvider() {
        @Override
        Iterable&lt;String&gt; asArguments() {
            // Provide compiled Kotlin classes to javac – needed for Java/Kotlin mixed sources to work
            return ["--patch-module", "YOUR_MODULE_NAME=${sourceSets["main"].output.asPath}"]
        }
    })
}
</pre></div>
</div>
<aside data-type="note" class="prompt" data-title="" id="1f3e1633"><p id="3966e0d4">Put <code class="code ">module-info.java</code> into the <code class="code ">src/main/java</code> directory as usual.</p>
<p id="163fa80c">For a module, a package name in Kotlin files should be equal to the package name from <code class="code ">module-info.java</code> to avoid a "package is empty or does not exist" build failure.</p></aside><p id="4f07138b">Learn more about:</p>
<ul class="list _bullet" id="13f9c5a">
<li class="list__item" id="f2f0d331"><p><a href="https://docs.gradle.org/current/userguide/java_library_plugin.html#sec:java_library_modular" id="ceeaaf15" data-external="true" rel="noopener noreferrer">Building modules for the Java Module System</a></p></li>
<li class="list__item" id="54098f78"><p><a href="https://docs.gradle.org/current/userguide/application_plugin.html#sec:application_modular" id="e05a76f7" data-external="true" rel="noopener noreferrer">Building applications using the Java Module System</a></p></li>
<li class="list__item" id="7643c558"><p><a href="visibility-modifiers.html#modules" id="467c54eb">What "module" means in Kotlin</a></p></li>
</ul></section><section class="chapter"><h3 id="other-details" data-toc="other-details">Other details</h3>
<p id="502ab525">Learn more about <a href="jvm-get-started.html" id="64ceab7f">Kotlin/JVM</a>.</p>
<section class="chapter"><h4 id="lazy-kotlin-jvm-task-creation" data-toc="lazy-kotlin-jvm-task-creation">Lazy Kotlin/JVM task creation</h4>
<p id="7a6a0c9">Starting from Kotlin 1.8.20, the Kotlin Gradle plugin registers all tasks and doesn't configure them on a dry run.</p></section><section class="chapter"><h4 id="non-default-location-of-compile-tasks-destinationdirectory" data-toc="non-default-location-of-compile-tasks-destinationdirectory">Non-default location of compile tasks' destinationDirectory</h4>
<p id="9ea7635e">If you override the Kotlin/JVM <code class="code ">KotlinJvmCompile</code>/<code class="code ">KotlinCompile</code> task's <code class="code ">destinationDirectory</code> location, update your build script. You need to explicitly add <code class="code ">sourceSets.main.kotlin.classesDirectories</code> to <code class="code ">sourceSets.main.outputs</code> in your JAR file:</p>
<pre class="code" data-language="kotlin">tasks.jar(type: Jar) {
     from sourceSets.main.outputs
     from sourceSets.main.kotlin.classesDirectories
}
</pre></section></section></section><section class="chapter"><h2 id="targeting-multiple-platforms" data-toc="targeting-multiple-platforms">Targeting multiple platforms</h2>
<p id="63c42bb2">Projects targeting <a href="multiplatform-dsl-reference.html#targets" id="2888ce78">multiple platforms</a>, called <a href="multiplatform-get-started.html" id="b01deb77">multiplatform projects</a>, require the <code class="code ">kotlin-multiplatform</code> plugin. <a href="multiplatform-discover-project.html#multiplatform-plugin" id="94373744">Learn more about the plugin</a>.</p>
<aside data-type="note" class="prompt" data-title="" id="4419155f"><p id="ab9a911d">The <code class="code ">kotlin-multiplatform</code> plugin works with Gradle 6.8.3 or later.</p></aside><div class="tabs" id="a2bf223a" data-group="build-script" data-anchors="[78936530,ae9438c8,b37ab062,dd6d481f,a2bf223a]">
<div class="tabs__content" data-gtm="tab" id="78936530" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">plugins {
    kotlin("multiplatform") version "1.9.0"
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="b37ab062" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">plugins {
    id 'org.jetbrains.kotlin.multiplatform' version '1.9.0'
}
</pre></div>
</div>
<p id="a880fc0f">Learn more about <a href="multiplatform-get-started.html" id="287c5047">Kotlin Multiplatform for different platforms</a> and <a href="multiplatform-mobile-getting-started.html" id="55f63a78">Kotlin Multiplatform for iOS and Android</a>.</p></section><section class="chapter"><h2 id="targeting-android" data-toc="targeting-android">Targeting Android</h2>
<p id="4d9d52c5">It's recommended to use Android Studio for creating Android applications. <a href="https://developer.android.com/studio/releases/gradle-plugin" id="286b3cd7" data-external="true" rel="noopener noreferrer">Learn how to use the Android Gradle plugin</a>.</p></section><section class="chapter"><h2 id="targeting-javascript" data-toc="targeting-javascript">Targeting JavaScript</h2>
<p id="1dc53df7">When targeting JavaScript, use the <code class="code ">kotlin-multiplatform</code> plugin as well. <a href="js-project-setup.html" id="40fe4d9c">Learn more about setting up a Kotlin/JS project</a></p>
<div class="tabs" id="e88661d1" data-group="build-script" data-anchors="[6dc9631,1c571e72,1fc91a46,670e17c2,e88661d1]">
<div class="tabs__content" data-gtm="tab" id="6dc9631" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">plugins {
    kotlin("multiplatform") version "1.9.0"
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="1fc91a46" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">plugins {
    id 'org.jetbrains.kotlin.multiplatform' version '1.9.0'
}
</pre></div>
</div>
<section class="chapter"><h3 id="kotlin-and-java-sources-for-javascript" data-toc="kotlin-and-java-sources-for-javascript">Kotlin and Java sources for JavaScript</h3>
<p id="948eb402">This plugin only works for Kotlin files, so it is recommended that you keep Kotlin and Java files separate (if the project contains Java files). If you don't store them separately, specify the source folder in the <code class="code ">sourceSets</code> block:</p>
<div class="tabs" id="b1111a6a" data-group="build-script" data-anchors="[a6a2452a,9b3ea921,d831d9b6,4f9522c7,b1111a6a]">
<div class="tabs__content" data-gtm="tab" id="a6a2452a" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    sourceSets["main"].apply {    
        kotlin.srcDir("src/main/myKotlin") 
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="d831d9b6" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    sourceSets {
        main.kotlin.srcDirs += 'src/main/myKotlin'
    }
}
</pre></div>
</div></section></section><section class="chapter"><h2 id="triggering-configuration-actions-with-the-kotlinbaseplugin-interface" data-toc="triggering-configuration-actions-with-the-kotlinbaseplugin-interface">Triggering configuration actions with the KotlinBasePlugin interface</h2>
<p id="d41281cb">To trigger some configuration action whenever any Kotlin Gradle plugin (JVM, JS, Multiplatform, Native, and others) is applied, use the <code class="code ">KotlinBasePlugin</code> interface that all Kotlin plugins inherit from:</p>
<div class="tabs" id="e9e55bd3" data-group="build-script" data-anchors="[9440b8c,b0eb0267,9714d3d6,5ef93654,e9e55bd3]">
<div class="tabs__content" data-gtm="tab" id="9440b8c" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">import org.jetbrains.kotlin.gradle.plugin.KotlinBasePlugin

// ...

project.plugins.withType&lt;KotlinBasePlugin&gt;() {
    // Configure your action here
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="9714d3d6" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">import org.jetbrains.kotlin.gradle.plugin.KotlinBasePlugin

// ...

project.plugins.withType(KotlinBasePlugin.class) {
    // Configure your action here
}
</pre></div>
</div></section><section class="chapter"><h2 id="configure-dependencies" data-toc="configure-dependencies">Configure dependencies</h2>
<p id="c30971e7">To add a dependency on a library, set the dependency of the required <a href="#dependency-types" id="93fdfcce">type</a> (for example, <code class="code ">implementation</code>) in the <code class="code ">dependencies</code> block of the source sets DSL.</p>
<div class="tabs" id="a6ac7edc" data-group="build-script" data-anchors="[7b50c817,cb28ffff,b82de440,d2d3c757,a6ac7edc]">
<div class="tabs__content" data-gtm="tab" id="7b50c817" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    sourceSets {
        val commonMain by getting {
            dependencies {
                implementation("com.example:my-library:1.0")
            }
        }
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="b82de440" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    sourceSets {
        commonMain {
            dependencies {
                implementation 'com.example:my-library:1.0'
            }
        }
    }
}
</pre></div>
</div>
<p id="63843d2d">Alternatively, you can <a href="#set-dependencies-at-top-level" id="21a6624e">set dependencies at top level</a>.</p>
<section class="chapter"><h3 id="dependency-types" data-toc="dependency-types">Dependency types</h3>
<p id="de03849f">Choose the dependency type based on your requirements.</p>
<div class="table-wrapper"><table class=" wide" id="4ade9983">
<thead><tr class="ijRowHead" id="c4441b8d">
<th id="38e20c1"><p>Type</p></th>
<th id="d6d7d1d2"><p>Description</p></th>
<th id="de754b5c"><p>When to use</p></th>
</tr></thead>
<tbody>
<tr class="" id="97c1764d">
<td id="d2aed34e"><p><code class="code ">api</code></p></td>
<td id="64b75e83"><p>Used both during compilation and at runtime and is exported to library consumers.</p></td>
<td id="e0f86d5f"><p>If any type from a dependency is used in the public API of the current module, use an <code class="code ">api</code> dependency.</p></td>
</tr>
<tr class="" id="2aa21446">
<td id="7e078d50"><p><code class="code ">implementation</code></p></td>
<td id="8d4c622f"><p>Used during compilation and at runtime for the current module, but is not exposed for compilation of other modules depending on the one with the `implementation` dependency.</p></td>
<td id="fad9b8e">
<p id="b6e3152d">Use for dependencies needed for the internal logic of a module.</p>
<p id="e2b4bdea">If a module is an endpoint application which is not published, use <code class="code ">implementation</code> dependencies instead of <code class="code ">api</code> dependencies.</p>
</td>
</tr>
<tr class="" id="8f32d221">
<td id="a3e75677"><p><code class="code ">compileOnly</code></p></td>
<td id="ce5f4db4"><p>Used for compilation of the current module and is not available at runtime nor during compilation of other modules.</p></td>
<td id="9959ffab"><p>Use for APIs which have a third-party implementation available at runtime.</p></td>
</tr>
<tr class="" id="c2e451cb">
<td id="6214c858"><p><code class="code ">runtimeOnly</code></p></td>
<td id="b42fb2d1"><p>Available at runtime but is not visible during compilation of any module.</p></td>
<td id="48026fe0"></td>
</tr>
</tbody>
</table></div></section><section class="chapter"><h3 id="dependency-on-the-standard-library" data-toc="dependency-on-the-standard-library">Dependency on the standard library</h3>
<p id="a28854a5">A dependency on the standard library (<code class="code ">stdlib</code>) is added automatically to each source set. The version of the standard library used is the same as the version of the Kotlin Gradle plugin.</p>
<p id="c04d6177">For platform-specific source sets, the corresponding platform-specific variant of the library is used, while a common standard library is added to the rest. The Kotlin Gradle plugin selects the appropriate JVM standard library depending on the <code class="code ">compilerOptions.jvmTarget</code> <a href="gradle-compiler-options.html" id="db67077d">compiler option</a> of your Gradle build script.</p>
<p id="239ac727">If you declare a standard library dependency explicitly (for example, if you need a different version), the Kotlin Gradle plugin won't override it or add a second standard library.</p>
<p id="1cee0af4">If you do not need a standard library at all, you can add the opt-out option to the <code class="code ">gradle.properties</code>:</p>
<pre class="code" data-language="none">kotlin.stdlib.default.dependency=false
</pre>
<section class="chapter"><h4 id="versions-alignment-of-transitive-dependencies" data-toc="versions-alignment-of-transitive-dependencies">Versions alignment of transitive dependencies</h4>
<p id="755cff1d">If you explicitly write the Kotlin version 1.8.0 or higher in your dependencies, for example: <code class="code ">implementation("org.jetbrains.kotlin:kotlin-stdlib:1.8.0")</code>, then the Kotlin Gradle Plugin uses this Kotlin version for transitive <code class="code ">kotlin-stdlib-jdk7</code> and <code class="code ">kotlin-stdlib-jdk8</code> dependencies. This is for avoiding class duplication from different stdlib versions. <a href="whatsnew18.html#updated-jvm-compilation-target" id="6c5c84cd">Learn more about merging <code class="code ">kotlin-stdlib-jdk7</code> and <code class="code ">kotlin-stdlib-jdk8</code> into <code class="code ">kotlin-stdlib</code></a>. You can disable this behavior with the <code class="code ">kotlin.stdlib.jdk.variants.version.alignment</code> Gradle property:</p>
<pre class="code" data-language="none">kotlin.stdlib.jdk.variants.version.alignment=false
</pre>
<section class="chapter" data-anchors="[891fde2e,9ae502f9,89e5725f,4279462,55c9c824,f07851f4,e8d6b073,219342fd,278920f0,6afbab1a,c6e5710f,b9f163f8,9373c3f5,d8a5f8f8,ec287b8a,2a6c1ae9,777ab1ef,f6ec005d,b96e32ba,df314337,ddf887a,6f3fa618,5906bd7c,ae49bcb4,b004ff7f,9a5a07f3,9ab8aca7,b770eb24,60e3b496,other-ways-to-align-versions]"><div class="collapse">
<div class="collapse__title"><h5 id="other-ways-to-align-versions" data-toc="other-ways-to-align-versions">Other ways to align versions</h5></div>
<div class="collapse__content"><ul class="list _bullet" id="891fde2e">
<li class="list__item" id="9ae502f9">
<p id="89e5725f">In case you have issues with versions alignment, align all versions via the Kotlin <a href="https://docs.gradle.org/current/userguide/platforms.html#sub:bom_import" id="1801a3d1" data-external="true" rel="noopener noreferrer">BOM</a>. Declare a platform dependency on <code class="code ">kotlin-bom</code> in your build script:</p>
<div class="tabs" id="4279462" data-group="build-script" data-anchors="[55c9c824,f07851f4,e8d6b073,219342fd,4279462]">
<div class="tabs__content" data-gtm="tab" id="55c9c824" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">implementation(platform("org.jetbrains.kotlin:kotlin-bom:1.9.0"))
</pre></div>
<div class="tabs__content" data-gtm="tab" id="e8d6b073" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">implementation platform('org.jetbrains.kotlin:kotlin-bom:1.9.0')
</pre></div>
</div>
</li>
<li class="list__item" id="278920f0">
<p id="6afbab1a">If you don't have a standard library explicitly: <code class="code ">kotlin.stdlib.default.dependency=false</code> in your <code class="code ">gradle.properties</code>, but one of your dependencies transitively brings some old Kotlin stdlib version, for example, <code class="code ">kotlin-stdlib-jdk7:1.7.20</code> and another dependency transitively brings <code class="code ">kotlin-stdlib:1.8+</code> – in this case, you can require <code class="code ">1.9.0</code> versions of these transitive libraries:</p>
<div class="tabs" id="c6e5710f" data-group="build-script" data-anchors="[b9f163f8,9373c3f5,d8a5f8f8,ec287b8a,c6e5710f]">
<div class="tabs__content" data-gtm="tab" id="b9f163f8" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">dependencies {
    constraints {
        add("implementation", "org.jetbrains.kotlin:kotlin-stdlib-jdk7") {
            version {
                require("1.9.0")
            }
        }
        add("implementation", "org.jetbrains.kotlin:kotlin-stdlib-jdk8") {
            version {
                require("1.9.0")
            }
        }
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="d8a5f8f8" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">dependencies {
    constraints {
        add("implementation", "org.jetbrains.kotlin:kotlin-stdlib-jdk7") {
            version {
                require("1.9.0")
            }
        }
        add("implementation", "org.jetbrains.kotlin:kotlin-stdlib-jdk8") {
            version {
                require("1.9.0")
            }
        }
    }
}
</pre></div>
</div>
</li>
<li class="list__item" id="2a6c1ae9">
<p id="777ab1ef">If you have a Kotlin version equal to <code class="code ">1.9.0</code>: <code class="code ">implementation("org.jetbrains.kotlin:kotlin-stdlib:1.9.0")</code> and an old version (less than <code class="code ">1.8.0</code>) of a Kotlin Gradle plugin – update the Kotlin Gradle plugin:</p>
<div class="tabs" id="f6ec005d" data-group="build-script" data-anchors="[b96e32ba,df314337,ddf887a,6f3fa618,f6ec005d]">
<div class="tabs__content" data-gtm="tab" id="b96e32ba" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">plugins {
    // replace `&lt;...&gt;` with the plugin name
    kotlin("&lt;...&gt;") version "1.9.0"
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="ddf887a" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">plugins {
    // replace `&lt;...&gt;` with the plugin name
    id "org.jetbrains.kotlin.&lt;...&gt;" version "1.9.0"
}
</pre></div>
</div>
</li>
<li class="list__item" id="5906bd7c">
<p id="ae49bcb4">If you have an explicit old version (less than <code class="code ">1.8.0</code>) of <code class="code ">kotlin-stdlib-jdk7</code>/<code class="code ">kotlin-stdlib-jdk8</code>, for example, <code class="code ">implementation("org.jetbrains.kotlin:kotlin-stdlib-jdk7:SOME_OLD_KOTLIN_VERSION")</code>, and a dependency that transitively brings <code class="code ">kotlin-stdlib:1.8+</code>, <a href="whatsnew18.html#updated-jvm-compilation-target" id="629d120">replace your <code class="code ">kotlin-stdlib-jdk&lt;7/8&gt;:SOME_OLD_KOTLIN_VERSION</code> with <code class="code ">kotlin-stdlib-jdk*:1.9.0</code></a> or <a href="https://docs.gradle.org/current/userguide/dependency_downgrade_and_exclude.html#sec:excluding-transitive-deps" id="518850e8" data-external="true" rel="noopener noreferrer">exclude</a> a transitive <code class="code ">kotlin-stdlib:1.8+</code> from the library that brings it:</p>
<div class="tabs" id="b004ff7f" data-group="build-script" data-anchors="[9a5a07f3,9ab8aca7,b770eb24,60e3b496,b004ff7f]">
<div class="tabs__content" data-gtm="tab" id="9a5a07f3" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">dependencies {
    implementation("com.example:lib:1.0") {
        exclude(group = "org.jetbrains.kotlin", module = "kotlin-stdlib")
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="b770eb24" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">dependencies {
    implementation("com.example:lib:1.0") {
        exclude group: "org.jetbrains.kotlin", module: "kotlin-stdlib"
    }
}
</pre></div>
</div>
</li>
</ul></div>
</div></section></section></section><section class="chapter"><h3 id="set-dependencies-on-test-libraries" data-toc="set-dependencies-on-test-libraries">Set dependencies on test libraries</h3>
<p id="7227f81e">The <a href="https://kotlinlang.org/api/latest/kotlin.test/" id="a4b671cd" data-external="true" rel="noopener noreferrer"><code class="code ">kotlin.test</code></a> API is available for testing Kotlin projects on all supported platforms. Add the dependency <code class="code ">kotlin-test</code> to the <code class="code ">commonTest</code> source set, so that the Gradle plugin can infer the corresponding test dependencies for each test source set:</p>
<ul class="list _bullet" id="327a2972">
<li class="list__item" id="c4faf813"><p><code class="code ">kotlin-test-common</code> and <code class="code ">kotlin-test-annotations-common</code> for common source sets</p></li>
<li class="list__item" id="9c5825df"><p><code class="code ">kotlin-test-junit</code> for JVM source sets</p></li>
<li class="list__item" id="ba7b88a1"><p><code class="code ">kotlin-test-js</code> for Kotlin/JS source sets</p></li>
</ul>
<p id="c27b37bc">Kotlin/Native targets do not require additional test dependencies, and the <code class="code ">kotlin.test</code> API implementations are built-in.</p>
<div class="tabs" id="e8267a1c" data-group="build-script" data-anchors="[c5432cc0,8e73116c,8f380330,ce57ff86,e8267a1c]">
<div class="tabs__content" data-gtm="tab" id="c5432cc0" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    sourceSets {
        val commonTest by getting {
            dependencies {
                implementation(kotlin("test")) // This brings all the platform dependencies automatically
            }
        }
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="8f380330" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    sourceSets {
        commonTest {
            dependencies {
                implementation kotlin("test") // This brings all the platform dependencies automatically
            }
        }
    }
}
</pre></div>
</div>
<aside data-type="note" class="prompt" data-title="" id="ac8c9f2e"><p id="f5bafcb8">You can use shorthand for a dependency on a Kotlin module, for example, kotlin("test") for "org.jetbrains.kotlin:kotlin-test".</p></aside><p id="a42aac96">You can use the <code class="code ">kotlin-test</code> dependency in any shared or platform-specific source set as well.</p>
<p id="3d4e79c7">For Kotlin/JVM, Gradle uses JUnit 4 by default. Therefore, the <code class="code ">kotlin("test")</code> dependency resolves to the variant for JUnit 4, namely <code class="code ">kotlin-test-junit</code>.</p>
<p id="6bfc6ff9">You can choose JUnit 5 or TestNG by calling <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#useJUnitPlatform" id="669c7d39" data-external="true" rel="noopener noreferrer"><code class="code ">useJUnitPlatform()</code></a> or <a href="https://docs.gradle.org/current/javadoc/org/gradle/api/tasks/testing/Test.html#useTestNG" id="511cc1ad" data-external="true" rel="noopener noreferrer"><code class="code ">useTestNG()</code></a> in the test task of your build script. The following example is for a Kotlin Multiplatform project:</p>
<div class="tabs" id="ba37ab51" data-group="build-script" data-anchors="[56d01e30,87b7b1d3,dad0a19f,5aabf1ae,ba37ab51]">
<div class="tabs__content" data-gtm="tab" id="56d01e30" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    jvm {
        testRuns["test"].executionTask.configure {
            useJUnitPlatform()
        }
    }
    sourceSets {
        val commonTest by getting {
            dependencies {
                implementation(kotlin("test"))
            }
        }
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="dad0a19f" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    jvm {
        testRuns["test"].executionTask.configure {
            useJUnitPlatform()
        }
    }
    sourceSets {
        commonTest {
            dependencies {
                implementation kotlin("test")
            }
        }
    }
}
</pre></div>
</div>
<p id="a515a8c0">The following example is for a JVM project:</p>
<div class="tabs" id="9d0681b6" data-group="build-script" data-anchors="[f66ea723,d0914bb7,3f3c1f7a,b15cd416,9d0681b6]">
<div class="tabs__content" data-gtm="tab" id="f66ea723" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">dependencies {
    testImplementation(kotlin("test"))
}

tasks {
    test {
        useTestNG()
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="3f3c1f7a" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">dependencies {
    testImplementation 'org.jetbrains.kotlin:kotlin-test'
}

test {
    useTestNG()
}
</pre></div>
</div>
<p id="2df27fa1"><a href="jvm-test-using-junit.html" id="a1688fce">Learn how to test code using JUnit on the JVM</a>.</p>
<p id="8d5af4e5">If you need to use a different JVM test framework, disable automatic testing framework selection by adding the line <code class="code ">kotlin.test.infer.jvm.variant=false</code> to the project's <code class="code ">gradle.properties</code> file. After doing this, add the framework as a Gradle dependency.</p>
<p id="b55b5bc5">If you have used a variant of <code class="code ">kotlin("test")</code> in your build script explicitly and your project build stopped working with a compatibility conflict, see <a href="compatibility-guide-15.html#do-not-mix-several-jvm-variants-of-kotlin-test-in-a-single-project" id="d74936af">this issue in the Compatibility Guide</a>.</p></section><section class="chapter"><h3 id="set-a-dependency-on-a-kotlinx-library" data-toc="set-a-dependency-on-a-kotlinx-library">Set a dependency on a kotlinx library</h3>
<p id="f91d852c">If you use a <a href="https://github.com/Kotlin/kotlinx.coroutines" id="e1a9d490" data-external="true" rel="noopener noreferrer"><code class="code ">kotlinx</code> library</a> and need a platform-specific dependency, you can use platform-specific variants of libraries with suffixes such as <code class="code ">-jvm</code> or <code class="code ">-js</code>, for example, <code class="code ">kotlinx-coroutines-core-jvm</code>. You can also use the library's base artifact name instead – <code class="code ">kotlinx-coroutines-core</code>.</p>
<div class="tabs" id="d24de7e1" data-group="build-script" data-anchors="[8d6339f1,b0d9291f,7a43f5bb,36b93de2,d24de7e1]">
<div class="tabs__content" data-gtm="tab" id="8d6339f1" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    sourceSets {
        val jvmMain by getting {
            dependencies {
                implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core-jvm:1.7.1")
            }
        }
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="7a43f5bb" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    sourceSets {
        jvmMain {
            dependencies {
                implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core-jvm:1.7.1'
            }
        }
    }
}
</pre></div>
</div>
<p id="4fa40e9c">If you use a multiplatform library and need to depend on the shared code, set the dependency only once, in the shared source set. Use the library's base artifact name, such as <code class="code ">kotlinx-coroutines-core</code> or <code class="code ">ktor-client-core</code>.</p>
<div class="tabs" id="3f14a080" data-group="build-script" data-anchors="[e0c6bea5,7667b55a,804cbadc,2d94fc3e,3f14a080]">
<div class="tabs__content" data-gtm="tab" id="e0c6bea5" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">kotlin {
    sourceSets {
        val commonMain by getting {
            dependencies {
                implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.1")
            }
        }
    }
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="804cbadc" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">kotlin {
    sourceSets {
        commonMain {
            dependencies {
                implementation 'org.jetbrains.kotlinx:kotlinx-coroutines-core:1.7.1'
            }
        }
    }
}
</pre></div>
</div></section><section class="chapter"><h3 id="set-dependencies-at-top-level" data-toc="set-dependencies-at-top-level">Set dependencies at top level</h3>
<p id="9e44f839">Alternatively, you can specify the dependencies at top level, using the following pattern for the configuration names: <code class="code ">&lt;sourceSetName&gt;&lt;DependencyType&gt;</code>. This can be helpful for some Gradle built-in dependencies, like <code class="code ">gradleApi()</code>, <code class="code ">localGroovy()</code>, or <code class="code ">gradleTestKit()</code>, which are not available in the source sets' dependency DSL.</p>
<div class="tabs" id="d83c0253" data-group="build-script" data-anchors="[d89c1afd,8a4315b6,ec9ed873,7555c66a,d83c0253]">
<div class="tabs__content" data-gtm="tab" id="d89c1afd" data-sync-tabs="kotlin" data-title="Kotlin"><pre class="code" data-language="kotlin">dependencies {
    "commonMainImplementation"("com.example:my-library:1.0")
}
</pre></div>
<div class="tabs__content" data-gtm="tab" id="ec9ed873" data-sync-tabs="groovy" data-title="Groovy"><pre class="code" data-language="groovy">dependencies {
    commonMainImplementation 'com.example:my-library:1.0'
}
</pre></div>
</div></section></section><section class="chapter"><h2 id="what-s-next" data-toc="what-s-next">What's next?</h2>
<p id="14597fbc">Learn more about:</p>
<ul class="list _bullet" id="a8072744">
<li class="list__item" id="e25672c5"><p><a href="gradle-compiler-options.html" id="c9416cd1">Compiler options and how to pass them</a>.</p></li>
<li class="list__item" id="4c9e8a72"><p><a href="gradle-compilation-and-caches.html" id="93e85a01">Incremental compilation, caches support, build reports, and the Kotlin daemon</a>.</p></li>
<li class="list__item" id="72049a3c"><p><a href="https://docs.gradle.org/current/userguide/getting_started.html" id="f762819c" data-external="true" rel="noopener noreferrer">Gradle basics and specifics</a>.</p></li>
<li class="list__item" id="f47e89ae"><p><a href="gradle-plugin-variants.html" id="2cff7e77">Support for Gradle plugin variants</a>.</p></li>
</ul></section><div class="last-modified"> Last modified: 14 July 2023</div>

<div class="navigation-links _bottom"> <a class="navigation-links__prev" href="get-started-with-jvm-gradle-project.html">Get started with Gradle and Kotlin/JVM</a> <a class="navigation-links__next" href="gradle-compiler-options.html">Compiler options in the Kotlin Gradle plugin</a> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2023 JetBrains s.r.o. and Kotlin Programming Language contributors<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://kotlinlang.org/docs/gradle-configure-project.html" class="_attribution-link">https://kotlinlang.org/docs/gradle-configure-project.html</a>
  </p>
</div>
