<h1 title="Class HttpResponse.BodySubscribers" class="title">Class HttpResponse.BodySubscribers</h1> <div class="inheritance" title="Inheritance Tree">
<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">java.lang.Object</a> <div class="inheritance">java.net.http.HttpResponse.BodySubscribers</div> </div> <section class="class-description" id="class-description"> <dl class="notes"> <dt>Enclosing interface:</dt> <dd><code><a href="httpresponse" title="interface in java.net.http">HttpResponse</a>&lt;<a href="httpresponse" title="type parameter in HttpResponse">T</a>&gt;</code></dd> </dl>  <pre class="lang-java" data-language="java">public static class HttpResponse.BodySubscribers extends Object</pre> <div class="block">Implementations of <a href="httpresponse.bodysubscriber" title="interface in java.net.http"><code>BodySubscriber</code></a> that implement various useful subscribers, such as converting the response body bytes into a String, or streaming the bytes to a file. <p>The following are examples of using the predefined body subscribers to convert a flow of response body data into common high-level Java objects: </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code>// Streams the response body to a File
HttpResponse&lt;Path&gt; response = client
  .send(request, responseInfo -&gt; BodySubscribers.ofFile(Paths.get("example.html"));</code></pre> </div> <div class="snippet-container"> <pre class="lang-java" data-language="java"><code>// Accumulates the response body and returns it as a byte[]
HttpResponse&lt;byte[]&gt; response = client
  .send(request, responseInfo -&gt; BodySubscribers.ofByteArray());</code></pre> </div> <div class="snippet-container"> <pre class="lang-java" data-language="java"><code>// Discards the response body
HttpResponse&lt;Void&gt; response = client
  .send(request, responseInfo -&gt; BodySubscribers.discarding());</code></pre> </div> <div class="snippet-container"> <pre class="lang-java" data-language="java"><code>// Accumulates the response body as a String then maps it to its bytes
HttpResponse&lt;byte[]&gt; response = client
  .send(request, responseInfo -&gt;
     BodySubscribers.mapping(BodySubscribers.ofString(UTF_8), String::getBytes));</code></pre> </div> </div> <dl class="notes"> <dt>Since:</dt> <dd>11</dd> </dl> </section> <section class="summary"> <section class="method-summary" id="method-summary"> <h2>Method Summary</h2> <div id="method-summary-table">  <div id="method-summary-table.tabpanel" role="tabpanel"> <table class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">                                                    <tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td><code>static &lt;T&gt; <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;T&gt;</wbr></code></td>
<td><code><a href="#buffering(java.net.http.HttpResponse.BodySubscriber,int)" class="member-name-link">buffering</a><wbr>(<a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a>&lt;T&gt; downstream,
 int bufferSize)</wbr></code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which buffers data before delivering it to the given downstream subscriber.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/lang/void.html" title="class in java.lang">Void</a>&gt;</wbr></code></td>
<td><code><a href="#discarding()" class="member-name-link">discarding</a>()</code></td>
<td> <div class="block">Returns a response subscriber which discards the response body.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/lang/void.html" title="class in java.lang">Void</a>&gt;</wbr></code></td>
<td><code><a href="#fromLineSubscriber(java.util.concurrent.Flow.Subscriber)" class="member-name-link">fromLineSubscriber</a><wbr>(<a href="../../../../java.base/java/util/concurrent/flow.subscriber.html" title="interface in java.util.concurrent">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a>&gt; subscriber)</wbr></code></td>
<td> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line.</div> </td>
</tr>
<tr>
<td><code>static &lt;S extends <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html" title="interface in java.util.concurrent">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a>&gt;,<wbr>
T&gt;<br><a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;T&gt;</wbr></wbr></code></td>
<td><code><a href="#fromLineSubscriber(S,java.util.function.Function,java.nio.charset.Charset,java.lang.String)" class="member-name-link">fromLineSubscriber</a><wbr>(S subscriber,
 <a href="../../../../java.base/java/util/function/function.html" title="interface in java.util.function">Function</a>&lt;? super S,<wbr>? extends T&gt; finisher,
 <a href="../../../../java.base/java/nio/charset/charset.html" title="class in java.nio.charset">Charset</a> charset,
 <a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a> lineSeparator)</wbr></wbr></code></td>
<td> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/lang/void.html" title="class in java.lang">Void</a>&gt;</wbr></code></td>
<td><code><a href="#fromSubscriber(java.util.concurrent.Flow.Subscriber)" class="member-name-link">fromSubscriber</a><wbr>(<a href="../../../../java.base/java/util/concurrent/flow.subscriber.html" title="interface in java.util.concurrent">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/util/list.html" title="interface in java.util">List</a>&lt;<a href="../../../../java.base/java/nio/bytebuffer.html" title="class in java.nio">ByteBuffer</a>&gt;&gt; subscriber)</wbr></code></td>
<td> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>.</div> </td>
</tr>
<tr>
<td><code>static &lt;S extends <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html" title="interface in java.util.concurrent">Flow.Subscriber</a>&lt;? super <a href="../../../../java.base/java/util/list.html" title="interface in java.util">List</a>&lt;<a href="../../../../java.base/java/nio/bytebuffer.html" title="class in java.nio">ByteBuffer</a>&gt;&gt;,<wbr>
T&gt;<br><a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;T&gt;</wbr></wbr></code></td>
<td><code><a href="#fromSubscriber(S,java.util.function.Function)" class="member-name-link">fromSubscriber</a><wbr>(S subscriber,
 <a href="../../../../java.base/java/util/function/function.html" title="interface in java.util.function">Function</a>&lt;? super S,<wbr>? extends T&gt; finisher)</wbr></wbr></code></td>
<td> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>.</div> </td>
</tr>
<tr>
<td><code>static &lt;T,<wbr>
U&gt; <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;U&gt;</wbr></wbr></code></td>
<td><code><a href="#mapping(java.net.http.HttpResponse.BodySubscriber,java.util.function.Function)" class="member-name-link">mapping</a><wbr>(<a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a>&lt;T&gt; upstream,
 <a href="../../../../java.base/java/util/function/function.html" title="interface in java.util.function">Function</a>&lt;? super T,<wbr>? extends U&gt; mapper)</wbr></wbr></code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> whose response body value is that of the result of applying the given function to the body object of the given <code>upstream</code> <code>BodySubscriber</code>.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;byte[]&gt;</wbr></code></td>
<td><code><a href="#ofByteArray()" class="member-name-link">ofByteArray</a>()</code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which stores the response body as a byte array.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/lang/void.html" title="class in java.lang">Void</a>&gt;</wbr></code></td>
<td><code><a href="#ofByteArrayConsumer(java.util.function.Consumer)" class="member-name-link">ofByteArrayConsumer</a><wbr>(<a href="../../../../java.base/java/util/function/consumer.html" title="interface in java.util.function">Consumer</a>&lt;<a href="../../../../java.base/java/util/optional.html" title="class in java.util">Optional</a>&lt;byte[]&gt;&gt; consumer)</wbr></code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which provides the incoming body data to the provided Consumer of <code>Optional&lt;byte[]&gt;</code>.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/nio/file/path.html" title="interface in java.nio.file">Path</a>&gt;</wbr></code></td>
<td><code><a href="#ofFile(java.nio.file.Path)" class="member-name-link">ofFile</a><wbr>(<a href="../../../../java.base/java/nio/file/path.html" title="interface in java.nio.file">Path</a> file)</wbr></code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given name.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/nio/file/path.html" title="interface in java.nio.file">Path</a>&gt;</wbr></code></td>
<td><code><a href="#ofFile(java.nio.file.Path,java.nio.file.OpenOption...)" class="member-name-link">ofFile</a><wbr>(<a href="../../../../java.base/java/nio/file/path.html" title="interface in java.nio.file">Path</a> file,
 <a href="../../../../java.base/java/nio/file/openoption.html" title="interface in java.nio.file">OpenOption</a>... openOptions)</wbr></code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given options and name.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/io/inputstream.html" title="class in java.io">InputStream</a>&gt;</wbr></code></td>
<td><code><a href="#ofInputStream()" class="member-name-link">ofInputStream</a>()</code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which streams the response body as an <a href="../../../../java.base/java/io/inputstream.html" title="class in java.io"><code>InputStream</code></a>.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/util/stream/stream.html" title="interface in java.util.stream">Stream</a>&lt;<a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a>&gt;&gt;</wbr></code></td>
<td><code><a href="#ofLines(java.nio.charset.Charset)" class="member-name-link">ofLines</a><wbr>(<a href="../../../../java.base/java/nio/charset/charset.html" title="class in java.nio.charset">Charset</a> charset)</wbr></code></td>
<td> <div class="block">Returns a <code>BodySubscriber</code> which streams the response body as a <a href="../../../../java.base/java/util/stream/stream.html" title="interface in java.util.stream"><code>Stream</code></a><code>&lt;String&gt;</code>, where each string in the stream corresponds to a line as defined by <a href="../../../../java.base/java/io/bufferedreader.html#lines()"><code>BufferedReader.lines()</code></a>.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/util/concurrent/flow.publisher.html" title="interface in java.util.concurrent">Flow.Publisher</a>&lt;<a href="../../../../java.base/java/util/list.html" title="interface in java.util">List</a>&lt;<a href="../../../../java.base/java/nio/bytebuffer.html" title="class in java.nio">ByteBuffer</a>&gt;&gt;&gt;</wbr></code></td>
<td><code><a href="#ofPublisher()" class="member-name-link">ofPublisher</a>()</code></td>
<td> <div class="block">Returns a response subscriber which publishes the response body through a <code>Publisher&lt;List&lt;ByteBuffer&gt;&gt;</code>.</div> </td>
</tr>
<tr>
<td><code>static <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;<a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a>&gt;</wbr></code></td>
<td><code><a href="#ofString(java.nio.charset.Charset)" class="member-name-link">ofString</a><wbr>(<a href="../../../../java.base/java/nio/charset/charset.html" title="class in java.nio.charset">Charset</a> charset)</wbr></code></td>
<td> <div class="block">Returns a body subscriber which stores the response body as a <code>
 String</code> converted using the given <code>Charset</code>.</div> </td>
</tr>
<tr>
<td><code>static &lt;U&gt; <a href="httpresponse.bodysubscriber" title="interface in java.net.http">HttpResponse.BodySubscriber</a><wbr>&lt;U&gt;</wbr></code></td>
<td><code><a href="#replacing(U)" class="member-name-link">replacing</a><wbr>(U value)</wbr></code></td>
<td> <div class="block">Returns a response subscriber which discards the response body.</div> </td>
</tr>
</table> </div> </div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class java.lang.<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">Object</a>
</h3> <code><a href="../../../../java.base/java/lang/object.html#clone()">clone</a>, <a href="../../../../java.base/java/lang/object.html#equals(java.lang.Object)">equals</a>, <a href="../../../../java.base/java/lang/object.html#finalize()">finalize</a>, <a href="../../../../java.base/java/lang/object.html#getClass()">getClass</a>, <a href="../../../../java.base/java/lang/object.html#hashCode()">hashCode</a>, <a href="../../../../java.base/java/lang/object.html#notify()">notify</a>, <a href="../../../../java.base/java/lang/object.html#notifyAll()">notifyAll</a>, <a href="../../../../java.base/java/lang/object.html#toString()">toString</a>, <a href="../../../../java.base/java/lang/object.html#wait()">wait</a>, <a href="../../../../java.base/java/lang/object.html#wait(long)">wait</a>, <a href="../../../../java.base/java/lang/object.html#wait(long,int)">wait</a></code>
</div> </section> </section> <section class="details"> <section class="method-details" id="method-detail"> <h2>Method Details</h2>  </section><section class="detail" id="fromSubscriber(java.util.concurrent.Flow.Subscriber)"> <h3>fromSubscriber</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; fromSubscriber(Flow.Subscriber&lt;? super List&lt;ByteBuffer&gt;&gt; subscriber)</pre> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked.</div> <dl class="notes"> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl> </section><section class="detail" id="fromSubscriber(S,java.util.function.Function)"> <h3 id="fromSubscriber(java.util.concurrent.Flow.Subscriber,java.util.function.Function)">fromSubscriber</h3> <pre class="lang-java" data-language="java">public static &lt;S extends Flow.Subscriber&lt;? super List&lt;ByteBuffer&gt;&gt;, T&gt; HttpResponse.BodySubscriber&lt;T&gt; fromSubscriber(S subscriber, Function&lt;? super S,? extends T&gt; finisher)</pre> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked. <p> The given <code>finisher</code> function is applied after the given subscriber's <code>onComplete</code> has been invoked. The <code>finisher</code> function is invoked with the given subscriber, and returns a value that is set as the response's body.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Type Parameters:</dt> <dd>
<code>S</code> - the type of the Subscriber</dd> <dd>
<code>T</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dd>
<code>finisher</code> - a function to be applied after the subscriber has completed</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl> </section><section class="detail" id="fromLineSubscriber(java.util.concurrent.Flow.Subscriber)"> <h3>fromLineSubscriber</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; fromLineSubscriber(Flow.Subscriber&lt;? super String&gt; subscriber)</pre> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked. Bytes are decoded using the <a href="../../../../java.base/java/nio/charset/standardcharsets.html#UTF_8"><code>UTF-8</code></a> charset, and lines are delimited in the manner of <a href="../../../../java.base/java/io/bufferedreader.html#readLine()"><code>BufferedReader.readLine()</code></a>.</div> <dl class="notes"> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Implementation Note:</dt> <dd>This is equivalent to calling <div class="snippet-container"> <pre class="lang-java" data-language="java"><code>fromLineSubscriber(subscriber, s -&gt; null, StandardCharsets.UTF_8, null)</code></pre> </div> </dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl> </section><section class="detail" id="fromLineSubscriber(S,java.util.function.Function,java.nio.charset.Charset,java.lang.String)"> <h3 id="fromLineSubscriber(java.util.concurrent.Flow.Subscriber,java.util.function.Function,java.nio.charset.Charset,java.lang.String)">fromLineSubscriber</h3> <pre class="lang-java" data-language="java">public static &lt;S extends Flow.Subscriber&lt;? super String&gt;, T&gt; HttpResponse.BodySubscriber&lt;T&gt; fromLineSubscriber(S subscriber, Function&lt;? super S,? extends T&gt; finisher, Charset charset, String lineSeparator)</pre> <div class="block">Returns a body subscriber that forwards all response body to the given <code>Flow.Subscriber</code>, line by line. The <a href="httpresponse.bodysubscriber#getBody()">completion stage</a> of the returned body subscriber completes after one of the given subscribers <code>onComplete</code> or <code>onError</code> has been invoked. <p> The given <code>finisher</code> function is applied after the given subscriber's <code>onComplete</code> has been invoked. The <code>finisher</code> function is invoked with the given subscriber, and returns a value that is set as the response's body.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>This method can be used as an adapter between <code>
 BodySubscriber</code> and <code>Flow.Subscriber</code>.</dd> <dt>Type Parameters:</dt> <dd>
<code>S</code> - the type of the Subscriber</dd> <dd>
<code>T</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>subscriber</code> - the subscriber</dd> <dd>
<code>finisher</code> - a function to be applied after the subscriber has completed</dd> <dd>
<code>charset</code> - a <a href="../../../../java.base/java/nio/charset/charset.html" title="class in java.nio.charset"><code>Charset</code></a> to decode the bytes</dd> <dd>
<code>lineSeparator</code> - an optional line separator: can be <code>null</code>, in which case lines will be delimited in the manner of <a href="../../../../java.base/java/io/bufferedreader.html#readLine()"><code>BufferedReader.readLine()</code></a>.</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if the supplied <code>lineSeparator</code> is the empty string</dd> </dl> </section><section class="detail" id="ofString(java.nio.charset.Charset)"> <h3>ofString</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;String&gt; ofString(Charset charset)</pre> <div class="block">Returns a body subscriber which stores the response body as a <code>
 String</code> converted using the given <code>Charset</code>. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>charset</code> - the character set to convert the String with</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl> </section><section class="detail" id="ofByteArray()"> <h3>ofByteArray</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;byte[]&gt; ofByteArray()</pre> <div class="block">Returns a <code>BodySubscriber</code> which stores the response body as a byte array. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read.</p>
</div> <dl class="notes"> <dt>Returns:</dt> <dd>a body subscriber</dd> </dl> </section><section class="detail" id="ofFile(java.nio.file.Path,java.nio.file.OpenOption...)"> <h3>ofFile</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Path&gt; ofFile(Path file, OpenOption... openOptions)</pre> <div class="block">Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given options and name. The file will be opened with the given options using <a href="../../../../java.base/java/nio/channels/filechannel.html#open(java.nio.file.Path,java.nio.file.OpenOption...)"><code>FileChannel.open</code></a> just before the body is read. Any exception thrown will be returned or thrown from <a href="httpclient#send(java.net.http.HttpRequest,java.net.http.HttpResponse.BodyHandler)"><code>HttpClient::send</code></a> or <a href="httpclient#sendAsync(java.net.http.HttpRequest,java.net.http.HttpResponse.BodyHandler)"><code>HttpClient::sendAsync</code></a> as appropriate. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read. </p>
<p> In the case of the default file system provider, security manager permission checks are performed in this factory method, when the <code>BodySubscriber</code> is created. Otherwise, <a href="../../../../java.base/java/nio/channels/filechannel.html#open(java.nio.file.Path,java.nio.file.OpenOption...)">permission checks</a> may be performed asynchronously against the caller's context at file access time. Care must be taken that the <code>BodySubscriber</code> is not shared with untrusted code.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>file</code> - the file to store the body in</dd> <dd>
<code>openOptions</code> - the list of options to open the file with</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if an invalid set of open options are specified</dd> <dd>
<code><a href="../../../../java.base/java/lang/securityexception.html" title="class in java.lang">SecurityException</a></code> - in the case of the default file system provider, and a security manager is installed, <a href="../../../../java.base/java/lang/securitymanager.html#checkWrite(java.lang.String)"><code>checkWrite</code></a> is invoked to check write access to the given file</dd> </dl> </section><section class="detail" id="ofFile(java.nio.file.Path)"> <h3>ofFile</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Path&gt; ofFile(Path file)</pre> <div class="block">Returns a <code>BodySubscriber</code> which stores the response body in a file opened with the given name. <p> Equivalent to: <code>ofFile(file, CREATE, WRITE)</code> </p>
<p> In the case of the default file system provider, security manager permission checks are performed in this factory method, when the <code>BodySubscriber</code> is created. Otherwise, <a href="../../../../java.base/java/nio/channels/filechannel.html#open(java.nio.file.Path,java.nio.file.OpenOption...)">permission checks</a> may be performed asynchronously against the caller's context at file access time. Care must be taken that the <code>BodySubscriber</code> is not shared with untrusted code.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>file</code> - the file to store the body in</dd> <dt>Returns:</dt> <dd>a body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/securityexception.html" title="class in java.lang">SecurityException</a></code> - in the case of the default file system provider, and a security manager is installed, <a href="../../../../java.base/java/lang/securitymanager.html#checkWrite(java.lang.String)"><code>checkWrite</code></a> is invoked to check write access to the given file</dd> </dl> </section><section class="detail" id="ofByteArrayConsumer(java.util.function.Consumer)"> <h3>ofByteArrayConsumer</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; ofByteArrayConsumer(Consumer&lt;Optional&lt;byte[]&gt;&gt; consumer)</pre> <div class="block">Returns a <code>BodySubscriber</code> which provides the incoming body data to the provided Consumer of <code>Optional&lt;byte[]&gt;</code>. Each call to <a href="../../../../java.base/java/util/function/consumer.html#accept(T)"><code>Consumer.accept()</code></a> will contain a non empty <code>Optional</code>, except for the final invocation after all body data has been read, when the <code>
 Optional</code> will be empty. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available after the entire response has been read.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>This subscriber is not flow controlled. Therefore, the supplied consumer must be able to process whatever amount of data is delivered in a timely fashion.</dd> <dt>Parameters:</dt> <dd>
<code>consumer</code> - a Consumer of byte arrays</dd> <dt>Returns:</dt> <dd>a BodySubscriber</dd> </dl> </section><section class="detail" id="ofInputStream()"> <h3>ofInputStream</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;InputStream&gt; ofInputStream()</pre> <div class="block">Returns a <code>BodySubscriber</code> which streams the response body as an <a href="../../../../java.base/java/io/inputstream.html" title="class in java.io"><code>InputStream</code></a>. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available immediately after the response headers have been read, without requiring to wait for the entire body to be processed. The response body can then be read directly from the <a href="../../../../java.base/java/io/inputstream.html" title="class in java.io"><code>InputStream</code></a>.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>To ensure that all resources associated with the corresponding exchange are properly released the caller must ensure to either read all bytes until EOF is reached, or call <a href="../../../../java.base/java/io/inputstream.html#close()"><code>InputStream.close()</code></a> if it is unable or unwilling to do so. Calling <code>close</code> before exhausting the stream may cause the underlying HTTP connection to be closed and prevent it from being reused for subsequent operations.</dd> <dt>Implementation Note:</dt> <dd>The <code>read</code> method of the <code>InputStream</code> returned by the default implementation of this method will throw an <code>IOException</code> with the <a href="../../../../java.base/java/lang/thread.html#isInterrupted()">thread interrupt status set</a> if the thread is interrupted while blocking on read. In that case, the request will also be cancelled and the <code>InputStream</code> will be closed.</dd> <dt>Returns:</dt> <dd>a body subscriber that streams the response body as an <a href="../../../../java.base/java/io/inputstream.html" title="class in java.io"><code>InputStream</code></a>.</dd> </dl> </section><section class="detail" id="ofLines(java.nio.charset.Charset)"> <h3>ofLines</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Stream&lt;String&gt;&gt; ofLines(Charset charset)</pre> <div class="block">Returns a <code>BodySubscriber</code> which streams the response body as a <a href="../../../../java.base/java/util/stream/stream.html" title="interface in java.util.stream"><code>Stream</code></a><code>&lt;String&gt;</code>, where each string in the stream corresponds to a line as defined by <a href="../../../../java.base/java/io/bufferedreader.html#lines()"><code>BufferedReader.lines()</code></a>. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available immediately after the response headers have been read, without requiring to wait for the entire body to be processed. The response body can then be read directly from the <a href="../../../../java.base/java/util/stream/stream.html" title="interface in java.util.stream"><code>Stream</code></a>.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>To ensure that all resources associated with the corresponding exchange are properly released the caller must ensure to either read all lines until the stream is exhausted, or call <a href="../../../../java.base/java/util/stream/basestream.html#close()"><code>BaseStream.close()</code></a> if it is unable or unwilling to do so. Calling <code>close</code> before exhausting the stream may cause the underlying HTTP connection to be closed and prevent it from being reused for subsequent operations.</dd> <dt>Parameters:</dt> <dd>
<code>charset</code> - the character set to use when converting bytes to characters</dd> <dt>Returns:</dt> <dd>a body subscriber that streams the response body as a <a href="../../../../java.base/java/util/stream/stream.html" title="interface in java.util.stream"><code>Stream</code></a><code>&lt;String&gt;</code>.</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="../../../../java.base/java/io/bufferedreader.html#lines()"><code>BufferedReader.lines()</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="ofPublisher()"> <h3>ofPublisher</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Flow.Publisher&lt;List&lt;ByteBuffer&gt;&gt;&gt; ofPublisher()</pre> <div class="block">Returns a response subscriber which publishes the response body through a <code>Publisher&lt;List&lt;ByteBuffer&gt;&gt;</code>. <p> The <a href="httpresponse" title="interface in java.net.http"><code>HttpResponse</code></a> using this subscriber is available immediately after the response headers have been read, without requiring to wait for the entire body to be processed. The response body bytes can then be obtained by subscribing to the publisher returned by the <code>HttpResponse</code> <a href="httpresponse#body()"><code>body</code></a> method. </p>
<p>The publisher returned by the <a href="httpresponse#body()"><code>body</code></a> method can be subscribed to only once. The first subscriber will receive the body response bytes if successfully subscribed, or will cause the subscription to be cancelled otherwise. If more subscriptions are attempted, the subsequent subscribers will be immediately subscribed with an empty subscription and their <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html#onError(java.lang.Throwable)"><code>onError</code></a> method will be invoked with an <code>IllegalStateException</code>.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>To ensure that all resources associated with the corresponding exchange are properly released the caller must ensure that the provided publisher is subscribed once, and either <a href="../../../../java.base/java/util/concurrent/flow.subscription.html#request(long)">requests</a> all bytes until <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html#onComplete()"><code>onComplete</code></a> or <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html#onError(java.lang.Throwable)"><code>onError</code></a> are invoked, or cancel the provided <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html#onSubscribe(java.util.concurrent.Flow.Subscription)">subscription</a> if it is unable or unwilling to do so. Note that depending on the actual HTTP protocol <a href="httpclient.version" title="enum class in java.net.http">version</a> used for the exchange, cancelling the subscription instead of exhausting the flow may cause the underlying HTTP connection to be closed and prevent it from being reused for subsequent operations.</dd> <dt>Returns:</dt> <dd>A <code>BodySubscriber</code> which publishes the response body through a <code>Publisher&lt;List&lt;ByteBuffer&gt;&gt;</code>.</dd> </dl> </section><section class="detail" id="replacing(U)"> <h3 id="replacing(java.lang.Object)">replacing</h3> <pre class="lang-java" data-language="java">public static &lt;U&gt; HttpResponse.BodySubscriber&lt;U&gt; replacing(U value)</pre> <div class="block">Returns a response subscriber which discards the response body. The supplied value is the value that will be returned from <a href="httpresponse#body()"><code>HttpResponse.body()</code></a>.</div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>U</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>value</code> - the value to return from HttpResponse.body(), may be <code>null</code>
</dd> <dt>Returns:</dt> <dd>a <code>BodySubscriber</code>
</dd> </dl> </section><section class="detail" id="discarding()"> <h3>discarding</h3> <pre class="lang-java" data-language="java">public static HttpResponse.BodySubscriber&lt;Void&gt; discarding()</pre> <div class="block">Returns a response subscriber which discards the response body.</div> <dl class="notes"> <dt>Returns:</dt> <dd>a response body subscriber</dd> </dl> </section><section class="detail" id="buffering(java.net.http.HttpResponse.BodySubscriber,int)"> <h3>buffering</h3> <pre class="lang-java" data-language="java">public static &lt;T&gt; HttpResponse.BodySubscriber&lt;T&gt; buffering(HttpResponse.BodySubscriber&lt;T&gt; downstream, int bufferSize)</pre> <div class="block">Returns a <code>BodySubscriber</code> which buffers data before delivering it to the given downstream subscriber. The subscriber guarantees to deliver <code>bufferSize</code> bytes of data to each invocation of the downstream's <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html#onNext(T)"><code>onNext</code></a> method, except for the final invocation, just before <a href="../../../../java.base/java/util/concurrent/flow.subscriber.html#onComplete()"><code>onComplete</code></a> is invoked. The final invocation of <code>onNext</code> may contain fewer than <code>bufferSize</code> bytes. <p> The returned subscriber delegates its <a href="httpresponse.bodysubscriber#getBody()"><code>getBody()</code></a> method to the downstream subscriber.</p>
</div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the type of the response body</dd> <dt>Parameters:</dt> <dd>
<code>downstream</code> - the downstream subscriber</dd> <dd>
<code>bufferSize</code> - the buffer size</dd> <dt>Returns:</dt> <dd>a buffering body subscriber</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if <code>bufferSize &lt;= 0</code>
</dd> </dl> </section><section class="detail" id="mapping(java.net.http.HttpResponse.BodySubscriber,java.util.function.Function)"> <h3>mapping</h3> <pre class="lang-java" data-language="java">public static &lt;T, U&gt; HttpResponse.BodySubscriber&lt;U&gt; mapping(HttpResponse.BodySubscriber&lt;T&gt; upstream, Function&lt;? super T,? extends U&gt; mapper)</pre> <div class="block">Returns a <code>BodySubscriber</code> whose response body value is that of the result of applying the given function to the body object of the given <code>upstream</code> <code>BodySubscriber</code>. <p> The mapping function is executed using the client's <a href="httpclient#executor()">executor</a>, and can therefore be used to map any response body type, including blocking <a href="../../../../java.base/java/io/inputstream.html" title="class in java.io"><code>InputStream</code></a>. However, performing any blocking operation in the mapper function runs the risk of blocking the executor's thread for an unknown amount of time (at least until the blocking operation finishes), which may end up starving the executor of available threads. Therefore, in the case where mapping to the desired type might block (e.g. by reading on the <code>InputStream</code>), then mapping to a <a href="../../../../java.base/java/util/function/supplier.html" title="interface in java.util.function"><code>Supplier</code></a> of the desired type and deferring the blocking operation until <a href="../../../../java.base/java/util/function/supplier.html#get()"><code>Supplier::get</code></a> is invoked by the caller's thread should be preferred, as shown in the following example which uses a well-known JSON parser to convert an <code>InputStream</code> into any annotated Java type. </p>
<p>For example: </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code> public static &lt;W&gt; BodySubscriber&lt;Supplier&lt;W&gt;&gt; asJSON(Class&lt;W&gt; targetType) {
   BodySubscriber&lt;InputStream&gt; upstream = BodySubscribers.ofInputStream();

   BodySubscriber&lt;Supplier&lt;W&gt;&gt; downstream = BodySubscribers.mapping(
         upstream,
         (InputStream is) -&gt; () -&gt; {
             try (InputStream stream = is) {
                 ObjectMapper objectMapper = new ObjectMapper();
                 return objectMapper.readValue(stream, targetType);
             } catch (IOException e) {
                 throw new UncheckedIOException(e);
             }
         });
  return downstream;
}</code></pre> </div> </div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>T</code> - the upstream body type</dd> <dd>
<code>U</code> - the type of the body subscriber returned</dd> <dt>Parameters:</dt> <dd>
<code>upstream</code> - the body subscriber to be mapped</dd> <dd>
<code>mapper</code> - the mapping function</dd> <dt>Returns:</dt> <dd>a mapping body subscriber</dd> </dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2023, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.net.http/java/net/http/HttpResponse.BodySubscribers.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/21/docs/api/java.net.http/java/net/http/HttpResponse.BodySubscribers.html</a>
  </p>
</div>
