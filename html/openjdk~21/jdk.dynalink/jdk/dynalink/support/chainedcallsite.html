<h1 title="Class ChainedCallSite" class="title">Class ChainedCallSite</h1> <div class="inheritance" title="Inheritance Tree">
<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">java.lang.Object</a> <div class="inheritance">
<a href="../../../../java.base/java/lang/invoke/callsite.html" title="class in java.lang.invoke">java.lang.invoke.CallSite</a> <div class="inheritance">
<a href="../../../../java.base/java/lang/invoke/mutablecallsite.html" title="class in java.lang.invoke">java.lang.invoke.MutableCallSite</a> <div class="inheritance">
<a href="abstractrelinkablecallsite.html" title="class in jdk.dynalink.support">jdk.dynalink.support.AbstractRelinkableCallSite</a> <div class="inheritance">jdk.dynalink.support.ChainedCallSite</div> </div> </div> </div> </div> <section class="class-description" id="class-description"> <dl class="notes"> <dt>All Implemented Interfaces:</dt> <dd><code><a href="../relinkablecallsite.html" title="interface in jdk.dynalink">RelinkableCallSite</a></code></dd> </dl>  <pre class="lang-java" data-language="java">public class ChainedCallSite extends AbstractRelinkableCallSite</pre> <div class="block">A relinkable call site that implements a polymorphic inline caching strategy. It remembers up to 8 <a href="../linker/guardedinvocation.html" title="class in jdk.dynalink.linker"><code>GuardedInvocation</code></a>s it was linked with, and on each relink request builds a cascading chain of method handles of one invocation falling back to the next one. The number of remembered invocations can be customized by overriding <a href="#getMaxChainLength()"><code>getMaxChainLength()</code></a> in a subclass. When this call site is relinked with a new invocation and the length of the chain is already at the maximum, it will throw away the oldest invocation. Invocations with invalidated switch points and ones for which their invalidating exception triggered are removed eagerly from the chain. The invocations are never reordered; the most recently linked method handle is always at the start of the chain and the least recently linked at its end. The call site can be safely relinked on more than one thread concurrently. Race conditions in linking are resolved by throwing away the <a href="../linker/guardedinvocation.html" title="class in jdk.dynalink.linker"><code>GuardedInvocation</code></a> produced on the losing thread without incorporating it into the chain, so it can lead to repeated linking for the same arguments.</div> </section> <section class="summary"> <section class="constructor-summary" id="constructor-summary"> <h2>Constructor Summary</h2>  <table class="summary-table two-column-summary">     <tr>
<th>Constructor</th>
<th>Description</th>
</tr>
<tr>
<td><code><a href="#%3Cinit%3E(jdk.dynalink.CallSiteDescriptor)" class="member-name-link">ChainedCallSite</a><wbr>(<a href="../callsitedescriptor.html" title="class in jdk.dynalink">CallSiteDescriptor</a> descriptor)</wbr></code></td>
<td> <div class="block">Creates a new chained call site.</div> </td>
</tr>
</table> </section><section class="method-summary" id="method-summary"> <h2>Method Summary</h2> <div id="method-summary-table">  <div id="method-summary-table.tabpanel" role="tabpanel"> <table class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">             <tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td><code>protected int</code></td>
<td><code><a href="#getMaxChainLength()" class="member-name-link">getMaxChainLength</a>()</code></td>
<td> <div class="block">The maximum number of method handles in the chain.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)" class="member-name-link">relink</a><wbr>(<a href="../linker/guardedinvocation.html" title="class in jdk.dynalink.linker">GuardedInvocation</a> guardedInvocation,
 <a href="../../../../java.base/java/lang/invoke/methodhandle.html" title="class in java.lang.invoke">MethodHandle</a> relinkAndInvoke)</wbr></code></td>
<td> <div class="block">This method will be called by the dynamic linker every time the call site is relinked (but see <a href="../relinkablecallsite.html#resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.resetAndRelink(GuardedInvocation, MethodHandle)</code></a> for an exception).</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)" class="member-name-link">resetAndRelink</a><wbr>(<a href="../linker/guardedinvocation.html" title="class in jdk.dynalink.linker">GuardedInvocation</a> guardedInvocation,
 <a href="../../../../java.base/java/lang/invoke/methodhandle.html" title="class in java.lang.invoke">MethodHandle</a> relinkAndInvoke)</wbr></code></td>
<td> <div class="block">This method will be called by the dynamic linker every time the call site is relinked <b>and</b> the linker wishes the call site to throw away any prior linkage state (that is how it differs from <a href="../relinkablecallsite.html#relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.relink(GuardedInvocation, MethodHandle)</code></a>).</div> </td>
</tr>
</table> </div> </div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-jdk.dynalink.support.AbstractRelinkableCallSite">Methods declared in class jdk.dynalink.support.<a href="abstractrelinkablecallsite.html" title="class in jdk.dynalink.support">AbstractRelinkableCallSite</a>
</h3> <code><a href="abstractrelinkablecallsite.html#getDescriptor()">getDescriptor</a>, <a href="abstractrelinkablecallsite.html#initialize(java.lang.invoke.MethodHandle)">initialize</a></code>
</div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.invoke.MutableCallSite">Methods declared in class java.lang.invoke.<a href="../../../../java.base/java/lang/invoke/mutablecallsite.html" title="class in java.lang.invoke">MutableCallSite</a>
</h3> <code><a href="../../../../java.base/java/lang/invoke/mutablecallsite.html#dynamicInvoker()">dynamicInvoker</a>, <a href="../../../../java.base/java/lang/invoke/mutablecallsite.html#getTarget()">getTarget</a>, <a href="../../../../java.base/java/lang/invoke/mutablecallsite.html#setTarget(java.lang.invoke.MethodHandle)">setTarget</a>, <a href="../../../../java.base/java/lang/invoke/mutablecallsite.html#syncAll(java.lang.invoke.MutableCallSite%5B%5D)">syncAll</a></code>
</div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.invoke.CallSite">Methods declared in class java.lang.invoke.<a href="../../../../java.base/java/lang/invoke/callsite.html" title="class in java.lang.invoke">CallSite</a>
</h3> <code><a href="../../../../java.base/java/lang/invoke/callsite.html#type()">type</a></code>
</div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class java.lang.<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">Object</a>
</h3> <code><a href="../../../../java.base/java/lang/object.html#clone()">clone</a>, <a href="../../../../java.base/java/lang/object.html#equals(java.lang.Object)">equals</a>, <a href="../../../../java.base/java/lang/object.html#finalize()">finalize</a>, <a href="../../../../java.base/java/lang/object.html#getClass()">getClass</a>, <a href="../../../../java.base/java/lang/object.html#hashCode()">hashCode</a>, <a href="../../../../java.base/java/lang/object.html#notify()">notify</a>, <a href="../../../../java.base/java/lang/object.html#notifyAll()">notifyAll</a>, <a href="../../../../java.base/java/lang/object.html#toString()">toString</a>, <a href="../../../../java.base/java/lang/object.html#wait()">wait</a>, <a href="../../../../java.base/java/lang/object.html#wait(long)">wait</a>, <a href="../../../../java.base/java/lang/object.html#wait(long,int)">wait</a></code>
</div> </section> </section> <section class="details"> <section class="constructor-details" id="constructor-detail"> <h2>Constructor Details</h2>  </section><section class="detail" id="&lt;init&gt;(jdk.dynalink.CallSiteDescriptor)"> <h3>ChainedCallSite</h3> <pre class="lang-java" data-language="java">public ChainedCallSite(CallSiteDescriptor descriptor)</pre> <div class="block">Creates a new chained call site.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>descriptor</code> - the descriptor for the call site.</dd> </dl> </section><section class="method-details" id="method-detail"> <h2>Method Details</h2>  </section><section class="detail" id="getMaxChainLength()"> <h3>getMaxChainLength</h3> <pre class="lang-java" data-language="java">protected int getMaxChainLength()</pre> <div class="block">The maximum number of method handles in the chain. Defaults to 8. You can override it in a subclass if you need to change the value.</div> <dl class="notes"> <dt>Returns:</dt> <dd>the maximum number of method handles in the chain. The return value is checked, and if your override returns a value less than 1, a <a href="../../../../java.base/java/lang/runtimeexception.html" title="class in java.lang"><code>RuntimeException</code></a> will be thrown.</dd> </dl> </section><section class="detail" id="relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"> <h3>relink</h3> <pre class="lang-java" data-language="java">public void relink(GuardedInvocation guardedInvocation, MethodHandle relinkAndInvoke)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="../relinkablecallsite.html#relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)">RelinkableCallSite</a></code></span></div> <div class="block">This method will be called by the dynamic linker every time the call site is relinked (but see <a href="../relinkablecallsite.html#resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.resetAndRelink(GuardedInvocation, MethodHandle)</code></a> for an exception). It will be passed a <code>GuardedInvocation</code> that the call site should incorporate into its target method handle. When this method is called, the call site is allowed to keep other non-invalidated invocations around for implementation of polymorphic inline caches and compose them with this invocation to form its final target.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>guardedInvocation</code> - the guarded invocation that the call site should incorporate into its target method handle.</dd> <dd>
<code>relinkAndInvoke</code> - a relink-and-invoke method handle. This is a method handle matching the method type of the call site that is supplied by the <a href="../dynamiclinker.html" title="class in jdk.dynalink"><code>DynamicLinker</code></a> as a callback. It should be used by this call site as the ultimate fallback when it can't invoke its target with the passed arguments. The fallback method is such that when it's invoked, it'll try to obtain an adequate target <a href="../linker/guardedinvocation.html" title="class in jdk.dynalink.linker"><code>GuardedInvocation</code></a> for the invocation, and subsequently invoke <a href="../relinkablecallsite.html#relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.relink(GuardedInvocation, MethodHandle)</code></a> or <a href="../relinkablecallsite.html#resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.resetAndRelink(GuardedInvocation, MethodHandle)</code></a>, and finally invoke the target.</dd> </dl> </section><section class="detail" id="resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"> <h3>resetAndRelink</h3> <pre class="lang-java" data-language="java">public void resetAndRelink(GuardedInvocation guardedInvocation, MethodHandle relinkAndInvoke)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="../relinkablecallsite.html#resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)">RelinkableCallSite</a></code></span></div> <div class="block">This method will be called by the dynamic linker every time the call site is relinked <b>and</b> the linker wishes the call site to throw away any prior linkage state (that is how it differs from <a href="../relinkablecallsite.html#relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.relink(GuardedInvocation, MethodHandle)</code></a>). It will be passed a <code>GuardedInvocation</code> that the call site should use to build its new target method handle. When this method is called, the call site is discouraged from keeping any previous state, and is supposed to only link the current invocation.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>guardedInvocation</code> - the guarded invocation that the call site should use to build its target method handle.</dd> <dd>
<code>relinkAndInvoke</code> - a relink-and-invoke method handle. This is a method handle matching the method type of the call site that is supplied by the <a href="../dynamiclinker.html" title="class in jdk.dynalink"><code>DynamicLinker</code></a> as a callback. It should be used by this call site as the ultimate fallback when it can't invoke its target with the passed arguments. The fallback method is such that when it's invoked, it'll try to obtain an adequate target <a href="../linker/guardedinvocation.html" title="class in jdk.dynalink.linker"><code>GuardedInvocation</code></a> for the invocation, and subsequently invoke <a href="../relinkablecallsite.html#relink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.relink(GuardedInvocation, MethodHandle)</code></a> or <a href="../relinkablecallsite.html#resetAndRelink(jdk.dynalink.linker.GuardedInvocation,java.lang.invoke.MethodHandle)"><code>RelinkableCallSite.resetAndRelink(GuardedInvocation, MethodHandle)</code></a>, and finally invoke the target.</dd> </dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2023, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/21/docs/api/jdk.dynalink/jdk/dynalink/support/ChainedCallSite.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/21/docs/api/jdk.dynalink/jdk/dynalink/support/ChainedCallSite.html</a>
  </p>
</div>
