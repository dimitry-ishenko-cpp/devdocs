<h1 title="Module jdk.dynalink" class="title">Module jdk.dynalink</h1>  <div class="module-signature">module <span class="element-name">jdk.dynalink</span>
</div> <section class="module-description" id="module-description">  <div class="block">Defines the API for dynamic linking of high-level operations on objects. <p> Dynalink is a library for dynamic linking of high-level operations on objects. These operations include "read a property", "write a property", "invoke a function" and so on. Dynalink is primarily useful for implementing programming languages where at least some expressions have dynamic types (that is, types that can not be decided statically), and the operations on dynamic types are expressed as <a href="../java.base/java/lang/invoke/callsite.html" title="class in java.lang.invoke">call sites</a>. These call sites will be linked to appropriate target <a href="../java.base/java/lang/invoke/methodhandle.html" title="class in java.lang.invoke">method handles</a> at run time based on actual types of the values the expressions evaluated to. These can change between invocations, necessitating relinking the call site multiple times to accommodate new types; Dynalink handles all that and more. </p>
<p> Dynalink supports implementation of programming languages with object models that differ (even radically) from the JVM's class-based model and have their custom type conversions. </p>
<p> Dynalink is closely related to, and relies on, the <a href="../java.base/java/lang/invoke/package-summary.html"><code>java.lang.invoke</code></a> package. </p>
<p> While <a href="../java.base/java/lang/invoke/package-summary.html"><code>java.lang.invoke</code></a> provides a low level API for dynamic linking of <code>invokedynamic</code> call sites, it does not provide a way to express higher level operations on objects, nor methods that implement them. These operations are the usual ones in object-oriented environments: property access, access of elements of collections, invocation of methods and constructors (potentially with multiple dispatch, e.g. link- and run-time equivalents of Java overloaded method resolution). These are all functions that are normally desired in a language on the JVM. If a language is statically typed and its type system matches that of the JVM, it can accomplish this with use of the usual invocation, field access, etc. instructions (e.g. <code>invokevirtual</code>, <code>getfield</code>). However, if the language is dynamic (hence, types of some expressions are not known until evaluated at run time), or its object model or type system don't match closely that of the JVM, then it should use <code>invokedynamic</code> call sites instead and let Dynalink manage them. </p>
<h2 id="example-heading">Example</h2> Dynalink is probably best explained by an example showing its use. Let's suppose you have a program in a language where you don't have to declare the type of an object and you want to access a property on it: <pre>
 var color = obj.color;
 </pre> If you generated a Java class to represent the above one-line program, its bytecode would look something like this: <pre>
 aload 2 // load "obj" on stack
 invokedynamic "GET:PROPERTY:color"(Object)Object // invoke property getter on object of unknown type
 astore 3 // store the return value into local variable "color"
 </pre> In order to link the <code>invokedynamic</code> instruction, we need a bootstrap method. A minimalist bootstrap method with Dynalink could look like this: <pre>
 import java.lang.invoke.*;
 import jdk.dynalink.*;
 import jdk.dynalink.support.*;

 class MyLanguageRuntime {
     private static final DynamicLinker dynamicLinker = new DynamicLinkerFactory().createLinker();

     public static CallSite bootstrap(MethodHandles.Lookup lookup, String name, MethodType type) {
         return dynamicLinker.link(
             new SimpleRelinkableCallSite(
                 new CallSiteDescriptor(lookup, parseOperation(name), type)));
     }

     private static Operation parseOperation(String name) {
         ...
     }
 }
 </pre> There are several objects of significance in the above code snippet: <ul> <li>
<a href="jdk/dynalink/dynamiclinker.html" title="class in jdk.dynalink"><code>DynamicLinker</code></a> is the main object in Dynalink, it coordinates the linking of call sites to method handles that implement the operations named in them. It is configured and created using a <a href="jdk/dynalink/dynamiclinkerfactory.html" title="class in jdk.dynalink"><code>DynamicLinkerFactory</code></a>.</li> <li>When the bootstrap method is invoked, it needs to create a <a href="../java.base/java/lang/invoke/callsite.html" title="class in java.lang.invoke"><code>CallSite</code></a> object. In Dynalink, these call sites need to additionally implement the <a href="jdk/dynalink/relinkablecallsite.html" title="interface in jdk.dynalink"><code>RelinkableCallSite</code></a> interface. "Relinkable" here alludes to the fact that if the call site encounters objects of different types at run time, its target will be changed to a method handle that can perform the operation on the newly encountered type. <a href="jdk/dynalink/support/simplerelinkablecallsite.html" title="class in jdk.dynalink.support"><code>SimpleRelinkableCallSite</code></a> and <a href="jdk/dynalink/support/chainedcallsite.html" title="class in jdk.dynalink.support"><code>ChainedCallSite</code></a> (not used in the above example) are two implementations already provided by the library.</li> <li>Dynalink uses <a href="jdk/dynalink/callsitedescriptor.html" title="class in jdk.dynalink"><code>CallSiteDescriptor</code></a> objects to preserve the parameters to the bootstrap method: the lookup and the method type, as it will need them whenever it needs to relink a call site.</li> <li>Dynalink uses <a href="jdk/dynalink/operation.html" title="interface in jdk.dynalink"><code>Operation</code></a> objects to express dynamic operations. It does not prescribe how would you encode the operations in your call site, though. That is why in the above example the <code>parseOperation</code> function is left empty, and you would be expected to provide the code to parse the string <code>"GET:PROPERTY:color"</code> in the call site's name into a named property getter operation object as <code>StandardOperation.GET.withNamespace(StandardNamespace.PROPERTY).named("color")</code>. </li>
</ul> <p>What can you already do with the above setup? <code>DynamicLinkerFactory</code> by default creates a <code>DynamicLinker</code> that can link Java objects with the usual Java semantics. If you have these three simple classes: </p>
<pre>
 public class A {
     public String color;
     public A(String color) { this.color = color; }
 }

 public class B {
     private String color;
     public B(String color) { this.color = color; }
     public String getColor() { return color; }
 }

 public class C {
     private int color;
     public C(int color) { this.color = color; }
     public int getColor() { return color; }
 }
 </pre> and you somehow create their instances and pass them to your call site in your programming language: <pre>
 for each(var obj in [new A("red"), new B("green"), new C(0x0000ff)]) {
     print(obj.color);
 }
 </pre> then on first invocation, Dynalink will link the <code>.color</code> getter operation to a field getter for <code>A.color</code>, on second invocation it will relink it to <code>B.getColor()</code> returning a <code>String</code>, and finally on third invocation it will relink it to <code>C.getColor()</code> returning an <code>int</code>. The <code>SimpleRelinkableCallSite</code> we used above only remembers the linkage for the last encountered type (it implements what is known as a <i>monomorphic inline cache</i>). Another already provided implementation, <a href="jdk/dynalink/support/chainedcallsite.html" title="class in jdk.dynalink.support"><code>ChainedCallSite</code></a> will remember linkages for several different types (it is a <i>polymorphic inline cache</i>) and is probably a better choice in serious applications. <h2 id="dynalink-and-bytecode-creation-heading">Dynalink and bytecode creation</h2> <code>CallSite</code> objects are usually created as part of bootstrapping <code>invokedynamic</code> instructions in bytecode. Hence, Dynalink is typically used as part of language runtimes that compile programs into Java <code>.class</code> bytecode format. Dynalink does not address the aspects of either creating bytecode classes or loading them into the JVM. That said, Dynalink can also be used without bytecode compilation (e.g. in language interpreters) by creating <code>CallSite</code> objects explicitly and associating them with representations of dynamic operations in the interpreted program (e.g. a typical representation would be some node objects in a syntax tree). <h2 id="available-operations-heading">Available operations</h2> Dynalink defines several standard operations in its <a href="jdk/dynalink/standardoperation.html" title="enum class in jdk.dynalink"><code>StandardOperation</code></a> class. The linker for Java objects can link all of these operations, and you are encouraged to at minimum support and use these operations in your language too. The standard operations <code>GET</code> and <code>SET</code> need to be combined with at least one <a href="jdk/dynalink/namespace.html" title="interface in jdk.dynalink"><code>Namespace</code></a> to be useful, e.g. to express a property getter, you'd use <code>StandardOperation.GET.withNamespace(StandardNamespace.PROPERTY)</code>. Dynalink defines three standard namespaces in the <a href="jdk/dynalink/standardnamespace.html" title="enum class in jdk.dynalink"><code>StandardNamespace</code></a> class. To associate a fixed name with an operation, you can use <a href="jdk/dynalink/namedoperation.html" title="class in jdk.dynalink"><code>NamedOperation</code></a> as in the previous example: <code>StandardOperation.GET.withNamespace(StandardNamespace.PROPERTY).named("color")</code> expresses a getter for the property named "color". <h2 id="operations-on-multiple-namespaces-heading">Operations on multiple namespaces</h2> Some languages might not have separate namespaces on objects for properties, elements, and methods, and a source language construct might address several of them at once. Dynalink supports specifying multiple <a href="jdk/dynalink/namespace.html" title="interface in jdk.dynalink"><code>Namespace</code></a> objects with <a href="jdk/dynalink/namespaceoperation.html" title="class in jdk.dynalink"><code>NamespaceOperation</code></a>. <h2 id="language-specific-linkers-heading">Language-specific linkers</h2> Languages that define their own object model different than the JVM class-based model and/or use their own type conversions will need to create their own language-specific linkers. See the <a href="jdk/dynalink/linker/package-summary.html"><code>jdk.dynalink.linker</code></a> package and specifically the <a href="jdk/dynalink/linker/guardingdynamiclinker.html" title="interface in jdk.dynalink.linker"><code>GuardingDynamicLinker</code></a> interface to get started. <h2 id="dynalink-and-java-objects-heading">Dynalink and Java objects</h2> The <code>DynamicLinker</code> objects created by <code>DynamicLinkerFactory</code> by default contain an internal instance of <code>BeansLinker</code>, which is a language-specific linker that implements the usual Java semantics for all of the above operations and can link any Java object that no other language-specific linker has managed to link. This way, all language runtimes have built-in interoperability with ordinary Java objects. See <a href="jdk/dynalink/beans/beanslinker.html" title="class in jdk.dynalink.beans"><code>BeansLinker</code></a> for details on how it links the various operations. <h2 id="cross-language-interoperability-heading">Cross-language interoperability</h2> A <code>DynamicLinkerFactory</code> can be configured with a <a href="jdk/dynalink/dynamiclinkerfactory.html#setClassLoader(java.lang.ClassLoader)">class loader</a>. It will try to instantiate all <a href="jdk/dynalink/linker/guardingdynamiclinkerexporter.html" title="class in jdk.dynalink.linker"><code>GuardingDynamicLinkerExporter</code></a> classes visible to that class loader and compose the linkers they provide into the <code>DynamicLinker</code> it creates. This allows for interoperability between languages: if you have two language runtimes A and B deployed in your JVM and they export their linkers through the above mechanism, language runtime A will have a language-specific linker instance from B and vice versa inside their <code>DynamicLinker</code> objects. This means that if an object from language runtime B gets passed to code from language runtime A, the linker from B will get a chance to link the call site in A when it encounters the object from B.</div> <dl class="notes">
<dt>Module Graph:</dt>
<dd><a class="module-graph" href="https://docs.oracle.com/en/java/javase/21/docs/api/jdk.dynalink/module-graph.svg"><img style="vertical-align:top" alt="Module graph for jdk.dynalink" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8IS0tIEdlbmVyYXRlZCBieSBncmFwaHZpeiB2ZXJzaW9uIDIuMzguMCAoMjAxNDA0MTMuMjA0MSkKIC0tPgo8IS0tIFRpdGxlOiBqZGsuZHluYWxpbmsgUGFnZXM6IDEgLS0+Cjxzdmcgd2lkdGg9IjEwN3B0IiBoZWlnaHQ9IjEzM3B0Igogdmlld0JveD0iMC4wMCAwLjAwIDEwNy4wMCAxMzMuMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8ZyBpZD0iZ3JhcGgwIiBjbGFzcz0iZ3JhcGgiIHRyYW5zZm9ybT0ic2NhbGUoMSAxKSByb3RhdGUoMCkgdHJhbnNsYXRlKDQgMTI5KSI+Cjx0aXRsZT5qZGsuZHluYWxpbms8L3RpdGxlPgo8cG9seWdvbiBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiBwb2ludHM9Ii00LDQgLTQsLTEyOSAxMDMsLTEyOSAxMDMsNCAtNCw0Ii8+CjwhLS0gamF2YS5iYXNlIC0tPgo8ZyBpZD0ibm9kZTEiIGNsYXNzPSJub2RlIj48dGl0bGU+amF2YS5iYXNlPC90aXRsZT4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNDkuNSIgeT0iLTE3LjQiIGZvbnQtZmFtaWx5PSJEZWphVnVTYW5zIiBmb250LXNpemU9IjEyLjAwIiBmaWxsPSIjZTc2ZjAwIj5qYXZhLmJhc2U8L3RleHQ+CjwvZz4KPCEtLSBqZGsuZHluYWxpbmsgLS0+CjxnIGlkPSJub2RlMiIgY2xhc3M9Im5vZGUiPjx0aXRsZT5qZGsuZHluYWxpbms8L3RpdGxlPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI0OS41IiB5PSItMTAxLjQiIGZvbnQtZmFtaWx5PSJEZWphVnVTYW5zIiBmb250LXNpemU9IjEyLjAwIiBmaWxsPSIjNDM3MjkxIj5qZGsuZHluYWxpbms8L3RleHQ+CjwvZz4KPCEtLSBqZGsuZHluYWxpbmsmIzQ1OyZndDtqYXZhLmJhc2UgLS0+CjxnIGlkPSJlZGdlMSIgY2xhc3M9ImVkZ2UiPjx0aXRsZT5qZGsuZHluYWxpbmsmIzQ1OyZndDtqYXZhLmJhc2U8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNkZGRkZGQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTQ5LjUsLTgzLjY1MDFDNDkuNSwtNzMuOTgwOCA0OS41LC02Mi4xNTAyIDQ5LjUsLTUxLjQxNTciLz4KPHBvbHlnb24gZmlsbD0iI2RkZGRkZCIgc3Ryb2tlPSIjZGRkZGRkIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50cz0iNDkuNSwtNDEuMTY3MSA1NC4wMDAxLC01MS4xNjcxIDUwLC00Ni4xNjcxIDUwLjAwMDEsLTUxLjE2NzEgNDkuNTAwMSwtNTEuMTY3MSA0OS4wMDAxLC01MS4xNjcxIDQ5LC00Ni4xNjcxIDQ1LjAwMDEsLTUxLjE2NzIgNDkuNSwtNDEuMTY3MSA0OS41LC00MS4xNjcxIi8+CjwvZz4KPC9nPgo8L3N2Zz4K" height="100"><span><img style="border: solid lightgray 1px; vertical-align:top" alt="Module graph for jdk.dynalink" src="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8IS0tIEdlbmVyYXRlZCBieSBncmFwaHZpeiB2ZXJzaW9uIDIuMzguMCAoMjAxNDA0MTMuMjA0MSkKIC0tPgo8IS0tIFRpdGxlOiBqZGsuZHluYWxpbmsgUGFnZXM6IDEgLS0+Cjxzdmcgd2lkdGg9IjEwN3B0IiBoZWlnaHQ9IjEzM3B0Igogdmlld0JveD0iMC4wMCAwLjAwIDEwNy4wMCAxMzMuMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8ZyBpZD0iZ3JhcGgwIiBjbGFzcz0iZ3JhcGgiIHRyYW5zZm9ybT0ic2NhbGUoMSAxKSByb3RhdGUoMCkgdHJhbnNsYXRlKDQgMTI5KSI+Cjx0aXRsZT5qZGsuZHluYWxpbms8L3RpdGxlPgo8cG9seWdvbiBmaWxsPSJ3aGl0ZSIgc3Ryb2tlPSJub25lIiBwb2ludHM9Ii00LDQgLTQsLTEyOSAxMDMsLTEyOSAxMDMsNCAtNCw0Ii8+CjwhLS0gamF2YS5iYXNlIC0tPgo8ZyBpZD0ibm9kZTEiIGNsYXNzPSJub2RlIj48dGl0bGU+amF2YS5iYXNlPC90aXRsZT4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNDkuNSIgeT0iLTE3LjQiIGZvbnQtZmFtaWx5PSJEZWphVnVTYW5zIiBmb250LXNpemU9IjEyLjAwIiBmaWxsPSIjZTc2ZjAwIj5qYXZhLmJhc2U8L3RleHQ+CjwvZz4KPCEtLSBqZGsuZHluYWxpbmsgLS0+CjxnIGlkPSJub2RlMiIgY2xhc3M9Im5vZGUiPjx0aXRsZT5qZGsuZHluYWxpbms8L3RpdGxlPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI0OS41IiB5PSItMTAxLjQiIGZvbnQtZmFtaWx5PSJEZWphVnVTYW5zIiBmb250LXNpemU9IjEyLjAwIiBmaWxsPSIjNDM3MjkxIj5qZGsuZHluYWxpbms8L3RleHQ+CjwvZz4KPCEtLSBqZGsuZHluYWxpbmsmIzQ1OyZndDtqYXZhLmJhc2UgLS0+CjxnIGlkPSJlZGdlMSIgY2xhc3M9ImVkZ2UiPjx0aXRsZT5qZGsuZHluYWxpbmsmIzQ1OyZndDtqYXZhLmJhc2U8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiNkZGRkZGQiIHN0cm9rZS13aWR0aD0iMiIgZD0iTTQ5LjUsLTgzLjY1MDFDNDkuNSwtNzMuOTgwOCA0OS41LC02Mi4xNTAyIDQ5LjUsLTUxLjQxNTciLz4KPHBvbHlnb24gZmlsbD0iI2RkZGRkZCIgc3Ryb2tlPSIjZGRkZGRkIiBzdHJva2Utd2lkdGg9IjIiIHBvaW50cz0iNDkuNSwtNDEuMTY3MSA1NC4wMDAxLC01MS4xNjcxIDUwLC00Ni4xNjcxIDUwLjAwMDEsLTUxLjE2NzEgNDkuNTAwMSwtNTEuMTY3MSA0OS4wMDAxLC01MS4xNjcxIDQ5LC00Ni4xNjcxIDQ1LjAwMDEsLTUxLjE2NzIgNDkuNSwtNDEuMTY3MSA0OS41LC00MS4xNjcxIi8+CjwvZz4KPC9nPgo8L3N2Zz4K"></span></a></dd> <dt>Since:</dt> <dd>9</dd> </dl> </section> <section class="summary"> <section class="packages-summary" id="packages-summary">  <h2>Packages</h2> <div id="package-summary-table">  <table class="summary-table two-column-summary">             <tr>
<th>Package</th>
<th>Description</th>
</tr>
<tr>
<td><a href="jdk/dynalink/package-summary.html">jdk.dynalink</a></td>
<td> <div class="block">Contains interfaces and classes that are used to link an <code>invokedynamic</code> call site.</div> </td>
</tr>
<tr>
<td><a href="jdk/dynalink/beans/package-summary.html">jdk.dynalink.beans</a></td>
<td> <div class="block">Contains the linker for ordinary Java objects.</div> </td>
</tr>
<tr>
<td><a href="jdk/dynalink/linker/package-summary.html">jdk.dynalink.linker</a></td>
<td> <div class="block"> Contains interfaces and classes needed by language runtimes to implement their own language-specific object models and type conversions.</div> </td>
</tr>
<tr>
<td><a href="jdk/dynalink/linker/support/package-summary.html">jdk.dynalink.linker.support</a></td>
<td> <div class="block">Contains classes that make it more convenient for language runtimes to implement their own language-specific object models and type conversions by providing basic implementations of some classes as well as various utilities.</div> </td>
</tr>
<tr>
<td><a href="jdk/dynalink/support/package-summary.html">jdk.dynalink.support</a></td>
<td> <div class="block">Contains classes that make using Dynalink more convenient by providing basic implementations of some classes as well as various utilities.</div> </td>
</tr>
</table> </div> </section><section class="services-summary" id="services-summary">  <h2>Services</h2>  <table class="details-table two-column-summary">     <tr>
<th>Type</th>
<th>Description</th>
</tr>
<tr>
<td><a href="jdk/dynalink/linker/guardingdynamiclinkerexporter.html" title="class in jdk.dynalink.linker">GuardingDynamicLinkerExporter</a></td>
<td> <div class="block">A class acting as a supplier of guarding dynamic linkers that can be automatically loaded by other language runtimes.</div> </td>
</tr>
</table> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2023, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/21/docs/api/jdk.dynalink/module-summary.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/21/docs/api/jdk.dynalink/module-summary.html</a>
  </p>
</div>
