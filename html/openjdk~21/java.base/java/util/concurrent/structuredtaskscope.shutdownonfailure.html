<h1 title="Class StructuredTaskScope.ShutdownOnFailure" class="title">Class StructuredTaskScope.ShutdownOnFailure</h1> <div class="inheritance" title="Inheritance Tree">
<a href="../../lang/object.html" title="class in java.lang">java.lang.Object</a> <div class="inheritance">
<a href="structuredtaskscope.html" title="class in java.util.concurrent">java.util.concurrent.StructuredTaskScope</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>&lt;<a href="../../lang/object.html" title="class in java.lang">Object</a>&gt; <div class="inheritance">java.util.concurrent.StructuredTaskScope.ShutdownOnFailure</div> </div> </div> <section class="class-description" id="class-description"> <dl class="notes"> <dt>All Implemented Interfaces:</dt> <dd><code><a href="../../lang/autocloseable.html" title="interface in java.lang">AutoCloseable</a></code></dd> </dl> <dl class="notes"> <dt>Enclosing class:</dt> <dd><code><a href="structuredtaskscope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>&lt;<a href="structuredtaskscope.html" title="type parameter in StructuredTaskScope">T</a>&gt;</code></dd> </dl>  <pre class="lang-java" data-language="java">public static final class StructuredTaskScope.ShutdownOnFailure extends StructuredTaskScopePREVIEW&lt;Object&gt;</pre> <div class="preview-block" id="preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">
<span class="preview-label"><code>ShutdownOnFailure</code> is a preview API of the Java platform.</span> <div class="preview-comment">Programs can only use <code>ShutdownOnFailure</code> when preview features are enabled.</div> <div class="preview-comment">Preview features may be removed in a future release, or upgraded to permanent features of the Java platform.</div> </div> <div class="block">A <code>StructuredTaskScope</code> that captures the exception of the first subtask to <a href="structuredtaskscope.subtask.state.html#FAILED">fail</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>. Once captured, it <a href="structuredtaskscope.html#shutdown()">shuts down</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> the task scope to interrupt unfinished threads and wakeup the task scope owner. The policy implemented by this class is intended for cases where the results for all subtasks are required ("invoke all"); if any subtask fails then the results of other unfinished subtasks are no longer needed. <p> Unless otherwise specified, passing a <code>null</code> argument to a method in this class will cause a <a href="../../lang/nullpointerexception.html" title="class in java.lang"><code>NullPointerException</code></a> to be thrown.</p>
</div> <dl class="notes"> <dt>API Note:</dt> <dd>This class implements a policy to shut down the task scope when a subtask fails. There shouldn't be any need to directly shut down the task scope with the <a href="structuredtaskscope.html#shutdown()"><code>shutdown</code></a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> method.</dd> <dt>Since:</dt> <dd>21</dd> </dl> </section> <section class="summary"> <section class="nested-class-summary" id="nested-class-summary"> <h2>Nested Class Summary</h2> <div class="inherited-list"> <h2 id="nested-classes-inherited-from-class-java.util.concurrent.StructuredTaskScope">Nested classes/interfaces declared in class java.util.concurrent.<a href="structuredtaskscope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>
</h2> <code><a href="structuredtaskscope.shutdownonfailure.html" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnFailure</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup>, <a href="structuredtaskscope.shutdownonsuccess.html" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnSuccess</a><sup><a href="structuredtaskscope.shutdownonsuccess.html#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnSuccess">PREVIEW</a></sup>&lt;<a href="structuredtaskscope.shutdownonsuccess.html" title="type parameter in StructuredTaskScope.ShutdownOnSuccess">T</a>&gt;, <a href="structuredtaskscope.subtask.html" title="interface in java.util.concurrent">StructuredTaskScope.Subtask</a><sup><a href="structuredtaskscope.subtask.html#preview-java.util.concurrent.StructuredTaskScope.Subtask">PREVIEW</a></sup>&lt;<a href="structuredtaskscope.subtask.html" title="type parameter in StructuredTaskScope.Subtask">T</a>&gt;</code>
</div> </section><section class="constructor-summary" id="constructor-summary"> <h2>Constructor Summary</h2>  <table class="summary-table two-column-summary">       <tr>
<th>Constructor</th>
<th>Description</th>
</tr>
<tr>
<td><code><a href="#%3Cinit%3E()" class="member-name-link">ShutdownOnFailure</a>()</code></td>
<td> <div class="block">Constructs a new unnamed <code>ShutdownOnFailure</code> that creates virtual threads.</div> </td>
</tr>
<tr>
<td><code><a href="#%3Cinit%3E(java.lang.String,java.util.concurrent.ThreadFactory)" class="member-name-link">ShutdownOnFailure</a><wbr>(<a href="../../lang/string.html" title="class in java.lang">String</a> name,
 <a href="threadfactory.html" title="interface in java.util.concurrent">ThreadFactory</a> factory)</wbr></code></td>
<td> <div class="block">Constructs a new <code>ShutdownOnFailure</code> with the given name and thread factory.</div> </td>
</tr>
</table> </section><section class="method-summary" id="method-summary"> <h2>Method Summary</h2> <div id="method-summary-table">  <div id="method-summary-table.tabpanel" role="tabpanel"> <table class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">                   <tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td><code><a href="../optional.html" title="class in java.util">Optional</a><wbr>&lt;<a href="../../lang/throwable.html" title="class in java.lang">Throwable</a>&gt;</wbr></code></td>
<td><code><a href="#exception()" class="member-name-link">exception</a>()</code></td>
<td> <div class="block">Returns the exception of the first subtask that <a href="structuredtaskscope.subtask.state.html#FAILED">failed</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>.</div> </td>
</tr>
<tr>
<td><code><a href="structuredtaskscope.shutdownonfailure.html" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnFailure</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup></code></td>
<td><code><a href="#join()" class="member-name-link">join</a>()</code></td>
<td> <div class="block">Wait for all subtasks started in this task scope to complete or for a subtask to <a href="structuredtaskscope.subtask.state.html#FAILED">fail</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>.</div> </td>
</tr>
<tr>
<td><code><a href="structuredtaskscope.shutdownonfailure.html" title="class in java.util.concurrent">StructuredTaskScope.ShutdownOnFailure</a><sup><a href="#preview-java.util.concurrent.StructuredTaskScope.ShutdownOnFailure">PREVIEW</a></sup></code></td>
<td><code><a href="#joinUntil(java.time.Instant)" class="member-name-link">joinUntil</a><wbr>(<a href="../../time/instant.html" title="class in java.time">Instant</a> deadline)</wbr></code></td>
<td> <div class="block">Wait for all subtasks started in this task scope to complete or for a subtask to <a href="structuredtaskscope.subtask.state.html#FAILED">fail</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>, up to the given deadline.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#throwIfFailed()" class="member-name-link">throwIfFailed</a>()</code></td>
<td> <div class="block">Throws if a subtask <a href="structuredtaskscope.subtask.state.html#FAILED">failed</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>.</div> </td>
</tr>
<tr>
<td><code>&lt;X extends <a href="../../lang/throwable.html" title="class in java.lang">Throwable</a>&gt;<br>void</code></td>
<td><code><a href="#throwIfFailed(java.util.function.Function)" class="member-name-link">throwIfFailed</a><wbr>(<a href="../function/function.html" title="interface in java.util.function">Function</a>&lt;<a href="../../lang/throwable.html" title="class in java.lang">Throwable</a>,<wbr>? extends X&gt; esf)</wbr></wbr></code></td>
<td> <div class="block">Throws the exception produced by the given exception supplying function if a subtask <a href="structuredtaskscope.subtask.state.html#FAILED">failed</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>.</div> </td>
</tr>
</table> </div> </div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.util.concurrent.StructuredTaskScope">Methods declared in class java.util.concurrent.<a href="structuredtaskscope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>
</h3> <code><a href="structuredtaskscope.html#close()">close</a>, <a href="structuredtaskscope.html#ensureOwnerAndJoined()">ensureOwnerAndJoined</a>, <a href="structuredtaskscope.html#fork(java.util.concurrent.Callable)">fork</a>, <a href="structuredtaskscope.html#handleComplete(java.util.concurrent.StructuredTaskScope.Subtask)">handleComplete</a>, <a href="structuredtaskscope.html#isShutdown()">isShutdown</a>, <a href="structuredtaskscope.html#shutdown()">shutdown</a></code>
</div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class java.lang.<a href="../../lang/object.html" title="class in java.lang">Object</a>
</h3> <code><a href="../../lang/object.html#clone()">clone</a>, <a href="../../lang/object.html#equals(java.lang.Object)">equals</a>, <a href="../../lang/object.html#finalize()">finalize</a>, <a href="../../lang/object.html#getClass()">getClass</a>, <a href="../../lang/object.html#hashCode()">hashCode</a>, <a href="../../lang/object.html#notify()">notify</a>, <a href="../../lang/object.html#notifyAll()">notifyAll</a>, <a href="../../lang/object.html#toString()">toString</a>, <a href="../../lang/object.html#wait()">wait</a>, <a href="../../lang/object.html#wait(long)">wait</a>, <a href="../../lang/object.html#wait(long,int)">wait</a></code>
</div> </section> </section> <section class="details"> <section class="constructor-details" id="constructor-detail"> <h2>Constructor Details</h2>  </section><section class="detail" id="&lt;init&gt;(java.lang.String,java.util.concurrent.ThreadFactory)"> <h3>ShutdownOnFailure</h3> <pre class="lang-java" data-language="java">public ShutdownOnFailure(String name, ThreadFactory factory)</pre> <div class="block">Constructs a new <code>ShutdownOnFailure</code> with the given name and thread factory. The task scope is optionally named for the purposes of monitoring and management. The thread factory is used to <a href="threadfactory.html#newThread(java.lang.Runnable)"><code>create</code></a> threads when subtasks are <a href="structuredtaskscope.html#fork(java.util.concurrent.Callable)">forked</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>. The task scope is owned by the current thread. <p> Construction captures the current thread's <a href="../../lang/scopedvalue.html" title="class in java.lang">scoped value</a><sup><a href="../../lang/scopedvalue.html#preview-java.lang.ScopedValue">PREVIEW</a></sup> bindings for inheritance by threads started in the task scope. The <a href="#TreeStructure">Tree Structure</a> section in the class description details how parent-child relations are established implicitly for the purpose of inheritance of scoped value bindings.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>name</code> - the name of the task scope, can be null</dd> <dd>
<code>factory</code> - the thread factory</dd> </dl> </section><section class="detail" id="&lt;init&gt;()"> <h3>ShutdownOnFailure</h3> <pre class="lang-java" data-language="java">public ShutdownOnFailure()</pre> <div class="block">Constructs a new unnamed <code>ShutdownOnFailure</code> that creates virtual threads.</div> <dl class="notes"> <dt>Implementation Requirements:</dt> <dd>This constructor is equivalent to invoking the 2-arg constructor with a name of <code>null</code> and a thread factory that creates virtual threads.</dd> </dl> </section><section class="method-details" id="method-detail"> <h2>Method Details</h2>  </section><section class="detail" id="join()"> <h3>join</h3> <pre class="lang-java" data-language="java">public StructuredTaskScope.ShutdownOnFailurePREVIEW join() throws InterruptedException</pre> <div class="block">Wait for all subtasks started in this task scope to complete or for a subtask to <a href="structuredtaskscope.subtask.state.html#FAILED">fail</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>. <p> This method waits for all subtasks by waiting for all threads <a href="structuredtaskscope.html#fork(java.util.concurrent.Callable)">started</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> in this task scope to finish execution. It stops waiting when all threads finish, a subtask fails, or the current thread is <a href="../../lang/thread.html#interrupt()">interrupted</a>. It also stops waiting if the <a href="structuredtaskscope.html#shutdown()"><code>shutdown</code></a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> method is invoked directly to shut down this task scope. </p>
<p> This method may only be invoked by the task scope owner.</p>
</div> <dl class="notes"> <dt>Overrides:</dt> <dd>
<code><a href="structuredtaskscope.html#join()">join</a></code> in class <code><a href="structuredtaskscope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>&lt;<a href="../../lang/object.html" title="class in java.lang">Object</a>&gt;</code>
</dd> <dt>Returns:</dt> <dd>this task scope</dd> <dt>Throws:</dt> <dd>
<code><a href="../../lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if this task scope is closed</dd> <dd>
<code><a href="../../lang/wrongthreadexception.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd> <dd>
<code><a href="../../lang/interruptedexception.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting</dd> </dl> </section><section class="detail" id="joinUntil(java.time.Instant)"> <h3>joinUntil</h3> <pre class="lang-java" data-language="java">public StructuredTaskScope.ShutdownOnFailurePREVIEW joinUntil(Instant deadline) throws InterruptedException, TimeoutException</pre> <div class="block">Wait for all subtasks started in this task scope to complete or for a subtask to <a href="structuredtaskscope.subtask.state.html#FAILED">fail</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>, up to the given deadline. <p> This method waits for all subtasks by waiting for all threads <a href="structuredtaskscope.html#fork(java.util.concurrent.Callable)">started</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> in this task scope to finish execution. It stops waiting when all threads finish, a subtask fails, the deadline is reached, or the current thread is <a href="../../lang/thread.html#interrupt()">interrupted</a>. It also stops waiting if the <a href="structuredtaskscope.html#shutdown()"><code>shutdown</code></a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup> method is invoked directly to shut down this task scope. </p>
<p> This method may only be invoked by the task scope owner.</p>
</div> <dl class="notes"> <dt>Overrides:</dt> <dd>
<code><a href="structuredtaskscope.html#joinUntil(java.time.Instant)">joinUntil</a></code> in class <code><a href="structuredtaskscope.html" title="class in java.util.concurrent">StructuredTaskScope</a><sup><a href="structuredtaskscope.html#preview-java.util.concurrent.StructuredTaskScope">PREVIEW</a></sup>&lt;<a href="../../lang/object.html" title="class in java.lang">Object</a>&gt;</code>
</dd> <dt>Parameters:</dt> <dd>
<code>deadline</code> - the deadline</dd> <dt>Returns:</dt> <dd>this task scope</dd> <dt>Throws:</dt> <dd>
<code><a href="../../lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if this task scope is closed</dd> <dd>
<code><a href="../../lang/wrongthreadexception.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd> <dd>
<code><a href="../../lang/interruptedexception.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting</dd> <dd>
<code><a href="timeoutexception.html" title="class in java.util.concurrent">TimeoutException</a></code> - if the deadline is reached while waiting</dd> </dl> </section><section class="detail" id="exception()"> <h3>exception</h3> <pre class="lang-java" data-language="java">public Optional&lt;Throwable&gt; exception()</pre> <div class="block">Returns the exception of the first subtask that <a href="structuredtaskscope.subtask.state.html#FAILED">failed</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>. If no subtasks failed then an empty <code>Optional</code> is returned.</div> <dl class="notes"> <dt>Returns:</dt> <dd>the exception for the first subtask to fail or an empty optional if no subtasks failed</dd> <dt>Throws:</dt> <dd>
<code><a href="../../lang/wrongthreadexception.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd> <dd>
<code><a href="../../lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the task scope owner did not join after forking</dd> </dl> </section><section class="detail" id="throwIfFailed()"> <h3>throwIfFailed</h3> <pre class="lang-java" data-language="java">public void throwIfFailed() throws ExecutionException</pre> <div class="block">Throws if a subtask <a href="structuredtaskscope.subtask.state.html#FAILED">failed</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>. If any subtask failed with an exception then <code>ExecutionException</code> is thrown with the exception of the first subtask to fail as the <a href="../../lang/throwable.html#getCause()">cause</a>. This method does nothing if no subtasks failed.</div> <dl class="notes"> <dt>Throws:</dt> <dd>
<code><a href="executionexception.html" title="class in java.util.concurrent">ExecutionException</a></code> - if a subtask failed</dd> <dd>
<code><a href="../../lang/wrongthreadexception.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd> <dd>
<code><a href="../../lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the task scope owner did not join after forking</dd> </dl> </section><section class="detail" id="throwIfFailed(java.util.function.Function)"> <h3>throwIfFailed</h3> <pre class="lang-java" data-language="java">public &lt;X extends Throwable&gt; void throwIfFailed(Function&lt;Throwable,? extends X&gt; esf) throws X</pre> <div class="block">Throws the exception produced by the given exception supplying function if a subtask <a href="structuredtaskscope.subtask.state.html#FAILED">failed</a><sup><a href="structuredtaskscope.subtask.state.html#preview-java.util.concurrent.StructuredTaskScope.Subtask.State">PREVIEW</a></sup>. If any subtask failed with an exception then the function is invoked with the exception of the first subtask to fail. The exception returned by the function is thrown. This method does nothing if no subtasks failed.</div> <dl class="notes"> <dt>Type Parameters:</dt> <dd>
<code>X</code> - type of the exception to be thrown</dd> <dt>Parameters:</dt> <dd>
<code>esf</code> - the exception supplying function</dd> <dt>Throws:</dt> <dd>
<code>X</code> - produced by the exception supplying function</dd> <dd>
<code><a href="../../lang/wrongthreadexception.html" title="class in java.lang">WrongThreadException</a></code> - if the current thread is not the task scope owner</dd> <dd>
<code><a href="../../lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the task scope owner did not join after forking</dd> </dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2023, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/StructuredTaskScope.ShutdownOnFailure.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/util/concurrent/StructuredTaskScope.ShutdownOnFailure.html</a>
  </p>
</div>
