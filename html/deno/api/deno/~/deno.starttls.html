<h1 class="text-2xl leading-none break-all"> <span class="text-Function">function</span> <span class="font-bold">Deno.startTls</span> </h1>
<article> <div> <div> <div class="space-x-2 !mt-2">
<div class="text-permissions border border-permissions/50 bg-permissions/5 inline-flex items-center gap-0.5 *:flex-none rounded-md leading-none font-bold py-2 px-3"><span class="space-x-2"><span>allow-net</span></span></div> </div>
</div>
</div>
<div>
<div class="mt-3 space-y-8"><div class="scroll-mt-16" id="function_startTls_0"> <code data-language="ts">startTls(conn: TcpConn,options?: StartTlsOptions,): Promise&lt;TlsConn&gt;</code><div class="space-y-7" id="">
<div data-color-mode="dark" data-light-theme="light" data-dark-theme="dark" class="markdown-body">
<p>Start TLS handshake from an existing connection using an optional list of CA certificates, and hostname (default is "127.0.0.1"). Specifying CA certs is optional. By default the configured root certificates are used. Using this function requires that the other end of the connection is prepared for a TLS handshake.</p> <p>Note that this function <em>consumes</em> the TCP connection passed to it, thus the original TCP connection will be unusable after calling this. Additionally, you need to ensure that the TCP connection is not being used elsewhere when calling this function in order for the TCP connection to be consumed properly. For instance, if there is a <code data-language="ts">Promise</code> that is waiting for read operation on the TCP connection to complete, it is considered that the TCP connection is being used elsewhere. In such a case, this function will fail.</p> <div class="relative">
<pre><code data-language="ts"><span class="token keyword">const</span> conn <span class="token operator">=</span> <span class="token keyword">await</span> Deno<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">{</span> port<span class="token operator">:</span> <span class="token number">80</span><span class="token punctuation">,</span> hostname<span class="token operator">:</span> <span class="token string">"127.0.0.1"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> caCert <span class="token operator">=</span> <span class="token keyword">await</span> Deno<span class="token punctuation">.</span><span class="token function">readTextFile</span><span class="token punctuation">(</span><span class="token string">"./certs/my_custom_root_CA.pem"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// `conn` becomes unusable after calling `Deno.startTls`</span>
<span class="token keyword">const</span> tlsConn <span class="token operator">=</span> <span class="token keyword">await</span> Deno<span class="token punctuation">.</span><span class="token function">startTls</span><span class="token punctuation">(</span>conn<span class="token punctuation">,</span> <span class="token punctuation">{</span> caCerts<span class="token operator">:</span> <span class="token punctuation">[</span>caCert<span class="token punctuation">]</span><span class="token punctuation">,</span> hostname<span class="token operator">:</span> <span class="token string">"localhost"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<p>Requires <code data-language="ts">allow-net</code> permission.</p> </div>
<section class="section" id="parameters"> <div> <h2 class="anchorable mb-1">
 Parameters</h2>
</div>
<div class="space-y-8">
<div class="anchorable docEntry" id="function_starttls_0_parameters_conn"> <div class="docEntryHeader"> <div>
<code data-language="ts">conn: TcpConn</code> </div>
</div>
</div> <div class="anchorable docEntry" id="function_starttls_0_parameters_options"> <div class="docEntryHeader"> <div>
<div class="space-x-1 mb-1">
<div class="text-optional border border-optional/50 bg-optional/5 inline-flex items-center gap-0.5 *:flex-none rounded-md leading-none text-sm py-1 px-2">optional</div> </div>
<code data-language="ts">options: StartTlsOptions</code> </div>
</div>
</div> </div></section> <section class="section" id="return-type"> <div> <h2 class="anchorable mb-1">
 Return Type</h2>
</div>
<div class="space-y-8">
<div class=" docEntry" id="function_startTls_0_return"> <div class="docEntryHeader"> <div>
<code data-language="ts">Promise&lt;TlsConn&gt;</code> </div>
</div>
</div> </div></section> </div> </div></div> </div> </article><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018â€“2024 the Deno authors<br>Licensed under the MIT License.<br>
    <a href="https://docs.deno.com/api/deno/~/Deno.startTls" class="_attribution-link">https://docs.deno.com/api/deno/~/Deno.startTls</a>
  </p>
</div>
