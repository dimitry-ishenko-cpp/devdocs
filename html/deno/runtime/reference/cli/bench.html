<h1>
<code data-language="ts">deno bench</code>, benchmarking tool</h1>
<div>
<div class="p-4 bg-stone-100 dark:bg-transparent rounded border border-gray-300 dark:border-background-tertiary mt-6 mb-6 relative">
<h3 class="!text-xs !m-0 -top-2.5 bg-background-primary border border-gray-600/25 px-2 py-0.5 rounded absolute !font-normal">Command line usage</h3>
<div><pre class="!mb-0 !px-3 !py-2 language-none" tabindex="0"><code data-language="none">deno bench [OPTIONS] [files]... [-- [SCRIPT_ARG]...]</code></pre></div>
</div>
<div>
<p>Run benchmarks using Deno's built-in bench tool.</p> <p>Evaluate the given files, run all benches declared with 'Deno.bench()' and report results to standard output:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">deno bench src/fetch_bench.ts src/signal_bench.ts
</code></pre>   </div>
<p>If you specify a directory instead of a file, the path is expanded to all contained files matching the glob <code data-language="ts">{*_,*.,}bench.{js,mjs,ts,mts,jsx,tsx}</code>:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">deno bench src/
</code></pre>   </div>
</div>
<br><h2 id="type-checking-options">Type checking options </h2>
<h3 id="type-checking-options-check">
<code data-language="ts">--check</code> </h3>

<p>Set type-checking behavior. This subcommand type-checks local modules by default, so adding<code data-language="ts"> --check</code> is redundant If the value of "all" is supplied, remote modules will be included. Alternatively, the 'deno check' subcommand can be used.</p>

<h3 id="type-checking-options-no-check">
<code data-language="ts">--no-check</code> </h3>

<p>Skip type-checking. If the value of "remote" is supplied, diagnostic errors from remote modules will be ignored.</p>

<h2 id="dependency-management-options">Dependency management options </h2>
<h3 id="dependency-management-options-cached-only">
<code data-language="ts">--cached-only</code> </h3>

<p>Require that remote dependencies are already cached.</p>

<h3 id="dependency-management-options-frozen">
<code data-language="ts">--frozen</code> </h3>

<p>Error out if lockfile is out of date.</p>

<h3 id="dependency-management-options-import-map">
<code data-language="ts"><a href="https://docs.deno.com/runtime/manual/basics/import_maps">--import-map</a></code> </h3>

<p>Load import map file from local file or remote URL.</p>

<h3 id="dependency-management-options-lock">
<code data-language="ts">--lock</code> </h3>

<p>Check the specified lock file. (If value is not provided, defaults to "./deno.lock").</p>

<h3 id="dependency-management-options-no-lock">
<code data-language="ts">--no-lock</code> </h3>

<p>Disable auto discovery of the lock file.</p>

<h3 id="dependency-management-options-no-npm">
<code data-language="ts">--no-npm</code> </h3>

<p>Do not resolve npm modules.</p>

<h3 id="dependency-management-options-no-remote">
<code data-language="ts">--no-remote</code> </h3>

<p>Do not resolve remote modules.</p>

<h3 id="dependency-management-options-node-modules-dir">
<code data-language="ts">--node-modules-dir</code> </h3>

<p>Sets the node modules management mode for npm packages.</p>

<h3 id="dependency-management-options-reload">
<code data-language="ts">--reload</code> </h3>
<p>Short flag: <code data-language="ts">-r</code></p>

<p>Reload source code cache (recompile TypeScript) no value Reload everything jsr:@std/http/file-server,jsr:@std/assert/assert-equals Reloads specific modules npm: Reload all npm modules npm:chalk Reload specific npm module.</p>

<h3 id="dependency-management-options-vendor">
<code data-language="ts">--vendor</code> </h3>

<p>Toggles local vendor folder usage for remote modules and a node_modules folder for npm packages.</p>

<h2 id="options">Options </h2>
<h3 id="options-allow-scripts">
<code data-language="ts">--allow-scripts</code> </h3>

<p>Allow running npm lifecycle scripts for the given packages Note: Scripts will only be executed when using a node_modules directory (<code data-language="ts">--node-modules-dir</code>).</p>

<h3 id="options-cert">
<code data-language="ts">--cert</code> </h3>

<p>Load certificate authority from PEM encoded file.</p>

<h3 id="options-config">
<code data-language="ts"><a href="https://docs.deno.com/go/config">--config</a></code> </h3>
<p>Short flag: <code data-language="ts">-c</code></p>

<p>Configure different aspects of deno including TypeScript, linting, and code formatting Typically the configuration file will be called <code data-language="ts">deno.json</code> or <code data-language="ts">deno.jsonc</code> and automatically detected; in that case this flag is not necessary.</p>

<h3 id="options-env-file">
<code data-language="ts">--env-file</code> </h3>

<p>Load environment variables from local file Only the first environment variable with a given key is used. Existing process environment variables are not overwritten, so if variables with the same names already exist in the environment, their values will be preserved. Where multiple declarations for the same environment variable exist in your .env file, the first one encountered is applied. This is determined by the order of the files you pass as arguments.</p>

<h3 id="options-ext">
<code data-language="ts">--ext</code> </h3>

<p>Set content type of the supplied file.</p>

<h3 id="options-filter">
<code data-language="ts">--filter</code> </h3>

<p>Run benchmarks with this string or regexp pattern in the bench name.</p>

<h3 id="options-ignore">
<code data-language="ts">--ignore</code> </h3>

<p>Ignore files.</p>

<h3 id="options-json">
<code data-language="ts">--json</code> </h3>

<p>UNSTABLE: Output benchmark result in JSON format.</p>

<h3 id="options-location">
<code data-language="ts">--location</code> </h3>

<p>Value of globalThis.location used by some web APIs.</p>

<h3 id="options-no-config">
<code data-language="ts">--no-config</code> </h3>

<p>Disable automatic loading of the configuration file.</p>

<h3 id="options-no-run">
<code data-language="ts">--no-run</code> </h3>

<p>Cache bench modules, but don't run benchmarks.</p>

<h3 id="options-seed">
<code data-language="ts">--seed</code> </h3>

<p>Set the random number generator seed.</p>

<h3 id="options-v8-flags">
<code data-language="ts">--v8-flags</code> </h3>

<p>To see a list of all available flags use<code data-language="ts"> --v8-flags=--help</code> Flags can also be set via the DENO_V8_FLAGS environment variable. Any flags set with this flag are appended after the DENO_V8_FLAGS environment variable.</p>

<h2 id="file-watching-options">File watching options </h2>
<h3 id="file-watching-options-no-clear-screen">
<code data-language="ts">--no-clear-screen</code> </h3>

<p>Do not clear terminal screen when under watch mode.</p>

<h3 id="file-watching-options-watch">
<code data-language="ts">--watch</code> </h3>

<p>Watch for file changes and restart process automatically. Only local files from entry point module graph are watched.</p>

<h3 id="file-watching-options-watch-exclude">
<code data-language="ts">--watch-exclude</code> </h3>

<p>Exclude provided files/patterns from watch mode.</p>

</div>
<div>
<h2 id="quickstart" tabindex="-1">Quickstart </h2> <p>Firstly, let's create a file <code data-language="ts">url_bench.ts</code> and register a bench using the <code data-language="ts">Deno.bench()</code> function.</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts"><span class="token comment">// url_bench.ts</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"URL parsing"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<p>Secondly, run the benchmark using the <code data-language="ts">deno bench</code> subcommand.</p> <div class="relative">
<pre class="language-sh" tabindex="0"><code data-language="sh">deno bench url_bench.ts
cpu: Apple M1 Max
runtime: deno <span class="token number">1.21</span>.0 <span class="token punctuation">(</span>aarch64-apple-darwin<span class="token punctuation">)</span>

file:///dev/deno/url_bench.ts
benchmark        <span class="token function">time</span> <span class="token punctuation">(</span>avg<span class="token punctuation">)</span>             <span class="token punctuation">(</span>min … max<span class="token punctuation">)</span>       p75       p99      p995
--------------------------------------------------- -----------------------------
URL parsing   <span class="token number">17.29</span> µs/iter  <span class="token punctuation">(</span><span class="token number">16.67</span> µs … <span class="token number">153.62</span> µs<span class="token punctuation">)</span>  <span class="token number">17.25</span> µs  <span class="token number">18.92</span> µs  <span class="token number">22.25</span> µs
</code></pre>   </div>
<h2 id="writing-benchmarks" tabindex="-1">Writing benchmarks </h2> <p>To define a benchmark you need to register it with a call to the <code data-language="ts">Deno.bench</code> API. There are multiple overloads of this API to allow for the greatest flexibility and easy switching between the forms (eg. when you need to quickly focus a single bench for debugging, using the <code data-language="ts">only: true</code> option):</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts"><span class="token comment">// Compact form: name and function</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"hello world #1"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Compact form: named function.</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token function">helloWorld3</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Longer form: bench definition.</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"hello world #2"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Similar to compact form, with additional configuration as a second argument.</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"hello world #4"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> permissions<span class="token operator">:</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Similar to longer form, with bench function as a second argument.</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"hello world #5"</span><span class="token punctuation">,</span> permissions<span class="token operator">:</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Similar to longer form, with a named bench function as a second argument.</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span> permissions<span class="token operator">:</span> <span class="token punctuation">{</span> read<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token function">helloWorld6</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<h3 id="async-functions" tabindex="-1">Async functions </h3> <p>You can also bench asynchronous code by passing a bench function that returns a promise. For this you can use the <code data-language="ts">async</code> keyword when defining a function:</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts">Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"async hello world"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">await</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<h3 id="critical-sections" tabindex="-1">Critical sections </h3> <p>Sometimes the benchmark case needs to include setup and teardown code that would taint the benchmark results. For example, if you want to measure how long it takes to read a small file, you need to open the file, read it, and then close it. If the file is small enough the time it takes to open and close the file might outweigh the time it takes to read the file itself.</p> <p>To help with such situations you can <code data-language="ts">Deno.BenchContext.start</code> and <code data-language="ts">Deno.BenchContext.end</code> to tell the benchmarking tool about the critical section you want to measure. Everything outside of the section between these two calls will be excluded from the measurement.</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts">Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"foo"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Open a file that we will act upon.</span>
  <span class="token keyword">const</span> file <span class="token operator">=</span> <span class="token keyword">await</span> Deno<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"a_big_data_file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Tell the benchmarking tool that this is the only section you want</span>
  <span class="token comment">// to measure.</span>
  b<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Now let's measure how long it takes to read all of the data from the file.</span>
  <span class="token keyword">await</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>readable<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">arrayBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// End measurement here.</span>
  b<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// Now we can perform some potentially time-consuming teardown that will not</span>
  <span class="token comment">// taint out benchmark results.</span>
  file<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<h2 id="grouping-and-baselines" tabindex="-1">Grouping and baselines </h2> <p>When registering a bench case, it can be assigned to a group, using <code data-language="ts">Deno.BenchDefinition.group</code> option:</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts"><span class="token comment">// url_bench.ts</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"url parse"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> group<span class="token operator">:</span> <span class="token string">"url"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token string">"https://deno.land"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<p>It is useful to assign several cases to a single group and compare how they perform against a "baseline" case.</p> <p>In this example we'll check how performant is <code data-language="ts">Date.now()</code> compared to <code data-language="ts">performance.now()</code>, to do that we'll mark the first case as a "baseline" using <code data-language="ts">Deno.BenchDefinition.baseline</code> option:</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts"><span class="token comment">// time_bench.ts</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"Date.now()"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> group<span class="token operator">:</span> <span class="token string">"timing"</span><span class="token punctuation">,</span> baseline<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token string">"performance.now()"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> group<span class="token operator">:</span> <span class="token string">"timing"</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  performance<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<div class="relative">
<pre class="language-shellsesssion" tabindex="0"><code data-language="shellsesssion">$ deno bench time_bench.ts
cpu: Apple M1 Max
runtime: deno 1.21.0 (aarch64-apple-darwin)

file:///dev/deno/time_bench.ts
benchmark              time (avg)             (min … max)       p75       p99      p995
--------------------------------------------------------- -----------------------------
Date.now()         125.24 ns/iter (118.98 ns … 559.95 ns) 123.62 ns 150.69 ns 156.63 ns
performance.now()    2.67 µs/iter     (2.64 µs … 2.82 µs)   2.67 µs   2.82 µs   2.82 µs

summary
  Date.now()
   21.29x times faster than performance.now()
</code></pre>   </div>
<p>You can specify multiple groups in the same file.</p> <h2 id="running-benchmarks" tabindex="-1">Running benchmarks </h2> <p>To run a benchmark, call <code data-language="ts">deno bench</code> with the file that contains your bench function. You can also omit the file name, in which case all benchmarks in the current directory (recursively) that match the glob <code data-language="ts">{*_,*.,}bench.{ts, tsx, mts, js, mjs, jsx}</code> will be run. If you pass a directory, all files in the directory that match this glob will be run.</p> <p>The glob expands to:</p> <ul> <li>files named <code data-language="ts">bench.{ts, tsx, mts, js, mjs, jsx}</code>,</li> <li>or files ending with <code data-language="ts">.bench.{ts, tsx, mts, js, mjs, jsx}</code>,</li> <li>or files ending with <code data-language="ts">_bench.{ts, tsx, mts, js, mjs, jsx}</code>
</li> </ul> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell"><span class="token comment"># Run all benches in the current directory and all sub-directories</span>
deno bench

<span class="token comment"># Run all benches in the util directory</span>
deno bench util/

<span class="token comment"># Run just my_bench.ts</span>
deno bench my_bench.ts
</code></pre>   </div>
<blockquote> <p>⚠️ If you want to pass additional CLI arguments to the bench files use <code data-language="ts">--</code> to inform Deno that remaining arguments are scripts arguments.</p> </blockquote> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell"><span class="token comment"># Pass additional arguments to the bench file</span>
deno bench my_bench.ts -- <span class="token parameter variable">-e</span> <span class="token parameter variable">--foo</span> <span class="token parameter variable">--bar</span>
</code></pre>   </div>
<p><code data-language="ts">deno bench</code> uses the same permission model as <code data-language="ts">deno run</code> and therefore will require, for example, <code data-language="ts">--allow-write</code> to write to the file system during benching.</p> <p>To see all runtime options with <code data-language="ts">deno bench</code>, you can reference the command line help:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deno <span class="token builtin class-name">help</span> bench
</code></pre>   </div>
<h2 id="filtering" tabindex="-1">Filtering </h2> <p>There are a number of options to filter the benches you are running.</p> <h3 id="command-line-filtering" tabindex="-1">Command line filtering </h3> <p>Benches can be run individually or in groups using the command line <code data-language="ts">--filter</code> option.</p> <p>The filter flags accept a string or a pattern as value.</p> <p>Assuming the following benches:</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts">Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"my-bench"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* bench function zero */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"bench-1"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* bench function one */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"bench2"</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fn</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token comment">/* bench function two */</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<p>This command will run all of these benches because they all contain the word "bench".</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deno bench <span class="token parameter variable">--filter</span> <span class="token string">"bench"</span> benchmarks/
</code></pre>   </div>
<p>On the flip side, the following command uses a pattern and will run the second and third benchmarks.</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deno bench <span class="token parameter variable">--filter</span> <span class="token string">"/bench-*\d/"</span> benchmarks/
</code></pre>   </div>
<p><em>To let Deno know that you want to use a pattern, wrap your filter with forward-slashes like the JavaScript syntactic sugar for a regex.</em></p> <h3 id="bench-definition-filtering" tabindex="-1">Bench definition filtering </h3> <p>Within the benches themselves, you have two options for filtering.</p> <h4 id="filtering-out-(ignoring-these-benches)" tabindex="-1">Filtering out (ignoring these benches) </h4> <p>Sometimes you want to ignore benches based on some sort of condition (for example you only want a benchmark to run on Windows). For this you can use the <code data-language="ts">ignore</code> boolean in the bench definition. If it is set to true the bench will be skipped.</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts">Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"bench windows feature"</span><span class="token punctuation">,</span>
  ignore<span class="token operator">:</span> Deno<span class="token punctuation">.</span>build<span class="token punctuation">.</span>os <span class="token operator">!==</span> <span class="token string">"windows"</span><span class="token punctuation">,</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// do windows feature</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<h4 id="filtering-in-(only-run-these-benches)" tabindex="-1">Filtering in (only run these benches) </h4> <p>Sometimes you may be in the middle of a performance problem within a large bench class and you would like to focus on just that single bench and ignore the rest for now. For this you can use the <code data-language="ts">only</code> option to tell the benchmark harness to only run benches with this set to true. Multiple benches can set this option. While the benchmark run will report on the success or failure of each bench, the overall benchmark run will always fail if any bench is flagged with <code data-language="ts">only</code>, as this is a temporary measure only which disables nearly all of your benchmarks.</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts">Deno<span class="token punctuation">.</span><span class="token function">bench</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">"Focus on this bench only"</span><span class="token punctuation">,</span>
  only<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// bench complicated stuff</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<h2 id="json-output" tabindex="-1">JSON output </h2> <p>To retrieve the output as JSON, use the <code data-language="ts">--json</code> flag:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">$ deno bench --json bench_me.js
{
  "runtime": "Deno/1.31.0 x86_64-apple-darwin",
  "cpu": "Intel(R) Core(TM) i7-9750H CPU @ 2.60GHz",
  "benches": [
    "origin": "file:///dev/bench_me.js",
    "group": null,
    "name": "Deno.UnsafePointerView#getUint32",
    "baseline": false,
    "result": {
      "ok": {
        "n": 49,
        "min": 1251.9348,
        "max": 1441.2696,
        "avg": 1308.7523755102038,
        "p75": 1324.1055,
        "p99": 1441.2696,
        "p995": 1441.2696,
        "p999": 1441.2696
      }
    }
  ]
}
</code></pre>   </div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018–2024 the Deno authors<br>Licensed under the MIT License.<br>
    <a href="https://docs.deno.com/runtime/reference/cli/bench" class="_attribution-link">https://docs.deno.com/runtime/reference/cli/bench</a>
  </p>
</div>
