<h1>KV on Deno Deploy</h1>
<div>
<p><deno-admonition></deno-admonition></p> <p>Deno Deploy now offers a built-in serverless key-value database called Deno KV.</p> <p>Additionally, Deno KV is available within Deno itself, utilizing SQLite as its backend. This feature has been accessible since Deno v1.32 with the <code data-language="ts">--unstable</code> flag. Learn more about <a href="../manual.html">Deno KV</a>.</p> <h2 id="consistency" tabindex="-1">Consistency </h2> <p>Deno KV, by default, is a strongly-consistent database. It provides the strictest form of strong consistency called <em>external consistency</em>, which implies:</p> <ul> <li>
<strong>Serializability</strong>: This is the highest level of isolation for transactions. It ensures that the concurrent execution of multiple transactions results in a system state that would be the same as if the transactions were executed sequentially, one after another. In other words, the end result of serializable transactions is equivalent to some sequential order of these transactions.</li> <li>
<strong>Linearizability</strong>: This consistency model guarantees that operations, such as read and write, appear to be instantaneous and occur in real-time. Once a write operation completes, all subsequent read operations will immediately return the updated value. Linearizability ensures a strong real-time ordering of operations, making the system more predictable and easier to reason about.</li> </ul> <p>Meanwhile, you can choose to relax consistency constraints by setting the <code data-language="ts">consistency: "eventual"</code> option on individual read operations. This option allows the system to serve the read from global replicas and caches for minimal latency.</p> <p>Below are the latency figures observed in our top regions:</p> <table> <thead> <tr> <th>Region</th> <th>Latency (Eventual Consistency)</th> <th>Latency (Strong Consistency)</th> </tr> </thead> <tbody> <tr> <td>North Virginia (us-east4)</td> <td>7ms</td> <td>7ms</td> </tr> <tr> <td>Frankfurt (europe-west3)</td> <td>7ms</td> <td>94ms</td> </tr> <tr> <td>Netherlands (europe-west4)</td> <td>13ms</td> <td>95ms</td> </tr> <tr> <td>California (us-west2)</td> <td>72ms</td> <td>72ms</td> </tr> <tr> <td>Hong Kong (asia-east2)</td> <td>42ms</td> <td>194ms</td> </tr> </tbody> </table> <h2 id="distributed-queues" tabindex="-1">Distributed queues </h2> <p>Serverless distributed queues are available on Deno Deploy. See <a href="queue_overview.html#queues-on-deno-deploy">Queues on Deno Deploy</a> for more details.</p> <h2 id="connect-to-managed-databases-from-outside-of-deno-deploy" tabindex="-1">Connect to managed databases from outside of Deno Deploy </h2> <p>You can connect to your Deno Deploy KV database from your Deno application outside of Deno Deploy. To open a managed database, set the <code data-language="ts">DENO_KV_ACCESS_TOKEN</code> environment variable to a Deno Deploy personal access token and provide the URL of the database to <code data-language="ts">Deno.openKv</code>:</p> <div class="relative">
<pre class="language-ts" tabindex="0"><code data-language="ts"><span class="token keyword">const</span> kv <span class="token operator">=</span> <span class="token keyword">await</span> Deno<span class="token punctuation">.</span><span class="token function">openKv</span><span class="token punctuation">(</span>
  <span class="token string">"https://api.deno.com/databases/&lt;database-id&gt;/connect"</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>   </div>
<p>Please check the <a href="https://github.com/denoland/deno/tree/main/ext/kv#kv-connect">docs</a> for the specification of the protocol for connecting to a remote KV database</p> <h2 id="data-distribution" tabindex="-1">Data distribution </h2> <p>Deno KV databases are replicated across at least 6 data centers, spanning 3 regions (US, Europe, and Asia). Once a write operation is committed, its mutations are persistently stored in a minimum of two data centers within the primary region. Asynchronous replication typically transfers these mutations to the other two regions in under 10 seconds.</p> <p>The system is designed to tolerate most data center-level failures without experiencing downtime or data loss. Recovery Point Objectives (RPO) and Recovery Time Objectives (RTO) help quantify the system's resilience under various failure modes. RPO represents the maximum acceptable amount of data loss measured in time, whereas RTO signifies the maximum acceptable time required to restore the system to normal operations after a failure.</p> <ul> <li>Loss of one data center in the primary region: RPO=0 (no data loss), RTO&lt;5s (system restoration in under 5 seconds)</li> <li>Loss of any number of data centers in a replica region: RPO=0, RTO&lt;5s</li> <li>Loss of two or more data centers in the primary region: RPO&lt;60s (under 60 seconds of data loss)</li> </ul> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018â€“2024 the Deno authors<br>Licensed under the MIT License.<br>
    <a href="https://docs.deno.com/deploy/kv/manual/on_deploy" class="_attribution-link">https://docs.deno.com/deploy/kv/manual/on_deploy</a>
  </p>
</div>
