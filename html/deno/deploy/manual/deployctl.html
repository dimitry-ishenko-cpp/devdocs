<h1>Using deployctl on the command line</h1>
<div>
<p><code data-language="ts">deployctl</code> is a command line tool (CLI) that lets you operate the Deno Deploy platform without leaving your terminal. With it you can deploy your code, create and manage your projects and their deployments, and monitor their usage and logs.</p> <h2 id="dependencies" tabindex="-1">Dependencies </h2> <p>The only dependency for <code data-language="ts">deployctl</code> is the Deno runtime. You can install it by running the following command:</p> <div class="relative">
<pre class="language-sh" tabindex="0"><code data-language="sh"><span class="token function">curl</span> <span class="token parameter variable">-fsSL</span> https://deno.land/install.sh <span class="token operator">|</span> <span class="token function">sh</span>
</code></pre>   </div>
<p>You don't need to setup a Deno Deploy account beforehand. It will be created along the way when you deploy your first project.</p> <h2 id="install-deployctl" tabindex="-1">Install <code data-language="ts">deployctl</code> </h2> <p>With the Deno runtime installed, you can install the <code data-language="ts">deployctl</code> utility with the following command:</p> <div class="relative">
<pre class="language-sh" tabindex="0"><code data-language="sh">deno <span class="token function">install</span> <span class="token parameter variable">-gArf</span> jsr:@deno/deployctl
</code></pre>   </div>
<p>The <code data-language="ts">-A</code> option in the deno install command grants all permissions to the installed script. You can opt not to use it, in which case you will be prompted to grant the necessary permissions when needed during the execution of the tool.</p> <h2 id="deploy" tabindex="-1">Deploy </h2> <p>To perform a new deployment of your code, navigate to the root directory of your project and execute:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy
</code></pre>   </div>
<h3 id="project-and-entrypoint" tabindex="-1">Project and Entrypoint </h3> <p>If this is the first deployment of the project, <code data-language="ts">deployctl</code> will guess the project name based on the Git repo or directory it is in. Similarly, it will guess the entrypoint by looking for files with common entrypoint names (main.ts, src/main.ts, etc). After the first deployment, the settings used will be stored in a config file (by default deno.json).</p> <p>You can specify the project name and/or the entrypoint using the <code data-language="ts">--project</code> and <code data-language="ts">--entrypoint</code> arguments respectively. If the project does not exist, it will be created automatically. By default it is created in the personal organization of the user, but it can also be created in a custom organization by specifying the <code data-language="ts">--org</code> argument. If the organization does not exist yet, it will also be created automatically.</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--project</span><span class="token operator">=</span>helloworld <span class="token parameter variable">--entrypoint</span><span class="token operator">=</span>src/entrypoint.ts <span class="token parameter variable">--org</span><span class="token operator">=</span>my-team
</code></pre>   </div>
<h3 id="include-and-exclude-files" tabindex="-1">Include and Exclude Files </h3> <p>By default, deployctl deploys all the files in the current directory (recursively, except <code data-language="ts">node_modules</code> directories). You can customize this behavior using the <code data-language="ts">--include</code> and <code data-language="ts">--exclude</code> arguments (also supported in the config file). These arguments accept specific files, whole directories and globs. Here are some examples:</p> <ul> <li> <p>Include only source and static files:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--include</span><span class="token operator">=</span>./src <span class="token parameter variable">--include</span><span class="token operator">=</span>./static
</code></pre>   </div>
</li> <li> <p>Include only Typescript files:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--include</span><span class="token operator">=</span>**/*.ts
</code></pre>   </div>
</li> <li> <p>Exclude local tooling and artifacts</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--exclude</span><span class="token operator">=</span>./tools <span class="token parameter variable">--exclude</span><span class="token operator">=</span>./benches
</code></pre>   </div>
</li> </ul> <p>A common pitfall is to not include the source code modules that need to be run (entrypoint and dependencies). The following example will fail because <code data-language="ts">main.ts</code> is not included:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--include</span><span class="token operator">=</span>./static <span class="token parameter variable">--entrypoint</span><span class="token operator">=</span>./main.ts
</code></pre>   </div>
<p>The entrypoint can also be a remote script. A common use case for this is to deploy an static site using <code data-language="ts">std/http/file_server.ts</code> (more details in <a href="../tutorials/static-site.html">Static Site Tutorial</a>):</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--include</span><span class="token operator">=</span>dist <span class="token parameter variable">--entrypoint</span><span class="token operator">=</span>jsr:@std/http/file_server
</code></pre>   </div>
<h3 id="environment-variables" tabindex="-1">Environment variables </h3> <p>You can set env variables using <code data-language="ts">--env</code> (to set individual environment variables) or <code data-language="ts">--env-file</code> (to load one or more environment files). These options can be combined and used multiple times:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy --env-file --env-file<span class="token operator">=</span>.other-env <span class="token parameter variable">--env</span><span class="token operator">=</span>DEPLOYMENT_TS<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
</code></pre>   </div>
<p>The deployment will have access to these variables using <code data-language="ts">Deno.env.get()</code>. Be aware that the env variables set with <code data-language="ts">--env</code> and <code data-language="ts">--env-file</code> are specific for the deployment being created and are not added to the list of <a href="environment-variables.html">env variables configured for the project</a>.</p> <h3 id="production-deployments" tabindex="-1">Production Deployments </h3> <p>Each deployment you create have a unique URL. In addition, a project has a "production URL" and custom domains routing trafffic to its "production" deployment. Deployments can be promoted to production at any time, or created directly as production using the <code data-language="ts">--prod</code> flag:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deploy <span class="token parameter variable">--prod</span>
</code></pre>   </div>
<p>Learn more about production deployments in the <a href="deployments.html">Deployments</a> docs.</p> <h2 id="deployments" tabindex="-1">Deployments </h2> <p>The deployments subcommand groups all the operations around deployments.</p> <h3 id="list" tabindex="-1">List </h3> <p>You can list the deployments of a project with:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments list
</code></pre>   </div>
<p>Output:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">✔ Page 1 of the list of deployments of the project 'my-project' is ready
┌───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
│  Deployment  │               Date               │   Status   │  Database  │                       Domain                       │ Entrypoint │  Branch  │  Commit  │
├───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┤
│ kcbxc4xwe4mc │ 12/3/2024 13:21:40 CET (2 days)  │ Preview    │ Preview    │ https://my-project-kcbxc4xwe4mc.deno.dev │ main.ts    │ main     │ 4b6c506  │
│ c0ph5xa9exb3 │ 12/3/2024 13:21:25 CET (2 days)  │ Production │ Production │ https://my-project-c0ph5xa9exb3.deno.dev │ main.ts    │ main     │ 4b6c506  │
│ kwkbev9er4h2 │ 12/3/2024 13:21:12 CET (2 days)  │ Preview    │ Preview    │ https://my-project-kwkbev9er4h2.deno.dev │ main.ts    │ main     │ 4b6c506  │
│ dxseq0jc8402 │ 6/3/2024 23:16:51 CET (8 days)   │ Preview    │ Production │ https://my-project-dxseq0jc8402.deno.dev │ main.ts    │ main     │ 099359b  │
│ 7xr5thz8yjbz │ 6/3/2024 22:58:32 CET (8 days)   │ Preview    │ Preview    │ https://my-project-7xr5thz8yjbz.deno.dev │ main.ts    │ another  │ a4d2953  │
│ 4qr4h5ac3rfn │ 6/3/2024 22:57:05 CET (8 days)   │ Failed     │ Preview    │ n/a                                                │ main.ts    │ another  │ 56d2c88  │
│ 25wryhcqmb9q │ 6/3/2024 22:56:41 CET (8 days)   │ Preview    │ Preview    │ https://my-project-25wryhcqmb9q.deno.dev │ main.ts    │ another  │ 4b6c506  │
│ 64tbrn8jre9n │ 6/3/2024 8:21:33 CET (8 days)    │ Preview    │ Production │ https://my-project-64tbrn8jre9n.deno.dev │ main.ts    │ main     │ 4b6c506  │
│ hgqgccnmzg04 │ 6/3/2024 8:17:40 CET (8 days)    │ Failed     │ Production │ n/a                                                │ main.ts    │ main     │ 8071902  │
│ rxkh1w3g74e8 │ 6/3/2024 8:17:28 CET (8 days)    │ Failed     │ Production │ n/a                                                │ main.ts    │ main     │ b142a59  │
│ wx6cw9aya64c │ 6/3/2024 8:02:29 CET (8 days)    │ Preview    │ Production │ https://my-project-wx6cw9aya64c.deno.dev │ main.ts    │ main     │ b803784  │
│ a1qh5fmew2yf │ 5/3/2024 16:25:29 CET (9 days)   │ Preview    │ Production │ https://my-project-a1qh5fmew2yf.deno.dev │ main.ts    │ main     │ 4bb1f0f  │
│ w6pf4r0rrdkb │ 5/3/2024 16:07:35 CET (9 days)   │ Preview    │ Production │ https://my-project-w6pf4r0rrdkb.deno.dev │ main.ts    │ main     │ 6e487fc  │
│ nn700gexgdzq │ 5/3/2024 13:37:11 CET (9 days)   │ Preview    │ Production │ https://my-project-nn700gexgdzq.deno.dev │ main.ts    │ main     │ c5b1d1f  │
│ 98crfqxa6vvf │ 5/3/2024 13:33:52 CET (9 days)   │ Preview    │ Production │ https://my-project-98crfqxa6vvf.deno.dev │ main.ts    │ main     │ 090146e  │
│ xcdcs014yc5p │ 5/3/2024 13:30:58 CET (9 days)   │ Preview    │ Production │ https://my-project-xcdcs014yc5p.deno.dev │ main.ts    │ main     │ 5b78c0f  │
│ btw43kx89ws1 │ 5/3/2024 13:27:31 CET (9 days)   │ Preview    │ Production │ https://my-project-btw43kx89ws1.deno.dev │ main.ts    │ main     │ 663452a  │
│ 62tg1ketkjx7 │ 5/3/2024 13:27:03 CET (9 days)   │ Preview    │ Production │ https://my-project-62tg1ketkjx7.deno.dev │ main.ts    │ main     │ 24d1618  │
│ 07ag6pt6kjex │ 5/3/2024 13:19:11 CET (9 days)   │ Preview    │ Production │ https://my-project-07ag6pt6kjex.deno.dev │ main.ts    │ main     │ 4944545  │
│ 4msyne1rvwj1 │ 5/3/2024 13:17:16 CET (9 days)   │ Preview    │ Production │ https://my-project-4msyne1rvwj1.deno.dev │ main.ts    │ main     │ dda85e1  │
└───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
Press enter to fetch the next page [Enter]
</code></pre>   </div>
<p>This command outputs pages of 20 deployments by default. You can iterate over the pages with the enter key, and use the <code data-language="ts">--page</code> and <code data-language="ts">--limit</code> options to query a specific page and page size.</p> <p>Like with the rest of commands, you can use the <code data-language="ts">--project</code> option to specify the project of which to list deployments, if you are not in a project directory or want to list deployments from a different project.</p> <h3 id="show" tabindex="-1">Show </h3> <p>Get all the details of a particular deployment using:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments show
</code></pre>   </div>
<p>Output:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">✔ The production deployment of the project 'my-project' is 'c0ph5xa9exb3'
✔ The details of the deployment 'c0ph5xa9exb3' are ready:

c0ph5xa9exb3
------------
Status:       Production
Date:         2 days, 12 hours, 29 minutes, 46 seconds ago (12/3/2024 13:21:25 CET)
Project:      my-project (e54f23b5-828d-4b7f-af12-706d4591062b)
Organization:	my-team (d97822ac-ee20-4ce9-b942-5389330b57ee)
Domain(s):    https://my-project.deno.dev
              https://my-project-c0ph5xa9exb3.deno.dev
Database:     Production (0efa985f-3793-48bc-8c05-f740ffab4ca0)
Entrypoint:   main.ts
Env Vars:     HOME
Git
  Ref:        main [4b6c506]
  Message:    change name
  Author:     John Doe @johndoe [mailto:johndoe@deno.com]
  Url:        https://github.com/arnauorriols/my-project/commit/4b6c50629ceeeb86601347732d01dc7ed63bf34f
Crons:        another cron [*/10 * * * *] succeeded at 15/3/2024 1:50:00 CET after 2 seconds (next at 15/3/2024 2:00:00 CET)
              newest cron [*/10 * * * *] n/a
              yet another cron [*/10 * * * *] failed at 15/3/2024 1:40:00 CET after 2 seconds (next at 15/3/2024 1:51:54 CET)
</code></pre>   </div>
<p>If no deployment is specified, the command shows the details of the current production deployment of the project. To see the details of the last deployment, use <code data-language="ts">--last</code>, and to see the details of a particular deployment, use <code data-language="ts">--id</code> (or positional argument). You can also use <code data-language="ts">--next</code> or <code data-language="ts">--prev</code> to navigate the deployments chronologically.</p> <p>For example, to see the details of the second to last deployment, you can do:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments show <span class="token parameter variable">--last</span> <span class="token parameter variable">--prev</span>
</code></pre>   </div>
<p>And to see the details of 2 deployments after a specific deployment:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments show 64tbrn8jre9n <span class="token parameter variable">--next</span><span class="token operator">=</span><span class="token number">2</span>
</code></pre>   </div>
<h3 id="redeploy" tabindex="-1">Redeploy </h3> <p>The redeploy command creates a new deployment reusing the build of an existing deployment, for the purpose of changing the resources associated with it. This includes production domains, environment variables and KV databases.</p> 
<div class="admonition info"> <div class="title">Info</div>  <p>The semantics of selecting the deployment to redeploy are the same as those of the <a href="#show">show subcommand</a>, including <code data-language="ts">--last</code>, <code data-language="ts">--id</code>, <code data-language="ts">--next</code> and <code data-language="ts">--prev</code>.</p> 
</div>  <h4 id="production-domains" tabindex="-1">Production Domains </h4> <p>If you want to change the routing of the production domains of the project to a particular deployment, you can redeploy it with the <code data-language="ts">--prod</code> option:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments redeploy <span class="token parameter variable">--prod</span> 64tbrn8jre9n
</code></pre>   </div>
<p>This will create a new deployment with the same code and environment variables as the specified deployment, but with the production domains of the project pointing to it. For those projects with preview/prod databases (ie projects linked to GitHub), this will also set the production database for the new deployment.</p> 
<div class="admonition note"> <div class="title">Note</div>  <p>This feature is similar to the "promote to production" button found in the Deno Deploy web application with the exception that the "promote to production" button does not create a new deployment. Instead, the "promote to production" button changes the domain routing in-place, however it's restricted to deployments already using the production database.</p> 
</div>  <h4 id="kv-database" tabindex="-1">KV Database </h4> <p>If this is a GitHub deployment, it will have 2 databases, one for prod deployments and one for preview deployments. You can change the database of a deployment by redeploying it with the <code data-language="ts">--db</code> option:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments redeploy <span class="token parameter variable">--db</span><span class="token operator">=</span>prod <span class="token parameter variable">--id</span><span class="token operator">=</span>64tbrn8jre9n
</code></pre>   </div>

<div class="admonition note"> <div class="title">Note</div>  <p>When redeploying a deployment to prod, by default it will automatically configure it to use the prod database. You can combine both <code data-language="ts">--prod</code> and <code data-language="ts">--db</code> options to opt out of this behavior. For example, the following command will redeploy the current production deployment (given the lack of positional argument, <code data-language="ts">--id</code> or <code data-language="ts">--last</code>). The new deployment will become the new production deployment, but it will use the preview database instead of the production database:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments redeploy <span class="token parameter variable">--prod</span> <span class="token parameter variable">--db</span><span class="token operator">=</span>preview
</code></pre>   </div>

</div>  <p>If your organization has custom databases, you can also set them by UUID:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments redeploy <span class="token parameter variable">--last</span> <span class="token parameter variable">--db</span><span class="token operator">=</span>5261e096-f9aa-4b72-8440-1c2b5b553def
</code></pre>   </div>
<h4 id="environment-variables-1" tabindex="-1">Environment Variables </h4> <p>When a deployment is created, it inherits the environment variables of the project. Given that the deployments are immutable, their environment variables can never be changed. To set new environment variables in a deployment, you need to redeploy it using <code data-language="ts">--env</code> (to set individual variables) and <code data-language="ts">--env-file</code> (to load one or more environment files).</p> <p>The following command redeploys the current production deployment with the env variables defined in the <code data-language="ts">.env</code> and <code data-language="ts">.other-env</code> files, plus the <code data-language="ts">DEPLOYMENT_TS</code> variable set to the current timestamp. The resulting deployment will be a preview deployment (ie the production domains won't route traffic to it, given the lack of <code data-language="ts">--prod</code>).</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments redeploy --env-file --env-file<span class="token operator">=</span>.other-env <span class="token parameter variable">--env</span><span class="token operator">=</span>DEPLOYMENT_TS<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> +%s<span class="token variable">)</span></span>
</code></pre>   </div>

<div class="admonition note"> <div class="title">Note</div>  <p>Be aware that when changing env variables, only the env variables set in the redeploy command will be used by the new deployment. The project env variables and the env variables of the deployment being redeployed are ignored. If this does not suit your needs, please report your feedback at <a href="https://github.com/denoland/deploy_feedback/issues/">https://github.com/denoland/deploy_feedback/issues/</a></p> 
</div>  
<div class="admonition note"> <div class="title">Note</div>  <p>When you change the project environment variables in the Deno Deploy web application, the current production deployment is redeployed with the new environment variables, and the new deployment becomes the new production deployment.</p> 
</div>  <h3 id="delete" tabindex="-1">Delete </h3> <p>You can delete a deployment using the <code data-language="ts">delete</code> subcommand:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments delete 64tbrn8jre9n
</code></pre>   </div>
<p>Like <code data-language="ts">show</code> and <code data-language="ts">redeploy</code>, <code data-language="ts">delete</code> can also use <code data-language="ts">--last</code>, <code data-language="ts">--next</code> and <code data-language="ts">--prev</code> to select the deployment to delete. Here's an example command that deletes all the deployments of a project except the last (use with caution!):</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell"><span class="token keyword">while</span> deployctl deployments delete <span class="token parameter variable">--project</span><span class="token operator">=</span>my-project <span class="token parameter variable">--last</span> --prev<span class="token punctuation">;</span> <span class="token keyword">do</span> <span class="token builtin class-name">:</span><span class="token punctuation">;</span> <span class="token keyword">done</span>
</code></pre>   </div>
<h2 id="projects" tabindex="-1">Projects </h2> <p>The <code data-language="ts">projects</code> subcommand groups all the operations against projects as a whole. this includes <code data-language="ts">list</code>, <code data-language="ts">show</code>, <code data-language="ts">rename</code>, <code data-language="ts">create</code> and <code data-language="ts">delete</code>.</p> <h3 id="list-1" tabindex="-1">List </h3> <p><code data-language="ts">deployctl projects list</code> outputs all the projects your user has access to, grouped by organization:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">Personal org:
    blog
    url-shortener

'my-team' org:
    admin-site
    main-site
    analytics
</code></pre>   </div>
<p>You can filter by organization using <code data-language="ts">--org</code>:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl projects list <span class="token parameter variable">--org</span><span class="token operator">=</span>my-team
</code></pre>   </div>
<h3 id="show-1" tabindex="-1">Show </h3> <p>To see the details of a particular project, use <code data-language="ts">projects show</code>. If you are inside a project, it will pick up the project id from the config file. You can also specify the project using <code data-language="ts">--project</code> or the positional argument:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl projects show main-site
</code></pre>   </div>
<p>Output:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">main-site
---------
Organization:	my-team (5261e096-f9aa-4b72-8440-1c2b5b553def)
Domain(s):  	https://my-team.com
		          https://main-site.deno.dev
Dash URL:	    https://dash.deno.com/projects/8422c515-f68f-49b2-89f3-157f4b144611
Repository:	  https://github.com/my-team/main-site
Databases:  	[main] dd28e63e-f495-416b-909a-183380e3a232
		          [*] e061c76e-4445-409a-bc36-a1a9040c83b3
Crons:		    another cron [*/10 * * * *] succeeded at 12/3/2024 14:40:00 CET after 2 seconds (next at 12/3/2024 14:50:00 CET)
		          newest cron [*/10 * * * *] n/a
		          yet another cron [*/10 * * * *] failed at 12/3/2024 14:40:00 CET after 2 seconds (next at 12/3/2024 14:50:00 CET)
Deployments:	kcbxc4xwe4mc	c0ph5xa9exb3*	kwkbev9er4h2	dxseq0jc8402	7xr5thz8yjbz
		          4qr4h5ac3rfn	25wryhcqmb9q	64tbrn8jre9n	hgqgccnmzg04	rxkh1w3g74e8
		          wx6cw9aya64c	a1qh5fmew2yf	w6pf4r0rrdkb	nn700gexgdzq	98crfqxa6vvf
		          xcdcs014yc5p	btw43kx89ws1	62tg1ketkjx7	07ag6pt6kjex	4msyne1rvwj1
</code></pre>   </div>
<h3 id="rename" tabindex="-1">Rename </h3> <p>Projects can be renamed easily with the <code data-language="ts">rename</code> subcommand. Similarly to the other commands, if you run the command from within a project's directory, you don't need to specify the current name of the project:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl projects <span class="token function">rename</span> my-personal-blog
</code></pre>   </div>
<p>Output:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">ℹ Using config file '/private/tmp/blog/deno.json'
✔ Project 'blog' (8422c515-f68f-49b2-89f3-157f4b144611) found
✔ Project 'blog' renamed to 'my-personal-blog'
</code></pre>   </div>

<div class="admonition note"> <div class="title">Note</div>  <p>Keep in mind that the name of the project is part of the preview domains (<a href="https://my-personal-blog-kcbxc4xwe4mc.deno.dev">https://my-personal-blog-kcbxc4xwe4mc.deno.dev</a>) and the default production domain (<a href="https://my-personal-blog.deno.dev">https://my-personal-blog.deno.dev</a>). Therefore, when changing the project name, the URLs with the previous name will no longer route to the project's corresponding deployments.</p> 
</div>  <h3 id="create" tabindex="-1">Create </h3> <p>You can create an empty project with:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl projects create my-new-project
</code></pre>   </div>
<h3 id="delete-1" tabindex="-1">Delete </h3> <p>You can delete a project with:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl projects delete my-new-project
</code></pre>   </div>
<h2 id="top" tabindex="-1">Top </h2> <p>The <code data-language="ts">top</code> subcommand is used to monitor the resource usage of a project in real-time:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl <span class="token function">top</span>
</code></pre>   </div>
<p>Output:</p> <div class="relative">
<pre class="language-none" tabindex="0"><code data-language="none">┌────────┬────────────────┬────────────────────────┬─────────┬───────┬─────────┬──────────┬─────────────┬────────────┬─────────┬─────────┬───────────┬───────────┐
│ (idx)  │ deployment     │ region                 │ Req/min │ CPU%  │ CPU/req │ RSS/5min │ Ingress/min │ Egress/min │ KVr/min │ KVw/min │ QSenq/min │ QSdeq/min │
├────────┼────────────────┼────────────────────────┼─────────┼───────┼─────────┼──────────┼─────────────┼────────────┼─────────┼─────────┼───────────┼───────────┤
│ 6b80e8 │ "kcbxc4xwe4mc" │ "asia-northeast1"      │      80 │ 0.61  │ 4.56    │ 165.908  │ 11.657      │ 490.847    │       0 │       0 │         0 │         0 │
│ 08312f │ "kcbxc4xwe4mc" │ "asia-northeast1"      │      76 │ 3.49  │ 27.58   │ 186.278  │ 19.041      │ 3195.288   │       0 │       0 │         0 │         0 │
│ 77c10b │ "kcbxc4xwe4mc" │ "asia-south1"          │      28 │ 0.13  │ 2.86    │ 166.806  │ 7.354       │ 111.478    │       0 │       0 │         0 │         0 │
│ 15e356 │ "kcbxc4xwe4mc" │ "asia-south1"          │      66 │ 0.97  │ 8.93    │ 162.288  │ 17.56       │ 4538.371   │       0 │       0 │         0 │         0 │
│ a06817 │ "kcbxc4xwe4mc" │ "asia-southeast1"      │     126 │ 0.44  │ 2.11    │ 140.087  │ 16.504      │ 968.794    │       0 │       0 │         0 │         0 │
│ d012b6 │ "kcbxc4xwe4mc" │ "asia-southeast1"      │     119 │ 2.32  │ 11.72   │ 193.704  │ 23.44       │ 8359.829   │       0 │       0 │         0 │         0 │
│ 7d9a3d │ "kcbxc4xwe4mc" │ "australia-southeast1" │       8 │ 0.97  │ 75      │ 158.872  │ 10.538      │ 3.027      │       0 │       0 │         0 │         0 │
│ 3c21be │ "kcbxc4xwe4mc" │ "australia-southeast1" │       1 │ 0.04  │ 90      │ 105.292  │ 0.08        │ 1.642      │       0 │       0 │         0 │         0 │
│ b75dc7 │ "kcbxc4xwe4mc" │ "europe-west2"         │     461 │ 5.43  │ 7.08    │ 200.573  │ 63.842      │ 9832.936   │       0 │       0 │         0 │         0 │
│ 33607e │ "kcbxc4xwe4mc" │ "europe-west2"         │      35 │ 0.21  │ 3.69    │ 141.98   │ 9.438       │ 275.788    │       0 │       0 │         0 │         0 │
│ 9be3d2 │ "kcbxc4xwe4mc" │ "europe-west2"         │     132 │ 0.92  │ 4.19    │ 180.654  │ 15.959      │ 820.513    │       0 │       0 │         0 │         0 │
│ 33a859 │ "kcbxc4xwe4mc" │ "europe-west3"         │    1335 │ 7.57  │ 3.4     │ 172.032  │ 178.064     │ 10967.918  │       0 │       0 │         0 │         0 │
│ 3f54ce │ "kcbxc4xwe4mc" │ "europe-west4"         │     683 │ 4.76  │ 4.19    │ 187.802  │ 74.696      │ 7565.017   │       0 │       0 │         0 │         0 │
│ cf881c │ "kcbxc4xwe4mc" │ "europe-west4"         │     743 │ 3.95  │ 3.19    │ 177.213  │ 86.974      │ 6087.454   │       0 │       0 │         0 │         0 │
│ b4565b │ "kcbxc4xwe4mc" │ "me-west1"             │       3 │ 0.21  │ 55      │ 155.46   │ 2.181       │ 0.622      │       0 │       0 │         0 │         0 │
│ b97970 │ "kcbxc4xwe4mc" │ "southamerica-east1"   │       3 │ 0.08  │ 25      │ 186.049  │ 1.938       │ 0.555      │       0 │       0 │         0 │         0 │
│ fd7a08 │ "kcbxc4xwe4mc" │ "us-east4"             │       3 │ 0.32  │ 80      │ 201.101  │ 0.975       │ 58.495     │       0 │       0 │         0 │         0 │
│ 95d68a │ "kcbxc4xwe4mc" │ "us-east4"             │     133 │ 1.05  │ 4.77    │ 166.052  │ 28.107      │ 651.737    │       0 │       0 │         0 │         0 │
│ c473e7 │ "kcbxc4xwe4mc" │ "us-east4"             │       0 │ 0     │ 0       │ 174.154  │ 0.021       │ 0          │       0 │       0 │         0 │         0 │
│ ebabfb │ "kcbxc4xwe4mc" │ "us-east4"             │      19 │ 0.15  │ 4.78    │ 115.732  │ 7.764       │ 67.054     │       0 │       0 │         0 │         0 │
│ eac700 │ "kcbxc4xwe4mc" │ "us-south1"            │     114 │ 2.37  │ 12.54   │ 183.001  │ 18.401      │ 22417.397  │       0 │       0 │         0 │         0 │
│ cd2194 │ "kcbxc4xwe4mc" │ "us-south1"            │      35 │ 0.33  │ 5.68    │ 145.871  │ 8.142       │ 91.236     │       0 │       0 │         0 │         0 │
│ 140fec │ "kcbxc4xwe4mc" │ "us-west2"             │     110 │ 1.43  │ 7.84    │ 115.298  │ 18.093      │ 977.993    │       0 │       0 │         0 │         0 │
│ 51689f │ "kcbxc4xwe4mc" │ "us-west2"             │    1105 │ 7.66  │ 4.16    │ 187.277  │ 154.876     │ 14648.383  │       0 │       0 │         0 │         0 │
│ c5806e │ "kcbxc4xwe4mc" │ "us-west2"             │     620 │ 4.38  │ 4.24    │ 192.291  │ 109.086     │ 9685.688   │       0 │       0 │         0 │         0 │
└────────┴────────────────┴────────────────────────┴─────────┴───────┴─────────┴──────────┴─────────────┴────────────┴─────────┴─────────┴───────────┴───────────┘
⠼ Streaming...
</code></pre>   </div>
<p>The columns are defined as follows:</p> <table> <thead> <tr> <th>Column</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>idx</td> <td>Instance discriminator. Opaque id to discriminate different executions running in the same region.</td> </tr> <tr> <td>deployment</td> <td>The id of the deployment running in the executing instance.</td> </tr> <tr> <td>Req/min</td> <td>Requests per minute received by the project.</td> </tr> <tr> <td>CPU%</td> <td>Percentage of CPU used by the project.</td> </tr> <tr> <td>CPU/req</td> <td>CPU time per request, in milliseconds.</td> </tr> <tr> <td>RSS/5min</td> <td>Max RSS used by the project during the last 5 minutes, in MB.</td> </tr> <tr> <td>Ingress/min</td> <td>Data received by the project per minute, in KB.</td> </tr> <tr> <td>Egress/min</td> <td>Data output by the project per minute, in KB.</td> </tr> <tr> <td>KVr/min</td> <td>KV reads performed by the project per minute.</td> </tr> <tr> <td>KVw/min</td> <td>KV writes performed by the project per minute.</td> </tr> <tr> <td>QSenq/min</td> <td>Queues enqueues performed by the project per minute.</td> </tr> <tr> <td>QSdeq/min</td> <td>Queues dequeues performed by the project per minute.</td> </tr> </tbody> </table> <p>You can filter by region using <code data-language="ts">--region</code>, which accepts substrings and can be used multiple times:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl <span class="token function">top</span> <span class="token parameter variable">--region</span><span class="token operator">=</span>asia <span class="token parameter variable">--region</span><span class="token operator">=</span>southamerica
</code></pre>   </div>
<h2 id="logs" tabindex="-1">Logs </h2> <p>You can fetch the logs of your deployments with <code data-language="ts">deployctl logs</code>. It supports both live logs where the logs are streamed to the console as they are generated, and query persisted logs where the logs generated in the past are fetched.</p> <p>To show the live logs of the current production deployment of a project:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl logs
</code></pre>   </div>

<div class="admonition note"> <div class="title">Note</div>  <p>Unlike in the Deno Deploy web application, at the moment the logs subcommand does not automatically switch to the new production deployment when it changes.</p> 
</div>  <p>To show the live logs of a particular deployment:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl logs <span class="token parameter variable">--deployment</span><span class="token operator">=</span>1234567890ab
</code></pre>   </div>
<p>Logs can be filtered by level, region and text using <code data-language="ts">--levels</code> <code data-language="ts">--regions</code> and <code data-language="ts">--grep</code> options:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl logs <span class="token parameter variable">--levels</span><span class="token operator">=</span>error,info <span class="token parameter variable">--regions</span><span class="token operator">=</span>region1,region2 <span class="token parameter variable">--grep</span><span class="token operator">=</span><span class="token string">'unexpected'</span>
</code></pre>   </div>
<p>To show the persisted logs, use the <code data-language="ts">--since</code> and/or <code data-language="ts">--until</code> options:</p> <div class="deno-tabs" data-id="null">
<ul class="deno-tabs-buttons">
<li><button data-tab="mac" data-active="true">macOS</button></li>
<li><button data-tab="linux" data-active="false">Linux</button></li>
</ul>
<div class="deno-tabs-content">
<div data-tab="mac" data-active="true"> <div class="relative">
<pre class="language-sh" tabindex="0"><code data-language="sh">deployctl logs <span class="token parameter variable">--since</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token parameter variable">-Iseconds</span> -v-2H<span class="token variable">)</span></span> <span class="token parameter variable">--until</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token parameter variable">-Iseconds</span> -v-30M<span class="token variable">)</span></span>
</code></pre>   </div>
</div>
<div data-tab="linux" data-active="false"> <div class="relative">
<pre class="language-sh" tabindex="0"><code data-language="sh">deployctl logs <span class="token parameter variable">--since</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token parameter variable">-Iseconds</span> <span class="token parameter variable">--date</span><span class="token operator">=</span><span class="token string">'2 hours ago'</span><span class="token variable">)</span></span> <span class="token parameter variable">--until</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token function">date</span> <span class="token parameter variable">-Iseconds</span> <span class="token parameter variable">--date</span><span class="token operator">=</span><span class="token string">'30 minutes ago'</span><span class="token variable">)</span></span>
</code></pre>   </div>
</div>
</div>
</div> <h2 id="api" tabindex="-1">API </h2> <p>If you use the <a href="../../subhosting/manual.html">subhosting API</a>, <code data-language="ts">deployctl api</code> will help you interact with the API by handling the authentication and headers for you:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl api /projects/my-personal-blog/deployments
</code></pre>   </div>
<p>Use <code data-language="ts">--method</code> and <code data-language="ts">--body</code> to specify the HTTP method and the request body:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl api <span class="token parameter variable">--method</span><span class="token operator">=</span>POST <span class="token parameter variable">--body</span><span class="token operator">=</span><span class="token string">'{"name": "main-site"}'</span> organizations/5261e096-f9aa-4b72-8440-1c2b5b553def/projects
</code></pre>   </div>
<h2 id="local-development" tabindex="-1">Local Development </h2> <p>For local development you can use the <code data-language="ts">deno</code> CLI. To install <code data-language="ts">deno</code>, follow the instructions in the <a href="https://deno.land/manual/getting_started/installation">Deno manual</a>.</p> <p>After installation, you can run your scripts locally:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">$ deno run --allow-net<span class="token operator">=</span>:8000 ./main.ts
Listening on http://localhost:8000
</code></pre>   </div>
<p>To watch for file changes add the <code data-language="ts">--watch</code> flag:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">$ deno run --allow-net<span class="token operator">=</span>:8000 <span class="token parameter variable">--watch</span> ./main.ts
Listening on http://localhost:8000
</code></pre>   </div>
<p>For more information about the Deno CLI, and how to configure your development environment and IDE, visit the Deno Manual's <a href="https://deno.land/manual/getting_started">Getting Started</a> section.</p> <h2 id="json-output" tabindex="-1">JSON output </h2> <p>All the commands that output data have a <code data-language="ts">--format=json</code> option that outputs the data in JSON objects. This output mode is the default when stdout is not a TTY, notably when piping to another command. Together with <code data-language="ts">jq</code>, this mode enables the programmatic use of all the data provided by <code data-language="ts">deployctl</code>:</p> <p>Get the id of the current production deployment:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl deployments show <span class="token operator">|</span> jq .build.deploymentId
</code></pre>   </div>
<p>Get a csv stream of the CPU time per request on each isolate of each region:</p> <div class="relative">
<pre class="language-shell" tabindex="0"><code data-language="shell">deployctl <span class="token function">top</span> <span class="token operator">|</span> jq <span class="token parameter variable">-r</span> <span class="token string">'[.id,.region,.cpuTimePerRequest] | @csv'</span>
</code></pre>   </div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018–2024 the Deno authors<br>Licensed under the MIT License.<br>
    <a href="https://docs.deno.com/deploy/manual/deployctl" class="_attribution-link">https://docs.deno.com/deploy/manual/deployctl</a>
  </p>
</div>
