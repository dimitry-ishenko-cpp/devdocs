<h1>Compressing response bodies</h1>
<div>
<p>Compressing the response body to save bandwidth is a common practice. To take some work off your shoulder, we built the capabilities directly into Deploy.</p> <p>Deno Deploy supports brotli and gzip compression. Compression is applied when the following conditions are met.</p> <ol> <li>The request to your deployment has <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Accept-Encoding"><code data-language="ts">Accept-Encoding</code></a> header set to either <code data-language="ts">br</code> (brotli) or <code data-language="ts">gzip</code>.</li> <li>The response from your deployment includes the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code data-language="ts">Content-Type</code></a> header.</li> <li>The provided content type is compressible; we use <a href="https://github.com/jshttp/mime-db/blob/master/db.json">this database</a> to determine if the content type is compressible.</li> <li>The response body size is greater than 20 bytes.</li> </ol> <p>When Deploy compresses the response body, it will set <code data-language="ts">Content-Encoding: gzip</code> or <code data-language="ts">Content-Encoding: br</code> header to the response based on the compression algorithm used.</p> <h3 id="when-is-compression-skipped%3F" tabindex="-1">When is compression skipped? </h3> <p>Deno Deploy skips the compression if:</p> <ul> <li>The response has <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Encoding"><code data-language="ts">Content-Encoding</code></a> header.</li> <li>The response has <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Range"><code data-language="ts">Content-Range</code></a> header.</li> <li>The response's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control"><code data-language="ts">Cache-Control</code></a> header has <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cache-Control#other"><code data-language="ts">no-transform</code></a> value (e.g. <code data-language="ts">cache-control: public, no-transform</code>).</li> </ul> <h3 id="what-happens-to-my-etag-header%3F" tabindex="-1">What happens to my <code data-language="ts">Etag</code> header? </h3> <p>When you set an Etag header with the response, we convert the header value to a Weak Etag if we apply compression to your response body. If it is already a Weak Etag, we don't touch the header.</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018â€“2024 the Deno authors<br>Licensed under the MIT License.<br>
    <a href="https://docs.deno.com/deploy/api/compression" class="_attribution-link">https://docs.deno.com/deploy/api/compression</a>
  </p>
</div>
