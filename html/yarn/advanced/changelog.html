<header><h1>Changelog</h1></header><div class="theme-admonition theme-admonition-tip admonition_JrWa alert alert--success">
<div class="admonitionHeading_MtRg">
tip</div>
<div class="admonitionContent_G2Ck"><p>Yarn now accepts sponsors! Please take a look at our <a href="https://opencollective.com/yarnpkg" target="_blank" rel="noopener noreferrer">OpenCollective</a> and <a href="https://github.com/sponsors/yarnpkg" target="_blank" rel="noopener noreferrer">GitHub Sponsors</a> pages for more details.</p></div>
</div> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="master">Master<a class="hash-link" aria-label="Direct link to Master" title="Direct link to Master" href="changelog.html#master">​</a>
</h2> <div class="theme-admonition theme-admonition-info admonition_JrWa alert alert--info">
<div class="admonitionHeading_MtRg">
info</div>
<div class="admonitionContent_G2Ck"><p>Features in <code>master</code> can be tried out by running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Build yarn from master
" href="../cli/set/version/from/sources.html"><span class="token_Ye2a" data-type="path">set</span> <span class="token_Ye2a" data-type="path">version</span> <span class="token_Ye2a" data-type="path">from</span> <span class="token_Ye2a" data-type="path">sources</span></a></code></span> in your project.</p></div>
</div> <ul> <li>Fixes <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to use interactive prompts by default or not."><a class="key_FEvO" href="../configuration/yarnrc.html#preferInteractive">preferInteractive</a></code> forcing interactive mode in non-TTY environments.</li> <li>
<code>node-modules</code> linker now honors user-defined symlinks for <code>&lt;workspace&gt;/node_modules</code> directories</li> <li>
<code>node-modules</code> linker supports hoisting into inner workspaces that are parents of other workspaces</li> <li>
<code>node-modules</code> linker attemps to hoist tree more exhaustivel until nothing can be hoisted</li> <li>
<code>node-modules</code> linker uses aggregated count of peer and regular usages to decide hoisting priority, instead of preferring peer usages over regular as before, which should result in fewer duplicates</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="410">4.1.0<a class="hash-link" aria-label="Direct link to 4.1.0" title="Direct link to 4.1.0" href="changelog.html#410">​</a>
</h2> <ul> <li> <p>Tweaks <code>-,--verbose</code> in <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span>; <code>-v</code> will now only print the prefixes, <code>-vv</code> will be necessary to also print the timings.</p> </li> <li> <p>Adds a new <code>--json</code> option to <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">run</span></span></code></span> when called without script name</p> </li> <li> <p>Fixes <code>node-modules</code> linker <code>link:</code> dependencies mistreatment as inner workspaces, when they point to a parent folder of a workspace</p> </li> <li> <p>Fixes spurious "No candidates found" errors</p> </li> <li> <p>Fixes missing executable permissions when using <code data-tooltip-id="tooltip" data-tooltip-content="Define how Node packages should be installed."><a class="key_FEvO" href="../configuration/yarnrc.html#nodeLinker">nodeLinker</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">pnpm</span></code></p> </li> <li> <p>Fixes packages being incorrectly flagged as optional</p> </li> <li> <p>Fixes cache key corruptions due to uncontrolled git merges</p> </li> <li> <p>Fixes <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Apply all the deferred version bumps at once
" href="../cli/version/apply.html"><span class="token_Ye2a" data-type="path">version</span> <span class="token_Ye2a" data-type="path">apply</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Apply the deferred version changes on all workspaces">all</span> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Print the versions without actually generating the package archive">dry-run</span></code></span> making unexpected changes</p> </li> <li> <p>Fixes <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Store new login info to access the npm registry
" href="../cli/npm/login.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">login</span></a></code></span> when the remote registry is Verdaccio</p> </li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="401">4.0.1<a class="hash-link" aria-label="Direct link to 4.0.1" title="Direct link to 4.0.1" href="changelog.html#401">​</a>
</h2> <ul> <li>Fixes creation of symlinks for <code>node-modules</code> linker when inner workspace depends on outer workspace</li> <li>Fixes progress bars when the terminal is too large</li> <li>Fixes crashes while running Yarn within Docker within GitHub Actions</li> <li>Fixes <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Perform a vulnerability audit against the installed packages
" href="../cli/npm/audit.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">audit</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Array of glob patterns of advisory ID's to ignore in the audit report">ignore</span> <span class="token_Ye2a" data-type="value">NUM</span></code></span> which didn't apply to deprecations</li> <li>Fixes <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Perform a vulnerability audit against the installed packages
" href="../cli/npm/audit.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">audit</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Format the output as an NDJSON stream">json</span></code></span> which didn't print the right output format</li> <li>Fixes an incorrect type export in <code>@yarnpkg/core</code>
</li> <li>Implements back the <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Explain a set of peer requirements
" href="../cli/explain/peer-requirements.html"><span class="token_Ye2a" data-type="path">explain</span> <span class="token_Ye2a" data-type="path">peer-requirements</span></a></code></span> command</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="400">4.0.0<a class="hash-link" aria-label="Direct link to 4.0.0" title="Direct link to 4.0.0" href="changelog.html#400">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="major-changes">
<strong>Major Changes</strong><a class="hash-link" aria-label="Direct link to major-changes" title="Direct link to major-changes" href="changelog.html#major-changes">​</a>
</h3> <ul> <li> <p>With Node.js 16's <a href="https://nodejs.org/en/blog/announcements/nodejs16-eol" target="_blank" rel="noopener noreferrer">now being End of Life'd</a>, we dropped support for Node.js versions lower than 18.12.</p> </li> <li> <p>Some important defaults have changed:</p> <ul> <li> <p><span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> and <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Lock the yarn version used by the project
" href="../cli/set/version.html"><span class="token_Ye2a" data-type="path">set</span> <span class="token_Ye2a" data-type="path">version</span></a></code></span> will prefer using <code data-tooltip-id="tooltip" data-tooltip-content="Define the package manager that should be used when working on this project."><a class="key_FEvO" href="../configuration/manifest.html#packageManager">packageManager</a></code> rather than <code data-tooltip-id="tooltip" data-tooltip-content="Path of a Yarn binary to use instead of the global one."><a class="key_FEvO" href="../configuration/yarnrc.html#yarnPath">yarnPath</a></code> when possible (when they detect <code>COREPACK_ROOT</code> in your environment variables).</p> </li> <li> <p><span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> will no longer use zero-install by default. You still can enable it, but it should make it easier to start one-of projects without having to rewrite the configuration afterwards.</p> <ul> <li>As a result, <code data-tooltip-id="tooltip" data-tooltip-content="Define whether the cache should be shared between all local projects."><a class="key_FEvO" href="../configuration/yarnrc.html#enableGlobalCache">enableGlobalCache</a></code> now defaults to <code>true</code>. If your project uses Zero-Installs, the first <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install the project dependencies
" href="../cli/install.html"><span class="token_Ye2a" data-type="path">install</span></a></code></span> you run after migrating to 4.0 will automatically set <code data-tooltip-id="tooltip" data-tooltip-content="Define whether the cache should be shared between all local projects."><a class="key_FEvO" href="../configuration/yarnrc.html#enableGlobalCache">enableGlobalCache</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">false</span></code> in your local <code>.yarnrc.yml</code>.</li> </ul> </li> <li> <p><span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> now requires one of <code>--all</code>, <code>--recursive</code>, <code>--since</code>, or <code>--worktree</code> to be explicitly specified; the previous default was <code>--worktree</code>, but it was rarely what users expected.</p> </li> <li> <p><code data-tooltip-id="tooltip" data-tooltip-content="Compression level employed for zip archives"><a class="key_FEvO" href="../configuration/yarnrc.html#compressionLevel">compressionLevel</a></code> now defaults to <code>0</code> rather than <code>mixed</code>. It's been proved significantly faster on installs, and the size impact was reasonable enough to change the default. Note that it benefits you <strong>even if you use Zero-Installs</strong>: as per our tests, a zero-compression is actually easier to handle for Git (you can see by yourself with those examples using <a href="https://github.com/yarnpkg/example-repo-zip0" target="_blank" rel="noopener noreferrer"><code data-tooltip-id="tooltip" data-tooltip-content="Compression level employed for zip archives"><span class="key_FEvO">compressionLevel</span><span class="assign_Ad7a">:</span> <span class="value_jT9z">0</span></code></a> vs <a href="https://github.com/yarnpkg/example-repo-zipn" target="_blank" rel="noopener noreferrer"><code data-tooltip-id="tooltip" data-tooltip-content="Compression level employed for zip archives"><span class="key_FEvO">compressionLevel</span><span class="assign_Ad7a">:</span> <span class="value_jT9z">mixed</span></code></a>).</p> <ul> <li>To avoid making the upgrade too disruptive, Yarn will check whether Zero-Installs are enabled the first time you run <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install the project dependencies
" href="../cli/install.html"><span class="token_Ye2a" data-type="path">install</span></a></code></span> after migrating from 3.6 to 4.0. If you do, it will automatically set the old default (<code data-tooltip-id="tooltip" data-tooltip-content="Compression level employed for zip archives"><a class="key_FEvO" href="../configuration/yarnrc.html#compressionLevel">compressionLevel</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">mixed</span></code>) in your <code>.yarnrc.yml</code> file. You can then remove it whenever you feel ready to actually change the compression settings.</li> </ul> </li> </ul> </li> <li> <p>All official Yarn plugins are now included by default in the bundle we provide. You no longer need to run <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Download a plugin
" href="../cli/plugin/import.html"><span class="token_Ye2a" data-type="path">plugin</span> <span class="token_Ye2a" data-type="path">import</span></a></code></span> for <em>official</em> plugins (you still need to do it for third-party plugins, of course).</p> <ul> <li>This doesn't change anything to the plugin API we provide, which will keep being maintained.</li> <li>Yarn still has a modular architecture and uses the exact same APIs as contrib plugins; all that changes is how we distribute our own features.</li> </ul> </li> <li> <p>Yarn's UI during installs has been greatly improved:</p> <ul> <li>Packages added and removed from the lockfile are now explicitly reported.</li> <li>Fluctuations in the project cache size are now reported as a single line.</li> <li>Unactionable warnings (<code>node-gyp</code> and transitive peer dependency errors) have been removed.</li> <li>Skipped builds are now only reported during initial installs and manual <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Rebuild the project's native packages
" href="../cli/rebuild.html"><span class="token_Ye2a" data-type="path">rebuild</span></a></code></span> calls.</li> <li>The Yarn version is now displayed on installs to help us investigate issues <a href="https://meta.stackoverflow.com/questions/285551/why-should-i-not-upload-images-of-code-data-errors/285557#285557" target="_blank" rel="noopener noreferrer">when reported as screenshots</a>.</li> <li>Deprecation checks have been moved to <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Perform a vulnerability audit against the installed packages
" href="../cli/npm/audit.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">audit</span></a></code></span>.</li> </ul> </li> <li> <p>Some settings were renamed or removed:</p> <ul> <li>
<code>caFilePath</code> is now <code data-tooltip-id="tooltip" data-tooltip-content="Path to a file containing one or multiple Certificate Authority signing certificates."><a class="key_FEvO" href="../configuration/yarnrc.html#httpsCaFilePath">httpsCaFilePath</a></code>
</li> <li>
<code>preferAggregateCacheInfo</code> has been removed (it's now always on)</li> <li>
<code>pnpDataPath</code> has been removed to adhere to our new <a href="pnp-spec.html" target="_blank" rel="noopener noreferrer">PnP specification</a>. For consistency, all PnP files will now be hardcoded to a single value so that third-party tools can implement the PnP specification without relying on the Yarn configuration.</li> </ul> </li> <li> <p>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Perform a vulnerability audit against the installed packages
" href="../cli/npm/audit.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">audit</span></a></code></span> command has been reimplemented:</p> <ul> <li>The audit registry must now implement the <code>/-/npm/v1/security/advisories/bulk</code> endpoint.</li> <li>The <code data-tooltip-id="tooltip" data-tooltip-content="Define the registry to use when auditing dependencies."><a class="key_FEvO" href="../configuration/yarnrc.html#npmAuditRegistry">npmAuditRegistry</a></code> can be used to temporarily route audit queries to the npm registry.</li> <li>Deprecations are now returned by default. To silence them, use <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Don't warn about deprecated packages">no-deprecations</span></code></span>.</li> </ul> </li> <li> <p>Some legacy layers have been sunset:</p> <ul> <li>Plugins cannot access the Clipanion 2 APIs anymore (upgrade to <a href="https://github.com/arcanis/clipanion" target="_blank" rel="noopener noreferrer">Clipanion 3</a>)</li> <li>Plugins cannot access the internal copy of Yup anymore (use <a href="https://github.com/arcanis/typanion" target="_blank" rel="noopener noreferrer">Typanion</a> instead)</li> <li>Yarn will no longer remove the old Yarn 2.x <code>.pnp.js</code> file when migrating.</li> <li>The <code>--assume-fresh-project</code> flag of <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> has been removed.</li> </ul> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="api-changes">
<strong>API Changes</strong><a class="hash-link" aria-label="Direct link to api-changes" title="Direct link to api-changes" href="changelog.html#api-changes">​</a>
</h3> <p>The following changes only affect people writing Yarn plugins:</p> <ul> <li> <p>The <code>ZipFS</code> and <code>ZipOpenFS</code> classes have been moved from <code>@yarnpkg/fslib</code> to <code>@yarnpkg/libzip</code>. They no longer need or accept the <code>libzip</code> parameter.</p> <ul> <li>Reading the zip archives is now done on the Node.js side for performance; as a result, the <code>open</code>, <code>ZIP_CREATE</code>, and <code>ZIP_TRUNCATE</code> bindings are no longer needed for <code>ZipFS</code> and have also been removed.</li> </ul> </li> <li> <p>The <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that must be made available to the current package in order for it to work properly."><a class="key_FEvO" href="../configuration/manifest.html#dependencies">dependencies</a></code> field sent returned by <code>Resolver#resolve</code> must now be the result of a <code>Configuration#normalizeDependencyMap</code> call. This change is prompted by a refactoring of how default protocols (ie <code>npm:</code>) are injected into descriptors. The previous implementation caused various descriptors to never be normalized, which made it difficult to know what were the descriptors each function should expect.</p> <ul> <li> <p>Similarly, the descriptors returned by <code>Resolve#getResolutionDependencies</code> are now expected to be the result of <code>Configuration#normalizeDependency</code> calls.</p> </li> <li> <p>Note that this only applies to the <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that must be made available to the current package in order for it to work properly."><a class="key_FEvO" href="../configuration/manifest.html#dependencies">dependencies</a></code> field; the <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that the package must inherit from its ancestor in the dependency tree."><a class="key_FEvO" href="../configuration/manifest.html#peerDependencies">peerDependencies</a></code> field is unchanged, as it must only contains semver ranges without any protocol (with an exception for <code>workspace:</code>, but that's not relevant here).</p> </li> </ul> </li> <li> <p>The <code>Resolve#getResolutionDependencies</code> function must now return an object of arbitrary string keys and descriptor values (instead of a map with <code>DescriptorHash</code> keys). Those descriptors will be resolved and assigned to the same keys as the initial object. This change allows resolvers to wrap resolution dependencies from other resolvers, which wasn't possible before since it'd have caused the key to change.</p> </li> <li> <p>The <code>generateLoader</code> function in <code>@yarnpkg/pnp</code> no longer generates the <code>$$SETUP_STATE</code> function, it now needs to be present in the <code>loader</code> passed to the function.</p> </li> <li> <p>The <code>getCustomDataKey</code> function in <code>Installer</code> from <code>@yarnpkg/core</code> has been moved to <code>Linker</code>.</p> </li> <li> <p><code>renderForm</code>'s <code>options</code> argument is now required to enforce that custom streams are always specified.</p> </li> <li> <p><code>npmConfigUtils.getAuditRegistry</code> no longer takes a <code>Manifest</code> as its first argument.</p> </li> <li> <p>The <code>FetchOptions.skipIntegrityCheck</code> option has been removed. Use <code>FetchOptions.cacheOptions.skipIntegrityCheck</code> instead.</p> </li> <li> <p><code>MapConfigurationValue</code> has been removed. Use <code>miscUtils.ToMapValue</code> instead.</p> </li> <li> <p><code>Manifest.isManifestFieldCompatible</code> and <code>Manifest.prototype.isCompatibleWith{OS,CPU}</code> have been removed. Use <code>Manifest.prototype.getConditions</code> and <code>structUtils.isPackageCompatible</code> instead.</p> </li> <li> <p><code>versionUtils.{fetchBase,fetchRoot,fetchChangedFiles}</code> have been moved from <code>@yarnpkg/plugin-version</code> to <code>@yarnpkg/plugin-git</code>. Use <code>gitUtils.{fetchBase,fetchRoot,fetchChangedFiles}</code> instead.</p> </li> <li> <p>For consistency reasons:</p> <ul> <li>
<code>Link{Resolver,Fetcher}</code> have been renamed to <code>Portal{Resolver,Fetcher}</code>
</li> <li>
<code>RawLink{Resolver,Fetcher}</code> have been renamed to <code>Link{Resolver,Fetcher}</code>
</li> </ul> </li> <li> <p><code>FakeFS</code> classes are now required to implement <code>lutimes{Sync,Promise}</code>.</p> </li> <li> <p><code>workspace.dependencies</code> has been removed. Use <code>workspace.anchoredPackage.dependencies</code> instead.</p> </li> <li> <p>The <code>Installer</code> class must now return <code>BuildRequest</code> structures instead of <code>BuildDirective[]</code>. This lets you mark that the build must be skipped, and the reason why.</p> </li> <li> <p><code>startCacheReport</code> has been removed, and is now part of the output generated by <code>fetchEverything</code>.</p> </li> <li> <p><code>forgettableNames</code> &amp; <code>forgettableBufferSize</code> have been removed (the only messages using them have been removed, making the forgettable logs implementation obsolete).</p> </li> <li> <p><code>workspace.locator</code> has been removed. You can instead use:</p> <ul> <li>
<code>workspace.anchoredLocator</code> to get the locator that's used throughout the dependency tree.</li> <li>
<code>workspace.manifest.version</code> to get the workspace version.</li> </ul> </li> <li> <p><code>configuration.{packageExtensions,refreshPackageExtensions}</code> have been removed. Use <code>configuration.getPackageExtensions</code> instead.</p> </li> <li> <p><code>configuration.normalizePackage</code> now requires a <code data-tooltip-id="tooltip" data-tooltip-content="Extend the package definitions of your dependencies; useful to fix third-party issues."><a class="key_FEvO" href="../configuration/yarnrc.html#packageExtensions">packageExtensions</a></code> option.</p> </li> <li> <p><code>ProjectLookup</code> has been removed. Both <code>Configuration.find</code> and <code>Configuration.findProjectCwd</code> now always do a lockfile lookup.</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs">​</a>
</h3> <ul> <li>Yarn now caches npm version metadata, leading to faster resolution steps and decreased network data usage.</li> <li>The <code>pnpm</code> linker avoids creating symlinks that lead to loops on the file system, by moving them higher up in the directory structure.</li> <li>The <code>pnpm</code> linker no longer reports duplicate "incompatible virtual" warnings.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="features">Features<a class="hash-link" aria-label="Direct link to Features" title="Direct link to Features" href="changelog.html#features">​</a>
</h3> <ul> <li>
<code data-tooltip-id="tooltip" data-tooltip-content="Define whether Yarn should exclusively read package metadata from its cache"><a class="key_FEvO" href="../configuration/yarnrc.html#enableOfflineMode">enableOfflineMode</a></code> is a new setting that, when set, will instruct Yarn to only use the metadata and archives already stored on the local machine rather than download them from the registry. This can be useful when performing local development under network-constrained environments (trains, planes, ...).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a script defined in the package.json
" href="../cli/run.html"><span class="token_Ye2a" data-type="path">run</span></a> <span class="token_Ye2a" data-type="positional">bin</span></code></span> now injects the environment variables defined in <code>.env.yarn</code> when spawning a process. This can be configured using the <code data-tooltip-id="tooltip" data-tooltip-content="Array of .env files which will get injected into any subprocess spawned by Yarn."><a class="key_FEvO" href="../configuration/yarnrc.html#injectEnvironmentFiles">injectEnvironmentFiles</a></code> variable.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> now automatically enables the <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Increase level of logging verbosity up to 2 times">verbose</span></code></span> flag in interactive terminals.</li> <li>Constraints can now be written in JavaScript. See the <a href="../features/constraints.html">revamped documentation</a> for more information.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes">​</a>
</h3> <ul> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a package in a temporary environment
" href="../cli/dlx.html"><span class="token_Ye2a" data-type="path">dlx</span></a></code></span> will no longer report false-positive <code>UNUSED_PACKAGE_EXTENSION</code> warnings</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command within the specified workspace
" href="../cli/workspace.html"><span class="token_Ye2a" data-type="path">workspace</span></a></code></span> will now set <code>$INIT_CWD</code> to the CLI working directory rather than the workspace root.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="shell">Shell<a class="hash-link" aria-label="Direct link to Shell" title="Direct link to Shell" href="changelog.html#shell">​</a>
</h3> <ul> <li>The builtin shell now supports whitespace-only commands.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility">​</a>
</h3> <ul> <li>The patched filesystem now supports <code>FileHandle.readLines</code>.</li> <li>PnP now reports missing files when in watch mode.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="341">3.4.1<a class="hash-link" aria-label="Direct link to 3.4.1" title="Direct link to 3.4.1" href="changelog.html#341">​</a>
</h2> <ul> <li>Fixes an accidental backport error in <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span>.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="340">3.4.0<a class="hash-link" aria-label="Direct link to 3.4.0" title="Direct link to 3.4.0" href="changelog.html#340">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="nodejs-parity">Node.js parity<a class="hash-link" aria-label="Direct link to Node.js parity" title="Direct link to Node.js parity" href="changelog.html#nodejs-parity">​</a>
</h3> <ul> <li>PnP now supports the Node <code>--conditions</code> flag.</li> <li>PnP now supports the Node <code>--watch</code> flag on Node 18 (it previously only supported it on Node 19).</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-1">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-1">​</a>
</h3> <ul> <li>The PnP API module (<code>pnpapi</code>) can now be imported from ESM modules.</li> <li>
<code>ZipFS.prototype.getBufferAndClose</code> will not error on empty archives resulting from an unlink after write.</li> <li>Fixes various issues around postinstall script inter-dependencies.</li> <li>Removes the message prefixes (<code>YN0000</code>) from <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span>.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-1">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-1">​</a>
</h3> <ul> <li>Updates the PnP compatibility layer for TypeScript v5.0.0-beta.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="330">3.3.0<a class="hash-link" aria-label="Direct link to 3.3.0" title="Direct link to 3.3.0" href="changelog.html#330">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-1">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-1">​</a>
</h3> <ul> <li>The node-modules linker avoids creation of circular symlinks</li> <li>The node-modules linker no longer creates duplicate copies inside of aliased packages</li> <li>The node-modules linker locates binaries correctly when the same version of the package is duplicated inside root workspace and another workspace</li> <li>Improved performance for <code>hardlinks-global</code> <code>node-modules</code> linker mode by 1.5x</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-2">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-2">​</a>
</h3> <ul> <li>Updates the PnP compatibility layer for TypeScript v4.9.2-rc.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="324">3.2.4<a class="hash-link" aria-label="Direct link to 3.2.4" title="Direct link to 3.2.4" href="changelog.html#324">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-3">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-3">​</a>
</h3> <ul> <li>The patched filesystem now supports fchown.</li> <li>PnP now handles private import mappings.</li> <li>Updates the PnP compatibility layer for TypeScript v4.8.4 and v4.9.1-beta.</li> <li>PnP now reports loaded modules when in watch mode.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="323">3.2.3<a class="hash-link" aria-label="Direct link to 3.2.3" title="Direct link to 3.2.3" href="changelog.html#323">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-2">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-2">​</a>
</h3> <ul> <li>When Corepack is enabled Yarn will now use the current CLI to prepare external Yarn classic projects, matching the behaviour of when Corepack is disabled.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-4">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-4">​</a>
</h3> <ul> <li>Updates the PnP compatibility layer for TypeScript 4.8.1-rc</li> <li>The ESM loader now supports unflagged JSON modules.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="322">3.2.2<a class="hash-link" aria-label="Direct link to 3.2.2" title="Direct link to 3.2.2" href="changelog.html#322">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-5">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-5">​</a>
</h3> <ul> <li>The patched filesystem now supports <code>ftruncate</code>.</li> <li>The patched filesystem now supports <code>fchmod</code>.</li> <li>The patched filesystem now supports <code>throwIfNoEntry</code>.</li> <li>The PnP filesystem now handles most of the FileHandle methods</li> <li>Updates the PnP compatibility layer for TypeScript 4.8 Beta</li> <li>The <code>npm_package_json</code> environment variable is now set by Yarn.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="321">3.2.1<a class="hash-link" aria-label="Direct link to 3.2.1" title="Direct link to 3.2.1" href="changelog.html#321">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-2">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-2">​</a>
</h3> <ul> <li>The pnpm linker no longer tries to remove <code>node_modules</code> directory, when <code>node-modules</code> linker is active</li> <li>The node-modules linker does not fail anymore if portal dependency points to an external project with multiple interdependent workspaces</li> <li>The node-modules linker has received various improvements: <ul> <li>applies hoisting algorithm on aliased dependencies</li> <li>reinstalls modules that have their directories removed from node_modules by the user</li> <li>improves portal hoisting</li> <li>supports <code data-tooltip-id="tooltip" data-tooltip-content="Systems for which Yarn should install packages."><a class="key_FEvO" href="../configuration/yarnrc.html#supportedArchitectures">supportedArchitectures</a></code>
</li> </ul> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-3">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-3">​</a>
</h3> <ul> <li>The PnP ESM loader is now able to handle symlinked extensionless entrypoints.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="320">3.2.0<a class="hash-link" aria-label="Direct link to 3.2.0" title="Direct link to 3.2.0" href="changelog.html#320">​</a>
</h2> <p>Various improvements have been made in the core to improve performance. Additionally:</p> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="commands">Commands<a class="hash-link" aria-label="Direct link to Commands" title="Direct link to Commands" href="changelog.html#commands">​</a>
</h3> <ul> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a> <span class="token_Ye2a" data-type="positional">run</span></code></span> command is now able to run binaries.</li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Show information about a package
" href="../cli/npm/info.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">info</span></a></code></span> command now supports displaying information about a tagged version of a package (e.g. <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Show information about a package
" href="../cli/npm/info.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">info</span></a> <span class="token_Ye2a" data-type="positional">vue@next</span></code></span>).</li> <li>A new <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Explain an error code
" href="../cli/explain.html"><span class="token_Ye2a" data-type="path">explain</span></a></code></span> command has been added. It can be used to explain an error code, or list all available error codes. <ul> <li>For example, try to run <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Explain an error code
" href="../cli/explain.html"><span class="token_Ye2a" data-type="path">explain</span></a> <span class="token_Ye2a" data-type="positional">YN0002</span></code></span>.</li> </ul> </li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Publish the active workspace to the npm registry
" href="../cli/npm/publish.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">publish</span></a></code></span> command now accepts a new <code>--otp</code> option, to set the One-Time Password from the CLI. <ul> <li>A better error message will also be shown when a query fails due to an invalid OTP.</li> </ul> </li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Open the upgrade interface
" href="../cli/upgrade-interactive.html"><span class="token_Ye2a" data-type="path">upgrade-interactive</span></a></code></span> now has improved paging: <ul> <li>Yarn will display as many suggestions as can fit in the viewport (rather than a fixed-size list).</li> <li>The suggestions that fit in the viewport will be fetched in the foreground and will load one-by-one.</li> <li>The suggestions that don't will be fetched in the background and will be loaded in batches to increase responsiveness and reduce input lag.</li> <li>Most notably, you won't have to wait for all of the suggestions to be fetched (which took a very long time before on large monorepos) before you can start navigating through the list.</li> </ul> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-3">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-3">​</a>
</h3> <ul> <li>The node-modules linker now tolerates if <code>node_modules</code> is a symbolic link, and doesn't recreate it.</li> <li>On top of the <code data-tooltip-id="tooltip" data-tooltip-content="Set of CPU architectures on which this package works."><a class="key_FEvO" href="../configuration/manifest.html#cpu">cpu</a></code> and <code>arch</code> fields, Yarn now support a new <code data-tooltip-id="tooltip" data-tooltip-content="Set of C standard libraries on which this package depends."><a class="key_FEvO" href="../configuration/manifest.html#libc">libc</a></code> field which can be used in tandem with <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that Yarn should only try to install if the os/cpu/libc fields match those of the host platform."><a class="key_FEvO" href="../configuration/manifest.html#optionalDependencies">optionalDependencies</a></code> to avoid downloading packages that have been linked against incompatible standard libraries (we currently support two values: <code>glibc</code> and <code>musl</code>).</li> <li>The pnpm linker has received various improvements: <ul> <li>It will now remove the <code>node_modules/.store</code> and <code>node_modules</code> folders if they are empty.</li> <li>It now supports running binaries of soft links.</li> <li>It will now create self-references for packages that don't depend on other versions of themselves.</li> <li>It will now remove scope folders (e.g. <code>node_modules/@yarnpkg</code>) if they are empty or after removing a scoped dependency.</li> </ul> </li> <li>All <code>.pnp.cjs</code> files with inlined data will now store the data in a JSON string literal instead of an object literal <a href="https://v8.dev/blog/cost-of-javascript-2019#json" target="_blank" rel="noopener noreferrer">to improve startup performance</a>.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-6">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-6">​</a>
</h3> <ul> <li>The shell now treats backslashes same as Bash (so it mostly ignore them). <ul> <li>Could potentially be a breaking change, but the old behavior caused portability issues with a few packages, so we had to make this change (especially since the portable shell is intended to help portability).</li> </ul> </li> <li>The shell now supports <code>${FOO:+}</code>.</li> <li>The PnP filesystem now handles <code>read</code> and <code>readSync</code> using options.</li> <li>The PnP filesystem now handles UNC paths using forward slashes.</li> <li>The PnP filesystem now sets the proper <code>path</code> property on streams created by <code>createReadStream()</code> and obtained from zip archives.</li> <li>The PnP runtime now throws an <code>ERR_REQUIRE_ESM</code> error when attempting to require an ES Module, matching the default Node.js behaviour.</li> <li>Updates the PnP compatibility layer for TypeScript 4.6 Beta (it's possible we'll need to publish another patch update once the 4.6 enters stable).</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-4">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-4">​</a>
</h3> <ul> <li>
<code>@yarnpkg/pnpify</code> now escapes paths correctly.</li> <li>The ESM loader is now enabled regardless of the entrypoint module type, this fixes support for dynamic imports in commonjs modules when the entrypoint is also commonjs.</li> <li>The ESM loader is now able to resolve relative imports with search parameters.</li> <li>The <code>node</code> field inside the <code>npm_config_user_agent</code> Yarn sets will now include a leading <code>v</code>.</li> <li>Yarn is now able to recover from a corrupted install state.</li> <li>Yarn is now able to migrate classic lockfiles containing unconventional tarball URLs.</li> <li>The nm linker hoists portals after hoisting their dependencies first.</li> <li>Fixed a crash caused by a bad interaction between aliased packages and peer dependencies.</li> <li>The ESBuild plugin will no longer allow access to Node.js builtins if the <code>platform</code> isn't set to Node.</li> <li>SemVer ranges with build metadata can now be resolved.</li> <li>The <code>YARN_IGNORE_NODE</code> environment variable will now be parsed using the same mechanism as env variable configuration settings (i.e. both <code>1</code>/<code>0</code> and <code>true</code>/<code>false</code> will be accepted)</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="zipfs-extension">ZipFS Extension<a class="hash-link" aria-label="Direct link to ZipFS Extension" title="Direct link to ZipFS Extension" href="changelog.html#zipfs-extension">​</a>
</h3> <ul> <li>You can now unmount zip folders by right-clicking on their workspaces.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous-features">Miscellaneous Features<a class="hash-link" aria-label="Direct link to Miscellaneous Features" title="Direct link to Miscellaneous Features" href="changelog.html#miscellaneous-features">​</a>
</h3> <ul> <li>Reporting for Git errors has been improved.</li> <li>The resolution step now has a progress indicator.</li> <li>The experimental ESM loader warning emitted by Node.js is now suppressed.</li> <li>Private registries can now be authenticated using private keys and certificates.</li> <li>A new <code>wrapNetworkRequest</code> hook now lets you wrap network requests (for example to log them).</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="311">3.1.1<a class="hash-link" aria-label="Direct link to 3.1.1" title="Direct link to 3.1.1" href="changelog.html#311">​</a>
</h2> <ul> <li>Updates the PnP compatibility layer for TypeScript 4.5</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="310">3.1.0<a class="hash-link" aria-label="Direct link to 3.1.0" title="Direct link to 3.1.0" href="changelog.html#310">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="commands-1">Commands<a class="hash-link" aria-label="Direct link to Commands" title="Direct link to Commands" href="changelog.html#commands-1">​</a>
</h3> <ul> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="List all available workspaces
" href="../cli/workspaces/list.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">list</span></a></code></span> and <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> commands now both support a new <code>--since</code> option that lets you filter the workspace list by changes (only workspaces that changed since the specified commit will be iterated on). This feature is still a little experimental, especially when used with <code>-R,--recursive</code>.</li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> command now handles the fact that a script containing <code>:</code> only becomes global if it exists in exactly one workspace.</li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> command now supports <code>--jobs 1</code> and <code>--jobs unlimited</code>.</li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a> <span class="token_Ye2a" data-type="dash">-</span><span class="token_Ye2a" data-type="option">2</span></code></span> command will now add the <a href="https://nodejs.org/api/packages.html#packagemanager" target="_blank" rel="noopener noreferrer"><code data-tooltip-id="tooltip" data-tooltip-content="Define the package manager that should be used when working on this project."><span class="key_FEvO">packageManager</span></code></a> field to your project manifest.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="settings">Settings<a class="hash-link" aria-label="Direct link to Settings" title="Direct link to Settings" href="changelog.html#settings">​</a>
</h3> <ul> <li>The <code>pattern</code> matcher from <code data-tooltip-id="tooltip" data-tooltip-content="Alter the log levels for emitted messages."><a class="key_FEvO" href="../configuration/yarnrc.html#logFilters">logFilters</a></code> will now match any part of the log entry.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-4">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-4">​</a>
</h3> <ul> <li>A new <code data-tooltip-id="tooltip" data-tooltip-content="Define how Node packages should be installed."><a class="key_FEvO" href="../configuration/yarnrc.html#nodeLinker">nodeLinker</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">pnpm</span></code> mode will let you install packages using the pnpm install strategy, where packages are stored flat and referenced by each others through symlinks. This mode is still a little experimental, so please send our way bugs you might find.</li> <li>Yarn won't install anymore packages that don't match the current OS. Should you need to (for example if you check-in your cache), use the <a href="../configuration/yarnrc.html#supportedArchitectures" target="_blank" rel="noopener noreferrer"><code data-tooltip-id="tooltip" data-tooltip-content="Systems for which Yarn should install packages."><span class="key_FEvO">supportedArchitectures</span></code></a> field to manually enforce the presence of specific architectures.</li> <li>The <code data-tooltip-id="tooltip" data-tooltip-content="Define how to copy files to their target destination."><a class="key_FEvO" href="../configuration/yarnrc.html#nmMode">nmMode</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">hardlinks-global</span></code> setting will now be automatically downgraded to <code data-tooltip-id="tooltip" data-tooltip-content="Define how to copy files to their target destination."><a class="key_FEvO" href="../configuration/yarnrc.html#nmMode">nmMode</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">hardlinks-local</span></code> when global caches and install folders are kept on different devices, thus letting the install continue normally. A warning will still be produced explaining this behaviour.</li> <li>The <code>node_modules</code> linker maximizes chances to end-up with only one top-level node_modules in the case of using workspaces</li> <li>The <code data-tooltip-id="tooltip" data-tooltip-content="Define whether workspaces are allowed to require themselves."><a class="key_FEvO" href="../configuration/yarnrc.html#nmSelfReferences">nmSelfReferences</a></code> setting has been added to the nm linker to control whether workspaces are allowed to require themselves - results in creation of self-referencing symlinks. <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install a single workspace and its dependencies
" href="../cli/workspaces/focus.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">focus</span></a></code></span> will not create self-referencing symlinks for excluded workspaces anymore.</li> <li>Yarn can now install workspaces from remote git repositories that use npm if npm@&gt;=7.x is installed on the system.</li> <li>The hoisting algorithm should be faster, improving the install time for recurrent <code>node_modules</code> installs.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous-features-1">Miscellaneous Features<a class="hash-link" aria-label="Direct link to Miscellaneous Features" title="Direct link to Miscellaneous Features" href="changelog.html#miscellaneous-features-1">​</a>
</h3> <ul> <li>Workspaces can now be referred to using <code>workspace:^</code> and <code>workspace:~</code>. When published, those markers will turn into the actual version (just like what used to happen with <code>workspace:*</code>), except that they'll be prefixed with the relevant semver prefix (respectively <code>^</code> and <code>~</code>).</li> <li>A new <code data-tooltip-id="tooltip" data-tooltip-content="Define the registry to use when auditing dependencies."><a class="key_FEvO" href="../configuration/yarnrc.html#npmAuditRegistry">npmAuditRegistry</a></code> setting will let you define which registry to use when running audits. If unset, we'll fallback to the currently configured publish registry (we'll likely change this behavior in Yarn 4 to rather use the fetch registry).</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-5">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-5">​</a>
</h3> <ul> <li>Direct portal dependencies for <code>node_modules</code> installs will now be given priority during hoisting, preventing cases when indirect regular dependencies would block the way for direct portal dependencies.</li> <li>The <code>pnpify</code> binary can now be used from inside directories containing spaces.</li> <li>The CLI bundles built from sources will now output the commit hash instead of the tree hash, as part of their <code>--version</code> string.</li> <li>Nested workspaces are properly hoisted by <code>node-modules</code> linker.</li> <li>Self-referencing symlinks won't be created for anonymous workspaces when using the <code>node-modules</code> linker, since they cannot be used from the code anyway.</li> <li>The cache is now fully atomic when moving files across devices, and is more efficient in general.</li> <li>The PnP patch will now properly pick up changes to the <code>fs</code> module, allowing users to patch it.</li> <li>When using PnP, <code>require.resolve('pnpapi')</code> will be handled correctly even when using <code>exports</code>.</li> <li>The install state will no longer be invalidated after running commands that modify the lockfile; this should bring a significant performance improvement when running commands such as <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">run</span></span></code></span> immediately after adding or removing dependencies inside large monorepos.</li> <li>Optional peer dependencies now imply an optional peer dependency on the corresponding <code>@types</code> version. This matches the behaviour for peer dependencies.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-7">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-7">​</a>
</h3> <ul> <li>Yarn will now generate an experimental ESM loader when it detects you may need it. This can be disabled (or enabled) using <a href="../configuration/yarnrc.html#pnpEnableEsmLoader" target="_blank" rel="noopener noreferrer"><code data-tooltip-id="tooltip" data-tooltip-content="Define whether to generate a Node.js ESM loader or not."><span class="key_FEvO">pnpEnableEsmLoader</span></code></a>.</li> <li>The PnP compatibility patch for <code>resolve</code> will no longer resolve missing modules to a file with the same name that would happen to be located next to the issuer.</li> <li>Fixes the SDK to account for a breaking change in VSCode &gt;=1.61.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="302">3.0.2<a class="hash-link" aria-label="Direct link to 3.0.2" title="Direct link to 3.0.2" href="changelog.html#302">​</a>
</h2> <ul> <li>Updated TypeScript patch to cover TypeScript 4.4.</li> <li>Fixed <code>VirtualFS.mapToBase</code> to preserve <code>.</code> characters (was converting them to empty strings).</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="301">3.0.1<a class="hash-link" aria-label="Direct link to 3.0.1" title="Direct link to 3.0.1" href="changelog.html#301">​</a>
</h2> <ul> <li>Fixes an edge case with the PnP loader when calling <code>readdir</code> with <code>null</code> as second parameter (instead of <code>undefined</code>).</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="300">3.0.0<a class="hash-link" aria-label="Direct link to 3.0.0" title="Direct link to 3.0.0" href="changelog.html#300">​</a>
</h2> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="breaking-changes">
<strong>Breaking Changes</strong><a class="hash-link" aria-label="Direct link to breaking-changes" title="Direct link to breaking-changes" href="changelog.html#breaking-changes">​</a>
</h3> <ul> <li>Node 10 isn't supported anymore.</li> <li>Plugins can't access <code>yup</code> anymore (we migrated to <a href="https://github.com/arcanis/typanion" target="_blank" rel="noopener noreferrer">Typanion</a> as part of <a href="https://github.com/arcanis/clipanion" target="_blank" rel="noopener noreferrer">Clipanion v3</a>). <ul> <li>To upgrade <code>workspace-tools</code>, remove it from your <code>.yarnrc.yml</code>, upgrade, then import it back.</li> </ul> </li> <li>The <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to allow adding/removing entries from the lockfile or not."><a class="key_FEvO" href="../configuration/yarnrc.html#enableImmutableInstalls">enableImmutableInstalls</a></code> will now default to <code>true</code> on CI (we still recommend to explicitly use <code>--immutable</code> on the CLI). <ul> <li>You can re-allow mutations by adding <code>YARN_ENABLE_IMMUTABLE_INSTALLS=false</code> in your environment variables.</li> </ul> </li> <li>The <code>initVersion</code> and <code>initLicense</code> configuration options have been removed. <code data-tooltip-id="tooltip" data-tooltip-content="Additional fields to set when creating packages via the `init` command."><a class="key_FEvO" href="../configuration/yarnrc.html#initFields">initFields</a></code> should be used instead.</li> <li>Yarn will now generate <code>.pnp.cjs</code> files (instead of <code>.pnp.js</code>) when using PnP, regardless of what the <code data-tooltip-id="tooltip" data-tooltip-content="Define how should be interpreted `.js` files."><a class="key_FEvO" href="../configuration/manifest.html#type">type</a></code> field inside the manifest is set to.</li> <li>The virtual folder (used to disambiguate peer dependencies) got renamed from <code>$$virtual</code> into <code>__virtual__</code>.</li> <li>The <code>-a</code> alias flag of <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> got removed; use <code>-A,--all</code> instead, which is strictly the same.</li> <li>The old PnPify SDK folder (<code>.vscode/pnpify</code>) won't be cleaned up anymore.</li> <li>The <code>--skip-builds</code> flag from <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install the project dependencies
" href="../cli/install.html"><span class="token_Ye2a" data-type="path">install</span></a></code></span> got renamed into <code>--mode=skip-build</code>.</li> <li>The <code>bstatePath</code> configuration option has been removed. The build state (<code>.yarn/build-state.yml</code>) has been moved into the install state (<code>.yarn/install-state.gz</code>)</li> <li>The cache files need to be regenerated. We had to change their timestamps in order to account for a flaw in the zip spec that was causing problems with some third-party tools.</li> <li>
<code>@yarnpkg/pnpify</code> has been refactored into 3 packages: <ul> <li>
<code>@yarnpkg/sdks</code> now contains the <a href="../getting-started/editor-sdks.html" target="_blank" rel="noopener noreferrer">Editor SDKs</a>
</li> <li>
<code>@yarnpkg/pnpify</code> now contains the <a href="pnpify.html" target="_blank" rel="noopener noreferrer">PnPify CLI compatibility tool that creates in-memory <code>node_modules</code></a>
</li> <li>
<code>@yarnpkg/nm</code> now contains the <code>node_modules</code> tree builder and hoister</li> </ul> </li> <li>
<code>@yarnpkg/plugin-node-modules</code> has been renamed to <code>@yarnpkg/plugin-nm</code>
</li> <li>The <code>--clipanion=definitions</code> commands supported by our CLIs will now expose the definitions on the entry point (rather than on <code>.command</code>)</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="api">API<a class="hash-link" aria-label="Direct link to API" title="Direct link to API" href="changelog.html#api">​</a>
</h3> <ul> <li>
<code>structUtils.requirableIdent</code> got removed; use <code>structUtils.stringifyIdent</code> instead, which is strictly the same.</li> <li>
<code>configuration.format</code> got removed; use <code>formatUtils.pretty</code> instead, which is strictly the same, but type-safe.</li> <li>
<code>httpUtils.Options['json']</code> got removed; use <code>httpUtils.Options['jsonResponse']</code> instead, which is strictly the same.</li> <li>
<code>PackageExtension['description']</code> got removed, use <code>formatUtils.json(packageExtension, formatUtils.Type.PACKAGE_EXTENSION)</code> instead, which is strictly the same.</li> <li>
<code>Project.generateBuildStateFile</code> has been removed, the build state is now in <code>Project.storedBuildState</code>.</li> <li>
<code>Project.tryWorkspaceByDescriptor</code> and <code>Project.getWorkspaceByDescriptor</code> now match on virtual descriptors.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-5">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-5">​</a>
</h3> <ul> <li> <p>Workspaces now get self-references even when under the <code>node-modules</code> linker (just like how it already worked with the <code>pnp</code> linker). This means that a workspace called <code>foo</code> can now safely assume that calls to <code>require('foo/package.json')</code> will always work, removing the need for <a href="https://nextjs.org/docs/advanced-features/module-path-aliases" target="_blank" rel="noopener noreferrer">absolute aliases</a> in the majority of cases.</p> </li> <li> <p>The node-modules linker now does its best to support the <code>portal:</code> protocol. This support comes with two important limitations:</p> <ul> <li>Projects that make use of such dependencies will have to be run with the <code>--preserve-symlinks</code> Node option if they wish to access their dependencies.</li> <li>Because Yarn installs will never modify files outside of the project due to security reasons, sub-dependencies of packages with <code>portal:</code> must be hoisted outside of the portal. Failing that (for example if the portal package depends on something incompatible with the version hoisted via another package), the linker will produce an error and abandon the install.</li> </ul> </li> <li> <p>The node-modules linker can now utilize hardlinks. The new setting <code data-tooltip-id="tooltip" data-tooltip-content="Define how to copy files to their target destination."><a class="key_FEvO" href="../configuration/yarnrc.html#nmMode">nmMode</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">classic | hardlinks-local | hardlinks-global</span></code> specifies which <code>node_modules</code> strategy should be used:</p> <ul> <li>
<code>classic</code> - standard <code>node_modules</code> layout, without hardlinks</li> <li>
<code>hardlinks-local</code> - standard <code>node_modules</code> layout with hardlinks inside the project only</li> <li>
<code>hardlinks-global</code> - standard <code>node_modules</code> layout with hardlinks pointing to global content storage across all the projects using this option</li> </ul> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-6">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-6">​</a>
</h3> <ul> <li>Yarn now has a proper <a href="https://github.com/yarnpkg/berry/blob/master/GOVERNANCE.md" target="_blank" rel="noopener noreferrer">governance model</a>.</li> <li>The <code>node-modules</code> linker will now ensure that the generated install layouts are terminal, by doing several rounds when needed.</li> <li>The <code>node-modules</code> linker will no longer print warnings about postinstall scripts when a workspace depends on another workspace listing install scripts.</li> <li>Peer dependencies depending on their own parent are now properly hoisted by the node-modules linker.</li> <li>Boolean values will be properly interpreted when specified inside the configuration file via the <code>${ENV_VAR}</code> syntax.</li> <li>Should any of <code>preinstall</code>, <code>install</code>, <code>postinstall</code> fail, the remaining scripts will be skipped.</li> <li>The <code>git:</code> protocol will now default to fetching <code>HEAD</code> (rather than the hardcoded <code>master</code>).</li> <li>The <code>SIGTERM</code> signal will now be propagated to child processes.</li> <li>The PnP linker now schedules packages to be rebuilt if their unplugged folder is removed</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Unset a configuration setting
" href="../cli/config/unset.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">unset</span></a></code></span> will now correctly unset non-nested properties</li> <li>The TypeScript SDK now</li> <li>And a bunch of smaller fixes.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="settings-1">Settings<a class="hash-link" aria-label="Direct link to Settings" title="Direct link to Settings" href="changelog.html#settings-1">​</a>
</h3> <ul> <li>Various <code data-tooltip-id="tooltip" data-tooltip-content="Additional fields to set when creating packages via the `init` command."><a class="key_FEvO" href="../configuration/yarnrc.html#initFields">initFields</a></code> edge cases have been fixed.</li> <li>The <code>preferAggregateCacheInfo</code> flag will now also aggregate cleanup reports.</li> <li>A new <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to prepend a message name before each printed line or not."><a class="key_FEvO" href="../configuration/yarnrc.html#enableMessageNames">enableMessageNames</a></code> flag can be set to <code>false</code> to exclude the <code>YNxxxx</code> from the output.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="commands-2">Commands<a class="hash-link" aria-label="Direct link to Commands" title="Direct link to Commands" href="changelog.html#commands-2">​</a>
</h3> <ul> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> can now be run even from within existing projects (will create missing files).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> and <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Lock the yarn version used by the project
" href="../cli/set/version.html"><span class="token_Ye2a" data-type="path">set</span> <span class="token_Ye2a" data-type="path">version</span></a></code></span> will set the <code data-tooltip-id="tooltip" data-tooltip-content="Define the package manager that should be used when working on this project."><a class="key_FEvO" href="../configuration/manifest.html#packageManager">packageManager</a></code> field.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Lock the yarn version used by the project
" href="../cli/set/version.html"><span class="token_Ye2a" data-type="path">set</span> <span class="token_Ye2a" data-type="path">version</span></a></code></span> now downloads binaries from the official Yarn website (rather than GitHub).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Build yarn from master
" href="../cli/set/version/from/sources.html"><span class="token_Ye2a" data-type="path">set</span> <span class="token_Ye2a" data-type="path">version</span> <span class="token_Ye2a" data-type="path">from</span> <span class="token_Ye2a" data-type="path">sources</span></a></code></span> will now upgrade the builtin plugins as well unless <code>--skip-plugins</code> is set.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Apply all the deferred version bumps at once
" href="../cli/version/apply.html"><span class="token_Ye2a" data-type="path">version</span> <span class="token_Ye2a" data-type="path">apply</span></a></code></span> now supports a new <code>--prerelease</code> flag which replaces how prereleases were previously handled.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">run</span></span></code></span> should be significantly faster to boot on large projects.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Increase level of logging verbosity up to 2 times">verbose</span></code></span> will now print when processes start and end, even if they don't have an output.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> now supports a <code>--from &lt;glob&gt;</code> flag, which when combined with <code>-R</code> will target workspaces reachable from the 'from' glob.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Generate a patch out of a directory
" href="../cli/patch-commit.html"><span class="token_Ye2a" data-type="path">patch-commit</span></a></code></span> can now be used as many times as you want on the same patch folder.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Generate a patch out of a directory
" href="../cli/patch-commit.html"><span class="token_Ye2a" data-type="path">patch-commit</span></a></code></span> now supports a new <code>-s,--save</code> flag which will save the patch instead of just printing it.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Upgrade dependencies across the project
" href="../cli/up.html"><span class="token_Ye2a" data-type="path">up</span></a></code></span> now supports a new <code>-R,--recursive</code> flag which will upgrade the specified package, regardless where it is.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Unset a configuration setting
" href="../cli/config/unset.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">unset</span></a></code></span> is a new command that will remove a setting from the local configuration (or home if <code>-H</code> is set).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Execute a shell script
" href="../cli/exec.html"><span class="token_Ye2a" data-type="path">exec</span></a></code></span> got support for running shell scripts using Yarn's portable shell.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Download a plugin
" href="../cli/plugin/import.html"><span class="token_Ye2a" data-type="path">plugin</span> <span class="token_Ye2a" data-type="path">import</span></a></code></span> can now install specific versions of the official plugins.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Download a plugin
" href="../cli/plugin/import.html"><span class="token_Ye2a" data-type="path">plugin</span> <span class="token_Ye2a" data-type="path">import</span></a></code></span> will now download plugins compatible with the current CLI by default.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Disconnect the local project from another one
" href="../cli/unlink.html"><span class="token_Ye2a" data-type="path">unlink</span></a></code></span> has been added which removes resolutions previously set by <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Connect the local project to another one
" href="../cli/link.html"><span class="token_Ye2a" data-type="path">link</span></a></code></span>.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="builtin-shell">Builtin Shell<a class="hash-link" aria-label="Direct link to Builtin Shell" title="Direct link to Builtin Shell" href="changelog.html#builtin-shell">​</a>
</h3> <ul> <li>The shell now supports background jobs, with color-coded output.</li> <li>It now also supports redirections from file descriptors.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-8">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-8">​</a>
</h3> <ul> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install the project dependencies
" href="../cli/install.html"><span class="token_Ye2a" data-type="path">install</span></a></code></span> inside a Yarn v1 project will now automatically enable the <code>node-modules</code> linker. This should solve most of the problems people have had in their migrations. We still recommend to keep the default PnP for new projects, but the choice is yours.</li> <li>The patched filesystem now supports file URLs, <code>bigint</code>, and <code>fstat</code>.</li> <li>An official ESBuild resolver is now provided under the name <code>@yarnpkg/esbuild-plugin-pnp</code>. We use it to bundle Yarn itself!</li> <li>PnP projects can now use the Node <a href="https://nodejs.org/api/packages.html#packages_package_entry_points" target="_blank" rel="noopener noreferrer"><code>exports</code> field</a> - regardless of the Node version.</li> <li>The PnP hook now supports the <code>node:</code> protocol (new in Node 16)</li> <li>The Prettier SDK does not use PnPify anymore since it was its only remaining use, and was fairly invasive; as a result, the Prettier plugins must be specified in Prettier's <code>plugins</code> configuration property.</li> <li>Zip terminal links can now be clicked from within VSCode</li> <li>Builtin patches that fail to apply will no longer cause an error (they'll emit a warning and the original sources will be used instead). <ul> <li>Remember that patches are a problem for our team too, and that we only do this because we don't have any other option available to us right now - if you wish to help, consider <a href="https://github.com/microsoft/TypeScript/pull/35206" target="_blank" rel="noopener noreferrer">upvoting</a> the relevant pull request in the TypeScript repository or, if you work at Microsoft, perhaps mention to your TypeScript team next door that fixing this would benefit you.</li> </ul> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous">Miscellaneous<a class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous" href="changelog.html#miscellaneous">​</a>
</h3> <ul> <li>Reporting for HTTP errors has been improved, which should help you investigate registry issues.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="243">2.4.3<a class="hash-link" aria-label="Direct link to 2.4.3" title="Direct link to 2.4.3" href="changelog.html#243">​</a>
</h2>  <ul> <li>Updated TypeScript patch to cover TypeScript 4.4.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="242">2.4.2<a class="hash-link" aria-label="Direct link to 2.4.2" title="Direct link to 2.4.2" href="changelog.html#242">​</a>
</h2>  <ul> <li>Updated TypeScript patch to cover TypeScript 4.3.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="241">2.4.1<a class="hash-link" aria-label="Direct link to 2.4.1" title="Direct link to 2.4.1" href="changelog.html#241">​</a>
</h2>  <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-9">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-9">​</a>
</h3> <ul> <li>The release of TypeScript 4.2 couldn't be installed due to patch conflicts. This is now fixed. This version only includes a fix specific to 4.2, but future Yarn releases starting from 3.0 will be more tolerant of this kind of situation and won't cause such errors.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="240">2.4.0<a class="hash-link" aria-label="Direct link to 2.4.0" title="Direct link to 2.4.0" href="changelog.html#240">​</a>
</h2>  <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-6">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-6">​</a>
</h3> <ul> <li> <p>The resolution pipeline got reimplemented. We previously used a multi-pass approach where we performed SAT optimization between each pass, but after investigating it turned out the SAT optims had little impact and added performance bottlenecks. We now run the resolution using a much simpler and more efficient algorithm.</p> </li> <li> <p>Linkers can now define custom data to cache between Yarn invocations. The builtin linkers new use those new capabilities to cache package information that can't change between runs. In practice, this translates into much faster recurrent installs (when running an install that adds few new packages, if any).</p> </li> <li> <p>Warnings are now reported when <code data-tooltip-id="tooltip" data-tooltip-content="Extend the package definitions of your dependencies; useful to fix third-party issues."><a class="key_FEvO" href="../configuration/yarnrc.html#packageExtensions">packageExtensions</a></code> rules are either unused or redundant with the original package definition.</p> </li> <li> <p>Potentially breaking, but it was intended this way from the start: the <code data-tooltip-id="tooltip" data-tooltip-content="Extend the package definitions of your dependencies; useful to fix third-party issues."><a class="key_FEvO" href="../configuration/yarnrc.html#packageExtensions">packageExtensions</a></code> field cannot be used to <em>replace</em> dependencies anymore (only to add missing ones). Prefer using the <code data-tooltip-id="tooltip" data-tooltip-content="Override the resolutions of specific dependencies."><a class="key_FEvO" href="../configuration/manifest.html#resolutions">resolutions</a></code> field to replace existing ones.</p> </li> <li> <p>Progress bars are rendered less often, which should help performances on some terminals.</p> </li> <li> <p>Aliased packages no longer include themselves in node_modules installs</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="cli">CLI<a class="hash-link" aria-label="Direct link to CLI" title="Direct link to CLI" href="changelog.html#cli">​</a>
</h3> <ul> <li> <p>The <code>upgrade-interactive</code> command will now only show upgrade suggestions for packages that have available upgrades (rather than all of them).</p> </li> <li> <p>The <code>upgrade-interactive</code> command has received UI improvements that should make it easier to look at.</p> </li> <li> <p>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install a single workspace and its dependencies
" href="../cli/workspaces/focus.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">focus</span></a></code></span> command will now only run the <code>postinstall</code> scripts for the focused workspaces.</p> </li> <li> <p>A new <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Perform a vulnerability audit against the installed packages
" href="../cli/npm/audit.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">audit</span></a></code></span> command lets you query audit information from the npm registry.</p> </li> <li> <p>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> command has a new flag, <code>-R,--recursive</code>, which will run a command on the current workspace and all others it depends on.</p> </li> <li> <p>A new <code>--skip-builds</code> option on <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install the project dependencies
" href="../cli/install.html"><span class="token_Ye2a" data-type="path">install</span></a></code></span> will let you skip the build scripts without impacting the generated Yarn artifacts (contrary to <code>enableScripts</code>, which would also stop unplugging the packages that would otherwise be unplugged due to containing build scripts).</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="binaries">Binaries<a class="hash-link" aria-label="Direct link to Binaries" title="Direct link to Binaries" href="changelog.html#binaries">​</a>
</h3> <ul> <li> <p>It's now possible to run dependency binaries when using the node-modules linker even if one of your other dependencies is reported as incompatible with your system.</p> </li> <li> <p>By default Windows automatically requests for administrator rights before spawning any binary whose filename contains "install", "setup", "update", or "patch" (it thinks they are installers). We now explicitly opt-out of this behavior in the binary jumpers we use on Windows.</p> </li> <li> <p>By default, arguments passed to MinGW-compiled programs are automatically expanded by a basic glob pattern engine. We now explicitly opt-out of this behavior in the binary jumpers we use on Windows.</p> </li> <li> <p>The Windows binary jumpers will now report the right exit code.</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="settings-2">Settings<a class="hash-link" aria-label="Direct link to Settings" title="Direct link to Settings" href="changelog.html#settings-2">​</a>
</h3> <ul> <li> <p>Using empty fallbacks in Yarnrc environment variables (<code>${VAR:-}</code>) will now work.</p> </li> <li> <p>You can now use the new <code data-tooltip-id="tooltip" data-tooltip-content="Alter the log levels for emitted messages."><a class="key_FEvO" href="../configuration/yarnrc.html#logFilters">logFilters</a></code> setting to turn warnings into either errors or info, or to hide them entirely. Note that we plan to significantly improve the peer dependency warnings in the next release, so perhaps don't silence them just now even if you have a bunch of them.</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="shell-1">Shell<a class="hash-link" aria-label="Direct link to Shell" title="Direct link to Shell" href="changelog.html#shell-1">​</a>
</h3> <ul> <li>Some shell errors (<code>No matches found</code>, <code>Bad file descriptor</code>, <code>Unbound variable</code>, <code>Unbound argument</code>) will now be recoverable errors that make the shell continue on to the next command in the chain instead of hard crashes. Fixes cases such as <code>rm -rf ./inexistentFolder/* || true</code>.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="vscode-zipfs-extension">VSCode ZipFS Extension<a class="hash-link" aria-label="Direct link to VSCode ZipFS Extension" title="Direct link to VSCode ZipFS Extension" href="changelog.html#vscode-zipfs-extension">​</a>
</h3> <ul> <li>The extension will now activate even if the workspace doesn't contain zip files (usually because you excluded them).</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="compatibility-10">Compatibility<a class="hash-link" aria-label="Direct link to Compatibility" title="Direct link to Compatibility" href="changelog.html#compatibility-10">​</a>
</h3> <ul> <li> <p>Some patches went missing for TypeScript &lt;4. This is now fixed.</p> </li> <li> <p>Calling <code>fs.exists(undefined)</code> won't crash anymore.</p> </li> <li> <p>TypeScript import suggestions should now be correct even when the imported module is deep within a workspace.</p> </li> <li> <p>TypeScript in watch mode (both using <code>-w</code> and within VSCode) will now detect new dependencies as you add them.</p> </li> <li> <p>Some particular multi-dependency-trees setups will be better supported on Plug'n'Play installs.</p> </li> <li> <p>Using <code>ctrl+click</code> on imports in VSCode won't take you to virtual packages anymore (require an SDK update).</p> </li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="231">2.3.1<a class="hash-link" aria-label="Direct link to 2.3.1" title="Direct link to 2.3.1" href="changelog.html#231">​</a>
</h2>  <h3 class="anchor anchorWithStickyNavbar_ATBP" id="cli-1">CLI<a class="hash-link" aria-label="Direct link to CLI" title="Direct link to CLI" href="changelog.html#cli-1">​</a>
</h3> <ul> <li>Take into account peer dependency defaults when inheriting workspace peer dependencies in the node_modules linker</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="230">2.3.0<a class="hash-link" aria-label="Direct link to 2.3.0" title="Direct link to 2.3.0" href="changelog.html#230">​</a>
</h2>  <h3 class="anchor anchorWithStickyNavbar_ATBP" id="cli-2">CLI<a class="hash-link" aria-label="Direct link to CLI" title="Direct link to CLI" href="changelog.html#cli-2">​</a>
</h3> <ul> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="token_Ye2a" data-type="positional">tag</span></code></span> set of commands has been ported over from Yarn Classic as <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn npm tag</div></code></span>.</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="See information related to packages
" href="../cli/info.html"><span class="token_Ye2a" data-type="path">info</span></a></code></span> will now print many information about your dependencies. Various options are available to tweak the output, including <code>--json</code>. Plugin authors can provide their own information sections via the <code>fetchPackageInfo</code> hook.</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Add all yarn files to your vcs
" href="../cli/stage.html"><span class="token_Ye2a" data-type="path">stage</span></a></code></span> with the <code>-r,--reset</code> flag will now unstage all changes that seem related to Yarn.</li> <li>All commands now document each of their options (run <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn add -h</div></code></span> to see an example).</li> <li>Publish registry errors will now be reported as is rather than being collapsed into a generic error message.</li> <li>A native binary jumper will now be used on Windows to avoid the <code>Terminate batch job (Y/N)?</code> prompts when invoking dependency binaries.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-7">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-7">​</a>
</h3> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="pnp-api">PnP API<a class="hash-link" aria-label="Direct link to PnP API" title="Direct link to PnP API" href="changelog.html#pnp-api">​</a>
</h3> <p>The following changes only apply to the <code>pnp</code> linker (which is the default install strategy):</p> <ul> <li>The <code>pnpapi</code> module now exposes a new function called <code>getAllLocators</code> allow you to access the list of all locators in the map without having to traverse the dependency tree. This method is considered a Yarn extension, so you should check for its existence if you plan to use it in your code.</li> <li>When using a portal to a package that had peer dependencies, Yarn would loose the information required to resolve those peer dependencies. It will now properly resolve them the same way as all other packages in the dependency tree.</li> </ul> <p>The following changes only apply to the <code>node-modules</code> linker:</p> <ul> <li>The bin symlinks will now be properly removed from the <code>node_modules/.bin</code> folder as their corresponding dependencies are removed.</li> <li>A new setting called <code data-tooltip-id="tooltip" data-tooltip-content="Highest point where packages can be hoisted."><a class="key_FEvO" href="../configuration/yarnrc.html#nmHoistingLimits">nmHoistingLimits</a></code> has appeared. It replaces what was previously known as <code>nohoist</code> in Yarn 1.</li> <li>We are now more forgiving for packages that make incorrect assumptions about the hoisting layout by first trying to maximize package exposure at the top-level. Only after the top-level has been populated will we deduplicate the remaining packages.</li> <li>Fixed some pathological cases around peer dependencies. In particular, workspaces' peer dependencies will now be resolved against their closest workspace ancestor (according to the directory hierarchy) rather than be ignored. Note that peer dependencies are inherently problematic with workspaces when using the <code>node-modules</code> linker, and that the strictly correct behavior can only be obtained by using the default Plug'n'Play linker.</li> <li>Running install after an interrupted install is supported now and will result in a consistent install state</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="shell-2">Shell<a class="hash-link" aria-label="Direct link to Shell" title="Direct link to Shell" href="changelog.html#shell-2">​</a>
</h3> <ul> <li>Added support for <code>$$</code> and <code>$PPID</code>
</li> <li>Fixes some pathological globbing problems.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-7">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-7">​</a>
</h3> <ul> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Check that the project constraints are met
" href="../cli/constraints.html"><span class="token_Ye2a" data-type="path">constraints</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Attempt to automatically fix unambiguous issues, following a multi-pass process">fix</span></code></span> command will now properly persist the changes on disk.</li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Force the unpacking of a list of packages
" href="../cli/unplug.html"><span class="token_Ye2a" data-type="path">unplug</span></a></code></span> command will now work when used on packages with peer dependencies.</li> <li>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Add all yarn files to your vcs
" href="../cli/stage.html"><span class="token_Ye2a" data-type="path">stage</span></a></code></span> command will now allow to stage files when called without the <code>-c,--commit</code> flag.</li> <li>Fixes a performance regression when using FSEvents.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous-1">Miscellaneous<a class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous" href="changelog.html#miscellaneous-1">​</a>
</h3> <ul> <li>Removes extraneous subprocesses when using the <code data-tooltip-id="tooltip" data-tooltip-content="Path of a Yarn binary to use instead of the global one."><a class="key_FEvO" href="../configuration/yarnrc.html#yarnPath">yarnPath</a></code> setting.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="third-party-integrations">Third-party integrations<a class="hash-link" aria-label="Direct link to Third-party integrations" title="Direct link to Third-party integrations" href="changelog.html#third-party-integrations">​</a>
</h3> <ul> <li>Updated the VSCode SDK to take into account changes in the TypeScript server protocol.</li> <li>Added a few builtin extensions to improve compatibility with packages that weren't correctly listing their dependencies.</li> <li>Updated the TypeScript patch to cover TypeScript 4.1.</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="220">2.2.0<a class="hash-link" aria-label="Direct link to 2.2.0" title="Direct link to 2.2.0" href="changelog.html#220">​</a>
</h2>  <h3 class="anchor anchorWithStickyNavbar_ATBP" id="ecosystem">Ecosystem<a class="hash-link" aria-label="Direct link to Ecosystem" title="Direct link to Ecosystem" href="changelog.html#ecosystem">​</a>
</h3> <ul> <li>Packages can now use the <code data-tooltip-id="tooltip" data-tooltip-content="Set of files that must be marked as executable (+x) in the published tarball."><a class="key_FEvO" href="../configuration/manifest.html#publishConfig.executableFiles">publishConfig.executableFiles</a></code> field in their manifests to indicate which files should keep the executable flag once packed in the archive. This is important as for portability reasons Yarn strips the executable flag from all files during packing (otherwise <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Generate a tarball from the active workspace
" href="../cli/pack.html"><span class="token_Ye2a" data-type="path">pack</span></a></code></span> would yield different outputs when run on Posix vs Windows). Files listed in the <code data-tooltip-id="tooltip" data-tooltip-content="Set of files to expose via `yarn run bin-name` and the shell environment."><a class="key_FEvO" href="../configuration/manifest.html#bin">bin</a></code> field are assumed executable by default, so you don't need to explicitly list them in <code>executableFiles</code>.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="bugfixes-8">Bugfixes<a class="hash-link" aria-label="Direct link to Bugfixes" title="Direct link to Bugfixes" href="changelog.html#bugfixes-8">​</a>
</h3> <ul> <li>Requests won't timeout anymore as long as the server is still sending data.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Generate a tarball from the active workspace
" href="../cli/pack.html"><span class="token_Ye2a" data-type="path">pack</span></a></code></span> will properly include main/module/bin files, even when not explicitly referenced through the <code data-tooltip-id="tooltip" data-tooltip-content="Array of file glob patterns that will be included within the published tarball."><a class="key_FEvO" href="../configuration/manifest.html#files">files</a></code> field.</li> <li>Local git repositories can now be fetched via the <code>git+file:</code> protocol.</li> <li>The progress bars will be properly styled when using the new Windows terminal on certain days.</li> <li>Yarn will now avoid using deprecated versions of the dependencies, unless only deprecated versions are available for the requested ranges.</li> <li>Build keys are now properly computed, which fixes issues where build scripts weren't always triggered when they should have been.</li> <li>Negated glob patterns in the <code>workspace</code> field will now be processed correctly.</li> <li>Yarn will now allow relative paths inside the <code>workspace:</code> protocol to start with <code>./</code>
</li> <li>Yarn will now show the actual error when it fails to resolve a request during <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Add dependencies to the project
" href="../cli/add.html"><span class="token_Ye2a" data-type="path">add</span></a></code></span> and <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Upgrade dependencies across the project
" href="../cli/up.html"><span class="token_Ye2a" data-type="path">up</span></a></code></span>
</li> <li>The portable shell will now support calling <code>cd</code> and <code>exit</code> without arguments</li> <li>Yarn will now show the exit code when a lifecycle script fails</li> <li>Yarn's portable shell will now also pipe the stderr when using the <code>|&amp;</code> pipeline</li> <li>Yarn's portable shell will now respect the left associativity of list operators</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="cli-3">CLI<a class="hash-link" aria-label="Direct link to CLI" title="Direct link to CLI" href="changelog.html#cli-3">​</a>
</h3> <ul> <li>Yarn will now report an error when run through an incompatible Node version.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Add dependencies to the project
" href="../cli/add.html"><span class="token_Ye2a" data-type="path">add</span></a></code></span> and <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Upgrade dependencies across the project
" href="../cli/up.html"><span class="token_Ye2a" data-type="path">up</span></a></code></span> will now respect the <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to use interactive prompts by default or not."><a class="key_FEvO" href="../configuration/yarnrc.html#preferInteractive">preferInteractive</a></code> configuration option.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Change a configuration settings
" href="../cli/config/set.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">set</span></a></code></span> now supports the <code>-H,--home</code> flag, which causes it to update the home configuration instead of the project configuration.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="configuration">Configuration<a class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration" href="changelog.html#configuration">​</a>
</h3> <ul> <li>The settings found in the home configuration file won't cause exceptions when consumed by older Yarn versions. Unsupported options will simply be silently ignored. This should improve the user experience when working with multiple projects configured with different Yarn versions.</li> <li>A new <code>immutablePaths</code> setting allow you to specify paths that must not change when running Yarn with the <code>--immutable</code> flag set. You can use it to detect unforeseen changes to your install artifacts, be it <code>.pnp.js</code> or <code>node_modules</code> files.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous-2">Miscellaneous<a class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous" href="changelog.html#miscellaneous-2">​</a>
</h3> <ul> <li>Scripts can now use the <code>$RANDOM</code> variable as well as simple calculations using <code>+</code>, <code>-</code>, <code>*</code>, <code>/</code> and <code>()</code> inside <code>$(())</code>
</li> <li>Scripts can now use grouping curly braces (<code>{echo foo}</code>) to execute a command in the context of the current shell (without creating a subshell like in the case of <code>(echo foo)</code>).</li> <li>Scripts can now end with a semicolon.</li> <li>PnP linker will not remove lingering node_modules inside folders matching <code data-tooltip-id="tooltip" data-tooltip-content="Array of file glob patterns that should be forced to use the default CommonJS resolution."><a class="key_FEvO" href="../configuration/yarnrc.html#pnpIgnorePatterns">pnpIgnorePatterns</a></code>
</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="third-party-integrations-1">Third-party integrations<a class="hash-link" aria-label="Direct link to Third-party integrations" title="Direct link to Third-party integrations" href="changelog.html#third-party-integrations-1">​</a>
</h3> <ul> <li>The PnP hook will now display clearer error message when requiring Node builtins from contexts that can't access them out of the box (for example when accessing the <code>fs</code> module from within a Webpack browser bundle).</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="211">2.1.1<a class="hash-link" aria-label="Direct link to 2.1.1" title="Direct link to 2.1.1" href="changelog.html#211">​</a>
</h2>  <ul> <li>Fixed hyperlink rendering on iTerm</li> </ul> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="210">2.1.0<a class="hash-link" aria-label="Direct link to 2.1.0" title="Direct link to 2.1.0" href="changelog.html#210">​</a>
</h2>  <h3 class="anchor anchorWithStickyNavbar_ATBP" id="ecosystem-1">Ecosystem<a class="hash-link" aria-label="Direct link to Ecosystem" title="Direct link to Ecosystem" href="changelog.html#ecosystem-1">​</a>
</h3> <ul> <li>Packages can now declare they they <em>need</em> to be unpacked in order to be functional using the new <code>"preferUnplugged": true</code> field in the manifest. This will hurt the experience of your users (your project will be the only one that will require hard installs), so please refrain using this field unless there's no other choice.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="new-commands">New commands<a class="hash-link" aria-label="Direct link to New commands" title="Direct link to New commands" href="changelog.html#new-commands">​</a>
</h3> <ul> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Open the search interface
" href="../cli/search.html"><span class="token_Ye2a" data-type="path">search</span></a></code></span> will open a rich interface to search for packages to install (requires the <code>interactive-tools</code> plugin).</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Logout of the npm registry
" href="../cli/npm/logout.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">logout</span></a></code></span> will remove your credentials from your home directory.</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Build a plugin from sources
" href="../cli/plugin/import/from/sources.html"><span class="token_Ye2a" data-type="path">plugin</span> <span class="token_Ye2a" data-type="path">import</span> <span class="token_Ye2a" data-type="path">from</span> <span class="token_Ye2a" data-type="path">sources</span></a></code></span> will allow you to build plugins from the master branch of the our repository.</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install a single workspace and its dependencies
" href="../cli/workspaces/focus.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">focus</span></a></code></span> will only install the current workspace, plus any other workspace it might depend on. The <code>--production</code> flag will only install their production dependencies.</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Execute a shell script
" href="../cli/exec.html"><span class="token_Ye2a" data-type="path">exec</span></a></code></span> will execute the specified command at the root of the current workspace (reintroduced from the Classic branch).</li> <li>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">create</span></span></code></span> is now an alias to <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a package in a temporary environment
" href="../cli/dlx.html"><span class="token_Ye2a" data-type="path">dlx</span></a></code></span> (with the <code>create-</code> prefix.)</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="cli-4">CLI<a class="hash-link" aria-label="Direct link to CLI" title="Direct link to CLI" href="changelog.html#cli-4">​</a>
</h3> <ul> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> will now generate an <a href="https://editorconfig.org" target="_blank" rel="noopener noreferrer">EditorConfig</a> file, and run <code>git init</code> on the resulting folder.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> now supports a <code>-i</code> flag which will automatically pin the Yarn version in the project.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> will now inject the settings from the <code data-tooltip-id="tooltip" data-tooltip-content="Additional fields to set when creating packages via the `init` command."><a class="key_FEvO" href="../configuration/yarnrc.html#initFields">initFields</a></code> configuration setting when generating the initial manifest (future release will remove the now deprecated <code>initVersion</code> and <code>initLicense</code> settings).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Create a new package
" href="../cli/init.html"><span class="token_Ye2a" data-type="path">init</span></a></code></span> will now initialize a workspace project if given the <code>-w</code> flag.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command on all workspaces
" href="../cli/workspaces/foreach.html"><span class="token_Ye2a" data-type="path">workspaces</span> <span class="token_Ye2a" data-type="path">foreach</span></a></code></span> now support glob patterns in <code>--include</code> and <code>--exclude</code>.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Lock the yarn version used by the project
" href="../cli/set/version.html"><span class="token_Ye2a" data-type="path">set</span> <span class="token_Ye2a" data-type="path">version</span></a></code></span> now as an alias called <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="token_Ye2a" data-type="positional">policies</span> <span class="token_Ye2a" data-type="positional">set-version</span></code></span> (will be deprecated in 3.x).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="path_tCL7"><span class="token_Ye2a" data-type="path">run</span></span></code></span> now supports the <code>--inspect</code> and <code>--inspect-brk</code> switches for binaries (for example <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a script defined in the package.json
" href="../cli/run.html"><span class="token_Ye2a" data-type="path">run</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Forwarded to the underlying Node process when executing a binary">inspect-brk</span> <span class="token_Ye2a" data-type="positional">jest</span></code></span>).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Remove dependencies from the project
" href="../cli/remove.html"><span class="token_Ye2a" data-type="path">remove</span></a></code></span> and <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Upgrade dependencies across the project
" href="../cli/up.html"><span class="token_Ye2a" data-type="path">up</span></a></code></span> now support glob patterns.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a package in a temporary environment
" href="../cli/dlx.html"><span class="token_Ye2a" data-type="path">dlx</span></a></code></span> now respects the local project configuration (particularly the configured registries). This is still experimental and will be further improved in the next months.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a package in a temporary environment
" href="../cli/dlx.html"><span class="token_Ye2a" data-type="path">dlx</span></a></code></span> now properly exits with an exit code when the underlying command returned an exit code too.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Read a configuration settings
" href="../cli/config/get.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">get</span></a></code></span> (and <code>set</code>) can now access nested configuration values (for example, <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Read a configuration settings
" href="../cli/config/get.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">get</span></a> <span class="token_Ye2a" data-type="positional">npmScopes.foo.npmRegistryServer</span></code></span> will tell you which server is configured for the given server, if any).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Read a configuration settings
" href="../cli/config/get.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">get</span></a></code></span> will now hide its secrets (or rather yours) from the rest of the world. A new <code>--no-redacted</code> option will toggle off this behavior if needed.</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Change a configuration settings
" href="../cli/config/set.html"><span class="token_Ye2a" data-type="path">config</span> <span class="token_Ye2a" data-type="path">set</span></a></code></span> now has a <code>--json</code> option that will let Yarn know it should interpret the given value as a JSON object (useful to set server configuration, etc).</li> <li>
<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Run a command within the specified workspace
" href="../cli/workspace.html"><span class="token_Ye2a" data-type="path">workspace</span></a> <span class="token_Ye2a" data-type="positional">foreach</span></code></span> will now exit with the expected status code if there's an error.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="configuration-1">Configuration<a class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration" href="changelog.html#configuration-1">​</a>
</h3> <ul> <li>Registry auth settings can now be declared per-scope (they previously had to be per-registry). This will be handy with the GitHub Package Registry model, where each scope may have different access tokens.</li> <li>The configuration file now interpolates the values with the environment variables using the <code>${name}</code> syntax (strict by default; use <code>${name:-default}</code> to provide a default value).</li> <li>The new <code data-tooltip-id="tooltip" data-tooltip-content="Array of file glob patterns that will be excluded from change detection."><a class="key_FEvO" href="../configuration/yarnrc.html#changesetIgnorePatterns">changesetIgnorePatterns</a></code> setting can be used to ignore some paths from the changeset detection from <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Check that all the relevant packages have been bumped
" href="../cli/version/check.html"><span class="token_Ye2a" data-type="path">version</span> <span class="token_Ye2a" data-type="path">check</span></a></code></span> (changes to those paths won't be taken into account when deciding which workspaces need to fresh releases).</li> <li>The new <code>changesetBaseRef</code> setting can be used to change the name of the master branch that <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Check that all the relevant packages have been bumped
" href="../cli/version/check.html"><span class="token_Ye2a" data-type="path">version</span> <span class="token_Ye2a" data-type="path">check</span></a></code></span> will use in its changeset heuristic.</li> <li>The new <code data-tooltip-id="tooltip" data-tooltip-content="Amount of time to wait in milliseconds before cancelling pending HTTP requests."><a class="key_FEvO" href="../configuration/yarnrc.html#httpTimeout">httpTimeout</a></code> and <code data-tooltip-id="tooltip" data-tooltip-content="Amount of time to wait in seconds before retrying a failed HTTP request."><a class="key_FEvO" href="../configuration/yarnrc.html#httpRetry">httpRetry</a></code> settings allow you to configure the behavior of the HTTP(s) requests.</li> <li>The new <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to truncate lines that would go beyond the size of the terminal or not."><a class="key_FEvO" href="../configuration/yarnrc.html#preferTruncatedLines">preferTruncatedLines</a></code> setting allow you to tell Yarn that it's ok if info and warning messages are truncated to fit in a single line (errors will always wrap as much as needed, and piping Yarn's output will toggle off this behaviour altogether).</li> <li>The cache compression level can now be configured through <code data-tooltip-id="tooltip" data-tooltip-content="Compression level employed for zip archives"><a class="key_FEvO" href="../configuration/yarnrc.html#compressionLevel">compressionLevel</a></code>. If you don't use Zero-Installs, using a value of <code>0</code> may yield speed improvements at little cost.</li> <li>Plugins are now loaded from the location of the RC file.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="protocols">Protocols<a class="hash-link" aria-label="Direct link to Protocols" title="Direct link to Protocols" href="changelog.html#protocols">​</a>
</h3> <ul> <li>The Git protocol has been improved, and now supports multiple patterns that were missing.</li> <li>The Git protocol can now clone any workspace from a given repository. To do this, use the <code>owner/repo#workspace=name</code> syntax (which you can mix with branch names as usual).</li> <li>The repositories cloned using the Git protocol will now automatically disable <code>core.autocrlf</code> so that the builds lead to deterministic results. Generally speaking, improvements have been made to avoid freshly built packages from generating different results.</li> <li>Packages fetched using the Git protocol will now be built using either of Yarn 1, Yarn 2, npm, or pnpm. The choice will be made based on the content of the sources (for example, we will pack the project using <code>npm pack</code> if we detect a <code>package-lock.json</code>).</li> <li>The <code>exec:</code> protocol has a different API. In particular, builtin modules can now be accessed without having to actually require them.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="installs-8">Installs<a class="hash-link" aria-label="Direct link to Installs" title="Direct link to Installs" href="changelog.html#installs-8">​</a>
</h3> <ul> <li>Deprecation warnings are now shown during installs.</li> <li>The out-of-file PnP data generation has been fixed (it allows to generate the PnP data in a JSON file separated from the JS loader itself).</li> <li>An edge case in the virtual instances deduplication has been fixed; packages with the same effective peer dependencies now always share the exact same instance.</li> <li>The heuristic we use to locate zip files within paths has been improved. As a result, running ESLint on our repository now takes 28s instead of 57s.</li> <li>Yarn will now exclude the node_modules folder from the workspace detection. As a result, listing <code>**/*</code> in your <code data-tooltip-id="tooltip" data-tooltip-content="Array of folder glob patterns referencing the workspaces of the project."><a class="key_FEvO" href="../configuration/manifest.html#workspaces">workspaces</a></code> field will now detect all child packages as workspaces.</li> <li>The cache names have changed in order to make the cache content-addressed. In particular, this mean that in the event where we need to fix a bug in the fetch steps, we won't need to bump a global cache key anymore.</li> <li>The PnP linker now features an additional loose mode (optional, and enabled through the <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to attempt to simulate traditional `node_modules` hoisting."><a class="key_FEvO" href="../configuration/yarnrc.html#pnpMode">pnpMode</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">loose</span></code> setting). Under this mode, Yarn will compute the list of packages that would have been hoisted under the node_modules linker, and let the application code access them with only a warning. This mode will however not become the default - warnings cannot be caught by the application code, and as a result the output of the loose mode can be quite verbose, often being more confusing than the strict mode.</li> <li>Because we're aware of no incorrect hoisting bug on the v2 (but have discovered a few in the v1), and because its performances are about the same, the node_modules linker from Yarn 2 is now deemed more stable than the one from the v1, and we recommend users to migrate to it even if you don't want to use Plug'n'Play. More improvements are to come, but they'll mostly be in the user experience (for example to mix PnP and nm into a single install).</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="rendering">Rendering<a class="hash-link" aria-label="Direct link to Rendering" title="Direct link to Rendering" href="changelog.html#rendering">​</a>
</h3> <ul> <li>Rendering on small terminals (or terminals which didn't expose their size) could lead to failed assertions. This is now fixed.</li> <li>The output of <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Open the upgrade interface
" href="../cli/upgrade-interactive.html"><span class="token_Ye2a" data-type="path">upgrade-interactive</span></a></code></span> has been revamped to reintroduce some elements that had been omitted when porting the command from the v1 to the v2.</li> <li>Error codes are now hyperlinks on compatible terminals.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="third-party-integrations-2">Third-party integrations<a class="hash-link" aria-label="Direct link to Third-party integrations" title="Direct link to Third-party integrations" href="changelog.html#third-party-integrations-2">​</a>
</h3> <ul> <li>The PnP hook will now display the list of packages that broke the peer dependency chain (it previously only showed the name of the package that wasn't provided the peer dependency, but not the name of which ancestor was responsible).</li> <li>We have added <code>lutimes</code> support into Node itself, since it was otherwise impossible to implement perfect copy mechanisms (the copied symlinks would end up with different mtime than their originals).</li> <li>The SDK files have been moved from <code>.vscode/pnpify</code> to <code>.yarn/sdks</code>.</li> <li>Improvements have been made in the VSCode integration. In particular, the PnP support is now good enough that it started to fix some longstanding issues that VSCode had with properly naming workspaces.</li> <li>We have contributed to VSCode support for third-party protocols with TypeScript. As a result, zip archives now properly support the "Jump to definition" workflow (this requires the <a href="https://marketplace.visualstudio.com/items?itemName=arcanis.vscode-zipfs" target="_blank" rel="noopener noreferrer">ZipFS</a> extension to be installed).</li> <li>The SDK output has been migrated to the same standard as the other commands.</li> <li>The SDK can now prepare the development environment for both VSCode and Vim. More third-party tools have been added, such as the Svelte extension. Note: the SDK is only needed for editor integrations; you don't need it if you just want to author JavaScript on basic text editors.</li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous-3">Miscellaneous<a class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous" href="changelog.html#miscellaneous-3">​</a>
</h3> <ul> <li>Scripts can now use glob patterns, which will be resolved regardless of the underlying shell (so it'll work on Windows as well as Linux). Note that this only covers file globbing - using something like <code>echo {foo,bar}</code> won't work expect if there's actually a file named <code>foo</code> and/or <code>bar</code>.</li> <li>Sending SIGKILL (or other signals) to the Yarn process wasn't causing the child processes to stop. Yarn will now forward the signal, and wait for its children to exit.</li> <li>Some temporary folders weren't properly cleaned up; this has been fixed.</li> <li>Support for the <code>.cjs</code> extension has been added to multiple files in order to make it easier to use <code>"type": "module"</code>.</li> <li>The bundle has received various size and startup time optimizations.</li> </ul> <hr> <h2 class="anchor anchorWithStickyNavbar_ATBP" id="200">2.0.0<a class="hash-link" aria-label="Direct link to 2.0.0" title="Direct link to 2.0.0" href="changelog.html#200">​</a>
</h2>  <p>Remember that a <a href="../getting-started/migration.html" target="_blank" rel="noopener noreferrer">migration guide</a> is available to help you port your applications to Yarn 2.</p> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="notable-fixes">Notable fixes<a class="hash-link" aria-label="Direct link to Notable fixes" title="Direct link to Notable fixes" href="changelog.html#notable-fixes">​</a>
</h3> <ul> <li> <p>Using <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Connect the local project to another one
" href="../cli/link.html"><span class="token_Ye2a" data-type="path">link</span></a></code></span> will now properly resolve peer dependencies based on the package that requires the linked package rather than the dependencies installed in the linked project folder.</p> </li> <li> <p>Packages will now only be built when one of their dependencies is changed in some way. Note that this includes both direct dependencies and transitive dependencies, which might trigger unintuitive rebuilds in some case (for example, since <code>node-sass</code> depends on <code>lodash.assign</code>, upgrading <code>lodash.assign</code> will trigger a rebuild). This will be improved in a later release by introducing a new <code>runtime</code> field for the <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `dependencies` and `devDependencies` fields are interpreted."><a class="key_FEvO" href="../configuration/manifest.html#dependenciesMeta">dependenciesMeta</a></code> object that will exclude the package from the build key computation (feel free to start setting this flag as of now, even if it won't have any effect until then).</p> </li> <li> <p>Registry hostnames finally aren't part of the lockfile anymore. It means that you can switch the registry at any time by changing the <code data-tooltip-id="tooltip" data-tooltip-content="Define the registry to use when fetching packages."><a class="key_FEvO" href="../configuration/yarnrc.html#npmRegistryServer">npmRegistryServer</a></code> settings. One unfortunate limitation is that this doesn't apply to registries that use non-standard paths for their archives (ie <code>/@scope/name/-/name-version.tgz</code>). One such example is NPM Enterprise, which will see the full path being stored in the lockfile.</p> </li> <li> <p>The <code>--immutable</code> option (new name for <code>--frozen-lockfile</code>) will now properly report when the lockfile would be changed because of entry removals (it would previously only reject new entries, not removals).</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="notable-changes">Notable changes<a class="hash-link" aria-label="Direct link to Notable changes" title="Direct link to Notable changes" href="changelog.html#notable-changes">​</a>
</h3> <ul> <li> <p>We dropped support for Node 8, which has reached its end of life in December.</p> </li> <li> <p>Accessing registries through http is now forbidden by default (Yarn will throw an exception and require to use https instead). This can be overruled on a per-hostname basis by using <a href="../configuration/yarnrc.html#unsafeHttpWhitelist" target="_blank" rel="noopener noreferrer"><code data-tooltip-id="tooltip" data-tooltip-content="Array of hostname glob patterns for which using the HTTP protocol is allowed."><span class="key_FEvO">unsafeHttpWhitelist</span></code></a>.</p> </li> <li> <p>The meaning of <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that must be made available to the current package in order for it to work properly as a workspace."><a class="key_FEvO" href="../configuration/manifest.html#devDependencies">devDependencies</a></code> is slightly altered. Until then dev dependencies were described as "dependencies we only use in development". Given that we now advocate for all your packages to be stored within the repository (in order to guarantee reproducible builds), this doesn't really make sense anymore. As a result, our description of dev dependencies is now "dependencies that aren't installed by the package consumers". It doesn't really change anything else than the name, but the more you know.</p> <ul> <li>One particular note is that you cannot install production dependencies only at the moment. We plan to add back this feature at a later time, but given that enabling <a href="../features/zero-installs.html" target="_blank" rel="noopener noreferrer">Zero-Installs</a> would cause your repository to contain all your packages anyway (prod &amp; dev), this feature isn't deemed as important as it used to be.</li> </ul> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn link &lt;package&gt;</div></code></span> now has a semi-permanent effect in that <code>&lt;package&gt;</code> will be added as a dependency of your active workspace (using the new <code>portal:</code> protocol). Apart from that the workflow stays the same, meaning that running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Connect the local project to another one
" href="../cli/link.html"><span class="token_Ye2a" data-type="path">link</span></a></code></span> somewhere will add the local path to the local registry, and <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn link &lt;package&gt;</div></code></span> will add a dependency to the previously linked package.</p> <ul> <li>To disable such a link, just remove its <code>resolution</code> entry and run <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Install the project dependencies
" href="../cli/install.html"><span class="token_Ye2a" data-type="path">install</span></a></code></span> again.</li> </ul> </li> <li> <p>The Yarn configuration has been revamped and <em>will not read the <code>.npmrc</code> files anymore.</em> This used to cause a lot of confusion as to where the configuration was coming from, so the logic is now very simple: Yarn will look in the current directory and all its ancestors for <code>.yarnrc.yml</code> files.</p> <ul> <li>Note that the configuration files are now called <code>.yarnrc.yml</code> and thus are expected to be valid YAML. The available settings are listed <a href="../configuration/yarnrc.html" target="_blank" rel="noopener noreferrer">here</a>.</li> </ul> </li> <li> <p>The lockfiles now generated should be compatible with Yaml, while staying compatible with old-style lockfiles. Old-style lockfiles will be automatically migrated, but that will require some round-trips to the registry to obtain more information that wasn't stored previously, so the first install will be slightly slower.</p> </li> <li> <p>The cache files are now zip instead of tgz. This has an impact on cold install performances, because the currently available registries don't support it, which requires us to convert it on our side. Zero-Install is one way to offset this cost, and we're hoping that registries will consider offering zip as an option in the future.</p> <ul> <li>We chose zip because of its perfect combination in terms of tooling ubiquity and random access performances (tgz would require to decompress the whole archive to access a single file).</li> </ul> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="package-manifests-packagejson">Package manifests (<code>package.json</code>)<a class="hash-link" aria-label="Direct link to package-manifests-packagejson" title="Direct link to package-manifests-packagejson" href="changelog.html#package-manifests-packagejson">​</a>
</h3> <p>To see a comprehensive documentation about each possible field, please check our <a href="../configuration/manifest.html" target="_blank" rel="noopener noreferrer">documentation</a>.</p> <ul> <li> <p>Two new fields are now supported in the <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the package is published."><a class="key_FEvO" href="../configuration/manifest.html#publishConfig">publishConfig</a></code> key of your manifests: the <code data-tooltip-id="tooltip" data-tooltip-content="Path of the file that should be resolved when requiring the package via a bare identifier."><a class="key_FEvO" href="../configuration/manifest.html#main">main</a></code>, <code data-tooltip-id="tooltip" data-tooltip-content="Set of files to expose via `yarn run bin-name` and the shell environment."><a class="key_FEvO" href="../configuration/manifest.html#bin">bin</a></code>, and <code data-tooltip-id="tooltip" data-tooltip-content="Path of the file that should be resolved when requiring the package via a bare identifier in an ES6-compatible bundler environment."><a class="key_FEvO" href="../configuration/manifest.html#module">module</a></code> fields will be used to replace the value of their respective top-level counterparts in the manifest shipped along with the generated file.</p> <ul> <li>The <code>typings</code> and <code>types</code> fields will also be replaced if you use the <a href="https://github.com/yarnpkg/berry/tree/master/packages/plugin-typescript" target="_blank" rel="noopener noreferrer">TypeScript plugin</a>.</li> </ul> </li> <li> <p>Two new fields are now supported at the root of the manifest: <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `dependencies` and `devDependencies` fields are interpreted."><a class="key_FEvO" href="../configuration/manifest.html#dependenciesMeta">dependenciesMeta</a></code> and <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `peerDependencies` field is interpreted."><a class="key_FEvO" href="../configuration/manifest.html#peerDependenciesMeta">peerDependenciesMeta</a></code> (<code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `peerDependencies` field is interpreted."><a class="key_FEvO" href="../configuration/manifest.html#peerDependenciesMeta">peerDependenciesMeta</a></code> actually was supported in Yarn 1 as well, but <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `dependencies` and `devDependencies` fields are interpreted."><a class="key_FEvO" href="../configuration/manifest.html#dependenciesMeta">dependenciesMeta</a></code> is a new addition). These fields are meant to store dependency settings unique to each package.</p> <ul> <li> <p>Both of these new fields, and all settings the support, are entirely optional. Yarn will keep doing what you expect if they're not there - they're just a mechanism to expose more fine-grained settings.</p> </li> <li> <p>Some of those settings can only be declared in the project top-level manifest and will be ignored anywhere else (for example <code>built</code>), while others will have a per-package effect (for example <code>optional</code>). As a rule of thumb, <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `dependencies` and `devDependencies` fields are interpreted."><a class="key_FEvO" href="../configuration/manifest.html#dependenciesMeta">dependenciesMeta</a></code> settings are always project-wide (and thus are only taken into account in the top-level package.json) while <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `peerDependencies` field is interpreted."><a class="key_FEvO" href="../configuration/manifest.html#peerDependenciesMeta">peerDependenciesMeta</a></code> settings are package-specific.</p> </li> <li> <p>The <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `dependencies` and `devDependencies` fields are interpreted."><a class="key_FEvO" href="../configuration/manifest.html#dependenciesMeta">dependenciesMeta</a></code> field covers dependencies declared in either of the <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that must be made available to the current package in order for it to work properly."><a class="key_FEvO" href="../configuration/manifest.html#dependencies">dependencies</a></code> and <code data-tooltip-id="tooltip" data-tooltip-content="Set of dependencies that must be made available to the current package in order for it to work properly as a workspace."><a class="key_FEvO" href="../configuration/manifest.html#devDependencies">devDependencies</a></code> fields.</p> </li> <li> <p>The <code data-tooltip-id="tooltip" data-tooltip-content="Extra settings affecting how the `dependencies` and `devDependencies` fields are interpreted."><a class="key_FEvO" href="../configuration/manifest.html#dependenciesMeta">dependenciesMeta</a></code> field accepts two types of keys: either a generic package name (<code>lodash</code>), or a specialized package <strong>version</strong> (<code>lodash@1.2.3</code>). This later syntax only works for the top-level manifest and <em>will thus be ignored when seen in a dependency / transitive dependency</em>.</p> </li> </ul> </li> <li> <p>The <code>dependenciesMeta[].comment</code> field is expected to be a string field. Even though it isn't actually used anywhere at the moment, we suggest you to write comments regarding the reason why some packages are used here rather than anywhere else. This might prove useful for plugin authors.</p> </li> <li> <p>The <code>dependenciesMeta[].built</code> field is a boolean flag; setting it to <code>false</code> will cause the package manager to ignore this package when considering the list of packages that need to be built. If the project uses <code>enable-scripts: false</code>, the warning that would have traditionally been emitted will be downgraded into a simple notice. This settings is project-wide.</p> </li> <li> <p>The <code>peerDependenciesMeta[].optional</code> field is a boolean flag; setting it to <code>true</code> will stop the package manager from emitting a warning when the specified peer dependency is missing (you typically want to use it if you provide optional integrations with specific third-party packages and don't want to pollute your users' installs with a bunch of irrelevant warnings). This settings is package-specific.</p> </li> <li> <p>The <code data-tooltip-id="tooltip" data-tooltip-content="Override the resolutions of specific dependencies."><a class="key_FEvO" href="../configuration/manifest.html#resolutions">resolutions</a></code> field no longer support the glob syntax within its patterns, as it was redundant with its own glob-less syntax and caused unnecessary confusion.</p> <div class="language-diff-json codeBlockContainer_EXcq theme-code-block"><div class="codeBlockContent_gO9Y">
<pre tabindex="0" class="prism-code language-diff-json codeBlock_itEV thin-scrollbar" data-language="diff">{
  "resolutions": {
-    "**/@babel/core": "7.5.5",
+    "@babel/core": "7.5.5",
  }
}</pre>

</div></div> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="workspaces">Workspaces<a class="hash-link" aria-label="Direct link to Workspaces" title="Direct link to Workspaces" href="changelog.html#workspaces">​</a>
</h3> <ul> <li> <p>Workspaces can now be referenced using the special <code>workspace:</code> protocol. This protocol accepts either a relative path to the workspace, or a semver range that will be compared against the <code data-tooltip-id="tooltip" data-tooltip-content="Version of the package."><a class="key_FEvO" href="../configuration/manifest.html#version">version</a></code> fields from candidate workspaces.</p> </li> <li> <p>Workspaces don't have to specify a version anymore. If referenced through the <code>workspace:</code> resolver, the engine will assume that they have the version <code>0.0.0</code> (which makes <code>workspace:*</code> a good way to say "shut up and take my workspace").</p> <ul> <li>That being said, workspaces referenced through the <code>workspace:</code> protocol will see their referenced changed at pack-time <em>if the target workspace defines a version</em>. An error will be thrown otherwise and the package won't be packable.</li> </ul> </li> <li> <p>Workspaces can now contain sub-workspaces. This follow the same restriction than before, meaning that any workspace that wishes to expose sub-workspaces must be declared <code data-tooltip-id="tooltip" data-tooltip-content="Define whether the package is meant to be published."><a class="key_FEvO" href="../configuration/manifest.html#private">private</a><span class="assign_Ad7a">:</span> <span class="value_jT9z">true</span></code>.</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="cli-5">CLI<a class="hash-link" aria-label="Direct link to CLI" title="Direct link to CLI" href="changelog.html#cli-5">​</a>
</h3> <ul> <li> <p>The npm-specific commands (such as <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="token_Ye2a" data-type="positional">login</span></code></span> or <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="token_Ye2a" data-type="positional">publish</span></code></span>) have been moved into a specific namespace (<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Store new login info to access the npm registry
" href="../cli/npm/login.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">login</span></a></code></span> / <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Publish the active workspace to the npm registry
" href="../cli/npm/publish.html"><span class="token_Ye2a" data-type="path">npm</span> <span class="token_Ye2a" data-type="path">publish</span></a></code></span>). This doesn't affect the <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Generate a tarball from the active workspace
" href="../cli/pack.html"><span class="token_Ye2a" data-type="path">pack</span></a></code></span> command which is considered generic enough for the top-level.</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn &lt;path&gt; add ...</div></code></span> will run the <code>add</code> command into the location pointed by <code>&lt;path&gt;</code>. This is true for any command. The only limitation is that <code>&lt;path&gt;</code> must be either be <code>.</code>, <code>..</code>, or must contain a slash (in order to disambiguate with script and command names).</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn add -P &lt;package&gt;</div></code></span> will use <code>*</code> by default instead of resolving a new range for <code>&lt;package&gt;</code>. This change only affects peer dependencies (<code>-P</code>), and can be disabled by manually specifying the range (<span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Add dependencies to the project
" href="../cli/add.html"><span class="token_Ye2a" data-type="path">add</span></a> <span class="token_Ye2a" data-type="dash">-</span><span class="token_Ye2a" data-type="option" data-tooltip-id="tooltip" data-tooltip-content="Add a package as a peer dependency">P</span> <span class="token_Ye2a" data-type="positional">lodash@^4.0.0</span></code></span>).</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn add &lt;package&gt; -i</div></code></span> will now make suggestions based on the dependencies from your other workspaces. This behavior can be made a default by setting <code data-tooltip-id="tooltip" data-tooltip-content="Define whether to use interactive prompts by default or not."><a class="key_FEvO" href="../configuration/yarnrc.html#preferInteractive">preferInteractive</a></code> to <code>true</code> in your settings.</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <span class="token_Ye2a" data-type="positional">foo:bar</span></code></span> will run the <code>foo:bar</code> script regardless of what workspace declares it as long as only one workspace declares it. <em>This change only affects scripts whose names contains at least one colon.</em></p> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn remove -A &lt;package&gt;</div></code></span> will remove <code>&lt;package&gt;</code> from all the dependency sets from all your workspaces, regardless of what your cwd is.</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn set resolution &lt;package&gt; &lt;resolution&gt;</div></code></span> will force the resolver to use a specific resolution for the given package descriptor. Note that the descriptor passed as parameter must be exactly the same as the one you want to override. This command is a handy tool to manually optimize some ranges that could benefit from overlapping.</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><div class="comment_nCoG">yarn up &lt;package&gt;</div></code></span> will upgrade <code>&lt;package&gt;</code> in all of your workspaces at once (only if they already use the specified package - those that don't won't see it being added). Adding the <code>-i</code> flag will also cause Yarn to ask you to confirm for each workspace.</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Display the current configuration
" href="../cli/config.html"><span class="token_Ye2a" data-type="path">config</span></a> <span class="token_Ye2a" data-type="dash">--</span><span class="token_Ye2a" data-type="option">why</span></code></span> will tell you the source for each value in your configuration. We recommend using it when you're not sure to understand why Yarn would have a particular settings.</p> </li> <li> <p>Running <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Generate a tarball from the active workspace
" href="../cli/pack.html"><span class="token_Ye2a" data-type="path">pack</span></a></code></span> will no longer always include <em>nested</em> README, CHANGELOG, LICENSE or LICENCE files (note that those files will still be included if found at the root of the workspace being packed, as is usually the case). If you rely on this (<a href="https://github.com/npm/npm-packlist/blob/270f534bc70dfb1d316682226332fd05e75e1b14/index.js#L162-L168" target="_blank" rel="noopener noreferrer">somewhat unintended</a>) behavior you can add those files manually to the <code data-tooltip-id="tooltip" data-tooltip-content="Array of file glob patterns that will be included within the published tarball."><a class="key_FEvO" href="../configuration/manifest.html#files">files</a></code> field of your <code>package.json</code>.</p> </li> <li> <p>The <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Open the upgrade interface
" href="../cli/upgrade-interactive.html"><span class="token_Ye2a" data-type="path">upgrade-interactive</span></a></code></span> command has been moved into a plugin that needs to be installed through <span class="inline_hdsZ"><code><span class="token_Ye2a" data-type="binary">yarn</span> <a class="path_tCL7" data-tooltip-id="tooltip" data-tooltip-content="Download a plugin
" href="../cli/plugin/import.html"><span class="token_Ye2a" data-type="path">plugin</span> <span class="token_Ye2a" data-type="path">import</span></a> <span class="token_Ye2a" data-type="positional">interactive-tools</span></code></span>. It's also been rewritten, and we'll keep improving over time.</p> </li> </ul> <h3 class="anchor anchorWithStickyNavbar_ATBP" id="miscellaneous-4">Miscellaneous<a class="hash-link" aria-label="Direct link to Miscellaneous" title="Direct link to Miscellaneous" href="changelog.html#miscellaneous-4">​</a>
</h3> <ul> <li> <p>A new protocol is now supported, <code>portal:</code>. Portals are very much like <code>link:</code> in that they directly point to a location on the disk, but unlike links they also take into account the dependencies of the target location (whereas links don't care about these). To give you a better idea, portals are what you use when you want to target a <em>package</em>, whereas links are what you use when you want to target a non-package folder (for example your <code>src</code> directory, or similar).</p> </li> <li> <p>A new protocol is now supported, <code>patch:</code>. The patch protocol can be used to automatically apply changes to the sources of a package. It's very similar to <a href="https://github.com/ds300/patch-package" target="_blank" rel="noopener noreferrer"><code>patch-package</code></a>, but is directly integrated within Yarn (including its cache and checksum systems).</p> </li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2016&ndash;present Yarn Contributors<br>Licensed under the BSD License.<br>
    <a href="https://yarnpkg.com/advanced/changelog" class="_attribution-link">https://yarnpkg.com/advanced/changelog</a>
  </p>
</div>
