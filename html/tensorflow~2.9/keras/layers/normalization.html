<h1 class="devsite-page-title">tf.keras.layers.Normalization</h1> <devsite-bookmark></devsite-bookmark>       <p>A preprocessing layer which normalizes continuous features.</p> <p>Inherits From: <a href="experimental/preprocessing/preprocessinglayer.html"><code translate="no" dir="ltr">PreprocessingLayer</code></a>, <a href="layer.html"><code translate="no" dir="ltr">Layer</code></a>, <a href="../../module.html"><code translate="no" dir="ltr">Module</code></a></p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases">View aliases</h4> <p> <b>Main aliases</b> </p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Normalization"><code translate="no" dir="ltr">tf.keras.layers.experimental.preprocessing.Normalization</code></a></p> <b>Compat aliases for migration</b> <p>See <a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for more details.</p> <p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Normalization"><code translate="no" dir="ltr">tf.compat.v1.keras.layers.Normalization</code></a>, <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Normalization"><code translate="no" dir="ltr">tf.compat.v1.keras.layers.experimental.preprocessing.Normalization</code></a></p> </section> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
tf.keras.layers.Normalization(
    axis=-1, mean=None, variance=None, **kwargs
)
</pre>  <p>This layer will shift and scale inputs into a distribution centered around 0 with standard deviation 1. It accomplishes this by precomputing the mean and variance of the data, and calling <code translate="no" dir="ltr">(input - mean) / sqrt(var)</code> at runtime.</p> <p>The mean and variance values for the layer must be either supplied on construction or learned via <code translate="no" dir="ltr">adapt()</code>. <code translate="no" dir="ltr">adapt()</code> will compute the mean and variance of the data and store them as the layer's weights. <code translate="no" dir="ltr">adapt()</code> should be called before <code translate="no" dir="ltr">fit()</code>, <code translate="no" dir="ltr">evaluate()</code>, or <code translate="no" dir="ltr">predict()</code>.</p> <p>For an overview and full list of preprocessing layers, see the preprocessing <a href="https://www.tensorflow.org/guide/keras/preprocessing_layers">guide</a>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">axis</code> </td> <td> Integer, tuple of integers, or None. The axis or axes that should have a separate mean and variance for each index in the shape. For example, if shape is <code translate="no" dir="ltr">(None, 5)</code> and <code translate="no" dir="ltr">axis=1</code>, the layer will track 5 separate mean and variance values for the last axis. If <code translate="no" dir="ltr">axis</code> is set to <code translate="no" dir="ltr">None</code>, the layer will normalize all elements in the input by a scalar mean and variance. Defaults to -1, where the last axis of the input is assumed to be a feature dimension and is normalized per index. Note that in the specific case of batched scalar inputs where the only axis is the batch axis, the default will normalize each index in the batch separately. In this case, consider passing <code translate="no" dir="ltr">axis=None</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">mean</code> </td> <td> The mean value(s) to use during normalization. The passed value(s) will be broadcast to the shape of the kept axes above; if the value(s) cannot be broadcast, an error will be raised when this layer's <code translate="no" dir="ltr">build()</code> method is called. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">variance</code> </td> <td> The variance value(s) to use during normalization. The passed value(s) will be broadcast to the shape of the kept axes above; if the value(s) cannot be broadcast, an error will be raised when this layer's <code translate="no" dir="ltr">build()</code> method is called. </td> </tr> </table> <h4 id="examples" data-text="Examples:">Examples:</h4> <p>Calculate a global mean and variance by analyzing the dataset in <code translate="no" dir="ltr">adapt()</code>.</p> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
adapt_data = np.array([1., 2., 3., 4., 5.], dtype='float32')
input_data = np.array([1., 2., 3.], dtype='float32')
layer = tf.keras.layers.Normalization(axis=None)
layer.adapt(adapt_data)
layer(input_data)
&lt;tf.Tensor: shape=(3,), dtype=float32, numpy=
array([-1.4142135, -0.70710677, 0.], dtype=float32)&gt;
</pre> <p>Calculate a mean and variance for each index on the last axis.</p> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
adapt_data = np.array([[0., 7., 4.],
                       [2., 9., 6.],
                       [0., 7., 4.],
                       [2., 9., 6.]], dtype='float32')
input_data = np.array([[0., 7., 4.]], dtype='float32')
layer = tf.keras.layers.Normalization(axis=-1)
layer.adapt(adapt_data)
layer(input_data)
&lt;tf.Tensor: shape=(1, 3), dtype=float32, numpy=
array([-1., -1., -1.], dtype=float32)&gt;
</pre> <p>Pass the mean and variance directly.</p> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
input_data = np.array([[1.], [2.], [3.]], dtype='float32')
layer = tf.keras.layers.Normalization(mean=3., variance=2.)
layer(input_data)
&lt;tf.Tensor: shape=(3, 1), dtype=float32, numpy=
array([[-1.4142135 ],
       [-0.70710677],
       [ 0.        ]], dtype=float32)&gt;
</pre>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">is_adapted</code> </td> <td> Whether the layer has been fit to data already. </td> </tr> </table> <h2 id="methods" data-text="Methods">Methods</h2> <h3 id="adapt" data-text="adapt"><code translate="no" dir="ltr">adapt</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/layers/preprocessing/normalization.py#L197-L242">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
adapt(
    data, batch_size=None, steps=None
)
</pre> <p>Computes the mean and variance of values in a dataset.</p> <p>Calling <code translate="no" dir="ltr">adapt()</code> on a <code translate="no" dir="ltr">Normalization</code> layer is an alternative to passing in <code translate="no" dir="ltr">mean</code> and <code translate="no" dir="ltr">variance</code> arguments during layer construction. A <code translate="no" dir="ltr">Normalization</code> layer should always either be adapted over a dataset or passed <code translate="no" dir="ltr">mean</code> and <code translate="no" dir="ltr">variance</code>.</p> <p>During <code translate="no" dir="ltr">adapt()</code>, the layer will compute a <code translate="no" dir="ltr">mean</code> and <code translate="no" dir="ltr">variance</code> separately for each position in each axis specified by the <code translate="no" dir="ltr">axis</code> argument. To calculate a single <code translate="no" dir="ltr">mean</code> and <code translate="no" dir="ltr">variance</code> over the input data, simply pass <code translate="no" dir="ltr">axis=None</code>.</p> <p>In order to make <code translate="no" dir="ltr">Normalization</code> efficient in any distribution context, the computed mean and variance are kept static with respect to any compiled <a href="../../graph.html"><code translate="no" dir="ltr">tf.Graph</code></a>s that call the layer. As a consequence, if the layer is adapted a second time, any models using the layer should be re-compiled. For more information see <a href="experimental/preprocessing/preprocessinglayer.html#adapt"><code translate="no" dir="ltr">tf.keras.layers.experimental.preprocessing.PreprocessingLayer.adapt</code></a>.</p> <p><code translate="no" dir="ltr">adapt()</code> is meant only as a single machine utility to compute layer state. To analyze a dataset that cannot fit on a single machine, see <a href="https://www.tensorflow.org/tfx/transform/get_started">Tensorflow Transform</a> for a multi-machine, map-reduce solution.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> The data to train on. It can be passed either as a <a href="../../data/dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a>, or as a numpy array. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per state update. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of datasets, generators, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Total number of steps (batches of samples) When training with input tensors such as TensorFlow data tensors, the default <code translate="no" dir="ltr">None</code> is equal to the number of samples in your dataset divided by the batch size, or 1 if that cannot be determined. If x is a <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset, and 'steps' is None, the epoch will run until the input dataset is exhausted. When passing an infinitely repeating dataset, you must specify the <code translate="no" dir="ltr">steps</code> argument. This argument is not supported with array inputs. </td> </tr> </table> <h3 id="compile" data-text="compile"><code translate="no" dir="ltr">compile</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/base_preprocessing_layer.py#L134-L154">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
compile(
    run_eagerly=None, steps_per_execution=None
)
</pre> <p>Configures the layer for <code translate="no" dir="ltr">adapt</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">run_eagerly</code> </td> <td> Bool. Defaults to <code translate="no" dir="ltr">False</code>. If <code translate="no" dir="ltr">True</code>, this <code translate="no" dir="ltr">Model</code>'s logic will not be wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. Recommended to leave this as <code translate="no" dir="ltr">None</code> unless your <code translate="no" dir="ltr">Model</code> cannot be run inside a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. steps_per_execution: Int. Defaults to 1. The number of batches to run during each <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> call. Running multiple batches inside a single <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> call can greatly improve performance on TPUs or small models with a large Python overhead. </td> </tr> </table> <h3 id="reset_state" data-text="reset_state"><code translate="no" dir="ltr">reset_state</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/layers/preprocessing/normalization.py#L281-L287">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
reset_state()
</pre> <p>Resets the statistics of the preprocessing layer.</p> <h3 id="update_state" data-text="update_state"><code translate="no" dir="ltr">update_state</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/layers/preprocessing/normalization.py#L244-L279">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
update_state(
    data
)
</pre> <p>Accumulates statistics for the preprocessing layer.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Arguments</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A mini-batch of inputs to the layer. </td> </tr> </table>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/keras/layers/Normalization" class="_attribution-link">https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/keras/layers/Normalization</a>
  </p>
</div>
