<h1 class="devsite-page-title">tf.keras.experimental.WideDeepModel</h1> <devsite-bookmark></devsite-bookmark>      <table class="tfo-notebook-buttons tfo-api nocontent" align="left">  <td> <a target="_blank" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/premade_models/wide_deep.py#L33-L217">  View source on GitHub </a> </td> </table> <p>Wide &amp; Deep Model for regression and classification problems.</p> <p>Inherits From: <a href="../model.html"><code translate="no" dir="ltr">Model</code></a>, <a href="../layers/layer.html"><code translate="no" dir="ltr">Layer</code></a>, <a href="../../module.html"><code translate="no" dir="ltr">Module</code></a></p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases">View aliases</h4> <p> <b>Compat aliases for migration</b> </p>
<p>See <a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for more details.</p> <p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/experimental/WideDeepModel"><code translate="no" dir="ltr">tf.compat.v1.keras.experimental.WideDeepModel</code></a>, <a href="https://www.tensorflow.org/api_docs/python/tf/keras/experimental/WideDeepModel"><code translate="no" dir="ltr">tf.compat.v1.keras.models.WideDeepModel</code></a></p> </section> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
tf.keras.experimental.WideDeepModel(
    linear_model, dnn_model, activation=None, **kwargs
)
</pre>  <p>This model jointly train a linear and a dnn model.</p> <h4 id="example" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">linear_model = LinearModel()
dnn_model = keras.Sequential([keras.layers.Dense(units=64),
                             keras.layers.Dense(units=1)])
combined_model = WideDeepModel(linear_model, dnn_model)
combined_model.compile(optimizer=['sgd', 'adam'], 'mse', ['mse'])
# define dnn_inputs and linear_inputs as separate numpy arrays or
# a single numpy array if dnn_inputs is same as linear_inputs.
combined_model.fit([linear_inputs, dnn_inputs], y, epochs)
# or define a single `tf.data.Dataset` that contains a single tensor or
# separate tensors for dnn_inputs and linear_inputs.
dataset = tf.data.Dataset.from_tensors(([linear_inputs, dnn_inputs], y))
combined_model.fit(dataset, epochs)
</pre> <p>Both linear and dnn model can be pre-compiled and trained separately before jointly training:</p> <h4 id="example_2" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">linear_model = LinearModel()
linear_model.compile('adagrad', 'mse')
linear_model.fit(linear_inputs, y, epochs)
dnn_model = keras.Sequential([keras.layers.Dense(units=1)])
dnn_model.compile('rmsprop', 'mse')
dnn_model.fit(dnn_inputs, y, epochs)
combined_model = WideDeepModel(linear_model, dnn_model)
combined_model.compile(optimizer=['sgd', 'adam'], 'mse', ['mse'])
combined_model.fit([linear_inputs, dnn_inputs], y, epochs)
</pre>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">linear_model</code> </td> <td> a premade LinearModel, its output must match the output of the dnn model. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dnn_model</code> </td> <td> a <a href="../model.html"><code translate="no" dir="ltr">tf.keras.Model</code></a>, its output must match the output of the linear model. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">activation</code> </td> <td> Activation function. Set it to None to maintain a linear activation. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> The keyword arguments that are passed on to BaseLayer.<strong>init</strong>. Allowed keyword arguments include <code translate="no" dir="ltr">name</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">distribute_strategy</code> </td> <td> The <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> this model was created under. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">layers</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">metrics_names</code> </td> <td> Returns the model's display labels for all outputs. <blockquote class="note">
<strong>Note:</strong><span> <code translate="no" dir="ltr">metrics_names</code> are available only after a <a href="../model.html"><code translate="no" dir="ltr">keras.Model</code></a> has been trained/evaluated on actual data.</span>
</blockquote> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
inputs = tf.keras.layers.Input(shape=(3,))
outputs = tf.keras.layers.Dense(2)(inputs)
model = tf.keras.models.Model(inputs=inputs, outputs=outputs)
model.compile(optimizer="Adam", loss="mse", metrics=["mae"])
model.metrics_names
[]
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
x = np.random.random((2, 3))
y = np.random.randint(0, 2, (2, 2))
model.fit(x, y)
model.metrics_names
['loss', 'mae']
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
inputs = tf.keras.layers.Input(shape=(3,))
d = tf.keras.layers.Dense(2, name='out')
output_1 = d(inputs)
output_2 = d(inputs)
model = tf.keras.models.Model(
   inputs=inputs, outputs=[output_1, output_2])
model.compile(optimizer="Adam", loss="mse", metrics=["mae", "acc"])
model.fit(x, (y, y))
model.metrics_names
['loss', 'out_loss', 'out_1_loss', 'out_mae', 'out_acc', 'out_1_mae',
'out_1_acc']
</pre> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">run_eagerly</code> </td> <td> Settable attribute indicating whether the model should run eagerly. <p>Running eagerly means that your model will be run step by step, like Python code. Your model might run slower, but it should become easier for you to debug it by stepping into individual layer calls.</p> <p>By default, we will attempt to compile your model to a static graph to deliver the best execution performance. </p>
</td> </tr> </table> <h2 id="methods" data-text="Methods">Methods</h2> <h3 id="call" data-text="call"><code translate="no" dir="ltr">call</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/premade_models/wide_deep.py#L92-L109">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
call(
    inputs, training=None
)
</pre> <p>Calls the model on new inputs and returns the outputs as tensors.</p> <p>In this case <code translate="no" dir="ltr">call()</code> just reapplies all ops in the graph to the new inputs (e.g. build a new computational graph from the provided inputs).</p> <blockquote class="note">
<strong>Note:</strong><span> This method should not be called directly. It is only meant to be overridden when subclassing <a href="../model.html"><code translate="no" dir="ltr">tf.keras.Model</code></a>. To call a model on an input, always use the <code translate="no" dir="ltr">__call__()</code> method, i.e. <code translate="no" dir="ltr">model(inputs)</code>, which relies on the underlying <code translate="no" dir="ltr">call()</code> method.</span>
</blockquote>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">inputs</code> </td> <td> Input tensor, or dict/list/tuple of input tensors. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">training</code> </td> <td> Boolean or boolean scalar tensor, indicating whether to run the <code translate="no" dir="ltr">Network</code> in training mode or inference mode. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">mask</code> </td> <td> A mask or list of masks. A mask can be either a boolean tensor or None (no mask). For more details, check the guide <a href="https://www.tensorflow.org/guide/keras/masking_and_padding">here</a>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A tensor if there is a single output, or a list of tensors if there are more than one outputs. </td> </tr> 
</table> <h3 id="compile" data-text="compile"><code translate="no" dir="ltr">compile</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L523-L659">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
compile(
    optimizer='rmsprop',
    loss=None,
    metrics=None,
    loss_weights=None,
    weighted_metrics=None,
    run_eagerly=None,
    steps_per_execution=None,
    jit_compile=None,
    **kwargs
)
</pre> <p>Configures the model for training.</p> <h4 id="example_3" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">model.compile(optimizer=tf.keras.optimizers.Adam(learning_rate=1e-3),
              loss=tf.keras.losses.BinaryCrossentropy(),
              metrics=[tf.keras.metrics.BinaryAccuracy(),
                       tf.keras.metrics.FalseNegatives()])
</pre>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">optimizer</code> </td> <td> String (name of optimizer) or optimizer instance. See <a href="../optimizers.html"><code translate="no" dir="ltr">tf.keras.optimizers</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">loss</code> </td> <td> Loss function. May be a string (name of loss function), or a <a href="../losses/loss.html"><code translate="no" dir="ltr">tf.keras.losses.Loss</code></a> instance. See <a href="../losses.html"><code translate="no" dir="ltr">tf.keras.losses</code></a>. A loss function is any callable with the signature <code translate="no" dir="ltr">loss = fn(y_true, y_pred)</code>, where <code translate="no" dir="ltr">y_true</code> are the ground truth values, and <code translate="no" dir="ltr">y_pred</code> are the model's predictions. <code translate="no" dir="ltr">y_true</code> should have shape <code translate="no" dir="ltr">(batch_size, d0, .. dN)</code> (except in the case of sparse loss functions such as sparse categorical crossentropy which expects integer arrays of shape <code translate="no" dir="ltr">(batch_size, d0, .. dN-1)</code>). <code translate="no" dir="ltr">y_pred</code> should have shape <code translate="no" dir="ltr">(batch_size, d0, .. dN)</code>. The loss function should return a float tensor. If a custom <code translate="no" dir="ltr">Loss</code> instance is used and reduction is set to <code translate="no" dir="ltr">None</code>, return value has shape <code translate="no" dir="ltr">(batch_size, d0, .. dN-1)</code> i.e. per-sample or per-timestep loss values; otherwise, it is a scalar. If the model has multiple outputs, you can use a different loss on each output by passing a dictionary or a list of losses. The loss value that will be minimized by the model will then be the sum of all individual losses, unless <code translate="no" dir="ltr">loss_weights</code> is specified. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">metrics</code> </td> <td> List of metrics to be evaluated by the model during training and testing. Each of this can be a string (name of a built-in function), function or a <a href="../metrics/metric.html"><code translate="no" dir="ltr">tf.keras.metrics.Metric</code></a> instance. See <a href="../metrics.html"><code translate="no" dir="ltr">tf.keras.metrics</code></a>. Typically you will use <code translate="no" dir="ltr">metrics=['accuracy']</code>. A function is any callable with the signature <code translate="no" dir="ltr">result = fn(y_true, y_pred)</code>. To specify different metrics for different outputs of a multi-output model, you could also pass a dictionary, such as <code translate="no" dir="ltr">metrics={'output_a': 'accuracy', 'output_b': ['accuracy', 'mse']}</code>. You can also pass a list to specify a metric or a list of metrics for each output, such as <code translate="no" dir="ltr">metrics=[['accuracy'], ['accuracy', 'mse']]</code> or <code translate="no" dir="ltr">metrics=['accuracy', ['accuracy', 'mse']]</code>. When you pass the strings 'accuracy' or 'acc', we convert this to one of <a href="../metrics/binaryaccuracy.html"><code translate="no" dir="ltr">tf.keras.metrics.BinaryAccuracy</code></a>, <a href="../metrics/categoricalaccuracy.html"><code translate="no" dir="ltr">tf.keras.metrics.CategoricalAccuracy</code></a>, <a href="../metrics/sparsecategoricalaccuracy.html"><code translate="no" dir="ltr">tf.keras.metrics.SparseCategoricalAccuracy</code></a> based on the loss function used and the model output shape. We do a similar conversion for the strings 'crossentropy' and 'ce' as well. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">loss_weights</code> </td> <td> Optional list or dictionary specifying scalar coefficients (Python floats) to weight the loss contributions of different model outputs. The loss value that will be minimized by the model will then be the <em>weighted sum</em> of all individual losses, weighted by the <code translate="no" dir="ltr">loss_weights</code> coefficients. If a list, it is expected to have a 1:1 mapping to the model's outputs. If a dict, it is expected to map output names (strings) to scalar coefficients. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">weighted_metrics</code> </td> <td> List of metrics to be evaluated and weighted by <code translate="no" dir="ltr">sample_weight</code> or <code translate="no" dir="ltr">class_weight</code> during training and testing. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">run_eagerly</code> </td> <td> Bool. Defaults to <code translate="no" dir="ltr">False</code>. If <code translate="no" dir="ltr">True</code>, this <code translate="no" dir="ltr">Model</code>'s logic will not be wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. Recommended to leave this as <code translate="no" dir="ltr">None</code> unless your <code translate="no" dir="ltr">Model</code> cannot be run inside a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. <code translate="no" dir="ltr">run_eagerly=True</code> is not supported when using <a href="../../distribute/experimental/parameterserverstrategy.html"><code translate="no" dir="ltr">tf.distribute.experimental.ParameterServerStrategy</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps_per_execution</code> </td> <td> Int. Defaults to 1. The number of batches to run during each <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> call. Running multiple batches inside a single <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> call can greatly improve performance on TPUs or small models with a large Python overhead. At most, one full epoch will be run each execution. If a number larger than the size of the epoch is passed, the execution will be truncated to the size of the epoch. Note that if <code translate="no" dir="ltr">steps_per_execution</code> is set to <code translate="no" dir="ltr">N</code>, <a href="../callbacks/callback.html#on_batch_begin"><code translate="no" dir="ltr">Callback.on_batch_begin</code></a> and <a href="../callbacks/callback.html#on_batch_end"><code translate="no" dir="ltr">Callback.on_batch_end</code></a> methods will only be called every <code translate="no" dir="ltr">N</code> batches (i.e. before/after each <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> execution). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">jit_compile</code> </td> <td> If <code translate="no" dir="ltr">True</code>, compile the model training step with XLA. <a href="https://www.tensorflow.org/xla">XLA</a> is an optimizing compiler for machine learning. <code translate="no" dir="ltr">jit_compile</code> is not enabled for by default. This option cannot be enabled with <code translate="no" dir="ltr">run_eagerly=True</code>. Note that <code translate="no" dir="ltr">jit_compile=True</code> is may not necessarily work for all models. For more information on supported operations please refer to the <a href="https://www.tensorflow.org/xla">XLA documentation</a>. Also refer to <a href="https://www.tensorflow.org/xla/known_issues">known XLA issues</a> for more details. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Arguments supported for backwards compatibility only. </td> </tr> </table> <h3 id="compute_loss" data-text="compute_loss"><code translate="no" dir="ltr">compute_loss</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L896-L949">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
compute_loss(
    x=None, y=None, y_pred=None, sample_weight=None
)
</pre> <p>Compute the total loss, validate it, and return it.</p> <p>Subclasses can optionally override this method to provide custom loss computation logic.</p> <h4 id="example_4" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">class MyModel(tf.keras.Model):

  def __init__(self, *args, **kwargs):
    super(MyModel, self).__init__(*args, **kwargs)
    self.loss_tracker = tf.keras.metrics.Mean(name='loss')

  def compute_loss(self, x, y, y_pred, sample_weight):
    loss = tf.reduce_mean(tf.math.squared_difference(y_pred, y))
    loss += tf.add_n(self.losses)
    self.loss_tracker.update_state(loss)
    return loss

  def reset_metrics(self):
    self.loss_tracker.reset_states()

  @property
  def metrics(self):
    return [self.loss_tracker]

tensors = tf.random.uniform((10, 10)), tf.random.uniform((10,))
dataset = tf.data.Dataset.from_tensor_slices(tensors).repeat().batch(1)

inputs = tf.keras.layers.Input(shape=(10,), name='my_input')
outputs = tf.keras.layers.Dense(10)(inputs)
model = MyModel(inputs, outputs)
model.add_loss(tf.reduce_sum(outputs))

optimizer = tf.keras.optimizers.SGD()
model.compile(optimizer, loss='mse', steps_per_execution=10)
model.fit(dataset, epochs=2, steps_per_epoch=10)
print('My custom loss: ', model.loss_tracker.result().numpy())
</pre>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">y_pred</code> </td> <td> Predictions returned by the model (output of <code translate="no" dir="ltr">model(x)</code>) </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Sample weights for weighting the loss function. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> The total loss as a <a href="../../tensor.html"><code translate="no" dir="ltr">tf.Tensor</code></a>, or <code translate="no" dir="ltr">None</code> if no loss results (which is the case when called by <a href="../model.html#test_step"><code translate="no" dir="ltr">Model.test_step</code></a>). </td> </tr> 
</table> <h3 id="compute_metrics" data-text="compute_metrics"><code translate="no" dir="ltr">compute_metrics</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L951-L996">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
compute_metrics(
    x, y, y_pred, sample_weight
)
</pre> <p>Update metric states and collect all metrics to be returned.</p> <p>Subclasses can optionally override this method to provide custom metric updating and collection logic.</p> <h4 id="example_5" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">class MyModel(tf.keras.Sequential):

  def compute_metrics(self, x, y, y_pred, sample_weight):

    # This super call updates `self.compiled_metrics` and returns results
    # for all metrics listed in `self.metrics`.
    metric_results = super(MyModel, self).compute_metrics(
        x, y, y_pred, sample_weight)

    # Note that `self.custom_metric` is not listed in `self.metrics`.
    self.custom_metric.update_state(x, y, y_pred, sample_weight)
    metric_results['custom_metric_name'] = self.custom_metric.result()
    return metric_results
</pre>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">y_pred</code> </td> <td> Predictions returned by the model (output of <code translate="no" dir="ltr">model.call(x)</code>) </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Sample weights for weighting the loss function. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">dict</code> containing values that will be passed to <a href="../callbacks/callbacklist.html#on_train_batch_end"><code translate="no" dir="ltr">tf.keras.callbacks.CallbackList.on_train_batch_end()</code></a>. Typically, the values of the metrics listed in <code translate="no" dir="ltr">self.metrics</code> are returned. Example: <code translate="no" dir="ltr">{'loss': 0.2, 'accuracy': 0.7}</code>. </td> </tr> 
</table> <h3 id="evaluate" data-text="evaluate"><code translate="no" dir="ltr">evaluate</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1602-L1768">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
evaluate(
    x=None,
    y=None,
    batch_size=None,
    verbose='auto',
    sample_weight=None,
    steps=None,
    callbacks=None,
    max_queue_size=10,
    workers=1,
    use_multiprocessing=False,
    return_dict=False,
    **kwargs
)
</pre> <p>Returns the loss value &amp; metrics values for the model in test mode.</p> <p>Computation is done in batches (see the <code translate="no" dir="ltr">batch_size</code> arg.)</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs.</li> <li>A <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset. Should return a tuple of either <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>.</li> <li>A generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> returning <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>. A more detailed description of unpacking behavior for iterator types (Dataset, generator, Sequence) is given in the <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> section of <code translate="no" dir="ltr">Model.fit</code>. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). If <code translate="no" dir="ltr">x</code> is a dataset, generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance, <code translate="no" dir="ltr">y</code> should not be specified (since targets will be obtained from the iterator/dataset). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per batch of computation. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of a dataset, generators, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> <code translate="no" dir="ltr">"auto"</code>, 0, 1, or 2. Verbosity mode. 0 = silent, 1 = progress bar, 2 = single line. <code translate="no" dir="ltr">"auto"</code> defaults to 1 for most cases, and to 2 when used with <code translate="no" dir="ltr">ParameterServerStrategy</code>. Note that the progress bar is not particularly useful when logged to a file, so <code translate="no" dir="ltr">verbose=2</code> is recommended when not running interactively (e.g. in a production environment). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional Numpy array of weights for the test samples, used for weighting the loss function. You can either pass a flat (1D) Numpy array with the same length as the input samples (1:1 mapping between weights and samples), or in the case of temporal data, you can pass a 2D array with shape <code translate="no" dir="ltr">(samples, sequence_length)</code>, to apply a different weight to every timestep of every sample. This argument is not supported when <code translate="no" dir="ltr">x</code> is a dataset, instead pass sample weights as the third element of <code translate="no" dir="ltr">x</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Total number of steps (batches of samples) before declaring the evaluation round finished. Ignored with the default value of <code translate="no" dir="ltr">None</code>. If x is a <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset and <code translate="no" dir="ltr">steps</code> is None, 'evaluate' will run until the dataset is exhausted. This argument is not supported with array inputs. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">callbacks</code> </td> <td> List of <a href="../callbacks/callback.html"><code translate="no" dir="ltr">keras.callbacks.Callback</code></a> instances. List of callbacks to apply during evaluation. See <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks">callbacks</a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">max_queue_size</code> </td> <td> Integer. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum size for the generator queue. If unspecified, <code translate="no" dir="ltr">max_queue_size</code> will default to 10. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">workers</code> </td> <td> Integer. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum number of processes to spin up when using process-based threading. If unspecified, <code translate="no" dir="ltr">workers</code> will default to 1. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_multiprocessing</code> </td> <td> Boolean. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. If <code translate="no" dir="ltr">True</code>, use process-based threading. If unspecified, <code translate="no" dir="ltr">use_multiprocessing</code> will default to <code translate="no" dir="ltr">False</code>. Note that because this implementation relies on multiprocessing, you should not pass non-picklable arguments to the generator as they can't be passed easily to children processes. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_dict</code> </td> <td> If <code translate="no" dir="ltr">True</code>, loss and metric results are returned as a dict, with each key being the name of the metric. If <code translate="no" dir="ltr">False</code>, they are returned as a list. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Unused at this time. </td> </tr> </table> <p>See the discussion of <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> for <a href="../model.html#fit"><code translate="no" dir="ltr">Model.fit</code></a>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Scalar test loss (if the model has a single output and no metrics) or list of scalars (if the model has multiple outputs and/or metrics). The attribute <code translate="no" dir="ltr">model.metrics_names</code> will give you the display labels for the scalar outputs. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.evaluate</code> is wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr> </table> <h3 id="fit" data-text="fit"><code translate="no" dir="ltr">fit</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1099-L1472">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
fit(
    x=None,
    y=None,
    batch_size=None,
    epochs=1,
    verbose='auto',
    callbacks=None,
    validation_split=0.0,
    validation_data=None,
    shuffle=True,
    class_weight=None,
    sample_weight=None,
    initial_epoch=0,
    steps_per_epoch=None,
    validation_steps=None,
    validation_batch_size=None,
    validation_freq=1,
    max_queue_size=10,
    workers=1,
    use_multiprocessing=False
)
</pre> <p>Trains the model for a fixed number of epochs (iterations on a dataset).</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs.</li> <li>A <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset. Should return a tuple of either <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>.</li> <li>A generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> returning <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>.</li> <li>A <a href="../utils/experimental/datasetcreator.html"><code translate="no" dir="ltr">tf.keras.utils.experimental.DatasetCreator</code></a>, which wraps a callable that takes a single argument of type <a href="../../distribute/inputcontext.html"><code translate="no" dir="ltr">tf.distribute.InputContext</code></a>, and returns a <a href="../../data/dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a>. <code translate="no" dir="ltr">DatasetCreator</code> should be used when users prefer to specify the per-replica batching and sharding logic for the <code translate="no" dir="ltr">Dataset</code>. See <a href="../utils/experimental/datasetcreator.html"><code translate="no" dir="ltr">tf.keras.utils.experimental.DatasetCreator</code></a> doc for more information. A more detailed description of unpacking behavior for iterator types (Dataset, generator, Sequence) is given below. If using <a href="../../distribute/experimental/parameterserverstrategy.html"><code translate="no" dir="ltr">tf.distribute.experimental.ParameterServerStrategy</code></a>, only <code translate="no" dir="ltr">DatasetCreator</code> type is supported for <code translate="no" dir="ltr">x</code>. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). If <code translate="no" dir="ltr">x</code> is a dataset, generator, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance, <code translate="no" dir="ltr">y</code> should not be specified (since targets will be obtained from <code translate="no" dir="ltr">x</code>). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per gradient update. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of datasets, generators, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">epochs</code> </td> <td> Integer. Number of epochs to train the model. An epoch is an iteration over the entire <code translate="no" dir="ltr">x</code> and <code translate="no" dir="ltr">y</code> data provided (unless the <code translate="no" dir="ltr">steps_per_epoch</code> flag is set to something other than None). Note that in conjunction with <code translate="no" dir="ltr">initial_epoch</code>, <code translate="no" dir="ltr">epochs</code> is to be understood as "final epoch". The model is not trained for a number of iterations given by <code translate="no" dir="ltr">epochs</code>, but merely until the epoch of index <code translate="no" dir="ltr">epochs</code> is reached. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> 'auto', 0, 1, or 2. Verbosity mode. 0 = silent, 1 = progress bar, 2 = one line per epoch. 'auto' defaults to 1 for most cases, but 2 when used with <code translate="no" dir="ltr">ParameterServerStrategy</code>. Note that the progress bar is not particularly useful when logged to a file, so verbose=2 is recommended when not running interactively (eg, in a production environment). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">callbacks</code> </td> <td> List of <a href="../callbacks/callback.html"><code translate="no" dir="ltr">keras.callbacks.Callback</code></a> instances. List of callbacks to apply during training. See <a href="../callbacks.html"><code translate="no" dir="ltr">tf.keras.callbacks</code></a>. Note <a href="../callbacks/progbarlogger.html"><code translate="no" dir="ltr">tf.keras.callbacks.ProgbarLogger</code></a> and <a href="../callbacks/history.html"><code translate="no" dir="ltr">tf.keras.callbacks.History</code></a> callbacks are created automatically and need not be passed into <code translate="no" dir="ltr">model.fit</code>. <a href="../callbacks/progbarlogger.html"><code translate="no" dir="ltr">tf.keras.callbacks.ProgbarLogger</code></a> is created or not based on <code translate="no" dir="ltr">verbose</code> argument to <code translate="no" dir="ltr">model.fit</code>. Callbacks with batch-level calls are currently unsupported with <a href="../../distribute/experimental/parameterserverstrategy.html"><code translate="no" dir="ltr">tf.distribute.experimental.ParameterServerStrategy</code></a>, and users are advised to implement epoch-level calls instead with an appropriate <code translate="no" dir="ltr">steps_per_epoch</code> value. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_split</code> </td> <td> Float between 0 and 1. Fraction of the training data to be used as validation data. The model will set apart this fraction of the training data, will not train on it, and will evaluate the loss and any model metrics on this data at the end of each epoch. The validation data is selected from the last samples in the <code translate="no" dir="ltr">x</code> and <code translate="no" dir="ltr">y</code> data provided, before shuffling. This argument is not supported when <code translate="no" dir="ltr">x</code> is a dataset, generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance. If both <code translate="no" dir="ltr">validation_data</code> and <code translate="no" dir="ltr">validation_split</code> are provided, <code translate="no" dir="ltr">validation_data</code> will override <code translate="no" dir="ltr">validation_split</code>. <code translate="no" dir="ltr">validation_split</code> is not yet supported with <a href="../../distribute/experimental/parameterserverstrategy.html"><code translate="no" dir="ltr">tf.distribute.experimental.ParameterServerStrategy</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_data</code> </td> <td> Data on which to evaluate the loss and any model metrics at the end of each epoch. The model will not be trained on this data. Thus, note the fact that the validation loss of data provided using <code translate="no" dir="ltr">validation_split</code> or <code translate="no" dir="ltr">validation_data</code> is not affected by regularization layers like noise and dropout. <code translate="no" dir="ltr">validation_data</code> will override <code translate="no" dir="ltr">validation_split</code>. <code translate="no" dir="ltr">validation_data</code> could be: <ul> <li>A tuple <code translate="no" dir="ltr">(x_val, y_val)</code> of Numpy arrays or tensors.</li> <li>A tuple <code translate="no" dir="ltr">(x_val, y_val, val_sample_weights)</code> of NumPy arrays.</li> <li>A <a href="../../data/dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a>.</li> <li>A Python generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> returning <code translate="no" dir="ltr">(inputs, targets)</code> or <code translate="no" dir="ltr">(inputs, targets, sample_weights)</code>. <code translate="no" dir="ltr">validation_data</code> is not yet supported with <a href="../../distribute/experimental/parameterserverstrategy.html"><code translate="no" dir="ltr">tf.distribute.experimental.ParameterServerStrategy</code></a>. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">shuffle</code> </td> <td> Boolean (whether to shuffle the training data before each epoch) or str (for 'batch'). This argument is ignored when <code translate="no" dir="ltr">x</code> is a generator or an object of tf.data.Dataset. 'batch' is a special option for dealing with the limitations of HDF5 data; it shuffles in batch-sized chunks. Has no effect when <code translate="no" dir="ltr">steps_per_epoch</code> is not <code translate="no" dir="ltr">None</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">class_weight</code> </td> <td> Optional dictionary mapping class indices (integers) to a weight (float) value, used for weighting the loss function (during training only). This can be useful to tell the model to "pay more attention" to samples from an under-represented class. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional Numpy array of weights for the training samples, used for weighting the loss function (during training only). You can either pass a flat (1D) Numpy array with the same length as the input samples (1:1 mapping between weights and samples), or in the case of temporal data, you can pass a 2D array with shape <code translate="no" dir="ltr">(samples, sequence_length)</code>, to apply a different weight to every timestep of every sample. This argument is not supported when <code translate="no" dir="ltr">x</code> is a dataset, generator, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance, instead provide the sample_weights as the third element of <code translate="no" dir="ltr">x</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">initial_epoch</code> </td> <td> Integer. Epoch at which to start training (useful for resuming a previous training run). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps_per_epoch</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Total number of steps (batches of samples) before declaring one epoch finished and starting the next epoch. When training with input tensors such as TensorFlow data tensors, the default <code translate="no" dir="ltr">None</code> is equal to the number of samples in your dataset divided by the batch size, or 1 if that cannot be determined. If x is a <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset, and 'steps_per_epoch' is None, the epoch will run until the input dataset is exhausted. When passing an infinitely repeating dataset, you must specify the <code translate="no" dir="ltr">steps_per_epoch</code> argument. If <code translate="no" dir="ltr">steps_per_epoch=-1</code> the training will run indefinitely with an infinitely repeating dataset. This argument is not supported with array inputs. When using <a href="../../distribute/experimental/parameterserverstrategy.html"><code translate="no" dir="ltr">tf.distribute.experimental.ParameterServerStrategy</code></a>: <li>
<code translate="no" dir="ltr">steps_per_epoch=None</code> is not supported. </li>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_steps</code> </td> <td> Only relevant if <code translate="no" dir="ltr">validation_data</code> is provided and is a <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset. Total number of steps (batches of samples) to draw before stopping when performing validation at the end of every epoch. If 'validation_steps' is None, validation will run until the <code translate="no" dir="ltr">validation_data</code> dataset is exhausted. In the case of an infinitely repeated dataset, it will run into an infinite loop. If 'validation_steps' is specified and only part of the dataset will be consumed, the evaluation will start from the beginning of the dataset at each epoch. This ensures that the same validation samples are used every time. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per validation batch. If unspecified, will default to <code translate="no" dir="ltr">batch_size</code>. Do not specify the <code translate="no" dir="ltr">validation_batch_size</code> if your data is in the form of datasets, generators, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_freq</code> </td> <td> Only relevant if validation data is provided. Integer or <code translate="no" dir="ltr">collections.abc.Container</code> instance (e.g. list, tuple, etc.). If an integer, specifies how many training epochs to run before a new validation run is performed, e.g. <code translate="no" dir="ltr">validation_freq=2</code> runs validation every 2 epochs. If a Container, specifies the epochs on which to run validation, e.g. <code translate="no" dir="ltr">validation_freq=[1, 2, 10]</code> runs validation at the end of the 1st, 2nd, and 10th epochs. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">max_queue_size</code> </td> <td> Integer. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum size for the generator queue. If unspecified, <code translate="no" dir="ltr">max_queue_size</code> will default to 10. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">workers</code> </td> <td> Integer. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum number of processes to spin up when using process-based threading. If unspecified, <code translate="no" dir="ltr">workers</code> will default to 1. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_multiprocessing</code> </td> <td> Boolean. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. If <code translate="no" dir="ltr">True</code>, use process-based threading. If unspecified, <code translate="no" dir="ltr">use_multiprocessing</code> will default to <code translate="no" dir="ltr">False</code>. Note that because this implementation relies on multiprocessing, you should not pass non-picklable arguments to the generator as they can't be passed easily to children processes. </td> </tr> </table> <p>Unpacking behavior for iterator-like inputs: A common pattern is to pass a tf.data.Dataset, generator, or tf.keras.utils.Sequence to the <code translate="no" dir="ltr">x</code> argument of fit, which will in fact yield not only features (x) but optionally targets (y) and sample weights. Keras requires that the output of such iterator-likes be unambiguous. The iterator should return a tuple of length 1, 2, or 3, where the optional second and third elements will be used for y and sample_weight respectively. Any other type provided will be wrapped in a length one tuple, effectively treating everything as 'x'. When yielding dicts, they should still adhere to the top-level tuple structure. e.g. <code translate="no" dir="ltr">({"x0": x0, "x1": x1}, y)</code>. Keras will not attempt to separate features, targets, and weights from the keys of a single dict. A notable unsupported data type is the namedtuple. The reason is that it behaves like both an ordered datatype (tuple) and a mapping datatype (dict). So given a namedtuple of the form: <code translate="no" dir="ltr">namedtuple("example_tuple", ["y", "x"])</code> it is ambiguous whether to reverse the order of the elements when interpreting the value. Even worse is a tuple of the form: <code translate="no" dir="ltr">namedtuple("other_tuple", ["x", "y", "z"])</code> where it is unclear if the tuple was intended to be unpacked into x, y, and sample_weight or passed through as a single element to <code translate="no" dir="ltr">x</code>. As a result the data processing code will simply raise a ValueError if it encounters a namedtuple. (Along with instructions to remedy the issue.)</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">History</code> object. Its <code translate="no" dir="ltr">History.history</code> attribute is a record of training loss values and metrics values at successive epochs, as well as validation loss values and validation metrics values (if applicable). </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> <ol> <li>If the model was never compiled or,</li> <li>If <code translate="no" dir="ltr">model.fit</code> is wrapped in <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. </li>
</ol>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of mismatch between the provided input data and what the model expects or when the input data is empty. </td> </tr> </table> <h3 id="get_layer" data-text="get_layer"><code translate="no" dir="ltr">get_layer</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2891-L2925">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
get_layer(
    name=None, index=None
)
</pre> <p>Retrieves a layer based on either its name (unique) or index.</p> <p>If <code translate="no" dir="ltr">name</code> and <code translate="no" dir="ltr">index</code> are both provided, <code translate="no" dir="ltr">index</code> will take precedence. Indices are based on order of horizontal graph traversal (bottom-up).</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">name</code> </td> <td> String, name of layer. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">index</code> </td> <td> Integer, index of layer. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A layer instance. </td> </tr> 
</table> <h3 id="load_weights" data-text="load_weights"><code translate="no" dir="ltr">load_weights</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2556-L2661">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
load_weights(
    filepath, by_name=False, skip_mismatch=False, options=None
)
</pre> <p>Loads all layer weights, either from a TensorFlow or an HDF5 weight file.</p> <p>If <code translate="no" dir="ltr">by_name</code> is False weights are loaded based on the network's topology. This means the architecture should be the same as when the weights were saved. Note that layers that don't have weights are not taken into account in the topological ordering, so adding or removing layers is fine as long as they don't have weights.</p> <p>If <code translate="no" dir="ltr">by_name</code> is True, weights are loaded into layers only if they share the same name. This is useful for fine-tuning or transfer-learning models where some of the layers have changed.</p> <p>Only topological loading (<code translate="no" dir="ltr">by_name=False</code>) is supported when loading weights from the TensorFlow format. Note that topological loading differs slightly between TensorFlow and HDF5 formats for user-defined classes inheriting from <a href="../model.html"><code translate="no" dir="ltr">tf.keras.Model</code></a>: HDF5 loads based on a flattened list of weights, while the TensorFlow format loads based on the object-local names of attributes to which layers are assigned in the <code translate="no" dir="ltr">Model</code>'s constructor.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> String, path to the weights file to load. For weight files in TensorFlow format, this is the file prefix (the same as was passed to <code translate="no" dir="ltr">save_weights</code>). This can also be a path to a SavedModel saved from <code translate="no" dir="ltr">model.save</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">by_name</code> </td> <td> Boolean, whether to load weights by name or by topological order. Only topological loading is supported for weight files in TensorFlow format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">skip_mismatch</code> </td> <td> Boolean, whether to skip loading of layers where there is a mismatch in the number of weights, or a mismatch in the shape of the weight (only valid when <code translate="no" dir="ltr">by_name=True</code>). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> Optional <a href="../../train/checkpointoptions.html"><code translate="no" dir="ltr">tf.train.CheckpointOptions</code></a> object that specifies options for loading weights. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> When loading a weight file in TensorFlow format, returns the same status object as <a href="../../train/checkpoint.html#restore"><code translate="no" dir="ltr">tf.train.Checkpoint.restore</code></a>. When graph building, restore ops are run automatically as soon as the network is built (on first call for user-defined classes inheriting from <code translate="no" dir="ltr">Model</code>, immediately if it is already built). <p>When loading weights in HDF5 format, returns <code translate="no" dir="ltr">None</code>. </p>
</td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ImportError</code> </td> <td> If <code translate="no" dir="ltr">h5py</code> is not available and the weight file is in HDF5 format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> If <code translate="no" dir="ltr">skip_mismatch</code> is set to <code translate="no" dir="ltr">True</code> when <code translate="no" dir="ltr">by_name</code> is <code translate="no" dir="ltr">False</code>. </td> </tr> </table> <h3 id="make_predict_function" data-text="make_predict_function"><code translate="no" dir="ltr">make_predict_function</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1793-L1867">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
make_predict_function(
    force=False
)
</pre> <p>Creates a function that executes one step of inference.</p> <p>This method can be overridden to support custom inference logic. This method is called by <a href="../model.html#predict"><code translate="no" dir="ltr">Model.predict</code></a> and <a href="../model.html#predict_on_batch"><code translate="no" dir="ltr">Model.predict_on_batch</code></a>.</p> <p>Typically, this method directly controls <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings, and delegates the actual evaluation logic to <a href="../model.html#predict_step"><code translate="no" dir="ltr">Model.predict_step</code></a>.</p> <p>This function is cached the first time <a href="../model.html#predict"><code translate="no" dir="ltr">Model.predict</code></a> or <a href="../model.html#predict_on_batch"><code translate="no" dir="ltr">Model.predict_on_batch</code></a> is called. The cache is cleared whenever <a href="../model.html#compile"><code translate="no" dir="ltr">Model.compile</code></a> is called. You can skip the cache and generate again the function with <code translate="no" dir="ltr">force=True</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">force</code> </td> <td> Whether to regenerate the predict function and skip the cached function if available. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Function. The function created by this method should accept a <a href="../../data/iterator.html"><code translate="no" dir="ltr">tf.data.Iterator</code></a>, and return the outputs of the <code translate="no" dir="ltr">Model</code>. </td> </tr> 
</table> <h3 id="make_test_function" data-text="make_test_function"><code translate="no" dir="ltr">make_test_function</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1504-L1600">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
make_test_function(
    force=False
)
</pre> <p>Creates a function that executes one step of evaluation.</p> <p>This method can be overridden to support custom evaluation logic. This method is called by <a href="../model.html#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a> and <a href="../model.html#test_on_batch"><code translate="no" dir="ltr">Model.test_on_batch</code></a>.</p> <p>Typically, this method directly controls <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings, and delegates the actual evaluation logic to <a href="../model.html#test_step"><code translate="no" dir="ltr">Model.test_step</code></a>.</p> <p>This function is cached the first time <a href="../model.html#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a> or <a href="../model.html#test_on_batch"><code translate="no" dir="ltr">Model.test_on_batch</code></a> is called. The cache is cleared whenever <a href="../model.html#compile"><code translate="no" dir="ltr">Model.compile</code></a> is called. You can skip the cache and generate again the function with <code translate="no" dir="ltr">force=True</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">force</code> </td> <td> Whether to regenerate the test function and skip the cached function if available. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Function. The function created by this method should accept a <a href="../../data/iterator.html"><code translate="no" dir="ltr">tf.data.Iterator</code></a>, and return a <code translate="no" dir="ltr">dict</code> containing values that will be passed to <code translate="no" dir="ltr">tf.keras.Callbacks.on_test_batch_end</code>. </td> </tr> 
</table> <h3 id="make_train_function" data-text="make_train_function"><code translate="no" dir="ltr">make_train_function</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L998-L1097">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
make_train_function(
    force=False
)
</pre> <p>Creates a function that executes one step of training.</p> <p>This method can be overridden to support custom training logic. This method is called by <a href="../model.html#fit"><code translate="no" dir="ltr">Model.fit</code></a> and <a href="../model.html#train_on_batch"><code translate="no" dir="ltr">Model.train_on_batch</code></a>.</p> <p>Typically, this method directly controls <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings, and delegates the actual training logic to <a href="../model.html#train_step"><code translate="no" dir="ltr">Model.train_step</code></a>.</p> <p>This function is cached the first time <a href="../model.html#fit"><code translate="no" dir="ltr">Model.fit</code></a> or <a href="../model.html#train_on_batch"><code translate="no" dir="ltr">Model.train_on_batch</code></a> is called. The cache is cleared whenever <a href="../model.html#compile"><code translate="no" dir="ltr">Model.compile</code></a> is called. You can skip the cache and generate again the function with <code translate="no" dir="ltr">force=True</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">force</code> </td> <td> Whether to regenerate the train function and skip the cached function if available. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Function. The function created by this method should accept a <a href="../../data/iterator.html"><code translate="no" dir="ltr">tf.data.Iterator</code></a>, and return a <code translate="no" dir="ltr">dict</code> containing values that will be passed to <code translate="no" dir="ltr">tf.keras.Callbacks.on_train_batch_end</code>, such as <code translate="no" dir="ltr">{'loss': 0.2, 'accuracy': 0.7}</code>. </td> </tr> 
</table> <h3 id="predict" data-text="predict"><code translate="no" dir="ltr">predict</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1869-L2064">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict(
    x,
    batch_size=None,
    verbose='auto',
    steps=None,
    callbacks=None,
    max_queue_size=10,
    workers=1,
    use_multiprocessing=False
)
</pre> <p>Generates output predictions for the input samples.</p> <p>Computation is done in batches. This method is designed for batch processing of large numbers of inputs. It is not intended for use inside of loops that iterate over your data and process small numbers of inputs at a time.</p> <p>For small numbers of inputs that fit in one batch, directly use <code translate="no" dir="ltr">__call__()</code> for faster execution, e.g., <code translate="no" dir="ltr">model(x)</code>, or <code translate="no" dir="ltr">model(x, training=False)</code> if you have layers such as <a href="../layers/batchnormalization.html"><code translate="no" dir="ltr">tf.keras.layers.BatchNormalization</code></a> that behave differently during inference. You may pair the individual model call with a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> for additional performance inside your inner loop. If you need access to numpy array values instead of tensors after your model call, you can use <code translate="no" dir="ltr">tensor.numpy()</code> to get the numpy array value of an eager tensor.</p> <p>Also, note the fact that test loss is not affected by regularization layers like noise and dropout.</p> <blockquote class="note">
<strong>Note:</strong><span> See <a href="https://keras.io/getting_started/faq/#whats-the-difference-between-model-methods-predict-and-call">this FAQ entry</a> for more details about the difference between <code translate="no" dir="ltr">Model</code> methods <code translate="no" dir="ltr">predict()</code> and <code translate="no" dir="ltr">__call__()</code>.</span>
</blockquote>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input samples. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset.</li> <li>A generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instance. A more detailed description of unpacking behavior for iterator types (Dataset, generator, Sequence) is given in the <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> section of <code translate="no" dir="ltr">Model.fit</code>. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Integer or <code translate="no" dir="ltr">None</code>. Number of samples per batch. If unspecified, <code translate="no" dir="ltr">batch_size</code> will default to 32. Do not specify the <code translate="no" dir="ltr">batch_size</code> if your data is in the form of dataset, generators, or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> instances (since they generate batches). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> <code translate="no" dir="ltr">"auto"</code>, 0, 1, or 2. Verbosity mode. 0 = silent, 1 = progress bar, 2 = single line. <code translate="no" dir="ltr">"auto"</code> defaults to 1 for most cases, and to 2 when used with <code translate="no" dir="ltr">ParameterServerStrategy</code>. Note that the progress bar is not particularly useful when logged to a file, so <code translate="no" dir="ltr">verbose=2</code> is recommended when not running interactively (e.g. in a production environment). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">steps</code> </td> <td> Total number of steps (batches of samples) before declaring the prediction round finished. Ignored with the default value of <code translate="no" dir="ltr">None</code>. If x is a <a href="../../data.html"><code translate="no" dir="ltr">tf.data</code></a> dataset and <code translate="no" dir="ltr">steps</code> is None, <code translate="no" dir="ltr">predict()</code> will run until the input dataset is exhausted. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">callbacks</code> </td> <td> List of <a href="../callbacks/callback.html"><code translate="no" dir="ltr">keras.callbacks.Callback</code></a> instances. List of callbacks to apply during prediction. See <a href="https://www.tensorflow.org/api_docs/python/tf/keras/callbacks">callbacks</a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">max_queue_size</code> </td> <td> Integer. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum size for the generator queue. If unspecified, <code translate="no" dir="ltr">max_queue_size</code> will default to 10. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">workers</code> </td> <td> Integer. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. Maximum number of processes to spin up when using process-based threading. If unspecified, <code translate="no" dir="ltr">workers</code> will default to 1. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_multiprocessing</code> </td> <td> Boolean. Used for generator or <a href="../utils/sequence.html"><code translate="no" dir="ltr">keras.utils.Sequence</code></a> input only. If <code translate="no" dir="ltr">True</code>, use process-based threading. If unspecified, <code translate="no" dir="ltr">use_multiprocessing</code> will default to <code translate="no" dir="ltr">False</code>. Note that because this implementation relies on multiprocessing, you should not pass non-picklable arguments to the generator as they can't be passed easily to children processes. </td> </tr> </table> <p>See the discussion of <code translate="no" dir="ltr">Unpacking behavior for iterator-like inputs</code> for <a href="../model.html#fit"><code translate="no" dir="ltr">Model.fit</code></a>. Note that Model.predict uses the same interpretation rules as <a href="../model.html#fit"><code translate="no" dir="ltr">Model.fit</code></a> and <a href="../model.html#evaluate"><code translate="no" dir="ltr">Model.evaluate</code></a>, so inputs must be unambiguous for all three methods.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Numpy array(s) of predictions. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.predict</code> is wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> In case of mismatch between the provided input data and the model's expectations, or in case a stateful model receives a number of samples that is not a multiple of the batch size. </td> </tr> </table> <h3 id="predict_on_batch" data-text="predict_on_batch"><code translate="no" dir="ltr">predict_on_batch</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2209-L2231">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict_on_batch(
    x
)
</pre> <p>Returns predictions for a single batch of samples.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs). </li>
</ul>
</td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Numpy array(s) of predictions. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.predict_on_batch</code> is wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr> </table> <h3 id="predict_step" data-text="predict_step"><code translate="no" dir="ltr">predict_step</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1770-L1791">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
predict_step(
    data
)
</pre> <p>The logic for one inference step.</p> <p>This method can be overridden to support custom inference logic. This method is called by <a href="../model.html#make_predict_function"><code translate="no" dir="ltr">Model.make_predict_function</code></a>.</p> <p>This method should contain the mathematical logic for one step of inference. This typically includes the forward pass.</p> <p>Configuration details for <em>how</em> this logic is run (e.g. <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings), should be left to <a href="../model.html#make_predict_function"><code translate="no" dir="ltr">Model.make_predict_function</code></a>, which can also be overridden.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A nested structure of <code translate="no" dir="ltr">Tensor</code>s. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> The result of one inference step, typically the output of calling the <code translate="no" dir="ltr">Model</code> on data. </td> </tr> 
</table> <h3 id="reset_metrics" data-text="reset_metrics"><code translate="no" dir="ltr">reset_metrics</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2066-L2086">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
reset_metrics()
</pre> <p>Resets the state of all the metrics in the model.</p> <h4 id="examples" data-text="Examples:">Examples:</h4> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
inputs = tf.keras.layers.Input(shape=(3,))
outputs = tf.keras.layers.Dense(2)(inputs)
model = tf.keras.models.Model(inputs=inputs, outputs=outputs)
model.compile(optimizer="Adam", loss="mse", metrics=["mae"])
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
x = np.random.random((2, 3))
y = np.random.randint(0, 2, (2, 2))
_ = model.fit(x, y, verbose=0)
assert all(float(m.result()) for m in model.metrics)
</pre> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
model.reset_metrics()
assert all(float(m.result()) == 0 for m in model.metrics)
</pre> <h3 id="reset_states" data-text="reset_states"><code translate="no" dir="ltr">reset_states</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2788-L2791">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
reset_states()
</pre> <h3 id="save" data-text="save"><code translate="no" dir="ltr">save</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2383-L2436">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
save(
    filepath,
    overwrite=True,
    include_optimizer=True,
    save_format=None,
    signatures=None,
    options=None,
    save_traces=True
)
</pre> <p>Saves the model to Tensorflow SavedModel or a single HDF5 file.</p> <p>Please see <a href="../models/save_model.html"><code translate="no" dir="ltr">tf.keras.models.save_model</code></a> or the <a href="https://keras.io/guides/serialization_and_saving/">Serialization and Saving guide</a> for details.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> String, PathLike, path to SavedModel or H5 file to save the model. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">overwrite</code> </td> <td> Whether to silently overwrite any existing file at the target location, or provide the user with a manual prompt. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">include_optimizer</code> </td> <td> If True, save optimizer's state together. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">save_format</code> </td> <td> Either <code translate="no" dir="ltr">'tf'</code> or <code translate="no" dir="ltr">'h5'</code>, indicating whether to save the model to Tensorflow SavedModel or HDF5. Defaults to 'tf' in TF 2.X, and 'h5' in TF 1.X. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">signatures</code> </td> <td> Signatures to save with the SavedModel. Applicable to the 'tf' format only. Please see the <code translate="no" dir="ltr">signatures</code> argument in <a href="../../saved_model/save.html"><code translate="no" dir="ltr">tf.saved_model.save</code></a> for details. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> (only applies to SavedModel format) <a href="../../saved_model/saveoptions.html"><code translate="no" dir="ltr">tf.saved_model.SaveOptions</code></a> object that specifies options for saving to SavedModel. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">save_traces</code> </td> <td> (only applies to SavedModel format) When enabled, the SavedModel will store the function traces for each layer. This can be disabled, so that only the configs of each layer are stored. Defaults to <code translate="no" dir="ltr">True</code>. Disabling this will decrease serialization time and reduce file size, but it requires that all custom layers/models implement a <code translate="no" dir="ltr">get_config()</code> method. </td> </tr> </table> <h4 id="example_6" data-text="Example:">Example:</h4> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">from keras.models import load_model

model.save('my_model.h5')  # creates a HDF5 file 'my_model.h5'
del model  # deletes the existing model

# returns a compiled model
# identical to the previous one
model = load_model('my_model.h5')
</pre> <h3 id="save_spec" data-text="save_spec"><code translate="no" dir="ltr">save_spec</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2965-L3002">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
save_spec(
    dynamic_batch=True
)
</pre> <p>Returns the <a href="../../tensorspec.html"><code translate="no" dir="ltr">tf.TensorSpec</code></a> of call inputs as a tuple <code translate="no" dir="ltr">(args, kwargs)</code>.</p> <p>This value is automatically defined after calling the model for the first time. Afterwards, you can use it when exporting the model for serving:</p> <pre class="prettyprint lang-python" translate="no" dir="ltr" data-language="python">model = tf.keras.Model(...)

@tf.function
def serve(*args, **kwargs):
  outputs = model(*args, **kwargs)
  # Apply postprocessing steps, or add additional outputs.
  ...
  return outputs

# arg_specs is `[tf.TensorSpec(...), ...]`. kwarg_specs, in this example, is
# an empty dict since functional models do not use keyword arguments.
arg_specs, kwarg_specs = model.save_spec()

model.save(path, signatures={
  'serving_default': serve.get_concrete_function(*arg_specs, **kwarg_specs)
})
</pre>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">dynamic_batch</code> </td> <td> Whether to set the batch sizes of all the returned <a href="../../tensorspec.html"><code translate="no" dir="ltr">tf.TensorSpec</code></a> to <code translate="no" dir="ltr">None</code>. (Note that when defining functional or Sequential models with <code translate="no" dir="ltr">tf.keras.Input([...], batch_size=X)</code>, the batch size will always be preserved). Defaults to <code translate="no" dir="ltr">True</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> If the model inputs are defined, returns a tuple <code translate="no" dir="ltr">(args, kwargs)</code>. All elements in <code translate="no" dir="ltr">args</code> and <code translate="no" dir="ltr">kwargs</code> are <a href="../../tensorspec.html"><code translate="no" dir="ltr">tf.TensorSpec</code></a>. If the model inputs are not defined, returns <code translate="no" dir="ltr">None</code>. The model inputs are automatically set when calling the model, <code translate="no" dir="ltr">model.fit</code>, <code translate="no" dir="ltr">model.evaluate</code> or <code translate="no" dir="ltr">model.predict</code>. </td> </tr> 
</table> <h3 id="save_weights" data-text="save_weights"><code translate="no" dir="ltr">save_weights</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2438-L2554">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
save_weights(
    filepath, overwrite=True, save_format=None, options=None
)
</pre> <p>Saves all layer weights.</p> <p>Either saves in HDF5 or in TensorFlow format based on the <code translate="no" dir="ltr">save_format</code> argument.</p> <p>When saving in HDF5 format, the weight file has:</p> <ul> <li>
<code translate="no" dir="ltr">layer_names</code> (attribute), a list of strings (ordered names of model layers).</li> <li>For every layer, a <code translate="no" dir="ltr">group</code> named <code translate="no" dir="ltr">layer.name</code> <ul> <li>For every such layer group, a group attribute <code translate="no" dir="ltr">weight_names</code>, a list of strings (ordered names of weights tensor of the layer).</li> <li>For every weight in the layer, a dataset storing the weight value, named after the weight tensor.</li> </ul>
</li> </ul> <p>When saving in TensorFlow format, all objects referenced by the network are saved in the same format as <a href="../../train/checkpoint.html"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a>, including any <code translate="no" dir="ltr">Layer</code> instances or <code translate="no" dir="ltr">Optimizer</code> instances assigned to object attributes. For networks constructed from inputs and outputs using <code translate="no" dir="ltr">tf.keras.Model(inputs, outputs)</code>, <code translate="no" dir="ltr">Layer</code> instances used by the network are tracked/saved automatically. For user-defined classes which inherit from <a href="../model.html"><code translate="no" dir="ltr">tf.keras.Model</code></a>, <code translate="no" dir="ltr">Layer</code> instances must be assigned to object attributes, typically in the constructor. See the documentation of <a href="../../train/checkpoint.html"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a> and <a href="../model.html"><code translate="no" dir="ltr">tf.keras.Model</code></a> for details.</p> <p>While the formats are the same, do not mix <code translate="no" dir="ltr">save_weights</code> and <a href="../../train/checkpoint.html"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a>. Checkpoints saved by <a href="../model.html#save_weights"><code translate="no" dir="ltr">Model.save_weights</code></a> should be loaded using <a href="../model.html#load_weights"><code translate="no" dir="ltr">Model.load_weights</code></a>. Checkpoints saved using <a href="../../train/checkpoint.html#save"><code translate="no" dir="ltr">tf.train.Checkpoint.save</code></a> should be restored using the corresponding <a href="../../train/checkpoint.html#restore"><code translate="no" dir="ltr">tf.train.Checkpoint.restore</code></a>. Prefer <a href="../../train/checkpoint.html"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a> over <code translate="no" dir="ltr">save_weights</code> for training checkpoints.</p> <p>The TensorFlow format matches objects and variables by starting at a root object, <code translate="no" dir="ltr">self</code> for <code translate="no" dir="ltr">save_weights</code>, and greedily matching attribute names. For <a href="../model.html#save"><code translate="no" dir="ltr">Model.save</code></a> this is the <code translate="no" dir="ltr">Model</code>, and for <a href="../../train/checkpoint.html#save"><code translate="no" dir="ltr">Checkpoint.save</code></a> this is the <code translate="no" dir="ltr">Checkpoint</code> even if the <code translate="no" dir="ltr">Checkpoint</code> has a model attached. This means saving a <a href="../model.html"><code translate="no" dir="ltr">tf.keras.Model</code></a> using <code translate="no" dir="ltr">save_weights</code> and loading into a <a href="../../train/checkpoint.html"><code translate="no" dir="ltr">tf.train.Checkpoint</code></a> with a <code translate="no" dir="ltr">Model</code> attached (or vice versa) will not match the <code translate="no" dir="ltr">Model</code>'s variables. See the <a href="https://www.tensorflow.org/guide/checkpoint">guide to training checkpoints</a> for details on the TensorFlow format.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> String or PathLike, path to the file to save the weights to. When saving in TensorFlow format, this is the prefix used for checkpoint files (multiple files are generated). Note that the '.h5' suffix causes weights to be saved in HDF5 format. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">overwrite</code> </td> <td> Whether to silently overwrite any existing file at the target location, or provide the user with a manual prompt. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">save_format</code> </td> <td> Either 'tf' or 'h5'. A <code translate="no" dir="ltr">filepath</code> ending in '.h5' or '.keras' will default to HDF5 if <code translate="no" dir="ltr">save_format</code> is <code translate="no" dir="ltr">None</code>. Otherwise <code translate="no" dir="ltr">None</code> defaults to 'tf'. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> Optional <a href="../../train/checkpointoptions.html"><code translate="no" dir="ltr">tf.train.CheckpointOptions</code></a> object that specifies options for saving weights. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ImportError</code> </td> <td> If <code translate="no" dir="ltr">h5py</code> is not available when attempting to save in HDF5 format. </td> </tr> </table> <h3 id="summary" data-text="summary"><code translate="no" dir="ltr">summary</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2841-L2879">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
summary(
    line_length=None,
    positions=None,
    print_fn=None,
    expand_nested=False,
    show_trainable=False
)
</pre> <p>Prints a string summary of the network.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">line_length</code> </td> <td> Total length of printed lines (e.g. set this to adapt the display to different terminal window sizes). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">positions</code> </td> <td> Relative or absolute positions of log elements in each line. If not provided, defaults to <code translate="no" dir="ltr">[.33, .55, .67, 1.]</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">print_fn</code> </td> <td> Print function to use. Defaults to <code translate="no" dir="ltr">print</code>. It will be called on each line of the summary. You can set it to a custom function in order to capture the string summary. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">expand_nested</code> </td> <td> Whether to expand the nested models. If not provided, defaults to <code translate="no" dir="ltr">False</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">show_trainable</code> </td> <td> Whether to show if a layer is trainable. If not provided, defaults to <code translate="no" dir="ltr">False</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> if <code translate="no" dir="ltr">summary()</code> is called before the model is built. </td> </tr> </table> <h3 id="test_on_batch" data-text="test_on_batch"><code translate="no" dir="ltr">test_on_batch</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2152-L2207">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
test_on_batch(
    x, y=None, sample_weight=None, reset_metrics=True, return_dict=False
)
</pre> <p>Test the model on a single batch of samples.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). It should be consistent with <code translate="no" dir="ltr">x</code> (you cannot have Numpy inputs and tensor targets, or inversely). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional array of the same length as x, containing weights to apply to the model's loss for each sample. In the case of temporal data, you can pass a 2D array with shape (samples, sequence_length), to apply a different weight to every timestep of every sample. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">reset_metrics</code> </td> <td> If <code translate="no" dir="ltr">True</code>, the metrics returned will be only for this batch. If <code translate="no" dir="ltr">False</code>, the metrics will be statefully accumulated across batches. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_dict</code> </td> <td> If <code translate="no" dir="ltr">True</code>, loss and metric results are returned as a dict, with each key being the name of the metric. If <code translate="no" dir="ltr">False</code>, they are returned as a list. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Scalar test loss (if the model has a single output and no metrics) or list of scalars (if the model has multiple outputs and/or metrics). The attribute <code translate="no" dir="ltr">model.metrics_names</code> will give you the display labels for the scalar outputs. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.test_on_batch</code> is wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr> </table> <h3 id="test_step" data-text="test_step"><code translate="no" dir="ltr">test_step</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L1474-L1502">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
test_step(
    data
)
</pre> <p>The logic for one evaluation step.</p> <p>This method can be overridden to support custom evaluation logic. This method is called by <a href="../model.html#make_test_function"><code translate="no" dir="ltr">Model.make_test_function</code></a>.</p> <p>This function should contain the mathematical logic for one step of evaluation. This typically includes the forward pass, loss calculation, and metrics updates.</p> <p>Configuration details for <em>how</em> this logic is run (e.g. <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings), should be left to <a href="../model.html#make_test_function"><code translate="no" dir="ltr">Model.make_test_function</code></a>, which can also be overridden.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A nested structure of <code translate="no" dir="ltr">Tensor</code>s. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">dict</code> containing values that will be passed to <a href="../callbacks/callbacklist.html#on_train_batch_end"><code translate="no" dir="ltr">tf.keras.callbacks.CallbackList.on_train_batch_end</code></a>. Typically, the values of the <code translate="no" dir="ltr">Model</code>'s metrics are returned. </td> </tr> 
</table> <h3 id="to_json" data-text="to_json"><code translate="no" dir="ltr">to_json</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2743-L2758">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
to_json(
    **kwargs
)
</pre> <p>Returns a JSON string containing the network configuration.</p> <p>To load a network from a JSON save file, use <a href="../models/model_from_json.html"><code translate="no" dir="ltr">keras.models.model_from_json(json_string, custom_objects={})</code></a>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Additional keyword arguments to be passed to <code translate="no" dir="ltr">json.dumps()</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A JSON string. </td> </tr> 
</table> <h3 id="to_yaml" data-text="to_yaml"><code translate="no" dir="ltr">to_yaml</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2760-L2786">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
to_yaml(
    **kwargs
)
</pre> <p>Returns a yaml string containing the network configuration.</p> <blockquote class="note">
<strong>Note:</strong><span> Since TF 2.6, this method is no longer supported and will raise a RuntimeError.</span>
</blockquote> <p>To load a network from a yaml save file, use <a href="../models/model_from_yaml.html"><code translate="no" dir="ltr">keras.models.model_from_yaml(yaml_string, custom_objects={})</code></a>.</p> <p><code translate="no" dir="ltr">custom_objects</code> should be a dictionary mapping the names of custom losses / layers / etc to the corresponding functions / classes.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Additional keyword arguments to be passed to <code translate="no" dir="ltr">yaml.dump()</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A YAML string. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> announces that the method poses a security risk </td> </tr> </table> <h3 id="train_on_batch" data-text="train_on_batch"><code translate="no" dir="ltr">train_on_batch</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/engine/training.py#L2088-L2150">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
train_on_batch(
    x,
    y=None,
    sample_weight=None,
    class_weight=None,
    reset_metrics=True,
    return_dict=False
)
</pre> <p>Runs a single gradient update on a single batch of data.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">x</code> </td> <td> Input data. It could be: <ul> <li>A Numpy array (or array-like), or a list of arrays (in case the model has multiple inputs).</li> <li>A TensorFlow tensor, or a list of tensors (in case the model has multiple inputs).</li> <li>A dict mapping input names to the corresponding array/tensors, if the model has named inputs. </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">y</code> </td> <td> Target data. Like the input data <code translate="no" dir="ltr">x</code>, it could be either Numpy array(s) or TensorFlow tensor(s). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">sample_weight</code> </td> <td> Optional array of the same length as x, containing weights to apply to the model's loss for each sample. In the case of temporal data, you can pass a 2D array with shape (samples, sequence_length), to apply a different weight to every timestep of every sample. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">class_weight</code> </td> <td> Optional dictionary mapping class indices (integers) to a weight (float) to apply to the model's loss for the samples from this class during training. This can be useful to tell the model to "pay more attention" to samples from an under-represented class. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">reset_metrics</code> </td> <td> If <code translate="no" dir="ltr">True</code>, the metrics returned will be only for this batch. If <code translate="no" dir="ltr">False</code>, the metrics will be statefully accumulated across batches. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_dict</code> </td> <td> If <code translate="no" dir="ltr">True</code>, loss and metric results are returned as a dict, with each key being the name of the metric. If <code translate="no" dir="ltr">False</code>, they are returned as a list. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> Scalar training loss (if the model has a single output and no metrics) or list of scalars (if the model has multiple outputs and/or metrics). The attribute <code translate="no" dir="ltr">model.metrics_names</code> will give you the display labels for the scalar outputs. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">RuntimeError</code> </td> <td> If <code translate="no" dir="ltr">model.train_on_batch</code> is wrapped in a <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a>. </td> </tr> </table> <h3 id="train_step" data-text="train_step"><code translate="no" dir="ltr">train_step</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/premade_models/wide_deep.py#L112-L134">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
train_step(
    data
)
</pre> <p>The logic for one training step.</p> <p>This method can be overridden to support custom training logic. For concrete examples of how to override this method see <a href="https://www.tensorflow.org/guide/keras/customizing_what_happens_in_fit">Customizing what happends in fit</a>. This method is called by <a href="../model.html#make_train_function"><code translate="no" dir="ltr">Model.make_train_function</code></a>.</p> <p>This method should contain the mathematical logic for one step of training. This typically includes the forward pass, loss calculation, backpropagation, and metric updates.</p> <p>Configuration details for <em>how</em> this logic is run (e.g. <a href="../../function.html"><code translate="no" dir="ltr">tf.function</code></a> and <a href="../../distribute/strategy.html"><code translate="no" dir="ltr">tf.distribute.Strategy</code></a> settings), should be left to <a href="../model.html#make_train_function"><code translate="no" dir="ltr">Model.make_train_function</code></a>, which can also be overridden.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">data</code> </td> <td> A nested structure of <code translate="no" dir="ltr">Tensor</code>s. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A <code translate="no" dir="ltr">dict</code> containing values that will be passed to <a href="../callbacks/callbacklist.html#on_train_batch_end"><code translate="no" dir="ltr">tf.keras.callbacks.CallbackList.on_train_batch_end</code></a>. Typically, the values of the <code translate="no" dir="ltr">Model</code>'s metrics are returned. Example: <code translate="no" dir="ltr">{'loss': 0.2, 'accuracy': 0.7}</code>. </td> </tr> 
</table>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/keras/experimental/WideDeepModel" class="_attribution-link">https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/keras/experimental/WideDeepModel</a>
  </p>
</div>
