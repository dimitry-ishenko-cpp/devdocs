<h1 class="title">QModbusDevice Class</h1>  <p>The QModbusDevice class is the base class for Modbus classes, <a href="qmodbusserver.html">QModbusServer</a> and <a href="qmodbusclient.html">QModbusClient</a>. <a href="#details">More...</a></p>  <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> Header:</td>
<td class="memItemRight bottomAlign"> <span class="preprocessor">#include &lt;QModbusDevice&gt;</span> </td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> qmake:</td>
<td class="memItemRight bottomAlign"> QT += serialbus</td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> Since:</td>
<td class="memItemRight bottomAlign"> Qt 5.8</td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> Inherits:</td>
<td class="memItemRight bottomAlign"> <a href="qobject.html">QObject</a>
</td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> Inherited By:</td>
<td class="memItemRight bottomAlign"> <p><a href="qmodbusclient.html">QModbusClient</a> and <a href="qmodbusserver.html">QModbusServer</a></p> </td>
</tr>
</table> <ul> <li><a href="https://doc.qt.io/qt-6.2/qmodbusdevice-members.html">List of all members, including inherited members</a></li> </ul> <h2 id="public-types">Public Types
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> enum </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#ConnectionParameter-enum">ConnectionParameter</a></b> { SerialPortNameParameter, SerialParityParameter, SerialBaudRateParameter, SerialDataBitsParameter, SerialStopBitsParameter, …, NetworkAddressParameter }</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> enum </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#Error-enum">Error</a></b> { NoError, ReadError, WriteError, ConnectionError, ConfigurationError, …, UnknownError }</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> enum </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#IntermediateError-enum">IntermediateError</a></b> { ResponseCrcError, ResponseRequestMismatch }</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> enum </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#State-enum">State</a></b> { UnconnectedState, ConnectingState, ConnectedState, ClosingState }</td>
</tr> </table> <h2 id="public-functions">Public Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#QModbusDevice">QModbusDevice</a></b>(QObject *<i>parent</i> = nullptr)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#dtor.QModbusDevice">~QModbusDevice</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> bool </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#connectDevice">connectDevice</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QVariant </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#connectionParameter">connectionParameter</a></b>(QModbusDevice::ConnectionParameter <i>parameter</i>) const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QIODevice *</td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#device">device</a></b>() const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#disconnectDevice">disconnectDevice</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QModbusDevice::Error </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#error">error</a></b>() const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QString </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#errorString">errorString</a></b>() const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#setConnectionParameter">setConnectionParameter</a></b>(QModbusDevice::ConnectionParameter <i>parameter</i>, const QVariant &amp;<i>value</i>)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QModbusDevice::State </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#state">state</a></b>() const</td>
</tr> </table> <h2 id="signals">Signals
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#errorOccurred">errorOccurred</a></b>(QModbusDevice::Error <i>error</i>)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#stateChanged">stateChanged</a></b>(QModbusDevice::State <i>state</i>)</td>
</tr> </table> <h2 id="protected-functions">Protected Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#close">close</a></b>() = 0</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual bool </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#open">open</a></b>() = 0</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#setError">setError</a></b>(const QString &amp;<i>errorText</i>, QModbusDevice::Error <i>error</i>)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qmodbusdevice.html#setState">setState</a></b>(QModbusDevice::State <i>newState</i>)</td>
</tr> </table>   <h2 id="details">Detailed Description
</h2>    <h2>Member Type Documentation</h2>  <h3 class="fn" id="ConnectionParameter-enum">enum QModbusDevice::<span class="name">ConnectionParameter</span>
</h3> <p>This enum describes the possible values that can be set for a Modbus device connection.</p> <p>The general purpose value (and the associated types) are:</p> <table class="valuelist">
<tr class="odd" valign="top">
<th class="tblConst">Constant</th>
<th class="tblval">Value</th>
<th class="tbldscr">Description</th>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::SerialPortNameParameter</code></td>
<td class="topAlign tblval"><code>0</code></td>
<td class="topAlign">This parameter holds the serial port used for device communication, e.g. COM1. <code>QString</code>
</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::SerialParityParameter</code></td>
<td class="topAlign tblval"><code>1</code></td>
<td class="topAlign">This parameter holds the parity checking mode. <code>QSerialPort::Parity</code>
</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::SerialBaudRateParameter</code></td>
<td class="topAlign tblval"><code>2</code></td>
<td class="topAlign">This parameter holds the data baud rate for the communication. <code>QSerialPort::BaudRate</code>
</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::SerialDataBitsParameter</code></td>
<td class="topAlign tblval"><code>3</code></td>
<td class="topAlign">This parameter holds the data bits in a frame. <code>QSerialPort::DataBits</code>
</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::SerialStopBitsParameter</code></td>
<td class="topAlign tblval"><code>4</code></td>
<td class="topAlign">This parameter holds the number of stop bits in a frame. <code>QSerialPort::StopBits</code>
</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::NetworkPortParameter</code></td>
<td class="topAlign tblval"><code>5</code></td>
<td class="topAlign">This parameter holds the network port. <code>int</code>
</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::NetworkAddressParameter</code></td>
<td class="topAlign tblval"><code>6</code></td>
<td class="topAlign">This parameter holds the host address for network communication. <code>QString</code>
</td>
</tr> </table>   <h3 class="fn" id="Error-enum">enum QModbusDevice::<span class="name">Error</span>
</h3> <p>This enum describes all the possible error conditions.</p> <table class="valuelist">
<tr class="odd" valign="top">
<th class="tblConst">Constant</th>
<th class="tblval">Value</th>
<th class="tbldscr">Description</th>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::NoError</code></td>
<td class="topAlign tblval"><code>0</code></td>
<td class="topAlign">No errors have occurred.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ReadError</code></td>
<td class="topAlign tblval"><code>1</code></td>
<td class="topAlign">An error occurred during a read operation.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::WriteError</code></td>
<td class="topAlign tblval"><code>2</code></td>
<td class="topAlign">An error occurred during a write operation.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ConnectionError</code></td>
<td class="topAlign tblval"><code>3</code></td>
<td class="topAlign">An error occurred when attempting to open the backend.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ConfigurationError</code></td>
<td class="topAlign tblval"><code>4</code></td>
<td class="topAlign">An error occurred when attempting to set a configuration parameter.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::TimeoutError</code></td>
<td class="topAlign tblval"><code>5</code></td>
<td class="topAlign">A timeout occurred during I/O. An I/O operation did not finish within a given time frame.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ProtocolError</code></td>
<td class="topAlign tblval"><code>6</code></td>
<td class="topAlign">A Modbus specific protocol error occurred.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ReplyAbortedError</code></td>
<td class="topAlign tblval"><code>7</code></td>
<td class="topAlign">The reply was aborted due to a disconnection of the device.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::UnknownError</code></td>
<td class="topAlign tblval"><code>8</code></td>
<td class="topAlign">An unknown error occurred.</td>
</tr> </table>   <h3 class="fn" id="IntermediateError-enum">
<code>[since 6.0] </code>enum QModbusDevice::<span class="name">IntermediateError</span>
</h3> <p>This enum describes possible errors that can happen during a full send and receive cycle for a Modbus reply.</p> <table class="valuelist">
<tr class="odd" valign="top">
<th class="tblConst">Constant</th>
<th class="tblval">Value</th>
<th class="tbldscr">Description</th>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ResponseCrcError</code></td>
<td class="topAlign tblval"><code>0</code></td>
<td class="topAlign">A Modbus response with a wrong CRC was received.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ResponseRequestMismatch</code></td>
<td class="topAlign tblval"><code>1</code></td>
<td class="topAlign">A Modbus response was received but did not match the open request, probably due to the PDU's function code not matching.</td>
</tr> </table> <p>If any of the above intermediate errors occurred, the frame is likely resent until the maximum number of retries has been reached.</p> <p>The list of intermediate errors can be inspected from the <a href="qmodbusreply.html">QModbusReply</a> intermediate errors function.</p> <p>This enum was introduced or modified in Qt 6.0.</p> <p><b>See also </b><a href="qmodbusclient.html#numberOfRetries">QModbusClient::numberOfRetries</a>() and <a href="qmodbusreply.html#intermediateErrors">QModbusReply::intermediateErrors</a>().</p>   <h3 class="fn" id="State-enum">enum QModbusDevice::<span class="name">State</span>
</h3> <p>This enum describes all possible device states.</p> <table class="valuelist">
<tr class="odd" valign="top">
<th class="tblConst">Constant</th>
<th class="tblval">Value</th>
<th class="tbldscr">Description</th>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::UnconnectedState</code></td>
<td class="topAlign tblval"><code>0</code></td>
<td class="topAlign">The device is disconnected.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ConnectingState</code></td>
<td class="topAlign tblval"><code>1</code></td>
<td class="topAlign">The device is being connected.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ConnectedState</code></td>
<td class="topAlign tblval"><code>2</code></td>
<td class="topAlign">The device is connected to the Modbus network.</td>
</tr> <tr>
<td class="topAlign"><code>QModbusDevice::ClosingState</code></td>
<td class="topAlign tblval"><code>3</code></td>
<td class="topAlign">The device is being closed.</td>
</tr> </table>    <h2>Member Function Documentation</h2>  <h3 class="fn" id="QModbusDevice">QModbusDevice::<span class="name">QModbusDevice</span>(<span class="type"><a href="qobject.html#QObject">QObject</a></span> *<i>parent</i> = nullptr)
</h3> <p>Constructs a Modbus device with the specified <i>parent</i>.</p>   <h3 class="fn" id="errorOccurred">
<code>[signal] </code><span class="type">void</span> QModbusDevice::<span class="name">errorOccurred</span>(<span class="type"><a href="qmodbusdevice.html#Error-enum">QModbusDevice::Error</a></span> <i>error</i>)
</h3> <p>This signal is emitted when an error of the type, <i>error</i>, occurs.</p>   <h3 class="fn" id="stateChanged">
<code>[signal] </code><span class="type">void</span> QModbusDevice::<span class="name">stateChanged</span>(<span class="type"><a href="qmodbusdevice.html#State-enum">QModbusDevice::State</a></span> <i>state</i>)
</h3> <p>This signal is emitted every time the state of the device changes. The new state is represented by <i>state</i>.</p> <p><b>See also </b><a href="qmodbusdevice.html#setState">setState</a>() and <a href="qmodbusdevice.html#state">state</a>().</p>   <h3 class="fn" id="dtor.QModbusDevice">
<code>[virtual] </code>QModbusDevice::<span class="name">~QModbusDevice</span>()
</h3> <p>Destroys the <a href="qmodbusdevice.html">QModbusDevice</a> instance</p>   <h3 class="fn" id="close">
<code>[pure virtual protected] </code><span class="type">void</span> QModbusDevice::<span class="name">close</span>()
</h3> <p>This function is responsible for closing the Modbus connection. The implementation must ensure that the instance's <a href="qmodbusdevice.html#state">state</a>() is set to <a href="qmodbusdevice.html#State-enum">QModbusDevice::UnconnectedState</a>.</p> <p><b>See also </b><a href="qmodbusdevice.html#disconnectDevice">disconnectDevice</a>().</p>   <h3 class="fn" id="connectDevice">
<span class="type">bool</span> QModbusDevice::<span class="name">connectDevice</span>()
</h3> <p>Connects the device to the Modbus network. Returns <code>true</code> if the connection process was successfully initiated; otherwise <code>false</code>. Final connection success confirmation requires the <a href="qmodbusdevice.html#state">state</a>() changing to <a href="qmodbusdevice.html#State-enum">QModbusDevice::ConnectedState</a>.</p> <p>This function calls <a href="qmodbusdevice.html#open">open</a>() as part of its implementation.</p> <p><b>See also </b><a href="qmodbusdevice.html#open">open</a>().</p>   <h3 class="fn" id="connectionParameter">
<span class="type"><a href="qvariant.html">QVariant</a></span> QModbusDevice::<span class="name">connectionParameter</span>(<span class="type"><a href="qmodbusdevice.html#ConnectionParameter-enum">QModbusDevice::ConnectionParameter</a></span> <i>parameter</i>) const
</h3> <p>Returns the value associated with the given connection <i>parameter</i>. The returned value can be empty.</p> <p>By default the <code>QModbusDevice</code> is initialized with some common values. The serial port settings are even parity, a baud rate of 19200 bits per second, eight data bits and one stop bit. The network settings for the host address is set to local host and port to 502.</p> <div class="admonition note"> <p><b>Note: </b>For a serial connection to succeed, the <a href="qmodbusdevice.html#ConnectionParameter-enum">SerialPortNameParameter</a> needs to be set to a valid communication port. The information about valid serial ports can be obtained from <a href="qserialportinfo.html">QSerialPortInfo</a>.</p> </div> <div class="admonition note"> <p><b>Note: </b>If the device is already connected, the settings are taken into account after reconnecting the device.</p> </div> <p><b>See also </b><a href="qmodbusdevice.html#setConnectionParameter">setConnectionParameter</a>() and <a href="qmodbusdevice.html#ConnectionParameter-enum">ConnectionParameter</a>.</p>   <h3 class="fn" id="device">
<code>[since 5.14] </code><span class="type"><a href="qiodevice.html">QIODevice</a></span> *QModbusDevice::<span class="name">device</span>() const
</h3> <p>Returns the underlying <a href="qiodevice.html">QIODevice</a> used for ModBus communication or <code>nullptr</code> if the device was not yet fully initialized.</p> <div class="admonition note"> <p><b>Note: </b>Do not store a pointer to the underlying device, because it can be invalidated at any point in time.</p> </div> <p>This function was introduced in Qt 5.14.</p>   <h3 class="fn" id="disconnectDevice">
<span class="type">void</span> QModbusDevice::<span class="name">disconnectDevice</span>()
</h3> <p>Disconnects the device.</p> <p>This function calls <a href="qmodbusdevice.html#close">close</a>() as part of its implementation.</p>   <h3 class="fn" id="error">
<span class="type"><a href="qmodbusdevice.html#Error-enum">QModbusDevice::Error</a></span> QModbusDevice::<span class="name">error</span>() const
</h3> <p>Returns the error state of the device.</p> <p><b>See also </b><a href="qmodbusdevice.html#setError">setError</a>() and <a href="qmodbusdevice.html#Error-enum">QModbusDevice::Error</a>.</p>   <h3 class="fn" id="errorString">
<span class="type"><a href="qstring.html">QString</a></span> QModbusDevice::<span class="name">errorString</span>() const
</h3> <p>Returns descriptive error text for the device error.</p> <p><b>See also </b><a href="qmodbusdevice.html#Error-enum">QModbusDevice::Error</a>.</p>   <h3 class="fn" id="open">
<code>[pure virtual protected] </code><span class="type">bool</span> QModbusDevice::<span class="name">open</span>()
</h3> <p>This function is called by <a href="qmodbusdevice.html#connectDevice">connectDevice</a>(). Subclasses must provide an implementation that returns <code>true</code> on successful Modbus connection or connection initiation; otherwise returns <code>false</code>.</p> <p>The implementation must ensure that the instance's <a href="qmodbusdevice.html#state">state</a>() is set to <a href="qmodbusdevice.html#State-enum">QModbusDevice::ConnectingState</a> or <a href="qmodbusdevice.html#State-enum">QModbusDevice::ConnectedState</a> upon success; otherwise <a href="qmodbusdevice.html#State-enum">QModbusDevice::UnconnectedState</a>. Typically, <a href="qmodbusdevice.html#State-enum">QModbusDevice::ConnectingState</a> is used when the connection process reports back asynchronously and <a href="qmodbusdevice.html#State-enum">QModbusDevice::ConnectedState</a> in case of synchronous connect behavior.</p> <p><b>See also </b><a href="qmodbusdevice.html#connectDevice">connectDevice</a>().</p>   <h3 class="fn" id="setConnectionParameter">
<span class="type">void</span> QModbusDevice::<span class="name">setConnectionParameter</span>(<span class="type"><a href="qmodbusdevice.html#ConnectionParameter-enum">QModbusDevice::ConnectionParameter</a></span> <i>parameter</i>, const <span class="type"><a href="qvariant.html">QVariant</a></span> &amp;<i>value</i>)
</h3> <p>Sets the value of <i>parameter</i> to <i>value</i>. If the <i>parameter</i> already exists, the previous value is overwritten. A active or running connection is not affected by such parameter changes.</p> <p><b>See also </b><a href="qmodbusdevice.html#ConnectionParameter-enum">ConnectionParameter</a> and <a href="qmodbusdevice.html#connectionParameter">connectionParameter</a>().</p>   <h3 class="fn" id="setError">
<code>[protected] </code><span class="type">void</span> QModbusDevice::<span class="name">setError</span>(const <span class="type"><a href="qstring.html">QString</a></span> &amp;<i>errorText</i>, <span class="type"><a href="qmodbusdevice.html#Error-enum">QModbusDevice::Error</a></span> <i>error</i>)
</h3> <p>Sets the error state of the device. ModBus device implementations must use this function in case of an error to set the <i>error</i> type and a descriptive <i>errorText</i>.</p> <p><b>See also </b><a href="qmodbusdevice.html#error">error</a>() and <a href="qmodbusdevice.html#Error-enum">QModbusDevice::Error</a>.</p>   <h3 class="fn" id="setState">
<code>[protected] </code><span class="type">void</span> QModbusDevice::<span class="name">setState</span>(<span class="type"><a href="qmodbusdevice.html#State-enum">QModbusDevice::State</a></span> <i>newState</i>)
</h3> <p>Sets the state of the device to <i>newState</i>. Modbus device implementations must use this function to update the device state.</p> <p><b>See also </b><a href="qmodbusdevice.html#state">state</a>().</p>   <h3 class="fn" id="state">
<span class="type"><a href="qmodbusdevice.html#State-enum">QModbusDevice::State</a></span> QModbusDevice::<span class="name">state</span>() const
</h3> <p>Returns the current state of the device.</p> <p><b>See also </b><a href="qmodbusdevice.html#setState">setState</a>() and <a href="qmodbusdevice.html#stateChanged">stateChanged</a>().</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; The Qt Company Ltd<br>Licensed under the GNU Free Documentation License, Version 1.3.<br>
    <a href="https://doc.qt.io/qt-6.2/qmodbusdevice.html" class="_attribution-link">https://doc.qt.io/qt-6.2/qmodbusdevice.html</a>
  </p>
</div>
