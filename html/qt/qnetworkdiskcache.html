<h1 class="title">QNetworkDiskCache Class</h1>  <p>The QNetworkDiskCache class provides a very basic disk cache. <a href="#details">More...</a></p>  <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> Header:</td>
<td class="memItemRight bottomAlign"> <span class="preprocessor">#include &lt;QNetworkDiskCache&gt;</span> </td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> CMake:</td>
<td class="memItemRight bottomAlign"> find_package(Qt6 COMPONENTS Network REQUIRED)  target_link_libraries(mytarget PRIVATE Qt6::Network)</td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> qmake:</td>
<td class="memItemRight bottomAlign"> QT += network</td>
</tr>
<tr>
<td class="memItemLeft rightAlign topAlign"> Inherits:</td>
<td class="memItemRight bottomAlign"> <a href="qabstractnetworkcache.html">QAbstractNetworkCache</a>
</td>
</tr>
</table> <ul> <li><a href="https://doc.qt.io/qt-6.2/qnetworkdiskcache-members.html">List of all members, including inherited members</a></li> </ul> <h2 id="public-functions">Public Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#QNetworkDiskCache">QNetworkDiskCache</a></b>(QObject *<i>parent</i> = nullptr)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#dtor.QNetworkDiskCache">~QNetworkDiskCache</a></b>()</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QString </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#cacheDirectory">cacheDirectory</a></b>() const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> QNetworkCacheMetaData </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#fileMetaData">fileMetaData</a></b>(const QString &amp;<i>fileName</i>) const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> qint64 </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#maximumCacheSize">maximumCacheSize</a></b>() const</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#setCacheDirectory">setCacheDirectory</a></b>(const QString &amp;<i>cacheDir</i>)</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> void </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#setMaximumCacheSize">setMaximumCacheSize</a></b>(qint64 <i>size</i>)</td>
</tr> </table> <h2 id="reimplemented-public-functions">Reimplemented Public Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual qint64 </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#cacheSize">cacheSize</a></b>() const override</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual QIODevice *</td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#data">data</a></b>(const QUrl &amp;<i>url</i>) override</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#insert">insert</a></b>(QIODevice *<i>device</i>) override</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual QNetworkCacheMetaData </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#metaData">metaData</a></b>(const QUrl &amp;<i>url</i>) override</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual QIODevice *</td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#prepare">prepare</a></b>(const QNetworkCacheMetaData &amp;<i>metaData</i>) override</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual bool </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#remove">remove</a></b>(const QUrl &amp;<i>url</i>) override</td>
</tr> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#updateMetaData">updateMetaData</a></b>(const QNetworkCacheMetaData &amp;<i>metaData</i>) override</td>
</tr> </table> <h2 id="public-slots">Public Slots
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual void </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#clear">clear</a></b>() override</td>
</tr> </table> <h2 id="protected-functions">Protected Functions
</h2> <table class="alignedsummary"> <tr>
<td class="memItemLeft rightAlign topAlign"> virtual qint64 </td>
<td class="memItemRight bottomAlign">
<b><a href="qnetworkdiskcache.html#expire">expire</a></b>()</td>
</tr> </table>   <h2 id="details">Detailed Description
</h2> <p>QNetworkDiskCache stores each url in its own file inside of the <a href="qnetworkdiskcache.html#cacheDirectory">cacheDirectory</a> using <a href="qdatastream.html">QDataStream</a>. Files with a text MimeType are compressed using <a href="qbytearray.html#qCompress-1">qCompress</a>. Data is written to disk only in <a href="qnetworkdiskcache.html#insert">insert</a>() and <a href="qnetworkdiskcache.html#updateMetaData">updateMetaData</a>().</p> <p>Currently you cannot share the same cache files with more than one disk cache.</p> <p>QNetworkDiskCache by default limits the amount of space that the cache will use on the system to 50MB.</p> <p>Note you have to set the cache directory before it will work.</p> <p>A network disk cache can be enabled by:</p> <pre data-language="cpp">QNetworkAccessManager *manager = new QNetworkAccessManager(this);
QNetworkDiskCache *diskCache = new QNetworkDiskCache(this);
diskCache-&gt;setCacheDirectory("cacheDir");
manager-&gt;setCache(diskCache);</pre> <p>When sending requests, to control the preference of when to use the cache and when to use the network, consider the following:</p> <pre data-language="cpp">// do a normal request (preferred from network, as this is the default)
QNetworkRequest request(QUrl(QString("http://qt-project.org")));
manager-&gt;get(request);

// do a request preferred from cache
QNetworkRequest request2(QUrl(QString("http://qt-project.org")));
request2.setAttribute(QNetworkRequest::CacheLoadControlAttribute, QNetworkRequest::PreferCache);
manager-&gt;get(request2);</pre> <p>To check whether the response came from the cache or from the network, the following can be applied:</p> <pre data-language="cpp">void replyFinished(QNetworkReply *reply) {
    QVariant fromCache = reply-&gt;attribute(QNetworkRequest::SourceIsFromCacheAttribute);
    qDebug() &lt;&lt; "page from cache?" &lt;&lt; fromCache.toBool();
}</pre>    <h2>Member Function Documentation</h2>  <h3 class="fn" id="QNetworkDiskCache">QNetworkDiskCache::<span class="name">QNetworkDiskCache</span>(<span class="type"><a href="qobject.html#QObject">QObject</a></span> *<i>parent</i> = nullptr)
</h3> <p>Creates a new disk cache. The <i>parent</i> argument is passed to <a href="qabstractnetworkcache.html">QAbstractNetworkCache</a>'s constructor.</p>   <h3 class="fn" id="clear">
<code>[override virtual slot] </code><span class="type">void</span> QNetworkDiskCache::<span class="name">clear</span>()
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#clear">QAbstractNetworkCache::clear</a>().</p>   <h3 class="fn" id="dtor.QNetworkDiskCache">
<code>[virtual] </code>QNetworkDiskCache::<span class="name">~QNetworkDiskCache</span>()
</h3> <p>Destroys the cache object. This does not clear the disk cache.</p>   <h3 class="fn" id="cacheDirectory">
<span class="type"><a href="qstring.html">QString</a></span> QNetworkDiskCache::<span class="name">cacheDirectory</span>() const
</h3> <p>Returns the location where cached files will be stored.</p> <p><b>See also </b><a href="qnetworkdiskcache.html#setCacheDirectory">setCacheDirectory</a>().</p>   <h3 class="fn" id="cacheSize">
<code>[override virtual] </code><span class="type"><a href="qtglobal.html#qint64-typedef">qint64</a></span> QNetworkDiskCache::<span class="name">cacheSize</span>() const
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#cacheSize">QAbstractNetworkCache::cacheSize() const</a>.</p>   <h3 class="fn" id="data">
<code>[override virtual] </code><span class="type"><a href="qiodevice.html">QIODevice</a></span> *QNetworkDiskCache::<span class="name">data</span>(const <span class="type"><a href="qurl.html">QUrl</a></span> &amp;<i>url</i>)
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#data">QAbstractNetworkCache::data</a>(const QUrl &amp;url).</p>   <h3 class="fn" id="expire">
<code>[virtual protected] </code><span class="type"><a href="qtglobal.html#qint64-typedef">qint64</a></span> QNetworkDiskCache::<span class="name">expire</span>()
</h3> <p>Cleans the cache so that its size is under the maximum cache size. Returns the current size of the cache.</p> <p>When the current size of the cache is greater than the <a href="qnetworkdiskcache.html#maximumCacheSize">maximumCacheSize</a>() older cache files are removed until the total size is less then 90% of <a href="qnetworkdiskcache.html#maximumCacheSize">maximumCacheSize</a>() starting with the oldest ones first using the file creation date to determine how old a cache file is.</p> <p>Subclasses can reimplement this function to change the order that cache files are removed taking into account information in the application knows about that <a href="qnetworkdiskcache.html">QNetworkDiskCache</a> does not, for example the number of times a cache is accessed.</p> <div class="admonition note"> <p><b>Note: </b><a href="qnetworkdiskcache.html#cacheSize">cacheSize</a>() calls expire if the current cache size is unknown.</p> </div> <p><b>See also </b><a href="qnetworkdiskcache.html#maximumCacheSize">maximumCacheSize</a>() and <a href="qnetworkdiskcache.html#fileMetaData">fileMetaData</a>().</p>   <h3 class="fn" id="fileMetaData">
<span class="type"><a href="qnetworkcachemetadata.html">QNetworkCacheMetaData</a></span> QNetworkDiskCache::<span class="name">fileMetaData</span>(const <span class="type"><a href="qstring.html">QString</a></span> &amp;<i>fileName</i>) const
</h3> <p>Returns the <a href="qnetworkcachemetadata.html">QNetworkCacheMetaData</a> for the cache file <i>fileName</i>.</p> <p>If <i>fileName</i> is not a cache file <a href="qnetworkcachemetadata.html">QNetworkCacheMetaData</a> will be invalid.</p>   <h3 class="fn" id="insert">
<code>[override virtual] </code><span class="type">void</span> QNetworkDiskCache::<span class="name">insert</span>(<span class="type"><a href="qiodevice.html">QIODevice</a></span> *<i>device</i>)
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#insert">QAbstractNetworkCache::insert</a>(QIODevice *device).</p>   <h3 class="fn" id="maximumCacheSize">
<span class="type"><a href="qtglobal.html#qint64-typedef">qint64</a></span> QNetworkDiskCache::<span class="name">maximumCacheSize</span>() const
</h3> <p>Returns the current maximum size for the disk cache.</p> <p><b>See also </b><a href="qnetworkdiskcache.html#setMaximumCacheSize">setMaximumCacheSize</a>().</p>   <h3 class="fn" id="metaData">
<code>[override virtual] </code><span class="type"><a href="qnetworkcachemetadata.html">QNetworkCacheMetaData</a></span> QNetworkDiskCache::<span class="name">metaData</span>(const <span class="type"><a href="qurl.html">QUrl</a></span> &amp;<i>url</i>)
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#metaData">QAbstractNetworkCache::metaData</a>(const QUrl &amp;url).</p>   <h3 class="fn" id="prepare">
<code>[override virtual] </code><span class="type"><a href="qiodevice.html">QIODevice</a></span> *QNetworkDiskCache::<span class="name">prepare</span>(const <span class="type"><a href="qnetworkcachemetadata.html">QNetworkCacheMetaData</a></span> &amp;<i>metaData</i>)
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#prepare">QAbstractNetworkCache::prepare</a>(const QNetworkCacheMetaData &amp;metaData).</p>   <h3 class="fn" id="remove">
<code>[override virtual] </code><span class="type">bool</span> QNetworkDiskCache::<span class="name">remove</span>(const <span class="type"><a href="qurl.html">QUrl</a></span> &amp;<i>url</i>)
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#remove">QAbstractNetworkCache::remove</a>(const QUrl &amp;url).</p>   <h3 class="fn" id="setCacheDirectory">
<span class="type">void</span> QNetworkDiskCache::<span class="name">setCacheDirectory</span>(const <span class="type"><a href="qstring.html">QString</a></span> &amp;<i>cacheDir</i>)
</h3> <p>Sets the directory where cached files will be stored to <i>cacheDir</i></p> <p><a href="qnetworkdiskcache.html">QNetworkDiskCache</a> will create this directory if it does not exists.</p> <p>Prepared cache items will be stored in the new cache directory when they are inserted.</p> <p><b>See also </b><a href="qnetworkdiskcache.html#cacheDirectory">cacheDirectory</a>() and <a href="qstandardpaths.html#StandardLocation-enum">QStandardPaths::CacheLocation</a>.</p>   <h3 class="fn" id="setMaximumCacheSize">
<span class="type">void</span> QNetworkDiskCache::<span class="name">setMaximumCacheSize</span>(<span class="type"><a href="qtglobal.html#qint64-typedef">qint64</a></span> <i>size</i>)
</h3> <p>Sets the maximum size of the disk cache to be <i>size</i>.</p> <p>If the new size is smaller then the current cache size then the cache will call <a href="qnetworkdiskcache.html#expire">expire</a>().</p> <p><b>See also </b><a href="qnetworkdiskcache.html#maximumCacheSize">maximumCacheSize</a>().</p>   <h3 class="fn" id="updateMetaData">
<code>[override virtual] </code><span class="type">void</span> QNetworkDiskCache::<span class="name">updateMetaData</span>(const <span class="type"><a href="qnetworkcachemetadata.html">QNetworkCacheMetaData</a></span> &amp;<i>metaData</i>)
</h3> <p>Reimplements: <a href="qabstractnetworkcache.html#updateMetaData">QAbstractNetworkCache::updateMetaData</a>(const QNetworkCacheMetaData &amp;metaData).</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; The Qt Company Ltd<br>Licensed under the GNU Free Documentation License, Version 1.3.<br>
    <a href="https://doc.qt.io/qt-6.2/qnetworkdiskcache.html" class="_attribution-link">https://doc.qt.io/qt-6.2/qnetworkdiskcache.html</a>
  </p>
</div>
