<h1 id="input-format">Input format</h1> <div class="rule" id="r-input"><a class="rule-link" href="#r-input">[input]</a></div> <div class="rule" id="r-input.intro"><a class="rule-link" href="#r-input.intro">[input.intro]</a></div> <p>This chapter describes how a source file is interpreted as a sequence of tokens.</p> <p>See <a href="crates-and-source-files.html">Crates and source files</a> for a description of how programs are organised into files.</p> <h2 id="source-encoding">Source encoding</h2> <div class="rule" id="r-input.encoding"><a class="rule-link" href="#r-input.encoding">[input.encoding]</a></div> <div class="rule" id="r-input.encoding.utf8">
<a class="rule-link" href="#r-input.encoding.utf8">[input.encoding.utf8]</a><span class="popup-container"> <a href="javascript:void(0).html" onclick="spec_toggle_tests('input.encoding.utf8');">Tests</a> <div id="tests-input.encoding.utf8" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/macros/not-utf8.rs">tests/ui/macros/not-utf8.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/utf16-be-without-bom.rs">tests/ui/parser/utf16-be-without-bom.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/utf16-le-without-bom.rs">tests/ui/parser/utf16-le-without-bom.rs</a></li> </ul>
</div></span>
</div> <p>Each source file is interpreted as a sequence of Unicode characters encoded in UTF-8.</p> <div class="rule" id="r-input.encoding.invalid">
<a class="rule-link" href="#r-input.encoding.invalid">[input.encoding.invalid]</a><span class="popup-container"> <a href="javascript:void(0).html" onclick="spec_toggle_tests('input.encoding.invalid');">Tests</a> <div id="tests-input.encoding.invalid" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/macros/not-utf8.rs">tests/ui/macros/not-utf8.rs</a></li> </ul>
</div></span>
</div> <p>It is an error if the file is not valid UTF-8.</p> <h2 id="byte-order-mark-removal">Byte order mark removal</h2> <div class="rule" id="r-input.byte-order-mark">
<a class="rule-link" href="#r-input.byte-order-mark">[input.byte-order-mark]</a><span class="popup-container"> <a href="javascript:void(0).html" onclick="spec_toggle_tests('input.byte-order-mark');">Tests</a> <div id="tests-input.byte-order-mark" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/json/json-bom-plus-crlf-multifile.rs">tests/ui/json/json-bom-plus-crlf-multifile.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/json/json-bom-plus-crlf.rs">tests/ui/json/json-bom-plus-crlf.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/utf8-bom.rs">tests/ui/utf8-bom.rs</a></li> </ul>
</div></span>
</div> <p>If the first character in the sequence is <code>U+FEFF</code> (<a href="https://en.wikipedia.org/wiki/Byte_order_mark#UTF-8">BYTE ORDER MARK</a>), it is removed.</p> <h2 id="crlf-normalization">CRLF normalization</h2> <div class="rule" id="r-input.crlf">
<a class="rule-link" href="#r-input.crlf">[input.crlf]</a><span class="popup-container"> <a href="javascript:void(0).html" onclick="spec_toggle_tests('input.crlf');">Tests</a> <div id="tests-input.crlf" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/json/json-bom-plus-crlf-multifile.rs">tests/ui/json/json-bom-plus-crlf-multifile.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/json/json-bom-plus-crlf.rs">tests/ui/json/json-bom-plus-crlf.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/lexer/lexer-crlf-line-endings-string-literal-doc-comment.rs">tests/ui/lexer/lexer-crlf-line-endings-string-literal-doc-comment.rs</a></li> </ul>
</div></span>
</div> <p>Each pair of characters <code>U+000D</code> (CR) immediately followed by <code>U+000A</code> (LF) is replaced by a single <code>U+000A</code> (LF).</p> <p>Other occurrences of the character <code>U+000D</code> (CR) are left in place (they are treated as <a href="whitespace.html">whitespace</a>).</p> <h2 id="shebang-removal">Shebang removal</h2> <div class="rule" id="r-input.shebang">
<a class="rule-link" href="#r-input.shebang">[input.shebang]</a><span class="popup-container"> <a href="javascript:void(0).html" onclick="spec_toggle_tests('input.shebang');">Tests</a> <div id="tests-input.shebang" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/issue-71471-ignore-tidy.rs">tests/ui/parser/shebang/issue-71471-ignore-tidy.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/shebang-comment.rs">tests/ui/parser/shebang/shebang-comment.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/shebang-empty.rs">tests/ui/parser/shebang/shebang-empty.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/shebang-must-start-file.rs">tests/ui/parser/shebang/shebang-must-start-file.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/shebang-space.rs">tests/ui/parser/shebang/shebang-space.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/valid-shebang.rs">tests/ui/parser/shebang/valid-shebang.rs</a></li> </ul>
</div></span>
</div> <div class="rule" id="r-input.shebang.intro"><a class="rule-link" href="#r-input.shebang.intro">[input.shebang.intro]</a></div> <p>If the remaining sequence begins with the characters <code>#!</code>, the characters up to and including the first <code>U+000A</code> (LF) are removed from the sequence.</p> <p>For example, the first line of the following file would be ignored:</p>  <pre data-language="rust">#!/usr/bin/env rustx

fn main() {
    println!("Hello!");
}</pre> <div class="rule" id="r-input.shebang.inner-attribute">
<a class="rule-link" href="#r-input.shebang.inner-attribute">[input.shebang.inner-attribute]</a><span class="popup-container"> <a href="javascript:void(0).html" onclick="spec_toggle_tests('input.shebang.inner-attribute');">Tests</a> <div id="tests-input.shebang.inner-attribute" class="tests-popup popup-hidden"> Tests with this rule: <ul>
<li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/multiline-attrib.rs">tests/ui/parser/shebang/multiline-attrib.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/regular-attrib.rs">tests/ui/parser/shebang/regular-attrib.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/shebang-and-attrib.rs">tests/ui/parser/shebang/shebang-and-attrib.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/shebang-doc-comment.rs">tests/ui/parser/shebang/shebang-doc-comment.rs</a></li> <li><a href="https://github.com/rust-lang/rust/blob/1.85.0/tests/ui/parser/shebang/sneaky-attrib.rs">tests/ui/parser/shebang/sneaky-attrib.rs</a></li> </ul>
</div></span>
</div> <p>As an exception, if the <code>#!</code> characters are followed (ignoring intervening <a href="comments.html">comments</a> or <a href="whitespace.html">whitespace</a>) by a <code>[</code> token, nothing is removed. This prevents an <a href="attributes.html">inner attribute</a> at the start of a source file being removed.</p> <blockquote> <p><strong>Note</strong>: The standard library <a href="https://doc.rust-lang.org/core/macro.include.html"><code>include!</code></a> macro applies byte order mark removal, CRLF normalization, and shebang removal to the file it reads. The <a href="https://doc.rust-lang.org/core/macro.include_str.html"><code>include_str!</code></a> and <a href="https://doc.rust-lang.org/core/macro.include_bytes.html"><code>include_bytes!</code></a> macros do not.</p> </blockquote> <h2 id="tokenization">Tokenization</h2> <div class="rule" id="r-input.tokenization"><a class="rule-link" href="#r-input.tokenization">[input.tokenization]</a></div> <p>The resulting sequence of characters is then converted into tokens as described in the remainder of this chapter.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010 The Rust Project Developers<br>Licensed under the Apache License, Version 2.0 or the MIT license, at your option.<br>
    <a href="https://doc.rust-lang.org/reference/input-format.html" class="_attribution-link">https://doc.rust-lang.org/reference/input-format.html</a>
  </p>
</div>
