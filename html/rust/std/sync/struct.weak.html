<h1 class="main-heading">Struct std::sync::Weak</h1>
<pre class="rust item-decl" data-language="rust">pub struct Weak&lt;T, A = Global&gt;where
    A: Allocator,
    T: ?Sized,{ /* private fields */ }</pre>
<p><code>Weak</code> is a version of <a href="struct.arc.html" title="struct std::sync::Arc"><code>Arc</code></a> that holds a non-owning reference to the managed allocation. The allocation is accessed by calling <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> on the <code>Weak</code> pointer, which returns an <code><a href="../option/enum.option.html" title="enum std::option::Option">Option</a>&lt;<a href="struct.arc.html" title="struct std::sync::Arc">Arc</a>&lt;T&gt;&gt;</code>.</p> <p>Since a <code>Weak</code> reference does not count towards ownership, it will not prevent the value stored in the allocation from being dropped, and <code>Weak</code> itself makes no guarantees about the value still being present. Thus it may return <a href="../option/enum.option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a> when <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a>d. Note however that a <code>Weak</code> reference <em>does</em> prevent the allocation itself (the backing store) from being deallocated.</p> <p>A <code>Weak</code> pointer is useful for keeping a temporary reference to the allocation managed by <a href="struct.arc.html" title="struct std::sync::Arc"><code>Arc</code></a> without preventing its inner value from being dropped. It is also used to prevent circular references between <a href="struct.arc.html" title="struct std::sync::Arc"><code>Arc</code></a> pointers, since mutual owning references would never allow either <a href="struct.arc.html" title="struct std::sync::Arc"><code>Arc</code></a> to be dropped. For example, a tree could have strong <a href="struct.arc.html" title="struct std::sync::Arc"><code>Arc</code></a> pointers from parent nodes to children, and <code>Weak</code> pointers from children back to their parents.</p> <p>The typical way to obtain a <code>Weak</code> pointer is to call <a href="struct.arc.html#method.downgrade" title="associated function std::sync::Arc::downgrade"><code>Arc::downgrade</code></a>.</p> <h3 id="implementations" class="section-header">Implementations</h3>
<div id="implementations-list">
<summary><section id="impl-Weak%3CT%3E" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2585">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; Weak&lt;T&gt;</pre></section></summary><div class="impl-items">
<summary><section id="method.new" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.10.0, const since 1.73.0">1.10.0 (const: 1.73.0)</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2603">source</a></span><pre class="code-header" data-language="rust">pub const fn new() -&gt; Weak&lt;T&gt;</pre></section></summary><div class="docblock">
<p>Constructs a new <code>Weak&lt;T&gt;</code>, without allocating any memory. Calling <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> on the return value always gives <a href="../option/enum.option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a>.</p> <h5 id="examples">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::Weak;

let empty: Weak&lt;i64&gt; = Weak::new();
assert!(empty.upgrade().is_none());</pre></div> </div>
</div>
<summary><section id="impl-Weak%3CT,+A%3E" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2613">source</a><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Weak&lt;T, A&gt;where
    A: Allocator,</pre></section></summary><div class="impl-items">
<summary><section id="method.new_in" class="method"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2633">source</a><pre class="code-header" data-language="rust">pub fn new_in(alloc: A) -&gt; Weak&lt;T, A&gt;</pre></section><span class="item-info"><div class="stab unstable">
<span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code> <a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span>
</div></span></summary><div class="docblock">
<p>Constructs a new <code>Weak&lt;T, A&gt;</code>, without allocating any memory, technically in the provided allocator. Calling <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> on the return value always gives <a href="../option/enum.option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a>.</p> <h5 id="examples-1">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">#![feature(allocator_api)]

use std::sync::Weak;
use std::alloc::System;

let empty: Weak&lt;i64, _&gt; = Weak::new_in(System);
assert!(empty.upgrade().is_none());</pre></div> </div>
</div>
<summary><section id="impl-Weak%3CT%3E-1" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2650">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; Weak&lt;T&gt;where
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.from_raw" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.45.0">1.45.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2694">source</a></span><pre class="code-header" data-language="rust">pub unsafe fn from_raw(ptr: *const T) -&gt; Weak&lt;T&gt;</pre></section></summary><div class="docblock">
<p>Converts a raw pointer previously created by <a href="struct.weak.html#method.into_raw" title="method std::sync::Weak::into_raw"><code>into_raw</code></a> back into <code>Weak&lt;T&gt;</code>.</p> <p>This can be used to safely get a strong reference (by calling <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> later) or to deallocate the weak count by dropping the <code>Weak&lt;T&gt;</code>.</p> <p>It takes ownership of one weak reference (with the exception of pointers created by <a href="struct.weak.html#method.new" title="associated function std::sync::Weak::new"><code>new</code></a>, as these donâ€™t own anything; the method still works on them).</p> <h5 id="safety">Safety</h5> <p>The pointer must have originated from the <a href="struct.weak.html#method.into_raw" title="method std::sync::Weak::into_raw"><code>into_raw</code></a> and must still own its potential weak reference.</p> <p>It is allowed for the strong count to be 0 at the time of calling this. Nevertheless, this takes ownership of one weak reference currently represented as a raw pointer (the weak count is not modified by this operation) and therefore it must be paired with a previous call to <a href="struct.weak.html#method.into_raw" title="method std::sync::Weak::into_raw"><code>into_raw</code></a>.</p> <h5 id="examples-2">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::{Arc, Weak};

let strong = Arc::new("hello".to_owned());

let raw_1 = Arc::downgrade(&amp;strong).into_raw();
let raw_2 = Arc::downgrade(&amp;strong).into_raw();

assert_eq!(2, Arc::weak_count(&amp;strong));

assert_eq!("hello", &amp;*unsafe { Weak::from_raw(raw_1) }.upgrade().unwrap());
assert_eq!(1, Arc::weak_count(&amp;strong));

drop(strong);

// Decrement the last weak count.
assert!(unsafe { Weak::from_raw(raw_2) }.upgrade().is_none());</pre></div> </div>
</div>
<summary><section id="impl-Weak%3CT,+A%3E-1" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2699">source</a><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Weak&lt;T, A&gt;where
    A: Allocator,
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.as_ptr" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.45.0">1.45.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2727">source</a></span><pre class="code-header" data-language="rust">pub fn as_ptr(&amp;self) -&gt; *const T</pre></section></summary><div class="docblock">
<p>Returns a raw pointer to the object <code>T</code> pointed to by this <code>Weak&lt;T&gt;</code>.</p> <p>The pointer is valid only if there are some strong references. The pointer may be dangling, unaligned or even <a href="../ptr/fn.null.html" title="ptr::null"><code>null</code></a> otherwise.</p> <h5 id="examples-3">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::Arc;
use std::ptr;

let strong = Arc::new("hello".to_owned());
let weak = Arc::downgrade(&amp;strong);
// Both point to the same object
assert!(ptr::eq(&amp;*strong, weak.as_ptr()));
// The strong here keeps it alive, so we can still access the object.
assert_eq!("hello", unsafe { &amp;*weak.as_ptr() });

drop(strong);
// But not any more. We can do weak.as_ptr(), but accessing the pointer would lead to
// undefined behaviour.
// assert_eq!("hello", unsafe { &amp;*weak.as_ptr() });</pre></div> </div>
<summary><section id="method.into_raw" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.45.0">1.45.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2771">source</a></span><pre class="code-header" data-language="rust">pub fn into_raw(self) -&gt; *const T</pre></section></summary><div class="docblock">
<p>Consumes the <code>Weak&lt;T&gt;</code> and turns it into a raw pointer.</p> <p>This converts the weak pointer into a raw pointer, while still preserving the ownership of one weak reference (the weak count is not modified by this operation). It can be turned back into the <code>Weak&lt;T&gt;</code> with <a href="struct.weak.html#method.from_raw" title="associated function std::sync::Weak::from_raw"><code>from_raw</code></a>.</p> <p>The same restrictions of accessing the target of the pointer as with <a href="struct.weak.html#method.as_ptr" title="method std::sync::Weak::as_ptr"><code>as_ptr</code></a> apply.</p> <h5 id="examples-4">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::{Arc, Weak};

let strong = Arc::new("hello".to_owned());
let weak = Arc::downgrade(&amp;strong);
let raw = weak.into_raw();

assert_eq!(1, Arc::weak_count(&amp;strong));
assert_eq!("hello", unsafe { &amp;*raw });

drop(unsafe { Weak::from_raw(raw) });
assert_eq!(0, Arc::weak_count(&amp;strong));</pre></div> </div>
<summary><section id="method.into_raw_with_allocator" class="method"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2808">source</a><pre class="code-header" data-language="rust">pub fn into_raw_with_allocator(self) -&gt; (*const T, A)</pre></section><span class="item-info"><div class="stab unstable">
<span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code> <a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span>
</div></span></summary><div class="docblock">
<p>Consumes the <code>Weak&lt;T&gt;</code>, returning the wrapped pointer and allocator.</p> <p>This converts the weak pointer into a raw pointer, while still preserving the ownership of one weak reference (the weak count is not modified by this operation). It can be turned back into the <code>Weak&lt;T&gt;</code> with <a href="struct.weak.html#method.from_raw_in" title="associated function std::sync::Weak::from_raw_in"><code>from_raw_in</code></a>.</p> <p>The same restrictions of accessing the target of the pointer as with <a href="struct.weak.html#method.as_ptr" title="method std::sync::Weak::as_ptr"><code>as_ptr</code></a> apply.</p> <h5 id="examples-5">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">#![feature(allocator_api)]
use std::sync::{Arc, Weak};
use std::alloc::System;

let strong = Arc::new_in("hello".to_owned(), System);
let weak = Arc::downgrade(&amp;strong);
let (raw, alloc) = weak.into_raw_with_allocator();

assert_eq!(1, Arc::weak_count(&amp;strong));
assert_eq!("hello", unsafe { &amp;*raw });

drop(unsafe { Weak::from_raw_in(raw, alloc) });
assert_eq!(0, Arc::weak_count(&amp;strong));</pre></div> </div>
<summary><section id="method.from_raw_in" class="method"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2860">source</a><pre class="code-header" data-language="rust">pub unsafe fn from_raw_in(ptr: *const T, alloc: A) -&gt; Weak&lt;T, A&gt;</pre></section><span class="item-info"><div class="stab unstable">
<span class="emoji">ðŸ”¬</span><span>This is a nightly-only experimental API. (<code>allocator_api</code> <a href="https://github.com/rust-lang/rust/issues/32838">#32838</a>)</span>
</div></span></summary><div class="docblock">
<p>Converts a raw pointer previously created by <a href="struct.weak.html#method.into_raw" title="method std::sync::Weak::into_raw"><code>into_raw</code></a> back into <code>Weak&lt;T&gt;</code> in the provided allocator.</p> <p>This can be used to safely get a strong reference (by calling <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> later) or to deallocate the weak count by dropping the <code>Weak&lt;T&gt;</code>.</p> <p>It takes ownership of one weak reference (with the exception of pointers created by <a href="struct.weak.html#method.new" title="associated function std::sync::Weak::new"><code>new</code></a>, as these donâ€™t own anything; the method still works on them).</p> <h5 id="safety-1">Safety</h5> <p>The pointer must have originated from the <a href="struct.weak.html#method.into_raw" title="method std::sync::Weak::into_raw"><code>into_raw</code></a> and must still own its potential weak reference, and must point to a block of memory allocated by <code>alloc</code>.</p> <p>It is allowed for the strong count to be 0 at the time of calling this. Nevertheless, this takes ownership of one weak reference currently represented as a raw pointer (the weak count is not modified by this operation) and therefore it must be paired with a previous call to <a href="struct.weak.html#method.into_raw" title="method std::sync::Weak::into_raw"><code>into_raw</code></a>.</p> <h5 id="examples-6">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::{Arc, Weak};

let strong = Arc::new("hello".to_owned());

let raw_1 = Arc::downgrade(&amp;strong).into_raw();
let raw_2 = Arc::downgrade(&amp;strong).into_raw();

assert_eq!(2, Arc::weak_count(&amp;strong));

assert_eq!("hello", &amp;*unsafe { Weak::from_raw(raw_1) }.upgrade().unwrap());
assert_eq!(1, Arc::weak_count(&amp;strong));

drop(strong);

// Decrement the last weak count.
assert!(unsafe { Weak::from_raw(raw_2) }.upgrade().is_none());</pre></div> </div>
</div>
<summary><section id="impl-Weak%3CT,+A%3E-2" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2880">source</a><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Weak&lt;T, A&gt;where
    A: Allocator,
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.upgrade" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2907-2909">source</a></span><pre class="code-header" data-language="rust">pub fn upgrade(&amp;self) -&gt; Option&lt;Arc&lt;T, A&gt;&gt;where
    A: Clone,</pre></section></summary><div class="docblock">
<p>Attempts to upgrade the <code>Weak</code> pointer to an <a href="struct.arc.html" title="struct std::sync::Arc"><code>Arc</code></a>, delaying dropping of the inner value if successful.</p> <p>Returns <a href="../option/enum.option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a> if the inner value has since been dropped.</p> <h5 id="examples-7">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::Arc;

let five = Arc::new(5);

let weak_five = Arc::downgrade(&amp;five);

let strong_five: Option&lt;Arc&lt;_&gt;&gt; = weak_five.upgrade();
assert!(strong_five.is_some());

// Destroy all strong pointers.
drop(strong_five);
drop(five);

assert!(weak_five.upgrade().is_none());</pre></div> </div>
<summary><section id="method.strong_count" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.41.0">1.41.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2943">source</a></span><pre class="code-header" data-language="rust">pub fn strong_count(&amp;self) -&gt; usize</pre></section></summary><div class="docblock">
<p>Gets the number of strong (<code>Arc</code>) pointers pointing to this allocation.</p> <p>If <code>self</code> was created using <a href="struct.weak.html#method.new" title="associated function std::sync::Weak::new"><code>Weak::new</code></a>, this will return 0.</p> </div>
<summary><section id="method.weak_count" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.41.0">1.41.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#2960">source</a></span><pre class="code-header" data-language="rust">pub fn weak_count(&amp;self) -&gt; usize</pre></section></summary><div class="docblock">
<p>Gets an approximation of the number of <code>Weak</code> pointers pointing to this allocation.</p> <p>If <code>self</code> was created using <a href="struct.weak.html#method.new" title="associated function std::sync::Weak::new"><code>Weak::new</code></a>, or if there are no remaining strong pointers, this will return 0.</p> <h5 id="accuracy">Accuracy</h5> <p>Due to implementation details, the returned value can be off by 1 in either direction when other threads are manipulating any <code>Arc</code>s or <code>Weak</code>s pointing to the same allocation.</p> </div>
<summary><section id="method.ptr_eq" class="method"><span class="rightside"><span class="since" title="Stable since Rust version 1.39.0">1.39.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3038">source</a></span><pre class="code-header" data-language="rust">pub fn ptr_eq(&amp;self, other: &amp;Weak&lt;T, A&gt;) -&gt; bool</pre></section></summary><div class="docblock">
<p>Returns <code>true</code> if the two <code>Weak</code>s point to the same allocation similar to <a href="../ptr/fn.eq.html" title="ptr::eq"><code>ptr::eq</code></a>, or if both donâ€™t point to any allocation (because they were created with <code>Weak::new()</code>). However, this function ignores the metadata of <code>dyn Trait</code> pointers.</p> <h5 id="notes">Notes</h5> <p>Since this compares pointers it means that <code>Weak::new()</code> will equal each other, even though they donâ€™t point to any allocation.</p> <h5 id="examples-8">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::Arc;

let first_rc = Arc::new(5);
let first = Arc::downgrade(&amp;first_rc);
let second = Arc::downgrade(&amp;first_rc);

assert!(first.ptr_eq(&amp;second));

let third_rc = Arc::new(5);
let third = Arc::downgrade(&amp;third_rc);

assert!(!first.ptr_eq(&amp;third));</pre></div> <p>Comparing <code>Weak::new</code>.</p> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::{Arc, Weak};

let first = Weak::new();
let second = Weak::new();
assert!(first.ptr_eq(&amp;second));

let third_rc = Arc::new(());
let third = Arc::downgrade(&amp;third_rc);
assert!(!first.ptr_eq(&amp;third));</pre></div> </div>
</div>
</div>
<h3 id="trait-implementations" class="section-header">Trait Implementations</h3>
<div id="trait-implementations-list">
<summary><section id="impl-Clone-for-Weak%3CT,+A%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3044">source</a></span><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Clone for Weak&lt;T, A&gt;where
    A: Allocator + Clone,
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.clone" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3057">source</a><pre class="code-header" data-language="rust">fn clone(&amp;self) -&gt; Weak&lt;T, A&gt;</pre></section></summary><div class="docblock">
<p>Makes a clone of the <code>Weak</code> pointer that points to the same allocation.</p> <h5 id="examples-9">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::{Arc, Weak};

let weak_five = Arc::downgrade(&amp;Arc::new(5));

let _ = Weak::clone(&amp;weak_five);</pre></div> </div>
<summary><section id="method.clone_from" class="method trait-impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.0.0">1.0.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/core/clone.rs.html#169">source</a></span><pre class="code-header" data-language="rust">fn clone_from(&amp;mut self, source: &amp;Self)</pre></section></summary><div class="docblock">Performs copy-assignment from <code>source</code>. <a href="../clone/trait.clone.html#method.clone_from">Read more</a>
</div>
</div>
<summary><section id="impl-Debug-for-Weak%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#344">source</a></span><pre class="code-header" data-language="rust">impl&lt;T&gt; Debug for Weak&lt;T&gt;where
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.fmt" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#345">source</a><pre class="code-header" data-language="rust">fn fmt(&amp;self, f: &amp;mut Formatter&lt;'_&gt;) -&gt; Result&lt;(), Error&gt;</pre></section></summary><div class="docblock">Formats the value using the given formatter. <a href="../fmt/trait.debug.html#tymethod.fmt">Read more</a>
</div>
</div>
<summary><section id="impl-Default-for-Weak%3CT%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.10.0">1.10.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3076">source</a></span><pre class="code-header" data-language="rust">impl&lt;T&gt; Default for Weak&lt;T&gt;</pre></section></summary><div class="impl-items">
<summary><section id="method.default" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3091">source</a><pre class="code-header" data-language="rust">fn default() -&gt; Weak&lt;T&gt;</pre></section></summary><div class="docblock">
<p>Constructs a new <code>Weak&lt;T&gt;</code>, without allocating memory. Calling <a href="struct.weak.html#method.upgrade" title="method std::sync::Weak::upgrade"><code>upgrade</code></a> on the return value always gives <a href="../option/enum.option.html#variant.None" title="variant std::option::Option::None"><code>None</code></a>.</p> <h5 id="examples-10">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::Weak;

let empty: Weak&lt;i64&gt; = Default::default();
assert!(empty.upgrade().is_none());</pre></div> </div>
</div>
<summary><section id="impl-Drop-for-Weak%3CT,+A%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3097">source</a></span><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Drop for Weak&lt;T, A&gt;where
    A: Allocator,
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.drop" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#3122">source</a><pre class="code-header" data-language="rust">fn drop(&amp;mut self)</pre></section></summary><div class="docblock">
<p>Drops the <code>Weak</code> pointer.</p> <h5 id="examples-11">Examples</h5> <div class="example-wrap"><pre class="rust rust-example-rendered" data-language="rust">use std::sync::{Arc, Weak};

struct Foo;

impl Drop for Foo {
    fn drop(&amp;mut self) {
        println!("dropped!");
    }
}

let foo = Arc::new(Foo);
let weak_foo = Arc::downgrade(&amp;foo);
let other_weak_foo = Weak::clone(&amp;weak_foo);

drop(weak_foo);   // Doesn't print anything
drop(foo);        // Prints "dropped!"

assert!(other_weak_foo.upgrade().is_none());</pre></div> </div>
</div>
<section id="impl-CoerceUnsized%3CWeak%3CU,+A%3E%3E-for-Weak%3CT,+A%3E" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#339">source</a><pre class="code-header" data-language="rust">impl&lt;T, U, A&gt; CoerceUnsized&lt;Weak&lt;U, A&gt;&gt; for Weak&lt;T, A&gt;where
    T: Unsize&lt;U&gt; + ?Sized,
    A: Allocator,
    U: ?Sized,</pre></section><section id="impl-DispatchFromDyn%3CWeak%3CU%3E%3E-for-Weak%3CT%3E" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#341">source</a><pre class="code-header" data-language="rust">impl&lt;T, U&gt; DispatchFromDyn&lt;Weak&lt;U&gt;&gt; for Weak&lt;T&gt;where
    T: Unsize&lt;U&gt; + ?Sized,
    U: ?Sized,</pre></section><section id="impl-Send-for-Weak%3CT,+A%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#334">source</a></span><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Send for Weak&lt;T, A&gt;where
    T: Sync + Send + ?Sized,
    A: Allocator + Send,</pre></section><section id="impl-Sync-for-Weak%3CT,+A%3E" class="impl"><span class="rightside"><span class="since" title="Stable since Rust version 1.4.0">1.4.0</span><a class="src" href="https://doc.rust-lang.org/1.80.0/src/alloc/sync.rs.html#336">source</a></span><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Sync for Weak&lt;T, A&gt;where
    T: Sync + Send + ?Sized,
    A: Allocator + Sync,</pre></section>
</div>
<h3 id="synthetic-implementations" class="section-header">Auto Trait Implementations</h3>
<div id="synthetic-implementations-list">
<section id="impl-Freeze-for-Weak%3CT,+A%3E" class="impl"><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Freeze for Weak&lt;T, A&gt;where
    A: Freeze,
    T: ?Sized,</pre></section><section id="impl-RefUnwindSafe-for-Weak%3CT,+A%3E" class="impl"><pre class="code-header" data-language="rust">impl&lt;T, A&gt; RefUnwindSafe for Weak&lt;T, A&gt;where
    A: RefUnwindSafe,
    T: RefUnwindSafe + ?Sized,</pre></section><section id="impl-Unpin-for-Weak%3CT,+A%3E" class="impl"><pre class="code-header" data-language="rust">impl&lt;T, A&gt; Unpin for Weak&lt;T, A&gt;where
    A: Unpin,
    T: ?Sized,</pre></section><section id="impl-UnwindSafe-for-Weak%3CT,+A%3E" class="impl"><pre class="code-header" data-language="rust">impl&lt;T, A&gt; UnwindSafe for Weak&lt;T, A&gt;where
    A: UnwindSafe,
    T: RefUnwindSafe + ?Sized,</pre></section>
</div>
<h3 id="blanket-implementations" class="section-header">Blanket Implementations</h3>
<div id="blanket-implementations-list">
<summary><section id="impl-Any-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/any.rs.html#140">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; Any for Twhere
    T: 'static + ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.type_id" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/any.rs.html#141">source</a><pre class="code-header" data-language="rust">fn type_id(&amp;self) -&gt; TypeId</pre></section></summary><div class="docblock">Gets the <code>TypeId</code> of <code>self</code>. <a href="../any/trait.any.html#tymethod.type_id">Read more</a>
</div>
</div>
<summary><section id="impl-Borrow%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/borrow.rs.html#208">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; Borrow&lt;T&gt; for Twhere
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.borrow" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/borrow.rs.html#210">source</a><pre class="code-header" data-language="rust">fn borrow(&amp;self) -&gt; &amp;T</pre></section></summary><div class="docblock">Immutably borrows from an owned value. <a href="../borrow/trait.borrow.html#tymethod.borrow">Read more</a>
</div>
</div>
<summary><section id="impl-BorrowMut%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/borrow.rs.html#216">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; BorrowMut&lt;T&gt; for Twhere
    T: ?Sized,</pre></section></summary><div class="impl-items">
<summary><section id="method.borrow_mut" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/borrow.rs.html#217">source</a><pre class="code-header" data-language="rust">fn borrow_mut(&amp;mut self) -&gt; &amp;mut T</pre></section></summary><div class="docblock">Mutably borrows from an owned value. <a href="../borrow/trait.borrowmut.html#tymethod.borrow_mut">Read more</a>
</div>
</div>
<summary><section id="impl-From%3CT%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#765">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; From&lt;T&gt; for T</pre></section></summary><div class="impl-items">
<summary><section id="method.from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#768">source</a><pre class="code-header" data-language="rust">fn from(t: T) -&gt; T</pre></section></summary><div class="docblock">
<p>Returns the argument unchanged.</p> </div>
</div>
<summary><section id="impl-Into%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#748-750">source</a><pre class="code-header" data-language="rust">impl&lt;T, U&gt; Into&lt;U&gt; for Twhere
    U: From&lt;T&gt;,</pre></section></summary><div class="impl-items">
<summary><section id="method.into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#758">source</a><pre class="code-header" data-language="rust">fn into(self) -&gt; U</pre></section></summary><div class="docblock">
<p>Calls <code>U::from(self)</code>.</p> <p>That is, this conversion is whatever the implementation of <code><a href="../convert/trait.from.html" title="trait std::convert::From">From</a>&lt;T&gt; for U</code> chooses to do.</p> </div>
</div>
<summary><section id="impl-ToOwned-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/borrow.rs.html#83-85">source</a><pre class="code-header" data-language="rust">impl&lt;T&gt; ToOwned for Twhere
    T: Clone,</pre></section></summary><div class="impl-items">
<summary><section id="associatedtype.Owned" class="associatedtype trait-impl"><pre class="code-header" data-language="rust">type Owned = T</pre></section></summary><div class="docblock">The resulting type after obtaining ownership.</div>
<summary><section id="method.to_owned" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/borrow.rs.html#88">source</a><pre class="code-header" data-language="rust">fn to_owned(&amp;self) -&gt; T</pre></section></summary><div class="docblock">Creates owned data from borrowed data, usually by cloning. <a href="../borrow/trait.toowned.html#tymethod.to_owned">Read more</a>
</div>
<summary><section id="method.clone_into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/alloc/borrow.rs.html#92">source</a><pre class="code-header" data-language="rust">fn clone_into(&amp;self, target: &amp;mut T)</pre></section></summary><div class="docblock">Uses borrowed data to replace owned data, usually by cloning. <a href="../borrow/trait.toowned.html#method.clone_into">Read more</a>
</div>
</div>
<summary><section id="impl-TryFrom%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#805-807">source</a><pre class="code-header" data-language="rust">impl&lt;T, U&gt; TryFrom&lt;U&gt; for Twhere
    U: Into&lt;T&gt;,</pre></section></summary><div class="impl-items">
<summary><section id="associatedtype.Error-1" class="associatedtype trait-impl"><pre class="code-header" data-language="rust">type Error = Infallible</pre></section></summary><div class="docblock">The type returned in the event of a conversion error.</div>
<summary><section id="method.try_from" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#812">source</a><pre class="code-header" data-language="rust">fn try_from(value: U) -&gt; Result&lt;T, &lt;T as TryFrom&lt;U&gt;&gt;::Error&gt;</pre></section></summary><div class="docblock">Performs the conversion.</div>
</div>
<summary><section id="impl-TryInto%3CU%3E-for-T" class="impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#790-792">source</a><pre class="code-header" data-language="rust">impl&lt;T, U&gt; TryInto&lt;U&gt; for Twhere
    U: TryFrom&lt;T&gt;,</pre></section></summary><div class="impl-items">
<summary><section id="associatedtype.Error" class="associatedtype trait-impl"><pre class="code-header" data-language="rust">type Error = &lt;U as TryFrom&lt;T&gt;&gt;::Error</pre></section></summary><div class="docblock">The type returned in the event of a conversion error.</div>
<summary><section id="method.try_into" class="method trait-impl"><a class="src rightside" href="https://doc.rust-lang.org/1.80.0/src/core/convert/mod.rs.html#797">source</a><pre class="code-header" data-language="rust">fn try_into(self) -&gt; Result&lt;U, &lt;U as TryFrom&lt;T&gt;&gt;::Error&gt;</pre></section></summary><div class="docblock">Performs the conversion.</div>
</div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010 The Rust Project Developers<br>Licensed under the Apache License, Version 2.0 or the MIT license, at your option.<br>
    <a href="https://doc.rust-lang.org/std/sync/struct.Weak.html" class="_attribution-link">https://doc.rust-lang.org/std/sync/struct.Weak.html</a>
  </p>
</div>
