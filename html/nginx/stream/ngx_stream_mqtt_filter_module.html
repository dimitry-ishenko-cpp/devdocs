<h1>Module ngx_stream_mqtt_filter_module</h1>
<ul>
<li><a href="#example">Example Configuration</a></li>
<li><a href="#directives">Directives</a></li>
<li><a href="#mqtt">mqtt</a></li>
<li><a href="#mqtt_buffers">mqtt_buffers</a></li>
<li><a href="#mqtt_rewrite_buffer_size">mqtt_rewrite_buffer_size</a></li>
<li><a href="#mqtt_set_connect">mqtt_set_connect</a></li>
</ul> <p id="summary"> The <code>ngx_stream_mqtt_filter_module</code> module (1.23.4) provides support for Message Queuing Telemetry Transport protocol (MQTT) versions <a href="https://docs.oasis-open.org/mqtt/mqtt/v3.1.1/mqtt-v3.1.1.html">3.1.1</a> and <a href="https://docs.oasis-open.org/mqtt/mqtt/v5.0/mqtt-v5.0.html">5.0</a>. </p>
 <blockquote class="note"> This module is available as part of our <a href="https://www.f5.com/products/nginx">commercial subscription</a>. </blockquote>
 <h4 id="example">Example Configuration</h4>
 <pre data-language="nginx">
listen            127.0.0.1:18883;
proxy_pass        backend;
proxy_buffer_size 16k;

mqtt             on;
mqtt_set_connect clientid "$client";
mqtt_set_connect username "$name";
</pre>
 <h4 id="directives">Directives</h4>
<div class="directive" id="mqtt"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>mqtt</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>mqtt off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>stream</code>, <code>server</code><br> </td> </tr> </table></div>
<p> Enables the MQTT protocol for the given virtual server. </p>
<div class="directive" id="mqtt_buffers">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>mqtt_buffers</strong> <i>number</i> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>mqtt_buffers 100 1k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>stream</code>, <code>server</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.25.1. </p>
</div>
<p> Sets the <code><i>number</i></code> and <code><i>size</i></code> of the buffers used for handling MQTT messages, for a single connection. </p>
<div class="directive" id="mqtt_rewrite_buffer_size"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>mqtt_rewrite_buffer_size</strong> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>mqtt_rewrite_buffer_size 4k|8k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>server</code><br> </td> </tr> </table></div>
 <blockquote class="note"> This directive is obsolete since version 1.25.1. The <a href="#mqtt_buffers">mqtt_buffers</a> directive should be used instead. </blockquote>

<p> Sets the <code><i>size</i></code> of the buffer used for writing a modified message. By default, the buffer size is equal to one memory page. This is either 4K or 8K, depending on a platform. It can be made smaller, however. </p>
<div class="directive" id="mqtt_set_connect"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>mqtt_set_connect</strong> field <i>value</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> â€” </td> </tr> <tr> <th> Context: </th> <td> <code>server</code><br> </td> </tr> </table></div>
<p> Sets the message <code>field</code> to the given <code>value</code> for CONNECT message. The following fields are supported: <code>clientid</code>, <code>username</code>, and <code>password</code>. The value can contain text, variables, and their combination. </p>
<p> Several <code>mqtt_set_connect</code> directives can be specified on the same level: </p> <pre data-language="nginx">
mqtt_set_connect clientid "$client";
mqtt_set_connect username "$name";
</pre>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002-2021 Igor Sysoev<br>&copy; 2011-2024 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/stream/ngx_stream_mqtt_filter_module.html" class="_attribution-link">https://nginx.org/en/docs/stream/ngx_stream_mqtt_filter_module.html</a>
  </p>
</div>
