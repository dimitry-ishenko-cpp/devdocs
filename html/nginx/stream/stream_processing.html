<h1>How nginx processes a TCP/UDP session</h1>
<p> A TCP/UDP session from a client is processed in successive steps called <b>phases</b>: </p> <dl class="compact"> <dt id="postaccept_phase"> <code>Post-accept</code> </dt> <dd> The first phase after accepting a client connection. The <a href="ngx_stream_realip_module.html">ngx_stream_realip_module</a> module is invoked at this phase. </dd> <dt id="preaccess_phase"> <code>Pre-access</code> </dt> <dd> Preliminary check for access. The <a href="ngx_stream_limit_conn_module.html">ngx_stream_limit_conn_module</a> and <a href="ngx_stream_set_module.html">ngx_stream_set_module</a> modules are invoked at this phase. </dd> <dt id="access_phase"> <code>Access</code> </dt> <dd> Client access limitation before actual data processing. At this phase, the <a href="ngx_stream_access_module.html">ngx_stream_access_module</a> module is invoked, for <a href="../njs/index.html">njs</a>, the <a href="ngx_stream_js_module.html#js_access">js_access</a> directive is invoked. </dd> <dt id="ssl_phase"> <code>SSL</code> </dt> <dd> TLS/SSL termination. The <a href="ngx_stream_ssl_module.html">ngx_stream_ssl_module</a> module is invoked at this phase. </dd> <dt id="preread_phase"> <code>Preread</code> </dt> <dd> Reading initial bytes of data into the <a href="ngx_stream_core_module.html#preread_buffer_size">preread buffer</a> to allow modules such as <a href="ngx_stream_ssl_preread_module.html">ngx_stream_ssl_preread_module</a> analyze the data before its processing. For <a href="../njs/index.html">njs</a>, the <a href="ngx_stream_js_module.html#js_preread">js_preread</a> directive is invoked at this phase. </dd> <dt id="content_phase"> <code>Content</code> </dt> <dd> Mandatory phase where data is actually processed, usually <a href="ngx_stream_proxy_module.html">proxied</a> to <a href="ngx_stream_upstream_module.html">upstream</a> servers, or a specified value is <a href="ngx_stream_return_module.html">returned</a> to a client. For <a href="../njs/index.html">njs</a>, the <a href="ngx_stream_js_module.html#js_filter">js_filter</a> directive is invoked at this phase. </dd> <dt id="log_phase"> <code>Log</code> </dt> <dd> The final phase where the result of a client session processing is recorded. The <a href="ngx_stream_log_module.html">ngx_stream_log_module</a> module is invoked at this phase. </dd> </dl>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002-2021 Igor Sysoev<br>&copy; 2011-2024 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/stream/stream_processing.html" class="_attribution-link">https://nginx.org/en/docs/stream/stream_processing.html</a>
  </p>
</div>
