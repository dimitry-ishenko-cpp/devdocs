<h1>Module ngx_http_uwsgi_module</h1>
<ul>
<li><a href="#example">Example Configuration</a></li>
<li><a href="#directives">Directives</a></li>
<li><a href="#uwsgi_bind">uwsgi_bind</a></li>
<li><a href="#uwsgi_buffer_size">uwsgi_buffer_size</a></li>
<li><a href="#uwsgi_buffering">uwsgi_buffering</a></li>
<li><a href="#uwsgi_buffers">uwsgi_buffers</a></li>
<li><a href="#uwsgi_busy_buffers_size">uwsgi_busy_buffers_size</a></li>
<li><a href="#uwsgi_cache">uwsgi_cache</a></li>
<li><a href="#uwsgi_cache_background_update">uwsgi_cache_background_update</a></li>
<li><a href="#uwsgi_cache_bypass">uwsgi_cache_bypass</a></li>
<li><a href="#uwsgi_cache_key">uwsgi_cache_key</a></li>
<li><a href="#uwsgi_cache_lock">uwsgi_cache_lock</a></li>
<li><a href="#uwsgi_cache_lock_age">uwsgi_cache_lock_age</a></li>
<li><a href="#uwsgi_cache_lock_timeout">uwsgi_cache_lock_timeout</a></li>
<li><a href="#uwsgi_cache_max_range_offset">uwsgi_cache_max_range_offset</a></li>
<li><a href="#uwsgi_cache_methods">uwsgi_cache_methods</a></li>
<li><a href="#uwsgi_cache_min_uses">uwsgi_cache_min_uses</a></li>
<li><a href="#uwsgi_cache_path">uwsgi_cache_path</a></li>
<li><a href="#uwsgi_cache_purge">uwsgi_cache_purge</a></li>
<li><a href="#uwsgi_cache_revalidate">uwsgi_cache_revalidate</a></li>
<li><a href="#uwsgi_cache_use_stale">uwsgi_cache_use_stale</a></li>
<li><a href="#uwsgi_cache_valid">uwsgi_cache_valid</a></li>
<li><a href="#uwsgi_connect_timeout">uwsgi_connect_timeout</a></li>
<li><a href="#uwsgi_force_ranges">uwsgi_force_ranges</a></li>
<li><a href="#uwsgi_hide_header">uwsgi_hide_header</a></li>
<li><a href="#uwsgi_ignore_client_abort">uwsgi_ignore_client_abort</a></li>
<li><a href="#uwsgi_ignore_headers">uwsgi_ignore_headers</a></li>
<li><a href="#uwsgi_intercept_errors">uwsgi_intercept_errors</a></li>
<li><a href="#uwsgi_limit_rate">uwsgi_limit_rate</a></li>
<li><a href="#uwsgi_max_temp_file_size">uwsgi_max_temp_file_size</a></li>
<li><a href="#uwsgi_modifier1">uwsgi_modifier1</a></li>
<li><a href="#uwsgi_modifier2">uwsgi_modifier2</a></li>
<li><a href="#uwsgi_next_upstream">uwsgi_next_upstream</a></li>
<li><a href="#uwsgi_next_upstream_timeout">uwsgi_next_upstream_timeout</a></li>
<li><a href="#uwsgi_next_upstream_tries">uwsgi_next_upstream_tries</a></li>
<li><a href="#uwsgi_no_cache">uwsgi_no_cache</a></li>
<li><a href="#uwsgi_param">uwsgi_param</a></li>
<li><a href="#uwsgi_pass">uwsgi_pass</a></li>
<li><a href="#uwsgi_pass_header">uwsgi_pass_header</a></li>
<li><a href="#uwsgi_pass_request_body">uwsgi_pass_request_body</a></li>
<li><a href="#uwsgi_pass_request_headers">uwsgi_pass_request_headers</a></li>
<li><a href="#uwsgi_read_timeout">uwsgi_read_timeout</a></li>
<li><a href="#uwsgi_request_buffering">uwsgi_request_buffering</a></li>
<li><a href="#uwsgi_send_timeout">uwsgi_send_timeout</a></li>
<li><a href="#uwsgi_socket_keepalive">uwsgi_socket_keepalive</a></li>
<li><a href="#uwsgi_ssl_certificate">uwsgi_ssl_certificate</a></li>
<li><a href="#uwsgi_ssl_certificate_key">uwsgi_ssl_certificate_key</a></li>
<li><a href="#uwsgi_ssl_ciphers">uwsgi_ssl_ciphers</a></li>
<li><a href="#uwsgi_ssl_conf_command">uwsgi_ssl_conf_command</a></li>
<li><a href="#uwsgi_ssl_crl">uwsgi_ssl_crl</a></li>
<li><a href="#uwsgi_ssl_name">uwsgi_ssl_name</a></li>
<li><a href="#uwsgi_ssl_password_file">uwsgi_ssl_password_file</a></li>
<li><a href="#uwsgi_ssl_protocols">uwsgi_ssl_protocols</a></li>
<li><a href="#uwsgi_ssl_server_name">uwsgi_ssl_server_name</a></li>
<li><a href="#uwsgi_ssl_session_reuse">uwsgi_ssl_session_reuse</a></li>
<li><a href="#uwsgi_ssl_trusted_certificate">uwsgi_ssl_trusted_certificate</a></li>
<li><a href="#uwsgi_ssl_verify">uwsgi_ssl_verify</a></li>
<li><a href="#uwsgi_ssl_verify_depth">uwsgi_ssl_verify_depth</a></li>
<li><a href="#uwsgi_store">uwsgi_store</a></li>
<li><a href="#uwsgi_store_access">uwsgi_store_access</a></li>
<li><a href="#uwsgi_temp_file_write_size">uwsgi_temp_file_write_size</a></li>
<li><a href="#uwsgi_temp_path">uwsgi_temp_path</a></li>
</ul> <p id="summary"> The <code>ngx_http_uwsgi_module</code> module allows passing requests to a uwsgi server. </p> <h4 id="example">Example Configuration</h4>
 <pre data-language="nginx">
location / {
    include    uwsgi_params;
    uwsgi_pass localhost:9000;
}
</pre>
 <h4 id="directives">Directives</h4>
<div class="directive" id="uwsgi_bind"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_bind</strong> 
    <i>address</i>
    [transparent] |
    off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Makes outgoing connections to a uwsgi server originate from the specified local IP address with an optional port (1.11.2). Parameter value can contain variables (1.3.12). The special value <code>off</code> (1.3.12) cancels the effect of the <code>uwsgi_bind</code> directive inherited from the previous configuration level, which allows the system to auto-assign the local IP address and port. </p>
<p id="uwsgi_bind_transparent"> The <code>transparent</code> parameter (1.11.0) allows outgoing connections to a uwsgi server originate from a non-local IP address, for example, from a real IP address of a client: </p> <pre data-language="nginx">
uwsgi_bind $remote_addr transparent;
</pre>
<p> In order for this parameter to work, it is usually necessary to run nginx worker processes with the <a href="../ngx_core_module.html#user">superuser</a> privileges. On Linux it is not required (1.13.8) as if the <code>transparent</code> parameter is specified, worker processes inherit the <code>CAP_NET_RAW</code> capability from the master process. It is also necessary to configure kernel routing table to intercept network traffic from the uwsgi server. </p>
<div class="directive" id="uwsgi_buffer_size"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_buffer_size</strong> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_buffer_size 4k|8k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the <code><i>size</i></code> of the buffer used for reading the first part of the response received from the uwsgi server. This part usually contains a small response header. By default, the buffer size is equal to one memory page. This is either 4K or 8K, depending on a platform. It can be made smaller, however. </p>
<div class="directive" id="uwsgi_buffering"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_buffering</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_buffering on;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Enables or disables buffering of responses from the uwsgi server. </p>
<p> When buffering is enabled, nginx receives a response from the uwsgi server as soon as possible, saving it into the buffers set by the <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> and <a href="#uwsgi_buffers">uwsgi_buffers</a> directives. If the whole response does not fit into memory, a part of it can be saved to a <a href="#uwsgi_temp_path">temporary file</a> on the disk. Writing to temporary files is controlled by the <a href="#uwsgi_max_temp_file_size">uwsgi_max_temp_file_size</a> and <a href="#uwsgi_temp_file_write_size">uwsgi_temp_file_write_size</a> directives. </p>
<p> When buffering is disabled, the response is passed to a client synchronously, immediately as it is received. nginx will not try to read the whole response from the uwsgi server. The maximum size of the data that nginx can receive from the server at a time is set by the <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> directive. </p>
<p> Buffering can also be enabled or disabled by passing “<code>yes</code>” or “<code>no</code>” in the “X-Accel-Buffering” response header field. This capability can be disabled using the <a href="#uwsgi_ignore_headers">uwsgi_ignore_headers</a> directive. </p>
<div class="directive" id="uwsgi_buffers"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_buffers</strong> <i>number</i> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_buffers 8 4k|8k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the <code><i>number</i></code> and <code><i>size</i></code> of the buffers used for reading a response from the uwsgi server, for a single connection. By default, the buffer size is equal to one memory page. This is either 4K or 8K, depending on a platform. </p>
<div class="directive" id="uwsgi_busy_buffers_size"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_busy_buffers_size</strong> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_busy_buffers_size 8k|16k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> When <a href="#uwsgi_buffering">buffering</a> of responses from the uwsgi server is enabled, limits the total <code><i>size</i></code> of buffers that can be busy sending a response to the client while the response is not yet fully read. In the meantime, the rest of the buffers can be used for reading the response and, if needed, buffering part of the response to a temporary file. By default, <code><i>size</i></code> is limited by the size of two buffers set by the <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> and <a href="#uwsgi_buffers">uwsgi_buffers</a> directives. </p>
<div class="directive" id="uwsgi_cache"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache</strong> <i>zone</i> | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines a shared memory zone used for caching. The same zone can be used in several places. Parameter value can contain variables (1.7.9). The <code>off</code> parameter disables caching inherited from the previous configuration level. </p>
<div class="directive" id="uwsgi_cache_background_update">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_background_update</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_background_update off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.11.10. </p>
</div>
<p> Allows starting a background subrequest to update an expired cache item, while a stale cached response is returned to the client. Note that it is necessary to <a href="#uwsgi_cache_use_stale_updating">allow</a> the usage of a stale cached response when it is being updated. </p>
<div class="directive" id="uwsgi_cache_bypass"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_bypass</strong> <i>string</i> ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines conditions under which the response will not be taken from a cache. If at least one value of the string parameters is not empty and is not equal to “0” then the response will not be taken from the cache: </p> <pre data-language="nginx">
uwsgi_cache_bypass $cookie_nocache $arg_nocache$arg_comment;
uwsgi_cache_bypass $http_pragma    $http_authorization;
</pre>
<p> Can be used along with the <a href="#uwsgi_no_cache">uwsgi_no_cache</a> directive. </p>
<div class="directive" id="uwsgi_cache_key"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_key</strong> <i>string</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines a key for caching, for example </p> <pre data-language="nginx">
uwsgi_cache_key localhost:9000$request_uri;
</pre>

<div class="directive" id="uwsgi_cache_lock">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_lock</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_lock off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.1.12. </p>
</div>
<p> When enabled, only one request at a time will be allowed to populate a new cache element identified according to the <a href="#uwsgi_cache_key">uwsgi_cache_key</a> directive by passing a request to a uwsgi server. Other requests of the same cache element will either wait for a response to appear in the cache or the cache lock for this element to be released, up to the time set by the <a href="#uwsgi_cache_lock_timeout">uwsgi_cache_lock_timeout</a> directive. </p>
<div class="directive" id="uwsgi_cache_lock_age">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_lock_age</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_lock_age 5s;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.8. </p>
</div>
<p> If the last request passed to the uwsgi server for populating a new cache element has not completed for the specified <code><i>time</i></code>, one more request may be passed to the uwsgi server. </p>
<div class="directive" id="uwsgi_cache_lock_timeout">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_lock_timeout</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_lock_timeout 5s;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.1.12. </p>
</div>
<p> Sets a timeout for <a href="#uwsgi_cache_lock">uwsgi_cache_lock</a>. When the <code><i>time</i></code> expires, the request will be passed to the uwsgi server, however, the response will not be cached. </p> <blockquote class="note"> Before 1.7.8, the response could be cached. </blockquote>

<div class="directive" id="uwsgi_cache_max_range_offset">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_max_range_offset</strong> <i>number</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.11.6. </p>
</div>
<p> Sets an offset in bytes for byte-range requests. If the range is beyond the offset, the range request will be passed to the uwsgi server and the response will not be cached. </p>
<div class="directive" id="uwsgi_cache_methods"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_methods</strong> 
    GET |
    HEAD |
    POST
    ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_methods GET HEAD;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> If the client request method is listed in this directive then the response will be cached. “<code>GET</code>” and “<code>HEAD</code>” methods are always added to the list, though it is recommended to specify them explicitly. See also the <a href="#uwsgi_no_cache">uwsgi_no_cache</a> directive. </p>
<div class="directive" id="uwsgi_cache_min_uses"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_min_uses</strong> <i>number</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_min_uses 1;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the <code><i>number</i></code> of requests after which the response will be cached. </p>
<div class="directive" id="uwsgi_cache_path"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_path</strong> 
    <i>path</i>
    [levels=<i>levels</i>]
    [use_temp_path=on|off]
    keys_zone=<i>name</i>:<i>size</i>
    [inactive=<i>time</i>]
    [max_size=<i>size</i>]
    [min_free=<i>size</i>]
    [manager_files=<i>number</i>]
    [manager_sleep=<i>time</i>]
    [manager_threshold=<i>time</i>]
    [loader_files=<i>number</i>]
    [loader_sleep=<i>time</i>]
    [loader_threshold=<i>time</i>]
    [purger=on|off]
    [purger_files=<i>number</i>]
    [purger_sleep=<i>time</i>]
    [purger_threshold=<i>time</i>];</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code><br> </td> </tr> </table></div>
<p> Sets the path and other parameters of a cache. Cache data are stored in files. The file name in a cache is a result of applying the MD5 function to the <a href="#uwsgi_cache_key">cache key</a>. The <code>levels</code> parameter defines hierarchy levels of a cache: from 1 to 3, each level accepts values 1 or 2. For example, in the following configuration </p> <pre data-language="nginx">
uwsgi_cache_path /data/nginx/cache levels=1:2 keys_zone=one:10m;
</pre>
<p> file names in a cache will look like this: </p> <pre data-language="nginx">
/data/nginx/cache/<strong>c</strong>/<strong>29</strong>/b7f54b2df7773722d382f4809d650<strong>29c</strong>
</pre>

<p> A cached response is first written to a temporary file, and then the file is renamed. Starting from version 0.8.9, temporary files and the cache can be put on different file systems. However, be aware that in this case a file is copied across two file systems instead of the cheap renaming operation. It is thus recommended that for any given location both cache and a directory holding temporary files are put on the same file system. A directory for temporary files is set based on the <code>use_temp_path</code> parameter (1.7.10). If this parameter is omitted or set to the value <code>on</code>, the directory set by the <a href="#uwsgi_temp_path">uwsgi_temp_path</a> directive for the given location will be used. If the value is set to <code>off</code>, temporary files will be put directly in the cache directory. </p>
<p> In addition, all active keys and information about data are stored in a shared memory zone, whose <code><i>name</i></code> and <code><i>size</i></code> are configured by the <code>keys_zone</code> parameter. One megabyte zone can store about 8 thousand keys. </p> <blockquote class="note"> As part of <a href="https://www.f5.com/products/nginx">commercial subscription</a>, the shared memory zone also stores extended cache <a href="ngx_http_api_module.html#http_caches_">information</a>, thus, it is required to specify a larger zone size for the same number of keys. For example, one megabyte zone can store about 4 thousand keys. </blockquote>

<p> Cached data that are not accessed during the time specified by the <code>inactive</code> parameter get removed from the cache regardless of their freshness. By default, <code>inactive</code> is set to 10 minutes. </p>
<p id="uwsgi_cache_path_max_size"> The special “cache manager” process monitors the maximum cache size set by the <code>max_size</code> parameter, and the minimum amount of free space set by the <code>min_free</code> (1.19.1) parameter on the file system with cache. When the size is exceeded or there is not enough free space, it removes the least recently used data. The data is removed in iterations configured by <code>manager_files</code>, <code>manager_threshold</code>, and <code>manager_sleep</code> parameters (1.11.5). During one iteration no more than <code>manager_files</code> items are deleted (by default, 100). The duration of one iteration is limited by the <code>manager_threshold</code> parameter (by default, 200 milliseconds). Between iterations, a pause configured by the <code>manager_sleep</code> parameter (by default, 50 milliseconds) is made. </p>
<p> A minute after the start the special “cache loader” process is activated. It loads information about previously cached data stored on file system into a cache zone. The loading is also done in iterations. During one iteration no more than <code>loader_files</code> items are loaded (by default, 100). Besides, the duration of one iteration is limited by the <code>loader_threshold</code> parameter (by default, 200 milliseconds). Between iterations, a pause configured by the <code>loader_sleep</code> parameter (by default, 50 milliseconds) is made. </p>
<p> Additionally, the following parameters are available as part of our <a href="https://www.f5.com/products/nginx">commercial subscription</a>: </p>
 <dl class="compact"> <dt id="purger"> <code>purger</code>=<code>on</code>|<code>off</code> </dt> <dd> Instructs whether cache entries that match a <a href="#uwsgi_cache_purge">wildcard key</a> will be removed from the disk by the cache purger (1.7.12). Setting the parameter to <code>on</code> (default is <code>off</code>) will activate the “cache purger” process that permanently iterates through all cache entries and deletes the entries that match the wildcard key. </dd> <dt id="purger_files"> <code>purger_files</code>=<code><i>number</i></code> </dt> <dd> Sets the number of items that will be scanned during one iteration (1.7.12). By default, <code>purger_files</code> is set to 10. </dd> <dt id="purger_threshold"> <code>purger_threshold</code>=<code><i>number</i></code> </dt> <dd> Sets the duration of one iteration (1.7.12). By default, <code>purger_threshold</code> is set to 50 milliseconds. </dd> <dt id="purger_sleep"> <code>purger_sleep</code>=<code><i>number</i></code> </dt> <dd> Sets a pause between iterations (1.7.12). By default, <code>purger_sleep</code> is set to 50 milliseconds. </dd> </dl>

 <blockquote class="note"> In versions 1.7.3, 1.7.7, and 1.11.10 cache header format has been changed. Previously cached responses will be considered invalid after upgrading to a newer nginx version. </blockquote>

<div class="directive" id="uwsgi_cache_purge">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_purge</strong> string ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.5.7. </p>
</div>
<p> Defines conditions under which the request will be considered a cache purge request. If at least one value of the string parameters is not empty and is not equal to “0” then the cache entry with a corresponding <a href="#uwsgi_cache_key">cache key</a> is removed. The result of successful operation is indicated by returning the 204 (No Content) response. </p>
<p> If the <a href="#uwsgi_cache_key">cache key</a> of a purge request ends with an asterisk (“<code>*</code>”), all cache entries matching the wildcard key will be removed from the cache. However, these entries will remain on the disk until they are deleted for either <a href="#uwsgi_cache_path">inactivity</a>, or processed by the <a href="#purger">cache purger</a> (1.7.12), or a client attempts to access them. </p>
<p> Example configuration: </p> <pre data-language="nginx">
uwsgi_cache_path /data/nginx/cache keys_zone=cache_zone:10m;

map $request_method $purge_method {
    PURGE   1;
    default 0;
}

server {
    ...
    location / {
        uwsgi_pass        backend;
        uwsgi_cache       cache_zone;
        uwsgi_cache_key   $uri;
        uwsgi_cache_purge $purge_method;
    }
}
</pre>
 <blockquote class="note"> This functionality is available as part of our <a href="https://www.f5.com/products/nginx">commercial subscription</a>. </blockquote>

<div class="directive" id="uwsgi_cache_revalidate">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_revalidate</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_revalidate off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.5.7. </p>
</div>
<p> Enables revalidation of expired cache items using conditional requests with the “If-Modified-Since” and “If-None-Match” header fields. </p>
<div class="directive" id="uwsgi_cache_use_stale"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_use_stale</strong> 
    error |
    timeout |
    invalid_header |
    updating |
    http_500 |
    http_503 |
    http_403 |
    http_404 |
    http_429 |
    off
    ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_cache_use_stale off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Determines in which cases a stale cached response can be used when an error occurs during communication with the uwsgi server. The directive’s parameters match the parameters of the <a href="#uwsgi_next_upstream">uwsgi_next_upstream</a> directive. </p>
<p> The <code>error</code> parameter also permits using a stale cached response if a uwsgi server to process a request cannot be selected. </p>
<p id="uwsgi_cache_use_stale_updating"> Additionally, the <code>updating</code> parameter permits using a stale cached response if it is currently being updated. This allows minimizing the number of accesses to uwsgi servers when updating cached data. </p>
<p> Using a stale cached response can also be enabled directly in the response header for a specified number of seconds after the response became stale (1.11.10). This has lower priority than using the directive parameters. </p> <ul> <li> The “<a href="https://datatracker.ietf.org/doc/html/rfc5861#section-3">stale-while-revalidate</a>” extension of the “Cache-Control” header field permits using a stale cached response if it is currently being updated. </li> <li> The “<a href="https://datatracker.ietf.org/doc/html/rfc5861#section-4">stale-if-error</a>” extension of the “Cache-Control” header field permits using a stale cached response in case of an error. </li> </ul>

<p> To minimize the number of accesses to uwsgi servers when populating a new cache element, the <a href="#uwsgi_cache_lock">uwsgi_cache_lock</a> directive can be used. </p>
<div class="directive" id="uwsgi_cache_valid"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_cache_valid</strong> [<i>code</i> ...] <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets caching time for different response codes. For example, the following directives </p> <pre data-language="nginx">
uwsgi_cache_valid 200 302 10m;
uwsgi_cache_valid 404      1m;
</pre>
<p> set 10 minutes of caching for responses with codes 200 and 302 and 1 minute for responses with code 404. </p>
<p> If only caching <code><i>time</i></code> is specified </p> <pre data-language="nginx">
uwsgi_cache_valid 5m;
</pre>
<p> then only 200, 301, and 302 responses are cached. </p>
<p> In addition, the <code>any</code> parameter can be specified to cache any responses: </p> <pre data-language="nginx">
uwsgi_cache_valid 200 302 10m;
uwsgi_cache_valid 301      1h;
uwsgi_cache_valid any      1m;
</pre>

<p> Parameters of caching can also be set directly in the response header. This has higher priority than setting of caching time using the directive. </p> <ul> <li> The “X-Accel-Expires” header field sets caching time of a response in seconds. The zero value disables caching for a response. If the value starts with the <code>@</code> prefix, it sets an absolute time in seconds since Epoch, up to which the response may be cached. </li> <li> If the header does not include the “X-Accel-Expires” field, parameters of caching may be set in the header fields “Expires” or “Cache-Control”. </li> <li> If the header includes the “Set-Cookie” field, such a response will not be cached. </li> <li> If the header includes the “Vary” field with the special value “<code>*</code>”, such a response will not be cached (1.7.7). If the header includes the “Vary” field with another value, such a response will be cached taking into account the corresponding request header fields (1.7.7). </li> </ul>
<p> Processing of one or more of these response header fields can be disabled using the <a href="#uwsgi_ignore_headers">uwsgi_ignore_headers</a> directive. </p>
<div class="directive" id="uwsgi_connect_timeout"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_connect_timeout</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_connect_timeout 60s;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines a timeout for establishing a connection with a uwsgi server. It should be noted that this timeout cannot usually exceed 75 seconds. </p>
<div class="directive" id="uwsgi_force_ranges">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_force_ranges</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_force_ranges off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.7. </p>
</div>
<p> Enables byte-range support for both cached and uncached responses from the uwsgi server regardless of the “Accept-Ranges” field in these responses. </p>
<div class="directive" id="uwsgi_hide_header"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_hide_header</strong> <i>field</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> By default, nginx does not pass the header fields “Status” and “X-Accel-...” from the response of a uwsgi server to a client. The <code>uwsgi_hide_header</code> directive sets additional fields that will not be passed. If, on the contrary, the passing of fields needs to be permitted, the <a href="#uwsgi_pass_header">uwsgi_pass_header</a> directive can be used. </p>
<div class="directive" id="uwsgi_ignore_client_abort"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ignore_client_abort</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ignore_client_abort off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Determines whether the connection with a uwsgi server should be closed when a client closes the connection without waiting for a response. </p>
<div class="directive" id="uwsgi_ignore_headers"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ignore_headers</strong> <i>field</i> ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Disables processing of certain response header fields from the uwsgi server. The following fields can be ignored: “X-Accel-Redirect”, “X-Accel-Expires”, “X-Accel-Limit-Rate” (1.1.6), “X-Accel-Buffering” (1.1.6), “X-Accel-Charset” (1.1.6), “Expires”, “Cache-Control”, “Set-Cookie” (0.8.44), and “Vary” (1.7.7). </p>
<p> If not disabled, processing of these header fields has the following effect: </p> <ul> <li> “X-Accel-Expires”, “Expires”, “Cache-Control”, “Set-Cookie”, and “Vary” set the parameters of response <a href="#uwsgi_cache_valid">caching</a>; </li> <li> “X-Accel-Redirect” performs an <a href="ngx_http_core_module.html#internal">internal redirect</a> to the specified URI; </li> <li> “X-Accel-Limit-Rate” sets the <a href="ngx_http_core_module.html#limit_rate">rate limit</a> for transmission of a response to a client; </li> <li> “X-Accel-Buffering” enables or disables <a href="#uwsgi_buffering">buffering</a> of a response; </li> <li> “X-Accel-Charset” sets the desired <a href="ngx_http_charset_module.html#charset">charset</a> of a response. </li> </ul>

<div class="directive" id="uwsgi_intercept_errors"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_intercept_errors</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_intercept_errors off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Determines whether a uwsgi server responses with codes greater than or equal to 300 should be passed to a client or be intercepted and redirected to nginx for processing with the <a href="ngx_http_core_module.html#error_page">error_page</a> directive. </p>
<div class="directive" id="uwsgi_limit_rate">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_limit_rate</strong> <i>rate</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_limit_rate 0;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.7. </p>
</div>
<p> Limits the speed of reading the response from the uwsgi server. The <code><i>rate</i></code> is specified in bytes per second. The zero value disables rate limiting. The limit is set per a request, and so if nginx simultaneously opens two connections to the uwsgi server, the overall rate will be twice as much as the specified limit. The limitation works only if <a href="#uwsgi_buffering">buffering</a> of responses from the uwsgi server is enabled. Parameter value can contain variables (1.27.0). </p>
<div class="directive" id="uwsgi_max_temp_file_size"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_max_temp_file_size</strong> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_max_temp_file_size 1024m;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> When <a href="#uwsgi_buffering">buffering</a> of responses from the uwsgi server is enabled, and the whole response does not fit into the buffers set by the <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> and <a href="#uwsgi_buffers">uwsgi_buffers</a> directives, a part of the response can be saved to a temporary file. This directive sets the maximum <code><i>size</i></code> of the temporary file. The size of data written to the temporary file at a time is set by the <a href="#uwsgi_temp_file_write_size">uwsgi_temp_file_write_size</a> directive. </p>
<p> The zero value disables buffering of responses to temporary files. </p>
 <blockquote class="note"> This restriction does not apply to responses that will be <a href="#uwsgi_cache">cached</a> or <a href="#uwsgi_store">stored</a> on disk. </blockquote>

<div class="directive" id="uwsgi_modifier1"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_modifier1</strong> <i>number</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_modifier1 0;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the value of the <code>modifier1</code> field in the <a href="http://uwsgi-docs.readthedocs.org/en/latest/Protocol.html#uwsgi-packet-header">uwsgi packet header</a>. </p>
<div class="directive" id="uwsgi_modifier2"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_modifier2</strong> <i>number</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_modifier2 0;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the value of the <code>modifier2</code> field in the <a href="http://uwsgi-docs.readthedocs.org/en/latest/Protocol.html#uwsgi-packet-header">uwsgi packet header</a>. </p>
<div class="directive" id="uwsgi_next_upstream"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_next_upstream</strong> 
    error |
    timeout |
    invalid_header |
    http_500 |
    http_503 |
    http_403 |
    http_404 |
    http_429 |
    non_idempotent |
    off
    ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_next_upstream error timeout;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Specifies in which cases a request should be passed to the next server: </p> <dl class="compact"> <dt><code>error</code></dt> <dd>an error occurred while establishing a connection with the server, passing a request to it, or reading the response header;</dd> <dt><code>timeout</code></dt> <dd>a timeout has occurred while establishing a connection with the server, passing a request to it, or reading the response header;</dd> <dt><code>invalid_header</code></dt> <dd>a server returned an empty or invalid response;</dd> <dt><code>http_500</code></dt> <dd>a server returned a response with the code 500;</dd> <dt><code>http_503</code></dt> <dd>a server returned a response with the code 503;</dd> <dt><code>http_403</code></dt> <dd>a server returned a response with the code 403;</dd> <dt><code>http_404</code></dt> <dd>a server returned a response with the code 404;</dd> <dt><code>http_429</code></dt> <dd>a server returned a response with the code 429 (1.11.13);</dd> <dt id="non_idempotent"><code>non_idempotent</code></dt> <dd>normally, requests with a <a href="https://datatracker.ietf.org/doc/html/rfc7231#section-4.2.2">non-idempotent</a> method (<code>POST</code>, <code>LOCK</code>, <code>PATCH</code>) are not passed to the next server if a request has been sent to an upstream server (1.9.13); enabling this option explicitly allows retrying such requests; </dd> <dt><code>off</code></dt> <dd>disables passing a request to the next server.</dd> </dl>

<p> One should bear in mind that passing a request to the next server is only possible if nothing has been sent to a client yet. That is, if an error or timeout occurs in the middle of the transferring of a response, fixing this is impossible. </p>
<p> The directive also defines what is considered an <a href="ngx_http_upstream_module.html#max_fails">unsuccessful attempt</a> of communication with a server. The cases of <code>error</code>, <code>timeout</code> and <code>invalid_header</code> are always considered unsuccessful attempts, even if they are not specified in the directive. The cases of <code>http_500</code>, <code>http_503</code>, and <code>http_429</code> are considered unsuccessful attempts only if they are specified in the directive. The cases of <code>http_403</code> and <code>http_404</code> are never considered unsuccessful attempts. </p>
<p> Passing a request to the next server can be limited by <a href="#uwsgi_next_upstream_tries">the number of tries</a> and by <a href="#uwsgi_next_upstream_timeout">time</a>. </p>
<div class="directive" id="uwsgi_next_upstream_timeout">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_next_upstream_timeout</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_next_upstream_timeout 0;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.5. </p>
</div>
<p> Limits the time during which a request can be passed to the <a href="#uwsgi_next_upstream">next server</a>. The <code>0</code> value turns off this limitation. </p>
<div class="directive" id="uwsgi_next_upstream_tries">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_next_upstream_tries</strong> <i>number</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_next_upstream_tries 0;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.5. </p>
</div>
<p> Limits the number of possible tries for passing a request to the <a href="#uwsgi_next_upstream">next server</a>. The <code>0</code> value turns off this limitation. </p>
<div class="directive" id="uwsgi_no_cache"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_no_cache</strong> <i>string</i> ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines conditions under which the response will not be saved to a cache. If at least one value of the string parameters is not empty and is not equal to “0” then the response will not be saved: </p> <pre data-language="nginx">
uwsgi_no_cache $cookie_nocache $arg_nocache$arg_comment;
uwsgi_no_cache $http_pragma    $http_authorization;
</pre>
<p> Can be used along with the <a href="#uwsgi_cache_bypass">uwsgi_cache_bypass</a> directive. </p>
<div class="directive" id="uwsgi_param"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_param</strong> 
    <i>parameter</i> <i>value</i>
    [if_not_empty];</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets a <code><i>parameter</i></code> that should be passed to the uwsgi server. The <code><i>value</i></code> can contain text, variables, and their combination. These directives are inherited from the previous configuration level if and only if there are no <code>uwsgi_param</code> directives defined on the current level. </p>
<p> Standard <a href="https://datatracker.ietf.org/doc/html/rfc3875#section-4.1">CGI environment variables</a> should be provided as uwsgi headers, see the <code>uwsgi_params</code> file provided in the distribution: </p> <pre data-language="nginx">
location / {
    include uwsgi_params;
    ...
}
</pre>

<p> If the directive is specified with <code>if_not_empty</code> (1.1.11) then such a parameter will be passed to the server only if its value is not empty: </p> <pre data-language="nginx">
uwsgi_param HTTPS $https if_not_empty;
</pre>

<div class="directive" id="uwsgi_pass"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_pass</strong> [<i>protocol</i>://]<i>address</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>location</code>, <code>if in location</code><br> </td> </tr> </table></div>
<p> Sets the protocol and address of a uwsgi server. As a <code><i>protocol</i></code>, “<code>uwsgi</code>” or “<code>suwsgi</code>” (secured uwsgi, uwsgi over SSL) can be specified. The address can be specified as a domain name or IP address, and a port: </p> <pre data-language="nginx">
uwsgi_pass localhost:9000;
uwsgi_pass uwsgi://localhost:9000;
uwsgi_pass suwsgi://[2001:db8::1]:9090;
</pre>
<p> or as a UNIX-domain socket path: </p> <pre data-language="nginx">
uwsgi_pass unix:/tmp/uwsgi.socket;
</pre>

<p> If a domain name resolves to several addresses, all of them will be used in a round-robin fashion. In addition, an address can be specified as a <a href="ngx_http_upstream_module.html">server group</a>. </p>
<p> Parameter value can contain variables. In this case, if an address is specified as a domain name, the name is searched among the described <a href="ngx_http_upstream_module.html">server groups</a>, and, if not found, is determined using a <a href="ngx_http_core_module.html#resolver">resolver</a>. </p>
 <blockquote class="note"> Secured uwsgi protocol is supported since version 1.5.8. </blockquote>

<div class="directive" id="uwsgi_pass_header"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_pass_header</strong> <i>field</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Permits passing <a href="#uwsgi_hide_header">otherwise disabled</a> header fields from a uwsgi server to a client. </p>
<div class="directive" id="uwsgi_pass_request_body"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_pass_request_body</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_pass_request_body on;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Indicates whether the original request body is passed to the uwsgi server. See also the <a href="#uwsgi_pass_request_headers">uwsgi_pass_request_headers</a> directive. </p>
<div class="directive" id="uwsgi_pass_request_headers"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_pass_request_headers</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_pass_request_headers on;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Indicates whether the header fields of the original request are passed to the uwsgi server. See also the <a href="#uwsgi_pass_request_body">uwsgi_pass_request_body</a> directive. </p>
<div class="directive" id="uwsgi_read_timeout"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_read_timeout</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_read_timeout 60s;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines a timeout for reading a response from the uwsgi server. The timeout is set only between two successive read operations, not for the transmission of the whole response. If the uwsgi server does not transmit anything within this time, the connection is closed. </p>
<div class="directive" id="uwsgi_request_buffering">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_request_buffering</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_request_buffering on;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.11. </p>
</div>
<p> Enables or disables buffering of a client request body. </p>
<p> When buffering is enabled, the entire request body is <a href="ngx_http_core_module.html#client_body_buffer_size">read</a> from the client before sending the request to a uwsgi server. </p>
<p> When buffering is disabled, the request body is sent to the uwsgi server immediately as it is received. In this case, the request cannot be passed to the <a href="#uwsgi_next_upstream">next server</a> if nginx already started sending the request body. </p>
<p> When HTTP/1.1 chunked transfer encoding is used to send the original request body, the request body will be buffered regardless of the directive value. </p>
<div class="directive" id="uwsgi_send_timeout"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_send_timeout</strong> <i>time</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_send_timeout 60s;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets a timeout for transmitting a request to the uwsgi server. The timeout is set only between two successive write operations, not for the transmission of the whole request. If the uwsgi server does not receive anything within this time, the connection is closed. </p>
<div class="directive" id="uwsgi_socket_keepalive">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_socket_keepalive</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_socket_keepalive off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.15.6. </p>
</div>
<p> Configures the “TCP keepalive” behavior for outgoing connections to a uwsgi server. By default, the operating system’s settings are in effect for the socket. If the directive is set to the value “<code>on</code>”, the <code>SO_KEEPALIVE</code> socket option is turned on for the socket. </p>
<div class="directive" id="uwsgi_ssl_certificate">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_certificate</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.8. </p>
</div>
<p> Specifies a <code><i>file</i></code> with the certificate in the PEM format used for authentication to a secured uwsgi server. </p>
<p> Since version 1.21.0, variables can be used in the <code><i>file</i></code> name. </p>
<div class="directive" id="uwsgi_ssl_certificate_key">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_certificate_key</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.8. </p>
</div>
<p> Specifies a <code><i>file</i></code> with the secret key in the PEM format used for authentication to a secured uwsgi server. </p>
<p> The value <code>engine</code>:<code><i>name</i></code>:<code><i>id</i></code> can be specified instead of the <code><i>file</i></code> (1.7.9), which loads a secret key with a specified <code><i>id</i></code> from the OpenSSL engine <code><i>name</i></code>. </p>
<p> Since version 1.21.0, variables can be used in the <code><i>file</i></code> name. </p>
<div class="directive" id="uwsgi_ssl_ciphers">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_ciphers</strong> <i>ciphers</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_ciphers DEFAULT;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.5.8. </p>
</div>
<p> Specifies the enabled ciphers for requests to a secured uwsgi server. The ciphers are specified in the format understood by the OpenSSL library. </p>
<p> The full list can be viewed using the “<code>openssl ciphers</code>” command. </p>
<div class="directive" id="uwsgi_ssl_conf_command">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_conf_command</strong> <i>name</i> <i>value</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.19.4. </p>
</div>
<p> Sets arbitrary OpenSSL configuration <a href="https://www.openssl.org/docs/man1.1.1/man3/SSL_CONF_cmd.html">commands</a> when establishing a connection with the secured uwsgi server. </p> <blockquote class="note"> The directive is supported when using OpenSSL 1.0.2 or higher. </blockquote>

<p> Several <code>uwsgi_ssl_conf_command</code> directives can be specified on the same level. These directives are inherited from the previous configuration level if and only if there are no <code>uwsgi_ssl_conf_command</code> directives defined on the current level. </p>
 <blockquote class="note"> Note that configuring OpenSSL directly might result in unexpected behavior. </blockquote>

<div class="directive" id="uwsgi_ssl_crl">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_crl</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.0. </p>
</div>
<p> Specifies a <code><i>file</i></code> with revoked certificates (CRL) in the PEM format used to <a href="#uwsgi_ssl_verify">verify</a> the certificate of the secured uwsgi server. </p>
<div class="directive" id="uwsgi_ssl_name">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_name</strong> <i>name</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_name host from uwsgi_pass;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.0. </p>
</div>
<p> Allows overriding the server name used to <a href="#uwsgi_ssl_verify">verify</a> the certificate of the secured uwsgi server and to be <a href="#uwsgi_ssl_server_name">passed through SNI</a> when establishing a connection with the secured uwsgi server. </p>
<p> By default, the host part from <a href="#uwsgi_pass">uwsgi_pass</a> is used. </p>
<div class="directive" id="uwsgi_ssl_password_file">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_password_file</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.8. </p>
</div>
<p> Specifies a <code><i>file</i></code> with passphrases for <a href="#uwsgi_ssl_certificate_key">secret keys</a> where each passphrase is specified on a separate line. Passphrases are tried in turn when loading the key. </p>
<div class="directive" id="uwsgi_ssl_protocols">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_protocols</strong> 
    [SSLv2]
    [SSLv3]
    [TLSv1]
    [TLSv1.1]
    [TLSv1.2]
    [TLSv1.3];</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_protocols TLSv1 TLSv1.1 TLSv1.2 TLSv1.3;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.5.8. </p>
</div>
<p> Enables the specified protocols for requests to a secured uwsgi server. </p>
 <blockquote class="note"> The <code>TLSv1.3</code> parameter is used by default since 1.23.4. </blockquote>

<div class="directive" id="uwsgi_ssl_server_name">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_server_name</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_server_name off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.0. </p>
</div>
<p> Enables or disables passing of the server name through <a href="http://en.wikipedia.org/wiki/Server_Name_Indication">TLS Server Name Indication extension</a> (SNI, RFC 6066) when establishing a connection with the secured uwsgi server. </p>
<div class="directive" id="uwsgi_ssl_session_reuse">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_session_reuse</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_session_reuse on;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.5.8. </p>
</div>
<p> Determines whether SSL sessions can be reused when working with a secured uwsgi server. If the errors “<code>SSL3_GET_FINISHED:digest check failed</code>” appear in the logs, try disabling session reuse. </p>
<div class="directive" id="uwsgi_ssl_trusted_certificate">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_trusted_certificate</strong> <i>file</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> — </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.0. </p>
</div>
<p> Specifies a <code><i>file</i></code> with trusted CA certificates in the PEM format used to <a href="#uwsgi_ssl_verify">verify</a> the certificate of the secured uwsgi server. </p>
<div class="directive" id="uwsgi_ssl_verify">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_verify</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_verify off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.0. </p>
</div>
<p> Enables or disables verification of the secured uwsgi server certificate. </p>
<div class="directive" id="uwsgi_ssl_verify_depth">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_ssl_verify_depth</strong> <i>number</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_ssl_verify_depth 1;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.7.0. </p>
</div>
<p> Sets the verification depth in the secured uwsgi server certificates chain. </p>
<div class="directive" id="uwsgi_store"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_store</strong> 
    on |
    off |
    <i>string</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_store off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Enables saving of files to a disk. The <code>on</code> parameter saves files with paths corresponding to the directives <a href="ngx_http_core_module.html#alias">alias</a> or <a href="ngx_http_core_module.html#root">root</a>. The <code>off</code> parameter disables saving of files. In addition, the file name can be set explicitly using the <code><i>string</i></code> with variables: </p> <pre data-language="nginx">
uwsgi_store /data/www$original_uri;
</pre>

<p> The modification time of files is set according to the received “Last-Modified” response header field. The response is first written to a temporary file, and then the file is renamed. Starting from version 0.8.9, temporary files and the persistent store can be put on different file systems. However, be aware that in this case a file is copied across two file systems instead of the cheap renaming operation. It is thus recommended that for any given location both saved files and a directory holding temporary files, set by the <a href="#uwsgi_temp_path">uwsgi_temp_path</a> directive, are put on the same file system. </p>
<p> This directive can be used to create local copies of static unchangeable files, e.g.: </p> <pre data-language="nginx">
location /images/ {
    root               /data/www;
    error_page         404 = /fetch$uri;
}

location /fetch/ {
    internal;

    uwsgi_pass         backend:9000;
    ...

    uwsgi_store        on;
    uwsgi_store_access user:rw group:rw all:r;
    uwsgi_temp_path    /data/temp;

    alias              /data/www/;
}
</pre>

<div class="directive" id="uwsgi_store_access"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_store_access</strong> <i>users</i>:<i>permissions</i> ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_store_access user:rw;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets access permissions for newly created files and directories, e.g.: </p> <pre data-language="nginx">
uwsgi_store_access user:rw group:rw all:r;
</pre>

<p> If any <code>group</code> or <code>all</code> access permissions are specified then <code>user</code> permissions may be omitted: </p> <pre data-language="nginx">
uwsgi_store_access group:rw all:r;
</pre>

<div class="directive" id="uwsgi_temp_file_write_size"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_temp_file_write_size</strong> <i>size</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_temp_file_write_size 8k|16k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Limits the <code><i>size</i></code> of data written to a temporary file at a time, when buffering of responses from the uwsgi server to temporary files is enabled. By default, <code><i>size</i></code> is limited by two buffers set by the <a href="#uwsgi_buffer_size">uwsgi_buffer_size</a> and <a href="#uwsgi_buffers">uwsgi_buffers</a> directives. The maximum size of a temporary file is set by the <a href="#uwsgi_max_temp_file_size">uwsgi_max_temp_file_size</a> directive. </p>
<div class="directive" id="uwsgi_temp_path"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>uwsgi_temp_path</strong> 
    <i>path</i>
    [<i>level1</i>
    [<i>level2</i>
    [<i>level3</i>]]];</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>uwsgi_temp_path uwsgi_temp;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Defines a directory for storing temporary files with data received from uwsgi servers. Up to three-level subdirectory hierarchy can be used underneath the specified directory. For example, in the following configuration </p> <pre data-language="nginx">
uwsgi_temp_path /spool/nginx/uwsgi_temp 1 2;
</pre>
<p> a temporary file might look like this: </p> <pre data-language="nginx">
/spool/nginx/uwsgi_temp/<strong>7</strong>/<strong>45</strong>/00000123<strong>457</strong>
</pre>

<p> See also the <code>use_temp_path</code> parameter of the <a href="#uwsgi_cache_path">uwsgi_cache_path</a> directive. </p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002-2021 Igor Sysoev<br>&copy; 2011-2024 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/http/ngx_http_uwsgi_module.html" class="_attribution-link">https://nginx.org/en/docs/http/ngx_http_uwsgi_module.html</a>
  </p>
</div>
