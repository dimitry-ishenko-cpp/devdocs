<h1>Module ngx_http_ssi_module</h1>
<ul>
<li><a href="#example">Example Configuration</a></li>
<li><a href="#directives">Directives</a></li>
<li><a href="#ssi">ssi</a></li>
<li><a href="#ssi_last_modified">ssi_last_modified</a></li>
<li><a href="#ssi_min_file_chunk">ssi_min_file_chunk</a></li>
<li><a href="#ssi_silent_errors">ssi_silent_errors</a></li>
<li><a href="#ssi_types">ssi_types</a></li>
<li><a href="#ssi_value_length">ssi_value_length</a></li>
<li><a href="#commands">SSI Commands</a></li>
<li><a href="#variables">Embedded Variables</a></li>
</ul> <p id="summary"> The <code>ngx_http_ssi_module</code> module is a filter that processes SSI (Server Side Includes) commands in responses passing through it. Currently, the list of supported SSI commands is incomplete. </p> <h4 id="example">Example Configuration</h4>
 <pre data-language="nginx">
location / {
    ssi on;
    ...
}
</pre>
 <h4 id="directives">Directives</h4>
<div class="directive" id="ssi"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssi</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssi off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code>, <code>if in location</code><br> </td> </tr> </table></div>
<p> Enables or disables processing of SSI commands in responses. </p>
<div class="directive" id="ssi_last_modified">
<table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssi_last_modified</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssi_last_modified off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table>
<p>This directive appeared in version 1.5.1. </p>
</div>
<p> Allows preserving the “Last-Modified” header field from the original response during SSI processing to facilitate response caching. </p>
<p> By default, the header field is removed as contents of the response are modified during processing and may contain dynamically generated elements or parts that are changed independently of the original response. </p>
<div class="directive" id="ssi_min_file_chunk"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssi_min_file_chunk</strong> size;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssi_min_file_chunk 1k;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the minimum <code><i>size</i></code> for parts of a response stored on disk, starting from which it makes sense to send them using <a href="ngx_http_core_module.html#sendfile">sendfile</a>. </p>
<div class="directive" id="ssi_silent_errors"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssi_silent_errors</strong> on | off;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssi_silent_errors off;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> If enabled, suppresses the output of the “<code>[an error occurred while processing the directive]</code>” string if an error occurred during SSI processing. </p>
<div class="directive" id="ssi_types"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssi_types</strong> <i>mime-type</i> ...;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssi_types text/html;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Enables processing of SSI commands in responses with the specified MIME types in addition to “<code>text/html</code>”. The special value “<code>*</code>” matches any MIME type (0.8.29). </p>
<div class="directive" id="ssi_value_length"><table cellspacing="0"> <tr> <th> Syntax: </th> <td> <code><strong>ssi_value_length</strong> <i>length</i>;</code><br> </td> </tr> <tr> <th> Default: </th> <td> <code>ssi_value_length 256;</code> </td> </tr> <tr> <th> Context: </th> <td> <code>http</code>, <code>server</code>, <code>location</code><br> </td> </tr> </table></div>
<p> Sets the maximum length of parameter values in SSI commands. </p> <h4 id="commands">SSI Commands</h4>
<p> SSI commands have the following generic format: </p> <pre data-language="nginx">
&lt;!--# command parameter1=value1 parameter2=value2 ... --&gt;
</pre>

<p> The following commands are supported: </p> <dl class="compact"> <dt><code>block</code></dt> <dd> Defines a block that can be used as a stub in the <code>include</code> command. The block can contain other SSI commands. The command has the following parameter: <dl class="compact"> <dt><code>name</code></dt> <dd> block name. </dd> </dl> Example: <pre data-language="nginx">
&lt;!--# block name="one" --&gt;
stub
&lt;!--# endblock --&gt;
</pre> </dd> <dt><code>config</code></dt> <dd> Sets some parameters used during SSI processing, namely: <dl class="compact"> <dt><code>errmsg</code></dt> <dd> a string that is output if an error occurs during SSI processing. By default, the following string is output: <pre data-language="nginx">
[an error occurred while processing the directive]
</pre> </dd> <dt><code>timefmt</code></dt> <dd> a format string passed to the <code>strftime()</code> function used to output date and time. By default, the following format is used: <pre data-language="nginx">
"%A, %d-%b-%Y %H:%M:%S %Z"
</pre> The “<code>%s</code>” format is suitable to output time in seconds. </dd> </dl> </dd> <dt><code>echo</code></dt> <dd> Outputs the value of a variable. The command has the following parameters: <dl class="compact"> <dt><code>var</code></dt> <dd> the variable name. </dd> <dt><code>encoding</code></dt> <dd> the encoding method. Possible values include <code>none</code>, <code>url</code>, and <code>entity</code>. By default, <code>entity</code> is used. </dd> <dt><code>default</code></dt> <dd> a non-standard parameter that sets a string to be output if a variable is undefined. By default, “<code>(none)</code>” is output. The command <pre data-language="nginx">
&lt;!--# echo var="name" default="<strong>no</strong>" --&gt;
</pre> replaces the following sequence of commands: <pre data-language="nginx">
&lt;!--# if expr="$name" --&gt;&lt;!--# echo var="name" --&gt;&lt;!--#
       else --&gt;<strong>no</strong>&lt;!--# endif --&gt;
</pre> </dd> </dl> </dd> <dt><code>if</code></dt> <dd> Performs a conditional inclusion. The following commands are supported: <pre data-language="nginx">
&lt;!--# if expr="..." --&gt;
...
&lt;!--# elif expr="..." --&gt;
...
&lt;!--# else --&gt;
...
&lt;!--# endif --&gt;
</pre> Only one level of nesting is currently supported. The command has the following parameter: <dl class="compact"> <dt><code>expr</code></dt> <dd> expression. An expression can be: <ul class="compact"> <li> variable existence check: <pre data-language="nginx">
&lt;!--# if expr="$name" --&gt;
</pre> </li> <li> comparison of a variable with a text: <pre data-language="nginx">
&lt;!--# if expr="$name = <code><i>text</i></code>" --&gt;
&lt;!--# if expr="$name != <code><i>text</i></code>" --&gt;
</pre> </li> <li> comparison of a variable with a regular expression: <pre data-language="nginx">
&lt;!--# if expr="$name = /<code><i>text</i></code>/" --&gt;
&lt;!--# if expr="$name != /<code><i>text</i></code>/" --&gt;
</pre> </li> </ul> If a <code><i>text</i></code> contains variables, their values are substituted. A regular expression can contain positional and named captures that can later be used through variables, for example: <pre data-language="nginx">
&lt;!--# if expr="$name = /(.+)@(?P&lt;domain&gt;.+)/" --&gt;
    &lt;!--# echo var="1" --&gt;
    &lt;!--# echo var="domain" --&gt;
&lt;!--# endif --&gt;
</pre> </dd> </dl> </dd> <dt><code>include</code></dt> <dd> Includes the result of another request into a response. The command has the following parameters: <dl class="compact"> <dt><code>file</code></dt> <dd> specifies an included file, for example: <pre data-language="nginx">
&lt;!--# include file="footer.html" --&gt;
</pre> </dd> <dt><code>virtual</code></dt> <dd> specifies an included request, for example: <pre data-language="nginx">
&lt;!--# include virtual="/remote/body.php?argument=value" --&gt;
</pre> Several requests specified on one page and processed by proxied or FastCGI/uwsgi/SCGI/gRPC servers run in parallel. If sequential processing is desired, the <code>wait</code> parameter should be used. </dd> <dt><code>stub</code></dt> <dd> a non-standard parameter that names the block whose content will be output if the included request results in an empty body or if an error occurs during the request processing, for example: <pre data-language="nginx">
&lt;!--# block name="one" --&gt;&amp;nbsp;&lt;!--# endblock --&gt;
&lt;!--# include virtual="/remote/body.php?argument=value" stub="one" --&gt;
</pre> The replacement block content is processed in the included request context. </dd> <dt><code>wait</code></dt> <dd> a non-standard parameter that instructs to wait for a request to fully complete before continuing with SSI processing, for example: <pre data-language="nginx">
&lt;!--# include virtual="/remote/body.php?argument=value" wait="yes" --&gt;
</pre> </dd> <dt id="ssi_include_set"><code>set</code></dt> <dd> a non-standard parameter that instructs to write a successful result of request processing to the specified variable, for example: <pre data-language="nginx">
&lt;!--# include virtual="/remote/body.php?argument=value" set="one" --&gt;
</pre> The maximum size of the response is set by the <a href="ngx_http_core_module.html#subrequest_output_buffer_size">subrequest_output_buffer_size</a> directive (1.13.10): <pre data-language="nginx">
location /remote/ {
    subrequest_output_buffer_size 64k;
    ...
}
</pre> Prior to version 1.13.10, only the results of responses obtained using the <a href="ngx_http_proxy_module.html">ngx_http_proxy_module</a>, <a href="ngx_http_memcached_module.html">ngx_http_memcached_module</a>, <a href="ngx_http_fastcgi_module.html">ngx_http_fastcgi_module</a> (1.5.6), <a href="ngx_http_uwsgi_module.html">ngx_http_uwsgi_module</a> (1.5.6), and <a href="ngx_http_scgi_module.html">ngx_http_scgi_module</a> (1.5.6) modules could be written into variables. The maximum size of the response was set with the <a href="ngx_http_proxy_module.html#proxy_buffer_size">proxy_buffer_size</a>, <a href="ngx_http_memcached_module.html#memcached_buffer_size">memcached_buffer_size</a>, <a href="ngx_http_fastcgi_module.html#fastcgi_buffer_size">fastcgi_buffer_size</a>, <a href="ngx_http_uwsgi_module.html#uwsgi_buffer_size">uwsgi_buffer_size</a>, and <a href="ngx_http_scgi_module.html#scgi_buffer_size">scgi_buffer_size</a> directives. </dd> </dl> </dd> <dt><code>set</code></dt> <dd> Sets a value of a variable. The command has the following parameters: <dl class="compact"> <dt><code>var</code></dt> <dd> the variable name. </dd> <dt><code>value</code></dt> <dd> the variable value. If an assigned value contains variables, their values are substituted. </dd> </dl> </dd> </dl>
 <h4 id="variables">Embedded Variables</h4>
<p> The <code>ngx_http_ssi_module</code> module supports two embedded variables: </p> <dl class="compact"> <dt id="var_date_local"><code>$date_local</code></dt> <dd> current time in the local time zone. The format is set by the <code>config</code> command with the <code>timefmt</code> parameter. </dd> <dt id="var_date_gmt"><code>$date_gmt</code></dt> <dd> current time in GMT. The format is set by the <code>config</code> command with the <code>timefmt</code> parameter. </dd> </dl>
<div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002-2021 Igor Sysoev<br>&copy; 2011-2023 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/http/ngx_http_ssi_module.html" class="_attribution-link">https://nginx.org/en/docs/http/ngx_http_ssi_module.html</a>
  </p>
</div>
