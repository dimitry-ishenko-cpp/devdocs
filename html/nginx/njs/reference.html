<h1>Reference</h1>
<ul>
<li><a href="#http_stream">nginx objects</a></li>
<li><a href="#http">HTTP Request</a></li>
<li><a href="#stream">Stream Session</a></li>
<li><a href="#periodic_session">Periodic Session</a></li>
<li><a href="#headers">Headers</a></li>
<li><a href="#request">Request</a></li>
<li><a href="#response">Response</a></li>
<li><a href="#ngx">ngx</a></li>
<li><a href="#ngx_shared">ngx.shared</a></li>
<li><a href="#builtin_objects">built-in objects</a></li>
<li><a href="#console">console</a></li>
<li><a href="#builtin_crypto">crypto</a></li>
<li><a href="#cryptokey">CryptoKey</a></li>
<li><a href="#cryptokeypair">CryptoKeyPair</a></li>
<li><a href="#njs">njs</a></li>
<li><a href="#process">process</a></li>
<li><a href="#string">String</a></li>
<li><a href="#webapi">web API</a></li>
<li><a href="#textdecoder">Text Decoder</a></li>
<li><a href="#textencoder">Text Encoder</a></li>
<li><a href="#njs_api_timers">timers</a></li>
<li><a href="#njs_global_functions">Global functions</a></li>
<li><a href="#builtin_modules">built-in modules</a></li>
<li><a href="#buffer">Buffer</a></li>
<li><a href="#crypto">Crypto</a></li>
<li><a href="#njs_api_fs">File System</a></li>
<li><a href="#querystring">Query String</a></li>
<li><a href="#xml">XML</a></li>
<li><a href="#zlib">zlib</a></li>
</ul>
<p id="summary"> <a href="index.html">njs</a> provides objects, methods and properties for extending nginx functionality. </p>
<p> This reference contains only njs specific properties, methods and modules not compliant with ECMAScript. Definitions of njs properties and methods compliant with ECMAScript can be found in <a href="http://www.ecma-international.org/ecma-262/">ECMAScript specification</a>. List of all njs properties and methods can be found in <a href="compatibility.html">Compatibility</a>. </p>
<h4 id="http_stream">nginx objects</h4>
<h4 id="http">HTTP Request</h4>

<table width="100%"> <tr><td><a href="#r_args"><code>r.args{}</code></a></td></tr> <tr><td><a href="#r_done"><code>r.done()</code></a></td></tr> <tr><td><a href="#r_error"><code>r.error()</code></a></td></tr> <tr><td><a href="#r_finish"><code>r.finish()</code></a></td></tr> <tr><td><a href="#r_headers_in"><code>r.headersIn{}</code></a></td></tr> <tr><td><a href="#r_headers_out"><code>r.headersOut{}</code></a></td></tr> <tr><td><a href="#r_http_version"><code>r.httpVersion</code></a></td></tr> <tr><td><a href="#r_internal"><code>r.internal</code></a></td></tr> <tr><td><a href="#r_internal_redirect"><code>r.internalRedirect()</code></a></td></tr> <tr><td><a href="#r_log"><code>r.log()</code></a></td></tr> <tr><td><a href="#r_method"><code>r.method</code></a></td></tr> <tr><td><a href="#r_parent"><code>r.parent</code></a></td></tr> <tr><td><a href="#r_remote_address"><code>r.remoteAddress</code></a></td></tr> <tr><td><a href="#r_request_body"><code>r.requestBody</code></a></td></tr> <tr><td><a href="#r_request_buffer"><code>r.requestBuffer</code></a></td></tr> <tr><td><a href="#r_request_text"><code>r.requestText</code></a></td></tr> <tr><td><a href="#r_raw_headers_in"><code>r.rawHeadersIn[]</code></a></td></tr> <tr><td><a href="#r_raw_headers_out"><code>r.rawHeadersOut[]</code></a></td></tr> <tr><td><a href="#r_response_body"><code>r.responseBody</code></a></td></tr> <tr><td><a href="#r_response_buffer"><code>r.responseBuffer</code></a></td></tr> <tr><td><a href="#r_response_text"><code>r.responseText</code></a></td></tr> <tr><td><a href="#r_return"><code>r.return()</code></a></td></tr> <tr><td><a href="#r_send"><code>r.send()</code></a></td></tr> <tr><td><a href="#r_sendbuffer"><code>r.sendBuffer()</code></a></td></tr> <tr><td><a href="#r_send_header"><code>r.sendHeader()</code></a></td></tr> <tr><td><a href="#r_set_return_value"><code>r.setReturnValue()</code></a></td></tr> <tr><td><a href="#r_status"><code>r.status</code></a></td></tr> <tr><td><a href="#r_subrequest"><code>r.subrequest()</code></a></td></tr> <tr><td><a href="#r_uri"><code>r.uri</code></a></td></tr> <tr><td><a href="#r_raw_variables"><code>r.rawVariables{}</code></a></td></tr> <tr><td><a href="#r_variables"><code>r.variables{}</code></a></td></tr> <tr><td><a href="#r_warn"><code>r.warn()</code></a></td></tr> </table> <p> The HTTP request object is available only in the <a href="../http/ngx_http_js_module.html">ngx_http_js_module</a> module. Before <a href="changes.html#njs0.8.5">0.8.5</a>, all string properties of the object were <a href="#string">byte strings</a>. </p> <dl class="compact"> <dt id="r_args"><code>r.args{}</code></dt> <dd> request arguments object, read-only. <p> The query string is returned as an object. Since <a href="changes.html#njs0.7.6">0.7.6</a>, duplicate keys are returned as an array, keys are case-sensitive, both keys and values are percent-decoded. </p> <p> For example, the query string </p> <pre data-language="nginx">
'a=1&amp;b=%32&amp;A=3&amp;b=4&amp;B=two%20words'
</pre>
<p> is converted to <code>r.args</code> as: </p> <pre data-language="nginx">
{a: "1", b: ["2", "4"], A: "3", B: "two words"}
</pre>
<p> More advanced parsing scenarios can be achieved with the <a href="#querystring">Query String</a> module and with the <a href="../http/ngx_http_core_module.html#var_args"><code>$args</code></a> variable, for example: </p> <pre data-language="nginx">
import qs from 'querystring';

function args(r) {
    return qs.parse(r.variables.args);
}
</pre>
<p> The argument object is evaluated at the first access to <code>r.args</code>. If only a single argument is needed, for example <code>foo</code>, <a href="https://nginx.org/en/docs/varindex.html">nginx variables</a> can be used: </p> <pre data-language="nginx">
r.variables.arg_foo
</pre>
<p> Here, <a href="#r_variables">nginx variables object</a> returns the first value for a given key, case-insensitive, without percent-decoding. </p> <p> To convert <code>r.args</code> back to a string, the Query String <a href="#querystring_stringify"><code>stringify</code></a> method can be used. </p> </dd> <dt id="r_done"><code>r.done()</code></dt> <dd> after calling this function, next data chunks will be passed to client without calling <a href="../http/ngx_http_js_module.html#js_body_filter">js_body_filter</a> (<a href="changes.html#njs0.5.2">0.5.2</a>). May be called only from the <a href="../http/ngx_http_js_module.html#js_body_filter">js_body_filter</a> function </dd> <dt id="r_error"><code>r.error(<i>string</i>)</code></dt> <dd> writes a <code>string</code> to the error log on the <code>error</code> level of logging  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> <dt id="r_finish"><code>r.finish()</code></dt> <dd> finishes sending a response to the client </dd> <dt id="r_headers_in"><code>r.headersIn{}</code></dt> <dd> incoming headers object, read-only. <p> The <code>Foo</code> request header can be accessed with the syntax: <code>headersIn.foo</code> or <code>headersIn['Foo']</code>. </p> <p> The “Authorization”, “Content-Length”, “Content-Range”, “Content-Type”, “ETag”, “Expect”, “From”, “Host”, “If-Match”, “If-Modified-Since”, “If-None-Match”, “If-Range”, “If-Unmodified-Since”, “Max-Forwards”, “Proxy-Authorization”, “Referer”, “Transfer-Encoding”, and “User-Agent” request headers can have only one field value (<a href="changes.html#njs0.4.1">0.4.1</a>). Duplicate field values in “Cookie” headers are separated by semicolon (<code>;</code>). Duplicate field values in all other request headers are separated by commas. </p> </dd> <dt id="r_headers_out"><code>r.headersOut{}</code></dt> <dd> outgoing headers object for the main request, writable. <p> If <code>r.headersOut{}</code> is the response object of a <a href="#r_subrequest">subrequest</a>, it represents response headers. In this case, field values in “Accept-Ranges”, “Connection”, “Content-Disposition”, “Content-Encoding”, “Content-Length”, “Content-Range”, “Date”, “Keep-Alive”, “Server”, “Transfer-Encoding”, “X-Accel-*” response headers may be omitted. </p> <p> The “Foo” response header can be accessed with the syntax: <code>headersOut.foo</code> or <code>headersOut['Foo']</code>. </p> <p> Outgoing headers should be set before a response header is sent to a client, otherwise header update will be ignored. This means that <code>r.headersOut{}</code> is effectively writable in: </p> <ul class="compact"> <li> the <a href="../http/ngx_http_js_module.html#js_content">js_content</a> handler before <a href="#r_send_header"><code>r.sendHeader()</code></a> or <a href="#r_return"><code>r.return()</code></a> are called </li> <li> the <a href="../http/ngx_http_js_module.html#js_header_filter">js_header_filter</a> handler </li> </ul>
 <p> Field values of multi-value response headers (<a href="changes.html#njs0.4.0">0.4.0</a>) can be set with the syntax: </p> <pre data-language="nginx">
r.headersOut['Foo'] = ['a', 'b']
</pre>
<p> where the output will be: </p> <pre data-language="nginx">
Foo: a
Foo: b
</pre>
<p> All previous field values of the “Foo” response header will be deleted. </p> <p> For standard response headers that accept only a single field value such as “Content-Type”, only the last element of the array will take effect. Field values of the “Set-Cookie” response header are always returned as an array. Duplicate field values in “Age”, “Content-Encoding”, “Content-Length”, “Content-Type”, “ETag”, “Expires”, “Last-Modified”, “Location”, “Retry-After” response headers are ignored. Duplicate field values in all other response headers are separated by commas. </p> </dd> <dt id="r_http_version"><code>r.httpVersion</code></dt> <dd> HTTP version, read-only </dd> <dt id="r_internal"><code>r.internal</code></dt> <dd> boolean value, true for <a href="../http/ngx_http_core_module.html#internal">internal</a> locations </dd> <dt id="r_internal_redirect"><code>r.internalRedirect(<i>uri</i>)</code></dt> <dd> performs an <a href="../dev/development_guide.html#http_request_redirection">internal redirect</a> to the specified <code>uri</code>. If the uri starts with the “<code>@</code>” prefix, it is considered a named location. In a new location, all request processing is repeated starting from <a href="../dev/development_guide.html#http_phases">NGX_HTTP_SERVER_REWRITE_PHASE</a> for ordinary locations and from <a href="../dev/development_guide.html#http_phases">NGX_HTTP_REWRITE_PHASE</a> for named locations. As a result, a redirect to a named location does not check <a href="../http/ngx_http_core_module.html#client_max_body_size">client_max_body_size</a> limit. See <a href="../dev/development_guide.html#http_request_redirection">dev guide</a> for more details. Redirected requests become internal and can access the <a href="../http/ngx_http_core_module.html#internal">internal</a> locations. The actual redirect happens after the handler execution is completed.  <blockquote class="note"> After redirect, a new njs VM is started in the target location, the VM in the original location is stopped. Values of <a href="https://nginx.org/en/docs/varindex.html">nginx variables</a> are kept and can be used to pass information to the target location. Since <a href="changes.html#njs0.5.3">0.5.3</a>, the variable declared with the <code>js_var</code> directive for <a href="../http/ngx_http_js_module.html#js_var">http</a> or <a href="../stream/ngx_stream_js_module.html#js_var">stream</a> can be used. </blockquote>
  <blockquote class="note"> Since <a href="changes.html#njs0.7.4">0.7.4</a>, the method accepts escaped URIs. </blockquote>
 </dd> <dt id="r_log"><code>r.log(<i>string</i>)</code></dt> <dd> writes a <code>string</code> to the error log on the <code>info</code> level of logging  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> <dt id="r_method"><code>r.method</code></dt> <dd> HTTP method, read-only </dd> <dt id="r_parent"><code>r.parent</code></dt> <dd> references the parent request object </dd> <dt id="r_remote_address"><code>r.remoteAddress</code></dt> <dd> client address, read-only </dd> <dt id="r_request_body"><code>r.requestBody</code></dt> <dd> the property was made obsolete in <a href="changes.html#njs0.5.0">0.5.0</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. The <a href="#r_request_buffer"><code>r.requestBuffer</code></a> or <a href="#r_request_text"><code>r.requestText</code></a> property should be used instead. </dd> <dt id="r_request_buffer"><code>r.requestBuffer</code></dt> <dd> client request body if it has not been written to a temporary file (since <a href="changes.html#njs0.5.0">0.5.0</a>). To ensure that the client request body is in memory, its size should be limited by <a href="../http/ngx_http_core_module.html#client_max_body_size">client_max_body_size</a>, and a sufficient buffer size should be set using <a href="../http/ngx_http_core_module.html#client_body_buffer_size">client_body_buffer_size</a>. The property is available only in the <a href="../http/ngx_http_js_module.html#js_content">js_content</a> directive. </dd> <dt id="r_request_text"><code>r.requestText</code></dt> <dd> the same as <a href="#r_request_buffer"><code>r.requestBuffer</code></a>, but returns a <code>string</code>. Note that it may convert bytes invalid in UTF-8 encoding into the replacement character. </dd> <dt id="r_raw_headers_in"><code>r.rawHeadersIn[]</code></dt> <dd> returns an array of key-value pairs exactly as they were received from the client (<a href="changes.html#njs0.4.1">0.4.1</a>). <p> For example, with the following request headers: </p> <pre data-language="nginx">
Host: localhost
Foo:  bar
foo:  bar2
</pre>
<p> the output of <code>r.rawHeadersIn</code> will be: </p> <pre data-language="nginx">
[
    ['Host', 'localhost'],
    ['Foo', 'bar'],
    ['foo', 'bar2']
]
</pre>
<p> All <code>foo</code> headers can be collected with the syntax: </p> <pre data-language="nginx">
r.rawHeadersIn.filter(v=&gt;v[0].toLowerCase() == 'foo').map(v=&gt;v[1])
</pre>
<p> the output will be: </p> <pre data-language="nginx">
['bar', 'bar2']
</pre>
<p> Header field names are not converted to lower case, duplicate field values are not merged. </p> </dd> <dt id="r_raw_headers_out"><code>r.rawHeadersOut[]</code></dt> <dd> returns an array of key-value pairs of response headers (<a href="changes.html#njs0.4.1">0.4.1</a>). Header field names are not converted to lower case, duplicate field values are not merged. </dd> <dt id="r_response_body"><code>r.responseBody</code></dt> <dd> the property was made obsolete in <a href="changes.html#njs0.5.0">0.5.0</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. The <a href="#r_response_buffer"><code>r.responseBuffer</code></a> or the <a href="#r_response_text"><code>r.responseText</code></a> property should be used instead. </dd> <dt id="r_response_buffer"><code>r.responseBuffer</code></dt> <dd> holds the <a href="#r_subrequest">subrequest</a> response body, read-only (since <a href="changes.html#njs0.5.0">0.5.0</a>). The size of <code>r.responseBuffer</code> is limited by the <a href="../http/ngx_http_core_module.html#subrequest_output_buffer_size">subrequest_output_buffer_size</a> directive. </dd> <dt id="r_response_text"><code>r.responseText</code></dt> <dd> the same as <a href="#r_response_buffer"><code>r.responseBuffer</code></a> but returns a string (since <a href="changes.html#njs0.5.0">0.5.0</a>). Note that it may convert bytes invalid in UTF-8 encoding into the replacement character. </dd> <dt id="r_return"><code>r.return(status[,
string | Buffer])</code></dt> <dd> sends the entire response with the specified <code>status</code> to the client. The response can be a string or Buffer (<a href="changes.html#njs0.5.0">0.5.0</a>). <p> It is possible to specify either a redirect URL (for codes 301, 302, 303, 307, and 308) or the response body text (for other codes) as the second argument </p> </dd> <dt id="r_send"><code>r.send(string
| Buffer)</code></dt> <dd> sends a part of the response body to the client. The data sent can be a string or Buffer (<a href="changes.html#njs0.5.0">0.5.0</a>) </dd> <dt id="r_sendbuffer"><code>r.sendBuffer(<i>data</i>[,
<i>options</i>])</code></dt> <dd> adds data to the chain of data chunks to be forwarded to the next body filter (<a href="changes.html#njs0.5.2">0.5.2</a>). The actual forwarding happens later, when the all the data chunks of the current chain are processed. <p> The data can be a string or Buffer. The <code>options</code> is an object used to override nginx buffer flags derived from an incoming data chunk buffer. The flags can be overridden with the following flags: </p> <dl class="compact"> <dt><code>last</code></dt> <dd> boolean, true if the buffer is the last buffer </dd> <dt><code>flush</code></dt> <dd> boolean, true if the buffer should have the <code>flush</code> flag </dd> </dl>
 The method may be called only from the <a href="../http/ngx_http_js_module.html#js_body_filter">js_body_filter</a> function. </dd> <dt id="r_send_header"><code>r.sendHeader()</code></dt> <dd> sends the HTTP headers to the client </dd> <dt id="r_set_return_value"><code>r.setReturnValue(<i>value</i>)</code></dt> <dd> sets the return value of the <a href="../http/ngx_http_js_module.html#js_set">js_set</a> handler (<a href="changes.html#njs0.7.0">0.7.0</a>). Unlike an ordinary return statement, this method should be used when the handler is JS async function. For example: <pre data-language="nginx">
async function js_set(r) {
    const digest = await crypto.subtle.digest('SHA-256', r.headersIn.host);
    r.setReturnValue(digest);
}
</pre> </dd> <dt id="r_status"><code>r.status</code></dt> <dd> status, writable </dd> <dt id="r_subrequest"><code>r.subrequest(<i>uri</i>[,
<i>options</i>[, <i>callback</i>]])</code></dt> <dd> creates a subrequest with the given <code>uri</code> and <code>options</code>, and installs an optional completion <code>callback</code>. <p> A <a href="../dev/development_guide.html#http_subrequests">subrequest</a> shares its input headers with the client request. To send headers different from original headers to a proxied server, the <a href="../http/ngx_http_proxy_module.html#proxy_set_header">proxy_set_header</a> directive can be used. To send a completely new set of headers to a proxied server, the <a href="../http/ngx_http_proxy_module.html#proxy_pass_request_headers">proxy_pass_request_headers</a> directive can be used. </p> <p> If <code>options</code> is a string, then it holds the subrequest arguments string. Otherwise, <code>options</code> is expected to be an object with the following keys: </p> <dl class="compact"> <dt><code>args</code></dt> <dd> arguments string, by default an empty string is used </dd> <dt><code>body</code></dt> <dd> request body, by default the request body of the parent request object is used </dd> <dt><code>method</code></dt> <dd> HTTP method, by default the <code>GET</code> method is used </dd> <dt><code>detached</code></dt> <dd> boolean flag (<a href="changes.html#njs0.3.9">0.3.9</a>), if <code>true</code>, the created subrequest is a detached subrequest. Responses to detached subrequests are ignored. Unlike ordinary subrequests, a detached subrequest can be created inside a variable handler. The <code>detached</code> flag and callback argument are mutually exclusive. </dd> </dl>
 <p> The completion <code>callback</code> receives a <a href="#http">subrequest response object</a> with methods and properties identical to the parent request object. </p> <p> Since <a href="changes.html#njs0.3.8">0.3.8</a>, if a <code>callback</code> is not provided, the <code>Promise</code> object that resolves to the <a href="#http">subrequest response object</a> is returned. </p> <p> For example, to view all response headers in the subrequest: </p> <pre data-language="nginx">
async function handler(r) {
    const reply = await r.subrequest('/path');

    for (const h in reply.headersOut) {
        r.log(`${h}: ${reply.headersOut[h]}`);
    }

    r.return(200);
}
</pre>
 </dd> <dt id="r_uri"><code>r.uri</code></dt> <dd> current <a href="../http/ngx_http_core_module.html#var_uri">URI</a> in request, <a href="../http/ngx_http_core_module.html#location">normalized</a>, read-only </dd> <dt id="r_raw_variables"><code>r.rawVariables{}</code></dt> <dd> nginx <a href="#r_variables">variables</a> as Buffers, writable (since <a href="changes.html#njs0.5.0">0.5.0</a>) </dd> <dt id="r_variables"><code>r.variables{}</code></dt> <dd> <a href="https://nginx.org/en/docs/varindex.html">nginx variables</a> object, writable (since <a href="changes.html#njs0.2.8">0.2.8</a>). <p> For example, to get the <code>$foo</code> variable, one of the following syntax can be used: </p> <pre data-language="nginx">
r.variables['foo']
r.variables.foo
</pre>
<p> nginx treats variables referenced in <code>nginx.conf</code> and unreferenced variables differently. When a variable is referenced, it may be cacheable, but when it is unreferenced it is always uncacheable. For example, when the <a href="../http/ngx_http_core_module.html#var_request_id">$request_id</a> variable is only accessed from njs, it has a new value every time it is evaluated. But, when the <a href="../http/ngx_http_core_module.html#var_request_id">$request_id</a> is referenced, for example: </p> <pre data-language="nginx">
proxy_set_header X-Request-Id $request_id;
</pre>
<p> the <code>r.variables.request_id</code> returns the same value every time. </p> <p> A variable is writable if: </p> <ul class="compact"> <li> it was created using the <code>js_var</code> directive for <a href="../http/ngx_http_js_module.html#js_var">http</a> or <a href="../stream/ngx_stream_js_module.html#js_var">stream</a> (since <a href="changes.html#njs0.5.3">0.5.3</a>) </li> <li> it is referenced in nginx configuration file </li> </ul>
<p> Even so, some embedded variables still cannot be assigned a value (for example, <a href="../http/ngx_http_core_module.html#var_http_"><code>$http_</code></a>). </p> </dd> <dt id="r_warn"><code>r.warn(<i>string</i>)</code></dt> <dd> writes a <code>string</code> to the error log on the <code>warning</code> level of logging  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> </dl>

<h4 id="stream">Stream Session</h4>

<table width="100%"> <tr><td><a href="#s_allow"><code>s.allow()</code></a></td></tr> <tr><td><a href="#s_decline"><code>s.decline()</code></a></td></tr> <tr><td><a href="#s_deny"><code>s.deny()</code></a></td></tr> <tr><td><a href="#s_done"><code>s.done()</code></a></td></tr> <tr><td><a href="#s_error"><code>s.error()</code></a></td></tr> <tr><td><a href="#s_log"><code>s.log()</code></a></td></tr> <tr><td><a href="#s_off"><code>s.off()</code></a></td></tr> <tr><td><a href="#s_on"><code>s.on()</code></a></td></tr> <tr><td><a href="#s_remote_address"><code>s.remoteAddress</code></a></td></tr> <tr><td><a href="#s_raw_variables"><code>s.rawVariables{}</code></a></td></tr> <tr><td><a href="#s_send"><code>s.send()</code></a></td></tr> <tr><td><a href="#s_send_downstream"><code>s.sendDownstream()</code></a></td></tr> <tr><td><a href="#s_send_upstream"><code>s.sendUpstream()</code></a></td></tr> <tr><td><a href="#s_status"><code>s.status</code></a></td></tr> <tr><td><a href="#s_set_return_value"><code>s.setReturnValue()</code></a></td></tr> <tr><td><a href="#s_variables"><code>s.variables{}</code></a></td></tr> <tr><td><a href="#s_warn"><code>s.warn()</code></a></td></tr> </table> <p> The stream session object is available only in the <a href="../stream/ngx_stream_js_module.html">ngx_stream_js_module</a> module. Before <a href="changes.html#njs0.8.5">0.8.5</a>, all string properties of the object were <a href="#string">byte strings</a>. </p>
 <dl class="compact"> <dt id="s_allow"><code>s.allow()</code></dt> <dd> an alias to <a href="#s_done"><code>s.done(0)</code></a> (<a href="changes.html#njs0.2.4">0.2.4</a>) </dd> <dt id="s_decline"><code>s.decline()</code></dt> <dd> an alias to <a href="#s_done"><code>s.done(-5)</code></a> (<a href="changes.html#njs0.2.4">0.2.4</a>) </dd> <dt id="s_deny"><code>s.deny()</code></dt> <dd> an alias to <a href="#s_done"><code>s.done(403)</code></a> (<a href="changes.html#njs0.2.4">0.2.4</a>) </dd> <dt id="s_done">
<code>s.done([<i>code</i>]</code>)</dt> <dd> sets an exit <code>code</code> for the current <a href="../stream/stream_processing.html">phase</a> handler to a code value, by default <code>0</code>. The actual finalization happens when the js handler is completed and all pending events, for example, from <a href="#ngx_fetch"><code>ngx.fetch()</code></a> or <a href="#settimeout"><code>setTimeout()</code></a>, are processed (<a href="changes.html#njs0.2.4">0.2.4</a>). <p> Possible code values: </p> <ul class="compact"> <li> <code>0</code> — successful finalization, passing control to the next phase </li> <li> <code>-5</code> — undecided, passing control to the next handler of the current phase (if any) </li> <li> <code>403</code> — access is forbidden </li> </ul>
 May be called only from a phase handler function: <a href="../stream/ngx_stream_js_module.html#js_access"><code>js_access</code></a> or <a href="../stream/ngx_stream_js_module.html#js_preread"><code>js_preread</code></a>. </dd> <dt id="s_error"><code>s.error(<i>string</i>)</code></dt> <dd> writes a sent <code>string</code> to the error log on the <code>error</code> level of logging  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> <dt id="s_log"><code>s.log(<i>string</i>)</code></dt> <dd> writes a sent <code><i>string</i></code> to the error log on the <code>info</code> level of logging  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> <dt id="s_off"><code>s.off(<i>eventName</i>)</code></dt> <dd> unregisters the callback set by the <a href="#s_on">s.on()</a> method (<a href="changes.html#njs0.2.4">0.2.4</a>) </dd> <dt id="s_on"><code>s.on(<i>event</i>,
<i>callback</i>)</code></dt> <dd> registers a <code>callback</code> for the specified <code>event</code> (<a href="changes.html#njs0.2.4">0.2.4</a>). <p> An <code>event</code> may be one of the following strings: </p> <dl class="compact"> <dt><code>upload</code></dt> <dd> new data (string) from a client </dd> <dt><code>download</code></dt> <dd> new data (string) to a client </dd> <dt><code>upstream</code></dt> <dd> new data (Buffer) from a client (since <a href="changes.html#njs0.5.0">0.5.0</a>) </dd> <dt><code>downstream</code></dt> <dd> new data (Buffer) to a client (since <a href="changes.html#njs0.5.0">0.5.0</a>) </dd> </dl>
 <p> The completion callback has the following prototype: <code>callback(data, flags)</code>, where <code>data</code> is string or Buffer (depending on the event type) <code>flags</code> is an object with the following properties: </p> <dl class="compact"> <dt id="s_on_callback_last"><code>last</code></dt> <dd> a boolean value, true if data is a last buffer. </dd> </dl>
 </dd> <dt id="s_remote_address"><code>s.remoteAddress</code></dt> <dd> client address, read-only </dd> <dt id="s_raw_variables"><code>s.rawVariables</code></dt> <dd> nginx <a href="#s_variables">variables</a> as Buffers, writable (since <a href="changes.html#njs0.5.0">0.5.0</a>) </dd> <dt id="s_send"><code>s.send(<i>data</i>[,
<i>options</i>])</code></dt> <dd> adds data to the chain of data chunks that will be forwarded in the forward direction: in download callback to a client; in upload to an upstream server (<a href="changes.html#njs0.2.4">0.2.4</a>). The actual forwarding happens later, when the all the data chunks of the current chain are processed. <p> The data can be a string or Buffer (<a href="changes.html#njs0.5.0">0.5.0</a>). The <code>options</code> is an object used to override nginx buffer flags derived from an incoming data chunk buffer. The flags can be overridden with the following flags: </p> <dl class="compact"> <dt><code>last</code></dt> <dd> boolean, true if the buffer is the last buffer </dd> <dt><code>flush</code></dt> <dd> boolean, true if the buffer should have the <code>flush</code> flag </dd> </dl>
 The method can be called multiple times per callback invocation. </dd> <dt id="s_send_downstream"><code>s.sendDownstream()</code></dt> <dd> is identical to <a href="#s_send">s.send()</a>, except for it always sends data to a client (since <a href="changes.html#njs0.7.8">0.7.8</a>). </dd> <dt id="s_send_upstream"><code>s.sendUpstream()</code></dt> <dd> is identical to <a href="#s_send">s.send()</a>, except for it always sends data from a client (since <a href="changes.html#njs0.7.8">0.7.8</a>). </dd> <dt id="s_status"><code>s.status</code></dt> <dd> session status code, an alias to the <a href="../stream/ngx_stream_core_module.html#var_status"><code>$status</code></a> variable, read only (since <a href="changes.html#njs0.5.2">0.5.2</a>) </dd> <dt id="s_set_return_value"><code>s.setReturnValue(<i>value</i>)</code></dt> <dd> sets the return value of the <a href="../stream/ngx_stream_js_module.html#js_set">js_set</a> handler (<a href="changes.html#njs0.7.0">0.7.0</a>). Unlike an ordinary return statement, this method should be used when the handler is JS async function. For example: <pre data-language="nginx">
async function js_set(r) {
    const digest = await crypto.subtle.digest('SHA-256', r.headersIn.host);
    r.setReturnValue(digest);
}
</pre> </dd> <dt id="s_variables"><code>s.variables{}</code></dt> <dd> <a href="https://nginx.org/en/docs/varindex.html">nginx variables</a> object, writable (since <a href="changes.html#njs0.2.8">0.2.8</a>). A variable can be writable only if it is referenced in nginx configuration file. Even so, some embedded variables still cannot be assigned a value. </dd> <dt id="s_warn"><code>s.warn(<i>string</i>)</code></dt> <dd> writes a sent <code>string</code> to the error log on the <code>warning</code> level of logging  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> </dl>

<h4 id="periodic_session">Periodic Session</h4>

<table width="100%"> <tr><td><a href="#periodic_session_raw_variables"><code>PeriodicSession.rawVariables{}</code></a></td></tr> <tr><td><a href="#periodic_session_variables"><code>PeriodicSession.variables{}</code></a></td></tr> </table> <p> The <code>Periodic Session</code> object is provided as the first argument for the <code>js_periodic</code> handler for <a href="../http/ngx_http_js_module.html#js_periodic">http</a> and <a href="../stream/ngx_stream_js_module.html#js_periodic">stream</a> (since <a href="changes.html#njs0.8.1">0.8.1</a>). </p>
 <dl class="compact"> <dt id="periodic_session_raw_variables"><code>PeriodicSession.rawVariables{}</code></dt> <dd> nginx <a href="#periodic_session_variables">variables</a> as Buffers, writable. </dd> <dt id="periodic_session_variables"><code>PeriodicSession.variables{}</code></dt> <dd> <a href="https://nginx.org/en/docs/varindex.html">nginx variables</a> object, writable. </dd> </dl>

<h4 id="headers">Headers</h4>

<table width="100%"> <tr><td><a href="#headers_constructor"><code>Headers()</code></a></td></tr> <tr><td><a href="#headers_append"><code>Headers.append()</code></a></td></tr> <tr><td><a href="#headers_delete"><code>Headers.delete()</code></a></td></tr> <tr><td><a href="#headers_get"><code>Headers.get()</code></a></td></tr> <tr><td><a href="#headers_getall"><code>Headers.getAll()</code></a></td></tr> <tr><td><a href="#headers_foreach"><code>Headers.forEach()</code></a></td></tr> <tr><td><a href="#headers_has"><code>Headers.has()</code></a></td></tr> <tr><td><a href="#headers_set"><code>Headers.set()</code></a></td></tr> </table> <p> The <code>Headers</code> interface of the <a href="#ngx_fetch"><code>Fetch API</code></a> is available since <a href="changes.html#njs0.5.1">0.5.1</a>. </p>
<p> A new <code>Headers</code> object can be created using the <a href="#headers_constructor"><code>Headers()</code></a> constructor: (since <a href="changes.html#njs0.7.10">0.7.10</a>): </p> <dl class="compact"> <dt id="headers_constructor"><code>Headers([<i>init</i>])</code></dt> <dd> <dl class="compact"> <dt><code>init</code></dt> <dd> An object containing HTTP headers for prepopulating the <code>Headers</code> object, can be a <code>string</code>, an <code>array</code> of name-value pairs, or an existing <code>Headers</code> object. </dd> </dl> </dd> </dl>

<p> A new <code>Headers</code> object can be created with the following properties and methods: </p> <dl class="compact"> <dt id="headers_append"><code>append()</code></dt> <dd> Appends a new value into an existing header in the <code>Headers</code> object, or adds the header if it does not already exist (since <a href="changes.html#njs0.7.10">0.7.10</a>). </dd> <dt id="headers_delete"><code>delete()</code></dt> <dd> Deletes a header from the <code>Headers</code> object (since <a href="changes.html#njs0.7.10">0.7.10</a>). </dd> <dt id="headers_get"><code>get()</code></dt> <dd> Returns a string containing the values of all headers with the specified name separated by a comma and a space. </dd> <dt id="headers_getall"><code>getAll(<i>name</i>)</code></dt> <dd> Returns an array containing the values of all headers with the specified name. </dd> <dt id="headers_foreach"><code>forEach()</code></dt> <dd> Executes a provided function once for each key/value pair in the <code>Headers</code> object (since <a href="changes.html#njs0.7.10">0.7.10</a>). </dd> <dt id="headers_has"><code>has()</code></dt> <dd> Returns a boolean value indicating whether a header with the specified name exists. </dd> <dt id="headers_set"><code>set()</code></dt> <dd> Sets a new value for an existing header inside the <code>Headers</code> object, or adds the header if it does not already exist (since <a href="changes.html#njs0.7.10">0.7.10</a>). </dd> </dl>

<h4 id="request">Request</h4>

<table width="100%"> <tr><td><a href="#request_constructor"><code>Request()</code></a></td></tr> <tr><td><a href="#request_arraybuffer"><code>Request.arrayBuffer()</code></a></td></tr> <tr><td><a href="#request_bodyused"><code>Request.bodyUsed</code></a></td></tr> <tr><td><a href="#request_cache"><code>Request.cache</code></a></td></tr> <tr><td><a href="#request_credentials"><code>Request.credentials</code></a></td></tr> <tr><td><a href="#request_headers"><code>Request.headers</code></a></td></tr> <tr><td><a href="#request_json"><code>Request.json()</code></a></td></tr> <tr><td><a href="#request_method"><code>Request.method</code></a></td></tr> <tr><td><a href="#request_mode"><code>Request.mode</code></a></td></tr> <tr><td><a href="#request_text"><code>Request.text()</code></a></td></tr> <tr><td><a href="#request_url"><code>Request.url</code></a></td></tr> </table> <p> The <code>Request</code> interface of the <a href="#ngx_fetch"><code>Fetch API</code></a> is available since <a href="changes.html#njs0.7.10">0.7.10</a>. </p>
<p> A new <code>Request</code> object can be created using the <a href="#request_constructor"><code>Request()</code></a> constructor: </p> <dl class="compact"> <dt id="request_constructor"><code>Request[<i>resource</i>[,
<i>options</i>]])</code></dt> <dd> Creates a <code>Request</code> object to fetch that can be passed later to <a href="#ngx_fetch"><code>ngx.fetch()</code></a>. The <code>resource</code> can be a URL or an existing <code>Request</code> object. The <code>options</code> is an optional argument that is expected to be an object with the following keys: <dl class="compact"> <dt><code>body</code></dt> <dd> The request body, by default is empty. </dd> <dt><code>headers</code></dt> <dd> The response headers object — the object containing HTTP headers for prepopulating the <a href="#headers"><code>Headers</code></a> object, can be a <code>string</code>, an <code>array</code> of name-value pairs, or an existing <a href="#headers"><code>Headers</code></a> object. </dd> <dt><code>method</code></dt> <dd> The HTTP method, by default the GET method is used. </dd> </dl> </dd> </dl>

<p> A new <code>Request</code> object can be created with the following properties and methods: </p> <dl class="compact"> <dt id="request_arraybuffer"><code>arrayBuffer()</code></dt> <dd> Returns a <code>Promise</code> that resolves with an <code>ArrayBuffer</code>. </dd> <dt id="request_bodyused"><code>bodyUsed</code></dt> <dd> A boolean value, <code>true</code> if the body was used in the request. </dd> <dt id="request_cache"><code>cache</code></dt> <dd> Contains the cache mode of the request. </dd> <dt id="request_credentials"><code>credentials</code></dt> <dd> Contains the credentials of the request, by default is <code>same-origin</code>. </dd> <dt id="request_headers"><code>headers</code></dt> <dd> The <a href="#headers"><code>Headers</code></a> read-only object associated with the <a href="#request"><code>Request</code></a>. </dd> <dt id="request_json"><code>json()</code></dt> <dd> Returns a <code>Promise</code> that resolves with the result of parsing the request body as JSON. </dd> <dt id="request_method"><code>method</code></dt> <dd> Contains the request method. </dd> <dt id="request_mode"><code>mode</code></dt> <dd> Contains the mode of the request. </dd> <dt id="request_text"><code>text()</code></dt> <dd> Returns a <code>Promise</code> that resolves with a string representation of the request body. </dd> <dt id="request_url"><code>url</code></dt> <dd> Contains the URL of the request. </dd> </dl>

<h4 id="response">Response</h4>

<table width="100%"> <tr><td><a href="#response_constructor"><code>Response()</code></a></td></tr> <tr><td><a href="#response_arraybuffer"><code>Response.arrayBuffer()</code></a></td></tr> <tr><td><a href="#response_bodyused"><code>Response.bodyUsed</code></a></td></tr> <tr><td><a href="#response_headers"><code>Response.headers</code></a></td></tr> <tr><td><a href="#response_json"><code>Response.json()</code></a></td></tr> <tr><td><a href="#response_ok"><code>Response.ok</code></a></td></tr> <tr><td><a href="#response_redirect"><code>Response.redirected</code></a></td></tr> <tr><td><a href="#response_status"><code>Response.status</code></a></td></tr> <tr><td><a href="#response_statustext"><code>Response.statusText</code></a></td></tr> <tr><td><a href="#response_text"><code>Response.text()</code></a></td></tr> <tr><td><a href="#response_type"><code>Response.type</code></a></td></tr> <tr><td><a href="#response_url"><code>Response.url</code></a></td></tr> </table> <p> The <code>Response</code> interface is available since <a href="changes.html#njs0.5.1">0.5.1</a>. </p>
<p> A new <code>Response</code> object can be created using the <a href="#response_constructor"><code>Response()</code></a> constructor (since <a href="changes.html#njs0.7.10">0.7.10</a>): </p> <dl class="compact"> <dt id="response_constructor"><code>Response[<i>body</i>[,
<i>options</i>]])</code></dt> <dd> Creates a <code>Response</code> object. The <code>body</code> is an optional argument, can be a <code>string</code> or a <code>buffer</code>, by default is <code>null</code>. The <code>options</code> is an optional argument that is expected to be an object with the following keys: <dl class="compact"> <dt><code>headers</code></dt> <dd> The response headers object — the object containing HTTP headers for prepopulating the <a href="#headers"><code>Headers</code></a> object, can be a <code>string</code>, an <code>array</code> of name-value pairs, or an existing <a href="#headers"><code>Headers</code></a> object. </dd> <dt><code>status</code></dt> <dd> The status code of the response. </dd> <dt><code>statusText</code></dt> <dd> The status message corresponding to the status code. </dd> </dl> </dd> </dl>

<p> A new <code>Response()</code> object can be created with the following properties and methods: </p> <dl class="compact"> <dt id="response_arraybuffer"><code>arrayBuffer()</code></dt> <dd> Takes a <code>Response</code> stream and reads it to completion. Returns a <code>Promise</code> that resolves with an <code>ArrayBuffer</code>. </dd> <dt id="response_bodyused"><code>bodyUsed</code></dt> <dd> A boolean value, <code>true</code> if the body was read. </dd> <dt id="response_headers"><code>headers</code></dt> <dd> The <a href="#headers"><code>Headers</code></a> read-only object associated with the <a href="#response"><code>Response</code></a>. </dd> <dt id="response_json"><code>json()</code></dt> <dd> Takes a <code>Response</code> stream and reads it to completion. Returns a <code>Promise</code> that resolves with the result of parsing the body text as JSON. </dd> <dt id="response_ok"><code>ok</code></dt> <dd> A boolean value, <code>true</code> if the response was successful (status codes between 200–299). </dd> <dt id="response_redirect"><code>redirected</code></dt> <dd> A boolean value, <code>true</code> if the response is the result of a redirect. </dd> <dt id="response_status"><code>status</code></dt> <dd> The status code of the response. </dd> <dt id="response_statustext"><code>statusText</code></dt> <dd> The status message corresponding to the status code. </dd> <dt id="response_text"><code>text()</code></dt> <dd> Takes a <code>Response</code> stream and reads it to completion. Returns a <code>Promise</code> that resolves with a string. </dd> <dt id="response_type"><code>type</code></dt> <dd> The type of the response. </dd> <dt id="response_url"><code>url</code></dt> <dd> The URL of the response. </dd> </dl>

<h4 id="ngx">ngx</h4>

<table width="100%"> <tr><td><a href="#ngx_build"><code>ngx.build</code></a></td></tr> <tr><td><a href="#ngx_conf_file_path"><code>ngx.conf_file_path</code></a></td></tr> <tr><td><a href="#ngx_conf_prefix"><code>ngx.conf_prefix</code></a></td></tr> <tr><td><a href="#ngx_error_log_path"><code>ngx.error_log_path</code></a></td></tr> <tr><td><a href="#ngx_fetch"><code>ngx.fetch()</code></a></td></tr> <tr><td><a href="#ngx_log"><code>ngx.log()</code></a></td></tr> <tr><td><a href="#ngx_prefix"><code>ngx.prefix</code></a></td></tr> <tr><td><a href="#ngx_version"><code>ngx.version</code></a></td></tr> <tr><td><a href="#ngx_version_number"><code>ngx.version_number</code></a></td></tr> <tr><td><a href="#ngx_worker_id"><code>ngx.worker_id</code></a></td></tr> </table> <p> The <code>ngx</code> global object is available since <a href="changes.html#njs0.5.0">0.5.0</a>. </p> <dl class="compact"> <dt id="ngx_build"><code>ngx.build</code></dt> <dd> a string containing an optional nginx build name, corresponds to the <a href="../configure.html#build"><code>--build=name</code></a> argument of the <a href="../configure.html">configure</a> script, by default is <code>""</code> (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> <dt id="ngx_conf_file_path"><code>ngx.conf_file_path</code></dt> <dd> a string containing the file path to current nginx configuration file (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> <dt id="ngx_conf_prefix"><code>ngx.conf_prefix</code></dt> <dd> a string containing the file path to <a href="../configure.html#conf_path">nginx configuration prefix</a> — the directory where nginx is currently looking for configuration (<a href="changes.html#njs0.7.8">0.7.8</a>) </dd> <dt id="ngx_error_log_path"><code>ngx.error_log_path</code></dt> <dd> a string containing the file path to the current <a href="../ngx_core_module.html#error_log">error log</a> file (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> <dt id="ngx_fetch"><code>ngx.fetch(<i>resource</i>,
[<i>options</i>])</code></dt> <dd> <p> Makes a request to fetch a <code><i>resource</i></code> (<a href="changes.html#njs0.5.1">0.5.1</a>), which can be an URL or the <a href="#request"><code>Request</code></a> object (<a href="changes.html#njs0.7.10">0.7.10</a>). Returns a <code>Promise</code> that resolves with the <a href="#response"><code>Response</code></a> object. Since <a href="changes.html#njs0.7.0">0.7.0</a>, the <code>https://</code> scheme is supported, redirects are not handled. </p> <p> If the URL in the <code><i>resource</i></code> is specified as a domain name, it is determined using a <a href="../http/ngx_http_core_module.html#resolver">resolver</a>. If the <code>https://</code> scheme is specified, the <a href="../http/ngx_http_js_module.html#js_fetch_trusted_certificate">js_fetch_trusted_certificate</a> directive should be configured for the authentication of the <code><i>resource</i></code>'s HTTPS server. </p> <p> The <code>options</code> parameter is expected to be an object with the following keys: </p> <dl class="compact"> <dt id="fetch_body"><code>body</code></dt> <dd> request body, by default is empty </dd> <dt id="fetch_buffer_size"><code>buffer_size</code></dt> <dd> the buffer size for reading the response, by default is <code>4096</code> </dd> <dt id="fetch_headers"><code>headers</code></dt> <dd> request <a href="#headers">headers</a> object </dd> <dt id="fetch_get"><code>max_response_body_size</code></dt> <dd> the maximum size of the response body in bytes, by default is <code>32768</code> </dd> <dt id="fetch_method"><code>method</code></dt> <dd> HTTP method, by default the <code>GET</code> method is used </dd> <dt id="fetch_verify"><code>verify</code></dt> <dd> enables or disables verification of the HTTPS server certificate, by default is <code>true</code> (<a href="changes.html#njs0.7.0">0.7.0</a>) </dd> </dl>
<p> Example: </p> <pre data-language="nginx">
let reply = await ngx.fetch('http://nginx.org/');
let body = await reply.text();

r.return(200, body);
</pre>
 </dd> <dt id="ngx_log">
<code>ngx.log</code>(<code><i>level</i></code>, <code><i>message</i></code>)</dt> <dd> writes a message to the error log with the specified level of logging. The <code><i>level</i></code> parameter specifies one of the log levels, the <code><i>message</i></code> parameter can be a string or Buffer. The following log levels can be specified: <code>ngx.INFO</code>, <code>ngx.WARN</code>, and <code>ngx.ERR</code>.  <blockquote class="note"> As nginx has a <a href="../dev/development_guide.html#logging">hardcoded</a> maximum line length limit, only first 2048 bytes of the string can be logged. </blockquote>
 </dd> <dt id="ngx_prefix"><code>ngx.prefix</code></dt> <dd> a string containing the file path to <a href="../configure.html#prefix">nginx prefix</a> — a directory that keeps server files (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> <dt id="ngx_version"><code>ngx.version</code></dt> <dd> a string containing nginx version, for example: <code>1.25.0</code> (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> <dt id="ngx_version_number"><code>ngx.version_number</code></dt> <dd> a number containing nginx version, for example: <code>1025000</code> (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> <dt id="ngx_worker_id"><code>ngx.worker_id</code></dt> <dd> a number that corresponds to nginx internal worker id, the value is between <code>0</code> and the value specified in the <a href="../ngx_core_module.html#worker_processes">worker_processes</a> directive (<a href="changes.html#njs0.8.0">0.8.0</a>) </dd> </dl>

<h4 id="ngx_shared">ngx.shared</h4>
<p> The <code>ngx.shared</code> global object is available since <a href="changes.html#njs0.8.0">0.8.0</a>. </p>
<h4 id="dict">SharedDict</h4>

<table width="100%"> <tr><td><a href="#dict_add"><code>ngx.shared.SharedDict.add()</code></a></td></tr> <tr><td><a href="#dict_capacity"><code>ngx.shared.SharedDict.capacity</code></a></td></tr> <tr><td><a href="#dict_clear"><code>ngx.shared.SharedDict.clear()</code></a></td></tr> <tr><td><a href="#dict_delete"><code>ngx.shared.SharedDict.delete()</code></a></td></tr> <tr><td><a href="#dict_freespace"><code>ngx.shared.SharedDict.freeSpace()</code></a></td></tr> <tr><td><a href="#dict_get"><code>ngx.shared.SharedDict.get()</code></a></td></tr> <tr><td><a href="#dict_has"><code>ngx.shared.SharedDict.has()</code></a></td></tr> <tr><td><a href="#dict_incr"><code>ngx.shared.SharedDict.incr()</code></a></td></tr> <tr><td><a href="#dict_items"><code>ngx.shared.SharedDict.items()</code></a></td></tr> <tr><td><a href="#dict_keys"><code>ngx.shared.SharedDict.keys()</code></a></td></tr> <tr><td><a href="#dict_name"><code>ngx.shared.SharedDict.name</code></a></td></tr> <tr><td><a href="#dict_pop"><code>ngx.shared.SharedDict.pop()</code></a></td></tr> <tr><td><a href="#dict_replace"><code>ngx.shared.SharedDict.replace()</code></a></td></tr> <tr><td><a href="#dict_set"><code>ngx.shared.SharedDict.set()</code></a></td></tr> <tr><td><a href="#dict_size"><code>ngx.shared.SharedDict.size()</code></a></td></tr> <tr><td><a href="#dict_type"><code>ngx.shared.SharedDict.type</code></a></td></tr> </table> <p> The shared dictionary object is available since <a href="changes.html#njs0.8.0">0.8.0</a>. The shared dictionary name, type, and size are set with the <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a>. </p>
<p> A <code>SharedDict()</code> object has the following properties and methods: </p> <dl class="compact"> <dt id="dict_add"><code>ngx.shared.SharedDict.add(<i>key</i>,
<i>value</i> [,<i>timeout</i>])</code></dt> <dd> Sets the <code>value</code> for the specified <code>key</code> in the dictionary only if the key does not exist yet. The <code>key</code> is a string representing the key of the item to add, the <code>value</code> is the value of the item to add. <p> The optional <code>timeout</code> argument is specified in milliseconds and overrides the <code>timeout</code> parameter of the <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a> (since <a href="changes.html#njs0.8.5">0.8.5</a>). It can be useful when some keys are expected to have unique timeouts. </p> <p> Returns <code>true</code> if the value has been successfully added to the <code>SharedDict</code> dictionary, <code>false</code> if the key already exists in the dictionary. Throws <code>SharedMemoryError</code> if there is not enough free space in the <code>SharedDict</code> dictionary. Throws <code>TypeError</code> if the <code>value</code> is of a different type than expected by this dictionary. </p> </dd> <dt id="dict_capacity"><code>ngx.shared.SharedDict.capacity</code></dt> <dd> Returns the capacity of the <code>SharedDict</code> dictionary, corresponds to the <code>size</code> parameter of <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a>. </dd> <dt id="dict_clear"><code>ngx.shared.SharedDict.clear()</code></dt> <dd> Removes all items from the <code>SharedDict</code> dictionary. </dd> <dt id="dict_delete"><code>ngx.shared.SharedDict.delete(<i>key</i>)</code></dt> <dd> Removes the item associated with the specified key from the <code>SharedDict</code> dictionary, <code>true</code> if the item in the dictionary existed and was removed, <code>false</code> otherwise. </dd> <dt id="dict_freespace"><code>ngx.shared.SharedDict.freeSpace()</code></dt> <dd> Returns the free page size in bytes. If the size is zero, the <code>SharedDict</code> dictionary will still accept new values if there is space in the occupied pages. </dd> <dt id="dict_get"><code>ngx.shared.SharedDict.get(<i>key</i>)</code></dt> <dd> Retrieves the item by its <code>key</code>, returns the value associated with the <code>key</code> or <code>undefined</code> if there is none. </dd> <dt id="dict_has"><code>ngx.shared.SharedDict.has(<i>key</i>)</code></dt> <dd> Searches for an item by its <code>key</code>, returns <code>true</code> if such item exists or <code>false</code> otherwise. </dd> <dt id="dict_incr"><code>ngx.shared.SharedDict.incr(<i>key</i>,<i>delta</i>[[,<i>init</i>], <i>timeout</i>]))</code></dt> <dd> Increments the integer value associated with the <code>key</code> by <code>delta</code>. The <code>key</code> is a string, the <code>delta</code> is the number to increment or decrement the value by. If the key does not exist, the item will be initialized to an optional <code>init</code> argument, by default is <code>0</code>. <p> The optional <code>timeout</code> argument is specified in milliseconds and overrides the <code>timeout</code> parameter of the <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a> (since <a href="changes.html#njs0.8.5">0.8.5</a>). It can be useful when some keys are expected to have unique timeouts. </p> <p> Returns the new value. Throws <code>SharedMemoryError</code> if there is not enough free space in the <code>SharedDict</code> dictionary. Throws <code>TypeError</code> if this dictionary does not expect numbers. </p>  <blockquote class="note"> This method can be used only if the dictionary type was declared with <code>type=number</code> parameter of the <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a>. </blockquote>
 </dd> <dt id="dict_items"><code>ngx.shared.SharedDict.items([<i>maxCount</i>])</code></dt> <dd> Returns an array of the <code>SharedDict</code> dictionary key-value items (since <a href="changes.html#njs0.8.1">0.8.1</a>). The <code>maxCount</code> parameter sets maximum number of items to retrieve, by default is <code>1024</code>. </dd> <dt id="dict_keys"><code>ngx.shared.SharedDict.keys([<i>maxCount</i>])</code></dt> <dd> Returns an array of the <code>SharedDict</code> dictionary keys. The <code>maxCount</code> parameter sets maximum number of keys to retrieve, by default is <code>1024</code>. </dd> <dt id="dict_name"><code>ngx.shared.SharedDict.name</code></dt> <dd> Returns the name of the <code>SharedDict</code> dictionary, corresponds to the <code>zone=</code> parameter of <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a>. </dd> <dt id="dict_pop"><code>ngx.shared.SharedDict.pop(<i>key</i>)</code></dt> <dd> Removes the item associated with the specified <code>key</code> from the <code>SharedDict</code> dictionary, returns the value associated with the <code>key</code> or <code>undefined</code> if there is none. </dd> <dt id="dict_replace"><code>ngx.shared.SharedDict.replace(<i>key</i>,
<i>value</i>)</code></dt> <dd> Replaces the <code>value</code> for the specified <code>key</code> only if the key already exists, returns <code>true</code> if the value was successfully replaced, <code>false</code> if the key does not exist in the <code>SharedDict</code> dictionary. Throws <code>SharedMemoryError</code> if there is not enough free space in the <code>SharedDict</code> dictionary. Throws <code>TypeError</code> if the <code>value</code> is of a different type than expected by this dictionary. </dd> <dt id="dict_set"><code>ngx.shared.SharedDict.set(<i>key</i>,
<i>value</i> [,<i>timeout</i>])</code></dt> <dd> Sets the <code>value</code> for the specified <code>key</code>, returns this <code>SharedDict</code> dictionary (for method chaining). <p> The optional <code>timeout</code> argument is specified in milliseconds and overrides the <code>timeout</code> parameter of the <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a> (since <a href="changes.html#njs0.8.5">0.8.5</a>). It can be useful when some keys are expected to have unique timeouts. </p> </dd> <dt id="dict_size"><code>ngx.shared.SharedDict.size()</code></dt> <dd> Returns the number of items for the <code>SharedDict</code> dictionary. </dd> <dt id="dict_type"><code>ngx.shared.SharedDict.type</code></dt> <dd> Returns <code>string</code> or <code>number</code> that corresponds to the <code>SharedDict</code> dictionary type set by the <code>type=</code> parameter of <code>js_shared_dict_zone</code> directive in <a href="../http/ngx_http_js_module.html#js_shared_dict_zone">http</a> or <a href="../stream/ngx_stream_js_module.html#js_shared_dict_zone">stream</a>. </dd> </dl>

<h4 id="builtin_objects">built-in objects</h4>
<h4 id="console">console</h4>

<table width="100%"> <tr><td><a href="#console_error"><code>console.error()</code></a></td></tr> <tr><td><a href="#console_info"><code>console.info()</code></a></td></tr> <tr><td><a href="#console_log"><code>console.log()</code></a></td></tr> <tr><td><a href="#console_time"><code>console.time()</code></a></td></tr> <tr><td><a href="#console_time_end"><code>console.timeEnd()</code></a></td></tr> <tr><td><a href="#console_warn"><code>console.warn()</code></a></td></tr> </table> <p> The <code>console</code> object is available in nginx since <a href="changes.html#njs0.8.2">0.8.2</a>, in CLI since <a href="changes.html#njs0.2.6">0.2.6</a>. </p> <dl class="compact"> <dt id="console_error"><code>console.error(<i>msg</i>[, <i>msg2</i> ...])</code></dt> <dd> Outputs one or more error messages. The message may be a string or an object. </dd> <dt id="console_info"><code>console.info(<i>msg</i>[, <i>msg2</i> ...])</code></dt> <dd> Outputs one or more info messages. The message may be a string or an object. </dd> <dt id="console_log"><code>console.log(<i>msg</i>[, <i>msg2</i> ...])</code></dt> <dd> Outputs one or more log messages. The message may be a string or an object. </dd> <dt id="console_time"><code>console.time(<i>label</i>)</code></dt> <dd> Starts a timer that can track how long an operation takes. The <code>label</code> parameter allows naming different timers. If <a href="#console_time_end"><code>console.timeEnd()</code></a> with the same name is called, the time that elapsed since the timer was started will be output, in milliseconds. </dd> <dt id="console_time_end"><code>console.timeEnd(<i>label</i>)</code></dt> <dd> Stops a timer previously started by <a href="#console_time"><code>console.time()</code></a> The <code>label</code> parameter allows naming different timers. </dd> <dt id="console_warn"><code>console.warn(<i>msg</i>[, <i>msg2</i> ...])</code></dt> <dd> Outputs one or more warning messages. The message may be a string or an object. </dd> </dl>

<h4 id="builtin_crypto">crypto</h4>

<table width="100%"> <tr><td><a href="#crypto_get_random_values"><code>сrypto.getRandomValues()</code></a></td></tr> <tr><td><a href="#crypto_subtle_encrypt"><code>сrypto.subtle.encrypt()</code></a></td></tr> <tr><td><a href="#crypto_subtle_decrypt"><code>сrypto.subtle.decrypt()</code></a></td></tr> <tr><td><a href="#crypto_subtle_derive_bits"><code>сrypto.subtle.deriveBits()</code></a></td></tr> <tr><td><a href="#crypto_subtle_derive_key"><code>сrypto.subtle.deriveKey()</code></a></td></tr> <tr><td><a href="#crypto_subtle_digest"><code>сrypto.subtle.digest()</code></a></td></tr> <tr><td><a href="#crypto_subtle_export_key"><code>сrypto.subtle.exportKey()</code></a></td></tr> <tr><td><a href="#crypto_subtle_generate_key"><code>сrypto.subtle.generateKey()</code></a></td></tr> <tr><td><a href="#crypto_subtle_import_key"><code>сrypto.subtle.importKey()</code></a></td></tr> <tr><td><a href="#crypto_subtle_sign"><code>сrypto.subtle.sign()</code></a></td></tr> <tr><td><a href="#crypto_subtle_verify"><code>сrypto.subtle.verify()</code></a></td></tr> </table> <p> The <code>crypto</code> object is a global object that allows using cryptographic functionality (since <a href="changes.html#njs0.7.0">0.7.0</a>). </p>
 <dl class="compact"> <dt id="crypto_get_random_values">
<code>сrypto.getRandomValues</code>(<a href="#crypto_get_random_values_array"><code>typedArray</code></a>)</dt> <dd> Gets cryptographically strong random values. Returns the same array passed as <code>typedArray</code> but with its contents replaced with the newly generated random numbers. Possible values: <dl class="compact"> <dt id="crypto_get_random_values_array"><code>typedArray</code></dt> <dd> can be <code>Int8Array</code>, <code>Int16Array</code>, <code>Uint16Array</code>, <code>Int32Array</code>, or <code>Uint32Array</code> </dd> </dl> </dd> <dt id="crypto_subtle_encrypt">
<code>сrypto.subtle.encrypt</code>(<a href="#crypto_encrypt_alg"><code>algorithm</code></a>, <a href="#crypto_encrypt_key"><code>key</code></a>, <a href="#crypto_encrypt_data"><code>data</code></a>)</dt> <dd> Encrypts <a href="#crypto_encrypt_data"><code>data</code></a> using the provided <a href="#crypto_encrypt_algorithm"><code>algorithm</code></a> and <a href="#crypto_encrypt_key"><code>key</code></a>. Returns a <code>Promise</code> that fulfills with an <code>ArrayBuffer</code> containing the ciphertext. Possible values: <dl class="compact"> <dt id="crypto_encrypt_alg"><code>algorithm</code></dt> <dd> an object that specifies the algorithm to be used and any extra parameters if required: <ul class="compact"> <li id="rsa_oaep_params"> for <code>RSA-OAEP</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>RSA-OAEP</code>:  <pre data-language="nginx">
crypto.subtle.encrypt({name: "RSA-OAEP"}, key, data)
</pre>
 </li> </ul> </li> <li id="aes_ctr_params"> for <code>AES-CTR</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-CTR</code> </li> <li> <code>counter</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> — the initial value of the counter block, must be 16 bytes long (the AES block size). The rightmost length bits of this block are used for the counter, and the rest is used for the nonce. For example, if length is set to 64, then the first half of counter is the nonce and the second half is used for the counter </li> <li> <code>length</code> is the number of bits in the counter block that are used for the actual counter. The counter must be big enough that it doesn't wrap. </li> </ul> </li> <li id="aes_cbc_params"> for <code>AES-CBC</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-CBC</code> </li> <li> <code>iv</code> or the initialization vector, is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code>, must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret, for example, it may be transmitted unencrypted along with the ciphertext. </li> </ul> </li> <li id="aes_gcm_params"> for <code>AES-GCM</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-GCM</code> </li> <li> <code>iv</code> or the initialization vector, is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code>, must be 16 bytes, and must be unique for every encryption operation carried out with a given key </li> <li> <code>additionalData</code> (optional) is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that contains additional data that will not be encrypted but will be authenticated along with the encrypted data. If <code>additionalData</code> is specified, then the same data must be specified in the corresponding call to <code>decrypt()</code>: if the data given to the <code>decrypt()</code> call does not match the original data, the decryption will throw an exception. The bit length of <code>additionalData</code> must be smaller than <code>2^64 - 1</code>. </li> <li> <code>tagLength</code> (optional, default is <code>128</code>) - a <code>number</code> that determines the size in bits of the authentication tag generated in the encryption operation and used for authentication in the corresponding decryption Possible values: <code>32</code>, <code>64</code>, <code>96</code>, <code>104</code>, <code>112</code>, <code>120</code>, or <code>128</code>. The AES-GCM specification recommends that it should be <code>96</code>, <code>104</code>, <code>112</code>, <code>120</code>, or <code>128</code>, although <code>32</code> or <code>64</code> bits may be acceptable in some applications. </li> </ul> </li> </ul> </dd> <dt id="crypto_encrypt_key"><code>key</code></dt> <dd> a <a href="#cryptokey"><code>CryptoKey</code></a> that contains the key to be used for encryption </dd> <dt id="crypto_encrypt_data"><code>data</code></dt> <dd> an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that contains the data to be encrypted (also known as the plaintext) </dd> </dl> </dd> <dt id="crypto_subtle_decrypt">
<code>сrypto.subtle.decrypt</code>(<a href="#crypto_decrypt_alg"><code>algorithm</code></a>, <a href="#crypto_decrypt_key"><code>key</code></a>, <a href="#crypto_decrypt_data"><code>data</code></a>)</dt> <dd> Decrypts encrypted data. Returns a <code>Promise</code> with the decrypted data. Possible values: <dl class="compact"> <dt id="crypto_decrypt_alg"><code>algorithm</code></dt> <dd> an object that specifies the algorithm to be used, and any extra parameters as required. The values given for the extra parameters must match those passed into the corresponding <code>encrypt()</code> call. <ul class="compact"> <li> for <code>RSA-OAEP</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>RSA-OAEP</code>:  <pre data-language="nginx">
crypto.subtle.encrypt({name: "RSA-OAEP"}, key, data)
</pre>
 </li> </ul> </li> <li> for <code>AES-CTR</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-CTR</code> </li> <li> <code>counter</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> — the initial value of the counter block, must be 16 bytes long (the AES block size). The rightmost length bits of this block are used for the counter, and the rest is used for the nonce. For example, if length is set to 64, then the first half of counter is the nonce and the second half is used for the counter. </li> <li> <code>length</code> is the number of bits in the counter block that are used for the actual counter. The counter must be big enough that it doesn't wrap. </li> </ul> </li> <li> for <code>AES-CBC</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-CBC</code> </li> <li> <code>iv</code> or the initialization vector, is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code>, must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret (for example, it may be transmitted unencrypted along with the ciphertext). </li> </ul> </li> <li> for <code>AES-GCM</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-GCM</code> </li> <li> <code>iv</code> or the initialization vector, is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code>, must be 16 bytes, and must be unique for every encryption operation carried out with a given key </li> <li> <code>additionalData</code> (optional) is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that contains additional data that will not be encrypted but will be authenticated along with the encrypted data. If <code>additionalData</code> is specified, then the same data must be specified in the corresponding call to <code>decrypt()</code>: if the data given to the <code>decrypt()</code> call does not match the original data, the decryption will throw an exception. The bit length of <code>additionalData</code> must be smaller than <code>2^64 - 1</code>. </li> <li> <code>tagLength</code> (optional, default is <code>128</code>) - a <code>number</code> that determines the size in bits of the authentication tag generated in the encryption operation and used for authentication in the corresponding decryption. Possible values: <code>32</code>, <code>64</code>, <code>96</code>, <code>104</code>, <code>112</code>, <code>120</code>, or <code>128</code>. The AES-GCM specification recommends that it should be <code>96</code>, <code>104</code>, <code>112</code>, <code>120</code>, or <code>128</code>, although <code>32</code> or <code>64</code> bits may be acceptable in some applications. </li> </ul> </li> </ul> </dd> <dt id="crypto_decrypt_key"><code>key</code></dt> <dd> a <a href="#cryptokey"><code>CryptoKey</code></a> that contains the key to be used for decryption. If <code>RSA-OAEP</code> is used, this is the <code>privateKey</code> property of the <a href="#cryptokeypair"><code>CryptoKeyPair</code></a> object. </dd> <dt id="crypto_decrypt_data"><code>data</code></dt> <dd> an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that contains the data to be decrypted (also known as ciphertext) </dd> </dl> </dd> <dt id="crypto_subtle_derive_bits">
<code>сrypto.subtle.deriveBits</code>(<a href="#crypto_derive_bits_alg"><code>algorithm</code></a>, <a href="#crypto_derive_bits_basekey"><code>baseKey</code></a>, <a href="#crypto_derive_bits_length"><code>length</code></a>)</dt> <dd> Derives an array of bits from a base key. Returns a <code>Promise</code> which will be fulfilled with an <code>ArrayBuffer</code> that contains the derived bits. Possible values: <dl class="compact"> <dt id="crypto_derive_bits_alg"><code>algorithm</code></dt> <dd> is an object that defines the derivation algorithm to use: <ul class="compact"> <li id="hkdf_params"> for <code>HKDF</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>HKDF</code> </li> <li> <code>hash</code> is a string with the digest algorithm to use: <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>salt</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that represents random or pseudo-random value with the same length as the output of the <code>digest</code> function. Unlike the input key material passed into <code>deriveKey()</code>, salt does not need to be kept secret. </li> <li> <code>info</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that represents application-specific contextual information used to bind the derived key to an application or context, and enables deriving different keys for different contexts while using the same input key material. This property is required but may be an empty buffer. </li> </ul> </li> <li id="pbkdf2_params"> for <code>PBKDF2</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>PBKDF2</code> </li> <li> <code>hash</code> is a string with the digest algorithm to use: <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>salt</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that represents random or pseudo-random value of at least <code>16</code> bytes. Unlike the input key material passed into <code>deriveKey()</code>, salt does not need to be kept secret. </li> <li> <code>iterations</code> is a <code>number</code> that represents the number of times the hash function will be executed in <code>deriveKey()</code> </li> </ul> </li> </ul> </dd> <dt id="crypto_derive_bits_basekey"><code>baseKey</code></dt> <dd> is a <a href="#cryptokey"><code>CryptoKey</code></a> that represents the input to the derivation algorithm - the initial key material for the derivation function: for example, for <code>PBKDF2</code> it might be a password, imported as a <a href="#cryptokey"><code>CryptoKey</code></a> using <a href="#crypto_subtle_import_key"><code>сrypto.subtle.importKey()</code></a> </dd> <dt id="crypto_derive_bits_length"><code>length</code></dt> <dd> is a number representing the number of bits to derive. For browsers compatibility, the number should be a multiple of <code>8</code> </dd> </dl> </dd> <dt id="crypto_subtle_derive_key">
<code>сrypto.subtle.deriveKey</code>(<a href="#crypto_derive_key_alg"><code>algorithm</code></a>, <a href="#crypto_derive_key_basekey"><code>baseKey</code></a>, <a href="#crypto_derive_key_derivedkeyalg"><code>derivedKeyAlgorithm</code></a>, <a href="#crypto_derive_key_extractable"><code>extractable</code></a>, <a href="#crypto_derive_key_keyusages"><code>keyUsages</code></a>)</dt> <dd> Derives a secret key from a master key. Possible values: <dl class="compact"> <dt id="crypto_derive_key_alg"><code>algorithm</code></dt> <dd> is an object that defines the derivation algorithm to use: <ul class="compact"> <li> for <code>HKDF</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>HKDF</code> </li> <li> <code>hash</code> is a string with the digest algorithm to use: <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>salt</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that represents random or pseudo-random value with the same length as the output of the <code>digest</code> function. Unlike the input key material passed into <code>deriveKey()</code>, salt does not need to be kept secret. </li> <li> <code>info</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that represents application-specific contextual information used to bind the derived key to an application or context, and enables deriving different keys for different contexts while using the same input key material. This property is required but may be an empty buffer. </li> </ul> </li> <li> for <code>PBKDF2</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>PBKDF2</code> </li> <li> <code>hash</code> is a string with the digest algorithm to use: <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>salt</code> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that represents random or pseudo-random value of at least <code>16</code> bytes. Unlike the input key material passed into <code>deriveKey()</code>, salt does not need to be kept secret. </li> <li> <code>iterations</code> is a <code>number</code> that represents the number of times the hash function will be executed in <code>deriveKey()</code> </li> </ul> </li> </ul> </dd> <dt id="crypto_derive_key_basekey"><code>baseKey</code></dt> <dd> is a <a href="#cryptokey"><code>CryptoKey</code></a> that represents the input to the derivation algorithm - the initial key material for the derivation function: for example, for <code>PBKDF2</code> it might be a password, imported as a <a href="#cryptokey"><code>CryptoKey</code></a> using <a href="#crypto_subtle_import_key"><code>сrypto.subtle.importKey()</code></a>. </dd> <dt id="crypto_derive_key_derivedkeyalg"><code>derivedKeyAlgorithm</code></dt> <dd> is an object that defines the algorithm the derived key will be used for: <ul class="compact"> <li> for <code>HMAC</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>HMAC</code> </li> <li> <code>hash</code> is a string with the name of the digest function to use: <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>length</code> (optional) is a <code>number</code> that represents the length in bits of the key. If not specified, the length of the key is equal to the block size of the chozen hash function </li> </ul> </li> <li> for <code>AES-CTR</code>, <code>AES-CBC</code>, or <code>AES-GCM</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>AES-CTR</code>, <code>AES-CBC</code>, or <code>AES-GCM</code>, depending on the algorithm used </li> <li> <code>length</code> is a <code>number</code> that represents the length in bits of the key to generate: <code>128</code>, <code>192</code>, or <code>256</code> </li> </ul> </li> </ul> </dd> <dt id="crypto_derive_key_extractable"><code>extractable</code></dt> <dd> is a boolean value that indicates whether it will be possible to export the key </dd> <dt id="crypto_derive_key_keyusages"><code>keyUsages</code></dt> <dd> is an <code>Array</code> that indicates what can be done with the derived key. The key usages must be allowed by the algorithm set in <code>derivedKeyAlgorithm</code>. Possible values: <dl class="compact"> <dt><code>encrypt</code></dt> <dd> key for encrypting messages </dd> <dt><code>decrypt</code></dt> <dd> key for decrypting messages </dd> <dt><code>sign</code></dt> <dd> key for signing messages </dd> <dt><code>verify</code></dt> <dd> key for verifying signatures </dd> <dt><code>deriveKey</code></dt> <dd> key for deriving a new key </dd> <dt><code>deriveBits</code></dt> <dd> key for deriving bits </dd> <dt><code>wrapKey</code></dt> <dd> key for wrapping a key </dd> <dt><code>unwrapKey</code></dt> <dd> key for unwrapping a key </dd> </dl> </dd> </dl> </dd> <dt id="crypto_subtle_digest">
<code>сrypto.subtle.digest</code>(<a href="#crypto_digest_alg"><code>algorithm</code></a>, <a href="#crypto_digest_data"><code>data</code></a>)</dt> <dd> Generates a digest of the given data. Takes as its arguments an identifier for the digest algorithm to use and the data to digest. Returns a <code>Promise</code> which will be fulfilled with the digest. Possible values: <dl class="compact"> <dt id="crypto_digest_alg"><code>algorithm</code></dt> <dd> is a string that defines the hash function to use: <code>SHA-1</code> (not for cryptographic applications), <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </dd> <dt id="crypto_digest_data"><code>data</code></dt> <dd> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that contains the data to be digested </dd> </dl> </dd> <dt id="crypto_subtle_export_key">
<code>сrypto.subtle.exportKey</code>(<a href="#crypto_export_key_format"><code>format</code></a>, <a href="#crypto_export_key_keydata"><code>key</code></a>)</dt> <dd> Exports a key: takes a key as a <a href="#cryptokey"><code>CryptoKey</code></a> object and returns the key in an external, portable format (since <a href="changes.html#njs0.7.10">0.7.10</a>). If the <code>format</code> was <code>jwk</code>, then the <code>Promise</code> fulfills with a JSON object containing the key. Otherwise, the promise fulfills with an <code>ArrayBuffer</code> containing the key. Possible values: <dl class="compact"> <dt id="crypto_export_key_format"><code>format</code></dt> <dd> a string that describes the data format in which the key should be exported, can be the following: <dl class="compact"> <dt><code>raw</code></dt> <dd> the raw data format </dd> <dt><code>pkcs8</code></dt> <dd> the <a href="https://datatracker.ietf.org/doc/html/rfc5208">PKCS #8</a> format </dd> <dt><code>spki</code></dt> <dd> the <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1">SubjectPublicKeyInfo</a> format </dd> <dt><code>jwk</code></dt> <dd> the <a href="https://datatracker.ietf.org/doc/html/rfc7517">JSON Web Key</a> (JWK) format (since <a href="changes.html#njs0.7.10">0.7.10</a>) </dd> </dl> </dd> <dt id="crypto_export_key_keydata"><code>key</code></dt> <dd> the <a href="#cryptokey"><code>CryptoKey</code></a> that contains the key to be exported </dd> </dl> </dd> <dt id="crypto_subtle_generate_key">
<code>сrypto.subtle.generateKey</code>(<a href="#crypto_generate_key_alg"><code>algorithm</code></a>, <a href="#crypto_generate_key_extractable"><code>extractable</code></a>, <a href="#crypto_generate_key_usage"><code>usage</code></a>)</dt> <dd> Generates a new key for symmetric algorithms or key pair for public-key algorithms (since <a href="changes.html#njs0.7.10">0.7.10</a>). Returns a <code>Promise</code> that fulfills with the generated key as a <a href="#cryptokey"><code>CryptoKey</code></a> or <a href="#cryptokeypair"><code>CryptoKeyPair</code></a> object. Possible values: <dl class="compact"> <dt id="crypto_generate_key_alg"><code>algorithm</code></dt> <dd> a dictionary object that defines the type of key to generate and provides extra algorithm-specific parameters: <ul class="compact"> <li> for <code>RSASSA-PKCS1-v1_5</code>, <code>RSA-PSS</code>, or <code>RSA-OAEP</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>RSASSA-PKCS1-v1_5</code>, <code>RSA-PSS</code>, or <code>RSA-OAEP</code>, depending on the used algorithm </li> <li> <code>hash</code> is a string that represents the name of the <code>digest</code> function to use, can be <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> </ul> </li> <li> for <code>ECDSA</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>ECDSA</code> </li> <li> <code>namedCurve</code> is a string that represents the name of the elliptic curve to use, may be <code>P-256</code>, <code>P-384</code>, or <code>P-521</code> </li> </ul> </li> <li> for <code>HMAC</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>HMAC</code> </li> <li> <code>hash</code> is a string that represents the name of the <code>digest</code> function to use, can be <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>length</code> (optional) is a number that represents the length in bits of the key. If omitted, the length of the key is equal to the length of the digest generated by the chosen digest function. </li> </ul> </li> <li> for <code>AES-CTR</code>, <code>AES-CBC</code>, or <code>AES-GCM</code>, pass the string identifying the algorithm or an object of the form <code>{ "name": "ALGORITHM" }</code>, where <code>ALGORITHM</code> is the name of the algorithm </li> </ul> </dd> <dt id="crypto_generate_key_extractable"><code>extractable</code></dt> <dd> boolean value that indicates if it is possible to export the key </dd> <dt id="crypto_generate_key_usage"><code>usage</code></dt> <dd> an <code>array</code> that indicates possible actions with the key: <dl class="compact"> <dt><code>encrypt</code></dt> <dd> key for encrypting messages </dd> <dt><code>decrypt</code></dt> <dd> key for decrypting messages </dd> <dt><code>sign</code></dt> <dd> key for signing messages </dd> <dt><code>verify</code></dt> <dd> key for verifying signatures </dd> <dt><code>deriveKey</code></dt> <dd> key for deriving a new key </dd> <dt><code>deriveBits</code></dt> <dd> key for deriving bits </dd> <dt><code>wrapKey</code></dt> <dd> key for wrapping a key </dd> <dt><code>unwrapKey</code></dt> <dd> key for unwrapping a key </dd> </dl> </dd> </dl> </dd> <dt id="crypto_subtle_import_key">
<code>сrypto.subtle.importKey</code>(<a href="#crypto_import_key_format"><code>format</code></a>, <a href="#crypto_import_key_keydata"><code>keyData</code></a>, <a href="#crypto_import_key_alg"><code>algorithm</code></a>, <a href="#crypto_import_key_extractable"><code>extractable</code></a>, <a href="#crypto_import_key_keyusages"><code>keyUsages</code></a>)</dt> <dd> Imports a key: takes as input a key in an external, portable format and gives a <a href="#cryptokey"><code>CryptoKey</code></a> object. Returns a <code>Promise</code> that fulfills with the imported key as a <a href="#cryptokey"><code>CryptoKey</code></a> object. Possible values: <dl class="compact"> <dt id="crypto_import_key_format"><code>format</code></dt> <dd> a string that describes the data format of the key to import, can be the following: <dl class="compact"> <dt><code>raw</code></dt> <dd> the raw data format </dd> <dt><code>pkcs8</code></dt> <dd> the <a href="https://datatracker.ietf.org/doc/html/rfc5208">PKCS #8</a> format </dd> <dt><code>spki</code></dt> <dd> the <a href="https://datatracker.ietf.org/doc/html/rfc5280#section-4.1">SubjectPublicKeyInfo</a> format </dd> <dt><code>jwk</code></dt> <dd> the <a href="https://datatracker.ietf.org/doc/html/rfc7517">JSON Web Key</a> (JWK) format (since <a href="changes.html#njs0.7.10">0.7.10</a>) </dd> </dl> </dd> <dt id="crypto_import_key_keydata"><code>keyData</code></dt> <dd> the <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> object that contains the key in the given format </dd> <dt id="crypto_import_key_alg"><code>algorithm</code></dt> <dd> a dictionary object that defines the type of key to import and provides extra algorithm-specific parameters: <ul class="compact"> <li> for <code>RSASSA-PKCS1-v1_5</code>, <code>RSA-PSS</code>, or <code>RSA-OAEP</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>RSASSA-PKCS1-v1_5</code>, <code>RSA-PSS</code>, or <code>RSA-OAEP</code>, depending on the used algorithm </li> <li> <code>hash</code> is a string that represents the name of the <code>digest</code> function to use, can be <code>SHA-1</code>, <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> </ul> </li> <li> for <code>ECDSA</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>ECDSA</code> </li> <li> <code>namedCurve</code> is a string that represents the name of the elliptic curve to use, may be <code>P-256</code>, <code>P-384</code>, or <code>P-521</code> </li> </ul> </li> <li> for <code>HMAC</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>HMAC</code> </li> <li> <code>hash</code> is a string that represents the name of the <code>digest</code> function to use, can be <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> <li> <code>length</code> (optional) is a number that represents the length in bits of the key. If omitted, the length of the key is equal to the length of the digest generated by the chosen digest function. </li> </ul> </li> <li> for <code>AES-CTR</code>, <code>AES-CBC</code>, or <code>AES-GCM</code>, pass the string identifying the algorithm or an object of the form <code>{ "name": "ALGORITHM" }</code>, where <code>ALGORITHM</code> is the name of the algorithm </li> <li> for <code>PBKDF2</code>, pass the <code>PBKDF2</code> string </li> <li> for <code>HKDF</code>, pass the <code>HKDF</code> string </li> </ul> </dd> <dt id="crypto_import_key_extractable"><code>extractable</code></dt> <dd> boolean value that indicates if it is possible to export the key </dd> <dt id="crypto_import_key_keyusages"><code>keyUsages</code></dt> <dd> an <code>array</code> that indicates possible actions with the key: <dl class="compact"> <dt><code>encrypt</code></dt> <dd> key for encrypting messages </dd> <dt><code>decrypt</code></dt> <dd> key for decrypting messages </dd> <dt><code>sign</code></dt> <dd> key for signing messages </dd> <dt><code>verify</code></dt> <dd> key for verifying signatures </dd> <dt><code>deriveKey</code></dt> <dd> key for deriving a new key </dd> <dt><code>deriveBits</code></dt> <dd> key for deriving bits </dd> <dt><code>wrapKey</code></dt> <dd> key for wrapping a key </dd> <dt><code>unwrapKey</code></dt> <dd> key for unwrapping a key </dd> </dl> </dd> </dl> </dd> <dt id="crypto_subtle_sign">
<code>сrypto.subtle.sign</code>(<a href="#crypto_sign_alg"><code>algorithm</code></a>, <a href="#crypto_sign_key"><code>key</code></a>, <a href="#crypto_sign_data"><code>data</code></a>)</dt> <dd> Returns <code>signature</code> as a <code>Promise</code> that fulfills with an <code>ArrayBuffer</code> containing the signature. Possible values: <dl class="compact"> <dt id="crypto_sign_alg"><code>algorithm</code></dt> <dd> is a string or object that specifies the signature algorithm to use and its parameters: <ul class="compact"> <li> for <code>RSASSA-PKCS1-v1_5</code>, pass the string identifying the algorithm or an object of the form <code>{ "name": "ALGORITHM" }</code> </li> <li> for <code>RSA-PSS</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>RSA-PSS</code> </li> <li> <code>saltLength</code> is a long <code>integer</code> that represents the length of the random salt to use, in bytes </li> </ul> </li> <li> for <code>ECDSA</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>ECDSA</code> </li> <li> <code>hash</code> is an identifier for the digest algorithm to use, can be <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> </ul> </li> <li> for <code>HMAC</code>, pass the string identifying the algorithm or an object of the form <code>{ "name": "ALGORITHM" }</code> </li> </ul> </dd> <dt id="crypto_sign_key"><code>key</code></dt> <dd> is a <a href="#cryptokey"><code>CryptoKey</code></a> object that the key to be used for signing. If algorithm identifies a public-key cryptosystem, this is the private key. </dd> <dt id="crypto_sign_data"><code>data</code></dt> <dd> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> object that contains the data to be signed </dd> </dl> </dd> <dt id="crypto_subtle_verify">
<code>сrypto.subtle.verify</code>(<a href="#crypto_verify_alg"><code>algorithm</code></a>, <a href="#crypto_verify_key"><code>key</code></a>, <a href="#crypto_verify_signature"><code>signature</code></a>, <a href="#crypto_verify_data"><code>data</code></a>)</dt> <dd> Verifies a digital signature, returns a <code>Promise</code> that fulfills with a boolean value: <code>true</code> if the signature is valid, otherwise <code>false</code>. Possible values: <dl class="compact"> <dt id="crypto_verify_alg"><code>algorithm</code></dt> <dd> is a string or object that specifies the algorithm to use and its parameters: <ul class="compact"> <li> for <code>RSASSA-PKCS1-v1_5</code>, pass the string identifying the algorithm or an object of the form <code>{ "name": "ALGORITHM" }</code> </li> <li> for <code>RSA-PSS</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>RSA-PSS</code> </li> <li> <code>saltLength</code> is a long <code>integer</code> that represents the length of the random salt to use, in bytes </li> </ul> </li> <li> for <code>ECDSA</code>, pass the object with the following keys: <ul class="compact"> <li> <code>name</code> is a string, should be set to <code>ECDSA</code> </li> <li> <code>hash</code> is an identifier for the digest algorithm to use, can be <code>SHA-256</code>, <code>SHA-384</code>, or <code>SHA-512</code> </li> </ul> </li> <li> for <code>HMAC</code>, pass the string identifying the algorithm or an object of the form <code>{ "name": "ALGORITHM" }</code> </li> </ul> </dd> <dt id="crypto_verify_key"><code>key</code></dt> <dd> is a <a href="#cryptokey"><code>CryptoKey</code></a> object that the key to be used for verifying. It is the secret key for a symmetric algorithm and the public key for a public-key system. </dd> <dt id="crypto_verify_signature"><code>signature</code></dt> <dd> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> that contains the signature to verify </dd> <dt id="crypto_verify_data"><code>data</code></dt> <dd> is an <code>ArrayBuffer</code>, <code>TypedArray</code>, or <code>DataView</code> object that contains the data whose signature is to be verified </dd> </dl> </dd> </dl>

<h4 id="cryptokey">CryptoKey</h4>

<table width="100%"> <tr><td><a href="#cryptokey_alg"><code>CryptoKey.algorithm</code></a></td></tr> <tr><td><a href="#cryptokey_extractable"><code>CryptoKey.extractable</code></a></td></tr> <tr><td><a href="#cryptokey_type"><code>CryptoKey.type</code></a></td></tr> <tr><td><a href="#cryptokey_usages"><code>CryptoKey.usages</code></a></td></tr> </table> <p> The <code>CryptoKey</code> object represents a cryptographic <code>key</code> obtained from one of the <code>SubtleCrypto</code> methods: <a href="#crypto_subtle_generate_key"><code>сrypto.subtle.generateKey()</code></a>, <a href="#crypto_subtle_derive_key"><code>сrypto.subtle.deriveKey()</code></a>, <a href="#crypto_subtle_import_key"><code>сrypto.subtle.importKey()</code></a>. </p>
 <dl class="compact"> <dt id="cryptokey_alg"><code>CryptoKey.algorithm</code></dt> <dd> returns an object describing the algorithm for which this key can be used and any associated extra parameters (since <a href="changes.html#njs0.8.0">0.8.0</a>), read-only </dd> <dt id="cryptokey_extractable"><code>CryptoKey.extractable</code></dt> <dd> a boolean value, <code>true</code> if the key can be exported (since <a href="changes.html#njs0.8.0">0.8.0</a>), read-only </dd> <dt id="cryptokey_type"><code>CryptoKey.type</code></dt> <dd> a string value that indicates which kind of key is represented by the object, read-only. Possible values: <dl class="compact"> <dt><code>secret</code></dt> <dd> This key is a secret key for use with a symmetric algorithm. </dd> <dt><code>private</code></dt> <dd> This key is the private half of an asymmetric algorithm's <a href="#cryptokeypair"><code>CryptoKeyPair</code></a> </dd> <dt><code>public</code></dt> <dd> This key is the public half of an asymmetric algorithm's <a href="#cryptokeypair"><code>CryptoKeyPair</code></a>. </dd> </dl> </dd> <dt id="cryptokey_usages"><code>CryptoKey.usages</code></dt> <dd> An array of strings indicating what this key can be used for (since <a href="changes.html#njs0.8.0">0.8.0</a>), read-only. Possible array values: <dl class="compact"> <dt><code>encrypt</code></dt> <dd> key for encrypting messages </dd> <dt><code>decrypt</code></dt> <dd> key for decrypting messages </dd> <dt><code>sign</code></dt> <dd> key for signing messages </dd> <dt><code>verify</code></dt> <dd> key for verifying signatures </dd> <dt><code>deriveKey</code></dt> <dd> key for deriving a new key </dd> <dt><code>deriveBits</code></dt> <dd> key for deriving bits </dd> </dl> </dd> </dl>

<h4 id="cryptokeypair">CryptoKeyPair</h4>

<table width="100%"> <tr><td><a href="#cryptokeypair_privatekey"><code>CryptoKeyPair.privateKey</code></a></td></tr> <tr><td><a href="#cryptokeypair_publickey"><code>CryptoKeyPair.publicKey</code></a></td></tr> </table> <p> The <code>CryptoKeyPair</code> is a dictionary object of the <a href="#builtin_crypto">WebCrypto API</a> that represents an asymmetric key pair. </p>
 <dl class="compact"> <dt id="cryptokeypair_privatekey"><code>CryptoKeyPair.privateKey</code></dt> <dd> A <a href="#cryptokey"><code>CryptoKey</code></a> object representing the private key. </dd> <dt id="cryptokeypair_publickey"><code>CryptoKeyPair.publicKey</code></dt> <dd> A <a href="#cryptokey"><code>CryptoKey</code></a> object representing the public key. </dd> </dl>

<h4 id="njs">njs</h4>

<table width="100%"> <tr><td><a href="#njs_version"><code>njs.version</code></a></td></tr> <tr><td><a href="#njs_version_number"><code>njs.version_number</code></a></td></tr> <tr><td><a href="#njs_dump"><code>njs.dump()</code></a></td></tr> <tr><td><a href="#njs_memory_stats"><code>njs.memoryStats</code></a></td></tr> <tr><td><a href="#njs_on"><code>njs.on()</code></a></td></tr> </table> <p> The <code>njs</code> object is a global object that represents the current VM instance (since <a href="changes.html#njs0.2.0">0.2.0</a>). </p>
 <dl class="compact"> <dt id="njs_version"><code>njs.version</code></dt> <dd> Returns a string with the current version of njs (for example, “0.7.4”). </dd> <dt id="njs_version_number"><code>njs.version_number</code></dt> <dd> Returns a number with the current version of njs. For example, “0.7.4” is returned as <code>0x000704</code> (since <a href="changes.html#njs0.7.4">0.7.4</a>). </dd> <dt id="njs_dump"><code>njs.dump(<i>value</i>)</code></dt> <dd> Returns the pretty-print string representation for a value. </dd> <dt id="njs_memory_stats"><code>njs.memoryStats</code></dt> <dd> Object containing memory statistics for current VM instance (since <a href="changes.html#njs0.7.8">0.7.8</a>). <dl class="compact"> <dt><code>size</code></dt> <dd> amount of memory in bytes njs memory pool claimed from the operating system. </dd> </dl> </dd> <dt id="njs_on"><code>njs.on(<i>event</i>,
<i>callback</i>)</code></dt> <dd> Registers a callback for the specified VM event (since <a href="changes.html#njs0.5.2">0.5.2</a>). An event may be one of the following strings: <dl class="compact"> <dt><code>exit</code></dt> <dd> is called before the VM is destroyed. The callback is called without arguments. </dd> </dl> </dd> </dl>

<h4 id="process">process</h4>

<table width="100%"> <tr><td><a href="#process_argv"><code>process.argv</code></a></td></tr> <tr><td><a href="#process_env"><code>process.env</code></a></td></tr> <tr><td><a href="#process_pid"><code>process.pid</code></a></td></tr> <tr><td><a href="#process_ppid"><code>process.ppid</code></a></td></tr> </table> <p> The <code>process</code> object is a global object that provides information about the current process (<a href="changes.html#njs0.3.3">0.3.3</a>). </p>
 <dl class="compact"> <dt id="process_argv"><code>process.argv</code></dt> <dd> Returns an array that contains the command line arguments passed when the current process was launched. </dd> <dt id="process_env"><code>process.env</code></dt> <dd> Returns an object containing the user environment. <blockquote class="note"> By default, nginx removes all environment variables inherited from its parent process except the TZ variable. Use the <a href="../ngx_core_module.html#env">env</a> directive to preserve some of the inherited variables. </blockquote> </dd> <dt id="process_pid"><code>process.pid</code></dt> <dd> Returns the PID of the current process. </dd> <dt id="process_ppid"><code>process.ppid</code></dt> <dd> Returns the PID of the current parent process. </dd> </dl>

<h4 id="string">String</h4>
<p> By default all strings in njs are Unicode strings. They correspond to ECMAScript strings that contain Unicode characters. Before <a href="changes.html#njs0.8.0">0.8.0</a>, byte strings were also supported. </p>
<h4 id="byte_string">Byte strings</h4>
 <blockquote class="note"> Since <a href="changes.html#njs0.8.0">0.8.0</a>, the support for byte strings and byte string methods were removed. When working with byte sequence, the <a href="#buffer">Buffer</a> object and <code>Buffer</code> properties, such as <a href="#r_request_buffer"><code>r.requestBuffer</code></a>, <a href="#r_raw_variables"><code>r.rawVariables</code></a>, should be used. </blockquote>

<p> Byte strings contain a sequence of bytes and are used to serialize Unicode strings to external data and deserialize from external sources. For example, the <a href="#string_toutf8">toUTF8()</a> method serializes a Unicode string to a byte string using UTF-8 encoding: </p> <pre data-language="nginx">
&gt;&gt; '£'.toUTF8().toString('hex')
'c2a3'  /* C2 A3 is the UTF-8 representation of 00A3 ('£') code point */
</pre>
<p> The <a href="#string_tobytes">toBytes()</a> method serializes a Unicode string with code points up to 255 into a byte string, otherwise, <code>null</code> is returned: </p> <pre data-language="nginx">
&gt;&gt; '£'.toBytes().toString('hex')
'a3'  /* a3 is a byte equal to 00A3 ('£') code point  */
</pre>
 <dl class="compact"> <dt id="string_bytesfrom"><code>String.bytesFrom(<i>array</i>
| <i>string</i>, <i>encoding</i>)</code></dt> <dd> The method was made obsolete in <a href="changes.html#njs0.4.4">0.4.4</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. The <code>Buffer.from</code> method should be used instead: <pre data-language="nginx">
&gt;&gt; Buffer.from([0x62, 0x75, 0x66, 0x66, 0x65, 0x72]).toString()
'buffer'

&gt;&gt; Buffer.from('YnVmZmVy', 'base64').toString()
'buffer'
</pre> Before <a href="changes.html#njs0.4.4">0.4.4</a>, created a byte string either from an array that contained octets, or from an encoded string (<a href="changes.html#njs0.2.3">0.2.3</a>), the encoding could be <code>hex</code>, <code>base64</code>, and <code>base64url</code>. </dd> <dt id="string_frombytes"><code>String.prototype.fromBytes(<i>start</i>[,
<i>end</i>])</code></dt> <dd> the property was made obsolete in <a href="changes.html#njs0.7.7">0.7.7</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. Before <a href="changes.html#njs0.7.7">0.7.7</a>, returned a new Unicode string from a byte string where each byte was replaced with a corresponding Unicode code point. </dd> <dt id="string_fromutf8"><code>String.prototype.fromUTF8(<i>start</i>[,
<i>end</i>])</code></dt> <dd> the property was made obsolete in <a href="changes.html#njs0.7.7">0.7.7</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. The <a href="#textedeoder"><code>TextDecoder</code></a> method should be used instead. Before <a href="changes.html#njs0.7.7">0.7.7</a>, converted a byte string containing a valid UTF-8 string into a Unicode string, otherwise <code>null</code> was returned. </dd> <dt id="string_tobytes"><code>String.prototype.toBytes(<i>start</i>[,
<i>end</i>])</code></dt> <dd> the property was made obsolete in <a href="changes.html#njs0.7.7">0.7.7</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. Before <a href="changes.html#njs0.7.7">0.7.7</a>, serialized a Unicode string to a byte string, returned <code>null</code> if a character larger than 255 was found in the string. </dd> <dt id="string_tostring"><code>String.prototype.toString(<i>encoding</i>)</code></dt> <dd> <p> the property was made obsolete in <a href="changes.html#njs0.7.7">0.7.7</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. Before <a href="changes.html#njs0.7.7">0.7.7</a>, encoded a string to <code>hex</code>, <code>base64</code>, or <code>base64url</code>: </p> <pre data-language="nginx">
&gt;&gt;  'αβγδ'.toString('base64url')
'zrHOss6zzrQ'
</pre>
<p> Before version <a href="changes.html#njs0.4.3">0.4.3</a>, only a <a href="#string_tobytes">byte string</a> could be encoded: </p> <pre data-language="nginx">
&gt;&gt;  'αβγδ'.toUTF8().toString('base64url')
'zrHOss6zzrQ'
</pre>
 </dd> <dt id="string_toutf8"><code>String.prototype.toUTF8(<i>start</i>[,
<i>end</i>])</code></dt> <dd> the property was made obsolete in <a href="changes.html#njs0.7.7">0.7.7</a> and was removed in <a href="changes.html#njs0.8.0">0.8.0</a>. The <a href="#textencoder"><code>TextEncoder</code></a> method should be used instead. Before <a href="changes.html#njs0.7.7">0.7.7</a>, serialized a Unicode string to a byte string using UTF-8 encoding: <pre data-language="nginx">
&gt;&gt; 'αβγδ'.toUTF8().length
8
&gt;&gt; 'αβγδ'.length
4
</pre> </dd> </dl>

<h4 id="webapi">web API</h4>
<h4 id="textdecoder">Text Decoder</h4>

<table width="100%"> <tr><td><a href="#textdecoder_constructor"><code>TextDecoder()</code></a></td></tr> <tr><td><a href="#textdecoder_encoding"><code>TextDecoder.prototype.encoding</code></a></td></tr> <tr><td><a href="#textdecoder_fatal"><code>TextDecoder.prototype.fatal</code></a></td></tr> <tr><td><a href="#textdecoder_ignorebom"><code>TextDecoder.prototype.ignoreBOM</code></a></td></tr> <tr><td><a href="#textdecoder_decode"><code>TextDecoder.prototype.decode()</code></a></td></tr> </table> <p> The <code>TextDecoder</code> produces a stream of code points from a stream of bytes (<a href="changes.html#njs0.4.3">0.4.3</a>). </p>
 <dl class="compact"> <dt id="textdecoder_constructor"><code>TextDecoder([[<i>encoding</i>],
<i>options</i>])</code></dt> <dd> Creates a new <code>TextDecoder</code> object for specified <code>encoding</code>, currently, only UTF-8 is supported. The <code>options</code> is <code>TextDecoderOptions</code> dictionary with the property: <dl class="compact"> <dt><code>fatal</code></dt> <dd> boolean flag indicating if <a href="#textdecoder_decode"><code>TextDecoder.decode()</code></a> must throw the <code><i>TypeError</i></code> exception when a coding error is found, by default is <code>false</code>. </dd> </dl> </dd> <dt id="textdecoder_encoding"><code>TextDecoder.prototype.encoding</code></dt> <dd> Returns a string with the name of the encoding used by <a href="#textdecoder"><code>TextDecoder()</code></a>, read-only. </dd> <dt id="textdecoder_fatal"><code>TextDecoder.prototype.fatal</code></dt> <dd> boolean flag, <code>true</code> if the error mode is fatal, read-only. </dd> <dt id="textdecoder_ignorebom"><code>TextDecoder.prototype.ignoreBOM</code></dt> <dd> boolean flag, <code>true</code> if the byte order marker is ignored, read-only. </dd> <dt id="textdecoder_decode"><code>TextDecoder.prototype.decode(<i>buffer</i>,
[<i>options</i>])</code></dt> <dd> Returns a string with the text decoded from the <code>buffer</code> by <a href="#textdecoder"><code>TextDecoder()</code></a>. The buffer can be <code>ArrayBuffer</code>. The <code>options</code> is <code>TextDecodeOptions</code> dictionary with the property: <dl class="compact"> <dt><code>stream</code></dt> <dd> boolean flag indicating if additional data will follow in subsequent calls to <code>decode()</code>: <code>true</code> if processing the data in chunks, and <code>false</code> for the final chunk or if the data is not chunked. By default is <code>false</code>. </dd> </dl> <pre data-language="nginx">
&gt;&gt; (new TextDecoder()).decode(new Uint8Array([206,177,206,178]))
αβ
</pre> </dd> </dl>

<h4 id="textencoder">Text Encoder</h4>

<table width="100%"> <tr><td><a href="#textencoder_constructor"><code>TextEncoder()</code></a></td></tr> <tr><td><a href="#textencoder_encode"><code>TextEncoder.prototype.encode()</code></a></td></tr> <tr><td><a href="#textencoder_encodeinto"><code>TextEncoder.prototype.encodeInto()</code></a></td></tr> </table> <p> The <code>TextEncoder</code> object produces a byte stream with UTF-8 encoding from a stream of code points (<a href="changes.html#njs0.4.3">0.4.3</a>). </p>
 <dl class="compact"> <dt id="textencoder_constructor"><code>TextEncoder()</code></dt> <dd> Returns a newly constructed <code>TextEncoder</code> that will generate a byte stream with UTF-8 encoding. </dd> <dt id="textencoder_encode"><code>TextEncoder.prototype.encode(<i>string</i>)</code></dt> <dd> Encodes <code>string</code> into a <code>Uint8Array</code> with UTF-8 encoded text. </dd> <dt id="textencoder_encodeinto"><code>TextEncoder.prototype.encodeInto(<i>string</i>,
<i>uint8Array</i>)</code></dt> <dd> Encodes a <code>string</code> to UTF-8, puts the result into destination <code>Uint8Array</code>, and returns a dictionary object that shows the progress of the encoding. The dictionary object contains two members: <dl class="compact"> <dt><code>read</code></dt> <dd> the number of UTF-16 units of code from the source <code>string</code> converted to UTF-8 </dd> <dt><code>written</code></dt> <dd> the number of bytes modified in the destination <code>Uint8Array</code> </dd> </dl> </dd> </dl>

<h4 id="njs_api_timers">timers</h4>

<table width="100%"> <tr><td><a href="#cleartimeout"><code>clearTimeout()</code></a></td></tr> <tr><td><a href="#settimeout"><code>setTimeout()</code></a></td></tr> </table>  <dl class="compact"> <dt id="cleartimeout"><code>clearTimeout(<i>timeout</i>)</code></dt> <dd> Cancels a <code>timeout</code> object created by <a href="#settimeout"><code>setTimeout()</code></a>. </dd> <dt id="settimeout"><code>setTimeout(<i>function</i>,
<i>milliseconds</i>[,
<i>argument1</i>,
<i>argumentN</i>])</code></dt> <dd> Calls a <code>function</code> after a specified number of <code>milliseconds</code>. One or more optional <code>arguments</code> can be passed to the specified function. Returns a <code>timeout</code> object. <pre data-language="nginx">
function handler(v)
{
    // ...
}

t = setTimeout(handler, 12);

// ...

clearTimeout(t);
</pre> </dd> </dl>

<h4 id="njs_global_functions">Global functions</h4>

<table width="100%"> <tr><td><a href="#atob"><code>atob()</code></a></td></tr> <tr><td><a href="#btoa"><code>btoa()</code></a></td></tr> </table>  <dl class="compact"> <dt id="atob"><code>atob(<i>encodedData</i>)</code></dt> <dd> Decodes a string of data which has been encoded using <code>Base64</code> encoding. The <code>encodedData</code> parameter is a binary string that contains Base64-encoded data. Returns a string that contains decoded data from <code>encodedData</code>. <p> The similar <a href="#btoa"><code>btoa()</code></a> method can be used to encode and transmit data which may otherwise cause communication problems, then transmit it and use the <code>atob()</code> method to decode the data again. For example, you can encode, transmit, and decode control characters such as ASCII values <code>0</code> through <code>31</code>. </p> <pre data-language="nginx">
const encodedData = btoa("text to encode"); // encode a string
const decodedData = atob(encodedData); // decode the string
</pre>
 </dd> <dt id="btoa"><code>btoa(<i>stringToEncode</i>)</code></dt> <dd> Creates a Base64-encoded ASCII string from a binary string. The <code>stringToEncode</code> parameter is a binary string to encode. Returns an ASCII string containing the Base64 representation of <code>stringToEncode</code>. <p> The method can be used to encode data which may otherwise cause communication problems, transmit it, then use the <a href="#atob"><code>atob()</code></a> method to decode the data again. For example, you can encode control characters such as ASCII values <code>0</code> through <code>31</code>. </p> <pre data-language="nginx">
const encodedData = btoa("text to encode"); // encode a string
const decodedData = atob(encodedData); // decode the string
</pre>
 </dd> </dl>

<h4 id="builtin_modules">built-in modules</h4>
<h4 id="buffer">Buffer</h4>

<table width="100%"> <tr><td><a href="#buffer_alloc"><code>Buffer.alloc()</code></a></td></tr> <tr><td><a href="#buffer_alloc_unsafe"><code>Buffer.allocUnsafe()</code></a></td></tr> <tr><td><a href="#buffer_bytelength"><code>Buffer.byteLength()</code></a></td></tr> <tr><td><a href="#buffer_compare"><code>Buffer.compare()</code></a></td></tr> <tr><td><a href="#buffer_concat"><code>Buffer.concat()</code></a></td></tr> <tr><td><a href="#buffer_from_array"><code>Buffer.from(array)</code></a></td></tr> <tr><td><a href="#buffer_from_arraybuffer"><code>Buffer.from(arrayBuffer)</code></a></td></tr> <tr><td><a href="#buffer_from_buffer"><code>Buffer.from(buffer)</code></a></td></tr> <tr><td><a href="#buffer_from_object"><code>Buffer.from(object)</code></a></td></tr> <tr><td><a href="#buffer_from_string"><code>Buffer.from(string)</code></a></td></tr> <tr><td><a href="#buffer_is_buffer"><code>Buffer.isBuffer()</code></a></td></tr> <tr><td><a href="#buffer_is_encoding"><code>Buffer.isEncoding()</code></a></td></tr> <tr><td><a href="#buf_index"><code>buffer[]</code></a></td></tr> <tr><td><a href="#buf_buffer"><code>buf.buffer</code></a></td></tr> <tr><td><a href="#buf_byte_offset"><code>buf.byteOffset</code></a></td></tr> <tr><td><a href="#buf_compare"><code>buf.compare()</code></a></td></tr> <tr><td><a href="#buf_copy"><code>buf.copy()</code></a></td></tr> <tr><td><a href="#buf_equals"><code>buf.equals()</code></a></td></tr> <tr><td><a href="#buf_fill"><code>buf.fill()</code></a></td></tr> <tr><td><a href="#buf_includes"><code>buf.includes()</code></a></td></tr> <tr><td><a href="#buf_indexof"><code>buf.indexOf()</code></a></td></tr> <tr><td><a href="#buf_lastindexof"><code>buf.lastIndexOf()</code></a></td></tr> <tr><td><a href="#buf_length"><code>buf.length</code></a></td></tr> <tr><td><a href="#buf_readintbe"><code>buf.readIntBE()</code></a></td></tr> <tr><td><a href="#buf_readintle"><code>buf.readIntLE()</code></a></td></tr> <tr><td><a href="#buf_readuintbe"><code>buf.readUIntBE()</code></a></td></tr> <tr><td><a href="#buf_readuintle"><code>buf.readUIntLE()</code></a></td></tr> <tr><td><a href="#buf_readdobulebe"><code>buf.readDoubleBE</code></a></td></tr> <tr><td><a href="#buf_readdobulele"><code>buf.readDoubleLE()</code></a></td></tr> <tr><td><a href="#buf_readfloatbe"><code>buf.readFloatBE()</code></a></td></tr> <tr><td><a href="#buf_readfloatle"><code>buf.readFloatLE()</code></a></td></tr> <tr><td><a href="#buf_subarray"><code>buf.subarray()</code></a></td></tr> <tr><td><a href="#buf_slice"><code>buf.slice()</code></a></td></tr> <tr><td><a href="#buf_swap16"><code>buf.swap16()</code></a></td></tr> <tr><td><a href="#buf_swap32"><code>buf.swap32()</code></a></td></tr> <tr><td><a href="#buf_swap64"><code>buf.swap64()</code></a></td></tr> <tr><td><a href="#buf_tojson"><code>buf.toJSON()</code></a></td></tr> <tr><td><a href="#buf_tostring"><code>buf.toString()</code></a></td></tr> <tr><td><a href="#buf_write"><code>buf.write()</code></a></td></tr> <tr><td><a href="#buf_writeintbe"><code>buf.writeIntBE()</code></a></td></tr> <tr><td><a href="#buf_writeintle"><code>buf.writeIntLE()</code></a></td></tr> <tr><td><a href="#buf_writeuintbe"><code>buf.writeUIntBE()</code></a></td></tr> <tr><td><a href="#buf_writeuintle"><code>buf.writeUIntLE()</code></a></td></tr> <tr><td><a href="#buf_writedoublebe"><code>buf.writeDoubleBE()</code></a></td></tr> <tr><td><a href="#buf_writedoublele"><code>buf.writeDoubleLE()</code></a></td></tr> <tr><td><a href="#buf_writefloatbe"><code>buf.writeFloatBE()</code></a></td></tr> <tr><td><a href="#buf_writefloatle"><code>buf.writeFloatLE()</code></a></td></tr> </table>  <dl class="compact"> <dt id="buffer_alloc"><code>Buffer.alloc(<i>size</i>[,
<i>fill</i>[,
<i>encoding</i>]]))</code></dt> <dd> <p> Allocates a new Buffer of a specified <code><i>size</i></code>. If <code><i>fill</i></code> is not specified, the Buffer will be zero-filled. If <code><i>fill</i></code> is specified, the allocated Buffer will be initialized by calling <a href="#buf_fill"><code>buf.fill(fill)</code></a>. If <code><i>fill</i></code> and <code><i>encoding</i></code> are specified, the allocated Buffer will be initialized by calling <a href="#buf_fill"><code>buf.fill(fill,
encoding)</code></a>. </p> <p> The <code><i>fill</i></code> parameter may be a <code><i>string</i></code>, <code><i>Buffer</i></code>, <code><i>Uint8Array</i></code>, or <code><i>integer</i></code>. </p> </dd> <dt id="buffer_alloc_unsafe"><code>Buffer.allocUnsafe(<i>size</i>)</code></dt> <dd> <p> The same as <a href="#buffer_alloc"><code>Buffer.alloc()</code></a>, with the difference that the memory allocated for the buffer is not initialized, the contents of the new buffer is unknown and may contain sensitive data. </p> </dd> <dt id="buffer_bytelength"><code>Buffer.byteLength(<i>value</i>[,
<i>encoding</i>])</code></dt> <dd> Returns the byte length of a specified value, when encoded using <code><i>encoding</i></code>. The value can be a <code>string</code>, <code>Buffer</code>, <code>TypedArray</code>, <code>DataView</code>, or <code>ArrayBuffer</code>. If the value is a <code><i>string</i></code>, the <code>encoding</code> parameter is its encoding, can be <code><i>utf8</i></code>, <code><i>hex</i></code>, <code><i>base64</i></code>, <code><i>base64url</i></code>; by default is <code><i>utf8</i></code>. </dd> <dt id="buffer_compare"><code>Buffer.compare(<i>buffer1</i>,
<i>buffer2</i>)</code></dt> <dd> Compares <code><i>buffer1</i></code> with <code><i>buffer2</i></code> when sorting arrays of Buffer instances. Returns <code>0</code> if <code><i>buffer1</i></code> is the same as <code><i>buffer2</i></code>, <code>1</code> if <code><i>buffer2</i></code> should come before <code><i>buffer1</i></code> when sorted, or <code>-1</code> if <code><i>buffer2</i></code> should come after <code><i>buffer1</i></code> when sorted. </dd> <dt id="buffer_concat"><code>Buffer.concat(<i>list</i>[,
<i>totalLength</i>])</code></dt> <dd> Returns a new Buffer which is the result of concatenating all the Buffer instances in the list. If there are no items in the list or the total length is 0, a new zero-length Buffer is returned. If <code><i>totalLength</i></code> is not specified, it is calculated from the Buffer instances in list by adding their lengths. If <code><i>totalLength</i></code> is specified, it is coerced to an unsigned integer. If the combined length of the Buffers in list exceeds <code><i>totalLength</i></code>, the result is truncated to <code><i>totalLength</i></code>. </dd> <dt id="buffer_from_array"><code>Buffer.from(<i>array</i>)</code></dt> <dd> Allocates a new Buffer using an array of bytes in the range <code>0</code> – <code>255</code>. Array entries outside that range will be truncated. </dd> <dt id="buffer_from_arraybuffer"><code>Buffer.from(<i>arrayBuffer</i>,
<i>byteOffset</i>[,
<i>length</i>]])</code></dt> <dd> Creates a view of the <code><i>ArrayBuffer</i></code> without copying the underlying memory. The optional <code><i>byteOffset</i></code> and <code><i>length</i></code> arguments specify a memory range within the <code><i>arrayBuffer</i></code> that will be shared by the Buffer. </dd> <dt id="buffer_from_buffer"><code>Buffer.from(<i>buffer</i>)</code></dt> <dd> Copies the passed buffer data onto a new Buffer instance. </dd> <dt id="buffer_from_object"><code>Buffer.from(<i>object</i>[,
<i>offsetOrEncoding</i>[,
<i>length</i>]])</code></dt> <dd> For objects whose <code>valueOf()</code> function returns a value not strictly equal to object, returns <code>Buffer.from(object.valueOf()</code>, <code>offsetOrEncoding</code>, <code>length</code>). </dd> <dt id="buffer_from_string"><code>Buffer.from(<i>string</i>[,
<i>encoding</i>])</code></dt> <dd> Creates a new Buffer with a <code><i>string</i></code>. The <code><i>encoding</i></code> parameter identifies the character encoding to be used when converting a string into bytes. The encoding can be <code>utf8</code>, <code>hex</code>, <code>base64</code>, <code>base64url</code>; by default is <code>utf8</code>. </dd> <dt id="buffer_is_buffer"><code>Buffer.isBuffer(<i>object</i>)</code></dt> <dd> A boolean value, returns <code>true</code> if <code><i>object</i></code> is a Buffer. </dd> <dt id="buffer_is_encoding"><code>Buffer.isEncoding(<i>encoding</i>)</code></dt> <dd> A boolean value, returns <code>true</code> if encoding is the name of a supported character encoding. </dd> <dt id="buf_index"><code>buffer[<i>index</i>]</code></dt> <dd> The index operator that can be used to get and set the octet at position <code>index</code> in <code>buffer</code>. The values refer to individual bytes, so the legal value range is between 0 and 255 (decimal). </dd> <dt id="buf_buffer"><code>buf.buffer</code></dt> <dd> The underlying <code>ArrayBuffer</code> object based on which this Buffer object is created. </dd> <dt id="buf_byte_offset"><code>buf.byteOffset</code></dt> <dd> An integer, specifying the <code>byteOffset</code> of the Buffers underlying <code>ArrayBuffer</code> object. </dd> <dt id="buf_compare"><code>buf.compare(<i>target</i>[,
<i>targetStart</i>[,
<i>targetEnd</i>[,
<i>sourceStart</i>[,
<i>sourceEnd</i>]]]])</code></dt> <dd> Compares buffer with <code><i>target</i></code> and returns a number indicating whether buffer comes before, after, or is the same as <code><i>target</i></code> in sort order. Comparison is based on the actual sequence of bytes in each Buffer. The <code>targetStart</code> is an integer specifying the offset within <code><i>target</i></code> at which to begin comparison, by default is 0. The <code>targetEnd</code> is an integer specifying the offset within <code><i>target</i></code> at which to end comparison, by default is <code>target.length</code>. The <code>sourceStart</code> is an integer specifying the offset within buffer at which to begin comparison, by default is 0. The <code>sourceEnd</code> is an integer specifying the offset within buffer at which to end comparison (not inclusive), by default is <code>buf.length</code>. </dd> <dt id="buf_copy"><code>buf.copy(<i>target</i>[,
<i>targetStart</i>[,
<i>sourceStart</i>[,
<i>sourceEnd</i>]]])</code></dt> <dd> Copies data from a region of buffer to a region in <code><i>target</i></code>, even if the target memory region overlaps with buffer. The <code>target</code> parameter is a <code><i>Buffer</i></code> or <code><i>Uint8Array</i></code> to copy into. <p> The <code>targetStart</code> is an integer specifying the offset within target at which to begin writing, by default is 0. The <code>sourceStart</code> is an integer specifying the offset within buffer from which to begin copying, by default is 0. The <code>sourceEnd</code> is an integer specifying the offset within buffer at which to stop copying (not inclusive) by default is <code><i>buf.length</i></code>. </p> </dd> <dt id="buf_equals"><code>buf.equals(<i>otherBuffer</i>)</code></dt> <dd> A boolean value, returns <code>true</code> if both Buffer and <code><i>otherBuffer</i></code> have exactly the same bytes. </dd> <dt id="buf_fill"><code>buf.fill(<i>value</i>[,
<i>offset</i>[,
<i>end</i>]][,
<i>encoding</i>])</code></dt> <dd> Fills the Buffer with the specified <code><i>value</i></code>. If the <code><i>offset</i></code> and <code><i>end</i></code> are not specified, the entire Buffer will be filled. The <code><i>value</i></code> is coerced to <code><i>uint32</i></code> if it is not a <code>string</code>, <code>Buffer</code>, or <code>integer</code>. If the resulting integer is greater than 255, the Buffer will be filled with <code><i>value</i></code> and 255. </dd> <dt id="buf_includes"><code>buf.includes(<i>value</i>[,
<i>byteOffset</i>][,
<i>encoding</i>])</code></dt> <dd> Equivalent to <a href="#buf_indexof"><code>buf.indexOf()</code></a> <code>!== -1</code>, returns <code>true</code> if the <code><i>value</i></code> was found in Buffer. </dd> <dt id="buf_indexof"><code>buf.indexOf(<i>value</i>[,
<i>byteOffset</i>][,
<i>encoding</i>])</code></dt> <dd> Returns an integer which is the index of the first occurrence of <code><i>value</i></code> in Buffer, or <code><i>-1</i></code> if Buffer does not contain value. The <code><i>value</i></code> can be a <code>string</code> with specified <code><i>encoding</i></code> (by default <code><i>utf8</i></code>), <code>Buffer</code>, <code>Unit8Array</code>, or a number between 0 and 255. </dd> <dt id="buf_lastindexof"><code>buf.lastIndexOf(<i>value</i>[,
<i>byteOffset</i>][,
<i>encoding</i>])</code></dt> <dd> The same as <a href="#buf_indexof"><code>buf.indexOf()</code></a>, except the last occurrence of the <code><i>value</i></code> is found instead of the first occurrence. The <code><i>value</i></code> can be a string, Buffer, or integer between 1 and 255. If the <code><i>value</i></code> is an empty string or empty Buffer, <code>byteOffset</code> will be returned. </dd> <dt id="buf_length"><code>buf.length</code></dt> <dd> Returns the number of bytes in Buffer. </dd> <dt id="buf_readintbe"><code>buf.readIntBE(<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Reads the <code><i>byteLength</i></code> from <code>buf</code> at the specified <code><i>offset</i></code> and interprets the result as a big-endian, two's complement signed value supporting up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The similar methods are also supported: <code>buf.readInt8([offset])</code>, <code>buf.readInt16BE([offset])</code>, <code>buf.readInt32BE([offset])</code>. </p> </dd> <dt id="buf_readintle"><code>buf.readIntLE(<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Reads the <code><i>byteLength</i></code> from <code>buf</code> at the specified <code><i>offset</i></code> and interprets the result as a little-endian, two's complement signed value supporting up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The similar methods are also supported: <code>buf.readInt8([offset])</code>, <code>buf.readInt16LE([offset])</code>, <code>buf.readInt32LE([offset])</code>. </p> </dd> <dt id="buf_readuintbe"><code>buf.readUIntBE(<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Reads the <code><i>byteLength</i></code> from <code>buf</code> at the specified <code><i>offset</i></code> and interprets the result as a big-endian integer supporting up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The similar methods are also supported: <code>buf.readUInt8([offset])</code>, <code>buf.readUInt16BE([offset])</code>, <code>buf.readUInt32BE([offset])</code>. </p> </dd> <dt id="buf_readuintle"><code>buf.readUIntLE(<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Reads the <code><i>byteLength</i></code> from <code>buf</code> at the specified <code><i>offset</i></code> and interprets the result as a little-endian integer supporting up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The similar methods are also supported: <code>buf.readUInt8([offset])</code>, <code>buf.readUInt16LE([offset])</code>, <code>buf.readUInt32LE([offset])</code>. </p> </dd> <dt id="buf_readdobulebe">
<code>buf.readDoubleBE</code>([<code><i>offset</i></code>])</dt> <dd> Reads a 64-bit, big-endian double from <code>buf</code> at the specified <code><i>offset</i></code>. </dd> <dt id="buf_readdobulele">
<code>buf.readDoubleLE</code>([<code><i>offset</i></code>])</dt> <dd> Reads a 64-bit, little-endian double from <code>buf</code> at the specified <code><i>offset</i></code>. </dd> <dt id="buf_readfloatbe">
<code>buf.readFloatBE</code>([<code><i>offset</i></code>])</dt> <dd> Reads a 32-bit, big-endian float from <code>buf</code> at the specified <code><i>offset</i></code>. </dd> <dt id="buf_readfloatle">
<code>buf.readFloatLE</code>([<code><i>offset</i></code>])</dt> <dd> Reads a 32-bit, little-endian float from <code>buf</code> at the specified <code><i>offset</i></code>. </dd> <dt id="buf_subarray"><code>buf.subarray([<i>start</i>[,
<i>end</i>]])</code></dt> <dd> Returns a new <code>buf</code> that references the same memory as the original, but offset and cropped by <code><i>start</i></code> and <code><i>end</i></code>. If <code><i>end</i></code> is greater than <a href="#buf_length"><code>buf.length</code></a>, the same result as that of end equal to <a href="#buf_length"><code>buf.length</code></a> is returned. </dd> <dt id="buf_slice"><code>buf.slice([<i>start</i>[,
<i>end</i>]])</code></dt> <dd> Returns a new <code>buf</code> that references the same memory as the original, but offset and cropped by the <code><i>start</i></code> and <code><i>end</i></code> values. The method is not compatible with the <code>Uint8Array.prototype.slice()</code>, which is a superclass of Buffer. To copy the slice, use <code>Uint8Array.prototype.slice()</code>. </dd> <dt id="buf_swap16">
<code>buf.swap16</code>()</dt> <dd> Interprets <code>buf</code> as an array of unsigned 16-bit numbers and swaps the byte order in-place. Throws an error if <a href="#buf_length"><code>buf.length</code></a> is not a multiple of 2. </dd> <dt id="buf_swap32">
<code>buf.swap32</code>()</dt> <dd> Interprets <code>buf</code> as an array of unsigned 32-bit numbers and swaps the byte order in-place. Throws an error if <a href="#buf_length"><code>buf.length</code></a> is not a multiple of 4. </dd> <dt id="buf_swap64">
<code>buf.swap64</code>()</dt> <dd> Interprets <code>buf</code> as an array of 64-bit numbers and swaps byte order in-place. Throws an error if <a href="#buf_length"><code>buf.length</code></a> is not a multiple of 8. </dd> <dt id="buf_tojson">
<code>buf.toJSON</code>()</dt> <dd> Returns a JSON representation of <code>buf.</code> <code>JSON.stringify()</code> implicitly calls this function when stringifying a Buffer instance. </dd> <dt id="buf_tostring"><code>buf.toString([<i>encoding</i>[,
<i>start</i>[,
<i>end</i>]]])</code></dt> <dd> Decodes <code>buf</code> to a string according to the specified character <code><i>encoding</i></code> which can be <code><i>utf8</i></code>, <code><i>hex</i></code>, <code><i>base64</i></code>, <code><i>base64url</i></code>. The <code><i>start</i></code> and <code><i>end</i></code> parameters may be passed to decode only a subset of Buffer. </dd> <dt id="buf_write"><code>buf.write(<i>string</i>[,
<i>offset</i>[,
<i>length</i>]][,
<i>encoding</i>])</code></dt> <dd> Writes a <code><i>string</i></code> to <code>buf</code> at <code><i>offset</i></code> according to the character <code><i>encoding</i></code>. The <code><i>length</i></code> parameter is the number of bytes to write. If Buffer did not contain enough space to fit the entire string, only part of string will be written, however, partially encoded characters will not be written. The <code><i>encoding</i></code> can be <code><i>utf8</i></code>, <code><i>hex</i></code>, <code><i>base64</i></code>, <code><i>base64url</i></code>. </dd> <dt id="buf_writeintbe"><code>buf.writeIntBE(<i>value</i>,
<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Writes <code><i>byteLength</i></code> bytes of <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as big-endian. Supports up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The following similar methods are also supported: <code>buf.writeInt8</code>, <code>buf.writeInt16BE</code>, <code>buf.writeInt32BE</code>. </p> </dd> <dt id="buf_writeintle"><code>buf.writeIntLE(<i>value</i>,
<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Writes <code><i>byteLength</i></code> bytes of <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as little-endian. Supports up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The following similar methods are also supported: <code>buf.writeInt8</code>, <code>buf.writeInt16LE</code>, <code>buf.writeInt32LE</code>. </p> </dd> <dt id="buf_writeuintbe"><code>buf.writeUIntBE(<i>value</i>,
<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Writes <code><i>byteLength</i></code> bytes of <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as big-endian. Supports up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The following similar methods are also supported: <code>buf.writeUInt8</code>, <code>buf.writeUInt16BE</code>, <code>buf.writeUInt32BE</code>. </p> </dd> <dt id="buf_writeuintle"><code>buf.writeUIntLE(<i>value</i>,
<i>offset</i>,
<i>byteLength</i>)</code></dt> <dd> Writes <code><i>byteLength</i></code> bytes of <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as little-endian. Supports up to 48 bits of accuracy. The <code><i>byteLength</i></code> parameter is an integer between 1 and 6 specifying the number of bytes to read. <p> The following similar methods are also supported: <code>buf.writeUInt8</code>, <code>buf.writeUInt16LE</code>, <code>buf.writeUInt32LE</code>. </p> </dd> <dt id="buf_writedoublebe"><code>buf.writeDoubleBE(<i>value</i>,
[<i>offset</i>])</code></dt> <dd> Writes the <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as big-endian. </dd> <dt id="buf_writedoublele"><code>buf.writeDoubleLE(<i>value</i>,
[<i>offset</i>])</code></dt> <dd> Writes the <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as little-endian. </dd> <dt id="buf_writefloatbe"><code>buf.writeFloatBE(<i>value</i>,
[<i>offset</i>])</code></dt> <dd> Writes the <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as big-endian. </dd> <dt id="buf_writefloatle"><code>buf.writeFloatLE(<i>value</i>,
[<i>offset</i>])</code></dt> <dd> Writes the <code><i>value</i></code> to <code>buf</code> at the specified <code><i>offset</i></code> as little-endian. </dd> </dl>

<h4 id="crypto">Crypto</h4>

<table width="100%"> <tr><td><a href="#crypto_createhash"><code>crypto.createHash()</code></a></td></tr> <tr><td><a href="#crypto_createhmac"><code>crypto.createHmac()</code></a></td></tr> </table>  <blockquote class="note"> Since <a href="changes.html#njs0.7.0">0.7.0</a>, extended crypto API is available as a global <a href="#builtin_crypto">crypto</a> object. </blockquote>
<p> The Crypto module provides cryptographic functionality support. The Crypto module object is returned by <code>require('crypto')</code>. </p>
 <dl class="compact"> <dt id="crypto_createhash"><code>crypto.createHash(<i>algorithm</i>)</code></dt> <dd> Creates and returns a <a href="#crypto_hash">Hash</a> object that can be used to generate hash digests using the given <code><i>algorithm</i></code>. The algorithm can be <code>md5</code>, <code>sha1</code>, and <code>sha256</code>. </dd> <dt id="crypto_createhmac"><code>crypto.createHmac(<i>algorithm</i>,
<i>secret key</i>)</code></dt> <dd> Creates and returns an <a href="#crypto_hmac">HMAC</a> object that uses the given <code><i>algorithm</i></code> and <code><i>secret key</i></code>. The algorithm can be <code>md5</code>, <code>sha1</code>, and <code>sha256</code>. </dd> </dl>

<h4 id="crypto_hash">Hash</h4>

<table width="100%"> <tr><td><a href="#crypto_hash_update"><code>hash.update()</code></a></td></tr> <tr><td><a href="#crypto_hash_digest"><code>hash.digest()</code></a></td></tr> </table>  <dl class="compact"> <dt id="crypto_hash_update"><code>hash.update(<i>data</i>)</code></dt> <dd> Updates the hash content with the given <code><i>data</i></code>. </dd> <dt id="crypto_hash_digest"><code>hash.digest([<i>encoding</i>])</code></dt> <dd> Calculates the digest of all of the data passed using <code>hash.update()</code>. The encoding can be <code>hex</code>, <code>base64</code>, and <code>base64url</code>. If encoding is not provided, a Buffer object (<a href="changes.html#njs0.4.4">0.4.4</a>) is returned. <blockquote class="note"> Before version (<a href="changes.html#njs0.4.4">0.4.4</a>), a byte string was returned instead of a Buffer object. </blockquote> </dd> <dt id="crypto_hash_copy"><code>hash.copy()</code></dt> <dd> Makes a copy of the current state of the hash (since <a href="changes.html#njs0.7.12">0.7.12</a>). </dd> </dl>

 <pre data-language="nginx">
&gt;&gt; var cr = require('crypto')
undefined

&gt;&gt; cr.createHash('sha1').update('A').update('B').digest('base64url')
'BtlFlCqiamG-GMPiK_GbvKjdK10'
</pre>

<h4 id="crypto_hmac">HMAC</h4>

<table width="100%"> <tr><td><a href="#crypto_hmac_update"><code>hmac.update()</code></a></td></tr> <tr><td><a href="#crypto_hmac_digest"><code>hmac.digest()</code></a></td></tr> </table>  <dl class="compact"> <dt id="crypto_hmac_update"><code>hmac.update(<i>data</i>)</code></dt> <dd> Updates the HMAC content with the given <code><i>data</i></code>. </dd> <dt id="crypto_hmac_digest"><code>hmac.digest([<i>encoding</i>])</code></dt> <dd> Calculates the HMAC digest of all of the data passed using <code>hmac.update()</code>. The encoding can be <code>hex</code>, <code>base64</code>, and <code>base64url</code>. If encoding is not provided, a Buffer object (<a href="changes.html#njs0.4.4">0.4.4</a>) is returned. <blockquote class="note"> Before version <a href="changes.html#njs0.4.4">0.4.4</a>, a byte string was returned instead of a Buffer object. </blockquote> </dd> </dl>

 <pre data-language="nginx">
&gt;&gt; var cr = require('crypto')
undefined

&gt;&gt; cr.createHmac('sha1', 'secret.key').update('AB').digest('base64url')
'Oglm93xn23_MkiaEq_e9u8zk374'
</pre>

<h4 id="njs_api_fs">File System</h4>

<table width="100%"> <tr><td><a href="#fs_accesssync"><code>fs.accessSync()</code></a></td></tr> <tr><td><a href="#fs_appendfilesync"><code>fs.appendFileSync()</code></a></td></tr> <tr><td><a href="#fs_closesync"><code>fs.closeSync()</code></a></td></tr> <tr><td><a href="#fs_existssync"><code>fs.existsSync()</code></a></td></tr> <tr><td><a href="#fs_fstatsync"><code>fs.fstatSync()</code></a></td></tr> <tr><td><a href="#fs_lstatsync"><code>fs.lstatSync()</code></a></td></tr> <tr><td><a href="#fs_mkdirsync"><code>fs.mkdirSync()</code></a></td></tr> <tr><td><a href="#fs_opensync"><code>fs.openSync()</code></a></td></tr> <tr><td><a href="#fs_promises_open"><code>fs.promises.open()</code></a></td></tr> <tr><td><a href="#fs_readdirsync"><code>fs.readdirSync()</code></a></td></tr> <tr><td><a href="#fs_readfilesync"><code>fs.readFileSync()</code></a></td></tr> <tr><td><a href="#fs_readsync"><code>fs.readSync()</code></a></td></tr> <tr><td><a href="#fs_realpathsync"><code>fs.realpathSync()</code></a></td></tr> <tr><td><a href="#fs_renamesync"><code>fs.renameSync()</code></a></td></tr> <tr><td><a href="#fs_rmdirsync"><code>fs.rmdirSync()</code></a></td></tr> <tr><td><a href="#fs_statsync"><code>fs.statSync()</code></a></td></tr> <tr><td><a href="#fs_symlinksync"><code>fs.symlinkSync()</code></a></td></tr> <tr><td><a href="#fs_unlinksync"><code>fs.unlinkSync()</code></a></td></tr> <tr><td><a href="#fs_writefilesync"><code>fs.writeFileSync()</code></a></td></tr> <tr><td><a href="#fs_writesync_buf"><code>fs.writeSync()</code></a></td></tr> <tr><td><a href="#fs_writesync_str"><code>fs.writeSync()</code></a></td></tr> </table> 
<table width="100%"> <tr><td><a href="#fs_dirent"><code>fs.Dirent</code></a></td></tr> <tr><td><a href="#fs_filehandle"><code>fs.FileHandle</code></a></td></tr> <tr><td><a href="#fs_stats"><code>fs.Stats</code></a></td></tr> <tr><td><a href="#access_const"><code>File Access Constants</code></a></td></tr> <tr><td><a href="#njs_api_fs_flags"><code>File System Flags</code></a></td></tr> </table> <p> The File System module provides operations with files. </p>
<p> The module object is returned by <code>require('fs')</code>. Since <a href="changes.html#njs0.3.9">0.3.9</a>, promissified versions of file system methods are available through <code>require('fs').promises</code> object: </p> <pre data-language="nginx">
&gt; var fs = require('fs').promises;
undefined
&gt; fs.readFile("/file/path").then((data)=&gt;console.log(data))
&lt;file data&gt;
</pre>
 <dl class="compact"> <dt id="fs_accesssync"><code>accessSync(<i>path</i>[,
<i>mode</i>])</code></dt> <dd> Synchronously tests permissions for a file or directory specified in the <code>path</code> (<a href="changes.html#njs0.3.9">0.3.9</a>). If the check fails, an error will be returned, otherwise, the method will return undefined. <dl class="compact"> <dt><code>mode</code></dt> <dd> an optional integer that specifies the accessibility checks to be performed, by default is <a href="#access_const"><code>fs.constants.F_OK</code></a> <pre data-language="nginx">
try {
    fs.accessSync('/file/path', fs.constants.R_OK | fs.constants.W_OK);
    console.log('has access');
} catch (e) {
    console.log('no access');)
}
</pre> </dd> </dl> </dd> <dt id="fs_appendfilesync"><code>appendFileSync(<i>filename</i>,
<i>data</i>[, <i>options</i>])</code></dt> <dd> Synchronously appends specified <code>data</code> to a file with provided <code>filename</code>. The <code>data</code> is expected to be a string or a Buffer object (<a href="changes.html#njs0.4.4">0.4.4</a>). If the file does not exist, it will be created. The <code>options</code> parameter is expected to be an object with the following keys: <dl class="compact"> <dt><code>mode</code></dt> <dd> mode option, by default is <code>0o666</code> </dd> <dt><code>flag</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>a</code> </dd> </dl> </dd> <dt id="fs_closesync"><code>closeSync(<i>fd</i>)</code></dt> <dd> Closes the <code>fd</code> file descriptor represented by an integer used by the method. Returns <code>undefined</code>. </dd> <dt id="fs_existssync"><code>existsSync(<i>path</i>)</code></dt> <dd> Boolean value, returns <code>true</code> if the specified <code><i>path</i></code> exists. (<a href="changes.html#njs0.8.2">0.8.2</a>) </dd> <dt id="fs_fstatsync"><code>fstatSync(<i>fd</i>)</code></dt> <dd> Retrieves the <a href="#fs_stats"><code>fs.Stats</code></a> object for the file descriptor (<a href="changes.html#njs0.7.7">0.7.7</a>). The <code>fd</code> parameter is an integer representing the file descriptor used by the method. </dd> <dt id="fs_lstatsync"><code>lstatSync(<i>path</i>[,
<i>options</i>])</code></dt> <dd> Synchronously retrieves the <a href="#fs_stats"><code>fs.Stats</code></a> object for the symbolic link referred to by <code>path</code> (<a href="changes.html#njs0.7.1">0.7.1</a>). The <code>options</code> parameter is expected to be an object with the following keys: <dl class="compact"> <dt><code>throwIfNoEntry</code></dt> <dd> a boolean value which indicates whether an exception is thrown if no file system entry exists, rather than returning <code>undefined</code>, by default is <code>false</code>. </dd> </dl> </dd> <dt id="fs_mkdirsync"><code>mkdirSync(<i>path</i>[,
<i>options</i>])</code></dt> <dd> Synchronously creates a directory at the specified <code>path</code> (<a href="changes.html#njs0.4.2">0.4.2</a>). The <code>options</code> parameter is expected to be an <code>integer</code> that specifies the <a href="#fs_mkdirsync_mode">mode</a>, or an object with the following keys: <dl class="compact"> <dt id="fs_mkdirsync_mode"><code>mode</code></dt> <dd> mode option, by default is <code>0o777</code>. </dd> </dl> </dd> <dt id="fs_opensync"><code>openSync(<i>path</i>[,
<i>flags</i>[, <i>mode</i>]])</code></dt> <dd> Returns an integer representing the file descriptor for the opened file <code>path</code> (<a href="changes.html#njs0.7.7">0.7.7</a>). <dl class="compact"> <dt><code>flags</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>r</code> </dd> <dt><code>mode</code></dt> <dd> mode option, by default is <code>0o666</code> </dd> </dl> </dd> <dt id="fs_promises_open"><code>promises.open(<i>path</i>[,
<i>flags</i>[, <i>mode</i>]])</code></dt> <dd> Returns a <a href="#fs_filehandle"><code>FileHandle</code></a> object representing the opened file <code>path</code> (<a href="changes.html#njs0.7.7">0.7.7</a>). <dl class="compact"> <dt><code>flags</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>r</code> </dd> <dt><code>mode</code></dt> <dd> mode option, by default is <code>0o666</code> </dd> </dl> </dd> <dt id="fs_readdirsync"><code>readdirSync(<i>path</i>[,
<i>options</i>])</code></dt> <dd> Synchronously reads the contents of a directory at the specified <code>path</code> (<a href="changes.html#njs0.4.2">0.4.2</a>). The <code>options</code> parameter is expected to be a string that specifies <a href="#fs_readdirsync_encoding">encoding</a> or an object with the following keys: <dl class="compact"> <dt id="fs_readdirsync_encoding"><code>encoding</code></dt> <dd> encoding, by default is <code>utf8</code>. The encoding can be <code>utf8</code> and <code>buffer</code> (<a href="changes.html#njs0.4.4">0.4.4</a>). </dd> <dt id="fs_readdirsync_withfiletypes"><code>withFileTypes</code></dt> <dd> if set to <code>true</code>, the files array will contain <a href="#fs_dirent"><code>fs.Dirent</code></a> objects, by default is <code>false</code>. </dd> </dl> </dd> <dt id="fs_readfilesync"><code>readFileSync(<i>filename</i>[,
<i>options</i>])</code></dt> <dd> Synchronously returns the contents of the file with provided <code>filename</code>. The <code>options</code> parameter holds <code>string</code> that specifies encoding. If an encoding is specified, a string is returned, otherwise, a Buffer object (<a href="changes.html#njs0.4.4">0.4.4</a>) is returned. <blockquote class="note"> Before version <a href="changes.html#njs0.4.4">0.4.4</a>, a <a href="#string_tobytes">byte string</a> was returned if encoding was not specified. </blockquote> Otherwise, <code>options</code> is expected to be an object with the following keys: <dl class="compact"> <dt><code>encoding</code></dt> <dd> encoding, by default is not specified. The encoding can be <code>utf8</code>, <code>hex</code> (<a href="changes.html#njs0.4.4">0.4.4</a>), <code>base64</code> (<a href="changes.html#njs0.4.4">0.4.4</a>), <code>base64url</code> (<a href="changes.html#njs0.4.4">0.4.4</a>). </dd> <dt><code>flag</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>r</code> </dd> </dl> <pre data-language="nginx">
&gt;&gt; var fs = require('fs')
undefined
&gt;&gt; var file = fs.readFileSync('/file/path.tar.gz')
undefined
&gt;&gt; var gzipped = file.slice(0,2).toString('hex') === '1f8b'; gzipped
true
</pre> </dd> <dt id="fs_readsync"><code>readSync(<i>fd</i>,
<i>buffer</i>, <i>offset</i>[,
<i>length</i>[, <i>position</i>]])</code></dt> <dd> Reads the content of a file path using file descriptor <code>fd</code>, returns the number of bytes read (<a href="changes.html#njs0.7.7">0.7.7</a>). <dl class="compact"> <dt><code>buffer</code></dt> <dd> the <code>buffer</code> value can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> <dt><code>offset</code></dt> <dd> is an <code>integer</code> representing the position in buffer to write the data to </dd> <dt><code>length</code></dt> <dd> is an <code>integer</code> representing the number of bytes to read </dd> <dt><code>position</code></dt> <dd> specifies where to begin reading from in the file, the value can be <code>integer</code> or <code>null</code>, by default is <code>null</code>. If <code>position</code> is <code>null</code>, data will be read from the current file position, and the file position will be updated. If position is an <code>integer</code>, the file position will be unchanged </dd> </dl> </dd> <dt id="fs_realpathsync"><code>realpathSync(<i>path</i>[,
<i>options</i>])</code></dt> <dd> Synchronously computes the canonical pathname by resolving <code>.</code>, <code>..</code> and symbolic links using <a href="http://man7.org/linux/man-pages/man3/realpath.3.html">realpath(3)</a>. The <code>options</code> argument can be a string specifying an encoding, or an object with an encoding property specifying the character encoding to use for the path passed to the callback (<a href="changes.html#njs0.3.9">0.3.9</a>). </dd> <dt id="fs_renamesync"><code>renameSync(<i>oldPath</i>,
<i>newPath</i>)</code></dt> <dd> Synchronously changes the name or location of a file from <code>oldPath</code> to <code>newPath</code> (<a href="changes.html#njs0.3.4">0.3.4</a>). <pre data-language="nginx">
&gt;&gt; var fs = require('fs')
undefined
&gt;&gt; var file = fs.renameSync('hello.txt', 'HelloWorld.txt')
undefined
</pre> </dd> <dt id="fs_rmdirsync"><code>rmdirSync(<i>path</i>)</code></dt> <dd> Synchronously removes a directory at the specified <code>path</code> (<a href="changes.html#njs0.4.2">0.4.2</a>). </dd> <dt id="fs_statsync"><code>statSync(<i>path</i>,[
<i>options</i>])</code></dt> <dd> Synchronously retrieves the <a href="#fs_stats"><code>fs.Stats</code></a> object for the specified <code>path</code> (<a href="changes.html#njs0.7.1">0.7.1</a>). The <code>path</code> can be a <code>string</code> or <code>buffer</code>. The <code>options</code> parameter is expected to be an object with the following keys: <dl class="compact"> <dt><code>throwIfNoEntry</code></dt> <dd> a boolean value which indicates whether an exception is thrown if no file system entry exists rather than returning <code>undefined</code>, by default is <code>true</code>. </dd> </dl> </dd> <dt id="fs_symlinksync"><code>symlinkSync(<i>target</i>,
<i>path</i>)</code></dt> <dd> Synchronously creates the link called <code>path</code> pointing to <code>target</code> using <a href="http://man7.org/linux/man-pages/man2/symlink.2.html">symlink(2)</a> (<a href="changes.html#njs0.3.9">0.3.9</a>). Relative targets are relative to the link’s parent directory. </dd> <dt id="fs_unlinksync"><code>unlinkSync(<i>path</i>)</code></dt> <dd> Synchronously unlinks a file by <code>path</code> (<a href="changes.html#njs0.3.9">0.3.9</a>). </dd> <dt id="fs_writefilesync"><code>writeFileSync(<i>filename</i>,
<i>data</i>[,
<i>options</i>])</code></dt> <dd> Synchronously writes <code>data</code> to a file with provided <code>filename</code>. The <code>data</code> is expected to be a string or a Buffer object (<a href="changes.html#njs0.4.4">0.4.4</a>). If the file does not exist, it will be created, if the file exists, it will be replaced. The <code>options</code> parameter is expected to be an object with the following keys: <dl class="compact"> <dt><code>mode</code></dt> <dd> mode option, by default is <code>0o666</code> </dd> <dt><code>flag</code></dt> <dd> file system <a href="#njs_api_fs_flags">flag</a>, by default is <code>w</code> </dd> </dl> <pre data-language="nginx">
&gt;&gt; var fs = require('fs')
undefined
&gt;&gt; var file = fs.writeFileSync('hello.txt', 'Hello world')
undefined
</pre> </dd> <dt id="fs_writesync_buf"><code>writeSync(<i>fd</i>,
<i>buffer</i>, <i>offset</i>[,
<i>length</i>[, <i>position</i>]])</code></dt> <dd> Writes a buffer to a file using file descriptor, returns the <code>number</code> of bytes written (<a href="changes.html#njs0.7.7">0.7.7</a>). <dl class="compact"> <dt><code>fd</code></dt> <dd> an <code>integer</code> representing the file descriptor </dd> <dt><code>buffer</code></dt> <dd> the <code>buffer</code> value can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> <dt><code>offset</code></dt> <dd> is an <code>integer</code> that determines the part of the buffer to be written, by default <code>0</code> </dd> <dt><code>length</code></dt> <dd> is an <code>integer</code> specifying the number of bytes to write, by default is an offset of <a href="#buffer_bytelength">Buffer.byteLength</a> </dd> <dt><code>position</code></dt> <dd> refers to the offset from the beginning of the file where this data should be written, can be an <code>integer</code> or <code>null</code>, by default is <code>null</code>. See also <a href="https://man7.org/linux/man-pages/man2/write.2.html">pwrite(2)</a>. </dd> </dl> </dd> <dt id="fs_writesync_str"><code>writeSync(<i>fd</i>,
<i>string</i>[,
<i>position</i>[,
<i>encoding</i>]])</code></dt> <dd> Writes a <code>string</code> to a file using file descriptor <code>fd</code>, returns the <code>number</code> of bytes written (<a href="changes.html#njs0.7.7">0.7.7</a>). <dl class="compact"> <dt><code>fd</code></dt> <dd> is an <code>integer</code> representing a file descriptor </dd> <dt><code>position</code></dt> <dd> refers to the offset from the beginning of the file where this data should be written, can be an <code>integer</code> or <code>null</code>, by default is <code>null</code>. See also <a href="https://man7.org/linux/man-pages/man2/write.2.html">pwrite(2)</a> </dd> <dt><code>encoding</code></dt> <dd> is a <code>string</code>, by default is <code>utf8</code> </dd> </dl> </dd> </dl>

<h4 id="fs_dirent">fs.Dirent</h4>
<p> <code>fs.Dirent</code> is a representation of a directory entry — a file or a subdirectory. When <a href="#fs_readdirsync"><code>readdirSync()</code></a> is called with the <a href="#fs_readdirsync_withfiletypes"><code>withFileTypes</code></a> option, the resulting array contains <code>fs.Dirent</code> objects. </p> <ul> <li> <code>dirent.isBlockDevice()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a block device. </li> <li> <code>dirent.isCharacterDevice()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a character device. </li> <li> <code>dirent.isDirectory()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a file system directory. </li> <li> <code>dirent.isFIFO()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a first-in-first-out (FIFO) pipe. </li> <li> <code>dirent.isFile()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a regular file. </li> <li> <code>dirent.isSocket()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a socket. </li> <li> <code>dirent.isSymbolicLink()</code> — returns <code>true</code> if the <code>fs.Dirent</code> object describes a symbolic link. </li> <li> <code>dirent.name</code> — the name of the file <code>fs.Dirent</code> object refers to. </li> </ul>

<h4 id="fs_filehandle">fs.FileHandle</h4>

<table width="100%"> <tr><td><a href="#filehandle_close"><code>filehandle.close()</code></a></td></tr> <tr><td><a href="#filehandle_fd"><code>filehandle.fd</code></a></td></tr> <tr><td><a href="#filehandle_read"><code>filehandle.read()</code></a></td></tr> <tr><td><a href="#filehandle_stat"><code>filehandle.stat()</code></a></td></tr> <tr><td><a href="#filehandle_write_buf"><code>filehandle.write(<i>buf</i>)</code></a></td></tr> <tr><td><a href="#filehandle_write_str"><code>filehandle.write(<i>str</i>)</code></a></td></tr> </table> <p> The <code>FileHandle</code> object is an object wrapper for a numeric file descriptor (<a href="changes.html#njs0.7.7">0.7.7</a>). Instances of the <code>FileHandle</code> object are created by the <a href="#fs_promises_open"><code>fs.promises.open()</code></a> method. If a <code>FileHandle</code> is not closed using the <a href="#filehandle_close"><code>filehandle.close()</code></a> method, it will try to automatically close the file descriptor, helping to prevent memory leaks. Please do not rely on this behavior because it can be unreliable. Instead, always explicitly close a <code>FileHandle</code>. </p>
 <dl class="compact"> <dt id="filehandle_close"><code>filehandle.close()</code></dt> <dd> Closes the file handle after waiting for any pending operation on the handle to complete. Returns a <code>promise</code>, fulfills with undefined upon success. </dd> <dt id="filehandle_fd"><code>filehandle.fd</code></dt> <dd> The numeric file descriptor managed by the <code>FileHandle</code> object. </dd> <dt id="filehandle_read"><code>filehandle.read(<i>buffer</i>,
<i>offset</i>[,
<i>length</i>[,
<i>position</i>]])</code></dt> <dd> Reads data from the file and stores that in the given buffer. <dl class="compact"> <dt><code>buffer</code></dt> <dd> a buffer that will be filled with the file data read, the value can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> <dt><code>offset</code></dt> <dd> is an <code>integer</code> representing the location in the buffer at which to start filling </dd> <dt><code>length</code></dt> <dd> is an <code>integer</code> representing the number of bytes to read </dd> <dt><code>position</code></dt> <dd> the location where to begin reading data from the file, the value can be <code>integer</code>, <code>null</code>. If <code>null</code>, data will be read from the current file position and the position will be updated. If position is an <code>integer</code>, the current file position will remain unchanged. </dd> </dl> Returns a <code>Promise</code> which fulfills upon success with an object with two properties: <dl class="compact"> <dt><code>bytesRead</code></dt> <dd> is an <code>integer</code> representing the number of bytes read </dd> <dt><code>buffer</code></dt> <dd> is a reference to the passed argument in buffer, can be <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> </dl> </dd> <dt id="filehandle_stat"><code>filehandle.stat()</code></dt> <dd> Fulfills with an <a href="#fs_stats">fs.Stats</a> for the file, returns a <code>promise</code>. </dd> <dt id="filehandle_write_buf"><code>filehandle.write(<i>buffer</i>,
<i>offset</i>[,
<i>length</i>[,
<i>position</i>]])</code></dt> <dd> Writes a buffer to the file. <dl class="compact"> <dt><code>buffer</code></dt> <dd> the <code>buffer</code> value can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> <dt><code>offset</code></dt> <dd> is an <code>integer</code> representing the start position from within buffer where the data to write begins </dd> <dt><code>length</code></dt> <dd> is an <code>integer</code> representing the number of bytes from buffer to write, by default is an offset of <a href="#buffer_bytelength">Buffer.byteLength</a> </dd> <dt><code>position</code></dt> <dd> the offset from the beginning of the file where the data from buffer should be written, can be an <code>integer</code> or <code>null</code>, by default is <code>null</code>. If <code>position</code> is not a <code>number</code>, the data will be written at the current position. See the POSIX <a href="https://man7.org/linux/man-pages/man2/write.2.html">pwrite(2)</a> documentation for details. </dd> </dl> Returns a <code>Promise</code> which is resolved with an object containing two properties: <dl class="compact"> <dt><code>bytesWritten</code></dt> <dd> is an <code>integer</code> representing the number of bytes written </dd> <dt><code>buffer</code></dt> <dd> a reference to the buffer written, can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> </dl>  <blockquote class="note"> It is unsafe to use <code>filehandle.write()</code> multiple times on the same file without waiting for the promise to be resolved or rejected. </blockquote>
 </dd> <dt id="filehandle_write_str"><code>filehandle.write(<i>string</i>[,
<i>position</i>[,
<i>encoding</i>]])</code></dt> <dd> Writes a <code>string</code> to the file. <dl class="compact"> <dt><code>position</code></dt> <dd> the offset from the beginning of the file where the data from buffer should be written, can be an <code>integer</code> or <code>null</code>, by default is <code>null</code>. If <code>position</code> is not a <code>number</code>, the data will be written at the current position. See the POSIX <a href="https://man7.org/linux/man-pages/man2/write.2.html">pwrite(2)</a> documentation for details. </dd> <dt><code>encoding</code></dt> <dd> the expected encoding of the string, by default <code>utf8</code> </dd> </dl> Returns a <code>Promise</code> which is resolved with an object containing two properties: <dl class="compact"> <dt><code>bytesWritten</code></dt> <dd> is an <code>integer</code> representing the number of bytes written </dd> <dt><code>buffer</code></dt> <dd> a reference to the buffer written, can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code> </dd> </dl>  <blockquote class="note"> It is unsafe to use <code>filehandle.write()</code> multiple times on the same file without waiting for the promise to be resolved or rejected. </blockquote>
 </dd> </dl>

<h4 id="fs_stats">fs.Stats</h4>
<p> The <code>fs.Stats</code> object provides information about a file. The object is returned from <a href="#fs_statsync">fs.statSync()</a> and <a href="#fs_lstatsync">fs.lstatSync()</a>. </p> <ul> <li> <code>stats.isBlockDevice()</code> — returns <code>true</code> if the <code>fs.Stats</code> object describes a block device. </li> <li> <code>stats.isDirectory()</code> — returns <code>true</code> if the <code>fs.Stats</code> object describes a file system directory. </li> <li> <code>stats.isFIFO()</code> — returns <code>true</code> if the <code>fs.Stats</code> object describes a first-in-first-out (FIFO) pipe. </li> <li> <code>stats.isFile()</code> — returns <code>true</code> if the <code>fs.Stats</code> object describes a regular file. </li> <li> <code>stats.isSocket()</code> — returns <code>true</code> if the <code>fs.Stats</code> object describes a socket. </li> <li> <code>stats.isSymbolicLink()</code> — returns <code>true</code> if the <code>fs.Stats</code> object describes a symbolic link. </li> <li> <code>stats.dev</code> — the numeric identifier of the device containing the file. </li> <li> <code>stats.ino</code> — the file system specific <code>Inode</code> number for the file. </li> <li> <code>stats.mode</code> — a bit-field describing the file type and mode. </li> <li> <code>stats.nlink</code> — the number of hard-links that exist for the file. </li> <li> <code>stats.uid</code> — the numeric user identifier of the user that owns the file (POSIX). </li> <li> <code>stats.gid</code> — the numeric group identifier of the group that owns the file (POSIX). </li> <li> <code>stats.rdev</code> — the numeric device identifier if the file represents a device. </li> <li> <code>stats.size</code> — the size of the file in bytes. </li> <li> <code>stats.blksize</code> — the file system block size for i/o operations. </li> <li> <code>stats.blocks</code> — the number of blocks allocated for this file. </li> <li> <code>stats.atimeMs</code> — the timestamp indicating the last time this file was accessed expressed in milliseconds since the POSIX Epoch. </li> <li> <code>stats.mtimeMs</code> — the timestamp indicating the last time this file was modified expressed in milliseconds since the POSIX Epoch. </li> <li> <code>stats.ctimeMs</code> — the timestamp indicating the last time this file was changed expressed in milliseconds since the POSIX Epoch. </li> <li> <code>stats.birthtimeMs</code> — the timestamp indicating the creation time of this file expressed in milliseconds since the POSIX Epoch. </li> <li> <code>stats.atime</code> — the timestamp indicating the last time this file was accessed. </li> <li> <code>stats.mtime</code> — the timestamp indicating the last time this file was modified. </li> <li> <code>stats.ctime</code> — the timestamp indicating the last time this file was changed. </li> <li> <code>stats.birthtime</code> — the timestamp indicating the creation time of this file. </li> </ul>

<h4 id="access_const">File Access Constants</h4>
<p> The <a href="#fs_accesssync"><code>access()</code></a> method can accept the following flags. These flags are exported by <code>fs.constants</code>: </p> <ul> <li> <code>F_OK</code> — indicates that the file is visible to the calling process, used by default if no mode is specified </li> <li> <code>R_OK</code> — indicates that the file can be read by the calling process </li> <li> <code>W_OK</code> — indicates that the file can be written by the calling process </li> <li> <code>X_OK</code> — indicates that the file can be executed by the calling process </li> </ul>

<h4 id="njs_api_fs_flags">File System Flags</h4>
<p> The <code>flag</code> option can accept the following values: </p> <ul> <li> <code>a</code> — open a file for appending. The file is created if it does not exist </li> <li> <code>ax</code> — the same as <code>a</code> but fails if the file already exists </li> <li> <code>a+</code> — open a file for reading and appending. If the file does not exist, it will be created </li> <li> <code>ax+</code> — the same as <code>a+</code> but fails if the file already exists </li> <li> <code>as</code> — open a file for appending in synchronous mode. If the file does not exist, it will be created </li> <li> <code>as+</code> — open a file for reading and appending in synchronous mode. If the file does not exist, it will be created </li> <li> <code>r</code> — open a file for reading. An exception occurs if the file does not exist </li> <li> <code>r+</code> — open a file for reading and writing. An exception occurs if the file does not exist </li> <li> <code>rs+</code> — open a file for reading and writing in synchronous mode. Instructs the operating system to bypass the local file system cache </li> <li> <code>w</code> — open a file for writing. If the file does not exist, it will be created. If the file exists, it will be replaced </li> <li> <code>wx</code> — the same as <code>w</code> but fails if the file already exists </li> <li> <code>w+</code> — open a file for reading and writing. If the file does not exist, it will be created. If the file exists, it will be replaced </li> <li> <code>wx+</code> — the same as <code>w+</code> but fails if the file already exists </li> </ul>

<h4 id="querystring">Query String</h4>

<table width="100%"> <tr><td><a href="#querystring_decode"><code>querystring.decode()</code></a></td></tr> <tr><td><a href="#querystring_encode"><code>querystring.encode()</code></a></td></tr> <tr><td><a href="#querystring_escape"><code>querystring.escape()</code></a></td></tr> <tr><td><a href="#querystring_parse"><code>querystring.parse()</code></a></td></tr> <tr><td><a href="#querystring_stringify"><code>querystring.stringify()</code></a></td></tr> <tr><td><a href="#querystring_unescape"><code>querystring.unescape()</code></a></td></tr> </table> <p> The Query String module provides support for parsing and formatting URL query strings (<a href="changes.html#njs0.4.3">0.4.3</a>). The Query String module object is returned by <code>require('querystring')</code>. </p>
 <dl class="compact"> <dt id="querystring_decode"><code>querystring.decode()</code></dt> <dd> is an alias for <a href="#querystring_parse"><code>querystring.parse()</code></a>. </dd> <dt id="querystring_encode"><code>querystring.encode()</code></dt> <dd> is an alias for <a href="#querystring_stringify"><code>querystring.stringify()</code></a>. </dd> <dt id="querystring_escape"><code>querystring.escape(<i>string</i>)</code></dt> <dd> <p> Performs URL encoding of the given <code>string</code>, returns an escaped query string. The method is used by <a href="#querystring_stringify"><code>querystring.stringify()</code></a> and should not be used directly. </p> </dd> <dt id="querystring_parse"><code>querystring.parse(<i>string</i>[,
<i>separator</i>[,
<i>equal</i>[,
<i>options</i>]]])</code></dt> <dd> <p> Parses the query string URL and returns an object. </p> <p> The <code>separator</code> parameter is a substring for delimiting key and value pairs in the query string, by default is “<code>&amp;</code>”. </p> <p> The <code>equal</code> parameter is a substring for delimiting keys and values in the query string, by default is “<code>=</code>”. </p> <p> The <code>options</code> parameter is expected to be an object with the following keys: </p> <dl class="compact"> <dt>
<code>decodeURIComponent</code> <code><i>function</i></code>
</dt> <dd> Function used to decode percent-encoded characters in the query string, by default is <a href="#querystring_unescape"><code>querystring.unescape()</code></a> </dd> <dt>
<code>maxKeys</code> <code><i>number</i></code>
</dt> <dd> the maximum number of keys to parse, by default is <code>1000</code>. The <code>0</code> value removes limitations for counting keys. </dd> </dl>
<p> By default, percent-encoded characters within the query string are assumed to use the UTF-8 encoding, invalid UTF-8 sequences will be replaced with the <code>U+FFFD</code> replacement character. </p> <p> For example, for the following query string </p> <pre data-language="nginx">
'foo=bar&amp;abc=xyz&amp;abc=123'
</pre>
<p> the output will be: </p> <pre data-language="nginx">
{
  foo: 'bar',
  abc: ['xyz', '123']
}
</pre>
 </dd> <dt id="querystring_stringify"><code>querystring.stringify(<i>object</i>[,
<i>separator</i>[,
<i>equal</i>[,
<i>options</i>]]])</code></dt> <dd> <p> Serializes an object and returns a URL query string. </p> <p> The <code>separator</code> parameter is a substring for delimiting key and value pairs in the query string, by default is “<code>&amp;</code>”. </p> <p> The <code>equal</code> parameter is a substring for delimiting keys and values in the query string, by default is “<code>=</code>”. </p> <p> The <code>options</code> parameter is expected to be an object with the following keys: </p> <dl class="compact"> <dt>
<code>encodeURIComponent</code> <code><i>function</i></code>
</dt> <dd> The function to use when converting URL-unsafe characters to percent-encoding in the query string, by default is <a href="#querystring_escape"><code>querystring.escape()</code></a>. </dd> </dl>
 <p> By default, characters that require percent-encoding within the query string are encoded as UTF-8. If other encoding is required, then <code>encodeURIComponent</code> option should be specified. </p> <p> For example, for the following command </p> <pre data-language="nginx">
querystring.stringify({ foo: 'bar', baz: ['qux', 'quux'], 123: '' });
</pre>
<p> the query string will be: </p> <pre data-language="nginx">
'foo=bar&amp;baz=qux&amp;baz=quux&amp;123='
</pre>
 </dd> <dt id="querystring_unescape"><code>querystring.unescape(<i>string</i>)</code></dt> <dd> <p> Performs decoding of URL percent-encoded characters of the <code>string</code>, returns an unescaped query string. The method is used by <a href="#querystring_parse"><code>querystring.parse()</code></a> and should not be used directly. </p> </dd> </dl>

<h4 id="xml">XML</h4>

<table width="100%"> <tr><td><a href="#xml_parse"><code>xml.parse()</code></a></td></tr> <tr><td><a href="#xml_c14n"><code>xml.c14n()</code></a></td></tr> <tr><td><a href="#xml_exclusivec14n"><code>xml.exclusiveC14n()</code></a></td></tr> <tr><td><a href="#xml_serialize"><code>xml.serialize()</code></a></td></tr> <tr><td><a href="#xml_serialize_tostring"><code>xml.serializeToString()</code></a></td></tr> <tr><td><a href="#xml_doc"><code>XMLDoc</code></a></td></tr> <tr><td><a href="#xml_node"><code>XMLNode</code></a></td></tr> <tr><td><a href="#xml_xmlattr"><code>XMLAttr</code></a></td></tr> </table> <p> The XML module allows working with XML documents (since <a href="changes.html#njs0.7.10">0.7.10</a>). The XML module object is returned by <code>require('xml')</code>. </p>
<p> Example: </p> <pre data-language="nginx">
const xml = require("xml");
let data = `&lt;note&gt;&lt;to b="bar" a= "foo" &gt;Tove&lt;/to&gt;&lt;from&gt;Jani&lt;/from&gt;&lt;/note&gt;`;
let doc = xml.parse(data);

console.log(doc.note.to.$text) /* 'Tove' */
console.log(doc.note.to.$attr$b) /* 'bar' */
console.log(doc.note.$tags[1].$text) /* 'Jani' */

let dec = new TextDecoder();
let c14n = dec.decode(xml.exclusiveC14n(doc.note));
console.log(c14n) /* '&lt;note&gt;&lt;to a="foo" b="bar"&gt;Tove&lt;/to&gt;&lt;from&gt;Jani&lt;/from&gt;&lt;/note&gt;' */

c14n = dec.decode(xml.exclusiveC14n(doc.note.to));
console.log(c14n) /* '&lt;to a="foo" b="bar"&gt;Tove&lt;/to&gt;' */

c14n = dec.decode(xml.exclusiveC14n(doc.note, doc.note.to /* excluding 'to' */));
console.log(c14n) /* '&lt;note&gt;&lt;from&gt;Jani&lt;/from&gt;&lt;/note&gt;' */
</pre>

 <dl class="compact"> <dt id="xml_parse"><code>parse(<i>string</i> |
<i>Buffer</i>)</code></dt> <dd> Parses a string or Buffer for an XML document, returns an <a href="#xml_doc"><code>XMLDoc</code></a> wrapper object representing the parsed XML document. </dd> <dt id="xml_c14n"><code>c14n(<i>root_node</i>[,
<i>excluding_node</i>])</code></dt> <dd> Canonicalizes <code>root_node</code> and its children according to <a href="https://www.w3.org/TR/xml-c14n">Canonical XML Version 1.1</a>. The <code>root_node</code> can be <a href="#xml_node"><code>XMLNode</code></a> or <a href="#xml_doc"><code>XMLDoc</code></a> wrapper object around XML structure. Returns Buffer object that contains canonicalized output.  <dl class="compact"> <dt><code>excluding_node</code></dt> <dd> allows omitting from the output a part of the document </dd> </dl>
 </dd> <dt id="xml_exclusivec14n"><code>exclusiveC14n(<i>root_node</i>[,
<i>excluding_node</i>[,
<i>withComments</i>
[,<i>prefix_list</i>]]])</code></dt> <dd> Canonicalizes <code>root_node</code> and its children according to <a href="https://www.w3.org/TR/xml-exc-c14n/">Exclusive XML Canonicalization Version 1.0</a>.  <dl class="compact"> <dt><code>root_node</code></dt> <dd> is <a href="#xml_node"><code>XMLNode</code></a> or <a href="#xml_doc"><code>XMLDoc</code></a> wrapper object around XML structure </dd> <dt><code>excluding_node</code></dt> <dd> allows omitting from the output a part of the document corresponding to the node and its children </dd> <dt><code>withComments</code></dt> <dd> a boolean value, <code>false</code> by default. If <code>true</code>, canonicalization corresponds to <a href="http://www.w3.org/2001/10/xml-exc-c14n#WithComments">Exclusive XML Canonicalization Version 1.0</a>. Returns Buffer object that contains canonicalized output. </dd> <dt><code>prefix_list</code></dt> <dd> an optional string with a space separated namespace prefixes for namespaces that should also be included into the output </dd> </dl>
 </dd> <dt id="xml_serialize"><code>serialize()</code></dt> <dd> The same as <a href="#xml_c14n"><code>xml.c14n()</code></a> (since <a href="changes.html#njs0.7.11">0.7.11</a>). </dd> <dt id="xml_serialize_tostring"><code>serializeToString()</code></dt> <dd> The same as <a href="#xml_c14n"><code>xml.c14n()</code></a> except it returns the result as a <code>string</code> (since <a href="changes.html#njs0.7.11">0.7.11</a>). </dd> <dt id="xml_doc"><code>XMLDoc</code></dt> <dd> An XMLDoc wrapper object around XML structure, the root node of the document.  <dl class="compact"> <dt id="xml_doc_root"><code>doc.$root</code></dt> <dd> the document's root by its name or undefined </dd> <dt id="xml_doc_xxx"><code>doc.<i>abc</i></code></dt> <dd> the first root tag named <code><i>abc</i></code> as <a href="#xml_node"><code>XMLNode</code></a> wrapper object </dd> </dl>
 </dd> <dt id="xml_node"><code>XMLNode</code></dt> <dd> An XMLNode wrapper object around XML tag node.  <dl class="compact"> <dt id="node_abc"><code>node.<i>abc</i></code></dt> <dd> the same as <a href="#node_tag"><code>node.$tag$<i>abc</i></code></a> </dd> <dt id="node_attr"><code>node.$attr$<i>abc</i></code></dt> <dd> the node's attribute value of <code><i>abc</i></code>, writable since <a href="changes.html#njs0.7.11">0.7.11</a> </dd> <dt id="node_attr_value">
<code>node.$attr$<i>abc</i></code>=<code><i>xyz</i></code>
</dt> <dd> the same as <a href="#node_setattribute"><code>node.setAttribute('<i>abc</i>',
<i>xyz</i>)</code></a> (since <a href="changes.html#njs0.7.11">0.7.11</a>) </dd> <dt id="node_attrs"><code>node.$attrs</code></dt> <dd> an <a href="#xml_xmlattr"><code>XMLAttr</code></a> wrapper object for all attributes of the node </dd> <dt id="node_name"><code>node.$name</code></dt> <dd> the name of the node </dd> <dt id="node_ns"><code>node.$ns</code></dt> <dd> the namespace of the node </dd> <dt id="node_parent"><code>node.$parent</code></dt> <dd> the parent node of the current node </dd> <dt id="node_tag"><code>node.$tag$<i>abc</i></code></dt> <dd> the first child tag of the node named <code><i>abc</i></code>, writable since <a href="changes.html#njs0.7.11">0.7.11</a> </dd> <dt id="node_tags"><code>node.$tags</code></dt> <dd> an array of all children tags </dd> <dt id="node_tags_"><code>node.$tags = [node1, node2, ...]</code></dt> <dd> the same as <a href="#node_removechildren"><code>node.removeChildren</code>()</a>; <a href="#node_addchild"><code>node.addChild(<i>node1</i>)</code></a>; <a href="#node_addchild"><code>node.addChild(<i>node2</i>)</code></a> (since <a href="changes.html#njs0.7.11">0.7.11</a>). </dd> <dt id="node_tags_abc"><code>node.$tags$<i>abc</i></code></dt> <dd> all children tags named <code><i>abc</i></code> of the node, writable since <a href="changes.html#njs0.7.11">0.7.11</a> </dd> <dt id="node_text"><code>node.$text</code></dt> <dd> the content of the node, writable since <a href="changes.html#njs0.7.11">0.7.11</a> </dd> <dt id="node_text_abc"><code>node.$text = 'abc' </code></dt> <dd> the same as <a href="#node_settext"><code>node.setText('abc')</code></a> (since <a href="changes.html#njs0.7.11">0.7.11</a>) </dd> <dt id="node_addchild"><code>node.addChild(<i>nd</i>)</code></dt> <dd> adds XMLNode as a child to node (since <a href="changes.html#njs0.7.11">0.7.11</a>). <code>nd</code> is recursively copied before adding to the node </dd> <dt id="node_removeallattr"><code>node.removeAllAttributes()</code></dt> <dd> removes all attributes of the node (since <a href="changes.html#njs0.7.11">0.7.11</a>) </dd> <dt id="node_removeattr"><code>node.removeAttribute(<i>attr_name</i>)</code></dt> <dd> removes the attribute named <code>attr_name</code> (since <a href="changes.html#njs0.7.11">0.7.11</a>) </dd> <dt id="node_removechildren"><code>node.removeChildren(<i>tag_name</i>)</code></dt> <dd> removes all the children tags named <code>tag_name</code> (since <a href="changes.html#njs0.7.11">0.7.11</a>). If <code>tag_name</code> is absent, all children tags are removed </dd> <dt id="node_removetext"><code>node.removeText()</code></dt> <dd> removes the node's text value (<a href="changes.html#njs0.7.11">0.7.11</a>) </dd> <dt id="node_setattr"><code>node.setAttribute(<i>attr_name</i>,
<i>value</i>)</code></dt> <dd> sets a value for an <code>attr_name</code> (since <a href="changes.html#njs0.7.11">0.7.11</a>). When the value is <code>null</code>, the attribute named <code>attr_name</code> is deleted </dd> <dt id="node_settext"><code>node.setText(<i>value</i>)</code></dt> <dd> sets a text value for the node (since <a href="changes.html#njs0.7.11">0.7.11</a>). When the value is <code>null</code>, the text of the node is deleted. </dd> </dl>
 </dd> <dt id="xml_xmlattr"><code>XMLAttr</code></dt> <dd> An XMLAttrs wrapper object around XML node attributes.  <dl class="compact"> <dt id="xmlattr_x"><code>attr.<i>abc</i></code></dt> <dd> the attribute value of <code><i>abc</i></code> </dd> </dl>
 </dd> </dl>

<h4 id="zlib">zlib</h4>

<table width="100%"> <tr><td><a href="#zlib_deflaterawsync"><code>zlib.deflateRawSync()</code></a></td></tr> <tr><td><a href="#zlib_deflatesync"><code>zlib.deflateSync()</code></a></td></tr> <tr><td><a href="#zlib_inflaterawsync"><code>zlib.inflateRawSync()</code></a></td></tr> <tr><td><a href="#zlib_inflatesync"><code>zlib.inflateSync()</code></a></td></tr> </table> <p> The zlib module provides compression functionality using the “deflate” and “inflate” algorithms (since <a href="changes.html#njs0.7.12">0.7.12</a>). The zlib module object is returned by <code>require('zlib')</code>. </p>
 <dl class="compact"> <dt id="zlib_deflaterawsync"><code>deflateRawSync(<i>string</i> |
<i>Buffer</i>[,
<i>options</i>])</code></dt> <dd> Compresses data using the “deflate” algorithm provided as a string or Buffer and does not append a zlib header. The buffer value can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code>. <code>Options</code> is an optional object that contains <a href="#zlib_options">zlib_options</a>. Returns Buffer instance that contains the compressed data. </dd> <dt id="zlib_deflatesync"><code>deflateSync(<i>string</i> |
<i>Buffer</i>[,
<i>options</i>])</code></dt> <dd> Compresses data using the “deflate” algorithm provided as a string or Buffer. The Buffer value can be a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code>. <code>Options</code> is an optional object that contains <a href="#zlib_options">zlib_options</a>. Returns Buffer instance that contains the compressed data. </dd> <dt id="zlib_inflaterawsync"><code>inflateRawSync(<i>string</i> |
<i>Buffer</i>)</code></dt> <dd> Decompresses a raw stream by using the “deflate” algorithm. Returns Buffer instance that contains the decompressed data. </dd> <dt id="zlib_inflatesync"><code>inflateSync(<i>string</i> |
<i>Buffer</i>)</code></dt> <dd> Decompresses a stream by using the “deflate” algorithm. Returns Buffer instance that contains the decompressed data. </dd> </dl>

<h4 id="zlib_options">zlib options</h4>
 <ul> <li> <code>chunkSize</code> — is an integer, by default is <code>1024</code> </li> <li> <code>dictionary</code> — is a <code>Buffer</code>, <code>TypedArray</code>, or <code>DataView</code>. by default is empty </li> <li> <code>level</code> — is an integer, compression only, see <a href="#zlib_compression_levels">zlib_compression_levels</a> </li> <li> <code>memLevel</code> — is an integer from <code>1</code> to <code>9</code>, compression only </li> <li> <code>strategy</code> — is an integer, compression only, see <a href="#zlib_compression_strategy">zlib_compression_strategy</a> </li> <li> <code>windowBits</code> — is an integer from <code>-15</code> to <code>-9</code> for raw data, from <code>9</code> to <code>15</code> for an ordinary stream </li> </ul>

<h4 id="zlib_compression_levels">zlib compression levels</h4>

<table width="100%"> <tr>
<td>Name</td>
<td>Description</td>
</tr> <tr>
<td><code>zlib.constants.Z_NO_COMPRESSION</code></td>
<td>no compression</td>
</tr> <tr>
<td><code>zlib.constants.Z_BEST_SPEED</code></td>
<td>fastest, produces the least compression</td>
</tr> <tr>
<td><code>zlib.constants.Z_DEFAULT_COMPRESSION</code></td>
<td>trade-off between speed and compression</td>
</tr> <tr>
<td><code>zlib.constants.Z_BEST_COMPRESSION</code></td>
<td>slowest, produces the most compression</td>
</tr> </table> <h4 id="zlib_compression_strategy">zlib compression strategy</h4>

<table width="100%"> <tr>
<td>Name</td>
<td>Description</td>
</tr> <tr>
<td><code>zlib.constants.Z_FILTERED</code></td>
<td>Filtered strategy: for the data produced by a filter or predictor</td>
</tr> <tr>
<td><code>zlib.constants.Z_HUFFMAN_ONLY</code></td>
<td>Huffman-only strategy: only Huffman encoding, no string matching</td>
</tr> <tr>
<td><code>zlib.constants.Z_RLE</code></td>
<td>Run Length Encoding strategy: limit match distances to one, better compression of PNG image data</td>
</tr> <tr>
<td><code>zlib.constants.Z_FIXED</code></td>
<td>Fixed table strategy: prevents the use of dynamic Huffman codes, a simpler decoder for special applications</td>
</tr> <tr>
<td><code>zlib.constants.Z_DEFAULT_STRATEGY</code></td>
<td>Default strategy, suitable for general purpose compression</td>
</tr> </table><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002-2021 Igor Sysoev<br>&copy; 2011-2024 Nginx, Inc.<br>Licensed under the BSD License.<br>
    <a href="https://nginx.org/en/docs/njs/reference.html" class="_attribution-link">https://nginx.org/en/docs/njs/reference.html</a>
  </p>
</div>
