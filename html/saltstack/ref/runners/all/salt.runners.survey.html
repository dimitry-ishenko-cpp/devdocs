<h1>salt.runners.survey</h1> <p>A general map/reduce style salt runner for aggregating results returned by several different minions.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> <p>Aggregated results are sorted by the size of the minion pools which returned matching results.</p> <p>Useful for playing the game: <em>"some of these things are not like the others..."</em> when identifying discrepancies in a large infrastructure managed by salt.</p> <dl class="py function"> <h3 id="salt.runners.survey.diff"> salt.runners.survey.diff(*args, **kwargs)</h3> <dd>
<p>Return the DIFFERENCE of the result sets returned by each matching minion pool</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> <p>These pools are determined from the aggregated and sorted results of a salt command.</p> <p>This command displays the "diffs" as a series of 2-way differences -- namely the difference between the FIRST displayed minion pool (according to sort order) and EACH SUBSEQUENT minion pool result set.</p> <p>Differences are displayed according to the Python <code class="docutils literal notranslate"><span class="pre">difflib.unified_diff()</span></code> as in the case of the salt execution module <code class="docutils literal notranslate"><span class="pre">file.get_diff</span></code>.</p> <p>This command is submitted via a salt runner using the general form:</p> <pre class="highlight-default notranslate" data-language="default">salt-run survey.diff [survey_sort=up/down] &lt;target&gt;
             &lt;salt-execution-module&gt; &lt;salt-execution-module parameters&gt;</pre> <p>Optionally accept a <code class="docutils literal notranslate"><span class="pre">survey_sort=</span></code> parameter. Default: <code class="docutils literal notranslate"><span class="pre">survey_sort=down</span></code></p> <p>CLI Example #1: (Example to display the "differences of files")</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run survey.diff survey_sort=up "*" cp.get_file_str file:///etc/hosts</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.runners.survey.hash"> salt.runners.survey.hash(*args, **kwargs)</h3> <dd>
<p>Return the MATCHING minion pools from the aggregated and sorted results of a salt command</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> <p>This command is submitted via a salt runner using the general form:</p> <pre class="highlight-default notranslate" data-language="default">salt-run survey.hash [survey_sort=up/down] &lt;target&gt;
          &lt;salt-execution-module&gt; &lt;salt-execution-module parameters&gt;</pre> <p>Optionally accept a <code class="docutils literal notranslate"><span class="pre">survey_sort=</span></code> parameter. Default: <code class="docutils literal notranslate"><span class="pre">survey_sort=down</span></code></p> <p>CLI Example #1: (functionally equivalent to <code class="docutils literal notranslate"><span class="pre">salt-run</span> <span class="pre">manage.up</span></code>)</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run survey.hash "*" test.ping</pre> <p>CLI Example #2: (find an "outlier" minion config file)</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run survey.hash "*" file.get_hash /etc/salt/minion survey_sort=up</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/runners/all/salt.runners.survey.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/runners/all/salt.runners.survey.html</a>
  </p>
</div>
