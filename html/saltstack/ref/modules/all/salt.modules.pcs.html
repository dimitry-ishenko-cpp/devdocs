<h1>salt.modules.pcs</h1> <div class="section" id="configure-a-pacemaker-corosync-cluster-with-pcs"> <h2>Configure a Pacemaker/Corosync cluster with PCS</h2> <p>Configure Pacemaker/Cororsync clusters with the Pacemaker/Cororsync conifguration system (PCS)</p> <dl class="field-list simple"> <dt class="field-odd">depends</dt> <dd class="field-odd">
<p>pcs</p> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <dl class="py function"> <h3 id="salt.modules.pcs.auth"> salt.modules.pcs.auth(nodes, pcsuser='hacluster', pcspasswd='hacluster', extra_args=None)</h3> <dd>
<p>Authorize nodes to the cluster</p> <dl class="simple"> <dt>nodes</dt>
<dd>
<p>a list of nodes which should be authorized to the cluster</p> </dd> <dt>pcsuser</dt>
<dd>
<p>user for communitcation with PCS (default: hacluster)</p> </dd> <dt>pcspasswd</dt>
<dd>
<p>password for pcsuser (default: hacluster)</p> </dd> <dt>extra_args</dt>
<dd>
<p>list of extra option for the 'pcs cluster auth' command</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.auth nodes='[ node1.example.org node2.example.org ]' pcsuser=hacluster pcspasswd=hoonetorg extra_args="[ '--force' ]"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.cib_create"> salt.modules.pcs.cib_create(cibfile, scope='configuration', extra_args=None)</h3> <dd>
<p>Create a CIB-file from the current CIB of the cluster</p> <dl class="simple"> <dt>cibfile</dt>
<dd>
<p>name/path of the file containing the CIB</p> </dd> <dt>scope</dt>
<dd>
<p>specific section of the CIB (default: configuration)</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for creating the CIB-file</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.cib_create cibfile='/tmp/VIP_apache_1.cib' scope=False</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.cib_push"> salt.modules.pcs.cib_push(cibfile, scope='configuration', extra_args=None)</h3> <dd>
<p>Push a CIB-file as the new CIB to the cluster</p> <dl class="simple"> <dt>cibfile</dt>
<dd>
<p>name/path of the file containing the CIB</p> </dd> <dt>scope</dt>
<dd>
<p>specific section of the CIB (default: configuration)</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for creating the CIB-file</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.cib_push cibfile='/tmp/VIP_apache_1.cib' scope=False</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.cluster_node_add"> salt.modules.pcs.cluster_node_add(node, extra_args=None)</h3> <dd>
<p>Add a node to the pacemaker cluster via pcs command</p> <dl class="simple"> <dt>node</dt>
<dd>
<p>node that should be added</p> </dd> <dt>extra_args</dt>
<dd>
<p>list of extra option for the 'pcs cluster node add' command</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.cluster_node_add node=node2.example.org</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.cluster_setup"> salt.modules.pcs.cluster_setup(nodes, pcsclustername='pcscluster', extra_args=None)</h3> <dd>
<p>Setup pacemaker cluster via pcs command</p> <dl class="simple"> <dt>nodes</dt>
<dd>
<p>a list of nodes which should be set up</p> </dd> <dt>pcsclustername</dt>
<dd>
<p>Name of the Pacemaker cluster (default: pcscluster)</p> </dd> <dt>extra_args</dt>
<dd>
<p>list of extra option for the 'pcs cluster setup' command</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.cluster_setup nodes='[ node1.example.org node2.example.org ]' pcsclustername=pcscluster</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.config_show"> salt.modules.pcs.config_show(cibfile=None)</h3> <dd>
<p>Show config of cluster</p> <dl class="simple"> <dt>cibfile</dt>
<dd>
<p>name/path of the file containing the CIB</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.config_show cibfile='/tmp/cib_for_galera'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.is_auth"> salt.modules.pcs.is_auth(nodes)</h3> <dd>
<p>Check if nodes are already authorized</p> <dl class="simple"> <dt>nodes</dt>
<dd>
<p>a list of nodes to be checked for authorization to the cluster</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.is_auth nodes='[node1.example.org node2.example.org]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.item_create"> salt.modules.pcs.item_create(item, item_id, item_type, create='create', extra_args=None, cibfile=None)</h3> <dd>
<p>Create an item via pcs command (mainly for use with the pcs state module)</p> <dl class="simple"> <dt>item</dt>
<dd>
<p>config, property, resource, constraint etc.</p> </dd> <dt>item_id</dt>
<dd>
<p>id of the item</p> </dd> <dt>item_type</dt>
<dd>
<p>item type</p> </dd> <dt>create</dt>
<dd>
<p>create command (create or set f.e., default: create)</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for the pcs command</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.item_show"> salt.modules.pcs.item_show(item, item_id=None, item_type=None, show='show', extra_args=None, cibfile=None)</h3> <dd>
<p>Show an item via pcs command (mainly for use with the pcs state module)</p> <dl class="simple"> <dt>item</dt>
<dd>
<p>config, property, resource, constraint etc.</p> </dd> <dt>item_id</dt>
<dd>
<p>id of the item</p> </dd> <dt>item_type</dt>
<dd>
<p>item type</p> </dd> <dt>show</dt>
<dd>
<p>show command (probably None, default: show)</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for the pcs command</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.prop_set"> salt.modules.pcs.prop_set(prop, value, extra_args=None, cibfile=None)</h3> <dd>
<p>Set the value of a cluster property</p> <dl class="simple"> <dt>prop</dt>
<dd>
<p>name of the property</p> </dd> <dt>value</dt>
<dd>
<p>value of the property prop</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for the pcs property command</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.prop_set prop='no-quorum-policy' value='ignore' cibfile='/tmp/2_node_cluster.cib'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.prop_show"> salt.modules.pcs.prop_show(prop, extra_args=None, cibfile=None)</h3> <dd>
<p>Show the value of a cluster property</p> <dl class="simple"> <dt>prop</dt>
<dd>
<p>name of the property</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for the pcs property command</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.prop_show cibfile='/tmp/2_node_cluster.cib' prop='no-quorum-policy' cibfile='/tmp/2_node_cluster.cib'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.resource_create"> salt.modules.pcs.resource_create(resource_id, resource_type, resource_options=None, cibfile=None)</h3> <dd>
<p>Create a resource via pcs command</p> <dl class="simple"> <dt>resource_id</dt>
<dd>
<p>name for the resource</p> </dd> <dt>resource_type</dt>
<dd>
<p>resource type (f.e. ocf:heartbeat:IPaddr2 or VirtualIP)</p> </dd> <dt>resource_options</dt>
<dd>
<p>additional options for creating the resource</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB for manipulation</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.resource_create resource_id='galera' resource_type='ocf:heartbeat:galera' resource_options="['wsrep_cluster_address=gcomm://node1.example.org,node2.example.org,node3.example.org', '--master']" cibfile='/tmp/cib_for_galera.cib'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.resource_show"> salt.modules.pcs.resource_show(resource_id, extra_args=None, cibfile=None)</h3> <dd>
<p>Show a resource via pcs command</p> <dl class="simple"> <dt>resource_id</dt>
<dd>
<p>name of the resource</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for the pcs command</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.resource_show resource_id='galera' cibfile='/tmp/cib_for_galera.cib'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.stonith_create"> salt.modules.pcs.stonith_create(stonith_id, stonith_device_type, stonith_device_options=None, cibfile=None)</h3> <dd>
<p>Create a stonith resource via pcs command</p> <dl class="simple"> <dt>stonith_id</dt>
<dd>
<p>name for the stonith resource</p> </dd> <dt>stonith_device_type</dt>
<dd>
<p>name of the stonith agent fence_eps, fence_xvm f.e.</p> </dd> <dt>stonith_device_options</dt>
<dd>
<p>additional options for creating the stonith resource</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB for manipulation</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.stonith_create stonith_id='eps_fence' stonith_device_type='fence_eps'
                            stonith_device_options="['pcmk_host_map=node1.example.org:01;node2.example.org:02', 'ipaddr=myepsdevice.example.org', 'action=reboot', 'power_wait=5', 'verbose=1', 'debug=/var/log/pcsd/eps_fence.log', 'login=hidden', 'passwd=hoonetorg']" cibfile='/tmp/cib_for_stonith.cib'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.pcs.stonith_show"> salt.modules.pcs.stonith_show(stonith_id, extra_args=None, cibfile=None)</h3> <dd>
<p>Show the value of a cluster stonith</p> <dl class="simple"> <dt>stonith_id</dt>
<dd>
<p>name for the stonith resource</p> </dd> <dt>extra_args</dt>
<dd>
<p>additional options for the pcs stonith command</p> </dd> <dt>cibfile</dt>
<dd>
<p>use cibfile instead of the live CIB</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pcs.stonith_show stonith_id='eps_fence' cibfile='/tmp/2_node_cluster.cib'</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.pcs.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.pcs.html</a>
  </p>
</div>
