<h1>salt.modules.consul</h1> <p>Interact with Consul</p> <p><a class="reference external" href="https://www.consul.io">https://www.consul.io</a></p> <dl class="py function"> <h3 id="salt.modules.consul.acl_clone"> salt.modules.consul.acl_clone(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Information about an ACL token.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>id</strong> -- Unique identifier for the ACL to update.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean, message of success or failure, and new ID of cloned ACL.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.acl_info id='c1c4d223-91cb-3d1f-1ee8-f2af9e7b6716'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.acl_create"> salt.modules.consul.acl_create(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Create a new ACL token.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>name</strong> -- Meaningful indicator of the ACL's purpose.</p></li> <li><p><strong>type</strong> -- Type is either client or management. A management token is comparable to a root user and has the ability to perform any action including creating, modifying, and deleting ACLs.</p></li> <li><p><strong>rules</strong> -- The Consul server URL.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.acl_create</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.acl_delete"> salt.modules.consul.acl_delete(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Delete an ACL token.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>id</strong> -- Unique identifier for the ACL to update.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.acl_delete id='c1c4d223-91cb-3d1f-1ee8-f2af9e7b6716'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.acl_info"> salt.modules.consul.acl_info(consul_url=None, **kwargs)</h3> <dd>
<p>Information about an ACL token.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>id</strong> -- Unique identifier for the ACL to update.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Information about the ACL requested.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.acl_info id='c1c4d223-91cb-3d1f-1ee8-f2af9e7b6716'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.acl_list"> salt.modules.consul.acl_list(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>List the ACL tokens.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>List of ACLs</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.acl_list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.acl_update"> salt.modules.consul.acl_update(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Update an ACL token.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>name</strong> -- Meaningful indicator of the ACL's purpose.</p></li> <li><p><strong>id</strong> -- Unique identifier for the ACL to update.</p></li> <li><p><strong>type</strong> -- Type is either client or management. A management token is comparable to a root user and has the ability to perform any action including creating, modifying, and deleting ACLs.</p></li> <li><p><strong>rules</strong> -- The Consul server URL.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.acl_update</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_check_deregister"> salt.modules.consul.agent_check_deregister(consul_url=None, token=None, checkid=None)</h3> <dd>
<p>The agent will take care of deregistering the check from the Catalog.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>checkid</strong> -- The ID of the check to deregister from Consul.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_check_deregister checkid='Memory Utilization'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_check_fail"> salt.modules.consul.agent_check_fail(consul_url=None, token=None, checkid=None, **kwargs)</h3> <dd>
<p>This endpoint is used with a check that is of the TTL type. When this is called, the status of the check is set to critical and the TTL clock is reset.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>checkid</strong> -- The ID of the check to deregister from Consul.</p></li> <li><p><strong>note</strong> -- A human-readable message with the status of the check.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_check_fail checkid='redis_check1' note='Forcing check into critical state.'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_check_pass"> salt.modules.consul.agent_check_pass(consul_url=None, token=None, checkid=None, **kwargs)</h3> <dd>
<p>This endpoint is used with a check that is of the TTL type. When this is called, the status of the check is set to passing and the TTL clock is reset.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>checkid</strong> -- The ID of the check to mark as passing.</p></li> <li><p><strong>note</strong> -- A human-readable message with the status of the check.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_check_pass checkid='redis_check1' note='Forcing check into passing state.'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_check_register"> salt.modules.consul.agent_check_register(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>The register endpoint is used to add a new check to the local agent.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>name</strong> -- The description of what the check is for.</p></li> <li><p><strong>id</strong> -- The unique name to use for the check, if not provided 'name' is used.</p></li> <li><p><strong>notes</strong> -- Human readable description of the check.</p></li> <li><p><strong>script</strong> -- If script is provided, the check type is a script, and Consul will evaluate that script based on the interval parameter.</p></li> <li><p><strong>http</strong> -- Check will perform an HTTP GET request against the value of HTTP (expected to be a URL) based on the interval parameter.</p></li> <li><p><strong>ttl</strong> -- If a TTL type is used, then the TTL update endpoint must be used periodically to update the state of the check.</p></li> <li><p><strong>interval</strong> -- Interval at which the check should run.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_check_register name='Memory Utilization' script='/usr/local/bin/check_mem.py' interval='15s'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_check_warn"> salt.modules.consul.agent_check_warn(consul_url=None, token=None, checkid=None, **kwargs)</h3> <dd>
<p>This endpoint is used with a check that is of the TTL type. When this is called, the status of the check is set to warning and the TTL clock is reset.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>checkid</strong> -- The ID of the check to deregister from Consul.</p></li> <li><p><strong>note</strong> -- A human-readable message with the status of the check.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_check_warn checkid='redis_check1' note='Forcing check into warning state.'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_checks"> salt.modules.consul.agent_checks(consul_url=None, token=None)</h3> <dd>
<p>Returns the checks the local agent is managing</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns the checks the local agent is managing</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_checks</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_join"> salt.modules.consul.agent_join(consul_url=None, token=None, address=None, **kwargs)</h3> <dd>
<p>Triggers the local agent to join a node</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>address</strong> -- The address for the agent to connect to.</p></li> <li><p><strong>wan</strong> -- Causes the agent to attempt to join using the WAN pool.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_join address='192.168.1.1'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_leave"> salt.modules.consul.agent_leave(consul_url=None, token=None, node=None)</h3> <dd>
<p>Used to instruct the agent to force a node into the left state.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>node</strong> -- The node the agent will force into left state</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_leave node='web1.example.com'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_maintenance"> salt.modules.consul.agent_maintenance(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Manages node maintenance mode</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>enable</strong> -- The enable flag is required. Acceptable values are either true (to enter maintenance mode) or false (to resume normal operation).</p></li> <li><p><strong>reason</strong> -- If provided, its value should be a text string explaining the reason for placing the node into maintenance mode.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_maintenance enable='False' reason='Upgrade in progress'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_members"> salt.modules.consul.agent_members(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Returns the members as seen by the local serf agent</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns the members as seen by the local serf agent</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_members</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_self"> salt.modules.consul.agent_self(consul_url=None, token=None)</h3> <dd>
<p>Returns the local node configuration</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns the local node configuration</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_self</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_service_deregister"> salt.modules.consul.agent_service_deregister(consul_url=None, token=None, serviceid=None)</h3> <dd>
<p>Used to remove a service.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>serviceid</strong> -- A serviceid describing the service.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_service_deregister serviceid='redis'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_service_maintenance"> salt.modules.consul.agent_service_maintenance(consul_url=None, token=None, serviceid=None, **kwargs)</h3> <dd>
<p>Used to place a service into maintenance mode.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>serviceid</strong> -- A name of the service.</p></li> <li><p><strong>enable</strong> -- Whether the service should be enabled or disabled.</p></li> <li><p><strong>reason</strong> -- A human readable message of why the service was enabled or disabled.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_service_deregister serviceid='redis' enable='True' reason='Down for upgrade'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_service_register"> salt.modules.consul.agent_service_register(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>The used to add a new service, with an optional health check, to the local agent.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>name</strong> -- A name describing the service.</p></li> <li><p><strong>address</strong> -- The address used by the service, defaults to the address of the agent.</p></li> <li><p><strong>port</strong> -- The port used by the service.</p></li> <li><p><strong>id</strong> -- Unique ID to identify the service, if not provided the value of the name parameter is used.</p></li> <li><p><strong>tags</strong> -- Identifying tags for service, string or list.</p></li> <li><p><strong>script</strong> -- If script is provided, the check type is a script, and Consul will evaluate that script based on the interval parameter.</p></li> <li><p><strong>http</strong> -- Check will perform an HTTP GET request against the value of HTTP (expected to be a URL) based on the interval parameter.</p></li> <li><p><strong>check_ttl</strong> -- If a TTL type is used, then the TTL update endpoint must be used periodically to update the state of the check.</p></li> <li><p><strong>check_interval</strong> -- Interval at which the check should run.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_service_register name='redis' tags='["master", "v1"]' address="127.0.0.1" port="8080" check_script="/usr/local/bin/check_redis.py" interval="10s"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.agent_services"> salt.modules.consul.agent_services(consul_url=None, token=None)</h3> <dd>
<p>Returns the services the local agent is managing</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns the services the local agent is managing</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.agent_services</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_datacenters"> salt.modules.consul.catalog_datacenters(consul_url=None, token=None)</h3> <dd>
<p>Return list of available datacenters from catalog.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The list of available datacenters.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_datacenters</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_deregister"> salt.modules.consul.catalog_deregister(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Deregisters a node, service, or check</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>node</strong> -- The node to deregister.</p></li> <li><p><strong>datacenter</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> <li><p><strong>checkid</strong> -- The ID of the health check to deregister.</p></li> <li><p><strong>serviceid</strong> -- The ID of the service to deregister.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_register node='node1' serviceid='redis_server1' checkid='redis_check1'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_node"> salt.modules.consul.catalog_node(consul_url=None, token=None, node=None, **kwargs)</h3> <dd>
<p>Information about the registered node.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>node</strong> -- The node to request information about.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Information about the requested node.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_service service='redis'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_nodes"> salt.modules.consul.catalog_nodes(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Return list of available nodes from catalog.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The list of available nodes.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_nodes</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_register"> salt.modules.consul.catalog_register(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Registers a new node, service, or check</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> <li><p><strong>node</strong> -- The node to register.</p></li> <li><p><strong>address</strong> -- The address of the node.</p></li> <li><p><strong>service</strong> -- The service that will be registered.</p></li> <li><p><strong>service_address</strong> -- The address that the service listens on.</p></li> <li><p><strong>service_port</strong> -- The port for the service.</p></li> <li><p><strong>service_id</strong> -- A unique identifier for the service, if this is not provided "name" will be used.</p></li> <li><p><strong>service_tags</strong> -- Any tags associated with the service.</p></li> <li><p><strong>check</strong> -- The name of the health check to register</p></li> <li><p><strong>check_status</strong> -- The initial status of the check, must be one of unknown, passing, warning, or critical.</p></li> <li><p><strong>check_service</strong> -- The service that the check is performed against.</p></li> <li><p><strong>check_id</strong> -- Unique identifier for the service.</p></li> <li><p><strong>check_notes</strong> -- An opaque field that is meant to hold human-readable text.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_register node='node1' address='192.168.1.1' service='redis' service_address='127.0.0.1' service_port='8080' service_id='redis_server1'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_service"> salt.modules.consul.catalog_service(consul_url=None, token=None, service=None, **kwargs)</h3> <dd>
<p>Information about the registered service.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> <li><p><strong>tag</strong> -- Filter returned services with tag parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Information about the requested service.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_service service='redis'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.catalog_services"> salt.modules.consul.catalog_services(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Return list of available services rom catalog.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The list of available services.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.catalog_services</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.delete"> salt.modules.consul.delete(consul_url=None, token=None, key=None, **kwargs)</h3> <dd>
<p>Delete values from Consul</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>key</strong> -- The key to use as the starting point for the list.</p></li> <li><p><strong>recurse</strong> -- Delete values recursively beginning at the value of key.</p></li> <li><p><strong>cas</strong> -- This flag is used to turn the DELETE into a Check-And-Set operation.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.delete key='web'
salt '*' consul.delete key='web' recurse='True'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.event_fire"> salt.modules.consul.event_fire(consul_url=None, token=None, name=None, **kwargs)</h3> <dd>
<p>List the ACL tokens.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>name</strong> -- The name of the event to fire.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> <li><p><strong>node</strong> -- Filter by node name.</p></li> <li><p><strong>service</strong> -- Filter by service name.</p></li> <li><p><strong>tag</strong> -- Filter by tag name.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>List of ACLs</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.event_fire name='deploy'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.event_list"> salt.modules.consul.event_list(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>List the recent events.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>name</strong> -- The name of the event to fire.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>List of ACLs</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.event_list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.get"> salt.modules.consul.get(consul_url=None, key=None, token=None, recurse=False, decode=False, raw=False)</h3> <dd>
<p>Get key from Consul</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>key</strong> -- The key to use as the starting point for the list.</p></li> <li><p><strong>recurse</strong> -- Return values recursively beginning at the value of key.</p></li> <li><p><strong>decode</strong> -- By default values are stored as Base64 encoded values, decode will return the whole key with the value decoded.</p></li> <li><p><strong>raw</strong> -- Simply return the decoded value of the key.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The keys in Consul.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.get key='web/key1'
salt '*' consul.get key='web' recurse=True
salt '*' consul.get key='web' recurse=True decode=True</pre> <p>By default values stored in Consul are base64 encoded, passing the decode option will show them as the decoded values.</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.get key='web' recurse=True decode=True raw=True</pre> <p>By default Consult will return other information about the key, the raw option will return only the raw value.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.health_checks"> salt.modules.consul.health_checks(consul_url=None, token=None, service=None, **kwargs)</h3> <dd>
<p>Health information about the registered service.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>service</strong> -- The service to request health information about.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Health information about the requested node.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.health_checks service='redis1'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.health_node"> salt.modules.consul.health_node(consul_url=None, token=None, node=None, **kwargs)</h3> <dd>
<p>Health information about the registered node.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>node</strong> -- The node to request health information about.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Health information about the requested node.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.health_node node='node1'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.health_service"> salt.modules.consul.health_service(consul_url=None, token=None, service=None, **kwargs)</h3> <dd>
<p>Health information about the registered service.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>service</strong> -- The service to request health information about.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> <li><p><strong>tag</strong> -- Filter returned services with tag parameter.</p></li> <li><p><strong>passing</strong> -- Filter results to only nodes with all checks in the passing state.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Health information about the requested node.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.health_service service='redis1'

salt '*' consul.health_service service='redis1' passing='True'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.health_state"> salt.modules.consul.health_state(consul_url=None, token=None, state=None, **kwargs)</h3> <dd>
<p>Returns the checks in the state provided on the path.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>state</strong> -- The state to show checks for. The supported states are any, unknown, passing, warning, or critical. The any state is a wildcard that can be used to return all checks.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The checks in the provided state.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.health_state state='redis1'

salt '*' consul.health_state service='redis1' passing='True'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.list_"> salt.modules.consul.list_(consul_url=None, token=None, key=None, **kwargs)</h3> <dd>
<p>List keys in Consul</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>key</strong> -- The key to use as the starting point for the list.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The list of keys.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.list
salt '*' consul.list key='web'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.put"> salt.modules.consul.put(consul_url=None, token=None, key=None, value=None, **kwargs)</h3> <dd>
<p>Put values into Consul</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>key</strong> -- The key to use as the starting point for the list.</p></li> <li><p><strong>value</strong> -- The value to set the key to.</p></li> <li><p><strong>flags</strong> -- This can be used to specify an unsigned value between 0 and 2^64-1. Clients can choose to use this however makes sense for their application.</p></li> <li><p><strong>cas</strong> -- This flag is used to turn the PUT into a Check-And-Set operation.</p></li> <li><p><strong>acquire</strong> -- This flag is used to turn the PUT into a lock acquisition operation.</p></li> <li><p><strong>release</strong> -- This flag is used to turn the PUT into a lock release operation.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.put key='web/key1' value="Hello there"

salt '*' consul.put key='web/key1' value="Hello there" acquire='d5d371f4-c380-5280-12fd-8810be175592'

salt '*' consul.put key='web/key1' value="Hello there" release='d5d371f4-c380-5280-12fd-8810be175592'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.session_create"> salt.modules.consul.session_create(consul_url=None, token=None, **kwargs)</h3> <dd>
<p>Used to create a session.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>lockdelay</strong> -- Duration string using a "s" suffix for seconds. The default is 15s.</p></li> <li><p><strong>node</strong> -- Must refer to a node that is already registered, if specified. By default, the agent's own node name is used.</p></li> <li><p><strong>name</strong> -- A human-readable name for the session</p></li> <li><p><strong>checks</strong> -- A list of associated health checks. It is highly recommended that, if you override this list, you include the default "serfHealth".</p></li> <li><p><strong>behavior</strong> -- Can be set to either release or delete. This controls the behavior when a session is invalidated. By default, this is release, causing any locks that are held to be released. Changing this to delete causes any locks that are held to be deleted. delete is useful for creating ephemeral key/value entries.</p></li> <li><p><strong>ttl</strong> -- Session is invalidated if it is not renewed before the TTL expires</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean and message indicating success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.session_create node='node1' name='my-session' behavior='delete' ttl='3600s'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.session_destroy"> salt.modules.consul.session_destroy(consul_url=None, token=None, session=None, **kwargs)</h3> <dd>
<p>Destroy session</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>session</strong> -- The ID of the session to destroy.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.session_destroy session='c1c4d223-91cb-3d1f-1ee8-f2af9e7b6716'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.session_info"> salt.modules.consul.session_info(consul_url=None, token=None, session=None, **kwargs)</h3> <dd>
<p>Information about a session</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>session</strong> -- The ID of the session to return information about.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Boolean &amp; message of success or failure.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.session_info session='c1c4d223-91cb-3d1f-1ee8-f2af9e7b6716'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.session_list"> salt.modules.consul.session_list(consul_url=None, token=None, return_list=False, **kwargs)</h3> <dd>
<p>Used to list sessions.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>consul_url</strong> -- The Consul server URL.</p></li> <li><p><strong>dc</strong> -- By default, the datacenter of the agent is queried; however, the dc can be provided using the "dc" parameter.</p></li> <li><p><strong>return_list</strong> -- By default, all information about the sessions is returned, using the return_list parameter will return a list of session IDs.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A list of all available sessions.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.session_list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.status_leader"> salt.modules.consul.status_leader(consul_url=None, token=None)</h3> <dd>
<p>Returns the current Raft leader</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The address of the Raft leader.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.status_leader</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.consul.status_peers"> salt.modules.consul.status_peers(consul_url, token=None)</h3> <dd>
<p>Returns the current Raft peer set</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>consul_url</strong> -- The Consul server URL.</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Retrieves the Raft peers for the datacenter in which the agent is running.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' consul.status_peers</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.consul.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.consul.html</a>
  </p>
</div>
