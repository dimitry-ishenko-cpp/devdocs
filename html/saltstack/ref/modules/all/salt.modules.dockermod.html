<h1>salt.modules.dockermod</h1> <p>Management of Docker Containers</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>This module has replaced the legacy docker execution module.</p> </div> <dl class="field-list simple"> <dt class="field-odd">depends</dt> <dd class="field-odd">
<p><a class="reference external" href="https://pypi.python.org/pypi/docker">docker</a> Python module</p> </dd> </dl> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Older releases of the Python bindings for Docker were called <a class="reference external" href="https://pypi.python.org/pypi/docker-py">docker-py</a> in PyPI. All releases of <a class="reference external" href="https://pypi.python.org/pypi/docker">docker</a>, and releases of <a class="reference external" href="https://pypi.python.org/pypi/docker-py">docker-py</a> &gt;= 1.6.0 are supported. These python bindings can easily be installed using <a class="reference internal" href="salt.modules.pip.html#salt.modules.pip.install" title="salt.modules.pip.install"><code class="xref py py-func docutils literal notranslate"><span class="pre">pip.install</span></code></a>:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion pip.install docker</pre> <p>To upgrade from <a class="reference external" href="https://pypi.python.org/pypi/docker-py">docker-py</a> to <a class="reference external" href="https://pypi.python.org/pypi/docker">docker</a>, you must first uninstall <a class="reference external" href="https://pypi.python.org/pypi/docker-py">docker-py</a>, and then install <a class="reference external" href="https://pypi.python.org/pypi/docker">docker</a>:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion pip.uninstall docker-py
salt myminion pip.install docker</pre> </div> <div class="section" id="authentication"> <h2>Authentication</h2> <p>If you have previously performed a <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">login</span></code> from the minion, then the credentials saved in <code class="docutils literal notranslate"><span class="pre">~/.docker/config.json</span></code> will be used for any actions which require authentication. If not, then credentials can be configured in any of the following locations:</p> <ul class="simple"> <li><p>Minion config file</p></li> <li><p>Grains</p></li> <li><p>Pillar data</p></li> <li><p>Master config file (requires <code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">pillar_opts</span></code> to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> in Minion config file in order to work)</p></li> </ul> <div class="admonition important"> <p class="admonition-title">Important</p> <p>Versions prior to 3000 require that Docker credentials are configured in Pillar data. Be advised that Pillar data is still recommended though, because this keeps the configuration from being stored on the Minion.</p> <p>Also, keep in mind that if one gets your <code class="docutils literal notranslate"><span class="pre">~/.docker/config.json</span></code>, the password can be decoded from its contents.</p> </div> <p>The configuration schema is as follows:</p> <pre class="highlight-yaml notranslate" data-language="yaml">docker-registries:
  &lt;registry_url&gt;:
    username: &lt;username&gt;
    password: &lt;password&gt;</pre> <p>For example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">docker-registries:
  hub:
    username: foo
    password: s3cr3t</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>As of the 2016.3.7, 2016.11.4, and 2017.7.0 releases of Salt, credentials for the Docker Hub can be configured simply by specifying <code class="docutils literal notranslate"><span class="pre">hub</span></code> in place of the registry URL. In earlier releases, it is necessary to specify the actual registry URL for the Docker Hub (i.e. <code class="docutils literal notranslate"><span class="pre">https://index.docker.io/v1/</span></code>).</p> </div> <p>More than one registry can be configured. Salt will look for Docker credentials in the <code class="docutils literal notranslate"><span class="pre">docker-registries</span></code> Pillar key, as well as any key ending in <code class="docutils literal notranslate"><span class="pre">-docker-registries</span></code>. For example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">docker-registries:
  'https://mydomain.tld/registry:5000':
    username: foo
    password: s3cr3t

foo-docker-registries:
  https://index.foo.io/v1/:
    username: foo
    password: s3cr3t

bar-docker-registries:
  https://index.bar.io/v1/:
    username: foo
    password: s3cr3t</pre> <p>To login to the configured registries, use the <a class="reference internal" href="#salt.modules.dockermod.login" title="salt.modules.dockermod.login"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.login</span></code></a> function. This only needs to be done once for a given registry, and it will store/update the credentials in <code class="docutils literal notranslate"><span class="pre">~/.docker/config.json</span></code>.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>For Salt releases before 2016.3.7 and 2016.11.4, <a class="reference internal" href="#salt.modules.dockermod.login" title="salt.modules.dockermod.login"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.login</span></code></a> is not available. Instead, Salt will try to authenticate using each of your configured registries for each push/pull, behavior which is not correct and has been resolved in newer releases.</p> </div> </div> <div class="section" id="configuration-options"> <h2>Configuration Options</h2> <p>The following configuration options can be set to fine-tune how Salt uses Docker:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">docker.url</span></code>: URL to the docker service (default: local socket).</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">docker.version</span></code>: API version to use (should not need to be set manually in the vast majority of cases)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">docker.exec_driver</span></code>: Execution driver to use, one of <code class="docutils literal notranslate"><span class="pre">nsenter</span></code>, <code class="docutils literal notranslate"><span class="pre">lxc-attach</span></code>, or <code class="docutils literal notranslate"><span class="pre">docker-exec</span></code>. See the <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">Executing Commands Within a Running Container</span></a> section for more details on how this config parameter is used.</p></li> </ul> <p>These configuration options are retrieved using <a class="reference internal" href="salt.modules.config.html#salt.modules.config.get" title="salt.modules.config.get"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config.get</span></code></a> (click the link for further information).</p> </div> <div class="section" id="executing-commands-within-a-running-container"> <h2>Executing Commands Within a Running Container</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <p>With the release of Docker 1.13.1, the Execution Driver has been removed. Starting in versions 2016.3.6, 2016.11.4, and 2017.7.0, Salt defaults to using <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">exec</span></code> to run commands in containers, however for older Salt releases it will be necessary to set the <code class="docutils literal notranslate"><span class="pre">docker.exec_driver</span></code> config option to either <code class="docutils literal notranslate"><span class="pre">docker-exec</span></code> or <code class="docutils literal notranslate"><span class="pre">nsenter</span></code> for Docker versions 1.13.1 and newer.</p> </div> <p>Multiple methods exist for executing commands within Docker containers:</p> <ul class="simple"> <li><p><a class="reference external" href="https://linuxcontainers.org/lxc/manpages/man1/lxc-attach.1.html">lxc-attach</a>: Default for older versions of docker</p></li> <li><p><a class="reference external" href="http://man7.org/linux/man-pages/man1/nsenter.1.html">nsenter</a>: Enters container namespace to run command</p></li> <li><p><a class="reference external" href="http://docs.docker.com/reference/commandline/cli/#exec">docker-exec</a>: Native support for executing commands in Docker containers (added in Docker 1.3)</p></li> </ul> <p>Adding a configuration option (see <a class="reference internal" href="salt.modules.config.html#salt.modules.config.get" title="salt.modules.config.get"><code class="xref py py-func docutils literal notranslate"><span class="pre">config.get</span></code></a>) called <code class="docutils literal notranslate"><span class="pre">docker.exec_driver</span></code> will tell Salt which execution driver to use:</p> <pre class="highlight-yaml notranslate" data-language="yaml">docker.exec_driver: docker-exec</pre> <p>If this configuration option is not found, Salt will use the appropriate interface (either <a class="reference external" href="http://man7.org/linux/man-pages/man1/nsenter.1.html">nsenter</a> or <a class="reference external" href="https://linuxcontainers.org/lxc/manpages/man1/lxc-attach.1.html">lxc-attach</a>) based on the <code class="docutils literal notranslate"><span class="pre">Execution</span> <span class="pre">Driver</span></code> value returned from <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">info</span></code>. <a class="reference external" href="http://docs.docker.com/reference/commandline/cli/#exec">docker-exec</a> will not be used by default, as it is presently (as of version 1.6.2) only able to execute commands as the effective user of the container. Thus, if a <code class="docutils literal notranslate"><span class="pre">USER</span></code> directive was used to run as a non-privileged user, <a class="reference external" href="http://docs.docker.com/reference/commandline/cli/#exec">docker-exec</a> would be unable to perform the action as root. Salt can still use <a class="reference external" href="http://docs.docker.com/reference/commandline/cli/#exec">docker-exec</a> as an execution driver, but must be explicitly configured (as in the example above) to do so at this time.</p> <p>If possible, try to manually specify the execution driver, as it will save Salt a little work.</p> <p>This execution module provides functions that shadow those from the <a class="reference internal" href="salt.modules.cmdmod.html#module-salt.modules.cmdmod" title="salt.modules.cmdmod"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cmd</span></code></a> module. They are as follows:</p> <ul class="simple"> <li><p><a class="reference internal" href="#salt.modules.dockermod.retcode" title="salt.modules.dockermod.retcode"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.retcode</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.run" title="salt.modules.dockermod.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.run</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.run_all" title="salt.modules.dockermod.run_all"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.run_all</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.run_stderr" title="salt.modules.dockermod.run_stderr"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.run_stderr</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.run_stdout" title="salt.modules.dockermod.run_stdout"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.run_stdout</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.script" title="salt.modules.dockermod.script"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.script</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.script_retcode" title="salt.modules.dockermod.script_retcode"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.script_retcode</span></code></a></p></li> </ul> </div> <div class="section" id="detailed-function-documentation"> <h2>Detailed Function Documentation</h2> <dl class="py class"> <dt id="salt.modules.dockermod.DockerJSONDecoder"> <em class="property">class </em><code class="sig-prename descclassname">salt.modules.dockermod.</code><code class="sig-name descname">DockerJSONDecoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">object_hook</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parse_float</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parse_int</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parse_constant</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">strict</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">object_pairs_hook</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<dl class="py method"> <dt id="salt.modules.dockermod.DockerJSONDecoder.decode"> <code class="sig-name descname">decode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">s</span></em>, <em class="sig-param"><span class="n">_w</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Return the Python representation of <code class="docutils literal notranslate"><span class="pre">s</span></code> (a <code class="docutils literal notranslate"><span class="pre">str</span></code> instance containing a JSON document).</p> </dd>
</dl> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.apply_"> salt.modules.dockermod.apply_(name, mods=None, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>Apply states! This function will call highstate or state.sls based on the arguments passed in, <code class="docutils literal notranslate"><span class="pre">apply</span></code> is intended to be the main gateway for all state executions.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'docker' docker.apply web01
salt 'docker' docker.apply web01 test
salt 'docker' docker.apply web01 test,pkgs</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.build"> salt.modules.dockermod.build(path=None, repository=None, tag=None, cache=True, rm=True, api_response=False, fileobj=None, dockerfile=None, buildargs=None)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>If the built image should be tagged, then the repository and tag must now be passed separately using the <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> arguments, rather than together in the (now deprecated) <code class="docutils literal notranslate"><span class="pre">image</span></code> argument.</p> </div> <p>Builds a docker image from a Dockerfile or a URL</p> <dl> <dt>path</dt>
<dd>
<p>Path to directory on the Minion containing a Dockerfile</p> </dd> <dt>repository</dt>
<dd>
<p>Optional repository name for the image being built</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tag<span class="classifier">latest</span>
</dt>
<dd>
<p>Tag name for the image (required if <code class="docutils literal notranslate"><span class="pre">repository</span></code> is passed)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>image</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0: </span>Use both <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> instead</p> </div> </dd> <dt>cache<span class="classifier">True</span>
</dt>
<dd>
<p>Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to force the build process not to use the Docker image cache, and pull all required intermediate image layers</p> </dd> <dt>rm<span class="classifier">True</span>
</dt>
<dd>
<p>Remove intermediate containers created during build</p> </dd> <dt>api_response<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>: an <code class="docutils literal notranslate"><span class="pre">API_Response</span></code> key will be present in the return data, containing the raw output from the Docker API.</p> </dd> <dt>fileobj</dt>
<dd>
<p>Allows for a file-like object containing the contents of the Dockerfile to be passed in place of a file <code class="docutils literal notranslate"><span class="pre">path</span></code> argument. This argument should not be used from the CLI, only from other Salt code.</p> </dd> <dt>dockerfile</dt>
<dd>
<p>Allows for an alternative Dockerfile to be specified. Path to alternative Dockefile is relative to the build path for the Docker container.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> </dd> <dt>buildargs</dt>
<dd>
<p>A dictionary of build arguments provided to the docker build process.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing one or more of the following keys:</p> <ul> <li><p><code class="docutils literal notranslate"><span class="pre">Id</span></code> - ID of the newly-built image</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the build</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">Intermediate_Containers</span></code> - IDs of containers created during the course of the build process</p> <p><em>(Only present if rm=False)</em></p> </li> <li>
<dl class="simple"> <dt>
<code class="docutils literal notranslate"><span class="pre">Images</span></code> - A dictionary containing one or more of the following keys:</dt>
<dd>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Already_Pulled</span></code> - Layers that that were already present on the Minion</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Pulled</span></code> - Layers that that were pulled</p></li> </ul> </dd> </dl> <p><em>(Only present if the image specified by the "repository" and "tag" arguments was not present on the Minion, or if cache=False)</em></p> </li> <li>
<p><code class="docutils literal notranslate"><span class="pre">Status</span></code> - A string containing a summary of the pull action (usually a message saying that an image was downloaded, or that it was up to date).</p> <p><em>(Only present if the image specified by the "repository" and "tag" arguments was not present on the Minion, or if cache=False)</em></p> </li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.build /path/to/docker/build/dir
salt myminion docker.build https://github.com/myuser/myrepo.git repository=myimage tag=latest
salt myminion docker.build /path/to/docker/build/dir dockerfile=Dockefile.different repository=myimage tag=dev</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.call"> salt.modules.dockermod.call(name, function, *args, **kwargs)</h3> <dd>
<p>Executes a Salt function inside a running container</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> <p>The container does not need to have Salt installed, but Python is required.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>function</dt>
<dd>
<p>Salt execution module function</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.call test.ping
salt myminion test.arg arg1 arg2 key1=val1
salt myminion dockerng.call compassionate_mirzakhani test.arg arg1 arg2 key1=val1</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.commit"> salt.modules.dockermod.commit(name, repository, tag='latest', message=None, author=None)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>The repository and tag must now be passed separately using the <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> arguments, rather than together in the (now deprecated) <code class="docutils literal notranslate"><span class="pre">image</span></code> argument.</p> </div> <p>Commits a container, thereby promoting it to an image. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">commit</span></code> Docker CLI command.</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID to commit</p> </dd> <dt>repository</dt>
<dd>
<p>Repository name for the image being committed</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tag<span class="classifier">latest</span>
</dt>
<dd>
<p>Tag name for the image</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>image</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0: </span>Use both <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> instead</p> </div> </dd> <dt>message</dt>
<dd>
<p>Commit message (Optional)</p> </dd> <dt>author</dt>
<dd>
<p>Author name (Optional)</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Id</span></code> - ID of the newly-created image</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Image</span></code> - Name of the newly-created image</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the commit</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.commit mycontainer myuser/myimage mytag</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.compare_container"> salt.modules.dockermod.compare_container(first, second, ignore=None)</h3> <dd>
<p>This function is an alias of <code class="docutils literal notranslate"><span class="pre">compare_containers</span></code>.</p> <blockquote> <div>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Renamed from <code class="docutils literal notranslate"><span class="pre">docker.compare_container</span></code> to <code class="docutils literal notranslate"><span class="pre">docker.compare_containers</span></code> (old function name remains as an alias)</p> </div> <p>Compare two containers' Config and and HostConfig and return any differences between the two.</p> <dl class="simple"> <dt>first</dt>
<dd>
<p>Name or ID of first container</p> </dd> <dt>second</dt>
<dd>
<p>Name or ID of second container</p> </dd> <dt>ignore</dt>
<dd>
<p>A comma-separated list (or Python list) of keys to ignore when comparing. This is useful when comparing two otherwise identical containers which have different hostnames.</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.compare_containers foo bar
salt myminion docker.compare_containers foo bar ignore=Hostname</pre> </div>
</blockquote> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.compare_container_networks"> salt.modules.dockermod.compare_container_networks(first, second)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> <p>Returns the differences between two containers' networks. When a network is only present one of the two containers, that network's diff will simply be represented with <code class="docutils literal notranslate"><span class="pre">True</span></code> for the side of the diff in which the network is present) and <code class="docutils literal notranslate"><span class="pre">False</span></code> for the side of the diff in which the network is absent.</p> <p>This function works by comparing the contents of both containers' <code class="docutils literal notranslate"><span class="pre">Networks</span></code> keys (under <code class="docutils literal notranslate"><span class="pre">NetworkSettings</span></code>) in the return data from <a class="reference internal" href="#salt.modules.dockermod.inspect_container" title="salt.modules.dockermod.inspect_container"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.inspect_container</span></code></a>. Because each network contains some items that either A) only set at runtime, B) naturally varying from container to container, or both, by default the following keys in each network are examined:</p> <ul class="simple"> <li><p><strong>Aliases</strong></p></li> <li><p><strong>Links</strong></p></li> <li><p><strong>IPAMConfig</strong></p></li> </ul> <p>The exception to this is if <code class="docutils literal notranslate"><span class="pre">IPAMConfig</span></code> is unset (i.e. null) in one container but not the other. This happens when no static IP configuration is set, and automatic IP configuration is in effect. So, in order to report on changes between automatic IP configuration in one container and static IP configuration in another container (as we need to do for the <a class="reference internal" href="../../states/all/salt.states.docker_container.html#salt.states.docker_container.running" title="salt.states.docker_container.running"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker_container.running</span></code></a> state), automatic IP configuration will also be checked in these cases.</p> <p>This function uses the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-docker.compare_container_networks"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">docker.compare_container_networks</span></code></a> minion config option to determine which keys to examine. This provides flexibility in the event that features added in a future Docker release necessitate changes to how Salt compares networks. In these cases, rather than waiting for a new Salt release one can just set <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-docker.compare_container_networks"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">docker.compare_container_networks</span></code></a>.</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3000: </span>This config option can now also be set in pillar data and grains. Additionally, it can be set in the master config file, provided that <code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">pillar_opts</span></code> is enabled on the minion.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The checks for automatic IP configuration described above only apply if <code class="docutils literal notranslate"><span class="pre">IPAMConfig</span></code> is among the keys set for static IP checks in <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-docker.compare_container_networks"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">docker.compare_container_networks</span></code></a>.</p> </div> <dl class="simple"> <dt>first</dt>
<dd>
<p>Name or ID of first container (old)</p> </dd> <dt>second</dt>
<dd>
<p>Name or ID of second container (new)</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.compare_container_networks foo bar</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.compare_containers"> salt.modules.dockermod.compare_containers(first, second, ignore=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Renamed from <code class="docutils literal notranslate"><span class="pre">docker.compare_container</span></code> to <code class="docutils literal notranslate"><span class="pre">docker.compare_containers</span></code> (old function name remains as an alias)</p> </div> <p>Compare two containers' Config and and HostConfig and return any differences between the two.</p> <dl class="simple"> <dt>first</dt>
<dd>
<p>Name or ID of first container</p> </dd> <dt>second</dt>
<dd>
<p>Name or ID of second container</p> </dd> <dt>ignore</dt>
<dd>
<p>A comma-separated list (or Python list) of keys to ignore when comparing. This is useful when comparing two otherwise identical containers which have different hostnames.</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.compare_containers foo bar
salt myminion docker.compare_containers foo bar ignore=Hostname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.compare_networks"> salt.modules.dockermod.compare_networks(first, second, ignore='Name,Id,Created,Containers')</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> <p>Compare two networks and return any differences between the two</p> <dl class="simple"> <dt>first</dt>
<dd>
<p>Name or ID of first container</p> </dd> <dt>second</dt>
<dd>
<p>Name or ID of second container</p> </dd> <dt>ignore<span class="classifier">Name,Id,Created,Containers</span>
</dt>
<dd>
<p>A comma-separated list (or Python list) of keys to ignore when comparing.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.compare_network foo bar</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.connect_container_to_network"> salt.modules.dockermod.connect_container_to_network(container, net_id, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.3.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>Support for <code class="docutils literal notranslate"><span class="pre">ipv4_address</span></code> argument added</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>All arguments are now passed through to <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.network.NetworkApiMixin.connect_container_to_network">connect_container_to_network()</a>, allowing for any new arguments added to this function to be supported automagically.</p> </div> <p>Connect container to network. See the <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.network.NetworkApiMixin.connect_container_to_network">connect_container_to_network()</a> docs for information on supported arguments.</p> <dl class="simple"> <dt>container</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>net_id</dt>
<dd>
<p>Network name or ID</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.connect_container_to_network web-1 mynet
salt myminion docker.connect_container_to_network web-1 mynet ipv4_address=10.20.0.10
salt myminion docker.connect_container_to_network web-1 1f9d2454d0872b68dd9e8744c6e7a4c66b86f10abaccc21e14f7f014f729b2bc</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.connected"> salt.modules.dockermod.connected(name, verbose=False)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> <p>Return a list of running containers attached to the specified network</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Network name</p> </dd> <dt>verbose<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, return extended info about each container (IP configuration, etc.)</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.connected net_name</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.copy_from"> salt.modules.dockermod.copy_from(name, source, dest, overwrite=False, makedirs=False)</h3> <dd>
<p>Copy a file from inside a container to the Minion</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name</p> </dd> <dt>source</dt>
<dd>
<p>Path of the file on the container's filesystem</p> </dd> <dt>dest</dt>
<dd>
<p>Destination on the Minion. Must be an absolute path. If the destination is a directory, the file will be copied into that directory.</p> </dd> <dt>overwrite<span class="classifier">False</span>
</dt>
<dd>
<p>Unless this option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then if a file exists at the location specified by the <code class="docutils literal notranslate"><span class="pre">dest</span></code> argument, an error will be raised.</p> </dd> <dt>makedirs<span class="classifier">False</span>
</dt>
<dd>
<p>Create the parent directory on the container if it does not already exist.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.copy_from mycontainer /var/log/nginx/access.log /home/myuser</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.copy_to"> salt.modules.dockermod.copy_to(name, source, dest, exec_driver=None, overwrite=False, makedirs=False)</h3> <dd>
<p>Copy a file from the host into a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name</p> </dd> <dt>source</dt>
<dd>
<p>File to be copied to the container. Can be a local path on the Minion or a remote file from the Salt fileserver.</p> </dd> <dt>dest</dt>
<dd>
<p>Destination on the container. Must be an absolute path. If the destination is a directory, the file will be copied into that directory.</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>overwrite<span class="classifier">False</span>
</dt>
<dd>
<p>Unless this option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then if a file exists at the location specified by the <code class="docutils literal notranslate"><span class="pre">dest</span></code> argument, an error will be raised.</p> </dd> <dt>makedirs<span class="classifier">False</span>
</dt>
<dd>
<p>Create the parent directory on the container if it does not already exist.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.copy_to mycontainer /tmp/foo /root/foo</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.create"> salt.modules.dockermod.create(image, name=None, start=False, skip_translate=None, ignore_collisions=False, validate_ip_addrs=True, client_timeout=60, **kwargs)</h3> <dd>
<p>Create a new container</p> <dl> <dt>image</dt>
<dd>
<p>Image from which to create the container</p> </dd> <dt>name</dt>
<dd>
<p>Name for the new container. If not provided, Docker will randomly generate one for you (it will be included in the return data).</p> </dd> <dt>start<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, start container after creating it</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>skip_translate</dt>
<dd>
<p>This function translates Salt CLI or SLS input into the format which docker-py expects. However, in the event that Salt's translation logic fails (due to potential changes in the Docker Remote API, or to bugs in the translation code), this argument can be used to exert granular control over which arguments are translated and which are not.</p> <p>Pass this argument as a comma-separated list (or Python list) of arguments, and translation for each passed argument name will be skipped. Alternatively, pass <code class="docutils literal notranslate"><span class="pre">True</span></code> and <em>all</em> translation will be skipped.</p> <p>Skipping tranlsation allows for arguments to be formatted directly in the format which docker-py expects. This allows for API changes and other issues to be more easily worked around. An example of using this option to skip translation would be:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.create image=centos:7.3.1611 skip_translate=environment environment="{'FOO': 'bar'}"</pre> <p>See the following links for more information:</p> <ul class="simple"> <li><p><a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html">docker-py Low-level API</a></p></li> <li><p><a class="reference external" href="https://docs.docker.com/engine/api/v1.33/#operation/ContainerCreate">Docker Engine API</a></p></li> </ul> </dd> <dt>ignore_collisions<span class="classifier">False</span>
</dt>
<dd>
<p>Since many of docker-py's arguments differ in name from their CLI counterparts (with which most Docker users are more familiar), Salt detects usage of these and aliases them to the docker-py version of that argument. However, if both the alias and the docker-py version of the same argument (e.g. <code class="docutils literal notranslate"><span class="pre">env</span></code> and <code class="docutils literal notranslate"><span class="pre">environment</span></code>) are used, an error will be raised. Set this argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> to suppress these errors and keep the docker-py version of the argument.</p> </dd> <dt>validate_ip_addrs<span class="classifier">True</span>
</dt>
<dd>
<p>For parameters which accept IP addresses as input, IP address validation will be performed. To disable, set this to <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt>client_timeout<span class="classifier">60</span>
</dt>
<dd>
<p>Timeout in seconds for the Docker client. This is not a timeout for this function, but for receiving a response from the API.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This is only used if Salt needs to pull the requested image.</p> </div> </dd> </dl> <p><strong>CONTAINER CONFIGURATION ARGUMENTS</strong></p> <dl> <dt>auto_remove (or <em>rm</em>)<span class="classifier">False</span>
</dt>
<dd>
<p>Enable auto-removal of the container on daemon side when the containerâ€™s process exits (analogous to running a docker container with <code class="docutils literal notranslate"><span class="pre">--rm</span></code> on the CLI).</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">auto_remove=True</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">rm=True</span></code></p></li> </ul> </dd> <dt>binds</dt>
<dd>
<p>Files/directories to bind mount. Each bind mount should be passed in one of the following formats:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">&lt;host_path&gt;:&lt;container_path&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">host_path</span></code> is mounted within the container as <code class="docutils literal notranslate"><span class="pre">container_path</span></code> with read-write access.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">&lt;host_path&gt;:&lt;container_path&gt;:&lt;selinux_context&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">host_path</span></code> is mounted within the container as <code class="docutils literal notranslate"><span class="pre">container_path</span></code> with read-write access. Additionally, the specified selinux context will be set within the container.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">&lt;host_path&gt;:&lt;container_path&gt;:&lt;read_only&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">host_path</span></code> is mounted within the container as <code class="docutils literal notranslate"><span class="pre">container_path</span></code>, with the read-only or read-write setting explicitly defined.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">&lt;host_path&gt;:&lt;container_path&gt;:&lt;read_only&gt;,&lt;selinux_context&gt;</span></code> - <code class="docutils literal notranslate"><span class="pre">host_path</span></code> is mounted within the container as <code class="docutils literal notranslate"><span class="pre">container_path</span></code>, with the read-only or read-write setting explicitly defined. Additionally, the specified selinux context will be set within the container.</p></li> </ul> <p><code class="docutils literal notranslate"><span class="pre">&lt;read_only&gt;</span></code> can be either <code class="docutils literal notranslate"><span class="pre">ro</span></code> for read-write access, or <code class="docutils literal notranslate"><span class="pre">ro</span></code> for read-only access. When omitted, it is assumed to be read-write.</p> <p><code class="docutils literal notranslate"><span class="pre">&lt;selinux_context&gt;</span></code> can be <code class="docutils literal notranslate"><span class="pre">z</span></code> if the volume is shared between multiple containers, or <code class="docutils literal notranslate"><span class="pre">Z</span></code> if the volume should be private.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>When both <code class="docutils literal notranslate"><span class="pre">&lt;read_only&gt;</span></code> and <code class="docutils literal notranslate"><span class="pre">&lt;selinux_context&gt;</span></code> are specified, there must be a comma before <code class="docutils literal notranslate"><span class="pre">&lt;selinux_context&gt;</span></code>.</p> </div> <p>Binds can be expressed as a comma-separated list or a Python list, however in cases where both ro/rw and an selinux context are specified, the binds <em>must</em> be specified as a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">binds=/srv/www:/var/www:ro</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">binds=/srv/www:/var/www:rw</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">binds=/srv/www:/var/www</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">binds="['/srv/www:/var/www:ro,Z']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">binds="['/srv/www:/var/www:rw,Z']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">binds=/srv/www:/var/www:Z</span></code></p></li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The second and third examples above are equivalent to each other, as are the last two examples.</p> </div> </dd> <dt>blkio_weight</dt>
<dd>
<p>Block IO weight (relative weight), accepts a weight value between 10 and 1000.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">blkio_weight=100</span></code></p> </dd> <dt>blkio_weight_device</dt>
<dd>
<p>Block IO weight (relative device weight), specified as a list of expressions in the format <code class="docutils literal notranslate"><span class="pre">PATH:WEIGHT</span></code></p> <p>Example: <code class="docutils literal notranslate"><span class="pre">blkio_weight_device=/dev/sda:100</span></code></p> </dd> <dt>cap_add</dt>
<dd>
<p>List of capabilities to add within the container. Can be passed as a comma-separated list or a Python list. Requires Docker 1.2.0 or newer.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">cap_add=SYS_ADMIN,MKNOD</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">cap_add="[SYS_ADMIN,</span> <span class="pre">MKNOD]"</span></code></p></li> </ul> </dd> <dt>cap_drop</dt>
<dd>
<p>List of capabilities to drop within the container. Can be passed as a comma-separated string or a Python list. Requires Docker 1.2.0 or newer.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">cap_drop=SYS_ADMIN,MKNOD</span></code>,</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">cap_drop="[SYS_ADMIN,</span> <span class="pre">MKNOD]"</span></code></p></li> </ul> </dd> <dt>command (or <em>cmd</em>)</dt>
<dd>
<p>Command to run in the container</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">command=bash</span></code> or <code class="docutils literal notranslate"><span class="pre">cmd=bash</span></code></p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.1: </span><code class="docutils literal notranslate"><span class="pre">cmd</span></code> is now also accepted</p> </div> </dd> <dt>cpuset_cpus (or <em>cpuset</em>)</dt>
<dd>
<p>CPUs on which which to allow execution, specified as a string containing a range (e.g. <code class="docutils literal notranslate"><span class="pre">0-3</span></code>) or a comma-separated list of CPUs (e.g. <code class="docutils literal notranslate"><span class="pre">0,1</span></code>).</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">cpuset_cpus="0-3"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">cpuset="0,1"</span></code></p></li> </ul> </dd> <dt>cpuset_mems</dt>
<dd>
<p>Memory nodes on which which to allow execution, specified as a string containing a range (e.g. <code class="docutils literal notranslate"><span class="pre">0-3</span></code>) or a comma-separated list of MEMs (e.g. <code class="docutils literal notranslate"><span class="pre">0,1</span></code>). Only effective on NUMA systems.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">cpuset_mems="0-3"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">cpuset_mems="0,1"</span></code></p></li> </ul> </dd> <dt>cpu_group</dt>
<dd>
<p>The length of a CPU period in microseconds</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">cpu_group=100000</span></code></p> </dd> <dt>cpu_period</dt>
<dd>
<p>Microseconds of CPU time that the container can get in a CPU period</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">cpu_period=50000</span></code></p> </dd> <dt>cpu_shares</dt>
<dd>
<p>CPU shares (relative weight), specified as an integer between 2 and 1024.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">cpu_shares=512</span></code></p> </dd> <dt>detach<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, run the container's command in the background (daemon mode)</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">detach=True</span></code></p> </dd> <dt>devices</dt>
<dd>
<p>List of host devices to expose within the container</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">devices="/dev/net/tun,/dev/xvda1:/dev/xvda1,/dev/xvdb1:/dev/xvdb1:r"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">devices="['/dev/net/tun',</span> <span class="pre">'/dev/xvda1:/dev/xvda1',</span> <span class="pre">'/dev/xvdb1:/dev/xvdb1:r']"</span></code></p></li> </ul> </dd> <dt>device_read_bps</dt>
<dd>
<p>Limit read rate (bytes per second) from a device, specified as a list of expressions in the format <code class="docutils literal notranslate"><span class="pre">PATH:RATE</span></code>, where <code class="docutils literal notranslate"><span class="pre">RATE</span></code> is either an integer number of bytes, or a string ending in <code class="docutils literal notranslate"><span class="pre">kb</span></code>, <code class="docutils literal notranslate"><span class="pre">mb</span></code>, or <code class="docutils literal notranslate"><span class="pre">gb</span></code>.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">device_read_bps="/dev/sda:1mb,/dev/sdb:5mb"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">device_read_bps="['/dev/sda:100mb',</span> <span class="pre">'/dev/sdb:5mb']"</span></code></p></li> </ul> </dd> <dt>device_read_iops</dt>
<dd>
<p>Limit read rate (I/O per second) from a device, specified as a list of expressions in the format <code class="docutils literal notranslate"><span class="pre">PATH:RATE</span></code>, where <code class="docutils literal notranslate"><span class="pre">RATE</span></code> is a number of I/O operations.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">device_read_iops="/dev/sda:1000,/dev/sdb:500"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">device_read_iops="['/dev/sda:1000',</span> <span class="pre">'/dev/sdb:500']"</span></code></p></li> </ul> </dd> <dt>device_write_bps</dt>
<dd>
<p>Limit write rate (bytes per second) from a device, specified as a list of expressions in the format <code class="docutils literal notranslate"><span class="pre">PATH:RATE</span></code>, where <code class="docutils literal notranslate"><span class="pre">RATE</span></code> is either an integer number of bytes, or a string ending in <code class="docutils literal notranslate"><span class="pre">kb</span></code>, <code class="docutils literal notranslate"><span class="pre">mb</span></code> or <code class="docutils literal notranslate"><span class="pre">gb</span></code>.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">device_write_bps="/dev/sda:100mb,/dev/sdb:50mb"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">device_write_bps="['/dev/sda:100mb',</span> <span class="pre">'/dev/sdb:50mb']"</span></code></p></li> </ul> </dd> <dt>device_write_iops</dt>
<dd>
<p>Limit write rate (I/O per second) from a device, specified as a list of expressions in the format <code class="docutils literal notranslate"><span class="pre">PATH:RATE</span></code>, where <code class="docutils literal notranslate"><span class="pre">RATE</span></code> is a number of I/O operations.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">device_write_iops="/dev/sda:1000,/dev/sdb:500"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">device_write_iops="['/dev/sda:1000',</span> <span class="pre">'/dev/sdb:500']"</span></code></p></li> </ul> </dd> <dt>dns</dt>
<dd>
<p>List of DNS nameservers. Can be passed as a comma-separated list or a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">dns=8.8.8.8,8.8.4.4</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">dns="['8.8.8.8',</span> <span class="pre">'8.8.4.4']"</span></code></p></li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To skip IP address validation, use <code class="docutils literal notranslate"><span class="pre">validate_ip_addrs=False</span></code></p> </div> </dd> <dt>dns_opt</dt>
<dd>
<p>Additional options to be added to the containerâ€™s <code class="docutils literal notranslate"><span class="pre">resolv.conf</span></code> file</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">dns_opt=ndots:9</span></code></p> </dd> <dt>dns_search</dt>
<dd>
<p>List of DNS search domains. Can be passed as a comma-separated list or a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">dns_search=foo1.domain.tld,foo2.domain.tld</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">dns_search="[foo1.domain.tld,</span> <span class="pre">foo2.domain.tld]"</span></code></p></li> </ul> </dd> <dt>domainname</dt>
<dd>
<p>The domain name to use for the container</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">domainname=domain.tld</span></code></p> </dd> <dt>entrypoint</dt>
<dd>
<p>Entrypoint for the container. Either a string (e.g. <code class="docutils literal notranslate"><span class="pre">"mycmd</span> <span class="pre">--arg1</span>
<span class="pre">--arg2"</span></code>) or a Python list (e.g. <code class="docutils literal notranslate"><span class="pre">"['mycmd',</span> <span class="pre">'--arg1',</span> <span class="pre">'--arg2']"</span></code>)</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">entrypoint="cat</span> <span class="pre">access.log"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">entrypoint="['cat',</span> <span class="pre">'access.log']"</span></code></p></li> </ul> </dd> <dt>environment (or <em>env</em>)</dt>
<dd>
<p>Either a dictionary of environment variable names and their values, or a Python list of strings in the format <code class="docutils literal notranslate"><span class="pre">VARNAME=value</span></code>.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">environment='VAR1=value,VAR2=value'</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">environment="['VAR1=value',</span> <span class="pre">'VAR2=value']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">environment="{'VAR1':</span> <span class="pre">'value',</span> <span class="pre">'VAR2':</span> <span class="pre">'value'}"</span></code></p></li> </ul> </dd> <dt>extra_hosts</dt>
<dd>
<p>Additional hosts to add to the container's /etc/hosts file. Can be passed as a comma-separated list or a Python list. Requires Docker 1.3.0 or newer.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">extra_hosts=web1:10.9.8.7,web2:10.9.8.8</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">extra_hosts="['web1:10.9.8.7',</span> <span class="pre">'web2:10.9.8.8']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">extra_hosts="{'web1':</span> <span class="pre">'10.9.8.7',</span> <span class="pre">'web2':</span> <span class="pre">'10.9.8.8'}"</span></code></p></li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To skip IP address validation, use <code class="docutils literal notranslate"><span class="pre">validate_ip_addrs=False</span></code></p> </div> </dd> <dt>group_add</dt>
<dd>
<p>List of additional group names and/or IDs that the container process will run as</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">group_add=web,network</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">group_add="['web',</span> <span class="pre">'network']"</span></code></p></li> </ul> </dd> <dt>hostname</dt>
<dd>
<p>Hostname of the container. If not provided, and if a <code class="docutils literal notranslate"><span class="pre">name</span></code> has been provided, the <code class="docutils literal notranslate"><span class="pre">hostname</span></code> will default to the <code class="docutils literal notranslate"><span class="pre">name</span></code> that was passed.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">hostname=web1</span></code></p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>If the container is started with <code class="docutils literal notranslate"><span class="pre">network_mode=host</span></code>, the hostname will be overridden by the hostname of the Minion.</p> </div> </dd> <dt>interactive (or <em>stdin_open</em>): False</dt>
<dd>
<p>Leave stdin open, even if not attached</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">interactive=True</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">stdin_open=True</span></code></p></li> </ul> </dd> <dt>ipc_mode (or <em>ipc</em>)</dt>
<dd>
<p>Set the IPC mode for the container. The default behavior is to create a private IPC namespace for the container, but this option can be used to change that behavior:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">container:&lt;container_name_or_id&gt;</span></code> reuses another container shared memory, semaphores and message queues</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">host</span></code>: use the host's shared memory, semaphores and message queues</p></li> </ul> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">ipc_mode=container:foo</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ipc=host</span></code></p></li> </ul> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Using <code class="docutils literal notranslate"><span class="pre">host</span></code> gives the container full access to local shared memory and is therefore considered insecure.</p> </div> </dd> <dt>isolation</dt>
<dd>
<p>Specifies the type of isolation technology used by containers</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">isolation=hyperv</span></code></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The default value on Windows server is <code class="docutils literal notranslate"><span class="pre">process</span></code>, while the default value on Windows client is <code class="docutils literal notranslate"><span class="pre">hyperv</span></code>. On Linux, only <code class="docutils literal notranslate"><span class="pre">default</span></code> is supported.</p> </div> </dd> <dt>labels (or <em>label</em>)</dt>
<dd>
<p>Add metadata to the container. Labels can be set both with and without values:</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">labels=foo,bar=baz</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">labels="['foo',</span> <span class="pre">'bar=baz']"</span></code></p></li> </ul> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Labels both with and without values can now be mixed. Earlier releases only permitted one method or the other.</p> </div> </dd> <dt>links</dt>
<dd>
<p>Link this container to another. Links should be specified in the format <code class="docutils literal notranslate"><span class="pre">&lt;container_name_or_id&gt;:&lt;link_alias&gt;</span></code>. Multiple links can be passed, ether as a comma separated list or a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">links=web1:link1,web2:link2</span></code>,</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">links="['web1:link1',</span> <span class="pre">'web2:link2']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">links="{'web1':</span> <span class="pre">'link1',</span> <span class="pre">'web2':</span> <span class="pre">'link2'}"</span></code></p></li> </ul> </dd> <dt>log_driver</dt>
<dd>
<p>Set container's logging driver. Requires Docker 1.6 or newer.</p> <p>Example:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">log_driver=syslog</span></code></p></li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The logging driver feature was improved in Docker 1.13 introducing option name changes. Please see Docker's <a class="reference external" href="https://docs.docker.com/engine/admin/logging/overview/">Configure logging drivers</a> documentation for more information.</p> </div> </dd> <dt>log_opt</dt>
<dd>
<p>Config options for the <code class="docutils literal notranslate"><span class="pre">log_driver</span></code> config option. Requires Docker 1.6 or newer.</p> <p>Example:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">log_opt="syslog-address=tcp://192.168.0.42,syslog-facility=daemon"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">log_opt="['syslog-address=tcp://192.168.0.42',</span> <span class="pre">'syslog-facility=daemon']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">log_opt="{'syslog-address':</span> <span class="pre">'tcp://192.168.0.42',</span> <span class="pre">'syslog-facility':</span> <span class="pre">'daemon'}"</span></code></p></li> </ul> </dd> <dt>lxc_conf</dt>
<dd>
<p>Additional LXC configuration parameters to set before starting the container.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">lxc_conf="lxc.utsname=docker,lxc.arch=x86_64"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">lxc_conf="['lxc.utsname=docker',</span> <span class="pre">'lxc.arch=x86_64']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">lxc_conf="{'lxc.utsname':</span> <span class="pre">'docker',</span> <span class="pre">'lxc.arch':</span> <span class="pre">'x86_64'}"</span></code></p></li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>These LXC configuration parameters will only have the desired effect if the container is using the LXC execution driver, which has been deprecated for some time.</p> </div> </dd> <dt>mac_address</dt>
<dd>
<p>MAC address to use for the container. If not specified, a random MAC address will be used.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">mac_address=01:23:45:67:89:0a</span></code></p> </dd> <dt>mem_limit (or <em>memory</em>)<span class="classifier">0</span>
</dt>
<dd>
<p>Memory limit. Can be specified in bytes or using single-letter units (i.e. <code class="docutils literal notranslate"><span class="pre">512M</span></code>, <code class="docutils literal notranslate"><span class="pre">2G</span></code>, etc.). A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> (the default) means no memory limit.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">mem_limit=512M</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">memory=1073741824</span></code></p></li> </ul> </dd> <dt>mem_swappiness</dt>
<dd>
<p>Tune a container's memory swappiness behavior. Accepts an integer between 0 and 100.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">mem_swappiness=60</span></code></p> </dd> <dt>memswap_limit (or <em>memory_swap</em>)<span class="classifier">-1</span>
</dt>
<dd>
<p>Total memory limit (memory plus swap). Set to <code class="docutils literal notranslate"><span class="pre">-1</span></code> to disable swap. A value of <code class="docutils literal notranslate"><span class="pre">0</span></code> means no swap limit.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">memswap_limit=1G</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">memory_swap=2147483648</span></code></p></li> </ul> </dd> <dt>network_disabled<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, networking will be disabled within the container</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">network_disabled=True</span></code></p> </dd> <dt>network_mode<span class="classifier">bridge</span>
</dt>
<dd>
<p>One of the following:</p> <ul> <li><p><code class="docutils literal notranslate"><span class="pre">bridge</span></code> - Creates a new network stack for the container on the docker bridge</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">none</span></code> - No networking (equivalent of the Docker CLI argument <code class="docutils literal notranslate"><span class="pre">--net=none</span></code>). Not to be confused with Python's <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">container:&lt;name_or_id&gt;</span></code> - Reuses another container's network stack</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">host</span></code> - Use the host's network stack inside the container</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Using <code class="docutils literal notranslate"><span class="pre">host</span></code> mode gives the container full access to the hosts system's services (such as D-Bus), and is therefore considered insecure.</p> </div> </li> </ul> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">network_mode=null</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">network_mode=container:web1</span></code></p></li> </ul> </dd> <dt>oom_kill_disable</dt>
<dd>
<p>Whether to disable OOM killer</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">oom_kill_disable=False</span></code></p> </dd> <dt>oom_score_adj</dt>
<dd>
<p>An integer value containing the score given to the container in order to tune OOM killer preferences</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">oom_score_adj=500</span></code></p> </dd> <dt>pid_mode</dt>
<dd>
<p>Set to <code class="docutils literal notranslate"><span class="pre">host</span></code> to use the host container's PID namespace within the container. Requires Docker 1.5.0 or newer.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">pid_mode=host</span></code></p> </dd> <dt>pids_limit</dt>
<dd>
<p>Set the container's PID limit. Set to <code class="docutils literal notranslate"><span class="pre">-1</span></code> for unlimited.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">pids_limit=2000</span></code></p> </dd> <dt>port_bindings (or <em>publish</em>)</dt>
<dd>
<p>Bind exposed ports which were exposed using the <code class="docutils literal notranslate"><span class="pre">ports</span></code> argument to <a class="reference internal" href="#salt.modules.dockermod.create" title="salt.modules.dockermod.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.create</span></code></a>. These should be passed in the same way as the <code class="docutils literal notranslate"><span class="pre">--publish</span></code> argument to the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> CLI command:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">ip:hostPort:containerPort</span></code> - Bind a specific IP and port on the host to a specific port within the container.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ip::containerPort</span></code> - Bind a specific IP and an ephemeral port to a specific port within the container.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">hostPort:containerPort</span></code> - Bind a specific port on all of the host's interfaces to a specific port within the container.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">containerPort</span></code> - Bind an ephemeral port on all of the host's interfaces to a specific port within the container.</p></li> </ul> <p>Multiple bindings can be separated by commas, or passed as a Python list. The below two examples are equivalent:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">port_bindings="5000:5000,2123:2123/udp,8080"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">port_bindings="['5000:5000',</span> <span class="pre">'2123:2123/udp',</span> <span class="pre">8080]"</span></code></p></li> </ul> <p>Port bindings can also include ranges:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">port_bindings="14505-14506:4505-4506"</span></code></p></li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>When specifying a protocol, it must be passed in the <code class="docutils literal notranslate"><span class="pre">containerPort</span></code> value, as seen in the examples above.</p> </div> </dd> <dt>ports</dt>
<dd>
<p>A list of ports to expose on the container. Can be passed as comma-separated list or a Python list. If the protocol is omitted, the port will be assumed to be a TCP port.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">ports=1111,2222/udp</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ports="[1111,</span> <span class="pre">'2222/udp']"</span></code></p></li> </ul> </dd> <dt>privileged<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, runs the exec process with extended privileges</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">privileged=True</span></code></p> </dd> <dt>publish_all_ports (or <em>publish_all</em>): False</dt>
<dd>
<p>Publish all ports to the host</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">publish_all_ports=True</span></code></p> </dd> <dt>read_only<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, mount the containerâ€™s root filesystem as read only</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">read_only=True</span></code></p> </dd> <dt>restart_policy (or <em>restart</em>)</dt>
<dd>
<p>Set a restart policy for the container. Must be passed as a string in the format <code class="docutils literal notranslate"><span class="pre">policy[:retry_count]</span></code> where <code class="docutils literal notranslate"><span class="pre">policy</span></code> is one of <code class="docutils literal notranslate"><span class="pre">always</span></code>, <code class="docutils literal notranslate"><span class="pre">unless-stopped</span></code>, or <code class="docutils literal notranslate"><span class="pre">on-failure</span></code>, and <code class="docutils literal notranslate"><span class="pre">retry_count</span></code> is an optional limit to the number of retries. The retry count is ignored when using the <code class="docutils literal notranslate"><span class="pre">always</span></code> or <code class="docutils literal notranslate"><span class="pre">unless-stopped</span></code> restart policy.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">restart_policy=on-failure:5</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">restart_policy=always</span></code></p></li> </ul> </dd> <dt>security_opt</dt>
<dd>
<p>Security configuration for MLS systems such as SELinux and AppArmor. Can be passed as a comma-separated list or a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">security_opt=apparmor:unconfined,param2:value2</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">security_opt='["apparmor:unconfined",</span> <span class="pre">"param2:value2"]'</span></code></p></li> </ul> <div class="admonition important"> <p class="admonition-title">Important</p> <p>Some security options can contain commas. In these cases, this argument <em>must</em> be passed as a Python list, as splitting by comma will result in an invalid configuration.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>See the documentation for security_opt at <a class="reference external" href="https://docs.docker.com/engine/reference/run/#security-configuration">https://docs.docker.com/engine/reference/run/#security-configuration</a></p> </div> </dd> <dt>shm_size</dt>
<dd>
<p>Size of /dev/shm</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">shm_size=128M</span></code></p> </dd> <dt>stop_signal</dt>
<dd>
<p>The signal used to stop the container. The default is <code class="docutils literal notranslate"><span class="pre">SIGTERM</span></code>.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">stop_signal=SIGRTMIN+3</span></code></p> </dd> <dt>stop_timeout</dt>
<dd>
<p>Timeout to stop the container, in seconds</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">stop_timeout=5</span></code></p> </dd> <dt>storage_opt</dt>
<dd>
<p>Storage driver options for the container</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">storage_opt='dm.basesize=40G'</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">storage_opt="['dm.basesize=40G']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">storage_opt="{'dm.basesize':</span> <span class="pre">'40G'}"</span></code></p></li> </ul> </dd> <dt>sysctls (or <em>sysctl</em>)</dt>
<dd>
<p>Set sysctl options for the container</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">sysctl='fs.nr_open=1048576,kernel.pid_max=32768'</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">sysctls="['fs.nr_open=1048576',</span> <span class="pre">'kernel.pid_max=32768']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">sysctls="{'fs.nr_open':</span> <span class="pre">'1048576',</span> <span class="pre">'kernel.pid_max':</span> <span class="pre">'32768'}"</span></code></p></li> </ul> </dd> <dt>tmpfs</dt>
<dd>
<p>A map of container directories which should be replaced by tmpfs mounts, and their corresponding mount options. Can be passed as Python list of PATH:VALUE mappings, or a Python dictionary. However, since commas usually appear in the values, this option <em>cannot</em> be passed as a comma-separated list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">tmpfs="['/run:rw,noexec,nosuid,size=65536k',</span> <span class="pre">'/var/lib/mysql:rw,noexec,nosuid,size=600m']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">tmpfs="{'/run':</span> <span class="pre">'rw,noexec,nosuid,size=65536k',</span> <span class="pre">'/var/lib/mysql':</span> <span class="pre">'rw,noexec,nosuid,size=600m'}"</span></code></p></li> </ul> </dd> <dt>tty<span class="classifier">False</span>
</dt>
<dd>
<p>Attach TTYs</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">tty=True</span></code></p> </dd> <dt>ulimits (or <em>ulimit</em>)</dt>
<dd>
<p>List of ulimits. These limits should be passed in the format <code class="docutils literal notranslate"><span class="pre">&lt;ulimit_name&gt;:&lt;soft_limit&gt;:&lt;hard_limit&gt;</span></code>, with the hard limit being optional. Can be passed as a comma-separated list or a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">ulimits="nofile=1024:1024,nproc=60"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ulimits="['nofile=1024:1024',</span> <span class="pre">'nproc=60']"</span></code></p></li> </ul> </dd> <dt>user</dt>
<dd>
<p>User under which to run exec process</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">user=foo</span></code></p> </dd> <dt>userns_mode (or <em>user_ns_mode</em>)</dt>
<dd>
<p>Sets the user namsepace mode, when the user namespace remapping option is enabled.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">userns_mode=host</span></code></p> </dd> <dt>volumes (or <em>volume</em>)</dt>
<dd>
<p>List of directories to expose as volumes. Can be passed as a comma-separated list or a Python list.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">volumes=/mnt/vol1,/mnt/vol2</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">volume="['/mnt/vol1',</span> <span class="pre">'/mnt/vol2']"</span></code></p></li> </ul> </dd> <dt>volumes_from</dt>
<dd>
<p>Container names or IDs from which the container will get volumes. Can be passed as a comma-separated list or a Python list.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">volumes_from=foo</span></code>, <code class="docutils literal notranslate"><span class="pre">volumes_from=foo,bar</span></code>, <code class="docutils literal notranslate"><span class="pre">volumes_from="[foo,</span> <span class="pre">bar]"</span></code></p> </dd> <dt>volume_driver</dt>
<dd>
<p>Sets the container's volume driver</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">volume_driver=foobar</span></code></p> </dd> <dt>working_dir (or <em>workdir</em>)</dt>
<dd>
<p>Working directory inside the container</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">working_dir=/var/log/nginx</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">workdir=/var/www/myapp</span></code></p></li> </ul> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Id</span></code> - ID of the newly-created container</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Name</span></code> - Name of the newly-created container</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash"># Create a data-only container
salt myminion docker.create myuser/mycontainer volumes="/mnt/vol1,/mnt/vol2"
# Create a CentOS 7 container that will stay running once started
salt myminion docker.create centos:7 name=mycent7 interactive=True tty=True command=bash</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.create_network"> salt.modules.dockermod.create_network(name, skip_translate=None, ignore_collisions=False, validate_ip_addrs=True, client_timeout=60, **kwargs)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Support added for network configuration options other than <code class="docutils literal notranslate"><span class="pre">driver</span></code> and <code class="docutils literal notranslate"><span class="pre">driver_opts</span></code>, as well as IPAM configuration.</p> </div> <p>Create a new network</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This function supports all arguments for network and IPAM pool configuration which are available for the release of docker-py installed on the minion. For that reason, the arguments described below in the <a class="reference internal" href="#salt-modules-dockermod-create-network-netconf"><span class="std std-ref">NETWORK CONFIGURATION ARGUMENTS</span></a> and <a class="reference internal" href="#salt-modules-dockermod-create-network-ipam"><span class="std std-ref">IP ADDRESS MANAGEMENT (IPAM)</span></a> sections may not accurately reflect what is available on the minion. The <a class="reference internal" href="#salt.modules.dockermod.get_client_args" title="salt.modules.dockermod.get_client_args"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.get_client_args</span></code></a> function can be used to check the available arguments for the installed version of docker-py (they are found in the <code class="docutils literal notranslate"><span class="pre">network_config</span></code> and <code class="docutils literal notranslate"><span class="pre">ipam_config</span></code> sections of the return data), but Salt will not prevent a user from attempting to use an argument which is unsupported in the release of Docker which is installed. In those cases, network creation be attempted but will fail.</p> </div> <dl> <dt>name</dt>
<dd>
<p>Network name</p> </dd> <dt>skip_translate</dt>
<dd>
<p>This function translates Salt CLI or SLS input into the format which docker-py expects. However, in the event that Salt's translation logic fails (due to potential changes in the Docker Remote API, or to bugs in the translation code), this argument can be used to exert granular control over which arguments are translated and which are not.</p> <p>Pass this argument as a comma-separated list (or Python list) of arguments, and translation for each passed argument name will be skipped. Alternatively, pass <code class="docutils literal notranslate"><span class="pre">True</span></code> and <em>all</em> translation will be skipped.</p> <p>Skipping tranlsation allows for arguments to be formatted directly in the format which docker-py expects. This allows for API changes and other issues to be more easily worked around. See the following links for more information:</p> <ul class="simple"> <li><p><a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html">docker-py Low-level API</a></p></li> <li><p><a class="reference external" href="https://docs.docker.com/engine/api/v1.33/#operation/ContainerCreate">Docker Engine API</a></p></li> </ul> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>ignore_collisions<span class="classifier">False</span>
</dt>
<dd>
<p>Since many of docker-py's arguments differ in name from their CLI counterparts (with which most Docker users are more familiar), Salt detects usage of these and aliases them to the docker-py version of that argument. However, if both the alias and the docker-py version of the same argument (e.g. <code class="docutils literal notranslate"><span class="pre">options</span></code> and <code class="docutils literal notranslate"><span class="pre">driver_opts</span></code>) are used, an error will be raised. Set this argument to <code class="docutils literal notranslate"><span class="pre">True</span></code> to suppress these errors and keep the docker-py version of the argument.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>validate_ip_addrs<span class="classifier">True</span>
</dt>
<dd>
<p>For parameters which accept IP addresses as input, IP address validation will be performed. To disable, set this to <code class="docutils literal notranslate"><span class="pre">False</span></code></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>When validating subnets, whether or not the IP portion of the subnet is a valid subnet boundary will not be checked. The IP will portion will be validated, and the subnet size will be checked to confirm it is a valid number (1-32 for IPv4, 1-128 for IPv6).</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> </dl> <p id="salt-modules-dockermod-create-network-netconf"><strong>NETWORK CONFIGURATION ARGUMENTS</strong></p> <dl> <dt>driver</dt>
<dd>
<p>Network driver</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">driver=macvlan</span></code></p> </dd> <dt>driver_opts (or <em>driver_opt</em>, or <em>options</em>)</dt>
<dd>
<p>Options for the network driver. Either a dictionary of option names and values or a Python list of strings in the format <code class="docutils literal notranslate"><span class="pre">varname=value</span></code>.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">driver_opts='macvlan_mode=bridge,parent=eth0'</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">driver_opts="['macvlan_mode=bridge',</span> <span class="pre">'parent=eth0']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">driver_opts="{'macvlan_mode':</span> <span class="pre">'bridge',</span> <span class="pre">'parent':</span> <span class="pre">'eth0'}"</span></code></p></li> </ul> </dd> <dt>check_duplicate<span class="classifier">True</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, checks for networks with duplicate names. Since networks are primarily keyed based on a random ID and not on the name, and network name is strictly a user-friendly alias to the network which is uniquely identified using ID, there is no guaranteed way to check for duplicates. This option providess a best effort, checking for any networks which have the same name, but it is not guaranteed to catch all name collisions.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">check_duplicate=False</span></code></p> </dd> <dt>internal<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, restricts external access to the network</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">internal=True</span></code></p> </dd> <dt>labels</dt>
<dd>
<p>Add metadata to the network. Labels can be set both with and without values:</p> <p>Examples (<em>with</em> values):</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">labels="label1=value1,label2=value2"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">labels="['label1=value1',</span> <span class="pre">'label2=value2']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">labels="{'label1':</span> <span class="pre">'value1',</span> <span class="pre">'label2':</span> <span class="pre">'value2'}"</span></code></p></li> </ul> <p>Examples (<em>without</em> values):</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">labels=label1,label2</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">labels="['label1',</span> <span class="pre">'label2']"</span></code></p></li> </ul> </dd> <dt>enable_ipv6 (or <em>ipv6</em>)<span class="classifier">False</span>
</dt>
<dd>
<p>Enable IPv6 on the network</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">enable_ipv6=True</span></code></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>While it should go without saying, this argument must be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to <a class="reference internal" href="../../states/all/salt.states.docker_network.html#salt-states-docker-network-present-ipam"><span class="std std-ref">configure an IPv6 subnet</span></a>. Also, if this option is turned on without an IPv6 subnet explicitly configured, you will get an error unless you have set up a fixed IPv6 subnet. Consult the <a class="reference external" href="https://docs.docker.com/v17.09/engine/userguide/networking/default_network/ipv6/">Docker IPv6 docs</a> for information on how to do this.</p> </div> </dd> <dt>attachable<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, and the network is in the global scope, non-service containers on worker nodes will be able to connect to the network.</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">attachable=True</span></code></p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>While support for this option was added in API version 1.24, its value was not added to the inpsect results until API version 1.26. The version of Docker which is available for CentOS 7 runs API version 1.24, meaning that while Salt can pass this argument to the API, it has no way of knowing the value of this config option in an existing Docker network.</p> </div> </dd> <dt>scope</dt>
<dd>
<p>Specify the network's scope (<code class="docutils literal notranslate"><span class="pre">local</span></code>, <code class="docutils literal notranslate"><span class="pre">global</span></code> or <code class="docutils literal notranslate"><span class="pre">swarm</span></code>)</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">scope=local</span></code></p> </dd> <dt>ingress<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, create an ingress network which provides the routing-mesh in swarm mode</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">ingress=True</span></code></p> </dd> </dl> <p id="salt-modules-dockermod-create-network-ipam"><strong>IP ADDRESS MANAGEMENT (IPAM)</strong></p> <p>This function supports networks with either IPv4, or both IPv4 and IPv6. If configuring IPv4, then you can pass the IPAM arguments as shown below, as individual arguments on the Salt CLI. However, if configuring IPv4 and IPv6, the arguments must be passed as a list of dictionaries, in the <code class="docutils literal notranslate"><span class="pre">ipam_pools</span></code> argument. See the <strong>CLI Examples</strong> below. <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.types.IPAMPool">These docs</a> also have more information on these arguments.</p> <p><em>IPAM ARGUMENTS</em></p> <dl> <dt>ipam_driver</dt>
<dd>
<p>IPAM driver to use, if different from the default one</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">ipam_driver=foo</span></code></p> </dd> <dt>ipam_opts</dt>
<dd>
<p>Options for the IPAM driver. Either a dictionary of option names and values or a Python list of strings in the format <code class="docutils literal notranslate"><span class="pre">varname=value</span></code>.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">ipam_opts='foo=bar,baz=qux'</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ipam_opts="['foo=bar',</span> <span class="pre">'baz=quz']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ipam_opts="{'foo':</span> <span class="pre">'bar',</span> <span class="pre">'baz':</span> <span class="pre">'qux'}"</span></code></p></li> </ul> </dd> </dl> <p><em>IPAM POOL ARGUMENTS</em></p> <dl> <dt>subnet</dt>
<dd>
<p>Subnet in CIDR format that represents a network segment</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">subnet=192.168.50.0/25</span></code></p> </dd> <dt>iprange (or <em>ip_range</em>)</dt>
<dd>
<p>Allocate container IP from a sub-range within the subnet</p> <p>Subnet in CIDR format that represents a network segment</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">iprange=192.168.50.64/26</span></code></p> </dd> <dt>gateway</dt>
<dd>
<p>IPv4 gateway for the master subnet</p> <p>Example: <code class="docutils literal notranslate"><span class="pre">gateway=192.168.50.1</span></code></p> </dd> <dt>aux_addresses (or <em>aux_address</em>)</dt>
<dd>
<p>A dictionary of mapping container names to IP addresses which should be allocated for them should they connect to the network. Either a dictionary of option names and values or a Python list of strings in the format <code class="docutils literal notranslate"><span class="pre">host=ipaddr</span></code>.</p> <p>Examples:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">aux_addresses='foo.bar.tld=192.168.50.10,hello.world.tld=192.168.50.11'</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">aux_addresses="['foo.bar.tld=192.168.50.10',</span> <span class="pre">'hello.world.tld=192.168.50.11']"</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">aux_addresses="{'foo.bar.tld':</span> <span class="pre">'192.168.50.10',</span> <span class="pre">'hello.world.tld':</span> <span class="pre">'192.168.50.11'}"</span></code></p></li> </ul> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.create_network web_network driver=bridge
# IPv4
salt myminion docker.create_network macvlan_network driver=macvlan driver_opts="{'parent':'eth0'}" gateway=172.20.0.1 subnet=172.20.0.0/24
# IPv4 and IPv6
salt myminion docker.create_network mynet ipam_pools='[{"subnet": "10.0.0.0/24", "gateway": "10.0.0.1"}, {"subnet": "fe3f:2180:26:1::60/123", "gateway": "fe3f:2180:26:1::61"}]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.create_volume"> salt.modules.dockermod.create_volume(name, driver=None, driver_opts=None)</h3> <dd>
<p>Create a new volume</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.4.</span></p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>name of volume</p> </dd> <dt>driver</dt>
<dd>
<p>Driver of the volume</p> </dd> <dt>driver_opts</dt>
<dd>
<p>Options for the driver volume</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.create_volume my_volume driver=local</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.dangling"> salt.modules.dockermod.dangling(prune=False, force=False)</h3> <dd>
<p>Return top-level images (those on which no other images depend) which do not have a tag assigned to them. These include:</p> <ul class="simple"> <li><p>Images which were once tagged but were later untagged, such as those which were superseded by committing a new copy of an existing tagged image.</p></li> <li><p>Images which were loaded using <a class="reference internal" href="#salt.modules.dockermod.load" title="salt.modules.dockermod.load"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.load</span></code></a> (or the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">load</span></code> Docker CLI command), but not tagged.</p></li> </ul> <dl class="simple"> <dt>prune<span class="classifier">False</span>
</dt>
<dd>
<p>Remove these images</p> </dd> <dt>force<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, and if <code class="docutils literal notranslate"><span class="pre">prune=True</span></code>, then forcibly remove these images.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>If <code class="docutils literal notranslate"><span class="pre">prune=False</span></code>, the return data will be a list of dangling image IDs.</p> <p>If <code class="docutils literal notranslate"><span class="pre">prune=True</span></code>, the return data will be a dictionary with each key being the ID of the dangling image, and the following information for each image:</p> <ul> <li>
<p><code class="docutils literal notranslate"><span class="pre">Comment</span></code> - Any error encountered when trying to prune a dangling image</p> <p><em>(Only present if prune failed)</em></p> </li> <li><p><code class="docutils literal notranslate"><span class="pre">Removed</span></code> - A boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if prune was successful, <code class="docutils literal notranslate"><span class="pre">False</span></code> if not)</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.dangling
salt myminion docker.dangling prune=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.depends"> salt.modules.dockermod.depends(name)</h3> <dd>
<p>Returns the containers and images, if any, which depend on the given image</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Name or ID of image</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Containers</span></code> - A list of containers which depend on the specified image</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Images</span></code> - A list of IDs of images which depend on the specified image</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.depends myimage
salt myminion docker.depends 0123456789ab</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.diff"> salt.modules.dockermod.diff(name)</h3> <dd>
<p>Get information on changes made to container's filesystem since it was created. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">diff</span></code> Docker CLI command.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing any of the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Added</span></code> - A list of paths that were added.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Changed</span></code> - A list of paths that were changed.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Deleted</span></code> - A list of paths that were deleted.</p></li> </ul> <p>These keys will only be present if there were changes, so if the container has no differences the return dict will be empty.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.diff mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.disconnect_all_containers_from_network"> salt.modules.dockermod.disconnect_all_containers_from_network(network_id)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> <p>Runs <a class="reference internal" href="#salt.modules.dockermod.disconnect_container_from_network" title="salt.modules.dockermod.disconnect_container_from_network"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.disconnect_container_from_network</span></code></a> on all containers connected to the specified network, and returns the names of all containers that were disconnected.</p> <dl class="simple"> <dt>network_id</dt>
<dd>
<p>Network name or ID</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.disconnect_all_containers_from_network mynet
salt myminion docker.disconnect_all_containers_from_network 1f9d2454d0872b68dd9e8744c6e7a4c66b86f10abaccc21e14f7f014f729b2bc</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.disconnect_container_from_network"> salt.modules.dockermod.disconnect_container_from_network(container, network_id)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.3.</span></p> </div> <p>Disconnect container from network</p> <dl class="simple"> <dt>container</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>network_id</dt>
<dd>
<p>Network name or ID</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.disconnect_container_from_network web-1 mynet
salt myminion docker.disconnect_container_from_network web-1 1f9d2454d0872b68dd9e8744c6e7a4c66b86f10abaccc21e14f7f014f729b2bc</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.exists"> salt.modules.dockermod.exists(name)</h3> <dd>
<p>Check if a given container exists</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if the container exists, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.exists mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.export"> salt.modules.dockermod.export(name, path, overwrite=False, makedirs=False, compression=None, **kwargs)</h3> <dd>
<p>Exports a container to a tar archive. It can also optionally compress that tar archive, and push it up to the Master.</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>path</dt>
<dd>
<p>Absolute path on the Minion where the container will be exported</p> </dd> <dt>overwrite<span class="classifier">False</span>
</dt>
<dd>
<p>Unless this option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then if a file exists at the location specified by the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument, an error will be raised.</p> </dd> <dt>makedirs<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then if the parent directory of the file specified by the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument does not exist, Salt will attempt to create it.</p> </dd> <dt>compression<span class="classifier">None</span>
</dt>
<dd>
<p>Can be set to any of the following:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">gzip</span></code> or <code class="docutils literal notranslate"><span class="pre">gz</span></code> for gzip compression</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">bzip2</span></code> or <code class="docutils literal notranslate"><span class="pre">bz2</span></code> for bzip2 compression</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">xz</span></code> or <code class="docutils literal notranslate"><span class="pre">lzma</span></code> for XZ compression (requires <a class="reference external" href="http://tukaani.org/xz/">xz-utils</a>, as well as the <code class="docutils literal notranslate"><span class="pre">lzma</span></code> module from Python 3.3, available in Python 2 and Python 3.0-3.2 as <a class="reference external" href="https://pypi.python.org/pypi/backports.lzma">backports.lzma</a>)</p></li> </ul> <p>This parameter can be omitted and Salt will attempt to determine the compression type by examining the filename passed in the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter.</p> </dd> <dt>push<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the container will be pushed to the master using <a class="reference internal" href="salt.modules.cp.html#salt.modules.cp.push" title="salt.modules.cp.push"><code class="xref py py-func docutils literal notranslate"><span class="pre">cp.push</span></code></a>.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This requires <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/master.html#std-conf_master-file_recv"><code class="xref std std-conf_master docutils literal notranslate"><span class="pre">file_recv</span></code></a> to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> on the Master.</p> </div> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will containing the following keys:</p> <ul> <li><p><code class="docutils literal notranslate"><span class="pre">Path</span></code> - Path of the file that was exported</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">Push</span></code> - Reports whether or not the file was successfully pushed to the Master</p> <p><em>(Only present if push=True)</em></p> </li> <li><p><code class="docutils literal notranslate"><span class="pre">Size</span></code> - Size of the file, in bytes</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Size_Human</span></code> - Size of the file, in human-readable units</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the export</p></li> </ul> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.export mycontainer /tmp/mycontainer.tar
salt myminion docker.export mycontainer /tmp/mycontainer.tar.xz push=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.get_client_args"> salt.modules.dockermod.get_client_args(limit=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.6,2016.11.4,2017.7.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>Replaced the container config args with the ones from the API's <code class="docutils literal notranslate"><span class="pre">create_container</span></code> function.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Added ability to limit the input to specific client functions</p> </div> <p>Many functions in Salt have been written to support the full list of arguments for a given function in the <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html">docker-py Low-level API</a>. However, depending on the version of docker-py installed on the minion, the available arguments may differ. This function will get the arguments for various functions in the installed version of docker-py, to be used as a reference.</p> <dl class="simple"> <dt>limit</dt>
<dd>
<p>An optional list of categories for which to limit the return. This is useful if only a specific set of arguments is desired, and also keeps other function's argspecs from needlessly being examined.</p> </dd> </dl> <p><strong>AVAILABLE LIMITS</strong></p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">create_container</span></code> - arguments accepted by <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.container.ContainerApiMixin.create_container">create_container()</a> (used by <a class="reference internal" href="#salt.modules.dockermod.create" title="salt.modules.dockermod.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.create</span></code></a>)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">host_config</span></code> - arguments accepted by <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.container.ContainerApiMixin.create_host_config">create_host_config()</a> (used to build the host config for <a class="reference internal" href="#salt.modules.dockermod.create" title="salt.modules.dockermod.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.create</span></code></a>)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">connect_container_to_network</span></code> - arguments used by <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.network.NetworkApiMixin.connect_container_to_network">connect_container_to_network()</a> to construct an endpoint config when connecting to a network (used by <a class="reference internal" href="#salt.modules.dockermod.connect_container_to_network" title="salt.modules.dockermod.connect_container_to_network"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.connect_container_to_network</span></code></a>)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">create_network</span></code> - arguments accepted by <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.network.NetworkApiMixin.create_network">create_network()</a> (used by <a class="reference internal" href="#salt.modules.dockermod.create_network" title="salt.modules.dockermod.create_network"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.create_network</span></code></a>)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">ipam_config</span></code> - arguments used to create an <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.types.IPAMPool">IPAM pool</a> (used by <a class="reference internal" href="#salt.modules.dockermod.create_network" title="salt.modules.dockermod.create_network"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.create_network</span></code></a> in the process of constructing an IPAM config dictionary)</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.get_client_args
salt myminion docker.get_client_args logs
salt myminion docker.get_client_args create_container,connect_container_to_network</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.highstate"> salt.modules.dockermod.highstate(name, saltenv='base', **kwargs)</h3> <dd>
<p>Apply a highstate to the running container</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>The container does not need to have Salt installed, but Python is required.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>saltenv<span class="classifier">base</span>
</dt>
<dd>
<p>Specify the environment from which to retrieve the SLS indicated by the <cite>mods</cite> parameter.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.highstate compassionate_mirzakhani</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.history"> salt.modules.dockermod.history(name, quiet=False)</h3> <dd>
<p>Return the history for an image. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span>
<span class="pre">history</span></code> Docker CLI command.</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>quiet<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the return data will simply be a list of the commands run to build the container.</p> <pre class="highlight-bash notranslate" data-language="bash">$ salt myminion docker.history nginx:latest quiet=True
myminion:
    - FROM scratch
    - ADD file:ef063ed0ae9579362871b9f23d2bc0781ef7cd4de6ac822052cf6c9c5a12b1e2 in /
    - CMD [/bin/bash]
    - MAINTAINER NGINX Docker Maintainers "docker-maint@nginx.com"
    - apt-key adv --keyserver pgp.mit.edu --recv-keys 573BFD6B3D8FBC641079A6ABABF5BD827BD9BF62
    - echo "deb http://nginx.org/packages/mainline/debian/ wheezy nginx" &gt;&gt; /etc/apt/sources.list
    - ENV NGINX_VERSION=1.7.10-1~wheezy
    - apt-get update &amp;&amp;     apt-get install -y ca-certificates nginx=${NGINX_VERSION} &amp;&amp;     rm -rf /var/lib/apt/lists/*
    - ln -sf /dev/stdout /var/log/nginx/access.log
    - ln -sf /dev/stderr /var/log/nginx/error.log
    - VOLUME [/var/cache/nginx]
    - EXPOSE map[80/tcp:{} 443/tcp:{}]
    - CMD [nginx -g daemon off;]
            https://github.com/saltstack/salt/pull/22421</pre> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>If <code class="docutils literal notranslate"><span class="pre">quiet=False</span></code>, the return value will be a list of dictionaries containing information about each step taken to build the image. The keys in each step include the following:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Command</span></code> - The command executed in this build step</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Id</span></code> - Layer ID</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Size</span></code> - Cumulative image size, in bytes</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Size_Human</span></code> - Cumulative image size, in human-readable units</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Tags</span></code> - Tag(s) assigned to this layer</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Created_Epoch</span></code> - Time this build step was completed (Epoch time)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Created_Local</span></code> - Time this build step was completed (Minion's local timezone)</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.exists mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.images"> salt.modules.dockermod.images(verbose=False, **kwargs)</h3> <dd>
<p>Returns information about the Docker images on the Minion. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">images</span></code> Docker CLI command.</p> <dl class="simple"> <dt>all<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, untagged images will also be returned</p> </dd> <dt>verbose<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">inspect</span></code> will be run on each image returned.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary with each key being an image ID, and each value some general info about that image (time created, size, tags associated with the image, etc.)</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.images
salt myminion docker.images all=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.import_"> salt.modules.dockermod.import_(source, repository, tag='latest', api_response=False)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>The repository and tag must now be passed separately using the <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> arguments, rather than together in the (now deprecated) <code class="docutils literal notranslate"><span class="pre">image</span></code> argument.</p> </div> <p>Imports content from a local tarball or a URL as a new docker image</p> <dl> <dt>source</dt>
<dd>
<p>Content to import (URL or absolute path to a tarball). URL can be a file on the Salt fileserver (i.e. <code class="docutils literal notranslate"><span class="pre">salt://path/to/rootfs/tarball.tar.xz</span></code>. To import a file from a saltenv other than <code class="docutils literal notranslate"><span class="pre">base</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">dev</span></code>), pass it at the end of the URL (ex. <code class="docutils literal notranslate"><span class="pre">salt://path/to/rootfs/tarball.tar.xz?saltenv=dev</span></code>).</p> </dd> <dt>repository</dt>
<dd>
<p>Repository name for the image being imported</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tag<span class="classifier">latest</span>
</dt>
<dd>
<p>Tag name for the image</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>image</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0: </span>Use both <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> instead</p> </div> </dd> <dt>api_response<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> an <code class="docutils literal notranslate"><span class="pre">api_response</span></code> key will be present in the return data, containing the raw output from the Docker API.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Id</span></code> - ID of the newly-created image</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Image</span></code> - Name of the newly-created image</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the commit</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.import /tmp/cent7-minimal.tar.xz myuser/centos
salt myminion docker.import /tmp/cent7-minimal.tar.xz myuser/centos:7
salt myminion docker.import salt://dockerimages/cent7-minimal.tar.xz myuser/centos:7</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.info"> salt.modules.dockermod.info()</h3> <dd>
<p>Returns a dictionary of system-wide information. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">info</span></code> Docker CLI command.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.info</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.inspect"> salt.modules.dockermod.inspect(name)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>Volumes and networks are now checked, in addition to containers and images.</p> </div> <p>This is a generic container/image/volume/network inspecton function. It will run the following functions in order:</p> <ul class="simple"> <li><p><a class="reference internal" href="#salt.modules.dockermod.inspect_container" title="salt.modules.dockermod.inspect_container"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.inspect_container</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.inspect_image" title="salt.modules.dockermod.inspect_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.inspect_image</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.inspect_volume" title="salt.modules.dockermod.inspect_volume"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.inspect_volume</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.dockermod.inspect_network" title="salt.modules.dockermod.inspect_network"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.inspect_network</span></code></a></p></li> </ul> <p>The first of these to find a match will be returned.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container/image/volume/network name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary of container/image/volume/network information</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.inspect mycontainer
salt myminion docker.inspect busybox</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.inspect_container"> salt.modules.dockermod.inspect_container(name)</h3> <dd>
<p>Retrieves container information. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span>
<span class="pre">inspect</span></code> Docker CLI command, but will only look for container information.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary of container information</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.inspect_container mycontainer
salt myminion docker.inspect_container 0123456789ab</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.inspect_image"> salt.modules.dockermod.inspect_image(name)</h3> <dd>
<p>Retrieves image information. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">inspect</span></code> Docker CLI command, but will only look for image information.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To inspect an image, it must have been pulled from a registry or built locally. Images on a Docker registry which have not been pulled cannot be inspected.</p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>Image name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary of image information</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.inspect_image busybox
salt myminion docker.inspect_image centos:6
salt myminion docker.inspect_image 0123456789ab</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.inspect_network"> salt.modules.dockermod.inspect_network(network_id)</h3> <dd>
<p>Inspect Network</p> <dl class="simple"> <dt>network_id</dt>
<dd>
<p>ID of network</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.inspect_network 1f9d2454d0872b68dd9e8744c6e7a4c66b86f10abaccc21e14f7f014f729b2bc</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.inspect_volume"> salt.modules.dockermod.inspect_volume(name)</h3> <dd>
<p>Inspect Volume</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.4.</span></p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>Name of volume</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.inspect_volume my_volume</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.kill"> salt.modules.dockermod.kill(name)</h3> <dd>
<p>Kill all processes in a running container instead of performing a graceful shutdown</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> - Only present if the container cannot be killed</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.kill mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.layers"> salt.modules.dockermod.layers(name)</h3> <dd>
<p>Returns a list of the IDs of layers belonging to the specified image, with the top-most layer (the one correspnding to the passed name) appearing last.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Image name or ID</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.layers centos:7</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.list_containers"> salt.modules.dockermod.list_containers(**kwargs)</h3> <dd>
<p>Returns a list of containers by name. This is different from <a class="reference internal" href="#salt.modules.dockermod.ps_" title="salt.modules.dockermod.ps_"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.ps</span></code></a> in that <a class="reference internal" href="#salt.modules.dockermod.ps_" title="salt.modules.dockermod.ps_"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.ps</span></code></a> returns its results organized by container ID.</p> <dl class="simple"> <dt>all<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, stopped containers will be included in return data</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.inspect_image &lt;image&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.list_tags"> salt.modules.dockermod.list_tags()</h3> <dd>
<p>Returns a list of tagged images</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.list_tags</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.load"> salt.modules.dockermod.load(path, repository=None, tag=None)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>If the loaded image should be tagged, then the repository and tag must now be passed separately using the <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> arguments, rather than together in the (now deprecated) <code class="docutils literal notranslate"><span class="pre">image</span></code> argument.</p> </div> <p>Load a tar archive that was created using <a class="reference internal" href="#salt.modules.dockermod.save" title="salt.modules.dockermod.save"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.save</span></code></a> (or via the Docker CLI using <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">save</span></code>).</p> <dl> <dt>path</dt>
<dd>
<p>Path to docker tar archive. Path can be a file on the Minion, or the URL of a file on the Salt fileserver (i.e. <code class="docutils literal notranslate"><span class="pre">salt://path/to/docker/saved/image.tar</span></code>). To load a file from a saltenv other than <code class="docutils literal notranslate"><span class="pre">base</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">dev</span></code>), pass it at the end of the URL (ex. <code class="docutils literal notranslate"><span class="pre">salt://path/to/rootfs/tarball.tar.xz?saltenv=dev</span></code>).</p> </dd> <dt>repository</dt>
<dd>
<p>If specified, the topmost layer of the newly-loaded image will be tagged with the specified repo using <a class="reference internal" href="#salt.modules.dockermod.tag_" title="salt.modules.dockermod.tag_"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.tag</span></code></a>. If a repository name is provided, then the <code class="docutils literal notranslate"><span class="pre">tag</span></code> argument is also required.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tag</dt>
<dd>
<p>Tag name to go along with the repository name, if the loaded image is to be tagged.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>image</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0: </span>Use both <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> instead</p> </div> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul> <li><p><code class="docutils literal notranslate"><span class="pre">Path</span></code> - Path of the file that was saved</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Layers</span></code> - A list containing the IDs of the layers which were loaded. Any layers in the file that was loaded, which were already present on the Minion, will not be included.</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">Image</span></code> - Name of tag applied to topmost layer</p> <p><em>(Only present if tag was specified and tagging was successful)</em></p> </li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to load the file</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">Warning</span></code> - Message describing any problems encountered in attempt to tag the topmost layer</p> <p><em>(Only present if tag was specified and tagging failed)</em></p> </li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.load /path/to/image.tar
salt myminion docker.load salt://path/to/docker/saved/image.tar repository=myuser/myimage tag=mytag</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.login"> salt.modules.dockermod.login(*registries)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.7,2016.11.4,2017.7.0.</span></p> </div> <p>Performs a <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">login</span></code> to authenticate to one or more configured repositories. See the documentation at the top of this page to configure authentication credentials.</p> <p>Multiple registry URLs (matching those configured in Pillar) can be passed, and Salt will attempt to login to <em>just</em> those registries. If no registry URLs are provided, Salt will attempt to login to <em>all</em> configured registries.</p> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Results</span></code> - A dictionary mapping registry URLs to the authentication result. <code class="docutils literal notranslate"><span class="pre">True</span></code> means a successful login, <code class="docutils literal notranslate"><span class="pre">False</span></code> means a failed login.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Errors</span></code> - A list of errors encountered during the course of this function.</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.login
salt myminion docker.login hub
salt myminion docker.login hub https://mydomain.tld/registry/</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.logout"> salt.modules.dockermod.logout(*registries)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <p>Performs a <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">logout</span></code> to remove the saved authentication details for one or more configured repositories.</p> <p>Multiple registry URLs (matching those configured in Pillar) can be passed, and Salt will attempt to logout of <em>just</em> those registries. If no registry URLs are provided, Salt will attempt to logout of <em>all</em> configured registries.</p> <p><strong>RETURN DATA</strong></p> <p>A dictionary containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Results</span></code> - A dictionary mapping registry URLs to the authentication result. <code class="docutils literal notranslate"><span class="pre">True</span></code> means a successful logout, <code class="docutils literal notranslate"><span class="pre">False</span></code> means a failed logout.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Errors</span></code> - A list of errors encountered during the course of this function.</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.logout
salt myminion docker.logout hub
salt myminion docker.logout hub https://mydomain.tld/registry/</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.logs"> salt.modules.dockermod.logs(name, **kwargs)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Support for all of docker-py's <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.container.ContainerApiMixin.logs">logs()</a> function's arguments, with the exception of <code class="docutils literal notranslate"><span class="pre">stream</span></code>.</p> </div> <p>Returns the logs for the container. An interface to docker-py's <a class="reference external" href="http://docker-py.readthedocs.io/en/stable/api.html#docker.api.container.ContainerApiMixin.logs">logs()</a> function.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>stdout<span class="classifier">True</span>
</dt>
<dd>
<p>Return stdout lines</p> </dd> <dt>stderr<span class="classifier">True</span>
</dt>
<dd>
<p>Return stdout lines</p> </dd> <dt>timestamps<span class="classifier">False</span>
</dt>
<dd>
<p>Show timestamps</p> </dd> <dt>tail<span class="classifier">all</span>
</dt>
<dd>
<p>Output specified number of lines at the end of logs. Either an integer number of lines or the string <code class="docutils literal notranslate"><span class="pre">all</span></code>.</p> </dd> <dt>since</dt>
<dd>
<p>Show logs since the specified time, passed as a UNIX epoch timestamp. Optionally, if <a class="reference external" href="https://pypi.python.org/pypi/timelib">timelib</a> is installed on the minion the timestamp can be passed as a string which will be resolved to a date using <code class="docutils literal notranslate"><span class="pre">timelib.strtodatetime()</span></code>.</p> </dd> <dt>follow<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function will block until the container exits and return the logs when it does. The default behavior is to return what is in the log at the time this function is executed.</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash"># All logs
salt myminion docker.logs mycontainer
# Last 100 lines of log
salt myminion docker.logs mycontainer tail=100
# Just stderr
salt myminion docker.logs mycontainer stdout=False
# Logs since a specific UNIX timestamp
salt myminion docker.logs mycontainer since=1511688459
# Flexible format for "since" argument (requires timelib)
salt myminion docker.logs mycontainer since='1 hour ago'
salt myminion docker.logs mycontainer since='1 week ago'
salt myminion docker.logs mycontainer since='1 fortnight ago'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.networks"> salt.modules.dockermod.networks(names=None, ids=None)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>The <code class="docutils literal notranslate"><span class="pre">names</span></code> and <code class="docutils literal notranslate"><span class="pre">ids</span></code> can be passed as a comma-separated list now, as well as a Python list.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>The <code class="docutils literal notranslate"><span class="pre">Containers</span></code> key for each network is no longer always empty.</p> </div> <p>List existing networks</p> <dl class="simple"> <dt>names</dt>
<dd>
<p>Filter by name</p> </dd> <dt>ids</dt>
<dd>
<p>Filter by id</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.networks names=network-web
salt myminion docker.networks ids=1f9d2454d0872b68dd9e8744c6e7a4c66b86f10abaccc21e14f7f014f729b2bc</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.pause"> salt.modules.dockermod.pause(name)</h3> <dd>
<p>Pauses a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> - Only present if the container cannot be paused</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.pause mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.pid"> salt.modules.dockermod.pid(name)</h3> <dd>
<p>Returns the PID of a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.pid mycontainer
salt myminion docker.pid 0123456789ab</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.port"> salt.modules.dockermod.port(name, private_port=None)</h3> <dd>
<p>Returns port mapping information for a given container. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">port</span></code> Docker CLI command.</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2019.2.0: </span>This value can now be a pattern expression (using the pattern-matching characters defined in <a class="reference external" href="https://docs.python.org/2/library/fnmatch.html">fnmatch</a>). If a pattern expression is used, this function will return a dictionary mapping container names which match the pattern to the mappings for those containers. When no pattern expression is used, a dictionary of the mappings for the specified container name will be returned.</p> </div> </dd> <dt>private_port<span class="classifier">None</span>
</dt>
<dd>
<p>If specified, get information for that specific port. Can be specified either as a port number (i.e. <code class="docutils literal notranslate"><span class="pre">5000</span></code>), or as a port number plus the protocol (i.e. <code class="docutils literal notranslate"><span class="pre">5000/udp</span></code>).</p> <p>If this argument is omitted, all port mappings will be returned.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary of port mappings, with the keys being the port and the values being the mapping(s) for that port.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.port mycontainer
salt myminion docker.port mycontainer 5000
salt myminion docker.port mycontainer 5000/udp</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.prune"> salt.modules.dockermod.prune(containers=False, networks=False, images=False, build=False, volumes=False, system=None, **filters)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>Prune Docker's various subsystems</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This requires docker-py version 2.1.0 or later.</p> </div> <dl> <dt>containers<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prunes stopped containers (<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/container_prune/#filtering">documentation</a>)</p> </dd> <dt>images<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prunes unused images (<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/image_prune/#filtering">documentation</a>)</p> </dd> <dt>networks<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">False</span></code>, prunes unreferenced networks (<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/network_prune/#filtering)">documentation</a>)</p> </dd> <dt>build<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, clears the builder cache</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Only supported in Docker 17.07.x and newer. Additionally, filters do not apply to this argument.</p> </div> </dd> <dt>volumes<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prunes unreferenced volumes (<a class="reference external" href="https://docs.docker.com/engine/reference/commandline/volume_prune/">documentation</a>)</p> </dd> <dt>system</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, prunes containers, images, networks, and builder cache. Assumed to be <code class="docutils literal notranslate"><span class="pre">True</span></code> if none of <code class="docutils literal notranslate"><span class="pre">containers</span></code>, <code class="docutils literal notranslate"><span class="pre">images</span></code>, <code class="docutils literal notranslate"><span class="pre">networks</span></code>, or <code class="docutils literal notranslate"><span class="pre">build</span></code> are set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p><code class="docutils literal notranslate"><span class="pre">volumes=True</span></code> must still be used to prune volumes</p> </div> </dd> <dt>filters</dt>
<dd>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">dangling=True</span></code> (images only) - remove only dangling images</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">until=&lt;timestamp&gt;</span></code> - only remove objects created before given timestamp. Not applicable to volumes. See the documentation links above for examples of valid time expressions.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">label</span></code> - only remove objects matching the label expression. Valid expressions include <code class="docutils literal notranslate"><span class="pre">labelname</span></code> or <code class="docutils literal notranslate"><span class="pre">labelname=value</span></code>.</p></li> </ul> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.prune system=True
salt myminion docker.prune system=True until=12h
salt myminion docker.prune images=True dangling=True
salt myminion docker.prune images=True label=foo,bar=baz</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.ps_"> salt.modules.dockermod.ps_(filters=None, **kwargs)</h3> <dd>
<p>Returns information about the Docker containers on the Minion. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">ps</span></code> Docker CLI command.</p> <dl> <dt>all<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, stopped containers will also be returned</p> </dd> <dt>host: False</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, local host's network topology will be included</p> </dd> <dt>verbose<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">inspect</span></code> will be run on each container returned.</p> </dd> <dt>filters: None</dt>
<dd>
<p>A dictionary of filters to be processed on the container list. Available filters:</p> <blockquote> <div>
<ul class="simple"> <li><p>exited (int): Only containers with specified exit code</p></li> <li><p>status (str): One of restarting, running, paused, exited</p></li> <li><p>label (str): format either "key" or "key=value"</p></li> </ul> </div>
</blockquote> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary with each key being an container ID, and each value some general info about that container (time created, name, command, etc.)</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.ps
salt myminion docker.ps all=True
salt myminion docker.ps filters="{'label': 'role=web'}"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.pull"> salt.modules.dockermod.pull(image, insecure_registry=False, api_response=False, client_timeout=60)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>If no tag is specified in the <code class="docutils literal notranslate"><span class="pre">image</span></code> argument, all tags for the image will be pulled. For this reason is it recommended to pass <code class="docutils literal notranslate"><span class="pre">image</span></code> using the <code class="docutils literal notranslate"><span class="pre">repo:tag</span></code> notation.</p> </div> <p>Pulls an image from a Docker registry</p> <dl> <dt>image</dt>
<dd>
<p>Image to be pulled</p> </dd> <dt>insecure_registry<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the Docker client will permit the use of insecure (non-HTTPS) registries.</p> </dd> <dt>api_response<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an <code class="docutils literal notranslate"><span class="pre">API_Response</span></code> key will be present in the return data, containing the raw output from the Docker API.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This may result in a <strong>lot</strong> of additional return data, especially for larger images.</p> </div> </dd> <dt>client_timeout</dt>
<dd>
<p>Timeout in seconds for the Docker client. This is not a timeout for this function, but for receiving a response from the API.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li>
<dl class="simple"> <dt>
<code class="docutils literal notranslate"><span class="pre">Layers</span></code> - A dictionary containing one or more of the following keys:</dt>
<dd>
<ul> <li><p><code class="docutils literal notranslate"><span class="pre">Already_Pulled</span></code> - Layers that that were already present on the Minion</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Pulled</span></code> - Layers that that were pulled</p></li> </ul> </dd> </dl> </li> <li><p><code class="docutils literal notranslate"><span class="pre">Status</span></code> - A string containing a summary of the pull action (usually a message saying that an image was downloaded, or that it was up to date).</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the pull</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.pull centos
salt myminion docker.pull centos:6</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.push"> salt.modules.dockermod.push(image, insecure_registry=False, api_response=False, client_timeout=60)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.4: </span>The <code class="docutils literal notranslate"><span class="pre">Id</span></code> and <code class="docutils literal notranslate"><span class="pre">Image</span></code> keys are no longer present in the return data. This is due to changes in the Docker Remote API.</p> </div> <p>Pushes an image to a Docker registry. See the documentation at top of this page to configure authentication credentials.</p> <dl class="simple"> <dt>image</dt>
<dd>
<p>Image to be pushed. If just the repository name is passed, then all tagged images for the specified repo will be pushed. If the image name is passed in <code class="docutils literal notranslate"><span class="pre">repo:tag</span></code> notation, only the specified image will be pushed.</p> </dd> <dt>insecure_registry<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the Docker client will permit the use of insecure (non-HTTPS) registries.</p> </dd> <dt>api_response<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an <code class="docutils literal notranslate"><span class="pre">API_Response</span></code> key will be present in the return data, containing the raw output from the Docker API.</p> </dd> <dt>client_timeout</dt>
<dd>
<p>Timeout in seconds for the Docker client. This is not a timeout for this function, but for receiving a response from the API.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li>
<dl class="simple"> <dt>
<code class="docutils literal notranslate"><span class="pre">Layers</span></code> - A dictionary containing one or more of the following keys:</dt>
<dd>
<ul> <li><p><code class="docutils literal notranslate"><span class="pre">Already_Pushed</span></code> - Layers that that were already present on the Minion</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Pushed</span></code> - Layers that that were pushed</p></li> </ul> </dd> </dl> </li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the push</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.push myuser/mycontainer
salt myminion docker.push myuser/mycontainer:mytag</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.remove_network"> salt.modules.dockermod.remove_network(network_id)</h3> <dd>
<p>Remove a network</p> <dl class="simple"> <dt>network_id</dt>
<dd>
<p>Network name or ID</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.remove_network mynet
salt myminion docker.remove_network 1f9d2454d0872b68dd9e8744c6e7a4c66b86f10abaccc21e14f7f014f729b2bc</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.remove_volume"> salt.modules.dockermod.remove_volume(name)</h3> <dd>
<p>Remove a volume</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.4.</span></p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>Name of volume</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.remove_volume my_volume</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.rename"> salt.modules.dockermod.rename(name, new_name)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <p>Renames a container. Returns <code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, and raises an error if the API returns one. If unsuccessful and the API returns no error (should not happen), then <code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Name or ID of existing container</p> </dd> <dt>new_name</dt>
<dd>
<p>New name to assign to container</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.rename foo bar</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.resolve_image_id"> salt.modules.dockermod.resolve_image_id(name)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> <p>Given an image name (or partial image ID), return the full image ID. If no match is found among the locally-pulled images, then <code class="docutils literal notranslate"><span class="pre">False</span></code> will be returned.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.resolve_image_id foo
salt myminion docker.resolve_image_id foo:bar
salt myminion docker.resolve_image_id 36540f359ca3</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.resolve_tag"> salt.modules.dockermod.resolve_tag(name, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.2.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>Instead of matching against pulled tags using <a class="reference internal" href="#salt.modules.dockermod.list_tags" title="salt.modules.dockermod.list_tags"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.list_tags</span></code></a>, this function now simply inspects the passed image name using <a class="reference internal" href="#salt.modules.dockermod.inspect_image" title="salt.modules.dockermod.inspect_image"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.inspect_image</span></code></a> and returns the first matching tag. If no matching tags are found, it is assumed that the passed image is an untagged image ID, and the full ID is returned.</p> </div> <p>Inspects the specified image name and returns the first matching tag in the inspect results. If the specified image is not pulled locally, this function will return <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p> <dl> <dt>name</dt>
<dd>
<p>Image name to resolve. If the image is found but there are no tags, this means that the image name passed was an untagged image. In this case the image ID will be returned.</p> </dd> <dt>all<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, a list of all matching tags will be returned. If the image is found but there are no tags, then a list will still be returned, but it will simply contain the image ID.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tags</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0.</span></p> </div> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.resolve_tag busybox
salt myminion docker.resolve_tag centos:7 all=True
salt myminion docker.resolve_tag c9f378ac27d9</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.restart"> salt.modules.dockermod.restart(name, timeout=10)</h3> <dd>
<p>Restarts a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>timeout<span class="classifier">10</span>
</dt>
<dd>
<p>Timeout in seconds after which the container will be killed (if it has not yet gracefully shut down)</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">restarted</span></code> - If restart was successful, this key will be present and will be set to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li> </ul> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.restart mycontainer
salt myminion docker.restart mycontainer timeout=20</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.retcode"> salt.modules.dockermod.retcode(name, cmd, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', use_vt=False, ignore_retcode=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.retcode" title="salt.modules.cmdmod.retcode"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.retcode</span></code></a> within a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID in which to run the command</p> </dd> <dt>cmd</dt>
<dd>
<p>Command to run</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the command</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the command. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.retcode mycontainer 'ls -l /etc'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.rm_"> salt.modules.dockermod.rm_(name, force=False, volumes=False, **kwargs)</h3> <dd>
<p>Removes a container</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>force<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the container will be killed first before removal, as the Docker API will not permit a running container to be removed. This option is set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default to prevent accidental removal of a running container.</p> </dd> <dt>stop<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the container will be stopped first before removal, as the Docker API will not permit a running container to be removed. This option is set to <code class="docutils literal notranslate"><span class="pre">False</span></code> by default to prevent accidental removal of a running container.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd> <dt>timeout</dt>
<dd>
<p>Optional timeout to be passed to <a class="reference internal" href="#salt.modules.dockermod.stop" title="salt.modules.dockermod.stop"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.stop</span></code></a> if stopping the container.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>volumes<span class="classifier">False</span>
</dt>
<dd>
<p>Also remove volumes associated with container</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A list of the IDs of containers which were removed</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.rm mycontainer
salt myminion docker.rm mycontainer force=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.rmi"> salt.modules.dockermod.rmi(*names, **kwargs)</h3> <dd>
<p>Removes an image</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Name (in <code class="docutils literal notranslate"><span class="pre">repo:tag</span></code> notation) or ID of image.</p> </dd> <dt>force<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the image will be removed even if the Minion has containers created from that image</p> </dd> <dt>prune<span class="classifier">True</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, untagged parent image layers will be removed as well, set this to <code class="docutils literal notranslate"><span class="pre">False</span></code> to keep them.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following two keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Layers</span></code> - A list of the IDs of image layers that were removed</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Tags</span></code> - A list of the tags that were removed</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Errors</span></code> - A list of any errors that were encountered</p></li> </ul> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.rmi busybox
salt myminion docker.rmi busybox force=True
salt myminion docker.rmi foo bar baz</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.run"> salt.modules.dockermod.run(name, cmd, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', use_vt=False, ignore_retcode=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.run" title="salt.modules.cmdmod.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.run</span></code></a> within a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID in which to run the command</p> </dd> <dt>cmd</dt>
<dd>
<p>Command to run</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the command</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the command. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.run mycontainer 'ls -l /etc'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.run_all"> salt.modules.dockermod.run_all(name, cmd, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', use_vt=False, ignore_retcode=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.run_all" title="salt.modules.cmdmod.run_all"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.run_all</span></code></a> within a container</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>While the command is run within the container, it is initiated from the host. Therefore, the PID in the return dict is from the host, not from the container.</p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID in which to run the command</p> </dd> <dt>cmd</dt>
<dd>
<p>Command to run</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the command</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the command. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.run_all mycontainer 'ls -l /etc'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.run_container"> salt.modules.dockermod.run_container(image, name=None, skip_translate=None, ignore_collisions=False, validate_ip_addrs=True, client_timeout=60, bg=False, replace=False, force=False, networks=None, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> <p>Equivalent to <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">run</span></code> on the Docker CLI. Runs the container, waits for it to exit, and returns the container's logs when complete.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Not to be confused with <a class="reference internal" href="#salt.modules.dockermod.run" title="salt.modules.dockermod.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.run</span></code></a>, which provides a <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.run" title="salt.modules.cmdmod.run"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.run</span></code></a>-like interface for executing commands in a running container.</p> </div> <p>This function accepts the same arguments as <a class="reference internal" href="#salt.modules.dockermod.create" title="salt.modules.dockermod.create"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.create</span></code></a>, with the exception of <code class="docutils literal notranslate"><span class="pre">start</span></code>. In addition, it accepts the arguments from <a class="reference internal" href="#salt.modules.dockermod.logs" title="salt.modules.dockermod.logs"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.logs</span></code></a>, with the exception of <code class="docutils literal notranslate"><span class="pre">follow</span></code>, to control how logs are returned. Finally, the <code class="docutils literal notranslate"><span class="pre">bg</span></code> argument described below can be used to optionally run the container in the background (the default behavior is to block until the container exits).</p> <dl> <dt>bg<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, this function will not wait for the container to exit and will not return its logs. It will however return the container's name and ID, allowing for <a class="reference internal" href="#salt.modules.dockermod.logs" title="salt.modules.dockermod.logs"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.logs</span></code></a> to be used to view the logs.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The logs will be inaccessible once the container exits if <code class="docutils literal notranslate"><span class="pre">auto_remove</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, so keep this in mind.</p> </div> </dd> <dt>replace<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, and if the named container already exists, this will remove the existing container. The default behavior is to return a <code class="docutils literal notranslate"><span class="pre">False</span></code> result when the container already exists.</p> </dd> <dt>force<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, and the named container already exists, <em>and</em> <code class="docutils literal notranslate"><span class="pre">replace</span></code> is also set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the container will be forcibly removed. Otherwise, the state will not proceed and will return a <code class="docutils literal notranslate"><span class="pre">False</span></code> result.</p> </dd> <dt>networks</dt>
<dd>
<p>Networks to which the container should be connected. If automatic IP configuration is being used, the networks can be a simple list of network names. If custom IP configuration is being used, then this argument must be passed as a dictionary.</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.run_container myuser/myimage command=/usr/local/bin/myscript.sh
# Run container in the background
salt myminion docker.run_container myuser/myimage command=/usr/local/bin/myscript.sh bg=True
# Connecting to two networks using automatic IP configuration
salt myminion docker.run_container myuser/myimage command='perl /scripts/sync.py' networks=net1,net2
# net1 using automatic IP, net2 using static IPv4 address
salt myminion docker.run_container myuser/myimage command='perl /scripts/sync.py' networks='{"net1": {}, "net2": {"ipv4_address": "192.168.27.12"}}'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.run_stderr"> salt.modules.dockermod.run_stderr(name, cmd, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', use_vt=False, ignore_retcode=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.run_stderr" title="salt.modules.cmdmod.run_stderr"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.run_stderr</span></code></a> within a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID in which to run the command</p> </dd> <dt>cmd</dt>
<dd>
<p>Command to run</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the command</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the command. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.run_stderr mycontainer 'ls -l /etc'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.run_stdout"> salt.modules.dockermod.run_stdout(name, cmd, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', use_vt=False, ignore_retcode=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.run_stdout" title="salt.modules.cmdmod.run_stdout"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.run_stdout</span></code></a> within a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID in which to run the command</p> </dd> <dt>cmd</dt>
<dd>
<p>Command to run</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the command</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the command. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.run_stdout mycontainer 'ls -l /etc'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.save"> salt.modules.dockermod.save(name, path, overwrite=False, makedirs=False, compression=None, **kwargs)</h3> <dd>
<p>Saves an image and to a file on the minion. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">save</span></code> Docker CLI command, but unlike <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">save</span></code> this will also work on named images instead of just images IDs.</p> <dl> <dt>name</dt>
<dd>
<p>Name or ID of image. Specify a specific tag by using the <code class="docutils literal notranslate"><span class="pre">repo:tag</span></code> notation.</p> </dd> <dt>path</dt>
<dd>
<p>Absolute path on the Minion where the image will be exported</p> </dd> <dt>overwrite<span class="classifier">False</span>
</dt>
<dd>
<p>Unless this option is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then if the destination file exists an error will be raised.</p> </dd> <dt>makedirs<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, then if the parent directory of the file specified by the <code class="docutils literal notranslate"><span class="pre">path</span></code> argument does not exist, Salt will attempt to create it.</p> </dd> <dt>compression<span class="classifier">None</span>
</dt>
<dd>
<p>Can be set to any of the following:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">gzip</span></code> or <code class="docutils literal notranslate"><span class="pre">gz</span></code> for gzip compression</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">bzip2</span></code> or <code class="docutils literal notranslate"><span class="pre">bz2</span></code> for bzip2 compression</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">xz</span></code> or <code class="docutils literal notranslate"><span class="pre">lzma</span></code> for XZ compression (requires <a class="reference external" href="http://tukaani.org/xz/">xz-utils</a>, as well as the <code class="docutils literal notranslate"><span class="pre">lzma</span></code> module from Python 3.3, available in Python 2 and Python 3.0-3.2 as <a class="reference external" href="https://pypi.python.org/pypi/backports.lzma">backports.lzma</a>)</p></li> </ul> <p>This parameter can be omitted and Salt will attempt to determine the compression type by examining the filename passed in the <code class="docutils literal notranslate"><span class="pre">path</span></code> parameter.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Since the Docker API does not support <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">save</span></code>, compression will be a bit slower with this function than with <a class="reference internal" href="#salt.modules.dockermod.export" title="salt.modules.dockermod.export"><code class="xref py py-func docutils literal notranslate"><span class="pre">docker.export</span></code></a> since the image(s) will first be saved and then the compression done afterwards.</p> </div> </dd> <dt>push<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, the container will be pushed to the master using <a class="reference internal" href="salt.modules.cp.html#salt.modules.cp.push" title="salt.modules.cp.push"><code class="xref py py-func docutils literal notranslate"><span class="pre">cp.push</span></code></a>.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This requires <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/master.html#std-conf_master-file_recv"><code class="xref std std-conf_master docutils literal notranslate"><span class="pre">file_recv</span></code></a> to be set to <code class="docutils literal notranslate"><span class="pre">True</span></code> on the Master.</p> </div> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul> <li><p><code class="docutils literal notranslate"><span class="pre">Path</span></code> - Path of the file that was saved</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">Push</span></code> - Reports whether or not the file was successfully pushed to the Master</p> <p><em>(Only present if push=True)</em></p> </li> <li><p><code class="docutils literal notranslate"><span class="pre">Size</span></code> - Size of the file, in bytes</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Size_Human</span></code> - Size of the file, in human-readable units</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Time_Elapsed</span></code> - Time in seconds taken to perform the save</p></li> </ul> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.save centos:7 /tmp/cent7.tar
salt myminion docker.save 0123456789ab cdef01234567 /tmp/saved.tar</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.script"> salt.modules.dockermod.script(name, source, saltenv='base', args=None, template=None, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', ignore_retcode=False, use_vt=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.script" title="salt.modules.cmdmod.script"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.script</span></code></a> within a container</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>While the command is run within the container, it is initiated from the host. Therefore, the PID in the return dict is from the host, not from the container.</p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>source</dt>
<dd>
<p>Path to the script. Can be a local path on the Minion or a remote file from the Salt fileserver.</p> </dd> <dt>args</dt>
<dd>
<p>A string containing additional command-line options to pass to the script.</p> </dd> <dt>template<span class="classifier">None</span>
</dt>
<dd>
<p>Templating engine to use on the script before running.</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the script</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the script. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.script mycontainer salt://docker_script.py
salt myminion docker.script mycontainer salt://scripts/runme.sh 'arg1 arg2 "arg 3"'
salt myminion docker.script mycontainer salt://scripts/runme.sh stdin='one\ntwo\nthree\nfour\nfive\n' output_loglevel=quiet</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.script_retcode"> salt.modules.dockermod.script_retcode(name, source, saltenv='base', args=None, template=None, exec_driver=None, stdin=None, python_shell=True, output_loglevel='debug', ignore_retcode=False, use_vt=False, keep_env=None)</h3> <dd>
<p>Run <a class="reference internal" href="salt.modules.cmdmod.html#salt.modules.cmdmod.script_retcode" title="salt.modules.cmdmod.script_retcode"><code class="xref py py-func docutils literal notranslate"><span class="pre">cmd.script_retcode</span></code></a> within a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>source</dt>
<dd>
<p>Path to the script. Can be a local path on the Minion or a remote file from the Salt fileserver.</p> </dd> <dt>args</dt>
<dd>
<p>A string containing additional command-line options to pass to the script.</p> </dd> <dt>template<span class="classifier">None</span>
</dt>
<dd>
<p>Templating engine to use on the script before running.</p> </dd> <dt>exec_driver<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, the execution driver will be detected as described <a class="reference internal" href="#docker-execution-driver"><span class="std std-ref">above</span></a>.</p> </dd> <dt>stdin<span class="classifier">None</span>
</dt>
<dd>
<p>Standard input to be used for the script</p> </dd> <dt>output_loglevel<span class="classifier">debug</span>
</dt>
<dd>
<p>Level at which to log the output from the script. Set to <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to suppress logging.</p> </dd> <dt>use_vt<span class="classifier">False</span>
</dt>
<dd>
<p>Use SaltStack's utils.vt to stream output to console.</p> </dd> <dt>keep_env<span class="classifier">None</span>
</dt>
<dd>
<p>If not passed, only a sane default PATH environment variable will be set. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, all environment variables from the container's host will be kept. Otherwise, a comma-separated list (or Python list) of environment variable names can be passed, and those environment variables will be kept.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.script_retcode mycontainer salt://docker_script.py
salt myminion docker.script_retcode mycontainer salt://scripts/runme.sh 'arg1 arg2 "arg 3"'
salt myminion docker.script_retcode mycontainer salt://scripts/runme.sh stdin='one\ntwo\nthree\nfour\nfive\n' output_loglevel=quiet</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.search"> salt.modules.dockermod.search(name, official=False, trusted=False)</h3> <dd>
<p>Searches the registry for an image</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Search keyword</p> </dd> <dt>official<span class="classifier">False</span>
</dt>
<dd>
<p>Limit results to official builds</p> </dd> <dt>trusted<span class="classifier">False</span>
</dt>
<dd>
<p>Limit results to <a class="reference external" href="https://blog.docker.com/2013/11/introducing-trusted-builds/">trusted builds</a></p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary with each key being the name of an image, and the following information for each image:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">Description</span></code> - Image description</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Official</span></code> - A boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if an official build, <code class="docutils literal notranslate"><span class="pre">False</span></code> if not)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Stars</span></code> - Number of stars the image has on the registry</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">Trusted</span></code> - A boolean (<code class="docutils literal notranslate"><span class="pre">True</span></code> if a trusted build, <code class="docutils literal notranslate"><span class="pre">False</span></code> if not)</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.search centos
salt myminion docker.search centos official=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.signal_"> salt.modules.dockermod.signal_(name, signal)</h3> <dd>
<p>Send a signal to a container. Signals can be either strings or numbers, and are defined in the <strong>Standard Signals</strong> section of the <code class="docutils literal notranslate"><span class="pre">signal(7)</span></code> manpage. Run <code class="docutils literal notranslate"><span class="pre">man</span> <span class="pre">7</span> <span class="pre">signal</span></code> on a Linux host to browse this manpage.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>signal</dt>
<dd>
<p>Signal to send to container</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>If the signal was successfully sent, <code class="docutils literal notranslate"><span class="pre">True</span></code> will be returned. Otherwise, an error will be raised.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.signal mycontainer SIGHUP</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.sls"> salt.modules.dockermod.sls(name, mods=None, **kwargs)</h3> <dd>
<p>Apply the states defined by the specified SLS modules to the running container</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> <p>The container does not need to have Salt installed, but Python is required.</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>mods<span class="classifier">None</span>
</dt>
<dd>
<p>A string containing comma-separated list of SLS with defined states to apply to the container.</p> </dd> <dt>saltenv<span class="classifier">base</span>
</dt>
<dd>
<p>Specify the environment from which to retrieve the SLS indicated by the <cite>mods</cite> parameter.</p> </dd> <dt>pillarenv</dt>
<dd>
<p>Specify a Pillar environment to be used when applying states. This can also be set in the minion config file using the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-pillarenv"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">pillarenv</span></code></a> option. When neither the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-pillarenv"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">pillarenv</span></code></a> minion config option nor this CLI argument is used, all Pillar environments will be merged together.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>pillar</dt>
<dd>
<p>Custom Pillar values, passed as a dictionary of key-value pairs</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Values passed this way will override Pillar values set via <code class="docutils literal notranslate"><span class="pre">pillar_roots</span></code> or an external Pillar source.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.sls compassionate_mirzakhani mods=rails,web</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.sls_build"> salt.modules.dockermod.sls_build(repository, tag='latest', base='opensuse/python', mods=None, dryrun=False, **kwargs)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>The repository and tag must now be passed separately using the <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> arguments, rather than together in the (now deprecated) <code class="docutils literal notranslate"><span class="pre">image</span></code> argument.</p> </div> <p>Build a Docker image using the specified SLS modules on top of base image</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> <p>The base image does not need to have Salt installed, but Python is required.</p> <dl> <dt>repository</dt>
<dd>
<p>Repository name for the image to be built</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tag<span class="classifier">latest</span>
</dt>
<dd>
<p>Tag name for the image to be built</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>name</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0: </span>Use both <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> instead</p> </div> </dd> <dt>base<span class="classifier">opensuse/python</span>
</dt>
<dd>
<p>Name or ID of the base image</p> </dd> <dt>mods</dt>
<dd>
<p>A string containing comma-separated list of SLS with defined states to apply to the base image.</p> </dd> <dt>saltenv<span class="classifier">base</span>
</dt>
<dd>
<p>Specify the environment from which to retrieve the SLS indicated by the <cite>mods</cite> parameter.</p> </dd> <dt>pillarenv</dt>
<dd>
<p>Specify a Pillar environment to be used when applying states. This can also be set in the minion config file using the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-pillarenv"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">pillarenv</span></code></a> option. When neither the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-pillarenv"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">pillarenv</span></code></a> minion config option nor this CLI argument is used, all Pillar environments will be merged together.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>pillar</dt>
<dd>
<p>Custom Pillar values, passed as a dictionary of key-value pairs</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Values passed this way will override Pillar values set via <code class="docutils literal notranslate"><span class="pre">pillar_roots</span></code> or an external Pillar source.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>dryrun: False</dt>
<dd>
<p>when set to True the container will not be committed at the end of the build. The dryrun succeed also when the state contains errors.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary with the ID of the new container. In case of a dryrun, the state result is returned and the container gets removed.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.sls_build imgname base=mybase mods=rails,web</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.start_"> salt.modules.dockermod.start_(name)</h3> <dd>
<p>Start a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> - Only present if the container cannot be started</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.start mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.state"> salt.modules.dockermod.state(name)</h3> <dd>
<p>Returns the state of the container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A string representing the current state of the container (either <code class="docutils literal notranslate"><span class="pre">running</span></code>, <code class="docutils literal notranslate"><span class="pre">paused</span></code>, or <code class="docutils literal notranslate"><span class="pre">stopped</span></code>)</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.state mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.stop"> salt.modules.dockermod.stop(name, timeout=None, **kwargs)</h3> <dd>
<p>Stops a running container</p> <dl> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>unpause<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code> and the container is paused, it will be unpaused before attempting to stop the container.</p> </dd> <dt>timeout</dt>
<dd>
<p>Timeout in seconds after which the container will be killed (if it has not yet gracefully shut down)</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>If this argument is not passed, then the container's configuration will be checked. If the container was created using the <code class="docutils literal notranslate"><span class="pre">stop_timeout</span></code> argument, then the configured timeout will be used, otherwise the timeout will be 10 seconds.</p> </div> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> - Only present if the container can not be stopped</p></li> </ul> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.stop mycontainer
salt myminion docker.stop mycontainer unpause=True
salt myminion docker.stop mycontainer timeout=20</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.tag_"> salt.modules.dockermod.tag_(name, repository, tag='latest', force=False)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>The repository and tag must now be passed separately using the <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> arguments, rather than together in the (now deprecated) <code class="docutils literal notranslate"><span class="pre">image</span></code> argument.</p> </div> <p>Tag an image into a repository and return <code class="docutils literal notranslate"><span class="pre">True</span></code>. If the tag was unsuccessful, an error will be raised.</p> <dl> <dt>name</dt>
<dd>
<p>ID of image</p> </dd> <dt>repository</dt>
<dd>
<p>Repository name for the image to be built</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>tag<span class="classifier">latest</span>
</dt>
<dd>
<p>Tag name for the image to be built</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> <dt>image</dt>
<dd>
<div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2018.3.0: </span>Use both <code class="docutils literal notranslate"><span class="pre">repository</span></code> and <code class="docutils literal notranslate"><span class="pre">tag</span></code> instead</p> </div> </dd> <dt>force<span class="classifier">False</span>
</dt>
<dd>
<p>Force apply tag</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.tag 0123456789ab myrepo/mycontainer mytag</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.top"> salt.modules.dockermod.top(name)</h3> <dd>
<p>Runs the <cite>docker top</cite> command on a specific container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p>CLI Example:</p> <p><strong>RETURN DATA</strong></p> <p>A list of dictionaries containing information about each process</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.top mycontainer
salt myminion docker.top 0123456789ab</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.unpause"> salt.modules.dockermod.unpause(name)</h3> <dd>
<p>Unpauses a container</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> - Only present if the container can not be unpaused</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.pause mycontainer</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.version"> salt.modules.dockermod.version()</h3> <dd>
<p>Returns a dictionary of Docker version information. Equivalent to running the <code class="docutils literal notranslate"><span class="pre">docker</span> <span class="pre">version</span></code> Docker CLI command.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.version</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.volumes"> salt.modules.dockermod.volumes(filters=None)</h3> <dd>
<p>List existing volumes</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.4.</span></p> </div> <dl class="simple"> <dt>filters</dt>
<dd>
<p>There is one available filter: dangling=true</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.volumes filters="{'dangling': True}"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.dockermod.wait"> salt.modules.dockermod.wait(name, ignore_already_stopped=False, fail_on_exit_status=False)</h3> <dd>
<p>Wait for the container to exit gracefully, and return its exit code</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This function will block until the container is stopped.</p> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>Container name or ID</p> </dd> <dt>ignore_already_stopped</dt>
<dd>
<p>Boolean flag that prevents execution to fail, if a container is already stopped.</p> </dd> <dt>fail_on_exit_status</dt>
<dd>
<p>Boolean flag to report execution as failure if <code class="docutils literal notranslate"><span class="pre">exit_status</span></code> is different than 0.</p> </dd> </dl> <p><strong>RETURN DATA</strong></p> <p>A dictionary will be returned, containing the following keys:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">status</span></code> - A dictionary showing the prior state of the container as well as the new state</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">result</span></code> - A boolean noting whether or not the action was successful</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">exit_status</span></code> - Exit status for the container</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">comment</span></code> - Only present if the container is already stopped</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt myminion docker.wait mycontainer</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.dockermod.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.dockermod.html</a>
  </p>
</div>
