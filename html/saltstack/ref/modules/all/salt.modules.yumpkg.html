<h1>salt.modules.yumpkg</h1> <p>Support for YUM/DNF</p> <div class="admonition important"> <p class="admonition-title">Important</p> <p>If you feel that Salt should be using this module to manage packages on a minion, and it is using a different module (or gives an error similar to <em>'pkg.install' is not available</em>), see <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/modules/index.html#module-provider-override"><span class="std std-ref">here</span></a>.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>DNF is fully supported as of version 2015.5.10 and 2015.8.4 (partial support for DNF was initially added in 2015.8.0), and DNF is used automatically in place of YUM in Fedora 22 and newer.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003: </span>Support for <code class="docutils literal notranslate"><span class="pre">tdnf</span></code> on Photon OS.</p> </div> <dl class="py class"> <dt id="salt.modules.yumpkg.AvailablePackages"> <em class="property">class </em><code class="sig-prename descclassname">salt.modules.yumpkg.</code><code class="sig-name descname">AvailablePackages</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span>
</dt> 
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.clean_metadata"> salt.modules.yumpkg.clean_metadata(**kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <p>Cleans local yum metadata. Functionally identical to <a class="reference internal" href="#salt.modules.yumpkg.refresh_db" title="salt.modules.yumpkg.refresh_db"><code class="xref py py-mod docutils literal notranslate"><span class="pre">refresh_db()</span></code></a>.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.clean_metadata</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.del_repo"> salt.modules.yumpkg.del_repo(repo, basedir=None, **kwargs)</h3> <dd>
<p>Delete a repo from &lt;basedir&gt; (default basedir: all dirs in <cite>reposdir</cite> yum option).</p> <p>If the .repo file in which the repo exists does not contain any other repo configuration, the file itself will be deleted.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.del_repo myrepo
salt '*' pkg.del_repo myrepo basedir=/path/to/dir
salt '*' pkg.del_repo myrepo basedir=/path/to/dir,/path/to/another/dir</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.diff"> salt.modules.yumpkg.diff(*paths, **kwargs)</h3> <dd>
<p>Return a formatted diff between current files and original in a package. NOTE: this function includes all files (configuration and not), but does not work on binary content.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>path</strong> -- Full path to the installed file</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Difference string or raises and exception if examined file is binary.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.diff /etc/apache2/httpd.conf /etc/sudoers</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.download"> salt.modules.yumpkg.download(*packages, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2015.5.0.</span></p> </div> <p>Download packages to the local disk. Requires <code class="docutils literal notranslate"><span class="pre">yumdownloader</span></code> from <code class="docutils literal notranslate"><span class="pre">yum-utils</span></code> package.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p><code class="docutils literal notranslate"><span class="pre">yum-utils</span></code> will already be installed on the minion if the package was installed from the Fedora / EPEL repositories.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.download httpd
salt '*' pkg.download httpd postfix</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.file_dict"> salt.modules.yumpkg.file_dict(*packages, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <p>List the files that belong to a package, grouped by package. Not specifying any packages will return a list of <em>every</em> file on the system's rpm database (not generally recommended).</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.file_list httpd
salt '*' pkg.file_list httpd postfix
salt '*' pkg.file_list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.file_list"> salt.modules.yumpkg.file_list(*packages, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <p>List the files that belong to a package. Not specifying any packages will return a list of <em>every</em> file on the system's rpm database (not generally recommended).</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.file_list httpd
salt '*' pkg.file_list httpd postfix
salt '*' pkg.file_list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.get_repo"> salt.modules.yumpkg.get_repo(repo, basedir=None, **kwargs)</h3> <dd>
<p>Display a repo from &lt;basedir&gt; (default basedir: all dirs in <code class="docutils literal notranslate"><span class="pre">reposdir</span></code> yum option).</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.get_repo myrepo
salt '*' pkg.get_repo myrepo basedir=/path/to/dir
salt '*' pkg.get_repo myrepo basedir=/path/to/dir,/path/to/another/dir</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.group_diff"> salt.modules.yumpkg.group_diff(name)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2016.3.0,2015.8.4,2015.5.10: </span>Environment groups are now supported. The key names have been renamed, similar to the changes made in <a class="reference internal" href="#salt.modules.yumpkg.group_info" title="salt.modules.yumpkg.group_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.group_info</span></code></a>.</p> </div> <p>Lists which of a group's packages are installed and which are not installed</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.group_diff 'Perl Support'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.group_info"> salt.modules.yumpkg.group_info(name, expand=False, ignore_groups=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3001,2016.3.0,2015.8.4,2015.5.10: </span>The return data has changed. A new key <code class="docutils literal notranslate"><span class="pre">type</span></code> has been added to distinguish environment groups from package groups. Also, keys for the group name and group ID have been added. The <code class="docutils literal notranslate"><span class="pre">mandatory</span> <span class="pre">packages</span></code>, <code class="docutils literal notranslate"><span class="pre">optional</span> <span class="pre">packages</span></code>, and <code class="docutils literal notranslate"><span class="pre">default</span> <span class="pre">packages</span></code> keys have been renamed to <code class="docutils literal notranslate"><span class="pre">mandatory</span></code>, <code class="docutils literal notranslate"><span class="pre">optional</span></code>, and <code class="docutils literal notranslate"><span class="pre">default</span></code> for accuracy, as environment groups include other groups, and not packages. Finally, this function now properly identifies conditional packages.</p> </div> <p>Lists packages belonging to a certain group</p> <dl> <dt>name</dt>
<dd>
<p>Name of the group to query</p> </dd> <dt>expand<span class="classifier">False</span>
</dt>
<dd>
<p>If the specified group is an environment group, then the group will be expanded and the return data will include package names instead of group names.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> </dd> <dt>ignore_groups<span class="classifier">None</span>
</dt>
<dd>
<p>This parameter can be used to pass a list of groups to ignore when expanding subgroups. It is used during recursion in order to prevent expanding the same group multiple times.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.group_info 'Perl Support'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.group_install"> salt.modules.yumpkg.group_install(name, skip=(), include=(), **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <p>Install the passed package group(s). This is basically a wrapper around <a class="reference internal" href="#salt.modules.yumpkg.install" title="salt.modules.yumpkg.install"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.install</span></code></a>, which performs package group resolution for the user. This function is currently considered experimental, and should be expected to undergo changes.</p> <dl> <dt>name</dt>
<dd>
<p>Package group to install. To install more than one group, either use a comma-separated list or pass the value as a python list.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.group_install 'Group 1'
salt '*' pkg.group_install 'Group 1,Group 2'
salt '*' pkg.group_install '["Group 1", "Group 2"]'</pre> </dd> <dt>skip</dt>
<dd>
<p>Packages that would normally be installed by the package group ("default" packages), which should not be installed. Can be passed either as a comma-separated list or a python list.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.group_install 'My Group' skip='foo,bar'
salt '*' pkg.group_install 'My Group' skip='["foo", "bar"]'</pre> </dd> <dt>include</dt>
<dd>
<p>Packages which are included in a group, which would not normally be installed by a <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">groupinstall</span></code> ("optional" packages). Note that this will not enforce group membership; if you include packages which are not members of the specified groups, they will still be installed. Can be passed either as a comma-separated list or a python list.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.group_install 'My Group' include='foo,bar'
salt '*' pkg.group_install 'My Group' include='["foo", "bar"]'</pre> </dd> </dl> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Because this is essentially a wrapper around pkg.install, any argument which can be passed to pkg.install may also be included here, and it will be passed along wholesale.</p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.group_list"> salt.modules.yumpkg.group_list()</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <p>Lists all groups known by yum on this system</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.group_list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.hold"> salt.modules.yumpkg.hold(name=None, pkgs=None, sources=None, normalize=True, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> <p>Version-lock packages</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Requires the appropriate <code class="docutils literal notranslate"><span class="pre">versionlock</span></code> plugin package to be installed:</p> <ul class="simple"> <li><p>On RHEL 5: <code class="docutils literal notranslate"><span class="pre">yum-versionlock</span></code></p></li> <li><p>On RHEL 6 &amp; 7: <code class="docutils literal notranslate"><span class="pre">yum-plugin-versionlock</span></code></p></li> <li><p>On Fedora: <code class="docutils literal notranslate"><span class="pre">python-dnf-plugins-extras-versionlock</span></code></p></li> </ul> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>The name of the package to be held.</p> </dd> </dl> <p>Multiple Package Options:</p> <dl class="simple"> <dt>pkgs</dt>
<dd>
<p>A list of packages to hold. Must be passed as a python list. The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter will be ignored if this option is passed.</p> </dd> </dl> <p>Returns a dict containing the changes.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.hold &lt;package name&gt;
salt '*' pkg.hold pkgs='["foo", "bar"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.info_installed"> salt.modules.yumpkg.info_installed(*names, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.1.</span></p> </div> <p>Return the information of the named package(s), installed on the system.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>all_versions</strong> -- Include information for all versions of the packages installed on the minion.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.info_installed &lt;package1&gt;
salt '*' pkg.info_installed &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; ...
salt '*' pkg.info_installed &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; all_versions=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.install"> salt.modules.yumpkg.install(name=None, refresh=False, skip_verify=False, pkgs=None, sources=None, downloadonly=False, reinstall=False, normalize=True, update_holds=False, saltenv='base', ignore_epoch=False, **kwargs)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.12,2016.3.3,2016.11.0: </span>On minions running systemd&gt;=205, <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> is now used to isolate commands which modify installed packages from the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> daemon's control group. This is done to keep systemd from killing any yum/dnf commands spawned by Salt when the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> service is restarted. (see <code class="docutils literal notranslate"><span class="pre">KillMode</span></code> in the <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.kill.html">systemd.kill(5)</a> manpage for more information). If desired, usage of <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> can be suppressed by setting a <a class="reference internal" href="salt.modules.config.html#salt.modules.config.get" title="salt.modules.config.get"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span> <span class="pre">option</span></code></a> called <code class="docutils literal notranslate"><span class="pre">systemd.scope</span></code>, with a value of <code class="docutils literal notranslate"><span class="pre">False</span></code> (no quotes).</p> </div> <p>Install the passed package(s), add refresh=True to clean the yum database before package is installed.</p> <dl> <dt>name</dt>
<dd>
<p>The name of the package to be installed. Note that this parameter is ignored if either "pkgs" or "sources" is passed. Additionally, please note that this option can only be used to install packages from a software repository. To install a package file manually, use the "sources" option.</p> <p>32-bit packages can be installed on 64-bit systems by appending the architecture designation (<code class="docutils literal notranslate"><span class="pre">.i686</span></code>, <code class="docutils literal notranslate"><span class="pre">.i586</span></code>, etc.) to the end of the package name.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.install &lt;package name&gt;</pre> </dd> <dt>refresh</dt>
<dd>
<p>Whether or not to update the yum database before executing.</p> </dd> <dt>reinstall</dt>
<dd>
<p>Specifying reinstall=True will use <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">reinstall</span></code> rather than <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">install</span></code> for requested packages that are already installed.</p> <p>If a version is specified with the requested package, then <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">reinstall</span></code> will only be used if the installed version matches the requested version.</p> <p>Works with <code class="docutils literal notranslate"><span class="pre">sources</span></code> when the package header of the source can be matched to the name and version of an installed package.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> </dd> <dt>skip_verify</dt>
<dd>
<p>Skip the GPG verification check (e.g., <code class="docutils literal notranslate"><span class="pre">--nogpgcheck</span></code>)</p> </dd> <dt>downloadonly</dt>
<dd>
<p>Only download the packages, do not install.</p> </dd> <dt>version</dt>
<dd>
<p>Install a specific version of the package, e.g. 1.2.3-4.el5. Ignored if "pkgs" or "sources" is passed.</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2018.3.0: </span>version can now contain comparison operators (e.g. <code class="docutils literal notranslate"><span class="pre">&gt;1.2.3</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;=2.0</span></code>, etc.)</p> </div> </dd> <dt>update_holds<span class="classifier">False</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, and this function would update the package version, any packages held using the yum/dnf "versionlock" plugin will be unheld so that they can be updated. Otherwise, if this function attempts to update a held package, the held package(s) will be skipped and an error will be raised.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> </dd> <dt>setopt</dt>
<dd>
<p>A comma-separated or Python list of key=value options. This list will be expanded and <code class="docutils literal notranslate"><span class="pre">--setopt</span></code> prepended to each in the yum/dnf command that is run.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.install foo setopt='obsoletes=0,plugins=0'</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd> </dl> <p>Repository Options:</p> <dl> <dt>fromrepo</dt>
<dd>
<p>Specify a package repository (or repositories) from which to install. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disablerepo='*'</span> <span class="pre">--enablerepo='somerepo'</span></code>)</p> </dd> <dt>enablerepo (ignored if <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> is specified)</dt>
<dd>
<p>Specify a disabled package repository (or repositories) to enable. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--enablerepo='somerepo'</span></code>)</p> </dd> <dt>disablerepo (ignored if <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> is specified)</dt>
<dd>
<p>Specify an enabled package repository (or repositories) to disable. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disablerepo='somerepo'</span></code>)</p> </dd> <dt>disableexcludes</dt>
<dd>
<p>Disable exclude from main, for a repo or for everything. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disableexcludes='main'</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> </dd> <dt>ignore_epoch<span class="classifier">False</span>
</dt>
<dd>
<p>Only used when the version of a package is specified using a comparison operator (e.g. <code class="docutils literal notranslate"><span class="pre">&gt;4.1</span></code>). If set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the epoch will be ignored when comparing the currently-installed version to the desired version.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> </dl> <p>Multiple Package Installation Options:</p> <dl> <dt>pkgs</dt>
<dd>
<p>A list of packages to install from a software repository. Must be passed as a python list. A specific version number can be specified by using a single-element dict representing the package and its version.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.install pkgs='["foo", "bar"]'
salt '*' pkg.install pkgs='["foo", {"bar": "1.2.3-4.el5"}]'</pre> </dd> <dt>sources</dt>
<dd>
<p>A list of RPM packages to install. Must be passed as a list of dicts, with the keys being package names, and the values being the source URI or local path to the package.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.install sources='[{"foo": "salt://foo.rpm"}, {"bar": "salt://bar.rpm"}]'</pre> </dd> <dt>normalize<span class="classifier">True</span>
</dt>
<dd>
<p>Normalize the package name by removing the architecture. This is useful for poorly created packages which might include the architecture as an actual part of the name such as kernel modules which match a specific kernel version.</p> <pre class="highlight-bash notranslate" data-language="bash">salt -G role:nsd pkg.install gpfs.gplbin-2.6.32-279.31.1.el6.x86_64 normalize=False</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> </dd> <dt>diff_attr:</dt>
<dd>
<p>If a list of package attributes is specified, returned value will contain them, eg.:</p> <pre class="highlight-default notranslate" data-language="default">{'&lt;package&gt;': {
    'old': {
        'version': '&lt;old-version&gt;',
        'arch': '&lt;old-arch&gt;'},

    'new': {
        'version': '&lt;new-version&gt;',
        'arch': '&lt;new-arch&gt;'}}}</pre> <p>Valid attributes are: <code class="docutils literal notranslate"><span class="pre">epoch</span></code>, <code class="docutils literal notranslate"><span class="pre">version</span></code>, <code class="docutils literal notranslate"><span class="pre">release</span></code>, <code class="docutils literal notranslate"><span class="pre">arch</span></code>, <code class="docutils literal notranslate"><span class="pre">install_date</span></code>, <code class="docutils literal notranslate"><span class="pre">install_date_time_t</span></code>.</p> <p>If <code class="docutils literal notranslate"><span class="pre">all</span></code> is specified, all valid attributes will be returned.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </dd> </dl> <p>Returns a dict containing the new package names and versions:</p> <pre class="highlight-default notranslate" data-language="default">{'&lt;package&gt;': {'old': '&lt;old-version&gt;',
               'new': '&lt;new-version&gt;'}}</pre> <p>If an attribute list in diff_attr is specified, the dict will also contain any specified attribute, eg.:</p> <pre class="highlight-default notranslate" data-language="default">{'&lt;package&gt;': {
    'old': {
        'version': '&lt;old-version&gt;',
        'arch': '&lt;old-arch&gt;'},

    'new': {
        'version': '&lt;new-version&gt;',
        'arch': '&lt;new-arch&gt;'}}}</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.latest_version"> salt.modules.yumpkg.latest_version(*names, **kwargs)</h3> <dd>
<p>Return the latest version of the named package available for upgrade or installation. If more than one package name is specified, a dict of name/version pairs is returned.</p> <p>If the latest version of a given package is already installed, an empty string will be returned for that package.</p> <p>A specific repo can be requested using the <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> keyword argument, and the <code class="docutils literal notranslate"><span class="pre">disableexcludes</span></code> option is also supported.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0: </span>Support for the <code class="docutils literal notranslate"><span class="pre">disableexcludes</span></code> option</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.latest_version &lt;package name&gt;
salt '*' pkg.latest_version &lt;package name&gt; fromrepo=epel-testing
salt '*' pkg.latest_version &lt;package name&gt; disableexcludes=main
salt '*' pkg.latest_version &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; ...</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_downloaded"> salt.modules.yumpkg.list_downloaded(**kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <p>List prefetched packages downloaded by Yum in the local disk.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_downloaded</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_holds"> salt.modules.yumpkg.list_holds(pattern='[\\w+]+(?:[.-][^-]+)*', full=True)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2016.3.0,2015.8.4,2015.5.10: </span>Function renamed from <code class="docutils literal notranslate"><span class="pre">pkg.get_locked_pkgs</span></code> to <code class="docutils literal notranslate"><span class="pre">pkg.list_holds</span></code>.</p> </div> <p>List information on locked packages</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Requires the appropriate <code class="docutils literal notranslate"><span class="pre">versionlock</span></code> plugin package to be installed:</p> <ul class="simple"> <li><p>On RHEL 5: <code class="docutils literal notranslate"><span class="pre">yum-versionlock</span></code></p></li> <li><p>On RHEL 6 &amp; 7: <code class="docutils literal notranslate"><span class="pre">yum-plugin-versionlock</span></code></p></li> <li><p>On Fedora: <code class="docutils literal notranslate"><span class="pre">python-dnf-plugins-extras-versionlock</span></code></p></li> </ul> </div> <dl class="simple"> <dt>pattern<span class="classifier">w+(?:[.-][^-]+)*</span>
</dt>
<dd>
<p>Regular expression used to match the package name</p> </dd> <dt>full<span class="classifier">True</span>
</dt>
<dd>
<p>Show the full hold definition including version and epoch. Set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to return just the name of the package(s) being held.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_holds
salt '*' pkg.list_holds full=False</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_installed_patches"> salt.modules.yumpkg.list_installed_patches(**kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <p>List installed advisory patches on the system.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_installed_patches</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_patches"> salt.modules.yumpkg.list_patches(refresh=False, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <p>List all known advisory patches from available repos.</p> <dl class="simple"> <dt>refresh</dt>
<dd>
<p>force a refresh if set to True. If set to False (default) it depends on yum if a refresh is executed.</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_patches</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_pkgs"> salt.modules.yumpkg.list_pkgs(versions_as_list=False, **kwargs)</h3> <dd>
<p>List the packages currently installed as a dict. By default, the dict contains versions as a comma separated string:</p> <pre class="highlight-default notranslate" data-language="default">{'&lt;package_name&gt;': '&lt;version&gt;[,&lt;version&gt;...]'}</pre> <dl> <dt>versions_as_list:</dt>
<dd>
<p>If set to true, the versions are provided as a list</p> <p>{'&lt;package_name&gt;': ['&lt;version&gt;', '&lt;version&gt;']}</p> </dd> <dt>attr:</dt>
<dd>
<p>If a list of package attributes is specified, returned value will contain them in addition to version, eg.:</p> <pre class="highlight-default notranslate" data-language="default">{'&lt;package_name&gt;': [{'version' : 'version', 'arch' : 'arch'}]}</pre> <p>Valid attributes are: <code class="docutils literal notranslate"><span class="pre">epoch</span></code>, <code class="docutils literal notranslate"><span class="pre">version</span></code>, <code class="docutils literal notranslate"><span class="pre">release</span></code>, <code class="docutils literal notranslate"><span class="pre">arch</span></code>, <code class="docutils literal notranslate"><span class="pre">install_date</span></code>, <code class="docutils literal notranslate"><span class="pre">install_date_time_t</span></code>.</p> <p>If <code class="docutils literal notranslate"><span class="pre">all</span></code> is specified, all valid attributes will be returned.</p> <blockquote> <div>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.0.</span></p> </div> </div>
</blockquote> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_pkgs
salt '*' pkg.list_pkgs attr=version,arch
salt '*' pkg.list_pkgs attr='["version", "arch"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_repo_pkgs"> salt.modules.yumpkg.list_repo_pkgs(*args, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2014.7.0: </span>All available versions of each package are now returned. This required a slight modification to the structure of the return dict. The return data shown below reflects the updated return dict structure. Note that packages which are version-locked using <a class="reference internal" href="#salt.modules.yumpkg.hold" title="salt.modules.yumpkg.hold"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pkg.hold</span></code></a> will only show the currently-installed version, as locking a package will make other versions appear unavailable to yum/dnf.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>By default, the versions for each package are no longer organized by repository. To get results organized by repository, use <code class="docutils literal notranslate"><span class="pre">byrepo=True</span></code>.</p> </div> <p>Returns all available packages. Optionally, package names (and name globs) can be passed and the results will be filtered to packages matching those names. This is recommended as it speeds up the function considerably.</p> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Running this function on RHEL/CentOS 6 and earlier will be more resource-intensive, as the version of yum that ships with older RHEL/CentOS has no yum subcommand for listing packages from a repository. Thus, a <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">list</span> <span class="pre">installed</span></code> and <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">list</span> <span class="pre">available</span></code> are run, which generates a lot of output, which must then be analyzed to determine which package information to include in the return data.</p> </div> <p>This function can be helpful in discovering the version or repo to specify in a <a class="reference internal" href="../../states/all/salt.states.pkg.html#salt.states.pkg.installed" title="salt.states.pkg.installed"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pkg.installed</span></code></a> state.</p> <p>The return data will be a dictionary mapping package names to a list of version numbers, ordered from newest to oldest. If <code class="docutils literal notranslate"><span class="pre">byrepo</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, then the return dictionary will contain repository names at the top level, and each repository will map packages to lists of version numbers. For example:</p> <pre class="highlight-python notranslate" data-language="python"># With byrepo=False (default)
{
    'bash': ['4.1.2-15.el6_5.2',
             '4.1.2-15.el6_5.1',
             '4.1.2-15.el6_4'],
    'kernel': ['2.6.32-431.29.2.el6',
               '2.6.32-431.23.3.el6',
               '2.6.32-431.20.5.el6',
               '2.6.32-431.20.3.el6',
               '2.6.32-431.17.1.el6',
               '2.6.32-431.11.2.el6',
               '2.6.32-431.5.1.el6',
               '2.6.32-431.3.1.el6',
               '2.6.32-431.1.2.0.1.el6',
               '2.6.32-431.el6']
}
# With byrepo=True
{
    'base': {
        'bash': ['4.1.2-15.el6_4'],
        'kernel': ['2.6.32-431.el6']
    },
    'updates': {
        'bash': ['4.1.2-15.el6_5.2', '4.1.2-15.el6_5.1'],
        'kernel': ['2.6.32-431.29.2.el6',
                   '2.6.32-431.23.3.el6',
                   '2.6.32-431.20.5.el6',
                   '2.6.32-431.20.3.el6',
                   '2.6.32-431.17.1.el6',
                   '2.6.32-431.11.2.el6',
                   '2.6.32-431.5.1.el6',
                   '2.6.32-431.3.1.el6',
                   '2.6.32-431.1.2.0.1.el6']
    }
}</pre> <dl> <dt>fromrepo<span class="classifier">None</span>
</dt>
<dd>
<p>Only include results from the specified repo(s). Multiple repos can be specified, comma-separated.</p> </dd> <dt>enablerepo (ignored if <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> is specified)</dt>
<dd>
<p>Specify a disabled package repository (or repositories) to enable. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--enablerepo='somerepo'</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd> <dt>disablerepo (ignored if <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> is specified)</dt>
<dd>
<p>Specify an enabled package repository (or repositories) to disable. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disablerepo='somerepo'</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd> <dt>byrepo<span class="classifier">False</span>
</dt>
<dd>
<p>When <code class="docutils literal notranslate"><span class="pre">True</span></code>, the return data for each package will be organized by repository.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd> <dt>cacheonly<span class="classifier">False</span>
</dt>
<dd>
<p>When <code class="docutils literal notranslate"><span class="pre">True</span></code>, the repo information will be retrieved from the cached repo metadata. This is equivalent to passing the <code class="docutils literal notranslate"><span class="pre">-C</span></code> option to yum/dnf.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd> <dt>setopt</dt>
<dd>
<p>A comma-separated or Python list of key=value options. This list will be expanded and <code class="docutils literal notranslate"><span class="pre">--setopt</span></code> prepended to each in the yum/dnf command that is run.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_repo_pkgs
salt '*' pkg.list_repo_pkgs foo bar baz
salt '*' pkg.list_repo_pkgs 'samba4*' fromrepo=base,updates
salt '*' pkg.list_repo_pkgs 'python2-*' byrepo=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_repos"> salt.modules.yumpkg.list_repos(basedir=None, **kwargs)</h3> <dd>
<p>Lists all repos in &lt;basedir&gt; (default: all dirs in <cite>reposdir</cite> yum option).</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_repos
salt '*' pkg.list_repos basedir=/path/to/dir
salt '*' pkg.list_repos basedir=/path/to/dir,/path/to/another/dir</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.list_upgrades"> salt.modules.yumpkg.list_upgrades(refresh=True, **kwargs)</h3> <dd>
<p>Check whether or not an upgrade is available for all packages</p> <p>The <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code>, <code class="docutils literal notranslate"><span class="pre">enablerepo</span></code>, and <code class="docutils literal notranslate"><span class="pre">disablerepo</span></code> arguments are supported, as used in pkg states, and the <code class="docutils literal notranslate"><span class="pre">disableexcludes</span></code> option is also supported.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0: </span>Support for the <code class="docutils literal notranslate"><span class="pre">disableexcludes</span></code> option</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_upgrades</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.mod_repo"> salt.modules.yumpkg.mod_repo(repo, basedir=None, **kwargs)</h3> <dd>
<p>Modify one or more values for a repo. If the repo does not exist, it will be created, so long as the following values are specified:</p> <dl class="simple"> <dt>repo</dt>
<dd>
<p>name by which the yum refers to the repo</p> </dd> <dt>name</dt>
<dd>
<p>a human-readable name for the repo</p> </dd> <dt>baseurl</dt>
<dd>
<p>the URL for yum to reference</p> </dd> <dt>mirrorlist</dt>
<dd>
<p>the URL for yum to reference</p> </dd> </dl> <p>Key/Value pairs may also be removed from a repo's configuration by setting a key to a blank value. Bear in mind that a name cannot be deleted, and a baseurl can only be deleted if a mirrorlist is specified (or vice versa).</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.mod_repo reponame enabled=1 gpgcheck=1
salt '*' pkg.mod_repo reponame basedir=/path/to/dir enabled=1
salt '*' pkg.mod_repo reponame baseurl= mirrorlist=http://host.com/</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.modified"> salt.modules.yumpkg.modified(*packages, **flags)</h3> <dd>
<p>List the modified files that belong to a package. Not specifying any packages will return a list of _all_ modified files on the system's RPM database.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.5.0.</span></p> </div> <p>Filtering by flags (True or False):</p> <dl class="simple"> <dt>size</dt>
<dd>
<p>Include only files where size changed.</p> </dd> <dt>mode</dt>
<dd>
<p>Include only files which file's mode has been changed.</p> </dd> <dt>checksum</dt>
<dd>
<p>Include only files which MD5 checksum has been changed.</p> </dd> <dt>device</dt>
<dd>
<p>Include only files which major and minor numbers has been changed.</p> </dd> <dt>symlink</dt>
<dd>
<p>Include only files which are symbolic link contents.</p> </dd> <dt>owner</dt>
<dd>
<p>Include only files where owner has been changed.</p> </dd> <dt>group</dt>
<dd>
<p>Include only files where group has been changed.</p> </dd> <dt>time</dt>
<dd>
<p>Include only files where modification time of the file has been changed.</p> </dd> <dt>capabilities</dt>
<dd>
<p>Include only files where capabilities differ or not. Note: supported only on newer RPM versions.</p> </dd> </dl> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.modified
salt '*' pkg.modified httpd
salt '*' pkg.modified httpd postfix
salt '*' pkg.modified httpd owner=True group=False</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.normalize_name"> salt.modules.yumpkg.normalize_name(name)</h3> <dd>
<p>Strips the architecture from the specified package name, if necessary. Circumstances where this would be done include:</p> <ul class="simple"> <li><p>If the arch is 32 bit and the package name ends in a 32-bit arch.</p></li> <li><p>If the arch matches the OS arch, or is <code class="docutils literal notranslate"><span class="pre">noarch</span></code>.</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.normalize_name zsh.x86_64</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.owner"> salt.modules.yumpkg.owner(*paths, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> <p>Return the name of the package that owns the file. Multiple file paths can be passed. Like <a class="reference internal" href="#salt.modules.yumpkg.version" title="salt.modules.yumpkg.version"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pkg.version</span></code></a>, if a single path is passed, a string will be returned, and if multiple paths are passed, a dictionary of file/package name pairs will be returned.</p> <p>If the file is not owned by a package, or is not present on the minion, then an empty string will be returned for that path.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.owner /usr/bin/apachectl
salt '*' pkg.owner /usr/bin/apachectl /etc/httpd/conf/httpd.conf</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.parse_arch"> salt.modules.yumpkg.parse_arch(name)</h3> <dd>
<p>Parse name and architecture from the specified package name.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.parse_arch zsh.x86_64</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.purge"> salt.modules.yumpkg.purge(name=None, pkgs=None, **kwargs)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.12,2016.3.3,2016.11.0: </span>On minions running systemd&gt;=205, <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> is now used to isolate commands which modify installed packages from the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> daemon's control group. This is done to keep systemd from killing any yum/dnf commands spawned by Salt when the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> service is restarted. (see <code class="docutils literal notranslate"><span class="pre">KillMode</span></code> in the <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.kill.html">systemd.kill(5)</a> manpage for more information). If desired, usage of <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> can be suppressed by setting a <a class="reference internal" href="salt.modules.config.html#salt.modules.config.get" title="salt.modules.config.get"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span> <span class="pre">option</span></code></a> called <code class="docutils literal notranslate"><span class="pre">systemd.scope</span></code>, with a value of <code class="docutils literal notranslate"><span class="pre">False</span></code> (no quotes).</p> </div> <p>Package purges are not supported by yum, this function is identical to <a class="reference internal" href="#salt.modules.yumpkg.remove" title="salt.modules.yumpkg.remove"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pkg.remove</span></code></a>.</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>The name of the package to be purged</p> </dd> </dl> <p>Multiple Package Options:</p> <dl class="simple"> <dt>pkgs</dt>
<dd>
<p>A list of packages to delete. Must be passed as a python list. The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter will be ignored if this option is passed.</p> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.16.0.</span></p> </div> <p>Returns a dict containing the changes.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.purge &lt;package name&gt;
salt '*' pkg.purge &lt;package1&gt;,&lt;package2&gt;,&lt;package3&gt;
salt '*' pkg.purge pkgs='["foo", "bar"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.refresh_db"> salt.modules.yumpkg.refresh_db(**kwargs)</h3> <dd>
<p>Check the yum repos for updated packages</p> <p>Returns:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">True</span></code>: Updates are available</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">False</span></code>: An error occurred</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">None</span></code>: No updates are available</p></li> </ul> <dl> <dt>repo</dt>
<dd>
<p>Refresh just the specified repo</p> </dd> <dt>disablerepo</dt>
<dd>
<p>Do not refresh the specified repo</p> </dd> <dt>enablerepo</dt>
<dd>
<p>Refresh a disabled repo using this option</p> </dd> <dt>branch</dt>
<dd>
<p>Add the specified branch when refreshing</p> </dd> <dt>disableexcludes</dt>
<dd>
<p>Disable the excludes defined in your config files. Takes one of three options: - <code class="docutils literal notranslate"><span class="pre">all</span></code> - disable all excludes - <code class="docutils literal notranslate"><span class="pre">main</span></code> - disable excludes defined in [main] in yum.conf - <code class="docutils literal notranslate"><span class="pre">repoid</span></code> - disable excludes defined for that repo</p> </dd> <dt>setopt</dt>
<dd>
<p>A comma-separated or Python list of key=value options. This list will be expanded and <code class="docutils literal notranslate"><span class="pre">--setopt</span></code> prepended to each in the yum/dnf command that is run.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.refresh_db</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.remove"> salt.modules.yumpkg.remove(name=None, pkgs=None, **kwargs)</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.12,2016.3.3,2016.11.0: </span>On minions running systemd&gt;=205, <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> is now used to isolate commands which modify installed packages from the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> daemon's control group. This is done to keep systemd from killing any yum/dnf commands spawned by Salt when the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> service is restarted. (see <code class="docutils literal notranslate"><span class="pre">KillMode</span></code> in the <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.kill.html">systemd.kill(5)</a> manpage for more information). If desired, usage of <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> can be suppressed by setting a <a class="reference internal" href="salt.modules.config.html#salt.modules.config.get" title="salt.modules.config.get"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span> <span class="pre">option</span></code></a> called <code class="docutils literal notranslate"><span class="pre">systemd.scope</span></code>, with a value of <code class="docutils literal notranslate"><span class="pre">False</span></code> (no quotes).</p> </div> <p>Remove packages</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>The name of the package to be removed</p> </dd> </dl> <p>Multiple Package Options:</p> <dl class="simple"> <dt>pkgs</dt>
<dd>
<p>A list of packages to delete. Must be passed as a python list. The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter will be ignored if this option is passed.</p> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.16.0.</span></p> </div> <p>Returns a dict containing the changes.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.remove &lt;package name&gt;
salt '*' pkg.remove &lt;package1&gt;,&lt;package2&gt;,&lt;package3&gt;
salt '*' pkg.remove pkgs='["foo", "bar"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.services_need_restart"> salt.modules.yumpkg.services_need_restart(**kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> <p>List services that use files which have been changed by the package manager. It might be needed to restart them.</p> <p>Requires systemd.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.services_need_restart</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.unhold"> salt.modules.yumpkg.unhold(name=None, pkgs=None, sources=None, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.0.</span></p> </div> <p>Remove version locks</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Requires the appropriate <code class="docutils literal notranslate"><span class="pre">versionlock</span></code> plugin package to be installed:</p> <ul class="simple"> <li><p>On RHEL 5: <code class="docutils literal notranslate"><span class="pre">yum-versionlock</span></code></p></li> <li><p>On RHEL 6 &amp; 7: <code class="docutils literal notranslate"><span class="pre">yum-plugin-versionlock</span></code></p></li> <li><p>On Fedora: <code class="docutils literal notranslate"><span class="pre">python-dnf-plugins-extras-versionlock</span></code></p></li> </ul> </div> <dl class="simple"> <dt>name</dt>
<dd>
<p>The name of the package to be unheld</p> </dd> </dl> <p>Multiple Package Options:</p> <dl class="simple"> <dt>pkgs</dt>
<dd>
<p>A list of packages to unhold. Must be passed as a python list. The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter will be ignored if this option is passed.</p> </dd> </dl> <p>Returns a dict containing the changes.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.unhold &lt;package name&gt;
salt '*' pkg.unhold pkgs='["foo", "bar"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.update"> salt.modules.yumpkg.update(name=None, pkgs=None, refresh=True, skip_verify=False, normalize=True, minimal=False, obsoletes=False, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>Calls <a class="reference internal" href="#salt.modules.yumpkg.upgrade" title="salt.modules.yumpkg.upgrade"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.upgrade</span></code></a> with <code class="docutils literal notranslate"><span class="pre">obsoletes=False</span></code>. Mirrors the CLI behavior of <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">update</span></code>. See <a class="reference internal" href="#salt.modules.yumpkg.upgrade" title="salt.modules.yumpkg.upgrade"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.upgrade</span></code></a> for further documentation.</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.update</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.upgrade"> salt.modules.yumpkg.upgrade(name=None, pkgs=None, refresh=True, skip_verify=False, normalize=True, minimal=False, obsoletes=True, **kwargs)</h3> <dd>
<p>Run a full system upgrade (a <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">upgrade</span></code> or <code class="docutils literal notranslate"><span class="pre">dnf</span> <span class="pre">upgrade</span></code>), or upgrade specified packages. If the packages aren't installed, they will not be installed.</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2014.7.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.12,2016.3.3,2016.11.0: </span>On minions running systemd&gt;=205, <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> is now used to isolate commands which modify installed packages from the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> daemon's control group. This is done to keep systemd from killing any yum/dnf commands spawned by Salt when the <code class="docutils literal notranslate"><span class="pre">salt-minion</span></code> service is restarted. (see <code class="docutils literal notranslate"><span class="pre">KillMode</span></code> in the <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd.kill.html">systemd.kill(5)</a> manpage for more information). If desired, usage of <a class="reference external" href="https://www.freedesktop.org/software/systemd/man/systemd-run.html">systemd-run(1)</a> can be suppressed by setting a <a class="reference internal" href="salt.modules.config.html#salt.modules.config.get" title="salt.modules.config.get"><code class="xref py py-mod docutils literal notranslate"><span class="pre">config</span> <span class="pre">option</span></code></a> called <code class="docutils literal notranslate"><span class="pre">systemd.scope</span></code>, with a value of <code class="docutils literal notranslate"><span class="pre">False</span></code> (no quotes).</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2019.2.0: </span>Added <code class="docutils literal notranslate"><span class="pre">obsoletes</span></code> and <code class="docutils literal notranslate"><span class="pre">minimal</span></code> arguments</p> </div> <p>Returns a dictionary containing the changes:</p> <pre class="highlight-python notranslate" data-language="python">{'&lt;package&gt;':  {'old': '&lt;old-version&gt;',
                'new': '&lt;new-version&gt;'}}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade
salt '*' pkg.upgrade name=openssl</pre> <p>Repository Options:</p> <dl> <dt>fromrepo</dt>
<dd>
<p>Specify a package repository (or repositories) from which to install. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disablerepo='*'</span> <span class="pre">--enablerepo='somerepo'</span></code>)</p> </dd> <dt>enablerepo (ignored if <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> is specified)</dt>
<dd>
<p>Specify a disabled package repository (or repositories) to enable. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--enablerepo='somerepo'</span></code>)</p> </dd> <dt>disablerepo (ignored if <code class="docutils literal notranslate"><span class="pre">fromrepo</span></code> is specified)</dt>
<dd>
<p>Specify an enabled package repository (or repositories) to disable. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disablerepo='somerepo'</span></code>)</p> </dd> <dt>disableexcludes</dt>
<dd>
<p>Disable exclude from main, for a repo or for everything. (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">--disableexcludes='main'</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2014.7.</span></p> </div> </dd> <dt>name</dt>
<dd>
<p>The name of the package to be upgraded. Note that this parameter is ignored if "pkgs" is passed.</p> <p>32-bit packages can be upgraded on 64-bit systems by appending the architecture designation (<code class="docutils literal notranslate"><span class="pre">.i686</span></code>, <code class="docutils literal notranslate"><span class="pre">.i586</span></code>, etc.) to the end of the package name.</p> <p>Warning: if you forget 'name=' and run pkg.upgrade openssl, ALL packages are upgraded. This will be addressed in next releases.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade name=openssl</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> </dd> <dt>pkgs</dt>
<dd>
<p>A list of packages to upgrade from a software repository. Must be passed as a python list. A specific version number can be specified by using a single-element dict representing the package and its version. If the package was not already installed on the system, it will not be installed.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade pkgs='["foo", "bar"]'
salt '*' pkg.upgrade pkgs='["foo", {"bar": "1.2.3-4.el5"}]'</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> </dd> <dt>normalize<span class="classifier">True</span>
</dt>
<dd>
<p>Normalize the package name by removing the architecture. This is useful for poorly created packages which might include the architecture as an actual part of the name such as kernel modules which match a specific kernel version.</p> <pre class="highlight-bash notranslate" data-language="bash">salt -G role:nsd pkg.upgrade gpfs.gplbin-2.6.32-279.31.1.el6.x86_64 normalize=False</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> </dd> <dt>minimal<span class="classifier">False</span>
</dt>
<dd>
<p>Use upgrade-minimal instead of upgrade (e.g., <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">upgrade-minimal</span></code>) Goes to the 'newest' package match which fixes a problem that affects your system.</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade minimal=True</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd> <dt>obsoletes<span class="classifier">True</span>
</dt>
<dd>
<p>Controls whether yum/dnf should take obsoletes into account and remove them. If set to <code class="docutils literal notranslate"><span class="pre">False</span></code> yum will use <code class="docutils literal notranslate"><span class="pre">update</span></code> instead of <code class="docutils literal notranslate"><span class="pre">upgrade</span></code> and dnf will be run with <code class="docutils literal notranslate"><span class="pre">--obsoletes=False</span></code></p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade obsoletes=False</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd> <dt>setopt</dt>
<dd>
<p>A comma-separated or Python list of key=value options. This list will be expanded and <code class="docutils literal notranslate"><span class="pre">--setopt</span></code> prepended to each in the yum/dnf command that is run.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd> </dl> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To add extra arguments to the <code class="docutils literal notranslate"><span class="pre">yum</span> <span class="pre">upgrade</span></code> command, pass them as key word arguments. For arguments without assignments, pass <code class="docutils literal notranslate"><span class="pre">True</span></code></p> </div> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade security=True exclude='kernel*'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.upgrade_available"> salt.modules.yumpkg.upgrade_available(name, **kwargs)</h3> <dd>
<p>Check whether or not an upgrade is available for a given package</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade_available &lt;package name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.verify"> salt.modules.yumpkg.verify(*names, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2014.1.0.</span></p> </div> <p>Runs an rpm -Va on a system, and returns the results in a dict</p> <p>Pass options to modify rpm verify behavior using the <code class="docutils literal notranslate"><span class="pre">verify_options</span></code> keyword argument</p> <p>Files with an attribute of config, doc, ghost, license or readme in the package header can be ignored using the <code class="docutils literal notranslate"><span class="pre">ignore_types</span></code> keyword argument</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.verify
salt '*' pkg.verify httpd
salt '*' pkg.verify 'httpd postfix'
salt '*' pkg.verify 'httpd postfix' ignore_types=['config','doc']
salt '*' pkg.verify 'httpd postfix' verify_options=['nodeps','nosize']</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.version"> salt.modules.yumpkg.version(*names, **kwargs)</h3> <dd>
<p>Returns a string representing the package version or an empty string if not installed. If more than one package name is specified, a dict of name/version pairs is returned.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.version &lt;package name&gt;
salt '*' pkg.version &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; ...</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.yumpkg.version_cmp"> salt.modules.yumpkg.version_cmp(pkg1, pkg2, ignore_epoch=False, **kwargs)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2015.5.4.</span></p> </div> <p>Do a cmp-style comparison on two packages. Return -1 if pkg1 &lt; pkg2, 0 if pkg1 == pkg2, and 1 if pkg1 &gt; pkg2. Return None if there was a problem making the comparison.</p> <dl> <dt>ignore_epoch<span class="classifier">False</span>
</dt>
<dd>
<p>Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to ignore the epoch when comparing versions</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.8.10,2016.3.2.</span></p> </div> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.version_cmp '0.2-001' '0.2.0.1-002'</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.yumpkg.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.yumpkg.html</a>
  </p>
</div>
