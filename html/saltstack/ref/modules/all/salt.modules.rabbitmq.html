<h1>salt.modules.rabbitmq</h1> <p>Module to provide RabbitMQ compatibility to Salt. Todo: A lot, need to add cluster support, logging, and minion configuration data.</p> <dl class="py function"> <h3 id="salt.modules.rabbitmq.add_user"> salt.modules.rabbitmq.add_user(name, password=None, runas=None)</h3> <dd>
<p>Add a rabbitMQ user via rabbitmqctl user_add &lt;user&gt; &lt;password&gt;</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.add_user rabbit_user password</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.add_vhost"> salt.modules.rabbitmq.add_vhost(vhost, runas=None)</h3> <dd>
<p>Adds a vhost via rabbitmqctl add_vhost.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq add_vhost '&lt;vhost_name&gt;'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.change_password"> salt.modules.rabbitmq.change_password(name, password, runas=None)</h3> <dd>
<p>Changes a user's password.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.change_password rabbit_user password</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.check_password"> salt.modules.rabbitmq.check_password(name, password, runas=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <p>Checks if a user's password is valid.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.check_password rabbit_user password</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.clear_password"> salt.modules.rabbitmq.clear_password(name, runas=None)</h3> <dd>
<p>Removes a user's password.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.clear_password rabbit_user</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.cluster_status"> salt.modules.rabbitmq.cluster_status(runas=None)</h3> <dd>
<p>return rabbitmq cluster_status</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.cluster_status</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.delete_policy"> salt.modules.rabbitmq.delete_policy(vhost, name, runas=None)</h3> <dd>
<p>Delete a policy based on rabbitmqctl clear_policy.</p> <p>Reference: <a class="reference external" href="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</a></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.delete_policy / HA</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.delete_upstream"> salt.modules.rabbitmq.delete_upstream(name, runas=None)</h3> <dd>
<p>Deletes an upstream via rabbitmqctl clear_parameter.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the upstream to delete.</p></li> <li><p><strong>runas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the user to run the command as.</p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.delete_upstream upstream_name</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.delete_user"> salt.modules.rabbitmq.delete_user(name, runas=None)</h3> <dd>
<p>Deletes a user via rabbitmqctl delete_user.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.delete_user rabbit_user</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.delete_vhost"> salt.modules.rabbitmq.delete_vhost(vhost, runas=None)</h3> <dd>
<p>Deletes a vhost rabbitmqctl delete_vhost.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.delete_vhost '&lt;vhost_name&gt;'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.disable_plugin"> salt.modules.rabbitmq.disable_plugin(name, runas=None)</h3> <dd>
<p>Disable a RabbitMQ plugin via the rabbitmq-plugins command.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.disable_plugin foo</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.enable_plugin"> salt.modules.rabbitmq.enable_plugin(name, runas=None)</h3> <dd>
<p>Enable a RabbitMQ plugin via the rabbitmq-plugins command.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.enable_plugin foo</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.force_reset"> salt.modules.rabbitmq.force_reset(runas=None)</h3> <dd>
<p>Forcefully Return a RabbitMQ node to its virgin state</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.force_reset</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.join_cluster"> salt.modules.rabbitmq.join_cluster(host, user='rabbit', ram_node=None, runas=None)</h3> <dd>
<p>Join a rabbit cluster</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.join_cluster rabbit.example.com rabbit</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_available_plugins"> salt.modules.rabbitmq.list_available_plugins(runas=None)</h3> <dd>
<p>Returns a list of the names of all available plugins (enabled and disabled).</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_available_plugins</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_enabled_plugins"> salt.modules.rabbitmq.list_enabled_plugins(runas=None)</h3> <dd>
<p>Returns a list of the names of the enabled plugins.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_enabled_plugins</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_permissions"> salt.modules.rabbitmq.list_permissions(vhost, runas=None)</h3> <dd>
<p>Lists permissions for vhost via rabbitmqctl list_permissions</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_permissions /myvhost</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_policies"> salt.modules.rabbitmq.list_policies(vhost='/', runas=None)</h3> <dd>
<p>Return a dictionary of policies nested by vhost and name based on the data returned from rabbitmqctl list_policies.</p> <p>Reference: <a class="reference external" href="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</a></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_policies</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_queues"> salt.modules.rabbitmq.list_queues(runas=None, *args)</h3> <dd>
<p>Returns queue details of the / virtual host</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_queues messages consumers</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_queues_vhost"> salt.modules.rabbitmq.list_queues_vhost(vhost, runas=None, *args)</h3> <dd>
<p>Returns queue details of specified virtual host. This command will consider first parameter as the vhost name and rest will be treated as queueinfoitem. For getting details on vhost <code class="docutils literal notranslate"><span class="pre">/</span></code>, use <a class="reference internal" href="#salt.modules.rabbitmq.list_queues" title="salt.modules.rabbitmq.list_queues"><code class="xref py py-mod docutils literal notranslate"><span class="pre">list_queues</span></code></a> instead).</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_queues messages consumers</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_upstreams"> salt.modules.rabbitmq.list_upstreams(runas=None)</h3> <dd>
<p>Returns a dict of upstreams based on rabbitmqctl list_parameters.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>runas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the user to run this command as.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_upstreams</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_user_permissions"> salt.modules.rabbitmq.list_user_permissions(name, runas=None)</h3> <dd>
<p>List permissions for a user via rabbitmqctl list_user_permissions</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_user_permissions user</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_users"> salt.modules.rabbitmq.list_users(runas=None)</h3> <dd>
<p>Return a list of users based off of rabbitmqctl user_list.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_users</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.list_vhosts"> salt.modules.rabbitmq.list_vhosts(runas=None)</h3> <dd>
<p>Return a list of vhost based on rabbitmqctl list_vhosts.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.list_vhosts</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.plugin_is_enabled"> salt.modules.rabbitmq.plugin_is_enabled(name, runas=None)</h3> <dd>
<p>Return whether the plugin is enabled.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.plugin_is_enabled rabbitmq_plugin_name</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.policy_exists"> salt.modules.rabbitmq.policy_exists(vhost, name, runas=None)</h3> <dd>
<p>Return whether the policy exists based on rabbitmqctl list_policies.</p> <p>Reference: <a class="reference external" href="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</a></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.policy_exists / HA</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.reset"> salt.modules.rabbitmq.reset(runas=None)</h3> <dd>
<p>Return a RabbitMQ node to its virgin state</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.reset</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.set_permissions"> salt.modules.rabbitmq.set_permissions(vhost, user, conf='.*', write='.*', read='.*', runas=None)</h3> <dd>
<p>Sets permissions for vhost via rabbitmqctl set_permissions</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.set_permissions myvhost myuser</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.set_policy"> salt.modules.rabbitmq.set_policy(vhost, name, pattern, definition, priority=None, runas=None, apply_to=None)</h3> <dd>
<p>Set a policy based on rabbitmqctl set_policy.</p> <p>Reference: <a class="reference external" href="http://www.rabbitmq.com/ha.html">http://www.rabbitmq.com/ha.html</a></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.set_policy / HA '.*' '{"ha-mode":"all"}'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.set_upstream"> salt.modules.rabbitmq.set_upstream(name, uri, prefetch_count=None, reconnect_delay=None, ack_mode=None, trust_user_id=None, exchange=None, max_hops=None, expires=None, message_ttl=None, ha_policy=None, queue=None, runas=None)</h3> <dd>
<p>Configures an upstream via rabbitmqctl set_parameter. This can be an exchange-upstream, a queue-upstream or both.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the upstream to configure.</p> </dd> </dl> <p>The following parameters apply to federated exchanges and federated queues:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>uri</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The AMQP URI(s) for the upstream.</p></li> <li><p><strong>prefetch_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) -- The maximum number of unacknowledged messages copied over a link at any one time. Default: 1000</p></li> <li><p><strong>reconnect_delay</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) -- The duration (in seconds) to wait before reconnecting to the broker after being disconnected. Default: 1</p></li> <li><p><strong>ack_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- Determines how the link should acknowledge messages. If set to <code class="docutils literal notranslate"><span class="pre">on-confirm</span></code> (the default), messages are acknowledged to the upstream broker after they have been confirmed downstream. This handles network errors and broker failures without losing messages, and is the slowest option. If set to <code class="docutils literal notranslate"><span class="pre">on-publish</span></code>, messages are acknowledged to the upstream broker after they have been published downstream. This handles network errors without losing messages, but may lose messages in the event of broker failures. If set to <code class="docutils literal notranslate"><span class="pre">no-ack</span></code>, message acknowledgements are not used. This is the fastest option, but may lose messages in the event of network or broker failures.</p></li> <li><p><strong>trust_user_id</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Determines how federation should interact with the validated user-id feature. If set to true, federation will pass through any validated user-id from the upstream, even though it cannot validate it itself. If set to false or not set, it will clear any validated user-id it encounters. You should only set this to true if you trust the upstream server (and by extension, all its upstreams) not to forge user-ids.</p></li> </ul> </dd> </dl> <p>The following parameters apply to federated exchanges only:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>exchange</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the upstream exchange. Default is to use the same name as the federated exchange.</p></li> <li><p><strong>max_hops</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) -- The maximum number of federation links that a message published to a federated exchange can traverse before it is discarded. Default is 1. Note that even if max-hops is set to a value greater than 1, messages will never visit the same node twice due to travelling in a loop. However, messages may still be duplicated if it is possible for them to travel from the source to the destination via multiple routes.</p></li> <li><p><strong>expires</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) -- The expiry time (in milliseconds) after which an upstream queue for a federated exchange may be deleted, if a connection to the upstream broker is lost. The default is 'none', meaning the queue should never expire. This setting controls how long the upstream queue will last before it is eligible for deletion if the connection is lost. This value is used to set the "x-expires" argument for the upstream queue.</p></li> <li><p><strong>message_ttl</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) -- The expiry time for messages in the upstream queue for a federated exchange (see expires), in milliseconds. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning messages should never expire. This does not apply to federated queues. This value is used to set the "x-message-ttl" argument for the upstream queue.</p></li> <li><p><strong>ha_policy</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- Determines the "x-ha-policy" argument for the upstream queue for a federated exchange (see expires). This is only of interest when connecting to old brokers which determine queue HA mode using this argument. Default is <code class="docutils literal notranslate"><span class="pre">None</span></code>, meaning the queue is not HA.</p></li> </ul> </dd> </dl> <p>The following parameter applies to federated queues only:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>queue</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the upstream queue. Default is to use the same name as the federated queue.</p></li> <li><p><strong>runas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the user to run the command as.</p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.set_upstream upstream_name ack_mode=on-confirm max_hops=1             trust_user_id=True uri=amqp://hostname</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.set_user_tags"> salt.modules.rabbitmq.set_user_tags(name, tags, runas=None)</h3> <dd>
<p>Add user tags via rabbitmqctl set_user_tags</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.set_user_tags myadmin administrator</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.start_app"> salt.modules.rabbitmq.start_app(runas=None)</h3> <dd>
<p>Start the RabbitMQ application.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.start_app</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.status"> salt.modules.rabbitmq.status(runas=None)</h3> <dd>
<p>return rabbitmq status</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.status</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.stop_app"> salt.modules.rabbitmq.stop_app(runas=None)</h3> <dd>
<p>Stops the RabbitMQ application, leaving the Erlang node running.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.stop_app</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.upstream_exists"> salt.modules.rabbitmq.upstream_exists(name, runas=None)</h3> <dd>
<p>Return whether the upstreamexists based on rabbitmqctl list_parameters.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the upstream to check for.</p></li> <li><p><strong>runas</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the user to run the command as.</p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.upstream_exists rabbit_upstream</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.user_exists"> salt.modules.rabbitmq.user_exists(name, runas=None)</h3> <dd>
<p>Return whether the user exists based on rabbitmqctl list_users.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.user_exists rabbit_user</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.rabbitmq.vhost_exists"> salt.modules.rabbitmq.vhost_exists(name, runas=None)</h3> <dd>
<p>Return whether the vhost exists based on rabbitmqctl list_vhosts.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' rabbitmq.vhost_exists rabbit_host</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.rabbitmq.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.rabbitmq.html</a>
  </p>
</div>
