<h1>salt.modules.win_task</h1> <p>Windows Task Scheduler Module .. versionadded:: 2016.3.0</p> <p>A module for working with the Windows Task Scheduler. You can add and edit existing tasks. You can add and clear triggers and actions. You can list all tasks, folders, triggers, and actions.</p> <dl class="py function"> <h3 id="salt.modules.win_task.add_action"> salt.modules.win_task.add_action(name=None, location='\\', action_type='Execute', **kwargs)</h3> <dd>
<p>Add an action to a task.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task to which to add the action.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> <li>
<p><strong>action_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The type of action to add. There are three action types. Each one requires its own set of Keyword Arguments (kwargs). Valid values are:</p> <blockquote> <div>
<ul> <li><p>Execute</p></li> <li><p>Email</p></li> <li><p>Message</p></li> </ul> </div>
</blockquote> </li> </ul> </dd> </dl> <p>Required arguments for each action_type:</p> <p><strong>Execute</strong></p> <blockquote> <div>
<p>Execute a command or an executable</p> <blockquote> <div>
<dl> <dt>cmd (str):</dt>
<dd>
<p>(required) The command or executable to run.</p> </dd> <dt>arguments (str):</dt>
<dd>
<p>(optional) Arguments to be passed to the command or executable. To launch a script the first command will need to be the interpreter for the script. For example, to run a vbscript you would pass <code class="docutils literal notranslate"><span class="pre">cscript.exe</span></code> in the <code class="docutils literal notranslate"><span class="pre">cmd</span></code> parameter and pass the script in the <code class="docutils literal notranslate"><span class="pre">arguments</span></code> parameter as follows:</p> <blockquote> <div>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">cmd='cscript.exe'</span> <span class="pre">arguments='c:\scripts\myscript.vbs'</span></code></p></li> </ul> </div>
</blockquote> <p>Batch files do not need an interpreter and may be passed to the cmd parameter directly.</p> </dd> <dt>start_in (str):</dt>
<dd>
<p>(optional) The current working directory for the command.</p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><strong>Email</strong></p> <blockquote> <div>
<p>Send and email. Requires <code class="docutils literal notranslate"><span class="pre">server</span></code>, <code class="docutils literal notranslate"><span class="pre">from</span></code>, and <code class="docutils literal notranslate"><span class="pre">to</span></code> or <code class="docutils literal notranslate"><span class="pre">cc</span></code>.</p> <blockquote> <div>
<p>from (str): The sender</p> <p>reply_to (str): Who to reply to</p> <p>to (str): The recipient</p> <p>cc (str): The CC recipient</p> <p>bcc (str): The BCC recipient</p> <p>subject (str): The subject of the email</p> <p>body (str): The Message Body of the email</p> <p>server (str): The server used to send the email</p> <dl class="simple"> <dt>attachments (list):</dt>
<dd>
<p>A list of attachments. These will be the paths to the files to attach. ie: <code class="docutils literal notranslate"><span class="pre">attachments="['C:\attachment1.txt',</span>
<span class="pre">'C:\attachment2.txt']"</span></code></p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><strong>Message</strong></p> <blockquote> <div>
<p>Display a dialog box. The task must be set to "Run only when user is logged on" in order for the dialog box to display. Both parameters are required.</p> <blockquote> <div>
<dl class="simple"> <dt>title (str):</dt>
<dd>
<p>The dialog box title.</p> </dd> <dt>message (str):</dt>
<dd>
<p>The dialog box message body</p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary containing the task configuration</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.add_action &lt;task_name&gt; cmd='del /Q /S C:\\Temp'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.add_trigger"> salt.modules.win_task.add_trigger(name=None, location='\\', trigger_type=None, trigger_enabled=True, start_date=None, start_time=None, end_date=None, end_time=None, random_delay=None, repeat_interval=None, repeat_duration=None, repeat_stop_at_duration_end=False, execution_time_limit=None, delay=None, **kwargs)</h3> <dd>
<p>Add a trigger to a Windows Scheduled task</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Arguments are parsed by the YAML loader and are subject to yaml's idiosyncrasies. Therefore, time values in some formats (<code class="docutils literal notranslate"><span class="pre">%H:%M:%S</span></code> and <code class="docutils literal notranslate"><span class="pre">%H:%M</span></code>) should to be quoted. See <a class="reference external" href="https://docs.saltstack.com/en/latest/topics/troubleshooting/yaml_idiosyncrasies.html#time-expressions">YAML IDIOSYNCRASIES</a> for more details.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task to which to add the trigger.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> <li>
<p><strong>trigger_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The type of trigger to create. This is defined when the trigger is created and cannot be changed later. Options are as follows:</p> <blockquote> <div>
<ul> <li><p>Event</p></li> <li><p>Once</p></li> <li><p>Daily</p></li> <li><p>Weekly</p></li> <li><p>Monthly</p></li> <li><p>MonthlyDay</p></li> <li><p>OnIdle</p></li> <li><p>OnTaskCreation</p></li> <li><p>OnBoot</p></li> <li><p>OnLogon</p></li> <li><p>OnSessionChange</p></li> </ul> </div>
</blockquote> </li> <li><p><strong>trigger_enabled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates whether the trigger is enabled.</p></li> <li>
<p><strong>start_date</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The date when the trigger is activated. If no value is passed, the current date will be used. Can be one of the following formats:</p> <blockquote> <div>
<ul> <li><p>%Y-%m-%d</p></li> <li><p>%m-%d-%y</p></li> <li><p>%m-%d-%Y</p></li> <li><p>%m/%d/%y</p></li> <li><p>%m/%d/%Y</p></li> <li><p>%Y/%m/%d</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>start_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The time when the trigger is activated. If no value is passed, midnight will be used. Can be one of the following formats:</p> <blockquote> <div>
<ul> <li><p>%I:%M:%S %p</p></li> <li><p>%I:%M %p</p></li> <li><p>%H:%M:%S</p></li> <li><p>%H:%M</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>end_date</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The date when the trigger is deactivated. The trigger cannot start the task after it is deactivated. Can be one of the following formats:</p> <blockquote> <div>
<ul> <li><p>%Y-%m-%d</p></li> <li><p>%m-%d-%y</p></li> <li><p>%m-%d-%Y</p></li> <li><p>%m/%d/%y</p></li> <li><p>%m/%d/%Y</p></li> <li><p>%Y/%m/%d</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>end_time</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The time when the trigger is deactivated. If this is not passed with <code class="docutils literal notranslate"><span class="pre">end_date</span></code> it will be set to midnight. Can be one of the following formats:</p> <blockquote> <div>
<ul> <li><p>%I:%M:%S %p</p></li> <li><p>%I:%M %p</p></li> <li><p>%H:%M:%S</p></li> <li><p>%H:%M</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>random_delay</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The delay time that is randomly added to the start time of the trigger. Valid values are:</p> <blockquote> <div>
<ul> <li><p>30 seconds</p></li> <li><p>1 minute</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> <li><p>8 hours</p></li> <li><p>1 day</p></li> </ul> </div>
</blockquote> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This parameter applies to the following trigger types</p> <blockquote> <div>
<ul> <li><p>Once</p></li> <li><p>Daily</p></li> <li><p>Weekly</p></li> <li><p>Monthly</p></li> <li><p>MonthlyDay</p></li> </ul> </div>
</blockquote> </div> </li> <li>
<p><strong>repeat_interval</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The amount of time between each restart of the task. Valid values are:</p> <blockquote> <div>
<ul> <li><p>5 minutes</p></li> <li><p>10 minutes</p></li> <li><p>15 minutes</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>repeat_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>How long the pattern is repeated. Valid values are:</p> <blockquote> <div>
<ul> <li><p>Indefinitely</p></li> <li><p>15 minutes</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> <li><p>12 hours</p></li> <li><p>1 day</p></li> </ul> </div>
</blockquote> </li> <li><p><strong>repeat_stop_at_duration_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates if a running instance of the task is stopped at the end of the repetition pattern duration.</p></li> <li>
<p><strong>execution_time_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The maximum amount of time that the task launched by the trigger is allowed to run. Valid values are:</p> <blockquote> <div>
<ul> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> <li><p>2 hours</p></li> <li><p>4 hours</p></li> <li><p>8 hours</p></li> <li><p>12 hours</p></li> <li><p>1 day</p></li> <li><p>3 days (default)</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>delay</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The time the trigger waits after its activation to start the task. Valid values are:</p> <blockquote> <div>
<ul> <li><p>15 seconds</p></li> <li><p>30 seconds</p></li> <li><p>1 minute</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> <li><p>8 hours</p></li> <li><p>1 day</p></li> </ul> </div>
</blockquote> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This parameter applies to the following trigger types:</p> <blockquote> <div>
<ul> <li><p>OnLogon</p></li> <li><p>OnBoot</p></li> <li><p>Event</p></li> <li><p>OnTaskCreation</p></li> <li><p>OnSessionChange</p></li> </ul> </div>
</blockquote> </div> </li> </ul> </dd> </dl> <p><strong>kwargs</strong></p> <p>There are optional keyword arguments determined by the type of trigger being defined. They are as follows:</p> <p><em>Event</em></p> <blockquote> <div>
<p>The trigger will be fired by an event.</p> <blockquote> <div>
<dl class="simple"> <dt>subscription (str):</dt>
<dd>
<p>An event definition in xml format that fires the trigger. The easiest way to get this would is to create an event in Windows Task Scheduler and then copy the xml text.</p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><em>Once</em></p> <blockquote> <div>
<p>No special parameters required.</p> </div>
</blockquote> <p><em>Daily</em></p> <blockquote> <div>
<p>The task will run daily.</p> <blockquote> <div>
<dl class="simple"> <dt>days_interval (int):</dt>
<dd>
<p>The interval between days in the schedule. An interval of 1 produces a daily schedule. An interval of 2 produces an every-other day schedule. If no interval is specified, 1 is used. Valid entries are 1 - 999.</p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><em>Weekly</em></p> <blockquote> <div>
<p>The task will run weekly.</p> <blockquote> <div>
<dl class="simple"> <dt>weeks_interval (int):</dt>
<dd>
<p>The interval between weeks in the schedule. An interval of 1 produces a weekly schedule. An interval of 2 produces an every-other week schedule. If no interval is specified, 1 is used. Valid entries are 1 - 52.</p> </dd> <dt>days_of_week (list):</dt>
<dd>
<p>Sets the days of the week on which the task runs. Should be a list. ie: <code class="docutils literal notranslate"><span class="pre">['Monday','Wednesday','Friday']</span></code>. Valid entries are the names of the days of the week.</p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><em>Monthly</em></p> <blockquote> <div>
<p>The task will run monthly.</p> <blockquote> <div>
<dl> <dt>months_of_year (list):</dt>
<dd>
<p>Sets the months of the year during which the task runs. Should be a list. ie: <code class="docutils literal notranslate"><span class="pre">['January','July']</span></code>. Valid entries are the full names of all the months.</p> </dd> <dt>days_of_month (list):</dt>
<dd>
<p>Sets the days of the month during which the task runs. Should be a list. ie: <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">15,</span> <span class="pre">'Last']</span></code>. Options are all days of the month 1 - 31 and the word 'Last' to indicate the last day of the month.</p> </dd> <dt>last_day_of_month (bool):</dt>
<dd>
<p>Boolean value that indicates that the task runs on the last day of the month regardless of the actual date of that day.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>You can set the task to run on the last day of the month by either including the word 'Last' in the list of days, or setting the parameter 'last_day_of_month' equal to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> </div> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><em>MonthlyDay</em></p> <blockquote> <div>
<p>The task will run monthly on the specified day.</p> <blockquote> <div>
<dl> <dt>months_of_year (list):</dt>
<dd>
<p>Sets the months of the year during which the task runs. Should be a list. ie: <code class="docutils literal notranslate"><span class="pre">['January','July']</span></code>. Valid entries are the full names of all the months.</p> </dd> <dt>weeks_of_month (list):</dt>
<dd>
<p>Sets the weeks of the month during which the task runs. Should be a list. ie: <code class="docutils literal notranslate"><span class="pre">['First','Third']</span></code>. Valid options are:</p> <blockquote> <div>
<ul class="simple"> <li><p>First</p></li> <li><p>Second</p></li> <li><p>Third</p></li> <li><p>Fourth</p></li> </ul> </div>
</blockquote> </dd> <dt>last_week_of_month (bool):</dt>
<dd>
<p>Boolean value that indicates that the task runs on the last week of the month.</p> </dd> <dt>days_of_week (list):</dt>
<dd>
<p>Sets the days of the week during which the task runs. Should be a list. ie: <code class="docutils literal notranslate"><span class="pre">['Monday','Wednesday','Friday']</span></code>. Valid entries are the names of the days of the week.</p> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <p><em>OnIdle</em></p> <blockquote> <div>
<p>No special parameters required.</p> </div>
</blockquote> <p><em>OnTaskCreation</em></p> <blockquote> <div>
<p>No special parameters required.</p> </div>
</blockquote> <p><em>OnBoot</em></p> <blockquote> <div>
<p>No special parameters required.</p> </div>
</blockquote> <p><em>OnLogon</em></p> <blockquote> <div>
<p>No special parameters required.</p> </div>
</blockquote> <p><em>OnSessionChange</em></p> <blockquote> <div>
<p>The task will be triggered by a session change.</p> <blockquote> <div>
<dl> <dt>session_user_name (str):</dt>
<dd>
<p>Sets the user for the Terminal Server session. When a session state change is detected for this user, a task is started. To detect session status change for any user, do not pass this parameter.</p> </dd> <dt>state_change (str):</dt>
<dd>
<p>Sets the kind of Terminal Server session change that would trigger a task launch. Valid options are:</p> <blockquote> <div>
<ul class="simple"> <li><p>ConsoleConnect: When you connect to a user session (switch users)</p></li> <li><p>ConsoleDisconnect: When you disconnect a user session (switch users)</p></li> <li><p>RemoteConnect: When a user connects via Remote Desktop</p></li> <li><p>RemoteDisconnect: When a user disconnects via Remote Desktop</p></li> <li><p>SessionLock: When the workstation is locked</p></li> <li><p>SessionUnlock: When the workstation is unlocked</p></li> </ul> </div>
</blockquote> </dd> </dl> </div>
</blockquote> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.add_trigger &lt;task_name&gt; trigger_type=Once trigger_enabled=True start_date=2016/12/1 start_time='"12:01"'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.clear_triggers"> salt.modules.win_task.clear_triggers(name, location='\\')</h3> <dd>
<p>Remove all triggers from the task.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task from which to clear all triggers.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.clear_trigger &lt;task_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.create_folder"> salt.modules.win_task.create_folder(name, location='\\')</h3> <dd>
<p>Create a folder in which to create tasks.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the folder. This will be displayed in the task scheduler.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location in which to create the folder. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.create_folder &lt;folder_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.create_task"> salt.modules.win_task.create_task(name, location='\\', user_name='System', password=None, force=False, **kwargs)</h3> <dd>
<p>Create a new task in the designated location. This function has many keyword arguments that are not listed here. For additional arguments see:</p> <blockquote> <div>
<ul class="simple"> <li><p><a class="reference internal" href="#salt.modules.win_task.edit_task" title="salt.modules.win_task.edit_task"><code class="xref py py-func docutils literal notranslate"><span class="pre">edit_task()</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_task.add_action" title="salt.modules.win_task.add_action"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_action()</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_task.add_trigger" title="salt.modules.win_task.add_trigger"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_trigger()</span></code></a></p></li> </ul> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task. This will be displayed in the task scheduler.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location in which to create the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> <li><p><strong>user_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The user account under which to run the task. To specify the 'System' account, use 'System'. The password will be ignored.</p></li> <li><p><strong>password</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The password to use for authentication. This should set the task to run whether the user is logged in or not, but is currently not working.</p></li> <li><p><strong>force</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- If the task exists, overwrite the existing task.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.create_task &lt;task_name&gt; user_name=System force=True action_type=Execute cmd='del /Q /S C:\\Temp' trigger_type=Once start_date=2016-12-1 start_time=01:00</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.create_task_from_xml"> salt.modules.win_task.create_task_from_xml(name, location='\\', xml_text=None, xml_path=None, user_name='System', password=None)</h3> <dd>
<p>Create a task based on XML. Source can be a file or a string of XML.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task. This will be displayed in the task scheduler.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location in which to create the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> <li><p><strong>xml_text</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string of xml representing the task to be created. This will be overridden by <code class="docutils literal notranslate"><span class="pre">xml_path</span></code> if passed.</p></li> <li><p><strong>xml_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The path to an XML file on the local system containing the xml that defines the task. This will override <code class="docutils literal notranslate"><span class="pre">xml_text</span></code></p></li> <li><p><strong>user_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The user account under which to run the task. To specify the 'System' account, use 'System'. The password will be ignored.</p></li> <li><p><strong>password</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The password to use for authentication. This should set the task to run whether the user is logged in or not, but is currently not working.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code> str: A string with the error message if there is an error</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> <dt class="field-even">Raises</dt> <dd class="field-even">
<ul class="simple"> <li><p><a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/internals/salt.exceptions.html#salt.exceptions.ArgumentValueError" title="salt.exceptions.ArgumentValueError"><strong>ArgumentValueError</strong></a> -- If arguments are invalid</p></li> <li><p><a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/internals/salt.exceptions.html#salt.exceptions.CommandExecutionError" title="salt.exceptions.CommandExecutionError"><strong>CommandExecutionError</strong></a> -- </p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' task.create_task_from_xml &lt;task_name&gt; xml_path=C:\task.xml</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.delete_folder"> salt.modules.win_task.delete_folder(name, location='\\')</h3> <dd>
<p>Delete a folder from the task scheduler.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the folder to delete.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the folder. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.delete_folder &lt;folder_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.delete_task"> salt.modules.win_task.delete_task(name, location='\\')</h3> <dd>
<p>Delete a task from the task scheduler.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task to delete.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.delete_task &lt;task_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.edit_task"> salt.modules.win_task.edit_task(name=None, location='\\', user_name=None, password=None, description=None, enabled=None, hidden=None, run_if_idle=None, idle_duration=None, idle_wait_timeout=None, idle_stop_on_end=None, idle_restart=None, ac_only=None, stop_if_on_batteries=None, wake_to_run=None, run_if_network=None, network_id=None, network_name=None, allow_demand_start=None, start_when_available=None, restart_every=None, restart_count=3, execution_time_limit=None, force_stop=None, delete_after=None, multiple_instances=None, **kwargs)</h3> <dd>
<p>Edit the parameters of a task. Triggers and Actions cannot be edited yet.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task. This will be displayed in the task scheduler.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location in which to create the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> <li><p><strong>user_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The user account under which to run the task. To specify the 'System' account, use 'System'. The password will be ignored.</p></li> <li>
<p><strong>password</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The password to use for authentication. This should set the task to run whether the user is logged in or not, but is currently not working.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The combination of user_name and password determine how the task runs. For example, if a username is passed without at password the task will only run when the user is logged in. If a password is passed as well the task will run whether the user is logged on or not. If you pass 'System' as the username the task will run as the system account (the password parameter is ignored).</p> </div> </li> <li><p><strong>description</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string representing the text that will be displayed in the description field in the task scheduler.</p></li> <li><p><strong>enabled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- A boolean value representing whether or not the task is enabled.</p></li> <li><p><strong>hidden</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- A boolean value representing whether or not the task is hidden.</p></li> <li><p><strong>run_if_idle</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the Task Scheduler will run the task only if the computer is in an idle state.</p></li> <li>
<p><strong>idle_duration</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>A value that indicates the amount of time that the computer must be in an idle state before the task is run. Valid values are:</p> <blockquote> <div>
<ul> <li><p>1 minute</p></li> <li><p>5 minutes</p></li> <li><p>10 minutes</p></li> <li><p>15 minutes</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>idle_wait_timeout</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>A value that indicates the amount of time that the Task Scheduler will wait for an idle condition to occur. Valid values are:</p> <blockquote> <div>
<ul> <li><p>Do not wait</p></li> <li><p>1 minute</p></li> <li><p>5 minutes</p></li> <li><p>10 minutes</p></li> <li><p>15 minutes</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> <li><p>2 hours</p></li> </ul> </div>
</blockquote> </li> <li><p><strong>idle_stop_on_end</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the Task Scheduler will terminate the task if the idle condition ends before the task is completed.</p></li> <li><p><strong>idle_restart</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates whether the task is restarted when the computer cycles into an idle condition more than once.</p></li> <li><p><strong>ac_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the Task Scheduler will launch the task only while on AC power.</p></li> <li><p><strong>stop_if_on_batteries</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the task will be stopped if the computer begins to run on battery power.</p></li> <li><p><strong>wake_to_run</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the Task Scheduler will wake the computer when it is time to run the task.</p></li> <li><p><strong>run_if_network</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the Task Scheduler will run the task only when a network is available.</p></li> <li><p><strong>network_id</strong> (<em>guid</em>) -- GUID value that identifies a network profile.</p></li> <li><p><strong>network_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- Sets the name of a network profile. The name is used for display purposes.</p></li> <li><p><strong>allow_demand_start</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the task can be started by using either the Run command or the Context menu.</p></li> <li><p><strong>start_when_available</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the Task Scheduler can start the task at any time after its scheduled time has passed.</p></li> <li>
<p><strong>restart_every</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>A value that specifies the interval between task restart attempts. Valid values are:</p> <blockquote> <div>
<ul> <li><p>False (to disable)</p></li> <li><p>1 minute</p></li> <li><p>5 minutes</p></li> <li><p>10 minutes</p></li> <li><p>15 minutes</p></li> <li><p>30 minutes</p></li> <li><p>1 hour</p></li> <li><p>2 hours</p></li> </ul> </div>
</blockquote> </li> <li><p><strong>restart_count</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><em>int</em></a>) -- The number of times the Task Scheduler will attempt to restart the task. Valid values are integers 1 - 999.</p></li> <li>
<p><strong>execution_time_limit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The amount of time allowed to complete the task. Valid values are:</p> <blockquote> <div>
<ul> <li><p>False (to disable)</p></li> <li><p>1 hour</p></li> <li><p>2 hours</p></li> <li><p>4 hours</p></li> <li><p>8 hours</p></li> <li><p>12 hours</p></li> <li><p>1 day</p></li> <li><p>3 days</p></li> </ul> </div>
</blockquote> </li> <li><p><strong>force_stop</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value that indicates that the task may be terminated by using TerminateProcess.</p></li> <li>
<p><strong>delete_after</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>The amount of time that the Task Scheduler will wait before deleting the task after it expires. Requires a trigger with an expiration date. Valid values are:</p> <blockquote> <div>
<ul> <li><p>False (to disable)</p></li> <li><p>Immediately</p></li> <li><p>30 days</p></li> <li><p>90 days</p></li> <li><p>180 days</p></li> <li><p>365 days</p></li> </ul> </div>
</blockquote> </li> <li>
<p><strong>multiple_instances</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- </p>
<p>Sets the policy that defines how the Task Scheduler deals with multiple instances of the task. Valid values are:</p> <blockquote> <div>
<ul> <li><p>Parallel</p></li> <li><p>Queue</p></li> <li><p>No New Instance</p></li> <li><p>Stop Existing</p></li> </ul> </div>
</blockquote> </li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' task.edit_task &lt;task_name&gt; description='This task is awesome'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.info"> salt.modules.win_task.info(name, location='\\')</h3> <dd>
<p>Get the details about a task in the task scheduler.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task for which to return the status</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A dictionary containing the task configuration</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.info &lt;task_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.list_actions"> salt.modules.win_task.list_actions(name, location='\\')</h3> <dd>
<p>List all actions that pertain to a task in the specified location.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task for which list actions.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task from which to list actions. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns a list of actions.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash"># List all actions for a task in the default location
salt 'minion-id' task.list_actions &lt;task_name&gt;

# List all actions for the XblGameSaveTask in the Microsoft\XblGameSave
# location
salt 'minion-id' task.list_actions XblGameSaveTask Microsoft\XblGameSave</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.list_folders"> salt.modules.win_task.list_folders(location='\\')</h3> <dd>
<p>List all folders located in a specific location in the task scheduler.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the folder from which you want to list tasks. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns a list of folders.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash"># List all folders in the default location
salt 'minion-id' task.list_folders

# List all folders in the Microsoft directory
salt 'minion-id' task.list_folders Microsoft</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.list_tasks"> salt.modules.win_task.list_tasks(location='\\')</h3> <dd>
<p>List all tasks located in a specific location in the task scheduler.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the folder from which you want to list tasks. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns a list of tasks</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash"># List all tasks in the default location
salt 'minion-id' task.list_tasks

# List all tasks in the Microsoft\XblGameSave Directory
salt 'minion-id' task.list_tasks Microsoft\XblGameSave</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.list_triggers"> salt.modules.win_task.list_triggers(name, location='\\')</h3> <dd>
<p>List all triggers that pertain to a task in the specified location.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task for which list triggers.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task from which to list triggers. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Returns a list of triggers.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash"># List all triggers for a task in the default location
salt 'minion-id' task.list_triggers &lt;task_name&gt;

# List all triggers for the XblGameSaveTask in the Microsoft\XblGameSave
# location
salt '*' task.list_triggers XblGameSaveTask Microsoft\XblGameSave</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.run"> salt.modules.win_task.run(name, location='\\')</h3> <dd>
<p>Run a scheduled task manually.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task to run.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.run &lt;task_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.run_wait"> salt.modules.win_task.run_wait(name, location='\\')</h3> <dd>
<p>Run a scheduled task and return when the task finishes</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task to run.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.run_wait &lt;task_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.status"> salt.modules.win_task.status(name, location='\\')</h3> <dd>
<p>Determine the status of a task. Is it Running, Queued, Ready, etc.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task for which to return the status</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">

<p>The current status of the task. Will be one of the following:</p> <blockquote> <div>
<ul class="simple"> <li><p>Unknown</p></li> <li><p>Disabled</p></li> <li><p>Queued</p></li> <li><p>Ready</p></li> <li><p>Running</p></li> </ul> </div>
</blockquote> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.list_status &lt;task_name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_task.stop"> salt.modules.win_task.stop(name, location='\\')</h3> <dd>
<p>Stop a scheduled task.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the task to stop.</p></li> <li><p><strong>location</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A string value representing the location of the task. Default is <code class="docutils literal notranslate"><span class="pre">\</span></code> which is the root for the task scheduler (<code class="docutils literal notranslate"><span class="pre">C:\Windows\System32\tasks</span></code>).</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'minion-id' task.list_stop &lt;task_name&gt;</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_task.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_task.html</a>
  </p>
</div>
