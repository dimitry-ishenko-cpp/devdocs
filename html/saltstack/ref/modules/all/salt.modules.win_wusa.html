<h1>salt.modules.win_wusa</h1> <p>Microsoft Update files management via wusa.exe</p> <dl class="field-list simple"> <dt class="field-odd">maintainer</dt> <dd class="field-odd">
<p>Thomas Lemarchand</p> </dd> <dt class="field-even">platform</dt> <dd class="field-even">
<p>Windows</p> </dd> <dt class="field-odd">depends</dt> <dd class="field-odd">
<p>PowerShell</p> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2018.3.4.</span></p> </div> <dl class="py function"> <h3 id="salt.modules.win_wusa.install"> salt.modules.win_wusa.install(path, restart=False)</h3> <dd>
<p>Install a KB from a .msu file.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The full path to the msu file to install</p></li> <li><p><strong>restart</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- <code class="docutils literal notranslate"><span class="pre">True</span></code> to force a restart if required by the installation. Adds the <code class="docutils literal notranslate"><span class="pre">/forcerestart</span></code> switch to the <code class="docutils literal notranslate"><span class="pre">wusa.exe</span></code> command. <code class="docutils literal notranslate"><span class="pre">False</span></code> will add the <code class="docutils literal notranslate"><span class="pre">/norestart</span></code> switch instead. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <dl class="simple"> <dt>Raise:</dt>
<dd>
<dl class="simple"> <dt>CommandExecutionError: If the package is already installed or an error</dt>
<dd>
<p>is encountered</p> </dd> </dl> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' wusa.install C:/temp/KB123456.msu</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_wusa.is_installed"> salt.modules.win_wusa.is_installed(name)</h3> <dd>
<p>Check if a specific KB is installed.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the KB to check</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if installed, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' wusa.is_installed KB123456</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_wusa.list"> salt.modules.win_wusa.list()</h3> <dd>
<p>Get a list of updates installed on the machine</p> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A list of installed updates</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' wusa.list</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_wusa.uninstall"> salt.modules.win_wusa.uninstall(path, restart=False)</h3> <dd>
<p>Uninstall a specific KB.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The full path to the msu file to uninstall. This can also be just the name of the KB to uninstall</p></li> <li><p><strong>restart</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- <code class="docutils literal notranslate"><span class="pre">True</span></code> to force a restart if required by the installation. Adds the <code class="docutils literal notranslate"><span class="pre">/forcerestart</span></code> switch to the <code class="docutils literal notranslate"><span class="pre">wusa.exe</span></code> command. <code class="docutils literal notranslate"><span class="pre">False</span></code> will add the <code class="docutils literal notranslate"><span class="pre">/norestart</span></code> switch instead. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code></p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> if successful, otherwise <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> <dt class="field-even">Raises</dt> <dd class="field-even">
<p><a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/internals/salt.exceptions.html#salt.exceptions.CommandExecutionError" title="salt.exceptions.CommandExecutionError"><strong>CommandExecutionError</strong></a> -- If an error is encountered</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' wusa.uninstall KB123456

# or

salt '*' wusa.uninstall C:/temp/KB123456.msu</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_wusa.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_wusa.html</a>
  </p>
</div>
