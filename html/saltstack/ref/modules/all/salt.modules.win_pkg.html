<h1>salt.modules.win_pkg</h1> <p>A module to manage software on Windows</p> <div class="admonition important"> <p class="admonition-title">Important</p> <p>If you feel that Salt should be using this module to manage packages on a minion, and it is using a different module (or gives an error similar to <em>'pkg.install' is not available</em>), see <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/modules/index.html#module-provider-override"><span class="std std-ref">here</span></a>.</p> </div> <p>The following functions require the existence of a <a class="reference internal" href="https://docs.saltproject.io/en/latest/topics/windows/windows-package-manager.html#windows-package-manager"><span class="std std-ref">windows repository</span></a> metadata DB, typically created by running <a class="reference internal" href="#salt.modules.win_pkg.refresh_db" title="salt.modules.win_pkg.refresh_db"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.refresh_db</span></code></a>:</p> <ul class="simple"> <li><p><a class="reference internal" href="#salt.modules.win_pkg.get_repo_data" title="salt.modules.win_pkg.get_repo_data"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.get_repo_data</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_pkg.install" title="salt.modules.win_pkg.install"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.install</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_pkg.latest_version" title="salt.modules.win_pkg.latest_version"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.latest_version</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_pkg.list_available" title="salt.modules.win_pkg.list_available"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.list_available</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_pkg.list_pkgs" title="salt.modules.win_pkg.list_pkgs"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.list_pkgs</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_pkg.list_upgrades" title="salt.modules.win_pkg.list_upgrades"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.list_upgrades</span></code></a></p></li> <li><p><a class="reference internal" href="#salt.modules.win_pkg.remove" title="salt.modules.win_pkg.remove"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.remove</span></code></a></p></li> </ul> <p>If a metadata DB does not already exist and one of these functions is run, then one will be created from the repo SLS files that are present.</p> <p>As the creation of this metadata can take some time, the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-winrepo_cache_expire_min"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">winrepo_cache_expire_min</span></code></a> minion config option can be used to suppress refreshes when the metadata is less than a given number of seconds old.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Version numbers can be <code class="docutils literal notranslate"><span class="pre">version</span> <span class="pre">number</span> <span class="pre">string</span></code>, <code class="docutils literal notranslate"><span class="pre">latest</span></code> and <code class="docutils literal notranslate"><span class="pre">Not</span>
<span class="pre">Found</span></code>, where <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">Found</span></code> means this module was not able to determine the version of the software installed, it can also be used as the version number in sls definitions file in these cases. Versions numbers are sorted in order of 0, <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">Found</span></code>, <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">version</span> <span class="pre">numbers</span></code>, ..., <code class="docutils literal notranslate"><span class="pre">latest</span></code>.</p> </div> <dl class="py function"> <h3 id="salt.modules.win_pkg.compare_versions"> salt.modules.win_pkg.compare_versions(ver1='', oper='==', ver2='')</h3> <dd>
<p>Compare software package versions. Made public for use with Jinja</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>ver1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A software version to compare</p></li> <li><p><strong>oper</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The operand to use to compare</p></li> <li><p><strong>ver2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A software version to compare</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>True if the comparison is valid, otherwise False</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.compare_versions 1.2 &gt;= 1.3</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.genrepo"> salt.modules.win_pkg.genrepo(**kwargs)</h3> <dd>
<p>Generate package metadata db based on files within the winrepo_source_dir</p> <p>Kwargs:</p> <blockquote> <div>
<p>saltenv (str): Salt environment. Default: <code class="docutils literal notranslate"><span class="pre">base</span></code></p> <dl class="simple"> <dt>verbose (bool):</dt>
<dd>
<p>Return verbose data structure which includes 'success_list', a list of all sls files and the package names contained within. Default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p> </dd> <dt>failhard (bool):</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an error will be raised if any repo SLS files failed to process. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, no error will be raised, and a dictionary containing the full results will be returned.</p> </dd> </dl> </div>
</blockquote> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li><p>Hidden directories (directories beginning with '<cite>.</cite>', such as '<cite>.git</cite>') will be ignored.</p></li> </ul> </div> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary of the results of the command</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-run pkg.genrepo
salt -G 'os:windows' pkg.genrepo verbose=true failhard=false
salt -G 'os:windows' pkg.genrepo saltenv=base</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.get_package_info"> salt.modules.win_pkg.get_package_info(name, saltenv='base')</h3> <dd>
<p>Return package info. Returns empty map if package not available.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.get_repo_data"> salt.modules.win_pkg.get_repo_data(saltenv='base')</h3> <dd>
<p>Returns the existing package metadata db. Will create it, if it does not exist, however will not refresh it.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>saltenv</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- Salt environment. Default <code class="docutils literal notranslate"><span class="pre">base</span></code></p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A dict containing contents of metadata db.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.get_repo_data</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.install"> salt.modules.win_pkg.install(name=None, refresh=False, pkgs=None, **kwargs)</h3> <dd>
<p>Install the passed package(s) on the system using winrepo</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of a single package, or a comma-separated list of packages to install. (no spaces after the commas)</p></li> <li><p><strong>refresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Boolean value representing whether or not to refresh the winrepo db. Default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li> <li>
<p><strong>pkgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) -- </p>
<p>A list of packages to install from a software repository. All packages listed under <code class="docutils literal notranslate"><span class="pre">pkgs</span></code> will be installed via a single command.</p> <p>You can specify a version by passing the item as a dict:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash"># will install the latest version of foo and bar
salt '*' pkg.install pkgs='["foo", "bar"]'

# will install the latest version of foo and version 1.2.3 of bar
salt '*' pkg.install pkgs='["foo", {"bar": "1.2.3"}]'</pre> </li> </ul> </dd> </dl> <p>Kwargs:</p> <blockquote> <div>
<dl> <dt>version (str):</dt>
<dd>
<p>The specific version to install. If omitted, the latest version will be installed. Recommend for use when installing a single package.</p> <p>If passed with a list of packages in the <code class="docutils literal notranslate"><span class="pre">pkgs</span></code> parameter, the version will be ignored.</p> <p>CLI Example:</p> <blockquote> <div>
<pre class="highlight-bash notranslate" data-language="bash"># Version is ignored
salt '*' pkg.install pkgs="['foo', 'bar']" version=1.2.3</pre> </div>
</blockquote> <p>If passed with a comma separated list in the <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter, the version will apply to all packages in the list.</p> <p>CLI Example:</p> <blockquote> <div>
<pre class="highlight-bash notranslate" data-language="bash"># Version 1.2.3 will apply to packages foo and bar
salt '*' pkg.install foo,bar version=1.2.3</pre> </div>
</blockquote> </dd> <dt>extra_install_flags (str):</dt>
<dd>
<p>Additional install flags that will be appended to the <code class="docutils literal notranslate"><span class="pre">install_flags</span></code> defined in the software definition file. Only applies when single package is passed.</p> </dd> <dt>saltenv (str):</dt>
<dd>
<p>Salt environment. Default 'base'</p> </dd> <dt>report_reboot_exit_codes (bool):</dt>
<dd>
<p>If the installer exits with a recognized exit code indicating that a reboot is required, the module function</p> <blockquote> <div>
<p><em>win_system.set_reboot_required_witnessed</em></p> </div>
</blockquote> <p>will be called, preserving the knowledge of this event for the remainder of the current boot session. For the time being, 3010 is the only recognized exit code. The value of this param defaults to True.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> </dd> </dl> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">

<p>Return a dict containing the new package names and versions. If the package is already installed, an empty dict is returned.</p> <p>If the package is installed by <code class="docutils literal notranslate"><span class="pre">pkg.install</span></code>:</p> <pre class="highlight-cfg notranslate" data-language="cfg">{'&lt;package&gt;': {'old': '&lt;old-version&gt;',
               'new': '&lt;new-version&gt;'}}</pre> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>The following example will refresh the winrepo and install a single package, 7zip.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.install 7zip refresh=True</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.install 7zip
salt '*' pkg.install 7zip,filezilla
salt '*' pkg.install pkgs='["7zip","filezilla"]'</pre> <p>WinRepo Definition File Examples:</p> <p>The following example demonstrates the use of <code class="docutils literal notranslate"><span class="pre">cache_file</span></code>. This would be used if you have multiple installers in the same directory that use the same <code class="docutils literal notranslate"><span class="pre">install.ini</span></code> file and you don't want to download the additional installers.</p> <pre class="highlight-bash notranslate" data-language="bash">ntp:
  4.2.8:
    installer: 'salt://win/repo/ntp/ntp-4.2.8-win32-setup.exe'
    full_name: Meinberg NTP Windows Client
    locale: en_US
    reboot: False
    cache_file: 'salt://win/repo/ntp/install.ini'
    install_flags: '/USEFILE=C:\salt\var\cache\salt\minion\files\base\win\repo\ntp\install.ini'
    uninstaller: 'NTP/uninst.exe'</pre> <p>The following example demonstrates the use of <code class="docutils literal notranslate"><span class="pre">cache_dir</span></code>. It assumes a file named <code class="docutils literal notranslate"><span class="pre">install.ini</span></code> resides in the same directory as the installer.</p> <pre class="highlight-bash notranslate" data-language="bash">ntp:
  4.2.8:
    installer: 'salt://win/repo/ntp/ntp-4.2.8-win32-setup.exe'
    full_name: Meinberg NTP Windows Client
    locale: en_US
    reboot: False
    cache_dir: True
    install_flags: '/USEFILE=C:\salt\var\cache\salt\minion\files\base\win\repo\ntp\install.ini'
    uninstaller: 'NTP/uninst.exe'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.latest_version"> salt.modules.win_pkg.latest_version(*names, **kwargs)</h3> <dd>
<p>Return the latest version of the named package available for upgrade or installation. If more than one package name is specified, a dict of name/version pairs is returned.</p> <p>If the latest version of a given package is already installed, an empty string will be returned for that package.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Since this is looking for the latest version available, a refresh_db will be triggered by default. This can take some time. To avoid this set <code class="docutils literal notranslate"><span class="pre">refresh</span></code> to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- A single or multiple names to lookup</p> </dd> </dl> <dl class="simple"> <dt>Kwargs:</dt>
<dd>
<p>saltenv (str): Salt environment. Default <code class="docutils literal notranslate"><span class="pre">base</span></code> refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p> </dd> </dl> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary of packages with the latest version available</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.latest_version &lt;package name&gt;
salt '*' pkg.latest_version &lt;package1&gt; &lt;package2&gt; &lt;package3&gt; ...</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.list_available"> salt.modules.win_pkg.list_available(*names, **kwargs)</h3> <dd>
<p>Return a list of available versions of the specified package.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>names</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- One or more package names</p> </dd> </dl> <p>Kwargs:</p> <blockquote> <div>
<p>saltenv (str): The salt environment to use. Default <code class="docutils literal notranslate"><span class="pre">base</span></code>.</p> <p>refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p> <dl class="simple"> <dt>return_dict_always (bool):</dt>
<dd>
<p>Default <code class="docutils literal notranslate"><span class="pre">False</span></code> dict when a single package name is queried.</p> </dd> </dl> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>The package name with its available versions</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <pre class="highlight-cfg notranslate" data-language="cfg">{'&lt;package name&gt;': ['&lt;version&gt;', '&lt;version&gt;', ]}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_available &lt;package name&gt; return_dict_always=True
salt '*' pkg.list_available &lt;package name01&gt; &lt;package name02&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.list_pkgs"> salt.modules.win_pkg.list_pkgs(versions_as_list=False, include_components=True, include_updates=True, **kwargs)</h3> <dd>
<p>List the packages currently installed.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To view installed software as displayed in the Add/Remove Programs, set <code class="docutils literal notranslate"><span class="pre">include_components</span></code> and <code class="docutils literal notranslate"><span class="pre">include_updates</span></code> to False.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>versions_as_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Returns the versions as a list</p></li> <li><p><strong>include_components</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Include sub components of installed software. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li> <li><p><strong>include_updates</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Include software updates and Windows updates. Default is <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li> </ul> </dd> </dl> <p>Kwargs:</p> <blockquote> <div>
<dl class="simple"> <dt>saltenv (str):</dt>
<dd>
<p>The salt environment to use. Default <code class="docutils literal notranslate"><span class="pre">base</span></code></p> </dd> <dt>refresh (bool):</dt>
<dd>
<p>Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> </dl> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary of installed software with versions installed</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <pre class="highlight-cfg notranslate" data-language="cfg">{'&lt;package_name&gt;': '&lt;version&gt;'}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_pkgs
salt '*' pkg.list_pkgs versions_as_list=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.list_upgrades"> salt.modules.win_pkg.list_upgrades(refresh=True, **kwargs)</h3> <dd>
<p>List all available package upgrades on this system</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>refresh</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">True</span></code></p> </dd> </dl> <dl class="simple"> <dt>Kwargs:</dt>
<dd>
<p>saltenv (str): Salt environment. Default <code class="docutils literal notranslate"><span class="pre">base</span></code></p> </dd> </dl> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary of packages with available upgrades</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.list_upgrades</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.purge"> salt.modules.win_pkg.purge(name=None, pkgs=None, **kwargs)</h3> <dd>
<p>Package purges are not supported on Windows, this function is identical to <code class="docutils literal notranslate"><span class="pre">remove()</span></code>.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>At some point in the future, <code class="docutils literal notranslate"><span class="pre">pkg.purge</span></code> may direct the installer to remove all configs and settings for software packages that support that option.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.16.0.</span></p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the package to be deleted.</p></li> <li><p><strong>version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The version of the package to be deleted. If this option is used in combination with the <code class="docutils literal notranslate"><span class="pre">pkgs</span></code> option below, then this version will be applied to all targeted packages.</p></li> <li><p><strong>pkgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) -- A list of packages to delete. Must be passed as a python list. The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter will be ignored if this option is passed.</p></li> </ul> </dd> </dl> <dl class="simple"> <dt>Kwargs:</dt>
<dd>
<p>saltenv (str): Salt environment. Default <code class="docutils literal notranslate"><span class="pre">base</span></code> refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </dd> </dl> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dict containing the changes.</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.purge &lt;package name&gt;
salt '*' pkg.purge &lt;package1&gt;,&lt;package2&gt;,&lt;package3&gt;
salt '*' pkg.purge pkgs='["foo", "bar"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.refresh_db"> salt.modules.win_pkg.refresh_db(**kwargs)</h3> <dd>
<p>Generates the local software metadata database (<cite>winrepo.p</cite>) on the minion. The database is stored in a serialized format located by default at the following location:</p> <p><code class="docutils literal notranslate"><span class="pre">C:\salt\var\cache\salt\minion\files\base\win\repo-ng\winrepo.p</span></code></p> <p>This module performs the following steps to generate the software metadata database:</p> <ul class="simple"> <li><p>Fetch the package definition files (.sls) from <cite>winrepo_source_dir</cite> (default <cite>salt://win/repo-ng</cite>) and cache them in <cite>&lt;cachedir&gt;files&lt;saltenv&gt;&lt;winrepo_source_dir&gt;</cite> (default: <code class="docutils literal notranslate"><span class="pre">C:\salt\var\cache\salt\minion\files\base\win\repo-ng</span></code>)</p></li> <li><p>Call <a class="reference internal" href="#salt.modules.win_pkg.genrepo" title="salt.modules.win_pkg.genrepo"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.genrepo</span></code></a> to parse the package definition files and generate the repository metadata database file (<cite>winrepo.p</cite>)</p></li> <li><p>Return the report received from <a class="reference internal" href="#salt.modules.win_pkg.genrepo" title="salt.modules.win_pkg.genrepo"><code class="xref py py-func docutils literal notranslate"><span class="pre">pkg.genrepo</span></code></a></p></li> </ul> <p>The default winrepo directory on the master is <cite>/srv/salt/win/repo-ng</cite>. All files that end with <cite>.sls</cite> in this and all subdirectories will be used to generate the repository metadata database (<cite>winrepo.p</cite>).</p> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li><p>Hidden directories (directories beginning with '<cite>.</cite>', such as '<cite>.git</cite>') will be ignored.</p></li> </ul> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>There is no need to call <cite>pkg.refresh_db</cite> every time you work with the pkg module. Automatic refresh will occur based on the following minion configuration settings:</p> <ul class="simple"> <li><p><cite>winrepo_cache_expire_min</cite></p></li> <li><p><cite>winrepo_cache_expire_max</cite></p></li> </ul> <p>However, if the package definition files have changed, as would be the case if you are developing a new package definition, this function should be called to ensure the minion has the latest information about packages available to it.</p> </div> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Directories and files fetched from &lt;winrepo_source_dir&gt; (<cite>/srv/salt/win/repo-ng</cite>) will be processed in alphabetical order. If two or more software definition files contain the same name, the last one processed replaces all data from the files processed before it.</p> </div> <p>For more information see <a class="reference internal" href="https://docs.saltproject.io/en/latest/topics/windows/windows-package-manager.html#windows-package-manager"><span class="std std-ref">Windows Software Repository</span></a></p> <p>Arguments:</p> <p>saltenv (str): Salt environment. Default: <code class="docutils literal notranslate"><span class="pre">base</span></code></p> <dl class="simple"> <dt>verbose (bool):</dt>
<dd>
<p>Return a verbose data structure which includes 'success_list', a list of all sls files and the package names contained within. Default is 'False'</p> </dd> <dt>failhard (bool):</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">True</span></code>, an error will be raised if any repo SLS files fails to process. If <code class="docutils literal notranslate"><span class="pre">False</span></code>, no error will be raised, and a dictionary containing the full results will be returned.</p> </dd> </dl> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary containing the results of the database refresh.</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <div class="admonition note"> <p class="admonition-title">Note</p> <p>A result with a <cite>total: 0</cite> generally means that the files are in the wrong location on the master. Try running the following command on the minion: <cite>salt-call -l debug pkg.refresh saltenv=base</cite></p> </div> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>When calling this command from a state using <cite>module.run</cite> be sure to pass <cite>failhard: False</cite>. Otherwise the state will report failure if it encounters a bad software definition file.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.refresh_db
salt '*' pkg.refresh_db saltenv=base</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.remove"> salt.modules.win_pkg.remove(name=None, pkgs=None, **kwargs)</h3> <dd>
<p>Remove the passed package(s) from the system using winrepo</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.16.0.</span></p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name(s) of the package(s) to be uninstalled. Can be a single package or a comma delimited list of packages, no spaces.</p></li> <li><p><strong>pkgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) -- A list of packages to delete. Must be passed as a python list. The <code class="docutils literal notranslate"><span class="pre">name</span></code> parameter will be ignored if this option is passed.</p></li> </ul> </dd> </dl> <p>Kwargs:</p> <blockquote> <div>
<dl class="simple"> <dt>version (str):</dt>
<dd>
<p>The version of the package to be uninstalled. If this option is used to to uninstall multiple packages, then this version will be applied to all targeted packages. Recommended using only when uninstalling a single package. If this parameter is omitted, the latest version will be uninstalled.</p> </dd> </dl> <p>saltenv (str): Salt environment. Default <code class="docutils literal notranslate"><span class="pre">base</span></code> refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">False</span></code></p> </div>
</blockquote> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">

<p>Returns a dict containing the changes.</p> <p>If the package is removed by <code class="docutils literal notranslate"><span class="pre">pkg.remove</span></code>:</p> <blockquote> <div>
<dl class="simple"> <dt>{'&lt;package&gt;': {'old': '&lt;old-version&gt;',</dt>
<dd>
<p>'new': '&lt;new-version&gt;'}}</p> </dd> </dl> </div>
</blockquote> <p>If the package is already uninstalled:</p> <blockquote> <div>
<p>{'&lt;package&gt;': {'current': 'not installed'}}</p> </div>
</blockquote> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.remove &lt;package name&gt;
salt '*' pkg.remove &lt;package1&gt;,&lt;package2&gt;,&lt;package3&gt;
salt '*' pkg.remove pkgs='["foo", "bar"]'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.upgrade"> salt.modules.win_pkg.upgrade(**kwargs)</h3> <dd>
<p>Upgrade all software. Currently not implemented</p> <dl class="simple"> <dt>Kwargs:</dt>
<dd>
<p>saltenv (str): The salt environment to use. Default <code class="docutils literal notranslate"><span class="pre">base</span></code>. refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> </dd> </dl> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This feature is not yet implemented for Windows.</p> </div> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>Empty dict, until implemented</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.upgrade_available"> salt.modules.win_pkg.upgrade_available(name, **kwargs)</h3> <dd>
<p>Check whether or not an upgrade is available for a given package</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of a single package</p> </dd> </dl> <dl class="simple"> <dt>Kwargs:</dt>
<dd>
<p>refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">True</span></code> saltenv (str): The salt environment. Default <code class="docutils literal notranslate"><span class="pre">base</span></code></p> </dd> </dl> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>True if new version available, otherwise False</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.upgrade_available &lt;package name&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pkg.version"> salt.modules.win_pkg.version(*names, **kwargs)</h3> <dd>
<p>Returns a string representing the package version or an empty string if not installed. If more than one package name is specified, a dict of name/version pairs is returned.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- One or more package names</p> </dd> </dl> <dl class="simple"> <dt>Kwargs:</dt>
<dd>
<p>saltenv (str): The salt environment to use. Default <code class="docutils literal notranslate"><span class="pre">base</span></code>. refresh (bool): Refresh package metadata. Default <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p> </dd> </dl> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>version string when a single package is specified. dict: The package name(s) with the installed versions.</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p> </dd> </dl> <pre class="highlight-cfg notranslate" data-language="cfg">{['&lt;version&gt;', '&lt;version&gt;', ]} OR
{'&lt;package name&gt;': ['&lt;version&gt;', '&lt;version&gt;', ]}</pre> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' pkg.version &lt;package name&gt;
salt '*' pkg.version &lt;package name01&gt; &lt;package name02&gt;</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_pkg.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_pkg.html</a>
  </p>
</div>
