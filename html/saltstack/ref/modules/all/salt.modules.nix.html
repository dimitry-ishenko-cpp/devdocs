<h1>salt.modules.nix</h1> <div class="section" id="work-with-nix-packages"> <h2>Work with Nix packages</h2> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> <p>Does not require the machine to be Nixos, just have Nix installed and available to use for the user running this command. Their profile must be located in their home, under <code class="docutils literal notranslate"><span class="pre">$HOME/.nix-profile/</span></code>, and the nix store, unless specially set up, should be in <code class="docutils literal notranslate"><span class="pre">/nix</span></code>. To easily use this with multiple users or a root user, set up the <a class="reference external" href="https://nixos.org/nix/manual/#ssec-multi-user">nix-daemon</a>.</p> <p>This module exposes most of the common nix operations. Currently not meant to be run as a <code class="docutils literal notranslate"><span class="pre">pkg</span></code> module, but explicitly as <code class="docutils literal notranslate"><span class="pre">nix.*</span></code>.</p> <p>For more information on nix, see the <a class="reference external" href="https://nixos.org/nix/manual/">nix documentation</a>.</p> <dl class="py function"> <h3 id="salt.modules.nix.collect_garbage"> salt.modules.nix.collect_garbage()</h3> <dd>
<p>Completely removed all currently 'uninstalled' packages in the nix store.</p> <p>Tells the user how many store paths were removed and how much space was freed.</p> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>How much space was freed and how many derivations were removed</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p> </dd> </dl> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>This is a destructive action on the nix store.</p> </div> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nix.collect_garbage</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.nix.install"> salt.modules.nix.install(*pkgs, **kwargs)</h3> <dd>
<p>Installs a single or multiple packages via nix</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>pkgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>)</em>) -- packages to update</p></li> <li><p><strong>attributes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Pass the list of packages or single package as attribues, not package names. default: False</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Installed packages. Example element: <code class="docutils literal notranslate"><span class="pre">gcc-3.3.2</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>)</p> </dd> </dl> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nix.install package [package2 ...]
salt '*' nix.install attributes=True attr.name [attr.name2 ...]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.nix.list_pkgs"> salt.modules.nix.list_pkgs(installed=True, attributes=True)</h3> <dd>
<p>Lists installed packages. Due to how nix works, it defaults to just doing a <code class="docutils literal notranslate"><span class="pre">nix-env</span> <span class="pre">-q</span></code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>installed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- list only installed packages. This can be a very long list (12,000+ elements), so caution is advised. Default: True</p></li> <li><p><strong>attributes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- show the attributes of the packages when listing all packages. Default: True</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Packages installed or available, along with their attributes.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>))</p> </dd> </dl> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nix.list_pkgs
salt '*' nix.list_pkgs installed=False</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.nix.uninstall"> salt.modules.nix.uninstall(*pkgs)</h3> <dd>
<p>Erases a package from the current nix profile. Nix uninstalls work differently than other package managers, and the symlinks in the profile are removed, while the actual package remains. There is also a <code class="docutils literal notranslate"><span class="pre">nix.purge</span></code> function, to clear the package cache of unused packages.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>pkgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>)</em>) -- List, single package to uninstall</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>Packages that have been uninstalled</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>)</p> </dd> </dl> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nix.uninstall pkg1 [pkg2 ...]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.nix.upgrade"> salt.modules.nix.upgrade(*pkgs)</h3> <dd>
<p>Runs an update operation on the specified packages, or all packages if none is specified.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<p><strong>pkgs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em>)</em>) -- List of packages to update</p> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>The upgraded packages. Example element: <code class="docutils literal notranslate"><span class="pre">['libxslt-1.1.0',</span> <span class="pre">'libxslt-1.1.10']</span></code></p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a>))</p> </dd> </dl> <pre class="highlight-bash notranslate" data-language="bash">salt '*' nix.update
salt '*' nix.update pkgs=one,two</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.nix.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.nix.html</a>
  </p>
</div>
