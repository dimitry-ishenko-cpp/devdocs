<h1>salt.modules.virt</h1> <p>Work with virtual machines managed by libvirt</p> <dl class="field-list simple"> <dt class="field-odd">depends</dt> <dd class="field-odd">
<ul class="simple"> <li><p>libvirt Python module</p></li> <li><p>libvirt client</p></li> <li><p>qemu-img</p></li> <li><p>grep</p></li> </ul> </dd> </dl> <div class="section" id="connection"> <h2>Connection</h2> <p>The connection to the virtualization host can be either setup in the minion configuration, pillar data or overridden for each individual call.</p> <p>By default, the libvirt connection URL will be guessed: the first available libvirt hypervisor driver will be used. This can be overridden like this:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
  connection:
    uri: lxc:///</pre> <p>If the connection requires an authentication like for ESXi, this can be defined in the minion pillar data like this:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
  connection:
    uri: esx://10.1.1.101/?no_verify=1&amp;auto_answer=1
    auth:
      username: user
      password: secret</pre> <div class="section" id="connecting-with-ssh-protocol"> <h3>Connecting with SSH protocol</h3> <p>Libvirt can connect to remote hosts using SSH using one of the <code class="docutils literal notranslate"><span class="pre">ssh</span></code>, <code class="docutils literal notranslate"><span class="pre">libssh</span></code> and <code class="docutils literal notranslate"><span class="pre">libssh2</span></code> transports. Note that <code class="docutils literal notranslate"><span class="pre">libssh2</span></code> is likely to fail as it doesn't read the <code class="docutils literal notranslate"><span class="pre">known_hosts</span></code> file. Libvirt may also have been built without <code class="docutils literal notranslate"><span class="pre">libssh</span></code> or <code class="docutils literal notranslate"><span class="pre">libssh2</span></code> support.</p> <p>To use the SSH transport, on the minion setup an SSH agent with a key authorized on the remote libvirt machine.</p> </div> <div class="section" id="per-call-connection-setup"> <h3>Per call connection setup</h3> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>All the calls requiring the libvirt connection configuration as mentioned above can override this configuration using <code class="docutils literal notranslate"><span class="pre">connection</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">password</span></code> parameters.</p> <p>This means that the following will list the domains on the local LXC libvirt driver, whatever the <code class="docutils literal notranslate"><span class="pre">virt:connection</span></code> is.</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'hypervisor' virt.list_domains connection=lxc:///</pre> <p>The calls not using the libvirt connection setup are:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">seed_non_shared_migrate</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">virt_type</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">is_*hyper</span></code></p></li> <li><p>all migration functions</p></li> <li><p><a class="reference external" href="http://libvirt.org/drvesx.html#uriformat">libvirt ESX URI format</a></p></li> <li><p><a class="reference external" href="http://libvirt.org/uri.html#URI_config">libvirt URI format</a></p></li> <li><p><a class="reference external" href="http://libvirt.org/auth.html#Auth_client_config">libvirt authentication configuration</a></p></li> </ul> </div> </div> <div class="section" id="units"> <h2>Units</h2> <p class="rubric" id="virt-units">Units specification</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3002.</span></p> </div> <p>The string should contain a number optionally followed by a unit. The number may have a decimal fraction. If the unit is not given then MiB are set by default. Units can optionally be given in IEC style (such as MiB), although the standard single letter style (such as M) is more convenient.</p> <p>Valid units include:</p> <table class="docutils align-default"> <colgroup> <col style="width: 24%"> <col style="width: 12%"> <col style="width: 24%"> <col style="width: 24%"> <col style="width: 15%"> </colgroup> <thead> <tr class="row-odd">
<th class="head"><p>Standard</p></th> <th class="head"><p>IEC</p></th> <th class="head"><p>Standard</p></th> <th class="head"><p>IEC</p></th> <th class="head"></th> </tr> <tr class="row-even">
<th class="head"><p>Unit</p></th> <th class="head"><p>Unit</p></th> <th class="head"><p>Name</p></th> <th class="head"><p>Name</p></th> <th class="head"><p>Factor</p></th> </tr> </thead> <tbody> <tr class="row-odd">
<td><p>B</p></td> <td></td> <td><p>Bytes</p></td> <td></td> <td><p>1</p></td> </tr> <tr class="row-even">
<td><p>K</p></td> <td><p>KiB</p></td> <td><p>Kilobytes</p></td> <td><p>Kibibytes</p></td> <td><p>2**10</p></td> </tr> <tr class="row-odd">
<td><p>M</p></td> <td><p>MiB</p></td> <td><p>Megabytes</p></td> <td><p>Mebibytes</p></td> <td><p>2**20</p></td> </tr> <tr class="row-even">
<td><p>G</p></td> <td><p>GiB</p></td> <td><p>Gigabytes</p></td> <td><p>Gibibytes</p></td> <td><p>2**30</p></td> </tr> <tr class="row-odd">
<td><p>T</p></td> <td><p>TiB</p></td> <td><p>Terabytes</p></td> <td><p>Tebibytes</p></td> <td><p>2**40</p></td> </tr> <tr class="row-even">
<td><p>P</p></td> <td><p>PiB</p></td> <td><p>Petabytes</p></td> <td><p>Pebibytes</p></td> <td><p>2**50</p></td> </tr> <tr class="row-odd">
<td><p>E</p></td> <td><p>EiB</p></td> <td><p>Exabytes</p></td> <td><p>Exbibytes</p></td> <td><p>2**60</p></td> </tr> <tr class="row-even">
<td><p>Z</p></td> <td><p>ZiB</p></td> <td><p>Zettabytes</p></td> <td><p>Zebibytes</p></td> <td><p>2**70</p></td> </tr> <tr class="row-odd">
<td><p>Y</p></td> <td><p>YiB</p></td> <td><p>Yottabytes</p></td> <td><p>Yobibytes</p></td> <td><p>2**80</p></td> </tr> </tbody> </table> <p>Additional decimal based units:</p> <table class="docutils align-default"> <colgroup> <col style="width: 46%"> <col style="width: 54%"> </colgroup> <thead> <tr class="row-odd">
<th class="head"><p>Unit</p></th> <th class="head"><p>Factor</p></th> </tr> </thead> <tbody> <tr class="row-even">
<td><p>KB</p></td> <td><p>10**3</p></td> </tr> <tr class="row-odd">
<td><p>MB</p></td> <td><p>10**6</p></td> </tr> <tr class="row-even">
<td><p>GB</p></td> <td><p>10**9</p></td> </tr> <tr class="row-odd">
<td><p>TB</p></td> <td><p>10**12</p></td> </tr> <tr class="row-even">
<td><p>PB</p></td> <td><p>10**15</p></td> </tr> <tr class="row-odd">
<td><p>EB</p></td> <td><p>10**18</p></td> </tr> <tr class="row-even">
<td><p>ZB</p></td> <td><p>10**21</p></td> </tr> <tr class="row-odd">
<td><p>YB</p></td> <td><p>10**24</p></td> </tr> </tbody> </table> <dl class="py function"> <h3 id="salt.modules.virt.all_capabilities"> salt.modules.virt.all_capabilities(**kwargs)</h3> <dd>
<p>Return the host and domain capabilities in a single call.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.all_capabilities</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.capabilities"> salt.modules.virt.capabilities(**kwargs)</h3> <dd>
<p>Return the hypervisor connection capabilities.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.capabilities</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.cpu_baseline"> salt.modules.virt.cpu_baseline(full=False, migratable=False, out='libvirt', **kwargs)</h3> <dd>
<p>Return the optimal 'custom' CPU baseline config for VM's on this minion</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>full</strong> -- Return all CPU features rather than the ones on top of the closest CPU model</p></li> <li><p><strong>migratable</strong> -- Exclude CPU features that are unmigratable (libvirt 2.13+)</p></li> <li><p><strong>out</strong> -- 'libvirt' (default) for usable libvirt XML definition, 'salt' for nice dict</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.cpu_baseline</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.create_xml_path"> salt.modules.virt.create_xml_path(path, **kwargs)</h3> <dd>
<p>Start a transient domain based on the XML-file path passed to the function</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>path</strong> -- path to a file containing the libvirt XML definition of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.create_xml_path &lt;path to XML file on the node&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.create_xml_str"> salt.modules.virt.create_xml_str(xml, **kwargs)</h3> <dd>
<p>Start a transient domain based on the XML passed to the function</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>xml</strong> -- libvirt XML definition of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.create_xml_str &lt;XML in string format&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.ctrl_alt_del"> salt.modules.virt.ctrl_alt_del(vm_, **kwargs)</h3> <dd>
<p>Sends CTRL+ALT+DEL to a VM</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.ctrl_alt_del &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.define_vol_xml_path"> salt.modules.virt.define_vol_xml_path(path, pool=None, **kwargs)</h3> <dd>
<p>Define a volume based on the XML-file path passed to the function</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>path</strong> -- path to a file containing the libvirt XML definition of the volume</p></li> <li>
<p><strong>pool</strong> -- </p>
<p>storage pool name to define the volume in. If defined, this parameter will override the configuration setting.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.define_vol_xml_path &lt;path to XML file on the node&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.define_vol_xml_str"> salt.modules.virt.define_vol_xml_str(xml, pool=None, **kwargs)</h3> <dd>
<p>Define a volume based on the XML passed to the function</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>xml</strong> -- libvirt XML definition of the storage volume</p></li> <li>
<p><strong>pool</strong> -- </p>
<p>storage pool name to define the volume in. If defined, this parameter will override the configuration setting.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.define_vol_xml_str &lt;XML in string format&gt;</pre> <p>The storage pool where the disk image will be defined is <code class="docutils literal notranslate"><span class="pre">default</span></code> unless changed with the pool parameter or a configuration like this:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
    storagepool: mine</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.define_xml_path"> salt.modules.virt.define_xml_path(path, **kwargs)</h3> <dd>
<p>Define a persistent domain based on the XML-file path passed to the function</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>path</strong> -- path to a file containing the libvirt XML definition of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.define_xml_path &lt;path to XML file on the node&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.define_xml_str"> salt.modules.virt.define_xml_str(xml, **kwargs)</h3> <dd>
<p>Define a persistent domain based on the XML passed to the function</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>xml</strong> -- libvirt XML definition of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.define_xml_str &lt;XML in string format&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.delete_snapshots"> salt.modules.virt.delete_snapshots(name, *names, **kwargs)</h3> <dd>
<p>Delete one or more snapshots of the given VM.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- domain name</p></li> <li><p><strong>names</strong> -- names of the snapshots to remove</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.delete_snapshots &lt;domain&gt; all=True
salt '*' virt.delete_snapshots &lt;domain&gt; &lt;snapshot&gt;
salt '*' virt.delete_snapshots &lt;domain&gt; &lt;snapshot1&gt; &lt;snapshot2&gt; ...</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.domain_capabilities"> salt.modules.virt.domain_capabilities(emulator=None, arch=None, machine=None, domain=None, **kwargs)</h3> <dd>
<p>Return the domain capabilities given an emulator, architecture, machine or virtualization type.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>emulator</strong> -- return the capabilities for the given emulator binary</p></li> <li><p><strong>arch</strong> -- return the capabilities for the given CPU architecture</p></li> <li><p><strong>machine</strong> -- return the capabilities for the given emulated machine type</p></li> <li><p><strong>domain</strong> -- return the capabilities for the given virtualization type.</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p>The list of the possible emulator, arch, machine and domain can be found in the host capabilities output.</p> <p>If none of the parameters is provided, the libvirt default one is returned.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.domain_capabilities arch='x86_64' domain='kvm'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.freecpu"> salt.modules.virt.freecpu(**kwargs)</h3> <dd>
<p>Return an int representing the number of unallocated cpus on this hypervisor</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.freecpu</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.freemem"> salt.modules.virt.freemem(**kwargs)</h3> <dd>
<p>Return an int representing the amount of memory (in MB) that has not been given to virtual machines on this node</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.freemem</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.full_info"> salt.modules.virt.full_info(**kwargs)</h3> <dd>
<p>Return the node_info, vm_info and freemem</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.full_info</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_disks"> salt.modules.virt.get_disks(vm_, **kwargs)</h3> <dd>
<p>Return the disks of a named vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_disks &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_graphics"> salt.modules.virt.get_graphics(vm_, **kwargs)</h3> <dd>
<p>Returns the information on vnc for a given vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_graphics &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_hypervisor"> salt.modules.virt.get_hypervisor()</h3> <dd>
<p>Returns the name of the hypervisor running on this node or <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p> <p>Detected hypervisors:</p> <ul class="simple"> <li><p>kvm</p></li> <li><p>xen</p></li> <li><p>bhyve</p></li> </ul> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_hypervisor</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0: </span>the function and the <code class="docutils literal notranslate"><span class="pre">kvm</span></code>, <code class="docutils literal notranslate"><span class="pre">xen</span></code> and <code class="docutils literal notranslate"><span class="pre">bhyve</span></code> hypervisors support</p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_loader"> salt.modules.virt.get_loader(vm_, **kwargs)</h3> <dd>
<p>Returns the information on the loader for a given vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_loader &lt;domain&gt;</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_macs"> salt.modules.virt.get_macs(vm_, **kwargs)</h3> <dd>
<p>Return a list off MAC addresses from the named vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_macs &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_nics"> salt.modules.virt.get_nics(vm_, **kwargs)</h3> <dd>
<p>Return info about the network interfaces of a named vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_nics &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_profiles"> salt.modules.virt.get_profiles(hypervisor=None, **kwargs)</h3> <dd>
<p>Return the virt profiles for hypervisor.</p> <p>Currently there are profiles for:</p> <ul class="simple"> <li><p>nic</p></li> <li><p>disk</p></li> </ul> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>hypervisor</strong> -- override the default machine type.</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_profiles
salt '*' virt.get_profiles hypervisor=vmware</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.get_xml"> salt.modules.virt.get_xml(vm_, **kwargs)</h3> <dd>
<p>Returns the XML for a given vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.get_xml &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.init"> salt.modules.virt.init(name, cpu, mem, nic='default', interfaces=None, hypervisor=None, start=True, disk='default', disks=None, saltenv='base', seed=True, install=True, pub_key=None, priv_key=None, seed_cmd='seed.apply', graphics=None, os_type=None, arch=None, boot=None, boot_dev=None, numatune=None, hypervisor_features=None, clock=None, serials=None, consoles=None, stop_on_reboot=False, host_devices=None, **kwargs)</h3> <dd>
<p>Initialize a new vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- name of the virtual machine to create</p></li> <li>
<p><strong>cpu</strong> -- </p>
<p>Number of virtual CPUs to assign to the virtual machine or a dictionary with detailed information to configure cpu model and topology, numa node tuning, cpu tuning and iothreads allocation. The structure of the dictionary is documented in <a class="reference internal" href="#init-cpu-def"><span class="std std-ref">cpu parameters definition</span></a>.</p> <pre class="highlight-yaml notranslate" data-language="yaml">cpu:
  placement: static
  cpuset: 0-11
  current: 5
  maximum: 12
  vcpus:
    0:
      enabled: True
      hotpluggable: False
      order: 1
    1:
      enabled: False
      hotpluggable: True
  match: minimum
  mode: custom
  check: full
  vendor: Intel
  model:
    name: core2duo
    fallback: allow
    vendor_id: GenuineIntel
  topology:
    sockets: 1
    cores: 12
    threads: 1
  cache:
    level: 3
    mode: emulate
  features:
    lahf: optional
    pcid: require
  numa:
    0:
       cpus: 0-3
       memory: 1g
       discard: True
       distances:
         0: 10     # sibling id : value
         1: 21
         2: 31
         3: 41
    1:
       cpus: 4-6
       memory: 1g
       memAccess: shared
       distances:
         0: 21
         1: 10
         2: 21
         3: 31
  tuning:
       vcpupin:
         0: 1-4,^2  # vcpuid : cpuset
         1: 0,1
         2: 2,3
         3: 0,4
       emulatorpin: 1-3
       iothreadpin:
         1: 5,6    # iothread id: cpuset
         2: 7,8
       shares: 2048
       period: 1000000
       quota: -1
       global_period: 1000000
       global_quota: -1
       emulator_period: 1000000
       emulator_quota: -1
       iothread_period: 1000000
       iothread_quota: -1
       vcpusched:
         - scheduler: fifo
           priority: 1
           vcpus: 0,3-5
         - scheduler: rr
           priority: 3
       iothreadsched:
         - scheduler: idle
         - scheduler: batch
           iothreads: 2,3
       emulatorsched:
         - scheduler: batch
       cachetune:
         0-3:      # vcpus set
           0:      # cache id
             level: 3
             type: both
             size: 4
           1:
             level: 3
             type: both
             size: 6
           monitor:
             1: 3
             0-3: 3
         4-5:
           monitor:
             4: 3  # vcpus: level
             5: 3
       memorytune:
         0-3:      # vcpus set
           0: 60   # node id: bandwidth
         4-5:
           0: 60
  iothreads: 4</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>mem</strong> -- </p>
<p>Amount of memory to allocate to the virtual machine in MiB. Since 3002, a dictionary can be used to contain detailed configuration which support memory allocation or tuning. Supported parameters are <code class="docutils literal notranslate"><span class="pre">boot</span></code>, <code class="docutils literal notranslate"><span class="pre">current</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">slots</span></code>, <code class="docutils literal notranslate"><span class="pre">hard_limit</span></code>, <code class="docutils literal notranslate"><span class="pre">soft_limit</span></code>, <code class="docutils literal notranslate"><span class="pre">swap_hard_limit</span></code>, <code class="docutils literal notranslate"><span class="pre">min_guarantee</span></code>, <code class="docutils literal notranslate"><span class="pre">hugepages</span></code> , <code class="docutils literal notranslate"><span class="pre">nosharepages</span></code>, <code class="docutils literal notranslate"><span class="pre">locked</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>, <code class="docutils literal notranslate"><span class="pre">allocation</span></code> and <code class="docutils literal notranslate"><span class="pre">discard</span></code>. The structure of the dictionary is documented in <a class="reference internal" href="#init-mem-def"><span class="std std-ref">Memory parameter definition</span></a>. Both decimal and binary base are supported. Detail unit specification is documented in <a class="reference internal" href="#virt-units"><span class="std std-ref">Units specification</span></a>. Please note that the value for <code class="docutils literal notranslate"><span class="pre">slots</span></code> must be an integer.</p> <pre class="highlight-python notranslate" data-language="python">{
    'boot': 1g,
    'current': 1g,
    'max': 1g,
    'slots': 10,
    'hard_limit': '1024',
    'soft_limit': '512m',
    'swap_hard_limit': '1g',
    'min_guarantee': '512mib',
    'hugepages': [{'nodeset': '0-3,^2', 'size': '1g'}, {'nodeset': '2', 'size': '2m'}],
    'nosharepages': True,
    'locked': True,
    'source': 'file',
    'access': 'shared',
    'allocation': 'immediate',
    'discard': True
}</pre> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3002.</span></p> </div> </li> <li><p><strong>nic</strong> -- NIC profile to use (Default: <code class="docutils literal notranslate"><span class="pre">'default'</span></code>). The profile interfaces can be customized / extended with the interfaces parameter. If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, no profile will be used.</p></li> <li>
<p><strong>interfaces</strong> -- </p>
<p>List of dictionaries providing details on the network interfaces to create. These data are merged with the ones from the nic profile. The structure of each dictionary is documented in <a class="reference internal" href="#init-nic-def"><span class="std std-ref">Network Interfaces Definitions</span></a>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li><p><strong>hypervisor</strong> -- the virtual machine type. By default the value will be computed according to the virtual host capabilities.</p></li> <li><p><strong>start</strong> -- <code class="docutils literal notranslate"><span class="pre">True</span></code> to start the virtual machine after having defined it (Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li> <li><p><strong>disk</strong> -- Disk profile to use (Default: <code class="docutils literal notranslate"><span class="pre">'default'</span></code>). If set to <code class="docutils literal notranslate"><span class="pre">None</span></code>, no profile will be used.</p></li> <li>
<p><strong>disks</strong> -- </p>
<p>List of dictionaries providing details on the disk devices to create. These data are merged with the ones from the disk profile. The structure of each dictionary is documented in <a class="reference internal" href="#init-disk-def"><span class="std std-ref">Disks Definitions</span></a>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li><p><strong>saltenv</strong> -- Fileserver environment (Default: <code class="docutils literal notranslate"><span class="pre">'base'</span></code>). See <a class="reference internal" href="salt.modules.cp.html#module-salt.modules.cp" title="salt.modules.cp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cp</span> <span class="pre">module</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details</span></code></a></p></li> <li><p><strong>seed</strong> -- <code class="docutils literal notranslate"><span class="pre">True</span></code> to seed the disk image. Only used when the <code class="docutils literal notranslate"><span class="pre">image</span></code> parameter is provided. (Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li> <li><p><strong>install</strong> -- install salt minion if absent (Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li> <li><p><strong>pub_key</strong> -- public key to seed with (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li><p><strong>priv_key</strong> -- public key to seed with (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li><p><strong>seed_cmd</strong> -- Salt command to execute to seed the image. (Default: <code class="docutils literal notranslate"><span class="pre">'seed.apply'</span></code>)</p></li> <li>
<p><strong>graphics</strong> -- </p>
<p>Dictionary providing details on the graphics device to create. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) See <a class="reference internal" href="#init-graphics-def"><span class="std std-ref">Graphics Definition</span></a> for more details on the possible values.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>os_type</strong> -- </p>
<p>type of virtualization as found in the <code class="docutils literal notranslate"><span class="pre">//os/type</span></code> element of the libvirt definition. The default value is taken from the host capabilities, with a preference for <code class="docutils literal notranslate"><span class="pre">hvm</span></code>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>arch</strong> -- </p>
<p>architecture of the virtual machine. The default value is taken from the host capabilities, but <code class="docutils literal notranslate"><span class="pre">x86_64</span></code> is prefed over <code class="docutils literal notranslate"><span class="pre">i686</span></code>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li><p><strong>config</strong> -- minion configuration to use when seeding. See <a class="reference internal" href="salt.modules.seed.html#module-salt.modules.seed" title="salt.modules.seed"><code class="xref py py-mod docutils literal notranslate"><span class="pre">seed</span> <span class="pre">module</span> <span class="pre">for</span> <span class="pre">more</span> <span class="pre">details</span></code></a></p></li> <li><p><strong>boot_dev</strong> -- String of space-separated devices to boot from (Default: <code class="docutils literal notranslate"><span class="pre">'hd'</span></code>)</p></li> <li><p><strong>serial_type</strong> -- Serial device type. One of <code class="docutils literal notranslate"><span class="pre">'pty'</span></code>, <code class="docutils literal notranslate"><span class="pre">'tcp'</span></code> (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li><p><strong>telnet_port</strong> -- Telnet port to use for serial device of type <code class="docutils literal notranslate"><span class="pre">tcp</span></code>.</p></li> <li><p><strong>console</strong> -- <code class="docutils literal notranslate"><span class="pre">True</span></code> to add a console device along with serial one (Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>stop_on_reboot</strong> -- </p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> the guest will stop instead of rebooting. This is specially useful when creating a virtual machine with an installation cdrom or an autoinstallation needing a special first boot configuration. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code></p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>boot</strong> -- </p>
<p>Specifies kernel, initial ramdisk and kernel command line parameters for the virtual machine. This is an optional parameter, all of the keys are optional within the dictionary. The structure of the dictionary is documented in <a class="reference internal" href="#init-boot-def"><span class="std std-ref">Boot parameters definition</span></a>. If a remote path is provided to kernel or initrd, salt will handle the downloading of the specified remote file and modify the XML accordingly. To boot VM with UEFI, specify loader and nvram path or specify 'efi': <code class="docutils literal notranslate"><span class="pre">True</span></code> if your libvirtd version is &gt;= 5.2.0 and QEMU &gt;= 3.0.0.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> <pre class="highlight-python notranslate" data-language="python">{
    'kernel': '/root/f8-i386-vmlinuz',
    'initrd': '/root/f8-i386-initrd',
    'cmdline': 'console=ttyS0 ks=http://example.com/f8-i386/os/',
    'loader': '/usr/share/OVMF/OVMF_CODE.fd',
    'nvram': '/usr/share/OVMF/OVMF_VARS.ms.fd'
}</pre> </li> <li>
<p><strong>boot_dev</strong> -- </p>
<p>Space separated list of devices to boot from sorted by decreasing priority. Values can be <code class="docutils literal notranslate"><span class="pre">hd</span></code>, <code class="docutils literal notranslate"><span class="pre">fd</span></code>, <code class="docutils literal notranslate"><span class="pre">cdrom</span></code> or <code class="docutils literal notranslate"><span class="pre">network</span></code>.</p> <p>By default, the value will <code class="docutils literal notranslate"><span class="pre">"hd"</span></code>.</p> </li> <li>
<p><strong>numatune</strong> -- </p>
<p>The optional numatune element provides details of how to tune the performance of a NUMA host via controlling NUMA policy for domain process. The optional <code class="docutils literal notranslate"><span class="pre">memory</span></code> element specifies how to allocate memory for the domain process on a NUMA host. <code class="docutils literal notranslate"><span class="pre">memnode</span></code> elements can specify memory allocation policies per each guest NUMA node. The definition used in the dictionary can be found at <a class="reference internal" href="#init-cpu-def"><span class="std std-ref">cpu parameters definition</span></a>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> <pre class="highlight-python notranslate" data-language="python">{
    'memory': {'mode': 'strict', 'nodeset': '0-11'},
    'memnodes': {0: {'mode': 'strict', 'nodeset': 1}, 1: {'mode': 'preferred', 'nodeset': 2}}
}</pre> </li> <li>
<p><strong>hypervisor_features</strong> -- </p>
<p>Enable or disable hypervisor-specific features on the virtual machine.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> <pre class="highlight-yaml notranslate" data-language="yaml">hypervisor_features:
  kvm-hint-dedicated: True</pre> </li> <li>
<p><strong>clock</strong> -- </p>
<p>Configure the guest clock. The value is a dictionary with the following keys:</p> <dl class="simple"> <dt>adjustment</dt>
<dd>
<p>time adjustment in seconds or <code class="docutils literal notranslate"><span class="pre">reset</span></code></p> </dd> <dt>utc</dt>
<dd>
<p>set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to use the host local time as the guest clock. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> </dd> <dt>timezone</dt>
<dd>
<p>synchronize the guest to the correspding timezone</p> </dd> <dt>timers</dt>
<dd>
<p>a dictionary associating the timer name with its configuration. This configuration is a dictionary with the properties <code class="docutils literal notranslate"><span class="pre">track</span></code>, <code class="docutils literal notranslate"><span class="pre">tickpolicy</span></code>, <code class="docutils literal notranslate"><span class="pre">catchup</span></code>, <code class="docutils literal notranslate"><span class="pre">frequency</span></code>, <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">present</span></code>, <code class="docutils literal notranslate"><span class="pre">slew</span></code>, <code class="docutils literal notranslate"><span class="pre">threshold</span></code> and <code class="docutils literal notranslate"><span class="pre">limit</span></code>. See <a class="reference external" href="https://libvirt.org/formatdomain.html#time-keeping">libvirt time keeping documentation</a> for the possible values.</p> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> <p>Set the clock to local time using an offset in seconds .. code-block:: yaml</p> <blockquote> <div>
<dl class="simple"> <dt>clock:</dt>
<dd>
<p>adjustment: 3600 utc: False</p> </dd> </dl> </div>
</blockquote> <p>Set the clock to a specific time zone:</p> <pre class="highlight-yaml notranslate" data-language="yaml">clock:
  timezone: CEST</pre> <p>Tweak guest timers:</p> <pre class="highlight-yaml notranslate" data-language="yaml">clock:
  timers:
    tsc:
      frequency: 3504000000
      mode: native
    rtc:
      track: wall
      tickpolicy: catchup
      slew: 4636
      threshold: 123
      limit: 2342
    hpet:
      present: False</pre> </li> <li>
<p><strong>serials</strong> -- </p>
<p>Dictionary providing details on the serials connection to create. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) See <a class="reference internal" href="#init-chardevs-def"><span class="std std-ref">Serials and Consoles Definitions</span></a> for more details on the possible values.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>consoles</strong> -- </p>
<p>Dictionary providing details on the consoles device to create. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) See <a class="reference internal" href="#init-chardevs-def"><span class="std std-ref">Serials and Consoles Definitions</span></a> for more details on the possible values.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>host_devices</strong> -- </p>
<p>List of host devices to passthrough to the guest. The value is a list of device names as provided by the <a class="reference internal" href="#salt.modules.virt.node_devices" title="salt.modules.virt.node_devices"><code class="xref py py-func docutils literal notranslate"><span class="pre">node_devices()</span></code></a> function. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> </ul> </dd> </dl> <p class="rubric" id="init-cpu-def">cpu parameters definition</p> <p>The cpu parameters dictionary can contain the following properties:</p> <dl class="simple"> <dt>cpuset</dt>
<dd>
<p>a comma-separated list of physical CPU numbers that domain process and virtual CPUs can be pinned to by default. eg. <code class="docutils literal notranslate"><span class="pre">1-4,^3</span></code> cpuset 3 is excluded.</p> </dd> <dt>current</dt>
<dd>
<p>the number of virtual cpus available at startup</p> </dd> <dt>placement</dt>
<dd>
<p>indicate the CPU placement mode for domain process. the value can be either <code class="docutils literal notranslate"><span class="pre">static</span></code> or <code class="docutils literal notranslate"><span class="pre">auto</span></code></p> </dd> <dt>vcpus</dt>
<dd>
<p>specify the state of individual vcpu. Possible attribute for each individual vcpu include: <code class="docutils literal notranslate"><span class="pre">id</span></code>, <code class="docutils literal notranslate"><span class="pre">enabled</span></code>, <code class="docutils literal notranslate"><span class="pre">hotpluggable</span></code> and <code class="docutils literal notranslate"><span class="pre">order</span></code>. Valid <code class="docutils literal notranslate"><span class="pre">ids</span></code> are from 0 to the maximum vCPU count minus 1. <code class="docutils literal notranslate"><span class="pre">enabled</span></code> takes boolean values which controls the state of the vcpu. <code class="docutils literal notranslate"><span class="pre">hotpluggable</span></code> take boolean value which controls whether given vCPU can be hotplugged and hotunplugged. <code class="docutils literal notranslate"><span class="pre">order</span></code> takes an integer value which specifies the order to add the online vCPUs.</p> </dd> <dt>match</dt>
<dd>
<p>The cpu attribute <code class="docutils literal notranslate"><span class="pre">match</span></code> attribute specifies how strictly the virtual CPU provided to the guest matches the CPU requirements, possible values are <code class="docutils literal notranslate"><span class="pre">minimum</span></code>, <code class="docutils literal notranslate"><span class="pre">exact</span></code> or <code class="docutils literal notranslate"><span class="pre">strict</span></code>.</p> </dd> <dt>check</dt>
<dd>
<p>Optional cpu attribute <code class="docutils literal notranslate"><span class="pre">check</span></code> attribute can be used to request a specific way of checking whether the virtual CPU matches the specification, possible values are <code class="docutils literal notranslate"><span class="pre">none</span></code>, <code class="docutils literal notranslate"><span class="pre">partial</span></code> and <code class="docutils literal notranslate"><span class="pre">full</span></code>.</p> </dd> <dt>mode</dt>
<dd>
<p>Optional cpu attribute <code class="docutils literal notranslate"><span class="pre">mode</span></code> attribute may be used to make it easier to configure a guest CPU to be as close to host CPU as possible, possible values are <code class="docutils literal notranslate"><span class="pre">custom</span></code>, <code class="docutils literal notranslate"><span class="pre">host-model</span></code> and <code class="docutils literal notranslate"><span class="pre">host-passthrough</span></code>.</p> </dd> <dt>model</dt>
<dd>
<p>specifies CPU model requested by the guest. An optional <code class="docutils literal notranslate"><span class="pre">fallback</span></code> attribute can be used to forbid libvirt falls back to the closest model supported by the hypervisor, possible values are <code class="docutils literal notranslate"><span class="pre">allow</span></code> or <code class="docutils literal notranslate"><span class="pre">forbid</span></code>. <code class="docutils literal notranslate"><span class="pre">vendor_id</span></code> attribute can be used to set the vendor id seen by the guest, the length must be exactly 12 characters long.</p> </dd> <dt>vendor</dt>
<dd>
<p>specifies CPU vendor requested by the guest.</p> </dd> <dt>topology</dt>
<dd>
<p>specifies requested topology of virtual CPU provided to the guest. Four possible attributes , <code class="docutils literal notranslate"><span class="pre">sockets</span></code>, <code class="docutils literal notranslate"><span class="pre">dies</span></code>, <code class="docutils literal notranslate"><span class="pre">cores</span></code>, and <code class="docutils literal notranslate"><span class="pre">threads</span></code>, accept non-zero positive integer values. They refer to the number of CPU sockets per NUMA node, number of dies per socket, number of cores per die, and number of threads per core, respectively.</p> </dd> <dt>features</dt>
<dd>
<p>A dictionary conains a set of cpu features to fine-tune features provided by the selected CPU model. Use cpu feature <code class="docutils literal notranslate"><span class="pre">name</span></code> as the key and the <code class="docutils literal notranslate"><span class="pre">policy</span></code> as the value. <code class="docutils literal notranslate"><span class="pre">policy</span></code> Attribute takes <code class="docutils literal notranslate"><span class="pre">force</span></code>, <code class="docutils literal notranslate"><span class="pre">require</span></code>, <code class="docutils literal notranslate"><span class="pre">optional</span></code>, <code class="docutils literal notranslate"><span class="pre">disable</span></code> or <code class="docutils literal notranslate"><span class="pre">forbid</span></code>.</p> </dd> <dt>cache</dt>
<dd>
<p>describes the virtual CPU cache. Optional attribute <code class="docutils literal notranslate"><span class="pre">level</span></code> takes an integer value which describes cache level <code class="docutils literal notranslate"><span class="pre">mode</span></code> attribute supported three possible values: <code class="docutils literal notranslate"><span class="pre">emulate</span></code>, <code class="docutils literal notranslate"><span class="pre">passthrough</span></code>, <code class="docutils literal notranslate"><span class="pre">disable</span></code></p> </dd> <dt>numa</dt>
<dd>
<p>specify the guest numa topology. <code class="docutils literal notranslate"><span class="pre">cell</span></code> element specifies a NUMA cell or a NUMA node, <code class="docutils literal notranslate"><span class="pre">cpus</span></code> specifies the CPU or range of CPUs that are part of the node, <code class="docutils literal notranslate"><span class="pre">memory</span></code> specifies the size of the node memory. All cells should have <code class="docutils literal notranslate"><span class="pre">id</span></code> attribute in case referring to some cell is necessary in the code. optional attribute <code class="docutils literal notranslate"><span class="pre">memAccess</span></code> control whether the memory is to be mapped as <code class="docutils literal notranslate"><span class="pre">shared</span></code> or <code class="docutils literal notranslate"><span class="pre">private</span></code>, <code class="docutils literal notranslate"><span class="pre">discard</span></code> attribute which fine tunes the discard feature for given numa node, possible values are <code class="docutils literal notranslate"><span class="pre">True</span></code> or <code class="docutils literal notranslate"><span class="pre">False</span></code>. <code class="docutils literal notranslate"><span class="pre">distances</span></code> element define the distance between NUMA cells and <code class="docutils literal notranslate"><span class="pre">sibling</span></code> sub-element is used to specify the distance value between sibling NUMA cells.</p> </dd> <dt>vcpupin</dt>
<dd>
<p>The optional vcpupin element specifies which of host's physical CPUs the domain vCPU will be pinned to.</p> </dd> <dt>emulatorpin</dt>
<dd>
<p>The optional emulatorpin element specifies which of host physical CPUs the "emulator", a subset of a domain not including vCPU or iothreads will be pinned to.</p> </dd> <dt>iothreadpin</dt>
<dd>
<p>The optional iothreadpin element specifies which of host physical CPUs the IOThreads will be pinned to.</p> </dd> <dt>shares</dt>
<dd>
<p>The optional shares element specifies the proportional weighted share for the domain.</p> </dd> <dt>period</dt>
<dd>
<p>The optional period element specifies the enforcement interval (unit: microseconds).</p> </dd> <dt>quota</dt>
<dd>
<p>The optional quota element specifies the maximum allowed bandwidth (unit: microseconds).</p> </dd> <dt>global_period</dt>
<dd>
<p>The optional global_period element specifies the enforcement CFS scheduler interval (unit: microseconds) for the whole domain in contrast with period which enforces the interval per vCPU.</p> </dd> <dt>global_quota</dt>
<dd>
<p>The optional global_quota element specifies the maximum allowed bandwidth (unit: microseconds) within a period for the whole domain.</p> </dd> <dt>emulator_period</dt>
<dd>
<p>The optional emulator_period element specifies the enforcement interval (unit: microseconds).</p> </dd> <dt>emulator_quota</dt>
<dd>
<p>The optional emulator_quota element specifies the maximum allowed bandwidth (unit: microseconds) for domain's emulator threads (those excluding vCPUs).</p> </dd> <dt>iothread_period</dt>
<dd>
<p>The optional iothread_period element specifies the enforcement interval (unit: microseconds) for IOThreads.</p> </dd> <dt>iothread_quota</dt>
<dd>
<p>The optional iothread_quota element specifies the maximum allowed bandwidth (unit: microseconds) for IOThreads.</p> </dd> <dt>vcpusched</dt>
<dd>
<p>specify the scheduler type for vCPUs. The value is a list of dictionaries with the <code class="docutils literal notranslate"><span class="pre">scheduler</span></code> key (values <code class="docutils literal notranslate"><span class="pre">batch</span></code>, <code class="docutils literal notranslate"><span class="pre">idle</span></code>, <code class="docutils literal notranslate"><span class="pre">fifo</span></code>, <code class="docutils literal notranslate"><span class="pre">rr</span></code>) and the optional <code class="docutils literal notranslate"><span class="pre">priority</span></code> and <code class="docutils literal notranslate"><span class="pre">vcpus</span></code> keys. The <code class="docutils literal notranslate"><span class="pre">priority</span></code> value usually is a positive integer and the <code class="docutils literal notranslate"><span class="pre">vcpus</span></code> value is a cpu set like <code class="docutils literal notranslate"><span class="pre">1-4,^3,6</span></code> or simply the vcpu id.</p> </dd> <dt>iothreadsched</dt>
<dd>
<p>specify the scheduler type for IO threads. The value is a list of dictionaries with the <code class="docutils literal notranslate"><span class="pre">scheduler</span></code> key (values <code class="docutils literal notranslate"><span class="pre">batch</span></code>, <code class="docutils literal notranslate"><span class="pre">idle</span></code>, <code class="docutils literal notranslate"><span class="pre">fifo</span></code>, <code class="docutils literal notranslate"><span class="pre">rr</span></code>) and the optional <code class="docutils literal notranslate"><span class="pre">priority</span></code> and <code class="docutils literal notranslate"><span class="pre">vcpus</span></code> keys. The <code class="docutils literal notranslate"><span class="pre">priority</span></code> value usually is a positive integer and the <code class="docutils literal notranslate"><span class="pre">vcpus</span></code> value is a cpu set like <code class="docutils literal notranslate"><span class="pre">1-4,^3,6</span></code> or simply the vcpu id.</p> </dd> <dt>emulatorsched</dt>
<dd>
<p>specify the scheduler type (values batch, idle, fifo, rr) for particular the emulator. The value is a dictionary with the <code class="docutils literal notranslate"><span class="pre">scheduler</span></code> key (values <code class="docutils literal notranslate"><span class="pre">batch</span></code>, <code class="docutils literal notranslate"><span class="pre">idle</span></code>, <code class="docutils literal notranslate"><span class="pre">fifo</span></code>, <code class="docutils literal notranslate"><span class="pre">rr</span></code>) and the optional <code class="docutils literal notranslate"><span class="pre">priority</span></code> and <code class="docutils literal notranslate"><span class="pre">vcpus</span></code> keys. The <code class="docutils literal notranslate"><span class="pre">priority</span></code> value usually is a positive integer.</p> </dd> <dt>cachetune</dt>
<dd>
<p>Optional cachetune element can control allocations for CPU caches using the resctrl on the host.</p> </dd> <dt>monitor</dt>
<dd>
<p>The optional element monitor creates the cache monitor(s) for current cache allocation.</p> </dd> <dt>memorytune</dt>
<dd>
<p>Optional memorytune element can control allocations for memory bandwidth using the resctrl on the host.</p> </dd> <dt>iothreads</dt>
<dd>
<p>Number of threads for supported disk devices to perform I/O requests. iothread id will be numbered from 1 to the provided number (Default: None).</p> </dd> </dl> <p class="rubric" id="init-boot-def">Boot parameters definition</p> <p>The boot parameters dictionary can contains the following properties:</p> <dl> <dt>kernel</dt>
<dd>
<p>The URL or path to the kernel to run the virtual machine with.</p> </dd> <dt>initrd</dt>
<dd>
<p>The URL or path to the initrd file to run the virtual machine with.</p> </dd> <dt>cmdline</dt>
<dd>
<p>The parameters to pass to the kernel provided in the <cite>kernel</cite> property.</p> </dd> <dt>loader</dt>
<dd>
<p>The path to the UEFI binary loader to use.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd> <dt>nvram</dt>
<dd>
<p>The path to the UEFI data template. The file will be copied when creating the virtual machine.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd> <dt>efi</dt>
<dd>
<p>A boolean value.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd> </dl> <p class="rubric" id="init-mem-def">Memory parameter definition</p> <p>Memory parameter can contain the following properties:</p> <dl class="simple"> <dt>boot</dt>
<dd>
<p>The maximum allocation of memory for the guest at boot time</p> </dd> <dt>current</dt>
<dd>
<p>The actual allocation of memory for the guest</p> </dd> <dt>max</dt>
<dd>
<p>The run time maximum memory allocation of the guest</p> </dd> <dt>slots</dt>
<dd>
<p>specifies the number of slots available for adding memory to the guest</p> </dd> <dt>hard_limit</dt>
<dd>
<p>the maximum memory the guest can use</p> </dd> <dt>soft_limit</dt>
<dd>
<p>memory limit to enforce during memory contention</p> </dd> <dt>swap_hard_limit</dt>
<dd>
<p>the maximum memory plus swap the guest can use</p> </dd> <dt>min_guarantee</dt>
<dd>
<p>the guaranteed minimum memory allocation for the guest</p> </dd> <dt>hugepages</dt>
<dd>
<p>memory allocated using <code class="docutils literal notranslate"><span class="pre">hugepages</span></code> instead of the normal native page size. It takes a list of dictionaries with <code class="docutils literal notranslate"><span class="pre">nodeset</span></code> and <code class="docutils literal notranslate"><span class="pre">size</span></code> keys. For example <code class="docutils literal notranslate"><span class="pre">"hugepages":</span> <span class="pre">[{"nodeset":</span> <span class="pre">"1-4,^3",</span> <span class="pre">"size":</span> <span class="pre">"2m"},</span> <span class="pre">{"nodeset":</span> <span class="pre">"3",</span> <span class="pre">"size":</span> <span class="pre">"1g"}]</span></code>.</p> </dd> <dt>nosharepages</dt>
<dd>
<p>boolean value to instruct hypervisor to disable shared pages (memory merge, KSM) for this domain</p> </dd> <dt>locked</dt>
<dd>
<p>boolean value that allows memory pages belonging to the domain will be locked in host's memory and the host will not be allowed to swap them out, which might be required for some workloads such as real-time.</p> </dd> <dt>source</dt>
<dd>
<p>possible values are <code class="docutils literal notranslate"><span class="pre">file</span></code> which utilizes file memorybacking, <code class="docutils literal notranslate"><span class="pre">anonymous</span></code> by default and <code class="docutils literal notranslate"><span class="pre">memfd</span></code> backing. (QEMU/KVM only)</p> </dd> <dt>access</dt>
<dd>
<p>specify if the memory is to be <code class="docutils literal notranslate"><span class="pre">shared</span></code> or <code class="docutils literal notranslate"><span class="pre">private</span></code>. This can be overridden per numa node by memAccess.</p> </dd> <dt>allocation</dt>
<dd>
<p>specify when to allocate the memory by supplying either <code class="docutils literal notranslate"><span class="pre">immediate</span></code> or <code class="docutils literal notranslate"><span class="pre">ondemand</span></code>.</p> </dd> <dt>discard</dt>
<dd>
<p>boolean value to ensure the memory content is discarded just before guest shuts down (or when DIMM module is unplugged). Please note that this is just an optimization and is not guaranteed to work in all cases (e.g. when hypervisor crashes). (QEMU/KVM only)</p> </dd> </dl> <p class="rubric" id="init-nic-def">Network Interfaces Definitions</p> <p>Network interfaces dictionaries can contain the following properties:</p> <dl class="simple"> <dt>name</dt>
<dd>
<p>Name of the network interface. This is only used as a key to merge with the profile data</p> </dd> <dt>type</dt>
<dd>
<p>Network type. One of <code class="docutils literal notranslate"><span class="pre">'bridge'</span></code>, <code class="docutils literal notranslate"><span class="pre">'network'</span></code></p> </dd> <dt>source</dt>
<dd>
<p>The network source, typically the bridge or network name</p> </dd> <dt>mac</dt>
<dd>
<p>The desired mac address, computed if <code class="docutils literal notranslate"><span class="pre">None</span></code> (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>).</p> </dd> <dt>model</dt>
<dd>
<p>The network card model (Default: depends on the hypervisor)</p> </dd> </dl> <p class="rubric" id="init-disk-def">Disks Definitions</p> <p>Disk dictionaries can contain the following properties:</p> <dl> <dt>name</dt>
<dd>
<p>Name of the disk. This is mostly used in the name of the disk image and as a key to merge with the profile data.</p> </dd> <dt>format</dt>
<dd>
<p>Format of the disk image, like <code class="docutils literal notranslate"><span class="pre">'qcow2'</span></code>, <code class="docutils literal notranslate"><span class="pre">'raw'</span></code>, <code class="docutils literal notranslate"><span class="pre">'vmdk'</span></code>. (Default: depends on the hypervisor)</p> </dd> <dt>size</dt>
<dd>
<p>Disk size in MiB</p> </dd> <dt>pool</dt>
<dd>
<p>Path to the folder or name of the pool where disks should be created. (Default: depends on hypervisor and the virt:storagepool configuration)</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3001.</span></p> </div> <p>If the value contains no '/', it is considered a pool name where to create a volume. Using volumes will be mandatory for some pools types like rdb, iscsi, etc.</p> </dd> <dt>model</dt>
<dd>
<p>One of the disk busses allowed by libvirt (Default: depends on hypervisor)</p> <p>See the libvirt <a class="reference external" href="https://libvirt.org/formatdomain.html#elementsDisks">disk element</a> documentation for the allowed bus types.</p> </dd> <dt>image</dt>
<dd>
<p>Path to the image to use for the disk. If no image is provided, an empty disk will be created (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <p>Note that some pool types do not support uploading an image. This list can evolve with libvirt versions.</p> </dd> <dt>overlay_image</dt>
<dd>
<p><code class="docutils literal notranslate"><span class="pre">True</span></code> to create a QCOW2 disk image with <code class="docutils literal notranslate"><span class="pre">image</span></code> as backing file. If <code class="docutils literal notranslate"><span class="pre">False</span></code> the file pointed to by the <code class="docutils literal notranslate"><span class="pre">image</span></code> property will simply be copied. (Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3001.</span></p> </div> <p>This property is only valid on path-based disks, not on volumes. To create a volume with a backing store, set the <code class="docutils literal notranslate"><span class="pre">backing_store_path</span></code> and <code class="docutils literal notranslate"><span class="pre">backing_store_format</span></code> properties.</p> </dd> <dt>backing_store_path</dt>
<dd>
<p>Path to the backing store image to use. This can also be the name of a volume to use as backing store within the same pool.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd> <dt>backing_store_format</dt>
<dd>
<p>Image format of the disk or volume to use as backing store. This property is mandatory when using <code class="docutils literal notranslate"><span class="pre">backing_store_path</span></code> to avoid <a class="reference external" href="https://libvirt.org/kbase/backing_chains.html#troubleshooting">problems</a></p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd> <dt>source_file</dt>
<dd>
<p>Absolute path to the disk image to use. Not to be confused with <code class="docutils literal notranslate"><span class="pre">image</span></code> parameter. This parameter is useful to use disk images that are created outside of this module. Can also be <code class="docutils literal notranslate"><span class="pre">None</span></code> for devices that have no associated image like cdroms.</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3001.</span></p> </div> <p>For volume disks, this can be the name of a volume already existing in the storage pool.</p> </dd> <dt>device</dt>
<dd>
<p>Type of device of the disk. Can be one of 'disk', 'cdrom', 'floppy' or 'lun'. (Default: <code class="docutils literal notranslate"><span class="pre">'disk'</span></code>)</p> </dd> <dt>hostname_property</dt>
<dd>
<p>When using ZFS volumes, setting this value to a ZFS property ID will make Salt store the name of the virtual machine inside this property. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> </dd> <dt>sparse_volume</dt>
<dd>
<p>Boolean to specify whether to use a thin provisioned ZFS volume.</p> <p>Example profile for a bhyve VM with two ZFS disks. The first is cloned from the specified image. The second disk is a thin provisioned volume.</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
  disk:
    two_zvols:
      - system:
          image: zroot/bhyve/CentOS-7-x86_64-v1@v1.0.5
          hostname_property: virt:hostname
          pool: zroot/bhyve/guests
      - data:
          pool: tank/disks
          size: 20G
          hostname_property: virt:hostname
          sparse_volume: True</pre> </dd> <dt>io</dt>
<dd>
<p>I/O control policy. String value amongst <code class="docutils literal notranslate"><span class="pre">native</span></code>, <code class="docutils literal notranslate"><span class="pre">threads</span></code> and <code class="docutils literal notranslate"><span class="pre">io_uring</span></code>. (Default: <code class="docutils literal notranslate"><span class="pre">native</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd> <dt>iothread_id</dt>
<dd>
<p>I/O thread id to assign the disk to. (Default: none assigned)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd> </dl> <p class="rubric" id="init-graphics-def">Graphics Definition</p> <p>The graphics dictionary can have the following properties:</p> <dl> <dt>type</dt>
<dd>
<p>Graphics type. The possible values are <code class="docutils literal notranslate"><span class="pre">none</span></code>, <code class="docutils literal notranslate"><span class="pre">'spice'</span></code>, <code class="docutils literal notranslate"><span class="pre">'vnc'</span></code> and other values allowed as a libvirt graphics type (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <p>See the libvirt <a class="reference external" href="https://libvirt.org/formatdomain.html#elementsGraphics">graphics element</a> documentation for more details on the possible types.</p> </dd> <dt>port</dt>
<dd>
<p>Port to export the graphics on for <code class="docutils literal notranslate"><span class="pre">vnc</span></code>, <code class="docutils literal notranslate"><span class="pre">spice</span></code> and <code class="docutils literal notranslate"><span class="pre">rdp</span></code> types.</p> </dd> <dt>tls_port</dt>
<dd>
<p>Port to export the graphics over a secured connection for <code class="docutils literal notranslate"><span class="pre">spice</span></code> type.</p> </dd> <dt>listen</dt>
<dd>
<p>Dictionary defining on what address to listen on for <code class="docutils literal notranslate"><span class="pre">vnc</span></code>, <code class="docutils literal notranslate"><span class="pre">spice</span></code> and <code class="docutils literal notranslate"><span class="pre">rdp</span></code>. It has a <code class="docutils literal notranslate"><span class="pre">type</span></code> property with <code class="docutils literal notranslate"><span class="pre">address</span></code> and <code class="docutils literal notranslate"><span class="pre">None</span></code> as possible values, and an <code class="docutils literal notranslate"><span class="pre">address</span></code> property holding the IP or hostname to listen on.</p> <p>By default, not setting the <code class="docutils literal notranslate"><span class="pre">listen</span></code> part of the dictionary will default to listen on all addresses.</p> </dd> </dl> <p class="rubric" id="init-chardevs-def">Serials and Consoles Definitions</p> <p>Serial dictionaries can contain the following properties:</p> <dl class="simple"> <dt>type</dt>
<dd>
<p>Type of the serial connection, like <code class="docutils literal notranslate"><span class="pre">'tcp'</span></code>, <code class="docutils literal notranslate"><span class="pre">'pty'</span></code>, <code class="docutils literal notranslate"><span class="pre">'file'</span></code>, <code class="docutils literal notranslate"><span class="pre">'udp'</span></code>, <code class="docutils literal notranslate"><span class="pre">'dev'</span></code>, <code class="docutils literal notranslate"><span class="pre">'pipe'</span></code>, <code class="docutils literal notranslate"><span class="pre">'unix'</span></code>.</p> </dd> <dt>path</dt>
<dd>
<p>Path to the source device. Can be a log file, a host character device to pass through, a unix socket, a named pipe path.</p> </dd> <dt>host</dt>
<dd>
<p>The serial UDP or TCP host name. (Default: 23023)</p> </dd> <dt>port</dt>
<dd>
<p>The serial UDP or TCP port number. (Default: 23023)</p> </dd> <dt>protocol</dt>
<dd>
<p>Name of the TCP connection protocol. (Default: telnet)</p> </dd> <dt>tls</dt>
<dd>
<p>Boolean value indicating whether to use hypervisor TLS certificates environment for TCP devices.</p> </dd> <dt>target_port</dt>
<dd>
<p>The guest device port number starting from 0</p> </dd> <dt>target_type</dt>
<dd>
<p>The guest device type. Common values are <code class="docutils literal notranslate"><span class="pre">serial</span></code>, <code class="docutils literal notranslate"><span class="pre">virtio</span></code> or <code class="docutils literal notranslate"><span class="pre">usb-serial</span></code>, but more are documented in <a class="reference external" href="https://libvirt.org/formatdomain.html#consoles-serial-parallel-channel-devices">the libvirt documentation</a>.</p> </dd> </dl> <p class="rubric">CLI Example</p> <pre class="highlight-bash notranslate" data-language="bash">salt 'hypervisor' virt.init vm_name 4 512 salt://path/to/image.raw
salt 'hypervisor' virt.init vm_name 4 512 /var/lib/libvirt/images/img.raw
salt 'hypervisor' virt.init vm_name 4 512 nic=profile disk=profile</pre> <p>The disk images will be created in an image folder within the directory defined by the <code class="docutils literal notranslate"><span class="pre">virt:images</span></code> option. Its default value is <code class="docutils literal notranslate"><span class="pre">/srv/salt-images/</span></code> but this can changed with such a configuration:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
    images: /data/my/vm/images/</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.is_hyper"> salt.modules.virt.is_hyper()</h3> <dd>
<p>Returns a bool whether or not this node is a hypervisor of any kind</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.is_hyper</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.list_active_vms"> salt.modules.virt.list_active_vms(**kwargs)</h3> <dd>
<p>Return a list of names for active virtual machine on the minion</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.list_active_vms</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.list_domains"> salt.modules.virt.list_domains(**kwargs)</h3> <dd>
<p>Return a list of available domains.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.list_domains</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.list_inactive_vms"> salt.modules.virt.list_inactive_vms(**kwargs)</h3> <dd>
<p>Return a list of names for inactive virtual machine on the minion</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.list_inactive_vms</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.list_networks"> salt.modules.virt.list_networks(**kwargs)</h3> <dd>
<p>List all virtual networks.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.list_networks</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.list_pools"> salt.modules.virt.list_pools(**kwargs)</h3> <dd>
<p>List all storage pools.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.list_pools</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.list_snapshots"> salt.modules.virt.list_snapshots(domain=None, **kwargs)</h3> <dd>
<p>List available snapshots for certain vm or for all.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>domain</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.list_snapshots
salt '*' virt.list_snapshots &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.migrate"> salt.modules.virt.migrate(vm_, target, ssh=False, **kwargs)</h3> <dd>
<p>Shared storage migration</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li><p><strong>target</strong> -- target libvirt URI or host name</p></li> <li>
<p><strong>ssh</strong> -- </p>
<p>True to connect over ssh</p> <div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 3002.</span></p> </div> </li> <li>
<p><strong>kwargs</strong> -- </p>
<ul> <li><p>live: Use live migration. Default value is True.</p></li> <li>
<dl class="simple"> <dt>persistent: Leave the domain persistent on destination host.</dt>
<dd>
<p>Default value is True.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>undefinesource: Undefine the domain on the source host.</dt>
<dd>
<p>Default value is True.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>offline: If set to True it will migrate the domain definition</dt>
<dd>
<p>without starting the domain on destination and without stopping it on source host. Default value is False.</p> </dd> </dl> </li> <li><p>max_bandwidth: The maximum bandwidth (in MiB/s) that will be used.</p></li> <li>
<dl class="simple"> <dt>max_downtime: Set maximum tolerable downtime for live-migration.</dt>
<dd>
<p>The value represents a number of milliseconds the guest is allowed to be down at the end of live migration.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>parallel_connections: Specify a number of parallel network connections</dt>
<dd>
<p>to be used to send memory pages to the destination host.</p> </dd> </dl> </li> <li><p>compressed: Activate compression.</p></li> <li>
<dl class="simple"> <dt>comp_methods: A comma-separated list of compression methods. Supported</dt>
<dd>
<p>methods are "mt" and "xbzrle" and can be used in any combination. QEMU defaults to "xbzrle".</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>comp_mt_level: Set compression level. Values are in range from 0 to 9,</dt>
<dd>
<p>where 1 is maximum speed and 9 is maximum compression.</p> </dd> </dl> </li> <li><p>comp_mt_threads: Set number of compress threads on source host.</p></li> <li><p>comp_mt_dthreads: Set number of decompress threads on target host.</p></li> <li><p>comp_xbzrle_cache: Set the size of page cache for xbzrle compression in bytes.</p></li> <li>
<dl class="simple"> <dt>copy_storage: Migrate non-shared storage. It must be one of the following</dt>
<dd>
<p>values: all (full disk copy) or incremental (Incremental copy)</p> </dd> </dl> </li> <li><p>postcopy: Enable the use of post-copy migration.</p></li> <li><p>postcopy_bandwidth: The maximum bandwidth allowed in post-copy phase. (MiB/s)</p></li> <li><p>username: Username to connect with target host</p></li> <li><p>password: Password to connect with target host</p></li> </ul> <div class="versionadded"> <p><span class="versionmodified added">New in version 3002.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.migrate &lt;domain&gt; &lt;target hypervisor URI&gt;
salt src virt.migrate guest qemu+ssh://dst/system
salt src virt.migrate guest qemu+tls://dst/system
salt src virt.migrate guest qemu+tcp://dst/system</pre> <p>A tunnel data migration can be performed by setting this in the configuration:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
    tunnel: True</pre> <p>For more details on tunnelled data migrations, report to <a class="reference external" href="https://libvirt.org/migration.html#transporttunnel">https://libvirt.org/migration.html#transporttunnel</a></p> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.migrate_non_shared"> salt.modules.virt.migrate_non_shared(vm_, target, ssh=False, **kwargs)</h3> <dd>
<p>Attempt to execute non-shared storage "all" migration</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li><p><strong>target</strong> -- target libvirt host name</p></li> <li>
<p><strong>ssh</strong> -- </p>
<p>True to connect over ssh</p> <div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 3002.</span></p> </div> </li> <li>
<p><strong>kwargs</strong> -- </p>
<ul> <li><p>live: Use live migration. Default value is True.</p></li> <li>
<dl class="simple"> <dt>persistent: Leave the domain persistent on destination host.</dt>
<dd>
<p>Default value is True.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>undefinesource: Undefine the domain on the source host.</dt>
<dd>
<p>Default value is True.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>offline: If set to True it will migrate the domain definition</dt>
<dd>
<p>without starting the domain on destination and without stopping it on source host. Default value is False.</p> </dd> </dl> </li> <li><p>max_bandwidth: The maximum bandwidth (in MiB/s) that will be used.</p></li> <li>
<dl class="simple"> <dt>max_downtime: Set maximum tolerable downtime for live-migration.</dt>
<dd>
<p>The value represents a number of milliseconds the guest is allowed to be down at the end of live migration.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>parallel_connections: Specify a number of parallel network connections</dt>
<dd>
<p>to be used to send memory pages to the destination host.</p> </dd> </dl> </li> <li><p>compressed: Activate compression.</p></li> <li>
<dl class="simple"> <dt>comp_methods: A comma-separated list of compression methods. Supported</dt>
<dd>
<p>methods are "mt" and "xbzrle" and can be used in any combination. QEMU defaults to "xbzrle".</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>comp_mt_level: Set compression level. Values are in range from 0 to 9,</dt>
<dd>
<p>where 1 is maximum speed and 9 is maximum compression.</p> </dd> </dl> </li> <li><p>comp_mt_threads: Set number of compress threads on source host.</p></li> <li><p>comp_mt_dthreads: Set number of decompress threads on target host.</p></li> <li><p>comp_xbzrle_cache: Set the size of page cache for xbzrle compression in bytes.</p></li> <li><p>postcopy: Enable the use of post-copy migration.</p></li> <li><p>postcopy_bandwidth: The maximum bandwidth allowed in post-copy phase. (MiB/s)</p></li> <li><p>username: Username to connect with target host</p></li> <li><p>password: Password to connect with target host</p></li> </ul> <div class="versionadded"> <p><span class="versionmodified added">New in version 3002.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.migrate_non_shared &lt;vm name&gt; &lt;target hypervisor&gt;</pre> <p>A tunnel data migration can be performed by setting this in the configuration:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
    tunnel: True</pre> <p>For more details on tunnelled data migrations, report to <a class="reference external" href="https://libvirt.org/migration.html#transporttunnel">https://libvirt.org/migration.html#transporttunnel</a></p> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.migrate_non_shared_inc"> salt.modules.virt.migrate_non_shared_inc(vm_, target, ssh=False, **kwargs)</h3> <dd>
<p>Attempt to execute non-shared storage "inc" migration</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li><p><strong>target</strong> -- target libvirt host name</p></li> <li>
<p><strong>ssh</strong> -- </p>
<p>True to connect over ssh</p> <div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 3002.</span></p> </div> </li> <li>
<p><strong>kwargs</strong> -- </p>
<ul> <li><p>live: Use live migration. Default value is True.</p></li> <li>
<dl class="simple"> <dt>persistent: Leave the domain persistent on destination host.</dt>
<dd>
<p>Default value is True.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>undefinesource: Undefine the domain on the source host.</dt>
<dd>
<p>Default value is True.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>offline: If set to True it will migrate the domain definition</dt>
<dd>
<p>without starting the domain on destination and without stopping it on source host. Default value is False.</p> </dd> </dl> </li> <li><p>max_bandwidth: The maximum bandwidth (in MiB/s) that will be used.</p></li> <li>
<dl class="simple"> <dt>max_downtime: Set maximum tolerable downtime for live-migration.</dt>
<dd>
<p>The value represents a number of milliseconds the guest is allowed to be down at the end of live migration.</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>parallel_connections: Specify a number of parallel network connections</dt>
<dd>
<p>to be used to send memory pages to the destination host.</p> </dd> </dl> </li> <li><p>compressed: Activate compression.</p></li> <li>
<dl class="simple"> <dt>comp_methods: A comma-separated list of compression methods. Supported</dt>
<dd>
<p>methods are "mt" and "xbzrle" and can be used in any combination. QEMU defaults to "xbzrle".</p> </dd> </dl> </li> <li>
<dl class="simple"> <dt>comp_mt_level: Set compression level. Values are in range from 0 to 9,</dt>
<dd>
<p>where 1 is maximum speed and 9 is maximum compression.</p> </dd> </dl> </li> <li><p>comp_mt_threads: Set number of compress threads on source host.</p></li> <li><p>comp_mt_dthreads: Set number of decompress threads on target host.</p></li> <li><p>comp_xbzrle_cache: Set the size of page cache for xbzrle compression in bytes.</p></li> <li><p>postcopy: Enable the use of post-copy migration.</p></li> <li><p>postcopy_bandwidth: The maximum bandwidth allowed in post-copy phase. (MiB/s)</p></li> <li><p>username: Username to connect with target host</p></li> <li><p>password: Password to connect with target host</p></li> </ul> <div class="versionadded"> <p><span class="versionmodified added">New in version 3002.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.migrate_non_shared_inc &lt;vm name&gt; &lt;target hypervisor&gt;</pre> <p>A tunnel data migration can be performed by setting this in the configuration:</p> <pre class="highlight-yaml notranslate" data-language="yaml">virt:
    tunnel: True</pre> <p>For more details on tunnelled data migrations, report to <a class="reference external" href="https://libvirt.org/migration.html#transporttunnel">https://libvirt.org/migration.html#transporttunnel</a></p> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.migrate_start_postcopy"> salt.modules.virt.migrate_start_postcopy(vm_)</h3> <dd>
<p>Starts post-copy migration. This function has to be called while live migration is in progress and it has been initiated with the <cite>postcopy=True</cite> option.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.migrate_start_postcopy &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.nesthash"> salt.modules.virt.nesthash(value=None)</h3> <dd>
<p>create default dict that allows arbitrary level of nesting</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_define"> salt.modules.virt.network_define(name, bridge, forward, ipv4_config=None, ipv6_config=None, vport=None, tag=None, autostart=True, start=True, mtu=None, domain=None, nat=None, interfaces=None, addresses=None, physical_function=None, dns=None, **kwargs)</h3> <dd>
<p>Create libvirt network.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- Network name.</p></li> <li><p><strong>bridge</strong> -- Bridge name.</p></li> <li>
<p><strong>forward</strong> -- </p>
<p>Forward mode (bridge, router, nat).</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3003: </span>a <code class="docutils literal notranslate"><span class="pre">None</span></code> value creates an isolated network with no forwarding at all</p> </div> </li> <li>
<p><strong>vport</strong> -- </p>
<p>Virtualport type. The value can also be a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">parameters</span></code> keys. The <code class="docutils literal notranslate"><span class="pre">parameters</span></code> value is a dictionary of virtual port parameters.</p> <pre class="highlight-yaml notranslate" data-language="yaml">- vport:
    type: openvswitch
    parameters:
      interfaceid: 09b11c53-8b5c-4eeb-8f00-d84eaa0aaa4f</pre> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3003: </span>possible dictionary value</p> </div> </li> <li>
<p><strong>tag</strong> -- </p>
<p>Vlan tag. The value can also be a dictionary with the <code class="docutils literal notranslate"><span class="pre">tags</span></code> and optional <code class="docutils literal notranslate"><span class="pre">trunk</span></code> keys. <code class="docutils literal notranslate"><span class="pre">trunk</span></code> is a boolean value indicating whether to use VLAN trunking. <code class="docutils literal notranslate"><span class="pre">tags</span></code> is a list of dictionaries with keys <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">nativeMode</span></code>. The <code class="docutils literal notranslate"><span class="pre">nativeMode</span></code> value can be one of <code class="docutils literal notranslate"><span class="pre">tagged</span></code> or <code class="docutils literal notranslate"><span class="pre">untagged</span></code>.</p> <pre class="highlight-yaml notranslate" data-language="yaml">- tag:
    trunk: True
    tags:
      - id: 42
        nativeMode: untagged
      - id: 47</pre> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3003: </span>possible dictionary value</p> </div> </li> <li><p><strong>autostart</strong> -- Network autostart (default True).</p></li> <li><p><strong>start</strong> -- Network start (default True).</p></li> <li>
<p><strong>ipv4_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) -- </p>
<p>IP v4 configuration. Dictionary describing the IP v4 setup like IP range and a possible DHCP configuration. The structure is documented in <a class="reference internal" href="#net-define-ip">net-define-ip</a>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </li> <li>
<p><strong>ipv6_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) -- </p>
<p>IP v6 configuration. Dictionary describing the IP v6 setup like IP range and a possible DHCP configuration. The structure is documented in <a class="reference internal" href="#net-define-ip">net-define-ip</a>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults.</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults.</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults.</p></li> <li>
<p><strong>mtu</strong> -- </p>
<p>size of the Maximum Transmission Unit (MTU) of the network. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>domain</strong> -- </p>
<p>DNS domain name of the DHCP server. The value is a dictionary with a mandatory <code class="docutils literal notranslate"><span class="pre">name</span></code> property and an optional <code class="docutils literal notranslate"><span class="pre">localOnly</span></code> boolean one. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- domain:
    name: lab.acme.org
    localOnly: True</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>nat</strong> -- </p>
<p>addresses and ports to route in NAT forward mode. The value is a dictionary with optional keys <code class="docutils literal notranslate"><span class="pre">address</span></code> and <code class="docutils literal notranslate"><span class="pre">port</span></code>. Both values are a dictionary with <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> values. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: nat
- nat:
    address:
      start: 1.2.3.4
      end: 1.2.3.10
    port:
      start: 500
      end: 1000</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>interfaces</strong> -- </p>
<p>whitespace separated list of network interfaces devices that can be used for this network. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: passthrough
- interfaces: "eth10 eth11 eth12"</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>addresses</strong> -- </p>
<p>whitespace separated list of addreses of PCI devices that can be used for this network in <cite>hostdev</cite> forward mode. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: hostdev
- interfaces: "0000:04:00.1 0000:e3:01.2"</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>physical_function</strong> -- </p>
<p>device name of the physical interface to use in <code class="docutils literal notranslate"><span class="pre">hostdev</span></code> forward mode. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: hostdev
- physical_function: "eth0"</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>dns</strong> -- </p>
<p>virtual network DNS configuration. The value is a dictionary described in <a class="reference internal" href="#net-define-dns">net-define-dns</a>. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- dns:
    forwarders:
      - domain: example.com
        addr: 192.168.1.1
      - addr: 8.8.8.8
      - domain: www.example.com
    txt:
      example.com: "v=spf1 a -all"
      _http.tcp.example.com: "name=value,paper=A4"
    hosts:
      192.168.1.2:
        - mirror.acme.lab
        - test.acme.lab
    srvs:
      - name: ldap
        protocol: tcp
        domain: ldapserver.example.com
        target: .
        port: 389
        priority: 1
        weight: 10</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> </ul> </dd> </dl> <p class="rubric" id="net-define-ip">IP configuration definition</p> <p>Both the IPv4 and IPv6 configuration dictionaries can contain the following properties:</p> <dl> <dt>cidr</dt>
<dd>
<p>CIDR notation for the network. For example '192.168.124.0/24'</p> </dd> <dt>dhcp_ranges</dt>
<dd>
<p>A list of dictionaries with <code class="docutils literal notranslate"><span class="pre">'start'</span></code> and <code class="docutils literal notranslate"><span class="pre">'end'</span></code> properties.</p> </dd> <dt>hosts</dt>
<dd>
<p>A list of dictionaries with <code class="docutils literal notranslate"><span class="pre">ip</span></code> property and optional <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">mac</span></code> and <code class="docutils literal notranslate"><span class="pre">id</span></code> properties.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd> <dt>bootp</dt>
<dd>
<p>A dictionary with a <code class="docutils literal notranslate"><span class="pre">file</span></code> property and an optional <code class="docutils literal notranslate"><span class="pre">server</span></code> one.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd> <dt>tftp</dt>
<dd>
<p>The path to the TFTP root directory to serve.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd> </dl> <p class="rubric" id="net-define-dns">DNS configuration definition</p> <p>The DNS configuration dictionary contains the following optional properties:</p> <dl class="simple"> <dt>forwarders</dt>
<dd>
<p>List of alternate DNS forwarders to use. Each item is a dictionary with the optional <code class="docutils literal notranslate"><span class="pre">domain</span></code> and <code class="docutils literal notranslate"><span class="pre">addr</span></code> keys. If both are provided, the requests to the domain are forwarded to the server at the <code class="docutils literal notranslate"><span class="pre">addr</span></code>. If only <code class="docutils literal notranslate"><span class="pre">domain</span></code> is provided the requests matching this domain will be resolved locally. If only <code class="docutils literal notranslate"><span class="pre">addr</span></code> is provided all requests will be forwarded to this DNS server.</p> </dd> <dt>txt:</dt>
<dd>
<p>Dictionary of TXT fields to set.</p> </dd> <dt>hosts:</dt>
<dd>
<p>Dictionary of host DNS entries. The key is the IP of the host, and the value is a list of hostnames for it.</p> </dd> <dt>srvs:</dt>
<dd>
<p>List of SRV DNS entries. Each entry is a dictionary with the mandatory <code class="docutils literal notranslate"><span class="pre">name</span></code> and <code class="docutils literal notranslate"><span class="pre">protocol</span></code> keys. Entries can also have <code class="docutils literal notranslate"><span class="pre">target</span></code>, <code class="docutils literal notranslate"><span class="pre">port</span></code>, <code class="docutils literal notranslate"><span class="pre">priority</span></code>, <code class="docutils literal notranslate"><span class="pre">domain</span></code> and <code class="docutils literal notranslate"><span class="pre">weight</span></code> optional properties.</p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.network_define network main bridge openvswitch</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_get_xml"> salt.modules.virt.network_get_xml(name, **kwargs)</h3> <dd>
<p>Return the XML definition of a virtual network</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt network name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.network_get_xml default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_info"> salt.modules.virt.network_info(name=None, **kwargs)</h3> <dd>
<p>Return information on a virtual network provided its name.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- virtual network name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p>If no name is provided, return the infos for all defined virtual networks.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.network_info default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_set_autostart"> salt.modules.virt.network_set_autostart(name, state='on', **kwargs)</h3> <dd>
<p>Set the autostart flag on a virtual network so that the network will start with the host system on reboot.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- virtual network name</p></li> <li><p><strong>state</strong> -- 'on' to auto start the network, anything else to mark the virtual network not to be started when the host boots</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt "*" virt.network_set_autostart &lt;pool&gt; &lt;on | off&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_start"> salt.modules.virt.network_start(name, **kwargs)</h3> <dd>
<p>Start a defined virtual network.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- virtual network name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.network_start default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_stop"> salt.modules.virt.network_stop(name, **kwargs)</h3> <dd>
<p>Stop a defined virtual network.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- virtual network name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.network_stop default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_undefine"> salt.modules.virt.network_undefine(name, **kwargs)</h3> <dd>
<p>Remove a defined virtual network. This does not stop the virtual network.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- virtual network name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.network_undefine default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.network_update"> salt.modules.virt.network_update(name, bridge, forward, ipv4_config=None, ipv6_config=None, vport=None, tag=None, mtu=None, domain=None, nat=None, interfaces=None, addresses=None, physical_function=None, dns=None, test=False, **kwargs)</h3> <dd>
<p>Update a virtual network if needed.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- Network name.</p></li> <li><p><strong>bridge</strong> -- Bridge name.</p></li> <li><p><strong>forward</strong> -- Forward mode (bridge, router, nat). A <code class="docutils literal notranslate"><span class="pre">None</span></code> value creates an isolated network with no forwarding at all.</p></li> <li>
<p><strong>vport</strong> -- </p>
<p>Virtualport type. The value can also be a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">parameters</span></code> keys. The <code class="docutils literal notranslate"><span class="pre">parameters</span></code> value is a dictionary of virtual port parameters.</p> <pre class="highlight-yaml notranslate" data-language="yaml">- vport:
    type: openvswitch
    parameters:
      interfaceid: 09b11c53-8b5c-4eeb-8f00-d84eaa0aaa4f</pre> </li> <li>
<p><strong>tag</strong> -- </p>
<p>Vlan tag. The value can also be a dictionary with the <code class="docutils literal notranslate"><span class="pre">tags</span></code> and optional <code class="docutils literal notranslate"><span class="pre">trunk</span></code> keys. <code class="docutils literal notranslate"><span class="pre">trunk</span></code> is a boolean value indicating whether to use VLAN trunking. <code class="docutils literal notranslate"><span class="pre">tags</span></code> is a list of dictionaries with keys <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">nativeMode</span></code>. The <code class="docutils literal notranslate"><span class="pre">nativeMode</span></code> value can be one of <code class="docutils literal notranslate"><span class="pre">tagged</span></code> or <code class="docutils literal notranslate"><span class="pre">untagged</span></code>.</p> <pre class="highlight-yaml notranslate" data-language="yaml">- tag:
    trunk: True
    tags:
      - id: 42
        nativeMode: untagged
      - id: 47</pre> </li> <li><p><strong>ipv4_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) -- IP v4 configuration. Dictionary describing the IP v4 setup like IP range and a possible DHCP configuration. The structure is documented in <a class="reference internal" href="#net-define-ip">net-define-ip</a>.</p></li> <li><p><strong>ipv6_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.9)"><em>None</em></a>) -- IP v6 configuration. Dictionary describing the IP v6 setup like IP range and a possible DHCP configuration. The structure is documented in <a class="reference internal" href="#net-define-ip">net-define-ip</a>.</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults.</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults.</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults.</p></li> <li><p><strong>mtu</strong> -- size of the Maximum Transmission Unit (MTU) of the network. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li>
<p><strong>domain</strong> -- </p>
<p>DNS domain name of the DHCP server. The value is a dictionary with a mandatory <code class="docutils literal notranslate"><span class="pre">name</span></code> property and an optional <code class="docutils literal notranslate"><span class="pre">localOnly</span></code> boolean one. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- domain:
    name: lab.acme.org
    localOnly: True</pre> </li> <li>
<p><strong>nat</strong> -- </p>
<p>addresses and ports to route in NAT forward mode. The value is a dictionary with optional keys <code class="docutils literal notranslate"><span class="pre">address</span></code> and <code class="docutils literal notranslate"><span class="pre">port</span></code>. Both values are a dictionary with <code class="docutils literal notranslate"><span class="pre">start</span></code> and <code class="docutils literal notranslate"><span class="pre">end</span></code> values. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: nat
- nat:
    address:
      start: 1.2.3.4
      end: 1.2.3.10
    port:
      start: 500
      end: 1000</pre> </li> <li>
<p><strong>interfaces</strong> -- </p>
<p>whitespace separated list of network interfaces devices that can be used for this network. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: passthrough
- interfaces: "eth10 eth11 eth12"</pre> </li> <li>
<p><strong>addresses</strong> -- </p>
<p>whitespace separated list of addreses of PCI devices that can be used for this network in <cite>hostdev</cite> forward mode. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: hostdev
- interfaces: "0000:04:00.1 0000:e3:01.2"</pre> </li> <li>
<p><strong>physical_function</strong> -- </p>
<p>device name of the physical interface to use in <code class="docutils literal notranslate"><span class="pre">hostdev</span></code> forward mode. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- forward: hostdev
- physical_function: "eth0"</pre> </li> <li>
<p><strong>dns</strong> -- </p>
<p>virtual network DNS configuration. The value is a dictionary described in <a class="reference internal" href="#net-define-dns">net-define-dns</a>. (default <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <pre class="highlight-yaml notranslate" data-language="yaml">- dns:
    forwarders:
      - domain: example.com
        addr: 192.168.1.1
      - addr: 8.8.8.8
      - domain: www.example.com
    txt:
      example.com: "v=spf1 a -all"
      _http.tcp.example.com: "name=value,paper=A4"
    hosts:
      192.168.1.2:
        - mirror.acme.lab
        - test.acme.lab
    srvs:
      - name: ldap
        protocol: tcp
        domain: ldapserver.example.com
        target: .
        port: 389
        priority: 1
        weight: 10</pre> </li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.node_devices"> salt.modules.virt.node_devices(**kwargs)</h3> <dd>
<p>List the host available devices.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.node_info"> salt.modules.virt.node_info(**kwargs)</h3> <dd>
<p>Return a dict with information about this node</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.node_info</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pause"> salt.modules.virt.pause(vm_, **kwargs)</h3> <dd>
<p>Pause the named vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pause &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_build"> salt.modules.virt.pool_build(name, **kwargs)</h3> <dd>
<p>Build a defined libvirt storage pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_build default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_capabilities"> salt.modules.virt.pool_capabilities(**kwargs)</h3> <dd>
<p>Return the hypervisor connection storage pool capabilities.</p> <p>The returned data are either directly extracted from libvirt or computed. In the latter case some pool types could be listed as supported while they are not. To distinguish between the two cases, check the value of the <code class="docutils literal notranslate"><span class="pre">computed</span></code> property.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_capabilities</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_define"> salt.modules.virt.pool_define(name, ptype, target=None, permissions=None, source_devices=None, source_dir=None, source_initiator=None, source_adapter=None, source_hosts=None, source_auth=None, source_name=None, source_format=None, transient=False, start=True, **kwargs)</h3> <dd>
<p>Create libvirt pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- Pool name</p></li> <li><p><strong>ptype</strong> -- Pool type. See <a class="reference external" href="https://libvirt.org/storage.html">libvirt documentation</a> for the possible values.</p></li> <li><p><strong>target</strong> -- Pool full path target</p></li> <li><p><strong>permissions</strong> -- Permissions to set on the target folder. This is mostly used for filesystem-based pool types. See <a class="reference internal" href="#pool-define-permissions"><span class="std std-ref">Permissions definition</span></a> for more details on this structure.</p></li> <li>
<p><strong>source_devices</strong> -- </p>
<p>List of source devices for pools backed by physical devices. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <p>Each item in the list is a dictionary with <code class="docutils literal notranslate"><span class="pre">path</span></code> and optionally <code class="docutils literal notranslate"><span class="pre">part_separator</span></code> keys. The path is the qualified name for iSCSI devices.</p> <p>Report to <a class="reference external" href="https://libvirt.org/formatstorage.html#StoragePool">this libvirt page</a> for more information on the use of <code class="docutils literal notranslate"><span class="pre">part_separator</span></code></p> </li> <li><p><strong>source_dir</strong> -- Path to the source directory for pools of type <code class="docutils literal notranslate"><span class="pre">dir</span></code>, <code class="docutils literal notranslate"><span class="pre">netfs</span></code> or <code class="docutils literal notranslate"><span class="pre">gluster</span></code>. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li>
<p><strong>source_initiator</strong> -- </p>
<p>Initiator IQN for libiscsi-direct pool types. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </li> <li>
<p><strong>source_adapter</strong> -- </p>
<p>SCSI source definition. The value is a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">parent</span></code>, <code class="docutils literal notranslate"><span class="pre">managed</span></code>, <code class="docutils literal notranslate"><span class="pre">parent_wwnn</span></code>, <code class="docutils literal notranslate"><span class="pre">parent_wwpn</span></code>, <code class="docutils literal notranslate"><span class="pre">parent_fabric_wwn</span></code>, <code class="docutils literal notranslate"><span class="pre">wwnn</span></code>, <code class="docutils literal notranslate"><span class="pre">wwpn</span></code> and <code class="docutils literal notranslate"><span class="pre">parent_address</span></code> keys.</p> <p>The <code class="docutils literal notranslate"><span class="pre">parent_address</span></code> value is a dictionary with <code class="docutils literal notranslate"><span class="pre">unique_id</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code> keys. The address represents a PCI address and is itself a dictionary with <code class="docutils literal notranslate"><span class="pre">domain</span></code>, <code class="docutils literal notranslate"><span class="pre">bus</span></code>, <code class="docutils literal notranslate"><span class="pre">slot</span></code> and <code class="docutils literal notranslate"><span class="pre">function</span></code> properties. Report to <a class="reference external" href="https://libvirt.org/formatstorage.html#StoragePool">this libvirt page</a> for the meaning and possible values of these properties.</p> </li> <li><p><strong>source_hosts</strong> -- List of source for pools backed by storage from remote servers. Each item is the hostname optionally followed by the port separated by a colon. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li>
<p><strong>source_auth</strong> -- </p>
<p>Source authentication details. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <p>The value is a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">secret</span></code> keys. The type can be one of <code class="docutils literal notranslate"><span class="pre">ceph</span></code> for Ceph RBD or <code class="docutils literal notranslate"><span class="pre">chap</span></code> for iSCSI sources.</p> <p>The <code class="docutils literal notranslate"><span class="pre">secret</span></code> value links to a libvirt secret object. It is a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> keys. The type value can be either <code class="docutils literal notranslate"><span class="pre">uuid</span></code> or <code class="docutils literal notranslate"><span class="pre">usage</span></code>.</p> <p>Examples:</p> <pre class="highlight-python notranslate" data-language="python">source_auth={
    'type': 'ceph',
    'username': 'admin',
    'secret': {
        'type': 'uuid',
        'value': '2ec115d7-3a88-3ceb-bc12-0ac909a6fd87'
    }
}</pre> <pre class="highlight-python notranslate" data-language="python">source_auth={
    'type': 'chap',
    'username': 'myname',
    'secret': {
        'type': 'usage',
        'value': 'mycluster_myname'
    }
}</pre> <p>Since 3000, instead the source authentication can only contain <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">password</span></code> properties. In this case the libvirt secret will be defined and used. For Ceph authentications a base64 encoded key is expected.</p> </li> <li><p><strong>source_name</strong> -- Identifier of name-based sources.</p></li> <li>
<p><strong>source_format</strong> -- </p>
<p>String representing the source format. The possible values are depending on the source type. See <a class="reference external" href="https://libvirt.org/storage.html">libvirt documentation</a> for the possible values.</p> </li> <li><p><strong>start</strong> -- Pool start (default True)</p></li> <li><p><strong>transient</strong> -- When <code class="docutils literal notranslate"><span class="pre">True</span></code>, the pool will be automatically undefined after being stopped. Note that a transient pool will force <code class="docutils literal notranslate"><span class="pre">start</span></code> to <code class="docutils literal notranslate"><span class="pre">True</span></code>. (Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p class="rubric" id="pool-define-permissions">Permissions definition</p> <p>The permissions are described by a dictionary containing the following keys:</p> <dl class="simple"> <dt>mode</dt>
<dd>
<p>The octal representation of the permissions. (Default: <cite>0711</cite>)</p> </dd> <dt>owner</dt>
<dd>
<p>the numeric user ID of the owner. (Default: from the parent folder)</p> </dd> <dt>group</dt>
<dd>
<p>the numeric ID of the group. (Default: from the parent folder)</p> </dd> <dt>label</dt>
<dd>
<p>the SELinux label. (Default: <cite>None</cite>)</p> </dd> </dl> <p class="rubric">CLI Example:</p> <p>Local folder pool:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_define somepool dir target=/srv/mypool                                   permissions="{'mode': '0744' 'ower': 107, 'group': 107 }"</pre> <p>CIFS backed pool:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_define myshare netfs source_format=cifs                                   source_dir=samba_share source_hosts="['example.com']" target=/mnt/cifs</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_delete"> salt.modules.virt.pool_delete(name, **kwargs)</h3> <dd>
<p>Delete the resources of a defined libvirt storage pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_delete default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_get_xml"> salt.modules.virt.pool_get_xml(name, **kwargs)</h3> <dd>
<p>Return the XML definition of a virtual storage pool</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_get_xml default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_info"> salt.modules.virt.pool_info(name=None, **kwargs)</h3> <dd>
<p>Return information on a storage pool provided its name.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p>If no name is provided, return the infos for all defined storage pools.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_info default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_list_volumes"> salt.modules.virt.pool_list_volumes(name, **kwargs)</h3> <dd>
<p>List the volumes contained in a defined libvirt storage pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt "*" virt.pool_list_volumes &lt;pool&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_refresh"> salt.modules.virt.pool_refresh(name, **kwargs)</h3> <dd>
<p>Refresh a defined libvirt storage pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_refresh default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_set_autostart"> salt.modules.virt.pool_set_autostart(name, state='on', **kwargs)</h3> <dd>
<p>Set the autostart flag on a libvirt storage pool so that the storage pool will start with the host system on reboot.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>state</strong> -- 'on' to auto start the pool, anything else to mark the pool not to be started when the host boots</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt "*" virt.pool_set_autostart &lt;pool&gt; &lt;on | off&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_start"> salt.modules.virt.pool_start(name, **kwargs)</h3> <dd>
<p>Start a defined libvirt storage pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_start default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_stop"> salt.modules.virt.pool_stop(name, **kwargs)</h3> <dd>
<p>Stop a defined libvirt storage pool.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_stop default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_undefine"> salt.modules.virt.pool_undefine(name, **kwargs)</h3> <dd>
<p>Remove a defined libvirt storage pool. The pool needs to be stopped before calling.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- libvirt storage pool name</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_undefine default</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.pool_update"> salt.modules.virt.pool_update(name, ptype, target=None, permissions=None, source_devices=None, source_dir=None, source_initiator=None, source_adapter=None, source_hosts=None, source_auth=None, source_name=None, source_format=None, test=False, **kwargs)</h3> <dd>
<p>Update a libvirt storage pool if needed. If called with test=True, this is also reporting whether an update would be performed.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- Pool name</p></li> <li>
<p><strong>ptype</strong> -- </p>
<p>Pool type. See <a class="reference external" href="https://libvirt.org/storage.html">libvirt documentation</a> for the possible values.</p> </li> <li><p><strong>target</strong> -- Pool full path target</p></li> <li><p><strong>permissions</strong> -- Permissions to set on the target folder. This is mostly used for filesystem-based pool types. See <a class="reference internal" href="#pool-define-permissions"><span class="std std-ref">Permissions definition</span></a> for more details on this structure.</p></li> <li>
<p><strong>source_devices</strong> -- </p>
<p>List of source devices for pools backed by physical devices. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <p>Each item in the list is a dictionary with <code class="docutils literal notranslate"><span class="pre">path</span></code> and optionally <code class="docutils literal notranslate"><span class="pre">part_separator</span></code> keys. The path is the qualified name for iSCSI devices.</p> <p>Report to <a class="reference external" href="https://libvirt.org/formatstorage.html#StoragePool">this libvirt page</a> for more information on the use of <code class="docutils literal notranslate"><span class="pre">part_separator</span></code></p> </li> <li><p><strong>source_dir</strong> -- Path to the source directory for pools of type <code class="docutils literal notranslate"><span class="pre">dir</span></code>, <code class="docutils literal notranslate"><span class="pre">netfs</span></code> or <code class="docutils literal notranslate"><span class="pre">gluster</span></code>. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li>
<p><strong>source_initiator</strong> -- </p>
<p>Initiator IQN for libiscsi-direct pool types. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </li> <li>
<p><strong>source_adapter</strong> -- </p>
<p>SCSI source definition. The value is a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>, <code class="docutils literal notranslate"><span class="pre">parent</span></code>, <code class="docutils literal notranslate"><span class="pre">managed</span></code>, <code class="docutils literal notranslate"><span class="pre">parent_wwnn</span></code>, <code class="docutils literal notranslate"><span class="pre">parent_wwpn</span></code>, <code class="docutils literal notranslate"><span class="pre">parent_fabric_wwn</span></code>, <code class="docutils literal notranslate"><span class="pre">wwnn</span></code>, <code class="docutils literal notranslate"><span class="pre">wwpn</span></code> and <code class="docutils literal notranslate"><span class="pre">parent_address</span></code> keys.</p> <p>The <code class="docutils literal notranslate"><span class="pre">parent_address</span></code> value is a dictionary with <code class="docutils literal notranslate"><span class="pre">unique_id</span></code> and <code class="docutils literal notranslate"><span class="pre">address</span></code> keys. The address represents a PCI address and is itself a dictionary with <code class="docutils literal notranslate"><span class="pre">domain</span></code>, <code class="docutils literal notranslate"><span class="pre">bus</span></code>, <code class="docutils literal notranslate"><span class="pre">slot</span></code> and <code class="docutils literal notranslate"><span class="pre">function</span></code> properties. Report to <a class="reference external" href="https://libvirt.org/formatstorage.html#StoragePool">this libvirt page</a> for the meaning and possible values of these properties.</p> </li> <li><p><strong>source_hosts</strong> -- List of source for pools backed by storage from remote servers. Each item is the hostname optionally followed by the port separated by a colon. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li>
<p><strong>source_auth</strong> -- </p>
<p>Source authentication details. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <p>The value is a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code>, <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">secret</span></code> keys. The type can be one of <code class="docutils literal notranslate"><span class="pre">ceph</span></code> for Ceph RBD or <code class="docutils literal notranslate"><span class="pre">chap</span></code> for iSCSI sources.</p> <p>The <code class="docutils literal notranslate"><span class="pre">secret</span></code> value links to a libvirt secret object. It is a dictionary with <code class="docutils literal notranslate"><span class="pre">type</span></code> and <code class="docutils literal notranslate"><span class="pre">value</span></code> keys. The type value can be either <code class="docutils literal notranslate"><span class="pre">uuid</span></code> or <code class="docutils literal notranslate"><span class="pre">usage</span></code>.</p> <p>Examples:</p> <pre class="highlight-python notranslate" data-language="python">source_auth={
    'type': 'ceph',
    'username': 'admin',
    'secret': {
        'type': 'uuid',
        'uuid': '2ec115d7-3a88-3ceb-bc12-0ac909a6fd87'
    }
}</pre> <pre class="highlight-python notranslate" data-language="python">source_auth={
    'type': 'chap',
    'username': 'myname',
    'secret': {
        'type': 'usage',
        'uuid': 'mycluster_myname'
    }
}</pre> <p>Since 3000, instead the source authentication can only contain <code class="docutils literal notranslate"><span class="pre">username</span></code> and <code class="docutils literal notranslate"><span class="pre">password</span></code> properties. In this case the libvirt secret will be defined and used. For Ceph authentications a base64 encoded key is expected.</p> </li> <li><p><strong>source_name</strong> -- Identifier of name-based sources.</p></li> <li>
<p><strong>source_format</strong> -- </p>
<p>String representing the source format. The possible values are depending on the source type. See <a class="reference external" href="https://libvirt.org/storage.html">libvirt documentation</a> for the possible values.</p> </li> <li><p><strong>test</strong> -- run in dry-run mode if set to True</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p class="rubric">Example:</p> <p>Local folder pool:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_update somepool dir target=/srv/mypool                                   permissions="{'mode': '0744' 'ower': 107, 'group': 107 }"</pre> <p>CIFS backed pool:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.pool_update myshare netfs source_format=cifs                                   source_dir=samba_share source_hosts="['example.com']" target=/mnt/cifs</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.purge"> salt.modules.virt.purge(vm_, dirs=False, removables=False, **kwargs)</h3> <dd>
<p>Recursively destroy and delete a persistent virtual machine, pass True for dir's to also delete the directories containing the virtual machine disk images - USE WITH EXTREME CAUTION!</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li><p><strong>dirs</strong> -- pass True to remove containing directories</p></li> <li>
<p><strong>removables</strong> -- </p>
<p>pass True to remove removable devices</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.purge &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.reboot"> salt.modules.virt.reboot(name, **kwargs)</h3> <dd>
<p>Reboot a domain via ACPI request</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.reboot &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.reset"> salt.modules.virt.reset(vm_, **kwargs)</h3> <dd>
<p>Reset a VM by emulating the reset button on a physical machine</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.reset &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.resume"> salt.modules.virt.resume(vm_, **kwargs)</h3> <dd>
<p>Resume the named vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.resume &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.revert_snapshot"> salt.modules.virt.revert_snapshot(name, vm_snapshot=None, cleanup=False, **kwargs)</h3> <dd>
<p>Revert snapshot to the previous from current (if available) or to the specific.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- domain name</p></li> <li><p><strong>vm_snapshot</strong> -- name of the snapshot to revert</p></li> <li><p><strong>cleanup</strong> -- Remove all newer than reverted snapshots. Values: True or False (default False).</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.revert &lt;domain&gt;
salt '*' virt.revert &lt;domain&gt; &lt;snapshot&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.seed_non_shared_migrate"> salt.modules.virt.seed_non_shared_migrate(disks, force=False)</h3> <dd>
<p>Non shared migration requires that the disks be present on the migration destination, pass the disks information via this function, to the migration destination before executing the migration.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>disks</strong> -- the list of disk data as provided by virt.get_disks</p></li> <li><p><strong>force</strong> -- skip checking the compatibility of source and target disk images if True. (default: False)</p></li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.seed_non_shared_migrate &lt;disks&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.set_autostart"> salt.modules.virt.set_autostart(vm_, state='on', **kwargs)</h3> <dd>
<p>Set the autostart flag on a VM so that the VM will start with the host system on reboot.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li><p><strong>state</strong> -- 'on' to auto start the pool, anything else to mark the pool not to be started when the host boots</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt "*" virt.set_autostart &lt;domain&gt; &lt;on | off&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.setmem"> salt.modules.virt.setmem(vm_, memory, config=False, **kwargs)</h3> <dd>
<p>Changes the amount of memory allocated to VM. The VM must be shutdown for this to work.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li><p><strong>memory</strong> -- memory amount to set in MB</p></li> <li><p><strong>config</strong> -- if True then libvirt will be asked to modify the config as well</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.setmem &lt;domain&gt; &lt;size&gt;
salt '*' virt.setmem my_domain 768</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.setvcpus"> salt.modules.virt.setvcpus(vm_, vcpus, config=False, **kwargs)</h3> <dd>
<p>Changes the amount of vcpus allocated to VM. The VM must be shutdown for this to work.</p> <p>If config is True then we ask libvirt to modify the config as well</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li><p><strong>vcpus</strong> -- integer representing the number of CPUs to be assigned</p></li> <li><p><strong>config</strong> -- if True then libvirt will be asked to modify the config as well</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.setvcpus &lt;domain&gt; &lt;amount&gt;
salt '*' virt.setvcpus my_domain 4</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.shutdown"> salt.modules.virt.shutdown(vm_, **kwargs)</h3> <dd>
<p>Send a soft shutdown signal to the named vm</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.shutdown &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.snapshot"> salt.modules.virt.snapshot(domain, name=None, suffix=None, **kwargs)</h3> <dd>
<p>Create a snapshot of a VM.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>domain</strong> -- domain name</p></li> <li><p><strong>name</strong> -- Name of the snapshot. If the name is omitted, then will be used original domain name with ISO 8601 time as a suffix.</p></li> <li><p><strong>suffix</strong> -- Add suffix for the new name. Useful in states, where such snapshots can be distinguished from manually created.</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.3.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.snapshot &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.start"> salt.modules.virt.start(name, **kwargs)</h3> <dd>
<p>Start a defined domain</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.start &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.stop"> salt.modules.virt.stop(name, **kwargs)</h3> <dd>
<p>Hard power down the virtual machine, this is equivalent to pulling the power.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.stop &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.undefine"> salt.modules.virt.undefine(vm_, **kwargs)</h3> <dd>
<p>Remove a defined vm, this does not purge the virtual machine image, and this only works if the vm is powered down</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.undefine &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.update"> salt.modules.virt.update(name, cpu=0, mem=0, disk_profile=None, disks=None, nic_profile=None, interfaces=None, graphics=None, live=True, boot=None, numatune=None, test=False, boot_dev=None, hypervisor_features=None, clock=None, serials=None, consoles=None, stop_on_reboot=False, host_devices=None, **kwargs)</h3> <dd>
<p>Update the definition of an existing domain.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> -- Name of the domain to update</p></li> <li>
<p><strong>cpu</strong> -- </p>
<p>Number of virtual CPUs to assign to the virtual machine or a dictionary with detailed information to configure cpu model and topology, numa node tuning, cpu tuning and iothreads allocation. The structure of the dictionary is documented in <a class="reference internal" href="#init-cpu-def"><span class="std std-ref">cpu parameters definition</span></a>.</p> <p>To update any cpu parameters specify the new values to the corresponding tag. To remove any element or attribute, specify <code class="docutils literal notranslate"><span class="pre">None</span></code> object. Please note that <code class="docutils literal notranslate"><span class="pre">None</span></code> object is mapped to <code class="docutils literal notranslate"><span class="pre">null</span></code> in yaml, use <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file instead.</p> </li> <li>
<p><strong>mem</strong> -- </p>
<p>Amount of memory to allocate to the virtual machine in MiB. Since 3002, a dictionary can be used to contain detailed configuration which support memory allocation or tuning. Supported parameters are <code class="docutils literal notranslate"><span class="pre">boot</span></code>, <code class="docutils literal notranslate"><span class="pre">current</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>, <code class="docutils literal notranslate"><span class="pre">slots</span></code>, <code class="docutils literal notranslate"><span class="pre">hard_limit</span></code>, <code class="docutils literal notranslate"><span class="pre">soft_limit</span></code>, <code class="docutils literal notranslate"><span class="pre">swap_hard_limit</span></code>, <code class="docutils literal notranslate"><span class="pre">min_guarantee</span></code>, <code class="docutils literal notranslate"><span class="pre">hugepages</span></code> , <code class="docutils literal notranslate"><span class="pre">nosharepages</span></code>, <code class="docutils literal notranslate"><span class="pre">locked</span></code>, <code class="docutils literal notranslate"><span class="pre">source</span></code>, <code class="docutils literal notranslate"><span class="pre">access</span></code>, <code class="docutils literal notranslate"><span class="pre">allocation</span></code> and <code class="docutils literal notranslate"><span class="pre">discard</span></code>. The structure of the dictionary is documented in <a class="reference internal" href="#init-mem-def"><span class="std std-ref">Memory parameter definition</span></a>. Both decimal and binary base are supported. Detail unit specification is documented in <a class="reference internal" href="#virt-units"><span class="std std-ref">Units specification</span></a>. Please note that the value for <code class="docutils literal notranslate"><span class="pre">slots</span></code> must be an integer.</p> <p>To remove any parameters, pass a None object, for instance: 'soft_limit': <code class="docutils literal notranslate"><span class="pre">None</span></code>. Please note that <code class="docutils literal notranslate"><span class="pre">None</span></code> is mapped to <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file, pass <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file instead.</p> <pre class="highlight-yaml notranslate" data-language="yaml">- mem:
    hard_limit: null
    soft_limit: null</pre> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3002.</span></p> </div> </li> <li><p><strong>disk_profile</strong> -- disk profile to use</p></li> <li><p><strong>disks</strong> -- Disk definitions as documented in the <a class="reference internal" href="#salt.modules.virt.init" title="salt.modules.virt.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a> function. If neither the profile nor this parameter are defined, the disk devices will not be changed. However to clear disks set this parameter to empty list.</p></li> <li><p><strong>nic_profile</strong> -- network interfaces profile to use</p></li> <li><p><strong>interfaces</strong> -- Network interface definitions as documented in the <a class="reference internal" href="#salt.modules.virt.init" title="salt.modules.virt.init"><code class="xref py py-func docutils literal notranslate"><span class="pre">init()</span></code></a> function. If neither the profile nor this parameter are defined, the interface devices will not be changed. However to clear network interfaces set this parameter to empty list.</p></li> <li><p><strong>graphics</strong> -- The new graphics definition as defined in <a class="reference internal" href="#init-graphics-def"><span class="std std-ref">Graphics Definition</span></a>. If not set, the graphics will not be changed. To remove a graphics device, set this parameter to <code class="docutils literal notranslate"><span class="pre">{'type':</span> <span class="pre">'none'}</span></code>.</p></li> <li><p><strong>live</strong> -- <code class="docutils literal notranslate"><span class="pre">False</span></code> to avoid trying to live update the definition. In such a case, the new definition is applied at the next start of the virtual machine. If <code class="docutils literal notranslate"><span class="pre">True</span></code>, not all aspects of the definition can be live updated, but as much as possible will be attempted. (Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>)</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> <li>
<p><strong>boot</strong> -- </p>
<p>Specifies kernel, initial ramdisk and kernel command line parameters for the virtual machine. This is an optional parameter, all of the keys are optional within the dictionary.</p> <p>Refer to <a class="reference internal" href="#init-boot-def"><span class="std std-ref">Boot parameters definition</span></a> for the complete boot parameter description.</p> <p>To update any boot parameters, specify the new path for each. To remove any boot parameters, pass <code class="docutils literal notranslate"><span class="pre">None</span></code> object, for instance: 'kernel': <code class="docutils literal notranslate"><span class="pre">None</span></code>. To switch back to BIOS boot, specify ('loader': <code class="docutils literal notranslate"><span class="pre">None</span></code> and 'nvram': <code class="docutils literal notranslate"><span class="pre">None</span></code>) or 'efi': <code class="docutils literal notranslate"><span class="pre">False</span></code>. Please note that <code class="docutils literal notranslate"><span class="pre">None</span></code> is mapped to <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file, pass <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file instead.</p> <p>SLS file Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">- boot:
    loader: null
    nvram: null</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> </li> <li>
<p><strong>boot_dev</strong> -- </p>
<p>Space separated list of devices to boot from sorted by decreasing priority. Values can be <code class="docutils literal notranslate"><span class="pre">hd</span></code>, <code class="docutils literal notranslate"><span class="pre">fd</span></code>, <code class="docutils literal notranslate"><span class="pre">cdrom</span></code> or <code class="docutils literal notranslate"><span class="pre">network</span></code>.</p> <p>By default, the value will <code class="docutils literal notranslate"><span class="pre">"hd"</span></code>.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3002.</span></p> </div> </li> <li>
<p><strong>numatune</strong> -- </p>
<p>The optional numatune element provides details of how to tune the performance of a NUMA host via controlling NUMA policy for domain process. The optional <code class="docutils literal notranslate"><span class="pre">memory</span></code> element specifies how to allocate memory for the domain process on a NUMA host. <code class="docutils literal notranslate"><span class="pre">memnode</span></code> elements can specify memory allocation policies per each guest NUMA node. The definition used in the dictionary can be found at <a class="reference internal" href="#init-cpu-def"><span class="std std-ref">cpu parameters definition</span></a>.</p> <p>To update any numatune parameters, specify the new value. To remove any <code class="docutils literal notranslate"><span class="pre">numatune</span></code> parameters, pass a None object, for instance: 'numatune': <code class="docutils literal notranslate"><span class="pre">None</span></code>. Please note that <code class="docutils literal notranslate"><span class="pre">None</span></code> is mapped to <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file, pass <code class="docutils literal notranslate"><span class="pre">null</span></code> in sls file instead.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>serials</strong> -- </p>
<p>Dictionary providing details on the serials connection to create. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) See <a class="reference internal" href="#init-chardevs-def"><span class="std std-ref">Serials and Consoles Definitions</span></a> for more details on the possible values.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>consoles</strong> -- </p>
<p>Dictionary providing details on the consoles device to create. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>) See <a class="reference internal" href="#init-chardevs-def"><span class="std std-ref">Serials and Consoles Definitions</span></a> for more details on the possible values.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>stop_on_reboot</strong> -- </p>
<p>If set to <code class="docutils literal notranslate"><span class="pre">True</span></code> the guest will stop instead of rebooting. This is specially useful when creating a virtual machine with an installation cdrom or an autoinstallation needing a special first boot configuration. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code></p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> <li>
<p><strong>test</strong> -- </p>
<p>run in dry-run mode if set to True</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </li> <li>
<p><strong>hypervisor_features</strong> -- </p>
<p>Enable or disable hypervisor-specific features on the virtual machine.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> <pre class="highlight-yaml notranslate" data-language="yaml">hypervisor_features:
  kvm-hint-dedicated: True</pre> </li> <li>
<p><strong>clock</strong> -- </p>
<p>Configure the guest clock. The value is a dictionary with the following keys:</p> <dl class="simple"> <dt>adjustment</dt>
<dd>
<p>time adjustment in seconds or <code class="docutils literal notranslate"><span class="pre">reset</span></code></p> </dd> <dt>utc</dt>
<dd>
<p>set to <code class="docutils literal notranslate"><span class="pre">False</span></code> to use the host local time as the guest clock. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p> </dd> <dt>timezone</dt>
<dd>
<p>synchronize the guest to the correspding timezone</p> </dd> <dt>timers</dt>
<dd>
<p>a dictionary associating the timer name with its configuration. This configuration is a dictionary with the properties <code class="docutils literal notranslate"><span class="pre">track</span></code>, <code class="docutils literal notranslate"><span class="pre">tickpolicy</span></code>, <code class="docutils literal notranslate"><span class="pre">catchup</span></code>, <code class="docutils literal notranslate"><span class="pre">frequency</span></code>, <code class="docutils literal notranslate"><span class="pre">mode</span></code>, <code class="docutils literal notranslate"><span class="pre">present</span></code>, <code class="docutils literal notranslate"><span class="pre">slew</span></code>, <code class="docutils literal notranslate"><span class="pre">threshold</span></code> and <code class="docutils literal notranslate"><span class="pre">limit</span></code>. See <a class="reference external" href="https://libvirt.org/formatdomain.html#time-keeping">libvirt time keeping documentation</a> for the possible values.</p> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> <p>Set the clock to local time using an offset in seconds .. code-block:: yaml</p> <blockquote> <div>
<dl class="simple"> <dt>clock:</dt>
<dd>
<p>adjustment: 3600 utc: False</p> </dd> </dl> </div>
</blockquote> <p>Set the clock to a specific time zone:</p> <pre class="highlight-yaml notranslate" data-language="yaml">clock:
  timezone: CEST</pre> <p>Tweak guest timers:</p> <pre class="highlight-yaml notranslate" data-language="yaml">clock:
  timers:
    tsc:
      frequency: 3504000000
      mode: native
    rtc:
      track: wall
      tickpolicy: catchup
      slew: 4636
      threshold: 123
      limit: 2342
    hpet:
      present: False</pre> </li> <li>
<p><strong>host_devices</strong> -- </p>
<p>List of host devices to passthrough to the guest. The value is a list of device names as provided by the <a class="reference internal" href="#salt.modules.virt.node_devices" title="salt.modules.virt.node_devices"><code class="xref py py-func docutils literal notranslate"><span class="pre">node_devices()</span></code></a> function. (Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 3003.</span></p> </div> </li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">

<p>Returns a dictionary indicating the status of what has been done. It is structured in the following way:</p> <pre class="highlight-python notranslate" data-language="python">{
  'definition': True,
  'cpu': True,
  'mem': True,
  'disks': {'attached': [list of actually attached disks],
            'detached': [list of actually detached disks]},
  'nics': {'attached': [list of actually attached nics],
           'detached': [list of actually detached nics]},
  'errors': ['error messages for failures']
}</pre> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.update domain cpu=2 mem=1024</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.virt_type"> salt.modules.virt.virt_type()</h3> <dd>
<p>Returns the virtual machine type as a string</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.virt_type</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.vm_cputime"> salt.modules.virt.vm_cputime(vm_=None, **kwargs)</h3> <dd>
<p>Return cputime used by the vms on this hyper in a list of dicts:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <pre class="highlight-python notranslate" data-language="python">[
    'your-vm': {
        'cputime' &lt;int&gt;
        'cputime_percent' &lt;int&gt;
        },
    ...
    ]</pre> <p>If you pass a VM name in as an argument then it will return info for just the named VM, otherwise it will return all VMs.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.vm_cputime</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.vm_diskstats"> salt.modules.virt.vm_diskstats(vm_=None, **kwargs)</h3> <dd>
<p>Return disk usage counters used by the vms on this hyper in a list of dicts:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <pre class="highlight-python notranslate" data-language="python">[
    'your-vm': {
        'rd_req'   : 0,
        'rd_bytes' : 0,
        'wr_req'   : 0,
        'wr_bytes' : 0,
        'errs'     : 0
        },
    ...
    ]</pre> <p>If you pass a VM name in as an argument then it will return info for just the named VM, otherwise it will return all VMs.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.vm_blockstats</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.vm_info"> salt.modules.virt.vm_info(vm_=None, **kwargs)</h3> <dd>
<p>Return detailed information about the vms on this hyper in a list of dicts:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <pre class="highlight-python notranslate" data-language="python">[
    'your-vm': {
        'cpu': &lt;int&gt;,
        'maxMem': &lt;int&gt;,
        'mem': &lt;int&gt;,
        'state': '&lt;state&gt;',
        'cputime' &lt;int&gt;
        },
    ...
    ]</pre> <p>If you pass a VM name in as an argument then it will return info for just the named VM, otherwise it will return all VMs.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.vm_info</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.vm_netstats"> salt.modules.virt.vm_netstats(vm_=None, **kwargs)</h3> <dd>
<p>Return combined network counters used by the vms on this hyper in a list of dicts:</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- domain name</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <pre class="highlight-python notranslate" data-language="python">[
    'your-vm': {
        'rx_bytes'   : 0,
        'rx_packets' : 0,
        'rx_errs'    : 0,
        'rx_drop'    : 0,
        'tx_bytes'   : 0,
        'tx_packets' : 0,
        'tx_errs'    : 0,
        'tx_drop'    : 0
        },
    ...
    ]</pre> <p>If you pass a VM name in as an argument then it will return info for just the named VM, otherwise it will return all VMs.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.vm_netstats</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.vm_state"> salt.modules.virt.vm_state(vm_=None, **kwargs)</h3> <dd>
<p>Return list of all the vms and their state.</p> <p>If you pass a VM name in as an argument then it will return info for just the named VM, otherwise it will return all VMs.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>vm</strong> -- name of the domain</p></li> <li>
<p><strong>connection</strong> -- </p>
<p>libvirt connection URI, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>username</strong> -- </p>
<p>username to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> <li>
<p><strong>password</strong> -- </p>
<p>password to connect with, overriding defaults</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> </li> </ul> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.vm_state &lt;domain&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.volume_define"> salt.modules.virt.volume_define(pool, name, size, allocation=0, format=None, type=None, permissions=None, backing_store=None, nocow=False, **kwargs)</h3> <dd>
<p>Create libvirt volume.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>pool</strong> -- name of the pool to create the volume in</p></li> <li><p><strong>name</strong> -- name of the volume to define</p></li> <li><p><strong>size</strong> -- capacity of the volume to define in MiB</p></li> <li><p><strong>allocation</strong> -- allocated size of the volume in MiB. Defaults to 0.</p></li> <li><p><strong>format</strong> -- volume format. The allowed values are depending on the pool type. Check the virt.pool_capabilities output for the possible values and the default.</p></li> <li><p><strong>type</strong> -- type of the volume. One of file, block, dir, network, netdiri, ploop or None. By default, the type is guessed by libvirt from the pool type.</p></li> <li><p><strong>permissions</strong> -- Permissions to set on the target folder. This is mostly used for filesystem-based pool types. See <a class="reference internal" href="#pool-define-permissions"><span class="std std-ref">Permissions definition</span></a> for more details on this structure.</p></li> <li>
<p><strong>backing_store</strong> -- </p>
<p>dictionary describing a backing file for the volume. It must contain a <code class="docutils literal notranslate"><span class="pre">path</span></code> property pointing to the base volume and a <code class="docutils literal notranslate"><span class="pre">format</span></code> property defining the format of the base volume.</p> <p>The base volume format will not be guessed for security reasons and is thus mandatory.</p> </li> <li><p><strong>nocow</strong> -- disable COW for the volume.</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p class="rubric">CLI Example:</p> <p>Volume on ESX:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.volume_define "[local-storage]" myvm/myvm.vmdk vmdk 8192</pre> <p>QCow2 volume with backing file:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.volume_define default myvm.qcow2 qcow2 8192                             permissions="{'mode': '0775', 'owner': '123', 'group': '345'"}"                             backing_store="{'path': '/path/to/base.img', 'format': 'raw'}"                             nocow=True</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.volume_delete"> salt.modules.virt.volume_delete(pool, volume, **kwargs)</h3> <dd>
<p>Delete a libvirt managed volume.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>pool</strong> -- libvirt storage pool name</p></li> <li><p><strong>volume</strong> -- name of the volume to delete</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt "*" virt.volume_delete &lt;pool&gt; &lt;volume&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.volume_infos"> salt.modules.virt.volume_infos(pool=None, volume=None, **kwargs)</h3> <dd>
<p>Provide details on a storage volume. If no volume name is provided, the infos all the volumes contained in the pool are provided. If no pool is provided, the infos of the volumes of all pools are output.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>pool</strong> -- libvirt storage pool name (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li><p><strong>volume</strong> -- name of the volume to get infos from (default: <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3000.</span></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt "*" virt.volume_infos &lt;pool&gt; &lt;volume&gt;</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.virt.volume_upload"> salt.modules.virt.volume_upload(pool, volume, file, offset=0, length=0, sparse=False, **kwargs)</h3> <dd>
<p>Create libvirt volume.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>pool</strong> -- name of the pool to create the volume in</p></li> <li><p><strong>name</strong> -- name of the volume to define</p></li> <li><p><strong>file</strong> -- the file to upload to the volume</p></li> <li><p><strong>offset</strong> -- where to start writing the data in the volume</p></li> <li><p><strong>length</strong> -- amount of bytes to transfer to the volume</p></li> <li><p><strong>sparse</strong> -- set to True to preserve data sparsiness.</p></li> <li><p><strong>connection</strong> -- libvirt connection URI, overriding defaults</p></li> <li><p><strong>username</strong> -- username to connect with, overriding defaults</p></li> <li><p><strong>password</strong> -- password to connect with, overriding defaults</p></li> </ul> </dd> </dl> <p class="rubric">CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' virt.volume_upload default myvm.qcow2 /path/to/disk.qcow2</pre> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.virt.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.virt.html</a>
  </p>
</div>
