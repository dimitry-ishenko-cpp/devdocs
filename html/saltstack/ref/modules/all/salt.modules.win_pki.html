<h1>salt.modules.win_pki</h1> <p>Microsoft certificate management via the PKI Client PowerShell module. <a class="reference external" href="https://technet.microsoft.com/en-us/itpro/powershell/windows/pkiclient/pkiclient">https://technet.microsoft.com/en-us/itpro/powershell/windows/pkiclient/pkiclient</a></p> <p>The PKI Client PowerShell module is only available on Windows 8+ and Windows Server 2012+. <a class="reference external" href="https://technet.microsoft.com/en-us/library/hh848636(v=wps.620).aspx">https://technet.microsoft.com/en-us/library/hh848636(v=wps.620).aspx</a></p> <dl class="field-list simple"> <dt class="field-odd">platform</dt> <dd class="field-odd">
<p>Windows</p> </dd> <dt class="field-even">depends</dt> <dd class="field-even">
<ul class="simple"> <li><p>PowerShell 4</p></li> <li><p>PKI Client Module (Windows 8+ / Windows Server 2012+)</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> <dl class="py function"> <h3 id="salt.modules.win_pki.export_cert"> salt.modules.win_pki.export_cert(name, thumbprint, cert_format='cer', context='LocalMachine', store='My', password='')</h3> <dd>
<p>Export the certificate to a file from the given certificate store.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The destination path for the exported certificate file.</p></li> <li><p><strong>thumbprint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The thumbprint value of the target certificate.</p></li> <li><p><strong>cert_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The certificate format. Specify 'cer' for X.509, or 'pfx' for PKCS #12.</p></li> <li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store location context.</p></li> <li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store.</p></li> <li><p><strong>password</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The password of the certificate. Only applicable to pfx format. Note that if used interactively, the password will be seen by all minions. To protect the password, use a state and get the password from pillar.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A boolean representing whether all changes succeeded.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.export_cert name='C:\certs\example.cer' thumbprint='AAA000'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pki.get_cert_file"> salt.modules.win_pki.get_cert_file(name, cert_format='cer', password='')</h3> <dd>
<p>Get the details of the certificate file.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The filesystem path of the certificate file.</p></li> <li><p><strong>cert_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The certificate format. Specify 'cer' for X.509, or 'pfx' for PKCS #12.</p></li> <li><p><strong>password</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The password of the certificate. Only applicable to pfx format. Note that if used interactively, the password will be seen by all minions. To protect the password, use a state and get the password from pillar.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A dictionary of the certificate thumbprints and properties.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.get_cert_file name='C:\certs\example.cer'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pki.get_certs"> salt.modules.win_pki.get_certs(context='LocalMachine', store='My')</h3> <dd>
<p>Get the available certificates in the given store.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store location context.</p></li> <li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A dictionary of the certificate thumbprints and properties.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.get_certs</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pki.get_stores"> salt.modules.win_pki.get_stores()</h3> <dd>
<p>Get the certificate location contexts and their corresponding stores.</p> <dl class="field-list simple"> <dt class="field-odd">Returns</dt> <dd class="field-odd">
<p>A dictionary of the certificate location contexts and stores.</p> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.get_stores</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pki.import_cert"> salt.modules.win_pki.import_cert(name, cert_format='cer', context='LocalMachine', store='My', exportable=True, password='', saltenv='base')</h3> <dd>
<p>Import the certificate file into the given certificate store.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The path of the certificate file to import.</p></li> <li><p><strong>cert_format</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The certificate format. Specify 'cer' for X.509, or 'pfx' for PKCS #12.</p></li> <li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store location context.</p></li> <li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store.</p></li> <li><p><strong>exportable</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Mark the certificate as exportable. Only applicable to pfx format.</p></li> <li><p><strong>password</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The password of the certificate. Only applicable to pfx format. Note that if used interactively, the password will be seen by all minions. To protect the password, use a state and get the password from pillar.</p></li> <li><p><strong>saltenv</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The environment the file resides in.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A boolean representing whether all changes succeeded.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.import_cert name='salt://cert.cer'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pki.remove_cert"> salt.modules.win_pki.remove_cert(thumbprint, context='LocalMachine', store='My')</h3> <dd>
<p>Remove the certificate from the given certificate store.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>thumbprint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The thumbprint value of the target certificate.</p></li> <li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store location context.</p></li> <li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A boolean representing whether all changes succeeded.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.remove_cert thumbprint='AAA000'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.modules.win_pki.test_cert"> salt.modules.win_pki.test_cert(thumbprint, context='LocalMachine', store='My', untrusted_root=False, dns_name='', eku='')</h3> <dd>
<p>Check the certificate for validity.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>thumbprint</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The thumbprint value of the target certificate.</p></li> <li><p><strong>context</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store location context.</p></li> <li><p><strong>store</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the certificate store.</p></li> <li><p><strong>untrusted_root</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Whether the root certificate is required to be trusted in chain building.</p></li> <li><p><strong>dns_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The DNS name to verify as valid for the certificate.</p></li> <li><p><strong>eku</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The enhanced key usage object identifiers to verify for the certificate chain.</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A boolean representing whether the certificate was considered valid.</p> </dd> <dt class="field-odd">Return type</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)">bool</a></p> </dd> </dl> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt '*' win_pki.test_cert thumbprint='AAA000' dns_name='example.test'</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_pki.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/modules/all/salt.modules.win_pki.html</a>
  </p>
</div>
