<h1>salt.tops.mongo</h1> <p>Read tops data from a mongodb collection</p> <p>This module will load tops data from a mongo collection. It uses the node's id for lookups.</p> <div class="section" id="salt-master-mongo-configuration"> <h2>Salt Master Mongo Configuration</h2> <p>The module shares the same base mongo connection variables as <a class="reference internal" href="../../returners/all/salt.returners.mongo_return.html#module-salt.returners.mongo_return" title="salt.returners.mongo_return"><code class="xref py py-mod docutils literal notranslate"><span class="pre">salt.returners.mongo_return</span></code></a>. These variables go in your master config file.</p> <blockquote> <div>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">mongo.db</span></code> - The mongo database to connect to. Defaults to <code class="docutils literal notranslate"><span class="pre">'salt'</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">mongo.host</span></code> - The mongo host to connect to. Supports replica sets by specifying all hosts in the set, comma-delimited. Defaults to <code class="docutils literal notranslate"><span class="pre">'salt'</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">mongo.port</span></code> - The port that the mongo database is running on. Defaults to <code class="docutils literal notranslate"><span class="pre">27017</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">mongo.user</span></code> - The username for connecting to mongo. Only required if you are using mongo authentication. Defaults to <code class="docutils literal notranslate"><span class="pre">''</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">mongo.password</span></code> - The password for connecting to mongo. Only required if you are using mongo authentication. Defaults to <code class="docutils literal notranslate"><span class="pre">''</span></code>.</p></li> </ul> </div>
</blockquote> </div> <div class="section" id="configuring-the-mongo-tops-subsystem"> <h2>Configuring the Mongo Tops Subsystem</h2> <pre class="highlight-yaml notranslate" data-language="yaml">master_tops:
  mongo:
    collection: tops
    id_field: _id
    re_replace: ""
    re_pattern: \.example\.com
    states_field: states
    environment_field: environment</pre> </div> <div class="section" id="module-documentation"> <h2>Module Documentation</h2> <dl class="py function"> <h3 id="salt.tops.mongo.top"> salt.tops.mongo.top(**kwargs)</h3> <dd>
<p>Connect to a mongo database and read per-node tops data.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>collection</strong> (<em>*</em>) -- The mongodb collection to read data from. Defaults to <code class="docutils literal notranslate"><span class="pre">'tops'</span></code>.</p></li> <li><p><strong>id_field</strong> (<em>*</em>) -- The field in the collection that represents an individual minion id. Defaults to <code class="docutils literal notranslate"><span class="pre">'_id'</span></code>.</p></li> <li><p><strong>re_pattern</strong> (<em>*</em>) -- If your naming convention in the collection is shorter than the minion id, you can use this to trim the name. <cite>re_pattern</cite> will be used to match the name, and <cite>re_replace</cite> will be used to replace it. Backrefs are supported as they are in the Python standard library. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, no mangling of the name will be performed - the collection will be searched with the entire minion id. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li> <li><p><strong>re_replace</strong> (<em>*</em>) -- Use as the replacement value in node ids matched with <cite>re_pattern</cite>. Defaults to ''. Feel free to use backreferences here.</p></li> <li><p><strong>states_field</strong> (<em>*</em>) -- The name of the field providing a list of states.</p></li> <li><p><strong>environment_field</strong> (<em>*</em>) -- The name of the field providing the environment. Defaults to <code class="docutils literal notranslate"><span class="pre">environment</span></code>.</p></li> </ul> </dd> </dl> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/tops/all/salt.tops.mongo.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/tops/all/salt.tops.mongo.html</a>
  </p>
</div>
