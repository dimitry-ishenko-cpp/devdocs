<h1>salt.states.boto3_elasticsearch</h1> <div class="section" id="manage-elasticsearch-service"> <h2>Manage Elasticsearch Service</h2> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <dl class="field-list"> <dt class="field-odd">configuration</dt> <dd class="field-odd">
<p>This module accepts explicit AWS credentials but can also utilize IAM roles assigned to the instance trough Instance Profiles. Dynamic credentials are then automatically obtained from AWS API and no further configuration is necessary. More Information available at:</p> <pre class="highlight-text notranslate" data-language="text">http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html</pre> <p>If IAM roles are not used you need to specify them either in a pillar or in the minion's config file:</p> <pre class="highlight-yaml notranslate" data-language="yaml">es.keyid: GKTADJGHEIQSXMKKRBJ08H
es.key: askdjghsdfjkghWupUjasdflkdfklgjsdfjajkghs</pre> <p>A region may also be specified in the configuration:</p> <pre class="highlight-yaml notranslate" data-language="yaml">es.region: us-east-1</pre> <p>If a region is not specified, the default is us-east-1.</p> <p>It's also possible to specify key, keyid and region via a profile, either as a passed in dict, or as a string to pull from pillars or minion config:</p> <pre class="highlight-yaml notranslate" data-language="yaml">myprofile:
    keyid: GKTADJGHEIQSXMKKRBJ08H
    key: askdjghsdfjkghWupUjasdflkdfklgjsdfjajkghs
    region: us-east-1</pre> </dd> <dt class="field-even">codeauthor</dt> <dd class="field-even">
<p>Herbert Buurman &lt;<a class="reference external" href="mailto:herbert.buurman%40ogd.nl.html">herbert<span>.</span>buurman<span>@</span>ogd<span>.</span>nl</a>&gt;</p> </dd> <dt class="field-odd">depends</dt> <dd class="field-odd">
<p>boto3</p> </dd> </dl> <dl class="py function"> <h3 id="salt.states.boto3_elasticsearch.absent"> salt.states.boto3_elasticsearch.absent(name, blocking=True, region=None, keyid=None, key=None, profile=None)</h3> <dd>
<p>Ensure the Elasticsearch Domain specified does not exist.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the Elasticsearch domain to be made absent.</p></li> <li><p><strong>blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Whether or not the state should wait for the deletion to be completed. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <p>Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">Remove Elasticsearch Domain:
  boto3_elasticsearch.absent:
  - name: my_domain
  - region: eu-west-1</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.states.boto3_elasticsearch.latest"> salt.states.boto3_elasticsearch.latest(name, minor_only=True, region=None, keyid=None, key=None, profile=None)</h3> <dd>
<p>Ensures the Elasticsearch domain specifies runs on the latest compatible version of elasticsearch, upgrading it if it is not.</p> <p>Note that this operation is blocking until the upgrade is complete.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the Elasticsearch domain to upgrade.</p></li> <li><p><strong>minor_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Only upgrade to the latest minor version.</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <p>Example:</p> <p>The following example will ensure the elasticsearch domain <code class="docutils literal notranslate"><span class="pre">my_domain</span></code> is upgraded to the latest minor version. So if it is currently 5.1 it will be upgraded to 5.6.</p> <pre class="highlight-yaml notranslate" data-language="yaml">Upgrade Elasticsearch Domain:
  boto3_elasticsearch.latest:
  - name: my_domain
  - minor_only: True
  - region: eu-west-1</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.states.boto3_elasticsearch.present"> salt.states.boto3_elasticsearch.present(name, elasticsearch_version=None, elasticsearch_cluster_config=None, ebs_options=None, access_policies=None, snapshot_options=None, vpc_options=None, cognito_options=None, encryption_at_rest_options=None, node_to_node_encryption_options=None, advanced_options=None, log_publishing_options=None, blocking=True, tags=None, region=None, keyid=None, key=None, profile=None)</h3> <dd>
<p>Ensure an Elasticsearch Domain exists.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the Elasticsearch domain that you are creating. Domain names are unique across the domains owned by an account within an AWS region. Domain names must start with a letter or number and can contain the following characters: a-z (lowercase), 0-9, and - (hyphen).</p></li> <li><p><strong>elasticsearch_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- String of format X.Y to specify version for the Elasticsearch domain eg. "1.5" or "2.3".</p></li> <li>
<p><strong>elasticsearch_cluster_config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict specifying the configuration options for an Elasticsearch domain. Keys (case sensitive) in here are:</p> <ul> <li><p>InstanceType (str): The instance type for an Elasticsearch cluster.</p></li> <li><p>InstanceCount (int): The instance type for an Elasticsearch cluster.</p></li> <li><p>DedicatedMasterEnabled (bool): Indicate whether a dedicated master node is enabled.</p></li> <li><p>ZoneAwarenessEnabled (bool): Indicate whether zone awareness is enabled.</p></li> <li>
<p>ZoneAwarenessConfig (dict): Specifies the zone awareness configuration for a domain when zone awareness is enabled. Keys (case sensitive) in here are:</p> <ul> <li><p>AvailabilityZoneCount (int): An integer value to indicate the number of availability zones for a domain when zone awareness is enabled. This should be equal to number of subnets if VPC endpoints is enabled.</p></li> </ul> </li> <li><p>DedicatedMasterType (str): The instance type for a dedicated master node.</p></li> <li><p>DedicatedMasterCount (int): Total number of dedicated master nodes, active and on standby, for the cluster.</p></li> </ul> </li> <li>
<p><strong>ebs_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict specifying the options to enable or disable and specifying the type and size of EBS storage volumes. Keys (case sensitive) in here are:</p> <ul> <li><p>EBSEnabled (bool): Specifies whether EBS-based storage is enabled.</p></li> <li><p>VolumeType (str): Specifies the volume type for EBS-based storage.</p></li> <li><p>VolumeSize (int): Integer to specify the size of an EBS volume.</p></li> <li><p>Iops (int): Specifies the IOPD for a Provisioned IOPS EBS volume (SSD).</p></li> </ul> </li> <li><p><strong>access_policies</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- Dict or JSON string with the IAM access policy.</p></li> <li>
<p><strong>snapshot_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict specifying the snapshot options. Keys (case senstive) in here are:</p> <ul> <li><p>AutomatedSnapshotStartHour (int): Specifies the time, in UTC format, when the service takes a daily automated snapshot of the specified Elasticsearch domain. Default value is 0 hours.</p></li> </ul> </li> <li>
<p><strong>vpc_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict with the options to specify the subnets and security groups for the VPC endpoint. Keys (case sensitive) in here are:</p> <ul> <li><p>SubnetIds (list): The list of subnets for the VPC endpoint.</p></li> <li><p>SecurityGroupIds (list): The list of security groups for the VPC endpoint.</p></li> </ul> </li> <li>
<p><strong>cognito_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict with options to specify the cognito user and identity pools for Kibana authentication. Keys (case senstive) in here are:</p> <ul> <li><p>Enabled (bool): Specifies the option to enable Cognito for Kibana authentication.</p></li> <li><p>UserPoolId (str): Specifies the Cognito user pool ID for Kibana authentication.</p></li> <li><p>IdentityPoolId (str): Specifies the Cognito identity pool ID for Kibana authentication.</p></li> <li><p>RoleArn (str): Specifies the role ARN that provides Elasticsearch permissions for accessing Cognito resources.</p></li> </ul> </li> <li>
<p><strong>encryption_at_rest_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict specifying the encryption at rest options. This option can only be used for the creation of a new Elasticsearch domain. Keys (case sensitive) in here are:</p> <ul> <li><p>Enabled (bool): Specifies the option to enable Encryption At Rest.</p></li> <li><p>KmsKeyId (str): Specifies the KMS Key ID for Encryption At Rest options.</p></li> </ul> </li> <li>
<p><strong>node_to_node_encryption_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict specifying the node to node encryption options. This option can only be used for the creation of a new Elasticsearch domain. Keys (case sensitive) in here are:</p> <ul> <li><p>Enabled (bool): Specify True to enable node-to-node encryption.</p></li> </ul> </li> <li><p><strong>advanced_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- Dict with option to allow references to indices in an HTTP request body. Must be False when configuring access to individual sub-resources. By default, the value is True. See <a class="reference external" href="http://docs.aws.amazon.com/elasticsearch-service/latest/developerguide">http://docs.aws.amazon.com/elasticsearch-service/latest/developerguide</a> /es-createupdatedomains.html#es-createdomain-configure-advanced-options for more information.</p></li> <li>
<p><strong>log_publishing_options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- </p>
<p>Dict with options for various type of logs. The keys denote the type of log file and can be one of the following:</p> <ul> <li><p>INDEX_SLOW_LOGS</p></li> <li><p>SEARCH_SLOW_LOGS</p></li> <li><p>ES_APPLICATION_LOGS</p></li> </ul> <p>The value assigned to each key is a dict with the following case sensitive keys:</p> <ul> <li><p>CloudWatchLogsLogGroupArn (str): The ARN of the Cloudwatch log group to which the log needs to be published.</p></li> <li><p>Enabled (bool): Specifies whether given log publishing option is enabled or not.</p></li> </ul> </li> <li><p><strong>blocking</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Whether or not the state should wait for all operations (create/update/upgrade) to be completed. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p></li> <li><p><strong>tags</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- Dict of tags to ensure are present on the Elasticsearch domain.</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <p>Example:</p> <p>This will create an elasticsearch domain consisting of a single t2.small instance in the eu-west-1 region (Ireland) and will wait until the instance is available before returning from the state.</p> <pre class="highlight-yaml notranslate" data-language="yaml">Create new domain:
  boto3_elasticsearch.present:
  - name: my_domain
  - elasticsearch_version: '5.1'
  - elasticsearch_cluster_config:
      InstanceType: t2.small.elasticsearch
      InstanceCount: 1
      DedicatedMasterEnabled: False
      ZoneAwarenessEnabled: False
  - ebs_options:
      EBSEnabled: True
      VolumeType: gp2
      VolumeSize: 10
  - snapshot_options:
      AutomatedSnapshotStartHour: 3
  - vpc_options:
      SubnetIds:
      - subnet-12345678
      SecurityGroupIds:
      - sg-12345678
  - node_to_node_encryption_options:
      Enabled: False
  - region: eu-west-1
  - tags:
      foo: bar
      baz: qux</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.states.boto3_elasticsearch.tagged"> salt.states.boto3_elasticsearch.tagged(name, tags=None, replace=False, region=None, keyid=None, key=None, profile=None)</h3> <dd>
<p>Ensures the Elasticsearch domain has the tags provided. Adds tags to the domain unless <code class="docutils literal notranslate"><span class="pre">replace</span></code> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code>, in which case all existing tags will be replaced with the tags provided in <code class="docutils literal notranslate"><span class="pre">tags</span></code>. (This will remove all tags if <code class="docutils literal notranslate"><span class="pre">replace</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code> and <code class="docutils literal notranslate"><span class="pre">tags</span></code> is empty).</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The Elasticsearch domain to work with.</p></li> <li><p><strong>tags</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) -- The tags to add to/replace on the Elasticsearch domain.</p></li> <li><p><strong>replace</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><em>bool</em></a>) -- Whether or not to replace (<code class="docutils literal notranslate"><span class="pre">True</span></code>) all existing tags on the Elasticsearch domain, or add (<code class="docutils literal notranslate"><span class="pre">False</span></code>) tags to the ES domain.</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.states.boto3_elasticsearch.upgraded"> salt.states.boto3_elasticsearch.upgraded(name, elasticsearch_version, blocking=True, region=None, keyid=None, key=None, profile=None)</h3> <dd>
<p>Ensures the Elasticsearch domain specified runs on the specified version of elasticsearch. Only upgrades are possible as downgrades require a manual snapshot and an S3 bucket to store them in.</p> <p>Note that this operation is blocking until the upgrade is complete.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- The name of the Elasticsearch domain to upgrade.</p></li> <li><p><strong>elasticsearch_version</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) -- String of format X.Y to specify version for the Elasticsearch domain eg. "1.5" or "2.3".</p></li> </ul> </dd> </dl> <div class="versionadded"> <p><span class="versionmodified added">New in version 3001.</span></p> </div> <p>Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">Upgrade Elasticsearch Domain:
  boto3_elasticsearch.upgraded:
  - name: my_domain
  - elasticsearch_version: '7.2'
  - region: eu-west-1</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/states/all/salt.states.boto3_elasticsearch.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/states/all/salt.states.boto3_elasticsearch.html</a>
  </p>
</div>
