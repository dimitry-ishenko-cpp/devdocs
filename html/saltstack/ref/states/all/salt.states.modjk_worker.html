<h1>salt.states.modjk_worker</h1> <div class="section" id="manage-modjk-workers"> <h2>Manage modjk workers</h2> <p>Send commands to a <strong>modjk</strong> load balancer via the peer system.</p> <p>This module can be used with the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/states/requisites.html#requisites-prereq"><span class="std std-ref">prereq</span></a> requisite to remove/add the worker from the load balancer before deploying/restarting service.</p> <p>Mandatory Settings:</p> <ul class="simple"> <li><p>The minion needs to have permission to publish the <strong>modjk.*</strong> functions (see <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/peer.html#peer"><span class="std std-ref">here</span></a> for information on configuring peer publishing permissions)</p></li> <li><p>The modjk load balancer must be configured as stated in the <strong>modjk</strong> execution module <a class="reference internal" href="../../modules/all/salt.modules.modjk.html#module-salt.modules.modjk" title="salt.modules.modjk"><code class="xref py py-mod docutils literal notranslate"><span class="pre">documentation</span></code></a></p></li> </ul> <dl class="py function"> <h3 id="salt.states.modjk_worker.activate"> salt.states.modjk_worker.activate(name, lbn, target, profile='default', tgt_type='glob')</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>The <code class="docutils literal notranslate"><span class="pre">expr_form</span></code> argument has been renamed to <code class="docutils literal notranslate"><span class="pre">tgt_type</span></code>, earlier releases must use <code class="docutils literal notranslate"><span class="pre">expr_form</span></code>.</p> </div> <p>Activate the named worker from the lbn load balancers at the targeted minions</p> <p>Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">disable-before-deploy:
  modjk_worker.activate:
    - name: {{ grains['id'] }}
    - lbn: application
    - target: 'roles:balancer'
    - tgt_type: grain</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.states.modjk_worker.disable"> salt.states.modjk_worker.disable(name, lbn, target, profile='default', tgt_type='glob')</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>The <code class="docutils literal notranslate"><span class="pre">expr_form</span></code> argument has been renamed to <code class="docutils literal notranslate"><span class="pre">tgt_type</span></code>, earlier releases must use <code class="docutils literal notranslate"><span class="pre">expr_form</span></code>.</p> </div> <p>Disable the named worker from the lbn load balancers at the targeted minions. The worker will get traffic only for current sessions and won't get new ones.</p> <p>Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">disable-before-deploy:
  modjk_worker.disable:
    - name: {{ grains['id'] }}
    - lbn: application
    - target: 'roles:balancer'
    - tgt_type: grain</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.states.modjk_worker.stop"> salt.states.modjk_worker.stop(name, lbn, target, profile='default', tgt_type='glob')</h3> <dd>
<div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2017.7.0: </span>The <code class="docutils literal notranslate"><span class="pre">expr_form</span></code> argument has been renamed to <code class="docutils literal notranslate"><span class="pre">tgt_type</span></code>, earlier releases must use <code class="docutils literal notranslate"><span class="pre">expr_form</span></code>.</p> </div> <p>Stop the named worker from the lbn load balancers at the targeted minions The worker won't get any traffic from the lbn</p> <p>Example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">disable-before-deploy:
  modjk_worker.stop:
    - name: {{ grains['id'] }}
    - lbn: application
    - target: 'roles:balancer'
    - tgt_type: grain</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/states/all/salt.states.modjk_worker.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/states/all/salt.states.modjk_worker.html</a>
  </p>
</div>
