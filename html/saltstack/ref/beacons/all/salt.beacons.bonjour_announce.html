<h1>salt.beacons.bonjour_announce</h1> <p>Beacon to announce via Bonjour (zeroconf)</p> <dl class="py function"> <h3 id="salt.beacons.bonjour_announce.beacon"> salt.beacons.bonjour_announce.beacon(config)</h3> <dd>
<p>Broadcast values via zeroconf</p> <p>If the announced values are static, it is advised to set run_once: True (do not poll) on the beacon configuration.</p> <p>The following are required configuration settings:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">servicetype</span></code> - The service type to announce</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">port</span></code> - The port of the service to announce</p></li> <li>
<p><code class="docutils literal notranslate"><span class="pre">txt</span></code> - The TXT record of the service being announced as a dict. Grains can be used to define TXT values using one of following two formats:</p> <ul> <li><p><code class="docutils literal notranslate"><span class="pre">grains.&lt;grain_name&gt;</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">grains.&lt;grain_name&gt;[i]</span></code> where i is an integer representing the index of the grain to use. If the grain is not a list, the index is ignored.</p></li> </ul> </li> </ul> <p>The following are optional configuration settings:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">servicename</span></code> - Set the name of the service. Will use the hostname from the minion's <code class="docutils literal notranslate"><span class="pre">host</span></code> grain if this value is not set.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">reset_on_change</span></code> - If <code class="docutils literal notranslate"><span class="pre">True</span></code> and there is a change in TXT records detected, it will stop announcing the service and then restart announcing the service. This interruption in service announcement may be desirable if the client relies on changes in the browse records to update its cache of TXT records. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">reset_wait</span></code> - The number of seconds to wait after announcement stops announcing and before it restarts announcing in the case where there is a change in TXT records detected and <code class="docutils literal notranslate"><span class="pre">reset_on_change</span></code> is <code class="docutils literal notranslate"><span class="pre">True</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">copy_grains</span></code> - If <code class="docutils literal notranslate"><span class="pre">True</span></code>, Salt will copy the grains passed into the beacon when it backs them up to check for changes on the next iteration. Normally, instead of copy, it would use straight value assignment. This will allow detection of changes to grains where the grains are modified in-place instead of completely replaced. In-place grains changes are not currently done in the main Salt code but may be done due to a custom plug-in. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li> </ul> <p>Example Config</p> <pre class="highlight-yaml notranslate" data-language="yaml">beacons:
  bonjour_announce:
    - run_once: True
    - servicetype: _demo._tcp
    - port: 1234
    - txt:
        ProdName: grains.productname
        SerialNo: grains.serialnumber
        Comments: 'this is a test'</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.beacons.bonjour_announce.validate"> salt.beacons.bonjour_announce.validate(config)</h3> <dd>
<p>Validate the beacon configuration</p> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/beacons/all/salt.beacons.bonjour_announce.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/beacons/all/salt.beacons.bonjour_announce.html</a>
  </p>
</div>
