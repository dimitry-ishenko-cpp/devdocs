<h1>salt.cloud.clouds.vmware</h1> <div class="section" id="vmware-cloud-module"> <h2>VMware Cloud Module</h2> <div class="versionadded"> <p><span class="versionmodified added">New in version 2015.5.4.</span></p> </div> <p>The VMware cloud module allows you to manage VMware ESX, ESXi, and vCenter.</p> <p>See <a class="reference internal" href="https://docs.saltproject.io/en/latest/topics/cloud/vmware.html#cloud-getting-started-vmware"><span class="std std-ref">Getting started with VMware</span></a> to get started.</p> <dl class="field-list simple"> <dt class="field-odd">codeauthor</dt> <dd class="field-odd">
<p>Nitin Madhok &lt;<a class="reference external" href="mailto:nmadhok%40g.clemson.edu.html">nmadhok<span>@</span>g<span>.</span>clemson<span>.</span>edu</a>&gt;</p> </dd> </dl> </div> <div class="section" id="dependencies"> <h2>Dependencies</h2> <ul class="simple"> <li><p>pyVmomi Python Module</p></li> </ul> <div class="section" id="pyvmomi"> <h3>pyVmomi</h3> <p>PyVmomi can be installed via pip:</p> <pre class="highlight-bash notranslate" data-language="bash">pip install pyVmomi</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Version 6.0 of pyVmomi has some problems with SSL error handling on certain versions of Python. If using version 6.0 of pyVmomi, Python 2.6, Python 2.7.9, or newer must be present. This is due to an upstream dependency in pyVmomi 6.0 that is not supported in Python versions 2.7 to 2.7.8. If the version of Python is not in the supported range, you will need to install an earlier version of pyVmomi. See <a class="reference external" href="https://github.com/saltstack/salt/issues/29537">Issue #29537</a> for more information.</p> </div> <p>Based on the note above, to install an earlier version of pyVmomi than the version currently listed in PyPi, run the following:</p> <pre class="highlight-bash notranslate" data-language="bash">pip install pyVmomi==5.5.0.2014.1.1</pre> <p>The 5.5.0.2014.1.1 is a known stable version that this original VMware cloud driver was developed against.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Ensure python pyVmomi module is installed by running following one-liner check. The output should be 0.</p> <pre class="highlight-bash notranslate" data-language="bash">python -c "import pyVmomi" ; echo $?</pre> </div> </div> </div> <div class="section" id="configuration"> <h2>Configuration</h2> <p>To use this module, set up the vCenter or ESX/ESXi URL, username and password in the cloud configuration at <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers</span></code> or <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers.d/vmware.conf</span></code>:</p> <pre class="highlight-yaml notranslate" data-language="yaml">my-vmware-config:
  driver: vmware
  user: 'DOMAIN\user'
  password: 'verybadpass'
  url: '10.20.30.40'

vcenter01:
  driver: vmware
  user: 'DOMAIN\user'
  password: 'verybadpass'
  url: 'vcenter01.domain.com'
  protocol: 'https'
  port: 443

vcenter02:
  driver: vmware
  user: 'DOMAIN\user'
  password: 'verybadpass'
  url: 'vcenter02.domain.com'
  protocol: 'http'
  port: 80

esx01:
  driver: vmware
  user: 'admin'
  password: 'verybadpass'
  url: 'esx01.domain.com'</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Optionally, <code class="docutils literal notranslate"><span class="pre">protocol</span></code> and <code class="docutils literal notranslate"><span class="pre">port</span></code> can be specified if the vCenter server is not using the defaults. Default is <code class="docutils literal notranslate"><span class="pre">protocol:</span> <span class="pre">https</span></code> and <code class="docutils literal notranslate"><span class="pre">port:</span> <span class="pre">443</span></code>.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2015.8.0.</span></p> </div> <p>The <code class="docutils literal notranslate"><span class="pre">provider</span></code> parameter in cloud provider configuration was renamed to <code class="docutils literal notranslate"><span class="pre">driver</span></code>. This change was made to avoid confusion with the <code class="docutils literal notranslate"><span class="pre">provider</span></code> parameter that is used in cloud profile configuration. Cloud provider configuration now uses <code class="docutils literal notranslate"><span class="pre">driver</span></code> to refer to the salt-cloud driver that provides the underlying functionality to connect to a cloud provider, while cloud profile configuration continues to use <code class="docutils literal notranslate"><span class="pre">provider</span></code> to refer to the cloud provider configuration that you define.</p> </div> <p>To test the connection for <code class="docutils literal notranslate"><span class="pre">my-vmware-config</span></code> specified in the cloud configuration, run <a class="reference internal" href="#salt.cloud.clouds.vmware.test_vcenter_connection" title="salt.cloud.clouds.vmware.test_vcenter_connection"><code class="xref py py-func docutils literal notranslate"><span class="pre">test_vcenter_connection()</span></code></a></p> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.add_host"> salt.cloud.clouds.vmware.add_host(kwargs=None, call=None)</h3> <dd>
<p>Add a host system to the specified cluster or datacenter in this VMware environment</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To use this function, you need to specify <code class="docutils literal notranslate"><span class="pre">esxi_host_user</span></code> and <code class="docutils literal notranslate"><span class="pre">esxi_host_password</span></code> under your provider configuration set up at <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers</span></code> or <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers.d/vmware.conf</span></code>:</p> <pre class="highlight-yaml notranslate" data-language="yaml">vcenter01:
  driver: vmware
  user: 'DOMAIN\user'
  password: 'verybadpass'
  url: 'vcenter01.domain.com'

  # Required when adding a host system
  esxi_host_user: 'root'
  esxi_host_password: 'myhostpassword'
  # Optional fields that can be specified when adding a host system
  esxi_host_ssl_thumbprint: '12:A3:45:B6:CD:7E:F8:90:A1:BC:23:45:D6:78:9E:FA:01:2B:34:CD'</pre> <p>The SSL thumbprint of the host system can be optionally specified by setting <code class="docutils literal notranslate"><span class="pre">esxi_host_ssl_thumbprint</span></code> under your provider configuration. To get the SSL thumbprint of the host system, execute the following command from a remote server:</p> <pre class="highlight-bash notranslate" data-language="bash">echo -n | openssl s_client -connect &lt;YOUR-HOSTSYSTEM-DNS/IP&gt;:443 2&gt;/dev/null | openssl x509 -noout -fingerprint -sha1</pre> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f add_host my-vmware-config host="myHostSystemName" cluster="myClusterName"
salt-cloud -f add_host my-vmware-config host="myHostSystemName" datacenter="myDatacenterName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.avail_images"> salt.cloud.clouds.vmware.avail_images(call=None)</h3> <dd>
<p>Return a list of all the templates present in this VMware environment with basic details</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud --list-images my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.avail_locations"> salt.cloud.clouds.vmware.avail_locations(call=None)</h3> <dd>
<p>Return a list of all the available locations/datacenters in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud --list-locations my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.avail_sizes"> salt.cloud.clouds.vmware.avail_sizes(call=None)</h3> <dd>
<p>Return a list of all the available sizes in this VMware environment.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud --list-sizes my-vmware-config</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Since sizes are built into templates, this function will return an empty dictionary.</p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.build_clonespec"> salt.cloud.clouds.vmware.build_clonespec(config_spec, object_ref, reloc_spec, template)</h3> <dd>
<p>Returns the clone spec</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.connect_host"> salt.cloud.clouds.vmware.connect_host(kwargs=None, call=None)</h3> <dd>
<p>Connect the specified host system in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f connect_host my-vmware-config host="myHostSystemName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.convert_to_template"> salt.cloud.clouds.vmware.convert_to_template(name, kwargs=None, call=None)</h3> <dd>
<p>Convert the specified virtual machine to template.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a convert_to_template vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.create"> salt.cloud.clouds.vmware.create(vm_)</h3> <dd>
<p>To create a single VM in the VMware environment.</p> <p>Sample profile and arguments that can be specified in it can be found <a class="reference internal" href="https://docs.saltproject.io/en/latest/topics/cloud/vmware.html#vmware-cloud-profile"><span class="std std-ref">here.</span></a></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -p vmware-centos6.5 vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.create_cluster"> salt.cloud.clouds.vmware.create_cluster(kwargs=None, call=None)</h3> <dd>
<p>Create a new cluster under the specified datacenter in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f create_cluster my-vmware-config name="myNewCluster" datacenter="datacenterName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.create_datacenter"> salt.cloud.clouds.vmware.create_datacenter(kwargs=None, call=None)</h3> <dd>
<p>Create a new data center in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f create_datacenter my-vmware-config name="MyNewDatacenter"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.create_datastore_cluster"> salt.cloud.clouds.vmware.create_datastore_cluster(kwargs=None, call=None)</h3> <dd>
<p>Create a new datastore cluster for the specified datacenter in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f create_datastore_cluster my-vmware-config name="datastoreClusterName" datacenter="datacenterName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.create_folder"> salt.cloud.clouds.vmware.create_folder(kwargs=None, call=None)</h3> <dd>
<p>Create the specified folder path in this VMware environment</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>To create a Host and Cluster Folder under a Datacenter, specify <code class="docutils literal notranslate"><span class="pre">path="/yourDatacenterName/host/yourFolderName"</span></code></p> <p>To create a Network Folder under a Datacenter, specify <code class="docutils literal notranslate"><span class="pre">path="/yourDatacenterName/network/yourFolderName"</span></code></p> <p>To create a Storage Folder under a Datacenter, specify <code class="docutils literal notranslate"><span class="pre">path="/yourDatacenterName/datastore/yourFolderName"</span></code></p> <p>To create a VM and Template Folder under a Datacenter, specify <code class="docutils literal notranslate"><span class="pre">path="/yourDatacenterName/vm/yourFolderName"</span></code></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f create_folder my-vmware-config path="/Local/a/b/c"
salt-cloud -f create_folder my-vmware-config path="/MyDatacenter/vm/MyVMFolder"
salt-cloud -f create_folder my-vmware-config path="/MyDatacenter/host/MyHostFolder"
salt-cloud -f create_folder my-vmware-config path="/MyDatacenter/network/MyNetworkFolder"
salt-cloud -f create_folder my-vmware-config path="/MyDatacenter/storage/MyStorageFolder"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.create_snapshot"> salt.cloud.clouds.vmware.create_snapshot(name, kwargs=None, call=None)</h3> <dd>
<p>Create a snapshot of the specified virtual machine in this VMware environment</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If the VM is powered on, the internal state of the VM (memory dump) is included in the snapshot by default which will also set the power state of the snapshot to "powered on". You can set <code class="docutils literal notranslate"><span class="pre">memdump=False</span></code> to override this. This field is ignored if the virtual machine is powered off or if the VM does not support snapshots with memory dumps. Default is <code class="docutils literal notranslate"><span class="pre">memdump=True</span></code></p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If the VM is powered on when the snapshot is taken, VMware Tools can be used to quiesce the file system in the virtual machine by setting <code class="docutils literal notranslate"><span class="pre">quiesce=True</span></code>. This field is ignored if the virtual machine is powered off; if VMware Tools are not available or if <code class="docutils literal notranslate"><span class="pre">memdump=True</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">quiesce=False</span></code></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a create_snapshot vmname snapshot_name="mySnapshot"
salt-cloud -a create_snapshot vmname snapshot_name="mySnapshot" [description="My snapshot"] [memdump=False] [quiesce=True]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.destroy"> salt.cloud.clouds.vmware.destroy(name, call=None)</h3> <dd>
<p>To destroy a VM from the VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -d vmname
salt-cloud --destroy vmname
salt-cloud -a destroy vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.disconnect_host"> salt.cloud.clouds.vmware.disconnect_host(kwargs=None, call=None)</h3> <dd>
<p>Disconnect the specified host system in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f disconnect_host my-vmware-config host="myHostSystemName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.enter_maintenance_mode"> salt.cloud.clouds.vmware.enter_maintenance_mode(kwargs=None, call=None)</h3> <dd>
<p>To put the specified host system in maintenance mode in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f enter_maintenance_mode my-vmware-config host="myHostSystemName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.exit_maintenance_mode"> salt.cloud.clouds.vmware.exit_maintenance_mode(kwargs=None, call=None)</h3> <dd>
<p>To take the specified host system out of maintenance mode in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f exit_maintenance_mode my-vmware-config host="myHostSystemName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.get_clonespec_for_valid_snapshot"> salt.cloud.clouds.vmware.get_clonespec_for_valid_snapshot(config_spec, object_ref, reloc_spec, template, vm_)</h3> <dd>
<p>return clonespec only if values are valid</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.get_vcenter_version"> salt.cloud.clouds.vmware.get_vcenter_version(kwargs=None, call=None)</h3> <dd>
<p>Show the vCenter Server version with build number.</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f get_vcenter_version my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.handle_snapshot"> salt.cloud.clouds.vmware.handle_snapshot(config_spec, object_ref, reloc_spec, template, vm_)</h3> <dd>
<p>Returns a clone spec for cloning from shapshots :rtype vim.vm.CloneSpec</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_clusters"> salt.cloud.clouds.vmware.list_clusters(kwargs=None, call=None)</h3> <dd>
<p>List all the clusters for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_clusters my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_clusters_by_datacenter"> salt.cloud.clouds.vmware.list_clusters_by_datacenter(kwargs=None, call=None)</h3> <dd>
<p>List clusters for each datacenter; or clusters for a specified datacenter in this VMware environment</p> <p>To list clusters for each datacenter:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_clusters_by_datacenter my-vmware-config</pre> <p>To list clusters for a specified datacenter:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_clusters_by_datacenter my-vmware-config datacenter="datacenterName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_datacenters"> salt.cloud.clouds.vmware.list_datacenters(kwargs=None, call=None)</h3> <dd>
<p>List all the data centers for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_datacenters my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_datastore_clusters"> salt.cloud.clouds.vmware.list_datastore_clusters(kwargs=None, call=None)</h3> <dd>
<p>List all the datastore clusters for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_datastore_clusters my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_datastores"> salt.cloud.clouds.vmware.list_datastores(kwargs=None, call=None)</h3> <dd>
<p>List all the datastores for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_datastores my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_dvs"> salt.cloud.clouds.vmware.list_dvs(kwargs=None, call=None)</h3> <dd>
<p>List all the distributed virtual switches for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_dvs my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_folders"> salt.cloud.clouds.vmware.list_folders(kwargs=None, call=None)</h3> <dd>
<p>List all the folders for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_folders my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_hbas"> salt.cloud.clouds.vmware.list_hbas(kwargs=None, call=None)</h3> <dd>
<p>List all HBAs for each host system; or all HBAs for a specified host system; or HBAs of specified type for each host system; or HBAs of specified type for a specified host system in this VMware environment</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>You can specify type as either <code class="docutils literal notranslate"><span class="pre">parallel</span></code>, <code class="docutils literal notranslate"><span class="pre">iscsi</span></code>, <code class="docutils literal notranslate"><span class="pre">block</span></code> or <code class="docutils literal notranslate"><span class="pre">fibre</span></code>.</p> </div> <p>To list all HBAs for each host system:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hbas my-vmware-config</pre> <p>To list all HBAs for a specified host system:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hbas my-vmware-config host="hostSystemName"</pre> <p>To list HBAs of specified type for each host system:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hbas my-vmware-config type="HBAType"</pre> <p>To list HBAs of specified type for a specified host system:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hbas my-vmware-config host="hostSystemName" type="HBAtype"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_hosts"> salt.cloud.clouds.vmware.list_hosts(kwargs=None, call=None)</h3> <dd>
<p>List all the hosts for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hosts my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_hosts_by_cluster"> salt.cloud.clouds.vmware.list_hosts_by_cluster(kwargs=None, call=None)</h3> <dd>
<p>List hosts for each cluster; or hosts for a specified cluster in this VMware environment</p> <p>To list hosts for each cluster:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hosts_by_cluster my-vmware-config</pre> <p>To list hosts for a specified cluster:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hosts_by_cluster my-vmware-config cluster="clusterName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_hosts_by_datacenter"> salt.cloud.clouds.vmware.list_hosts_by_datacenter(kwargs=None, call=None)</h3> <dd>
<p>List hosts for each datacenter; or hosts for a specified datacenter in this VMware environment</p> <p>To list hosts for each datacenter:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hosts_by_datacenter my-vmware-config</pre> <p>To list hosts for a specified datacenter:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_hosts_by_datacenter my-vmware-config datacenter="datacenterName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_networks"> salt.cloud.clouds.vmware.list_networks(kwargs=None, call=None)</h3> <dd>
<p>List all the standard networks for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_networks my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_nodes"> salt.cloud.clouds.vmware.list_nodes(kwargs=None, call=None)</h3> <dd>
<p>Return a list of all VMs and templates that are on the specified provider, with basic fields</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_nodes my-vmware-config</pre> <p>To return a list of all VMs and templates present on ALL configured providers, with basic fields:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -Q</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_nodes_full"> salt.cloud.clouds.vmware.list_nodes_full(kwargs=None, call=None)</h3> <dd>
<p>Return a list of all VMs and templates that are on the specified provider, with full details</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_nodes_full my-vmware-config</pre> <p>To return a list of all VMs and templates present on ALL configured providers, with full details:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -F</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_nodes_min"> salt.cloud.clouds.vmware.list_nodes_min(kwargs=None, call=None)</h3> <dd>
<p>Return a list of all VMs and templates that are on the specified provider, with no details</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_nodes_min my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_nodes_select"> salt.cloud.clouds.vmware.list_nodes_select(call=None)</h3> <dd>
<p>Return a list of all VMs and templates that are on the specified provider, with fields specified under <code class="docutils literal notranslate"><span class="pre">query.selection</span></code> in <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud</span></code></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_nodes_select my-vmware-config</pre> <p>To return a list of all VMs and templates present on ALL configured providers, with fields specified under <code class="docutils literal notranslate"><span class="pre">query.selection</span></code> in <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud</span></code>:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -S</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_portgroups"> salt.cloud.clouds.vmware.list_portgroups(kwargs=None, call=None)</h3> <dd>
<p>List all the distributed virtual portgroups for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_portgroups my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_resourcepools"> salt.cloud.clouds.vmware.list_resourcepools(kwargs=None, call=None)</h3> <dd>
<p>List all the resource pools for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_resourcepools my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_snapshots"> salt.cloud.clouds.vmware.list_snapshots(kwargs=None, call=None)</h3> <dd>
<p>List snapshots either for all VMs and templates or for a specific VM/template in this VMware environment</p> <p>To list snapshots for all VMs and templates:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_snapshots my-vmware-config</pre> <p>To list snapshots for a specific VM/template:</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_snapshots my-vmware-config name="vmname"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_templates"> salt.cloud.clouds.vmware.list_templates(kwargs=None, call=None)</h3> <dd>
<p>List all the templates present in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_templates my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.list_vapps"> salt.cloud.clouds.vmware.list_vapps(kwargs=None, call=None)</h3> <dd>
<p>List all the vApps for this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f list_vapps my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.reboot_host"> salt.cloud.clouds.vmware.reboot_host(kwargs=None, call=None)</h3> <dd>
<p>Reboot the specified host system in this VMware environment</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If the host system is not in maintenance mode, it will not be rebooted. If you want to reboot the host system regardless of whether it is in maintenance mode, set <code class="docutils literal notranslate"><span class="pre">force=True</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">force=False</span></code>.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f reboot_host my-vmware-config host="myHostSystemName" [force=True]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.remove_all_snapshots"> salt.cloud.clouds.vmware.remove_all_snapshots(name, kwargs=None, call=None)</h3> <dd>
<p>Remove all the snapshots present for the specified virtual machine.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>All the snapshots higher up in the hierarchy of the current snapshot tree are consolidated and their virtual disks are merged. To override this behavior and only remove all snapshots, set <code class="docutils literal notranslate"><span class="pre">merge_snapshots=False</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">merge_snapshots=True</span></code></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a remove_all_snapshots vmname [merge_snapshots=False]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.remove_host"> salt.cloud.clouds.vmware.remove_host(kwargs=None, call=None)</h3> <dd>
<p>Remove the specified host system from this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f remove_host my-vmware-config host="myHostSystemName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.remove_snapshot"> salt.cloud.clouds.vmware.remove_snapshot(name, kwargs=None, call=None)</h3> <dd>
<p>Remove a snapshot of the specified virtual machine in this VMware environment</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a remove_snapshot vmname snapshot_name="mySnapshot"
salt-cloud -a remove_snapshot vmname snapshot_name="mySnapshot" [remove_children="True"]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.rescan_hba"> salt.cloud.clouds.vmware.rescan_hba(kwargs=None, call=None)</h3> <dd>
<p>To rescan a specified HBA or all the HBAs on the Host System</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f rescan_hba my-vmware-config host="hostSystemName"
salt-cloud -f rescan_hba my-vmware-config hba="hbaDeviceName" host="hostSystemName"</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.reset"> salt.cloud.clouds.vmware.reset(name, soft=False, call=None)</h3> <dd>
<p>To reset a VM using its name</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If <code class="docutils literal notranslate"><span class="pre">soft=True</span></code> then issues a command to the guest operating system asking it to perform a reboot. Otherwise hypervisor will terminate VM and start it again. Default is soft=False</p> <p>For <code class="docutils literal notranslate"><span class="pre">soft=True</span></code> vmtools should be installed on guest system.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a reset vmname
salt-cloud -a reset vmname soft=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.revert_to_snapshot"> salt.cloud.clouds.vmware.revert_to_snapshot(name, kwargs=None, call=None)</h3> <dd>
<p>Revert virtual machine to its current snapshot. If no snapshot exists, the state of the virtual machine remains unchanged</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The virtual machine will be powered on if the power state of the snapshot when it was created was set to "Powered On". Set <code class="docutils literal notranslate"><span class="pre">power_off=True</span></code> so that the virtual machine stays powered off regardless of the power state of the snapshot when it was created. Default is <code class="docutils literal notranslate"><span class="pre">power_off=False</span></code>.</p> <p>If the power state of the snapshot when it was created was "Powered On" and if <code class="docutils literal notranslate"><span class="pre">power_off=True</span></code>, the VM will be put in suspended state after it has been reverted to the snapshot.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a revert_to_snapshot vmame [power_off=True]
salt-cloud -a revert_to_snapshot vmame snapshot_name="selectedSnapshot" [power_off=True]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.show_instance"> salt.cloud.clouds.vmware.show_instance(name, call=None)</h3> <dd>
<p>List all available details of the specified VM</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a show_instance vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.shutdown_host"> salt.cloud.clouds.vmware.shutdown_host(kwargs=None, call=None)</h3> <dd>
<p>Shut down the specified host system in this VMware environment</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If the host system is not in maintenance mode, it will not be shut down. If you want to shut down the host system regardless of whether it is in maintenance mode, set <code class="docutils literal notranslate"><span class="pre">force=True</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">force=False</span></code>.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f shutdown_host my-vmware-config host="myHostSystemName" [force=True]</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.start"> salt.cloud.clouds.vmware.start(name, call=None)</h3> <dd>
<p>To start/power on a VM using its name</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a start vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.stop"> salt.cloud.clouds.vmware.stop(name, soft=False, call=None)</h3> <dd>
<p>To stop/power off a VM using its name</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If <code class="docutils literal notranslate"><span class="pre">soft=True</span></code> then issues a command to the guest operating system asking it to perform a clean shutdown of all services. Default is soft=False</p> <p>For <code class="docutils literal notranslate"><span class="pre">soft=True</span></code> vmtools should be installed on guest system.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a stop vmname
salt-cloud -a stop vmname soft=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.suspend"> salt.cloud.clouds.vmware.suspend(name, call=None)</h3> <dd>
<p>To suspend a VM using its name</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a suspend vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.terminate"> salt.cloud.clouds.vmware.terminate(name, call=None)</h3> <dd>
<p>To do an immediate power off of a VM using its name. A <code class="docutils literal notranslate"><span class="pre">SIGKILL</span></code> is issued to the vmx process of the VM</p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a terminate vmname</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.test_vcenter_connection"> salt.cloud.clouds.vmware.test_vcenter_connection(kwargs=None, call=None)</h3> <dd>
<p>Test if the connection can be made to the vCenter server using the specified credentials inside <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers</span></code> or <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers.d/vmware.conf</span></code></p> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f test_vcenter_connection my-vmware-config</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.upgrade_tools"> salt.cloud.clouds.vmware.upgrade_tools(name, reboot=False, call=None)</h3> <dd>
<p>To upgrade VMware Tools on a specified virtual machine.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If the virtual machine is running Windows OS, use <code class="docutils literal notranslate"><span class="pre">reboot=True</span></code> to reboot the virtual machine after VMware tools upgrade. Default is <code class="docutils literal notranslate"><span class="pre">reboot=False</span></code></p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a upgrade_tools vmname
salt-cloud -a upgrade_tools vmname reboot=True</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.vmware.upgrade_tools_all"> salt.cloud.clouds.vmware.upgrade_tools_all(call=None)</h3> <dd>
<p>To upgrade VMware Tools on all virtual machines present in the specified provider</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>If the virtual machine is running Windows OS, this function will attempt to suppress the automatic reboot caused by a VMware Tools upgrade.</p> </div> <p>CLI Example:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -f upgrade_tools_all my-vmware-config</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/clouds/all/salt.cloud.clouds.vmware.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/clouds/all/salt.cloud.clouds.vmware.html</a>
  </p>
</div>
