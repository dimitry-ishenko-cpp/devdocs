<h1>salt.cloud.clouds.azurearm</h1> <div class="section" id="azure-arm-cloud-module"> <h2>Azure ARM Cloud Module</h2> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2019.2.0.</span></p> </div> <p>The Azure ARM cloud module is used to control access to Microsoft Azure Resource Manager</p> <dl class="field-list"> <dt class="field-odd">depends</dt> <dd class="field-odd">
<ul class="simple"> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure">azure</a> &gt;= 2.0.0rc6</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-common">azure-common</a> &gt;= 1.1.4</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-mgmt">azure-mgmt</a> &gt;= 0.30.0rc6</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-mgmt-compute">azure-mgmt-compute</a> &gt;= 0.33.0</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-mgmt-network">azure-mgmt-network</a> &gt;= 0.30.0rc6</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-mgmt-resource">azure-mgmt-resource</a> &gt;= 0.30.0</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-mgmt-storage">azure-mgmt-storage</a> &gt;= 0.30.0rc6</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-mgmt-web">azure-mgmt-web</a> &gt;= 0.30.0rc6</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/azure-storage">azure-storage</a> &gt;= 0.32.0</p></li> <li><p><a class="reference external" href="https://pypi.python.org/pypi/msrestazure">msrestazure</a> &gt;= 0.4.21</p></li> </ul> </dd> <dt class="field-even">configuration</dt> <dd class="field-even">
<p>Required provider parameters:</p> <dl class="simple"> <dt>if using username and password:</dt>
<dd>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">subscription_id</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">username</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">password</span></code></p></li> </ul> </dd> <dt>if using a service principal:</dt>
<dd>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">subscription_id</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">tenant</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">client_id</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">secret</span></code></p></li> </ul> </dd> <dt>if using Managed Service Identity authentication:</dt>
<dd>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">subscription_id</span></code></p></li> </ul> </dd> </dl> <p>Optional provider parameters:</p> <dl class="simple"> <dt>
<strong>cloud_environment</strong>: Used to point the cloud driver to different API endpoints, such as Azure GovCloud. Possible values:</dt>
<dd>
<ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">AZURE_PUBLIC_CLOUD</span></code> (default)</p></li> <li><p><code class="docutils literal notranslate"><span class="pre">AZURE_CHINA_CLOUD</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">AZURE_US_GOV_CLOUD</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">AZURE_GERMAN_CLOUD</span></code></p></li> <li><p>HTTP base URL for a custom endpoint, such as Azure Stack. The <code class="docutils literal notranslate"><span class="pre">/metadata/endpoints</span></code> path will be added to the URL.</p></li> </ul> </dd> <dt>
<strong>userdata</strong> and <strong>userdata_file</strong>:</dt>
<dd>
<p>Azure Resource Manager uses a separate VirtualMachineExtension object to pass userdata scripts to the virtual machine. Arbitrary shell commands can be passed via the <code class="docutils literal notranslate"><span class="pre">userdata</span></code> parameter, or via a file local to the Salt Cloud system using the <code class="docutils literal notranslate"><span class="pre">userdata_file</span></code> parameter. Note that the local file is not treated as a script by the extension, so "one-liners" probably work best. If greater functionality is desired, a web-hosted script file can be specified via <code class="docutils literal notranslate"><span class="pre">userdata_file:</span> <span class="pre">https://raw.githubusercontent.com/account/repo/master/azure-script.py</span></code>, which will be executed on the system after VM creation. For Windows systems, script files ending in <code class="docutils literal notranslate"><span class="pre">.ps1</span></code> will be executed with <code class="docutils literal notranslate"><span class="pre">powershell.exe</span></code>. The <code class="docutils literal notranslate"><span class="pre">userdata</span></code> parameter takes precedence over the <code class="docutils literal notranslate"><span class="pre">userdata_file</span></code> parameter when creating the custom script extension.</p> </dd> <dt>
<strong>win_installer</strong>:</dt>
<dd>
<p>This parameter, which holds the local path to the Salt Minion installer package, is used to determine if the virtual machine type will be "Windows". Only set this parameter on profiles which install Windows operating systems.</p> </dd> </dl> </dd> </dl> <p>Example <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers</span></code> or <code class="docutils literal notranslate"><span class="pre">/etc/salt/cloud.providers.d/azure.conf</span></code> configuration:</p> <pre class="highlight-yaml notranslate" data-language="yaml">my-azure-config with username and password:
  driver: azurearm
  subscription_id: 3287abc8-f98a-c678-3bde-326766fd3617
  username: larry
  password: 123pass

Or my-azure-config with service principal:
  driver: azurearm
  subscription_id: 3287abc8-f98a-c678-3bde-326766fd3617
  tenant: ABCDEFAB-1234-ABCD-1234-ABCDEFABCDEF
  client_id: ABCDEFAB-1234-ABCD-1234-ABCDEFABCDEF
  secret: XXXXXXXXXXXXXXXXXXXXXXXX
  cloud_environment: AZURE_US_GOV_CLOUD

  The Service Principal can be created with the new Azure CLI (https://github.com/Azure/azure-cli) with:
  az ad sp create-for-rbac -n "http://&lt;yourappname&gt;" --role &lt;role&gt; --scopes &lt;scope&gt;
  For example, this creates a service principal with 'owner' role for the whole subscription:
  az ad sp create-for-rbac -n "http://mysaltapp" --role owner --scopes /subscriptions/3287abc8-f98a-c678-3bde-326766fd3617

  *Note: review the details of Service Principals. Owner role is more than you normally need, and you can restrict
  scope to a resource group or individual resources.</pre> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.avail_images"> salt.cloud.clouds.azurearm.avail_images(call=None)</h3> <dd>
<p>Return a dict of all available images on the provider</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.avail_locations"> salt.cloud.clouds.azurearm.avail_locations(call=None)</h3> <dd>
<p>Return a dict of all available regions.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.avail_sizes"> salt.cloud.clouds.azurearm.avail_sizes(call=None)</h3> <dd>
<p>Return a list of sizes available from the provider</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.create"> salt.cloud.clouds.azurearm.create(vm_)</h3> <dd>
<p>Create a single VM from a data dict.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.create_network_interface"> salt.cloud.clouds.azurearm.create_network_interface(call=None, kwargs=None)</h3> <dd>
<p>Create a network interface.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.create_or_update_vmextension"> salt.cloud.clouds.azurearm.create_or_update_vmextension(call=None, kwargs=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>Create or update a VM extension object "inside" of a VM object.</p> <dl> <dt>required kwargs:</dt>
<dd>
<pre class="highlight-yaml notranslate" data-language="yaml">extension_name: myvmextension
virtual_machine_name: myvm
settings: {"commandToExecute": "hostname"}</pre> </dd> <dt>optional kwargs:</dt>
<dd>
<pre class="highlight-yaml notranslate" data-language="yaml">resource_group: &lt; inferred from cloud configs &gt;
location: &lt; inferred from cloud configs &gt;
publisher: &lt; default: Microsoft.Azure.Extensions &gt;
virtual_machine_extension_type: &lt; default: CustomScript &gt;
type_handler_version: &lt; default: 2.0 &gt;
auto_upgrade_minor_version: &lt; default: True &gt;
protected_settings: &lt; default: None &gt;</pre> </dd> </dl> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.delete_blob"> salt.cloud.clouds.azurearm.delete_blob(call=None, kwargs=None)</h3> <dd>
<p>Delete a blob from a container.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.delete_interface"> salt.cloud.clouds.azurearm.delete_interface(call=None, kwargs=None)</h3> <dd>
<p>Delete a network interface.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.delete_managed_disk"> salt.cloud.clouds.azurearm.delete_managed_disk(call=None, kwargs=None)</h3> <dd>
<p>Delete a managed disk from a resource group.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.destroy"> salt.cloud.clouds.azurearm.destroy(name, call=None, kwargs=None)</h3> <dd>
<p>Destroy a VM.</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -d myminion
salt-cloud -a destroy myminion service_name=myservice</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.get_api_versions"> salt.cloud.clouds.azurearm.get_api_versions(call=None, kwargs=None)</h3> <dd>
<p>Get a resource type api versions</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.get_configured_provider"> salt.cloud.clouds.azurearm.get_configured_provider()</h3> <dd>
<p>Return the first configured provider instance.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.get_conn"> salt.cloud.clouds.azurearm.get_conn(client_type)</h3> <dd>
<p>Return a connection object for a client type.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.get_dependencies"> salt.cloud.clouds.azurearm.get_dependencies()</h3> <dd>
<p>Warn if dependencies aren't met.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.get_location"> salt.cloud.clouds.azurearm.get_location(call=None, kwargs=None)</h3> <dd>
<p>Return the location that is configured for this provider</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.get_resource_by_id"> salt.cloud.clouds.azurearm.get_resource_by_id(resource_id, api_version, extract_value=None)</h3> <dd>
<p>Get an AzureARM resource by id</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_blobs"> salt.cloud.clouds.azurearm.list_blobs(call=None, kwargs=None)</h3> <dd>
<p>List blobs.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_nodes"> salt.cloud.clouds.azurearm.list_nodes(call=None)</h3> <dd>
<p>List VMs on this Azure account</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_nodes_full"> salt.cloud.clouds.azurearm.list_nodes_full(call=None)</h3> <dd>
<p>List all VMs on the subscription with full information</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_resource_groups"> salt.cloud.clouds.azurearm.list_resource_groups(call=None)</h3> <dd>
<p>List resource groups associated with the subscription</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_storage_accounts"> salt.cloud.clouds.azurearm.list_storage_accounts(call=None)</h3> <dd>
<p>List storage accounts within the subscription.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_subnets"> salt.cloud.clouds.azurearm.list_subnets(call=None, kwargs=None)</h3> <dd>
<p>List subnets in a virtual network.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.list_virtual_networks"> salt.cloud.clouds.azurearm.list_virtual_networks(call=None, kwargs=None)</h3> <dd>
<p>List virtual networks.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.request_instance"> salt.cloud.clouds.azurearm.request_instance(vm_)</h3> <dd>
<p>Request a VM from Azure.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.show_instance"> salt.cloud.clouds.azurearm.show_instance(name, call=None)</h3> <dd>
<p>Show the details from AzureARM concerning an instance</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.start"> salt.cloud.clouds.azurearm.start(name, call=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>Start a VM</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a start myminion</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.cloud.clouds.azurearm.stop"> salt.cloud.clouds.azurearm.stop(name, call=None)</h3> <dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 2019.2.0.</span></p> </div> <p>Stop (deallocate) a VM</p> <p>CLI Examples:</p> <pre class="highlight-bash notranslate" data-language="bash">salt-cloud -a stop myminion</pre> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/clouds/all/salt.cloud.clouds.azurearm.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/clouds/all/salt.cloud.clouds.azurearm.html</a>
  </p>
</div>
