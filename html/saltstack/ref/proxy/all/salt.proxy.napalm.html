<h1>salt.proxy.napalm</h1> <div class="section" id="napalm-network-automation-and-programmability-abstraction-layer-with-multivendor-support"> <h2>NAPALM: Network Automation and Programmability Abstraction Layer with Multivendor support</h2> <div class="versionadded"> <p><span class="versionmodified added">New in version 2016.11.0.</span></p> </div> <p>Proxy minion for managing network devices via <a class="reference external" href="https://napalm-automation.net/">NAPALM</a> library.</p> <dl class="field-list simple"> <dt class="field-odd">codeauthor</dt> <dd class="field-odd">
<p>Mircea Ulinic &lt;<a class="reference external" href="mailto:ping%40mirceaulinic.net.html">ping<span>@</span>mirceaulinic<span>.</span>net</a>&gt; &amp; Jerome Fleury &lt;<a class="reference external" href="mailto:jf%40cloudflare.com.html">jf<span>@</span>cloudflare<span>.</span>com</a>&gt;</p> </dd> <dt class="field-even">maturity</dt> <dd class="field-even">
<p>new</p> </dd> <dt class="field-odd">depends</dt> <dd class="field-odd">
<p>napalm</p> </dd> <dt class="field-even">platform</dt> <dd class="field-even">
<p>unix</p> </dd> </dl> <div class="section" id="dependencies"> <h3>Dependencies</h3> <p>The <code class="docutils literal notranslate"><span class="pre">napalm</span></code> proxy module requires <a class="reference external" href="https://napalm-automation.net/">NAPALM</a> library to be installed: <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">napalm</span></code> Please check <a class="reference external" href="http://napalm.readthedocs.io/en/latest/installation/index.html">Installation</a> for complete details.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Beginning with Salt release 2017.7.3, it is recommended to use <code class="docutils literal notranslate"><span class="pre">napalm</span></code> &gt;= <code class="docutils literal notranslate"><span class="pre">2.0.0</span></code>. The library has been unified into a monolithic package, as in opposite to separate packages per driver. For more details you can check <a class="reference external" href="https://napalm-automation.net/reunification/">this document</a>. While it will still work with the old packages, bear in mind that the NAPALM core team will maintain only the main <code class="docutils literal notranslate"><span class="pre">napalm</span></code> package.</p> <p>Moreover, for additional capabilities, the users can always define a library that extends NAPALM's base capabilities and configure the <code class="docutils literal notranslate"><span class="pre">provider</span></code> option (see below).</p> </div> </div> <div class="section" id="pillar"> <h3>Pillar</h3> <p>The napalm proxy configuration requires the following parameters in order to connect to the network device:</p> <dl> <dt>driver</dt>
<dd>
<p>Specifies the network device operating system. For a complete list of the supported operating systems please refer to the <a class="reference external" href="https://napalm.readthedocs.io/en/latest/#supported-network-operating-systems">NAPALM Read the Docs page</a>.</p> </dd> <dt>host</dt>
<dd>
<p>The IP Address or FQDN to use when connecting to the device. Alternatively, the following field names can be used instead: <code class="docutils literal notranslate"><span class="pre">hostname</span></code>, <code class="docutils literal notranslate"><span class="pre">fqdn</span></code>, <code class="docutils literal notranslate"><span class="pre">ip</span></code>.</p> </dd> <dt>username</dt>
<dd>
<p>The username to be used when connecting to the device.</p> </dd> <dt>passwd</dt>
<dd>
<p>The password needed to establish the connection.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This field may not be mandatory when working with SSH-based drivers, and the username has a SSH key properly configured on the device targeted to be managed.</p> </div> </dd> <dt>optional_args</dt>
<dd>
<p>Dictionary with the optional arguments. Check the complete list of supported <a class="reference external" href="http://napalm.readthedocs.io/en/latest/support/index.html#list-of-supported-optional-arguments">optional arguments</a>.</p> </dd> <dt>always_alive: <code class="docutils literal notranslate"><span class="pre">True</span></code>
</dt>
<dd>
<p>In certain less dynamic environments, maintaining the remote connection permanently open with the network device is not always beneficial. In that case, the user can select to initialize the connection only when needed, by specifying this field to <code class="docutils literal notranslate"><span class="pre">false</span></code>. Default: <code class="docutils literal notranslate"><span class="pre">true</span></code> (maintains the connection with the remote network device).</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd> <dt>provider: <code class="docutils literal notranslate"><span class="pre">napalm_base</span></code>
</dt>
<dd>
<p>The library that provides the <code class="docutils literal notranslate"><span class="pre">get_network_device</span></code> function. This option is useful when the user has more specific needs and requires to extend the NAPALM capabilities using a private library implementation. The only constraint is that the alternative library needs to have the <code class="docutils literal notranslate"><span class="pre">get_network_device</span></code> function available.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.1.</span></p> </div> </dd> <dt>multiprocessing: <code class="docutils literal notranslate"><span class="pre">False</span></code>
</dt>
<dd>
<p>Overrides the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/configuration/minion.html#std-conf_minion-multiprocessing"><code class="xref std std-conf_minion docutils literal notranslate"><span class="pre">multiprocessing</span></code></a> option, per proxy minion. The <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> option must be turned off for SSH-based proxies. However, some NAPALM drivers (e.g. Arista, NX-OS) are not SSH-based. As multiple proxy minions may share the same configuration file, this option permits the configuration of the <code class="docutils literal notranslate"><span class="pre">multiprocessing</span></code> option more specifically, for some proxy minions.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.2.</span></p> </div> </dd> </dl> <p>Proxy pillar file example:</p> <pre class="highlight-yaml notranslate" data-language="yaml">proxy:
  proxytype: napalm
  driver: junos
  host: core05.nrt02
  username: my_username
  passwd: my_password
  optional_args:
    port: 12201</pre> <p>Example using a user-specific library, extending NAPALM's capabilities, e.g. <code class="docutils literal notranslate"><span class="pre">custom_napalm_base</span></code>:</p> <pre class="highlight-yaml notranslate" data-language="yaml">proxy:
  proxytype: napalm
  driver: ios
  fqdn: cr1.th2.par.as1234.net
  username: salt
  password: ''
  provider: custom_napalm_base</pre> <div class="admonition seealso"> <p class="admonition-title">See also</p> <ul class="simple"> <li><p><a class="reference internal" href="../../grains/all/salt.grains.napalm.html#module-salt.grains.napalm" title="salt.grains.napalm"><code class="xref py py-mod docutils literal notranslate"><span class="pre">NAPALM</span> <span class="pre">grains:</span> <span class="pre">select</span> <span class="pre">network</span> <span class="pre">devices</span> <span class="pre">based</span> <span class="pre">on</span> <span class="pre">their</span> <span class="pre">characteristics</span></code></a></p></li> <li><p><a class="reference internal" href="../../modules/all/salt.modules.napalm_network.html#module-salt.modules.napalm_network" title="salt.modules.napalm_network"><code class="xref py py-mod docutils literal notranslate"><span class="pre">NET</span> <span class="pre">module:</span> <span class="pre">network</span> <span class="pre">basic</span> <span class="pre">features</span></code></a></p></li> <li><p><a class="reference internal" href="../../states/all/salt.states.netconfig.html#module-salt.states.netconfig" title="salt.states.netconfig"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Network</span> <span class="pre">config</span> <span class="pre">state:</span> <span class="pre">Manage</span> <span class="pre">the</span> <span class="pre">configuration</span> <span class="pre">using</span> <span class="pre">arbitrary</span> <span class="pre">templates</span></code></a></p></li> <li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">NAPALM</span> <span class="pre">YANG</span> <span class="pre">state:</span> <span class="pre">Manage</span> <span class="pre">the</span> <span class="pre">configuration</span> <span class="pre">according</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">YANG</span> <span class="pre">models</span> <span class="pre">(OpenConfig/IETF)</span></code></p></li> <li><p><code class="xref py py-mod docutils literal notranslate"><span class="pre">Network</span> <span class="pre">ACL</span> <span class="pre">module:</span> <span class="pre">Generate</span> <span class="pre">and</span> <span class="pre">load</span> <span class="pre">ACL</span> <span class="pre">(firewall)</span> <span class="pre">configuration</span></code></p></li> <li><p><a class="reference internal" href="../../states/all/salt.states.netacl.html#module-salt.states.netacl" title="salt.states.netacl"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Network</span> <span class="pre">ACL</span> <span class="pre">state:</span> <span class="pre">Manage</span> <span class="pre">the</span> <span class="pre">firewall</span> <span class="pre">configuration</span></code></a></p></li> <li><p><a class="reference internal" href="../../modules/all/salt.modules.napalm_ntp.html#module-salt.modules.napalm_ntp" title="salt.modules.napalm_ntp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">NTP</span> <span class="pre">operational</span> <span class="pre">and</span> <span class="pre">configuration</span> <span class="pre">management</span> <span class="pre">module</span></code></a></p></li> <li><p><a class="reference internal" href="../../modules/all/salt.modules.napalm_bgp.html#module-salt.modules.napalm_bgp" title="salt.modules.napalm_bgp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">BGP</span> <span class="pre">operational</span> <span class="pre">and</span> <span class="pre">configuration</span> <span class="pre">management</span> <span class="pre">module</span></code></a></p></li> <li><p><a class="reference internal" href="../../modules/all/salt.modules.napalm_route.html#module-salt.modules.napalm_route" title="salt.modules.napalm_route"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Routes</span> <span class="pre">details</span></code></a></p></li> <li><p><a class="reference internal" href="../../modules/all/salt.modules.napalm_snmp.html#module-salt.modules.napalm_snmp" title="salt.modules.napalm_snmp"><code class="xref py py-mod docutils literal notranslate"><span class="pre">SNMP</span> <span class="pre">configuration</span> <span class="pre">module</span></code></a></p></li> <li><p><a class="reference internal" href="../../modules/all/salt.modules.napalm_users.html#module-salt.modules.napalm_users" title="salt.modules.napalm_users"><code class="xref py py-mod docutils literal notranslate"><span class="pre">Users</span> <span class="pre">configuration</span> <span class="pre">management</span></code></a></p></li> </ul> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Beginning with release codename 2019.2.0, any NAPALM command executed when running under a NAPALM Proxy Minion supports the <code class="docutils literal notranslate"><span class="pre">force_reconnect</span></code> magic argument.</p> <p>Proxy Minions generally establish a connection with the remote network device at the time of the Minion startup and that connection is going to be used forever.</p> <p>If one would need execute a command on the device but connecting using different parameters (due to various causes, e.g., unable to authenticate the user specified in the Pillar as the authentication system - say TACACS+ is not available, or the DNS resolver is currently down and would like to temporarily use the IP address instead, etc.), it implies updating the Pillar data and restarting the Proxy Minion process restart. In particular cases like that, you can pass the <code class="docutils literal notranslate"><span class="pre">force_reconnect=True</span></code> keyword argument, together with the alternative connection details, to enforce the command to be executed over a separate connection.</p> <p>For example, if the usual command is <code class="docutils literal notranslate"><span class="pre">salt</span> <span class="pre">'*'</span> <span class="pre">net.arp</span></code>, you can use the following to connect using a different username instead: <code class="docutils literal notranslate"><span class="pre">salt</span> <span class="pre">'*'</span> <span class="pre">net.arp</span> <span class="pre">username=my-alt-usr</span> <span class="pre">force_reconnect=True</span></code>.</p> </div> <dl class="py function"> <h3 id="salt.proxy.napalm.alive"> salt.proxy.napalm.alive(opts)</h3> <dd>
<p>Return the connection status with the remote device.</p> <div class="versionadded"> <p><span class="versionmodified added">New in version 2017.7.0.</span></p> </div> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.call"> salt.proxy.napalm.call(method, *args, **kwargs)</h3> <dd>
<p>Calls a specific method from the network driver instance. Please check the <a class="reference external" href="http://napalm.readthedocs.org/en/latest/support/index.html#getters-support-matrix">readthedocs</a> page for the updated list of getters.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li><p><strong>method</strong> -- specifies the name of the method to be called</p></li> <li><p><strong>params</strong> -- contains the mapping between the name and the values of the parameters needed to call the method</p></li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>A dictionary with three keys:</p> </dd> </dl> <ul class="simple"> <li><p>result (True/False): if the operation succeeded</p></li> <li><p>out (object): returns the object as-is from the call</p></li> <li><p>comment (string): provides more details in case the call failed</p></li> <li><p>traceback (string): complete traceback in case of exception. Please submit an issue including this traceback on the <a class="reference external" href="https://github.com/napalm-automation/napalm/issues/new">correct driver repo</a> and make sure to read the <a class="reference external" href="https://github.com/napalm-automation/napalm#faq">FAQ</a></p></li> </ul> <p>Example:</p> <pre class="highlight-python notranslate" data-language="python">__proxy__['napalm.call']('cli'
                         **{
                            'commands': [
                                'show version',
                                'show chassis fan'
                            ]
                         })</pre> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.fns"> salt.proxy.napalm.fns()</h3> <dd>
<p>Method called by NAPALM grains module.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.get_device"> salt.proxy.napalm.get_device()</h3> <dd>
<p>Returns the network device object.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.get_grains"> salt.proxy.napalm.get_grains()</h3> <dd>
<p>Retrieve facts from the network device.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.grains_refresh"> salt.proxy.napalm.grains_refresh()</h3> <dd>
<p>Refresh the grains.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.init"> salt.proxy.napalm.init(opts)</h3> <dd>
<p>Opens the connection with the network device.</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.initialized"> salt.proxy.napalm.initialized()</h3> <dd>
<p>Connection finished initializing?</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.ping"> salt.proxy.napalm.ping()</h3> <dd>
<p>Connection open successfully?</p> </dd>
</dl> <dl class="py function"> <h3 id="salt.proxy.napalm.shutdown"> salt.proxy.napalm.shutdown(opts)</h3> <dd>
<p>Closes connection with the device.</p> </dd>
</dl> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/proxy/all/salt.proxy.napalm.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/proxy/all/salt.proxy.napalm.html</a>
  </p>
</div>
