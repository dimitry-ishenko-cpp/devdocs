<h1>rest_wsgi</h1> <div class="section" id="a-minimalist-rest-api-for-salt"> <h2>A minimalist REST API for Salt</h2> <p>This <code class="docutils literal notranslate"><span class="pre">rest_wsgi</span></code> module provides a no-frills REST interface for sending commands to the Salt master. There are no dependencies.</p> <p>Extra care must be taken when deploying this module into production. Please read this documentation in entirety.</p> <p>All authentication is done through Salt's <a class="reference internal" href="https://docs.saltproject.io/en/latest/topics/eauth/index.html#acl-eauth"><span class="std std-ref">external auth</span></a> system.</p> </div> <div class="section" id="usage"> <h2>Usage</h2> <ul class="simple"> <li><p>All requests must be sent to the root URL (<code class="docutils literal notranslate"><span class="pre">/</span></code>).</p></li> <li><p>All requests must be sent as a POST request with JSON content in the request body.</p></li> <li><p>All responses are in JSON.</p></li> </ul> <div class="admonition seealso"> <p class="admonition-title">See also</p> <p><a class="reference internal" href="salt.netapi.rest_cherrypy.html#module-salt.netapi.rest_cherrypy.app" title="salt.netapi.rest_cherrypy.app"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rest_cherrypy</span></code></a></p> <p>The <a class="reference internal" href="salt.netapi.rest_cherrypy.html#module-salt.netapi.rest_cherrypy.app" title="salt.netapi.rest_cherrypy.app"><code class="xref py py-mod docutils literal notranslate"><span class="pre">rest_cherrypy</span></code></a> module is more full-featured, production-ready, and has builtin security features.</p> </div> </div> <div class="section" id="deployment"> <h2>Deployment</h2> <p>The <code class="docutils literal notranslate"><span class="pre">rest_wsgi</span></code> netapi module is a standard Python WSGI app. It can be deployed one of two ways.</p> <div class="section" id="using-a-wsgi-compliant-web-server"> <h3>Using a WSGI-compliant web server</h3> <p>This module may be run via any WSGI-compliant production server such as Apache with mod_wsgi or Nginx with FastCGI.</p> <p>It is strongly recommended that this app be used with a server that supports HTTPS encryption since raw Salt authentication credentials must be sent with every request. Any apps that access Salt through this interface will need to manually manage authentication credentials (either username and password or a Salt token). Tread carefully.</p> </div> <div class="section" id="salt-api-using-a-development-only-server"> <h3>
<strong class="program">salt-api</strong> using a development-only server</h3> <p>If run directly via the salt-api daemon it uses the <a class="reference external" href="http://docs.python.org/2/library/wsgiref.html#module-wsgiref.simple_server">wsgiref.simple_server()</a> that ships in the Python standard library. This is a single-threaded server that is intended for testing and development. <strong>This server does not use encryption</strong>; please note that raw Salt authentication credentials must be sent with every HTTP request.</p> <p><strong>Running this module via salt-api is not recommended!</strong></p> <p>In order to start this module via the <code class="docutils literal notranslate"><span class="pre">salt-api</span></code> daemon the following must be put into the Salt master config:</p> <pre class="highlight-default notranslate" data-language="default">rest_wsgi:
    port: 8001</pre> </div> </div> <div class="section" id="usage-examples"> <h2>Usage examples</h2> <dl class="http post"> <dt id="post--"> <code class="sig-name descname">POST </code><code class="sig-name descname">/</code>
</dt> <dd>
<p><strong>Example request</strong> for a basic <code class="docutils literal notranslate"><span class="pre">test.ping</span></code>:</p> <pre class="highlight-default notranslate" data-language="default">% curl -sS -i \
        -H 'Content-Type: application/json' \
        -d '[{"eauth":"pam","username":"saltdev","password":"saltdev","client":"local","tgt":"*","fun":"test.ping"}]' localhost:8001</pre> <p><strong>Example response</strong>:</p> <pre class="highlight-http notranslate" data-language="http">HTTP/1.0 200 OK
Content-Length: 89
Content-Type: application/json

{"return": [{"ms--4": true, "ms--3": true, "ms--2": true, "ms--1": true, "ms--0": true}]}</pre> <p><strong>Example request</strong> for an asynchronous <code class="docutils literal notranslate"><span class="pre">test.ping</span></code>:</p> <pre class="highlight-default notranslate" data-language="default">% curl -sS -i \
        -H 'Content-Type: application/json' \
        -d '[{"eauth":"pam","username":"saltdev","password":"saltdev","client":"local_async","tgt":"*","fun":"test.ping"}]' localhost:8001</pre> <p><strong>Example response</strong>:</p> <pre class="highlight-http notranslate" data-language="http">HTTP/1.0 200 OK
Content-Length: 103
Content-Type: application/json

{"return": [{"jid": "20130412192112593739", "minions": ["ms--4", "ms--3", "ms--2", "ms--1", "ms--0"]}]}</pre> <p><strong>Example request</strong> for looking up a job ID:</p> <pre class="highlight-default notranslate" data-language="default">% curl -sS -i \
        -H 'Content-Type: application/json' \
        -d '[{"eauth":"pam","username":"saltdev","password":"saltdev","client":"runner","fun":"jobs.lookup_jid","jid":"20130412192112593739"}]' localhost:8001</pre> <p><strong>Example response</strong>:</p> <pre class="highlight-http notranslate" data-language="http">HTTP/1.0 200 OK
Content-Length: 89
Content-Type: application/json

{"return": [{"ms--4": true, "ms--3": true, "ms--2": true, "ms--1": true, "ms--0": true}]}</pre> </dd>
</dl> <dl class="field-list simple"> <dt class="field-odd">form lowstate</dt> <dd class="field-odd">
<p>A list of lowstate data appropriate for the <a class="reference internal" href="https://docs.saltproject.io/en/latest/ref/clients/index.html#client-apis"><span class="std std-ref">client</span></a> interface you are calling.</p> </dd> <dt class="field-even">status 200</dt> <dd class="field-even">
<p>success</p> </dd> <dt class="field-odd">status 401</dt> <dd class="field-odd">
<p>authentication required</p> </dd> </dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/netapi/all/salt.netapi.rest_wsgi.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/netapi/all/salt.netapi.rest_wsgi.html</a>
  </p>
</div>
