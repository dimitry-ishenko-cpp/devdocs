<h1>salt.renderers.nacl</h1> <p>Renderer that will decrypt NACL ciphers</p> <p>Any key in the SLS file can be an NACL cipher, and this renderer will decrypt it before passing it off to Salt. This allows you to safely store secrets in source control, in such a way that only your Salt master can decrypt them and distribute them only to the minions that need them.</p> <p>The typical use-case would be to use ciphers in your pillar data, and keep a secret key on your master. You can put the public key in source control so that developers can add new secrets quickly and easily.</p> <p>This renderer requires the libsodium library binary and libnacl &gt;= 1.5.1 python package (support for sealed boxes came in 1.5.1 version).</p> <div class="section" id="setup"> <h2>Setup</h2> <p>To set things up, first generate a keypair. On the master, run the following:</p> <pre class="highlight-bash notranslate" data-language="bash"># salt-call --local nacl.keygen sk_file=/root/.nacl</pre> </div> <div class="section" id="using-encrypted-pillar"> <h2>Using encrypted pillar</h2> <p>To encrypt secrets, copy the public key to your local machine and run:</p> <pre class="highlight-bash notranslate" data-language="bash">$ salt-call --local nacl.enc datatoenc pk_file=/root/.nacl.pub</pre> <p>To apply the renderer on a file-by-file basis add the following line to the top of any pillar with nacl encrypted data in it:</p> <pre class="highlight-yaml notranslate" data-language="yaml">#!yaml|nacl</pre> <p>Now with your renderer configured, you can include your ciphers in your pillar data like so:</p> <pre class="highlight-yaml notranslate" data-language="yaml">#!yaml|nacl

a-secret: "NACL[MRN3cc+fmdxyQbz6WMF+jq1hKdU5X5BBI7OjK+atvHo1ll+w1gZ7XyWtZVfq9gK9rQaMfkDxmidJKwE0Mw==]"</pre> <dl class="py function"> <h3 id="salt.renderers.nacl.render"> salt.renderers.nacl.render(nacl_data, saltenv='base', sls='', argline='', **kwargs)</h3> <dd>
<p>Decrypt the data to be rendered using the given nacl key or the one given in config</p> </dd>
</dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 SaltStack.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.saltproject.io/en/latest/ref/renderers/all/salt.renderers.nacl.html" class="_attribution-link">https://docs.saltproject.io/en/latest/ref/renderers/all/salt.renderers.nacl.html</a>
  </p>
</div>
