<h1 class="command-name">TS.MADD</h1>
<pre>TS.MADD</pre> <div class="font-semibold text-slate-900">Syntax</div> <pre class="command-syntax">TS.MADD {key timestamp value}...
</pre> <dl class="grid grid-cols-[auto,1fr] gap-x-2 mb-12"> <dt class="font-semibold text-slate-900">Available in:</dt> <dd> <a href="https://redis.io/docs/stack">Redis Stack</a> / <a href="https://redis.io/docs/stack/timeseries">TimeSeries 1.0.0</a> </dd> <dt class="font-semibold text-slate-900">Time complexity:</dt> <dd>O(N*M) when N is the amount of series updated and M is the amount of compaction rules or O(N) with no compaction</dd> </dl> <p>Append new samples to one or more time series</p> <p><a href="#examples">Examples</a></p> <h2 id="required-arguments">Required arguments</h2> <details open> <summary><code>key</code></summary> <p>is the key name for the time series.</p> </details> <details open> <summary><code>timestamp</code></summary> <p>is (integer) UNIX sample timestamp in milliseconds or <code>*</code> to set the timestamp according to the server clock.</p> </details> <details open> <summary><code>value</code></summary> <p>is numeric data value of the sample (double). The double number should follow <a href="https://tools.ietf.org/html/rfc7159">RFC 7159</a> (a JSON standard). The parser rejects overly large values that would not fit in binary64. It does not accept NaN or infinite values.</p> </details> <p><note><b>Notes:</b></note></p> <ul> <li>If <code>timestamp</code> is older than the retention period compared to the maximum existing timestamp, the sample is discarded and an error is returned.</li> <li>Explicitly adding samples to a compacted time series (using <a href="../ts.add.html"><code>TS.ADD</code></a>, <code>TS.MADD</code>, <a href="../ts.incrby.html"><code>TS.INCRBY</code></a>, or <a href="../ts.decrby.html"><code>TS.DECRBY</code></a>) may result in inconsistencies between the raw and the compacted data. The compaction process may override such samples. </li> </ul> <h2 id="return-value">Return value</h2> <p>Either</p> <ul> <li>
<a href="https://redis.io/docs/reference/protocol-spec#resp-arrays">Array reply</a> of <a href="https://redis.io/docs/reference/protocol-spec#resp-integers">Integer reply</a> representing the timestamp of each added sample or an <a href="https://redis.io/docs/reference/protocol-spec#resp-errors">Error reply</a> (e.g., on <code>DUPLICATE_POLICY</code> violation)</li> <li>
<a href="https://redis.io/docs/reference/protocol-spec#resp-errors">Error reply</a> (e.g., on wrong number of arguments)</li> </ul> <h2 id="complexity">Complexity</h2> <p>If a compaction rule exits on a time series, TS.MADD performance might be reduced. The complexity of TS.MADD is always <code>O(N*M)</code>, where <code>N</code> is the amount of series updated and <code>M</code> is the amount of compaction rules or <code>O(N)</code> with no compaction.</p> <h2 id="examples">Examples</h2> <details open> <summary><b>Add stock prices at different timestamps</b></summary> <p>Create two stocks and add their prices at three different timestamps.</p> <div class="highlight"><pre tabindex="0" class="chroma"><span class="line"><span class="cl">127.0.0.1:6379&gt; TS.CREATE stock:A LABELS <span class="nb">type</span> stock name A
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; TS.CREATE stock:B LABELS <span class="nb">type</span> stock name B
</span></span><span class="line"><span class="cl">OK
</span></span><span class="line"><span class="cl">127.0.0.1:6379&gt; TS.MADD stock:A <span class="m">1000</span> <span class="m">100</span> stock:A <span class="m">1010</span> <span class="m">110</span> stock:A <span class="m">1020</span> <span class="m">120</span> stock:B <span class="m">1000</span> <span class="m">120</span> stock:B <span class="m">1010</span> <span class="m">110</span> stock:B <span class="m">1020</span> <span class="m">100</span>
</span></span><span class="line"><span class="cl">1<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1000</span>
</span></span><span class="line"><span class="cl">2<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1010</span>
</span></span><span class="line"><span class="cl">3<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1020</span>
</span></span><span class="line"><span class="cl">4<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1000</span>
</span></span><span class="line"><span class="cl">5<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1010</span>
</span></span><span class="line"><span class="cl">6<span class="o">)</span> <span class="o">(</span>integer<span class="o">)</span> <span class="m">1020</span></span></span></pre></div> </details> <h2 id="see-also">See also</h2> <p><a href="../ts.mrange.html"><code>TS.MRANGE</code></a> | <a href="../ts.range.html"><code>TS.RANGE</code></a> | <a href="../ts.mrevrange.html"><code>TS.MREVRANGE</code></a> | <a href="../ts.revrange.html"><code>TS.REVRANGE</code></a></p> <h2 id="related-topics">Related topics</h2> <p><a href="https://redis.io/docs/stack/timeseries">RedisTimeSeries</a></p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2006&ndash;2022 Salvatore Sanfilippo<br>Licensed under the Creative Commons Attribution-ShareAlike License 4.0.<br>
    <a href="https://redis.io/commands/ts.madd/" class="_attribution-link">https://redis.io/commands/ts.madd/</a>
  </p>
</div>
