<header><h1>SyntaxError: tagged template cannot be used with optional chain</h1></header><div class="section-content"><p>The JavaScript exception "tagged template cannot be used with optional chain" occurs when the tag expression of a <a href="../template_literals.html#tagged_templates">tagged template literal</a> is an <a href="../operators/optional_chaining.html">optional chain</a>, or if there's an optional chain between the tag and the template.</p></div>
<section aria-labelledby="message"><h2 id="message">Message</h2>
<div class="section-content"><pre data-language="plain">SyntaxError: Invalid tagged template on optional chain (V8-based)
SyntaxError: tagged template cannot be used with optional chain (Firefox)
SyntaxError: Cannot use tagged templates in an optional chain. (Safari)
</pre></div></section><section aria-labelledby="error_type"><h2 id="error_type">Error type</h2>
<div class="section-content"><a href="../global_objects/syntaxerror.html"><code>SyntaxError</code></a></div></section><section aria-labelledby="what_went_wrong"><h2 id="what_went_wrong">What went wrong?</h2>
<div class="section-content">
<p>There are two ways to get this error. The first one is if the tag expression is an optional chain expression, like this:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="dsRyGZZ22VY9JO1IX0yzBzptFCyrbgrOMyQGX5rgvkU=" data-language="js">String<span class="token operator">?.</span>raw<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span>log<span class="token operator">?.</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
Number<span class="token operator">?.</span><span class="token punctuation">[</span>parseMethod<span class="token punctuation">]</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</pre>
</div> <p>The second one is if <code>?.</code> occurs between the tag and the template, like this:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="zI9Q3RZBvsbGf4mTo6j6dZlZ4LiDsf9/7V9NuRF1SMs=" data-language="js">String<span class="token punctuation">.</span>raw<span class="token operator">?.</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</pre>
</div> <p>Optional chaining in the tag is specifically forbidden because there's no great use case for it, and what the result is expected to be is unclear (should it be <code>undefined</code> or the template's value as if it's untagged?). You need to translate the optional chaining to its underlying condition (see <a href="../operators/optional_chaining.html">optional chaining</a> for more information).</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="7SNHCWjBPW+QFYWvhtVcWKXigvBRD58TgCmKDHnKorw=" data-language="js"><span class="token keyword">const</span> result <span class="token operator">=</span>
  String<span class="token punctuation">.</span>raw <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> String<span class="token punctuation">.</span>raw <span class="token operator">===</span> <span class="token keyword">undefined</span>
    <span class="token operator">?</span> <span class="token keyword">undefined</span>
    <span class="token operator">:</span> String<span class="token punctuation">.</span>raw<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</pre>
</div> <p>Remember that optional chaining only short-circuits within a parenthesized unit. If you parenthesize your tag expression, the optional chaining will not cause an error, because now the tag does not short-circuit and the result is clear (the tag will produce <code>undefined</code> and then cause the tagged template to throw).</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="g99lAW1X9TNv+VsSGZ2JmJ3efgkro4fuPj0U9t0hlHY=" data-language="js"><span class="token punctuation">(</span>console<span class="token operator">?.</span>log<span class="token punctuation">)</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, world!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// Throws if console?.log is undefined</span>
</pre>
</div> <p>However this is a bit nonsensical anyway because optional chaining prevents errors inside the property access chain, but is then guaranteed to generate an error when calling the template tag. You would probably still want to use a conditional check.</p> <p>Note that optional chaining is only forbidden as the tag expression. You can use optional chaining inside the embedded expressions, or use optional chaining on the tagged template expression as a whole.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="lhDJ3Z/RN9MwHf4p9pyHayi+bMfCoQpfqwcKAD5xTyM=" data-language="js">console<span class="token punctuation">.</span>log<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token boolean">true</span><span class="token punctuation">.</span>constructor<span class="token operator">?.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span> <span class="token comment">// ['Hello, ', '!', raw: Array(2)] 'Boolean'</span>
console<span class="token punctuation">.</span>log<span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello</span><span class="token template-punctuation string">`</span></span><span class="token operator">?.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// undefined</span>
</pre>
</div>
</div></section><section aria-labelledby="see_also"><h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../template_literals.html">Template literals</a></li> <li><a href="../operators/optional_chaining.html">Optional chaining (<code>?.</code>)</a></li> <li><a href="https://github.com/tc39/proposal-optional-chaining/issues/54" target="_blank">Original discussion on whether optional chaining should be allowed in tagged template literals</a></li> </ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Bad_optional_template" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Errors/Bad_optional_template</a>
  </p>
</div>
