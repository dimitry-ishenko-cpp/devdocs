<h1>prefer-promise-reject-errors</h1> 
<p>Require using Error objects as Promise rejection reasons</p>   <p>It is considered good practice to only pass instances of the built-in <code>Error</code> object to the <code>reject()</code> function for user-defined errors in Promises. <code>Error</code> objects automatically store a stack trace, which can be used to debug an error by determining where it came from. If a Promise is rejected with a non-<code>Error</code> value, it can be difficult to determine where the rejection occurred.</p> <h2 id="rule-details" tabindex="-1">Rule Details</h2> <p>This rule aims to ensure that Promises are only rejected with <code>Error</code> objects.</p> <h2 id="options" tabindex="-1">Options</h2> <p>This rule takes one optional object argument:</p> <ul> <li>
<code>allowEmptyReject: true</code> (<code>false</code> by default) allows calls to <code>Promise.reject()</code> with no arguments.</li> </ul> <p>Examples of <strong>incorrect</strong> code for this rule:</p> <div class="incorrect"> <a class="c-btn c-btn--secondary c-btn--playground" href="https://eslint.org/play#eyJvcHRpb25zIjp7InBhcnNlck9wdGlvbnMiOnsic291cmNlVHlwZSI6Im1vZHVsZSJ9fSwidGV4dCI6Ii8qZXNsaW50IHByZWZlci1wcm9taXNlLXJlamVjdC1lcnJvcnM6IFwiZXJyb3JcIiovXG5cblByb21pc2UucmVqZWN0KFwic29tZXRoaW5nIGJhZCBoYXBwZW5lZFwiKTtcblxuUHJvbWlzZS5yZWplY3QoNSk7XG5cblByb21pc2UucmVqZWN0KCk7XG5cbm5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICByZWplY3QoXCJzb21ldGhpbmcgYmFkIGhhcHBlbmVkXCIpO1xufSk7XG5cbm5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICByZWplY3QoKTtcbn0pO1xuIn0=" target="_blank"> Open in Playground </a><pre class="language-js line-numbers-mode"><code><span class="token comment">/*eslint prefer-promise-reject-errors: "error"*/</span>

<span class="token eslint-marked eslint-message-id-1" title="Expected the Promise rejection reason to be an Error.">Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">"something bad happened"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>

<span class="token eslint-marked eslint-message-id-1" title="Expected the Promise rejection reason to be an Error.">Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>

<span class="token eslint-marked eslint-message-id-1" title="Expected the Promise rejection reason to be an Error.">Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token eslint-marked eslint-message-id-1" title="Expected the Promise rejection reason to be an Error."><span class="token function">reject</span><span class="token punctuation">(</span><span class="token string">"something bad happened"</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token eslint-marked eslint-message-id-1" title="Expected the Promise rejection reason to be an Error."><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre>
</div>
<p>Examples of <strong>correct</strong> code for this rule:</p> <div class="correct"> <a class="c-btn c-btn--secondary c-btn--playground" href="https://eslint.org/play#eyJvcHRpb25zIjp7InBhcnNlck9wdGlvbnMiOnsic291cmNlVHlwZSI6Im1vZHVsZSJ9fSwidGV4dCI6Ii8qZXNsaW50IHByZWZlci1wcm9taXNlLXJlamVjdC1lcnJvcnM6IFwiZXJyb3JcIiovXG5cblByb21pc2UucmVqZWN0KG5ldyBFcnJvcihcInNvbWV0aGluZyBiYWQgaGFwcGVuZWRcIikpO1xuXG5Qcm9taXNlLnJlamVjdChuZXcgVHlwZUVycm9yKFwic29tZXRoaW5nIGJhZCBoYXBwZW5lZFwiKSk7XG5cbm5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICByZWplY3QobmV3IEVycm9yKFwic29tZXRoaW5nIGJhZCBoYXBwZW5lZFwiKSk7XG59KTtcblxudmFyIGZvbyA9IGdldFVua25vd25WYWx1ZSgpO1xuUHJvbWlzZS5yZWplY3QoZm9vKTsifQ==" target="_blank"> Open in Playground </a><pre class="language-js line-numbers-mode"><code><span class="token comment">/*eslint prefer-promise-reject-errors: "error"*/</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"something bad happened"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"something bad happened"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">reject</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">"something bad happened"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> foo <span class="token operator">=</span> <span class="token function">getUnknownValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span>foo<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div>
<p>Examples of <strong>correct</strong> code for this rule with the <code>allowEmptyReject: true</code> option:</p> <div class="correct"> <a class="c-btn c-btn--secondary c-btn--playground" href="https://eslint.org/play#eyJvcHRpb25zIjp7InBhcnNlck9wdGlvbnMiOnsic291cmNlVHlwZSI6Im1vZHVsZSJ9fSwidGV4dCI6Ii8qZXNsaW50IHByZWZlci1wcm9taXNlLXJlamVjdC1lcnJvcnM6IFtcImVycm9yXCIsIHtcImFsbG93RW1wdHlSZWplY3RcIjogdHJ1ZX1dKi9cblxuUHJvbWlzZS5yZWplY3QoKTtcblxubmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gIHJlamVjdCgpO1xufSk7In0=" target="_blank"> Open in Playground </a><pre class="language-js line-numbers-mode"><code><span class="token comment">/*eslint prefer-promise-reject-errors: ["error", {"allowEmptyReject": true}]*/</span>

Promise<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
</div>
<h2 id="known-limitations" tabindex="-1">Known Limitations</h2> <p>Due to the limits of static analysis, this rule cannot guarantee that you will only reject Promises with <code>Error</code> objects. While the rule will report cases where it can guarantee that the rejection reason is clearly not an <code>Error</code>, it will not report cases where there is uncertainty about whether a given reason is an <code>Error</code>. For more information on this caveat, see the <a href="prefer-promise-reject-errorsno-throw-literal.html#known-limitations">similar limitations</a> in the <code>no-throw-literal</code> rule.</p> <p>To avoid conflicts between rules, this rule does not report non-error values used in <code>throw</code> statements in async functions, even though these lead to Promise rejections. To lint for these cases, use the <a href="prefer-promise-reject-errorsno-throw-literal.html"><code>no-throw-literal</code></a> rule.</p> <h2 id="when-not-to-use-it" tabindex="-1">When Not To Use It</h2> <p>If you’re using custom non-error values as Promise rejection reasons, you can turn off this rule.</p> <h2 id="related-rules">Related Rules</h2> <ul class="related-rules__list" role="list"> <li class="related-rules__list__item"> <a href="no-throw-literal.html"> <span>no-throw-literal</span>  </a> </li> </ul> <h2 id="version">Version</h2> <p>This rule was introduced in ESLint v3.14.0.</p> <h2 id="further-reading">Further Reading</h2> <article class="resource">  <div class="resource__content"> <a href="http://bluebirdjs.com/docs/warning-explanations.html#warning-a-promise-was-rejected-with-a-non-error" class="resource__title"> Warning Explanations | bluebird </a><br>  </div>  </article> <h2 id="resources">Resources</h2> <ul> <li><a href="https://github.com/eslint/eslint/blob/main/lib/rules/prefer-promise-reject-errors.js">Rule source</a></li> <li><a href="https://github.com/eslint/eslint/blob/main/tests/lib/rules/prefer-promise-reject-errors.js">Tests source</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; OpenJS Foundation and other contributors<br>Licensed under the MIT License.<br>
    <a href="https://eslint.org/docs/latest/rules/prefer-promise-reject-errors" class="_attribution-link">https://eslint.org/docs/latest/rules/prefer-promise-reject-errors</a>
  </p>
</div>
