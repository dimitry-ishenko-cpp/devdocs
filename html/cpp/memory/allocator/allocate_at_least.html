    <h1 id="firstHeading" class="firstHeading">std::allocator&lt;T&gt;::allocate_at_least</h1>            <table class="t-dcl-begin"> <tr class="t-dcl t-since-cxx23"> <td> <pre data-language="cpp">[[nodiscard]] constexpr std::allocation_result&lt;T*, std::size_t&gt;
    allocate_at_least( std::size_t n );</pre>
</td> <td class="t-dcl-nopad"> </td> <td> <span class="t-mark-rev t-since-cxx23">(since C++23)</span> </td> </tr>  </table> <p>Allocates <code>count * sizeof(T)</code> bytes of uninitialized storage, where <code>count</code> is an unspecified integer value not less than <code>n</code>, by calling <code><span class="sy4">::</span><a href="http://en.cppreference.com/w/cpp/memory/new/operator_new"><span class="kw690">operator new</span></a></code> (an additional <code><a href="../new/align_val_t.html" title="cpp/memory/new/align val t">std::align_val_t</a></code> argument might be provided), but it is unspecified when and how this function is called.</p>
<p>Then, this function creates an array of type <code>T[count]</code> in the storage and starts its lifetime, but does not start lifetime of any of its elements.</p>
<p>In order to use this function in a constant expression, the allocated storage must be deallocated within the evaluation of the same expression.</p>
<p>Use of this function is ill-formed if <code>T</code> is an <a href="../../language/type.html#Incomplete_type" title="cpp/language/type">incomplete type</a>.</p>
<h3 id="Parameters"> Parameters</h3> <table class="t-par-begin"> <tr class="t-par"> <td> n </td> <td> - </td> <td> the lower bound of number of objects to allocate storage for </td>
</tr>
</table> <h3 id="Return_value"> Return value</h3> <p><code><a href="http://en.cppreference.com/w/cpp/memory/allocation_result"><span class="kw3373">std::<span class="me2">allocation_result</span></span></a><span class="sy1">&lt;</span>T<span class="sy2">*</span><span class="sy1">&gt;</span><span class="br0">{</span>p, count<span class="br0">}</span></code>, where <code>p</code> points to the first element of an array of <code>count</code> objects of type <code>T</code> whose elements have not been constructed yet.</p>
<h3 id="Exceptions"> Exceptions</h3> <p>Throws <code><a href="../new/bad_array_new_length.html" title="cpp/memory/new/bad array new length">std::bad_array_new_length</a></code> if <code><a href="http://en.cppreference.com/w/cpp/types/numeric_limits"><span class="kw351">std::<span class="me2">numeric_limits</span></span></a><span class="sy1">&lt;</span><a href="http://en.cppreference.com/w/cpp/types/size_t"><span class="kw107">std::<span class="me2">size_t</span></span></a><span class="sy1">&gt;</span><span class="sy4">::</span><span class="me2">max</span><span class="br0">(</span><span class="br0">)</span> <span class="sy2">/</span> sizeof<span class="br0">(</span>T<span class="br0">)</span> <span class="sy1">&lt;</span> n</code>, or <code><a href="../new/bad_alloc.html" title="cpp/memory/new/bad alloc">std::bad_alloc</a></code> if allocation fails.</p>
<h3 id="Notes"> Notes</h3> <p><code>allocate_at_least</code> is mainly provided for contiguous containers, e.g. <code><a href="../../container/vector.html" title="cpp/container/vector">std::vector</a></code> and <code><a href="../../string/basic_string.html" title="cpp/string/basic string">std::basic_string</a></code>, in order to reduce reallocation by making their capacity match the actually allocated size when possible.</p>
<p>The "unspecified when and how" wording makes it possible to <a href="../../language/new.html#Allocation" title="cpp/language/new">combine or optimize away heap allocations</a> made by the standard library containers, even though such optimizations are disallowed for direct calls to <code><span class="sy4">::</span><a href="http://en.cppreference.com/w/cpp/memory/new/operator_new"><span class="kw690">operator new</span></a></code>. For example, this is implemented by libc++ (<a rel="nofollow" class="external autonumber" href="https://github.com/llvm-mirror/libcxx/blob/master@%7B2017-02-09%7D/include/memory#L1766-L1772">[1]</a> and <a rel="nofollow" class="external autonumber" href="https://github.com/llvm-mirror/libcxx/blob/master@%7B2017-02-09%7D/include/new#L211-L217">[2]</a>).</p>
<p>After calling <a href="#top"><code>allocate_at_least</code></a> and before construction of elements, pointer arithmetic of <code>T*</code> is well-defined within the allocated array, but the behavior is undefined if elements are accessed.</p>
<table class="wikitable ftm-begin ftm-has-value"> <tr> <th>
<a href="../../utility/feature_test.html" title="cpp/utility/feature test">Feature-test</a> macro</th> <th>Value</th> <th><span title="Standard in which the feature is introduced">Std</span></th> <th>Feature </th>
</tr> <tr> <td><a href="../../feature_test.html#cpp_lib_allocate_at_least" title="cpp/feature test"><code>__cpp_lib_allocate_at_least</code></a></td> <td><span class="nu0">202302L</span></td> <td><span class="t-mark">(C++23)</span></td> <td>
<a href="#top"><code>allocate_at_least</code></a> etc. </td>
</tr>
</table> <h3 id="Example"> Example</h3>  <h3 id="See_also"> See also</h3> <table class="t-dsc-begin"> <tr class="t-dsc"> <td> <div><a href="../allocation_result.html" title="cpp/memory/allocation result"> <span class="t-lines"><span>allocation_result</span></span></a></div>
<div><span class="t-lines"><span><span class="t-mark-rev t-since-cxx23">(C++23)</span></span></span></div> </td> <td> records the address and the actual size of storage allocated by <code>allocate_at_least</code> <br> <span class="t-mark">(class template)</span>  </td>
</tr> <tr class="t-dsc"> <td> <div><a href="../allocator_traits/allocate_at_least.html" title="cpp/memory/allocator traits/allocate at least"> <span class="t-lines"><span>allocate_at_least</span></span></a></div>
<div><span class="t-lines"><span><span class="t-cmark">[static]</span> <span class="t-mark-rev t-since-cxx23">(C++23)</span></span></span></div> </td> <td> allocates storage at least as large as the requested size via an allocator <br> <span class="t-mark">(public static member function of <code>std::allocator_traits&lt;Alloc&gt;</code>)</span>  </td>
</tr> </table>           <div class="_attribution">
  <p class="_attribution-p">
    &copy; cppreference.com<br>Licensed under the Creative Commons Attribution-ShareAlike Unported License v3.0.<br>
    <a href="https://en.cppreference.com/w/cpp/memory/allocator/allocate_at_least" class="_attribution-link">https://en.cppreference.com/w/cpp/memory/allocator/allocate_at_least</a>
  </p>
</div>
