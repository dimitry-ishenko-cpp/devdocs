<h1>Incomplete and Skipped Tests</h1> <div class="section" id="incomplete-tests"> <h2>Incomplete Tests</h2> <p>When you are working on a new test case class, you might want to begin by writing empty test methods such as:</p> <div class="highlight-php">
<div class="highlight"><pre class="highlight" data-language="php"><span class="k">public</span> <span class="k">function</span> <span class="nf">testSomething</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
<span class="p">{</span>
<span class="p">}</span>
</pre></div> </div> <p>to keep track of the tests that you have to write. The problem with empty test methods is that they are interpreted as a success by the PHPUnit framework. This misinterpretation leads to the test reports being useless – you cannot see whether a test is actually successful or just not yet implemented. Calling <code class="docutils literal"><span class="pre">$this-&gt;fail()</span></code> in the unimplemented test method does not help either, since then the test will be interpreted as a failure. This would be just as wrong as interpreting an unimplemented test as a success.</p> <p>If we think of a successful test as a green light and a test failure as a red light, we need an additional yellow light to mark a test as being incomplete or not yet implemented. <code class="docutils literal"><span class="pre">PHPUnit\Framework\IncompleteTest</span></code> is a marker interface for marking an exception that is raised by a test method as the result of the test being incomplete or currently not implemented. <code class="docutils literal"><span class="pre">PHPUnit\Framework\IncompleteTestError</span></code> is the standard implementation of this interface.</p> <p><a class="reference internal" href="#incomplete-and-skipped-tests-incomplete-tests-examples-sampletest-php"><span class="std std-numref">Example 7.1</span></a> shows a test case class, <code class="docutils literal"><span class="pre">SampleTest</span></code>, that contains one test method, <code class="docutils literal"><span class="pre">testSomething()</span></code>. By calling the convenience method <code class="docutils literal"><span class="pre">markTestIncomplete()</span></code> (which automatically raises an <code class="docutils literal"><span class="pre">PHPUnit\Framework\IncompleteTestError</span></code> exception) in the test method, we mark the test as being incomplete.</p> <div class="literal-block-wrapper docutils container" id="incomplete-and-skipped-tests-incomplete-tests-examples-sampletest-php"> <div class="code-block-caption">
<span class="caption-number">Example 7.1 </span><span class="caption-text">Marking a test as incomplete</span>
</div> <div class="highlight-php">
<div class="highlight"><pre class="highlight" data-language="php"><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="k">use</span> <span class="nx">PHPUnit\Framework\TestCase</span><span class="p">;</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">SampleTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testSomething</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="c1">// Optional: Test anything here, if you want.</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">assertTrue</span><span class="p">(</span><span class="k">true</span><span class="p">,</span> <span class="s1">'This should already work.'</span><span class="p">);</span>

        <span class="c1">// Stop here and mark this test as incomplete.</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">markTestIncomplete</span><span class="p">(</span>
          <span class="s1">'This test has not been implemented yet.'</span>
        <span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div> </div> </div> <p>An incomplete test is denoted by an <code class="docutils literal"><span class="pre">I</span></code> in the output of the PHPUnit command-line test runner, as shown in the following example:</p> <pre class="highlight" data-language="php">
$ phpunit --verbose SampleTest
PHPUnit 9.5.0 by Sebastian Bergmann and contributors.

I

Time: 0 seconds, Memory: 3.95Mb

There was 1 incomplete test:

1) SampleTest::testSomething
This test has not been implemented yet.

/home/sb/SampleTest.php:12
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 1, Incomplete: 1.
</pre> <p><a class="reference internal" href="#incomplete-and-skipped-tests-incomplete-tests-tables-api"><span class="std std-numref">Table 7.1</span></a> shows the API for marking tests as incomplete.</p> <table border="1" class="table docutils" id="incomplete-and-skipped-tests-incomplete-tests-tables-api"> <caption>
<span class="caption-number">Table 7.1 </span><span class="caption-text">API for Incomplete Tests</span>
</caption> <colgroup> <col width="50%"> <col width="50%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Method</th> <th class="head">Meaning</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="docutils literal"><span class="pre">void</span> <span class="pre">markTestIncomplete()</span></code></td> <td>Marks the current test as incomplete.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal"><span class="pre">void</span> <span class="pre">markTestIncomplete(string</span> <span class="pre">$message)</span></code></td> <td>Marks the current test as incomplete using <code class="docutils literal"><span class="pre">$message</span></code> as an explanatory message.</td> </tr> </tbody> </table> </div> <div class="section" id="skipping-tests"> <h2>Skipping Tests</h2> <p>Not all tests can be run in every environment. Consider, for instance, a database abstraction layer that has several drivers for the different database systems it supports. The tests for the MySQL driver can only be run if a MySQL server is available.</p> <p><a class="reference internal" href="#incomplete-and-skipped-tests-skipping-tests-examples-databasetest-php"><span class="std std-numref">Example 7.2</span></a> shows a test case class, <code class="docutils literal"><span class="pre">DatabaseTest</span></code>, that contains one test method, <code class="docutils literal"><span class="pre">testConnection()</span></code>. In the test case class’ <code class="docutils literal"><span class="pre">setUp()</span></code> template method we check whether the MySQLi extension is available and use the <code class="docutils literal"><span class="pre">markTestSkipped()</span></code> method to skip the test if it is not.</p> <div class="literal-block-wrapper docutils container" id="incomplete-and-skipped-tests-skipping-tests-examples-databasetest-php"> <div class="code-block-caption">
<span class="caption-number">Example 7.2 </span><span class="caption-text">Skipping a test</span>
</div> <div class="highlight-php">
<div class="highlight"><pre class="highlight" data-language="php"><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="k">use</span> <span class="nx">PHPUnit\Framework\TestCase</span><span class="p">;</span>

<span class="k">final</span> <span class="k">class</span> <span class="nc">DatabaseTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="k">protected</span> <span class="k">function</span> <span class="nf">setUp</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">extension_loaded</span><span class="p">(</span><span class="s1">'mysqli'</span><span class="p">))</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">markTestSkipped</span><span class="p">(</span>
              <span class="s1">'The MySQLi extension is not available.'</span>
            <span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">testConnection</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div> </div> </div> <p>A test that has been skipped is denoted by an <code class="docutils literal"><span class="pre">S</span></code> in the output of the PHPUnit command-line test runner, as shown in the following example:</p> <pre class="highlight" data-language="php">
$ phpunit --verbose DatabaseTest
PHPUnit 9.5.0 by Sebastian Bergmann and contributors.

S

Time: 0 seconds, Memory: 3.95Mb

There was 1 skipped test:

1) DatabaseTest::testConnection
The MySQLi extension is not available.

/home/sb/DatabaseTest.php:9
OK, but incomplete or skipped tests!
Tests: 1, Assertions: 0, Skipped: 1.
</pre> <p><a class="reference internal" href="#incomplete-and-skipped-tests-skipped-tests-tables-api"><span class="std std-numref">Table 7.2</span></a> shows the API for skipping tests.</p> <table border="1" class="table docutils" id="incomplete-and-skipped-tests-skipped-tests-tables-api"> <caption>
<span class="caption-number">Table 7.2 </span><span class="caption-text">API for Skipping Tests</span>
</caption> <colgroup> <col width="50%"> <col width="50%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Method</th> <th class="head">Meaning</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="docutils literal"><span class="pre">void</span> <span class="pre">markTestSkipped()</span></code></td> <td>Marks the current test as skipped.</td> </tr> <tr class="row-odd">
<td><code class="docutils literal"><span class="pre">void</span> <span class="pre">markTestSkipped(string</span> <span class="pre">$message)</span></code></td> <td>Marks the current test as skipped using <code class="docutils literal"><span class="pre">$message</span></code> as an explanatory message.</td> </tr> </tbody> </table> </div> <div class="section" id="skipping-tests-using-requires"> <h2>Skipping Tests using @requires</h2> <p>In addition to the above methods it is also possible to use the <code class="docutils literal"><span class="pre">@requires</span></code> annotation to express common preconditions for a test case.</p> <table border="1" class="table docutils" id="incomplete-and-skipped-tests-requires-tables-api"> <caption>
<span class="caption-number">Table 7.3 </span><span class="caption-text">Possible @requires usages</span>
</caption> <colgroup> <col width="25%"> <col width="25%"> <col width="25%"> <col width="25%"> </colgroup> <thead valign="bottom"> <tr class="row-odd">
<th class="head">Type</th> <th class="head">Possible Values</th> <th class="head">Examples</th> <th class="head">Another example</th> </tr> </thead> <tbody valign="top"> <tr class="row-even">
<td><code class="docutils literal"><span class="pre">PHP</span></code></td> <td>Any PHP version identifier along with an optional operator</td> <td>@requires PHP 7.1.20</td> <td>@requires PHP &gt;= 7.2</td> </tr> <tr class="row-odd">
<td><code class="docutils literal"><span class="pre">PHPUnit</span></code></td> <td>Any PHPUnit version identifier along with an optional operator</td> <td>@requires PHPUnit 7.3.1</td> <td>@requires PHPUnit &lt; 8</td> </tr> <tr class="row-even">
<td><code class="docutils literal"><span class="pre">OS</span></code></td> <td>A regexp matching <a class="reference external" href="https://www.php.net/manual/en/reserved.constants.php#constant.php-os">PHP_OS</a>
</td> <td>@requires OS Linux</td> <td>@requires OS WIN32|WINNT</td> </tr> <tr class="row-odd">
<td><code class="docutils literal"><span class="pre">OSFAMILY</span></code></td> <td>Any <a class="reference external" href="https://www.php.net/manual/en/reserved.constants.php#constant.php-os-family">OS family</a>
</td> <td>@requires OSFAMILY Solaris</td> <td>@requires OSFAMILY Windows</td> </tr> <tr class="row-even">
<td><code class="docutils literal"><span class="pre">function</span></code></td> <td>Any valid parameter to <a class="reference external" href="https://www.php.net/function_exists">function_exists</a>
</td> <td>@requires function imap_open</td> <td>@requires function ReflectionMethod::setAccessible</td> </tr> <tr class="row-odd">
<td><code class="docutils literal"><span class="pre">extension</span></code></td> <td>Any extension name along with an optional version identifier and optional operator</td> <td>@requires extension mysqli</td> <td>@requires extension redis &gt;= 2.2.0</td> </tr> </tbody> </table> <p>The following operators are supported for PHP, PHPUnit, and extension version constraints: <code class="docutils literal"><span class="pre">&lt;</span></code>, <code class="docutils literal"><span class="pre">&lt;=</span></code>, <code class="docutils literal"><span class="pre">&gt;</span></code>, <code class="docutils literal"><span class="pre">&gt;=</span></code>, <code class="docutils literal"><span class="pre">=</span></code>, <code class="docutils literal"><span class="pre">==</span></code>, <code class="docutils literal"><span class="pre">!=</span></code>, <code class="docutils literal"><span class="pre">&lt;&gt;</span></code>.</p> <p>Versions are compared using PHP’s <a class="reference external" href="https://www.php.net/version_compare">version_compare</a> function. Among other things, this means that the <code class="docutils literal"><span class="pre">=</span></code> and <code class="docutils literal"><span class="pre">==</span></code> operator can only be used with complete <code class="docutils literal"><span class="pre">X.Y.Z</span></code> version numbers and that just <code class="docutils literal"><span class="pre">X.Y</span></code> will not work.</p> <div class="literal-block-wrapper docutils container" id="incomplete-and-skipped-tests-skipping-tests-examples-databaseclassskippingtest-php"> <div class="code-block-caption">
<span class="caption-number">Example 7.3 </span><span class="caption-text">Skipping test cases using @requires</span>
</div> <div class="highlight-php">
<div class="highlight"><pre class="highlight" data-language="php"><span class="o">&lt;?</span><span class="nx">php</span> <span class="k">declare</span><span class="p">(</span><span class="nx">strict_types</span><span class="o">=</span><span class="mi">1</span><span class="p">);</span>
<span class="k">use</span> <span class="nx">PHPUnit\Framework\TestCase</span><span class="p">;</span>

<span class="sd">/**</span>
<span class="sd"> * @requires extension mysqli</span>
<span class="sd"> */</span>
<span class="k">final</span> <span class="k">class</span> <span class="nc">DatabaseTest</span> <span class="k">extends</span> <span class="nx">TestCase</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * @requires PHP &gt;= 5.3</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">testConnection</span><span class="p">()</span><span class="o">:</span> <span class="nx">void</span>
    <span class="p">{</span>
        <span class="c1">// Test requires the mysqli extension and PHP &gt;= 5.3</span>
    <span class="p">}</span>

    <span class="c1">// ... All other tests require the mysqli extension</span>
<span class="p">}</span>
</pre></div> </div> </div> <p>If you are using syntax that doesn’t compile with a certain PHP Version look into the xml configuration for version dependent includes in <a class="reference internal" href="configuration.html#appendixes-configuration-testsuites"><span class="std std-ref">The &lt;testsuites&gt; Element</span></a></p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2020 Sebastian Bergmann<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>
    <a href="https://phpunit.readthedocs.io/en/9.5/incomplete-and-skipped-tests.html" class="_attribution-link">https://phpunit.readthedocs.io/en/9.5/incomplete-and-skipped-tests.html</a>
  </p>
</div>
