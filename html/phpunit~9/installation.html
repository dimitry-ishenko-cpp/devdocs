<h1>Installing PHPUnit</h1> <div class="section" id="requirements"> <h2>Requirements</h2> <p>PHPUnit 9.5 requires PHP 7.3; using the latest version of PHP is highly recommended.</p> <p>PHPUnit requires the <a class="reference external" href="http://php.net/manual/en/dom.setup.php">dom</a> and <a class="reference external" href="http://php.net/manual/en/json.installation.php">json</a> extensions, which are normally enabled by default.</p> <p>PHPUnit also requires the <a class="reference external" href="http://php.net/manual/en/pcre.installation.php">pcre</a>, <a class="reference external" href="http://php.net/manual/en/reflection.installation.php">reflection</a>, and <a class="reference external" href="http://php.net/manual/en/spl.installation.php">spl</a> extensions. These standard extensions are enabled by default and cannot be disabled without patching PHP’s build system and/or C sources.</p> <p>The code coverage report feature requires the <a class="reference external" href="http://xdebug.org/">Xdebug</a> (2.7.0 or later) and <a class="reference external" href="http://php.net/manual/en/tokenizer.installation.php">tokenizer</a> extensions. Generating XML reports requires the <a class="reference external" href="http://php.net/manual/en/xmlwriter.installation.php">xmlwriter</a> extension.</p> </div> <div class="section" id="php-archive-phar"> <h2>PHP Archive (PHAR)</h2> <p>The easiest way to obtain PHPUnit is to download a <a class="reference external" href="http://php.net/phar">PHP Archive (PHAR)</a> that has all required (as well as some optional) dependencies of PHPUnit bundled in a single file.</p> <p>The <a class="reference external" href="http://php.net/manual/en/phar.installation.php">phar</a> extension is required for using PHP Archives (PHAR).</p> <p>If the <a class="reference external" href="http://suhosin.org/">Suhosin</a> extension is enabled, you need to allow execution of PHARs in your <code class="docutils literal"><span class="pre">php.ini</span></code>:</p> <div class="highlight-bash">
<div class="highlight"><pre class="highlight" data-language="php">suhosin.executor.include.whitelist <span class="o">=</span> phar
</pre></div> </div> <p>The PHPUnit PHAR can be used immediately after download:</p> <pre class="highlight" data-language="php">
$ wget <a class="reference external" href="https://phar.phpunit.de/phpunit">https://phar.phpunit.de/phpunit</a>-9.5.phar
$ php phpunit-9.5.phar --version
PHPUnit x.y.z by Sebastian Bergmann and contributors.
</pre> <p>It is a common practice to make the PHAR executable:</p> <pre class="highlight" data-language="php">
$ wget <a class="reference external" href="https://phar.phpunit.de/phpunit">https://phar.phpunit.de/phpunit</a>-9.5.phar
$ chmod +x phpunit-9.5.phar
$ ./phpunit-9.5.phar --version
PHPUnit x.y.z by Sebastian Bergmann and contributors.
</pre> <div class="section" id="verifying-phpunit-phar-releases"> <h3>Verifying PHPUnit PHAR Releases</h3> <p>All official releases of code distributed by the PHPUnit Project are signed by the release manager for the release. PGP signatures and SHA256 hashes are available for verification on <a class="reference external" href="https://phar.phpunit.de/">phar.phpunit.de</a>.</p> <p>The following example details how release verification works. We start by downloading <code class="file docutils literal"><span class="pre">phpunit.phar</span></code> as well as its detached PGP signature <code class="file docutils literal"><span class="pre">phpunit.phar.asc</span></code>:</p> <pre class="highlight" data-language="php">
$ wget <a class="reference external" href="https://phar.phpunit.de/phpunit">https://phar.phpunit.de/phpunit</a>-9.5.phar
$ wget <a class="reference external" href="https://phar.phpunit.de/phpunit">https://phar.phpunit.de/phpunit</a>-9.5.phar.asc
</pre> <p>We want to verify PHPUnit’s PHP Archive (<code class="file docutils literal"><span class="pre">phpunit-x.y.phar</span></code>) against its detached signature (<code class="file docutils literal"><span class="pre">phpunit-x.y.phar.asc</span></code>):</p> <pre class="highlight" data-language="php">
$ gpg phpunit-9.5.phar.asc
gpg: Signature made Sat 19 Jul 2014 01:28:02 PM CEST using RSA key ID 6372C20A
gpg: Can't check signature: public key not found
</pre> <p>We don’t have the release manager’s public key (<code class="docutils literal"><span class="pre">6372C20A</span></code>) in our local system. In order to proceed with the verification we need to retrieve the release manager’s public key from a key server. One such server is <code class="file docutils literal"><span class="pre">pgp.uni-mainz.de</span></code>. The public key servers are linked together, so you should be able to connect to any key server.</p> <div class="highlight-php">
<div class="highlight"><pre class="highlight" data-language="php"><span class="err">$</span> <span class="nx">curl</span> <span class="o">--</span><span class="nx">silent</span> <span class="nx">https</span><span class="o">://</span><span class="nx">sebastian</span><span class="o">-</span><span class="nx">bergmann</span><span class="o">.</span><span class="nx">de</span><span class="o">/</span><span class="nx">gpg</span><span class="o">.</span><span class="nx">asc</span> <span class="o">|</span> <span class="nx">gpg</span> <span class="o">--</span><span class="nx">import</span>
<span class="nx">gpg</span><span class="o">:</span> <span class="nb">key</span> <span class="mi">4</span><span class="nx">AA394086372C20A</span><span class="o">:</span> <span class="mi">452</span> <span class="nx">signatures</span> <span class="k">not</span> <span class="nx">checked</span> <span class="nx">due</span> <span class="nx">to</span> <span class="nx">missing</span> <span class="nx">keys</span>
<span class="nx">gpg</span><span class="o">:</span> <span class="o">/</span><span class="nx">root</span><span class="o">/.</span><span class="nx">gnupg</span><span class="o">/</span><span class="nx">trustdb</span><span class="o">.</span><span class="nx">gpg</span><span class="o">:</span> <span class="nx">trustdb</span> <span class="nx">created</span>
<span class="nx">gpg</span><span class="o">:</span> <span class="nb">key</span> <span class="mi">4</span><span class="nx">AA394086372C20A</span><span class="o">:</span> <span class="k">public</span> <span class="nb">key</span> <span class="s2">"Sebastian Bergmann &lt;sb@sebastian-bergmann.de&gt;"</span> <span class="nx">imported</span>
<span class="nx">gpg</span><span class="o">:</span> <span class="nx">Total</span> <span class="nx">number</span> <span class="nx">processed</span><span class="o">:</span> <span class="mi">1</span>
<span class="nx">gpg</span><span class="o">:</span>               <span class="nx">imported</span><span class="o">:</span> <span class="mi">1</span>
<span class="nx">gpg</span><span class="o">:</span> <span class="nx">no</span> <span class="nx">ultimately</span> <span class="nx">trusted</span> <span class="nx">keys</span> <span class="nx">found</span>
</pre></div> </div> <p>Now we have received a public key for an entity known as “Sebastian Bergmann &lt;<a class="reference external" href="mailto:sb%40sebastian-bergmann.de.html">sb<span>@</span>sebastian-bergmann<span>.</span>de</a>&gt;”. However, we have no way of verifying this key was created by the person known as Sebastian Bergmann. But, let’s try to verify the release signature again.</p> <pre class="highlight" data-language="php">
$ gpg phpunit-9.5.phar.asc
gpg: Signature made Sat 19 Jul 2014 01:28:02 PM CEST using RSA key ID 6372C20A
gpg: Good signature from "Sebastian Bergmann &lt;<a class="reference external" href="mailto:sb%40sebastian-bergmann.de.html">sb<span>@</span>sebastian-bergmann<span>.</span>de</a>&gt;"
gpg:                 aka "Sebastian Bergmann &lt;<a class="reference external" href="mailto:sebastian%40php.net.html">sebastian<span>@</span>php<span>.</span>net</a>&gt;"
gpg:                 aka "Sebastian Bergmann &lt;<a class="reference external" href="mailto:sebastian%40thephp.cc.html">sebastian<span>@</span>thephp<span>.</span>cc</a>&gt;"
gpg:                 aka "Sebastian Bergmann &lt;<a class="reference external" href="mailto:sebastian%40phpunit.de.html">sebastian<span>@</span>phpunit<span>.</span>de</a>&gt;"
gpg:                 aka "Sebastian Bergmann &lt;<a class="reference external" href="mailto:sebastian.bergmann%40thephp.cc.html">sebastian<span>.</span>bergmann<span>@</span>thephp<span>.</span>cc</a>&gt;"
gpg:                 aka "[jpeg image of size 40635]"
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: D840 6D0D 8294 7747 2937  7831 4AA3 9408 6372 C20A
</pre> <p>At this point, the signature is good, but we don’t trust this key. A good signature means that the file has not been tampered. However, due to the nature of public key cryptography, you need to additionally verify that key <code class="docutils literal"><span class="pre">6372C20A</span></code> was created by the real Sebastian Bergmann.</p> <p>Any attacker can create a public key and upload it to the public key servers. They can then create a malicious release signed by this fake key. Then, if you tried to verify the signature of this corrupt release, it would succeed because the key was not the “real” key. Therefore, you need to validate the authenticity of this key. Validating the authenticity of a public key, however, is outside the scope of this documentation.</p> <p>Manually verifying the authenticity and integrity of a PHPUnit PHAR using GPG is tedious. This is why PHIVE, the PHAR Installation and Verification Environment, was created. You can learn about PHIVE on its <a class="reference external" href="https://phar.io/">website</a></p> </div> </div> <div class="section" id="composer"> <h2>Composer</h2> <p>Add a (development-time) dependency on <code class="docutils literal"><span class="pre">phpunit/phpunit</span></code> to your project’s <code class="docutils literal"><span class="pre">composer.json</span></code> file if you use <a class="reference external" href="https://getcomposer.org/">Composer</a> to manage the dependencies of your project:</p> <pre class="highlight" data-language="php">
composer require --dev phpunit/phpunit ^9.5
</pre> </div> <div class="section" id="global-installation"> <h2>Global Installation</h2> <p>Please note that it is not recommended to install PHPUnit globally, as <code class="docutils literal"><span class="pre">/usr/bin/phpunit</span></code> or <code class="docutils literal"><span class="pre">/usr/local/bin/phpunit</span></code>, for instance.</p> <p>Instead, PHPUnit should be managed as a project-local dependency.</p> <p>Either put the PHAR of the specific PHPUnit version you need in your project’s <code class="docutils literal"><span class="pre">tools</span></code> directory (which should be managed by PHIVE) or depend on the specific PHPUnit version you need in your project’s <code class="docutils literal"><span class="pre">composer.json</span></code> if you use Composer.</p> </div> <div class="section" id="webserver"> <h2>Webserver</h2> <p>PHPUnit is a framework for writing as well as a commandline tool for running tests. Writing and running tests is a development-time activity. There is no reason why PHPUnit should be installed on a webserver.</p> <p><strong>If you upload PHPUnit to a webserver then your deployment process is broken. On a more general note, if your</strong> <code class="docutils literal"><span class="pre">vendor</span></code> <strong>directory is publicly accessible on your webserver then your deployment process is also broken.</strong></p> <p>Please note that if you upload PHPUnit to a webserver “bad things” may happen. <a class="reference external" href="https://thephp.cc/news/2020/02/phpunit-a-security-risk">You have been warned.</a></p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2020 Sebastian Bergmann<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>
    <a href="https://phpunit.readthedocs.io/en/9.5/installation.html" class="_attribution-link">https://phpunit.readthedocs.io/en/9.5/installation.html</a>
  </p>
</div>
