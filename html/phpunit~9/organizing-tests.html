<h1>Organizing Tests</h1> <p>One of the goals of PHPUnit is that tests should be composable: we want to be able to run any number or combination of tests together, for instance all tests for the whole project, or the tests for all classes of a component that is part of the project, or just the tests for a single class.</p> <p>PHPUnit supports different ways of organizing tests and composing them into a test suite. This chapter shows the most commonly used approaches.</p> <div class="section" id="composing-a-test-suite-using-the-filesystem"> <h2>Composing a Test Suite Using the Filesystem</h2> <p>Probably the easiest way to compose a test suite is to keep all test case source files in a test directory. PHPUnit can automatically discover and run the tests by recursively traversing the test directory.</p> <p>Lets take a look at the test suite of the <a class="reference external" href="http://github.com/sebastianbergmann/money/">sebastianbergmann/money</a> library. Looking at this project’s directory structure, we see that the test case classes in the <code class="file docutils literal"><span class="pre">tests</span></code> directory mirror the package and class structure of the System Under Test (SUT) in the <code class="file docutils literal"><span class="pre">src</span></code> directory:</p> <div class="highlight-none">
<div class="highlight"><pre class="highlight" data-language="php">src                                 tests
`-- Currency.php                    `-- CurrencyTest.php
`-- IntlFormatter.php               `-- IntlFormatterTest.php
`-- Money.php                       `-- MoneyTest.php
`-- autoload.php
</pre></div> </div> <p>To run all tests for the library we need to point the PHPUnit command-line test runner to the test directory:</p> <pre class="highlight" data-language="php">
$ phpunit --bootstrap src/autoload.php tests
PHPUnit 9.5.0 by Sebastian Bergmann and contributors.

.................................

Time: 636 ms, Memory: 3.50Mb

OK (33 tests, 52 assertions)
</pre> <div class="admonition-note admonition"> <p class="first admonition-title">Note</p> <p class="last">If you point the PHPUnit command-line test runner to a directory it will look for <code class="file docutils literal"><span class="pre">*Test.php</span></code> files.</p> </div> <p>To run only the tests that are declared in the <code class="docutils literal"><span class="pre">CurrencyTest</span></code> test case class in <code class="file docutils literal"><span class="pre">tests/CurrencyTest.php</span></code> we can use the following command:</p> <pre class="highlight" data-language="php">
$ phpunit --bootstrap src/autoload.php tests/CurrencyTest.php
PHPUnit 9.5.0 by Sebastian Bergmann and contributors.

........

Time: 280 ms, Memory: 2.75Mb

OK (8 tests, 8 assertions)
</pre> <p>For more fine-grained control of which tests to run we can use the <code class="docutils literal"><span class="pre">--filter</span></code> option:</p> <pre class="highlight" data-language="php">
$ phpunit --bootstrap src/autoload.php --filter testObjectCanBeConstructedForValidConstructorArgument tests
PHPUnit 9.5.0 by Sebastian Bergmann and contributors.

..

Time: 167 ms, Memory: 3.00Mb

OK (2 test, 2 assertions)
</pre> <div class="admonition-note admonition"> <p class="first admonition-title">Note</p> <p class="last">A drawback of this approach is that we have no control over the order in which the tests are run. This can lead to problems with regard to test dependencies, see <a class="reference internal" href="writing-tests-for-phpunit.html#writing-tests-for-phpunit-test-dependencies"><span class="std std-ref">Test Dependencies</span></a>. In the next section you will see how you can make the test execution order explicit by using the XML configuration file.</p> </div> </div> <div class="section" id="composing-a-test-suite-using-xml-configuration"> <h2>Composing a Test Suite Using XML Configuration</h2> <p>PHPUnit’s XML configuration file (<a class="reference internal" href="configuration.html#appendixes-configuration"><span class="std std-ref">The XML Configuration File</span></a>) can also be used to compose a test suite. <a class="reference internal" href="#organizing-tests-xml-configuration-examples-phpunit-xml"><span class="std std-numref">Example 5.1</span></a> shows a minimal <code class="file docutils literal"><span class="pre">phpunit.xml</span></code> file that will add all <code class="docutils literal"><span class="pre">*Test</span></code> classes that are found in <code class="file docutils literal"><span class="pre">*Test.php</span></code> files when the <code class="file docutils literal"><span class="pre">tests</span></code> directory is recursively traversed.</p> <div class="literal-block-wrapper docutils container" id="organizing-tests-xml-configuration-examples-phpunit-xml"> <div class="code-block-caption">
<span class="caption-number">Example 5.1 </span><span class="caption-text">Composing a Test Suite Using XML Configuration</span>
</div> <div class="highlight-xml">
<div class="highlight"><pre class="highlight" data-language="php"><span class="nt">&lt;phpunit</span> <span class="na">bootstrap=</span><span class="s">"src/autoload.php"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;testsuites&gt;</span>
    <span class="nt">&lt;testsuite</span> <span class="na">name=</span><span class="s">"money"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;directory&gt;</span>tests<span class="nt">&lt;/directory&gt;</span>
    <span class="nt">&lt;/testsuite&gt;</span>
  <span class="nt">&lt;/testsuites&gt;</span>
<span class="nt">&lt;/phpunit&gt;</span>
</pre></div> </div> </div> <p>To run the test suite, use the the <code class="docutils literal"><span class="pre">--testsuite</span></code> option:</p> <pre class="highlight" data-language="php">
$ phpunit --bootstrap src/autoload.php --testsuite money
PHPUnit 9.5.0 by Sebastian Bergmann and contributors.

..

Time: 167 ms, Memory: 3.00Mb

OK (2 test, 2 assertions)
</pre> <p>If <code class="file docutils literal"><span class="pre">phpunit.xml</span></code> or <code class="file docutils literal"><span class="pre">phpunit.xml.dist</span></code> (in that order) exist in the current working directory and <code class="docutils literal"><span class="pre">--configuration</span></code> is <em>not</em> used, the configuration will be automatically read from that file.</p> <p>The order in which tests are executed can be made explicit:</p> <div class="literal-block-wrapper docutils container" id="organizing-tests-xml-configuration-examples-phpunit-xml2"> <div class="code-block-caption">
<span class="caption-number">Example 5.2 </span><span class="caption-text">Composing a Test Suite Using XML Configuration</span>
</div> <div class="highlight-xml">
<div class="highlight"><pre class="highlight" data-language="php"><span class="nt">&lt;phpunit</span> <span class="na">bootstrap=</span><span class="s">"src/autoload.php"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;testsuites&gt;</span>
    <span class="nt">&lt;testsuite</span> <span class="na">name=</span><span class="s">"money"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;file&gt;</span>tests/IntlFormatterTest.php<span class="nt">&lt;/file&gt;</span>
      <span class="nt">&lt;file&gt;</span>tests/MoneyTest.php<span class="nt">&lt;/file&gt;</span>
      <span class="nt">&lt;file&gt;</span>tests/CurrencyTest.php<span class="nt">&lt;/file&gt;</span>
    <span class="nt">&lt;/testsuite&gt;</span>
  <span class="nt">&lt;/testsuites&gt;</span>
<span class="nt">&lt;/phpunit&gt;</span>
</pre></div> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2020 Sebastian Bergmann<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>
    <a href="https://phpunit.readthedocs.io/en/9.5/organizing-tests.html" class="_attribution-link">https://phpunit.readthedocs.io/en/9.5/organizing-tests.html</a>
  </p>
</div>
