<h1 id="doc-your-first-2d-game-creating-the-enemy">Creating the enemy</h1> <p>Now it's time to make the enemies our player will have to dodge. Their behavior will not be very complex: mobs will spawn randomly at the edges of the screen, choose a random direction, and move in a straight line.</p> <p>We'll create a <code>Mob</code> scene, which we can then <em>instance</em> to create any number of independent mobs in the game.</p> <section id="node-setup"> <h2>Node setup</h2> <p>Click Scene -&gt; New Scene and add the following nodes:</p> <ul> <li>
<p><a href="../../classes/class_rigidbody2d.html#class-rigidbody2d"><span class="std std-ref">RigidBody2D</span></a> (named <code>Mob</code>)</p>  <ul class="simple"> <li><a href="../../classes/class_animatedsprite.html#class-animatedsprite"><span class="std std-ref">AnimatedSprite</span></a></li> <li><a href="../../classes/class_collisionshape2d.html#class-collisionshape2d"><span class="std std-ref">CollisionShape2D</span></a></li> <li><a href="../../classes/class_visibilitynotifier2d.html#class-visibilitynotifier2d"><span class="std std-ref">VisibilityNotifier2D</span></a></li> </ul>  </li> </ul> <p>Don't forget to set the children so they can't be selected, like you did with the Player scene.</p> <p>In the <a href="../../classes/class_rigidbody2d.html#class-rigidbody2d"><span class="std std-ref">RigidBody2D</span></a> properties, set <code>Gravity Scale</code> to <code>0</code>, so the mob will not fall downward. In addition, under the <a href="../../classes/class_collisionobject2d.html#class-collisionobject2d"><span class="std std-ref">CollisionObject2D</span></a> section, click the <code>Mask</code> property and uncheck the first box. This will ensure the mobs do not collide with each other.</p> <img alt="../../_images/set_collision_mask.png" src="https://docs.godotengine.org/en/3.5/_images/set_collision_mask.png"> <p>Set up the <a href="../../classes/class_animatedsprite.html#class-animatedsprite"><span class="std std-ref">AnimatedSprite</span></a> like you did for the player. This time, we have 3 animations: <code>fly</code>, <code>swim</code>, and <code>walk</code>. There are two images for each animation in the art folder.</p> <p>Adjust the "Speed (FPS)" to <code>3</code> for all animations.</p> <img alt="../../_images/mob_animations.gif" src="https://docs.godotengine.org/en/3.5/_images/mob_animations.gif"> <p>Set the <code>Playing</code> property in the Inspector to "On".</p> <p>We'll select one of these animations randomly so that the mobs will have some variety.</p> <p>Like the player images, these mob images need to be scaled down. Set the <code>AnimatedSprite</code>'s <code>Scale</code> property to <code>(0.75, 0.75)</code>.</p> <p>As in the <code>Player</code> scene, add a <code>CapsuleShape2D</code> for the collision. To align the shape with the image, you'll need to set the <code>Rotation Degrees</code> property to <code>90</code> (under "Transform" in the Inspector).</p> <p>Save the scene.</p> </section> <section id="enemy-script"> <h2>Enemy script</h2> <p>Add a script to the <code>Mob</code> like this:</p> <div class="sphinx-tabs docutils container"> <div aria-label="Tabbed content" class="closeable" role="tablist">
<button aria-controls="panel-0-R0RTY3JpcHQ=" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button><button aria-controls="panel-0-QyM=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button><button aria-controls="panel-0-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button>
</div>
<div aria-labelledby="tab-0-R0RTY3JpcHQ=" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
<pre data-language="gdscript">extends RigidBody2D
</pre> </div>
<div aria-labelledby="tab-0-QyM=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-QyM=" name="QyM=" role="tabpanel" tabindex="0">
<pre data-language="csharp">public class Mob : RigidBody2D
{
    // Don't forget to rebuild the project.
}
</pre> </div>
<div aria-labelledby="tab-0-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-Qysr" name="Qysr" role="tabpanel" tabindex="0">
<pre data-language="cpp">// Copy `player.gdns` to `mob.gdns` and replace `Player` with `Mob`.
// Attach the `mob.gdns` file to the Mob node.

// Create two files `mob.cpp` and `mob.hpp` next to `entry.cpp` in `src`.
// This code goes in `mob.hpp`. We also define the methods we'll be using here.
#ifndef MOB_H
#define MOB_H

#include &lt;AnimatedSprite.hpp&gt;
#include &lt;Godot.hpp&gt;
#include &lt;RigidBody2D.hpp&gt;

class Mob : public godot::RigidBody2D {
    GODOT_CLASS(Mob, godot::RigidBody2D)

    godot::AnimatedSprite *_animated_sprite;

public:
    void _init() {}
    void _ready();
    void _on_VisibilityNotifier2D_screen_exited();

    static void _register_methods();
};

#endif // MOB_H
</pre> </div>
</div> <p>Now let's look at the rest of the script. In <code>_ready()</code> we play the animation and randomly choose one of the three animation types:</p> <div class="sphinx-tabs docutils container"> <div aria-label="Tabbed content" class="closeable" role="tablist">
<button aria-controls="panel-1-R0RTY3JpcHQ=" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button><button aria-controls="panel-1-QyM=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button><button aria-controls="panel-1-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button>
</div>
<div aria-labelledby="tab-1-R0RTY3JpcHQ=" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
<pre data-language="gdscript">func _ready():
    $AnimatedSprite.playing = true
    var mob_types = $AnimatedSprite.frames.get_animation_names()
    $AnimatedSprite.animation = mob_types[randi() % mob_types.size()]
</pre> </div>
<div aria-labelledby="tab-1-QyM=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-QyM=" name="QyM=" role="tabpanel" tabindex="0">
<pre data-language="csharp">public override void _Ready()
{
    var animSprite = GetNode&lt;AnimatedSprite&gt;("AnimatedSprite");
    animSprite.Playing = true;
    string[] mobTypes = animSprite.Frames.GetAnimationNames();
    animSprite.Animation = mobTypes[GD.Randi() % mobTypes.Length];
}
</pre> </div>
<div aria-labelledby="tab-1-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-Qysr" name="Qysr" role="tabpanel" tabindex="0">
<pre data-language="cpp">// This code goes in `mob.cpp`.
#include "mob.hpp"

#include &lt;RandomNumberGenerator.hpp&gt;
#include &lt;SpriteFrames.hpp&gt;

void Mob::_ready() {
    godot::Ref&lt;godot::RandomNumberGenerator&gt; random = godot::RandomNumberGenerator::_new();
    random-&gt;randomize();
    _animated_sprite = get_node&lt;godot::AnimatedSprite&gt;("AnimatedSprite");
    _animated_sprite-&gt;_set_playing(true);
    godot::PoolStringArray mob_types = _animated_sprite-&gt;get_sprite_frames()-&gt;get_animation_names();
    _animated_sprite-&gt;set_animation(mob_types[random-&gt;randi() % mob_types.size()]);
}
</pre> </div>
</div> <p>First, we get the list of animation names from the AnimatedSprite's <code>frames</code> property. This returns an Array containing all three animation names: <code>["walk",
"swim", "fly"]</code>.</p> <p>We then need to pick a random number between <code>0</code> and <code>2</code> to select one of these names from the list (array indices start at <code>0</code>). <code>randi() % n</code> selects a random integer between <code>0</code> and <code>n-1</code>.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>You must use <code>randomize()</code> if you want your sequence of "random" numbers to be different every time you run the scene. We're going to use <code>randomize()</code> in our <code>Main</code> scene, so we won't need it here.</p> </div> <p>The last piece is to make the mobs delete themselves when they leave the screen. Connect the <code>screen_exited()</code> signal of the <code>VisibilityNotifier2D</code> node and add this code:</p> <div class="sphinx-tabs docutils container"> <div aria-label="Tabbed content" class="closeable" role="tablist">
<button aria-controls="panel-2-R0RTY3JpcHQ=" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tab" tabindex="0">GDScript</button><button aria-controls="panel-2-QyM=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-QyM=" name="QyM=" role="tab" tabindex="-1">C#</button><button aria-controls="panel-2-Qysr" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-Qysr" name="Qysr" role="tab" tabindex="-1">C++</button>
</div>
<div aria-labelledby="tab-2-R0RTY3JpcHQ=" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-R0RTY3JpcHQ=" name="R0RTY3JpcHQ=" role="tabpanel" tabindex="0">
<pre data-language="gdscript">func _on_VisibilityNotifier2D_screen_exited():
    queue_free()
</pre> </div>
<div aria-labelledby="tab-2-QyM=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-QyM=" name="QyM=" role="tabpanel" tabindex="0">
<pre data-language="csharp">public void OnVisibilityNotifier2DScreenExited()
{
    QueueFree();
}
</pre> </div>
<div aria-labelledby="tab-2-Qysr" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-Qysr" name="Qysr" role="tabpanel" tabindex="0">
<pre data-language="cpp">// This code goes in `mob.cpp`.
void Mob::_on_VisibilityNotifier2D_screen_exited() {
    queue_free();
}
</pre> </div>
</div> <p>This completes the <code>Mob</code> scene.</p> <p>With the player and enemies ready, in the next part, we'll bring them together in a new scene. We'll make enemies spawn randomly around the game board and move forward, turning our project into a playable game.</p> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2014&ndash;2022 Juan Linietsky, Ariel Manzur and the Godot community<br>Licensed under the Creative Commons Attribution Unported License v3.0.<br>
    <a href="https://docs.godotengine.org/en/3.5/getting_started/first_2d_game/04.creating_the_enemy.html" class="_attribution-link">https://docs.godotengine.org/en/3.5/getting_started/first_2d_game/04.creating_the_enemy.html</a>
  </p>
</div>
