<h1>CREATE TABLE AS</h1> <p>CREATE TABLE AS — define a new table from the results of a query</p>   <h2>Synopsis</h2> <pre data-language="sql">
CREATE [ [ GLOBAL | LOCAL ] { TEMPORARY | TEMP } | UNLOGGED ] TABLE [ IF NOT EXISTS ] table_name
    [ (column_name [, ...] ) ]
    [ USING method ]
    [ WITH ( storage_parameter [= value] [, ... ] ) | WITHOUT OIDS ]
    [ ON COMMIT { PRESERVE ROWS | DELETE ROWS | DROP } ]
    [ TABLESPACE tablespace_name ]
    AS query
    [ WITH [ NO ] DATA ]
</pre>  <div class="refsect1" id="id-1.9.3.86.5"> <h2>Description</h2> <p><code class="command">CREATE TABLE AS</code> creates a table and fills it with data computed by a <code class="command">SELECT</code> command. The table columns have the names and data types associated with the output columns of the <code class="command">SELECT</code> (except that you can override the column names by giving an explicit list of new column names).</p> <p><code class="command">CREATE TABLE AS</code> bears some resemblance to creating a view, but it is really quite different: it creates a new table and evaluates the query just once to fill the new table initially. The new table will not track subsequent changes to the source tables of the query. In contrast, a view re-evaluates its defining <code class="command">SELECT</code> statement whenever it is queried.</p> <p><code class="command">CREATE TABLE AS</code> requires <code class="literal">CREATE</code> privilege on the schema used for the table.</p> </div> <div class="refsect1" id="id-1.9.3.86.6"> <h2>Parameters</h2> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">GLOBAL</code> or <code class="literal">LOCAL</code>
</dt> <dd> <p>Ignored for compatibility. Use of these keywords is deprecated; refer to <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> </dl> </div> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">TEMPORARY</code> or <code class="literal">TEMP</code>
</dt> <dd> <p>If specified, the table is created as a temporary table. Refer to <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> <dt><code class="literal">UNLOGGED</code></dt> <dd> <p>If specified, the table is created as an unlogged table. Refer to <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </dd> <dt><code class="literal">IF NOT EXISTS</code></dt> <dd> <p>Do not throw an error if a relation with the same name already exists; simply issue a notice and leave the table unmodified.</p> </dd> <dt><code>table_name</code></dt> <dd> <p>The name (optionally schema-qualified) of the table to be created.</p> </dd> <dt><code>column_name</code></dt> <dd> <p>The name of a column in the new table. If column names are not provided, they are taken from the output column names of the query.</p> </dd> <dt><code class="literal">USING method</code></dt> <dd> <p>This optional clause specifies the table access method to use to store the contents for the new table; the method needs be an access method of type <code class="literal">TABLE</code>. See <a class="xref" href="tableam.html" title="Chapter 63. Table Access Method Interface Definition">Chapter 63</a> for more information. If this option is not specified, the default table access method is chosen for the new table. See <a class="xref" href="runtime-config-client.html#GUC-DEFAULT-TABLE-ACCESS-METHOD">default_table_access_method</a> for more information.</p> </dd> <dt><code class="literal">WITH ( storage_parameter [= value] [, ... ] )</code></dt> <dd> <p>This clause specifies optional storage parameters for the new table; see <a class="xref" href="sql-createtable.html#SQL-CREATETABLE-STORAGE-PARAMETERS" title="Storage Parameters">Storage Parameters</a> in the <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a> documentation for more information. For backward-compatibility the <code class="literal">WITH</code> clause for a table can also include <code class="literal">OIDS=FALSE</code> to specify that rows of the new table should contain no OIDs (object identifiers), <code class="literal">OIDS=TRUE</code> is not supported anymore.</p> </dd> <dt><code class="literal">WITHOUT OIDS</code></dt> <dd> <p>This is backward-compatible syntax for declaring a table <code class="literal">WITHOUT OIDS</code>, creating a table <code class="literal">WITH OIDS</code> is not supported anymore.</p> </dd> <dt><code class="literal">ON COMMIT</code></dt> <dd> <p>The behavior of temporary tables at the end of a transaction block can be controlled using <code class="literal">ON COMMIT</code>. The three options are:</p> <div class="variablelist"> <dl class="variablelist"> <dt><code class="literal">PRESERVE ROWS</code></dt> <dd> <p>No special action is taken at the ends of transactions. This is the default behavior.</p> </dd> <dt><code class="literal">DELETE ROWS</code></dt> <dd> <p>All rows in the temporary table will be deleted at the end of each transaction block. Essentially, an automatic <a class="link" href="sql-truncate.html" title="TRUNCATE"><code class="command">TRUNCATE</code></a> is done at each commit.</p> </dd> <dt><code class="literal">DROP</code></dt> <dd> <p>The temporary table will be dropped at the end of the current transaction block.</p> </dd> </dl> </div> </dd> <dt><code class="literal">TABLESPACE tablespace_name</code></dt> <dd> <p>The <code>tablespace_name</code> is the name of the tablespace in which the new table is to be created. If not specified, <a class="xref" href="runtime-config-client.html#GUC-DEFAULT-TABLESPACE">default_tablespace</a> is consulted, or <a class="xref" href="runtime-config-client.html#GUC-TEMP-TABLESPACES">temp_tablespaces</a> if the table is temporary.</p> </dd> <dt><code>query</code></dt> <dd> <p>A <a class="link" href="sql-select.html" title="SELECT"><code class="command">SELECT</code></a>, <a class="link" href="sql-select.html#SQL-TABLE" title="TABLE Command"><code class="command">TABLE</code></a>, or <a class="link" href="sql-values.html" title="VALUES"><code class="command">VALUES</code></a> command, or an <a class="link" href="sql-execute.html" title="EXECUTE"><code class="command">EXECUTE</code></a> command that runs a prepared <code class="command">SELECT</code>, <code class="command">TABLE</code>, or <code class="command">VALUES</code> query.</p> </dd> <dt><code class="literal">WITH [ NO ] DATA</code></dt> <dd> <p>This clause specifies whether or not the data produced by the query should be copied into the new table. If not, only the table structure is copied. The default is to copy the data.</p> </dd> </dl> </div> </div> <div class="refsect1" id="id-1.9.3.86.7"> <h2>Notes</h2> <p>This command is functionally similar to <a class="xref" href="sql-selectinto.html" title="SELECT INTO">SELECT INTO</a>, but it is preferred since it is less likely to be confused with other uses of the <code class="command">SELECT INTO</code> syntax. Furthermore, <code class="command">CREATE TABLE AS</code> offers a superset of the functionality offered by <code class="command">SELECT INTO</code>.</p> </div> <div class="refsect1" id="id-1.9.3.86.8"> <h2>Examples</h2> <p>Create a new table <code class="literal">films_recent</code> consisting of only recent entries from the table <code class="literal">films</code>:</p> <pre data-language="sql">
CREATE TABLE films_recent AS
  SELECT * FROM films WHERE date_prod &gt;= '2002-01-01';
</pre> <p>To copy a table completely, the short form using the <code class="literal">TABLE</code> command can also be used:</p> <pre data-language="sql">
CREATE TABLE films2 AS
  TABLE films;
</pre> <p>Create a new temporary table <code class="literal">films_recent</code>, consisting of only recent entries from the table <code class="literal">films</code>, using a prepared statement. The new table will be dropped at commit:</p> <pre data-language="sql">
PREPARE recentfilms(date) AS
  SELECT * FROM films WHERE date_prod &gt; $1;
CREATE TEMP TABLE films_recent ON COMMIT DROP AS
  EXECUTE recentfilms('2002-01-01');
</pre> </div> <div class="refsect1" id="id-1.9.3.86.9"> <h2>Compatibility</h2> <p><code class="command">CREATE TABLE AS</code> conforms to the SQL standard. The following are nonstandard extensions:</p>  <ul> <li> <p>The standard requires parentheses around the subquery clause; in PostgreSQL, these parentheses are optional.</p> </li> <li> <p>In the standard, the <code class="literal">WITH [ NO ] DATA</code> clause is required; in PostgreSQL it is optional.</p> </li> <li> <p>PostgreSQL handles temporary tables in a way rather different from the standard; see <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a> for details.</p> </li> <li> <p>The <code class="literal">WITH</code> clause is a PostgreSQL extension; storage parameters are not in the standard.</p> </li> <li> <p>The PostgreSQL concept of tablespaces is not part of the standard. Hence, the clause <code class="literal">TABLESPACE</code> is an extension.</p> </li> </ul>  </div> <div class="refsect1" id="id-1.9.3.86.10"> <h2>See Also</h2>
<span class="simplelist"><a class="xref" href="sql-creatematerializedview.html" title="CREATE MATERIALIZED VIEW">CREATE MATERIALIZED VIEW</a>, <a class="xref" href="sql-createtable.html" title="CREATE TABLE">CREATE TABLE</a>, <a class="xref" href="sql-execute.html" title="EXECUTE">EXECUTE</a>, <a class="xref" href="sql-select.html" title="SELECT">SELECT</a>, <a class="xref" href="sql-selectinto.html" title="SELECT INTO">SELECT INTO</a>, <a class="xref" href="sql-values.html" title="VALUES">VALUES</a></span> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996&ndash;2023 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/16/sql-createtableas.html" class="_attribution-link">https://www.postgresql.org/docs/16/sql-createtableas.html</a>
  </p>
</div>
