<h1>ALTER SUBSCRIPTION</h1> <p>ALTER SUBSCRIPTION — change the definition of a subscription</p>   <h2>Synopsis</h2> <pre data-language="sql">
ALTER SUBSCRIPTION name CONNECTION 'conninfo'
ALTER SUBSCRIPTION name SET PUBLICATION publication_name [, ...] [ WITH ( publication_option [= value] [, ... ] ) ]
ALTER SUBSCRIPTION name ADD PUBLICATION publication_name [, ...] [ WITH ( publication_option [= value] [, ... ] ) ]
ALTER SUBSCRIPTION name DROP PUBLICATION publication_name [, ...] [ WITH ( publication_option [= value] [, ... ] ) ]
ALTER SUBSCRIPTION name REFRESH PUBLICATION [ WITH ( refresh_option [= value] [, ... ] ) ]
ALTER SUBSCRIPTION name ENABLE
ALTER SUBSCRIPTION name DISABLE
ALTER SUBSCRIPTION name SET ( subscription_parameter [= value] [, ... ] )
ALTER SUBSCRIPTION name SKIP ( skip_option = value )
ALTER SUBSCRIPTION name OWNER TO { new_owner | CURRENT_ROLE | CURRENT_USER | SESSION_USER }
ALTER SUBSCRIPTION name RENAME TO new_name
</pre>  <div class="refsect1" id="id-1.9.3.33.5"> <h2>Description</h2> <p><code class="command">ALTER SUBSCRIPTION</code> can change most of the subscription properties that can be specified in <a class="xref" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION">CREATE SUBSCRIPTION</a>.</p> <p>You must own the subscription to use <code class="command">ALTER SUBSCRIPTION</code>. To rename a subscription or alter the owner, you must have <code class="literal">CREATE</code> permission on the database. In addition, to alter the owner, you must be able to <code class="literal">SET ROLE</code> to the new owning role. If the subscription has <code class="literal">password_required=false</code>, only superusers can modify it.</p> <p>When refreshing a publication we remove the relations that are no longer part of the publication and we also remove the table synchronization slots if there are any. It is necessary to remove these slots so that the resources allocated for the subscription on the remote host are released. If due to network breakdown or some other error, PostgreSQL is unable to remove the slots, an error will be reported. To proceed in this situation, the user either needs to retry the operation or disassociate the slot from the subscription and drop the subscription as explained in <a class="xref" href="sql-dropsubscription.html" title="DROP SUBSCRIPTION">DROP SUBSCRIPTION</a>.</p> <p>Commands <code class="command">ALTER SUBSCRIPTION ... REFRESH PUBLICATION</code> and <code class="command">ALTER SUBSCRIPTION ... {SET|ADD|DROP} PUBLICATION ...</code> with <code class="literal">refresh</code> option as <code class="literal">true</code> cannot be executed inside a transaction block. These commands also cannot be executed when the subscription has <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-TWO-PHASE"><code class="literal">two_phase</code></a> commit enabled, unless <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-COPY-DATA"><code class="literal">copy_data</code></a> is <code class="literal">false</code>. See column <code class="structfield">subtwophasestate</code> of <a class="link" href="catalog-pg-subscription.html" title="53.54. pg_subscription"><code class="structname">pg_subscription</code></a> to know the actual two-phase state.</p> </div> <div class="refsect1" id="id-1.9.3.33.6"> <h2>Parameters</h2> <div class="variablelist"> <dl class="variablelist"> <dt><code>name</code></dt> <dd> <p>The name of a subscription whose properties are to be altered.</p> </dd> <dt><code class="literal">CONNECTION 'conninfo'</code></dt> <dd> <p>This clause replaces the connection string originally set by <a class="xref" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION">CREATE SUBSCRIPTION</a>. See there for more information.</p> </dd> <dt>
<code class="literal">SET PUBLICATION publication_name</code><code class="literal">ADD PUBLICATION publication_name</code><code class="literal">DROP PUBLICATION publication_name</code>
</dt> <dd> <p>These forms change the list of subscribed publications. <code class="literal">SET</code> replaces the entire list of publications with a new list, <code class="literal">ADD</code> adds additional publications to the list of publications, and <code class="literal">DROP</code> removes the publications from the list of publications. We allow non-existent publications to be specified in <code class="literal">ADD</code> and <code class="literal">SET</code> variants so that users can add those later. See <a class="xref" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION">CREATE SUBSCRIPTION</a> for more information. By default, this command will also act like <code class="literal">REFRESH PUBLICATION</code>.</p> <p><code>publication_option</code> specifies additional options for this operation. The supported options are:</p> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">refresh</code> (<code class="type">boolean</code>)</dt> <dd> <p>When false, the command will not try to refresh table information. <code class="literal">REFRESH PUBLICATION</code> should then be executed separately. The default is <code class="literal">true</code>.</p> </dd> </dl> </div> <p>Additionally, the options described under <code class="literal">REFRESH PUBLICATION</code> may be specified, to control the implicit refresh operation.</p> </dd> <dt><code class="literal">REFRESH PUBLICATION</code></dt> <dd> <p>Fetch missing table information from publisher. This will start replication of tables that were added to the subscribed-to publications since <code class="command">CREATE SUBSCRIPTION</code> or the last invocation of <code class="command">REFRESH PUBLICATION</code>.</p> <p><code>refresh_option</code> specifies additional options for the refresh operation. The supported options are:</p> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">copy_data</code> (<code class="type">boolean</code>)</dt> <dd> <p>Specifies whether to copy pre-existing data in the publications that are being subscribed to when the replication starts. The default is <code class="literal">true</code>.</p> <p>Previously subscribed tables are not copied, even if a table's row filter <code class="literal">WHERE</code> clause has since been modified.</p> <p>See <a class="xref" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-NOTES" title="Notes">Notes</a> for details of how <code class="literal">copy_data = true</code> can interact with the <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-ORIGIN"><code class="literal">origin</code></a> parameter.</p> <p>See the <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-BINARY"><code class="literal">binary</code></a> parameter of <code class="command">CREATE SUBSCRIPTION</code> for details about copying pre-existing data in binary format.</p> </dd> </dl> </div> </dd> <dt><code class="literal">ENABLE</code></dt> <dd> <p>Enables a previously disabled subscription, starting the logical replication worker at the end of the transaction.</p> </dd> <dt><code class="literal">DISABLE</code></dt> <dd> <p>Disables a running subscription, stopping the logical replication worker at the end of the transaction.</p> </dd> <dt><code class="literal">SET ( subscription_parameter [= value] [, ... ] )</code></dt> <dd> <p>This clause alters parameters originally set by <a class="xref" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION">CREATE SUBSCRIPTION</a>. See there for more information. The parameters that can be altered are <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-SLOT-NAME"><code class="literal">slot_name</code></a>, <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-SYNCHRONOUS-COMMIT"><code class="literal">synchronous_commit</code></a>, <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-BINARY"><code class="literal">binary</code></a>, <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-STREAMING"><code class="literal">streaming</code></a>, <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-DISABLE-ON-ERROR"><code class="literal">disable_on_error</code></a>, <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-PASSWORD-REQUIRED"><code class="literal">password_required</code></a>, <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-RUN-AS-OWNER"><code class="literal">run_as_owner</code></a>, and <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-ORIGIN"><code class="literal">origin</code></a>. Only a superuser can set <code class="literal">password_required = false</code>.</p> </dd> <dt><code class="literal">SKIP ( skip_option = value )</code></dt> <dd> <p>Skips applying all changes of the remote transaction. If incoming data violates any constraints, logical replication will stop until it is resolved. By using the <code class="command">ALTER SUBSCRIPTION ... SKIP</code> command, the logical replication worker skips all data modification changes within the transaction. This option has no effect on the transactions that are already prepared by enabling <a class="link" href="sql-createsubscription.html#SQL-CREATESUBSCRIPTION-WITH-TWO-PHASE"><code class="literal">two_phase</code></a> on the subscriber. After the logical replication worker successfully skips the transaction or finishes a transaction, the LSN (stored in <code class="structname">pg_subscription</code>.<code class="structfield">subskiplsn</code>) is cleared. See <a class="xref" href="logical-replication-conflicts.html" title="31.5. Conflicts">Section 31.5</a> for the details of logical replication conflicts.</p> <p><code>skip_option</code> specifies options for this operation. The supported option is:</p> <div class="variablelist"> <dl class="variablelist"> <dt>
<code class="literal">lsn</code> (<code class="type">pg_lsn</code>)</dt> <dd> <p>Specifies the finish LSN of the remote transaction whose changes are to be skipped by the logical replication worker. The finish LSN is the LSN at which the transaction is either committed or prepared. Skipping individual subtransactions is not supported. Setting <code class="literal">NONE</code> resets the LSN.</p> </dd> </dl> </div> </dd> <dt><code>new_owner</code></dt> <dd> <p>The user name of the new owner of the subscription.</p> </dd> <dt><code>new_name</code></dt> <dd> <p>The new name for the subscription.</p> </dd> </dl> </div> <p>When specifying a parameter of type <code class="type">boolean</code>, the <code class="literal">=</code> <code>value</code> part can be omitted, which is equivalent to specifying <code class="literal">TRUE</code>.</p> </div> <div class="refsect1" id="id-1.9.3.33.7"> <h2>Examples</h2> <p>Change the publication subscribed by a subscription to <code class="literal">insert_only</code>:</p> <pre data-language="sql">
ALTER SUBSCRIPTION mysub SET PUBLICATION insert_only;
</pre> <p>Disable (stop) the subscription:</p> <pre data-language="sql">
ALTER SUBSCRIPTION mysub DISABLE;
</pre> </div> <div class="refsect1" id="id-1.9.3.33.8"> <h2>Compatibility</h2> <p><code class="command">ALTER SUBSCRIPTION</code> is a PostgreSQL extension.</p> </div> <div class="refsect1" id="id-1.9.3.33.9"> <h2>See Also</h2>
<span class="simplelist"><a class="xref" href="sql-createsubscription.html" title="CREATE SUBSCRIPTION">CREATE SUBSCRIPTION</a>, <a class="xref" href="sql-dropsubscription.html" title="DROP SUBSCRIPTION">DROP SUBSCRIPTION</a>, <a class="xref" href="sql-createpublication.html" title="CREATE PUBLICATION">CREATE PUBLICATION</a>, <a class="xref" href="sql-alterpublication.html" title="ALTER PUBLICATION">ALTER PUBLICATION</a></span> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996&ndash;2023 The PostgreSQL Global Development Group<br>Licensed under the PostgreSQL License.<br>
    <a href="https://www.postgresql.org/docs/16/sql-altersubscription.html" class="_attribution-link">https://www.postgresql.org/docs/16/sql-altersubscription.html</a>
  </p>
</div>
