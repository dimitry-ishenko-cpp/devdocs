<h1>Creating a New Electron Browser Module</h1>
<p>Welcome to the Electron API guide! If you are unfamiliar with creating a new Electron API module within the <a href="https://github.com/electron/electron/tree/main/shell/browser" target="_blank" rel="noopener noreferrer"><code>browser</code></a> directory, this guide serves as a checklist for some of the necessary steps that you will need to implement.</p>
<p>This is not a comprehensive end-all guide to creating an Electron Browser API, rather an outline documenting some of the more unintuitive steps.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="add-your-files-to-electrons-project-configuration">Add your files to Electron's project configuration<a class="hash-link" href="#add-your-files-to-electrons-project-configuration" title="Direct link to heading">​</a>
</h2>
<p>Electron uses <a href="https://gn.googlesource.com/gn" target="_blank" rel="noopener noreferrer">GN</a> as a meta build system to generate files for its compiler, <a href="https://ninja-build.org/" target="_blank" rel="noopener noreferrer">Ninja</a>. This means that in order to tell Electron to compile your code, we have to add your API's code and header file names into <a href="https://github.com/electron/electron/blob/main/filenames.gni" target="_blank" rel="noopener noreferrer"><code>filenames.gni</code></a>.</p>
<p>You will need to append your API file names alphabetically into the appropriate files like so:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">filenames.gni</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" data-language="javascript">lib_sources = [
    "path/to/api/api_name.cc",
    "path/to/api/api_name.h",
]

lib_sources_mac = [
    "path/to/api/api_name_mac.h",
    "path/to/api/api_name_mac.mm",
]

lib_sources_win = [
    "path/to/api/api_name_win.cc",
    "path/to/api/api_name_win.h",
]

lib_sources_linux = [
    "path/to/api/api_name_linux.cc",
    "path/to/api/api_name_linux.h",
]</pre>

</div>
</div>
<p>Note that the Windows, macOS and Linux array additions are optional and should only be added if your API has specific platform implementations.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-api-documentation">Create API documentation<a class="hash-link" href="#create-api-documentation" title="Direct link to heading">​</a>
</h2>
<p>Type definitions are generated by Electron using <a href="https://github.com/electron/docs-parser" target="_blank" rel="noopener noreferrer"><code>@electron/docs-parser</code></a> and <a href="https://github.com/electron/typescript-definitions" target="_blank" rel="noopener noreferrer"><code>@electron/typescript-definitions</code></a>. This step is necessary to ensure consistency across Electron's API documentation. This means that for your API type definition to appear in the <code>electron.d.ts</code> file, we must create a <code>.md</code> file. Examples can be found in <a href="https://github.com/electron/electron/tree/main/docs/api" target="_blank" rel="noopener noreferrer">this folder</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="set-up-objecttemplatebuilder-and-wrappable">Set up <code>ObjectTemplateBuilder</code> and <code>Wrappable</code><a class="hash-link" href="#set-up-objecttemplatebuilder-and-wrappable" title="Direct link to heading">​</a>
</h2>
<p>Electron constructs its modules using <a href="https://www.electronjs.org/blog/from-native-to-js#mateobjecttemplatebuilder" target="_blank" rel="noopener noreferrer"><code>object_template_builder</code></a>.</p>
<p><a href="https://chromium.googlesource.com/chromium/src/+/refs/heads/main/gin/wrappable.h" target="_blank" rel="noopener noreferrer"><code>wrappable</code></a> is a base class for C++ objects that have corresponding v8 wrapper objects.</p>
<p>Here is a basic example of code that you may need to add, in order to incorporate <code>object_template_builder</code> and <code>wrappable</code> into your API. For further reference, you can find more implementations <a href="https://github.com/electron/electron/tree/main/shell/browser/api" target="_blank" rel="noopener noreferrer">here</a>.</p>
<p>In your <code>api_name.h</code> file:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">api_name.h</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" data-language="javascript">
#ifndef ELECTRON_SHELL_BROWSER_API_ELECTRON_API_{API_NAME}_H_
#define ELECTRON_SHELL_BROWSER_API_ELECTRON_API_{API_NAME}_H_

#include "gin/handle.h"
#include "gin/wrappable.h"

namespace electron {

namespace api {

class ApiName : public gin::Wrappable&lt;ApiName&gt;  {
 public:
  static gin::Handle&lt;ApiName&gt; Create(v8::Isolate* isolate);

  // gin::Wrappable
  static gin::WrapperInfo kWrapperInfo;
  gin::ObjectTemplateBuilder GetObjectTemplateBuilder(
      v8::Isolate* isolate) override;
  const char* GetTypeName() override;
} // namespace api
} // namespace electron</pre>

</div>
</div>
<p>In your <code>api_name.cc</code> file:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">api_name.cc</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" data-language="javascript">#include "shell/browser/api/electron_api_safe_storage.h"

#include "shell/browser/browser.h"
#include "shell/common/gin_converters/base_converter.h"
#include "shell/common/gin_converters/callback_converter.h"
#include "shell/common/gin_helper/dictionary.h"
#include "shell/common/gin_helper/object_template_builder.h"
#include "shell/common/node_includes.h"
#include "shell/common/platform_util.h"

namespace electron {

namespace api {

gin::WrapperInfo ApiName::kWrapperInfo = {gin::kEmbedderNativeGin};

gin::ObjectTemplateBuilder ApiName::GetObjectTemplateBuilder(
    v8::Isolate* isolate) {
  return gin::ObjectTemplateBuilder(isolate)
      .SetMethod("methodName", &amp;ApiName::methodName);
}

const char* ApiName::GetTypeName() {
  return "ApiName";
}

// static
gin::Handle&lt;ApiName&gt; ApiName::Create(v8::Isolate* isolate) {
  return gin::CreateHandle(isolate, new ApiName());
}

} // namespace api

} // namespace electron

namespace {

void Initialize(v8::Local&lt;v8::Object&gt; exports,
                v8::Local&lt;v8::Value&gt; unused,
                v8::Local&lt;v8::Context&gt; context,
                void* priv) {
  v8::Isolate* isolate = context-&gt;GetIsolate();
  gin_helper::Dictionary dict(isolate, exports);
  dict.Set("apiName", electron::api::ApiName::Create(isolate));
}

}  // namespace</pre>

</div>
</div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="link-your-electron-api-with-node">Link your Electron API with Node<a class="hash-link" href="#link-your-electron-api-with-node" title="Direct link to heading">​</a>
</h2>
<p>In the <a href="https://github.com/electron/electron/blob/main/typings/internal-ambient.d.ts" target="_blank" rel="noopener noreferrer"><code>typings/internal-ambient.d.ts</code></a> file, we need to append a new property onto the <code>Process</code> interface like so:</p>
<div class="language-ts codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">typings/internal-ambient.d.ts</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-ts codeBlock_bY9V thin-scrollbar" data-language="javascript">interface Process {
    _linkedBinding(name: 'electron_browser_{api_name}', Electron.ApiName);
}</pre>

</div>
</div>
<p>At the very bottom of your <code>api_name.cc</code> file:</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">api_name.cc</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" data-language="javascript">NODE_LINKED_MODULE_CONTEXT_AWARE(electron_browser_{api_name},Initialize)</pre>

</div>
</div>
<p>In your <a href="https://github.com/electron/electron/blob/main/shell/common/node_bindings.cc" target="_blank" rel="noopener noreferrer"><code>shell/common/node_bindings.cc</code></a> file, add your node binding name to Electron's built-in modules.</p>
<div class="language-cpp codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">shell/common/node_bindings.cc</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-cpp codeBlock_bY9V thin-scrollbar" data-language="javascript">#define ELECTRON_BUILTIN_MODULES(V)      \
  V(electron_browser_{api_name})</pre>

</div>
</div>
<blockquote><p>Note: More technical details on how Node links with Electron can be found on <a href="https://www.electronjs.org/blog/electron-internals-using-node-as-a-library#link-node-with-electron" target="_blank" rel="noopener noreferrer">our blog</a>.</p></blockquote>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="expose-your-api-to-typescript">Expose your API to TypeScript<a class="hash-link" href="#expose-your-api-to-typescript" title="Direct link to heading">​</a>
</h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="export-your-api-as-a-module">Export your API as a module<a class="hash-link" href="#export-your-api-as-a-module" title="Direct link to heading">​</a>
</h3>
<p>We will need to create a new TypeScript file in the path that follows:</p>
<p><code>"lib/browser/api/{electron_browser_{api_name}}.ts"</code></p>
<p>An example of the contents of this file can be found <a href="https://github.com/electron/electron/blob/main/lib/browser/api/native-image.ts" target="_blank" rel="noopener noreferrer">here</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="expose-your-module-to-typescript">Expose your module to TypeScript<a class="hash-link" href="#expose-your-module-to-typescript" title="Direct link to heading">​</a>
</h3>
<p>Add your module to the module list found at <code>"lib/browser/api/module-list.ts"</code> like so:</p>
<div class="language-typescript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa">
<div class="codeBlockTitle_Ktv7">lib/browser/api/module-list.ts</div>
<div class="codeBlockContent_biex">
<pre tabindex="0" class="prism-code language-typescript codeBlock_bY9V thin-scrollbar" data-language="javascript">export const browserModuleList: ElectronInternal.ModuleEntry[] = [
  { name: 'apiName', loader: () =&gt; require('./api-name') },
];</pre>

</div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; GitHub Inc.<br>Licensed under the MIT license.<br>
    <a href="https://www.electronjs.org/docs/latest/development/creating-api" class="_attribution-link">https://www.electronjs.org/docs/latest/development/creating-api</a>
  </p>
</div>
