<header><h1>Resource timing</h1></header><div class="section-content">
<p>Resource Timing is part of the Performance API and enables retrieving and analyzing detailed network timing data for the loading of an application's resources. An application can use the timing metrics to determine, for example, the length of time it takes to load a specific resource (such as an image or a script) either implicitly as part of page load or explicitly from JavaScript, for example using the <a href="../fetch.html"><code>fetch()</code></a> API.</p> <p>Every resource on a document will be represented by a <a href="../performanceresourcetiming.html"><code>PerformanceResourceTiming</code></a> entry (extending the <a href="../performanceentry.html"><code>PerformanceEntry</code></a> interface) with the <a href="../performanceentry/entrytype.html"><code>entryType</code></a> of <code>"resource"</code>.</p> <p>For each <code>PerformanceResourceTiming</code> entry, a <em>resource loading timeline</em> will be recorded, with <a href="../domhighrestimestamp.html">high-resolution timestamps</a> for network events such as redirect start and end times, DNS lookup start and end times, request start, response start and end times, and so on. Besides the timestamps, other properties that provide information about the resource are included as well, such the size of the fetched resource, or the type of resource that initiated the fetch.</p>
</div>
<h2 id="resource_loading_timestamps">Resource loading timestamps</h2>
<div class="section-content">
<p> <img src="https://developer.mozilla.org/en-US/docs/Web/API/PerformanceResourceTiming/timestamp-diagram.svg" alt="Timestamp diagram listing timestamps in the order in which they are recorded for the fetching of a resource" width="1152" height="464" loading="lazy"> Figure 1. Resource loading timestamps (<a href="https://w3c.github.io/resource-timing/#attribute-descriptions" target="_blank">source</a>). </p> <p>An application can get timestamps for the various stages used to load a resource. The timestamps this API provides are:</p> <ol> <li>
<a href="../performanceentry/starttime.html"><code>startTime</code></a>: timestamp immediately before the resource loading process begins.</li> <li>
<a href="../performanceresourcetiming/redirectstart.html"><code>redirectStart</code></a>: timestamp of the fetch which initiates the redirect.</li> <li>
<a href="../performanceresourcetiming/redirectend.html"><code>redirectEnd</code></a>: timestamp immediately after receiving the last byte of the response to the last redirect.</li> <li>
<a href="../performanceresourcetiming/workerstart.html"><code>workerStart</code></a>: timestamp immediately before starting the Service Worker thread.</li> <li>
<a href="../performanceresourcetiming/fetchstart.html"><code>fetchStart</code></a>: timestamp immediately before the browser starts to fetch the resource.</li> <li>
<a href="../performanceresourcetiming/domainlookupstart.html"><code>domainLookupStart</code></a>: timestamp immediately before the browser starts the domain name lookup for the resource.</li> <li>
<a href="../performanceresourcetiming/domainlookupend.html"><code>domainLookupEnd</code></a>: timestamp immediately after the browser finishes the domain name lookup for the resource.</li> <li>
<a href="../performanceresourcetiming/connectstart.html"><code>connectStart</code></a>: timestamp immediately before the user agent starts establishing the connection to the server to retrieve the resource.</li> <li>
<a href="../performanceresourcetiming/secureconnectionstart.html"><code>secureConnectionStart</code></a>: If the resource is loaded via a secure connection, timestamp immediately before the browser starts the handshake process to secure the current connection.</li> <li>
<a href="../performanceresourcetiming/connectend.html"><code>connectEnd</code></a>: timestamp immediately after the browser finishes establishing the connection to the server to retrieve the resource.</li> <li>
<a href="../performanceresourcetiming/requeststart.html"><code>requestStart</code></a>: timestamp of the time immediately before the browser starts requesting the resource from the server, cache, or local resource.</li> <li>
<a href="../performanceresourcetiming/responsestart.html"><code>responseStart</code></a>: timestamp immediately after the browser receives the first byte of the response from the server, cache, or local resource.</li> <li>
<a href="../performanceresourcetiming/responseend.html"><code>responseEnd</code></a>: timestamp immediately after the browser receives the last byte of the resource or immediately before the transport connection is closed, whichever comes first.</li> </ol>
</div>
<h2 id="resource_size">Resource size</h2>
<div class="section-content">
<p>The <a href="../performanceresourcetiming.html"><code>PerformanceResourceTiming</code></a> interface has three properties that can be used to obtain size data about a resource. The <a href="../performanceresourcetiming/transfersize.html"><code>transferSize</code></a> property returns the size (in bytes) of the fetched resource including the response header fields plus the response payload body.</p> <p>The <a href="../performanceresourcetiming/encodedbodysize.html"><code>encodedBodySize</code></a> property returns the size (in octets) received from the fetch (HTTP or cache), of the <em>payload body</em>, <strong>before</strong> removing any applied content-codings. <a href="../performanceresourcetiming/decodedbodysize.html"><code>decodedBodySize</code></a> returns the size (in octets) received from the fetch (HTTP or cache) of the <em>message body</em>, <strong>after</strong> removing any applied content-codings.</p>
</div>
<h2 id="other_properties">Other properties</h2>
<div class="section-content"><p>The <a href="../performanceresourcetiming.html"><code>PerformanceResourceTiming</code></a> interface provides <a href="../performanceresourcetiming.html#additional_resource_information">additional resources information</a>. Consult the reference docs for the full list of properties.</p></div>
<h2 id="typical_resource_timing_metrics">Typical resource timing metrics</h2>
<div class="section-content">
<p>The information the <code>PerformanceResourceTiming</code> entries provide are often used for calculations like the following:</p> <ul> <li>Measuring TCP handshake time (<code>connectEnd</code> - <code>connectStart</code>)</li> <li>Measuring DNS lookup time (<code>domainLookupEnd</code> - <code>domainLookupStart</code>)</li> <li>Measuring redirection time (<code>redirectEnd</code> - <code>redirectStart</code>)</li> <li>Measuring request time (<code>responseStart</code> - <code>requestStart</code>)</li> <li>Measuring TLS negotiation time (<code>requestStart</code> - <code>secureConnectionStart</code>)</li> <li>Measuring time to fetch (without redirects) (<code>responseEnd</code> - <code>fetchStart</code>)</li> <li>Measuring ServiceWorker processing time (<code>fetchStart</code> - <code>workerStart</code>)</li> <li>Checking if content was compressed (<code>decodedBodySize</code> should not be <code>encodedBodySize</code>)</li> <li>Checking if local caches were hit (<code>transferSize</code> should be <code>0</code>)</li> <li>Checking if modern and fast protocols are used (<code>nextHopProtocol</code> should be HTTP/2 or HTTP/3)</li> <li>Checking if the correct resources are render-blocking (<code>renderBlockingStatus</code>)</li> </ul> <p>The <a href="../performanceresourcetiming.html"><code>PerformanceResourceTiming</code></a> reference pages contain example code for measuring all of these metrics. Typically, the code for measuring these metrics looks like this:</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="PU68yor3Rka+EeRN+v8UbJspxkjtP0DvECL1iZ1Ps6c=" data-language="js"><span class="token keyword">const</span> observer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PerformanceObserver</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">list</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  list<span class="token punctuation">.</span><span class="token function">getEntries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">entry</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> request <span class="token operator">=</span> entry<span class="token punctuation">.</span>responseStart <span class="token operator">-</span> entry<span class="token punctuation">.</span>requestStart<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>request <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>entry<span class="token punctuation">.</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">: Request time: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>request<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">ms</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

observer<span class="token punctuation">.</span><span class="token function">observe</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">"resource"</span><span class="token punctuation">,</span> <span class="token literal-property property">buffered</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="cross-origin_timing_information">Cross-origin timing information</h2>
<div class="section-content">
<p>When <a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS">CORS</a> is in effect, many of the timing properties' values are returned as zero unless the server's access policy permits these values to be shared. This requires the server providing the resource to send the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin"><code>Timing-Allow-Origin</code></a> HTTP response header with a value specifying the origin or origins which are allowed to get the restricted timestamp values.</p> <p>The properties which are returned as 0 by default when loading a resource from an origin other than the one of the web page itself: <code>redirectStart</code>, <code>redirectEnd</code>, <code>domainLookupStart</code>, <code>domainLookupEnd</code>, <code>connectStart</code>, <code>connectEnd</code>, <code>secureConnectionStart</code>, <code>requestStart</code>, and <code>responseStart</code>.</p> <p>For example, to allow <code>https://developer.mozilla.org</code> to see resource timing information, the cross-origin resource should send:</p> <div class="code-example">
<p class="example-header"><span class="language-name">http</span></p>
<pre data-signature="XmXtiJrbKuPHKdV27fcR2RixWwa+L3l/ym1GLRNMBjw=" data-language="http"><span class="token header"><span class="token header-name keyword">Timing-Allow-Origin</span><span class="token punctuation">:</span> <span class="token header-value">https://developer.mozilla.org</span></span>
</pre>
</div>
</div>
<h2 id="managing_resource_buffer_sizes">Managing resource buffer sizes</h2>
<div class="section-content">
<p>If your website or application fetches more than 250 resources and you want to record more than 250 <a href="../performanceresourcetiming.html"><code>PerformanceResourceTiming</code></a> entries, you need to increase the size of the resource timing buffer.</p> <p>To set the size of the browser's performance resource data buffer, use the <a href="../performance/setresourcetimingbuffersize.html"><code>Performance.setResourceTimingBufferSize()</code></a> method, and to clear the browser's performance resource data buffer, use the <a href="../performance/clearresourcetimings.html"><code>Performance.clearResourceTimings()</code></a> method.</p> <p>To get notified when the browser's resource timing buffer is full, listen for the <a href="../performance/resourcetimingbufferfull_event.html"><code>resourcetimingbufferfull</code></a> event.</p> <p>The following call allows 500 <code>"resource"</code> performance entries in the browser's performance timeline.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="VV13ItP43kqS4rXx4++CYMFIqyuMCf4hhWt5QvQh+DE=" data-language="js">performance<span class="token punctuation">.</span><span class="token function">setResourceTimingBufferSize</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>For more information, see also <a href="performance_data.html#managing_buffer_sizes">Managing buffer sizes</a>.</p>
</div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../performanceresourcetiming.html"><code>PerformanceResourceTiming</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Timing-Allow-Origin"><code>Timing-Allow-Origin</code></a></li> <li><a href="../performance/setresourcetimingbuffersize.html"><code>Performance.setResourceTimingBufferSize()</code></a></li> <li><a href="../performance/clearresourcetimings.html"><code>Performance.clearResourceTimings()</code></a></li> </ul></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Performance_API/Resource_timing" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Performance_API/Resource_timing</a>
  </p>
</div>
