<header><h1>PaymentRequestEvent: changePaymentMethod() method</h1></header><div class="section-content">
<div class="notecard experimental" id="sect1"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div>
<div class="notecard note" id="sect2"> <p><strong>Note:</strong> This feature is only available in <a href="../service_worker_api.html">Service Workers</a>.</p> </div> <p>The <code>changePaymentMethod()</code> method of the <a href="../paymentrequestevent.html"><code>PaymentRequestEvent</code></a> interface is used by the payment handler to get an updated total, given such payment method details as the billing address.</p> <p>When this method is invoked, a <a href="../paymentmethodchangeevent.html"><code>PaymentMethodChangeEvent</code></a> is fired.</p>
</div>
<h2 id="syntax">Syntax</h2>
<div class="section-content"><div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="jnw1nYY6yxVMlRTZfObSee4LjbK3GGXDn2NxpfTYdRI=" data-language="js"><span class="token function">changePaymentMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">)</span>
<span class="token function">changePaymentMethod</span><span class="token punctuation">(</span>methodName<span class="token punctuation">,</span> methodDetails<span class="token punctuation">)</span>
</pre>
</div></div>
<h3 id="parameters">Parameters</h3>
<div class="section-content"><dl> <dt id="methodname"><a href="#methodname"><code>methodName</code></a></dt> <dd> <p>The name of the payment method to be used.</p> </dd> <dt id="methoddetails">
<a href="#methoddetails"><code>methodDetails</code></a> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>An object containing method-specific details that are being updated.</p> </dd> </dl></div>
<h3 id="return_value">Return value</h3>
<div class="section-content">
<p>A <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> that resolves with a <code>PaymentRequestDetailsUpdate</code> object. This object contains the following properties:</p> <dl> <dt id="error"><a href="#error"><code>error</code></a></dt> <dd> <p>A string that explains why the user-selected payment method cannot be used.</p> </dd> <dt id="total"><a href="#total"><code>total</code></a></dt> <dd> <p>An updated total based on the changed payment method. The total can change, for example, because the billing address of the payment method selected by the user changes the applicable sales tax.</p> </dd> <dt id="modifiers"><a href="#modifiers"><code>modifiers</code></a></dt> <dd> <p>An <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array"><code>Array</code></a> of <code>PaymentDetailsModifier</code> objects, whose properties are described in <a href="modifiers.html"><code>PaymentRequestEvent.modifiers</code></a>.</p> </dd> <dt id="paymentmethoderrors"><a href="#paymentmethoderrors"><code>paymentMethodErrors</code></a></dt> <dd> <p>An object containing validation errors for the payment method, if any.</p> </dd> </dl>
</div>
<h2 id="examples">Examples</h2>
<div class="section-content">
<p>The following shows a trivial code snippet that could be used in a service worker to send a payment method change notification to the main payment handler window. For a complete test example, see <a href="https://rsolomakhin.github.io/pr/apps/pmc/" target="_blank">Payment handler for testing payment method change event</a>.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="kW1PLj2CzNUYzMRSob+NO+OJztnOa5OcI+NAHlIKjGk=" data-language="js"><span class="token keyword">function</span> <span class="token function">notifyPaymentMethodChanged</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token function">changePaymentMethod</span><span class="token punctuation">(</span><span class="token string">"someMethod"</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">paymentMethodChangeResponse</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      paymentHandlerWindow<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>paymentMethodChangeResponse<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">error</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">error</span><span class="token operator">:</span> error<span class="token punctuation">.</span>message <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://w3c.github.io/payment-handler/#changepaymentmethod-method">Payment Handler API <br><small># changepaymentmethod-method</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
</tr>
</thead>
<tbody><tr>
<th><code>changePaymentMethod</code></th>
<td class="bc-supports-yes">76</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">63</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">76</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">54</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">12.0</td>
<td class="bc-supports-no">No</td>
</tr></tbody>
</table></div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="https://web.dev/articles/web-based-payment-apps-overview" target="_blank">Web-based payment apps overview</a></li> <li><a href="https://web.dev/articles/setting-up-a-payment-method" target="_blank">Setting up a payment method</a></li> <li><a href="https://web.dev/articles/life-of-a-payment-transaction" target="_blank">Life of a payment transaction</a></li> <li><a href="../payment_request_api/using_the_payment_request_api.html">Using the Payment Request API</a></li> <li><a href="../payment_request_api/concepts.html">Payment processing concepts</a></li> </ul></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/PaymentRequestEvent/changePaymentMethod" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/PaymentRequestEvent/changePaymentMethod</a>
  </p>
</div>
