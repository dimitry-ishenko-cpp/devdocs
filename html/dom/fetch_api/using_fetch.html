<header><h1>Using the Fetch API</h1></header><div class="section-content">
<p>The <a href="../fetch_api.html">Fetch API</a> provides a JavaScript interface for making HTTP requests and processing the responses.</p> <p>Fetch is the modern replacement for <a href="../xmlhttprequest.html"><code>XMLHttpRequest</code></a>: unlike <code>XMLHttpRequest</code>, which uses callbacks, Fetch is promise-based and is integrated with features of the modern web such as <a href="../service_worker_api.html">service workers</a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing (CORS)</a>.</p> <p>With the Fetch API, you make a request by calling <a href="../window/fetch.html"><code>fetch()</code></a>, which is available as a global function in both <a href="../window.html"><code>window</code></a> and <a href="../workerglobalscope.html"><code>worker</code></a> contexts. You pass it a <a href="../request.html"><code>Request</code></a> object or a string containing the URL to fetch, along with an optional argument to configure the request.</p> <p>The <code>fetch()</code> function returns a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> which is fulfilled with a <a href="../response.html"><code>Response</code></a> object representing the server's response. You can then check the request status and extract the body of the response in various formats, including text and JSON, by calling the appropriate method on the response.</p> <p>Here's a minimal function that uses <code>fetch()</code> to retrieve some JSON data from a server:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="viYHaE44JOjq+si2RR+o6J2w0yuPn5Q9sFCDq4WQvIc=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://example.org/products.json"</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> json <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>We declare a string containing the URL and then call <code>fetch()</code>, passing the URL with no extra options.</p> <p>The <code>fetch()</code> function will reject the promise on some errors, but not if the server responds with an error status like <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404"><code>404</code></a>: so we also check the response status and throw if it is not OK.</p> <p>Otherwise, we fetch the response body content as <a href="https://developer.mozilla.org/en-US/docs/Glossary/JSON">JSON</a> by calling the <a href="../response/json.html"><code>json()</code></a> method of <code>Response</code>, and log one of its values. Note that like <code>fetch()</code> itself, <code>json()</code> is asynchronous, as are all the other methods to access the response body content.</p> <p>In the rest of this page we'll look in more detail at the different stages of this process.</p>
</div>
<h2 id="making_a_request">Making a request</h2>
<div class="section-content">
<p>To make a request, call <code>fetch()</code>, passing in:</p> <ol> <li>a definition of the resource to fetch. This can be any one of: <ul> <li>a string containing the URL</li> <li>an object, such an instance of <a href="../url.html"><code>URL</code></a>, which has a <a href="https://developer.mozilla.org/en-US/docs/Glossary/Stringifier">stringifier</a> that produces a string containing the URL</li> <li>a <a href="../request.html"><code>Request</code></a> instance</li> </ul> </li> <li>optionally, an object containing options to configure the request.</li> </ol> <p>In this section we'll look at some of the most commonly-used options. To read about all the options that can be given, see the <a href="../window/fetch.html"><code>fetch()</code></a> reference page.</p>
</div>
<h3 id="setting_the_method">Setting the method</h3>
<div class="section-content">
<p>By default, <code>fetch()</code> makes a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/GET"><code>GET</code></a> request, but you can use the <code>method</code> option to use a different <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods">request method</a>:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="nEOVdVsx52+gAV/y8XMySR98B8Y8l8QOjSrx8SNDU7Q=" data-language="js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>If the <code>mode</code> option is set to <code>no-cors</code>, then <code>method</code> must be one of <code>GET</code>, <code>POST</code> or <code>HEAD</code>.</p>
</div>
<h3 id="setting_a_body">Setting a body</h3>
<div class="section-content">
<p>The request body is the payload of the request: it's the thing the client is sending to the server. You cannot include a body with <code>GET</code> requests, but it's useful for requests that send content to the server, such as <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/POST"><code>POST</code></a> or <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Methods/PUT"><code>PUT</code></a> requests. For example, if you want to upload a file to the server, you might make a <code>POST</code> request and include the file as the request body.</p> <p>To set a request body, pass it as the <code>body</code> option:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="j0Tg7AeL4F9EAfcJ4Z0uBHiMfyibqZiMym5G+wFpgWY=" data-language="js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>You can supply the body as an instance of any of the following types:</p> <ul> <li>a string</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/ArrayBuffer"><code>ArrayBuffer</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/TypedArray"><code>TypedArray</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/DataView"><code>DataView</code></a></li> <li><a href="../blob.html"><code>Blob</code></a></li> <li><a href="../file.html"><code>File</code></a></li> <li><a href="../urlsearchparams.html"><code>URLSearchParams</code></a></li> <li><a href="../formdata.html"><code>FormData</code></a></li> </ul> <p>Note that just like response bodies, request bodies are streams, and making the request reads the stream, so if a request contains a body, you can't make it twice:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="6NEz1C02xB8MXhWOWKoyNIyfL854xKfJ411pEzw9XSU=" data-language="js"><span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response1<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Will throw: "Body has already been consumed."</span>
<span class="token keyword">const</span> response2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response2<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>Instead, you would need to <a href="../request/clone.html">create a clone</a> of the request before sending it:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="1Jtt2XQaxHdn72XgGoQR4DMgf7ioBramlXF0N46sBRY=" data-language="js"><span class="token keyword">const</span> request1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> request2 <span class="token operator">=</span> request1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request1<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response1<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response2 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request2<span class="token punctuation">)</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>response2<span class="token punctuation">.</span>status<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>See <a href="#locked_and_disturbed_streams">Locked and disturbed streams</a> for more information.</p>
</div>
<h3 id="setting_headers">Setting headers</h3>
<div class="section-content">
<p>Request headers give the server information about the request: for example, the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type"><code>Content-Type</code></a> header tells the server the format of the request's body. Many headers are set automatically by the browser and can't be set by a script: these are called <a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name">Forbidden header names</a>.</p> <p>To set request headers, assign them to the <code>headers</code> option.</p> <p>You can pass an object literal here containing <code>header-name: header-value</code> properties:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="LkVw1D2+Sd5S36SDwlvdXCceOmXfl7RrGUHrazcr1L0=" data-language="js"><span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"Content-Type"</span><span class="token operator">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// .,.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>Alternatively, you can construct a <a href="../headers.html"><code>Headers</code></a> object, add headers to that object using <a href="../headers/append.html"><code>Headers.append()</code></a>, then assign the <code>Headers</code> object to the <code>headers</code> option:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="2OmM12bg3rYE4GnmaxmSfb0CwGaZwESocYOkuTDXBQM=" data-language="js"><span class="token keyword">const</span> myHeaders <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myHeaders<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> myHeaders<span class="token punctuation">,</span>
  <span class="token comment">// .,.</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>If the <code>mode</code> option is set to <code>no-cors</code>, you can only set <a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS-safelisted_request_header">CORS-safelisted request headers</a>.</p>
</div>
<h3 id="making_post_requests">Making POST requests</h3>
<div class="section-content">
<p>We can combine the <code>method</code>, <code>body</code>, and <code>headers</code> options to make a POST request:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="AUeXIH8bqh1qHuxYdKAAQHsELO1Mu9Xyl/xu7phDDyQ=" data-language="js"><span class="token keyword">const</span> myHeaders <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myHeaders<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> myHeaders<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h3 id="making_cross-origin_requests">Making cross-origin requests</h3>
<div class="section-content">
<p>Whether a request can be made cross-origin or not is determined by the value of the <code>mode</code> option. This may take one of three values: <code>cors</code>, <code>no-cors</code>, or <code>same-origin</code>.</p> <ul> <li>By default, <code>mode</code> is set to <code>cors</code>, meaning that if the request is cross-origin then it will use the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">Cross-Origin Resource Sharing (CORS)</a> mechanism. This means that: <ul> <li>if the request is a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests">simple request</a>, then the request will always be sent, but the server must respond with the correct <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a> header or the browser will not share the response with the caller.</li> <li>if the request is not a simple request, then the browser will send a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests">preflighted request</a> to check that the server understands CORS and allows the request, and the real request will not be sent unless the server responds to the preflighted request with the appropriate CORS headers.</li> </ul> </li> <li>Setting <code>mode</code> to <code>same-origin</code> disallows cross-origin requests completely.</li> <li>Setting <code>mode</code> to <code>no-cors</code> means the request must be a simple request, which restricts the headers that may be set, and restricts methods to <code>GET</code>, <code>HEAD</code>, and <code>POST</code>.</li> </ul>
</div>
<h3 id="including_credentials">Including credentials</h3>
<div class="section-content">
<p>Credentials are cookies, <a href="https://developer.mozilla.org/en-US/docs/Glossary/TLS">TLS</a> client certificates, or authentication headers containing a username and password.</p> <p>To control whether or not the browser sends credentials, as well as whether the browser respects any <code>Set-Cookie</code> response headers, set the <code>credentials</code> option, which can take one of the following three values:</p> <ul> <li>
<code>omit</code>: never send credentials in the request or include credentials in the response.</li> <li>
<code>same-origin</code> (the default): only send and include credentials for same-origin requests.</li> <li>
<code>include</code>: always include credentials, even cross-origin.</li> </ul> <p>Note that if a cookie's <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Set-Cookie#samesitesamesite-value"><code>SameSite</code></a> attribute is set to <code>Strict</code> or <code>Lax</code>, then the cookie will not be sent cross-site, even if <code>credentials</code> is set to <code>include</code>.</p> <p>Including credentials in cross-origin requests can make a site vulnerable to <a href="https://developer.mozilla.org/en-US/docs/Glossary/CSRF">CSRF</a> attacks, so even if <code>credentials</code> is set to <code>include</code>, the server must also agree to their inclusion by including the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials"><code>Access-Control-Allow-Credentials</code></a> header in its response. Additionally, in this situation the server must explicitly specify the client's origin in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a> response header (that is, <code>*</code> is not allowed).</p> <p>This means that if <code>credentials</code> is set to <code>include</code> and the request is cross-origin, then:</p> <ul> <li>If the request is a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#simple_requests">simple request</a>, then the request will be sent with credentials, but the server must set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials"><code>Access-Control-Allow-Credentials</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a> response headers, or the browser will return a network error to the caller. If the server does set the correct headers, then the response, including credentials, will be delivered to the caller.</li> <li>If the request is not a simple request, then the browser will send a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS#preflighted_requests">preflighted request</a> without credentials, and the server must set the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials"><code>Access-Control-Allow-Credentials</code></a> and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Access-Control-Allow-Origin"><code>Access-Control-Allow-Origin</code></a> response headers, or the browser will return a network error to the caller. If the server does set the correct headers, then the browser will follow up with the real request, including credentials, and will deliver the real response, including credentials, to the caller.</li> </ul>
</div>
<h3 id="creating_a_request_object">Creating a <code>Request</code> object</h3>
<div class="section-content">
<p>The <a href="../request/request.html"><code>Request()</code></a> constructor takes the same arguments as <code>fetch()</code> itself. This means that instead of passing options into <code>fetch()</code>, you can pass the same options to the <code>Request()</code> constructor, and then pass that object to <code>fetch()</code>.</p> <p>For example, we can make a POST request by passing options into <code>fetch()</code> using code like this:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="AUeXIH8bqh1qHuxYdKAAQHsELO1Mu9Xyl/xu7phDDyQ=" data-language="js"><span class="token keyword">const</span> myHeaders <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myHeaders<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> myHeaders<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>However, we could rewrite this to pass the same arguments to the <code>Request()</code> constructor:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="aKaM2h3L4A1ycVVFFc9BP71A+Malq964at+8Q3HXxZM=" data-language="js"><span class="token keyword">const</span> myHeaders <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myHeaders<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> myRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> myHeaders<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>myRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>This also means that you can create a request from another request, while changing some of its properties using the second argument:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="UPamYaTDQzO+vNmmH/zC3+6TC0RK0iVfkRbZfoJbN4A=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">post</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Success:"</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Error:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> request1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token string">"https://example.org/post"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">method</span><span class="token operator">:</span> <span class="token string">"POST"</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headers</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">"Content-Type"</span><span class="token operator">:</span> <span class="token string">"application/json"</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example1"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> request2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span>request1<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">body</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">username</span><span class="token operator">:</span> <span class="token string">"example2"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">post</span><span class="token punctuation">(</span>request1<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">post</span><span class="token punctuation">(</span>request2<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="canceling_a_request">Canceling a request</h2>
<div class="section-content">
<p>To make a request cancelable, create an <a href="../abortcontroller.html"><code>AbortController</code></a>, and assign its <a href="../abortsignal.html"><code>AbortSignal</code></a> to the request's <code>signal</code> property.</p> <p>To cancel the request, call the controller's <a href="../abortcontroller/abort.html"><code>abort()</code></a> method. The <code>fetch()</code> call will reject the promise with an <code>AbortError</code> exception.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="3NlOnWkAMs/x3rciTB8Q4A3Y5jaKR3v4spPGyFfbXMw=" data-language="js"><span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> fetchButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#fetch"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
fetchButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Starting fetch"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">"https://example.org/get"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Error: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>e<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> cancelButton <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"#cancel"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
cancelButton<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"click"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  controller<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"Canceled fetch"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>If the request is aborted after the <code>fetch()</code> call has been fulfilled but before the response body has been read, then attempting to read the response body will reject with an <code>AbortError</code> exception.</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="jiUQ/OXeZl1zc9EeA1/2bHa5PdOWrSMbEJg1a68ahxs=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> controller <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbortController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Request</span><span class="token punctuation">(</span><span class="token string">"https://example.org/get"</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">signal</span><span class="token operator">:</span> controller<span class="token punctuation">.</span>signal<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  controller<span class="token punctuation">.</span><span class="token function">abort</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// The next line will throw `AbortError`</span>
  <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h2 id="handling_the_response">Handling the response</h2>
<div class="section-content"><p>As soon as the browser has received the response status and headers from the server (and potentially before the response body itself has been received), the promise returned by <code>fetch()</code> is fulfilled with a <a href="../response.html"><code>Response</code></a> object.</p></div>
<h3 id="checking_response_status">Checking response status</h3>
<div class="section-content">
<p>The promise returned by <code>fetch()</code> will reject on some errors, such as a network error or a bad scheme. However, if the server responds with an error like <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status/404"><code>404</code></a>, then <code>fetch()</code> fulfills with a <code>Response</code>, so we have to check the status before we can read the response body.</p> <p>The <a href="../response/status.html"><code>Response.status</code></a> property tells us the numerical status code, and the <a href="../response/ok.html"><code>Response.ok</code></a> property returns <code>true</code> if the status is in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#successful_responses">200 range</a>.</p> <p>A common pattern is to check the value of <code>ok</code> and throw if it is <code>false</code>:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="0KIL7dYxp+1wzo7usThKs9xic7AeTH3m3FI5FNvS+LA=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://example.org/products.json"</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h3 id="checking_the_response_type">Checking the response type</h3>
<div class="section-content">
<p>Responses have a <a href="../response/type.html"><code>type</code></a> property that can be one of the following:</p> <ul> <li>
<code>basic</code>: the request was a same-origin request.</li> <li>
<code>cors</code>: the request was a cross-origin CORS request.</li> <li>
<code>opaque</code>: the request was a cross-origin simple request made with the <code>no-cors</code> mode.</li> <li>
<code>opaqueredirect</code>: the request set the <code>redirect</code> option to <code>manual</code>, and the server returned a <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Status#redirection_messages">redirect status</a>.</li> </ul> <p>The type determines the possible contents of the response, as follows:</p> <ul> <li>Basic responses exclude response headers from the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_response_header_name">Forbidden response header name</a> list.</li> <li>CORS responses include only response headers from the <a href="https://developer.mozilla.org/en-US/docs/Glossary/CORS-safelisted_response_header">CORS-safelisted response header</a> list.</li> <li>Opaque responses and opaque redirect responses have a <code>status</code> of <code>0</code>, an empty header list, and a <code>null</code> body.</li> </ul>
</div>
<h3 id="checking_headers">Checking headers</h3>
<div class="section-content">
<p>Just like the request, the response has a <a href="../response/headers.html"><code>headers</code></a> property which is a <a href="../headers.html"><code>Headers</code></a> object, and this contains any response headers that are exposed to scripts, subject to the exclusions made based on the response type.</p> <p>A common use case for this is to check the content type before trying to read the body:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="MjhDjNMGhFCQ9CZzzs7dqO+TXmmuxExH3tdxXDrZDFI=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchJSON</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> contentType <span class="token operator">=</span> response<span class="token punctuation">.</span>headers<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"content-type"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>contentType <span class="token operator">||</span> <span class="token operator">!</span>contentType<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">"Oops, we haven't got JSON!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// Otherwise, we can read the body as JSON</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">"Error:"</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div>
<h3 id="reading_the_response_body">Reading the response body</h3>
<div class="section-content">
<p>The <code>Response</code> interface provides a number of methods to retrieve the entire body contents in a variety of different formats:</p> <ul> <li><a href="../response/arraybuffer.html"><code>Response.arrayBuffer()</code></a></li> <li><a href="../response/blob.html"><code>Response.blob()</code></a></li> <li><a href="../response/formdata.html"><code>Response.formData()</code></a></li> <li><a href="../response/json.html"><code>Response.json()</code></a></li> <li><a href="../response/text.html"><code>Response.text()</code></a></li> </ul> <p>These are all asynchronous methods, returning a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise"><code>Promise</code></a> which will be fulfilled with the body content.</p> <p>In this example, we fetch an image and read it as a <a href="../blob.html"><code>Blob</code></a>, which we can then use to create an object URL:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="c47izdeqazLJcJEbp8euDLQzWG9PvpB1EkHIcF+yYgw=" data-language="js"><span class="token keyword">const</span> image <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">"img"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"flowers.jpg"</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">setImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> blob <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">blob</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> objectURL <span class="token operator">=</span> <span class="token constant">URL</span><span class="token punctuation">.</span><span class="token function">createObjectURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span><span class="token punctuation">;</span>
    image<span class="token punctuation">.</span>src <span class="token operator">=</span> objectURL<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The method will throw an exception if the response body is not in the appropriate format: for example, if you call <code>json()</code> on a response that can't be parsed as JSON.</p>
</div>
<h3 id="streaming_the_response_body">Streaming the response body</h3>
<div class="section-content">
<p>Request and response bodies are actually <a href="../readablestream.html"><code>ReadableStream</code></a> objects, and whenever you read them, you're streaming the content. This is good for memory efficiency, because the browser doesn't have to buffer the entire response in memory before the caller retrieves it using a method like <code>json()</code>.</p> <p>This also means that the caller can process the content incrementally as it is received.</p> <p>For example, consider a <code>GET</code> request that fetches a large text file and processes it in some way, or displays it to the user:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="0cSFCEnho0BYWcCn6Lr9/MhudVAVoq0Nz1JiSVkYu78=" data-language="js"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://www.example.org/a-large-file.txt"</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchText</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> text <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>If we use <a href="../response/text.html"><code>Response.text()</code></a>, as above, we must wait until the whole file has been received before we can process any of it.</p> <p>If we stream the response instead, we can process chunks of the body as they are received from the network:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="mErFGlDw9ynQau5dyv2Ej7SE9jXNplVFmeTbQb5yDxI=" data-language="js"><span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://www.example.org/a-large-file.txt"</span><span class="token punctuation">;</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">fetchTextAsStream</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> stream <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">pipeThrough</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextDecoderStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> value <span class="token keyword">of</span> stream<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>In this example, we <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for-await...of">iterate asynchronously</a> over the stream, processing each chunk as it arrives.</p> <p>Note that when you access the body directly like this, you get the raw bytes of the response and must transform it yourself. In this case we call <a href="../readablestream/pipethrough.html"><code>ReadableStream.pipeThrough()</code></a> to pipe the response through a <a href="../textdecoderstream.html"><code>TextDecoderStream</code></a>, which decodes the UTF-8-encoded body data as text.</p>
</div>
<h3 id="processing_a_text_file_line_by_line">Processing a text file line by line</h3>
<div class="section-content">
<p>In the example below, we fetch a text resource and process it line by line, using a regular expression to look for line endings. For simplicity, we assume the text is UTF-8, and don't handle fetch errors:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="VCtOwJwl1ckq7+vvYGYjvlF2qMwscs6RIczOtvv8CCw=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">makeTextFileLineIterator</span><span class="token punctuation">(</span><span class="token parameter">fileURL</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>fileURL<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> reader <span class="token operator">=</span> response<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">pipeThrough</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">TextDecoderStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> <span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> chunk<span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> readerDone <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  chunk <span class="token operator">=</span> chunk <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> newline <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex"><span class="token escape">\r</span><span class="token quantifier number">?</span><span class="token escape">\n</span></span><span class="token regex-delimiter">/</span><span class="token regex-flags">gm</span></span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> startIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> result<span class="token punctuation">;</span>

  <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> newline<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>readerDone<span class="token punctuation">)</span> <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> remainder <span class="token operator">=</span> chunk<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">value</span><span class="token operator">:</span> chunk<span class="token punctuation">,</span> <span class="token literal-property property">done</span><span class="token operator">:</span> readerDone <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> reader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      chunk <span class="token operator">=</span> remainder <span class="token operator">+</span> <span class="token punctuation">(</span>chunk <span class="token operator">||</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      startIndex <span class="token operator">=</span> newline<span class="token punctuation">.</span>lastIndex <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token keyword">continue</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">yield</span> chunk<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">,</span> result<span class="token punctuation">.</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    startIndex <span class="token operator">=</span> newline<span class="token punctuation">.</span>lastIndex<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>startIndex <span class="token operator">&lt;</span> chunk<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Last line didn't end in a newline char</span>
    <span class="token keyword">yield</span> chunk<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>startIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token parameter">urlOfFile</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> line <span class="token keyword">of</span> <span class="token function">makeTextFileLineIterator</span><span class="token punctuation">(</span>urlOfFile<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">processLine</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">processLine</span><span class="token punctuation">(</span><span class="token parameter">line</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>line<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function">run</span><span class="token punctuation">(</span><span class="token string">"https://www.example.org/a-large-file.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h3 id="locked_and_disturbed_streams">Locked and disturbed streams</h3>
<div class="section-content">
<p>The consequences of request and response bodies being streams are that:</p> <ul> <li>if a reader has been attached to a stream using <code>ReadableStream.getReader()</code>, then the stream is <em>locked</em>, and nothing else can read the stream.</li> <li>if any content has been read from the stream, then the stream is <em>disturbed</em>, and nothing else can read from the stream.</li> </ul> <p>This means it's not possible to read the same response (or request) body more than once:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="fYp/nGZN9dnkp/krh8EJJ0mN4HmhxZ3AzNQbmMfG/6M=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://example.org/products.json"</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> json1 <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> json2 <span class="token operator">=</span> <span class="token keyword">await</span> response<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// will throw</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>If you do need to read the body more than once, you must call <a href="../response/clone.html"><code>Response.clone()</code></a> before reading the body:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="yNHm0STGZeMun5xUz9RE/MUcXtnXzRddP03MFTO8A88=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> url <span class="token operator">=</span> <span class="token string">"https://example.org/products.json"</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response1 <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response1<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Response status: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>response1<span class="token punctuation">.</span>status<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> response2 <span class="token operator">=</span> response1<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> json1 <span class="token operator">=</span> <span class="token keyword">await</span> response1<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> json2 <span class="token operator">=</span> <span class="token keyword">await</span> response2<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>error<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>This is a common pattern when <a href="https://developer.mozilla.org/en-US/docs/Web/Progressive_web_apps/Guides/Caching">implementing an offline cache with service workers</a>. The service worker wants to return the response to the app, but also to cache the response. So it clones the response, returns the original, and caches the clone:</p> <div class="code-example">
<div class="example-header"><span class="language-name">js</span></div>
<pre data-signature="oqOkXwSU10vOzQzOPk/1+lHtzgdJJMifAOnVhmfH0Fc=" data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">cacheFirst</span><span class="token punctuation">(</span><span class="token parameter">request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> cachedResponse <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cachedResponse<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> cachedResponse<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> networkResponse <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>networkResponse<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> cache <span class="token operator">=</span> <span class="token keyword">await</span> caches<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">"MyCache_1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      cache<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> networkResponse<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> networkResponse<span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Response<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"fetch"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>precachedResources<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>url<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    event<span class="token punctuation">.</span><span class="token function">respondWith</span><span class="token punctuation">(</span><span class="token function">cacheFirst</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../service_worker_api.html">Service Worker API</a></li> <li><a href="../streams_api.html">Streams API</a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS">CORS</a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP">HTTP</a></li> <li><a href="https://github.com/mdn/dom-examples/tree/main/fetch" target="_blank">Fetch examples on GitHub</a></li> </ul></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch</a>
  </p>
</div>
