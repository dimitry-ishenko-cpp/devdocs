<header><h1>CSPViolationReportBody</h1></header><div class="section-content">
<div class="notecard secure"><p><strong>Secure context:</strong> This feature is available only in <a href="https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts">secure contexts</a> (HTTPS), in some or all <a href="#browser_compatibility">supporting browsers</a>.</p></div> <p>The <code>CSPViolationReportBody</code> interface is an extension of the <a href="reporting_api.html">Reporting API</a> that represents the body of a Content Security Policy (CSP) violation report.</p> <p>CSP violations are thrown when the webpage attempts to load a resource that violates the policy set by the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a> HTTP header.</p> <p>CSP violation reports are returned in the <a href="reportingobserver/reportingobserver.html#reports">reports</a> parameter of <a href="reportingobserver.html"><code>ReportingObserver</code></a> callbacks that have a <code>type</code> of <code>"csp-violation"</code>. The <code>body</code> property of those reports is an instance of <code>CSPViolationReportBody</code>.</p> <p>CSP violation reports may also be sent as JSON objects to the endpoint specified in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to"><code>report-to</code></a> policy directive of the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a> header. These reports similarly have a <code>type</code> of <code>"csp-violation"</code>, and a <code>body</code> property containing a serialization of an instance of this interface.</p> <div class="notecard note"> <p><strong>Note:</strong> CSP violation reports sent by the Reporting API, when an endpoint is specified using the CSP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to"><code>report-to</code></a> directive, are similar (but not identical) to the "CSP report" <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri#violation_report_syntax">JSON objects</a> sent when endpoints are specified using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-uri"><code>report-uri</code></a> directive. The Reporting API and <code>report-to</code> directive are intended to replace the older report format and the <code>report-uri</code> directive.</p> </div> <svg viewbox="-1 -1 650 42" preserveaspectratio="xMinYMin meet"><a style="text-decoration: none;" href="reportbody.html">  <text x="40" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> ReportBody </text> </a><a style="text-decoration: none;" href="cspviolationreportbody.html" aria-current="page">  <text x="198" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> CSPViolationReportBody </text> </a></svg>
</div>
<h2 id="instance_properties">Instance properties</h2>
<div class="section-content">
<p><em>Also inherits properties from its parent interface, <a href="reportbody.html"><code>ReportBody</code></a>.</em></p> <dl> <dt id="cspviolationreportbody.blockedurl">
<a href="cspviolationreportbody/blockedurl.html"><code>CSPViolationReportBody.blockedURL</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A string representing either the type or the URL of the resource that was blocked because it violates the CSP.</p> </dd> <dt id="cspviolationreportbody.columnnumber">
<a href="cspviolationreportbody/columnnumber.html"><code>CSPViolationReportBody.columnNumber</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>The column number in the script at which the violation occurred.</p> </dd> <dt id="cspviolationreportbody.disposition">
<a href="cspviolationreportbody/disposition.html"><code>CSPViolationReportBody.disposition</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>Indicates how the violated policy is configured to be treated by the user agent. This will be <code>"enforce"</code> or <code>"report"</code>.</p> </dd> <dt id="cspviolationreportbody.documenturl">
<a href="cspviolationreportbody/documenturl.html"><code>CSPViolationReportBody.documentURL</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A string representing the URL of the document or worker in which the violation was found.</p> </dd> <dt id="cspviolationreportbody.effectivedirective">
<a href="cspviolationreportbody/effectivedirective.html"><code>CSPViolationReportBody.effectiveDirective</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A string representing the directive whose enforcement uncovered the violation.</p> </dd> <dt id="cspviolationreportbody.linenumber">
<a href="cspviolationreportbody/linenumber.html"><code>CSPViolationReportBody.lineNumber</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>The line number in the script at which the violation occurred.</p> </dd> <dt id="cspviolationreportbody.originalpolicy">
<a href="cspviolationreportbody/originalpolicy.html"><code>CSPViolationReportBody.originalPolicy</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A string containing the policy whose enforcement uncovered the violation.</p> </dd> <dt id="cspviolationreportbody.referrer">
<a href="cspviolationreportbody/referrer.html"><code>CSPViolationReportBody.referrer</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A string representing the URL for the referrer of the resources whose policy was violated, or <code>null</code>.</p> </dd> <dt id="cspviolationreportbody.sample">
<a href="cspviolationreportbody/sample.html"><code>CSPViolationReportBody.sample</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A string representing a sample of the resource that caused the violation, usually the first 40 characters. This will only be populated if the resource is an inline script, event handler, or style â€” external resources causing a violation will not generate a sample.</p> </dd> <dt id="cspviolationreportbody.sourcefile">
<a href="cspviolationreportbody/sourcefile.html"><code>CSPViolationReportBody.sourceFile</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>If the violation occurred as a result of a script, this will be the URL of the script; otherwise, it will be <code>null</code>. Both <code>columnNumber</code> and <code>lineNumber</code> should have non-null values if this property is not <code>null</code>.</p> </dd> <dt id="cspviolationreportbody.statuscode">
<a href="cspviolationreportbody/statuscode.html"><code>CSPViolationReportBody.statusCode</code></a> <span class="badge inline readonly">Read only</span>
</dt> <dd> <p>A number representing the HTTP status code of the document or worker in which the violation occurred.</p> </dd> </dl>
</div>
<h2 id="instance_methods">Instance methods</h2>
<div class="section-content">
<p><em>Also inherits methods from its parent interface, <a href="reportbody.html"><code>ReportBody</code></a>.</em></p> <dl> <dt id="cspviolationreportbody.tojson"><a href="cspviolationreportbody/tojson.html"><code>CSPViolationReportBody.toJSON()</code></a></dt> <dd> <p>A <em>serializer</em> which returns a JSON representation of the <code>CSPViolationReportBody</code> object.</p> </dd> </dl>
</div>
<h2 id="examples">Examples</h2>

<h3 id="obtaining_a_cspviolationreportbody_object">Obtaining a <code>CSPViolationReportBody</code> object</h3>
<div class="section-content">
<p>To obtain a <code>CSPViolationReportBody</code> object, you must configure your page so that a CSP violation will occur. In this example, we will set our CSP to only allow content from the site's own origin, and then attempt to load a script from <code>apis.google.com</code>, which is an external origin.</p> <p>First, we will set our <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a> header in the HTTP response:</p> <div class="code-example"><pre data-language="http">Content-Security-Policy: default-src 'self';
</pre></div> <p>or in the HTML <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta"><code>&lt;meta&gt;</code></a> element:</p> <div class="code-example"><pre data-language="html">&lt;meta http-equiv="Content-Security-Policy" content="default-src 'self'" /&gt;
</pre></div> <p>Then, we will attempt to load an external script:</p> <div class="code-example"><pre data-language="html">&lt;!-- This should generate a CSP violation --&gt;
&lt;script src="https://apis.google.com/js/platform.js"&gt;&lt;/script&gt;
</pre></div> <p>Finally, we will create a new <a href="reportingobserver.html"><code>ReportingObserver</code></a> object to listen for CSP violations (this will need to be loaded from the same location, before the script that causes the violation).</p> <div class="code-example"><pre data-language="js">const observer = new ReportingObserver(
  (reports, observer) =&gt; {
    reports.forEach((violation) =&gt; {
      console.log(violation);
      console.log(JSON.stringify(violation));
    });
  },
  {
    types: ["csp-violation"],
    buffered: true,
  },
);

observer.observe();
</pre></div> <p>Above we log the each violation report object and a JSON-string version of the object, which might look similar to the object below. Note that the <code>body</code> is an instance of the <code>CSPViolationReportBody</code> and the <code>type</code> is <code>"csp-violation"</code>.</p> <div class="code-example"><pre data-language="js">{
    "type": "csp-violation",
    "url": "http://127.0.0.1:9999/",
    "body": {
        "sourceFile": null,
        "lineNumber": null,
        "columnNumber": null,
        "documentURL": "http://127.0.0.1:9999/",
        "referrer": "",
        "blockedURL": "https://apis.google.com/js/platform.js",
        "effectiveDirective": "script-src-elem",
        "originalPolicy": "default-src 'self';",
        "sample": "",
        "disposition": "enforce",
        "statusCode": 200
    }
}
</pre></div>
</div>
<h3 id="sending_a_csp_violation_report">Sending a CSP violation report</h3>
<div class="section-content">
<p>Configuring a web page to send a CSP violation report is similar to the previous example. As before, you need to configure your page so that there is a violation.</p> <p>In addition, you also need to specify the endpoint(s) where the report will be sent. A server specifies endpoints using the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Reporting-Endpoints"><code>Reporting-Endpoints</code></a> response header: these must be secure URLs (HTTPS). The CSP <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/report-to"><code>report-to</code></a> directive is then used to specify that a particular endpoint is used for reporting CSP violations:</p> <div class="code-example"><pre data-language="http">Reporting-Endpoints: csp-endpoint="https://example.com/csp-report-to"
Content-Security-Policy: default-src 'self'; report-to csp-endpoint
</pre></div> <p>As before, we can trigger a violation by loading an external script from a location that is not allowed by our CSP header:</p> <div class="code-example"><pre data-language="html">&lt;!-- This should generate a CSP violation --&gt;
&lt;script src="https://apis.google.com/js/platform.js"&gt;&lt;/script&gt;
</pre></div> <p>The violation report will then be sent to the indicated endpoint as a JSON file. As you can see from the example below, the <code>type</code> is <code>"csp-violation"</code> and the <code>body</code> property is a serialization of the <code>CSPViolationReportBody</code> object:</p> <div class="code-example"><pre data-language="json">[
  {
    "age": 53531,
    "body": {
      "blockedURL": "inline",
      "columnNumber": 59,
      "disposition": "enforce",
      "documentURL": "https://example.com/csp-report-to",
      "effectiveDirective": "script-src-elem",
      "lineNumber": 1441,
      "originalPolicy": "default-src 'self'; report-to csp-endpoint",
      "referrer": "https://www.google.com/",
      "sample": "",
      "sourceFile": "https://example.com/csp-report-to",
      "statusCode": 200
    },
    "type": "csp-violation",
    "url": "https://example.com/csp-report-to",
    "user_agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36"
  }
]
</pre></div>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://w3c.github.io/webappsec-csp/#cspviolationreportbody">Content Security Policy Level 3 <br><small># cspviolationreportbody</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="5">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Opera</th>
<th>Safari</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
<th>WebView Android</th>
</tr>
</thead>
<tbody>
<tr>
<th><code>CSPViolationReportBody</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-yes">130</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>blockedURL</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>columnNumber</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>disposition</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>documentURL</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>effectiveDirective</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>lineNumber</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>originalPolicy</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>referrer</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>sample</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>sourceFile</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>statusCode</code></th>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">74</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">74</td>
</tr>
<tr>
<th><code>toJSON</code></th>
<td class="bc-supports-yes">80</td>
<td class="bc-supports-yes">80</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">56</td>
<td class="bc-supports-yes">preview</td>
<td class="bc-supports-yes">80</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">48</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
<td class="bc-supports-yes">80</td>
</tr>
</tbody>
</table></div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="reportbody.html"><code>ReportBody</code></a></li> <li><a href="reportingobserver.html"><code>ReportingObserver</code></a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy"><code>Content-Security-Policy</code></a></li> <li><a href="securitypolicyviolationevent.html"><code>SecurityPolicyViolationEvent</code></a></li> </ul></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2024 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/CSPViolationReportBody" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/CSPViolationReportBody</a>
  </p>
</div>
