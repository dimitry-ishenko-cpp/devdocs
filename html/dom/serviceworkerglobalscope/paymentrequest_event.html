<header><h1>ServiceWorkerGlobalScope: paymentrequest event</h1></header><div class="section-content">
<div class="notecard experimental" id="sect1"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div> <p>The <code>paymentrequest</code> event of the <a href="../serviceworkerglobalscope.html"><code>ServiceWorkerGlobalScope</code></a> interface is fired on a payment app when a payment flow has been initiated on the merchant website via the <a href="../paymentrequest/show.html"><code>PaymentRequest.show()</code></a> method.</p>
</div>
<h2 id="syntax">Syntax</h2>
<div class="section-content">
<p>Use the event name in methods like <a href="../eventtarget/addeventlistener.html"><code>addEventListener()</code></a>, or set an event handler property.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="nK0+iXJXRa3g0w3nbxcE9xjM8ydK9lYlf0NCOvPTcF8=" data-language="js"><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"paymentrequest"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function-variable function">onpaymentrequest</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</pre>
</div>
</div>
<h2 id="event_type">Event type</h2>
<div class="section-content">
<p>A <a href="../paymentrequestevent.html"><code>PaymentRequestEvent</code></a>. Inherits from <a href="../extendableevent.html"><code>ExtendableEvent</code></a>.</p>
<svg viewbox="-1 -1 650 42" preserveaspectratio="xMinYMin meet"> <a style="text-decoration: none;" xlink:href="/en-US/docs/Web/API/Event.html">  <text x="37.5" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> Event </text> </a>   <a style="text-decoration: none;" xlink:href="/en-US/docs/Web/API/ExtendableEvent.html">  <text x="165" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> ExtendableEvent </text> </a>   <a style="text-decoration: none;" xlink:href="/en-US/docs/Web/API/PaymentRequestEvent.html">  <text x="331" y="16" font-size="10px" fill="#4D4E53" text-anchor="middle"> PaymentRequestEvent </text> </a></svg>
</div>
<h2 id="examples">Examples</h2>
<div class="section-content">
<p>When the <a href="../paymentrequest/show.html"><code>PaymentRequest.show()</code></a> method is invoked, a <a href="paymentrequest_event.html" aria-current="page"><code>paymentrequest</code></a> event is fired on the service worker of the payment app. This event is listened for inside the payment app's service worker to begin the next stage of the payment process.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="/nv3vTqZSnsdOvGjTgQh6Vi4xLcssKTMIVyPYR3kDQw=" data-language="js"><span class="token keyword">let</span> payment_request_event<span class="token punctuation">;</span>
<span class="token keyword">let</span> resolver<span class="token punctuation">;</span>
<span class="token keyword">let</span> client<span class="token punctuation">;</span>

<span class="token comment">// `self` is the global object in service worker</span>
self<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">"paymentrequest"</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>payment_request_event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// If there's an ongoing payment transaction, reject it.</span>
    resolver<span class="token punctuation">.</span><span class="token function">reject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// Preserve the event for future use</span>
  payment_request_event <span class="token operator">=</span> e<span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre>
</div> <p>When a <code>paymentrequest</code> event is received, the payment app can open a payment handler window by calling <a href="../paymentrequestevent/openwindow.html"><code>PaymentRequestEvent.openWindow()</code></a>. The payment handler window will present the customers with a payment app interface where they can authenticate, choose shipping address and options, and authorize the payment.</p> <p>When the payment has been handled, <a href="../paymentrequestevent/respondwith.html"><code>PaymentRequestEvent.respondWith()</code></a> is used to pass the payment result back to the merchant website.</p> <p>See <a href="https://web.dev/orchestrating-payment-transactions/#receive-payment-request-event" target="_blank">Receive a payment request event from the merchant</a> for more details of this stage.</p>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://w3c.github.io/payment-handler/#the-paymentrequestevent">Payment Handler API <br><small># the-paymentrequestevent</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody><tr>
<th><code>paymentrequest_event</code></th>
<td class="bc-supports-yes">70</td>
<td class="bc-supports-yes">79</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">57</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">70</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">49</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes">10.0</td>
</tr></tbody>
</table></div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../payment_handler_api.html">Payment Handler API</a></li> <li><a href="https://web.dev/web-based-payment-apps-overview/" target="_blank">Web-based payment apps overview</a></li> <li><a href="https://web.dev/setting-up-a-payment-method/" target="_blank">Setting up a payment method</a></li> <li><a href="https://web.dev/life-of-a-payment-transaction/" target="_blank">Life of a payment transaction</a></li> <li><a href="../payment_request_api/using_the_payment_request_api.html">Using the Payment Request API</a></li> <li><a href="../payment_request_api/concepts.html">Payment processing concepts</a></li> </ul></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/paymentrequest_event" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/ServiceWorkerGlobalScope/paymentrequest_event</a>
  </p>
</div>
