<header><h1>GPUComputePassEncoder: dispatchWorkgroups() method</h1></header><div class="section-content">
<div class="notecard experimental" id="sect1"><p><strong>Experimental:</strong> <strong>This is an <a href="https://developer.mozilla.org/en-US/docs/MDN/Writing_guidelines/Experimental_deprecated_obsolete#experimental">experimental technology</a></strong><br>Check the <a href="#browser_compatibility">Browser compatibility table</a> carefully before using this in production.</p></div> <p> The <code>dispatchWorkgroups()</code> method of the <a href="../gpucomputepassencoder.html"><code>GPUComputePassEncoder</code></a> interface dispatches a specific grid of workgroups to perform the work being done by the current <a href="../gpucomputepipeline.html"><code>GPUComputePipeline</code></a> (i.e. set via <a href="setpipeline.html"><code>GPUComputePassEncoder.setPipeline()</code></a>). </p>
</div>
<h2 id="syntax">Syntax</h2>
<div class="section-content"><div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="/gl21+os3m1MNVuZztyjTnanYjASwF+qhkBPgZEZIdo=" data-language="js"><span class="token function">dispatchWorkgroups</span><span class="token punctuation">(</span>workgroupCountX<span class="token punctuation">)</span>
<span class="token function">dispatchWorkgroups</span><span class="token punctuation">(</span>workgroupCountX<span class="token punctuation">,</span> workgroupCountY<span class="token punctuation">)</span>
<span class="token function">dispatchWorkgroups</span><span class="token punctuation">(</span>workgroupCountX<span class="token punctuation">,</span> workgroupCountY<span class="token punctuation">,</span> workgroupCountZ<span class="token punctuation">)</span>
</pre>
</div></div>
<h3 id="parameters">Parameters</h3>
<div class="section-content">
<dl> <dt id="workgroupcountx"><a href="#workgroupcountx"><code>workgroupCountX</code></a></dt> <dd> <p>The X dimension of the grid of workgroups to dispatch.</p> </dd> <dt id="workgroupcounty">
<a href="#workgroupcounty"><code>workgroupCountY</code></a> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>The Y dimension of the grid of workgroups to dispatch. If omitted, <code>workgroupCountY</code> defaults to 1.</p> </dd> <dt id="workgroupcountz">
<a href="#workgroupcountz"><code>workgroupCountZ</code></a> <span class="badge inline optional">Optional</span>
</dt> <dd> <p>The Z dimension of the grid of workgroups to dispatch. If omitted, <code>workgroupCountZ</code> defaults to 1.</p> </dd> </dl> <div class="notecard note" id="sect2"> <p><strong>Note:</strong> The X, Y, and Z dimension values passed to <code>dispatchWorkgroups()</code> and <a href="dispatchworkgroupsindirect.html"><code>GPUComputePassEncoder.dispatchWorkgroupsIndirect()</code></a> are the number of workgroups to dispatch for each dimension, not the number of shader invocations to perform across each dimension. This matches the behavior of modern native GPU APIs, but differs from the behavior of OpenCL. This means that if a <a href="../gpushadermodule.html"><code>GPUShaderModule</code></a> defines an entry point with <code>@workgroup_size(4, 4)</code>, and work is dispatched to it with the call <code>passEncoder.dispatchWorkgroups(8, 8);</code>, the entry point will be invoked 1024 times total â€” Dispatching a 4 x 4 workgroup 8 times along both the X and Y axes. <code>4 * 4 * 8 * 8 = 1024</code>.</p> </div>
</div>
<h3 id="return_value">Return value</h3>
<div class="section-content"><p>None (<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined"><code>Undefined</code></a>).</p></div>
<h3 id="validation">Validation</h3>
<div class="section-content">
<p>The following criteria must be met when calling <code>dispatchWorkgroups()</code>, otherwise a <a href="../gpuvalidationerror.html"><code>GPUValidationError</code></a> is generated and the <a href="../gpucomputepassencoder.html"><code>GPUComputePassEncoder</code></a> becomes invalid:</p> <ul> <li>
<code>workgroupCountX</code>, <code>workgroupCountY</code>, and <code>workgroupCountZ</code> are all less than or equal to the <a href="../gpudevice.html"><code>GPUDevice</code></a>'s <code>maxComputeWorkgroupsPerDimension</code> <a href="../gpusupportedlimits.html">limit</a>.</li> </ul>
</div>
<h2 id="examples">Examples</h2>
<div class="section-content">
<p>In our <a href="https://mdn.github.io/dom-examples/webgpu-compute-demo/" target="_blank">basic compute demo</a>, several commands are recorded via a <a href="../gpucommandencoder.html"><code>GPUCommandEncoder</code></a>. Most of these commands originate from the <a href="../gpucomputepassencoder.html"><code>GPUComputePassEncoder</code></a> created via <code>beginComputePass()</code>.</p> <p>At the start of the code, we set a global buffer size of 1000. Also, note that the workgroup size in the shader is set to 64.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="l9wrLVgdIXxianU8vMRxbGQt+kVSoaPdACNfFP0iieo=" data-language="js"><span class="token keyword">const</span> <span class="token constant">BUFFER_SIZE</span> <span class="token operator">=</span> <span class="token number">1000</span><span class="token punctuation">;</span>

<span class="token comment">// Compute shader</span>
<span class="token keyword">const</span> shader <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
@group(0) @binding(0)
var&lt;storage, read_write&gt; output: array&lt;f32&gt;;

@compute @workgroup_size(64)

...

</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
</pre>
</div> <p>Later in the code, the <code>dispatchWorkgroups()</code> <code>workgroupCountX</code> parameter is set based on the global buffer size and the shader workgroup count.</p> <div class="code-example">
<p class="example-header"><span class="language-name">js</span></p>
<pre data-signature="IuOCM/NBBfIJvjABvFHbgF0ODrXqXkamCRsdIW6N1e4=" data-language="js"><span class="token comment">// ...</span>

<span class="token comment">// Create GPUCommandEncoder to encode commands to issue to the GPU</span>
<span class="token keyword">const</span> commandEncoder <span class="token operator">=</span> device<span class="token punctuation">.</span><span class="token function">createCommandEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Initiate render pass</span>
<span class="token keyword">const</span> passEncoder <span class="token operator">=</span> commandEncoder<span class="token punctuation">.</span><span class="token function">beginComputePass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Issue commands</span>
passEncoder<span class="token punctuation">.</span><span class="token function">setPipeline</span><span class="token punctuation">(</span>computePipeline<span class="token punctuation">)</span><span class="token punctuation">;</span>
passEncoder<span class="token punctuation">.</span><span class="token function">setBindGroup</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> bindGroup<span class="token punctuation">)</span><span class="token punctuation">;</span>
passEncoder<span class="token punctuation">.</span><span class="token function">dispatchWorkgroups</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span><span class="token constant">BUFFER_SIZE</span> <span class="token operator">/</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// End the render pass</span>
passEncoder<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Copy output buffer to staging buffer</span>
commandEncoder<span class="token punctuation">.</span><span class="token function">copyBufferToBuffer</span><span class="token punctuation">(</span>
  output<span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// Source offset</span>
  stagingBuffer<span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// Destination offset</span>
  <span class="token constant">BUFFER_SIZE</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// End frame by passing array of command buffers to command queue for execution</span>
device<span class="token punctuation">.</span>queue<span class="token punctuation">.</span><span class="token function">submit</span><span class="token punctuation">(</span><span class="token punctuation">[</span>commandEncoder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...</span>
</pre>
</div>
</div>
<h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://gpuweb.github.io/gpuweb/#dom-gpucomputepassencoder-dispatchworkgroups">WebGPU <br><small># dom-gpucomputepassencoder-dispatchworkgroups</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<div class="_table"><table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody><tr>
<th><code>dispatchWorkgroups</code></th>
<td class="bc-supports-yes"><details><summary>113</summary>Currently supported on ChromeOS, macOS, and Windows only.</details></td>
<td class="bc-supports-yes"><details><summary>113</summary>Currently supported on ChromeOS, macOS, and Windows only.</details></td>
<td class="bc-supports-yes"><details><summary>preview</summary>Currently supported on Linux and Windows only.</details></td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-yes"><details><summary>99</summary>Currently supported on ChromeOS, macOS, and Windows only.</details></td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
<td class="bc-supports-no">No</td>
</tr></tbody>
</table></div>
<h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li>The <a href="../webgpu_api.html">WebGPU API</a>
</li> </ul></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/API/GPUComputePassEncoder/dispatchWorkgroups" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/API/GPUComputePassEncoder/dispatchWorkgroups</a>
  </p>
</div>
