<h1 id="node-api" tabindex="-1">Node API </h1>
<div class="warning custom-block">
<strong class="custom-block-title">WARNING</strong><p>Vitest exposes experimental private API. Breaking changes might not follow SemVer, please pin Vitest's version when using it.</p>
</div>
<h2 id="startvitest" tabindex="-1">startVitest </h2>
<p>You can start running Vitest tests using its Node API:</p>
<div class="language-js vp-adaptive-theme">
<span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-language="javascript">import { startVitest } from 'vitest/node'

const vitest = await startVitest('test')

await vitest?.close()</pre>
</div>
<p><code>startVitest</code> function returns <code>Vitest</code> instance if tests can be started. It returns <code>undefined</code>, if one of the following occurs:</p>
<ul>
<li>Vitest didn't find the <code>vite</code> package (usually installed with Vitest)</li>
<li>If coverage is enabled and run mode is "test", but the coverage package is not installed (<code>@vitest/coverage-v8</code> or <code>@vitest/coverage-istanbul</code>)</li>
<li>If the environment package is not installed (<code>jsdom</code>/<code>happy-dom</code>/<code>@edge-runtime/vm</code>)</li>
</ul>
<p>If <code>undefined</code> is returned or tests failed during the run, Vitest sets <code>process.exitCode</code> to <code>1</code>.</p>
<p>If watch mode is not enabled, Vitest will call <code>close</code> method.</p>
<p>If watch mode is enabled and the terminal supports TTY, Vitest will register console shortcuts.</p>
<p>You can pass down a list of filters as a second argument. Vitest will run only tests that contain at least one of the passed-down strings in their file path.</p>
<p>Additionally, you can use the third argument to pass in CLI arguments, which will override any test config options.</p>
<p>Alternatively, you can pass in the complete Vite config as the fourth argument, which will take precedence over any other user-defined options.</p>
<h2 id="createvitest" tabindex="-1">createVitest </h2>
<p>You can create Vitest instance yourself using <code>createVitest</code> function. It returns the same <code>Vitest</code> instance as <code>startVitest</code>, but it doesn't start tests and doesn't validate installed packages.</p>
<div class="language-js vp-adaptive-theme">
<span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-language="javascript">import { createVitest } from 'vitest/node'

const vitest = await createVitest('test', {
  watch: false,
})</pre>
</div>
<h2 id="vitest" tabindex="-1">Vitest </h2>
<p>Vitest instance requires the current test mode. It can be either:</p>
<ul>
<li>
<code>test</code> when running runtime tests</li>
<li>
<code>benchmark</code> when running benchmarks</li>
</ul>
<h3 id="mode" tabindex="-1">mode </h3>
<h4 id="test" tabindex="-1">test </h4>
<p>Test mode will only call functions inside <code>test</code> or <code>it</code>, and throws an error when <code>bench</code> is encountered. This mode uses <code>include</code> and <code>exclude</code> options in the config to find test files.</p>
<h4 id="benchmark" tabindex="-1">benchmark </h4>
<p>Benchmark mode calls <code>bench</code> functions and throws an error, when it encounters <code>test</code> or <code>it</code>. This mode uses <code>benchmark.include</code> and <code>benchmark.exclude</code> options in the config to find benchmark files.</p>
<h3 id="start" tabindex="-1">start </h3>
<p>You can start running tests or benchmarks with <code>start</code> method. You can pass an array of strings to filter test files.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021-Present Anthony Fu<br>&copy; 2021-Present Matias Capeletto<br>Licensed under the MIT License.<br>
    <a href="https://vitest.dev/advanced/api" class="_attribution-link">https://vitest.dev/advanced/api</a>
  </p>
</div>
