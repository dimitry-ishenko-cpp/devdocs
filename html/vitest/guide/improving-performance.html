<h1 id="improving-performance" tabindex="-1">Improving Performance </h1>
<p>By default Vitest runs every test file in an isolated environment based on the <a href="../config/index.html#pool">pool</a>:</p>
<ul>
<li>
<code>threads</code> pool runs every test file in a separate <a href="https://nodejs.org/api/worker_threads.html#class-worker" target="_blank" rel="noreferrer"><code>Worker</code></a>
</li>
<li>
<code>forks</code> pool runs every test file in a separate <a href="https://nodejs.org/api/child_process.html#child_processforkmodulepath-args-options" target="_blank" rel="noreferrer">forked child process</a>
</li>
<li>
<code>vmThreads</code> pool runs every test file in a separate <a href="https://nodejs.org/api/vm.html#vmcreatecontextcontextobject-options" target="_blank" rel="noreferrer">VM context</a>, but it uses workers for parallelism</li>
</ul>
<p>This greatly increases test times, which might not be desirable for projects that don't rely on side effects and properly cleanup their state (which is usually true for projects with <code>node</code> environment). In this case disabling isolation will improve the speed of your tests. To do that, you can provide <code>--no-isolate</code> flag to the CLI or set <a href="../config/index.html#isolate"><code>test.isolate</code></a> property in the config to <code>false</code>. If you are using several pools at once with <code>poolMatchGlobs</code>, you can also disable isolation for a specific pool you are using.</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group---Hwt" id="tab-Sb8CqKf" checked><label for="tab-Sb8CqKf">CLI</label><input type="radio" name="group---Hwt" id="tab--npMXLN"><label for="tab--npMXLN">vitest.config.js</label>
</div>
<div class="blocks">
<div class="language-bash vp-adaptive-theme active">
<span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-language="javascript">vitest --no-isolate</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    isolate: false,
    // you can also disable isolation only for specific pools
    poolOptions: {
      forks: {
        isolate: false,
      },
    },
  },
})</pre>
</div>
</div>
</div>
<div class="tip custom-block">
<strong class="custom-block-title">TIP</strong><p>If you are using <code>vmThreads</code> pool, you cannot disable isolation. Use <code>threads</code> pool instead to improve your tests performance.</p>
</div>
<p>For some projects, it might also be desirable to disable parallelism to improve startup time. To do that, provide <code>--no-file-parallelism</code> flag to the CLI or set <a href="../config/index.html#fileParallelism"><code>test.fileParallelism</code></a> property in the config to <code>false</code>.</p>
<div class="vp-code-group vp-adaptive-theme">
<div class="tabs">
<input type="radio" name="group-GX6ky" id="tab-XDga7wJ" checked><label for="tab-XDga7wJ">CLI</label><input type="radio" name="group-GX6ky" id="tab-JCY4S-_"><label for="tab-JCY4S-_">vitest.config.js</label>
</div>
<div class="blocks">
<div class="language-bash vp-adaptive-theme active">
<span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-language="javascript">vitest --no-file-parallelism</pre>
</div>
<div class="language-ts vp-adaptive-theme">
<span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" data-language="javascript">import { defineConfig } from 'vitest/config'

export default defineConfig({
  test: {
    fileParallelism: false,
  },
})</pre>
</div>
</div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021-Present Anthony Fu<br>&copy; 2021-Present Matias Capeletto<br>Licensed under the MIT License.<br>
    <a href="https://vitest.dev/guide/improving-performance" class="_attribution-link">https://vitest.dev/guide/improving-performance</a>
  </p>
</div>
