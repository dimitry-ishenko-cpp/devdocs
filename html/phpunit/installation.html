<h1>Installation</h1> <p>PHP is a general-purpose programming language. While it originally only supported the paradigm of procedural programming, most PHP code that is written today leverages the language’s capabilities for object-oriented programming. As it is especially suited for web development, you probably made your first contact with PHP in an environment where PHP code is executed on a web server.</p> <p>PHPUnit provides a framework for writing tests as well as a command-line tool for running these tests. Before we discuss obtaining and using PHPUnit, let us have a look at installing and configuring the PHP command-line interpreter.</p> <p>PHPUnit 11 requires PHP 8.2; using the latest version of PHP is highly recommended.</p> <section id="php-on-the-command-line"> <h2>PHP on the Command-Line<a class="headerlink" href="#php-on-the-command-line" title="Permalink to this heading"></a>
</h2> <p>We start by installing PHP’s command-line interpreter as well as the PHP extensions required to use PHPUnit.</p> <section id="installing-the-php-command-line-interpreter"> <h3>Installing the PHP Command-Line Interpreter<a class="headerlink" href="#installing-the-php-command-line-interpreter" title="Permalink to this heading"></a>
</h3> <section id="fedora"> <h4>Fedora<a class="headerlink" href="#fedora" title="Permalink to this heading"></a>
</h4> <p>At the time of writing, Fedora 40 is the current version of this Linux distribution. It ships with PHP 8.3 by default. Here is how you install PHP’s command-line interpreter together with the extensions required for PHPUnit:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">sudo dnf install php-cli \
                 php-json \
                 php-mbstring \
                 php-process \
                 php-xml \
                 php-pecl-pcov \
                 php-pecl-xdebug
</pre></div> </div> <p>If you use an older version of Fedora then you should have a look at the <a class="reference external" href="https://rpms.remirepo.net/">package repository maintained by Remi Collet</a>.</p> </section> <section id="debian"> <h4>Debian<a class="headerlink" href="#debian" title="Permalink to this heading"></a>
</h4> <p>At the time of writing, Debian 12 is the current version of this Linux distribution. It ships with PHP 8.2 by default. Here is how you install PHP’s command-line interpreter together with the extensions required for PHPUnit:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">sudo apt install php-cli \
                 php-json \
                 php-mbstring \
                 php-xml \
                 php-pcov \
                 php-xdebug
</pre></div> </div> <p>If you use an older version of Debian then you should have a look at the <a class="reference external" href="https://deb.sury.org/">package repository</a> maintained by Ondřej Surý.</p> </section> <section id="ubuntu"> <h4>Ubuntu<a class="headerlink" href="#ubuntu" title="Permalink to this heading"></a>
</h4> <p>At the time of writing, Ubuntu 24.04 is the current version of this Linux distribution. It ships with PHP 8.3 by default. Here is how you install PHP’s command-line interpreter together with the extensions required for PHPUnit:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">sudo apt install php-cli \
                 php-json \
                 php-mbstring \
                 php-xml \
                 php-pcov \
                 php-xdebug
</pre></div> </div> <p>If you use an older version of Ubuntu then you should have a look at the <a class="reference external" href="https://deb.sury.org/">package repository</a> maintained by Ondřej Surý.</p> </section> <section id="macos"> <h4>macOS<a class="headerlink" href="#macos" title="Permalink to this heading"></a>
</h4> <p>The most common way to install PHP on macOS is using <a class="reference external" href="https://brew.sh/">Homebrew</a>. The instructions given below assume that you have Homebrew already set up.</p> <p>We will use the <a class="reference external" href="https://github.com/shivammathur/homebrew-php">homebrew-php formulae maintained by Shivam Mathur</a>. The following command will fetch these formulae:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">brew tap shivammathur/php
</pre></div> </div> <p>The following command will install PHP 8.2:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">brew install shivammathur/php/php@8.2
</pre></div> </div> <p>The following extensions required by PHPUnit are already installed and enabled by default:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">dom</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">json</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">libxml</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">mbstring</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">xml</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">xmlwriter</span></code></p></li> </ul> <p>If you want to collect code coverage information, you need to additionally install and enable one of the following extensions:</p> <ul class="simple"> <li><p><code class="docutils literal notranslate"><span class="pre">pcov</span></code></p></li> <li><p><code class="docutils literal notranslate"><span class="pre">xdebug</span></code></p></li> </ul> <p>The following command will install and enable the <code class="docutils literal notranslate"><span class="pre">pcov</span></code> extension:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">brew install pcov@8.2
</pre></div> </div> <p>The following command will install and enable the <code class="docutils literal notranslate"><span class="pre">xdebug</span></code> extension:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">brew install xdebug@8.2
</pre></div> </div> </section> <section id="windows"> <h4>Windows<a class="headerlink" href="#windows" title="Permalink to this heading"></a>
</h4> <section id="native-binaries"> <h5>Native Binaries<a class="headerlink" href="#native-binaries" title="Permalink to this heading"></a>
</h5> <p>The PHP Project provides native binaries for Windows at <a class="reference external" href="https://windows.php.net/">windows.php.net</a>. Choose the appropriate binary package for your architecture (32-bit or 64-bit) and version of Windows and follow the installation instructions given on this website.</p> <p>Enable the <code class="docutils literal notranslate"><span class="pre">mbstring</span></code> extension by adding <code class="docutils literal notranslate"><span class="pre">extension=mbstring</span></code> to the <code class="docutils literal notranslate"><span class="pre">php.ini</span></code> configuration file used by the PHP command-line interpreter.</p> </section> <section id="windows-subsystem-for-linux"> <h5>Windows Subsystem for Linux<a class="headerlink" href="#windows-subsystem-for-linux" title="Permalink to this heading"></a>
</h5> <p>The Windows Subsystem for Linux allows Linux binary executables (in ELF format) to be run on Windows 10 (or later).</p> <p>Update to the latest version of Windows, install the latest version of Windows Subsystem for Linux, and install the Linux distribution of your choice from the Microsoft Store.</p> <p>Then follow the installation instructions in this chapter for the Linux distribution you chose.</p> </section> </section> </section> <section id="using-the-php-command-line-interpreter"> <h3>Using the PHP Command-Line Interpreter<a class="headerlink" href="#using-the-php-command-line-interpreter" title="Permalink to this heading"></a>
</h3> <p>Now we have the PHP command-line interpreter set up, and it is time to learn how to use it.</p> <p>With <code class="docutils literal notranslate"><span class="pre">php</span> <span class="pre">--version</span></code> we can verify that the PHP command-line interpreter, <code class="docutils literal notranslate"><span class="pre">php</span></code>, is on the path, works, and check which version it is.</p> </section> <section id="configuring-php-for-development"> <h3>Configuring PHP for Development<a class="headerlink" href="#configuring-php-for-development" title="Permalink to this heading"></a>
</h3> <p>In this section we ensure that the PHP command-line interpreter is configured in such a way that we can properly use PHPUnit.</p> <p>The configuration directives shown below should be added to your PHP configuration file. Using <code class="docutils literal notranslate"><span class="pre">php</span> <span class="pre">--ini</span></code> we can ask the PHP command-line interpreter for the configuration file, or files, that is (are) being used.</p> <p>We want to see all PHP errors, warnings, notices, etc. when we run our tests. The value used with <code class="docutils literal notranslate"><span class="pre">error_reporting</span></code> is a bitmask that can be used to toggle the reporting of the various types of errors supported by PHP. Setting this to <code class="docutils literal notranslate"><span class="pre">-1</span></code> ensures that we always see all errors:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">error_reporting=-1
</pre></div> </div> <p>When Xdebug is loaded, we do not want it to print its exception traces while our tests are being executed:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">xdebug.show_exception_trace=0
</pre></div> </div> <p>This is how you enable Xdebug’s code coverage functionality:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">xdebug.mode=coverage
</pre></div> </div> <p>Please note that the <code class="docutils literal notranslate"><span class="pre">xdebug.mode</span></code> configuration directive takes a comma-separated list of modes. <code class="docutils literal notranslate"><span class="pre">coverage</span></code> must be one of these modes for code coverage to work.</p> <p>When the code we test contains <code class="docutils literal notranslate"><span class="pre">assert()</span></code> statements then we want them to be evaluated and to raise exceptions:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">zend.assertions=1
assert.exception=1
</pre></div> </div> <p>The collection of code coverage data and the generation of a code coverage report sometimes requires more memory than PHP is allowed to use by default:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">memory_limit=-1
</pre></div> </div> <p>It is recommended to only load Xdebug when it is needed, for instance when you want to use it for debugging or to collect code coverage data.</p> <p>When it comes to collecting code coverage data and when you are interested only in line coverage, the <a class="reference external" href="https://github.com/krakjoe/pcov">PCOV</a> extension is recommended over Xdebug for performance reasons.</p> <p>Do not worry if terms such as “code coverage” or “line coverage” do not mean anything to you just yet. We will cover them in great detail later.</p> </section> </section> <section id="installing-phpunit"> <h2>Installing PHPUnit<a class="headerlink" href="#installing-phpunit" title="Permalink to this heading"></a>
</h2> <section id="php-archive-phar"> <h3>PHP Archive (PHAR)<a class="headerlink" href="#php-archive-phar" title="Permalink to this heading"></a>
</h3> <p>The recommended way to install and use PHPUnit is to download a distribution that is packaged as a PHP Archive (PHAR). Releases of PHPUnit packaged as PHP archives are available on <code class="docutils literal notranslate"><span class="pre">https://phar.phpunit.de/</span></code>.</p> <p>At <code class="docutils literal notranslate"><span class="pre">https://phar.phpunit.de/phpunit-10.phar</span></code>, for instance, you will always find the latest version of PHPUnit 10. At <code class="docutils literal notranslate"><span class="pre">https://phar.phpunit.de/phpunit-10.0.0.phar</span></code>, for instance, you will always find that specific version of PHPUnit. At <code class="docutils literal notranslate"><span class="pre">https://phar.phpunit.de/phpunit-snapshot.phar</span></code> you will always find the latest development snapshot of PHPUnit.</p> <p>Such a PHP archive has all required (as well as some optional) dependencies of PHPUnit bundled in a single file. The PHAR (<code class="docutils literal notranslate"><span class="pre">ext/phar</span></code>) extension is required if you want to use PHPUnit from a PHP archive.</p> <section id="manual-download-of-phar"> <h4>Manual Download of PHAR<a class="headerlink" href="#manual-download-of-phar" title="Permalink to this heading"></a>
</h4> <p>You can simply download a release of PHPUnit packaged as a PHP archive and immediately use it:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">wget -O phpunit.phar https://phar.phpunit.de/phpunit-10.phar
</pre></div> </div> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">php phpunit.phar --version
PHPUnit 10.0.0 by Sebastian Bergmann and contributors.
</pre></div> </div> <p>It is a common practice to make the PHAR executable:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">chmod +x phpunit.phar
</pre></div> </div> <p>Now you can directly run the PHAR:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">./phpunit.phar --version
PHPUnit 10.0.0 by Sebastian Bergmann and contributors.
</pre></div> </div> <p>All official releases distributed by the PHPUnit Project are signed by the release manager for the release. PGP signatures and SHA256 hashes are available for verification on <code class="docutils literal notranslate"><span class="pre">https://phar.phpunit.de/</span></code>.</p> <p>Here is an example of how you can manually verify a PHP archive of a PHPUnit release using its PGP signature:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">wget -O phpunit.phar https://phar.phpunit.de/phpunit-10.phar
wget -O phpunit.phar.asc https://phar.phpunit.de/phpunit-10.phar.asc
gpg --keyserver pgp.uni-mainz.de --recv-keys 0x4AA394086372C20A
gpg phpunit.phar.asc
</pre></div> </div> <p>It is a common practice to use different versions of PHPUnit on a per-project basis. This is achieved by putting a PHP archive of PHPUnit into your project directory. A typical directory structure for a PHP project looks like this:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">├── public
├── src
├── tests
└── tools
</pre></div> </div> <p>The <code class="docutils literal notranslate"><span class="pre">public</span></code> directory contains the application’s static assets (CSS, JavaScript, images, …); it is the webserver’s document root.</p> <p>The <code class="docutils literal notranslate"><span class="pre">src</span></code> directory contains the application’s PHP source code. The <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory contains the application’s test suite.</p> <p>The <code class="docutils literal notranslate"><span class="pre">tools</span></code> directory contains tools such as PHPUnit packaged as PHP archives.</p> <p>You can download PHPUnit’s PHP archive to that <code class="docutils literal notranslate"><span class="pre">tools</span></code> directory manually, of course:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">wget -O phpunit.phar https://phar.phpunit.de/phpunit-10.phar
chmod +x phpunit.phar
mv phpunit.phar tools
</pre></div> </div> </section> <section id="installing-phpunit-with-phive"> <h4>Installing PHPUnit with Phive<a class="headerlink" href="#installing-phpunit-with-phive" title="Permalink to this heading"></a>
</h4> <p>You can use <a class="reference external" href="https://phar.io/">Phive</a>, the <em>PHAR Installation and Verification Environment</em>, to manage the PHAR-based tools of your PHP project.</p> <p>This is how you install Phive:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">wget https://phar.io/releases/phive.phar
wget https://phar.io/releases/phive.phar.asc
gpg --keyserver hkps.pool.sks-keyservers.net --recv-keys 0x9B2D5D79
gpg --verify phive.phar.asc phive.phar
chmod +x phive.phar
mv phive.phar /usr/local/bin/phive
</pre></div> </div> <p>Once Phive is installed, PHPUnit can be installed like so:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">phive install phpunit
</pre></div> </div> <p>After executing the command shown above the project’s directory will look like this:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">├── .phive
|   └── phars.xml
├── public
├── src
├── tests
└── tools
    └── phpunit -&gt; ~/.phive/phars/phpunit-10.0.0.phar
</pre></div> </div> <p>Phive has downloaded the PHP archive for PHPUnit 10.0.0, placed it in a cache located in your home directory, and created a symbolic link from there to <code class="docutils literal notranslate"><span class="pre">tools/phpunit</span></code>.</p> <p>You can now invoke the project-local installation of PHPUnit by running <code class="docutils literal notranslate"><span class="pre">./tools/phpunit</span></code>:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">./tools/phpunit --version
PHPUnit 10.0.0 by Sebastian Bergmann and contributors.
</pre></div> </div> <p>The <code class="docutils literal notranslate"><span class="pre">.phive/phars.xml</span></code> file that was generated in your project’s root directory contains metadata about your project’s tool dependencies:</p> <div class="highlight-xml notranslate">
<div class="highlight"><pre class="highlight" data-language="php"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;phive</span><span class="na">xmlns=</span><span class="s">"https://phar.io/phive"</span><span class="nt">&gt;</span>
<span class="nt">&lt;phar</span><span class="na">name=</span><span class="s">"phpunit"</span>
<span class="na">version=</span><span class="s">"^10.0"</span><span class="na">installed=</span><span class="s">"10.0.0"</span>
<span class="na">location=</span><span class="s">"./tools/phpunit"</span><span class="na">copy=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/phive&gt;</span>
</pre></div> </div> <p><code class="docutils literal notranslate"><span class="pre">.phive/phars.xml</span></code> should be put under version control.</p> <p>The <code class="docutils literal notranslate"><span class="pre">^10.0</span></code> is a semantic version constraint: Phive will always install the latest version of PHPUnit that is compatible with PHPUnit 10.0.</p> <p>Phive does not only provide a convenient way for installing, managing, and updating tools that are distributed as a PHP archive. Phive also keeps you safe by automatically verifying the PGP signatures while downloading the PHAR files.</p> <p>If you want to keep PHPUnit’s PHP archive under version control, then you should use Phive’s <code class="docutils literal notranslate"><span class="pre">--copy</span></code> option to copy the PHP archive from its cache located in your home directory into your project’s tools directory:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">phive install --copy phpunit
</pre></div> </div> <p>After executing the command shown above the project’s directory will look like this:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">├── .phive
|   └── phars.xml
├── public
├── src
├── tests
└── tools
    └── phpunit
</pre></div> </div> <div class="admonition-note admonition"> <p class="admonition-title">Note</p> <p>Unfortunately, PhpStorm only recognizes a file as a PHP archive when it has the <code class="docutils literal notranslate"><span class="pre">.phar</span></code> suffix. This is remedied by creating a symbolic link: <code class="docutils literal notranslate"><span class="pre">ln</span> <span class="pre">-s</span> <span class="pre">phpunit</span> <span class="pre">tools/phpunit.phar</span></code>.</p> </div> </section> <section id="updating-phpunit-with-phive"> <h4>Updating PHPUnit with Phive<a class="headerlink" href="#updating-phpunit-with-phive" title="Permalink to this heading"></a>
</h4> <p><code class="docutils literal notranslate"><span class="pre">phive</span> <span class="pre">install</span> <span class="pre">phpunit</span></code> adds a dependency on PHPUnit with a version constraint that uses the caret operator (<code class="docutils literal notranslate"><span class="pre">^</span></code>) for semantic versioning: <code class="docutils literal notranslate"><span class="pre">version="^10.0"</span></code>.</p> <p>With this configuration, Phive will always install the latest version of PHPUnit that is compatible with PHPUnit 10.0.</p> <p>This ensures you “stay fresh” as long as PHPUnit 10 is the current stable version of PHPUnit and includes new minor versions such as PHPUnit 10.1. And when the time comes and PHPUnit 11 is released then Phive will not automatically and unexpectedly install it.</p> <section id="updating-to-a-new-minor-or-patch-version"> <h5>Updating to a new minor or patch version<a class="headerlink" href="#updating-to-a-new-minor-or-patch-version" title="Permalink to this heading"></a>
</h5> <p>Consider the following situation: you use the semantic version constraint <code class="docutils literal notranslate"><span class="pre">^9.6</span></code> for PHPUnit in your <code class="docutils literal notranslate"><span class="pre">.phive/phars.xml</span></code> file and have PHPUnit 9.6.0 installed. Here is what your <code class="docutils literal notranslate"><span class="pre">.phive/phars.xml</span></code> file currently looks like:</p> <div class="highlight-xml notranslate">
<div class="highlight"><pre class="highlight" data-language="php"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;phive</span><span class="na">xmlns=</span><span class="s">"https://phar.io/phive"</span><span class="nt">&gt;</span>
<span class="nt">&lt;phar</span><span class="na">name=</span><span class="s">"phpunit"</span>
<span class="na">version=</span><span class="s">"^9.6"</span><span class="na">installed=</span><span class="s">"9.6.0"</span>
<span class="na">location=</span><span class="s">"./tools/phpunit"</span><span class="na">copy=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/phive&gt;</span>
</pre></div> </div> <p>Since you used <code class="docutils literal notranslate"><span class="pre">phive</span> <span class="pre">update</span></code> last, PHPUnit 9.6.3 became available. You can use the <code class="docutils literal notranslate"><span class="pre">phive</span> <span class="pre">outdated</span></code> command to check whether an update is available for any of your project’s PHP archives that are managed by Phive:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">phive outdated
Phive 0.15.2 - Copyright (C) 2015-2023 by Arne Blankerts, Sebastian Heuer and Contributors
Found 1 outdated PHARs in phive.xml:

Name       Version Constraint    Installed    Available

phpunit    ^9.6                  9.6.0        9.6.3
</pre></div> </div> <p>Because PHPUnit 9.6.3 is a new patch version (and not a new major version), <code class="docutils literal notranslate"><span class="pre">phive</span> <span class="pre">update</span></code> will update from PHPUnit 9.6.0 to PHPUnit 9.6.3.</p> </section> <section id="updating-to-a-new-major-version"> <h5>Updating to a new major version<a class="headerlink" href="#updating-to-a-new-major-version" title="Permalink to this heading"></a>
</h5> <p>Consider the following situation:</p> <div class="highlight-xml notranslate">
<div class="highlight"><pre class="highlight" data-language="php"><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;phive</span><span class="na">xmlns=</span><span class="s">"https://phar.io/phive"</span><span class="nt">&gt;</span>
<span class="nt">&lt;phar</span><span class="na">name=</span><span class="s">"phpunit"</span>
<span class="na">version=</span><span class="s">"^9.6"</span><span class="na">installed=</span><span class="s">"9.6.3"</span>
<span class="na">location=</span><span class="s">"./tools/phpunit"</span><span class="na">copy=</span><span class="s">"true"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/phive&gt;</span>
</pre></div> </div> <p>Now PHPUnit 10, a new major version, became available. However, running <code class="docutils literal notranslate"><span class="pre">phive</span> <span class="pre">outdated</span></code> does not offer us the update to PHPUnit 10:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">phive outdated
Phive 0.15.2 - Copyright (C) 2015-2023 by Arne Blankerts, Sebastian Heuer and Contributors
Congrats, no outdated phars found
</pre></div> </div> <div class="admonition-note admonition"> <p class="admonition-title">Note</p> <p>Unfortunately, the output of <code class="docutils literal notranslate"><span class="pre">phive</span> <span class="pre">outdated</span></code> is confusing when no new minor or patch versions are available, but a new major version is available.</p> </div> <p>This is because PHPUnit 10 is a new major version and updates to a new major version should be an explicit operation following a conscious decision.</p> <p>If you use semantic version constraints in your <code class="docutils literal notranslate"><span class="pre">.phive/phars.xml</span></code> file (<a class="reference external" href="https://thephp.cc/articles/the-death-star-version-constraint?ref=phpunit">and you should!</a>) then you have to use the <code class="docutils literal notranslate"><span class="pre">install</span></code> command and explicitly request the new major version to be installed:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">phive install phpunit@^10.0
Phive 0.15.2 - Copyright (C) 2015-2024 by Arne Blankerts, Sebastian Heuer and Contributors
Linking /home/sb/.phive/phars/phpunit-10.5.15.phar to /path/to/tools/phpunit
</pre></div> </div> </section> </section> <section id="what-is-inside-the-phar"> <h4>What is inside the PHAR?<a class="headerlink" href="#what-is-inside-the-phar" title="Permalink to this heading"></a>
</h4> <p>To avoid <a class="reference external" href="https://github.com/sebastianbergmann/phpunit/issues/2014">problems</a> that occur when the code under test shares dependencies with PHPUnit but requires different versions than the ones bundled in the PHAR, a couple of measures have been implemented.</p> <p>Most units of code bundled in PHPUnit’s PHAR distribution, including all dependencies such as vendor directories, are moved to a new and distinct namespace, for instance. Classes that are part of PHPUnit’s public API, for example <code class="docutils literal notranslate"><span class="pre">PHPUnit\Framework\TestCase</span></code>, are exempt from this.</p> <p>PHPUnit’s PHAR does not use dynamic autoloading to load the bundled units of code. Instead, all units of code bundled in the PHAR are loaded on startup.</p> <p>Here is an <a class="reference external" href="https://thephp.cc/articles/ready-or-not-here-it-comes?ref=phpunit">article</a> that explains these measures in more detail.</p> <p>Sometimes you need to know exactly which versions of PHPUnit’s dependencies are bundled in PHPUnit’s PHAR distribution, for example in the context of <a class="reference external" href="https://thephp.cc/presentations/the-php-stacks-supply-chain?ref=phpunit">software supply chain security</a>. For this purpose, PHPUnit’s PHAR distribution offers additional CLI options that the Composer-installed test runner does not have.</p> <p>When PHPUnit’s PHAR is invoked with the <code class="docutils literal notranslate"><span class="pre">--manifest</span></code> CLI option then it will print a plain-text manifest with information about the versions of PHPUnit’s dependencies that are bundled in the PHAR:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">php phpunit-10.5.1.phar --manifest
phpunit/phpunit: 10.5.1
myclabs/deep-copy: 1.11.1
nikic/php-parser: v4.17.1
phar-io/manifest: 2.0.3
phar-io/version: 3.2.1
phpunit/php-code-coverage: 10.1.9
phpunit/php-file-iterator: 4.1.0
phpunit/php-invoker: 4.0.0
phpunit/php-text-template: 3.0.1
phpunit/php-timer: 6.0.0
sebastian/cli-parser: 2.0.0
sebastian/code-unit: 2.0.0
sebastian/code-unit-reverse-lookup: 3.0.0
sebastian/comparator: 5.0.1
sebastian/complexity: 3.1.0
sebastian/diff: 5.0.3
sebastian/environment: 6.0.1
sebastian/exporter: 5.1.1
sebastian/global-state: 6.0.1
sebastian/lines-of-code: 2.0.1
sebastian/object-enumerator: 5.0.0
sebastian/object-reflector: 3.0.0
sebastian/recursion-context: 5.0.0
sebastian/type: 4.0.0
sebastian/version: 4.0.1
theseer/tokenizer: 1.2.2
</pre></div> </div> <p>When PHPUnit’s PHAR is invoked with the <code class="docutils literal notranslate"><span class="pre">--sbom</span></code> CLI option then it will print a Software Bill of Materials (SBOM) in XML format with information about the versions of PHPUnit’s dependencies that are bundled in the PHAR:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">php phpunit-10.5.1.phar --sbom
&lt;?xml version="1.0"?&gt;
&lt;bom xmlns="http://cyclonedx.org/schema/bom/1.4"&gt;
 &lt;components&gt;
  &lt;component type="library"&gt;
   &lt;group&gt;phpunit&lt;/group&gt;
   &lt;name&gt;phpunit&lt;/name&gt;
   &lt;version&gt;10.5.1&lt;/version&gt;
   &lt;description&gt;The PHP Unit Testing framework.&lt;/description&gt;
   &lt;licenses&gt;
    &lt;license&gt;
     &lt;id&gt;BSD-3-Clause&lt;/id&gt;
    &lt;/license&gt;
   &lt;/licenses&gt;
   &lt;purl&gt;pkg:composer/phpunit/phpunit@10.5.1&lt;/purl&gt;
  &lt;/component&gt;
  .
  .
  .
</pre></div> </div> <p>When PHPUnit’s PHAR is invoked with the <code class="docutils literal notranslate"><span class="pre">--composer-lock</span></code> CLI option then it will print the <code class="docutils literal notranslate"><span class="pre">composer.lock</span></code> file that was used to install PHPUnit’s dependencies during the build of the PHAR:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">php phpunit-10.5.1.phar --composer-lock
{
    "_readme": [
        "This file locks the dependencies of your project to a known state",
        "Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies",
        "This file is @generated automatically"
    ],
    "content-hash": "e06728e5442edec84af96f94a889b4a7",
    .
    .
    .
</pre></div> </div> </section> </section> <section id="composer"> <h3>Composer<a class="headerlink" href="#composer" title="Permalink to this heading"></a>
</h3> <p>Using a PHP Archive (PHAR) is the recommended way of installing PHPUnit, but it is not the only way.</p> <p>You can add PHPUnit as a development-time dependency to your project using <a class="reference external" href="https://getcomposer.org/">Composer</a>.</p> <section id="installing-phpunit-with-composer"> <h4>Installing PHPUnit with Composer<a class="headerlink" href="#installing-phpunit-with-composer" title="Permalink to this heading"></a>
</h4> <p>The command shown below assumes that you have previously installed Composer and that its <code class="docutils literal notranslate"><span class="pre">composer</span></code> executable is on your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>. The installation of Composer is explained on the tool’s website.</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">composer require --dev phpunit/phpunit
</pre></div> </div> <p>After executing the command shown above the project’s directory will look like this:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">├── composer.json
├── composer.lock
├── public
├── src
├── tests
└── vendor
</pre></div> </div> <p>The <code class="docutils literal notranslate"><span class="pre">composer.json</span></code> file contains metadata about the dependencies of your project, for instance. This file must be put under version control.</p> <p>The <code class="docutils literal notranslate"><span class="pre">composer.lock</span></code> file contains the list of the exact versions of the dependencies which were installed by Composer. While technically not required, it is considered a best practice to put this file under version control.</p> <p>The project-local installation of PHPUnit can be invoked like this:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">./vendor/bin/phpunit --version
PHPUnit 10.0.0 by Sebastian Bergmann and contributors.
</pre></div> </div> </section> <section id="updating-phpunit-with-composer"> <h4>Updating PHPUnit with Composer<a class="headerlink" href="#updating-phpunit-with-composer" title="Permalink to this heading"></a>
</h4> <p><code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">require</span> <span class="pre">--dev</span> <span class="pre">phpunit/phpunit</span></code> adds a development-time dependency on PHPUnit with a version constraint that uses the caret operator (<code class="docutils literal notranslate"><span class="pre">^</span></code>) for semantic versioning: <code class="docutils literal notranslate"><span class="pre">"phpunit/phpunit":</span> <span class="pre">"^10.0"</span></code>.</p> <p>With this configuration, Composer will always install the latest version of PHPUnit that is compatible with PHPUnit 10.0.</p> <p>This ensures you “stay fresh” as long as PHPUnit 10 is the current stable version of PHPUnit and includes new minor versions such as PHPUnit 10.1. And when the time comes and PHPUnit 11 is released then Composer will not automatically and unexpectedly install it.</p> <section id="id4"> <h5>Updating to a new minor or patch version<a class="headerlink" href="#id4" title="Permalink to this heading"></a>
</h5> <p>Consider the following situation:</p> <div class="highlight-json notranslate">
<div class="highlight"><pre class="highlight" data-language="php"><span class="p">{</span>
<span class="nt">"require-dev"</span><span class="p">:</span><span class="p">{</span>
<span class="nt">"phpunit/phpunit"</span><span class="p">:</span><span class="s2">"^9.6"</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div> </div> <p>Using the <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">outdated</span></code> command we can see that we have PHPUnit 9.6.0 in our project and that a new patch version is available:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">composer outdated --minor-only
Legend:
! patch or minor release available - update recommended
~ major release available - update possible

Direct dependencies required in composer.json:
phpunit/phpunit 9.6.0 ! 9.6.3 The PHP Unit Testing framework.
</pre></div> </div> <p>Because PHPUnit 9.6.3 is a new patch version, <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">update</span></code> will update from PHPUnit 9.6.0 to PHPUnit 9.6.3.</p> </section> <section id="id5"> <h5>Updating to a new major version<a class="headerlink" href="#id5" title="Permalink to this heading"></a>
</h5> <p>Consider the following situation:</p> <div class="highlight-json notranslate">
<div class="highlight"><pre class="highlight" data-language="php"><span class="p">{</span>
<span class="nt">"require-dev"</span><span class="p">:</span><span class="p">{</span>
<span class="nt">"phpunit/phpunit"</span><span class="p">:</span><span class="s2">"^9.6"</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div> </div> <p>Using the <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">outdated</span></code> command we can see that we have PHPUnit 9.6.3 in our project and that a new major version is available:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">composer outdated
Legend:
! patch or minor release available - update recommended
~ major release available - update possible

Direct dependencies required in composer.json:
phpunit/phpunit                    9.6.3  ~ 10.0.7 The PHP Unit Testing framework.
</pre></div> </div> <p>Because PHPUnit 10 is a new major version, <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">update</span></code> will not update from PHPUnit 9.6.3 to PHPUnit 10.0.7. Updates to a new major version should be an explicit operation following a conscious decision.</p> <p>If you use semantic version constraints in your <code class="docutils literal notranslate"><span class="pre">composer.json</span></code> file (<a class="reference external" href="https://thephp.cc/articles/the-death-star-version-constraint?ref=phpunit">and you should!</a>) then you will have to manually update PHPUnit’s version constraint when you want to update to a new major version.</p> <p>Here is what you should do: edit your project’s <code class="docutils literal notranslate"><span class="pre">composer.json</span></code> file and change <code class="docutils literal notranslate"><span class="pre">^9.6</span></code> to <code class="docutils literal notranslate"><span class="pre">^10.0</span></code>:</p> <div class="highlight-json notranslate">
<div class="highlight"><pre class="highlight" data-language="php"><span class="p">{</span>
<span class="nt">"require-dev"</span><span class="p">:</span><span class="p">{</span>
<span class="nt">"phpunit/phpunit"</span><span class="p">:</span><span class="s2">"^10.0"</span>
<span class="p">}</span>
<span class="p">}</span>
</pre></div> </div> <p>Now we can run <code class="docutils literal notranslate"><span class="pre">composer</span> <span class="pre">update</span></code> and the new major version will be installed.</p> </section> </section> </section> <section id="phar-or-composer"> <h3>PHAR or Composer?<a class="headerlink" href="#phar-or-composer" title="Permalink to this heading"></a>
</h3> <p>According to its own documentation, Composer “[e]nables you to declare the libraries you depend on” and “[f]inds out which versions of which packages can and need to be installed, and installs them (meaning it downloads them into your project)”. This is exactly what you need – and want – for dealing with your project’s dependencies that are required at runtime. It is, however, not what you want for your project’s development-time dependencies, for instance tools for static analysis.</p> <p>While Composer allows for the separate declaration of dependencies that are only required during development and dependencies that are actually required to run the software, the implementation of this separation is merely cosmetic: the entirety of both development-time dependencies and runtime dependencies is resolved to one installable set. This set of dependencies is then installed into the same <code class="docutils literal notranslate"><span class="pre">vendor</span></code> directory. What happens, for instance, when a tool that you install using Composer requires a version of a library that is not compatible with the version of that library that is required by another tool – or even by your own software? Such a conflict cannot be resolved and Composer will abort the installation process.</p> <p>The really frustrating thing about this situation is the fact that such a conflict is, in most cases, unwarranted. A static analysis tool, for instance, never loads or executes the code of your software (it only looks at it in order to reason about it). Therefore, the conflicting versions of the library – one depended upon by your software, the other depended upon by the tool – are never (tried to be) loaded in the same PHP process. Hence: no problem.</p> <p>This is the primary reason why I do not use Composer to install a tool but instead use a PHP Archive (PHAR). The self-contained PHAR of a tool ensures that its dependencies cannot conflict with the actual software’s dependencies.</p> </section> <section id="global-installation"> <h3>Global Installation<a class="headerlink" href="#global-installation" title="Permalink to this heading"></a>
</h3> <p>So far we have discussed how to install PHPUnit on a per-project basis using a PHP Archive (PHAR) – manually as well as using Phive – and Composer.</p> <p>For the sake of completeness, we shall also discuss the possibility of installing PHPUnit globally. What we mean by that is having one global installation of PHPUnit where the command-line tool, <code class="docutils literal notranslate"><span class="pre">phpunit</span></code>, is on your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> to make it globally available in all your projects.</p> <p>A common approach for installing PHPUnit globally is to download a release of PHPUnit packaged as a PHP archive, make it executable, and put it into your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code>:</p> <div class="highlight-none notranslate">
<div class="highlight"><pre class="highlight" data-language="php">wget -O phpunit.phar https://phar.phpunit.de/phpunit-10.phar
chmod +x phpunit.phar
sudo mv phpunit.phar /usr/local/bin/phpunit
phpunit --version
PHPUnit 10.0.0 by Sebastian Bergmann and contributors.
</pre></div> </div> <p>Both Composer and Phive can be used to perform a global installation of PHPUnit.</p> <p>Using such a global installation of PHPUnit is almost always a bad idea as the different projects you work on may require different versions of PHPUnit, for instance.</p> <p>It is therefore best to use a project-local installation of the version of PHPUnit that should be used for the project at hand.</p> <p>Consequently, the package manager of your operating system should not be used to install PHPUnit as this would result in a global installation of PHPUnit.</p> </section> <section id="web-server"> <h3>Web Server<a class="headerlink" href="#web-server" title="Permalink to this heading"></a>
</h3> <p>PHPUnit is a framework for writing as well as a command-line tool for running tests. Writing and running tests is a development-time activity. There is no reason why PHPUnit should be installed on a web server.</p> <p>If you put PHPUnit on a web server then your deployment process is broken. On a more general note, if your <code class="docutils literal notranslate"><span class="pre">vendor</span></code> directory is publicly accessible on your web server then your deployment process is also broken.</p> <p><a class="reference external" href="https://thephp.cc/articles/phpunit-a-security-risk?ref=phpunit">Please note that if you put PHPUnit on a web server “bad things” may happen. You have been warned.</a></p> <p>Make sure your deployment process does not make PHPUnit, or any other development tool, publicly accessible on a web server.</p> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2025 Sebastian Bergmann<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>
    <a href="https://docs.phpunit.de/en/12.0/installation.html" class="_attribution-link">https://docs.phpunit.de/en/12.0/installation.html</a>
  </p>
</div>
