<h1>Content-Security-Policy-Report-Only</h1>
<h1>Content-Security-Policy-Report-Only</h1>
<div class="section-content">
<p>The HTTP <code>Content-Security-Policy-Report-Only</code> response header allows web developers to experiment with policies by monitoring (but not enforcing) their effects. These violation reports consist of <a href="https://developer.mozilla.org/en-US/docs/Glossary/JSON">JSON</a> documents sent via an HTTP <code>POST</code> request to the specified URI.</p> <p>For more information, see also this article on <a href="../csp.html">Content Security Policy (CSP)</a>.</p> <figure class="table-container"><div class="_table"><table class="properties"> <tbody> <tr> <th scope="row">Header type</th> <td><a href="https://developer.mozilla.org/en-US/docs/Glossary/Response_header">Response header</a></td> </tr> <tr> <th scope="row"><a href="https://developer.mozilla.org/en-US/docs/Glossary/Forbidden_header_name">Forbidden header name</a></th> <td>no</td> </tr> <tr> <th colspan="2" scope="row"> This header is not supported inside a <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/meta"><code>&lt;meta&gt;</code></a> element. </th> </tr> </tbody> </table></div></figure>
</div>
<section aria-labelledby="syntax"><h2 id="syntax">Syntax</h2>
<div class="section-content"><div class="code-example"><pre data-language="http"><span class="token header"><span class="token header-name keyword">Content-Security-Policy-Report-Only</span><span class="token punctuation">:</span> <span class="token header-value">&lt;policy-directive&gt;; &lt;policy-directive&gt;</span></span>
</pre></div></div></section><section aria-labelledby="directives"><h2 id="directives">Directives</h2>
<div class="section-content">
<p>The directives of the <a href="content-security-policy.html"><code>Content-Security-Policy</code></a> header can also be applied to <code>Content-Security-Policy-Report-Only</code>.</p> <p>The CSP <a href="content-security-policy/report-uri.html"><code>report-uri</code></a> directive should be used with this header, otherwise this header will be an expensive no-op machine.</p>
</div></section><section aria-labelledby="examples"><h2 id="examples">Examples</h2>
<div class="section-content">
<p>This header reports violations that would have occurred. You can use this to iteratively work on your content security policy. You observe how your site behaves, watching for violation reports, or <a href="https://secure.wphackedhelp.com/blog/wordpress-malware-redirect-hack-cleanup/" rel=" noopener">malware redirects</a>, then choose the desired policy enforced by the <a href="content-security-policy.html"><code>Content-Security-Policy</code></a> header.</p> <div class="code-example"><pre data-language="http"><span class="token header"><span class="token header-name keyword">Content-Security-Policy-Report-Only</span><span class="token punctuation">:</span> <span class="token header-value">default-src https:; report-uri /csp-violation-report-endpoint/</span></span>
</pre></div> <p>If you still want to receive reporting, but also want to enforce a policy, use the <a href="content-security-policy.html"><code>Content-Security-Policy</code></a> header with the <a href="content-security-policy/report-uri.html"><code>report-uri</code></a> directive.</p> <div class="code-example"><pre data-language="http"><span class="token header"><span class="token header-name keyword">Content-Security-Policy</span><span class="token punctuation">:</span> <span class="token header-value csp languages-csp">default-src https:; report-uri /csp-violation-report-endpoint/</span></span>
</pre></div>
</div></section><section aria-labelledby="violation_report_syntax"><h2 id="violation_report_syntax">Violation report syntax</h2>
<div class="section-content">
<p>The report JSON object contains the following data:</p> <dl> <dt id="blocked-uri"><code>blocked-uri</code></dt> <dd> <p>The URI of the resource that was blocked from loading by the Content Security Policy. If the blocked URI is from a different origin than the document-uri, then the blocked URI is truncated to contain just the scheme, host, and port.</p> </dd> <dt id="disposition"><code>disposition</code></dt> <dd> <p>Either <code>"enforce"</code> or <code>"report"</code> depending on whether the <a href="content-security-policy.html"><code>Content-Security-Policy</code></a> header or the <code>Content-Security-Policy-Report-Only</code> header is used.</p> </dd> <dt id="document-uri"><code>document-uri</code></dt> <dd> <p>The URI of the document in which the violation occurred.</p> </dd> <dt id="effective-directive"><code>effective-directive</code></dt> <dd> <p>The directive whose enforcement caused the violation.</p> </dd> <dt id="original-policy"><code>original-policy</code></dt> <dd> <p>The original policy as specified by the <code>Content-Security-Policy-Report-Only</code> HTTP header.</p> </dd> <dt id="referrer"><code>referrer</code></dt> <dd> <p>The referrer of the document in which the violation occurred.</p> </dd> <dt id="script-sample"><code>script-sample</code></dt> <dd> <p>The first 40 characters of the inline script, event handler, or style that caused the violation.</p> </dd> <dt id="status-code"><code>status-code</code></dt> <dd> <p>The HTTP status code of the resource on which the global object was instantiated.</p> </dd> <dt id="violated-directive"><code>violated-directive</code></dt> <dd> <p>The name of the policy section that was violated.</p> </dd> </dl>
</div></section><section aria-labelledby="sample_violation_report"><h2 id="sample_violation_report">Sample violation report</h2>
<div class="section-content">
<p>Let's consider a page located at <code>http://example.com/signup.html</code>. It uses the following policy, disallowing everything but stylesheets from <code>cdn.example.com</code>.</p> <div class="code-example"><pre data-language="http"><span class="token header"><span class="token header-name keyword">Content-Security-Policy-Report-Only</span><span class="token punctuation">:</span> <span class="token header-value">default-src 'none'; style-src cdn.example.com; report-uri /_/csp-reports</span></span>
</pre></div> <p>The HTML of <code>signup.html</code> looks like this:</p> <div class="code-example"><pre data-language="html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en-US<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Sign Up<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>css/style.css<span class="token punctuation">"</span></span> <span class="token punctuation">/&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    Page content
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span>
</pre></div> <p>Can you spot the violation? Stylesheets are only allowed to be loaded from <code>cdn.example.com</code>, yet the website tries to load one from its own origin (<code>http://example.com</code>). A browser capable of enforcing CSP will send the following violation report as a POST request to <code>http://example.com/_/csp-reports</code>, when the document is visited:</p> <div class="code-example"><pre data-language="json"><span class="token punctuation">{</span>
  <span class="token property">"csp-report"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"document-uri"</span><span class="token operator">:</span> <span class="token string">"http://example.com/signup.html"</span><span class="token punctuation">,</span>
    <span class="token property">"referrer"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>
    <span class="token property">"blocked-uri"</span><span class="token operator">:</span> <span class="token string">"http://example.com/css/style.css"</span><span class="token punctuation">,</span>
    <span class="token property">"violated-directive"</span><span class="token operator">:</span> <span class="token string">"style-src cdn.example.com"</span><span class="token punctuation">,</span>
    <span class="token property">"original-policy"</span><span class="token operator">:</span> <span class="token string">"default-src 'none'; style-src cdn.example.com; report-uri /_/csp-reports"</span><span class="token punctuation">,</span>
    <span class="token property">"disposition"</span><span class="token operator">:</span> <span class="token string">"report"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</pre></div> <p>As you can see, the report includes the full path to the violating resource in <code>blocked-uri</code>. This is not always the case. For example, when the <code>signup.html</code> would attempt to load CSS from <code>http://anothercdn.example.com/stylesheet.css</code>, the browser would <em>not</em> include the full path but only the origin (<code>http://anothercdn.example.com</code>). This is done to prevent leaking sensitive information about cross-origin resources.</p>
</div></section><h2 id="specifications">Specifications</h2>
<div class="_table"><table class="standard-table">
<thead><tr><th scope="col">Specification</th></tr></thead>
<tbody><tr><td><a href="https://w3c.github.io/webappsec-csp/#cspro-header">Content Security Policy Level 3 <br><small># cspro-header</small></a></td></tr></tbody>
</table></div>
<h2 id="browser_compatibility">Browser compatibility</h2>
<table>
<thead>
<tr id="bct-browser-type">
<th></th>
<th colspan="6">Desktop</th>
<th colspan="6">Mobile</th>
</tr>
<tr id="bct-browsers">
<th></th>
<th>Chrome</th>
<th>Edge</th>
<th>Firefox</th>
<th>Internet Explorer</th>
<th>Opera</th>
<th>Safari</th>
<th>WebView Android</th>
<th>Chrome Android</th>
<th>Firefox for Android</th>
<th>Opera Android</th>
<th>Safari on IOS</th>
<th>Samsung Internet</th>
</tr>
</thead>
<tbody><tr>
<th><code>Content-Security-Policy-Report-Only</code></th>
<td class="bc-supports-yes"><div>25</div></td>
<td class="bc-supports-yes"><div>14</div></td>
<td class="bc-supports-yes"><div>23</div></td>
<td class="bc-supports-yes"><div>10</div></td>
<td class="bc-supports-yes"><div>15</div></td>
<td class="bc-supports-yes"><div>7</div></td>
<td class="bc-supports-yes"><div>4.4</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
<td class="bc-supports-yes"><div>23</div></td>
<td class="bc-supports-no"><div>No</div></td>
<td class="bc-supports-yes"><div>7</div></td>
<td class="bc-supports-yes"><div>Yes</div></td>
</tr></tbody>
</table>
<section aria-labelledby="see_also"><h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="content-security-policy.html"><code>Content-Security-Policy</code></a></li> <li>CSP <a href="content-security-policy/report-uri.html"><code>report-uri</code></a> directive</li> </ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2022 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy-Report-Only</a>
  </p>
</div>
