<h1>Feature Policy: Using Feature Policy</h1>
<h1>Using Feature Policy</h1>
<div class="section-content">
<p><a href="../feature_policy.html">Feature Policy</a> allows you to control which origins can use which features, both in the top-level page and in embedded frames. Essentially, you write a policy, which is an allowed list of origins for each feature. For every feature controlled by Feature Policy, the feature is only enabled in the current document or frame if its origin matches the allowed list of origins.</p> <p>For each policy-controlled feature, the browser maintains a list of origins for which the feature is enabled, known as an allowlist. If you do not specify a policy for a feature, then a default allowlist will be used. The default allowlist is specific to each feature.</p> <div class="notecard note" id="sect1"> <p><strong>Note:</strong> The <code>Feature-Policy</code> header has now been renamed to <code>Permissions-Policy</code> in the spec, and this article will eventually be updated to reflect that change.</p> </div>
</div>
<section aria-labelledby="writing_a_policy"><h2 id="writing_a_policy">Writing a policy</h2>
<div class="section-content"><p>A policy is described using a set of individual policy directives. A policy directive is a combination of a defined feature name, and an allowlist of origins that can use the feature. Features within a policy are separated by semicolons.</p></div></section><section aria-labelledby="allowlist"><h3 id="allowlist">allowlist</h3>
<div class="section-content">
<p>An <code>allowlist</code> is a list of origins that takes one or more of the following values, separated by spaces:</p> <ul> <li>
<code>*</code>: The feature will be allowed in this document, and all nested browsing contexts (iframes) regardless of their origin.</li> <li>
<code>'self'</code>: The feature will be allowed in this document, and in all nested browsing contexts (iframes) in the same origin.</li> <li>
<code>'src'</code>: (In an iframe <code>allow</code> attribute only) The feature will be allowed in this iframe, as long as the document loaded into it comes from the same origin as the URL in the iframe's <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes">src</a> attribute. <div class="notecard note" id="sect2"> <p><strong>Note:</strong> The <code>'src'</code> origin is used in the iframe <code>allow</code> attribute only, and is the <em>default</em> <code>allowlist</code> value.</p> </div> </li> <li>
<code>'none'</code>: The feature is disabled in top-level and nested browsing contexts.</li> <li>&lt;origin(s)&gt;: The feature is allowed for specific origins (for example, <code>https://example.com</code>). Origins should be separated by a space.</li> </ul> <p>The values <code>*</code> (enable for all origins) or <code>'none'</code> (disable for all origins) may only be used alone, while <code>'self'</code> and <code>'src'</code> may be used with one or more origins.</p> <p>Features are each defined to have a default allowlist, which is one of:</p> <ul> <li>
<code>*</code>: The feature is allowed by default in top-level browsing contexts and all nested browsing contexts (iframes).</li> <li>
<code>'self'</code>: The feature is allowed by default in top-level browsing contexts and in nested browsing contexts (iframes) in the same origin. The feature is not allowed in cross-origin documents in nested browsing contexts.</li> <li>
<code>'none'</code>: The feature is disabled in top-level and nested browsing contexts.</li> </ul>
</div></section><section aria-labelledby="specifying_your_policy"><h2 id="specifying_your_policy">Specifying your policy</h2>
<div class="section-content">
<p>Feature Policy provides two ways to specify policies to control features:</p> <ul> <li>The <a href="../headers/feature-policy.html"><code>Feature-Policy</code></a> HTTP header.</li> <li>The <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attr-allow"><code>allow</code></a> attribute on <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe"><code>&lt;iframe&gt;</code></a>s.</li> </ul> <p>The primary difference between the HTTP header and the <code>allow</code> attribute is that the allow attribute only controls features within an iframe. The header controls features in the response and any embedded content within the page.</p>
</div></section><section aria-labelledby="the_feature-policy_http_header"><h3 id="the_feature-policy_http_header">The Feature-Policy HTTP header</h3>
<div class="section-content">
<p>You can send the <code>Feature-Policy</code> HTTP header with the response of a page. The value of this header is a policy to be enforced by the browser for the given page. It has the following structure.</p> <div class="code-example"><pre data-language="bash">Feature-Policy: <span class="token operator">&lt;</span>feature name<span class="token operator">&gt;</span> <span class="token operator">&lt;</span>allowlist of origin<span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">&gt;</span>
</pre></div> <p>For example, to block all content from using the Geolocation API across your site:</p> <div class="code-example"><pre data-language="bash">Feature-Policy: geolocation <span class="token string">'none'</span>
</pre></div> <p>Several features can be controlled at the same time by sending the HTTP header with a semicolon-separated list of policy directives, or by sending a separate header for each policy.</p> <p>For example, the following are equivalent:</p> <div class="code-example"><pre data-language="bash">Feature-Policy: unsized-media <span class="token string">'none'</span><span class="token punctuation">;</span> geolocation <span class="token string">'self'</span> https://example.com<span class="token punctuation">;</span> camera *<span class="token punctuation">;</span>

Feature-Policy: unsized-media <span class="token string">'none'</span>
Feature-Policy: geolocation <span class="token string">'self'</span> https://example.com
Feature-Policy: camera *<span class="token punctuation">;</span>
</pre></div>
</div></section><section aria-labelledby="the_iframe_allow_attribute"><h3 id="the_iframe_allow_attribute">The iframe allow attribute</h3>
<div class="section-content">
<p>The second way to use Feature Policy is for controlling content within an iframe. Use the <code>allow</code> attribute to specify a policy list for embedded content.</p> <p>For example, allow all browsing contexts within this iframe to use fullscreen:</p> <div class="code-example"><pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com/…<span class="token punctuation">"</span></span> <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fullscreen<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</pre></div> <p>The default <code>&lt;iframe&gt;</code> <a href="#allowlist">allowlist</a> value is <code>'src'</code>, so this is equivalent to:</p> <div class="code-example"><pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com/…<span class="token punctuation">"</span></span> <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>fullscreen 'src'<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</pre></div> <p>This example allows <code>&lt;iframe&gt;</code> content on a particular origin to access the user's location:</p> <div class="code-example"><pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://google-developers.appspot.com/demos/…<span class="token punctuation">"</span></span>
  <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>geolocation https://google-developers.appspot.com<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</pre></div> <p>Similar to the HTTP header, several features can be controlled at the same time by specifying a semicolon-separated list of policy directives.</p> <p>For example, this blocks the <code>&lt;iframe&gt;</code> from using the camera and microphone:</p> <div class="code-example"><pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span> <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>camera 'none'; microphone 'none'<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>…<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</pre></div>
</div></section><section aria-labelledby="inheritance_of_policy_for_embedded_content"><h2 id="inheritance_of_policy_for_embedded_content">Inheritance of policy for embedded content</h2>
<div class="section-content">
<p>Scripts inherit the policy of their browsing context, regardless of their origin. That means that top-level scripts inherit the policy from the main document.</p> <p>All iframes inherit the policy of their parent page. If the iframe has an <code>allow</code> attribute, the policies of the parent page and the <code>allow</code> attribute are combined, using the most restrictive subset. For an iframe to have a feature enabled, the origin must be in the allowlist for both the parent page and the allow attribute.</p> <p>Disabling a feature in a policy is a one-way toggle. If a feature has been disabled for a child frame by its parent frame, the child cannot re-enable it, and neither can any of the child's descendants.</p>
</div></section><section aria-labelledby="enforcing_best_practices_for_good_user_experiences"><h2 id="enforcing_best_practices_for_good_user_experiences">Enforcing best practices for good user experiences</h2>
<div class="section-content">
<p>It's difficult to build a website that uses all the latest best practices and provides great performance and user experiences. As the website evolves, it can become even harder to maintain the user experience over time. You can use feature policies to specify the desired best practices, and rely on the browser to enforce the policies to prevent regressions.</p> <p>There are several policy-controlled features designed to represent functionality that can negatively impact the user experience. These features include:</p> <ul> <li>Layout-inducing Animations</li> <li>Unoptimized (poorly compressed) images</li> <li>Oversized images</li> <li>Synchronous scripts</li> <li>Synchronous XMLHttpRequest</li> <li>Unsized media</li> </ul> <p>To avoid breaking existing web content, the default for such policy-controlled features is to allow the functionality to be used by all origins. That is, the default allowlist is <code>'*'</code> for each feature. Preventing the use of the sub-optimal functionality requires explicitly specifying a policy that disables the features.</p> <p>For new content, you can start developing with a policy that disables all the features. This approach ensures that none of the functionality is introduced. When applying a policy to existing content, testing is likely required to verify it continues to work as expected. This is especially important for embedded or third-party content that you do not control.</p> <p>To turn on the enforcement of all the best practices, specify the policy as below.</p> <p>Send the following the HTTP header:</p> <div class="code-example"><pre data-language="bash">Feature-Policy: layout-animations <span class="token string">'none'</span><span class="token punctuation">;</span> unoptimized-images <span class="token string">'none'</span><span class="token punctuation">;</span> oversized-images <span class="token string">'none'</span><span class="token punctuation">;</span> sync-script <span class="token string">'none'</span><span class="token punctuation">;</span> sync-xhr <span class="token string">'none'</span><span class="token punctuation">;</span> unsized-media <span class="token string">'none'</span><span class="token punctuation">;</span>
</pre></div> <p>Using the <code>&lt;iframe&gt;</code> <code>allow</code> attribute:</p> <div class="code-example"><pre data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>iframe</span>
  <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://example.com/…<span class="token punctuation">"</span></span>
  <span class="token attr-name">allow</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>layout-animations 'none'; unoptimized-images 'none'; oversized-images 'none'; sync-script 'none'; sync-xhr 'none'; unsized-media 'none';<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>iframe</span><span class="token punctuation">&gt;</span></span>
</pre></div>
</div></section><section aria-labelledby="see_also"><h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../feature_policy.html">Feature Policy</a></li> <li>
<a href="../headers/feature-policy.html"><code>Feature-Policy</code></a> header</li> <li>
<a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#attributes">allow</a> attribute on iframes</li> <li>
<a href="../headers/content-security-policy.html"><code>Content-Security-Policy</code></a> header</li> <li>
<a href="../headers/referrer-policy.html"><code>Referrer-Policy</code></a> header</li> <li><a href="https://developer.mozilla.org/en-US/docs/Web/Privacy">Privacy, permissions, and information security</a></li> </ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2022 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Feature_Policy/Using_Feature_Policy" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/HTTP/Feature_Policy/Using_Feature_Policy</a>
  </p>
</div>
