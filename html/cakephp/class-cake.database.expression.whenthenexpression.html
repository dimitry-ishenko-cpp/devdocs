<h1> Class WhenThenExpression  </h1> <div class="description"> <p>Represents a SQL when/then clause with a fluid API</p> </div> <div class="info"> <b>Namespace:</b> <a href="namespace-cake.database.expression.html">Cake\Database\Expression</a><br> </div> <div class="section"> <h2>Property Summary</h2> <ul class="member-summary properties"> <li class="clearfix"> <div class="name"> <a href="#%24_typeMap">$_typeMap</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>Cake\Database\TypeMap</code></div> <div class="description"> <p>The type map to use when using an array of conditions for the <code>WHEN</code> value.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24hasThenBeenDefined">$hasThenBeenDefined</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>bool</code></div> <div class="description"> <p>Whether the <code>THEN</code> value has been defined, eg whether <code>then()</code> has been invoked.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24then">$then</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>Cake\Database\ExpressionInterface|object|scalar|null</code></div> <div class="description"> <p>The <code>THEN</code> value.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24thenType">$thenType</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>string|null</code></div> <div class="description"> <p>The <code>THEN</code> result type.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24validClauseNames">$validClauseNames</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>array&lt;string&gt;</code></div> <div class="description"> <p>The names of the clauses that are valid for use with the <code>clause()</code> method.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24when">$when</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>Cake\Database\ExpressionInterface|object|scalar|null</code></div> <div class="description"> <p>Then <code>WHEN</code> value.</p> </div> </li> <li class="clearfix"> <div class="name"> <a href="#%24whenType">$whenType</a> <span class="attributes"> <span class="label">protected</span> </span> </div> <div class="property-type"><code>array|string|null</code></div> <div class="description"> <p>The <code>WHEN</code> value type.</p> </div> </li> </ul> </div> <div class="section"> <h2>Method Summary</h2> <ul class="member-summary"> <li class="clearfix"> <h5 class="function-name"> <a href="#__clone()">__clone()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Clones the inner expression objects.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#__construct()">__construct()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Constructor.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_castToExpression()">_castToExpression()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Conditionally converts the passed value to an ExpressionInterface object if the type class implements the ExpressionTypeInterface. Otherwise, returns the value unmodified.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#_requiresToExpressionCasting()">_requiresToExpressionCasting()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Returns an array with the types that require values to be casted to expressions, out of the list of type names passed as parameter.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#clause()">clause()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Returns the available data for the given clause.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#compileNullableValue()">compileNullableValue()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Compiles a nullable value to SQL.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#getResultType()">getResultType()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Returns the expression's result value type.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#inferType()">inferType()</a> <span class="label">protected</span> </h5> <div class="description detailed"> <p>Infers the abstract type for the given value.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#sql()">sql()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Converts the Node into a SQL string fragment.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#then()">then()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Sets the <code>THEN</code> result value.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#traverse()">traverse()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Iterates over each part of the expression recursively for every level of the expressions tree and executes the $callback callable passing as first parameter the instance of the expression currently being iterated.</p> </div> </li> <li class="clearfix"> <h5 class="function-name"> <a href="#when()">when()</a> <span class="label">public</span> </h5> <div class="description detailed"> <p>Sets the <code>WHEN</code> value.</p> </div> </li> </ul> <div class="section"> <h2>Method Detail</h2> <div class="method-detail">  <h3 class="method-name" id="__clone()"> __clone()   <span class="label">public</span> </h3> <pre data-language="php">__clone(): void</pre> <div class="description detailed"> <p>Clones the inner expression objects.</p> <h4>Returns</h4> <div class="list"> <code>void</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="__construct()"> __construct()   <span class="label">public</span> </h3> <pre data-language="php">__construct(Cake\Database\TypeMap|null $typeMap = null)</pre> <div class="description detailed"> <p>Constructor.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Cake\Database\TypeMap|null</code> <var>$typeMap</var> <span class="label">optional</span> </dt> <dd><p>The type map to use when using an array of conditions for the <code>WHEN</code> value.</p></dd> </dl> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_castToExpression()"> _castToExpression()   <span class="label">protected</span> </h3> <pre data-language="php">_castToExpression(mixed $value, string|null $type = null): mixed</pre> <div class="description detailed"> <p>Conditionally converts the passed value to an ExpressionInterface object if the type class implements the ExpressionTypeInterface. Otherwise, returns the value unmodified.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>mixed</code> <var>$value</var> </dt> <dd><p>The value to convert to ExpressionInterface</p></dd> <dt> <code>string|null</code> <var>$type</var> <span class="label">optional</span> </dt> <dd><p>The type name</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>mixed</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="_requiresToExpressionCasting()"> _requiresToExpressionCasting()   <span class="label">protected</span> </h3> <pre data-language="php">_requiresToExpressionCasting(array $types): array</pre> <div class="description detailed"> <p>Returns an array with the types that require values to be casted to expressions, out of the list of type names passed as parameter.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>array</code> <var>$types</var> </dt> <dd><p>List of type names</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>array</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="clause()"> clause()   <span class="label">public</span> </h3> <pre data-language="php">clause(string $clause): Cake\Database\ExpressionInterface|object|scalar|null</pre> <div class="description detailed"> <p>Returns the available data for the given clause.</p> <h3>Available clauses</h3> <p>The following clause names are available:</p> <ul> <li>
<code>when</code>: The <code>WHEN</code> value.</li> <li>
<code>then</code>: The <code>THEN</code> result value.</li> </ul> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>string</code> <var>$clause</var> </dt> <dd><p>The name of the clause to obtain.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>Cake\Database\ExpressionInterface|object|scalar|null</code><br> </div> <h4>Throws</h4> <div class="list"> <code>InvalidArgumentException</code><br> In case the given clause name is invalid. </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="compileNullableValue()"> compileNullableValue()   <span class="label">protected</span> </h3> <pre data-language="php">compileNullableValue(Cake\Database\ValueBinder $binder, Cake\Database\ExpressionInterface|object|scalar|null $value, string|null $type = null): string</pre> <div class="description detailed"> <p>Compiles a nullable value to SQL.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Cake\Database\ValueBinder</code> <var>$binder</var> </dt> <dd><p>The value binder to use.</p></dd> <dt> <code>Cake\Database\ExpressionInterface|object|scalar|null</code> <var>$value</var> </dt> <dd><p>The value to compile.</p></dd> <dt> <code>string|null</code> <var>$type</var> <span class="label">optional</span> </dt> <dd><p>The value type.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="getResultType()"> getResultType()   <span class="label">public</span> </h3> <pre data-language="php">getResultType(): string|null</pre> <div class="description detailed"> <p>Returns the expression's result value type.</p> <h4>Returns</h4> <div class="list"> <code>string|null</code><br> </div> <h4>See Also</h4> <div class="list"> WhenThenExpression::then() </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="inferType()"> inferType()   <span class="label">protected</span> </h3> <pre data-language="php">inferType(mixed $value): string|null</pre> <div class="description detailed"> <p>Infers the abstract type for the given value.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>mixed</code> <var>$value</var> </dt> <dd><p>The value for which to infer the type.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>string|null</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="sql()"> sql()   <span class="label">public</span> </h3> <pre data-language="php">sql(Cake\Database\ValueBinder $binder): string</pre> <div class="description detailed"> <p>Converts the Node into a SQL string fragment.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Cake\Database\ValueBinder</code> <var>$binder</var> </dt>  </dl> </div> <h4>Returns</h4> <div class="list"> <code>string</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="then()"> then()   <span class="label">public</span> </h3> <pre data-language="php">then(Cake\Database\ExpressionInterface|object|scalar|null $result, string|null $type = null): $this</pre> <div class="description detailed"> <p>Sets the <code>THEN</code> result value.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Cake\Database\ExpressionInterface|object|scalar|null</code> <var>$result</var> </dt> <dd><p>The result value.</p></dd> <dt> <code>string|null</code> <var>$type</var> <span class="label">optional</span> </dt> <dd><p>The result type. If no type is provided, the type will be inferred from the given result value.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>$this</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="traverse()"> traverse()   <span class="label">public</span> </h3> <pre data-language="php">traverse(Closure $callback): $this</pre> <div class="description detailed"> <p>Iterates over each part of the expression recursively for every level of the expressions tree and executes the $callback callable passing as first parameter the instance of the expression currently being iterated.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Closure</code> <var>$callback</var> </dt>  </dl> </div> <h4>Returns</h4> <div class="list"> <code>$this</code><br> </div> </div> </div> <div class="method-detail">  <h3 class="method-name" id="when()"> when()   <span class="label">public</span> </h3> <pre data-language="php">when(Cake\Database\ExpressionInterface|object|array|scalar $when, array&lt;string, string&gt;|string|null $type = null): $this</pre> <div class="description detailed"> <p>Sets the <code>WHEN</code> value.</p> <h4>Parameters</h4> <div class="parameter-list list"> <dl> <dt> <code>Cake\Database\ExpressionInterface|object|array|scalar</code> <var>$when</var> </dt> <dd><p>The <code>WHEN</code> value. When using an array of conditions, it must be compatible with <code>\Cake\Database\Query::where()</code>. Note that this argument is <em>not</em> completely safe for use with user data, as a user supplied array would allow for raw SQL to slip in! If you plan to use user data, either pass a single type for the <code>$type</code> argument (which forces the <code>$when</code> value to be a non-array, and then always binds the data), use a conditions array where the user data is only passed on the value side of the array entries, or custom bindings!</p></dd> <dt> <code>array&lt;string, string&gt;|string|null</code> <var>$type</var> <span class="label">optional</span> </dt> <dd><p>The when value type. Either an associative array when using array style conditions, or else a string. If no type is provided, the type will be tried to be inferred from the value.</p></dd> </dl> </div> <h4>Returns</h4> <div class="list"> <code>$this</code><br> </div> <h4>Throws</h4> <div class="list"> <code>InvalidArgumentException</code><br> In case the `$when` argument is neither a non-empty array, nor a scalar value, an object, or an instance of `\Cake\Database\ExpressionInterface`.<br> <code>InvalidArgumentException</code><br> In case the `$type` argument is neither an array, a string, nor null.<br> <code>InvalidArgumentException</code><br> In case the `$when` argument is an array, and the `$type` argument is neither an array, nor null.<br> <code>InvalidArgumentException</code><br> In case the `$when` argument is a non-array value, and the `$type` argument is neither a string, nor null. </div> <h4>See Also</h4> <div class="list"> CaseStatementExpression::when() for a more detailed usage explanation. </div> </div> </div> </div> <div class="section"> <h2>Property Detail</h2> <div class="property-detail">  <h3 class="property-name" id="$_typeMap"> <var>$_typeMap</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>The type map to use when using an array of conditions for the <code>WHEN</code> value.</p> <h4>Type</h4> <div class="list"> <code>Cake\Database\TypeMap</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$hasThenBeenDefined"> <var>$hasThenBeenDefined</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>Whether the <code>THEN</code> value has been defined, eg whether <code>then()</code> has been invoked.</p> <h4>Type</h4> <div class="list"> <code>bool</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$then"> <var>$then</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>The <code>THEN</code> value.</p> <h4>Type</h4> <div class="list"> <code>Cake\Database\ExpressionInterface|object|scalar|null</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$thenType"> <var>$thenType</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>The <code>THEN</code> result type.</p> <h4>Type</h4> <div class="list"> <code>string|null</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$validClauseNames"> <var>$validClauseNames</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>The names of the clauses that are valid for use with the <code>clause()</code> method.</p> <h4>Type</h4> <div class="list"> <code>array&lt;string&gt;</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$when"> <var>$when</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>Then <code>WHEN</code> value.</p> <h4>Type</h4> <div class="list"> <code>Cake\Database\ExpressionInterface|object|scalar|null</code><br> </div> </div> </div> <div class="property-detail">  <h3 class="property-name" id="$whenType"> <var>$whenType</var>   <span class="label">protected</span> </h3> <div class="description detailed"> <p>The <code>WHEN</code> value type.</p> <h4>Type</h4> <div class="list"> <code>array|string|null</code><br> </div> </div> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;present The Cake Software Foundation, Inc.<br>Licensed under the MIT License.<br>CakePHP is a registered trademark of Cake Software Foundation, Inc.<br>We are not endorsed by or affiliated with CakePHP.<br>
    <a href="https://api.cakephp.org/4.4/class-Cake.Database.Expression.WhenThenExpression.html" class="_attribution-link">https://api.cakephp.org/4.4/class-Cake.Database.Expression.WhenThenExpression.html</a>
  </p>
</div>
