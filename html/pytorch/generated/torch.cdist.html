<h1 id="torch-cdist">torch.cdist</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.cdist">
<code>torch.cdist(x1, x2, p=2.0, compute_mode='use_mm_for_euclid_dist_if_necessary')</code> <a class="reference internal" href="https://pytorch.org/docs/2.1/_modules/torch/functional.html#cdist"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Computes batched the p-norm distance between each pair of the two collections of row vectors.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>x1</strong> (<a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">Tensor</a>) – input tensor of shape <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>×</mo><mi>P</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">B \times P \times M</annotation></semantics></math></span></span></span>.</li> <li>
<strong>x2</strong> (<a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">Tensor</a>) – input tensor of shape <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>×</mo><mi>R</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">B \times R \times M</annotation></semantics></math></span></span></span>.</li> <li>
<strong>p</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)">float</a>) – p value for the p-norm distance to calculate between each vector pair <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo><mo stretchy="false">[</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\in [0, \infty]</annotation></semantics></math></span></span></span>.</li> <li>
<strong>compute_mode</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a>) – ‘use_mm_for_euclid_dist_if_necessary’ - will use matrix multiplication approach to calculate euclidean distance (p = 2) if P &gt; 25 or R &gt; 25 ‘use_mm_for_euclid_dist’ - will always use matrix multiplication approach to calculate euclidean distance (p = 2) ‘donot_use_mm_for_euclid_dist’ - will never use matrix multiplication approach to calculate euclidean distance (p = 2) Default: use_mm_for_euclid_dist_if_necessary.</li> </ul> </dd> <dt class="field-even">Return type</dt> <dd class="field-even">
<p><a class="reference internal" href="../tensors.html#torch.Tensor" title="torch.Tensor">Tensor</a></p> </dd> </dl> <p>If x1 has shape <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>×</mo><mi>P</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">B \times P \times M</annotation></semantics></math></span></span></span> and x2 has shape <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>×</mo><mi>R</mi><mo>×</mo><mi>M</mi></mrow><annotation encoding="application/x-tex">B \times R \times M</annotation></semantics></math></span></span></span> then the output will have shape <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mo>×</mo><mi>P</mi><mo>×</mo><mi>R</mi></mrow><annotation encoding="application/x-tex">B \times P \times R</annotation></semantics></math></span></span></span>.</p> <p>This function is equivalent to <code>scipy.spatial.distance.cdist(input,’minkowski’, p=p)</code> if <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>∈</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="normal">∞</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p \in (0, \infty)</annotation></semantics></math></span></span></span>. When <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">p = 0</annotation></semantics></math></span></span></span> it is equivalent to <code>scipy.spatial.distance.cdist(input, ‘hamming’) * M</code>. When <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mi mathvariant="normal">∞</mi></mrow><annotation encoding="application/x-tex">p = \infty</annotation></semantics></math></span></span></span>, the closest scipy function is <code>scipy.spatial.distance.cdist(xn, lambda x, y: np.abs(x - y).max())</code>.</p> <h4 class="rubric">Example</h4> <pre data-language="python">&gt;&gt;&gt; a = torch.tensor([[0.9041,  0.0196], [-0.3108, -2.4423], [-0.4821,  1.059]])
&gt;&gt;&gt; a
tensor([[ 0.9041,  0.0196],
        [-0.3108, -2.4423],
        [-0.4821,  1.0590]])
&gt;&gt;&gt; b = torch.tensor([[-2.1763, -0.4713], [-0.6986,  1.3702]])
&gt;&gt;&gt; b
tensor([[-2.1763, -0.4713],
        [-0.6986,  1.3702]])
&gt;&gt;&gt; torch.cdist(a, b, p=2)
tensor([[3.1193, 2.0959],
        [2.7138, 3.8322],
        [2.2830, 0.3791]])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.cdist.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.cdist.html</a>
  </p>
</div>
