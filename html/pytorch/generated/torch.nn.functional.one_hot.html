<h1 id="torch-nn-functional-one-hot">torch.nn.functional.one_hot</h1> <dl class="py function"> <dt class="sig sig-object py" id="torch.nn.functional.one_hot">
<code>torch.nn.functional.one_hot(tensor, num_classes=-1) → LongTensor</code> </dt> <dd>
<p>Takes LongTensor with index values of shape <code>(*)</code> and returns a tensor of shape <code>(*, num_classes)</code> that have zeros everywhere except where the index of last dimension matches the corresponding value of the input tensor, in which case it will be 1.</p> <p>See also <a class="reference external" href="https://en.wikipedia.org/wiki/One-hot">One-hot on Wikipedia</a> .</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>tensor</strong> (<em>LongTensor</em>) – class values of any shape.</li> <li>
<strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a>) – Total number of classes. If set to -1, the number of classes will be inferred as one greater than the largest class value in the input tensor.</li> </ul> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<p>LongTensor that has one more dimension with 1 values at the index of last dimension indicated by the input, and 0 everywhere else.</p> </dd> </dl> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; F.one_hot(torch.arange(0, 5) % 3)
tensor([[1, 0, 0],
        [0, 1, 0],
        [0, 0, 1],
        [1, 0, 0],
        [0, 1, 0]])
&gt;&gt;&gt; F.one_hot(torch.arange(0, 5) % 3, num_classes=5)
tensor([[1, 0, 0, 0, 0],
        [0, 1, 0, 0, 0],
        [0, 0, 1, 0, 0],
        [1, 0, 0, 0, 0],
        [0, 1, 0, 0, 0]])
&gt;&gt;&gt; F.one_hot(torch.arange(0, 6).view(3,2) % 3)
tensor([[[1, 0, 0],
         [0, 1, 0]],
        [[0, 0, 1],
         [1, 0, 0]],
        [[0, 1, 0],
         [0, 0, 1]]])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2024, PyTorch Contributors<br>PyTorch has a BSD-style license, as found in the <a href="https://github.com/pytorch/pytorch/blob/main/LICENSE">LICENSE</a> file.<br>
    <a href="https://pytorch.org/docs/2.1/generated/torch.nn.functional.one_hot.html" class="_attribution-link">https://pytorch.org/docs/2.1/generated/torch.nn.functional.one_hot.html</a>
  </p>
</div>
