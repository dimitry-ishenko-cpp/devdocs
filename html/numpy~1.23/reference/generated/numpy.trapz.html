<h1>numpy.trapz</h1> <dl class="py function"> <dt class="sig sig-object py" id="numpy.trapz"> <span class="sig-prename descclassname">numpy.</span><span class="sig-name descname">trapz</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">y</span></em>, <em class="sig-param"><span class="n">x</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dx</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">axis</span><span class="o">=</span><span class="default_value">- 1</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/numpy/numpy/blob/v1.23.0/numpy/lib/function_base.py#L4727-L4838"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Integrate along the given axis using the composite trapezoidal rule.</p> <p>If <code>x</code> is provided, the integration happens in sequence along its elements - they are not sorted.</p> <p>Integrate <code>y</code> (<code>x</code>) along each 1d slice on the given axis, compute <span class="math notranslate nohighlight">\(\int y(x) dx\)</span>. When <code>x</code> is specified, this integrates along the parametric curve, computing <span class="math notranslate nohighlight">\(\int_t y(t) dt = \int_t y(t) \left.\frac{dx}{dt}\right|_{x=x(t)} dt\)</span>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>y</strong><span class="classifier">array_like</span>
</dt>
<dd>
<p>Input array to integrate.</p> </dd> <dt>
<strong>x</strong><span class="classifier">array_like, optional</span>
</dt>
<dd>
<p>The sample points corresponding to the <code>y</code> values. If <code>x</code> is None, the sample points are assumed to be evenly spaced <code>dx</code> apart. The default is None.</p> </dd> <dt>
<strong>dx</strong><span class="classifier">scalar, optional</span>
</dt>
<dd>
<p>The spacing between sample points when <code>x</code> is None. The default is 1.</p> </dd> <dt>
<strong>axis</strong><span class="classifier">int, optional</span>
</dt>
<dd>
<p>The axis along which to integrate.</p> </dd> </dl> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<dl class="simple"> <dt>
<strong>trapz</strong><span class="classifier">float or ndarray</span>
</dt>
<dd>
<p>Definite integral of <code>y</code> = n-dimensional array as approximated along a single axis by the trapezoidal rule. If <code>y</code> is a 1-dimensional array, then the result is a float. If <code>n</code> is greater than 1, then the result is an <code>n</code>-1 dimensional array.</p> </dd> </dl> </dd> </dl> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt>
<a class="reference internal" href="numpy.sum.html#numpy.sum" title="numpy.sum"><code>sum</code></a>, <a class="reference internal" href="numpy.cumsum.html#numpy.cumsum" title="numpy.cumsum"><code>cumsum</code></a>
</dt>
 </dl> </div> <h4 class="rubric">Notes</h4> <p>Image <a class="reference internal" href="#r7aa6c77779c0-2" id="id1">[2]</a> illustrates trapezoidal rule â€“ y-axis locations of points will be taken from <code>y</code> array, by default x-axis distances between points will be 1.0, alternatively they can be provided with <code>x</code> array or with <code>dx</code> scalar. Return value will be equal to combined area under the red lines.</p> <h4 class="rubric">References</h4> <dl class="citation"> <dt class="label" id="r7aa6c77779c0-1"><span class="brackets">1</span></dt> <dd>
<p>Wikipedia page: <a class="reference external" href="https://en.wikipedia.org/wiki/Trapezoidal_rule">https://en.wikipedia.org/wiki/Trapezoidal_rule</a></p> </dd> <dt class="label" id="r7aa6c77779c0-2"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt> <dd>
<p>Illustration image: <a class="reference external" href="https://en.wikipedia.org/wiki/File:Composite_trapezoidal_rule_illustration.png">https://en.wikipedia.org/wiki/File:Composite_trapezoidal_rule_illustration.png</a></p> </dd> </dl> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; np.trapz([1,2,3])
4.0
&gt;&gt;&gt; np.trapz([1,2,3], x=[4,6,8])
8.0
&gt;&gt;&gt; np.trapz([1,2,3], dx=2)
8.0
</pre> <p>Using a decreasing <code>x</code> corresponds to integrating in reverse:</p> <pre data-language="python">&gt;&gt;&gt; np.trapz([1,2,3], x=[8,6,4])
-8.0
</pre> <p>More generally <code>x</code> is used to integrate along a parametric curve. This finds the area of a circle, noting we repeat the sample which closes the curve:</p> <pre data-language="python">&gt;&gt;&gt; theta = np.linspace(0, 2 * np.pi, num=1000, endpoint=True)
&gt;&gt;&gt; np.trapz(np.cos(theta), x=np.sin(theta))
3.141571941375841
</pre> <pre data-language="python">&gt;&gt;&gt; a = np.arange(6).reshape(2, 3)
&gt;&gt;&gt; a
array([[0, 1, 2],
       [3, 4, 5]])
&gt;&gt;&gt; np.trapz(a, axis=0)
array([1.5, 2.5, 3.5])
&gt;&gt;&gt; np.trapz(a, axis=1)
array([2.,  8.])
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2022 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://numpy.org/doc/1.23/reference/generated/numpy.trapz.html" class="_attribution-link">https://numpy.org/doc/1.23/reference/generated/numpy.trapz.html</a>
  </p>
</div>
