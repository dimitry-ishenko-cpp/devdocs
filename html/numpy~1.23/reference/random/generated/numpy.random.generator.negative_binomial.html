<h1>numpy.random.Generator.negative_binomial</h1> <p>method</p> <dl class="py method"> <dt class="sig sig-object py" id="numpy.random.Generator.negative_binomial"> <span class="sig-prename descclassname">random.Generator.</span><span class="sig-name descname">negative_binomial</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em>, <em class="sig-param"><span class="n">p</span></em>, <em class="sig-param"><span class="n">size</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Draw samples from a negative binomial distribution.</p> <p>Samples are drawn from a negative binomial distribution with specified parameters, <code>n</code> successes and <code>p</code> probability of success where <code>n</code> is &gt; 0 and <code>p</code> is in the interval (0, 1].</p> <dl class="field-list simple"> <dt class="field-odd">Parameters</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>n</strong><span class="classifier">float or array_like of floats</span>
</dt>
<dd>
<p>Parameter of the distribution, &gt; 0.</p> </dd> <dt>
<strong>p</strong><span class="classifier">float or array_like of floats</span>
</dt>
<dd>
<p>Parameter of the distribution. Must satisfy 0 &lt; p &lt;= 1.</p> </dd> <dt>
<strong>size</strong><span class="classifier">int or tuple of ints, optional</span>
</dt>
<dd>
<p>Output shape. If the given shape is, e.g., <code>(m, n, k)</code>, then <code>m * n * k</code> samples are drawn. If size is <code>None</code> (default), a single value is returned if <code>n</code> and <code>p</code> are both scalars. Otherwise, <code>np.broadcast(n, p).size</code> samples are drawn.</p> </dd> </dl> </dd> <dt class="field-even">Returns</dt> <dd class="field-even">
<dl class="simple"> <dt>
<strong>out</strong><span class="classifier">ndarray or scalar</span>
</dt>
<dd>
<p>Drawn samples from the parameterized negative binomial distribution, where each sample is equal to N, the number of failures that occurred before a total of n successes was reached.</p> </dd> </dl> </dd> </dl> <h4 class="rubric">Notes</h4> <p>The probability mass function of the negative binomial distribution is</p> <div class="math notranslate nohighlight"> \[P(N;n,p) = \frac{\Gamma(N+n)}{N!\Gamma(n)}p^{n}(1-p)^{N},\]</div> <p>where <span class="math notranslate nohighlight">\(n\)</span> is the number of successes, <span class="math notranslate nohighlight">\(p\)</span> is the probability of success, <span class="math notranslate nohighlight">\(N+n\)</span> is the number of trials, and <span class="math notranslate nohighlight">\(\Gamma\)</span> is the gamma function. When <span class="math notranslate nohighlight">\(n\)</span> is an integer, <span class="math notranslate nohighlight">\(\frac{\Gamma(N+n)}{N!\Gamma(n)} = \binom{N+n-1}{N}\)</span>, which is the more common form of this term in the the pmf. The negative binomial distribution gives the probability of N failures given n successes, with a success on the last trial.</p> <p>If one throws a die repeatedly until the third time a “1” appears, then the probability distribution of the number of non-“1”s that appear before the third “1” is a negative binomial distribution.</p> <p>Because this method internally calls <code>Generator.poisson</code> with an intermediate random value, a ValueError is raised when the choice of <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span> would result in the mean + 10 sigma of the sampled intermediate distribution exceeding the max acceptable value of the <code>Generator.poisson</code> method. This happens when <span class="math notranslate nohighlight">\(p\)</span> is too low (a lot of failures happen for every success) and <span class="math notranslate nohighlight">\(n\)</span> is too big ( a lot of sucesses are allowed). Therefore, the <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span> values must satisfy the constraint:</p> <div class="math notranslate nohighlight"> \[n\frac{1-p}{p}+10n\sqrt{n}\frac{1-p}{p}&lt;2^{63}-1-10\sqrt{2^{63}-1},\]</div> <p>Where the left side of the equation is the derived mean + 10 sigma of a sample from the gamma distribution internally used as the <span class="math notranslate nohighlight">\(lam\)</span> parameter of a poisson sample, and the right side of the equation is the constraint for maximum value of <span class="math notranslate nohighlight">\(lam\)</span> in <code>Generator.poisson</code>.</p> <h4 class="rubric">References</h4> <dl class="citation"> <dt class="label" id="r30b32598df4a-1"><span class="brackets">1</span></dt> <dd>
<p>Weisstein, Eric W. “Negative Binomial Distribution.” From MathWorld–A Wolfram Web Resource. <a class="reference external" href="http://mathworld.wolfram.com/NegativeBinomialDistribution.html">http://mathworld.wolfram.com/NegativeBinomialDistribution.html</a></p> </dd> <dt class="label" id="r30b32598df4a-2"><span class="brackets">2</span></dt> <dd>
<p>Wikipedia, “Negative binomial distribution”, <a class="reference external" href="https://en.wikipedia.org/wiki/Negative_binomial_distribution">https://en.wikipedia.org/wiki/Negative_binomial_distribution</a></p> </dd> </dl> <h4 class="rubric">Examples</h4> <p>Draw samples from the distribution:</p> <p>A real world example. A company drills wild-cat oil exploration wells, each with an estimated probability of success of 0.1. What is the probability of having one success for each successive well, that is what is the probability of a single success after drilling 5 wells, after 6 wells, etc.?</p> <pre data-language="python">&gt;&gt;&gt; s = np.random.default_rng().negative_binomial(1, 0.1, 100000)
&gt;&gt;&gt; for i in range(1, 11): 
...    probability = sum(s&lt;i) / 100000.
...    print(i, "wells drilled, probability of one success =", probability)
</pre> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2022 NumPy Developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://numpy.org/doc/1.23/reference/random/generated/numpy.random.Generator.negative_binomial.html" class="_attribution-link">https://numpy.org/doc/1.23/reference/random/generated/numpy.random.Generator.negative_binomial.html</a>
  </p>
</div>
