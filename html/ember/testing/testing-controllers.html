<h1> Testing Controllers </h1>  <div id="ember365126" class="ember-view">
<p><em>Container testing methods and computed properties follow previous patterns shown in <a href="../unit-testing-basics.html">Testing Basics</a> because Ember.Controller extends Ember.Object.</em></p> <p>Controllers can be tested using the <code>setupTest</code> helper which is part of the ember-qunit framework. The tests written for instances like <code>Ember.Controller</code> are also described as container tests.</p> <h2 id="toc_testing-controller-actions">Testing Controller Actions</h2> <section aria-labelledby="toc_testing-controller-actions"> <p>Here we have a controller <code>PostsController</code> with two properties, a method that sets one of those properties, and an action named <code>setProps</code>.</p> <blockquote> <p>You can follow along by generating your own controller with <code>ember generate controller posts</code>.</p> </blockquote> <pre><code class="javascript language-javascript" data-filename="app/controllers/posts.js">import Controller from '@ember/controller';
import { action } from '@ember/object';

export default class PostsController extends Controller {
  propA = 'You need to write tests';
  propB = 'And write one for me too';

  setPropB(str) {
    this.propB = str;
  }

  @action
  setProps(str) {
    this.propA = 'Testing is cool';
    this.setPropB(str);
  }
}
</code></pre> <p>The <code>setProps</code> action directly sets one property, and calls the method to set the other. In our generated test file, Ember CLI already uses the <code>module</code> and the <code>setupTest</code> helpers to set up a test container:</p> <pre><code class="javascript language-javascript" data-filename="tests/unit/controllers/posts-test.js">import { module, test } from 'qunit';
import { setupTest } from 'ember-qunit';

module('Unit | Controller | posts', function(hooks) {
  setupTest(hooks);
});
</code></pre> <p>Next we use the owner API to gain access to the controller we'd like to test. Using the <code>this.owner.lookup</code> method we get the instance of the <code>PostsController</code> and can check the action in our test. The <code>this.owner.lookup</code> helper returns objects generated by the framework in your applications and is also exposed in tests for your usage. Here it will return a singleton instance of the <code>PostsController</code>.</p> <pre><code class="javascript language-javascript" data-filename="tests/unit/controllers/posts-test.js">import { module, test } from 'qunit';
import { setupTest } from 'ember-qunit';

module('Unit | Controller | posts', function(hooks) {
  setupTest(hooks);

  test('should update A and B on setProps action', function(assert) {
    assert.expect(4);

    // get the controller instance
    let controller = this.owner.lookup('controller:posts');

    // check the properties before the action is triggered
    assert.equal(
      controller.propA,
      'You need to write tests',
      'propA initialized'
    );
    assert.equal(
      controller.propB,
      'And write one for me too',
      'propB initialized'
    );

    // trigger the action on the controller by using the `send` method,
    // passing in any params that our action may be expecting
    controller.send('setProps', 'Testing Rocks!');

    // finally we assert that our values have been updated
    // by triggering our action.
    assert.equal(controller.propA, 'Testing is cool', 'propA updated');
    assert.equal(controller.propB, 'Testing Rocks!', 'propB updated');
  });
});
</code></pre>  </section> </div> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 Yehuda Katz, Tom Dale and Ember.js contributors<br>Licensed under the MIT License.<br>
    <a href="https://guides.emberjs.com/v4.9.0/testing/testing-controllers" class="_attribution-link">https://guides.emberjs.com/v4.9.0/testing/testing-controllers</a>
  </p>
</div>
