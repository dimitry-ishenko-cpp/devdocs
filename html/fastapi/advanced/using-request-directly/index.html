<h1 id="using-the-request-directly">Using the Request Directly</h1> <p>Up to now, you have been declaring the parts of the request that you need with their types.</p> <p>Taking data from:</p> <ul> <li>The path as parameters.</li> <li>Headers.</li> <li>Cookies.</li> <li>etc.</li> </ul> <p>And by doing so, <strong>FastAPI</strong> is validating that data, converting it and generating documentation for your API automatically.</p> <p>But there are situations where you might need to access the <code>Request</code> object directly.</p> <h2 id="details-about-the-request-object">Details about the <code>Request</code> object</h2> <p>As <strong>FastAPI</strong> is actually <strong>Starlette</strong> underneath, with a layer of several tools on top, you can use Starlette's <a href="https://www.starlette.io/requests/" class="external-link" target="_blank"><code>Request</code></a> object directly when you need to.</p> <p>It would also mean that if you get data from the <code>Request</code> object directly (for example, read the body) it won't be validated, converted or documented (with OpenAPI, for the automatic API user interface) by FastAPI.</p> <p>Although any other parameter declared normally (for example, the body with a Pydantic model) would still be validated, converted, annotated, etc.</p> <p>But there are specific cases where it's useful to get the <code>Request</code> object.</p> <h2 id="use-the-request-object-directly">Use the <code>Request</code> object directly</h2> <p>Let's imagine you want to get the client's IP address/host inside of your <em>path operation function</em>.</p> <p>For that you need to access the request directly.</p> <div class="tabbed-set tabbed-alternate" data-tabs="1:1"> <div class="tabbed-content"> <div class="tabbed-block">
<label for="__tabbed_1_1">Python 3.8+</label> <div class="highlight"><pre class="language-python" data-language="python">from fastapi import FastAPI, Request

app = FastAPI()


@app.get("/items/{item_id}")
def read_root(item_id: str, request: Request):
    client_host = request.client.host
    return {"client_host": client_host, "item_id": item_id}
</pre></div> </div> </div> </div> <p>By declaring a <em>path operation function</em> parameter with the type being the <code>Request</code> <strong>FastAPI</strong> will know to pass the <code>Request</code> in that parameter.</p> <div class="admonition tip"> <p class="admonition-title">Tip</p> <p>Note that in this case, we are declaring a path parameter beside the request parameter.</p> <p>So, the path parameter will be extracted, validated, converted to the specified type and annotated with OpenAPI.</p> <p>The same way, you can declare any other parameter as normally, and additionally, get the <code>Request</code> too.</p> </div> <h2 id="request-documentation">
<code>Request</code> documentation</h2> <p>You can read more details about the <a href="https://www.starlette.io/requests/" class="external-link" target="_blank"><code>Request</code> object in the official Starlette documentation site</a>.</p> <div class="admonition note"> <p class="admonition-title">Technical Details</p> <p>You could also use <code>from starlette.requests import Request</code>.</p> <p><strong>FastAPI</strong> provides it directly just as a convenience for you, the developer. But it comes directly from Starlette.</p> </div> <form class="md-feedback" name="feedback" hidden> <fieldset> <legend class="md-feedback__title"> Was this page helpful? </legend> <div class="md-feedback__inner">  <div class="md-feedback__note"> <div data-md-value="1" hidden> Thanks for your feedback! </div> <div data-md-value="0" hidden> Thanks for your feedback! </div> </div> </div> </fieldset> </form><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018 Sebastián Ramírez<br>Licensed under the MIT License.<br>
    <a href="https://fastapi.tiangolo.com/advanced/using-request-directly/" class="_attribution-link">https://fastapi.tiangolo.com/advanced/using-request-directly/</a>
  </p>
</div>
