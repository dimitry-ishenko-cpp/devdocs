<h1>Aria Disabling Encryption</h1> <div> <div class="node creole"> <div class="answer formatted">  <p>The process involved in safely disabling data-at-rest encryption for your Aria tables is very similar to that of enabling encryption. To disable, you need to set the relevant system variables and then rebuild each table into an unencrypted state.</p> <div class="cstm-style redbox">
<p>Don't remove the <a href="key-management-encryption-plugins.html">Encryption Key Management</a> plugin from your configuration file until you have unencrypted all tables in your database. MariaDB cannot read encrypted tables without the relevant encryption key.</p> </div>
<h2 class="anchored_heading" id="disabling-encryption-on-user-created-tables">Disabling Encryption on User-created Tables</h2> <p>With tables that the user creates, you can disable encryption by setting the <code><a href="../aria-system-variables/index.html#aria_encrypt_tables">aria_encrypt_tables</a></code> system variable to <code>OFF</code>. Once this is set, MariaDB no longer encrypts new tables created with the Aria storage engine. </p> <pre class="fixed" data-language="sql">SET GLOBAL aria_encrypt_tables = OFF;
</pre>
<p>Unlike <a href="../innodb-encryption/index.html">InnoDB</a>, Aria does not currently use background encryption threads. Before removing the <a href="key-management-encryption-plugins.html">Encryption Key Management</a> plugin from the configuration file, you first need to manually rebuild each table to an unencrypted state.</p> <p>To find the encrypted tables, query the Information Schema, filtering the <code><a href="information_schema-tables-table.html">TABLES</a></code> table for those that use the Aria storage engine and the <code>PAGE</code> <code><a href="../create-table/index.html#row_format">ROW_FORMAT</a></code>. </p> <pre class="fixed" data-language="sql">SELECT TABLE_SCHEMA, TABLE_NAME
FROM information_schema.TABLES
WHERE ENGINE = 'Aria'
  AND ROW_FORMAT = 'PAGE'
  AND TABLE_SCHEMA != 'information_schema';
</pre>
<p>Each table in the result-set was potentially written to disk in an encrypted state. Before removing the configuration for the encryption keys, you need to rebuild each of these to an unencrypted state. This can be done with an <code><a href="../alter-table/index.html">ALTER TABLE</a></code> statement.</p> <pre class="fixed" data-language="sql">ALTER TABLE test.aria_table ENGINE = Aria ROW_FORMAT = PAGE;
</pre>
<p>Once all of the Aria tables are rebuilt, they're safely unencrypted.</p> <h2 class="anchored_heading" id="disabling-encryption-for-internal-on-disk-temporary-tables">Disabling Encryption for Internal On-disk Temporary Tables</h2> <p>MariaDB routinely creates internal temporary tables. When these temporary tables are written to disk and the <code><a href="../aria-system-variables/index.html#aria_used_for_temp_tables">aria_used_for_temp_tables</a></code> system variable is set to <code>ON</code>, MariaDB uses the Aria storage engine.</p> <p>To decrypt these tables, set the <code><a href="../server-system-variables/index.html#encrypt_tmp_disk_tables">encrypt_tmp_disk_tables</a></code> to <code>OFF</code>. Once set, all internal temporary tables that are created from that point on are written unencrypted to disk.</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/aria-disabling-encryption/" class="_attribution-link">https://mariadb.com/kb/en/aria-disabling-encryption/</a>
  </p>
</div>
