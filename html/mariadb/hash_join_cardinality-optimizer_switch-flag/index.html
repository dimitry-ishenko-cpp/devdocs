<h1>hash_join_cardinality optimizer_switch Flag</h1> <div> <div class="node creole"> <div class="answer formatted"> <div class="mariadb_from_10_6_13 mariadb from_10_6_13 product">
<strong class="product_title">MariaDB starting with <a href="https://mariadb.com/kb/en/mariadb-10613-release-notes/">10.6.13</a></strong><p>The hash_join_cardinality optimizer_switch flag was added in <a href="https://mariadb.com/kb/en/mariadb-11-0-2-release-notes/">MariaDB 11.0.2</a>, <a href="https://mariadb.com/kb/en/mariadb-10-11-3-release-notes/">MariaDB 10.11.3</a>, <a href="https://mariadb.com/kb/en/mariadb-10-10-4-release-notes/">MariaDB 10.10.4</a>, <a href="https://mariadb.com/kb/en/mariadb-10-9-6-release-notes/">MariaDB 10.9.6</a>, <a href="https://mariadb.com/kb/en/mariadb-10-8-8-release-notes/">MariaDB 10.8.8</a> and <a href="https://mariadb.com/kb/en/mariadb-10613-release-notes/">MariaDB 10.6.13</a>.</p> </div>
<p>In MySQL and MariaDB, the output cardinality of a part of query has historically been tied to the used access method(s). This is different from the approach used in database textbooks. There, the cardinality "x JOIN y" is the same regardless of which access methods are used to compute it.</p> <h2 class="anchored_heading" id="example">Example</h2> <p>Consider a query joining customers with their orders:</p> <pre class="fixed" data-language="sql">select * 
from 
  customer, orders, ...
where 
  customer.id = orders.customer_id and ...
</pre>
<p>Suppose, table orders has an index <code>IDX</code> on <code>orders.customer_id</code>. </p> <p>If the query plan is using this index to fetch orders for each customer, the optimizer will use index statistics from <code>IDX</code> to estimate the number of rows in the customer-joined-with-orders.</p> <p>On the other hand, if the optimizer considers a query plan that joins customer with orders without use of indexes, it will ignore the <code>customer.id = orders.customer_id</code> equality completely and will compute the output cardinality as if customer was cross-joined with orders.</p> <h2 class="anchored_heading" id="hash-join">Hash Join</h2> <p>MariaDB supports <a href="../block-based-join-algorithms/index.html#block-hash-join">Block Hash Join</a>. It is not enabled by default, one needs to set it <a href="../server-system-variables/index.html#join_cache_level">join_cache_level</a> to 3 or a bigger value to enable it.</p> <p>Before <a href="https://jira.mariadb.org/browse/MDEV-30812">MDEV-30812</a>, Query optimization for Block Hash Join would work as described in the above example: It would assume that the join operation is a cross join.</p> <p><a href="https://jira.mariadb.org/browse/MDEV-30812">MDEV-30812</a> introduces a new <a href="../server-system-variables/index.html#optimizer_switch">optimizer_switch</a> flag, <code>hash_join_cardinality</code>. In MariaDB versions before 11.0, it is off by default.</p> <p>If one sets it to ON, the optimizer will make use of column histograms when computing the cardinality of hash join operation output.</p> <p>One can see the computation in the Optimizer Trace, search for <code>hash_join_cardinality</code>.</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/hash_join_cardinality-optimizer_switch-flag/" class="_attribution-link">https://mariadb.com/kb/en/hash_join_cardinality-optimizer_switch-flag/</a>
  </p>
</div>
