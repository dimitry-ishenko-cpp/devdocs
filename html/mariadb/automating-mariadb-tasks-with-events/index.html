<h1>Automating MariaDB Tasks with Events</h1> <div> <div class="node creole"> <div class="answer formatted"> <p>MariaDB has an event scheduler that can be used to automate tasks, making them run at regular intervals of time. This page is about using events for <a href="../automated-mariadb-deployment-and-administration/index.html">automation</a>. For more information about events themselves, and how to work with them, see <a href="../event-scheduler/index.html">event scheduler</a>.</p> <h2 class="anchored_heading" id="pros-and-cons-of-using-events-for-automation">Pros and Cons of Using Events for Automation</h2> <p>Events can be compared to Unix cron jobs or Windows scheduled tasks. MariaDB events have at least the following benefits compared to those tools:</p> <ul start="1">
<li>Events are system-independent. The same code can run on any system. </li>
<li>Events are written in procedural SQL. There is no need to install other languages or libraries. </li>
<li>If you use <a href="../user-defined-functions/index.html">user-defined functions</a>, you can still take advantage of them in your events. </li>
<li>Events run in MariaDB. An implication, for example, is that the results of queries remain in MariaDB itself and are not sent to a client. This means that network glitches don't affect events, there is no overhead due to data roundtrip, and therefore locks are held for a shorter time. </li>
</ul> <p>Some drawbacks of using events are the following:</p> <ul start="1">
<li>Events can only perform tasks that can be developed in SQL. So, for example, it is not possible to send alerts. Access to files or remote databases is limited. </li>
<li>The event scheduler runs as a single thread. If any event is supposed to start while another event is running, its execution will be skipped. It cannot be just postponed. This can be a big problem when automating a number of tasks that should run in a limited time range. But this is fine when running a limited number of tasks that may occasionally be skipped without remarkable consequences. </li>
<li>For more events limitations, see <a href="../event-limitations/index.html">Event Limitations</a>. </li>
</ul> <p>In many cases you may prefer to develop scripts in an external programming language. However, you should know that simple tasks consisting of a few queries can easily be implemented as events.</p> <h2 class="anchored_heading" id="good-practices">Good Practices</h2> <p>When using events to automate tasks, there are good practices one may want to follow.</p> <p>Move your SQL code in a stored procedure. All the event will do is to call a stored procedures. Several events may call the same stored procedure, maybe with different parameters. The procedure may also be called manually, if necessary. This will avoid code duplication. This will separate the logic from the schedule, making it possible to change an event without a risk of making changes to the logic, and the other way around.</p> <p>Just like cron jobs, events should log whether if they succeed or not. Logging debug messages may also be useful for non-trivial events. This information can be logged into a dedicated table. The contents of the table can be monitored by a monitoring tool like Grafana. This allows to visualize in a dashboard the status of events, and send alerts in case of a failure.</p> <h2 class="anchored_heading" id="examples">Examples</h2> <p>Some examples of tasks that could easily be automated with events:</p> <ul start="1">
<li>Copying data from a remote table to a local table by night, using the <a href="../connect/index.html">CONNECT</a> storage engine. This can be a good idea if many rows need be copied, because data won't be sent to an external client. </li>
<li>Periodically delete historical data. For example, rows that are older than 5 years. Nothing prevents us from doing this with an external script, but probably this wouldn't add any value. </li>
<li>Periodically delete invalid rows. In an e-commerce, they could be abandoned carts. In a messaging system, they could be messages to users that don't exist anymore. </li>
<li>Add a new <a href="../partitioning-tables/index.html">partition</a> to a table and drop the oldest one (partition rotation). </li>
</ul> <hr> <p>Content initially contributed by <a href="https://vettabase.com/">Vettabase Ltd</a>.</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/automating-mariadb-tasks-with-events/" class="_attribution-link">https://mariadb.com/kb/en/automating-mariadb-tasks-with-events/</a>
  </p>
</div>
