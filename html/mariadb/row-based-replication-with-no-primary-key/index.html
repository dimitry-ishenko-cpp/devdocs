<h1>Row-based Replication With No Primary Key</h1> <div> <div class="node creole"> <div class="answer formatted"> <div class="cstm-style bluebox text">
<p>The terms <em>master</em> and <em>slave</em> have historically been used in replication, but the terms terms <em>primary</em> and <em>replica</em> are now preferred. The old terms are used still used in parts of the documentation, and in MariaDB commands, although <a href="../what-is-mariadb-105/index.html">MariaDB 10.5</a> has begun the process of renaming. The documentation process is ongoing. See <a href="https://jira.mariadb.org/browse/MDEV-18777">MDEV-18777</a> to follow progress on this effort.</p> </div>
<p> MariaDB improves on row-based <a href="../standard-replication/index.html">replication</a> (see <a href="../binary-log-formats/index.html">binary log formats</a>) of tables which have no primary key but do have some other index. This is based in part on the original Percona patch "row_based_replication_without_primary_key.patch", with some additional fixes and enhancements.</p> <p>When row-based replication is used with <a href="../update/index.html">UPDATE</a> or <a href="../delete/index.html">DELETE</a>, the slave needs to locate each replicated row based on the value in columns. If the table contains at least one index, an index lookup will be used (otherwise a table scan is needed for each row, which is extremely inefficient for all but the smallest table and generally to be avoided).</p> <p>In MariaDB, the slave will try to choose a good index among any available:</p> <ul start="1">
<li>The primary key is used, if there is one. </li>
<li>Else, the first unique index without NULL-able columns is used, if there is one. </li>
<li>Else, a choice is made among any normal indexes on the table (e.g. a <a href="../full-text-indexes/index.html">FULLTEXT</a> index is not considered). </li>
</ul> <p>The choice of which of several non-unique indexes to use is based on the cardinality of indexes; the one that is most selective (has the smallest average number of rows per distinct tuple of column values) is preferred. Note that for this choice to be effective, for most storage engines (like MyISAM, InnoDB) it is necessary to make sure <a href="../analyze-table/index.html">ANALYZE TABLE</a> has been run on the slave, otherwise statistics about index cardinality will not be available. In the absence of index cardinality, the first unique index will be chosen, if any, else the first non-unique index.</p> <p>Prior to <a href="../what-is-mariadb-53/index.html">MariaDB 5.3</a>, the slave would always choose the first index without considering cardinality. The slave could even choose an unusable index (like FULLTEXT) if no other index was available (<a href="http://bugs.mysql.com/bug.php?id=58997">MySQL Bug #58997</a>), causing row-based replication to break in this case; this was also fixed in <a href="../what-is-mariadb-53/index.html">MariaDB 5.3</a>.</p> <h2 class="anchored_heading" id="see-also">See Also</h2> <ul start="1"><li><a href="../what-is-mariadb-53/index.html">What is MariaDB 5.3</a></li></ul> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/row-based-replication-with-no-primary-key/" class="_attribution-link">https://mariadb.com/kb/en/row-based-replication-with-no-primary-key/</a>
  </p>
</div>
