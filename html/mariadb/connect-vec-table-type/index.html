<h1>CONNECT VEC Table Type</h1> <div> <div class="node creole"> <div class="answer formatted">  <div class="cstm-style redbox">
<p>Warning: Avoid using this table type in production applications. This file format is specific to CONNECT and may not be supported in future versions.</p> </div>
<p>Tables of type <code>VEC</code> are binary files that in some cases can provide good performance on read-intensive query workloads. CONNECT organizes their data on disk as columns of values from the same attribute, as opposed to storing it as rows of tabular records. This organization means that when a query needs to access only a few columns of a particular table, only those columns need to be read from disk. Conversely, in a row-oriented table, all values in a table are typically read from disk, wasting I/O bandwidth.</p> <p>CONNECT provides two integral VEC formats, in which each column's data is adjacent.</p> <h2 class="anchored_heading" id="integral-vector-formats">Integral vector formats</h2> <p>In these true vertical formats, the VEC files are made of all the data of the first column, followed by all the data of the second column etc. All this can be in one physical file or each column data can be in a separate file. In the first case, the option max_rows=m, where m is the estimate of the maximum size (number of rows) of the table, must be specified to be able to insert some new records. This leaves an empty space after each column area in which new data can be inserted. In the second case, the “Split” option can be specified<sup class="reference" id="_ref-1">[<a href="#_note-1">2</a>]</sup> at table creation and each column will be stored in a file named sequentially from the table file name followed by the rank of the column. Inserting new lines can freely augment such a table.</p> <h2 class="anchored_heading" id="differences-between-vector-formats">Differences between vector formats</h2> <p>These formats correspond to different needs. The integral vector format provides the best performance gain. It will be chosen when the speed of decisional queries must be optimized.</p> <p>In the case of a unique file, inserting new data will be limited but there will be only one open and close to do. However, the size of the table cannot be calculated from the file size because of the eventual unused space in the file. It must be kept in a header containing the maximum number of rows and the current number of valid rows in the table. To achieve this, specify the option Header=<em>n</em> when creating the table. If <code>n=1</code> the header will be placed at the beginning of the file, if <code>n=2</code> it will be a separate file with the type ‘.blk’, and if <code>n=3</code> the header will be place at the end of the file. This last value is provided because batch inserting is sometimes slower when the header is at the beginning of the file. If not specified, the header option will default to 2 for this table type.</p> <p>On the other hand, the "Split" format with separate files have none of these issues, and is a much safer solution when the table must frequently inserted or shared among several users.</p> <p>For instance:</p> <pre class="fixed" data-language="sql">create table vtab (
a int not null,
b char(10) not null)
engine=CONNECT table_type=VEC file_name='vt.vec'; 
</pre>
<p>This table, split by default, will have the column values in files vt1.vec and vt2.vec.</p> <p>For vector tables, the option <em>block_size=n</em> is used for block reading and writing; however, to have a file made of blocks of equal size, the internal value of the <em>max_rows=m</em> option is eventually increased to become a multiple of n.</p> <p>Like for BIN tables, numeric values are stored using platform internal layout, the correspondence between column types and internal format being the same than the default ones given above for BIN. However, field formats are not available for VEC tables.</p> <h2 class="anchored_heading" id="header-option">Header option</h2> <p>This applies to VEC tables that are not split. Because the file size depends on the MAX_ROWS value, CONNECT cannot know how many valid records exist in the file. Depending on the value of the HEADER option, this information is stored in a header that can be placed at the beginning of the file, at the end of the file or in a separate file called fn.blk. The valid values for the HEADER option are:</p> <table>
<tr>
<td>0</td>
<td>Defaults to 2 for standard tables and to 3 for inward tables.</td>
</tr> <tr>
<td>1</td>
<td>The header is at the beginning of the file.</td>
</tr> <tr>
<td>2</td>
<td>The header is in a separate file.</td>
</tr> <tr>
<td>3</td>
<td>The header is at the end of the file.</td>
</tr> </table> <p>The value 2 can be used when dealing with files created by another application with no header. The value 3 makes sometimes inserting in the file faster than when the header is at the beginning of the file.</p> <p>Note: VEC being a file format specific to CONNECT, no big endian / little endian conversion is provided. These files are not portable between machines using a different byte order setting.</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/connect-vec-table-type/" class="_attribution-link">https://mariadb.com/kb/en/connect-vec-table-type/</a>
  </p>
</div>
