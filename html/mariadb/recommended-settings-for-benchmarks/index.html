<h1>Recommended Settings for Benchmarks</h1> <div> <div class="node creole"> <div class="answer formatted">  <p>Running benchmarks requires a lot of different settings. In this article we collect our best known settings and recommendations.</p> <h2 class="anchored_heading" id="hardware-and-bios-settings">Hardware and BIOS Settings</h2> <p>We have had good experiences with Intel's hyperthreading on newer Xeon CPUs. Please turn on hyperthreading in your BIOS.</p> <h2 class="anchored_heading" id="numa">NUMA</h2> <p>The NUMA architecture attaches resources (most important: memory) to individual NUMA nodes (typically: NUMA node = cpu socket). This results in a performance penalty when a cpu core from one NUMA node accesses memory from another NUMA node.</p> <p>The NUMA topology can be checked with the <em>numactl</em> command:</p> <pre class="fixed" data-language="sql">~ $numactl --hardware
available: 2 nodes (0-1)
node 0 cpus: 0 1 2 3 4 5 12 13 14 15 16 17
node 0 size: 12278 MB
node 0 free: 11624 MB
node 1 cpus: 6 7 8 9 10 11 18 19 20 21 22 23
node 1 size: 12288 MB
node 1 free: 11778 MB
node distances:
node   0   1 
  0:  10  21 
  1:  21  10 
</pre>
<p>The Linux kernel uses ACPI tables from BIOS to detect if the hardware is NUMA. On NUMA hardware extra optimizations kick in:</p> <ul start="1"><li>if a task has been scheduled on a certain NUMA node, the scheduler tries to put it on the same node again in the future </li></ul> <ul start="1"><li>if a task running on a certain NUMA node allocates memory, the kernel tries hard to map physical memory from the same NUMA node </li></ul> <p>This results in all kinds of weird behavior when you run one big process (mysqld) that consumes most of the memory. In such cases it is recommended to either turn off NUMA (BIOS or kernel command line) or prefix such problem processes with <em>numactl --interleave all</em>. You can enable this by running <a href="../mysqld_safe/index.html">mysqld_safe</a> with the <code>--numa-interleave</code> option.</p> <p><a href="http://blog.jcole.us/2010/09/28/mysql-swap-insanity-and-the-numa-architecture/">More details can be found here</a>.</p> <h2 class="anchored_heading" id="linux-kernel-settings">Linux Kernel Settings</h2> <p>See <a href="../configuring-linux-for-mariadb/index.html">configuring Linux for MariaDB</a>.</p> <h2 class="anchored_heading" id="innodb-settings">InnoDB Settings</h2> <p><a href="../server-system-variables/index.html#innodb_buffer_pool_size">innodb_buffer_pool_size</a> to about 80% of RAM or leaving &lt;5G RAM free (on large RAM systems). Less if lots of connections are used.</p> <p><a href="../server-system-variables/index.html#innodb_log_file_size">innodb_log_file_size</a> to be larger than the amount of writes in the test run or sufficient to cover several minutes of the test run at least.</p> <h2 class="anchored_heading" id="myisam-settings">MyISAM Settings</h2> <h2 class="anchored_heading" id="general-settings">General Settings</h2> <p><a href="../server-system-variables/index.html#threads_cache_size">threads_cache_size</a> should be the same as <a href="../server-system-variables/index.html#max_connections">max_connections</a> (unless using thread pools).</p> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/recommended-settings-for-benchmarks/" class="_attribution-link">https://mariadb.com/kb/en/recommended-settings-for-benchmarks/</a>
  </p>
</div>
