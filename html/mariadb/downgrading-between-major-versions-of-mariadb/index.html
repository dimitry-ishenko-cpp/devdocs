<h1>Downgrading between Major Versions of MariaDB</h1> <div> <div class="node creole"> <div class="answer formatted"> <p>Downgrading MariaDB is not officially supported between major versions.</p> <p>For minor versions, upgrade is supported to an earlier <a href="../release-criteria/index.html#commitment-for-gammarc-releases">gamma/RC/GA</a> version as we do not change the storage format after <a href="../release-criteria/index.html#commitment-for-alpha-releases">Alpha</a> and very rarely during <a href="../release-criteria/index.html#commitment-for-beta-releases">Beta</a> (it has to be a very critical bug to require such a change). There are a few very rare cases when incompatible changes happen on a GA version, for example <a href="https://mariadb.com/kb/en/mariadb-10121-release-notes/">MariaDB 10.1.21</a> fixed a file format incompatibility bug that prevents a downgrade to earlier <a href="../what-is-mariadb-101/index.html">MariaDB 10.1</a> releases. After <a href="https://mariadb.com/kb/en/mariadb-10121-release-notes/">MariaDB 10.1.21</a> this has not happened in a GA release.</p> <p>The main reason why downgrades between major versions do not work are:</p> <ul start="1">
<li>Changes in the privilege/status tables in the <a href="../the-mysql-database-tables/index.html">mysql schema</a>. These changes happen between most major versions as we are continuously improving the privilege system. </li>
<li>Changes that affect how data is stored on disk. This happens more rarely and is usually table specific. For example, if one has used <a href="../instant-add-column-for-innodb/index.html">Instant add column</a> on a table in <a href="../what-is-mariadb-103/index.html">MariaDB 10.3</a>, that table cannot be opened in <a href="../what-is-mariadb-102/index.html">MariaDB 10.2</a>. </li>
<li>Between major releases there are often substantial changes, even if none of the new features are used. For example, both <a href="../what-is-mariadb-102/index.html">MariaDB 10.2</a> and <a href="../what-is-mariadb-103/index.html">MariaDB 10.3</a> introduce new versions of the redo log. </li>
</ul> <p>The only reliable way to downgrade is to <a href="../backing-up-and-restoring-databases/index.html">restore from a full backup</a> made before upgrading, and start the old version of MariaDB. At least one should take a backup of the <a href="../the-mysql-database-tables/index.html">mysql</a> schema as most upgrade changes happens in this directory. This may be of help if one needs to downgrade to an earlier MariaDB version. More about this later.</p> <p>Some people have reported successfully downgrading, but there are many possible things that can go wrong, and downgrading between two major versions is not tested in any way by the MariaDB developers.</p> <p>In general, one can downgrade a major version to an earlier version if one has not yet run <a href="../mariadb-upgrade/index.html">mariadb-upgrade</a> on the new version. Note however that it's recommended that one always uses <a href="../mariadb-upgrade/index.html">mariadb-upgrade</a> after upgrading to a new major version as otherwise some security features in the new server may not work and tables that have indexes using a character collation that has changed may not work properly.</p> <p>Assuming one <strong>must</strong> downgrade to an earlier major version, here is a list of things one has to do:</p> <ul start="1">
<li>MariaDB <strong>must</strong> be shut down cleanly. This means that: <ul start="1">
<li>One should ensure that <a href="../innodb-system-variables/index.html#innodb_fast_shutdown">innodb_fast_shutdown is set to 0</a>. </li>
<li>One uses the <a href="../shutdown/index.html">SHUTDOWN</a> command, <a href="../mariadb-admin/index.html">mariadb-admin shutdown</a> or the operating system official commands, like <a href="../systemd/index.html#stopping-the-mariadb-server-process">systemctl stop mariadb.service</a>. </li>
</ul> </li>
<li>Start the old server with <a href="../mariadbd-options/index.html#-skip-grant-tables">--skip-privilege-tables</a>. </li>
<li>Use ALTER TABLE to restore the <a href="../the-mysql-database-tables/index.html">mysql schema tables</a> to their original definition or drop and recreate the mysql tables. One can find the old definition by using <a href="../mariadb-install-db/index.html">mariadb-install-db</a> to create a separate temporary data directory. Starting the MariaDB server on the temporary directory will allow you to use <a href="../show-create-table/index.html">SHOW CREATE TABLE</a> to find the old definition. </li>
<li>Execute <a href="../flush/index.html">FLUSH PRIVILEGES</a> to reload the old tables. </li>
</ul> <p>The cases when the above will not work are when the table format has changed in an incompatible manner. In this case the affected tables may not be usable in the earlier version.</p> <p>The following is an incomplete list of when one will not be able to use a table in an earlier major version:</p> <ul start="1">
<li>
<a href="../what-is-mariadb-104/index.html">MariaDB 10.4</a> -&gt; <a href="../what-is-mariadb-103/index.html">MariaDB 10.3</a> <ul start="1">
<li>Any InnoDB table where one has used <code>ALTER TABLE ALGORITHM=INSTANT DROP COLUMN</code> </li>
<li>In <a href="../what-is-mariadb-104/index.html">MariaDB 10.4</a>, the MariaDB mysql.user table was replaced by <a href="../mysql-user-table/index.html">mysql.global_priv table</a> which may cause problems if ones wants to downgrade to 10.3. </li>
</ul> </li>
<li>
<a href="../what-is-mariadb-103/index.html">MariaDB 10.3</a> -&gt; <a href="../what-is-mariadb-102/index.html">MariaDB 10.2</a> <ul start="1"><li>Any InnoDB table where one has used <code>ALTER TABLE ALGORITHM=INSTANT ADD COLUMN</code>.</li></ul> </li>
</ul> </div>     </div> <div id="content_disclaimer" class="graybox"> Content reproduced on this site is the property of its respective owners, and this content is not reviewed in advance by MariaDB. The views, information and opinions expressed by this content do not necessarily represent those of MariaDB or any other party. </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2023 MariaDB<br>Licensed under the Creative Commons Attribution 3.0 Unported License and the GNU Free Documentation License.<br>
    <a href="https://mariadb.com/kb/en/downgrading-between-major-versions-of-mariadb/" class="_attribution-link">https://mariadb.com/kb/en/downgrading-between-major-versions-of-mariadb/</a>
  </p>
</div>
