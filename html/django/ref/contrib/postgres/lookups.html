<section id="s-postgresql-specific-lookups"> <h1 id="postgresql-specific-lookups">PostgreSQL specific lookups</h1> <section id="s-trigram-similarity"> <h2 id="trigram-similarity">Trigram similarity</h2> <section id="s-trigram-similar"> <h3 id="std-fieldlookup-trigram_similar"><code>trigram_similar</code></h3> <p>The <code>trigram_similar</code> lookup allows you to perform trigram lookups, measuring the number of trigrams (three consecutive characters) shared, using a dedicated PostgreSQL extension. A trigram lookup is given an expression and returns results that have a similarity measurement greater than the current similarity threshold.</p> <p>To use it, add <code>'django.contrib.postgres'</code> in your <a class="reference internal" href="../../settings.html#std-setting-INSTALLED_APPS"><code>INSTALLED_APPS</code></a> and activate the <a class="reference external" href="https://www.postgresql.org/docs/current/pgtrgm.html">pg_trgm extension</a> on PostgreSQL. You can install the extension using the <a class="reference internal" href="operations.html#django.contrib.postgres.operations.TrigramExtension" title="django.contrib.postgres.operations.TrigramExtension"><code>TrigramExtension</code></a> migration operation.</p> <p>The <code>trigram_similar</code> lookup can be used on <a class="reference internal" href="../../models/fields.html#django.db.models.CharField" title="django.db.models.CharField"><code>CharField</code></a> and <a class="reference internal" href="../../models/fields.html#django.db.models.TextField" title="django.db.models.TextField"><code>TextField</code></a>:</p> <pre data-language="pycon">&gt;&gt;&gt; City.objects.filter(name__trigram_similar="Middlesborough")
['&lt;City: Middlesbrough&gt;']
</pre> </section> <section id="s-trigram-word-similar"> <h3 id="std-fieldlookup-trigram_word_similar"><code>trigram_word_similar</code></h3> <p>The <code>trigram_word_similar</code> lookup allows you to perform trigram word similarity lookups using a dedicated PostgreSQL extension. It can be approximately understood as measuring the greatest number of trigrams shared between the parameter and any substring of the field. A trigram word lookup is given an expression and returns results that have a word similarity measurement greater than the current similarity threshold.</p> <p>To use it, add <code>'django.contrib.postgres'</code> in your <a class="reference internal" href="../../settings.html#std-setting-INSTALLED_APPS"><code>INSTALLED_APPS</code></a> and activate the <a class="reference external" href="https://www.postgresql.org/docs/current/pgtrgm.html">pg_trgm extension</a> on PostgreSQL. You can install the extension using the <a class="reference internal" href="operations.html#django.contrib.postgres.operations.TrigramExtension" title="django.contrib.postgres.operations.TrigramExtension"><code>TrigramExtension</code></a> migration operation.</p> <p>The <code>trigram_word_similar</code> lookup can be used on <a class="reference internal" href="../../models/fields.html#django.db.models.CharField" title="django.db.models.CharField"><code>CharField</code></a> and <a class="reference internal" href="../../models/fields.html#django.db.models.TextField" title="django.db.models.TextField"><code>TextField</code></a>:</p> <pre data-language="pycon">&gt;&gt;&gt; Sentence.objects.filter(name__trigram_word_similar="Middlesborough")
['&lt;Sentence: Gumby rides on the path of Middlesbrough&gt;']
</pre> </section> <section id="s-trigram-strict-word-similar"> <h3 id="std-fieldlookup-trigram_strict_word_similar"><code>trigram_strict_word_similar</code></h3> <p>Similar to <a class="reference internal" href="#std-fieldlookup-trigram_word_similar"><code>trigram_word_similar</code></a>, except that it forces extent boundaries to match word boundaries.</p> <p>To use it, add <code>'django.contrib.postgres'</code> in your <a class="reference internal" href="../../settings.html#std-setting-INSTALLED_APPS"><code>INSTALLED_APPS</code></a> and activate the <a class="reference external" href="https://www.postgresql.org/docs/current/pgtrgm.html">pg_trgm extension</a> on PostgreSQL. You can install the extension using the <a class="reference internal" href="operations.html#django.contrib.postgres.operations.TrigramExtension" title="django.contrib.postgres.operations.TrigramExtension"><code>TrigramExtension</code></a> migration operation.</p> <p>The <code>trigram_strict_word_similar</code> lookup can be used on <a class="reference internal" href="../../models/fields.html#django.db.models.CharField" title="django.db.models.CharField"><code>CharField</code></a> and <a class="reference internal" href="../../models/fields.html#django.db.models.TextField" title="django.db.models.TextField"><code>TextField</code></a>.</p> </section> </section> <section id="s-unaccent"> <h2 id="unaccent"><code>Unaccent</code></h2> <p id="std-fieldlookup-unaccent">The <code>unaccent</code> lookup allows you to perform accent-insensitive lookups using a dedicated PostgreSQL extension.</p> <p>This lookup is implemented using <a class="reference internal" href="../../models/lookups.html#django.db.models.Transform" title="django.db.models.Transform"><code>Transform</code></a>, so it can be chained with other lookup functions. To use it, you need to add <code>'django.contrib.postgres'</code> in your <a class="reference internal" href="../../settings.html#std-setting-INSTALLED_APPS"><code>INSTALLED_APPS</code></a> and activate the <a class="reference external" href="https://www.postgresql.org/docs/current/unaccent.html">unaccent extension on PostgreSQL</a>. The <a class="reference internal" href="operations.html#django.contrib.postgres.operations.UnaccentExtension" title="django.contrib.postgres.operations.UnaccentExtension"><code>UnaccentExtension</code></a> migration operation is available if you want to perform this activation using migrations).</p> <p>The <code>unaccent</code> lookup can be used on <a class="reference internal" href="../../models/fields.html#django.db.models.CharField" title="django.db.models.CharField"><code>CharField</code></a> and <a class="reference internal" href="../../models/fields.html#django.db.models.TextField" title="django.db.models.TextField"><code>TextField</code></a>:</p> <pre data-language="pycon">&gt;&gt;&gt; City.objects.filter(name__unaccent="México")
['&lt;City: Mexico&gt;']

&gt;&gt;&gt; User.objects.filter(first_name__unaccent__startswith="Jerem")
['&lt;User: Jeremy&gt;', '&lt;User: Jérémy&gt;', '&lt;User: Jérémie&gt;', '&lt;User: Jeremie&gt;']
</pre> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p><code>unaccent</code> lookups should perform fine in most use cases. However, queries using this filter will generally perform full table scans, which can be slow on large tables. In those cases, using dedicated full text indexing tools might be appropriate.</p> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; Django Software Foundation and individual contributors<br>Licensed under the BSD License.<br>
    <a href="https://docs.djangoproject.com/en/5.2/ref/contrib/postgres/lookups/" class="_attribution-link">https://docs.djangoproject.com/en/5.2/ref/contrib/postgres/lookups/</a>
  </p>
</div>
