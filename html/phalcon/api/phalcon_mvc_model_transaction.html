<h1 id="class-phalcon-mvc-model-transaction">Class <strong>Phalcon\Mvc\Model\Transaction</strong>
</h1> <p><em>implements</em> <a class="reference internal" href="phalcon_mvc_model_transactioninterface.html"><em>Phalcon\Mvc\Model\TransactionInterface</em></a></p> <p><span class="raw-html"><a href="https://github.com/phalcon/cphalcon/blob/master/phalcon/mvc/model/transaction.zep" class="btn btn-default btn-sm">Source on GitHub</a></span></p> <p>Transactions are protective blocks where SQL statements are only permanent if they can all succeed as one atomic action. Phalcon\Transaction is intended to be used with Phalcon_Model_Base. Phalcon Transactions should be created using Phalcon\Transaction\Manager.</p> <pre class="highlight-php" data-language="php">try {
    $manager = new \Phalcon\Mvc\Model\Transaction\Manager();

    $transaction = $manager-&gt;get();

    $robot = new Robots();

    $robot-&gt;setTransaction($transaction);

    $robot-&gt;name       = "WALLÂ·E";
    $robot-&gt;created_at = date("Y-m-d");

    if ($robot-&gt;save() === false) {
        $transaction-&gt;rollback("Can't save robot");
    }

    $robotPart = new RobotParts();

    $robotPart-&gt;setTransaction($transaction);

    $robotPart-&gt;type = "head";

    if ($robotPart-&gt;save() === false) {
        $transaction-&gt;rollback("Can't save robot part");
    }

    $transaction-&gt;commit();
} catch(Phalcon\Mvc\Model\Transaction\Failed $e) {
    echo "Failed, reason: ", $e-&gt;getMessage();
}
</pre>  <h2 id="methods">Methods</h2> <h3 id="__construct" class="method-signature">public <strong>__construct</strong> (<a class="reference internal" href="phalcon_diinterface.html"><em>Phalcon\DiInterface</em></a> $dependencyInjector, [<em>boolean</em> $autoBegin], [<em>string</em> $service])</h3> <p>Phalcon\Mvc\Model\Transaction constructor</p> <h3 id="settransactionmanager" class="method-signature">public <strong>setTransactionManager</strong> (<a class="reference internal" href="phalcon_mvc_model_transaction_managerinterface.html"><em>Phalcon\Mvc\Model\Transaction\ManagerInterface</em></a> $manager)</h3> <p>Sets transaction manager related to the transaction</p> <h3 id="begin" class="method-signature">public <strong>begin</strong> ()</h3> <p>Starts the transaction</p> <h3 id="commit" class="method-signature">public <strong>commit</strong> ()</h3> <p>Commits the transaction</p> <h3 id="rollback" class="method-signature">public <em>boolean</em> <strong>rollback</strong> ([<em>string</em> $rollbackMessage], [<a class="reference internal" href="phalcon_mvc_modelinterface.html"><em>Phalcon\Mvc\ModelInterface</em></a> $rollbackRecord])</h3> <p>Rollbacks the transaction</p> <h3 id="getconnection" class="method-signature">public <strong>getConnection</strong> ()</h3> <p>Returns the connection related to transaction</p> <h3 id="setisnewtransaction" class="method-signature">public <strong>setIsNewTransaction</strong> (<em>mixed</em> $isNew)</h3> <p>Sets if is a reused transaction or new once</p> <h3 id="setrollbackonabort" class="method-signature">public <strong>setRollbackOnAbort</strong> (<em>mixed</em> $rollbackOnAbort)</h3> <p>Sets flag to rollback on abort the HTTP connection</p> <h3 id="ismanaged" class="method-signature">public <strong>isManaged</strong> ()</h3> <p>Checks whether transaction is managed by a transaction manager</p> <h3 id="getmessages" class="method-signature">public <strong>getMessages</strong> ()</h3> <p>Returns validations messages from last save try</p> <h3 id="isvalid" class="method-signature">public <strong>isValid</strong> ()</h3> <p>Checks whether internal connection is under an active transaction</p> <h3 id="setrollbackedrecord" class="method-signature">public <strong>setRollbackedRecord</strong> (<a class="reference internal" href="phalcon_mvc_modelinterface.html"><em>Phalcon\Mvc\ModelInterface</em></a> $record)</h3> <p>Sets object which generates rollback action</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2011&ndash;2017 Phalcon Framework Team<br>Licensed under the Creative Commons Attribution License 3.0.<br>
    <a href="https://docs.phalconphp.com/en/latest/api/Phalcon_Mvc_Model_Transaction.html" class="_attribution-link">https://docs.phalconphp.com/en/latest/api/Phalcon_Mvc_Model_Transaction.html</a>
  </p>
</div>
