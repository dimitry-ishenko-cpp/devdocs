<h1>Production-ready Features</h1> <div id="preamble"> <div class="sectionbody"> <div class="paragraph"> <p>Spring Boot includes a number of additional features to help you monitor and manage your application when you push it to production. You can choose to manage and monitor your application by using HTTP endpoints or with JMX. Auditing, health, and metrics gathering can also be automatically applied to your application.</p> </div> </div> </div> <div class="sect1"> <h2 id="actuator.enabling">
1. Enabling Production-ready Features</h2> <div class="sectionbody"> <div class="paragraph"> <p>The <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator"><code>spring-boot-actuator</code></a> module provides all of Spring Boot’s production-ready features. The recommended way to enable the features is to add a dependency on the <code>spring-boot-starter-actuator</code> “Starter”.</p> </div> <div class="sidebarblock"> <div class="content"> <div class="title">Definition of Actuator</div> <div class="paragraph"> <p>An actuator is a manufacturing term that refers to a mechanical device for moving or controlling something. Actuators can generate a large amount of motion from a small change.</p> </div> </div> </div> <div class="paragraph"> <p>To add the actuator to a Maven-based project, add the following “Starter” dependency:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="xml"><code class="language-xml" data-lang="xml">&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre> </div> </div> <div class="paragraph"> <p>For Gradle, use the following declaration:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="gradle"><code class="language-gradle" data-lang="gradle">dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
}</code></pre> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.endpoints">
2. Endpoints</h2> <div class="sectionbody"> <div class="paragraph"> <p>Actuator endpoints let you monitor and interact with your application. Spring Boot includes a number of built-in endpoints and lets you add your own. For example, the <code>health</code> endpoint provides basic application health information.</p> </div> <div class="paragraph"> <p>You can <a href="#actuator.endpoints.enabling">enable or disable</a> each individual endpoint and <a href="#actuator.endpoints.exposing">expose them (make them remotely accessible) over HTTP or JMX</a>. An endpoint is considered to be available when it is both enabled and exposed. The built-in endpoints are auto-configured only when they are available. Most applications choose exposure over HTTP, where the ID of the endpoint and a prefix of <code>/actuator</code> is mapped to a URL. For example, by default, the <code>health</code> endpoint is mapped to <code>/actuator/health</code>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> To learn more about the Actuator’s endpoints and their request and response formats, see the separate API documentation (<a href="https://docs.spring.io/spring-boot/docs/3.1.3/actuator-api/htmlsingle">HTML</a> or <a href="https://docs.spring.io/spring-boot/docs/3.1.3/actuator-api/pdf/spring-boot-actuator-web-api.pdf">PDF</a>). </td> </tr> </table> </div> <div class="paragraph"> <p>The following technology-agnostic endpoints are available:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 28.5714%;"> <col style="width: 71.4286%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">ID</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>auditevents</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes audit events information for the current application. Requires an <code>AuditEventRepository</code> bean.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>beans</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Displays a complete list of all the Spring beans in your application.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>caches</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes available caches.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>conditions</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows the conditions that were evaluated on configuration and auto-configuration classes and the reasons why they did or did not match.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>configprops</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Displays a collated list of all <code>@ConfigurationProperties</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>env</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes properties from Spring’s <code>ConfigurableEnvironment</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>flyway</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows any Flyway database migrations that have been applied. Requires one or more <code>Flyway</code> beans.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>health</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows application health information.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>httpexchanges</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Displays HTTP exchange information (by default, the last 100 HTTP request-response exchanges). Requires an <code>HttpExchangeRepository</code> bean.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>info</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Displays arbitrary application info.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>integrationgraph</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows the Spring Integration graph. Requires a dependency on <code>spring-integration-core</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>loggers</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows and modifies the configuration of loggers in the application.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>liquibase</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows any Liquibase database migrations that have been applied. Requires one or more <code>Liquibase</code> beans.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>metrics</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows “metrics” information for the current application.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mappings</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Displays a collated list of all <code>@RequestMapping</code> paths.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>quartz</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows information about Quartz Scheduler jobs.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>scheduledtasks</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Displays the scheduled tasks in your application.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>sessions</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Allows retrieval and deletion of user sessions from a Spring Session-backed session store. Requires a servlet-based web application that uses Spring Session.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>shutdown</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Lets the application be gracefully shutdown. Only works when using jar packaging. Disabled by default.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>startup</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shows the <a href="features.html#features.spring-application.startup-tracking">startup steps data</a> collected by the <code>ApplicationStartup</code>. Requires the <code>SpringApplication</code> to be configured with a <code>BufferingApplicationStartup</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>threaddump</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Performs a thread dump.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>If your application is a web application (Spring MVC, Spring WebFlux, or Jersey), you can use the following additional endpoints:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 28.5714%;"> <col style="width: 71.4286%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">ID</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>heapdump</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Returns a heap dump file. On a HotSpot JVM, an <code>HPROF</code>-format file is returned. On an OpenJ9 JVM, a <code>PHD</code>-format file is returned.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>logfile</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Returns the contents of the logfile (if the <code>logging.file.name</code> or the <code>logging.file.path</code> property has been set). Supports the use of the HTTP <code>Range</code> header to retrieve part of the log file’s content.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>prometheus</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes metrics in a format that can be scraped by a Prometheus server. Requires a dependency on <code>micrometer-registry-prometheus</code>.</p></td> </tr> </tbody> </table> <div class="sect2"> <h3 id="actuator.endpoints.enabling">
2.1. Enabling Endpoints</h3> <div class="paragraph"> <p>By default, all endpoints except for <code>shutdown</code> are enabled. To configure the enablement of an endpoint, use its <code>management.endpoint.&lt;id&gt;.enabled</code> property. The following example enables the <code>shutdown</code> endpoint:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.shutdown.enabled=true</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    shutdown:
      enabled: true</code></pre> </div> </div> <div class="paragraph"> <p>If you prefer endpoint enablement to be opt-in rather than opt-out, set the <code>management.endpoints.enabled-by-default</code> property to <code>false</code> and use individual endpoint <code>enabled</code> properties to opt back in. The following example enables the <code>info</code> endpoint and disables all other endpoints:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.enabled-by-default=false
management.endpoint.info.enabled=true</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    enabled-by-default: false
  endpoint:
    info:
      enabled: true</code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Disabled endpoints are removed entirely from the application context. If you want to change only the technologies over which an endpoint is exposed, use the <a href="#actuator.endpoints.exposing"><code>include</code> and <code>exclude</code> properties</a> instead. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.exposing">
2.2. Exposing Endpoints</h3> <div class="paragraph"> <p>By default, only the health endpoint is exposed over HTTP and JMX. Since Endpoints may contain sensitive information, you should carefully consider when to expose them.</p> </div> <div class="paragraph"> <p>To change which endpoints are exposed, use the following technology-specific <code>include</code> and <code>exclude</code> properties:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 75%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Property</th> <th class="tableblock halign-left valign-top">Default</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.endpoints.jmx.exposure.exclude</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.endpoints.jmx.exposure.include</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>health</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.endpoints.web.exposure.exclude</code></p></td> <td class="tableblock halign-left valign-top"></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.endpoints.web.exposure.include</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>health</code></p></td> </tr> </tbody> </table> <div class="paragraph"> <p>The <code>include</code> property lists the IDs of the endpoints that are exposed. The <code>exclude</code> property lists the IDs of the endpoints that should not be exposed. The <code>exclude</code> property takes precedence over the <code>include</code> property. You can configure both the <code>include</code> and the <code>exclude</code> properties with a list of endpoint IDs.</p> </div> <div class="paragraph"> <p>For example, to only expose the <code>health</code> and <code>info</code> endpoints over JMX, use the following property:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.jmx.exposure.include=health,info</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    jmx:
      exposure:
        include: "health,info"</code></pre> </div> </div> <div class="paragraph"> <p><code>*</code> can be used to select all endpoints. For example, to expose everything over HTTP except the <code>env</code> and <code>beans</code> endpoints, use the following properties:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.exposure.include=*
management.endpoints.web.exposure.exclude=env,beans</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      exposure:
        include: "*"
        exclude: "env,beans"</code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> <code>*</code> has a special meaning in YAML, so be sure to add quotation marks if you want to include (or exclude) all endpoints. </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> If your application is exposed publicly, we strongly recommend that you also <a href="#actuator.endpoints.security">secure your endpoints</a>. </td> </tr> </table> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> If you want to implement your own strategy for when endpoints are exposed, you can register an <code>EndpointFilter</code> bean. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.security">
2.3. Security</h3> <div class="paragraph"> <p>For security purposes, only the <code>/health</code> endpoint is exposed over HTTP by default. You can use the <code>management.endpoints.web.exposure.include</code> property to configure the endpoints that are exposed.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Before setting the <code>management.endpoints.web.exposure.include</code>, ensure that the exposed actuators do not contain sensitive information, are secured by placing them behind a firewall, or are secured by something like Spring Security. </td> </tr> </table> </div> <div class="paragraph"> <p>If Spring Security is on the classpath and no other <code>SecurityFilterChain</code> bean is present, all actuators other than <code>/health</code> are secured by Spring Boot auto-configuration. If you define a custom <code>SecurityFilterChain</code> bean, Spring Boot auto-configuration backs off and lets you fully control the actuator access rules.</p> </div> <div class="paragraph"> <p>If you wish to configure custom security for HTTP endpoints (for example, to allow only users with a certain role to access them), Spring Boot provides some convenient <code>RequestMatcher</code> objects that you can use in combination with Spring Security.</p> </div> <div class="paragraph"> <p>A typical Spring Security configuration might look something like the following example:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

import static org.springframework.security.config.Customizer.withDefaults;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MySecurityConfiguration {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http.securityMatcher(EndpointRequest.toAnyEndpoint());
        http.authorizeHttpRequests((requests) -&gt; requests.anyRequest().hasRole("ENDPOINT_ADMIN"));
        http.httpBasic(withDefaults());
        return http.build();
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.config.Customizer.withDefaults
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.web.SecurityFilterChain

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MySecurityConfiguration {

    @Bean
    fun securityFilterChain(http: HttpSecurity): SecurityFilterChain {
        http.securityMatcher(EndpointRequest.toAnyEndpoint()).authorizeHttpRequests { requests -&gt;
            requests.anyRequest().hasRole("ENDPOINT_ADMIN")
        }
        http.httpBasic(withDefaults())
        return http.build()
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>The preceding example uses <code>EndpointRequest.toAnyEndpoint()</code> to match a request to any endpoint and then ensures that all have the <code>ENDPOINT_ADMIN</code> role. Several other matcher methods are also available on <code>EndpointRequest</code>. See the API documentation (<a href="https://docs.spring.io/spring-boot/docs/3.1.3/actuator-api/htmlsingle">HTML</a> or <a href="https://docs.spring.io/spring-boot/docs/3.1.3/actuator-api/pdf/spring-boot-actuator-web-api.pdf">PDF</a>) for details.</p> </div> <div class="paragraph"> <p>If you deploy applications behind a firewall, you may prefer that all your actuator endpoints can be accessed without requiring authentication. You can do so by changing the <code>management.endpoints.web.exposure.include</code> property, as follows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.exposure.include=*</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      exposure:
        include: "*"</code></pre> </div> </div> <div class="paragraph"> <p>Additionally, if Spring Security is present, you would need to add custom security configuration that allows unauthenticated access to the endpoints, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.web.SecurityFilterChain;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MySecurityConfiguration {

    @Bean
    public SecurityFilterChain securityFilterChain(HttpSecurity http) throws Exception {
        http.securityMatcher(EndpointRequest.toAnyEndpoint());
        http.authorizeHttpRequests((requests) -&gt; requests.anyRequest().permitAll());
        return http.build();
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.autoconfigure.security.servlet.EndpointRequest
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import org.springframework.security.config.annotation.web.builders.HttpSecurity
import org.springframework.security.web.SecurityFilterChain

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MySecurityConfiguration {

    @Bean
    fun securityFilterChain(http: HttpSecurity): SecurityFilterChain {
        http.securityMatcher(EndpointRequest.toAnyEndpoint()).authorizeHttpRequests { requests -&gt;
            requests.anyRequest().permitAll()
        }
        return http.build()
    }

}
</span></code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> In both of the preceding examples, the configuration applies only to the actuator endpoints. Since Spring Boot’s security configuration backs off completely in the presence of any <code>SecurityFilterChain</code> bean, you need to configure an additional <code>SecurityFilterChain</code> bean with rules that apply to the rest of the application. </td> </tr> </table> </div> <div class="sect3"> <h4 id="actuator.endpoints.security.csrf">
2.3.1. Cross Site Request Forgery Protection</h4> <div class="paragraph"> <p>Since Spring Boot relies on Spring Security’s defaults, CSRF protection is turned on by default. This means that the actuator endpoints that require a <code>POST</code> (shutdown and loggers endpoints), a <code>PUT</code>, or a <code>DELETE</code> get a 403 (forbidden) error when the default security configuration is in use.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> We recommend disabling CSRF protection completely only if you are creating a service that is used by non-browser clients. </td> </tr> </table> </div> <div class="paragraph"> <p>You can find additional information about CSRF protection in the <a href="https://docs.spring.io/spring-security/reference/6.1.3/features/exploits/csrf.html">Spring Security Reference Guide</a>.</p> </div> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.caching">
2.4. Configuring Endpoints</h3> <div class="paragraph"> <p>Endpoints automatically cache responses to read operations that do not take any parameters. To configure the amount of time for which an endpoint caches a response, use its <code>cache.time-to-live</code> property. The following example sets the time-to-live of the <code>beans</code> endpoint’s cache to 10 seconds:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.beans.cache.time-to-live=10s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    beans:
      cache:
        time-to-live: "10s"</code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> The <code>management.endpoint.&lt;name&gt;</code> prefix uniquely identifies the endpoint that is being configured. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.hypermedia">
2.5. Hypermedia for Actuator Web Endpoints</h3> <div class="paragraph"> <p>A “discovery page” is added with links to all the endpoints. The “discovery page” is available on <code>/actuator</code> by default.</p> </div> <div class="paragraph"> <p>To disable the “discovery page”, add the following property to your application properties:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.discovery.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      discovery:
        enabled: false</code></pre> </div> </div> <div class="paragraph"> <p>When a custom management context path is configured, the “discovery page” automatically moves from <code>/actuator</code> to the root of the management context. For example, if the management context path is <code>/management</code>, the discovery page is available from <code>/management</code>. When the management context path is set to <code>/</code>, the discovery page is disabled to prevent the possibility of a clash with other mappings.</p> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.cors">
2.6. CORS Support</h3> <div class="paragraph"> <p><a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing">Cross-origin resource sharing</a> (CORS) is a <a href="https://www.w3.org/TR/cors/">W3C specification</a> that lets you specify in a flexible way what kind of cross-domain requests are authorized. If you use Spring MVC or Spring WebFlux, you can configure Actuator’s web endpoints to support such scenarios.</p> </div> <div class="paragraph"> <p>CORS support is disabled by default and is only enabled once you have set the <code>management.endpoints.web.cors.allowed-origins</code> property. The following configuration permits <code>GET</code> and <code>POST</code> calls from the <code>example.com</code> domain:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.cors.allowed-origins=https://example.com
management.endpoints.web.cors.allowed-methods=GET,POST</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      cors:
        allowed-origins: "https://example.com"
        allowed-methods: "GET,POST"</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> See <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator-autoconfigure/src/main/java/org/springframework/boot/actuate/autoconfigure/endpoint/web/CorsEndpointProperties.java"><code>CorsEndpointProperties</code></a> for a complete list of options. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.implementing-custom">
2.7. Implementing Custom Endpoints</h3> <div class="paragraph"> <p>If you add a <code>@Bean</code> annotated with <code>@Endpoint</code>, any methods annotated with <code>@ReadOperation</code>, <code>@WriteOperation</code>, or <code>@DeleteOperation</code> are automatically exposed over JMX and, in a web application, over HTTP as well. Endpoints can be exposed over HTTP by using Jersey, Spring MVC, or Spring WebFlux. If both Jersey and Spring MVC are available, Spring MVC is used.</p> </div> <div class="paragraph"> <p>The following example exposes a read operation that returns a custom object:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java">@ReadOperation
public CustomData getData() {
    return new CustomData("test", 5);
}
</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin">@ReadOperation
fun getData(): CustomData {
    return CustomData("test", 5)
}
</code></pre> </div> </div> <div class="paragraph"> <p>You can also write technology-specific endpoints by using <code>@JmxEndpoint</code> or <code>@WebEndpoint</code>. These endpoints are restricted to their respective technologies. For example, <code>@WebEndpoint</code> is exposed only over HTTP and not over JMX.</p> </div> <div class="paragraph"> <p>You can write technology-specific extensions by using <code>@EndpointWebExtension</code> and <code>@EndpointJmxExtension</code>. These annotations let you provide technology-specific operations to augment an existing endpoint.</p> </div> <div class="paragraph"> <p>Finally, if you need access to web-framework-specific functionality, you can implement servlet or Spring <code>@Controller</code> and <code>@RestController</code> endpoints at the cost of them not being available over JMX or when using a different web framework.</p> </div> <div class="sect3"> <h4 id="actuator.endpoints.implementing-custom.input">
2.7.1. Receiving Input</h4> <div class="paragraph"> <p>Operations on an endpoint receive input through their parameters. When exposed over the web, the values for these parameters are taken from the URL’s query parameters and from the JSON request body. When exposed over JMX, the parameters are mapped to the parameters of the MBean’s operations. Parameters are required by default. They can be made optional by annotating them with either <code>@javax.annotation.Nullable</code> or <code>@org.springframework.lang.Nullable</code>.</p> </div> <div class="paragraph"> <p>You can map each root property in the JSON request body to a parameter of the endpoint. Consider the following JSON request body:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="json"><code class="language-json" data-lang="json">{
    "name": "test",
    "counter": 42
}</code></pre> </div> </div> <div class="paragraph"> <p>You can use this to invoke a write operation that takes <code>String name</code> and <code>int counter</code> parameters, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java">@WriteOperation
public void updateData(String name, int counter) {
    // injects "test" and 42
}
</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin">@WriteOperation
fun updateData(name: String?, counter: Int) {
    // injects "test" and 42
}
</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> Because endpoints are technology agnostic, only simple types can be specified in the method signature. In particular, declaring a single parameter with a <code>CustomData</code> type that defines a <code>name</code> and <code>counter</code> properties is not supported. </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> To let the input be mapped to the operation method’s parameters, Java code that implements an endpoint should be compiled with <code>-parameters</code>, and Kotlin code that implements an endpoint should be compiled with <code>-java-parameters</code>. This will happen automatically if you use Spring Boot’s Gradle plugin or if you use Maven and <code>spring-boot-starter-parent</code>. </td> </tr> </table> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.input.conversion">
Input Type Conversion</h5> <div class="paragraph"> <p>The parameters passed to endpoint operation methods are, if necessary, automatically converted to the required type. Before calling an operation method, the input received over JMX or HTTP is converted to the required types by using an instance of <code>ApplicationConversionService</code> as well as any <code>Converter</code> or <code>GenericConverter</code> beans qualified with <code>@EndpointConverter</code>.</p> </div> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.implementing-custom.web">
2.7.2. Custom Web Endpoints</h4> <div class="paragraph"> <p>Operations on an <code>@Endpoint</code>, <code>@WebEndpoint</code>, or <code>@EndpointWebExtension</code> are automatically exposed over HTTP using Jersey, Spring MVC, or Spring WebFlux. If both Jersey and Spring MVC are available, Spring MVC is used.</p> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.request-predicates">
Web Endpoint Request Predicates</h5> <div class="paragraph"> <p>A request predicate is automatically generated for each operation on a web-exposed endpoint.</p> </div> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.path-predicates">
Path</h5> <div class="paragraph"> <p>The path of the predicate is determined by the ID of the endpoint and the base path of the web-exposed endpoints. The default base path is <code>/actuator</code>. For example, an endpoint with an ID of <code>sessions</code> uses <code>/actuator/sessions</code> as its path in the predicate.</p> </div> <div class="paragraph"> <p>You can further customize the path by annotating one or more parameters of the operation method with <code>@Selector</code>. Such a parameter is added to the path predicate as a path variable. The variable’s value is passed into the operation method when the endpoint operation is invoked. If you want to capture all remaining path elements, you can add <code>@Selector(Match=ALL_REMAINING)</code> to the last parameter and make it a type that is conversion-compatible with a <code>String[]</code>.</p> </div> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.method-predicates">
HTTP method</h5> <div class="paragraph"> <p>The HTTP method of the predicate is determined by the operation type, as shown in the following table:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 75%;"> <col style="width: 25%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Operation</th> <th class="tableblock halign-left valign-top">HTTP method</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>@ReadOperation</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>GET</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>@WriteOperation</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>POST</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>@DeleteOperation</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>DELETE</code></p></td> </tr> </tbody> </table> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.consumes-predicates">
Consumes</h5> <div class="paragraph"> <p>For a <code>@WriteOperation</code> (HTTP <code>POST</code>) that uses the request body, the <code>consumes</code> clause of the predicate is <code>application/vnd.spring-boot.actuator.v2+json, application/json</code>. For all other operations, the <code>consumes</code> clause is empty.</p> </div> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.produces-predicates">
Produces</h5> <div class="paragraph"> <p>The <code>produces</code> clause of the predicate can be determined by the <code>produces</code> attribute of the <code>@DeleteOperation</code>, <code>@ReadOperation</code>, and <code>@WriteOperation</code> annotations. The attribute is optional. If it is not used, the <code>produces</code> clause is determined automatically.</p> </div> <div class="paragraph"> <p>If the operation method returns <code>void</code> or <code>Void</code>, the <code>produces</code> clause is empty. If the operation method returns a <code>org.springframework.core.io.Resource</code>, the <code>produces</code> clause is <code>application/octet-stream</code>. For all other operations, the <code>produces</code> clause is <code>application/vnd.spring-boot.actuator.v2+json, application/json</code>.</p> </div> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.response-status">
Web Endpoint Response Status</h5> <div class="paragraph"> <p>The default response status for an endpoint operation depends on the operation type (read, write, or delete) and what, if anything, the operation returns.</p> </div> <div class="paragraph"> <p>If a <code>@ReadOperation</code> returns a value, the response status will be 200 (OK). If it does not return a value, the response status will be 404 (Not Found).</p> </div> <div class="paragraph"> <p>If a <code>@WriteOperation</code> or <code>@DeleteOperation</code> returns a value, the response status will be 200 (OK). If it does not return a value, the response status will be 204 (No Content).</p> </div> <div class="paragraph"> <p>If an operation is invoked without a required parameter or with a parameter that cannot be converted to the required type, the operation method is not called, and the response status will be 400 (Bad Request).</p> </div> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.range-requests">
Web Endpoint Range Requests</h5> <div class="paragraph"> <p>You can use an HTTP range request to request part of an HTTP resource. When using Spring MVC or Spring Web Flux, operations that return a <code>org.springframework.core.io.Resource</code> automatically support range requests.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Range requests are not supported when using Jersey. </td> </tr> </table> </div> </div> <div class="sect4"> <h5 id="actuator.endpoints.implementing-custom.web.security">
Web Endpoint Security</h5> <div class="paragraph"> <p>An operation on a web endpoint or a web-specific endpoint extension can receive the current <code>java.security.Principal</code> or <code>org.springframework.boot.actuate.endpoint.SecurityContext</code> as a method parameter. The former is typically used in conjunction with <code>@Nullable</code> to provide different behavior for authenticated and unauthenticated users. The latter is typically used to perform authorization checks by using its <code>isUserInRole(String)</code> method.</p> </div> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.implementing-custom.servlet">
2.7.3. Servlet Endpoints</h4> <div class="paragraph"> <p>A servlet can be exposed as an endpoint by implementing a class annotated with <code>@ServletEndpoint</code> that also implements <code>Supplier&lt;EndpointServlet&gt;</code>. Servlet endpoints provide deeper integration with the servlet container but at the expense of portability. They are intended to be used to expose an existing servlet as an endpoint. For new endpoints, the <code>@Endpoint</code> and <code>@WebEndpoint</code> annotations should be preferred whenever possible.</p> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.implementing-custom.controller">
2.7.4. Controller Endpoints</h4> <div class="paragraph"> <p>You can use <code>@ControllerEndpoint</code> and <code>@RestControllerEndpoint</code> to implement an endpoint that is exposed only by Spring MVC or Spring WebFlux. Methods are mapped by using the standard annotations for Spring MVC and Spring WebFlux, such as <code>@RequestMapping</code> and <code>@GetMapping</code>, with the endpoint’s ID being used as a prefix for the path. Controller endpoints provide deeper integration with Spring’s web frameworks but at the expense of portability. The <code>@Endpoint</code> and <code>@WebEndpoint</code> annotations should be preferred whenever possible.</p> </div> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.health">
2.8. Health Information</h3> <div class="paragraph"> <p>You can use health information to check the status of your running application. It is often used by monitoring software to alert someone when a production system goes down. The information exposed by the <code>health</code> endpoint depends on the <code>management.endpoint.health.show-details</code> and <code>management.endpoint.health.show-components</code> properties, which can be configured with one of the following values:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 25%;"> <col style="width: 75%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>never</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Details are never shown.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>when-authorized</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Details are shown only to authorized users. Authorized roles can be configured by using <code>management.endpoint.health.roles</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>always</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Details are shown to all users.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>The default value is <code>never</code>. A user is considered to be authorized when they are in one or more of the endpoint’s roles. If the endpoint has no configured roles (the default), all authenticated users are considered to be authorized. You can configure the roles by using the <code>management.endpoint.health.roles</code> property.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> If you have secured your application and wish to use <code>always</code>, your security configuration must permit access to the health endpoint for both authenticated and unauthenticated users. </td> </tr> </table> </div> <div class="paragraph"> <p>Health information is collected from the content of a <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributorRegistry.java"><code>HealthContributorRegistry</code></a> (by default, all <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributor.java"><code>HealthContributor</code></a> instances defined in your <code>ApplicationContext</code>). Spring Boot includes a number of auto-configured <code>HealthContributors</code>, and you can also write your own.</p> </div> <div class="paragraph"> <p>A <code>HealthContributor</code> can be either a <code>HealthIndicator</code> or a <code>CompositeHealthContributor</code>. A <code>HealthIndicator</code> provides actual health information, including a <code>Status</code>. A <code>CompositeHealthContributor</code> provides a composite of other <code>HealthContributors</code>. Taken together, contributors form a tree structure to represent the overall system health.</p> </div> <div class="paragraph"> <p>By default, the final system health is derived by a <code>StatusAggregator</code>, which sorts the statuses from each <code>HealthIndicator</code> based on an ordered list of statuses. The first status in the sorted list is used as the overall health status. If no <code>HealthIndicator</code> returns a status that is known to the <code>StatusAggregator</code>, an <code>UNKNOWN</code> status is used.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> You can use the <code>HealthContributorRegistry</code> to register and unregister health indicators at runtime. </td> </tr> </table> </div> <div class="sect3"> <h4 id="actuator.endpoints.health.auto-configured-health-indicators">
2.8.1. Auto-configured HealthIndicators</h4> <div class="paragraph"> <p>When appropriate, Spring Boot auto-configures the <code>HealthIndicators</code> listed in the following table. You can also enable or disable selected indicators by configuring <code>management.health.key.enabled</code>, with the <code>key</code> listed in the following table:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 16.6666%;"> <col style="width: 33.3333%;"> <col style="width: 50.0001%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Key</th> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>cassandra</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraDriverHealthIndicator.java"><code>CassandraDriverHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Cassandra database is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>couchbase</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseHealthIndicator.java"><code>CouchbaseHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Couchbase cluster is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>db</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jdbc/DataSourceHealthIndicator.java"><code>DataSourceHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a connection to <code>DataSource</code> can be obtained.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>diskspace</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/system/DiskSpaceHealthIndicator.java"><code>DiskSpaceHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks for low disk space.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>elasticsearch</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/elasticsearch/ElasticsearchRestHealthIndicator.java"><code>ElasticsearchRestHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that an Elasticsearch cluster is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>hazelcast</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/hazelcast/HazelcastHealthIndicator.java"><code>HazelcastHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Hazelcast server is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>influxdb</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/influx/InfluxDbHealthIndicator.java"><code>InfluxDbHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that an InfluxDB server is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>jms</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/jms/JmsHealthIndicator.java"><code>JmsHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a JMS broker is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>ldap</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/ldap/LdapHealthIndicator.java"><code>LdapHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that an LDAP server is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mail</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/mail/MailHealthIndicator.java"><code>MailHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a mail server is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mongo</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/mongo/MongoHealthIndicator.java"><code>MongoHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Mongo database is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>neo4j</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/neo4j/Neo4jHealthIndicator.java"><code>Neo4jHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Neo4j database is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>ping</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/PingHealthIndicator.java"><code>PingHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Always responds with <code>UP</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>rabbit</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/amqp/RabbitHealthIndicator.java"><code>RabbitHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Rabbit server is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>redis</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/redis/RedisHealthIndicator.java"><code>RedisHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Redis server is up.</p></td> </tr> </tbody> </table> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> You can disable them all by setting the <code>management.health.defaults.enabled</code> property. </td> </tr> </table> </div> <div class="paragraph"> <p>Additional <code>HealthIndicators</code> are available but are not enabled by default:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 23.0769%;"> <col style="width: 30.7692%;"> <col style="width: 46.1539%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Key</th> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>livenessstate</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/availability/LivenessStateHealthIndicator.java"><code>LivenessStateHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes the “Liveness” application availability state.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>readinessstate</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/availability/ReadinessStateHealthIndicator.java"><code>ReadinessStateHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes the “Readiness” application availability state.</p></td> </tr> </tbody> </table> </div> <div class="sect3"> <h4 id="actuator.endpoints.health.writing-custom-health-indicators">
2.8.2. Writing Custom HealthIndicators</h4> <div class="paragraph"> <p>To provide custom health information, you can register Spring beans that implement the <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthIndicator.java"><code>HealthIndicator</code></a> interface. You need to provide an implementation of the <code>health()</code> method and return a <code>Health</code> response. The <code>Health</code> response should include a status and can optionally include additional details to be displayed. The following code shows a sample <code>HealthIndicator</code> implementation:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.HealthIndicator;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyHealthIndicator implements HealthIndicator {

    @Override
    public Health health() {
        int errorCode = check();
        if (errorCode != 0) {
            return Health.down().withDetail("Error Code", errorCode).build();
        }
        return Health.up().build();
    }

    private int check() {
        // perform some specific health check
        return ...
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.health.Health
import org.springframework.boot.actuate.health.HealthIndicator
import org.springframework.stereotype.Component

</span><span class="fold-block">@Component
class MyHealthIndicator : HealthIndicator {

    override fun health(): Health {
        val errorCode = check()
        if (errorCode != 0) {
            return Health.down().withDetail("Error Code", errorCode).build()
        }
        return Health.up().build()
    }

    private fun check(): Int {
        // perform some specific health check
        return  ...
    }

}
</span></code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> The identifier for a given <code>HealthIndicator</code> is the name of the bean without the <code>HealthIndicator</code> suffix, if it exists. In the preceding example, the health information is available in an entry named <code>my</code>. </td> </tr> </table> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> Health indicators are usually called over HTTP and need to respond before any connection timeouts. Spring Boot will log a warning message for any health indicator that takes longer than 10 seconds to respond. If you want to configure this threshold, you can use the <code>management.endpoint.health.logging.slow-indicator-threshold</code> property. </td> </tr> </table> </div> <div class="paragraph"> <p>In addition to Spring Boot’s predefined <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/Status.java"><code>Status</code></a> types, <code>Health</code> can return a custom <code>Status</code> that represents a new system state. In such cases, you also need to provide a custom implementation of the <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/StatusAggregator.java"><code>StatusAggregator</code></a> interface, or you must configure the default implementation by using the <code>management.endpoint.health.status.order</code> configuration property.</p> </div> <div class="paragraph"> <p>For example, assume a new <code>Status</code> with a code of <code>FATAL</code> is being used in one of your <code>HealthIndicator</code> implementations. To configure the severity order, add the following property to your application properties:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.status.order=fatal,down,out-of-service,unknown,up</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    health:
      status:
        order: "fatal,down,out-of-service,unknown,up"</code></pre> </div> </div> <div class="paragraph"> <p>The HTTP status code in the response reflects the overall health status. By default, <code>OUT_OF_SERVICE</code> and <code>DOWN</code> map to 503. Any unmapped health statuses, including <code>UP</code>, map to 200. You might also want to register custom status mappings if you access the health endpoint over HTTP. Configuring a custom mapping disables the defaults mappings for <code>DOWN</code> and <code>OUT_OF_SERVICE</code>. If you want to retain the default mappings, you must explicitly configure them, alongside any custom mappings. For example, the following property maps <code>FATAL</code> to 503 (service unavailable) and retains the default mappings for <code>DOWN</code> and <code>OUT_OF_SERVICE</code>:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.status.http-mapping.down=503
management.endpoint.health.status.http-mapping.fatal=503
management.endpoint.health.status.http-mapping.out-of-service=503</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    health:
      status:
        http-mapping:
          down: 503
          fatal: 503
          out-of-service: 503</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> If you need more control, you can define your own <code>HttpCodeStatusMapper</code> bean. </td> </tr> </table> </div> <div class="paragraph"> <p>The following table shows the default status mappings for the built-in statuses:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 25%;"> <col style="width: 75%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Status</th> <th class="tableblock halign-left valign-top">Mapping</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>DOWN</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>SERVICE_UNAVAILABLE</code> (<code>503</code>)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>OUT_OF_SERVICE</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>SERVICE_UNAVAILABLE</code> (<code>503</code>)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>UP</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">No mapping by default, so HTTP status is <code>200</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>UNKNOWN</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">No mapping by default, so HTTP status is <code>200</code></p></td> </tr> </tbody> </table> </div> <div class="sect3"> <h4 id="actuator.endpoints.health.reactive-health-indicators">
2.8.3. Reactive Health Indicators</h4> <div class="paragraph"> <p>For reactive applications, such as those that use Spring WebFlux, <code>ReactiveHealthContributor</code> provides a non-blocking contract for getting application health. Similar to a traditional <code>HealthContributor</code>, health information is collected from the content of a <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthContributorRegistry.java"><code>ReactiveHealthContributorRegistry</code></a> (by default, all <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/HealthContributor.java"><code>HealthContributor</code></a> and <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthContributor.java"><code>ReactiveHealthContributor</code></a> instances defined in your <code>ApplicationContext</code>). Regular <code>HealthContributors</code> that do not check against a reactive API are executed on the elastic scheduler.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> In a reactive application, you should use the <code>ReactiveHealthContributorRegistry</code> to register and unregister health indicators at runtime. If you need to register a regular <code>HealthContributor</code>, you should wrap it with <code>ReactiveHealthContributor#adapt</code>. </td> </tr> </table> </div> <div class="paragraph"> <p>To provide custom health information from a reactive API, you can register Spring beans that implement the <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/health/ReactiveHealthIndicator.java"><code>ReactiveHealthIndicator</code></a> interface. The following code shows a sample <code>ReactiveHealthIndicator</code> implementation:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import reactor.core.publisher.Mono;

import org.springframework.boot.actuate.health.Health;
import org.springframework.boot.actuate.health.ReactiveHealthIndicator;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyReactiveHealthIndicator implements ReactiveHealthIndicator {

    @Override
    public Mono&lt;Health&gt; health() {
        return doHealthCheck().onErrorResume((exception) -&gt;
            Mono.just(new Health.Builder().down(exception).build()));
    }

    private Mono&lt;Health&gt; doHealthCheck() {
        // perform some specific health check
        return ...
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.health.Health
import org.springframework.boot.actuate.health.ReactiveHealthIndicator
import org.springframework.stereotype.Component
import reactor.core.publisher.Mono

</span><span class="fold-block">@Component
class MyReactiveHealthIndicator : ReactiveHealthIndicator {

    override fun health(): Mono&lt;Health&gt; {
        return doHealthCheck()!!.onErrorResume { exception: Throwable? -&gt;
            Mono.just(Health.Builder().down(exception).build())
        }
    }

    private fun doHealthCheck(): Mono&lt;Health&gt;? {
        // perform some specific health check
        return  ...
    }

}
</span></code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> To handle the error automatically, consider extending from <code>AbstractReactiveHealthIndicator</code>. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.health.auto-configured-reactive-health-indicators">
2.8.4. Auto-configured ReactiveHealthIndicators</h4> <div class="paragraph"> <p>When appropriate, Spring Boot auto-configures the following <code>ReactiveHealthIndicators</code>:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 16.6666%;"> <col style="width: 33.3333%;"> <col style="width: 50.0001%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Key</th> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>cassandra</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/cassandra/CassandraDriverReactiveHealthIndicator.java"><code>CassandraDriverReactiveHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Cassandra database is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>couchbase</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/couchbase/CouchbaseReactiveHealthIndicator.java"><code>CouchbaseReactiveHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Couchbase cluster is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>elasticsearch</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/elasticsearch/ElasticsearchReactiveHealthIndicator.java"><code>ElasticsearchReactiveHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that an Elasticsearch cluster is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>mongo</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/mongo/MongoReactiveHealthIndicator.java"><code>MongoReactiveHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Mongo database is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>neo4j</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/neo4j/Neo4jReactiveHealthIndicator.java"><code>Neo4jReactiveHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Neo4j database is up.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>redis</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/data/redis/RedisReactiveHealthIndicator.java"><code>RedisReactiveHealthIndicator</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Checks that a Redis server is up.</p></td> </tr> </tbody> </table> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> If necessary, reactive indicators replace the regular ones. Also, any <code>HealthIndicator</code> that is not handled explicitly is wrapped automatically. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.health.groups">
2.8.5. Health Groups</h4> <div class="paragraph"> <p>It is sometimes useful to organize health indicators into groups that you can use for different purposes.</p> </div> <div class="paragraph"> <p>To create a health indicator group, you can use the <code>management.endpoint.health.group.&lt;name&gt;</code> property and specify a list of health indicator IDs to <code>include</code> or <code>exclude</code>. For example, to create a group that includes only database indicators you can define the following:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.group.custom.include=db</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    health:
      group:
        custom:
          include: "db"</code></pre> </div> </div> <div class="paragraph"> <p>You can then check the result by hitting <code><a href="http://localhost:8080/actuator/health/custom" class="bare">localhost:8080/actuator/health/custom</a></code>.</p> </div> <div class="paragraph"> <p>Similarly, to create a group that excludes the database indicators from the group and includes all the other indicators, you can define the following:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.group.custom.exclude=db</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    health:
      group:
        custom:
          exclude: "db"</code></pre> </div> </div> <div class="paragraph"> <p>By default, startup will fail if a health group includes or excludes a health indicator that does not exist. To disable this behavior set <code>management.endpoint.health.validate-group-membership</code> to <code>false</code>.</p> </div> <div class="paragraph"> <p>By default, groups inherit the same <code>StatusAggregator</code> and <code>HttpCodeStatusMapper</code> settings as the system health. However, you can also define these on a per-group basis. You can also override the <code>show-details</code> and <code>roles</code> properties if required:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.group.custom.show-details=when-authorized
management.endpoint.health.group.custom.roles=admin
management.endpoint.health.group.custom.status.order=fatal,up
management.endpoint.health.group.custom.status.http-mapping.fatal=500
management.endpoint.health.group.custom.status.http-mapping.out-of-service=500</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    health:
      group:
        custom:
          show-details: "when-authorized"
          roles: "admin"
          status:
            order: "fatal,up"
            http-mapping:
              fatal: 500
              out-of-service: 500</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> You can use <code>@Qualifier("groupname")</code> if you need to register custom <code>StatusAggregator</code> or <code>HttpCodeStatusMapper</code> beans for use with the group. </td> </tr> </table> </div> <div class="paragraph"> <p>A health group can also include/exclude a <code>CompositeHealthContributor</code>. You can also include/exclude only a certain component of a <code>CompositeHealthContributor</code>. This can be done using the fully qualified name of the component as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.group.custom.include="test/primary"
management.endpoint.health.group.custom.exclude="test/primary/b"</code></pre> </div> </div> <div class="paragraph"> <p>In the example above, the <code>custom</code> group will include the <code>HealthContributor</code> with the name <code>primary</code> which is a component of the composite <code>test</code>. Here, <code>primary</code> itself is a composite and the <code>HealthContributor</code> with the name <code>b</code> will be excluded from the <code>custom</code> group.</p> </div> <div class="paragraph"> <p>Health groups can be made available at an additional path on either the main or management port. This is useful in cloud environments such as Kubernetes, where it is quite common to use a separate management port for the actuator endpoints for security purposes. Having a separate port could lead to unreliable health checks because the main application might not work properly even if the health check is successful. The health group can be configured with an additional path as follows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.group.live.additional-path="server:/healthz"</code></pre> </div> </div> <div class="paragraph"> <p>This would make the <code>live</code> health group available on the main server port at <code>/healthz</code>. The prefix is mandatory and must be either <code>server:</code> (represents the main server port) or <code>management:</code> (represents the management port, if configured.) The path must be a single path segment.</p> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.health.datasource">
2.8.6. DataSource Health</h4> <div class="paragraph"> <p>The <code>DataSource</code> health indicator shows the health of both standard data sources and routing data source beans. The health of a routing data source includes the health of each of its target data sources. In the health endpoint’s response, each of a routing data source’s targets is named by using its routing key. If you prefer not to include routing data sources in the indicator’s output, set <code>management.health.db.ignore-routing-data-sources</code> to <code>true</code>.</p> </div> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.kubernetes-probes">
2.9. Kubernetes Probes</h3> <div class="paragraph"> <p>Applications deployed on Kubernetes can provide information about their internal state with <a href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/#container-probes">Container Probes</a>. Depending on <a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">your Kubernetes configuration</a>, the kubelet calls those probes and reacts to the result.</p> </div> <div class="paragraph"> <p>By default, Spring Boot manages your <a href="features.html#features.spring-application.application-availability">Application Availability State</a>. If deployed in a Kubernetes environment, actuator gathers the “Liveness” and “Readiness” information from the <code>ApplicationAvailability</code> interface and uses that information in dedicated <a href="#actuator.endpoints.health.auto-configured-health-indicators">health indicators</a>: <code>LivenessStateHealthIndicator</code> and <code>ReadinessStateHealthIndicator</code>. These indicators are shown on the global health endpoint (<code>"/actuator/health"</code>). They are also exposed as separate HTTP Probes by using <a href="#actuator.endpoints.health.groups">health groups</a>: <code>"/actuator/health/liveness"</code> and <code>"/actuator/health/readiness"</code>.</p> </div> <div class="paragraph"> <p>You can then configure your Kubernetes infrastructure with the following endpoint information:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">livenessProbe:
  httpGet:
    path: "/actuator/health/liveness"
    port: &lt;actuator-port&gt;
  failureThreshold: ...
  periodSeconds: ...

readinessProbe:
  httpGet:
    path: "/actuator/health/readiness"
    port: &lt;actuator-port&gt;
  failureThreshold: ...
  periodSeconds: ...</code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> <code>&lt;actuator-port&gt;</code> should be set to the port that the actuator endpoints are available on. It could be the main web server port or a separate management port if the <code>"management.server.port"</code> property has been set. </td> </tr> </table> </div> <div class="paragraph"> <p>These health groups are automatically enabled only if the application <a href="deployment.html#deployment.cloud.kubernetes">runs in a Kubernetes environment</a>. You can enable them in any environment by using the <code>management.endpoint.health.probes.enabled</code> configuration property.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> If an application takes longer to start than the configured liveness period, Kubernetes mentions the <code>"startupProbe"</code> as a possible solution. Generally speaking, the <code>"startupProbe"</code> is not necessarily needed here, as the <code>"readinessProbe"</code> fails until all startup tasks are done. This means your application will not receive traffic until it is ready. However, if your application takes a long time to start, consider using a <code>"startupProbe"</code> to make sure that Kubernetes won’t kill your application while it is in the process of starting. See the section that describes <a href="#actuator.endpoints.kubernetes-probes.lifecycle">how probes behave during the application lifecycle</a>. </td> </tr> </table> </div> <div class="paragraph"> <p>If your Actuator endpoints are deployed on a separate management context, the endpoints do not use the same web infrastructure (port, connection pools, framework components) as the main application. In this case, a probe check could be successful even if the main application does not work properly (for example, it cannot accept new connections). For this reason, is it a good idea to make the <code>liveness</code> and <code>readiness</code> health groups available on the main server port. This can be done by setting the following property:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.probes.add-additional-paths=true</code></pre> </div> </div> <div class="paragraph"> <p>This would make the <code>liveness</code> group available at <code>/livez</code> and the <code>readiness</code> group available at <code>/readyz</code> on the main server port. Paths can be customized using the <code>additional-path</code> property on each group, see <a href="#actuator.endpoints.health.groups">health groups</a> for details.</p> </div> <div class="sect3"> <h4 id="actuator.endpoints.kubernetes-probes.external-state">
2.9.1. Checking External State With Kubernetes Probes</h4> <div class="paragraph"> <p>Actuator configures the “liveness” and “readiness” probes as Health Groups. This means that all the <a href="#actuator.endpoints.health.groups">health groups features</a> are available for them. You can, for example, configure additional Health Indicators:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoint.health.group.readiness.include=readinessState,customCheck</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoint:
    health:
      group:
        readiness:
          include: "readinessState,customCheck"</code></pre> </div> </div> <div class="paragraph"> <p>By default, Spring Boot does not add other health indicators to these groups.</p> </div> <div class="paragraph"> <p>The “liveness” probe should not depend on health checks for external systems. If the <a href="features.html#features.spring-application.application-availability.liveness">liveness state of an application</a> is broken, Kubernetes tries to solve that problem by restarting the application instance. This means that if an external system (such as a database, a Web API, or an external cache) fails, Kubernetes might restart all application instances and create cascading failures.</p> </div> <div class="paragraph"> <p>As for the “readiness” probe, the choice of checking external systems must be made carefully by the application developers. For this reason, Spring Boot does not include any additional health checks in the readiness probe. If the <a href="features.html#features.spring-application.application-availability.readiness">readiness state of an application instance</a> is unready, Kubernetes does not route traffic to that instance. Some external systems might not be shared by application instances, in which case they could be included in a readiness probe. Other external systems might not be essential to the application (the application could have circuit breakers and fallbacks), in which case they definitely should not be included. Unfortunately, an external system that is shared by all application instances is common, and you have to make a judgement call: Include it in the readiness probe and expect that the application is taken out of service when the external service is down or leave it out and deal with failures higher up the stack, perhaps by using a circuit breaker in the caller.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> If all instances of an application are unready, a Kubernetes Service with <code>type=ClusterIP</code> or <code>NodePort</code> does not accept any incoming connections. There is no HTTP error response (503 and so on), since there is no connection. A service with <code>type=LoadBalancer</code> might or might not accept connections, depending on the provider. A service that has an explicit <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">ingress</a> also responds in a way that depends on the implementation — the ingress service itself has to decide how to handle the “connection refused” from downstream. HTTP 503 is quite likely in the case of both load balancer and ingress. </td> </tr> </table> </div> <div class="paragraph"> <p>Also, if an application uses Kubernetes <a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">autoscaling</a>, it may react differently to applications being taken out of the load-balancer, depending on its autoscaler configuration.</p> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.kubernetes-probes.lifecycle">
2.9.2. Application Lifecycle and Probe States</h4> <div class="paragraph"> <p>An important aspect of the Kubernetes Probes support is its consistency with the application lifecycle. There is a significant difference between the <code>AvailabilityState</code> (which is the in-memory, internal state of the application) and the actual probe (which exposes that state). Depending on the phase of application lifecycle, the probe might not be available.</p> </div> <div class="paragraph"> <p>Spring Boot publishes <a href="features.html#features.spring-application.application-events-and-listeners">application events during startup and shutdown</a>, and probes can listen to such events and expose the <code>AvailabilityState</code> information.</p> </div> <div class="paragraph"> <p>The following tables show the <code>AvailabilityState</code> and the state of HTTP connectors at different stages.</p> </div> <div class="paragraph"> <p>When a Spring Boot application starts:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 14.2857%;"> <col style="width: 14.2857%;"> <col style="width: 14.2857%;"> <col style="width: 21.4285%;"> <col style="width: 35.7144%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Startup phase</th> <th class="tableblock halign-left valign-top">LivenessState</th> <th class="tableblock halign-left valign-top">ReadinessState</th> <th class="tableblock halign-left valign-top">HTTP server</th> <th class="tableblock halign-left valign-top">Notes</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Starting</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>BROKEN</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>REFUSING_TRAFFIC</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Not started</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes checks the "liveness" Probe and restarts the application if it takes too long.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Started</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CORRECT</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>REFUSING_TRAFFIC</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Refuses requests</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The application context is refreshed. The application performs startup tasks and does not receive traffic yet.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Ready</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CORRECT</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACCEPTING_TRAFFIC</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Accepts requests</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Startup tasks are finished. The application is receiving traffic.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>When a Spring Boot application shuts down:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 14.2857%;"> <col style="width: 14.2857%;"> <col style="width: 14.2857%;"> <col style="width: 21.4285%;"> <col style="width: 35.7144%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Shutdown phase</th> <th class="tableblock halign-left valign-top">Liveness State</th> <th class="tableblock halign-left valign-top">Readiness State</th> <th class="tableblock halign-left valign-top">HTTP server</th> <th class="tableblock halign-left valign-top">Notes</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Running</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CORRECT</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>ACCEPTING_TRAFFIC</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Accepts requests</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Shutdown has been requested.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Graceful shutdown</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>CORRECT</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>REFUSING_TRAFFIC</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">New requests are rejected</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">If enabled, <a href="web.html#web.graceful-shutdown">graceful shutdown processes in-flight requests</a>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock">Shutdown complete</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">N/A</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Server is shut down</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The application context is closed and the application is shut down.</p></td> </tr> </tbody> </table> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> See <a href="deployment.html#deployment.cloud.kubernetes.container-lifecycle">Kubernetes container lifecycle section</a> for more information about Kubernetes deployment. </td> </tr> </table> </div> </div> </div> <div class="sect2"> <h3 id="actuator.endpoints.info">
2.10. Application Information</h3> <div class="paragraph"> <p>Application information exposes various information collected from all <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java"><code>InfoContributor</code></a> beans defined in your <code>ApplicationContext</code>. Spring Boot includes a number of auto-configured <code>InfoContributor</code> beans, and you can write your own.</p> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.auto-configured-info-contributors">
2.10.1. Auto-configured InfoContributors</h4> <div class="paragraph"> <p>When appropriate, Spring auto-configures the following <code>InfoContributor</code> beans:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 5.8823%;"> <col style="width: 23.5294%;"> <col style="width: 47.0588%;"> <col style="width: 23.5295%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">ID</th> <th class="tableblock halign-left valign-top">Name</th> <th class="tableblock halign-left valign-top">Description</th> <th class="tableblock halign-left valign-top">Prerequisites</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>build</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/BuildInfoContributor.java"><code>BuildInfoContributor</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes build information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">A <code>META-INF/build-info.properties</code> resource.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>env</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/EnvironmentInfoContributor.java"><code>EnvironmentInfoContributor</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes any property from the <code>Environment</code> whose name starts with <code>info.</code>.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">None.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>git</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/GitInfoContributor.java"><code>GitInfoContributor</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes git information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">A <code>git.properties</code> resource.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>java</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/JavaInfoContributor.java"><code>JavaInfoContributor</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes Java runtime information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">None.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>os</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/OsInfoContributor.java"><code>OsInfoContributor</code></a></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Exposes Operating System information.</p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">None.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>Whether an individual contributor is enabled is controlled by its <code>management.info.&lt;id&gt;.enabled</code> property. Different contributors have different defaults for this property, depending on their prerequisites and the nature of the information that they expose.</p> </div> <div class="paragraph"> <p>With no prerequisites to indicate that they should be enabled, the <code>env</code>, <code>java</code>, and <code>os</code> contributors are disabled by default. Each can be enabled by setting its <code>management.info.&lt;id&gt;.enabled</code> property to <code>true</code>.</p> </div> <div class="paragraph"> <p>The <code>build</code> and <code>git</code> info contributors are enabled by default. Each can be disabled by setting its <code>management.info.&lt;id&gt;.enabled</code> property to <code>false</code>. Alternatively, to disable every contributor that is usually enabled by default, set the <code>management.info.defaults.enabled</code> property to <code>false</code>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.custom-application-information">
2.10.2. Custom Application Information</h4> <div class="paragraph"> <p>When the <code>env</code> contributor is enabled, you can customize the data exposed by the <code>info</code> endpoint by setting <code>info.*</code> Spring properties. All <code>Environment</code> properties under the <code>info</code> key are automatically exposed. For example, you could add the following settings to your <code>application.properties</code> file:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">info.app.encoding=UTF-8
info.app.java.source=17
info.app.java.target=17</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">info:
  app:
    encoding: "UTF-8"
    java:
      source: "17"
      target: "17"</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> <div class="paragraph"> <p>Rather than hardcoding those values, you could also <a href="howto.html#howto.properties-and-configuration.expand-properties">expand info properties at build time</a>.</p> </div> <div class="paragraph"> <p>Assuming you use Maven, you could rewrite the preceding example as follows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">info.app.encoding=@project.build.sourceEncoding@
info.app.java.source=@java.version@
info.app.java.target=@java.version@</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">info:
  app:
    encoding: "@project.build.sourceEncoding@"
    java:
      source: "@java.version@"
      target: "@java.version@"</code></pre> </div> </div> </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.git-commit-information">
2.10.3. Git Commit Information</h4> <div class="paragraph"> <p>Another useful feature of the <code>info</code> endpoint is its ability to publish information about the state of your <code>git</code> source code repository when the project was built. If a <code>GitProperties</code> bean is available, you can use the <code>info</code> endpoint to expose these properties.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> A <code>GitProperties</code> bean is auto-configured if a <code>git.properties</code> file is available at the root of the classpath. See "<a href="howto.html#howto.build.generate-git-info">how to generate git information</a>" for more detail. </td> </tr> </table> </div> <div class="paragraph"> <p>By default, the endpoint exposes <code>git.branch</code>, <code>git.commit.id</code>, and <code>git.commit.time</code> properties, if present. If you do not want any of these properties in the endpoint response, they need to be excluded from the <code>git.properties</code> file. If you want to display the full git information (that is, the full content of <code>git.properties</code>), use the <code>management.info.git.mode</code> property, as follows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.info.git.mode=full</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  info:
    git:
      mode: "full"</code></pre> </div> </div> <div class="paragraph"> <p>To disable the git commit information from the <code>info</code> endpoint completely, set the <code>management.info.git.enabled</code> property to <code>false</code>, as follows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.info.git.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  info:
    git:
      enabled: false</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.build-information">
2.10.4. Build Information</h4> <div class="paragraph"> <p>If a <code>BuildProperties</code> bean is available, the <code>info</code> endpoint can also publish information about your build. This happens if a <code>META-INF/build-info.properties</code> file is available in the classpath.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> The Maven and Gradle plugins can both generate that file. See "<a href="howto.html#howto.build.generate-info">how to generate build information</a>" for more details. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.java-information">
2.10.5. Java Information</h4> <div class="paragraph"> <p>The <code>info</code> endpoint publishes information about your Java runtime environment, see <a href="https://docs.spring.io/spring-boot/docs/3.1.3/api/org/springframework/boot/info/JavaInfo.html"><code>JavaInfo</code></a> for more details.</p> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.os-information">
2.10.6. OS Information</h4> <div class="paragraph"> <p>The <code>info</code> endpoint publishes information about your Operating System, see <a href="https://docs.spring.io/spring-boot/docs/3.1.3/api/org/springframework/boot/info/OsInfo.html"><code>OsInfo</code></a> for more details.</p> </div> </div> <div class="sect3"> <h4 id="actuator.endpoints.info.writing-custom-info-contributors">
2.10.7. Writing Custom InfoContributors</h4> <div class="paragraph"> <p>To provide custom application information, you can register Spring beans that implement the <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-actuator/src/main/java/org/springframework/boot/actuate/info/InfoContributor.java"><code>InfoContributor</code></a> interface.</p> </div> <div class="paragraph"> <p>The following example contributes an <code>example</code> entry with a single value:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.util.Collections;

import org.springframework.boot.actuate.info.Info;
import org.springframework.boot.actuate.info.InfoContributor;
import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyInfoContributor implements InfoContributor {

    @Override
    public void contribute(Info.Builder builder) {
        builder.withDetail("example", Collections.singletonMap("key", "value"));
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import org.springframework.boot.actuate.info.Info
import org.springframework.boot.actuate.info.InfoContributor
import org.springframework.stereotype.Component
import java.util.Collections

</span><span class="fold-block">@Component
class MyInfoContributor : InfoContributor {

    override fun contribute(builder: Info.Builder) {
        builder.withDetail("example", Collections.singletonMap("key", "value"))
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>If you reach the <code>info</code> endpoint, you should see a response that contains the following additional entry:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="json"><code class="language-json" data-lang="json">{
    "example": {
        "key" : "value"
    }
}</code></pre> </div> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.monitoring">
3. Monitoring and Management Over HTTP</h2> <div class="sectionbody"> <div class="paragraph"> <p>If you are developing a web application, Spring Boot Actuator auto-configures all enabled endpoints to be exposed over HTTP. The default convention is to use the <code>id</code> of the endpoint with a prefix of <code>/actuator</code> as the URL path. For example, <code>health</code> is exposed as <code>/actuator/health</code>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> Actuator is supported natively with Spring MVC, Spring WebFlux, and Jersey. If both Jersey and Spring MVC are available, Spring MVC is used. </td> </tr> </table> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Jackson is a required dependency in order to get the correct JSON responses as documented in the API documentation (<a href="https://docs.spring.io/spring-boot/docs/3.1.3/actuator-api/htmlsingle">HTML</a> or <a href="https://docs.spring.io/spring-boot/docs/3.1.3/actuator-api/pdf/spring-boot-actuator-web-api.pdf">PDF</a>). </td> </tr> </table> </div> <div class="sect2"> <h3 id="actuator.monitoring.customizing-management-server-context-path">
3.1. Customizing the Management Endpoint Paths</h3> <div class="paragraph"> <p>Sometimes, it is useful to customize the prefix for the management endpoints. For example, your application might already use <code>/actuator</code> for another purpose. You can use the <code>management.endpoints.web.base-path</code> property to change the prefix for your management endpoint, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.base-path=/manage</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      base-path: "/manage"</code></pre> </div> </div> <div class="paragraph"> <p>The preceding <code>application.properties</code> example changes the endpoint from <code>/actuator/{id}</code> to <code>/manage/{id}</code> (for example, <code>/manage/info</code>).</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Unless the management port has been configured to <a href="#actuator.monitoring.customizing-management-server-port">expose endpoints by using a different HTTP port</a>, <code>management.endpoints.web.base-path</code> is relative to <code>server.servlet.context-path</code> (for servlet web applications) or <code>spring.webflux.base-path</code> (for reactive web applications). If <code>management.server.port</code> is configured, <code>management.endpoints.web.base-path</code> is relative to <code>management.server.base-path</code>. </td> </tr> </table> </div> <div class="paragraph"> <p>If you want to map endpoints to a different path, you can use the <code>management.endpoints.web.path-mapping</code> property.</p> </div> <div class="paragraph"> <p>The following example remaps <code>/actuator/health</code> to <code>/healthcheck</code>:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.base-path=/
management.endpoints.web.path-mapping.health=healthcheck</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      base-path: "/"
      path-mapping:
        health: "healthcheck"</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.monitoring.customizing-management-server-port">
3.2. Customizing the Management Server Port</h3> <div class="paragraph"> <p>Exposing management endpoints by using the default HTTP port is a sensible choice for cloud-based deployments. If, however, your application runs inside your own data center, you may prefer to expose endpoints by using a different HTTP port.</p> </div> <div class="paragraph"> <p>You can set the <code>management.server.port</code> property to change the HTTP port, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.server.port=8081</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  server:
    port: 8081</code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> On Cloud Foundry, by default, applications receive requests only on port 8080 for both HTTP and TCP routing. If you want to use a custom management port on Cloud Foundry, you need to explicitly set up the application’s routes to forward traffic to the custom port. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.monitoring.management-specific-ssl">
3.3. Configuring Management-specific SSL</h3> <div class="paragraph"> <p>When configured to use a custom port, you can also configure the management server with its own SSL by using the various <code>management.server.ssl.*</code> properties. For example, doing so lets a management server be available over HTTP while the main application uses HTTPS, as the following property settings show:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">server.port=8443
server.ssl.enabled=true
server.ssl.key-store=classpath:store.jks
server.ssl.key-password=secret
management.server.port=8080
management.server.ssl.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">server:
  port: 8443
  ssl:
    enabled: true
    key-store: "classpath:store.jks"
    key-password: "secret"
management:
  server:
    port: 8080
    ssl:
      enabled: false</code></pre> </div> </div> <div class="paragraph"> <p>Alternatively, both the main server and the management server can use SSL but with different key stores, as follows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">server.port=8443
server.ssl.enabled=true
server.ssl.key-store=classpath:main.jks
server.ssl.key-password=secret
management.server.port=8080
management.server.ssl.enabled=true
management.server.ssl.key-store=classpath:management.jks
management.server.ssl.key-password=secret</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">server:
  port: 8443
  ssl:
    enabled: true
    key-store: "classpath:main.jks"
    key-password: "secret"
management:
  server:
    port: 8080
    ssl:
      enabled: true
      key-store: "classpath:management.jks"
      key-password: "secret"</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.monitoring.customizing-management-server-address">
3.4. Customizing the Management Server Address</h3> <div class="paragraph"> <p>You can customize the address on which the management endpoints are available by setting the <code>management.server.address</code> property. Doing so can be useful if you want to listen only on an internal or ops-facing network or to listen only for connections from <code>localhost</code>.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> You can listen on a different address only when the port differs from the main server port. </td> </tr> </table> </div> <div class="paragraph"> <p>The following example <code>application.properties</code> does not allow remote management connections:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.server.port=8081
management.server.address=127.0.0.1</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  server:
    port: 8081
    address: "127.0.0.1"</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.monitoring.disabling-http-endpoints">
3.5. Disabling HTTP Endpoints</h3> <div class="paragraph"> <p>If you do not want to expose endpoints over HTTP, you can set the management port to <code>-1</code>, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.server.port=-1</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  server:
    port: -1</code></pre> </div> </div> <div class="paragraph"> <p>You can also achieve this by using the <code>management.endpoints.web.exposure.exclude</code> property, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.web.exposure.exclude=*</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    web:
      exposure:
        exclude: "*"</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.jmx">
4. Monitoring and Management over JMX</h2> <div class="sectionbody"> <div class="paragraph"> <p>Java Management Extensions (JMX) provide a standard mechanism to monitor and manage applications. By default, this feature is not enabled. You can turn it on by setting the <code>spring.jmx.enabled</code> configuration property to <code>true</code>. Spring Boot exposes the most suitable <code>MBeanServer</code> as a bean with an ID of <code>mbeanServer</code>. Any of your beans that are annotated with Spring JMX annotations (<code>@ManagedResource</code>, <code>@ManagedAttribute</code>, or <code>@ManagedOperation</code>) are exposed to it.</p> </div> <div class="paragraph"> <p>If your platform provides a standard <code>MBeanServer</code>, Spring Boot uses that and defaults to the VM <code>MBeanServer</code>, if necessary. If all that fails, a new <code>MBeanServer</code> is created.</p> </div> <div class="paragraph"> <p>See the <a href="https://github.com/spring-projects/spring-boot/tree/v3.1.3/spring-boot-project/spring-boot-autoconfigure/src/main/java/org/springframework/boot/autoconfigure/jmx/JmxAutoConfiguration.java"><code>JmxAutoConfiguration</code></a> class for more details.</p> </div> <div class="paragraph"> <p>By default, Spring Boot also exposes management endpoints as JMX MBeans under the <code>org.springframework.boot</code> domain. To take full control over endpoint registration in the JMX domain, consider registering your own <code>EndpointObjectNameFactory</code> implementation.</p> </div> <div class="sect2"> <h3 id="actuator.jmx.custom-mbean-names">
4.1. Customizing MBean Names</h3> <div class="paragraph"> <p>The name of the MBean is usually generated from the <code>id</code> of the endpoint. For example, the <code>health</code> endpoint is exposed as <code>org.springframework.boot:type=Endpoint,name=Health</code>.</p> </div> <div class="paragraph"> <p>If your application contains more than one Spring <code>ApplicationContext</code>, you may find that names clash. To solve this problem, you can set the <code>spring.jmx.unique-names</code> property to <code>true</code> so that MBean names are always unique.</p> </div> <div class="paragraph"> <p>You can also customize the JMX domain under which endpoints are exposed. The following settings show an example of doing so in <code>application.properties</code>:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">spring.jmx.unique-names=true
management.endpoints.jmx.domain=com.example.myapp</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">spring:
  jmx:
    unique-names: true
management:
  endpoints:
    jmx:
      domain: "com.example.myapp"</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.jmx.disable-jmx-endpoints">
4.2. Disabling JMX Endpoints</h3> <div class="paragraph"> <p>If you do not want to expose endpoints over JMX, you can set the <code>management.endpoints.jmx.exposure.exclude</code> property to <code>*</code>, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.endpoints.jmx.exposure.exclude=*</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  endpoints:
    jmx:
      exposure:
        exclude: "*"</code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.observability">
5. Observability</h2> <div class="sectionbody"> <div class="paragraph"> <p>Observability is the ability to observe the internal state of a running system from the outside. It consists of the three pillars logging, metrics and traces.</p> </div> <div class="paragraph"> <p>For metrics and traces, Spring Boot uses <a href="https://micrometer.io/docs/observation">Micrometer Observation</a>. To create your own observations (which will lead to metrics and traces), you can inject an <code>ObservationRegistry</code>.</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.observation.Observation;
import io.micrometer.observation.ObservationRegistry;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyCustomObservation {

    private final ObservationRegistry observationRegistry;

    public MyCustomObservation(ObservationRegistry observationRegistry) {
        this.observationRegistry = observationRegistry;
    }

    public void doSomething() {
        Observation.createNotStarted("doSomething", this.observationRegistry)
            .lowCardinalityKeyValue("locale", "en-US")
            .highCardinalityKeyValue("userId", "42")
            .observe(() -&gt; {
                // Execute business logic here
            });
    }

}
</span></code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Low cardinality tags will be added to metrics and traces, while high cardinality tags will only be added to traces. </td> </tr> </table> </div> <div class="paragraph"> <p>Beans of type <code>ObservationPredicate</code>, <code>GlobalObservationConvention</code> and <code>ObservationHandler</code> will be automatically registered on the <code>ObservationRegistry</code>. You can additionally register any number of <code>ObservationRegistryCustomizer</code> beans to further configure the registry.</p> </div> <div class="paragraph"> <p>For more details please see the <a href="https://micrometer.io/docs/observation">Micrometer Observation documentation</a>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> Observability for JDBC and R2DBC can be configured using separate projects. For JDBC, the <a href="https://github.com/jdbc-observations/datasource-micrometer">Datasource Micrometer project</a> provides a Spring Boot starter which automatically creates observations when JDBC operations are invoked. Read more about it <a href="https://jdbc-observations.github.io/datasource-micrometer/docs/current/docs/html/">in the reference documentation</a>. For R2DBC, the <a href="https://github.com/spring-projects-experimental/r2dbc-micrometer-spring-boot">Spring Boot Auto Configuration for R2DBC Observation</a> creates observations for R2DBC query invocations. </td> </tr> </table> </div> <div class="paragraph"> <p>The next sections will provide more details about logging, metrics and traces.</p> </div> </div> </div> <div class="sect1"> <h2 id="actuator.loggers">
6. Loggers</h2> <div class="sectionbody"> <div class="paragraph"> <p>Spring Boot Actuator includes the ability to view and configure the log levels of your application at runtime. You can view either the entire list or an individual logger’s configuration, which is made up of both the explicitly configured logging level as well as the effective logging level given to it by the logging framework. These levels can be one of:</p> </div> <div class="ulist"> <ul> <li> <p><code>TRACE</code></p> </li> <li> <p><code>DEBUG</code></p> </li> <li> <p><code>INFO</code></p> </li> <li> <p><code>WARN</code></p> </li> <li> <p><code>ERROR</code></p> </li> <li> <p><code>FATAL</code></p> </li> <li> <p><code>OFF</code></p> </li> <li> <p><code>null</code></p> </li> </ul> </div> <div class="paragraph"> <p><code>null</code> indicates that there is no explicit configuration.</p> </div> <div class="sect2"> <h3 id="actuator.loggers.configure">
6.1. Configure a Logger</h3> <div class="paragraph"> <p>To configure a given logger, <code>POST</code> a partial entity to the resource’s URI, as the following example shows:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="json"><code class="language-json" data-lang="json">{
    "configuredLevel": "DEBUG"
}</code></pre> </div> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> To “reset” the specific level of the logger (and use the default configuration instead), you can pass a value of <code>null</code> as the <code>configuredLevel</code>. </td> </tr> </table> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.metrics">
7. Metrics</h2> <div class="sectionbody"> <div class="paragraph"> <p>Spring Boot Actuator provides dependency management and auto-configuration for <a href="https://micrometer.io">Micrometer</a>, an application metrics facade that supports <a href="https://micrometer.io/docs">numerous monitoring systems</a>, including:</p> </div> <div class="ulist"> <ul> <li> <p><a href="#actuator.metrics.export.appoptics">AppOptics</a></p> </li> <li> <p><a href="#actuator.metrics.export.atlas">Atlas</a></p> </li> <li> <p><a href="#actuator.metrics.export.datadog">Datadog</a></p> </li> <li> <p><a href="#actuator.metrics.export.dynatrace">Dynatrace</a></p> </li> <li> <p><a href="#actuator.metrics.export.elastic">Elastic</a></p> </li> <li> <p><a href="#actuator.metrics.export.ganglia">Ganglia</a></p> </li> <li> <p><a href="#actuator.metrics.export.graphite">Graphite</a></p> </li> <li> <p><a href="#actuator.metrics.export.humio">Humio</a></p> </li> <li> <p><a href="#actuator.metrics.export.influx">Influx</a></p> </li> <li> <p><a href="#actuator.metrics.export.jmx">JMX</a></p> </li> <li> <p><a href="#actuator.metrics.export.kairos">KairosDB</a></p> </li> <li> <p><a href="#actuator.metrics.export.newrelic">New Relic</a></p> </li> <li> <p><a href="#actuator.metrics.export.otlp">OpenTelemetry</a></p> </li> <li> <p><a href="#actuator.metrics.export.prometheus">Prometheus</a></p> </li> <li> <p><a href="#actuator.metrics.export.signalfx">SignalFx</a></p> </li> <li> <p><a href="#actuator.metrics.export.simple">Simple (in-memory)</a></p> </li> <li> <p><a href="#actuator.metrics.export.stackdriver">Stackdriver</a></p> </li> <li> <p><a href="#actuator.metrics.export.statsd">StatsD</a></p> </li> <li> <p><a href="#actuator.metrics.export.wavefront">Wavefront</a></p> </li> </ul> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> To learn more about Micrometer’s capabilities, see its <a href="https://micrometer.io/docs">reference documentation</a>, in particular the <a href="https://micrometer.io/docs/concepts">concepts section</a>. </td> </tr> </table> </div> <div class="sect2"> <h3 id="actuator.metrics.getting-started">
7.1. Getting started</h3> <div class="paragraph"> <p>Spring Boot auto-configures a composite <code>MeterRegistry</code> and adds a registry to the composite for each of the supported implementations that it finds on the classpath. Having a dependency on <code>micrometer-registry-{system}</code> in your runtime classpath is enough for Spring Boot to configure the registry.</p> </div> <div class="paragraph"> <p>Most registries share common features. For instance, you can disable a particular registry even if the Micrometer registry implementation is on the classpath. The following example disables Datadog:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.datadog.metrics.export.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  datadog:
    metrics:
      export:
        enabled: false</code></pre> </div> </div> <div class="paragraph"> <p>You can also disable all registries unless stated otherwise by the registry-specific property, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.defaults.metrics.export.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  defaults:
    metrics:
      export:
        enabled: false</code></pre> </div> </div> <div class="paragraph"> <p>Spring Boot also adds any auto-configured registries to the global static composite registry on the <code>Metrics</code> class, unless you explicitly tell it not to:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.metrics.use-global-registry=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  metrics:
    use-global-registry: false</code></pre> </div> </div> <div class="paragraph"> <p>You can register any number of <code>MeterRegistryCustomizer</code> beans to further configure the registry, such as applying common tags, before any meters are registered with the registry:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.MeterRegistry;

import org.springframework.boot.actuate.autoconfigure.metrics.MeterRegistryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyMeterRegistryConfiguration {

    @Bean
    public MeterRegistryCustomizer&lt;MeterRegistry&gt; metricsCommonTags() {
        return (registry) -&gt; registry.config().commonTags("region", "us-east-1");
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.MeterRegistry
import org.springframework.boot.actuate.autoconfigure.metrics.MeterRegistryCustomizer
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyMeterRegistryConfiguration {

    @Bean
    fun metricsCommonTags(): MeterRegistryCustomizer&lt;MeterRegistry&gt; {
        return MeterRegistryCustomizer { registry -&gt;
            registry.config().commonTags("region", "us-east-1")
        }
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>You can apply customizations to particular registry implementations by being more specific about the generic type:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Meter;
import io.micrometer.core.instrument.config.NamingConvention;
import io.micrometer.graphite.GraphiteMeterRegistry;

import org.springframework.boot.actuate.autoconfigure.metrics.MeterRegistryCustomizer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyMeterRegistryConfiguration {

    @Bean
    public MeterRegistryCustomizer&lt;GraphiteMeterRegistry&gt; graphiteMetricsNamingConvention() {
        return (registry) -&gt; registry.config().namingConvention(this::name);
    }

    private String name(String name, Meter.Type type, String baseUnit) {
        return ...
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Meter
import io.micrometer.core.instrument.config.NamingConvention
import io.micrometer.graphite.GraphiteMeterRegistry
import org.springframework.boot.actuate.autoconfigure.metrics.MeterRegistryCustomizer
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyMeterRegistryConfiguration {

    @Bean
    fun graphiteMetricsNamingConvention(): MeterRegistryCustomizer&lt;GraphiteMeterRegistry&gt; {
        return MeterRegistryCustomizer { registry: GraphiteMeterRegistry -&gt;
            registry.config().namingConvention(this::name)
        }
    }

    private fun name(name: String, type: Meter.Type, baseUnit: String?): String {
        return  ...
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>Spring Boot also <a href="#actuator.metrics.supported">configures built-in instrumentation</a> that you can control through configuration or dedicated annotation markers.</p> </div> </div> <div class="sect2"> <h3 id="actuator.metrics.export">
7.2. Supported Monitoring Systems</h3> <div class="paragraph"> <p>This section briefly describes each of the supported monitoring systems.</p> </div> <div class="sect3"> <h4 id="actuator.metrics.export.appoptics">
7.2.1. AppOptics</h4> <div class="paragraph"> <p>By default, the AppOptics registry periodically pushes metrics to <code><a href="https://api.appoptics.com/v1/measurements" class="bare">api.appoptics.com/v1/measurements</a></code>. To export metrics to SaaS <a href="https://micrometer.io/docs/registry/appOptics">AppOptics</a>, your API token must be provided:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.appoptics.metrics.export.api-token=YOUR_TOKEN</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  appoptics:
    metrics:
      export:
        api-token: "YOUR_TOKEN"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.atlas">
7.2.2. Atlas</h4> <div class="paragraph"> <p>By default, metrics are exported to <a href="https://micrometer.io/docs/registry/atlas">Atlas</a> running on your local machine. You can provide the location of the <a href="https://github.com/Netflix/atlas">Atlas server</a>:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.atlas.metrics.export.uri=https://atlas.example.com:7101/api/v1/publish</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  atlas:
    metrics:
      export:
        uri: "https://atlas.example.com:7101/api/v1/publish"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.datadog">
7.2.3. Datadog</h4> <div class="paragraph"> <p>A Datadog registry periodically pushes metrics to <a href="https://www.datadoghq.com">datadoghq</a>. To export metrics to <a href="https://micrometer.io/docs/registry/datadog">Datadog</a>, you must provide your API key:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.datadog.metrics.export.api-key=YOUR_KEY</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  datadog:
    metrics:
      export:
        api-key: "YOUR_KEY"</code></pre> </div> </div> <div class="paragraph"> <p>If you additionally provide an application key (optional), then metadata such as meter descriptions, types, and base units will also be exported:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.datadog.metrics.export.api-key=YOUR_API_KEY
management.datadog.metrics.export.application-key=YOUR_APPLICATION_KEY</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  datadog:
    metrics:
      export:
        api-key: "YOUR_API_KEY"
        application-key: "YOUR_APPLICATION_KEY"</code></pre> </div> </div> <div class="paragraph"> <p>By default, metrics are sent to the Datadog US <a href="https://docs.datadoghq.com/getting_started/site">site</a> (<code><a href="https://api.datadoghq.com" class="bare">api.datadoghq.com</a></code>). If your Datadog project is hosted on one of the other sites, or you need to send metrics through a proxy, configure the URI accordingly:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.datadog.metrics.export.uri=https://api.datadoghq.eu</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  datadog:
    metrics:
      export:
        uri: "https://api.datadoghq.eu"</code></pre> </div> </div> <div class="paragraph"> <p>You can also change the interval at which metrics are sent to Datadog:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.datadog.metrics.export.step=30s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  datadog:
    metrics:
      export:
        step: "30s"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.dynatrace">
7.2.4. Dynatrace</h4> <div class="paragraph"> <p>Dynatrace offers two metrics ingest APIs, both of which are implemented for <a href="https://micrometer.io/docs/registry/dynatrace">Micrometer</a>. You can find the Dynatrace documentation on Micrometer metrics ingest <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/micrometer">here</a>. Configuration properties in the <code>v1</code> namespace apply only when exporting to the <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v1/">Timeseries v1 API</a>. Configuration properties in the <code>v2</code> namespace apply only when exporting to the <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v2/post-ingest-metrics/">Metrics v2 API</a>. Note that this integration can export only to either the <code>v1</code> or <code>v2</code> version of the API at a time, with <code>v2</code> being preferred. If the <code>device-id</code> (required for v1 but not used in v2) is set in the <code>v1</code> namespace, metrics are exported to the <code>v1</code> endpoint. Otherwise, <code>v2</code> is assumed.</p> </div> <div class="sect4"> <h5 id="actuator.metrics.export.dynatrace.v2-api">
v2 API</h5> <div class="paragraph"> <p>You can use the v2 API in two ways.</p> </div> <div class="sect5"> <h6 id="actuator.metrics.export.dynatrace.v2-api.auto-config">
Auto-configuration</h6> <div class="paragraph"> <p>Dynatrace auto-configuration is available for hosts that are monitored by the OneAgent or by the Dynatrace Operator for Kubernetes.</p> </div> <div class="paragraph"> <p><strong>Local OneAgent:</strong> If a OneAgent is running on the host, metrics are automatically exported to the <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/local-api/">local OneAgent ingest endpoint</a>. The ingest endpoint forwards the metrics to the Dynatrace backend.</p> </div> <div class="paragraph"> <p><strong>Dynatrace Kubernetes Operator:</strong> When running in Kubernetes with the Dynatrace Operator installed, the registry will automatically pick up your endpoint URI and API token from the operator instead.</p> </div> <div class="paragraph"> <p>This is the default behavior and requires no special setup beyond a dependency on <code>io.micrometer:micrometer-registry-dynatrace</code>.</p> </div> </div> <div class="sect5"> <h6 id="actuator.metrics.export.dynatrace.v2-api.manual-config">
Manual configuration</h6> <div class="paragraph"> <p>If no auto-configuration is available, the endpoint of the <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v2/post-ingest-metrics/">Metrics v2 API</a> and an API token are required. The <a href="https://www.dynatrace.com/support/help/dynatrace-api/basics/dynatrace-api-authentication/">API token</a> must have the “Ingest metrics” (<code>metrics.ingest</code>) permission set. We recommend limiting the scope of the token to this one permission. You must ensure that the endpoint URI contains the path (for example, <code>/api/v2/metrics/ingest</code>):</p> </div> <div class="paragraph"> <p>The URL of the Metrics API v2 ingest endpoint is different according to your deployment option:</p> </div> <div class="ulist"> <ul> <li> <p>SaaS: <code>https://{your-environment-id}.live.dynatrace.com/api/v2/metrics/ingest</code></p> </li> <li> <p>Managed deployments: <code>https://{your-domain}/e/{your-environment-id}/api/v2/metrics/ingest</code></p> </li> </ul> </div> <div class="paragraph"> <p>The example below configures metrics export using the <code>example</code> environment id:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.dynatrace.metrics.export.uri=https://example.live.dynatrace.com/api/v2/metrics/ingest
management.dynatrace.metrics.export.api-token=YOUR_TOKEN</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  dynatrace:
    metrics:
      export:
        uri: "https://example.live.dynatrace.com/api/v2/metrics/ingest"
        api-token: "YOUR_TOKEN"</code></pre> </div> </div> <div class="paragraph"> <p>When using the Dynatrace v2 API, the following optional features are available (more details can be found in the <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/micrometer#dt-configuration-properties">Dynatrace documentation</a>):</p> </div> <div class="ulist"> <ul> <li> <p>Metric key prefix: Sets a prefix that is prepended to all exported metric keys.</p> </li> <li> <p>Enrich with Dynatrace metadata: If a OneAgent or Dynatrace operator is running, enrich metrics with additional metadata (for example, about the host, process, or pod).</p> </li> <li> <p>Default dimensions: Specify key-value pairs that are added to all exported metrics. If tags with the same key are specified with Micrometer, they overwrite the default dimensions.</p> </li> <li> <p>Use Dynatrace Summary instruments: In some cases the Micrometer Dynatrace registry created metrics that were rejected. In Micrometer 1.9.x, this was fixed by introducing Dynatrace-specific summary instruments. Setting this toggle to <code>false</code> forces Micrometer to fall back to the behavior that was the default before 1.9.x. It should only be used when encountering problems while migrating from Micrometer 1.8.x to 1.9.x.</p> </li> </ul> </div> <div class="paragraph"> <p>It is possible to not specify a URI and API token, as shown in the following example. In this scenario, the automatically configured endpoint is used:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.dynatrace.metrics.export.v2.metric-key-prefix=your.key.prefix
management.dynatrace.metrics.export.v2.enrich-with-dynatrace-metadata=true
management.dynatrace.metrics.export.v2.default-dimensions.key1=value1
management.dynatrace.metrics.export.v2.default-dimensions.key2=value2
management.dynatrace.metrics.export.v2.use-dynatrace-summary-instruments=true</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  dynatrace:
    metrics:
      export:
        # Specify uri and api-token here if not using the local OneAgent endpoint.
        v2:
          metric-key-prefix: "your.key.prefix"
          enrich-with-dynatrace-metadata: true
          default-dimensions:
            key1: "value1"
            key2: "value2"
          use-dynatrace-summary-instruments: true # (default: true)</code></pre> </div> </div> </div> </div> <div class="sect4"> <h5 id="actuator.metrics.export.dynatrace.v1-api">
v1 API (Legacy)</h5> <div class="paragraph"> <p>The Dynatrace v1 API metrics registry pushes metrics to the configured URI periodically by using the <a href="https://www.dynatrace.com/support/help/dynatrace-api/environment-api/metric-v1/">Timeseries v1 API</a>. For backwards-compatibility with existing setups, when <code>device-id</code> is set (required for v1, but not used in v2), metrics are exported to the Timeseries v1 endpoint. To export metrics to <a href="https://micrometer.io/docs/registry/dynatrace">Dynatrace</a>, your API token, device ID, and URI must be provided:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.dynatrace.metrics.export.uri=https://{your-environment-id}.live.dynatrace.com
management.dynatrace.metrics.export.api-token=YOUR_TOKEN
management.dynatrace.metrics.export.v1.device-id=YOUR_DEVICE_ID</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  dynatrace:
    metrics:
      export:
        uri: "https://{your-environment-id}.live.dynatrace.com"
        api-token: "YOUR_TOKEN"
        v1:
          device-id: "YOUR_DEVICE_ID"</code></pre> </div> </div> <div class="paragraph"> <p>For the v1 API, you must specify the base environment URI without a path, as the v1 endpoint path is added automatically.</p> </div> </div> <div class="sect4"> <h5 id="actuator.metrics.export.dynatrace.version-independent-settings">
Version-independent Settings</h5> <div class="paragraph"> <p>In addition to the API endpoint and token, you can also change the interval at which metrics are sent to Dynatrace. The default export interval is <code>60s</code>. The following example sets the export interval to 30 seconds:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.dynatrace.metrics.export.step=30s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  dynatrace:
    metrics:
      export:
        step: "30s"</code></pre> </div> </div> <div class="paragraph"> <p>You can find more information on how to set up the Dynatrace exporter for Micrometer in the <a href="https://micrometer.io/docs/registry/dynatrace">Micrometer documentation</a> and the <a href="https://www.dynatrace.com/support/help/how-to-use-dynatrace/metrics/metric-ingestion/ingestion-methods/micrometer">Dynatrace documentation</a>.</p> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.elastic">
7.2.5. Elastic</h4> <div class="paragraph"> <p>By default, metrics are exported to <a href="https://micrometer.io/docs/registry/elastic">Elastic</a> running on your local machine. You can provide the location of the Elastic server to use by using the following property:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.elastic.metrics.export.host=https://elastic.example.com:8086</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  elastic:
    metrics:
      export:
        host: "https://elastic.example.com:8086"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.ganglia">
7.2.6. Ganglia</h4> <div class="paragraph"> <p>By default, metrics are exported to <a href="https://micrometer.io/docs/registry/ganglia">Ganglia</a> running on your local machine. You can provide the <a href="http://ganglia.sourceforge.net">Ganglia server</a> host and port, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.ganglia.metrics.export.host=ganglia.example.com
management.ganglia.metrics.export.port=9649</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  ganglia:
    metrics:
      export:
        host: "ganglia.example.com"
        port: 9649</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.graphite">
7.2.7. Graphite</h4> <div class="paragraph"> <p>By default, metrics are exported to <a href="https://micrometer.io/docs/registry/graphite">Graphite</a> running on your local machine. You can provide the <a href="https://graphiteapp.org">Graphite server</a> host and port, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.graphite.metrics.export.host=graphite.example.com
management.graphite.metrics.export.port=9004</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  graphite:
    metrics:
      export:
         host: "graphite.example.com"
         port: 9004</code></pre> </div> </div> <div class="paragraph"> <p>Micrometer provides a default <code>HierarchicalNameMapper</code> that governs how a dimensional meter ID is <a href="https://micrometer.io/docs/registry/graphite#_hierarchical_name_mapping">mapped to flat hierarchical names</a>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> <div class="paragraph"> <p>To take control over this behavior, define your <code>GraphiteMeterRegistry</code> and supply your own <code>HierarchicalNameMapper</code>. An auto-configured <code>GraphiteConfig</code> and <code>Clock</code> beans are provided unless you define your own:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Clock;
import io.micrometer.core.instrument.Meter;
import io.micrometer.core.instrument.config.NamingConvention;
import io.micrometer.core.instrument.util.HierarchicalNameMapper;
import io.micrometer.graphite.GraphiteConfig;
import io.micrometer.graphite.GraphiteMeterRegistry;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyGraphiteConfiguration {

    @Bean
    public GraphiteMeterRegistry graphiteMeterRegistry(GraphiteConfig config, Clock clock) {
        return new GraphiteMeterRegistry(config, clock, this::toHierarchicalName);
    }

    private String toHierarchicalName(Meter.Id id, NamingConvention convention) {
        return ...
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Clock
import io.micrometer.core.instrument.Meter
import io.micrometer.core.instrument.config.NamingConvention
import io.micrometer.core.instrument.util.HierarchicalNameMapper
import io.micrometer.graphite.GraphiteConfig
import io.micrometer.graphite.GraphiteMeterRegistry
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyGraphiteConfiguration {

    @Bean
    fun graphiteMeterRegistry(config: GraphiteConfig, clock: Clock): GraphiteMeterRegistry {
        return GraphiteMeterRegistry(config, clock, this::toHierarchicalName)
    }
    private fun toHierarchicalName(id: Meter.Id, convention: NamingConvention): String {
        return  ...
    }

}
</span></code></pre> </div> </div> </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.humio">
7.2.8. Humio</h4> <div class="paragraph"> <p>By default, the Humio registry periodically pushes metrics to <a href="https://cloud.humio.com" class="bare">cloud.humio.com</a>. To export metrics to SaaS <a href="https://micrometer.io/docs/registry/humio">Humio</a>, you must provide your API token:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.humio.metrics.export.api-token=YOUR_TOKEN</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  humio:
    metrics:
      export:
        api-token: "YOUR_TOKEN"</code></pre> </div> </div> <div class="paragraph"> <p>You should also configure one or more tags to identify the data source to which metrics are pushed:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.humio.metrics.export.tags.alpha=a
management.humio.metrics.export.tags.bravo=b</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  humio:
    metrics:
      export:
        tags:
          alpha: "a"
          bravo: "b"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.influx">
7.2.9. Influx</h4> <div class="paragraph"> <p>By default, metrics are exported to an <a href="https://micrometer.io/docs/registry/influx">Influx</a> v1 instance running on your local machine with the default configuration. To export metrics to InfluxDB v2, configure the <code>org</code>, <code>bucket</code>, and authentication <code>token</code> for writing metrics. You can provide the location of the <a href="https://www.influxdata.com">Influx server</a> to use by using:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.influx.metrics.export.uri=https://influx.example.com:8086</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  influx:
    metrics:
      export:
        uri: "https://influx.example.com:8086"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.jmx">
7.2.10. JMX</h4> <div class="paragraph"> <p>Micrometer provides a hierarchical mapping to <a href="https://micrometer.io/docs/registry/jmx">JMX</a>, primarily as a cheap and portable way to view metrics locally. By default, metrics are exported to the <code>metrics</code> JMX domain. You can provide the domain to use by using:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.jmx.metrics.export.domain=com.example.app.metrics</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  jmx:
    metrics:
      export:
        domain: "com.example.app.metrics"</code></pre> </div> </div> <div class="paragraph"> <p>Micrometer provides a default <code>HierarchicalNameMapper</code> that governs how a dimensional meter ID is <a href="https://micrometer.io/docs/registry/jmx#_hierarchical_name_mapping">mapped to flat hierarchical names</a>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> <div class="paragraph"> <p>To take control over this behavior, define your <code>JmxMeterRegistry</code> and supply your own <code>HierarchicalNameMapper</code>. An auto-configured <code>JmxConfig</code> and <code>Clock</code> beans are provided unless you define your own:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Clock;
import io.micrometer.core.instrument.Meter;
import io.micrometer.core.instrument.config.NamingConvention;
import io.micrometer.core.instrument.util.HierarchicalNameMapper;
import io.micrometer.jmx.JmxConfig;
import io.micrometer.jmx.JmxMeterRegistry;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyJmxConfiguration {

    @Bean
    public JmxMeterRegistry jmxMeterRegistry(JmxConfig config, Clock clock) {
        return new JmxMeterRegistry(config, clock, this::toHierarchicalName);
    }

    private String toHierarchicalName(Meter.Id id, NamingConvention convention) {
        return ...
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Clock
import io.micrometer.core.instrument.Meter
import io.micrometer.core.instrument.config.NamingConvention
import io.micrometer.core.instrument.util.HierarchicalNameMapper
import io.micrometer.jmx.JmxConfig
import io.micrometer.jmx.JmxMeterRegistry
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyJmxConfiguration {

    @Bean
    fun jmxMeterRegistry(config: JmxConfig, clock: Clock): JmxMeterRegistry {
        return JmxMeterRegistry(config, clock, this::toHierarchicalName)
    }

    private fun toHierarchicalName(id: Meter.Id, convention: NamingConvention): String {
        return  ...
    }

}
</span></code></pre> </div> </div> </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.kairos">
7.2.11. KairosDB</h4> <div class="paragraph"> <p>By default, metrics are exported to <a href="https://micrometer.io/docs/registry/kairos">KairosDB</a> running on your local machine. You can provide the location of the <a href="https://kairosdb.github.io/">KairosDB server</a> to use by using:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.kairos.metrics.export.uri=https://kairosdb.example.com:8080/api/v1/datapoints</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  kairos:
    metrics:
      export:
        uri: "https://kairosdb.example.com:8080/api/v1/datapoints"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.newrelic">
7.2.12. New Relic</h4> <div class="paragraph"> <p>A New Relic registry periodically pushes metrics to <a href="https://micrometer.io/docs/registry/new-relic">New Relic</a>. To export metrics to <a href="https://newrelic.com">New Relic</a>, you must provide your API key and account ID:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.newrelic.metrics.export.api-key=YOUR_KEY
management.newrelic.metrics.export.account-id=YOUR_ACCOUNT_ID</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  newrelic:
    metrics:
      export:
        api-key: "YOUR_KEY"
        account-id: "YOUR_ACCOUNT_ID"</code></pre> </div> </div> <div class="paragraph"> <p>You can also change the interval at which metrics are sent to New Relic:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.newrelic.metrics.export.step=30s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  newrelic:
    metrics:
      export:
        step: "30s"</code></pre> </div> </div> <div class="paragraph"> <p>By default, metrics are published through REST calls, but you can also use the Java Agent API if you have it on the classpath:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.newrelic.metrics.export.client-provider-type=insights-agent</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  newrelic:
    metrics:
      export:
        client-provider-type: "insights-agent"</code></pre> </div> </div> <div class="paragraph"> <p>Finally, you can take full control by defining your own <code>NewRelicClientProvider</code> bean.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.otlp">
7.2.13. OpenTelemetry</h4> <div class="paragraph"> <p>By default, metrics are exported to <a href="https://micrometer.io/docs/registry/otlp">OpenTelemetry</a> running on your local machine. You can provide the location of the <a href="https://opentelemetry.io/">OpenTelemetry metric endpoint</a> to use by using:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.otlp.metrics.export.url=https://otlp.example.com:4318/v1/metrics</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  otlp:
    metrics:
      export:
        url: "https://otlp.example.com:4318/v1/metrics"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.prometheus">
7.2.14. Prometheus</h4> <div class="paragraph"> <p><a href="https://micrometer.io/docs/registry/prometheus">Prometheus</a> expects to scrape or poll individual application instances for metrics. Spring Boot provides an actuator endpoint at <code>/actuator/prometheus</code> to present a <a href="https://prometheus.io">Prometheus scrape</a> with the appropriate format.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> By default, the endpoint is not available and must be exposed. See <a href="#actuator.endpoints.exposing">exposing endpoints</a> for more details. </td> </tr> </table> </div> <div class="paragraph"> <p>The following example <code>scrape_config</code> adds to <code>prometheus.yml</code>:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">scrape_configs:
  - job_name: "spring"
    metrics_path: "/actuator/prometheus"
    static_configs:
      - targets: ["HOST:PORT"]</code></pre> </div> </div> <div class="paragraph"> <p><a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#exemplars-storage">Prometheus Exemplars</a> are also supported. To enable this feature, a <code>SpanContextSupplier</code> bean should be present. If you use <a href="https://micrometer.io/docs/tracing">Micrometer Tracing</a>, this will be auto-configured for you, but you can always create your own if you want. Please check the <a href="https://prometheus.io/docs/prometheus/latest/feature_flags/#exemplars-storage">Prometheus Docs</a>, since this feature needs to be explicitly enabled on Prometheus' side, and it is only supported using the <a href="https://github.com/OpenObservability/OpenMetrics/blob/v1.0.0/specification/OpenMetrics.md#exemplars">OpenMetrics</a> format.</p> </div> <div class="paragraph"> <p>For ephemeral or batch jobs that may not exist long enough to be scraped, you can use <a href="https://github.com/prometheus/pushgateway">Prometheus Pushgateway</a> support to expose the metrics to Prometheus. To enable Prometheus Pushgateway support, add the following dependency to your project:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="xml"><code class="language-xml" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.prometheus&lt;/groupId&gt;
    &lt;artifactId&gt;simpleclient_pushgateway&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre> </div> </div> <div class="paragraph"> <p>When the Prometheus Pushgateway dependency is present on the classpath and the <code>management.prometheus.metrics.export.pushgateway.enabled</code> property is set to <code>true</code>, a <code>PrometheusPushGatewayManager</code> bean is auto-configured. This manages the pushing of metrics to a Prometheus Pushgateway.</p> </div> <div class="paragraph"> <p>You can tune the <code>PrometheusPushGatewayManager</code> by using properties under <code>management.prometheus.metrics.export.pushgateway</code>. For advanced configuration, you can also provide your own <code>PrometheusPushGatewayManager</code> bean.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.signalfx">
7.2.15. SignalFx</h4> <div class="paragraph"> <p>SignalFx registry periodically pushes metrics to <a href="https://micrometer.io/docs/registry/signalFx">SignalFx</a>. To export metrics to <a href="https://www.signalfx.com">SignalFx</a>, you must provide your access token:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.signalfx.metrics.export.access-token=YOUR_ACCESS_TOKEN</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  signalfx:
    metrics:
      export:
        access-token: "YOUR_ACCESS_TOKEN"</code></pre> </div> </div> <div class="paragraph"> <p>You can also change the interval at which metrics are sent to SignalFx:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.signalfx.metrics.export.step=30s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  signalfx:
    metrics:
      export:
        step: "30s"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.simple">
7.2.16. Simple</h4> <div class="paragraph"> <p>Micrometer ships with a simple, in-memory backend that is automatically used as a fallback if no other registry is configured. This lets you see what metrics are collected in the <a href="#actuator.metrics.endpoint">metrics endpoint</a>.</p> </div> <div class="paragraph"> <p>The in-memory backend disables itself as soon as you use any other available backend. You can also disable it explicitly:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.simple.metrics.export.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  simple:
    metrics:
      export:
        enabled: false</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.stackdriver">
7.2.17. Stackdriver</h4> <div class="paragraph"> <p>The Stackdriver registry periodically pushes metrics to <a href="https://cloud.google.com/stackdriver/">Stackdriver</a>. To export metrics to SaaS <a href="https://micrometer.io/docs/registry/stackdriver">Stackdriver</a>, you must provide your Google Cloud project ID:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.stackdriver.metrics.export.project-id=my-project</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  stackdriver:
    metrics:
      export:
        project-id: "my-project"</code></pre> </div> </div> <div class="paragraph"> <p>You can also change the interval at which metrics are sent to Stackdriver:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.stackdriver.metrics.export.step=30s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  stackdriver:
    metrics:
      export:
        step: "30s"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.statsd">
7.2.18. StatsD</h4> <div class="paragraph"> <p>The StatsD registry eagerly pushes metrics over UDP to a StatsD agent. By default, metrics are exported to a <a href="https://micrometer.io/docs/registry/statsD">StatsD</a> agent running on your local machine. You can provide the StatsD agent host, port, and protocol to use by using:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.statsd.metrics.export.host=statsd.example.com
management.statsd.metrics.export.port=9125
management.statsd.metrics.export.protocol=udp</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  statsd:
    metrics:
      export:
        host: "statsd.example.com"
        port: 9125
        protocol: "udp"</code></pre> </div> </div> <div class="paragraph"> <p>You can also change the StatsD line protocol to use (it defaults to Datadog):</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.statsd.metrics.export.flavor=etsy</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  statsd:
    metrics:
      export:
        flavor: "etsy"</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.export.wavefront">
7.2.19. Wavefront</h4> <div class="paragraph"> <p>The Wavefront registry periodically pushes metrics to <a href="https://micrometer.io/docs/registry/wavefront">Wavefront</a>. If you are exporting metrics to <a href="https://www.wavefront.com/">Wavefront</a> directly, you must provide your API token:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.wavefront.api-token=YOUR_API_TOKEN</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  wavefront:
    api-token: "YOUR_API_TOKEN"</code></pre> </div> </div> <div class="paragraph"> <p>Alternatively, you can use a Wavefront sidecar or an internal proxy in your environment to forward metrics data to the Wavefront API host:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.wavefront.uri=proxy://localhost:2878</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  wavefront:
    uri: "proxy://localhost:2878"</code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> If you publish metrics to a Wavefront proxy (as described in <a href="https://docs.wavefront.com/proxies_installing.html">the Wavefront documentation</a>), the host must be in the <code>proxy://HOST:PORT</code> format. </td> </tr> </table> </div> <div class="paragraph"> <p>You can also change the interval at which metrics are sent to Wavefront:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.wavefront.metrics.export.step=30s</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  wavefront:
    metrics:
      export:
        step: "30s"</code></pre> </div> </div> </div> </div> <div class="sect2"> <h3 id="actuator.metrics.supported">
7.3. Supported Metrics and Meters</h3> <div class="paragraph"> <p>Spring Boot provides automatic meter registration for a wide variety of technologies. In most situations, the defaults provide sensible metrics that can be published to any of the supported monitoring systems.</p> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.jvm">
7.3.1. JVM Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables JVM Metrics by using core Micrometer classes. JVM metrics are published under the <code>jvm.</code> meter name.</p> </div> <div class="paragraph"> <p>The following JVM metrics are provided:</p> </div> <div class="ulist"> <ul> <li> <p>Various memory and buffer pool details</p> </li> <li> <p>Statistics related to garbage collection</p> </li> <li> <p>Thread utilization</p> </li> <li> <p>The number of classes loaded and unloaded</p> </li> <li> <p>JVM version information</p> </li> <li> <p>JIT compilation time</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.system">
7.3.2. System Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables system metrics by using core Micrometer classes. System metrics are published under the <code>system.</code>, <code>process.</code>, and <code>disk.</code> meter names.</p> </div> <div class="paragraph"> <p>The following system metrics are provided:</p> </div> <div class="ulist"> <ul> <li> <p>CPU metrics</p> </li> <li> <p>File descriptor metrics</p> </li> <li> <p>Uptime metrics (both the amount of time the application has been running and a fixed gauge of the absolute start time)</p> </li> <li> <p>Disk space available</p> </li> </ul> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.application-startup">
7.3.3. Application Startup Metrics</h4> <div class="paragraph"> <p>Auto-configuration exposes application startup time metrics:</p> </div> <div class="ulist"> <ul> <li> <p><code>application.started.time</code>: time taken to start the application.</p> </li> <li> <p><code>application.ready.time</code>: time taken for the application to be ready to service requests.</p> </li> </ul> </div> <div class="paragraph"> <p>Metrics are tagged by the fully qualified name of the application class.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.logger">
7.3.4. Logger Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the event metrics for both Logback and Log4J2. The details are published under the <code>log4j2.events.</code> or <code>logback.events.</code> meter names.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.tasks">
7.3.5. Task Execution and Scheduling Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all available <code>ThreadPoolTaskExecutor</code> and <code>ThreadPoolTaskScheduler</code> beans, as long as the underling <code>ThreadPoolExecutor</code> is available. Metrics are tagged by the name of the executor, which is derived from the bean name.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.spring-mvc">
7.3.6. Spring MVC Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all requests handled by Spring MVC controllers and functional handlers. By default, metrics are generated with the name, <code>http.server.requests</code>. You can customize the name by setting the <code>management.observations.http.server.requests.name</code> property.</p> </div> <div class="paragraph"> <p>See the <a href="https://docs.spring.io/spring-framework/docs/6.0.11/reference/html/integration.html#integration.observability.http-server.servlet">Spring Framework reference documentation for more information on produced observations</a>.</p> </div> <div class="paragraph"> <p>To add to the default tags, provide a <code>@Bean</code> that extends <code>DefaultServerRequestObservationConvention</code> from the <code>org.springframework.http.server.observation</code> package. To replace the default tags, provide a <code>@Bean</code> that implements <code>ServerRequestObservationConvention</code>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> In some cases, exceptions handled in web controllers are not recorded as request metrics tags. Applications can opt in and record exceptions by <a href="web.html#web.servlet.spring-mvc.error-handling">setting handled exceptions as request attributes</a>. </td> </tr> </table> </div> <div class="paragraph"> <p>By default, all requests are handled. To customize the filter, provide a <code>@Bean</code> that implements <code>FilterRegistrationBean&lt;WebMvcMetricsFilter&gt;</code>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.spring-webflux">
7.3.7. Spring WebFlux Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all requests handled by Spring WebFlux controllers and functional handlers. By default, metrics are generated with the name, <code>http.server.requests</code>. You can customize the name by setting the <code>management.observations.http.server.requests.name</code> property.</p> </div> <div class="paragraph"> <p>See the <a href="https://docs.spring.io/spring-framework/docs/6.0.11/reference/html/integration.html#integration.observability.http-server.reactive">Spring Framework reference documentation for more information on produced observations</a>.</p> </div> <div class="paragraph"> <p>To add to the default tags, provide a <code>@Bean</code> that extends <code>DefaultServerRequestObservationConvention</code> from the <code>org.springframework.http.server.reactive.observation</code> package. To replace the default tags, provide a <code>@Bean</code> that implements <code>ServerRequestObservationConvention</code>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> In some cases, exceptions handled in controllers and handler functions are not recorded as request metrics tags. Applications can opt in and record exceptions by <a href="web.html#web.reactive.webflux.error-handling">setting handled exceptions as request attributes</a>. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.jersey">
7.3.8. Jersey Server Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all requests handled by the Jersey JAX-RS implementation. By default, metrics are generated with the name, <code>http.server.requests</code>. You can customize the name by setting the <code>management.observations.http.server.requests.name</code> property.</p> </div> <div class="paragraph"> <p>By default, Jersey server metrics are tagged with the following information:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Tag</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>exception</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The simple class name of any exception that was thrown while handling the request.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>method</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The request’s method (for example, <code>GET</code> or <code>POST</code>)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>outcome</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The request’s outcome, based on the status code of the response. 1xx is <code>INFORMATIONAL</code>, 2xx is <code>SUCCESS</code>, 3xx is <code>REDIRECTION</code>, 4xx is <code>CLIENT_ERROR</code>, and 5xx is <code>SERVER_ERROR</code></p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>status</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The response’s HTTP status code (for example, <code>200</code> or <code>500</code>)</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>uri</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The request’s URI template prior to variable substitution, if possible (for example, <code>/api/person/{id}</code>)</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>To customize the tags, provide a <code>@Bean</code> that implements <code>JerseyTagsProvider</code>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.http-clients">
7.3.9. HTTP Client Metrics</h4> <div class="paragraph"> <p>Spring Boot Actuator manages the instrumentation of both <code>RestTemplate</code> and <code>WebClient</code>. For that, you have to inject the auto-configured builder and use it to create instances:</p> </div> <div class="ulist"> <ul> <li> <p><code>RestTemplateBuilder</code> for <code>RestTemplate</code></p> </li> <li> <p><code>WebClient.Builder</code> for <code>WebClient</code></p> </li> </ul> </div> <div class="paragraph"> <p>You can also manually apply the customizers responsible for this instrumentation, namely <code>ObservationRestTemplateCustomizer</code> and <code>ObservationWebClientCustomizer</code>.</p> </div> <div class="paragraph"> <p>By default, metrics are generated with the name, <code>http.client.requests</code>. You can customize the name by setting the <code>management.observations.http.client.requests.name</code> property.</p> </div> <div class="paragraph"> <p>See the <a href="https://docs.spring.io/spring-framework/docs/6.0.11/reference/html/integration.html#integration.observability.http-client">Spring Framework reference documentation for more information on produced observations</a>.</p> </div> <div class="paragraph"> <p>To customize the tags when using <code>RestTemplate</code>, provide a <code>@Bean</code> that implements <code>ClientRequestObservationConvention</code> from the <code>org.springframework.http.client.observation</code> package. To customize the tags when using <code>WebClient</code>, provide a <code>@Bean</code> that implements <code>ClientRequestObservationConvention</code> from the <code>org.springframework.web.reactive.function.client</code> package.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.tomcat">
7.3.10. Tomcat Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of Tomcat only when an <code>MBeanRegistry</code> is enabled. By default, the <code>MBeanRegistry</code> is disabled, but you can enable it by setting <code>server.tomcat.mbeanregistry.enabled</code> to <code>true</code>.</p> </div> <div class="paragraph"> <p>Tomcat metrics are published under the <code>tomcat.</code> meter name.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.cache">
7.3.11. Cache Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all available <code>Cache</code> instances on startup, with metrics prefixed with <code>cache</code>. Cache instrumentation is standardized for a basic set of metrics. Additional, cache-specific metrics are also available.</p> </div> <div class="paragraph"> <p>The following cache libraries are supported:</p> </div> <div class="ulist"> <ul> <li> <p>Cache2k</p> </li> <li> <p>Caffeine</p> </li> <li> <p>Hazelcast</p> </li> <li> <p>Any compliant JCache (JSR-107) implementation</p> </li> <li> <p>Redis</p> </li> </ul> </div> <div class="paragraph"> <p>Metrics are tagged by the name of the cache and by the name of the <code>CacheManager</code>, which is derived from the bean name.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> Only caches that are configured on startup are bound to the registry. For caches not defined in the cache’s configuration, such as caches created on the fly or programmatically after the startup phase, an explicit registration is required. A <code>CacheMetricsRegistrar</code> bean is made available to make that process easier. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.spring-batch">
7.3.12. Spring Batch Metrics</h4> <div class="paragraph"> <p>See the <a href="https://docs.spring.io/spring-batch/docs/5.0.3/reference/html/monitoring-and-metrics.html">Spring Batch reference documentation</a>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.spring-graphql">
7.3.13. Spring GraphQL Metrics</h4> <div class="paragraph"> <p>See the <a href="https://docs.spring.io/spring-graphql/docs/1.2.2/reference/html/">Spring GraphQL reference documentation</a>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.jdbc">
7.3.14. DataSource Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all available <code>DataSource</code> objects with metrics prefixed with <code>jdbc.connections</code>. Data source instrumentation results in gauges that represent the currently active, idle, maximum allowed, and minimum allowed connections in the pool.</p> </div> <div class="paragraph"> <p>Metrics are also tagged by the name of the <code>DataSource</code> computed based on the bean name.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> By default, Spring Boot provides metadata for all supported data sources. You can add additional <code>DataSourcePoolMetadataProvider</code> beans if your favorite data source is not supported. See <code>DataSourcePoolMetadataProvidersConfiguration</code> for examples. </td> </tr> </table> </div> <div class="paragraph"> <p>Also, Hikari-specific metrics are exposed with a <code>hikaricp</code> prefix. Each metric is tagged by the name of the pool (you can control it with <code>spring.datasource.name</code>).</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.hibernate">
7.3.15. Hibernate Metrics</h4> <div class="paragraph"> <p>If <code>org.hibernate.orm:hibernate-micrometer</code> is on the classpath, all available Hibernate <code>EntityManagerFactory</code> instances that have statistics enabled are instrumented with a metric named <code>hibernate</code>.</p> </div> <div class="paragraph"> <p>Metrics are also tagged by the name of the <code>EntityManagerFactory</code>, which is derived from the bean name.</p> </div> <div class="paragraph"> <p>To enable statistics, the standard JPA property <code>hibernate.generate_statistics</code> must be set to <code>true</code>. You can enable that on the auto-configured <code>EntityManagerFactory</code>:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">spring.jpa.properties[hibernate.generate_statistics]=true</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">spring:
  jpa:
    properties:
      "[hibernate.generate_statistics]": true</code></pre> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.spring-data-repository">
7.3.16. Spring Data Repository Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all Spring Data <code>Repository</code> method invocations. By default, metrics are generated with the name, <code>spring.data.repository.invocations</code>. You can customize the name by setting the <code>management.metrics.data.repository.metric-name</code> property.</p> </div> <div class="paragraph"> <p>The <code>@Timed</code> annotation from the <code>io.micrometer.core.annotation</code> package is supported on <code>Repository</code> interfaces and methods. If you do not want to record metrics for all <code>Repository</code> invocations, you can set <code>management.metrics.data.repository.autotime.enabled</code> to <code>false</code> and exclusively use <code>@Timed</code> annotations instead.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> A <code>@Timed</code> annotation with <code>longTask = true</code> enables a long task timer for the method. Long task timers require a separate metric name and can be stacked with a short task timer. </td> </tr> </table> </div> <div class="paragraph"> <p>By default, repository invocation related metrics are tagged with the following information:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Tag</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>repository</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The simple class name of the source <code>Repository</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>method</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The name of the <code>Repository</code> method that was invoked.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>state</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The result state (<code>SUCCESS</code>, <code>ERROR</code>, <code>CANCELED</code>, or <code>RUNNING</code>).</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>exception</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The simple class name of any exception that was thrown from the invocation.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>To replace the default tags, provide a <code>@Bean</code> that implements <code>RepositoryTagsProvider</code>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.rabbitmq">
7.3.17. RabbitMQ Metrics</h4> <div class="paragraph"> <p>Auto-configuration enables the instrumentation of all available RabbitMQ connection factories with a metric named <code>rabbitmq</code>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.spring-integration">
7.3.18. Spring Integration Metrics</h4> <div class="paragraph"> <p>Spring Integration automatically provides <a href="https://docs.spring.io/spring-integration/docs/6.1.2/reference/html/system-management.html#micrometer-integration">Micrometer support</a> whenever a <code>MeterRegistry</code> bean is available. Metrics are published under the <code>spring.integration.</code> meter name.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.kafka">
7.3.19. Kafka Metrics</h4> <div class="paragraph"> <p>Auto-configuration registers a <code>MicrometerConsumerListener</code> and <code>MicrometerProducerListener</code> for the auto-configured consumer factory and producer factory, respectively. It also registers a <code>KafkaStreamsMicrometerListener</code> for <code>StreamsBuilderFactoryBean</code>. For more detail, see the <a href="https://docs.spring.io/spring-kafka/docs/3.0.10/reference/html/#micrometer-native">Micrometer Native Metrics</a> section of the Spring Kafka documentation.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.mongodb">
7.3.20. MongoDB Metrics</h4> <div class="paragraph"> <p>This section briefly describes the available metrics for MongoDB.</p> </div> <div class="sect4"> <h5 id="actuator.metrics.supported.mongodb.command">
MongoDB Command Metrics</h5> <div class="paragraph"> <p>Auto-configuration registers a <code>MongoMetricsCommandListener</code> with the auto-configured <code>MongoClient</code>.</p> </div> <div class="paragraph"> <p>A timer metric named <code>mongodb.driver.commands</code> is created for each command issued to the underlying MongoDB driver. Each metric is tagged with the following information by default:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Tag</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>command</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The name of the command issued.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>cluster.id</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The identifier of the cluster to which the command was sent.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.address</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The address of the server to which the command was sent.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>status</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The outcome of the command (<code>SUCCESS</code> or <code>FAILED</code>).</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>To replace the default metric tags, define a <code>MongoCommandTagsProvider</code> bean, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.binder.mongodb.MongoCommandTagsProvider;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCommandTagsProviderConfiguration {

    @Bean
    public MongoCommandTagsProvider customCommandTagsProvider() {
        return new CustomCommandTagsProvider();
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.binder.mongodb.MongoCommandTagsProvider
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyCommandTagsProviderConfiguration {

    @Bean
    fun customCommandTagsProvider(): MongoCommandTagsProvider? {
        return CustomCommandTagsProvider()
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>To disable the auto-configured command metrics, set the following property:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.metrics.mongo.command.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  metrics:
    mongo:
      command:
        enabled: false</code></pre> </div> </div> </div> <div class="sect4"> <h5 id="actuator.metrics.supported.mongodb.connection-pool">
MongoDB Connection Pool Metrics</h5> <div class="paragraph"> <p>Auto-configuration registers a <code>MongoMetricsConnectionPoolListener</code> with the auto-configured <code>MongoClient</code>.</p> </div> <div class="paragraph"> <p>The following gauge metrics are created for the connection pool:</p> </div> <div class="ulist"> <ul> <li> <p><code>mongodb.driver.pool.size</code> reports the current size of the connection pool, including idle and and in-use members.</p> </li> <li> <p><code>mongodb.driver.pool.checkedout</code> reports the count of connections that are currently in use.</p> </li> <li> <p><code>mongodb.driver.pool.waitqueuesize</code> reports the current size of the wait queue for a connection from the pool.</p> </li> </ul> </div> <div class="paragraph"> <p>Each metric is tagged with the following information by default:</p> </div> <table class="tableblock frame-all grid-all stretch"> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Tag</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>cluster.id</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The identifier of the cluster to which the connection pool corresponds.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>server.address</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">The address of the server to which the connection pool corresponds.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>To replace the default metric tags, define a <code>MongoConnectionPoolTagsProvider</code> bean:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.binder.mongodb.MongoConnectionPoolTagsProvider;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyConnectionPoolTagsProviderConfiguration {

    @Bean
    public MongoConnectionPoolTagsProvider customConnectionPoolTagsProvider() {
        return new CustomConnectionPoolTagsProvider();
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.binder.mongodb.MongoConnectionPoolTagsProvider
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyConnectionPoolTagsProviderConfiguration {

    @Bean
    fun customConnectionPoolTagsProvider(): MongoConnectionPoolTagsProvider {
        return CustomConnectionPoolTagsProvider()
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>To disable the auto-configured connection pool metrics, set the following property:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.metrics.mongo.connectionpool.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  metrics:
    mongo:
      connectionpool:
        enabled: false</code></pre> </div> </div> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.jetty">
7.3.21. Jetty Metrics</h4> <div class="paragraph"> <p>Auto-configuration binds metrics for Jetty’s <code>ThreadPool</code> by using Micrometer’s <code>JettyServerThreadPoolMetrics</code>. Metrics for Jetty’s <code>Connector</code> instances are bound by using Micrometer’s <code>JettyConnectionMetrics</code> and, when <code>server.ssl.enabled</code> is set to <code>true</code>, Micrometer’s <code>JettySslHandshakeMetrics</code>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.timed-annotation">
7.3.22. @Timed Annotation Support</h4> <div class="paragraph"> <p>To use <code>@Timed</code> where it is not directly supported by Spring Boot, refer to the <a href="https://micrometer.io/docs/concepts#_the_timed_annotation">Micrometer documentation</a>.</p> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.supported.redis">
7.3.23. Redis Metrics</h4> <div class="paragraph"> <p>Auto-configuration registers a <code>MicrometerCommandLatencyRecorder</code> for the auto-configured <code>LettuceConnectionFactory</code>. For more detail, see the <a href="https://lettuce.io/core/6.2.6.RELEASE/reference/index.html#command.latency.metrics.micrometer">Micrometer Metrics section</a> of the Lettuce documentation.</p> </div> </div> </div> <div class="sect2"> <h3 id="actuator.metrics.registering-custom">
7.4. Registering Custom Metrics</h3> <div class="paragraph"> <p>To register custom metrics, inject <code>MeterRegistry</code> into your component:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.MeterRegistry;
import io.micrometer.core.instrument.Tags;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
public class MyBean {

    private final Dictionary dictionary;

    public MyBean(MeterRegistry registry) {
        this.dictionary = Dictionary.load();
        registry.gauge("dictionary.size", Tags.empty(), this.dictionary.getWords().size());
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.MeterRegistry
import io.micrometer.core.instrument.Tags
import org.springframework.stereotype.Component

</span><span class="fold-block">@Component
class MyBean(registry: MeterRegistry) {

    private val dictionary: Dictionary

    init {
        dictionary = Dictionary.load()
        registry.gauge("dictionary.size", Tags.empty(), dictionary.words.size)
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>If your metrics depend on other beans, we recommend that you use a <code>MeterBinder</code> to register them:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Gauge;
import io.micrometer.core.instrument.binder.MeterBinder;

import org.springframework.context.annotation.Bean;

</span><span class="fold-block">public class MyMeterBinderConfiguration {

    @Bean
    public MeterBinder queueSize(Queue queue) {
        return (registry) -&gt; Gauge.builder("queueSize", queue::size).register(registry);
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.Gauge
import io.micrometer.core.instrument.binder.MeterBinder
import org.springframework.context.annotation.Bean

</span><span class="fold-block">class MyMeterBinderConfiguration {

    @Bean
    fun queueSize(queue: Queue): MeterBinder {
        return MeterBinder { registry -&gt;
            Gauge.builder("queueSize", queue::size).register(registry)
        }
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>Using a <code>MeterBinder</code> ensures that the correct dependency relationships are set up and that the bean is available when the metric’s value is retrieved. A <code>MeterBinder</code> implementation can also be useful if you find that you repeatedly instrument a suite of metrics across components or applications.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> By default, metrics from all <code>MeterBinder</code> beans are automatically bound to the Spring-managed <code>MeterRegistry</code>. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.metrics.customizing">
7.5. Customizing Individual Metrics</h3> <div class="paragraph"> <p>If you need to apply customizations to specific <code>Meter</code> instances, you can use the <code>io.micrometer.core.instrument.config.MeterFilter</code> interface.</p> </div> <div class="paragraph"> <p>For example, if you want to rename the <code>mytag.region</code> tag to <code>mytag.area</code> for all meter IDs beginning with <code>com.example</code>, you can do the following:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.config.MeterFilter;

import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyMetricsFilterConfiguration {

    @Bean
    public MeterFilter renameRegionTagMeterFilter() {
        return MeterFilter.renameTag("com.example", "mytag.region", "mytag.area");
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import io.micrometer.core.instrument.config.MeterFilter
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyMetricsFilterConfiguration {

    @Bean
    fun renameRegionTagMeterFilter(): MeterFilter {
        return MeterFilter.renameTag("com.example", "mytag.region", "mytag.area")
    }

}
</span></code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> By default, all <code>MeterFilter</code> beans are automatically bound to the Spring-managed <code>MeterRegistry</code>. Make sure to register your metrics by using the Spring-managed <code>MeterRegistry</code> and not any of the static methods on <code>Metrics</code>. These use the global registry that is not Spring-managed. </td> </tr> </table> </div> <div class="sect3"> <h4 id="actuator.metrics.customizing.common-tags">
7.5.1. Common Tags</h4> <div class="paragraph"> <p>Common tags are generally used for dimensional drill-down on the operating environment, such as host, instance, region, stack, and others. Commons tags are applied to all meters and can be configured, as the following example shows:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.metrics.tags.region=us-east-1
management.metrics.tags.stack=prod</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  metrics:
    tags:
      region: "us-east-1"
      stack: "prod"</code></pre> </div> </div> <div class="paragraph"> <p>The preceding example adds <code>region</code> and <code>stack</code> tags to all meters with a value of <code>us-east-1</code> and <code>prod</code>, respectively.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> The order of common tags is important if you use Graphite. As the order of common tags cannot be guaranteed by using this approach, Graphite users are advised to define a custom <code>MeterFilter</code> instead. </td> </tr> </table> </div> </div> <div class="sect3"> <h4 id="actuator.metrics.customizing.per-meter-properties">
7.5.2. Per-meter Properties</h4> <div class="paragraph"> <p>In addition to <code>MeterFilter</code> beans, you can apply a limited set of customization on a per-meter basis using properties. Per-meter customizations are applied, using Spring Boot’s <code>PropertiesMeterFilter</code>, to any meter IDs that start with the given name. The following example filters out any meters that have an ID starting with <code>example.remote</code>.</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.metrics.enable.example.remote=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  metrics:
    enable:
      example:
        remote: false</code></pre> </div> </div> <div class="paragraph"> <p>The following properties allow per-meter customization:</p> </div> <table class="tableblock frame-all grid-all stretch"> <caption class="title">Table 1. Per-meter customizations</caption> <colgroup> <col style="width: 50%;"> <col style="width: 50%;"> </colgroup> <thead> <tr> <th class="tableblock halign-left valign-top">Property</th> <th class="tableblock halign-left valign-top">Description</th> </tr> </thead> <tbody> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.metrics.enable</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to accept meters with certain IDs. Meters that are not accepted are filtered from the <code>MeterRegistry</code>.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.metrics.distribution.percentiles-histogram</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Whether to publish a histogram suitable for computing aggregable (across dimension) percentile approximations.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.metrics.distribution.minimum-expected-value</code>, <code>management.metrics.distribution.maximum-expected-value</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Publish fewer histogram buckets by clamping the range of expected values.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.metrics.distribution.percentiles</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Publish percentile values computed in your application</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.metrics.distribution.expiry</code>, <code>management.metrics.distribution.buffer-length</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Give greater weight to recent samples by accumulating them in ring buffers which rotate after a configurable expiry, with a configurable buffer length.</p></td> </tr> <tr> <td class="tableblock halign-left valign-top"><p class="tableblock"><code>management.metrics.distribution.slo</code></p></td> <td class="tableblock halign-left valign-top"><p class="tableblock">Publish a cumulative histogram with buckets defined by your service-level objectives.</p></td> </tr> </tbody> </table> <div class="paragraph"> <p>For more details on the concepts behind <code>percentiles-histogram</code>, <code>percentiles</code>, and <code>slo</code>, see the <a href="https://micrometer.io/docs/concepts#_histograms_and_percentiles">“Histograms and percentiles” section</a> of the Micrometer documentation.</p> </div> </div> </div> <div class="sect2"> <h3 id="actuator.metrics.endpoint">
7.6. Metrics Endpoint</h3> <div class="paragraph"> <p>Spring Boot provides a <code>metrics</code> endpoint that you can use diagnostically to examine the metrics collected by an application. The endpoint is not available by default and must be exposed. See <a href="#actuator.endpoints.exposing">exposing endpoints</a> for more details.</p> </div> <div class="paragraph"> <p>Navigating to <code>/actuator/metrics</code> displays a list of available meter names. You can drill down to view information about a particular meter by providing its name as a selector — for example, <code>/actuator/metrics/jvm.memory.max</code>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> <div class="paragraph"> <p>The name you use here should match the name used in the code, not the name after it has been naming-convention normalized for a monitoring system to which it is shipped. In other words, if <code>jvm.memory.max</code> appears as <code>jvm_memory_max</code> in Prometheus because of its snake case naming convention, you should still use <code>jvm.memory.max</code> as the selector when inspecting the meter in the <code>metrics</code> endpoint.</p> </div> </td> </tr> </table> </div> <div class="paragraph"> <p>You can also add any number of <code>tag=KEY:VALUE</code> query parameters to the end of the URL to dimensionally drill down on a meter — for example, <code>/actuator/metrics/jvm.memory.max?tag=area:nonheap</code>.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> <div class="paragraph"> <p>The reported measurements are the <em>sum</em> of the statistics of all meters that match the meter name and any tags that have been applied. In the preceding example, the returned <code>Value</code> statistic is the sum of the maximum memory footprints of the “Code Cache”, “Compressed Class Space”, and “Metaspace” areas of the heap. If you wanted to see only the maximum size for the “Metaspace”, you could add an additional <code>tag=id:Metaspace</code> — that is, <code>/actuator/metrics/jvm.memory.max?tag=area:nonheap&amp;tag=id:Metaspace</code>.</p> </div> </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.metrics.micrometer-observation">
7.7. Integration with Micrometer Observation</h3> <div class="paragraph"> <p>A <code>DefaultMeterObservationHandler</code> is automatically registered on the <code>ObservationRegistry</code>, which creates metrics for every completed observation.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.micrometer-tracing">
8. Tracing</h2> <div class="sectionbody"> <div class="paragraph"> <p>Spring Boot Actuator provides dependency management and auto-configuration for <a href="https://micrometer.io/docs/tracing">Micrometer Tracing</a>, a facade for popular tracer libraries.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> To learn more about Micrometer Tracing capabilities, see its <a href="https://micrometer.io/docs/tracing">reference documentation</a>. </td> </tr> </table> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.tracers">
8.1. Supported Tracers</h3> <div class="paragraph"> <p>Spring Boot ships auto-configuration for the following tracers:</p> </div> <div class="ulist"> <ul> <li> <p><a href="https://opentelemetry.io/">OpenTelemetry</a> with <a href="https://zipkin.io/">Zipkin</a>, <a href="https://docs.wavefront.com/">Wavefront</a>, or <a href="https://opentelemetry.io/docs/reference/specification/protocol/">OTLP</a></p> </li> <li> <p><a href="https://github.com/openzipkin/brave">OpenZipkin Brave</a> with <a href="https://zipkin.io/">Zipkin</a> or <a href="https://docs.wavefront.com/">Wavefront</a></p> </li> </ul> </div> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.getting-started">
8.2. Getting Started</h3> <div class="paragraph"> <p>We need an example application that we can use to get started with tracing. For our purposes, the simple “Hello World!” web application that’s covered in the “<a href="getting-started.html#getting-started.first-application">getting-started.html</a>” section will suffice. We’re going to use the OpenTelemetry tracer with Zipkin as trace backend.</p> </div> <div class="paragraph"> <p>To recap, our main application code looks like this:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

</span><span class="fold-block">@RestController
@SpringBootApplication
public class MyApplication {

    private static final Log logger = LogFactory.getLog(MyApplication.class);

    @RequestMapping("/")
    String home() {
        logger.info("home() has been called");
        return "Hello World!";
    }

    public static void main(String[] args) {
        SpringApplication.run(MyApplication.class, args);
    }

}
</span></code></pre> </div> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> There’s an added logger statement in the <code>home()</code> method, which will be important later. </td> </tr> </table> </div> <div class="paragraph"> <p>Now we have to add the following dependencies:</p> </div> <div class="ulist"> <ul> <li> <p><code>org.springframework.boot:spring-boot-starter-actuator</code></p> </li> <li> <p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - bridges the Micrometer Observation API to OpenTelemetry.</p> </li> <li> <p><code>io.opentelemetry:opentelemetry-exporter-zipkin</code> - reports <a href="https://micrometer.io/docs/tracing#_glossary">traces</a> to Zipkin.</p> </li> </ul> </div> <div class="paragraph"> <p>Add the following application properties:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.tracing.sampling.probability=1.0</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  tracing:
    sampling:
      probability: 1.0</code></pre> </div> </div> <div class="paragraph"> <p>By default, Spring Boot samples only 10% of requests to prevent overwhelming the trace backend. This property switches it to 100% so that every request is sent to the trace backend.</p> </div> <div class="paragraph"> <p>To collect and visualize the traces, we need a running trace backend. We use Zipkin as our trace backend here. The <a href="https://zipkin.io/pages/quickstart">Zipkin Quickstart guide</a> provides instructions how to start Zipkin locally.</p> </div> <div class="paragraph"> <p>After Zipkin is running, you can start your application.</p> </div> <div class="paragraph"> <p>If you open a web browser to <code><a href="http://localhost:8080" class="bare">localhost:8080</a></code>, you should see the following output:</p> </div> <div class="listingblock"> <div class="content"> <pre data-language="">Hello World!</pre> </div> </div> <div class="paragraph"> <p>Behind the scenes, an observation has been created for the HTTP request, which in turn gets bridged to OpenTelemetry, which reports a new trace to Zipkin.</p> </div> <div class="paragraph"> <p>Now open the Zipkin UI at <code><a href="http://localhost:9411" class="bare">localhost:9411</a></code> and press the "Run Query" button to list all collected traces. You should see one trace. Press the "Show" button to see the details of that trace.</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> You can include the current trace and span id in the logs by setting the <code>logging.pattern.level</code> property to <code>%5p [${spring.application.name:},%X{traceId:-},%X{spanId:-}]</code> </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.propagating-traces">
8.3. Propagating Traces</h3> <div class="paragraph"> <p>To automatically propagate traces over the network, use the auto-configured <a href="io.html#io.rest-client.resttemplate"><code>RestTemplateBuilder</code></a> or <a href="io.html#io.rest-client.webclient"><code>WebClient.Builder</code></a> to construct the client.</p> </div> <div class="admonitionblock warning"> <table> <tr> <td class="icon">  </td> <td class="content"> If you create the <code>WebClient</code> or the <code>RestTemplate</code> without using the auto-configured builders, automatic trace propagation won’t work! </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.tracer-implementations">
8.4. Tracer Implementations</h3> <div class="paragraph"> <p>As Micrometer Tracer supports multiple tracer implementations, there are multiple dependency combinations possible with Spring Boot.</p> </div> <div class="paragraph"> <p>All tracer implementations need the <code>org.springframework.boot:spring-boot-starter-actuator</code> dependency.</p> </div> <div class="sect3"> <h4 id="actuator.micrometer-tracing.tracer-implementations.otel-zipkin">
8.4.1. OpenTelemetry With Zipkin</h4> <div class="paragraph"> <p>Tracing with OpenTelemetry and reporting to Zipkin requires the following dependencies:</p> </div> <div class="ulist"> <ul> <li> <p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - bridges the Micrometer Observation API to OpenTelemetry.</p> </li> <li> <p><code>io.opentelemetry:opentelemetry-exporter-zipkin</code> - reports traces to Zipkin.</p> </li> </ul> </div> <div class="paragraph"> <p>Use the <code>management.zipkin.tracing.*</code> configuration properties to configure reporting to Zipkin.</p> </div> </div> <div class="sect3"> <h4 id="actuator.micrometer-tracing.tracer-implementations.otel-wavefront">
8.4.2. OpenTelemetry With Wavefront</h4> <div class="paragraph"> <p>Tracing with OpenTelemetry and reporting to Wavefront requires the following dependencies:</p> </div> <div class="ulist"> <ul> <li> <p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - bridges the Micrometer Observation API to OpenTelemetry.</p> </li> <li> <p><code>io.micrometer:micrometer-tracing-reporter-wavefront</code> - reports traces to Wavefront.</p> </li> </ul> </div> <div class="paragraph"> <p>Use the <code>management.wavefront.*</code> configuration properties to configure reporting to Wavefront.</p> </div> </div> <div class="sect3"> <h4 id="actuator.micrometer-tracing.tracer-implementations.otel-otlp">
8.4.3. OpenTelemetry With OTLP</h4> <div class="paragraph"> <p>Tracing with OpenTelemetry and reporting using OTLP requires the following dependencies:</p> </div> <div class="ulist"> <ul> <li> <p><code>io.micrometer:micrometer-tracing-bridge-otel</code> - bridges the Micrometer Observation API to OpenTelemetry.</p> </li> <li> <p><code>io.opentelemetry:opentelemetry-exporter-otlp</code> - reports traces to a collector that can accept OTLP.</p> </li> </ul> </div> <div class="paragraph"> <p>Use the <code>management.otlp.tracing.*</code> configuration properties to configure reporting using OTLP.</p> </div> </div> <div class="sect3"> <h4 id="actuator.micrometer-tracing.tracer-implementations.brave-zipkin">
8.4.4. OpenZipkin Brave With Zipkin</h4> <div class="paragraph"> <p>Tracing with OpenZipkin Brave and reporting to Zipkin requires the following dependencies:</p> </div> <div class="ulist"> <ul> <li> <p><code>io.micrometer:micrometer-tracing-bridge-brave</code> - bridges the Micrometer Observation API to Brave.</p> </li> <li> <p><code>io.zipkin.reporter2:zipkin-reporter-brave</code> - reports traces to Zipkin.</p> </li> </ul> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> If your project doesn’t use Spring MVC or Spring WebFlux, the <code>io.zipkin.reporter2:zipkin-sender-urlconnection</code> dependency is needed, too. </td> </tr> </table> </div> <div class="paragraph"> <p>Use the <code>management.zipkin.tracing.*</code> configuration properties to configure reporting to Zipkin.</p> </div> </div> <div class="sect3"> <h4 id="actuator.micrometer-tracing.tracer-implementations.brave-wavefront">
8.4.5. OpenZipkin Brave With Wavefront</h4> <div class="paragraph"> <p>Tracing with OpenZipkin Brave and reporting to Wavefront requires the following dependencies:</p> </div> <div class="ulist"> <ul> <li> <p><code>io.micrometer:micrometer-tracing-bridge-brave</code> - bridges the Micrometer Observation API to Brave.</p> </li> <li> <p><code>io.micrometer:micrometer-tracing-reporter-wavefront</code> - reports traces to Wavefront.</p> </li> </ul> </div> <div class="paragraph"> <p>Use the <code>management.wavefront.*</code> configuration properties to configure reporting to Wavefront.</p> </div> </div> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.micrometer-observation">
8.5. Integration with Micrometer Observation</h3> <div class="paragraph"> <p>A <code>TracingAwareMeterObservationHandler</code> is automatically registered on the <code>ObservationRegistry</code>, which creates spans for every completed observation.</p> </div> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.creating-spans">
8.6. Creating Custom Spans</h3> <div class="paragraph"> <p>You can create your own spans by starting an observation. For this, inject <code>ObservationRegistry</code> into your component:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.observation.Observation;
import io.micrometer.observation.ObservationRegistry;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
class CustomObservation {

    private final ObservationRegistry observationRegistry;

    CustomObservation(ObservationRegistry observationRegistry) {
        this.observationRegistry = observationRegistry;
    }

    void someOperation() {
        Observation observation = Observation.createNotStarted("some-operation", this.observationRegistry);
        observation.lowCardinalityKeyValue("some-tag", "some-value");
        observation.observe(() -&gt; {
            // Business logic ...
        });
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>This will create an observation named "some-operation" with the tag "some-tag=some-value".</p> </div> <div class="admonitionblock tip"> <table> <tr> <td class="icon">  </td> <td class="content"> If you want to create a span without creating a metric, you need to use the <a href="https://micrometer.io/docs/tracing#_using_micrometer_tracing_directly">lower-level <code>Tracer</code> API</a> from Micrometer. </td> </tr> </table> </div> </div> <div class="sect2"> <h3 id="actuator.micrometer-tracing.baggage">
8.7. Baggage</h3> <div class="paragraph"> <p>You can create baggage with the <code>Tracer</code> API:</p> </div> <div class="listingblock"> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import io.micrometer.tracing.BaggageInScope;
import io.micrometer.tracing.Tracer;

import org.springframework.stereotype.Component;

</span><span class="fold-block">@Component
class CreatingBaggage {

    private final Tracer tracer;

    CreatingBaggage(Tracer tracer) {
        this.tracer = tracer;
    }

    void doSomething() {
        try (BaggageInScope scope = this.tracer.createBaggageInScope("baggage1", "value1")) {
            // Business logic
        }
    }

}
</span></code></pre> </div> </div> <div class="paragraph"> <p>This example creates baggage named <code>baggage1</code> with the value <code>value1</code>. The baggage is automatically propagated over the network if you’re using W3C propagation. If you’re using B3 propagation, baggage is not automatically propagated. To manually propagate baggage over the network, use the <code>management.tracing.baggage.remote-fields</code> configuration property (this works for W3C, too). For the example above, setting this property to <code>baggage1</code> results in an HTTP header <code>baggage1: value1</code>.</p> </div> <div class="paragraph"> <p>If you want to propagate the baggage to the MDC, use the <code>management.tracing.baggage.correlation.fields</code> configuration property. For the example above, setting this property to <code>baggage1</code> results in an MDC entry named <code>baggage1</code>.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.auditing">
9. Auditing</h2> <div class="sectionbody"> <div class="paragraph"> <p>Once Spring Security is in play, Spring Boot Actuator has a flexible audit framework that publishes events (by default, “authentication success”, “failure” and “access denied” exceptions). This feature can be very useful for reporting and for implementing a lock-out policy based on authentication failures.</p> </div> <div class="paragraph"> <p>You can enable auditing by providing a bean of type <code>AuditEventRepository</code> in your application’s configuration. For convenience, Spring Boot offers an <code>InMemoryAuditEventRepository</code>. <code>InMemoryAuditEventRepository</code> has limited capabilities, and we recommend using it only for development environments. For production environments, consider creating your own alternative <code>AuditEventRepository</code> implementation.</p> </div> <div class="sect2"> <h3 id="actuator.auditing.custom">
9.1. Custom Auditing</h3> <div class="paragraph"> <p>To customize published security events, you can provide your own implementations of <code>AbstractAuthenticationAuditListener</code> and <code>AbstractAuthorizationAuditListener</code>.</p> </div> <div class="paragraph"> <p>You can also use the audit services for your own business events. To do so, either inject the <code>AuditEventRepository</code> bean into your own components and use that directly or publish an <code>AuditApplicationEvent</code> with the Spring <code>ApplicationEventPublisher</code> (by implementing <code>ApplicationEventPublisherAware</code>).</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.http-exchanges">
10. Recording HTTP Exchanges</h2> <div class="sectionbody"> <div class="paragraph"> <p>You can enable recording of HTTP exchanges by providing a bean of type <code>HttpExchangeRepository</code> in your application’s configuration. For convenience, Spring Boot offers <code>InMemoryHttpExchangeRepository</code>, which, by default, stores the last 100 request-response exchanges. <code>InMemoryHttpExchangeRepository</code> is limited compared to tracing solutions, and we recommend using it only for development environments. For production environments, we recommend using a production-ready tracing or observability solution, such as Zipkin or OpenTelemetry. Alternatively, you can create your own <code>HttpExchangeRepository</code>.</p> </div> <div class="paragraph"> <p>You can use the <code>httpexchanges</code> endpoint to obtain information about the request-response exchanges that are stored in the <code>HttpExchangeRepository</code>.</p> </div> <div class="sect2"> <h3 id="actuator.http-exchanges.custom">
10.1. Custom HTTP Exchange Recording</h3> <div class="paragraph"> <p>To customize the items that are included in each recorded exchange, use the <code>management.httpexchanges.recording.include</code> configuration property.</p> </div> <div class="paragraph"> <p>To disable recoding entirely, set <code>management.httpexchanges.recording.enabled</code> to <code>false</code>.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.process-monitoring">
11. Process Monitoring</h2> <div class="sectionbody"> <div class="paragraph"> <p>In the <code>spring-boot</code> module, you can find two classes to create files that are often useful for process monitoring:</p> </div> <div class="ulist"> <ul> <li> <p><code>ApplicationPidFileWriter</code> creates a file that contains the application PID (by default, in the application directory with a file name of <code>application.pid</code>).</p> </li> <li> <p><code>WebServerPortFileWriter</code> creates a file (or files) that contain the ports of the running web server (by default, in the application directory with a file name of <code>application.port</code>).</p> </li> </ul> </div> <div class="paragraph"> <p>By default, these writers are not activated, but you can enable them:</p> </div> <div class="ulist"> <ul> <li> <p><a href="#actuator.process-monitoring.configuration">By Extending Configuration</a></p> </li> <li> <p><a href="#actuator.process-monitoring.programmatically">Programmatically Enabling Process Monitoring</a></p> </li> </ul> </div> <div class="sect2"> <h3 id="actuator.process-monitoring.configuration">
11.1. Extending Configuration</h3> <div class="paragraph"> <p>In the <code>META-INF/spring.factories</code> file, you can activate the listener (or listeners) that writes a PID file:</p> </div> <div class="listingblock"> <div class="content"> <pre data-language="">org.springframework.context.ApplicationListener=\
org.springframework.boot.context.ApplicationPidFileWriter,\
org.springframework.boot.web.context.WebServerPortFileWriter</pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.process-monitoring.programmatically">
11.2. Programmatically Enabling Process Monitoring</h3> <div class="paragraph"> <p>You can also activate a listener by invoking the <code>SpringApplication.addListeners(…​)</code> method and passing the appropriate <code>Writer</code> object. This method also lets you customize the file name and path in the <code>Writer</code> constructor.</p> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.cloud-foundry">
12. Cloud Foundry Support</h2> <div class="sectionbody"> <div class="paragraph"> <p>Spring Boot’s actuator module includes additional support that is activated when you deploy to a compatible Cloud Foundry instance. The <code>/cloudfoundryapplication</code> path provides an alternative secured route to all <code>@Endpoint</code> beans.</p> </div> <div class="paragraph"> <p>The extended support lets Cloud Foundry management UIs (such as the web application that you can use to view deployed applications) be augmented with Spring Boot actuator information. For example, an application status page can include full health information instead of the typical “running” or “stopped” status.</p> </div> <div class="admonitionblock note"> <table> <tr> <td class="icon">  </td> <td class="content"> The <code>/cloudfoundryapplication</code> path is not directly accessible to regular users. To use the endpoint, you must pass a valid UAA token with the request. </td> </tr> </table> </div> <div class="sect2"> <h3 id="actuator.cloud-foundry.disable">
12.1. Disabling Extended Cloud Foundry Actuator Support</h3> <div class="paragraph"> <p>If you want to fully disable the <code>/cloudfoundryapplication</code> endpoints, you can add the following setting to your <code>application.properties</code> file:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.cloudfoundry.enabled=false</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  cloudfoundry:
    enabled: false</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.cloud-foundry.ssl">
12.2. Cloud Foundry Self-signed Certificates</h3> <div class="paragraph"> <p>By default, the security verification for <code>/cloudfoundryapplication</code> endpoints makes SSL calls to various Cloud Foundry services. If your Cloud Foundry UAA or Cloud Controller services use self-signed certificates, you need to set the following property:</p> </div> <div class="listingblock primary"> <div class="title">Properties</div> <div class="content"> <pre class="highlight" data-language="properties"><code class="language-properties" data-lang="properties">management.cloudfoundry.skip-ssl-validation=true</code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Yaml</div> <div class="content"> <pre class="highlight" data-language="yaml"><code class="language-yaml" data-lang="yaml">management:
  cloudfoundry:
    skip-ssl-validation: true</code></pre> </div> </div> </div> <div class="sect2"> <h3 id="actuator.cloud-foundry.custom-context-path">
12.3. Custom Context Path</h3> <div class="paragraph"> <p>If the server’s context-path has been configured to anything other than <code>/</code>, the Cloud Foundry endpoints are not available at the root of the application. For example, if <code>server.servlet.context-path=/app</code>, Cloud Foundry endpoints are available at <code>/app/cloudfoundryapplication/*</code>.</p> </div> <div class="paragraph"> <p>If you expect the Cloud Foundry endpoints to always be available at <code>/cloudfoundryapplication/*</code>, regardless of the server’s context-path, you need to explicitly configure that in your application. The configuration differs, depending on the web server in use. For Tomcat, you can add the following configuration:</p> </div> <div class="listingblock primary"> <div class="title">Java</div> <div class="content"> <pre class="highlight" data-language="java"><code class="language-java" data-lang="java"><span class="fold-block hide-when-folded">import java.io.IOException;
import java.util.Collections;

import jakarta.servlet.GenericServlet;
import jakarta.servlet.Servlet;
import jakarta.servlet.ServletContainerInitializer;
import jakarta.servlet.ServletContext;
import jakarta.servlet.ServletException;
import jakarta.servlet.ServletRequest;
import jakarta.servlet.ServletResponse;
import org.apache.catalina.Host;
import org.apache.catalina.core.StandardContext;
import org.apache.catalina.startup.Tomcat;

import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory;
import org.springframework.boot.web.servlet.ServletContextInitializer;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
public class MyCloudFoundryConfiguration {

    @Bean
    public TomcatServletWebServerFactory servletWebServerFactory() {
        return new TomcatServletWebServerFactory() {

            @Override
            protected void prepareContext(Host host, ServletContextInitializer[] initializers) {
                super.prepareContext(host, initializers);
                StandardContext child = new StandardContext();
                child.addLifecycleListener(new Tomcat.FixContextListener());
                child.setPath("/cloudfoundryapplication");
                ServletContainerInitializer initializer = getServletContextInitializer(getContextPath());
                child.addServletContainerInitializer(initializer, Collections.emptySet());
                child.setCrossContext(true);
                host.addChild(child);
            }

        };
    }

    private ServletContainerInitializer getServletContextInitializer(String contextPath) {
        return (classes, context) -&gt; {
            Servlet servlet = new GenericServlet() {

                @Override
                public void service(ServletRequest req, ServletResponse res) throws ServletException, IOException {
                    ServletContext context = req.getServletContext().getContext(contextPath);
                    context.getRequestDispatcher("/cloudfoundryapplication").forward(req, res);
                }

            };
            context.addServlet("cloudfoundry", servlet).addMapping("/*");
        };
    }

}
</span></code></pre> </div> </div> <div class="listingblock secondary"> <div class="title">Kotlin</div> <div class="content"> <pre class="highlight" data-language="kotlin"><code class="language-kotlin" data-lang="kotlin"><span class="fold-block hide-when-folded">import jakarta.servlet.GenericServlet
import jakarta.servlet.Servlet
import jakarta.servlet.ServletContainerInitializer
import jakarta.servlet.ServletContext
import jakarta.servlet.ServletException
import jakarta.servlet.ServletRequest
import jakarta.servlet.ServletResponse
import org.apache.catalina.Host
import org.apache.catalina.core.StandardContext
import org.apache.catalina.startup.Tomcat.FixContextListener
import org.springframework.boot.web.embedded.tomcat.TomcatServletWebServerFactory
import org.springframework.boot.web.servlet.ServletContextInitializer
import org.springframework.context.annotation.Bean
import org.springframework.context.annotation.Configuration
import java.io.IOException
import java.util.Collections.emptySet

</span><span class="fold-block">@Configuration(proxyBeanMethods = false)
class MyCloudFoundryConfiguration {

    @Bean
    fun servletWebServerFactory(): TomcatServletWebServerFactory {
        return object : TomcatServletWebServerFactory() {

            override fun prepareContext(host: Host, initializers: Array&lt;ServletContextInitializer&gt;) {
                super.prepareContext(host, initializers)
                val child = StandardContext()
                child.addLifecycleListener(FixContextListener())
                child.path = "/cloudfoundryapplication"
                val initializer = getServletContextInitializer(contextPath)
                child.addServletContainerInitializer(initializer, emptySet())
                child.crossContext = true
                host.addChild(child)
            }

        }
    }

    private fun getServletContextInitializer(contextPath: String): ServletContainerInitializer {
        return ServletContainerInitializer { classes: Set&lt;Class&lt;*&gt;?&gt;?, context: ServletContext -&gt;
            val servlet: Servlet = object : GenericServlet() {

                @Throws(ServletException::class, IOException::class)
                override fun service(req: ServletRequest, res: ServletResponse) {
                    val servletContext = req.servletContext.getContext(contextPath)
                    servletContext.getRequestDispatcher("/cloudfoundryapplication").forward(req, res)
                }

            }
            context.addServlet("cloudfoundry", servlet).addMapping("/*")
        }
    }
}
</span></code></pre> </div> </div> </div> </div> </div> <div class="sect1"> <h2 id="actuator.whats-next">
13. What to Read Next</h2> <div class="sectionbody"> <div class="paragraph"> <p>You might want to read about graphing tools such as <a href="https://graphiteapp.org">Graphite</a>.</p> </div> <div class="paragraph"> <p>Otherwise, you can continue on to read about <a href="deployment.html#deployment">“deployment options”</a> or jump ahead for some in-depth information about Spring Boot’s <a href="build-tool-plugins.html#build-tool-plugins">build tool plugins</a>.</p> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    Copyright &copy; 2012-2023 VMware, Inc.<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://docs.spring.io/spring-boot/docs/3.1.3/reference/html/actuator.html" class="_attribution-link">https://docs.spring.io/spring-boot/docs/3.1.3/reference/html/actuator.html</a>
  </p>
</div>
