<h1 id="debugging-your-application">Debugging Your Application</h1>  <ul class="simple"> <li>
<a class="reference internal" href="#replace-var-dump" id="id1">Replace var_dump</a><ul> <li><a class="reference internal" href="#enabling-kint" id="id2">Enabling Kint</a></li> <li><a class="reference internal" href="#using-kint" id="id3">Using Kint</a></li> </ul> </li> <li>
<a class="reference internal" href="#the-debug-toolbar" id="id4">The Debug Toolbar</a><ul> <li><a class="reference internal" href="#enabling-the-toolbar" id="id5">Enabling the Toolbar</a></li> <li><a class="reference internal" href="#setting-benchmark-points" id="id6">Setting Benchmark Points</a></li> <li><a class="reference internal" href="#creating-custom-collectors" id="id7">Creating Custom Collectors</a></li> </ul> </li> </ul>   <h2 id="replace-var-dump">Replace var_dump</h2> <p>While using XDebug and a good IDE can be indispensable to debug your application, sometimes a quick <code>var_dump()</code> is all you need. CodeIgniter makes that even better by bundling in the excellent <a class="reference external" href="https://kint-php.github.io/kint/">Kint</a> debugging tool for PHP. This goes way beyond your usual tool, providing many alternate pieces of data, like formatting timestamps into recognizable dates, showing you hexcodes as colors, display array data like a table for easy reading, and much, much more.</p>  <h3 id="enabling-kint">Enabling Kint</h3> <p>By default, Kint is enabled in <strong>development</strong> and <strong>testing</strong> <a class="reference internal" href="../general/environments.html"><span class="doc">environments</span></a> only. This can be altered by modifying the <code>$useKint</code> value in the environment configuration section of the main <strong>index.php</strong> file:</p> <pre data-language="php">$useKint = true;
</pre>   <h3 id="using-kint">Using Kint</h3> <p><strong>d()</strong></p> <p>The <code>d()</code> method dumps all of the data it knows about the contents passed as the only parameter to the screen, and allows the script to continue executing:</p> <pre data-language="php">d($_SERVER);
</pre> <p><strong>dd()</strong></p> <p>This method is identical to <code>d()</code>, except that it also <code>dies()</code> and no further code is executed this request.</p> <p><strong>trace()</strong></p> <p>This provides a backtrace to the current execution point, with Kint’s own unique spin:</p> <pre data-language="php">trace();
</pre> <p>For more information, see <a class="reference external" href="https://kint-php.github.io/kint//">Kint’s page</a>.</p>    <h2 id="the-debug-toolbar">The Debug Toolbar</h2> <p>The Debug Toolbar provides at-a-glance information about the current page request, including benchmark results, queries you have run, request and response data, and more. This can all prove very useful during development to help you debug and optimize.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The Debug Toolbar is still under construction with several planned features not yet implemented.</p> </div>  <h3 id="enabling-the-toolbar">Enabling the Toolbar</h3> <p>The toolbar is enabled by default in any <a class="reference internal" href="../general/environments.html"><span class="doc">environment</span></a> <em>except</em> <strong>production</strong>. It will be shown whenever the constant CI_DEBUG is defined and its value is truthy. This is defined in the boot files (e.g. <strong>app/Config/Boot/development.php</strong>) and can be modified there to determine what environment to show.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">The Debug Toolbar is not displayed when your <code>baseURL</code> setting (in <strong>app/Config/App.php</strong> or <code>app.baseURL</code> in <strong>.env</strong>) does not match your actual URL.</p> </div> <p>The toolbar itself is displayed as an <a class="reference internal" href="../incoming/filters.html"><span class="doc">After Filter</span></a>. You can stop it from ever running by removing it from the <code>$globals</code> property of <strong>app/Config/Filters.php</strong>.</p>  <h4 id="choosing-what-to-show">Choosing What to Show</h4> <p>CodeIgniter ships with several Collectors that, as the name implies, collect data to display on the toolbar. You can easily make your own to customize the toolbar. To determine which collectors are shown, again head over to the <strong>app/Config/Toolbar.php</strong> configuration file:</p> <pre data-language="php">public $collectors = [
    \CodeIgniter\Debug\Toolbar\Collectors\Timers::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Database::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Logs::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Views::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Cache::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Files::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Routes::class,
    \CodeIgniter\Debug\Toolbar\Collectors\Events::class,
];
</pre> <p>Comment out any collectors that you do not want to show. Add custom Collectors here by providing the fully-qualified class name. The exact collectors that appear here will affect which tabs are shown, as well as what information is shown on the Timeline.</p> <div class="admonition note"> <p class="first admonition-title">Note</p> <p class="last">Some tabs, like Database and Logs, will only display when they have content to show. Otherwise, they are removed to help out on smaller displays.</p> </div> <p>The Collectors that ship with CodeIgniter are:</p> <ul class="simple"> <li>
<strong>Timers</strong> collects all of the benchmark data, both by the system and by your application.</li> <li>
<strong>Database</strong> Displays a list of queries that all database connections have performed, and their execution time.</li> <li>
<strong>Logs</strong> Any information that was logged will be displayed here. In long-running systems, or systems with many items being logged, this can cause memory issues and should be disabled.</li> <li>
<strong>Views</strong> Displays render time for views on the timeline, and shows any data passed to the views on a separate tab.</li> <li>
<strong>Cache</strong> Will display information about cache hits and misses, and execution times.</li> <li>
<strong>Files</strong> displays a list of all files that have been loaded during this request.</li> <li>
<strong>Routes</strong> displays information about the current route and all routes defined in the system.</li> <li>
<strong>Events</strong> displays a list of all events that have been loaded during this request.</li> </ul>    <h3 id="setting-benchmark-points">Setting Benchmark Points</h3> <p>In order for the Profiler to compile and display your benchmark data you must name your mark points using specific syntax.</p> <p>Please read the information on setting Benchmark points in the <a class="reference internal" href="benchmark.html"><span class="doc">Benchmark Library</span></a> page.</p>   <h3 id="creating-custom-collectors">Creating Custom Collectors</h3> <p>Creating custom collectors is a straightforward task. You create a new class, fully-namespaced so that the autoloader can locate it, that extends <code>CodeIgniter\Debug\Toolbar\Collectors\BaseCollector</code>. This provides a number of methods that you can override, and has four required class properties that you must correctly set depending on how you want the Collector to work</p> <pre data-language="php">&lt;?php

namespace MyNamespace;

use CodeIgniter\Debug\Toolbar\Collectors\BaseCollector;

class MyCollector extends BaseCollector
{
    protected $hasTimeline = false;

    protected $hasTabContent = false;

    protected $hasVarData = false;

    protected $title = '';
}
</pre> <p><strong>$hasTimeline</strong> should be set to <code>true</code> for any Collector that wants to display information in the toolbar’s timeline. If this is true, you will need to implement the <code>formatTimelineData()</code> method to format and return the data for display.</p> <p><strong>$hasTabContent</strong> should be <code>true</code> if the Collector wants to display its own tab with custom content. If this is true, you will need to provide a <code>$title</code>, implement the <code>display()</code> method to render out tab’s contents, and might need to implement the <code>getTitleDetails()</code> method if you want to display additional information just to the right of the tab content’s title.</p> <p><strong>$hasVarData</strong> should be <code>true</code> if this Collector wants to add additional data to the <code>Vars</code> tab. If this is true, you will need to implement the <code>getVarData()</code> method.</p> <p><strong>$title</strong> is displayed on open tabs.</p>  <h4 id="displaying-a-toolbar-tab">Displaying a Toolbar Tab</h4> <p>To display a toolbar tab you must:</p> <ol class="arabic simple"> <li>Fill in <code>$title</code> with the text displayed as both the toolbar title and the tab header.</li> <li>Set <code>$hasTabContent</code> to <code>true</code>.</li> <li>Implement the <code>display()</code> method.</li> <li>Optionally, implement the <code>getTitleDetails()</code> method.</li> </ol> <p>The <code>display()</code> creates the HTML that is displayed within the tab itself. It does not need to worry about the title of the tab, as that is automatically handled by the toolbar. It should return a string of HTML.</p> <p>The <code>getTitleDetails()</code> method should return a string that is displayed just to the right of the tab’s title. it can be used to provide additional overview information. For example, the Database tab displays the total number of queries across all connections, while the Files tab displays the total number of files.</p>   <h4 id="providing-timeline-data">Providing Timeline Data</h4> <p>To provide information to be displayed in the Timeline you must:</p> <ol class="arabic simple"> <li>Set <code>$hasTimeline</code> to <code>true</code>.</li> <li>Implement the <code>formatTimelineData()</code> method.</li> </ol> <p>The <code>formatTimelineData()</code> method must return an array of arrays formatted in a way that the timeline can use it to sort it correctly and display the correct information. The inner arrays must include the following information:</p> <pre data-language="php">$data[] = [
    'name'      =&gt; '',     // Name displayed on the left of the timeline
    'component' =&gt; '',     // Name of the Component listed in the middle of timeline
    'start'     =&gt; 0.00,   // start time, like microtime(true)
    'duration'  =&gt; 0.00,   // duration, like mircrotime(true) - microtime(true)
];
</pre>   <h4 id="providing-vars">Providing Vars</h4> <p>To add data to the Vars tab you must:</p> <ol class="arabic simple"> <li>Set <code>$hasVarData</code> to <code>true</code>
</li> <li>Implement <code>getVarData()</code> method.</li> </ol> <p>The <code>getVarData()</code> method should return an array containing arrays of key/value pairs to display. The name of the outer array’s key is the name of the section on the Vars tab:</p> <pre data-language="php">$data = [
    'section 1' =&gt; [
        'foo' =&gt; 'bar',
        'bar' =&gt; 'baz',
    ],
    'section 2' =&gt; [
        'foo' =&gt; 'bar',
        'bar' =&gt; 'baz',
    ],
 ];
</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2014&ndash;2020 British Columbia Institute of Technology<br>Licensed under the MIT License.<br>
    <a href="https://codeigniter.com/user_guide/testing/debugging.html" class="_attribution-link">https://codeigniter.com/user_guide/testing/debugging.html</a>
  </p>
</div>
