<h1>3. Troubleshooting</h1>  <p>While we do our best to make Plug’n’Play a delightful experience, sometimes things might go wrong. The following page describes some common scenario one should be aware of, and provides some guidance to fix them.</p> <h6 id="name-is-trying-to-require-name-without-it-being-listed-in-its-dependencies-">
<code>&lt;name&gt; is trying to require &lt;name&gt; without it being listed in its dependencies</code> </h6> <p>This error simply means that the specified package is requiring something without explicitly declaring it in its dependencies. Since this behavior is unsafe and relies on the hoisting being done a certain way, Plug’n’Play doesn’t allow it.</p> <p>That being said, it might happen that the use is pseudo-legitimate. For example, Jest does something similar to <code>require(`jest-environment-${config.environment}`)</code> - in this circumstances the intent is obviously to use the package as provided by the package setting up the package configuration. Still, this is an unsafe behavior that must be fixed in one of three ways:</p> <ul> <li> <p>Either the code has to be modified so that the user becomes responsible for calling <code>require.resolve(`jest-environment-jsdom`)</code> (and then Jest can simply do <code>require(config.environment)</code>)</p> </li> <li> <p>Or the code has to be modified in order to use the <code>paths</code> option from <code>require.resolve</code>: <code>require(require.resolve(`jest-environment-${config.environment}`, {paths:[config.projectPath]}))</code> (note that this is the recommended option, being unintrusive for users and a good idea in general)</p> </li> <li> <p>Or, finally, the <code>jest-environment-jsdom</code> package can be specified as dependency of the top-level package - usually your own. In those circumstances, Yarn will allow Jest to access it even if it isn’t declared in its dependencies (we do this because this is the only case where this is safe: it isn’t possible for the top-level dependencies to be ambiguous).</p> </li> </ul> <p>The third option is typically meant as a way to unblock yourself, but please report it on the repository of the affected package and link them to this documentation (feel free to ping <a href="https://github.com/arcanis">@arcanis</a> as well so that we can track those problems).</p> <h6 id="couldnt-find-a-suitable-node-resolution-for-unqualified-path-path-">
<code>Couldn't find a suitable Node resolution for unqualified path &lt;path&gt;</code> </h6> <p>This error message means that Plug’n’Play was able to locate the <em>package</em> part of the require (so for example it understood that <code>foo</code> should be resolved into <code>/usr/cache/yarn/foo-1.0.0</code>), but couldn’t resolve the <em>file</em> part of the resolution (to use the same example, it couldn’t find an <code>index.js</code> file in <code>/usr/cache/yarn/foo-1.0.0/</code>). This problem typically isn’t caused by Plug’n’Play itself, but rather by your application requiring something that doesn’t exist (under non-PnP mode you’d likely have a generic “Cannot find module” error).</p> <h6 id="cannot-find-module-require-path-">
<code>Cannot find module &lt;require-path&gt;</code> </h6> <p><em>This error message is not generated by Plug’n’Play.</em> Ever. If you get it, it very likely means that your application is not running with the PnP resolver, meaning that your require calls won’t be able to load files from your dependencies (since the <code>node_modules</code> needed for the regular Node resolution won’t have been generated). Make sure to either run your code using <code>NODE_OPTIONS="--require /path/to/.pnp.js"</code> or to call it using <code>yarn node</code> which does the right thing transparently (whether you’re using PnP or not).</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2016&ndash;present Yarn Contributors<br>Licensed under the BSD License.<br>
    <a href="https://classic.yarnpkg.com/en/docs/pnp/troubleshooting" class="_attribution-link">https://classic.yarnpkg.com/en/docs/pnp/troubleshooting</a>
  </p>
</div>
