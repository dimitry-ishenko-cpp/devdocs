<h1 title="Class RecordingStream" class="title">Class RecordingStream</h1> <div class="inheritance" title="Inheritance Tree">
<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">java.lang.Object</a> <div class="inheritance">jdk.jfr.consumer.RecordingStream</div> </div> <section class="class-description" id="class-description"> <dl class="notes"> <dt>All Implemented Interfaces:</dt> <dd>
<code><a href="../../../../java.base/java/lang/autocloseable.html" title="interface in java.lang">AutoCloseable</a></code>, <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> </dl>  <pre class="lang-java" data-language="java">public final class RecordingStream extends Object implements AutoCloseable, EventStream</pre> <div class="block">A recording stream produces events from the current JVM (Java Virtual Machine). <p> The following example shows how to record events using the default configuration and print the Garbage Collection, CPU Load and JVM Information event to standard out. </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code class="language-java">Configuration c = Configuration.getConfiguration("default");
try (var rs = new RecordingStream(c)) {
    rs.onEvent("jdk.GarbageCollection", System.out::println);
    rs.onEvent("jdk.CPULoad", System.out::println);
    rs.onEvent("jdk.JVMInformation", System.out::println);
    rs.start();
}
</code></pre> </div> </div> <dl class="notes"> <dt>Since:</dt> <dd>14</dd> </dl> </section> <section class="summary"> <section class="constructor-summary" id="constructor-summary"> <h2>Constructor Summary</h2>  <table class="summary-table two-column-summary">       <tr>
<th>Constructor</th>
<th>Description</th>
</tr>
<tr>
<td><code><a href="#%3Cinit%3E()" class="member-name-link">RecordingStream</a>()</code></td>
<td> <div class="block">Creates an event stream for the current JVM (Java Virtual Machine).</div> </td>
</tr>
<tr>
<td><code><a href="#%3Cinit%3E(jdk.jfr.Configuration)" class="member-name-link">RecordingStream</a><wbr>(<a href="../configuration.html" title="class in jdk.jfr">Configuration</a> configuration)</wbr></code></td>
<td> <div class="block">Creates a recording stream using settings from a configuration.</div> </td>
</tr>
</table> </section><section class="method-summary" id="method-summary"> <h2>Method Summary</h2> <div id="method-summary-table">  <div id="method-summary-table.tabpanel" role="tabpanel"> <table class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">                                                                            <tr>
<th>Modifier and Type</th>
<th>Method</th>
<th>Description</th>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#awaitTermination()" class="member-name-link">awaitTermination</a>()</code></td>
<td> <div class="block">Blocks until all actions are completed, or the stream is closed, or the current thread is interrupted, whichever happens first.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#awaitTermination(java.time.Duration)" class="member-name-link">awaitTermination</a><wbr>(<a href="../../../../java.base/java/time/duration.html" title="class in java.time">Duration</a> timeout)</wbr></code></td>
<td> <div class="block">Blocks until all actions are completed, or the stream is closed, or the timeout occurs, or the current thread is interrupted, whichever happens first.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#close()" class="member-name-link">close</a>()</code></td>
<td> <div class="block">Closes this resource, relinquishing any underlying resources.</div> </td>
</tr>
<tr>
<td><code><a href="../eventsettings.html" title="class in jdk.jfr">EventSettings</a></code></td>
<td><code><a href="#disable(java.lang.Class)" class="member-name-link">disable</a><wbr>(<a href="../../../../java.base/java/lang/class.html" title="class in java.lang">Class</a>&lt;? extends <a href="../event.html" title="class in jdk.jfr">Event</a>&gt; eventClass)</wbr></code></td>
<td> <div class="block">Disables event.</div> </td>
</tr>
<tr>
<td><code><a href="../eventsettings.html" title="class in jdk.jfr">EventSettings</a></code></td>
<td><code><a href="#disable(java.lang.String)" class="member-name-link">disable</a><wbr>(<a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a> name)</wbr></code></td>
<td> <div class="block">Disables event with the specified name.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#dump(java.nio.file.Path)" class="member-name-link">dump</a><wbr>(<a href="../../../../java.base/java/nio/file/path.html" title="interface in java.nio.file">Path</a> destination)</wbr></code></td>
<td> <div class="block">Writes recording data to a file.</div> </td>
</tr>
<tr>
<td><code><a href="../eventsettings.html" title="class in jdk.jfr">EventSettings</a></code></td>
<td><code><a href="#enable(java.lang.Class)" class="member-name-link">enable</a><wbr>(<a href="../../../../java.base/java/lang/class.html" title="class in java.lang">Class</a>&lt;? extends <a href="../event.html" title="class in jdk.jfr">Event</a>&gt; eventClass)</wbr></code></td>
<td> <div class="block">Enables event.</div> </td>
</tr>
<tr>
<td><code><a href="../eventsettings.html" title="class in jdk.jfr">EventSettings</a></code></td>
<td><code><a href="#enable(java.lang.String)" class="member-name-link">enable</a><wbr>(<a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a> name)</wbr></code></td>
<td> <div class="block">Enables the event with the specified name.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#onClose(java.lang.Runnable)" class="member-name-link">onClose</a><wbr>(<a href="../../../../java.base/java/lang/runnable.html" title="interface in java.lang">Runnable</a> action)</wbr></code></td>
<td> <div class="block">Registers an action to perform when the stream is closed.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#onError(java.util.function.Consumer)" class="member-name-link">onError</a><wbr>(<a href="../../../../java.base/java/util/function/consumer.html" title="interface in java.util.function">Consumer</a>&lt;<a href="../../../../java.base/java/lang/throwable.html" title="class in java.lang">Throwable</a>&gt; action)</wbr></code></td>
<td> <div class="block">Registers an action to perform if an exception occurs.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#onEvent(java.lang.String,java.util.function.Consumer)" class="member-name-link">onEvent</a><wbr>(<a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a> eventName,
 <a href="../../../../java.base/java/util/function/consumer.html" title="interface in java.util.function">Consumer</a>&lt;<a href="recordedevent.html" title="class in jdk.jfr.consumer">RecordedEvent</a>&gt; action)</wbr></code></td>
<td> <div class="block">Registers an action to perform on all events matching a name.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#onEvent(java.util.function.Consumer)" class="member-name-link">onEvent</a><wbr>(<a href="../../../../java.base/java/util/function/consumer.html" title="interface in java.util.function">Consumer</a>&lt;<a href="recordedevent.html" title="class in jdk.jfr.consumer">RecordedEvent</a>&gt; action)</wbr></code></td>
<td> <div class="block">Registers an action to perform on all events in the stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#onFlush(java.lang.Runnable)" class="member-name-link">onFlush</a><wbr>(<a href="../../../../java.base/java/lang/runnable.html" title="interface in java.lang">Runnable</a> action)</wbr></code></td>
<td> <div class="block">Registers an action to perform after the stream has been flushed.</div> </td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code><a href="#remove(java.lang.Object)" class="member-name-link">remove</a><wbr>(<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">Object</a> action)</wbr></code></td>
<td> <div class="block">Unregisters an action.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setEndTime(java.time.Instant)" class="member-name-link">setEndTime</a><wbr>(<a href="../../../../java.base/java/time/instant.html" title="class in java.time">Instant</a> endTime)</wbr></code></td>
<td> <div class="block">Specifies the end time of the stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setMaxAge(java.time.Duration)" class="member-name-link">setMaxAge</a><wbr>(<a href="../../../../java.base/java/time/duration.html" title="class in java.time">Duration</a> maxAge)</wbr></code></td>
<td> <div class="block">Determines how far back data is kept for the stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setMaxSize(long)" class="member-name-link">setMaxSize</a><wbr>(long maxSize)</wbr></code></td>
<td> <div class="block">Determines how much data is kept for the stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setOrdered(boolean)" class="member-name-link">setOrdered</a><wbr>(boolean ordered)</wbr></code></td>
<td> <div class="block">Specifies that events arrives in chronological order, sorted by the time they were committed to the stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setReuse(boolean)" class="member-name-link">setReuse</a><wbr>(boolean reuse)</wbr></code></td>
<td> <div class="block">Specifies that the event object in an <a href="eventstream.html#onEvent(java.util.function.Consumer)"><code>EventStream.onEvent(Consumer)</code></a> action can be reused.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setSettings(java.util.Map)" class="member-name-link">setSettings</a><wbr>(<a href="../../../../java.base/java/util/map.html" title="interface in java.util">Map</a>&lt;<a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a>,<wbr><a href="../../../../java.base/java/lang/string.html" title="class in java.lang">String</a>&gt; settings)</wbr></wbr></code></td>
<td> <div class="block">Replaces all settings for this recording stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#setStartTime(java.time.Instant)" class="member-name-link">setStartTime</a><wbr>(<a href="../../../../java.base/java/time/instant.html" title="class in java.time">Instant</a> startTime)</wbr></code></td>
<td> <div class="block">Specifies the start time of the stream.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#start()" class="member-name-link">start</a>()</code></td>
<td> <div class="block">Starts processing of actions.</div> </td>
</tr>
<tr>
<td><code>void</code></td>
<td><code><a href="#startAsync()" class="member-name-link">startAsync</a>()</code></td>
<td> <div class="block">Starts asynchronous processing of actions.</div> </td>
</tr>
<tr>
<td><code>boolean</code></td>
<td><code><a href="#stop()" class="member-name-link">stop</a>()</code></td>
<td> <div class="block">Stops the recording stream.</div> </td>
</tr>
</table> </div> </div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-java.lang.Object">Methods declared in class java.lang.<a href="../../../../java.base/java/lang/object.html" title="class in java.lang">Object</a>
</h3> <code><a href="../../../../java.base/java/lang/object.html#clone()">clone</a>, <a href="../../../../java.base/java/lang/object.html#equals(java.lang.Object)">equals</a>, <a href="../../../../java.base/java/lang/object.html#finalize()">finalize</a>, <a href="../../../../java.base/java/lang/object.html#getClass()">getClass</a>, <a href="../../../../java.base/java/lang/object.html#hashCode()">hashCode</a>, <a href="../../../../java.base/java/lang/object.html#notify()">notify</a>, <a href="../../../../java.base/java/lang/object.html#notifyAll()">notifyAll</a>, <a href="../../../../java.base/java/lang/object.html#toString()">toString</a>, <a href="../../../../java.base/java/lang/object.html#wait()">wait</a>, <a href="../../../../java.base/java/lang/object.html#wait(long)">wait</a>, <a href="../../../../java.base/java/lang/object.html#wait(long,int)">wait</a></code>
</div> <div class="inherited-list"> <h3 id="methods-inherited-from-class-jdk.jfr.consumer.EventStream">Methods declared in interface jdk.jfr.consumer.<a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a>
</h3> <code><a href="eventstream.html#onMetadata(java.util.function.Consumer)">onMetadata</a></code>
</div> </section> </section> <section class="details"> <section class="constructor-details" id="constructor-detail"> <h2>Constructor Details</h2>  </section><section class="detail" id="&lt;init&gt;()"> <h3>RecordingStream</h3> <pre class="lang-java" data-language="java">public RecordingStream()</pre> <div class="block">Creates an event stream for the current JVM (Java Virtual Machine).</div> <dl class="notes"> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if Flight Recorder can't be created (for example, if the Java Virtual Machine (JVM) lacks Flight Recorder support, or if the file repository can't be created or accessed)</dd> <dd>
<code><a href="../../../../java.base/java/lang/securityexception.html" title="class in java.lang">SecurityException</a></code> - if a security manager exists and the caller does not have <code>FlightRecorderPermission("accessFlightRecorder")</code>
</dd> </dl> </section><section class="detail" id="&lt;init&gt;(jdk.jfr.Configuration)"> <h3>RecordingStream</h3> <pre class="lang-java" data-language="java">public RecordingStream(Configuration configuration)</pre> <div class="block">Creates a recording stream using settings from a configuration. <p> The following example shows how to create a recording stream that uses a predefined configuration. </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code class="language-java">var c = Configuration.getConfiguration("default");
try (var rs = new RecordingStream(c)) {
    rs.onEvent(System.out::println);
    rs.start();
}
</code></pre> </div> </div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>configuration</code> - configuration that contains the settings to use, not <code>null</code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if Flight Recorder can't be created (for example, if the Java Virtual Machine (JVM) lacks Flight Recorder support, or if the file repository can't be created or accessed)</dd> <dd>
<code><a href="../../../../java.base/java/lang/securityexception.html" title="class in java.lang">SecurityException</a></code> - if a security manager is used and FlightRecorderPermission "accessFlightRecorder" is not set.</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="../configuration.html" title="class in jdk.jfr"><code>Configuration</code></a></li> </ul> </dd> </dl> </section><section class="method-details" id="method-detail"> <h2>Method Details</h2>  </section><section class="detail" id="enable(java.lang.String)"> <h3>enable</h3> <pre class="lang-java" data-language="java">public EventSettings enable(String name)</pre> <div class="block">Enables the event with the specified name. <p> If multiple events have the same name (for example, the same class is loaded in different class loaders), then all events that match the name are enabled. To enable a specific class, use the <a href="#enable(java.lang.Class)"><code>enable(Class)</code></a> method or a <code>String</code> representation of the event type ID.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>name</code> - the settings for the event, not <code>null</code>
</dd> <dt>Returns:</dt> <dd>an event setting for further configuration, not <code>null</code>
</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="../eventtype.html" title="class in jdk.jfr"><code>EventType</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="setSettings(java.util.Map)"> <h3>setSettings</h3> <pre class="lang-java" data-language="java">public void setSettings(Map&lt;String,String&gt; settings)</pre> <div class="block">Replaces all settings for this recording stream. <p> The following example records 20 seconds using the "default" configuration and then changes settings to the "profile" configuration. </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code class="language-java">Configuration defaultConfiguration = Configuration.getConfiguration("default");
Configuration profileConfiguration = Configuration.getConfiguration("profile");
try (var rs = new RecordingStream(defaultConfiguration)) {
    rs.onEvent(System.out::println);
    rs.startAsync();
    Thread.sleep(20_000);
    rs.setSettings(profileConfiguration.getSettings());
    Thread.sleep(20_000);
}
</code></pre> </div> </div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>settings</code> - the settings to set, not <code>null</code>
</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="../recording.html#setSettings(java.util.Map)"><code>Recording.setSettings(Map)</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="enable(java.lang.Class)"> <h3>enable</h3> <pre class="lang-java" data-language="java">public EventSettings enable(Class&lt;? extends Event&gt; eventClass)</pre> <div class="block">Enables event.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>eventClass</code> - the event to enable, not <code>null</code>
</dd> <dt>Returns:</dt> <dd>an event setting for further configuration, not <code>null</code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if <code>eventClass</code> is an abstract class or not a subclass of <a href="../event.html" title="class in jdk.jfr"><code>Event</code></a>
</dd> </dl> </section><section class="detail" id="disable(java.lang.String)"> <h3>disable</h3> <pre class="lang-java" data-language="java">public EventSettings disable(String name)</pre> <div class="block">Disables event with the specified name. <p> If multiple events with same name (for example, the same class is loaded in different class loaders), then all events that match the name are disabled. To disable a specific class, use the <a href="#disable(java.lang.Class)"><code>disable(Class)</code></a> method or a <code>String</code> representation of the event type ID.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>name</code> - the settings for the event, not <code>null</code>
</dd> <dt>Returns:</dt> <dd>an event setting for further configuration, not <code>null</code>
</dd> </dl> </section><section class="detail" id="disable(java.lang.Class)"> <h3>disable</h3> <pre class="lang-java" data-language="java">public EventSettings disable(Class&lt;? extends Event&gt; eventClass)</pre> <div class="block">Disables event.</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>eventClass</code> - the event to enable, not <code>null</code>
</dd> <dt>Returns:</dt> <dd>an event setting for further configuration, not <code>null</code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if <code>eventClass</code> is an abstract class or not a subclass of <a href="../event.html" title="class in jdk.jfr"><code>Event</code></a>
</dd> </dl> </section><section class="detail" id="setMaxAge(java.time.Duration)"> <h3>setMaxAge</h3> <pre class="lang-java" data-language="java">public void setMaxAge(Duration maxAge)</pre> <div class="block">Determines how far back data is kept for the stream. <p> To control the amount of recording data stored on disk, the maximum length of time to retain the data can be specified. Data stored on disk that is older than the specified length of time is removed by the Java Virtual Machine (JVM). </p>
<p> If neither maximum limit or the maximum age is set, the size of the recording may grow indefinitely if events are on</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>maxAge</code> - the length of time that data is kept, or <code>null</code> if infinite</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if <code>maxAge</code> is negative</dd> <dd>
<code><a href="../../../../java.base/java/lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the recording is in the <code>CLOSED</code> state</dd> </dl> </section><section class="detail" id="setMaxSize(long)"> <h3>setMaxSize</h3> <pre class="lang-java" data-language="java">public void setMaxSize(long maxSize)</pre> <div class="block">Determines how much data is kept for the stream. <p> To control the amount of recording data that is stored on disk, the maximum amount of data to retain can be specified. When the maximum limit is exceeded, the Java Virtual Machine (JVM) removes the oldest chunk to make room for a more recent chunk. </p>
<p> If neither maximum limit or the maximum age is set, the size of the recording may grow indefinitely. </p>
<p> The size is measured in bytes.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>maxSize</code> - the amount of data to retain, <code>0</code> if infinite</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalargumentexception.html" title="class in java.lang">IllegalArgumentException</a></code> - if <code>maxSize</code> is negative</dd> <dd>
<code><a href="../../../../java.base/java/lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the recording is in <code>CLOSED</code> state</dd> </dl> </section><section class="detail" id="setReuse(boolean)"> <h3>setReuse</h3> <pre class="lang-java" data-language="java">public void setReuse(boolean reuse)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#setReuse(boolean)">EventStream</a></code></span></div> <div class="block">Specifies that the event object in an <a href="eventstream.html#onEvent(java.util.function.Consumer)"><code>EventStream.onEvent(Consumer)</code></a> action can be reused. <p> If reuse is set to <code>true</code>, an action should not keep a reference to the event object after the action has completed.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#setReuse(boolean)">setReuse</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>reuse</code> - <code>true</code> if an event object can be reused, <code>false</code> otherwise</dd> </dl> </section><section class="detail" id="setOrdered(boolean)"> <h3>setOrdered</h3> <pre class="lang-java" data-language="java">public void setOrdered(boolean ordered)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#setOrdered(boolean)">EventStream</a></code></span></div> <div class="block">Specifies that events arrives in chronological order, sorted by the time they were committed to the stream.</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#setOrdered(boolean)">setOrdered</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>ordered</code> - if event objects arrive in chronological order to <a href="eventstream.html#onEvent(java.util.function.Consumer)"><code>EventStream.onEvent(Consumer)</code></a>
</dd> </dl> </section><section class="detail" id="setStartTime(java.time.Instant)"> <h3>setStartTime</h3> <pre class="lang-java" data-language="java">public void setStartTime(Instant startTime)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#setStartTime(java.time.Instant)">EventStream</a></code></span></div> <div class="block">Specifies the start time of the stream. <p> The start time must be set before starting the stream</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#setStartTime(java.time.Instant)">setStartTime</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>startTime</code> - the start time, not <code>null</code>
</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="eventstream.html#start()"><code>EventStream.start()</code></a></li> <li><a href="eventstream.html#startAsync()"><code>EventStream.startAsync()</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="setEndTime(java.time.Instant)"> <h3>setEndTime</h3> <pre class="lang-java" data-language="java">public void setEndTime(Instant endTime)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#setEndTime(java.time.Instant)">EventStream</a></code></span></div> <div class="block">Specifies the end time of the stream. <p> The end time must be set before starting the stream. </p>
<p> At end time, the stream is closed.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#setEndTime(java.time.Instant)">setEndTime</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>endTime</code> - the end time, not <code>null</code>
</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="eventstream.html#start()"><code>EventStream.start()</code></a></li> <li><a href="eventstream.html#startAsync()"><code>EventStream.startAsync()</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="onEvent(java.lang.String,java.util.function.Consumer)"> <h3>onEvent</h3> <pre class="lang-java" data-language="java">public void onEvent(String eventName, Consumer&lt;RecordedEvent&gt; action)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#onEvent(java.lang.String,java.util.function.Consumer)">EventStream</a></code></span></div> <div class="block">Registers an action to perform on all events matching a name.</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#onEvent(java.lang.String,java.util.function.Consumer)">onEvent</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>eventName</code> - the name of the event, not <code>null</code>
</dd> <dd>
<code>action</code> - an action to perform on each <code>RecordedEvent</code> matching the event name, not <code>null</code>
</dd> </dl> </section><section class="detail" id="onEvent(java.util.function.Consumer)"> <h3>onEvent</h3> <pre class="lang-java" data-language="java">public void onEvent(Consumer&lt;RecordedEvent&gt; action)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#onEvent(java.util.function.Consumer)">EventStream</a></code></span></div> <div class="block">Registers an action to perform on all events in the stream. <p> To perform an action on a subset of event types, consider using <a href="eventstream.html#onEvent(java.lang.String,java.util.function.Consumer)"><code>EventStream.onEvent(String, Consumer)</code></a> and <a href="eventstream.html#onMetadata(java.util.function.Consumer)"><code>EventStream.onMetadata(Consumer)</code></a> as it is likely more performant than any selection or filtering mechanism implemented in a generic action.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#onEvent(java.util.function.Consumer)">onEvent</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>action</code> - an action to perform on each <code>RecordedEvent</code>, not <code>null</code>
</dd> <dt>See Also:</dt> <dd> <ul class="tag-list-long"> <li><a href="eventstream.html#onEvent(java.util.function.Consumer)"><code>EventStream.onEvent(Consumer)</code></a></li> <li><a href="eventstream.html#onMetadata(java.util.function.Consumer)"><code>EventStream.onMetadata(Consumer)</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="onFlush(java.lang.Runnable)"> <h3>onFlush</h3> <pre class="lang-java" data-language="java">public void onFlush(Runnable action)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#onFlush(java.lang.Runnable)">EventStream</a></code></span></div> <div class="block">Registers an action to perform after the stream has been flushed.</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#onFlush(java.lang.Runnable)">onFlush</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>action</code> - an action to perform after the stream has been flushed, not <code>null</code>
</dd> </dl> </section><section class="detail" id="onClose(java.lang.Runnable)"> <h3>onClose</h3> <pre class="lang-java" data-language="java">public void onClose(Runnable action)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#onClose(java.lang.Runnable)">EventStream</a></code></span></div> <div class="block">Registers an action to perform when the stream is closed. <p> If the stream is already closed, the action will be performed immediately in the current thread.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#onClose(java.lang.Runnable)">onClose</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>action</code> - an action to perform after the stream is closed, not <code>null</code>
</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="eventstream.html#close()"><code>EventStream.close()</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="onError(java.util.function.Consumer)"> <h3>onError</h3> <pre class="lang-java" data-language="java">public void onError(Consumer&lt;Throwable&gt; action)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#onError(java.util.function.Consumer)">EventStream</a></code></span></div> <div class="block">Registers an action to perform if an exception occurs. <p> If an action is not registered, an exception stack trace is printed to standard error. </p>
<p> Registering an action overrides the default behavior. If multiple actions have been registered, they are performed in the order of registration. </p>
<p> If this method itself throws an exception, resulting behavior is undefined.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#onError(java.util.function.Consumer)">onError</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>action</code> - an action to perform if an exception occurs, not <code>null</code>
</dd> </dl> </section><section class="detail" id="close()"> <h3>close</h3> <pre class="lang-java" data-language="java">public void close()</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="../../../../java.base/java/lang/autocloseable.html#close()">AutoCloseable</a></code></span></div> <div class="block">Closes this resource, relinquishing any underlying resources. This method is invoked automatically on objects managed by the <code>try</code>-with-resources statement.</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="../../../../java.base/java/lang/autocloseable.html#close()">close</a></code> in interface <code><a href="../../../../java.base/java/lang/autocloseable.html" title="interface in java.lang">AutoCloseable</a></code>
</dd> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#close()">close</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> </dl> </section><section class="detail" id="remove(java.lang.Object)"> <h3>remove</h3> <pre class="lang-java" data-language="java">public boolean remove(Object action)</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#remove(java.lang.Object)">EventStream</a></code></span></div> <div class="block">Unregisters an action. <p> If the action has been registered multiple times, all instances are unregistered.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#remove(java.lang.Object)">remove</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>action</code> - the action to unregister, not <code>null</code>
</dd> <dt>Returns:</dt> <dd>
<code>true</code> if the action was unregistered, <code>false</code> otherwise</dd> <dt>See Also:</dt> <dd> <ul class="tag-list-long"> <li><a href="eventstream.html#onEvent(java.util.function.Consumer)"><code>EventStream.onEvent(Consumer)</code></a></li> <li><a href="eventstream.html#onEvent(java.lang.String,java.util.function.Consumer)"><code>EventStream.onEvent(String, Consumer)</code></a></li> <li><a href="eventstream.html#onFlush(java.lang.Runnable)"><code>EventStream.onFlush(Runnable)</code></a></li> <li><a href="eventstream.html#onClose(java.lang.Runnable)"><code>EventStream.onClose(Runnable)</code></a></li> <li><a href="eventstream.html#onError(java.util.function.Consumer)"><code>EventStream.onError(Consumer)</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="start()"> <h3>start</h3> <pre class="lang-java" data-language="java">public void start()</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#start()">EventStream</a></code></span></div> <div class="block">Starts processing of actions. <p> Actions are performed in the current thread. </p>
<p> To stop the stream, use the <a href="eventstream.html#close()"><code>EventStream.close()</code></a> method.</p>
</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#start()">start</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> </dl> </section><section class="detail" id="startAsync()"> <h3>startAsync</h3> <pre class="lang-java" data-language="java">public void startAsync()</pre> <div class="block">Starts asynchronous processing of actions. <p> Actions are performed in a single separate thread. </p>
<p> To stop the stream, use the <a href="#close()"><code>close()</code></a> method. </p>
<p> The following example prints the CPU usage for ten seconds. When the current thread leaves the try-with-resources block the stream is stopped/closed. </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code class="language-java">try (var stream = new RecordingStream()) {
    stream.enable("jdk.CPULoad").withPeriod(Duration.ofSeconds(1));
    stream.onEvent("jdk.CPULoad", event -&gt; {
        System.out.println(event);
    });
    stream.startAsync();
    Thread.sleep(10_000);
}
</code></pre> </div> </div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#startAsync()">startAsync</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the stream is already started or closed</dd> </dl> </section><section class="detail" id="stop()"> <h3>stop</h3> <pre class="lang-java" data-language="java">public boolean stop()</pre> <div class="block">Stops the recording stream. <p> Stops a started stream and waits until all events in the recording have been consumed. </p>
<p> Invoking this method in an action, for example in the <a href="#onEvent(java.util.function.Consumer)"><code>onEvent(Consumer)</code></a> method, could block the stream indefinitely. To stop the stream abruptly, use the <a href="#close()"><code>close()</code></a> method. </p>
<p> The following code snippet illustrates how this method can be used in conjunction with the <a href="#startAsync()"><code>startAsync()</code></a> method to monitor what happens during a test method: </p>
<div class="snippet-container"> <pre class="lang-java" data-language="java"><code class="language-java">AtomicBoolean socketUse = new AtomicBoolean();
try (var r = new RecordingStream()) {
    r.setMaxSize(Long.MAX_VALUE);
    r.enable("jdk.SocketWrite").withoutThreshold();
    r.enable("jdk.SocketRead").withoutThreshold();
    r.onEvent(event -&gt; socketUse.set(true));
    r.startAsync();
    testFoo();
    r.stop();
    if (socketUse.get()) {
        r.dump(Path.of("socket-events.jfr"));
        throw new AssertionError("testFoo() should not use network");
    }
}
</code></pre> </div> </div> <dl class="notes"> <dt>Returns:</dt> <dd>
<code>true</code> if recording is stopped, <code>false</code> otherwise</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/illegalstateexception.html" title="class in java.lang">IllegalStateException</a></code> - if the recording is not started or is already stopped</dd> <dt>Since:</dt> <dd>20</dd> </dl> </section><section class="detail" id="dump(java.nio.file.Path)"> <h3>dump</h3> <pre class="lang-java" data-language="java">public void dump(Path destination) throws IOException</pre> <div class="block">Writes recording data to a file. <p> The recording stream must be started, but not closed. </p>
<p> It's highly recommended that a max age or max size is set before starting the stream. Otherwise, the dump may not contain any events.</p>
</div> <dl class="notes"> <dt>Parameters:</dt> <dd>
<code>destination</code> - the location where recording data is written, not <code>null</code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/io/ioexception.html" title="class in java.io">IOException</a></code> - if the recording data can't be copied to the specified location, or if the stream is closed, or not started.</dd> <dd>
<code><a href="../../../../java.base/java/lang/securityexception.html" title="class in java.lang">SecurityException</a></code> - if a security manager exists and the caller doesn't have <code>FilePermission</code> to write to the destination path</dd> <dt>Since:</dt> <dd>17</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="#setMaxAge(java.time.Duration)"><code>setMaxAge(Duration)</code></a></li> <li><a href="#setMaxSize(long)"><code>setMaxSize(long)</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="awaitTermination(java.time.Duration)"> <h3>awaitTermination</h3> <pre class="lang-java" data-language="java">public void awaitTermination(Duration timeout) throws InterruptedException</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#awaitTermination(java.time.Duration)">EventStream</a></code></span></div> <div class="block">Blocks until all actions are completed, or the stream is closed, or the timeout occurs, or the current thread is interrupted, whichever happens first.</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#awaitTermination(java.time.Duration)">awaitTermination</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Parameters:</dt> <dd>
<code>timeout</code> - the maximum time to wait, not <code>null</code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/interruptedexception.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="eventstream.html#start()"><code>EventStream.start()</code></a></li> <li><a href="eventstream.html#startAsync()"><code>EventStream.startAsync()</code></a></li> <li><a href="../../../../java.base/java/lang/thread.html#interrupt()"><code>Thread.interrupt()</code></a></li> </ul> </dd> </dl> </section><section class="detail" id="awaitTermination()"> <h3>awaitTermination</h3> <pre class="lang-java" data-language="java">public void awaitTermination() throws InterruptedException</pre> <div class="block"><span class="description-from-type-label">Description copied from interface: <code><a href="eventstream.html#awaitTermination()">EventStream</a></code></span></div> <div class="block">Blocks until all actions are completed, or the stream is closed, or the current thread is interrupted, whichever happens first.</div> <dl class="notes"> <dt>Specified by:</dt> <dd>
<code><a href="eventstream.html#awaitTermination()">awaitTermination</a></code> in interface <code><a href="eventstream.html" title="interface in jdk.jfr.consumer">EventStream</a></code>
</dd> <dt>Throws:</dt> <dd>
<code><a href="../../../../java.base/java/lang/interruptedexception.html" title="class in java.lang">InterruptedException</a></code> - if interrupted while waiting</dd> <dt>See Also:</dt> <dd> <ul class="tag-list"> <li><a href="eventstream.html#start()"><code>EventStream.start()</code></a></li> <li><a href="eventstream.html#startAsync()"><code>EventStream.startAsync()</code></a></li> <li><a href="../../../../java.base/java/lang/thread.html#interrupt()"><code>Thread.interrupt()</code></a></li> </ul> </dd> </dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1993, 2023, Oracle and/or its affiliates. All rights reserved.<br>Documentation extracted from Debian's OpenJDK Development Kit package.<br>Licensed under the GNU General Public License, version 2, with the Classpath Exception.<br>Various third party code in OpenJDK is licensed under different licenses (see Debian package).<br>Java and OpenJDK are trademarks or registered trademarks of Oracle and/or its affiliates.<br>
    <a href="https://docs.oracle.com/en/java/javase/21/docs/api/jdk.jfr/jdk/jfr/consumer/RecordingStream.html" class="_attribution-link">https://docs.oracle.com/en/java/javase/21/docs/api/jdk.jfr/jdk/jfr/consumer/RecordingStream.html</a>
  </p>
</div>
