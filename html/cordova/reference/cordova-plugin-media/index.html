<h1 id="cordova-plugin-media">cordova-plugin-media</h1> <p>This plugin provides the ability to record and play back audio files on a device.</p> <p><strong>NOTE</strong>: The current implementation does not adhere to a W3C specification for media capture, and is provided for convenience only. A future implementation will adhere to the latest W3C specification and may deprecate the current APIs.</p> <p>This plugin defines a global <code>Media</code> Constructor.</p> <p>Although in the global scope, it is not available until after the <code>deviceready</code> event.</p> <pre data-language="js">document.addEventListener("deviceready", onDeviceReady, false);
function onDeviceReady() {
    console.log(Media);
}
</pre> <h2 id="installation">Installation</h2> <pre data-language="bash">cordova plugin add cordova-plugin-media
</pre> <h2 id="supported-platforms">Supported Platforms</h2> <ul> <li>Android</li> <li>iOS</li> <li>Windows</li> <li>Browser</li> </ul> <h2 id="media">Media</h2> <pre data-language="js">var media = new Media(src, mediaSuccess, [mediaError], [mediaStatus]);
</pre> <h3 id="parameters">Parameters</h3> <ul> <li><p><strong>src</strong>: A URI containing the audio content. <em>(DOMString)</em></p></li> <li><p><strong>mediaSuccess</strong>: (Optional) The callback that executes after a <code>Media</code> object has completed the current play, record, or stop action. <em>(Function)</em></p></li> <li><p><strong>mediaError</strong>: (Optional) The callback that executes if an error occurs. It takes an integer error code. <em>(Function)</em></p></li> <li><p><strong>mediaStatus</strong>: (Optional) The callback that executes to indicate status changes. It takes a integer status code. <em>(Function)</em></p></li> </ul> <p><strong>NOTE</strong>: <code>cdvfile</code> path is supported as <code>src</code> parameter:</p> <pre data-language="javascript">var my_media = new Media('cdvfile://localhost/temporary/recording.mp3', ...);
</pre> <h3 id="constants">Constants</h3> <p>The following constants are reported as the only parameter to the <code>mediaStatus</code> callback:</p> <ul> <li>
<code>Media.MEDIA_NONE</code> = 0;</li> <li>
<code>Media.MEDIA_STARTING</code> = 1;</li> <li>
<code>Media.MEDIA_RUNNING</code> = 2;</li> <li>
<code>Media.MEDIA_PAUSED</code> = 3;</li> <li>
<code>Media.MEDIA_STOPPED</code> = 4;</li> </ul> <h3 id="methods">Methods</h3> <ul> <li><p><code>media.getCurrentAmplitude</code>: Returns the current amplitude within an audio file.</p></li> <li><p><code>media.getCurrentPosition</code>: Returns the current position within an audio file.</p></li> <li><p><code>media.getDuration</code>: Returns the duration of an audio file.</p></li> <li><p><code>media.play</code>: Start or resume playing an audio file.</p></li> <li><p><code>media.pause</code>: Pause playback of an audio file.</p></li> <li><p><code>media.pauseRecord</code>: Pause recording of an audio file.</p></li> <li><p><code>media.release</code>: Releases the underlying operating system's audio resources.</p></li> <li><p><code>media.resumeRecord</code>: Resume recording of an audio file.</p></li> <li><p><code>media.seekTo</code>: Moves the position within the audio file.</p></li> <li><p><code>media.setVolume</code>: Set the volume for audio playback.</p></li> <li><p><code>media.startRecord</code>: Start recording an audio file.</p></li> <li><p><code>media.stopRecord</code>: Stop recording an audio file.</p></li> <li><p><code>media.stop</code>: Stop playing an audio file.</p></li> <li><p><code>media.setRate</code>: Set the playback rate for the audio file.</p></li> </ul> <h3 id="additional-readonly-parameters">Additional ReadOnly Parameters</h3> <ul> <li>
<p><strong>position</strong>: The position within the audio playback, in seconds.</p> <ul> <li>Not automatically updated during play; call <code>getCurrentPosition</code> to update.</li> </ul>
</li> <li><p><strong>duration</strong>: The duration of the media, in seconds.</p></li> </ul> <h2 id="media-getcurrentamplitude">media.getCurrentAmplitude</h2> <p>Returns the current amplitude within an audio file.</p> <pre data-language="">media.getCurrentAmplitude(mediaSuccess, [mediaError]);
</pre> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>Android</li> <li>iOS</li> </ul> <h3 id="parameters">Parameters</h3> <ul> <li><p><strong>mediaSuccess</strong>: The callback that is passed the current amplitude (0.0 - 1.0).</p></li> <li><p><strong>mediaError</strong>: (Optional) The callback to execute if an error occurs.</p></li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Audio player
//
var my_media = new Media(src, onSuccess, onError);

// Record audio
my_media.startRecord();

mediaTimer = setInterval(function () {
    // get media amplitude
    my_media.getCurrentAmplitude(
        // success callback
        function (amp) {
            console.log(amp + "%");
        },
        // error callback
        function (e) {
            console.log("Error getting amp=" + e);
        }
    );
}, 1000);
</pre> <h2 id="media-getcurrentposition">media.getCurrentPosition</h2> <p>Returns the current position within an audio file. Also updates the <code>Media</code> object's <code>position</code> parameter.</p> <pre data-language="">media.getCurrentPosition(mediaSuccess, [mediaError]);
</pre> <h3 id="parameters">Parameters</h3> <ul> <li><p><strong>mediaSuccess</strong>: The callback that is passed the current position in seconds.</p></li> <li><p><strong>mediaError</strong>: (Optional) The callback to execute if an error occurs.</p></li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Audio player
//
var my_media = new Media(src, onSuccess, onError);

// Update media position every second
var mediaTimer = setInterval(function () {
    // get media position
    my_media.getCurrentPosition(
        // success callback
        function (position) {
            if (position &gt; -1) {
                console.log((position) + " sec");
            }
        },
        // error callback
        function (e) {
            console.log("Error getting pos=" + e);
        }
    );
}, 1000);
</pre> <h2 id="media-getduration">media.getDuration</h2> <p>Returns the duration of an audio file in seconds. If the duration is unknown, it returns a value of -1.</p> <pre data-language="">media.getDuration();
</pre> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Audio player
//
var my_media = new Media(src, onSuccess, onError);

// Get duration
var counter = 0;
var timerDur = setInterval(function() {
    counter = counter + 100;
    if (counter &gt; 2000) {
        clearInterval(timerDur);
    }
    var dur = my_media.getDuration();
    if (dur &gt; 0) {
        clearInterval(timerDur);
        document.getElementById('audio_duration').innerHTML = (dur) + " sec";
    }
}, 100);
</pre> <h2 id="media-pause">media.pause</h2> <p>Pauses playing an audio file.</p> <pre data-language="">media.pause();
</pre> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Play audio
//
function playAudio(url) {
    // Play the audio file at url
    var my_media = new Media(url,
        // success callback
        function () { console.log("playAudio():Audio Success"); },
        // error callback
        function (err) { console.log("playAudio():Audio Error: " + err); }
    );

    // Play audio
    my_media.play();

    // Pause after 10 seconds
    setTimeout(function () {
        my_media.pause();
    }, 10000);
}
</pre> <h2 id="media-pauserecord">media.pauseRecord</h2> <p>Pauses recording an audio file.</p> <pre data-language="">media.pauseRecord();
</pre> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>iOS</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Record audio
//
function recordAudio() {
    var src = "myrecording.mp3";
    var mediaRec = new Media(src,
        // success callback
        function() {
            console.log("recordAudio():Audio Success");
        },

        // error callback
        function(err) {
            console.log("recordAudio():Audio Error: "+ err.code);
        });

    // Record audio
    mediaRec.startRecord();

    // Pause Recording after 5 seconds
    setTimeout(function() {
        mediaRec.pauseRecord();
    }, 5000);
}
</pre> <h2 id="media-play">media.play</h2> <p>Starts or resumes playing an audio file.</p> <pre data-language="js">media.play();
</pre> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Play audio
//
function playAudio(url) {
    // Play the audio file at url
    var my_media = new Media(url,
        // success callback
        function () {
            console.log("playAudio():Audio Success");
        },
        // error callback
        function (err) {
            console.log("playAudio():Audio Error: " + err);
        }
    );
    // Play audio
    my_media.play();
}
</pre> <h3 id="ios-quirks">iOS Quirks</h3> <ul> <li>
<p><strong>numberOfLoops</strong>: Pass this option to the <code>play</code> method to specify the number of times you want the media file to play, e.g.:</p> <pre data-language="">var myMedia = new Media("http://audio.ibeat.org/content/p1rj1s/p1rj1s_-_rockGuitar.mp3")
myMedia.play({ numberOfLoops: 2 })
</pre>
</li> <li>
<p><strong>playAudioWhenScreenIsLocked</strong>: Pass in this option to the <code>play</code> method to specify whether you want to allow playback when the screen is locked. If set to <code>true</code> (the default value), the state of the hardware mute button is ignored, e.g.:</p> <pre data-language="">var myMedia = new Media("http://audio.ibeat.org/content/p1rj1s/p1rj1s_-_rockGuitar.mp3");
myMedia.play({ playAudioWhenScreenIsLocked : true });
myMedia.setVolume('1.0');
</pre>
</li> </ul> <blockquote> <p>Note: To allow playback with the screen locked or background audio you have to add <code>audio</code> to <code>UIBackgroundModes</code> in the <code>info.plist</code> file. See <a href="https://developer.apple.com/library/content/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/BackgroundExecution/BackgroundExecution.html#//apple_ref/doc/uid/TP40007072-CH4-SW23">Apple documentation</a>. Also note that the audio has to be started before going to background.</p> </blockquote> <ul> <li>
<p><strong>order of file search</strong>: When only a file name or simple path is provided, iOS searches in the <code>www</code> directory for the file, then in the application's <code>documents/tmp</code> directory:</p> <pre data-language="">var myMedia = new Media("audio/beer.mp3")
myMedia.play()  // first looks for file in www/audio/beer.mp3 then in &lt;application&gt;/documents/tmp/audio/beer.mp3
</pre>
</li> </ul> <h2 id="media-release">media.release</h2> <p>Releases the underlying operating system's audio resources. This is particularly important for Android, since there are a finite amount of OpenCore instances for media playback. Applications should call the <code>release</code> function for any <code>Media</code> resource that is no longer needed.</p> <pre data-language="">media.release();
</pre> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Audio player
//
var my_media = new Media(src, onSuccess, onError);

my_media.play();
my_media.stop();
my_media.release();
</pre> <h2 id="media-resumerecord">media.resumeRecord</h2> <p>Resume recording an audio file.</p> <pre data-language="">media.resumeRecord();
</pre> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>iOS</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Record audio
//
function recordAudio() {
    var src = "myrecording.mp3";
    var mediaRec = new Media(src,
        // success callback
        function() {
            console.log("recordAudio():Audio Success");
        },

        // error callback
        function(err) {
            console.log("recordAudio():Audio Error: "+ err.code);
        });

    // Record audio
    mediaRec.startRecord();

    // Pause Recording after 5 seconds
    setTimeout(function() {
        mediaRec.pauseRecord();
    }, 5000);

    // Resume Recording after 10 seconds
    setTimeout(function() {
        mediaRec.resumeRecord();
    }, 10000);
}
</pre> <h2 id="media-seekto">media.seekTo</h2> <p>Sets the current position within an audio file.</p> <pre data-language="">media.seekTo(milliseconds);
</pre> <h3 id="parameters">Parameters</h3> <ul> <li>
<strong>milliseconds</strong>: The position to set the playback position within the audio, in milliseconds.</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Audio player
//
var my_media = new Media(src, onSuccess, onError);
    my_media.play();
// SeekTo to 10 seconds after 5 seconds
setTimeout(function() {
    my_media.seekTo(10000);
}, 5000);
</pre> <h2 id="media-setvolume">media.setVolume</h2> <p>Set the volume for an audio file.</p> <pre data-language="">media.setVolume(volume);
</pre> <h3 id="parameters">Parameters</h3> <ul> <li>
<strong>volume</strong>: The volume to set for playback. The value must be within the range of 0.0 to 1.0.</li> </ul> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>Android</li> <li>iOS</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Play audio
//
function playAudio(url) {
    // Play the audio file at url
    var my_media = new Media(url,
        // success callback
        function() {
            console.log("playAudio():Audio Success");
        },
        // error callback
        function(err) {
            console.log("playAudio():Audio Error: "+err);
    });

    // Play audio
    my_media.play();

    // Mute volume after 2 seconds
    setTimeout(function() {
        my_media.setVolume('0.0');
    }, 2000);

    // Set volume to 1.0 after 5 seconds
    setTimeout(function() {
        my_media.setVolume('1.0');
    }, 5000);
}
</pre> <h2 id="media-startrecord">media.startRecord</h2> <p>Starts recording an audio file.</p> <pre data-language="">media.startRecord();
</pre> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>Android</li> <li>iOS</li> <li>Windows</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Record audio
//
function recordAudio() {
    var src = "myrecording.mp3";
    var mediaRec = new Media(src,
        // success callback
        function() {
            console.log("recordAudio():Audio Success");
        },

        // error callback
        function(err) {
            console.log("recordAudio():Audio Error: "+ err.code);
        });

    // Record audio
    mediaRec.startRecord();
}
</pre> <h3 id="android-quirks">Android Quirks</h3> <ul> <li>Android devices record audio in AAC ADTS file format. The specified file should end with a <em>.aac</em> extension.</li> <li>The hardware volume controls are wired up to the media volume while any Media objects are alive. Once the last created Media object has <code>release()</code> called on it, the volume controls revert to their default behaviour. The controls are also reset on page navigation, as this releases all Media objects.</li> </ul> <h3 id="ios-quirks">iOS Quirks</h3> <ul> <li><p>iOS only records to files of type <em>.wav</em> and <em>.m4a</em> and returns an error if the file name extension is not correct.</p></li> <li><p>If a full path is not provided, the recording is placed in the application's <code>documents/tmp</code> directory. This can be accessed via the <code>File</code> API using <code>LocalFileSystem.TEMPORARY</code>. Any subdirectory specified at record time must already exist.</p></li> <li>
<p>Files can be recorded and played back using the documents URI:</p> <pre data-language="">var myMedia = new Media("documents://beer.mp3")
</pre>
</li> <li><p>Since iOS 10 it's mandatory to provide an usage description in the <code>info.plist</code> if trying to access privacy-sensitive data. When the system prompts the user to allow access, this usage description string will displayed as part of the permission dialog box, but if you didn't provide the usage description, the app will crash before showing the dialog. Also, Apple will reject apps that access private data but don't provide an usage description.</p></li> </ul> <p>This plugins requires the following usage description:</p> <ul> <li>
<code>NSMicrophoneUsageDescription</code> describes the reason that the app accesses the user's microphone. </li> </ul> <p>To add this entry into the <code>info.plist</code>, you can use the <code>edit-config</code> tag in the <code>config.xml</code> like this:</p> <pre data-language="">&lt;edit-config target="NSMicrophoneUsageDescription" file="*-Info.plist" mode="merge"&gt;
    &lt;string&gt;need microphone access to record sounds&lt;/string&gt;
&lt;/edit-config&gt;
</pre> <h3 id="windows-quirks">Windows Quirks</h3> <ul> <li><p>Windows devices can use MP3, M4A and WMA formats for recorded audio. However in most cases it is not possible to use MP3 for audio recording on <em>Windows Phone 8.1</em> devices, because an MP3 encoder is <a href="https://msdn.microsoft.com/en-us/library/windows/apps/windows.media.mediaproperties.mediaencodingprofile.createmp3.aspx">not shipped with Windows Phone</a>.</p></li> <li><p>If a full path is not provided, the recording is placed in the <code>AppData/temp</code> directory. This can be accessed via the <code>File</code> API using <code>LocalFileSystem.TEMPORARY</code> or <code>ms-appdata:///temp/&lt;filename&gt;</code> URI.</p></li> <li><p>Any subdirectory specified at record time must already exist.</p></li> </ul> <h2 id="media-stop">media.stop</h2> <p>Stops playing an audio file.</p> <pre data-language="">media.stop();
</pre> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Play audio
//
function playAudio(url) {
    // Play the audio file at url
    var my_media = new Media(url,
        // success callback
        function() {
            console.log("playAudio():Audio Success");
        },
        // error callback
        function(err) {
            console.log("playAudio():Audio Error: "+err);
        }
    );

    // Play audio
    my_media.play();

    // Pause after 10 seconds
    setTimeout(function() {
        my_media.stop();
    }, 10000);
}
</pre> <h2 id="media-stoprecord">media.stopRecord</h2> <p>Stops recording an audio file.</p> <pre data-language="">media.stopRecord();
</pre> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>Android</li> <li>iOS</li> <li>Windows</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Record audio
//
function recordAudio() {
    var src = "myrecording.mp3";
    var mediaRec = new Media(src,
        // success callback
        function() {
            console.log("recordAudio():Audio Success");
        },

        // error callback
        function(err) {
            console.log("recordAudio():Audio Error: "+ err.code);
        }
    );

    // Record audio
    mediaRec.startRecord();

    // Stop recording after 10 seconds
    setTimeout(function() {
        mediaRec.stopRecord();
    }, 10000);
}
</pre> <h2 id="media-setrate">media.setRate</h2> <p>Stops recording an audio file.</p> <pre data-language="">media.setRate(rate);
</pre> <h3 id="supported-platforms">Supported Platforms</h3> <ul> <li>iOS</li> </ul> <h3 id="parameters">Parameters</h3> <ul> <li>
<strong>rate</strong>: The rate to set for playback.</li> </ul> <h3 id="quick-example">Quick Example</h3> <pre data-language="js">// Audio player
//
var my_media = new Media(src, onSuccess, onError);
    my_media.play();

// Set playback rate to 2.0x after 10 seconds
setTimeout(function() {
    my_media.setRate(2.0);
}, 5000);
</pre> <h2 id="mediaerror">MediaError</h2> <p>A <code>MediaError</code> object is returned to the <code>mediaError</code> callback function when an error occurs.</p> <h3 id="properties">Properties</h3> <ul> <li><p><strong>code</strong>: One of the predefined error codes listed below.</p></li> <li><p><strong>message</strong>: An error message describing the details of the error.</p></li> </ul> <h3 id="constants">Constants</h3> <ul> <li>
<code>MediaError.MEDIA_ERR_ABORTED</code> = 1</li> <li>
<code>MediaError.MEDIA_ERR_NETWORK</code> = 2</li> <li>
<code>MediaError.MEDIA_ERR_DECODE</code> = 3</li> <li>
<code>MediaError.MEDIA_ERR_NONE_SUPPORTED</code> = 4</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012, 2013, 2015 The Apache Software Foundation<br>Licensed under the Apache License 2.0.<br>
    <a href="https://cordova.apache.org/docs/en/9.x/reference/cordova-plugin-media/index.html" class="_attribution-link">https://cordova.apache.org/docs/en/9.x/reference/cordova-plugin-media/index.html</a>
  </p>
</div>
