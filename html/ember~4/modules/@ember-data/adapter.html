<article class="chapter"> <h1 class="module-name">Package @ember-data/adapter</h1>   
<h2 id="overview">Overview</h2> <p>In order to properly fetch and update data, EmberData needs to understand how to connect to your API.</p> <p><code>Adapters</code> accept various kinds of requests from the store and manage fulfillment of the request from your API.</p> <h3 id="request-flow">Request Flow</h3> <p>When the store decides it needs to issue a request it uses the following flow to manage the request and process the data.</p> <ul> <li>find the appropriate adapter</li> <li>issue the request to the adapter</li> <li>await the adapter's response<ul> <li>if an error occurs reject with the error</li> <li>if no error<ul> <li>if there is response data<ul> <li>pass the response data to the appropriate serializer</li> <li>update the cache using the JSON:API formatted data from the serializer's response</li> </ul> </li> <li>return the primary record(s) associated with the request</li> </ul> </li> </ul> </li> </ul> <h3 id="request-errors">Request Errors</h3> <p>When a request errors and your adapter does not have the ability to recover from the error, you may either reject the promise returned by your adapter method with the error or simply throw the error.</p> <p>If the request was for a <code>createRecord</code> <code>updateRecord</code> or <code>deleteRecord</code> special rules apply to how this error will affect the state of the store and additional properties on the <code>Error</code> class may be used. See the documentation for these methods in the <code>MinimumAdapterInterface</code> for more information.</p> <h3 id="implementing-an-adapter">Implementing an Adapter</h3> <p>There are seven required adapter methods, one for each of the primary request types that EmberData issues.</p> <p>They are:</p> <ul> <li>findRecord</li> <li>findAll</li> <li>queryRecord</li> <li>query</li> <li>createRecord</li> <li>updateRecord</li> <li>deleteRecord</li> </ul> <p>Each of these request types has a matching store method that triggers it and matching <code>requestType</code> that is passed to the serializer's <code>normalizeResponse</code> method.</p> <p>If your app only reads data but never writes data, it is not necessary to implement the methods for create, update, and delete. This extends to all of the store's find methods with the exception of <code>findRecord</code> (<code>findAll</code>, <code>query</code>, <code>queryRecord</code>): if you do not use the store method in your app then your Adapter does not need the method.</p> <pre class="highlight typescript" data-language="">import EmberObject from '@ember/object';

async function fetchData(url, options = {}) {
  let response = await fetch(url, options);
  return response.toJSON();
}

export default class ApplicationAdapter extends EmberObject {
  findRecord(_, { modelName }, id) {
    return fetchData(`./${modelName}s/${id}`);
  }
}</pre> <h3 id="adapter-resolution">Adapter Resolution</h3> <p><code>store.adapterFor(name)</code> will lookup adapters defined in <code>app/adapters/</code> and return an instance.</p> <p><code>adapterFor</code> first attempts to find an adapter with an exact match on <code>name</code>, then falls back to checking for the presence of an adapter named <code>application</code>.</p> <p>If no adapter is found, an error will be thrown.</p> <pre class="highlight typescript" data-language="">store.adapterFor('author');

// lookup paths (in order) =&gt;
//   app/adapters/author.js
//   app/adapters/application.js</pre> <p>Most requests in EmberData are made with respect to a particular <code>type</code> (or <code>modelName</code>) (e.g., "get me the full collection of <strong>books</strong>" or "get me the <strong>employee</strong> whose id is 37"). We refer to this as the <strong>primary</strong> resource <code>type</code>.</p> <p><code>adapterFor</code> is used by the store to find an adapter with a name matching that of the primary resource <code>type</code> for the request, which then falls back to the <code>application</code> adapter.</p> <p>It is recommended that applications define only a single <code>application</code> adapter and serializer where possible, only implementing an adapter specific to the <code>type</code> when absolutely necessary.</p> <p>If you need to support multiple API versions for the same type, the per-type strategy for defining adapters might not be adequate.</p> <p>If you have multiple APIs or multiple API versions and the single application adapter and per-type strategy does not suite your needs, one strategy is to write an <code>application</code> adapter and serializer that make use of <code>options</code> to specify the desired format when making a request, then forwards to the request to the desired adapter or serializer as needed.</p> <div class="pre-title"><code>app/adapters/application.js</code></div>
<pre class="highlight javascript" data-language="javascript">export default class Adapter extends EmberObject {
  findRecord(store, schema, id, snapshot) {
    let { apiVersion } = snapshot.adapterOptions;
    return this.adapterFor(`-api-${apiVersion}`).findRecord(store, schema, id, snapshot);
  }
}</pre> <h3 id="using-an-adapter">Using an Adapter</h3> <p>Any adapter in <code>app/adapters/</code> can be looked up by <code>name</code> using <code>store.adapterFor(name)</code>.</p> <h3 id="default-adapters">Default Adapters</h3> <p>Applications whose API's structure endpoint URLs <em>very close to</em> or <em>exactly</em> the <strong>REST</strong> or <strong>JSON:API</strong> convention, the <code>@ember-data/adapter</code> package contains implementations these applications can extend.</p> <p>Many applications will find writing their own adapter to be allow greater flexibility, customization, and maintenance than attempting to override methods in these adapters.</p>   <h2 id="classes" class="anchorable-toc">  Classes </h2> <ul> <li> <a href="../classes/adapter.html"> Adapter </a> </li> <li> <a href="../classes/buildurlmixin.html"> BuildURLMixin </a> </li> <li> <a href="../classes/minimumadapterinterface.html"> MinimumAdapterInterface </a> </li> </ul>    </article><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 Yehuda Katz, Tom Dale and Ember.js contributors<br>Licensed under the MIT License.<br>
    <a href="https://api.emberjs.com/ember-data/4.9/modules/@ember-data%2Fadapter" class="_attribution-link">https://api.emberjs.com/ember-data/4.9/modules/@ember-data%2Fadapter</a>
  </p>
</div>
