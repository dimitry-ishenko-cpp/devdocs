<div class="sphx-glr-download-link-note admonition note"> <p class="admonition-title">Note</p> <p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-multioutput-plot-classifier-chain-yeast-py"><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p> </div> <section class="sphx-glr-example-title" id="classifier-chain"> <h1 id="sphx-glr-auto-examples-multioutput-plot-classifier-chain-yeast-py">Classifier Chain</h1> <p>Example of using classifier chain on a multilabel dataset.</p> <p>For this example we will use the <a class="reference external" href="https://www.openml.org/d/40597">yeast</a> dataset which contains 2417 datapoints each with 103 features and 14 possible labels. Each data point has at least one label. As a baseline we first train a logistic regression classifier for each of the 14 labels. To evaluate the performance of these classifiers we predict on a held-out test set and calculate the <a class="reference internal" href="../../modules/model_evaluation.html#jaccard-similarity-score"><span class="std std-ref">jaccard score</span></a> for each sample.</p> <p>Next we create 10 classifier chains. Each classifier chain contains a logistic regression model for each of the 14 labels. The models in each chain are ordered randomly. In addition to the 103 features in the dataset, each model gets the predictions of the preceding models in the chain as features (note that by default at training time each model gets the true labels as features). These additional features allow each chain to exploit correlations among the classes. The Jaccard similarity score for each chain tends to be greater than that of the set independent logistic models.</p> <p>Because the models in each chain are arranged randomly there is significant variation in performance among the chains. Presumably there is an optimal ordering of the classes in a chain that will yield the best performance. However we do not know that ordering a priori. Instead we can construct an voting ensemble of classifier chains by averaging the binary predictions of the chains and apply a threshold of 0.5. The Jaccard similarity score of the ensemble is greater than that of the independent models and tends to exceed the score of each chain in the ensemble (although this is not guaranteed with randomly ordered chains).</p> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_classifier_chain_yeast_001.png" alt="Classifier Chain Ensemble Performance Comparison" class="sphx-glr-single-img"><pre data-language="python"># Author: Adam Kleczewski
# License: BSD 3 clause

import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import fetch_openml
from sklearn.multioutput import ClassifierChain
from sklearn.model_selection import train_test_split
from sklearn.multiclass import OneVsRestClassifier
from sklearn.metrics import jaccard_score
from sklearn.linear_model import LogisticRegression

# Load a multi-label dataset from https://www.openml.org/d/40597
X, Y = fetch_openml("yeast", version=4, return_X_y=True)
Y = Y == "TRUE"
X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.2, random_state=0)

# Fit an independent logistic regression model for each class using the
# OneVsRestClassifier wrapper.
base_lr = LogisticRegression()
ovr = OneVsRestClassifier(base_lr)
ovr.fit(X_train, Y_train)
Y_pred_ovr = ovr.predict(X_test)
ovr_jaccard_score = jaccard_score(Y_test, Y_pred_ovr, average="samples")

# Fit an ensemble of logistic regression classifier chains and take the
# take the average prediction of all the chains.
chains = [ClassifierChain(base_lr, order="random", random_state=i) for i in range(10)]
for chain in chains:
    chain.fit(X_train, Y_train)

Y_pred_chains = np.array([chain.predict(X_test) for chain in chains])
chain_jaccard_scores = [
    jaccard_score(Y_test, Y_pred_chain &gt;= 0.5, average="samples")
    for Y_pred_chain in Y_pred_chains
]

Y_pred_ensemble = Y_pred_chains.mean(axis=0)
ensemble_jaccard_score = jaccard_score(
    Y_test, Y_pred_ensemble &gt;= 0.5, average="samples"
)

model_scores = [ovr_jaccard_score] + chain_jaccard_scores
model_scores.append(ensemble_jaccard_score)

model_names = (
    "Independent",
    "Chain 1",
    "Chain 2",
    "Chain 3",
    "Chain 4",
    "Chain 5",
    "Chain 6",
    "Chain 7",
    "Chain 8",
    "Chain 9",
    "Chain 10",
    "Ensemble",
)

x_pos = np.arange(len(model_names))

# Plot the Jaccard similarity scores for the independent model, each of the
# chains, and the ensemble (note that the vertical axis on this plot does
# not begin at 0).

fig, ax = plt.subplots(figsize=(7, 4))
ax.grid(True)
ax.set_title("Classifier Chain Ensemble Performance Comparison")
ax.set_xticks(x_pos)
ax.set_xticklabels(model_names, rotation="vertical")
ax.set_ylabel("Jaccard Similarity Score")
ax.set_ylim([min(model_scores) * 0.9, max(model_scores) * 1.1])
colors = ["r"] + ["b"] * len(chain_jaccard_scores) + ["g"]
ax.bar(x_pos, model_scores, alpha=0.5, color=colors)
plt.tight_layout()
plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 10.037 seconds)</p> <div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-multioutput-plot-classifier-chain-yeast-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/1.1.X?urlpath=lab/tree/notebooks/auto_examples/multioutput/plot_classifier_chain_yeast.ipynb"><img alt="Launch binder" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA5IiBoZWlnaHQ9IjIwIj48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgyPSIwIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYmJiIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9ImEiPjxyZWN0IHdpZHRoPSIxMDkiIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoNjR2MjBIMHoiLz48cGF0aCBmaWxsPSIjNTc5YWNhIiBkPSJNNjQgMGg0NXYyMEg2NHoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMCAwaDEwOXYyMEgweiIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iRGVqYVZ1IFNhbnMsVmVyZGFuYSxHZW5ldmEsc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRmtBQUFCWkNBTUFBQUJpMVhpZEFBQUI4bEJNVkVYLy8vOVhtc3JtWllIMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sSlhtc3JtWllIMW9sTDFvbEwwbkZmMW9sSlhtc3JtWllIMW9sSlhtc3E4ZFpiMW9sSlhtc3JtWllIMW9sSlhtc3BYbXNwWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sTGVhSVZYbXNybVpZSDFvbEwxb2xMMW9sSlhtc3JtWllIMW9sTG5hMzFYbXNyMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xMcW9WcjFvbEpYbXNyMW9sSlhtc3JtWllIMW9sTDFvbEtrZmFQb2JYdnZpR2FiZ2FkWG1zcVRoS3VvZktIbVo0RG9ibnIxb2xKWG1zcjFvbEpYbXNwWG1zcjFvbEpYbXNyZlo0VHVoV24xb2xMMW9sSlhtc3FCaTdYMW9sSlhtc3BabXNsYm1NaGJtc2RlbXNWZmw4Wmdtc05pbThKcGs4RjBtN1I0bTdGNW5MQjZqYmg3amJpRGlyT0VpYk9HbkthTWhxK1BuYUNWZzZxV2c2cWVnS2FmZjZXaG5wS29mS0d0bm9teGVaeTNub0c2ZFppK24zdkNjcFBEY3BQR24zYkxiNC9NYjQ3VWJJclZhNHJZb0dqZGFJYmVhSVhob1dIbVpZSG9iWHZwY0hqcWRIWHJlSExyb1Zyc2ZHL3VoR251aDJid2oySHhrMTd5bDF2em1sanptMWowbmxYMW9sTDNBSlhXQUFBQWJYUlNUbE1BRUJBUUh4OGdJQ0F1TGpBd01EdzlQVUJBUUVwUVVGQlhWMWhnWUdCa2NIQndjWGw4Z0lDQWdvaUlrSkNRbEppY25KMmdvS0NtcUsrd3NMQzR1c0RBd01qUDBORFExTmJXM056ZzRPRGk1KzN2OFBEdzgvVDA5UFgyOXZiMzkvZjUrZnI3Ky96OC9QejkvdjcremN6Q3hnQUFCQzVKUkVGVWVBSE4xdWwzazBVVUJ2Q2IxQ1RWcG1wYWl0QUdTTFNwU3VLQ0xXcGJUS05KRkdsY1NNQUZGNjNpVW1SY2NORzZnTGJ1eGtYVTY2SkFVZWYvOUxTcG1YbnlMcjNUNUFPL3J6bDV6ajEzN3AxMzZCSVN5NDRmS0pYdUdOL2QxOVBVZlllTzY3Wm5xdGYyS0gzM0lkMXBzWG9GZFczMHNQWjFzTXZzMkQwNjBBSHF3czRGSGVKb2pMWnFudzUzY21mdmcrWFI4bUMwT0VqdXhyWEVrWDV5ZGVWSkxWSWxWMGUxMFBYazVrN2RZZUh1N0NqMWorNDl1S2c3dUxVNjF0R0x3MWxxMjd1Z1FZbGNsSEM0Ymd2N1ZRK1RBeWo1WmMvVWpzUHZzMXNkNWNXcnlXT2J0dldUMkVQYTRydG5XVzNKa3BqZ2dFcGJPc1ByN0Y3RXlOZXd0cEJJc2xBN3A0M0hDc253b29YVEVjM1VtUG1DTm41bHJxVEp4eTZuUm1jYXZHWlZ0LzNEYTJwRDVOSHZzT0hKQ3JkYzFHMnIzRElUcFU3eWljN3cvN1J4bmpjMGt0NUdDNGRqaXYyU3ozRmIyaUVaZzQxL2Rkc0ZEb3l1WXJJa21GZWh6MEhSMnRoUGdRcU15UVliMk90QjBXeHNaM0JlRzMrd3BSYjF2emwyVVlCb2c4RmZHaHR0RktqdEFjbG5aWXJSbzlyeUc5dUcvRlpRVTRBRWc4WkU5TGpHTXpUbXFLWFBMbmxXVm5JbFFRVHZ4SmY4aXA3VmdqWmp5VlByancxdGU1b3RNN1JtUDd4bStzSzJHdjlJOEdpKytCUmJFa1I5RUJ3OHpSVWNLeHdwNzN4a2FMaXFRYitrR2R1SlROSEc3MnpjVzlMb0pncVF4cFAzL1RqLy9jM3lCMHRxemFtbDA1LytvckhMa3NWTys5NWtYNy83cWdKdm5qbHJmcjJHZ3N5eDBlb3k5dVB6TjVTUGQ4NmFYZ2dPc0VLVzJQcno3ZHUzVklEMy90enMvc1NSczJ3N292VkhLdGpyWDJwZDdaTWxUeEFZZkJBTDlqaUR3ZkxrcTU1VG03aWZoTWxUR1B5Q0FzN1JGUmhuNDdKbmxjQjlSTTVUOTdBU3VaWEljVk51VURJbmRwRGJkc2ZycXNPcHBlWGw1WStYVktkakZDVGgrekdhVnVqMGQ5enkwNVBQSzNRekJhbXhkd3RUQ3J6eWcvMlJ2ZjJFc3RVam9yZEd3YS9reDltU0pMcjhtTEx0Q1c4SEhHSmMyUjVoUzIxOUlpRjZQblR1c09xY01sNTdnbTBaOGthbktNQVFnMHFTeXVaZm43ekl0c2JHeU85UWxueFkwZUN1RDFYTDJ5cy9Nc3JRaGx0RTdVZzB1Rk96dWZKRkUyUHhCby9ZQXg4WFBQZER3V04wTXJEUllJWkYwbVNNS0NOSGdhSVZGb0JiTm9MSjd0RVFES3hHRjBrY0xRaW1vakNab3B2ME9rTk95V0NDZzlYTVZBaTdBUkp6UWRNMlFVaDBnbUJvempjM1NrZzZkU0JScURHWVNVT3U2NlpnK0kyZk5acy9NMy9mL0dybC9YbnlGMUd3M1ZLQ2V6MFBONUlVZkZMcXZnVU40QzBxTnFZczVZaFBMK2FWWllERTRJcFVrNTdvU0ZuSm00RnlDcXFPRTBqaFkyU015TEZvbzU2enlvNmJlY09TNVVWRGRqN1ZpaDB6cCt0Y01od1JwQmVMeXF0SWpsSktBSVpTYkk4U0dTRjNrMHBBM21SNXRIdXdQRm9hN043cmVvcTJicUNzQWsxSHFDdTV1dkkxbjZKdVJYSStTMU1jbzU0WW1ZVHdjbjZBZWljK2tzc1hpOFhwWEM0VjN0Ny9BRHVUTkthUUpkU2NBQUFBQUVsRlRrU3VRbUNDIi8+IDx0ZXh0IHg9IjQxNSIgeT0iMTUwIiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzcwIj5sYXVuY2g8L3RleHQ+PHRleHQgeD0iNDE1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIzNzAiPmxhdW5jaDwvdGV4dD48dGV4dCB4PSI4NTUiIHk9IjE1MCIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9IjM1MCI+YmluZGVyPC90ZXh0Pjx0ZXh0IHg9Ijg1NSIgeT0iMTQwIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzUwIj5iaW5kZXI8L3RleHQ+PC9nPiA8L3N2Zz4=" width="150px"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/c6856243c97f58098e60fb14d2bf3750/plot_classifier_chain_yeast.py"><code>Download Python source code: plot_classifier_chain_yeast.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/05ca8a4e90b4cc2acd69f9e24b4a1f3a/plot_classifier_chain_yeast.ipynb"><code>Download Jupyter notebook: plot_classifier_chain_yeast.ipynb</code></a></p> </div> </div>  </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2022 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.1/auto_examples/multioutput/plot_classifier_chain_yeast.html" class="_attribution-link">https://scikit-learn.org/1.1/auto_examples/multioutput/plot_classifier_chain_yeast.html</a>
  </p>
</div>
