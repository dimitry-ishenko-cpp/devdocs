<div class="sphx-glr-download-link-note admonition note"> <p class="admonition-title">Note</p> <p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-model-selection-plot-grid-search-refit-callable-py"><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p> </div> <section class="sphx-glr-example-title" id="balance-model-complexity-and-cross-validated-score"> <h1 id="sphx-glr-auto-examples-model-selection-plot-grid-search-refit-callable-py">Balance model complexity and cross-validated score</h1> <p>This example balances model complexity and cross-validated score by finding a decent accuracy within 1 standard deviation of the best accuracy score while minimising the number of PCA components [1].</p> <p>The figure shows the trade-off between cross-validated score and the number of PCA components. The balanced case is when n_components=10 and accuracy=0.88, which falls into the range within 1 standard deviation of the best accuracy score.</p> <p>[1] Hastie, T., Tibshirani, R.,, Friedman, J. (2001). Model Assessment and Selection. The Elements of Statistical Learning (pp. 219-260). New York, NY, USA: Springer New York Inc..</p> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_grid_search_refit_callable_001.png" alt="Balance model complexity and cross-validated score" class="sphx-glr-single-img"><pre data-language="none">The best_index_ is 2
The n_components selected is 10
The corresponding accuracy score is 0.88
</pre>  <pre data-language="python"># Author: Wenhao Zhang &lt;wenhaoz@ucla.edu&gt;

import numpy as np
import matplotlib.pyplot as plt

from sklearn.datasets import load_digits
from sklearn.decomposition import PCA
from sklearn.model_selection import GridSearchCV
from sklearn.pipeline import Pipeline
from sklearn.svm import LinearSVC


def lower_bound(cv_results):
    """
    Calculate the lower bound within 1 standard deviation
    of the best `mean_test_scores`.

    Parameters
    ----------
    cv_results : dict of numpy(masked) ndarrays
        See attribute cv_results_ of `GridSearchCV`

    Returns
    -------
    float
        Lower bound within 1 standard deviation of the
        best `mean_test_score`.
    """
    best_score_idx = np.argmax(cv_results["mean_test_score"])

    return (
        cv_results["mean_test_score"][best_score_idx]
        - cv_results["std_test_score"][best_score_idx]
    )


def best_low_complexity(cv_results):
    """
    Balance model complexity with cross-validated score.

    Parameters
    ----------
    cv_results : dict of numpy(masked) ndarrays
        See attribute cv_results_ of `GridSearchCV`.

    Return
    ------
    int
        Index of a model that has the fewest PCA components
        while has its test score within 1 standard deviation of the best
        `mean_test_score`.
    """
    threshold = lower_bound(cv_results)
    candidate_idx = np.flatnonzero(cv_results["mean_test_score"] &gt;= threshold)
    best_idx = candidate_idx[
        cv_results["param_reduce_dim__n_components"][candidate_idx].argmin()
    ]
    return best_idx


pipe = Pipeline(
    [
        ("reduce_dim", PCA(random_state=42)),
        ("classify", LinearSVC(random_state=42, C=0.01)),
    ]
)

param_grid = {"reduce_dim__n_components": [6, 8, 10, 12, 14]}

grid = GridSearchCV(
    pipe,
    cv=10,
    n_jobs=1,
    param_grid=param_grid,
    scoring="accuracy",
    refit=best_low_complexity,
)
X, y = load_digits(return_X_y=True)
grid.fit(X, y)

n_components = grid.cv_results_["param_reduce_dim__n_components"]
test_scores = grid.cv_results_["mean_test_score"]

plt.figure()
plt.bar(n_components, test_scores, width=1.3, color="b")

lower = lower_bound(grid.cv_results_)
plt.axhline(np.max(test_scores), linestyle="--", color="y", label="Best score")
plt.axhline(lower, linestyle="--", color=".5", label="Best score - 1 std")

plt.title("Balance model complexity and cross-validated score")
plt.xlabel("Number of PCA components used")
plt.ylabel("Digit classification accuracy")
plt.xticks(n_components.tolist())
plt.ylim((0, 1.0))
plt.legend(loc="upper left")

best_index_ = grid.best_index_

print("The best_index_ is %d" % best_index_)
print("The n_components selected is %d" % n_components[best_index_])
print(
    "The corresponding accuracy score is %.2f"
    % grid.cv_results_["mean_test_score"][best_index_]
)
plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 4.580 seconds)</p> <div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-model-selection-plot-grid-search-refit-callable-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/1.1.X?urlpath=lab/tree/notebooks/auto_examples/model_selection/plot_grid_search_refit_callable.ipynb"><img alt="Launch binder" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA5IiBoZWlnaHQ9IjIwIj48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgyPSIwIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYmJiIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9ImEiPjxyZWN0IHdpZHRoPSIxMDkiIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoNjR2MjBIMHoiLz48cGF0aCBmaWxsPSIjNTc5YWNhIiBkPSJNNjQgMGg0NXYyMEg2NHoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMCAwaDEwOXYyMEgweiIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iRGVqYVZ1IFNhbnMsVmVyZGFuYSxHZW5ldmEsc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRmtBQUFCWkNBTUFBQUJpMVhpZEFBQUI4bEJNVkVYLy8vOVhtc3JtWllIMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sSlhtc3JtWllIMW9sTDFvbEwwbkZmMW9sSlhtc3JtWllIMW9sSlhtc3E4ZFpiMW9sSlhtc3JtWllIMW9sSlhtc3BYbXNwWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sTGVhSVZYbXNybVpZSDFvbEwxb2xMMW9sSlhtc3JtWllIMW9sTG5hMzFYbXNyMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xMcW9WcjFvbEpYbXNyMW9sSlhtc3JtWllIMW9sTDFvbEtrZmFQb2JYdnZpR2FiZ2FkWG1zcVRoS3VvZktIbVo0RG9ibnIxb2xKWG1zcjFvbEpYbXNwWG1zcjFvbEpYbXNyZlo0VHVoV24xb2xMMW9sSlhtc3FCaTdYMW9sSlhtc3BabXNsYm1NaGJtc2RlbXNWZmw4Wmdtc05pbThKcGs4RjBtN1I0bTdGNW5MQjZqYmg3amJpRGlyT0VpYk9HbkthTWhxK1BuYUNWZzZxV2c2cWVnS2FmZjZXaG5wS29mS0d0bm9teGVaeTNub0c2ZFppK24zdkNjcFBEY3BQR24zYkxiNC9NYjQ3VWJJclZhNHJZb0dqZGFJYmVhSVhob1dIbVpZSG9iWHZwY0hqcWRIWHJlSExyb1Zyc2ZHL3VoR251aDJid2oySHhrMTd5bDF2em1sanptMWowbmxYMW9sTDNBSlhXQUFBQWJYUlNUbE1BRUJBUUh4OGdJQ0F1TGpBd01EdzlQVUJBUUVwUVVGQlhWMWhnWUdCa2NIQndjWGw4Z0lDQWdvaUlrSkNRbEppY25KMmdvS0NtcUsrd3NMQzR1c0RBd01qUDBORFExTmJXM056ZzRPRGk1KzN2OFBEdzgvVDA5UFgyOXZiMzkvZjUrZnI3Ky96OC9QejkvdjcremN6Q3hnQUFCQzVKUkVGVWVBSE4xdWwzazBVVUJ2Q2IxQ1RWcG1wYWl0QUdTTFNwU3VLQ0xXcGJUS05KRkdsY1NNQUZGNjNpVW1SY2NORzZnTGJ1eGtYVTY2SkFVZWYvOUxTcG1YbnlMcjNUNUFPL3J6bDV6ajEzN3AxMzZCSVN5NDRmS0pYdUdOL2QxOVBVZlllTzY3Wm5xdGYyS0gzM0lkMXBzWG9GZFczMHNQWjFzTXZzMkQwNjBBSHF3czRGSGVKb2pMWnFudzUzY21mdmcrWFI4bUMwT0VqdXhyWEVrWDV5ZGVWSkxWSWxWMGUxMFBYazVrN2RZZUh1N0NqMWorNDl1S2c3dUxVNjF0R0x3MWxxMjd1Z1FZbGNsSEM0Ymd2N1ZRK1RBeWo1WmMvVWpzUHZzMXNkNWNXcnlXT2J0dldUMkVQYTRydG5XVzNKa3BqZ2dFcGJPc1ByN0Y3RXlOZXd0cEJJc2xBN3A0M0hDc253b29YVEVjM1VtUG1DTm41bHJxVEp4eTZuUm1jYXZHWlZ0LzNEYTJwRDVOSHZzT0hKQ3JkYzFHMnIzRElUcFU3eWljN3cvN1J4bmpjMGt0NUdDNGRqaXYyU3ozRmIyaUVaZzQxL2Rkc0ZEb3l1WXJJa21GZWh6MEhSMnRoUGdRcU15UVliMk90QjBXeHNaM0JlRzMrd3BSYjF2emwyVVlCb2c4RmZHaHR0RktqdEFjbG5aWXJSbzlyeUc5dUcvRlpRVTRBRWc4WkU5TGpHTXpUbXFLWFBMbmxXVm5JbFFRVHZ4SmY4aXA3VmdqWmp5VlByancxdGU1b3RNN1JtUDd4bStzSzJHdjlJOEdpKytCUmJFa1I5RUJ3OHpSVWNLeHdwNzN4a2FMaXFRYitrR2R1SlROSEc3MnpjVzlMb0pncVF4cFAzL1RqLy9jM3lCMHRxemFtbDA1LytvckhMa3NWTys5NWtYNy83cWdKdm5qbHJmcjJHZ3N5eDBlb3k5dVB6TjVTUGQ4NmFYZ2dPc0VLVzJQcno3ZHUzVklEMy90enMvc1NSczJ3N292VkhLdGpyWDJwZDdaTWxUeEFZZkJBTDlqaUR3ZkxrcTU1VG03aWZoTWxUR1B5Q0FzN1JGUmhuNDdKbmxjQjlSTTVUOTdBU3VaWEljVk51VURJbmRwRGJkc2ZycXNPcHBlWGw1WStYVktkakZDVGgrekdhVnVqMGQ5enkwNVBQSzNRekJhbXhkd3RUQ3J6eWcvMlJ2ZjJFc3RVam9yZEd3YS9reDltU0pMcjhtTEx0Q1c4SEhHSmMyUjVoUzIxOUlpRjZQblR1c09xY01sNTdnbTBaOGthbktNQVFnMHFTeXVaZm43ekl0c2JHeU85UWxueFkwZUN1RDFYTDJ5cy9Nc3JRaGx0RTdVZzB1Rk96dWZKRkUyUHhCby9ZQXg4WFBQZER3V04wTXJEUllJWkYwbVNNS0NOSGdhSVZGb0JiTm9MSjd0RVFES3hHRjBrY0xRaW1vakNab3B2ME9rTk95V0NDZzlYTVZBaTdBUkp6UWRNMlFVaDBnbUJvempjM1NrZzZkU0JScURHWVNVT3U2NlpnK0kyZk5acy9NMy9mL0dybC9YbnlGMUd3M1ZLQ2V6MFBONUlVZkZMcXZnVU40QzBxTnFZczVZaFBMK2FWWllERTRJcFVrNTdvU0ZuSm00RnlDcXFPRTBqaFkyU015TEZvbzU2enlvNmJlY09TNVVWRGRqN1ZpaDB6cCt0Y01od1JwQmVMeXF0SWpsSktBSVpTYkk4U0dTRjNrMHBBM21SNXRIdXdQRm9hN043cmVvcTJicUNzQWsxSHFDdTV1dkkxbjZKdVJYSStTMU1jbzU0WW1ZVHdjbjZBZWljK2tzc1hpOFhwWEM0VjN0Ny9BRHVUTkthUUpkU2NBQUFBQUVsRlRrU3VRbUNDIi8+IDx0ZXh0IHg9IjQxNSIgeT0iMTUwIiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzcwIj5sYXVuY2g8L3RleHQ+PHRleHQgeD0iNDE1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIzNzAiPmxhdW5jaDwvdGV4dD48dGV4dCB4PSI4NTUiIHk9IjE1MCIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9IjM1MCI+YmluZGVyPC90ZXh0Pjx0ZXh0IHg9Ijg1NSIgeT0iMTQwIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzUwIj5iaW5kZXI8L3RleHQ+PC9nPiA8L3N2Zz4=" width="150px"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/02d88d76c60b7397c8c6e221b31568dd/plot_grid_search_refit_callable.py"><code>Download Python source code: plot_grid_search_refit_callable.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/af8345a01f32fc7a8b3c9693bb4aca30/plot_grid_search_refit_callable.ipynb"><code>Download Jupyter notebook: plot_grid_search_refit_callable.ipynb</code></a></p> </div> </div>  </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2022 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.1/auto_examples/model_selection/plot_grid_search_refit_callable.html" class="_attribution-link">https://scikit-learn.org/1.1/auto_examples/model_selection/plot_grid_search_refit_callable.html</a>
  </p>
</div>
