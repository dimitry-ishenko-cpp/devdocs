<div class="sphx-glr-download-link-note admonition note"> <p class="admonition-title">Note</p> <p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-neighbors-plot-nca-illustration-py"><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p> </div> <section class="sphx-glr-example-title" id="neighborhood-components-analysis-illustration"> <h1 id="sphx-glr-auto-examples-neighbors-plot-nca-illustration-py">Neighborhood Components Analysis Illustration</h1> <p>This example illustrates a learned distance metric that maximizes the nearest neighbors classification accuracy. It provides a visual representation of this metric compared to the original point space. Please refer to the <a class="reference internal" href="../../modules/neighbors.html#nca"><span class="std std-ref">User Guide</span></a> for more information.</p> <pre data-language="python"># License: BSD 3 clause

import numpy as np
import matplotlib.pyplot as plt
from sklearn.datasets import make_classification
from sklearn.neighbors import NeighborhoodComponentsAnalysis
from matplotlib import cm
from scipy.special import logsumexp
</pre> <section id="original-points"> <h2>Original points</h2> <p>First we create a data set of 9 samples from 3 classes, and plot the points in the original space. For this example, we focus on the classification of point no. 3. The thickness of a link between point no. 3 and another point is proportional to their distance.</p> <pre data-language="python">X, y = make_classification(
    n_samples=9,
    n_features=2,
    n_informative=2,
    n_redundant=0,
    n_classes=3,
    n_clusters_per_class=1,
    class_sep=1.0,
    random_state=0,
)

plt.figure(1)
ax = plt.gca()
for i in range(X.shape[0]):
    ax.text(X[i, 0], X[i, 1], str(i), va="center", ha="center")
    ax.scatter(X[i, 0], X[i, 1], s=300, c=cm.Set1(y[[i]]), alpha=0.4)

ax.set_title("Original points")
ax.axes.get_xaxis().set_visible(False)
ax.axes.get_yaxis().set_visible(False)
ax.axis("equal")  # so that boundaries are displayed correctly as circles


def link_thickness_i(X, i):
    diff_embedded = X[i] - X
    dist_embedded = np.einsum("ij,ij-&gt;i", diff_embedded, diff_embedded)
    dist_embedded[i] = np.inf

    # compute exponentiated distances (use the log-sum-exp trick to
    # avoid numerical instabilities
    exp_dist_embedded = np.exp(-dist_embedded - logsumexp(-dist_embedded))
    return exp_dist_embedded


def relate_point(X, i, ax):
    pt_i = X[i]
    for j, pt_j in enumerate(X):
        thickness = link_thickness_i(X, i)
        if i != j:
            line = ([pt_i[0], pt_j[0]], [pt_i[1], pt_j[1]])
            ax.plot(*line, c=cm.Set1(y[j]), linewidth=5 * thickness[j])


i = 3
relate_point(X, i, ax)
plt.show()
</pre> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_nca_illustration_001.png" alt="Original points" class="sphx-glr-single-img"></section> <section id="learning-an-embedding"> <h2>Learning an embedding</h2> <p>We use <a class="reference internal" href="../../modules/generated/sklearn.neighbors.neighborhoodcomponentsanalysis.html#sklearn.neighbors.NeighborhoodComponentsAnalysis" title="sklearn.neighbors.NeighborhoodComponentsAnalysis"><code>NeighborhoodComponentsAnalysis</code></a> to learn an embedding and plot the points after the transformation. We then take the embedding and find the nearest neighbors.</p> <pre data-language="python">nca = NeighborhoodComponentsAnalysis(max_iter=30, random_state=0)
nca = nca.fit(X, y)

plt.figure(2)
ax2 = plt.gca()
X_embedded = nca.transform(X)
relate_point(X_embedded, i, ax2)

for i in range(len(X)):
    ax2.text(X_embedded[i, 0], X_embedded[i, 1], str(i), va="center", ha="center")
    ax2.scatter(X_embedded[i, 0], X_embedded[i, 1], s=300, c=cm.Set1(y[[i]]), alpha=0.4)

ax2.set_title("NCA embedding")
ax2.axes.get_xaxis().set_visible(False)
ax2.axes.get_yaxis().set_visible(False)
ax2.axis("equal")
plt.show()
</pre> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_nca_illustration_002.png" alt="NCA embedding" class="sphx-glr-single-img"><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 0.149 seconds)</p> <div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-neighbors-plot-nca-illustration-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/1.1.X?urlpath=lab/tree/notebooks/auto_examples/neighbors/plot_nca_illustration.ipynb"><img alt="Launch binder" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA5IiBoZWlnaHQ9IjIwIj48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgyPSIwIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYmJiIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9ImEiPjxyZWN0IHdpZHRoPSIxMDkiIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoNjR2MjBIMHoiLz48cGF0aCBmaWxsPSIjNTc5YWNhIiBkPSJNNjQgMGg0NXYyMEg2NHoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMCAwaDEwOXYyMEgweiIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iRGVqYVZ1IFNhbnMsVmVyZGFuYSxHZW5ldmEsc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRmtBQUFCWkNBTUFBQUJpMVhpZEFBQUI4bEJNVkVYLy8vOVhtc3JtWllIMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sSlhtc3JtWllIMW9sTDFvbEwwbkZmMW9sSlhtc3JtWllIMW9sSlhtc3E4ZFpiMW9sSlhtc3JtWllIMW9sSlhtc3BYbXNwWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sTGVhSVZYbXNybVpZSDFvbEwxb2xMMW9sSlhtc3JtWllIMW9sTG5hMzFYbXNyMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xMcW9WcjFvbEpYbXNyMW9sSlhtc3JtWllIMW9sTDFvbEtrZmFQb2JYdnZpR2FiZ2FkWG1zcVRoS3VvZktIbVo0RG9ibnIxb2xKWG1zcjFvbEpYbXNwWG1zcjFvbEpYbXNyZlo0VHVoV24xb2xMMW9sSlhtc3FCaTdYMW9sSlhtc3BabXNsYm1NaGJtc2RlbXNWZmw4Wmdtc05pbThKcGs4RjBtN1I0bTdGNW5MQjZqYmg3amJpRGlyT0VpYk9HbkthTWhxK1BuYUNWZzZxV2c2cWVnS2FmZjZXaG5wS29mS0d0bm9teGVaeTNub0c2ZFppK24zdkNjcFBEY3BQR24zYkxiNC9NYjQ3VWJJclZhNHJZb0dqZGFJYmVhSVhob1dIbVpZSG9iWHZwY0hqcWRIWHJlSExyb1Zyc2ZHL3VoR251aDJid2oySHhrMTd5bDF2em1sanptMWowbmxYMW9sTDNBSlhXQUFBQWJYUlNUbE1BRUJBUUh4OGdJQ0F1TGpBd01EdzlQVUJBUUVwUVVGQlhWMWhnWUdCa2NIQndjWGw4Z0lDQWdvaUlrSkNRbEppY25KMmdvS0NtcUsrd3NMQzR1c0RBd01qUDBORFExTmJXM056ZzRPRGk1KzN2OFBEdzgvVDA5UFgyOXZiMzkvZjUrZnI3Ky96OC9QejkvdjcremN6Q3hnQUFCQzVKUkVGVWVBSE4xdWwzazBVVUJ2Q2IxQ1RWcG1wYWl0QUdTTFNwU3VLQ0xXcGJUS05KRkdsY1NNQUZGNjNpVW1SY2NORzZnTGJ1eGtYVTY2SkFVZWYvOUxTcG1YbnlMcjNUNUFPL3J6bDV6ajEzN3AxMzZCSVN5NDRmS0pYdUdOL2QxOVBVZlllTzY3Wm5xdGYyS0gzM0lkMXBzWG9GZFczMHNQWjFzTXZzMkQwNjBBSHF3czRGSGVKb2pMWnFudzUzY21mdmcrWFI4bUMwT0VqdXhyWEVrWDV5ZGVWSkxWSWxWMGUxMFBYazVrN2RZZUh1N0NqMWorNDl1S2c3dUxVNjF0R0x3MWxxMjd1Z1FZbGNsSEM0Ymd2N1ZRK1RBeWo1WmMvVWpzUHZzMXNkNWNXcnlXT2J0dldUMkVQYTRydG5XVzNKa3BqZ2dFcGJPc1ByN0Y3RXlOZXd0cEJJc2xBN3A0M0hDc253b29YVEVjM1VtUG1DTm41bHJxVEp4eTZuUm1jYXZHWlZ0LzNEYTJwRDVOSHZzT0hKQ3JkYzFHMnIzRElUcFU3eWljN3cvN1J4bmpjMGt0NUdDNGRqaXYyU3ozRmIyaUVaZzQxL2Rkc0ZEb3l1WXJJa21GZWh6MEhSMnRoUGdRcU15UVliMk90QjBXeHNaM0JlRzMrd3BSYjF2emwyVVlCb2c4RmZHaHR0RktqdEFjbG5aWXJSbzlyeUc5dUcvRlpRVTRBRWc4WkU5TGpHTXpUbXFLWFBMbmxXVm5JbFFRVHZ4SmY4aXA3VmdqWmp5VlByancxdGU1b3RNN1JtUDd4bStzSzJHdjlJOEdpKytCUmJFa1I5RUJ3OHpSVWNLeHdwNzN4a2FMaXFRYitrR2R1SlROSEc3MnpjVzlMb0pncVF4cFAzL1RqLy9jM3lCMHRxemFtbDA1LytvckhMa3NWTys5NWtYNy83cWdKdm5qbHJmcjJHZ3N5eDBlb3k5dVB6TjVTUGQ4NmFYZ2dPc0VLVzJQcno3ZHUzVklEMy90enMvc1NSczJ3N292VkhLdGpyWDJwZDdaTWxUeEFZZkJBTDlqaUR3ZkxrcTU1VG03aWZoTWxUR1B5Q0FzN1JGUmhuNDdKbmxjQjlSTTVUOTdBU3VaWEljVk51VURJbmRwRGJkc2ZycXNPcHBlWGw1WStYVktkakZDVGgrekdhVnVqMGQ5enkwNVBQSzNRekJhbXhkd3RUQ3J6eWcvMlJ2ZjJFc3RVam9yZEd3YS9reDltU0pMcjhtTEx0Q1c4SEhHSmMyUjVoUzIxOUlpRjZQblR1c09xY01sNTdnbTBaOGthbktNQVFnMHFTeXVaZm43ekl0c2JHeU85UWxueFkwZUN1RDFYTDJ5cy9Nc3JRaGx0RTdVZzB1Rk96dWZKRkUyUHhCby9ZQXg4WFBQZER3V04wTXJEUllJWkYwbVNNS0NOSGdhSVZGb0JiTm9MSjd0RVFES3hHRjBrY0xRaW1vakNab3B2ME9rTk95V0NDZzlYTVZBaTdBUkp6UWRNMlFVaDBnbUJvempjM1NrZzZkU0JScURHWVNVT3U2NlpnK0kyZk5acy9NMy9mL0dybC9YbnlGMUd3M1ZLQ2V6MFBONUlVZkZMcXZnVU40QzBxTnFZczVZaFBMK2FWWllERTRJcFVrNTdvU0ZuSm00RnlDcXFPRTBqaFkyU015TEZvbzU2enlvNmJlY09TNVVWRGRqN1ZpaDB6cCt0Y01od1JwQmVMeXF0SWpsSktBSVpTYkk4U0dTRjNrMHBBM21SNXRIdXdQRm9hN043cmVvcTJicUNzQWsxSHFDdTV1dkkxbjZKdVJYSStTMU1jbzU0WW1ZVHdjbjZBZWljK2tzc1hpOFhwWEM0VjN0Ny9BRHVUTkthUUpkU2NBQUFBQUVsRlRrU3VRbUNDIi8+IDx0ZXh0IHg9IjQxNSIgeT0iMTUwIiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzcwIj5sYXVuY2g8L3RleHQ+PHRleHQgeD0iNDE1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIzNzAiPmxhdW5jaDwvdGV4dD48dGV4dCB4PSI4NTUiIHk9IjE1MCIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9IjM1MCI+YmluZGVyPC90ZXh0Pjx0ZXh0IHg9Ijg1NSIgeT0iMTQwIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzUwIj5iaW5kZXI8L3RleHQ+PC9nPiA8L3N2Zz4=" width="150px"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/3c0067f1f85f236ccc8a25c1245347e8/plot_nca_illustration.py"><code>Download Python source code: plot_nca_illustration.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/19e9c0cb24a132133cef3b311caaf199/plot_nca_illustration.ipynb"><code>Download Jupyter notebook: plot_nca_illustration.ipynb</code></a></p> </div> </div>  </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2022 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.1/auto_examples/neighbors/plot_nca_illustration.html" class="_attribution-link">https://scikit-learn.org/1.1/auto_examples/neighbors/plot_nca_illustration.html</a>
  </p>
</div>
