<div class="sphx-glr-download-link-note admonition note"> <p class="admonition-title">Note</p> <p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-linear-model-plot-ols-py"><span class="std std-ref">here</span></a> to download the full example code or to run this example in your browser via Binder</p> </div> <section class="sphx-glr-example-title" id="linear-regression-example"> <h1 id="sphx-glr-auto-examples-linear-model-plot-ols-py">Linear Regression Example</h1> <p>The example below uses only the first feature of the <code>diabetes</code> dataset, in order to illustrate the data points within the two-dimensional plot. The straight line can be seen in the plot, showing how linear regression attempts to draw a straight line that will best minimize the residual sum of squares between the observed responses in the dataset, and the responses predicted by the linear approximation.</p> <p>The coefficients, residual sum of squares and the coefficient of determination are also calculated.</p> <img src="data:image/png;base64,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" srcset="../../_images/sphx_glr_plot_ols_001.png" alt="plot ols" class="sphx-glr-single-img"><pre data-language="none">Coefficients:
 [938.23786125]
Mean squared error: 2548.07
Coefficient of determination: 0.47
</pre>  <pre data-language="python"># Code source: Jaques Grobler
# License: BSD 3 clause

import matplotlib.pyplot as plt
import numpy as np
from sklearn import datasets, linear_model
from sklearn.metrics import mean_squared_error, r2_score

# Load the diabetes dataset
diabetes_X, diabetes_y = datasets.load_diabetes(return_X_y=True)

# Use only one feature
diabetes_X = diabetes_X[:, np.newaxis, 2]

# Split the data into training/testing sets
diabetes_X_train = diabetes_X[:-20]
diabetes_X_test = diabetes_X[-20:]

# Split the targets into training/testing sets
diabetes_y_train = diabetes_y[:-20]
diabetes_y_test = diabetes_y[-20:]

# Create linear regression object
regr = linear_model.LinearRegression()

# Train the model using the training sets
regr.fit(diabetes_X_train, diabetes_y_train)

# Make predictions using the testing set
diabetes_y_pred = regr.predict(diabetes_X_test)

# The coefficients
print("Coefficients: \n", regr.coef_)
# The mean squared error
print("Mean squared error: %.2f" % mean_squared_error(diabetes_y_test, diabetes_y_pred))
# The coefficient of determination: 1 is perfect prediction
print("Coefficient of determination: %.2f" % r2_score(diabetes_y_test, diabetes_y_pred))

# Plot outputs
plt.scatter(diabetes_X_test, diabetes_y_test, color="black")
plt.plot(diabetes_X_test, diabetes_y_pred, color="blue", linewidth=3)

plt.xticks(())
plt.yticks(())

plt.show()
</pre> <p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes 0.037 seconds)</p> <div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-linear-model-plot-ols-py"> <div class="binder-badge docutils container"> <a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-learn/scikit-learn/1.1.X?urlpath=lab/tree/notebooks/auto_examples/linear_model/plot_ols.ipynb"><img alt="Launch binder" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iMTA5IiBoZWlnaHQ9IjIwIj48bGluZWFyR3JhZGllbnQgaWQ9ImIiIHgyPSIwIiB5Mj0iMTAwJSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjYmJiIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLW9wYWNpdHk9Ii4xIi8+PC9saW5lYXJHcmFkaWVudD48Y2xpcFBhdGggaWQ9ImEiPjxyZWN0IHdpZHRoPSIxMDkiIGhlaWdodD0iMjAiIHJ4PSIzIiBmaWxsPSIjZmZmIi8+PC9jbGlwUGF0aD48ZyBjbGlwLXBhdGg9InVybCgjYSkiPjxwYXRoIGZpbGw9IiM1NTUiIGQ9Ik0wIDBoNjR2MjBIMHoiLz48cGF0aCBmaWxsPSIjNTc5YWNhIiBkPSJNNjQgMGg0NXYyMEg2NHoiLz48cGF0aCBmaWxsPSJ1cmwoI2IpIiBkPSJNMCAwaDEwOXYyMEgweiIvPjwvZz48ZyBmaWxsPSIjZmZmIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iRGVqYVZ1IFNhbnMsVmVyZGFuYSxHZW5ldmEsc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxMTAiPjxpbWFnZSB4PSI1IiB5PSIzIiB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHhsaW5rOmhyZWY9ImRhdGE6aW1hZ2UvcG5nO2Jhc2U2NCxpVkJPUncwS0dnb0FBQUFOU1VoRVVnQUFBRmtBQUFCWkNBTUFBQUJpMVhpZEFBQUI4bEJNVkVYLy8vOVhtc3JtWllIMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcjFvbEpYbXNybVpZSDFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sSlhtc3JtWllIMW9sTDFvbEwwbkZmMW9sSlhtc3JtWllIMW9sSlhtc3E4ZFpiMW9sSlhtc3JtWllIMW9sSlhtc3BYbXNwWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xKWG1zcjFvbEwxb2xKWG1zcm1aWUgxb2xMMW9sTGVhSVZYbXNybVpZSDFvbEwxb2xMMW9sSlhtc3JtWllIMW9sTG5hMzFYbXNyMW9sSlhtc3Ixb2xKWG1zcm1aWUgxb2xMcW9WcjFvbEpYbXNyMW9sSlhtc3JtWllIMW9sTDFvbEtrZmFQb2JYdnZpR2FiZ2FkWG1zcVRoS3VvZktIbVo0RG9ibnIxb2xKWG1zcjFvbEpYbXNwWG1zcjFvbEpYbXNyZlo0VHVoV24xb2xMMW9sSlhtc3FCaTdYMW9sSlhtc3BabXNsYm1NaGJtc2RlbXNWZmw4Wmdtc05pbThKcGs4RjBtN1I0bTdGNW5MQjZqYmg3amJpRGlyT0VpYk9HbkthTWhxK1BuYUNWZzZxV2c2cWVnS2FmZjZXaG5wS29mS0d0bm9teGVaeTNub0c2ZFppK24zdkNjcFBEY3BQR24zYkxiNC9NYjQ3VWJJclZhNHJZb0dqZGFJYmVhSVhob1dIbVpZSG9iWHZwY0hqcWRIWHJlSExyb1Zyc2ZHL3VoR251aDJid2oySHhrMTd5bDF2em1sanptMWowbmxYMW9sTDNBSlhXQUFBQWJYUlNUbE1BRUJBUUh4OGdJQ0F1TGpBd01EdzlQVUJBUUVwUVVGQlhWMWhnWUdCa2NIQndjWGw4Z0lDQWdvaUlrSkNRbEppY25KMmdvS0NtcUsrd3NMQzR1c0RBd01qUDBORFExTmJXM056ZzRPRGk1KzN2OFBEdzgvVDA5UFgyOXZiMzkvZjUrZnI3Ky96OC9QejkvdjcremN6Q3hnQUFCQzVKUkVGVWVBSE4xdWwzazBVVUJ2Q2IxQ1RWcG1wYWl0QUdTTFNwU3VLQ0xXcGJUS05KRkdsY1NNQUZGNjNpVW1SY2NORzZnTGJ1eGtYVTY2SkFVZWYvOUxTcG1YbnlMcjNUNUFPL3J6bDV6ajEzN3AxMzZCSVN5NDRmS0pYdUdOL2QxOVBVZlllTzY3Wm5xdGYyS0gzM0lkMXBzWG9GZFczMHNQWjFzTXZzMkQwNjBBSHF3czRGSGVKb2pMWnFudzUzY21mdmcrWFI4bUMwT0VqdXhyWEVrWDV5ZGVWSkxWSWxWMGUxMFBYazVrN2RZZUh1N0NqMWorNDl1S2c3dUxVNjF0R0x3MWxxMjd1Z1FZbGNsSEM0Ymd2N1ZRK1RBeWo1WmMvVWpzUHZzMXNkNWNXcnlXT2J0dldUMkVQYTRydG5XVzNKa3BqZ2dFcGJPc1ByN0Y3RXlOZXd0cEJJc2xBN3A0M0hDc253b29YVEVjM1VtUG1DTm41bHJxVEp4eTZuUm1jYXZHWlZ0LzNEYTJwRDVOSHZzT0hKQ3JkYzFHMnIzRElUcFU3eWljN3cvN1J4bmpjMGt0NUdDNGRqaXYyU3ozRmIyaUVaZzQxL2Rkc0ZEb3l1WXJJa21GZWh6MEhSMnRoUGdRcU15UVliMk90QjBXeHNaM0JlRzMrd3BSYjF2emwyVVlCb2c4RmZHaHR0RktqdEFjbG5aWXJSbzlyeUc5dUcvRlpRVTRBRWc4WkU5TGpHTXpUbXFLWFBMbmxXVm5JbFFRVHZ4SmY4aXA3VmdqWmp5VlByancxdGU1b3RNN1JtUDd4bStzSzJHdjlJOEdpKytCUmJFa1I5RUJ3OHpSVWNLeHdwNzN4a2FMaXFRYitrR2R1SlROSEc3MnpjVzlMb0pncVF4cFAzL1RqLy9jM3lCMHRxemFtbDA1LytvckhMa3NWTys5NWtYNy83cWdKdm5qbHJmcjJHZ3N5eDBlb3k5dVB6TjVTUGQ4NmFYZ2dPc0VLVzJQcno3ZHUzVklEMy90enMvc1NSczJ3N292VkhLdGpyWDJwZDdaTWxUeEFZZkJBTDlqaUR3ZkxrcTU1VG03aWZoTWxUR1B5Q0FzN1JGUmhuNDdKbmxjQjlSTTVUOTdBU3VaWEljVk51VURJbmRwRGJkc2ZycXNPcHBlWGw1WStYVktkakZDVGgrekdhVnVqMGQ5enkwNVBQSzNRekJhbXhkd3RUQ3J6eWcvMlJ2ZjJFc3RVam9yZEd3YS9reDltU0pMcjhtTEx0Q1c4SEhHSmMyUjVoUzIxOUlpRjZQblR1c09xY01sNTdnbTBaOGthbktNQVFnMHFTeXVaZm43ekl0c2JHeU85UWxueFkwZUN1RDFYTDJ5cy9Nc3JRaGx0RTdVZzB1Rk96dWZKRkUyUHhCby9ZQXg4WFBQZER3V04wTXJEUllJWkYwbVNNS0NOSGdhSVZGb0JiTm9MSjd0RVFES3hHRjBrY0xRaW1vakNab3B2ME9rTk95V0NDZzlYTVZBaTdBUkp6UWRNMlFVaDBnbUJvempjM1NrZzZkU0JScURHWVNVT3U2NlpnK0kyZk5acy9NMy9mL0dybC9YbnlGMUd3M1ZLQ2V6MFBONUlVZkZMcXZnVU40QzBxTnFZczVZaFBMK2FWWllERTRJcFVrNTdvU0ZuSm00RnlDcXFPRTBqaFkyU015TEZvbzU2enlvNmJlY09TNVVWRGRqN1ZpaDB6cCt0Y01od1JwQmVMeXF0SWpsSktBSVpTYkk4U0dTRjNrMHBBM21SNXRIdXdQRm9hN043cmVvcTJicUNzQWsxSHFDdTV1dkkxbjZKdVJYSStTMU1jbzU0WW1ZVHdjbjZBZWljK2tzc1hpOFhwWEM0VjN0Ny9BRHVUTkthUUpkU2NBQUFBQUVsRlRrU3VRbUNDIi8+IDx0ZXh0IHg9IjQxNSIgeT0iMTUwIiBmaWxsPSIjMDEwMTAxIiBmaWxsLW9wYWNpdHk9Ii4zIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzcwIj5sYXVuY2g8L3RleHQ+PHRleHQgeD0iNDE1IiB5PSIxNDAiIHRyYW5zZm9ybT0ic2NhbGUoLjEpIiB0ZXh0TGVuZ3RoPSIzNzAiPmxhdW5jaDwvdGV4dD48dGV4dCB4PSI4NTUiIHk9IjE1MCIgZmlsbD0iIzAxMDEwMSIgZmlsbC1vcGFjaXR5PSIuMyIgdHJhbnNmb3JtPSJzY2FsZSguMSkiIHRleHRMZW5ndGg9IjM1MCI+YmluZGVyPC90ZXh0Pjx0ZXh0IHg9Ijg1NSIgeT0iMTQwIiB0cmFuc2Zvcm09InNjYWxlKC4xKSIgdGV4dExlbmd0aD0iMzUwIj5iaW5kZXI8L3RleHQ+PC9nPiA8L3N2Zz4=" width="150px"></a> </div> <div class="sphx-glr-download sphx-glr-download-python docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/5ff7ffaf8076af51ffb8c5732f697c8e/plot_ols.py"><code>Download Python source code: plot_ols.py</code></a></p> </div> <div class="sphx-glr-download sphx-glr-download-jupyter docutils container"> <p><a class="reference download internal" download="" href="https://scikit-learn.org/1.1/_downloads/ee7c3a1966ea76f4980405cbc44de6da/plot_ols.ipynb"><code>Download Jupyter notebook: plot_ols.ipynb</code></a></p> </div> </div>  </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2022 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.1/auto_examples/linear_model/plot_ols.html" class="_attribution-link">https://scikit-learn.org/1.1/auto_examples/linear_model/plot_ols.html</a>
  </p>
</div>
