<section id="sklearn-utils-resample"> <h1>sklearn.utils.resample</h1> <dl class="py function"> <dt class="sig sig-object py" id="sklearn.utils.resample"> <span class="sig-prename descclassname">sklearn.utils.</span><span class="sig-name descname">resample</span><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">arrays</span></em>, <em class="sig-param"><span class="n">replace</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n_samples</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">random_state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">stratify</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/f3f51f9b6/sklearn/utils/__init__.py#L435"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Resample arrays or sparse matrices in a consistent way.</p> <p>The default strategy implements one step of the bootstrapping procedure.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>*arrays</strong><span class="classifier">sequence of array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</dt>
<dd>
<p>Indexable data-structures can be arrays, lists, dataframes or scipy sparse matrices with consistent first dimension.</p> </dd> <dt>
<strong>replace</strong><span class="classifier">bool, default=True</span>
</dt>
<dd>
<p>Implements resampling with replacement. If False, this will implement (sliced) random permutations.</p> </dd> <dt>
<strong>n_samples</strong><span class="classifier">int, default=None</span>
</dt>
<dd>
<p>Number of samples to generate. If left to None this is automatically set to the first dimension of the arrays. If replace is False it should not be larger than the length of arrays.</p> </dd> <dt>
<strong>random_state</strong><span class="classifier">int, RandomState instance or None, default=None</span>
</dt>
<dd>
<p>Determines random number generation for shuffling the data. Pass an int for reproducible results across multiple function calls. See <a class="reference internal" href="https://scikit-learn.org/1.1/glossary.html#term-random_state"><span class="xref std std-term">Glossary</span></a>.</p> </dd> <dt>
<strong>stratify</strong><span class="classifier">array-like of shape (n_samples,) or (n_samples, n_outputs), default=None</span>
</dt>
<dd>
<p>If not None, data is split in a stratified fashion, using this as the class labels.</p> </dd> </dl> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<dl class="simple"> <dt>
<strong>resampled_arrays</strong><span class="classifier">sequence of array-like of shape (n_samples,) or (n_samples, n_outputs)</span>
</dt>
<dd>
<p>Sequence of resampled copies of the collections. The original arrays are not impacted.</p> </dd> </dl> </dd> </dl> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="sklearn.utils.shuffle.html#sklearn.utils.shuffle" title="sklearn.utils.shuffle"><code>shuffle</code></a></dt>
<dd>
<p>Shuffle arrays or sparse matrices in a consistent way.</p> </dd> </dl> </div> <h4 class="rubric">Examples</h4> <p>It is possible to mix sparse and dense arrays in the same run:</p> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; X = np.array([[1., 0.], [2., 1.], [0., 0.]])
&gt;&gt;&gt; y = np.array([0, 1, 2])

&gt;&gt;&gt; from scipy.sparse import coo_matrix
&gt;&gt;&gt; X_sparse = coo_matrix(X)

&gt;&gt;&gt; from sklearn.utils import resample
&gt;&gt;&gt; X, X_sparse, y = resample(X, X_sparse, y, random_state=0)
&gt;&gt;&gt; X
array([[1., 0.],
       [2., 1.],
       [1., 0.]])

&gt;&gt;&gt; X_sparse
&lt;3x2 sparse matrix of type '&lt;... 'numpy.float64'&gt;'
    with 4 stored elements in Compressed Sparse Row format&gt;

&gt;&gt;&gt; X_sparse.toarray()
array([[1., 0.],
       [2., 1.],
       [1., 0.]])

&gt;&gt;&gt; y
array([0, 1, 0])

&gt;&gt;&gt; resample(y, n_samples=2, random_state=0)
array([0, 1])
</pre> <p>Example using stratification:</p> <pre data-language="python">&gt;&gt;&gt; y = [0, 0, 1, 1, 1, 1, 1, 1, 1]
&gt;&gt;&gt; resample(y, n_samples=5, replace=False, stratify=y,
...          random_state=0)
[1, 1, 1, 0, 1]
</pre> </dd>
</dl> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2022 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.1/modules/generated/sklearn.utils.resample.html" class="_attribution-link">https://scikit-learn.org/1.1/modules/generated/sklearn.utils.resample.html</a>
  </p>
</div>
