<section id="oas"> <h1>oas</h1> <dl class="py function"> <dt class="sig sig-object py" id="sklearn.covariance.oas"> <span class="sig-prename descclassname">sklearn.covariance.</span><span class="sig-name descname">oas</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">X</span></em>, <em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">assume_centered</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/99bf3d8e4/sklearn/covariance/_shrunk_covariance.py#L616"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Estimate covariance with the Oracle Approximating Shrinkage.</p> <p>Read more in the <a class="reference internal" href="../covariance.html#shrunk-covariance"><span class="std std-ref">User Guide</span></a>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<dl class="simple"> <dt>
<strong>X</strong><span class="classifier">array-like of shape (n_samples, n_features)</span>
</dt>
<dd>
<p>Data from which to compute the covariance estimate.</p> </dd> <dt>
<strong>assume_centered</strong><span class="classifier">bool, default=False</span>
</dt>
<dd>
<p>If True, data will not be centered before computation. Useful to work with data whose mean is significantly equal to zero but is not exactly zero. If False, data will be centered before computation.</p> </dd> </dl> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<dl class="simple"> <dt>
<strong>shrunk_cov</strong><span class="classifier">array-like of shape (n_features, n_features)</span>
</dt>
<dd>
<p>Shrunk covariance.</p> </dd> <dt>
<strong>shrinkage</strong><span class="classifier">float</span>
</dt>
<dd>
<p>Coefficient in the convex combination used for the computation of the shrunk estimate.</p> </dd> </dl> </dd> </dl> <h4 class="rubric">Notes</h4> <p>The regularised covariance is:</p> <p>(1 - shrinkage) * cov + shrinkage * mu * np.identity(n_features),</p> <p>where mu = trace(cov) / n_features and shrinkage is given by the OAS formula (see <a class="reference internal" href="#rca3a42e5ec35-1" id="id1">[1]</a>).</p> <p>The shrinkage formulation implemented here differs from Eq. 23 in <a class="reference internal" href="#rca3a42e5ec35-1" id="id2">[1]</a>. In the original article, formula (23) states that 2/p (p being the number of features) is multiplied by Trace(cov*cov) in both the numerator and denominator, but this operation is omitted because for a large p, the value of 2/p is so small that it doesn’t affect the value of the estimator.</p> <h4 class="rubric">References</h4> <div role="list" class="citation-list"> <div class="citation" id="rca3a42e5ec35-1" role="doc-biblioentry"> <span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span> <span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id2">2</a>)</span> <p><a class="reference external" href="https://arxiv.org/abs/0907.4698">“Shrinkage algorithms for MMSE covariance estimation.”, Chen, Y., Wiesel, A., Eldar, Y. C., &amp; Hero, A. O. IEEE Transactions on Signal Processing, 58(10), 5016-5029, 2010.</a></p> </div> </div> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.covariance import oas
&gt;&gt;&gt; rng = np.random.RandomState(0)
&gt;&gt;&gt; real_cov = [[.8, .3], [.3, .4]]
&gt;&gt;&gt; X = rng.multivariate_normal(mean=[0, 0], cov=real_cov, size=500)
&gt;&gt;&gt; shrunk_cov, shrinkage = oas(X)
&gt;&gt;&gt; shrunk_cov
array([[0.7533..., 0.2763...],
       [0.2763..., 0.3964...]])
&gt;&gt;&gt; shrinkage
np.float64(0.0195...)
</pre> </dd>
</dl> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2025 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.6/modules/generated/oas-function.html" class="_attribution-link">https://scikit-learn.org/1.6/modules/generated/oas-function.html</a>
  </p>
</div>
