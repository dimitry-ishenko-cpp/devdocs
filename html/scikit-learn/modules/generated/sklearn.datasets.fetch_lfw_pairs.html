<section id="fetch-lfw-pairs"> <h1>fetch_lfw_pairs</h1> <dl class="py function"> <dt class="sig sig-object py" id="sklearn.datasets.fetch_lfw_pairs"> <span class="sig-prename descclassname">sklearn.datasets.</span><span class="sig-name descname">fetch_lfw_pairs</span><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">subset</span><span class="o">=</span><span class="default_value">'train'</span></em>, <em class="sig-param"><span class="n">data_home</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">funneled</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">resize</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">color</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">slice_</span><span class="o">=</span><span class="default_value">(slice(70, 195, None), slice(78, 172, None))</span></em>, <em class="sig-param"><span class="n">download_if_missing</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">n_retries</span><span class="o">=</span><span class="default_value">3</span></em>, <em class="sig-param"><span class="n">delay</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/scikit-learn/scikit-learn/blob/99bf3d8e4/sklearn/datasets/_lfw.py#L477"><span class="viewcode-link">[source]</span></a>
</dt> <dd>
<p>Load the Labeled Faces in the Wild (LFW) pairs dataset (classification).</p> <p>Download it if necessary.</p> <div class="pst-scrollable-table-container">
<table class="table">  <tr>
<td><p>Classes</p></td> <td><p>2</p></td> </tr> <tr>
<td><p>Samples total</p></td> <td><p>13233</p></td> </tr> <tr>
<td><p>Dimensionality</p></td> <td><p>5828</p></td> </tr> <tr>
<td><p>Features</p></td> <td><p>real, between 0 and 255</p></td> </tr>  </table> </div> <p>In the official <a class="reference external" href="http://vis-www.cs.umass.edu/lfw/README.txt">README.txt</a> this task is described as the “Restricted” task. As I am not sure as to implement the “Unrestricted” variant correctly, I left it as unsupported for now.</p> <p>The original images are 250 x 250 pixels, but the default slice and resize arguments reduce them to 62 x 47.</p> <p>Read more in the <a class="reference internal" href="https://scikit-learn.org/1.6/datasets/real_world.html#labeled-faces-in-the-wild-dataset"><span class="std std-ref">User Guide</span></a>.</p> <dl class="field-list"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<dl> <dt>
<strong>subset</strong><span class="classifier">{‘train’, ‘test’, ‘10_folds’}, default=’train’</span>
</dt>
<dd>
<p>Select the dataset to load: ‘train’ for the development training set, ‘test’ for the development test set, and ‘10_folds’ for the official evaluation set that is meant to be used with a 10-folds cross validation.</p> </dd> <dt>
<strong>data_home</strong><span class="classifier">str or path-like, default=None</span>
</dt>
<dd>
<p>Specify another download and cache folder for the datasets. By default all scikit-learn data is stored in ‘~/scikit_learn_data’ subfolders.</p> </dd> <dt>
<strong>funneled</strong><span class="classifier">bool, default=True</span>
</dt>
<dd>
<p>Download and use the funneled variant of the dataset.</p> </dd> <dt>
<strong>resize</strong><span class="classifier">float, default=0.5</span>
</dt>
<dd>
<p>Ratio used to resize the each face picture.</p> </dd> <dt>
<strong>color</strong><span class="classifier">bool, default=False</span>
</dt>
<dd>
<p>Keep the 3 RGB channels instead of averaging them to a single gray level channel. If color is True the shape of the data has one more dimension than the shape with color = False.</p> </dd> <dt>
<strong>slice_</strong><span class="classifier">tuple of slice, default=(slice(70, 195), slice(78, 172))</span>
</dt>
<dd>
<p>Provide a custom 2D slice (height, width) to extract the ‘interesting’ part of the jpeg files and avoid use statistical correlation from the background.</p> </dd> <dt>
<strong>download_if_missing</strong><span class="classifier">bool, default=True</span>
</dt>
<dd>
<p>If False, raise an OSError if the data is not locally available instead of trying to download the data from the source site.</p> </dd> <dt>
<strong>n_retries</strong><span class="classifier">int, default=3</span>
</dt>
<dd>
<p>Number of retries when HTTP errors are encountered.</p> <div class="versionadded"> <p><span class="versionmodified added">Added in version 1.5.</span></p> </div> </dd> <dt>
<strong>delay</strong><span class="classifier">float, default=1.0</span>
</dt>
<dd>
<p>Number of seconds between retries.</p> <div class="versionadded"> <p><span class="versionmodified added">Added in version 1.5.</span></p> </div> </dd> </dl> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<dl> <dt>
<strong>data</strong><span class="classifier"><a class="reference internal" href="sklearn.utils.bunch.html#sklearn.utils.Bunch" title="sklearn.utils.Bunch"><code>Bunch</code></a></span>
</dt>
<dd>
<p>Dictionary-like object, with the following attributes.</p> <dl> <dt>data<span class="classifier">ndarray of shape (2200, 5828). Shape depends on <code>subset</code>.</span>
</dt>
<dd>
<p>Each row corresponds to 2 ravel’d face images of original size 62 x 47 pixels. Changing the <code>slice_</code>, <code>resize</code> or <code>subset</code> parameters will change the shape of the output.</p> </dd> <dt>pairs<span class="classifier">ndarray of shape (2200, 2, 62, 47). Shape depends on <code>subset</code></span>
</dt>
<dd>
<p>Each row has 2 face images corresponding to same or different person from the dataset containing 5749 people. Changing the <code>slice_</code>, <code>resize</code> or <code>subset</code> parameters will change the shape of the output.</p> </dd> <dt>target<span class="classifier">numpy array of shape (2200,). Shape depends on <code>subset</code>.</span>
</dt>
<dd>
<p>Labels associated to each pair of images. The two label values being different persons or the same person.</p> </dd> <dt>target_names<span class="classifier">numpy array of shape (2,)</span>
</dt>
<dd>
<p>Explains the target values of the target array. 0 corresponds to “Different person”, 1 corresponds to “same person”.</p> </dd> <dt>DESCR<span class="classifier">str</span>
</dt>
<dd>
<p>Description of the Labeled Faces in the Wild (LFW) dataset.</p> </dd> </dl> </dd> </dl> </dd> </dl> <h4 class="rubric">Examples</h4> <pre data-language="python">&gt;&gt;&gt; from sklearn.datasets import fetch_lfw_pairs
&gt;&gt;&gt; lfw_pairs_train = fetch_lfw_pairs(subset='train')
&gt;&gt;&gt; list(lfw_pairs_train.target_names)
[np.str_('Different persons'), np.str_('Same person')]
&gt;&gt;&gt; lfw_pairs_train.pairs.shape
(2200, 2, 62, 47)
&gt;&gt;&gt; lfw_pairs_train.data.shape
(2200, 5828)
&gt;&gt;&gt; lfw_pairs_train.target.shape
(2200,)
</pre> </dd>
</dl> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007&ndash;2025 The scikit-learn developers<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://scikit-learn.org/1.6/modules/generated/sklearn.datasets.fetch_lfw_pairs.html" class="_attribution-link">https://scikit-learn.org/1.6/modules/generated/sklearn.datasets.fetch_lfw_pairs.html</a>
  </p>
</div>
