<h1 class="devsite-page-title" tabindex="-1"> tf.data.experimental.sample_from_datasets </h1> <devsite-feature-tooltip ack-key="AckCollectionsBookmarkTooltipDismiss" analytics-category="Site-Wide Custom Events" analytics-action-show="Callout Profile displayed" analytics-action-close="Callout Profile dismissed" analytics-label="Create Collection Callout" class="devsite-page-bookmark-tooltip nocontent" dismiss-button="true" id="devsite-collections-dropdown" dismiss-button-text="Dismiss" close-button-text="Got it">    </devsite-feature-tooltip> <div class="devsite-page-title-meta"><devsite-view-release-notes></devsite-view-release-notes></div>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.data.experimental.sample_from_datasets"> <meta itemprop="path" content="Stable"> </div>   <p>Samples elements at random from the datasets in <code translate="no" dir="ltr">datasets</code>. (deprecated)</p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">tf.data.experimental.sample_from_datasets(
    datasets, weights=None, seed=None, stop_on_empty_dataset=False
)
</pre></devsite-code>  <aside class="deprecated"><strong>Deprecated:</strong><span> THIS FUNCTION IS DEPRECATED. It will be removed in a future version. Instructions for updating: Use <a href="../dataset.html#sample_from_datasets"><code translate="no" dir="ltr">tf.data.Dataset.sample_from_datasets(...)</code></a>.</span></aside> <p>Creates a dataset by interleaving elements of <code translate="no" dir="ltr">datasets</code> with <code translate="no" dir="ltr">weight[i]</code> probability of picking an element from dataset <code translate="no" dir="ltr">i</code>. Sampling is done without replacement. For example, suppose we have 2 datasets:</p> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">dataset1 = tf.data.Dataset.range(0, 3)
dataset2 = tf.data.Dataset.range(100, 103)
</pre></devsite-code> <p>Suppose also that we sample from these 2 datasets with the following weights:</p> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">sample_dataset = tf.data.Dataset.sample_from_datasets(
    [dataset1, dataset2], weights=[0.5, 0.5])
</pre></devsite-code> <p>One possible outcome of elements in sample_dataset is:</p> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">print(list(sample_dataset.as_numpy_iterator()))
# [100, 0, 1, 101, 2, 102]
</pre></devsite-code>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">datasets</code> </td> <td> A non-empty list of <a href="../dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a> objects with compatible structure. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">weights</code> </td> <td> (Optional.) A list or Tensor of <code translate="no" dir="ltr">len(datasets)</code> floating-point values where <code translate="no" dir="ltr">weights[i]</code> represents the probability to sample from <code translate="no" dir="ltr">datasets[i]</code>, or a <a href="../dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a> object where each element is such a list. Defaults to a uniform distribution across <code translate="no" dir="ltr">datasets</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">seed</code> </td> <td> (Optional.) A <a href="../../../tf.html#int64"><code translate="no" dir="ltr">tf.int64</code></a> scalar <a href="../../tensor.html"><code translate="no" dir="ltr">tf.Tensor</code></a>, representing the random seed that will be used to create the distribution. See <a href="../../random/set_seed.html"><code translate="no" dir="ltr">tf.random.set_seed</code></a> for behavior. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">stop_on_empty_dataset</code> </td> <td> If <code translate="no" dir="ltr">True</code>, sampling stops if it encounters an empty dataset. If <code translate="no" dir="ltr">False</code>, it skips empty datasets. It is recommended to set it to <code translate="no" dir="ltr">True</code>. Otherwise, the distribution of samples starts off as the user intends, but may change as input datasets become empty. This can be difficult to detect since the dataset starts off looking correct. Default to <code translate="no" dir="ltr">False</code> for backward compatibility. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A dataset that interleaves elements from <code translate="no" dir="ltr">datasets</code> at random, according to <code translate="no" dir="ltr">weights</code> if provided, otherwise with uniform probability. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">TypeError</code> </td> <td> If the <code translate="no" dir="ltr">datasets</code> or <code translate="no" dir="ltr">weights</code> arguments have the wrong type. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> <ul> <li>If <code translate="no" dir="ltr">datasets</code> is empty, or</li> <li>If <code translate="no" dir="ltr">weights</code> is specified and does not match the length of <code translate="no" dir="ltr">datasets</code>. </li>
</ul>
</td> </tr> </table>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/data/experimental/sample_from_datasets" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/data/experimental/sample_from_datasets</a>
  </p>
</div>
