<h1 class="devsite-page-title" tabindex="-1"> tf.experimental.DynamicRaggedShape </h1> <devsite-feature-tooltip ack-key="AckCollectionsBookmarkTooltipDismiss" analytics-category="Site-Wide Custom Events" analytics-action-show="Callout Profile displayed" analytics-action-close="Callout Profile dismissed" analytics-label="Create Collection Callout" class="devsite-page-bookmark-tooltip nocontent" dismiss-button="true" id="devsite-collections-dropdown" dismiss-button-text="Dismiss" close-button-text="Got it">    </devsite-feature-tooltip> <div class="devsite-page-title-meta"><devsite-view-release-notes></devsite-view-release-notes></div>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.experimental.DynamicRaggedShape"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="Spec"> <meta itemprop="property" content="__eq__"> <meta itemprop="property" content="__getitem__"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="__ne__"> <meta itemprop="property" content="from_lengths"> <meta itemprop="property" content="from_row_partitions"> <meta itemprop="property" content="from_tensor"> <meta itemprop="property" content="is_uniform"> <meta itemprop="property" content="static_lengths"> <meta itemprop="property" content="with_dtype"> </div>   <p>The shape of a ragged or dense tensor.</p> <p>Inherits From: <a href="batchableextensiontype.html"><code translate="no" dir="ltr">BatchableExtensionType</code></a>, <a href="extensiontype.html"><code translate="no" dir="ltr">ExtensionType</code></a></p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases" tabindex="-1">View aliases</h4> <p> <b>Compat aliases for migration</b> </p>
<p>See <a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for more details.</p> <p><a href="dynamicraggedshape.html"><code translate="no" dir="ltr">tf.compat.v1.experimental.DynamicRaggedShape</code></a></p> </section> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">tf.experimental.DynamicRaggedShape(
    row_partitions: Sequence[tf.experimental.RowPartition],
    inner_shape: tf.types.experimental.TensorLike,
    dtype: Optional[tf.dtypes.DType] = None,
    validate: bool = False,
    static_inner_shape: ... = None
)
</pre></devsite-code> <h3 id="used-in-the-notebooks" data-text="Used in the notebooks" tabindex="-1">Used in the notebooks</h3> <table class="vertical-rules"> <thead> <tr> <th>Used in the guide</th> </tr> </thead> <tbody> <tr> <td> <ul> <li><a href="https://www.tensorflow.org/guide/ragged_tensor">Ragged tensors</a></li> </ul> </td> </tr> </tbody> </table> <p>Ragged shapes are encoded using two fields:</p> <ul> <li>
<code translate="no" dir="ltr">inner_shape</code>: An integer vector giving the shape of a dense tensor.</li> <li>
<code translate="no" dir="ltr">row_partitions</code>: A list of <code translate="no" dir="ltr">RowPartition</code> objects, describing how that flat shape should be partitioned to add ragged axes.</li> </ul> <p>If a DynamicRaggedShape is the shape of a RaggedTensor rt, then:</p> <ol> <li>row_partitions = rt._nested_row_partitions (and thus len(row_partitions) &gt; 0)</li> <li>inner_shape is the shape of rt.flat_values</li> </ol> <p>If a DynamicRaggedShape is the shape of a dense tensor t, then:</p> <ol> <li>row_partitions = []</li> <li>inner_shape is the shape of t.</li> </ol> <h4 id="examples" data-text="Examples:" tabindex="-1">Examples:</h4> <p>The following table gives a few examples (where <code translate="no" dir="ltr">RP(lengths)</code> is short for <code translate="no" dir="ltr">RowPartition.from_lengths(lengths)</code>):</p> <table> <thead> <tr> <th>Row Partitions</th> <th>Inner Shape</th> <th>Example Tensor</th> </tr> </thead> <tbody> <tr> <td>[]</td> <td>[2, 3]</td> <td><code translate="no" dir="ltr">[[1, 2, 3], [4, 5, 6]]</code></td> </tr> <tr> <td>[RP([2, 0, 3])]</td> <td>[5]</td> <td><code translate="no" dir="ltr">[[1, 2], [], [3, 4, 5]]</code></td> </tr> <tr> <td>[RP([2, 1])]</td> <td>[3, 2]</td> <td><code translate="no" dir="ltr">[[[1, 2], [3, 4]], [[5, 6]]]</code></td> </tr> <tr> <td>[RP([2, 1]), RP([2, 1, 2])]</td> <td>[5]</td> <td><code translate="no" dir="ltr">[[[1, 2], [3]], [[4, 5]]]</code></td> </tr> </tbody> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">row_partitions</code> </td> <td> the row_partitions of the shape. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">inner_shape</code> </td> <td> if len(row_partitions) &gt; 0, the shape of the flat_values. Otherwise, the shape of the tensor. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> tf.int64, tf.int32, or None representing the preferred dtype. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validate</code> </td> <td> if true, dynamic validation is applied to the shape. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">static_inner_shape</code> </td> <td> if len(row_partitions) &gt; 0, the static shape of the flat_values. Otherwise, the static shape of the tensor. Should be convertible to a TensorShape. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> The dtype of the shape -- one of tf.int32 or tf.int64. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">inner_rank</code> </td> <td> The rank of inner_shape. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">inner_shape</code> </td> <td> The inner dimension sizes for this shape. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">num_row_partitions</code> </td> <td> The number of row_partitions of the shape. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">rank</code> </td> <td> The number of dimensions in this shape, or None if unknown. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">row_partitions</code> </td> <td> The row_partitions of the shape. </td> </tr> </table> <h2 id="child_classes" data-text="Child Classes" tabindex="-1">Child Classes</h2> <p><a href="dynamicraggedshape/spec.html"><code translate="no" dir="ltr">class Spec</code></a></p> <h2 id="methods" data-text="Methods" tabindex="-1">Methods</h2> <h3 id="from_lengths" data-text="from_lengths" tabindex="-1"><code translate="no" dir="ltr">from_lengths</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L308-L407">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">@classmethod
from_lengths(
    lengths: Sequence[Union[Sequence[int], int]],
    num_row_partitions=None,
    dtype=tf.dtypes.int64
)
</pre></devsite-code> <p>Creates a shape with the given lengths and num_row_partitions.</p> <p>The lengths can either be a nonnegative int or a list of nonnegative ints.</p> <p>If num_row_partitions is None, then the minimal num_row_partitions is used.</p> <p>For example, [2, (3, 2)] is the shape of [[0, 0, 0], [0, 0]], and [2, 2] is the shape of [[0, 0], [0, 0]]</p> <p>This chooses the minimal num_row_partitions required (including zero).</p> <p>The following table gives a few examples (where <code translate="no" dir="ltr">RP(lengths)</code> is short for <code translate="no" dir="ltr">RowPartition.from_lengths(lengths)</code>):</p> <h4 id="for_example" data-text="For example:" tabindex="-1">For example:</h4> <table> <thead> <tr> <th>from_lengths</th> <th>row_partitions</th> <th>inner_shape</th> </tr> </thead> <tbody> <tr> <td>[]</td> <td>[]</td> <td>[]</td> </tr> <tr> <td>[2, (3, 2)]</td> <td>[RP([3, 2])]</td> <td>[5]</td> </tr> <tr> <td>[2, 2]</td> <td>[]</td> <td>[2, 2]</td> </tr> <tr> <td>[2, (3, 2), 7]</td> <td>[RP([3, 2])]</td> <td>[5, 7]</td> </tr> <tr> <td>[2, (2, 2), 3]</td> <td>[RP([2, 2])]</td> <td>[4, 3]</td> </tr> <tr> <td>[2, 2, 3]</td> <td>[]</td> <td>[2, 2, 3]</td> </tr> <tr> <td>[2, (2, 1), (2, 0, 3)]</td> <td>[RP(2, 1), RP([2, 0, 3])]</td> <td>[5]</td> </tr> </tbody> </table> <p>If we want the row partitions to end with uniform row partitions, then we can set num_row_partitions.</p> <p>For example, below URP(3, 12) is RowPartition.from_uniform_row_length(3, 12)</p> <table> <thead> <tr> <th>from_lengths</th> <th>num_row_partitions</th> <th>row_partitions</th> <th>inner_shape</th> </tr> </thead> <tbody> <tr> <td>[2, (3, 2), 2]</td> <td>2</td> <td>[RP([3, 2]), URP(2, 10)]</td> <td>[10]</td> </tr> <tr> <td>[2, 2]</td> <td>1</td> <td>[URP(2, 4)]</td> <td>[4]</td> </tr> <tr> <td>[2, 2, 3]</td> <td>0</td> <td>[]</td> <td>[2, 2, 3]</td> </tr> <tr> <td>[2, 2, 3]</td> <td>1</td> <td>[URP(2, 4)]</td> <td>[4, 3]</td> </tr> <tr> <td>[2, 2, 3]</td> <td>2</td> <td>[URP(2, 4), URP(3, 12)]</td> <td>[12]</td> </tr> </tbody> </table> <p>Representing the shapes from init():</p> <table> <thead> <tr> <th>from_lengths</th> <th>Tensor Example</th> </tr> </thead> <tbody> <tr> <td><code translate="no" dir="ltr">[2, 3]</code></td> <td><code translate="no" dir="ltr">[[1, 2, 3], [4, 5, 6]]</code></td> </tr> <tr> <td><code translate="no" dir="ltr">[3, (2, 0, 3)]</code></td> <td><code translate="no" dir="ltr">[[1, 2], [], [3, 4, 5]]</code></td> </tr> <tr> <td><code translate="no" dir="ltr">[2, (2, 1), 2]</code></td> <td><code translate="no" dir="ltr">[[[1, 2], [3, 4]], [[5, 6]]]</code></td> </tr> <tr> <td><code translate="no" dir="ltr">[2, (2, 1), (2, 1, 2)]</code></td> <td><code translate="no" dir="ltr">[[[1, 2], [3]], [[4, 5]]]</code></td> </tr> </tbody> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">lengths</code> </td> <td> the lengths of sublists along each axis. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">num_row_partitions</code> </td> <td> the num_row_partitions of the result or None indicating the minimum number of row_partitions. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> the dtype of the shape (tf.int32 or tf.int64). </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> a new DynamicRaggedShape </td> </tr> 
</table> <h3 id="from_row_partitions" data-text="from_row_partitions" tabindex="-1"><code translate="no" dir="ltr">from_row_partitions</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L409-L423">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">@classmethod
from_row_partitions(
    row_partitions, dtype=None
)
</pre></devsite-code> <p>Create a shape from row_partitions.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">row_partitions</code> </td> <td> a nonempty list of RowPartition objects. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> the dtype to use, or None to use the row_partitions dtype. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> a DynamicRaggedShape with inner_rank==1. </td> </tr> 
</table> <h3 id="from_tensor" data-text="from_tensor" tabindex="-1"><code translate="no" dir="ltr">from_tensor</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L431-L439">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">@classmethod
from_tensor(
    t, dtype=None
)
</pre></devsite-code> <p>Constructs a ragged shape for a potentially ragged tensor.</p> <h3 id="is_uniform" data-text="is_uniform" tabindex="-1"><code translate="no" dir="ltr">is_uniform</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L709-L720">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">is_uniform(
    axis
)
</pre></devsite-code> <p>Returns true if the indicated dimension is uniform.</p> <h3 id="static_lengths" data-text="static_lengths" tabindex="-1"><code translate="no" dir="ltr">static_lengths</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L465-L500">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">static_lengths(
    ragged_lengths=True
)
</pre></devsite-code> <p>Returns a list of statically known axis lengths.</p> <p>This represents what values are known. For each row partition, it presents either the uniform row length (if statically known), the list of row lengths, or none if it is not statically known. For the inner shape, if the rank is known, then each dimension is reported if known, and None otherwise. If the rank of the inner shape is not known, then the returned list ends with an ellipsis.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ragged_lengths</code> </td> <td> If false, returns None for all ragged dimensions. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A Sequence[Union[Sequence[int],int, None]] of lengths, with a possible Ellipsis at the end. </td> </tr> 
</table> <h3 id="with_dtype" data-text="with_dtype" tabindex="-1"><code translate="no" dir="ltr">with_dtype</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L984-L990">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">with_dtype(
    dtype
)
</pre></devsite-code> <p>Change the dtype of the shape.</p> <h3 id="__eq__" data-text="__eq__" tabindex="-1"><code translate="no" dir="ltr">__eq__</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/framework/extension_type.py#L276-L305">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">__eq__(
    other
)
</pre></devsite-code> <p>Return self==value.</p> <h3 id="__getitem__" data-text="__getitem__" tabindex="-1"><code translate="no" dir="ltr">__getitem__</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/ops/ragged/dynamic_ragged_shape.py#L615-L654">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">__getitem__(
    index
)
</pre></devsite-code> <p>Returns a dimension or a slice of the shape.</p> <p>Ragged shapes can have ragged dimensions that depend upon other dimensions. Therefore, if you ask for a dimension that is ragged, this function returns a ValueError. For similar reasons, if a slice is selected that includes a ragged dimension without including the zero dimension, then this fails.</p> <p>Any slice that does not start at zero will return a shape with num_row_partitions == 0.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">index</code> </td> <td> the index: can be an int or a slice. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">IndexError</code> </td> <td> if the index is not in range. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> if the rank is unknown, or a ragged rank is requested incorrectly. </td> </tr> </table> <h3 id="__ne__" data-text="__ne__" tabindex="-1"><code translate="no" dir="ltr">__ne__</code></h3> <p><a target="_blank" class="external" href="https://github.com/tensorflow/tensorflow/blob/v2.16.1/tensorflow/python/framework/extension_type.py#L307-L312">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">__ne__(
    other
)
</pre></devsite-code> <p>Return self!=value.</p>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/experimental/DynamicRaggedShape" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/experimental/DynamicRaggedShape</a>
  </p>
</div>
