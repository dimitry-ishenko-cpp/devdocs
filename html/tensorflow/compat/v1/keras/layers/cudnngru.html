<h1 class="devsite-page-title">tf.compat.v1.keras.layers.CuDNNGRU</h1> <devsite-bookmark></devsite-bookmark>       <p>Fast GRU implementation backed by cuDNN.</p> <p>Inherits From: <a href="../../../../keras/layers/rnn.html"><code translate="no" dir="ltr">RNN</code></a>, <a href="../../../../keras/layers/layer.html"><code translate="no" dir="ltr">Layer</code></a>, <a href="../../../../module.html"><code translate="no" dir="ltr">Module</code></a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
tf.compat.v1.keras.layers.CuDNNGRU(
    units,
    kernel_initializer='glorot_uniform',
    recurrent_initializer='orthogonal',
    bias_initializer='zeros',
    kernel_regularizer=None,
    recurrent_regularizer=None,
    bias_regularizer=None,
    activity_regularizer=None,
    kernel_constraint=None,
    recurrent_constraint=None,
    bias_constraint=None,
    return_sequences=False,
    return_state=False,
    go_backwards=False,
    stateful=False,
    **kwargs
)
</pre>  <p>More information about cuDNN can be found on the <a href="https://developer.nvidia.com/cudnn">NVIDIA developer website</a>. Can only be run on GPU.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">units</code> </td> <td> Positive integer, dimensionality of the output space. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">kernel_initializer</code> </td> <td> Initializer for the <code translate="no" dir="ltr">kernel</code> weights matrix, used for the linear transformation of the inputs. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">recurrent_initializer</code> </td> <td> Initializer for the <code translate="no" dir="ltr">recurrent_kernel</code> weights matrix, used for the linear transformation of the recurrent state. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">bias_initializer</code> </td> <td> Initializer for the bias vector. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">kernel_regularizer</code> </td> <td> Regularizer function applied to the <code translate="no" dir="ltr">kernel</code> weights matrix. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">recurrent_regularizer</code> </td> <td> Regularizer function applied to the <code translate="no" dir="ltr">recurrent_kernel</code> weights matrix. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">bias_regularizer</code> </td> <td> Regularizer function applied to the bias vector. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">activity_regularizer</code> </td> <td> Regularizer function applied to the output of the layer (its "activation"). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">kernel_constraint</code> </td> <td> Constraint function applied to the <code translate="no" dir="ltr">kernel</code> weights matrix. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">recurrent_constraint</code> </td> <td> Constraint function applied to the <code translate="no" dir="ltr">recurrent_kernel</code> weights matrix. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">bias_constraint</code> </td> <td> Constraint function applied to the bias vector. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_sequences</code> </td> <td> Boolean. Whether to return the last output in the output sequence, or the full sequence. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_state</code> </td> <td> Boolean. Whether to return the last state in addition to the output. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">go_backwards</code> </td> <td> Boolean (default False). If True, process the input sequence backwards and return the reversed sequence. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">stateful</code> </td> <td> Boolean (default False). If True, the last state for each sample at index i in a batch will be used as initial state for the sample of index i in the following batch. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">cell</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">states</code> </td> <td> 
</td> </tr> </table> <h2 id="methods" data-text="Methods">Methods</h2> <h3 id="get_losses_for" data-text="get_losses_for"><code translate="no" dir="ltr">get_losses_for</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/layers/rnn/base_cudnn_rnn.py#L143-L145">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
get_losses_for(
    inputs=None
)
</pre> <h3 id="reset_states" data-text="reset_states"><code translate="no" dir="ltr">reset_states</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/layers/rnn/base_rnn.py#L752-L831">View source</a></p> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
reset_states(
    states=None
)
</pre> <p>Reset the recorded states for the stateful RNN layer.</p> <p>Can only be used when RNN layer is constructed with <code translate="no" dir="ltr">stateful</code> = <code translate="no" dir="ltr">True</code>. Args: states: Numpy arrays that contains the value for the initial state, which will be feed to cell at the first time step. When the value is None, zero filled numpy array will be created based on the cell state size.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">AttributeError</code> </td> <td> When the RNN layer is not stateful. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> When the batch size of the RNN layer is unknown. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">ValueError</code> </td> <td> When the input numpy array is not compatible with the RNN layer state, either size wise or dtype wise. </td> </tr> </table>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/compat/v1/keras/layers/CuDNNGRU" class="_attribution-link">https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/compat/v1/keras/layers/CuDNNGRU</a>
  </p>
</div>
