<h1 class="devsite-page-title" tabindex="-1"> tf.keras.preprocessing.image_dataset_from_directory </h1> <devsite-feature-tooltip ack-key="AckCollectionsBookmarkTooltipDismiss" analytics-category="Site-Wide Custom Events" analytics-action-show="Callout Profile displayed" analytics-action-close="Callout Profile dismissed" analytics-label="Create Collection Callout" class="devsite-page-bookmark-tooltip nocontent" dismiss-button="true" id="devsite-collections-dropdown" dismiss-button-text="Dismiss" close-button-text="Got it">    </devsite-feature-tooltip> <div class="devsite-page-title-meta"><devsite-view-release-notes></devsite-view-release-notes></div>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.preprocessing.image_dataset_from_directory"> <meta itemprop="path" content="Stable"> </div>   <p>Generates a <a href="../../data/dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a> from image files in a directory.</p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases" tabindex="-1">View aliases</h4> <p> <b>Main aliases</b> </p>
<p><a href="image_dataset_from_directory.html"><code translate="no" dir="ltr">tf.keras.utils.image_dataset_from_directory</code></a></p> </section> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">tf.keras.preprocessing.image_dataset_from_directory(
    directory,
    labels='inferred',
    label_mode='int',
    class_names=None,
    color_mode='rgb',
    batch_size=32,
    image_size=(256, 256),
    shuffle=True,
    seed=None,
    validation_split=None,
    subset=None,
    interpolation='bilinear',
    follow_links=False,
    crop_to_aspect_ratio=False,
    pad_to_aspect_ratio=False,
    data_format=None,
    verbose=True
)
</pre></devsite-code> <h3 id="used-in-the-notebooks" data-text="Used in the notebooks" tabindex="-1">Used in the notebooks</h3> <table class="vertical-rules"> <thead> <tr> <th>Used in the tutorials</th> </tr> </thead> <tbody> <tr> <td> <ul> <li><a href="https://www.tensorflow.org/tutorials/images/classification">Image classification</a></li> <li><a href="https://www.tensorflow.org/tutorials/images/transfer_learning">Transfer learning and fine-tuning</a></li> <li><a href="https://www.tensorflow.org/tutorials/images/transfer_learning_with_hub">Transfer learning with TensorFlow Hub</a></li> <li><a href="https://www.tensorflow.org/tutorials/load_data/images">Load and preprocess images</a></li> <li><a href="https://www.tensorflow.org/hub/tutorials/tf2_image_retraining">Retraining an Image Classifier</a></li> </ul> </td> </tr> </tbody> </table> <p>If your directory structure is:</p> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">main_directory/
...class_a/
......a_image_1.jpg
......a_image_2.jpg
...class_b/
......b_image_1.jpg
......b_image_2.jpg
</pre></devsite-code> <p>Then calling <code translate="no" dir="ltr">image_dataset_from_directory(main_directory, labels='inferred')</code> will return a <code translate="no" dir="ltr">tf.data.Dataset</code> that yields batches of images from the subdirectories <code translate="no" dir="ltr">class_a</code> and <code translate="no" dir="ltr">class_b</code>, together with labels 0 and 1 (0 corresponding to <code translate="no" dir="ltr">class_a</code> and 1 corresponding to <code translate="no" dir="ltr">class_b</code>).</p> <p>Supported image formats: <code translate="no" dir="ltr">.jpeg</code>, <code translate="no" dir="ltr">.jpg</code>, <code translate="no" dir="ltr">.png</code>, <code translate="no" dir="ltr">.bmp</code>, <code translate="no" dir="ltr">.gif</code>. Animated gifs are truncated to the first frame.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">directory</code> </td> <td> Directory where the data is located. If <code translate="no" dir="ltr">labels</code> is <code translate="no" dir="ltr">"inferred"</code>, it should contain subdirectories, each containing images for a class. Otherwise, the directory structure is ignored. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">labels</code> </td> <td> Either <code translate="no" dir="ltr">"inferred"</code> (labels are generated from the directory structure), <code translate="no" dir="ltr">None</code> (no labels), or a list/tuple of integer labels of the same size as the number of image files found in the directory. Labels should be sorted according to the alphanumeric order of the image file paths (obtained via <code translate="no" dir="ltr">os.walk(directory)</code> in Python). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">label_mode</code> </td> <td> String describing the encoding of <code translate="no" dir="ltr">labels</code>. Options are: <ul> <li>
<code translate="no" dir="ltr">"int"</code>: means that the labels are encoded as integers (e.g. for <code translate="no" dir="ltr">sparse_categorical_crossentropy</code> loss).</li> <li>
<code translate="no" dir="ltr">"categorical"</code> means that the labels are encoded as a categorical vector (e.g. for <code translate="no" dir="ltr">categorical_crossentropy</code> loss).</li> <li>
<code translate="no" dir="ltr">"binary"</code> means that the labels (there can be only 2) are encoded as <code translate="no" dir="ltr">float32</code> scalars with values 0 or 1 (e.g. for <code translate="no" dir="ltr">binary_crossentropy</code>).</li> <li>
<code translate="no" dir="ltr">None</code> (no labels). </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">class_names</code> </td> <td> Only valid if <code translate="no" dir="ltr">labels</code> is <code translate="no" dir="ltr">"inferred"</code>. This is the explicit list of class names (must match names of subdirectories). Used to control the order of the classes (otherwise alphanumerical order is used). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">color_mode</code> </td> <td> One of <code translate="no" dir="ltr">"grayscale"</code>, <code translate="no" dir="ltr">"rgb"</code>, <code translate="no" dir="ltr">"rgba"</code>. Defaults to <code translate="no" dir="ltr">"rgb"</code>. Whether the images will be converted to have 1, 3, or 4 channels. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">batch_size</code> </td> <td> Size of the batches of data. Defaults to 32. If <code translate="no" dir="ltr">None</code>, the data will not be batched (the dataset will yield individual samples). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">image_size</code> </td> <td> Size to resize images to after they are read from disk, specified as <code translate="no" dir="ltr">(height, width)</code>. Defaults to <code translate="no" dir="ltr">(256, 256)</code>. Since the pipeline processes batches of images that must all have the same size, this must be provided. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">shuffle</code> </td> <td> Whether to shuffle the data. Defaults to <code translate="no" dir="ltr">True</code>. If set to <code translate="no" dir="ltr">False</code>, sorts the data in alphanumeric order. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">seed</code> </td> <td> Optional random seed for shuffling and transformations. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">validation_split</code> </td> <td> Optional float between 0 and 1, fraction of data to reserve for validation. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">subset</code> </td> <td> Subset of the data to return. One of <code translate="no" dir="ltr">"training"</code>, <code translate="no" dir="ltr">"validation"</code>, or <code translate="no" dir="ltr">"both"</code>. Only used if <code translate="no" dir="ltr">validation_split</code> is set. When <code translate="no" dir="ltr">subset="both"</code>, the utility returns a tuple of two datasets (the training and validation datasets respectively). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">interpolation</code> </td> <td> String, the interpolation method used when resizing images. Defaults to <code translate="no" dir="ltr">"bilinear"</code>. Supports <code translate="no" dir="ltr">"bilinear"</code>, <code translate="no" dir="ltr">"nearest"</code>, <code translate="no" dir="ltr">"bicubic"</code>, <code translate="no" dir="ltr">"area"</code>, <code translate="no" dir="ltr">"lanczos3"</code>, <code translate="no" dir="ltr">"lanczos5"</code>, <code translate="no" dir="ltr">"gaussian"</code>, <code translate="no" dir="ltr">"mitchellcubic"</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">follow_links</code> </td> <td> Whether to visit subdirectories pointed to by symlinks. Defaults to <code translate="no" dir="ltr">False</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">crop_to_aspect_ratio</code> </td> <td> If <code translate="no" dir="ltr">True</code>, resize the images without aspect ratio distortion. When the original aspect ratio differs from the target aspect ratio, the output image will be cropped so as to return the largest possible window in the image (of size <code translate="no" dir="ltr">image_size</code>) that matches the target aspect ratio. By default (<code translate="no" dir="ltr">crop_to_aspect_ratio=False</code>), aspect ratio may not be preserved. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">pad_to_aspect_ratio</code> </td> <td> If <code translate="no" dir="ltr">True</code>, resize the images without aspect ratio distortion. When the original aspect ratio differs from the target aspect ratio, the output image will be padded so as to return the largest possible window in the image (of size <code translate="no" dir="ltr">image_size</code>) that matches the target aspect ratio. By default (<code translate="no" dir="ltr">pad_to_aspect_ratio=False</code>), aspect ratio may not be preserved. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">data_format</code> </td> <td> If None uses keras.config.image_data_format() otherwise either 'channel_last' or 'channel_first'. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">verbose</code> </td> <td> Whether to display number information on classes and number of files found. Defaults to <code translate="no" dir="ltr">True</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> 
</table> <p>A <a href="../../data/dataset.html"><code translate="no" dir="ltr">tf.data.Dataset</code></a> object.</p> <ul> <li>If <code translate="no" dir="ltr">label_mode</code> is <code translate="no" dir="ltr">None</code>, it yields <code translate="no" dir="ltr">float32</code> tensors of shape <code translate="no" dir="ltr">(batch_size, image_size[0], image_size[1], num_channels)</code>, encoding images (see below for rules regarding <code translate="no" dir="ltr">num_channels</code>).</li> <li>Otherwise, it yields a tuple <code translate="no" dir="ltr">(images, labels)</code>, where <code translate="no" dir="ltr">images</code> has shape <code translate="no" dir="ltr">(batch_size, image_size[0], image_size[1], num_channels)</code>, and <code translate="no" dir="ltr">labels</code> follows the format described below.</li> </ul> <p>Rules regarding labels format:</p> <ul> <li>if <code translate="no" dir="ltr">label_mode</code> is <code translate="no" dir="ltr">"int"</code>, the labels are an <code translate="no" dir="ltr">int32</code> tensor of shape <code translate="no" dir="ltr">(batch_size,)</code>.</li> <li>if <code translate="no" dir="ltr">label_mode</code> is <code translate="no" dir="ltr">"binary"</code>, the labels are a <code translate="no" dir="ltr">float32</code> tensor of 1s and 0s of shape <code translate="no" dir="ltr">(batch_size, 1)</code>.</li> <li>if <code translate="no" dir="ltr">label_mode</code> is <code translate="no" dir="ltr">"categorical"</code>, the labels are a <code translate="no" dir="ltr">float32</code> tensor of shape <code translate="no" dir="ltr">(batch_size, num_classes)</code>, representing a one-hot encoding of the class index.</li> </ul> <p>Rules regarding number of channels in the yielded images:</p> <ul> <li>if <code translate="no" dir="ltr">color_mode</code> is <code translate="no" dir="ltr">"grayscale"</code>, there's 1 channel in the image tensors.</li> <li>if <code translate="no" dir="ltr">color_mode</code> is <code translate="no" dir="ltr">"rgb"</code>, there are 3 channels in the image tensors.</li> <li>if <code translate="no" dir="ltr">color_mode</code> is <code translate="no" dir="ltr">"rgba"</code>, there are 4 channels in the image tensors.</li> </ul>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image_dataset_from_directory" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/preprocessing/image_dataset_from_directory</a>
  </p>
</div>
