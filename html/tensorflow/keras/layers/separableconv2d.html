<h1 class="devsite-page-title" tabindex="-1"> tf.keras.layers.SeparableConv2D </h1> <devsite-feature-tooltip ack-key="AckCollectionsBookmarkTooltipDismiss" analytics-category="Site-Wide Custom Events" analytics-action-show="Callout Profile displayed" analytics-action-close="Callout Profile dismissed" analytics-label="Create Collection Callout" class="devsite-page-bookmark-tooltip nocontent" dismiss-button="true" id="devsite-collections-dropdown" dismiss-button-text="Dismiss" close-button-text="Got it">    </devsite-feature-tooltip> <div class="devsite-page-title-meta"><devsite-view-release-notes></devsite-view-release-notes></div>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.layers.SeparableConv2D"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="from_config"> <meta itemprop="property" content="symbolic_call"> </div>   <p>2D separable convolution layer.</p> <p>Inherits From: <a href="../layer.html"><code translate="no" dir="ltr">Layer</code></a>, <a href="../operation.html"><code translate="no" dir="ltr">Operation</code></a></p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases" tabindex="-1">View aliases</h4> <p> <b>Main aliases</b> </p>
<p><a href="separableconv2d.html"><code translate="no" dir="ltr">tf.keras.layers.SeparableConvolution2D</code></a></p> </section> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">tf.keras.layers.SeparableConv2D(
    filters,
    kernel_size,
    strides=(1, 1),
    padding='valid',
    data_format=None,
    dilation_rate=(1, 1),
    depth_multiplier=1,
    activation=None,
    use_bias=True,
    depthwise_initializer='glorot_uniform',
    pointwise_initializer='glorot_uniform',
    bias_initializer='zeros',
    depthwise_regularizer=None,
    pointwise_regularizer=None,
    bias_regularizer=None,
    activity_regularizer=None,
    depthwise_constraint=None,
    pointwise_constraint=None,
    bias_constraint=None,
    **kwargs
)
</pre></devsite-code>  <p>This layer performs a depthwise convolution that acts separately on channels, followed by a pointwise convolution that mixes channels. If <code translate="no" dir="ltr">use_bias</code> is True and a bias initializer is provided, it adds a bias vector to the output. It then optionally applies an activation function to produce the final output.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filters</code> </td> <td> int, the dimensionality of the output space (i.e. the number of filters in the pointwise convolution). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">kernel_size</code> </td> <td> int or tuple/list of 2 integers, specifying the size of the depthwise convolution window. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">strides</code> </td> <td> int or tuple/list of 2 integers, specifying the stride length of the depthwise convolution. If only one int is specified, the same stride size will be used for all dimensions. <code translate="no" dir="ltr">strides &gt; 1</code> is incompatible with <code translate="no" dir="ltr">dilation_rate &gt; 1</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">padding</code> </td> <td> string, either <code translate="no" dir="ltr">"valid"</code> or <code translate="no" dir="ltr">"same"</code> (case-insensitive). <code translate="no" dir="ltr">"valid"</code> means no padding. <code translate="no" dir="ltr">"same"</code> results in padding evenly to the left/right or up/down of the input. When <code translate="no" dir="ltr">padding="same"</code> and <code translate="no" dir="ltr">strides=1</code>, the output has the same size as the input. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">data_format</code> </td> <td> string, either <code translate="no" dir="ltr">"channels_last"</code> or <code translate="no" dir="ltr">"channels_first"</code>. The ordering of the dimensions in the inputs. <code translate="no" dir="ltr">"channels_last"</code> corresponds to inputs with shape <code translate="no" dir="ltr">(batch, height, width, channels)</code> while <code translate="no" dir="ltr">"channels_first"</code> corresponds to inputs with shape <code translate="no" dir="ltr">(batch, channels, height, width)</code>. It defaults to the <code translate="no" dir="ltr">image_data_format</code> value found in your Keras config file at <code translate="no" dir="ltr">~/.keras/keras.json</code>. If you never set it, then it will be <code translate="no" dir="ltr">"channels_last"</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dilation_rate</code> </td> <td> int or tuple/list of 2 integers, specifying the dilation rate to use for dilated convolution. If only one int is specified, the same dilation rate will be used for all dimensions. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">depth_multiplier</code> </td> <td> The number of depthwise convolution output channels for each input channel. The total number of depthwise convolution output channels will be equal to <code translate="no" dir="ltr">input_channel * depth_multiplier</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">activation</code> </td> <td> Activation function. If <code translate="no" dir="ltr">None</code>, no activation is applied. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">use_bias</code> </td> <td> bool, if <code translate="no" dir="ltr">True</code>, bias will be added to the output. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">depthwise_initializer</code> </td> <td> An initializer for the depthwise convolution kernel. If None, then the default initializer (<code translate="no" dir="ltr">"glorot_uniform"</code>) will be used. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">pointwise_initializer</code> </td> <td> An initializer for the pointwise convolution kernel. If None, then the default initializer (<code translate="no" dir="ltr">"glorot_uniform"</code>) will be used. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">bias_initializer</code> </td> <td> An initializer for the bias vector. If None, the default initializer ('"zeros"') will be used. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">depthwise_regularizer</code> </td> <td> Optional regularizer for the depthwise convolution kernel. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">pointwise_regularizer</code> </td> <td> Optional regularizer for the pointwise convolution kernel. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">bias_regularizer</code> </td> <td> Optional regularizer for the bias vector. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">activity_regularizer</code> </td> <td> Optional regularizer function for the output. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">depthwise_constraint</code> </td> <td> Optional projection function to be applied to the depthwise kernel after being updated by an <code translate="no" dir="ltr">Optimizer</code> (e.g. used for norm constraints or value constraints for layer weights). The function must take as input the unprojected variable and must return the projected variable (which must have the same shape). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">pointwise_constraint</code> </td> <td> Optional projection function to be applied to the pointwise kernel after being updated by an <code translate="no" dir="ltr">Optimizer</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">bias_constraint</code> </td> <td> Optional projection function to be applied to the bias after being updated by an <code translate="no" dir="ltr">Optimizer</code>. </td> </tr> </table> <h4 id="input_shape" data-text="Input shape:" tabindex="-1">Input shape:</h4> <ul> <li>If <code translate="no" dir="ltr">data_format="channels_last"</code>: A 4D tensor with shape: <code translate="no" dir="ltr">(batch_size, height, width, channels)</code>
</li> <li>If <code translate="no" dir="ltr">data_format="channels_first"</code>: A 4D tensor with shape: <code translate="no" dir="ltr">(batch_size, channels, height, width)</code>
</li> </ul> <h4 id="output_shape" data-text="Output shape:" tabindex="-1">Output shape:</h4> <ul> <li>If <code translate="no" dir="ltr">data_format="channels_last"</code>: A 4D tensor with shape: <code translate="no" dir="ltr">(batch_size, new_height, new_width, filters)</code>
</li> <li>If <code translate="no" dir="ltr">data_format="channels_first"</code>: A 4D tensor with shape: <code translate="no" dir="ltr">(batch_size, filters, new_height, new_width)</code>
</li> </ul>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A 4D tensor representing <code translate="no" dir="ltr">activation(separable_conv2d(inputs, kernel) + bias)</code>. </td> </tr> 
</table> <h4 id="example" data-text="Example:" tabindex="-1">Example:</h4> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">x = np.random.rand(4, 10, 10, 12)
y = keras.layers.SeparableConv2D(3, 4, 3, 2, activation='relu')(x)
print(y.shape)
(4, 4, 4, 4)</pre></devsite-code>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">input</code> </td> <td> Retrieves the input tensor(s) of a symbolic operation. <p>Only returns the tensor(s) corresponding to the <em>first time</em> the operation was called. </p>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">output</code> </td> <td> Retrieves the output tensor(s) of a layer. <p>Only returns the tensor(s) corresponding to the <em>first time</em> the operation was called. </p>
</td> </tr> </table> <h2 id="methods" data-text="Methods" tabindex="-1">Methods</h2> <h3 id="from_config" data-text="from_config" tabindex="-1"><code translate="no" dir="ltr">from_config</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/ops/operation.py#L191-L213">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">@classmethod
from_config(
    config
)
</pre></devsite-code> <p>Creates a layer from its config.</p> <p>This method is the reverse of <code translate="no" dir="ltr">get_config</code>, capable of instantiating the same layer from the config dictionary. It does not handle layer connectivity (handled by Network), nor weights (handled by <code translate="no" dir="ltr">set_weights</code>).</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">config</code> </td> <td> A Python dictionary, typically the output of get_config. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A layer instance. </td> </tr> 
</table> <h3 id="symbolic_call" data-text="symbolic_call" tabindex="-1"><code translate="no" dir="ltr">symbolic_call</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/ops/operation.py#L58-L70">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">symbolic_call(
    *args, **kwargs
)
</pre></devsite-code>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/SeparableConv2D" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/layers/SeparableConv2D</a>
  </p>
</div>
