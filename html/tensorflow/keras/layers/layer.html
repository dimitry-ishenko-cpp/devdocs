<h1 class="devsite-page-title" tabindex="-1"> tf.keras.Layer </h1> <devsite-feature-tooltip ack-key="AckCollectionsBookmarkTooltipDismiss" analytics-category="Site-Wide Custom Events" analytics-action-show="Callout Profile displayed" analytics-action-close="Callout Profile dismissed" analytics-label="Create Collection Callout" class="devsite-page-bookmark-tooltip nocontent" dismiss-button="true" id="devsite-collections-dropdown" dismiss-button-text="Dismiss" close-button-text="Got it">    </devsite-feature-tooltip> <div class="devsite-page-title-meta"><devsite-view-release-notes></devsite-view-release-notes></div>     <div itemscope itemtype="http://developers.google.com/ReferenceObject"> <meta itemprop="name" content="tf.keras.Layer"> <meta itemprop="path" content="Stable"> <meta itemprop="property" content="__call__"> <meta itemprop="property" content="__init__"> <meta itemprop="property" content="__new__"> <meta itemprop="property" content="add_loss"> <meta itemprop="property" content="add_metric"> <meta itemprop="property" content="add_variable"> <meta itemprop="property" content="add_weight"> <meta itemprop="property" content="build"> <meta itemprop="property" content="build_from_config"> <meta itemprop="property" content="call"> <meta itemprop="property" content="compute_mask"> <meta itemprop="property" content="compute_output_shape"> <meta itemprop="property" content="compute_output_spec"> <meta itemprop="property" content="count_params"> <meta itemprop="property" content="from_config"> <meta itemprop="property" content="get_build_config"> <meta itemprop="property" content="get_config"> <meta itemprop="property" content="get_weights"> <meta itemprop="property" content="load_own_variables"> <meta itemprop="property" content="quantize"> <meta itemprop="property" content="quantized_call"> <meta itemprop="property" content="save_own_variables"> <meta itemprop="property" content="set_weights"> <meta itemprop="property" content="stateless_call"> <meta itemprop="property" content="symbolic_call"> </div>   <p>This is the class from which all layers inherit.</p> <p>Inherits From: <a href="../operation.html"><code translate="no" dir="ltr">Operation</code></a></p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases" tabindex="-1">View aliases</h4> <p> <b>Main aliases</b> </p>
<p><a href="../layer.html"><code translate="no" dir="ltr">tf.keras.layers.Layer</code></a></p> <b>Compat aliases for migration</b> <p>See <a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for more details.</p> <p><a href="../layer.html"><code translate="no" dir="ltr">tf.compat.v1.keras.Layer</code></a></p> </section> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">tf.keras.Layer(
    *,
    activity_regularizer=None,
    trainable=True,
    dtype=None,
    autocast=True,
    name=None,
    **kwargs
)
</pre></devsite-code> <h3 id="used-in-the-notebooks" data-text="Used in the notebooks" tabindex="-1">Used in the notebooks</h3> <table class="vertical-rules"> <thead> <tr> <th>Used in the guide</th> <th>Used in the tutorials</th> </tr> </thead> <tbody> <tr> <td> <ul> <li><a href="https://www.tensorflow.org/guide/migrate/model_mapping">Use TF1.x models in TF2 workflows</a></li> <li><a href="https://www.tensorflow.org/guide/migrate/validate_correctness">Validating correctness &amp; numerical equivalence</a></li> <li><a href="https://www.tensorflow.org/guide/intro_to_modules">Introduction to modules, layers, and models</a></li> <li><a href="https://www.tensorflow.org/guide/extension_type">Extension types</a></li> <li><a href="https://www.tensorflow.org/guide/migrate/migration_debugging">Debug a TensorFlow 2 migrated training pipeline</a></li> </ul> </td> <td> <ul> <li><a href="https://www.tensorflow.org/tutorials/load_data/text">Load text</a></li> <li><a href="https://www.tensorflow.org/tutorials/optimization/compression">Scalable model compression</a></li> <li><a href="https://www.tensorflow.org/tutorials/audio/transfer_learning_audio">Transfer learning with YAMNet for environmental sound classification</a></li> <li><a href="https://www.tensorflow.org/tutorials/customization/custom_layers">Custom layers</a></li> <li><a href="https://www.tensorflow.org/tutorials/images/data_augmentation">Data augmentation</a></li> </ul> </td> </tr> </tbody> </table> <p>A layer is a callable object that takes as input one or more tensors and that outputs one or more tensors. It involves <em>computation</em>, defined in the <code translate="no" dir="ltr">call()</code> method, and a <em>state</em> (weight variables). State can be created:</p> <ul> <li>in <code translate="no" dir="ltr">__init__()</code>, for instance via <code translate="no" dir="ltr">self.add_weight()</code>;</li> <li>in the optional <code translate="no" dir="ltr">build()</code> method, which is invoked by the first <code translate="no" dir="ltr">__call__()</code> to the layer, and supplies the shape(s) of the input(s), which may not have been known at initialization time.</li> </ul> <p>Layers are recursively composable: If you assign a Layer instance as an attribute of another Layer, the outer layer will start tracking the weights created by the inner layer. Nested layers should be instantiated in the <code translate="no" dir="ltr">__init__()</code> method or <code translate="no" dir="ltr">build()</code> method.</p> <p>Users will just instantiate a layer and then treat it as a callable.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">trainable</code> </td> <td> Boolean, whether the layer's variables should be trainable. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">name</code> </td> <td> String name of the layer. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> The dtype of the layer's computations and weights. Can also be a <a href="../dtypepolicy.html"><code translate="no" dir="ltr">keras.DTypePolicy</code></a>, which allows the computation and weight dtype to differ. Defaults to <code translate="no" dir="ltr">None</code>. <code translate="no" dir="ltr">None</code> means to use <a href="../config/dtype_policy.html"><code translate="no" dir="ltr">keras.config.dtype_policy()</code></a>, which is a <code translate="no" dir="ltr">float32</code> policy unless set to different value (via <a href="../config/set_dtype_policy.html"><code translate="no" dir="ltr">keras.config.set_dtype_policy()</code></a>). </td> </tr> </table> <p>We recommend that descendants of <code translate="no" dir="ltr">Layer</code> implement the following methods:</p> <ul> <li>
<code translate="no" dir="ltr">__init__()</code>: Defines custom layer attributes, and creates layer weights that do not depend on input shapes, using <code translate="no" dir="ltr">add_weight()</code>, or other state.</li> <li>
<code translate="no" dir="ltr">build(self, input_shape)</code>: This method can be used to create weights that depend on the shape(s) of the input(s), using <code translate="no" dir="ltr">add_weight()</code>, or other state. <code translate="no" dir="ltr">__call__()</code> will automatically build the layer (if it has not been built yet) by calling <code translate="no" dir="ltr">build()</code>.</li> <li>
<code translate="no" dir="ltr">call(self, *args, **kwargs)</code>: Called in <code translate="no" dir="ltr">__call__</code> after making sure <code translate="no" dir="ltr">build()</code> has been called. <code translate="no" dir="ltr">call()</code> performs the logic of applying the layer to the input arguments. Two reserved keyword arguments you can optionally use in <code translate="no" dir="ltr">call()</code> are: 1. <code translate="no" dir="ltr">training</code> (boolean, whether the call is in inference mode or training mode). 2. <code translate="no" dir="ltr">mask</code> (boolean tensor encoding masked timesteps in the input, used e.g. in RNN layers). A typical signature for this method is <code translate="no" dir="ltr">call(self, inputs)</code>, and user could optionally add <code translate="no" dir="ltr">training</code> and <code translate="no" dir="ltr">mask</code> if the layer need them.</li> <li>
<code translate="no" dir="ltr">get_config(self)</code>: Returns a dictionary containing the configuration used to initialize this layer. If the keys differ from the arguments in <code translate="no" dir="ltr">__init__()</code>, then override <code translate="no" dir="ltr">from_config(self)</code> as well. This method is used when saving the layer or a model that contains this layer.</li> </ul> <h4 id="examples" data-text="Examples:" tabindex="-1">Examples:</h4> <p>Here's a basic example: a layer with two variables, <code translate="no" dir="ltr">w</code> and <code translate="no" dir="ltr">b</code>, that returns <code translate="no" dir="ltr">y = w . x + b</code>. It shows how to implement <code translate="no" dir="ltr">build()</code> and <code translate="no" dir="ltr">call()</code>. Variables set as attributes of a layer are tracked as weights of the layers (in <code translate="no" dir="ltr">layer.weights</code>).</p> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">class SimpleDense(Layer):
    def __init__(self, units=32):
        super().__init__()
        self.units = units

    # Create the state of the layer (weights)
    def build(self, input_shape):
        self.kernel = self.add_weight(
            shape=(input_shape[-1], self.units),
            initializer="glorot_uniform",
            trainable=True,
            name="kernel",
        )
        self.bias = self.add_weight(
            shape=(self.units,),
            initializer="zeros",
            trainable=True,
            name="bias",
        )

    # Defines the computation
    def call(self, inputs):
        return ops.matmul(inputs, self.kernel) + self.bias

# Instantiates the layer.
linear_layer = SimpleDense(4)

# This will also call `build(input_shape)` and create the weights.
y = linear_layer(ops.ones((2, 2)))
assert len(linear_layer.weights) == 2

# These weights are trainable, so they're listed in `trainable_weights`:
assert len(linear_layer.trainable_weights) == 2
</pre></devsite-code> <p>Besides trainable weights, updated via backpropagation during training, layers can also have non-trainable weights. These weights are meant to be updated manually during <code translate="no" dir="ltr">call()</code>. Here's a example layer that computes the running sum of its inputs:</p> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">class ComputeSum(Layer):

  def __init__(self, input_dim):
      super(ComputeSum, self).__init__()
      # Create a non-trainable weight.
      self.total = self.add_weight(
        shape=(),
        initializer="zeros",
        trainable=False,
        name="total",
      )

  def call(self, inputs):
      self.total.assign(self.total + ops.sum(inputs))
      return self.total

my_sum = ComputeSum(2)
x = ops.ones((2, 2))
y = my_sum(x)

assert my_sum.weights == [my_sum.total]
assert my_sum.non_trainable_weights == [my_sum.total]
assert my_sum.trainable_weights == []
</pre></devsite-code>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Attributes</th></tr> 
<tr> <td> <code translate="no" dir="ltr">name</code> </td> <td> The name of the layer (string). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> Dtype of the layer's weights. Alias of <code translate="no" dir="ltr">layer.variable_dtype</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">variable_dtype</code> </td> <td> Dtype of the layer's weights. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">compute_dtype</code> </td> <td> The dtype of the layer's computations. Layers automatically cast inputs to this dtype, which causes the computations and output to also be in this dtype. When mixed precision is used with a <a href="../dtypepolicy.html"><code translate="no" dir="ltr">keras.DTypePolicy</code></a>, this will be different than <code translate="no" dir="ltr">variable_dtype</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">trainable_weights</code> </td> <td> List of variables to be included in backprop. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">non_trainable_weights</code> </td> <td> List of variables that should not be included in backprop. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">weights</code> </td> <td> The concatenation of the lists trainable_weights and non_trainable_weights (in this order). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">trainable</code> </td> <td> Whether the layer should be trained (boolean), i.e. whether its potentially-trainable weights should be returned as part of <code translate="no" dir="ltr">layer.trainable_weights</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">input_spec</code> </td> <td> Optional (list of) <code translate="no" dir="ltr">InputSpec</code> object(s) specifying the constraints on inputs that can be accepted by the layer. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype_policy</code> </td> <td> 
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">input</code> </td> <td> Retrieves the input tensor(s) of a symbolic operation. <p>Only returns the tensor(s) corresponding to the <em>first time</em> the operation was called. </p>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">input_dtype</code> </td> <td> The dtype layer inputs should be converted to. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">losses</code> </td> <td> List of scalar losses from <code translate="no" dir="ltr">add_loss</code>, regularizers and sublayers. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">metrics</code> </td> <td> List of all metrics. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">metrics_variables</code> </td> <td> List of all metric variables. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">non_trainable_variables</code> </td> <td> List of all non-trainable layer state. <p>This extends <code translate="no" dir="ltr">layer.non_trainable_weights</code> to include all state used by the layer including state for metrics and <code translate="no" dir="ltr">SeedGenerator</code>s. </p>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">output</code> </td> <td> Retrieves the output tensor(s) of a layer. <p>Only returns the tensor(s) corresponding to the <em>first time</em> the operation was called. </p>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">supports_masking</code> </td> <td> Whether this layer supports computing a mask using <code translate="no" dir="ltr">compute_mask</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">trainable_variables</code> </td> <td> List of all trainable layer state. <p>This is equivalent to <code translate="no" dir="ltr">layer.trainable_weights</code>. </p>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">variables</code> </td> <td> List of all layer state, including random seeds. <p>This extends <code translate="no" dir="ltr">layer.weights</code> to include all state used by the layer including <code translate="no" dir="ltr">SeedGenerator</code>s.</p> <p>Note that metrics variables are not included here, use <code translate="no" dir="ltr">metrics_variables</code> to visit all the metric variables. </p>
</td> </tr> </table> <h2 id="methods" data-text="Methods" tabindex="-1">Methods</h2> <h3 id="add_loss" data-text="add_loss" tabindex="-1"><code translate="no" dir="ltr">add_loss</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1060-L1088">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">add_loss(
    loss
)
</pre></devsite-code> <p>Can be called inside of the <code translate="no" dir="ltr">call()</code> method to add a scalar loss.</p> <h4 id="example" data-text="Example:" tabindex="-1">Example:</h4> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">class MyLayer(Layer):
    ...
    def call(self, x):
        self.add_loss(ops.sum(x))
        return x
</pre></devsite-code> <h3 id="add_metric" data-text="add_metric" tabindex="-1"><code translate="no" dir="ltr">add_metric</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1244-L1246">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">add_metric()
</pre></devsite-code> <h3 id="add_variable" data-text="add_variable" tabindex="-1"><code translate="no" dir="ltr">add_variable</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L429-L453">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">add_variable(
    shape,
    initializer,
    dtype=None,
    trainable=True,
    autocast=True,
    regularizer=None,
    constraint=None,
    name=None
)
</pre></devsite-code> <p>Add a weight variable to the layer.</p> <p>Alias of <code translate="no" dir="ltr">add_weight()</code>.</p> <h3 id="add_weight" data-text="add_weight" tabindex="-1"><code translate="no" dir="ltr">add_weight</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L455-L524">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">add_weight(
    shape=None,
    initializer=None,
    dtype=None,
    trainable=True,
    autocast=True,
    regularizer=None,
    constraint=None,
    aggregation='mean',
    name=None
)
</pre></devsite-code> <p>Add a weight variable to the layer.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">shape</code> </td> <td> Shape tuple for the variable. Must be fully-defined (no <code translate="no" dir="ltr">None</code> entries). Defaults to <code translate="no" dir="ltr">()</code> (scalar) if unspecified. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">initializer</code> </td> <td> Initializer object to use to populate the initial variable value, or string name of a built-in initializer (e.g. <code translate="no" dir="ltr">"random_normal"</code>). If unspecified, defaults to <code translate="no" dir="ltr">"glorot_uniform"</code> for floating-point variables and to <code translate="no" dir="ltr">"zeros"</code> for all other types (e.g. int, bool). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">dtype</code> </td> <td> Dtype of the variable to create, e.g. <code translate="no" dir="ltr">"float32"</code>. If unspecified, defaults to the layer's variable dtype (which itself defaults to <code translate="no" dir="ltr">"float32"</code> if unspecified). </td> </tr>
<tr> <td> <code translate="no" dir="ltr">trainable</code> </td> <td> Boolean, whether the variable should be trainable via backprop or whether its updates are managed manually. Defaults to <code translate="no" dir="ltr">True</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">autocast</code> </td> <td> Boolean, whether to autocast layers variables when accessing them. Defaults to <code translate="no" dir="ltr">True</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">regularizer</code> </td> <td> Regularizer object to call to apply penalty on the weight. These penalties are summed into the loss function during optimization. Defaults to <code translate="no" dir="ltr">None</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">constraint</code> </td> <td> Contrainst object to call on the variable after any optimizer update, or string name of a built-in constraint. Defaults to <code translate="no" dir="ltr">None</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">aggregation</code> </td> <td> String, one of <code translate="no" dir="ltr">'mean'</code>, <code translate="no" dir="ltr">'sum'</code>, <code translate="no" dir="ltr">'only_first_replica'</code>. Annotates the variable with the type of multi-replica aggregation to be used for this variable when writing custom data parallel training loops. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">name</code> </td> <td> String name of the variable. Useful for debugging purposes. </td> </tr> </table> <h3 id="build" data-text="build" tabindex="-1"><code translate="no" dir="ltr">build</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L357-L369">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">build(
    input_shape
)
</pre></devsite-code> <h3 id="build_from_config" data-text="build_from_config" tabindex="-1"><code translate="no" dir="ltr">build_from_config</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L408-L424">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">build_from_config(
    config
)
</pre></devsite-code> <p>Builds the layer's states with the supplied config dict.</p> <p>By default, this method calls the <code translate="no" dir="ltr">build(config["input_shape"])</code> method, which creates weights based on the layer's input shape in the supplied config. If your config contains other information needed to load the layer's state, you should override this method.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">config</code> </td> <td> Dict containing the input shape associated with this layer. </td> </tr> </table> <h3 id="call" data-text="call" tabindex="-1"><code translate="no" dir="ltr">call</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L889-L893">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">call(
    *args, **kwargs
)
</pre></devsite-code> <h3 id="compute_mask" data-text="compute_mask" tabindex="-1"><code translate="no" dir="ltr">compute_mask</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L720-L722">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">compute_mask(
    inputs, previous_mask
)
</pre></devsite-code> <h3 id="compute_output_shape" data-text="compute_output_shape" tabindex="-1"><code translate="no" dir="ltr">compute_output_shape</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1053-L1058">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">compute_output_shape(
    *args, **kwargs
)
</pre></devsite-code> <h3 id="compute_output_spec" data-text="compute_output_spec" tabindex="-1"><code translate="no" dir="ltr">compute_output_spec</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1009-L1051">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">compute_output_spec(
    *args, **kwargs
)
</pre></devsite-code> <h3 id="count_params" data-text="count_params" tabindex="-1"><code translate="no" dir="ltr">count_params</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1248-L1262">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">count_params()
</pre></devsite-code> <p>Count the total number of scalars composing the weights.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> An integer count. </td> </tr> 
</table> <h3 id="from_config" data-text="from_config" tabindex="-1"><code translate="no" dir="ltr">from_config</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/ops/operation.py#L191-L213">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">@classmethod
from_config(
    config
)
</pre></devsite-code> <p>Creates a layer from its config.</p> <p>This method is the reverse of <code translate="no" dir="ltr">get_config</code>, capable of instantiating the same layer from the config dictionary. It does not handle layer connectivity (handled by Network), nor weights (handled by <code translate="no" dir="ltr">set_weights</code>).</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">config</code> </td> <td> A Python dictionary, typically the output of get_config. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A layer instance. </td> </tr> 
</table> <h3 id="get_build_config" data-text="get_build_config" tabindex="-1"><code translate="no" dir="ltr">get_build_config</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L384-L406">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">get_build_config()
</pre></devsite-code> <p>Returns a dictionary with the layer's input shape.</p> <p>This method returns a config dict that can be used by <code translate="no" dir="ltr">build_from_config(config)</code> to create all states (e.g. Variables and Lookup tables) needed by the layer.</p> <p>By default, the config only contains the input shape that the layer was built with. If you're writing a custom layer that creates state in an unusual way, you should override this method to make sure this state is already created when Keras attempts to load its value upon model loading.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A dict containing the input shape associated with the layer. </td> </tr> 
</table> <h3 id="get_config" data-text="get_config" tabindex="-1"><code translate="no" dir="ltr">get_config</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1435-L1443">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">get_config()
</pre></devsite-code> <p>Returns the config of the object.</p> <p>An object config is a Python dictionary (serializable) containing the information needed to re-instantiate it.</p> <h3 id="get_weights" data-text="get_weights" tabindex="-1"><code translate="no" dir="ltr">get_weights</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L658-L660">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">get_weights()
</pre></devsite-code> <p>Return the values of <code translate="no" dir="ltr">layer.weights</code> as a list of NumPy arrays.</p> <h3 id="load_own_variables" data-text="load_own_variables" tabindex="-1"><code translate="no" dir="ltr">load_own_variables</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1183-L1225">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">load_own_variables(
    store
)
</pre></devsite-code> <p>Loads the state of the layer.</p> <p>You can override this method to take full control of how the state of the layer is loaded upon calling <a href="../models/load_model.html"><code translate="no" dir="ltr">keras.models.load_model()</code></a>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">store</code> </td> <td> Dict from which the state of the model will be loaded. </td> </tr> </table> <h3 id="quantize" data-text="quantize" tabindex="-1"><code translate="no" dir="ltr">quantize</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1137-L1141">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">quantize(
    mode
)
</pre></devsite-code> <h3 id="quantized_call" data-text="quantized_call" tabindex="-1"><code translate="no" dir="ltr">quantized_call</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L895-L899">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">quantized_call(
    *args, **kwargs
)
</pre></devsite-code> <h3 id="save_own_variables" data-text="save_own_variables" tabindex="-1"><code translate="no" dir="ltr">save_own_variables</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L1170-L1181">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">save_own_variables(
    store
)
</pre></devsite-code> <p>Saves the state of the layer.</p> <p>You can override this method to take full control of how the state of the layer is saved upon calling <code translate="no" dir="ltr">model.save()</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">store</code> </td> <td> Dict where the state of the model will be saved. </td> </tr> </table> <h3 id="set_weights" data-text="set_weights" tabindex="-1"><code translate="no" dir="ltr">set_weights</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L662-L678">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">set_weights(
    weights
)
</pre></devsite-code> <p>Sets the values of <code translate="no" dir="ltr">layer.weights</code> from a list of NumPy arrays.</p> <h3 id="stateless_call" data-text="stateless_call" tabindex="-1"><code translate="no" dir="ltr">stateless_call</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L901-L1007">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">stateless_call(
    trainable_variables,
    non_trainable_variables,
    *args,
    return_losses=False,
    **kwargs
)
</pre></devsite-code> <p>Call the layer without any side effects.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">trainable_variables</code> </td> <td> List of trainable variables of the model. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">non_trainable_variables</code> </td> <td> List of non-trainable variables of the model. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">*args</code> </td> <td> Positional arguments to be passed to <code translate="no" dir="ltr">call()</code>. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">return_losses</code> </td> <td> If <code translate="no" dir="ltr">True</code>, <code translate="no" dir="ltr">stateless_call()</code> will return the list of losses created during <code translate="no" dir="ltr">call()</code> as part of its return values. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">**kwargs</code> </td> <td> Keyword arguments to be passed to <code translate="no" dir="ltr">call()</code>. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A tuple. By default, returns <code translate="no" dir="ltr">(outputs, non_trainable_variables)</code>. If <code translate="no" dir="ltr">return_losses = True</code>, then returns <code translate="no" dir="ltr">(outputs, non_trainable_variables, losses)</code>. </td> </tr> 
</table> <blockquote class="note">
<strong>Note:</strong><span> <code translate="no" dir="ltr">non_trainable_variables</code> include not only non-trainable weights such as <code translate="no" dir="ltr">BatchNormalization</code> statistics, but also RNG seed state (if there are any random operations part of the layer, such as dropout), and <code translate="no" dir="ltr">Metric</code> state (if there are any metrics attached to the layer). These are all elements of state of the layer.</span>
</blockquote> <h4 id="example_2" data-text="Example:" tabindex="-1">Example:</h4> 
<devsite-code><pre class="devsite-click-to-copy" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">model = ...
data = ...
trainable_variables = model.trainable_variables
non_trainable_variables = model.non_trainable_variables
# Call the model with zero side effects
outputs, non_trainable_variables = model.stateless_call(
    trainable_variables,
    non_trainable_variables,
    data,
)
# Attach the updated state to the model
# (until you do this, the model is still in its pre-call state).
for ref_var, value in zip(
    model.non_trainable_variables, non_trainable_variables
):
    ref_var.assign(value)
</pre></devsite-code> <h3 id="symbolic_call" data-text="symbolic_call" tabindex="-1"><code translate="no" dir="ltr">symbolic_call</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/ops/operation.py#L58-L70">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">symbolic_call(
    *args, **kwargs
)
</pre></devsite-code> <h3 id="__call__" data-text="__call__" tabindex="-1"><code translate="no" dir="ltr">__call__</code></h3> <p><a target="_blank" class="external" href="https://github.com/keras-team/keras/tree/v3.3.3/keras/src/layers/layer.py#L724-L887">View source</a></p> 
<devsite-code><pre class="devsite-click-to-copy tfo-signature-link" translate="no" dir="ltr" is-upgraded syntax="Python" data-language="cpp">__call__(
    *args, **kwargs
)
</pre></devsite-code> <p>Call self as a function.</p>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating> <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Layer" class="_attribution-link">https://www.tensorflow.org/api_docs/python/tf/keras/layers/Layer</a>
  </p>
</div>
