<h1 class="devsite-page-title">tf.keras.models.load_model</h1> <devsite-bookmark></devsite-bookmark>      <table class="tfo-notebook-buttons tfo-api nocontent" align="left">  <td> <a target="_blank" href="https://github.com/keras-team/keras/tree/v2.9.0/keras/saving/save.py#L157-L224">  View source on GitHub </a> </td> </table> <p>Loads a model saved via <code translate="no" dir="ltr">model.save()</code>.</p> <section class="expandable"> <h4 class="showalways" id="view-aliases" data-text="View aliases">View aliases</h4> <p> <b>Compat aliases for migration</b> </p>
<p>See <a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for more details.</p> <p><a href="https://www.tensorflow.org/api_docs/python/tf/keras/models/load_model"><code translate="no" dir="ltr">tf.compat.v1.keras.models.load_model</code></a></p> </section> <pre class="devsite-click-to-copy prettyprint lang-py tfo-signature-link" translate="no" dir="ltr" data-language="cpp">
tf.keras.models.load_model(
    filepath, custom_objects=None, compile=True, options=None
)
</pre>  <h4 id="usage" data-text="Usage:">Usage:</h4> <pre class="devsite-click-to-copy prettyprint lang-py" translate="no" dir="ltr" data-language="cpp">
model = tf.keras.Sequential([
    tf.keras.layers.Dense(5, input_shape=(3,)),
    tf.keras.layers.Softmax()])
model.save('/tmp/model')
loaded_model = tf.keras.models.load_model('/tmp/model')
x = tf.random.uniform((10, 3))
assert np.allclose(model.predict(x), loaded_model.predict(x))
</pre> <p>Note that the model weights may have different scoped names after being loaded. Scoped names include the model/layer names, such as <code translate="no" dir="ltr">"dense_1/kernel:0"</code>. It is recommended that you use the layer properties to access specific variables, e.g. <code translate="no" dir="ltr">model.get_layer("dense_1").kernel</code>.</p>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Args</th></tr> 
<tr> <td> <code translate="no" dir="ltr">filepath</code> </td> <td> One of the following: <ul> <li>String or <code translate="no" dir="ltr">pathlib.Path</code> object, path to the saved model</li> <li>
<code translate="no" dir="ltr">h5py.File</code> object from which to load the model </li>
</ul>
</td> </tr>
<tr> <td> <code translate="no" dir="ltr">custom_objects</code> </td> <td> Optional dictionary mapping names (strings) to custom classes or functions to be considered during deserialization. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">compile</code> </td> <td> Boolean, whether to compile the model after loading. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">options</code> </td> <td> Optional <a href="../../saved_model/loadoptions.html"><code translate="no" dir="ltr">tf.saved_model.LoadOptions</code></a> object that specifies options for loading from SavedModel. </td> </tr> </table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Returns</th></tr> <tr class="alt"> <td colspan="2"> A Keras model instance. If the original model was compiled, and saved with the optimizer, then the returned model will be compiled. Otherwise, the model will be left uncompiled. In the case that an uncompiled model is returned, a warning is displayed if the <code translate="no" dir="ltr">compile</code> argument is set to <code translate="no" dir="ltr">True</code>. </td> </tr> 
</table>  
<table class="responsive fixed orange"> <colgroup>
<col width="214px">
<col>
</colgroup> <tr><th colspan="2">Raises</th></tr> 
<tr> <td> <code translate="no" dir="ltr">ImportError</code> </td> <td> if loading from an hdf5 file and h5py is not available. </td> </tr>
<tr> <td> <code translate="no" dir="ltr">IOError</code> </td> <td> In case of an invalid savefile. </td> </tr> </table>  <devsite-thumb-rating position="footer"> </devsite-thumb-rating><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2022 The TensorFlow Authors. All rights reserved.<br>Licensed under the Creative Commons Attribution License 4.0.<br>Code samples licensed under the Apache 2.0 License.<br>
    <a href="https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/keras/models/load_model" class="_attribution-link">https://www.tensorflow.org/versions/r2.9/api_docs/python/tf/keras/models/load_model</a>
  </p>
</div>
