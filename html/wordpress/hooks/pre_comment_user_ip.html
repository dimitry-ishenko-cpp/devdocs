<h1 class="wp-block-wporg-code-reference-title">
<span class="hook-func">apply_filters</span>( ‘pre_comment_user_ip’, <nobr><span class="arg-type">string</span> <span class="arg-name">$comment_author_ip</span></nobr> )</h1> <section><p>Filters the comment author’s IP address before it is set.</p> </section> <section><h2 id="parameters">Parameters</h2> <dl>
<dt>
<code>$comment_author_ip</code><span class="type"><span class="string">string</span></span>
</dt>
<dd><div class="desc"><span class="description">The comment author’s IP address.</span></div></dd>
</dl></section> <section><h2 id="more-information">More Information</h2> <p>With this filter, we can change the comment author’s IP before it’s recorded. Example use case can be when a client submits a comment through a proxy server.</p> <p>The general format of the header is:<br> <code>X-Forwarded-For: client1, proxy1, proxy2</code></p> <p>where the value is a comma+space separated list of IP addresses, the left-most being the original client, and each successive proxy that passed the request adding the IP address where it received the request from. In this example, the request goes through the IPs: client1 -&gt; proxy1 -&gt; proxy2 -&gt; proxy3. Proxy3 is not shown in the <code>X-Forwarded-For</code> header here and appears as the remote address of the request.</p> <p>Since it is easy to forge an <code>X-Forwarded-For</code> header, the given information should be used with care.</p> <p><code>X-Forwarded-For</code>, <code>X-Forwarded-By</code>, and <code>X-Forwarded-Proto</code> are non-standard header fields and in increasing cases, have been superseded by the standard <code>Forwarded</code> header defined in RFC 7239. Example of a <code>Forwarded</code> header:<br> <code>Forwarded: for=192.0.2.60;proto=http;by=203.0.113.43</code></p> </section> <section><h2 id="source">Source</h2> <pre class="wp-block-code" data-start="2151" aria-label="Function source code" data-language="php"><code id="wporg-source-code" lang="php" class="language-php line-numbers">$commentdata['comment_author_IP'] = apply_filters( 'pre_comment_user_ip', $commentdata['comment_author_IP'] );
</code></pre>
<p class="wporg-dot-link-list"><a href="https://developer.wordpress.org/reference/files/wp-includes/comment.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/comment.php#L2151">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/comment.php#L2151-L2151">View on GitHub</a></p></section>  <section><h2 id="changelog">Changelog</h2> <section style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table "><table>
<thead><tr>
<th scope="col">Version</th>
<th scope="col">Description</th>
</tr></thead>
<tbody><tr class="">
<td><a href="https://developer.wordpress.org/reference/since/1.5.0/">1.5.0</a></td>
<td>Introduced.</td>
</tr></tbody>
</table></figure></section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2024 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/hooks/pre_comment_user_ip" class="_attribution-link">https://developer.wordpress.org/reference/hooks/pre_comment_user_ip</a>
  </p>
</div>
