<h1 class="wp-block-wporg-code-reference-title">
<span class="hook-func">apply_filters</span>( ‘pre_comment_approved’, <nobr><span class="arg-type">int|string|WP_Error</span> <span class="arg-name">$approved</span></nobr>, <nobr><span class="arg-type">array</span> <span class="arg-name">$commentdata</span></nobr> )</h1> <section><p>Filters a comment’s approval status before it is set.</p> </section> <section><h2 id="parameters">Parameters</h2> <dl>
<dt>
<code>$approved</code><span class="type"><span class="int">int</span>|<span class="string">string</span>|<span class="WP_Error"><a href="../classes/wp_error.html" rel="class">WP_Error</a></span></span>
</dt>
<dd><div class="desc"><span class="description">The approval status. Accepts 1, 0, <code>'spam'</code>, <code>'trash'</code>, or <a href="../classes/wp_error.html" rel="class">WP_Error</a>.</span></div></dd>
<dt>
<code>$commentdata</code><span class="type"><span class="array">array</span></span>
</dt>
<dd><div class="desc"><span class="description">Comment data.</span></div></dd>
</dl></section> <section><h2 id="more-information">More Information</h2> <ul class="wp-block-list"> <li>A filter hook called by the <a href="../functions/wp_allow_comment.html" rel="function">wp_allow_comment()</a> function prior to inserting a comment into the database. The filter is applied to the proposed comment’s approval status, allowing a plugin to override.</li> <li>
<a href="../functions/wp_allow_comment.html" rel="function">wp_allow_comment()</a> handles the preliminary approval checking, and that approval status is passed through this filter before it returns.</li> <li>The <code>$commentdata</code> array contains the same indices as the array returned by <a href="../classes/wp_comment_query/get_comments.html">WP_Comment_Query::get_comments()</a>, including:<br> <code><br>
   'comment_post_ID'      - The post to which the comment will apply<br>
   'comment_author'       - (may be empty)<br>
   'comment_author_email' - (may be empty)<br>
   'comment_author_url'   - (may be empty)<br>
   'comment_author_IP'    - IP address<br>
   'comment_agent'        - e.g., "Mozilla/5.0..."<br>
   'comment_content'      - The text of the proposed comment<br>
   'comment_type'         - 'pingback', 'trackback', or empty for regular comments<br>
   'user_ID'              - (empty if not logged in)<br>
</code>
</li> <li>Return Values:<br> <code><br>
0 (int) comment is marked for moderation as "Pending"<br>
1 (int) comment is marked for immediate publication as "Approved"<br>
'spam' (string) comment is marked as "Spam"<br>
'trash' (string) comment is to be put in the Trash<br>
</code><br> In all cases the comment is added to the database, even spam. Comments marked as spam will never be visible on the front end. Spam comments are kept for possible analysis by plugins. </li> <li>Prior to WP 3.1, the filter was not passed $comment_data and instead was expected to use global variables such as <em>$comment_ID</em> to access information about the comment. (see: <a href="https://core.trac.wordpress.org/ticket/14802">https://core.trac.wordpress.org/ticket/14802</a> )</li> </ul> </section> <section><h2 id="source">Source</h2> <pre class="wp-block-code" data-start="1309" aria-label="Function source code" data-language="php"><code id="wporg-source-code" lang="php" class="language-php line-numbers">return apply_filters( 'pre_comment_approved', $approved, $comment_data );
</code></pre>
<p class="wporg-dot-link-list"><a href="https://developer.wordpress.org/reference/files/wp-includes/comment.php/">View all references</a> <a href="https://core.trac.wordpress.org/browser/tags/6.7/src/wp-includes/comment.php#L1309">View on Trac</a> <a href="https://github.com/WordPress/wordpress-develop/blob/6.7/src/wp-includes/comment.php#L1309-L1309">View on GitHub</a></p></section>  <section><h2 id="changelog">Changelog</h2> <section style="margin-top:var(--wp--preset--spacing--20);"><figure class="wp-block-table "><table>
<thead><tr>
<th scope="col">Version</th>
<th scope="col">Description</th>
</tr></thead>
<tbody>
<tr class="">
<td><a href="https://developer.wordpress.org/reference/since/4.9.0/">4.9.0</a></td>
<td><span class="since-description">Returning a <a href="../classes/wp_error.html" rel="class">WP_Error</a> value from the filter will short-circuit comment insertion and allow skipping further processing.</span></td>
</tr>
<tr class="">
<td><a href="https://developer.wordpress.org/reference/since/2.1.0/">2.1.0</a></td>
<td>Introduced.</td>
</tr>
</tbody>
</table></figure></section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2024 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/hooks/pre_comment_approved" class="_attribution-link">https://developer.wordpress.org/reference/hooks/pre_comment_approved</a>
  </p>
</div>
