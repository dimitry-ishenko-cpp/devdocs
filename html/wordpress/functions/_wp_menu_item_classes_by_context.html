<h1>_wp_menu_item_classes_by_context( array $menu_items )</h1> <div class="callout callout-alert">
<p> This functionâ€™s access is marked private. This means it is not intended for use by plugin or theme developers, only in other core functions. It is listed here for completeness.</p> </div>  <section> <p>Adds the class property classes for the current context, if applicable.</p> </section>   <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$menu_items</code> <span class="type"><span class="array">array</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">The current menu item objects to which to add the class property information.</span> </div> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/nav-menu-template.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/nav-menu-template.php/">View all references</a> </p> <pre class="wp-block-code" data-start="328" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function _wp_menu_item_classes_by_context( &amp;$menu_items ) {
	global $wp_query, $wp_rewrite;

	$queried_object    = $wp_query-&gt;get_queried_object();
	$queried_object_id = (int) $wp_query-&gt;queried_object_id;

	$active_object               = '';
	$active_ancestor_item_ids    = array();
	$active_parent_item_ids      = array();
	$active_parent_object_ids    = array();
	$possible_taxonomy_ancestors = array();
	$possible_object_parents     = array();
	$home_page_id                = (int) get_option( 'page_for_posts' );

	if ( $wp_query-&gt;is_singular &amp;&amp; ! empty( $queried_object-&gt;post_type ) &amp;&amp; ! is_post_type_hierarchical( $queried_object-&gt;post_type ) ) {
		foreach ( (array) get_object_taxonomies( $queried_object-&gt;post_type ) as $taxonomy ) {
			if ( is_taxonomy_hierarchical( $taxonomy ) ) {
				$term_hierarchy = _get_term_hierarchy( $taxonomy );
				$terms          = wp_get_object_terms( $queried_object_id, $taxonomy, array( 'fields' =&gt; 'ids' ) );
				if ( is_array( $terms ) ) {
					$possible_object_parents = array_merge( $possible_object_parents, $terms );
					$term_to_ancestor        = array();
					foreach ( (array) $term_hierarchy as $anc =&gt; $descs ) {
						foreach ( (array) $descs as $desc ) {
							$term_to_ancestor[ $desc ] = $anc;
						}
					}

					foreach ( $terms as $desc ) {
						do {
							$possible_taxonomy_ancestors[ $taxonomy ][] = $desc;
							if ( isset( $term_to_ancestor[ $desc ] ) ) {
								$_desc = $term_to_ancestor[ $desc ];
								unset( $term_to_ancestor[ $desc ] );
								$desc = $_desc;
							} else {
								$desc = 0;
							}
						} while ( ! empty( $desc ) );
					}
				}
			}
		}
	} elseif ( ! empty( $queried_object-&gt;taxonomy ) &amp;&amp; is_taxonomy_hierarchical( $queried_object-&gt;taxonomy ) ) {
		$term_hierarchy   = _get_term_hierarchy( $queried_object-&gt;taxonomy );
		$term_to_ancestor = array();
		foreach ( (array) $term_hierarchy as $anc =&gt; $descs ) {
			foreach ( (array) $descs as $desc ) {
				$term_to_ancestor[ $desc ] = $anc;
			}
		}
		$desc = $queried_object-&gt;term_id;
		do {
			$possible_taxonomy_ancestors[ $queried_object-&gt;taxonomy ][] = $desc;
			if ( isset( $term_to_ancestor[ $desc ] ) ) {
				$_desc = $term_to_ancestor[ $desc ];
				unset( $term_to_ancestor[ $desc ] );
				$desc = $_desc;
			} else {
				$desc = 0;
			}
		} while ( ! empty( $desc ) );
	}

	$possible_object_parents = array_filter( $possible_object_parents );

	$front_page_url         = home_url();
	$front_page_id          = (int) get_option( 'page_on_front' );
	$privacy_policy_page_id = (int) get_option( 'wp_page_for_privacy_policy' );

	foreach ( (array) $menu_items as $key =&gt; $menu_item ) {

		$menu_items[ $key ]-&gt;current = false;

		$classes   = (array) $menu_item-&gt;classes;
		$classes[] = 'menu-item';
		$classes[] = 'menu-item-type-' . $menu_item-&gt;type;
		$classes[] = 'menu-item-object-' . $menu_item-&gt;object;

		// This menu item is set as the 'Front Page'.
		if ( 'post_type' === $menu_item-&gt;type &amp;&amp; $front_page_id === (int) $menu_item-&gt;object_id ) {
			$classes[] = 'menu-item-home';
		}

		// This menu item is set as the 'Privacy Policy Page'.
		if ( 'post_type' === $menu_item-&gt;type &amp;&amp; $privacy_policy_page_id === (int) $menu_item-&gt;object_id ) {
			$classes[] = 'menu-item-privacy-policy';
		}

		// If the menu item corresponds to a taxonomy term for the currently queried non-hierarchical post object.
		if ( $wp_query-&gt;is_singular &amp;&amp; 'taxonomy' === $menu_item-&gt;type
			&amp;&amp; in_array( (int) $menu_item-&gt;object_id, $possible_object_parents, true )
		) {
			$active_parent_object_ids[] = (int) $menu_item-&gt;object_id;
			$active_parent_item_ids[]   = (int) $menu_item-&gt;db_id;
			$active_object              = $queried_object-&gt;post_type;

			// If the menu item corresponds to the currently queried post or taxonomy object.
		} elseif (
			$menu_item-&gt;object_id == $queried_object_id
			&amp;&amp; (
				( ! empty( $home_page_id ) &amp;&amp; 'post_type' === $menu_item-&gt;type
					&amp;&amp; $wp_query-&gt;is_home &amp;&amp; $home_page_id == $menu_item-&gt;object_id )
				|| ( 'post_type' === $menu_item-&gt;type &amp;&amp; $wp_query-&gt;is_singular )
				|| ( 'taxonomy' === $menu_item-&gt;type
					&amp;&amp; ( $wp_query-&gt;is_category || $wp_query-&gt;is_tag || $wp_query-&gt;is_tax )
					&amp;&amp; $queried_object-&gt;taxonomy == $menu_item-&gt;object )
			)
		) {
			$classes[]                   = 'current-menu-item';
			$menu_items[ $key ]-&gt;current = true;
			$_anc_id                     = (int) $menu_item-&gt;db_id;

			while (
				( $_anc_id = (int) get_post_meta( $_anc_id, '_menu_item_menu_item_parent', true ) )
				&amp;&amp; ! in_array( $_anc_id, $active_ancestor_item_ids, true )
			) {
				$active_ancestor_item_ids[] = $_anc_id;
			}

			if ( 'post_type' === $menu_item-&gt;type &amp;&amp; 'page' === $menu_item-&gt;object ) {
				// Back compat classes for pages to match wp_page_menu().
				$classes[] = 'page_item';
				$classes[] = 'page-item-' . $menu_item-&gt;object_id;
				$classes[] = 'current_page_item';
			}

			$active_parent_item_ids[]   = (int) $menu_item-&gt;menu_item_parent;
			$active_parent_object_ids[] = (int) $menu_item-&gt;post_parent;
			$active_object              = $menu_item-&gt;object;

			// If the menu item corresponds to the currently queried post type archive.
		} elseif (
			'post_type_archive' === $menu_item-&gt;type
			&amp;&amp; is_post_type_archive( array( $menu_item-&gt;object ) )
		) {
			$classes[]                   = 'current-menu-item';
			$menu_items[ $key ]-&gt;current = true;
			$_anc_id                     = (int) $menu_item-&gt;db_id;

			while (
				( $_anc_id = (int) get_post_meta( $_anc_id, '_menu_item_menu_item_parent', true ) )
				&amp;&amp; ! in_array( $_anc_id, $active_ancestor_item_ids, true )
			) {
				$active_ancestor_item_ids[] = $_anc_id;
			}

			$active_parent_item_ids[] = (int) $menu_item-&gt;menu_item_parent;

			// If the menu item corresponds to the currently requested URL.
		} elseif ( 'custom' === $menu_item-&gt;object &amp;&amp; isset( $_SERVER['HTTP_HOST'] ) ) {
			$_root_relative_current = untrailingslashit( $_SERVER['REQUEST_URI'] );

			// If it's the customize page then it will strip the query var off the URL before entering the comparison block.
			if ( is_customize_preview() ) {
				$_root_relative_current = strtok( untrailingslashit( $_SERVER['REQUEST_URI'] ), '?' );
			}

			$current_url        = set_url_scheme( 'http://' . $_SERVER['HTTP_HOST'] . $_root_relative_current );
			$raw_item_url       = strpos( $menu_item-&gt;url, '#' ) ? substr( $menu_item-&gt;url, 0, strpos( $menu_item-&gt;url, '#' ) ) : $menu_item-&gt;url;
			$item_url           = set_url_scheme( untrailingslashit( $raw_item_url ) );
			$_indexless_current = untrailingslashit( preg_replace( '/' . preg_quote( $wp_rewrite-&gt;index, '/' ) . '$/', '', $current_url ) );

			$matches = array(
				$current_url,
				urldecode( $current_url ),
				$_indexless_current,
				urldecode( $_indexless_current ),
				$_root_relative_current,
				urldecode( $_root_relative_current ),
			);

			if ( $raw_item_url &amp;&amp; in_array( $item_url, $matches, true ) ) {
				$classes[]                   = 'current-menu-item';
				$menu_items[ $key ]-&gt;current = true;
				$_anc_id                     = (int) $menu_item-&gt;db_id;

				while (
					( $_anc_id = (int) get_post_meta( $_anc_id, '_menu_item_menu_item_parent', true ) )
					&amp;&amp; ! in_array( $_anc_id, $active_ancestor_item_ids, true )
				) {
					$active_ancestor_item_ids[] = $_anc_id;
				}

				if ( in_array( home_url(), array( untrailingslashit( $current_url ), untrailingslashit( $_indexless_current ) ), true ) ) {
					// Back compat for home link to match wp_page_menu().
					$classes[] = 'current_page_item';
				}
				$active_parent_item_ids[]   = (int) $menu_item-&gt;menu_item_parent;
				$active_parent_object_ids[] = (int) $menu_item-&gt;post_parent;
				$active_object              = $menu_item-&gt;object;

				// Give front page item the 'current-menu-item' class when extra query arguments are involved.
			} elseif ( $item_url == $front_page_url &amp;&amp; is_front_page() ) {
				$classes[] = 'current-menu-item';
			}

			if ( untrailingslashit( $item_url ) == home_url() ) {
				$classes[] = 'menu-item-home';
			}
		}

		// Back-compat with wp_page_menu(): add "current_page_parent" to static home page link for any non-page query.
		if ( ! empty( $home_page_id ) &amp;&amp; 'post_type' === $menu_item-&gt;type
			&amp;&amp; empty( $wp_query-&gt;is_page ) &amp;&amp; $home_page_id == $menu_item-&gt;object_id
		) {
			$classes[] = 'current_page_parent';
		}

		$menu_items[ $key ]-&gt;classes = array_unique( $classes );
	}
	$active_ancestor_item_ids = array_filter( array_unique( $active_ancestor_item_ids ) );
	$active_parent_item_ids   = array_filter( array_unique( $active_parent_item_ids ) );
	$active_parent_object_ids = array_filter( array_unique( $active_parent_object_ids ) );

	// Set parent's class.
	foreach ( (array) $menu_items as $key =&gt; $parent_item ) {
		$classes                                   = (array) $parent_item-&gt;classes;
		$menu_items[ $key ]-&gt;current_item_ancestor = false;
		$menu_items[ $key ]-&gt;current_item_parent   = false;

		if (
			isset( $parent_item-&gt;type )
			&amp;&amp; (
				// Ancestral post object.
				(
					'post_type' === $parent_item-&gt;type
					&amp;&amp; ! empty( $queried_object-&gt;post_type )
					&amp;&amp; is_post_type_hierarchical( $queried_object-&gt;post_type )
					&amp;&amp; in_array( (int) $parent_item-&gt;object_id, $queried_object-&gt;ancestors, true )
					&amp;&amp; $parent_item-&gt;object != $queried_object-&gt;ID
				) ||

				// Ancestral term.
				(
					'taxonomy' === $parent_item-&gt;type
					&amp;&amp; isset( $possible_taxonomy_ancestors[ $parent_item-&gt;object ] )
					&amp;&amp; in_array( (int) $parent_item-&gt;object_id, $possible_taxonomy_ancestors[ $parent_item-&gt;object ], true )
					&amp;&amp; (
						! isset( $queried_object-&gt;term_id ) ||
						$parent_item-&gt;object_id != $queried_object-&gt;term_id
					)
				)
			)
		) {
			if ( ! empty( $queried_object-&gt;taxonomy ) ) {
				$classes[] = 'current-' . $queried_object-&gt;taxonomy . '-ancestor';
			} else {
				$classes[] = 'current-' . $queried_object-&gt;post_type . '-ancestor';
			}
		}

		if ( in_array( (int) $parent_item-&gt;db_id, $active_ancestor_item_ids, true ) ) {
			$classes[] = 'current-menu-ancestor';

			$menu_items[ $key ]-&gt;current_item_ancestor = true;
		}
		if ( in_array( (int) $parent_item-&gt;db_id, $active_parent_item_ids, true ) ) {
			$classes[] = 'current-menu-parent';

			$menu_items[ $key ]-&gt;current_item_parent = true;
		}
		if ( in_array( (int) $parent_item-&gt;object_id, $active_parent_object_ids, true ) ) {
			$classes[] = 'current-' . $active_object . '-parent';
		}

		if ( 'post_type' === $parent_item-&gt;type &amp;&amp; 'page' === $parent_item-&gt;object ) {
			// Back compat classes for pages to match wp_page_menu().
			if ( in_array( 'current-menu-parent', $classes, true ) ) {
				$classes[] = 'current_page_parent';
			}
			if ( in_array( 'current-menu-ancestor', $classes, true ) ) {
				$classes[] = 'current_page_ancestor';
			}
		}

		$menu_items[ $key ]-&gt;classes = array_unique( $classes );
	}
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="5">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="is_customize_preview.html">is_customize_preview()</a> <span>wp-includes/theme.php</span> </td> <td class="related-desc"> <p>Whether the site is being previewed in the Customizer.</p> </td> </tr> <tr> <td class="related-title"> <a href="untrailingslashit.html">untrailingslashit()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Removes trailing forward slashes and backslashes if they exist.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_query/get_queried_object.html">WP_Query::get_queried_object()</a> <span>wp-includes/class-wp-query.php</span> </td> <td class="related-desc"> <p>Retrieves the currently queried object.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_front_page.html">is_front_page()</a> <span>wp-includes/query.php</span> </td> <td class="related-desc"> <p>Determines whether the query is for the front page of the site.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_post_type_archive.html">is_post_type_archive()</a> <span>wp-includes/query.php</span> </td> <td class="related-desc"> <p>Determines whether the query is for an existing post type archive page.</p> </td> </tr> <tr> <td class="related-title"> <a href="_get_term_hierarchy.html">_get_term_hierarchy()</a> <span>wp-includes/taxonomy.php</span> </td> <td class="related-desc"> <p>Retrieves children of taxonomy as term IDs.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_get_object_terms.html">wp_get_object_terms()</a> <span>wp-includes/taxonomy.php</span> </td> <td class="related-desc"> <p>Retrieves the terms associated with the given object(s), in the supplied taxonomies.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_object_taxonomies.html">get_object_taxonomies()</a> <span>wp-includes/taxonomy.php</span> </td> <td class="related-desc"> <p>Returns the names or objects of the taxonomies which are registered for the requested object or object type, such as a post object or post type name.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_taxonomy_hierarchical.html">is_taxonomy_hierarchical()</a> <span>wp-includes/taxonomy.php</span> </td> <td class="related-desc"> <p>Determines whether the taxonomy object is hierarchical.</p> </td> </tr> <tr> <td class="related-title"> <a href="set_url_scheme.html">set_url_scheme()</a> <span>wp-includes/link-template.php</span> </td> <td class="related-desc"> <p>Sets the scheme for a URL.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_post_type_hierarchical.html">is_post_type_hierarchical()</a> <span>wp-includes/post.php</span> </td> <td class="related-desc"> <p>Determines whether the post type is hierarchical.</p> </td> </tr> <tr> <td class="related-title"> <a href="home_url.html">home_url()</a> <span>wp-includes/link-template.php</span> </td> <td class="related-desc"> <p>Retrieves the URL for the current site where the front end is accessible.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_option.html">get_option()</a> <span>wp-includes/option.php</span> </td> <td class="related-desc"> <p>Retrieves an option value based on an option name.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_post_meta.html">get_post_meta()</a> <span>wp-includes/post.php</span> </td> <td class="related-desc"> <p>Retrieves a post meta field for the given post ID.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="wp_nav_menu.html">wp_nav_menu()</a> <span>wp-includes/nav-menu-template.php</span> </td> <td class="related-desc"> <p>Displays a navigation menu.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/3.0.0/" alt="WordPress 3.0.0">3.0.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/_wp_menu_item_classes_by_context" class="_attribution-link">https://developer.wordpress.org/reference/functions/_wp_menu_item_classes_by_context</a>
  </p>
</div>
