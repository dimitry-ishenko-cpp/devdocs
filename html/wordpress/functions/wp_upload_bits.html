<h1>wp_upload_bits( string $name, null|string $deprecated, string $bits, string $time = null ): array</h1>  <section> <p>Creates a file in the upload folder with given content.</p> </section>   <section> <header class="toc-header"><h2 id="description">Description</h2></header> <p>If there is an error, then the key ‘error’ will exist with the error message.<br>If success, then the key ‘file’ will have the unique file path, the ‘url’ key will have the link to the new file. and the ‘error’ key will be set to false.</p> <p>This function will not move an uploaded file to the upload folder. It will create a new file with the content in $bits parameter. If you move the upload file, read the content of the uploaded file, and then you can give the filename and content to this function, which will add it to the upload folder.</p> <p>The permissions will be set on the new file automatically by this function.</p> </section>  <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$name</code> <span class="type"><span class="string">string</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Filename.</span> </div> </dd> <dt> <code>$deprecated</code> <span class="type"><span class="null">null</span>|<span class="string">string</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Never used. Set to null.</span> </div> </dd> <dt> <code>$bits</code> <span class="type"><span class="string">string</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">File content</span> </div> </dd> <dt> <code>$time</code> <span class="type"><span class="string">string</span></span> <span class="required">Optional</span> </dt> <dd> <div class="desc"> <span class="description"> Time formatted in <code>'yyyy/mm'</code>. </span> </div> <p class="default">Default: <code>null</code></p> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type">array</span> Information about the newly-uploaded file.<br> </p>
<ul class="param-hash">
<li>
<code>file</code><span class="type">string</span><div class="desc">Filename of the newly-uploaded file.</div>
</li> <li>
<code>url</code><span class="type">string</span><div class="desc">URL of the uploaded file.</div>
</li> <li>
<code>type</code><span class="type">string</span><div class="desc">File type.</div>
</li> <li>
<code>error</code><span class="type">string|false</span><div class="desc">Error message, if there has been an error.</div>
</li> </ul> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/functions.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/functions.php/">View all references</a> </p> <pre class="wp-block-code" data-start="2857" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function wp_upload_bits( $name, $deprecated, $bits, $time = null ) {
	if ( ! empty( $deprecated ) ) {
		_deprecated_argument( __FUNCTION__, '2.0.0' );
	}

	if ( empty( $name ) ) {
		return array( 'error' =&gt; __( 'Empty filename' ) );
	}

	$wp_filetype = wp_check_filetype( $name );
	if ( ! $wp_filetype['ext'] &amp;&amp; ! current_user_can( 'unfiltered_upload' ) ) {
		return array( 'error' =&gt; __( 'Sorry, you are not allowed to upload this file type.' ) );
	}

	$upload = wp_upload_dir( $time );

	if ( false !== $upload['error'] ) {
		return $upload;
	}

	/**
	 * Filters whether to treat the upload bits as an error.
	 *
	 * Returning a non-array from the filter will effectively short-circuit preparing the upload bits
	 * and return that value instead. An error message should be returned as a string.
	 *
	 * @since 3.0.0
	 *
	 * @param array|string $upload_bits_error An array of upload bits data, or error message to return.
	 */
	$upload_bits_error = apply_filters(
		'wp_upload_bits',
		array(
			'name' =&gt; $name,
			'bits' =&gt; $bits,
			'time' =&gt; $time,
		)
	);
	if ( ! is_array( $upload_bits_error ) ) {
		$upload['error'] = $upload_bits_error;
		return $upload;
	}

	$filename = wp_unique_filename( $upload['path'], $name );

	$new_file = $upload['path'] . "/$filename";
	if ( ! wp_mkdir_p( dirname( $new_file ) ) ) {
		if ( 0 === strpos( $upload['basedir'], ABSPATH ) ) {
			$error_path = str_replace( ABSPATH, '', $upload['basedir'] ) . $upload['subdir'];
		} else {
			$error_path = wp_basename( $upload['basedir'] ) . $upload['subdir'];
		}

		$message = sprintf(
			/* translators: %s: Directory path. */
			__( 'Unable to create directory %s. Is its parent directory writable by the server?' ),
			$error_path
		);
		return array( 'error' =&gt; $message );
	}

	$ifp = @fopen( $new_file, 'wb' );
	if ( ! $ifp ) {
		return array(
			/* translators: %s: File name. */
			'error' =&gt; sprintf( __( 'Could not write file %s' ), $new_file ),
		);
	}

	fwrite( $ifp, $bits );
	fclose( $ifp );
	clearstatcache();

	// Set correct file permissions.
	$stat  = @ stat( dirname( $new_file ) );
	$perms = $stat['mode'] &amp; 0007777;
	$perms = $perms &amp; 0000666;
	chmod( $new_file, $perms );
	clearstatcache();

	// Compute the URL.
	$url = $upload['url'] . "/$filename";

	if ( is_multisite() ) {
		clean_dirsize_cache( $new_file );
	}

	/** This filter is documented in wp-admin/includes/file.php */
	return apply_filters(
		'wp_handle_upload',
		array(
			'file'  =&gt; $new_file,
			'url'   =&gt; $url,
			'type'  =&gt; $wp_filetype['type'],
			'error' =&gt; false,
		),
		'sideload'
	);
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="hooks">Hooks</h2></header> <article class="hooks"> <dl> <dt class="signature-highlight"> <a href="../hooks/wp_handle_upload.html" style="text-decoration: none"> <span class="hook-func">apply_filters</span>( 'wp_handle_upload', <nobr><span class="arg-type">array</span> <span class="arg-name">$upload</span></nobr>, <nobr><span class="arg-type">string</span> <span class="arg-name">$context</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Filters the data array for the uploaded file.</p> </dd> </dl> <dl> <dt class="signature-highlight"> <a href="../hooks/wp_upload_bits.html" style="text-decoration: none"> <span class="hook-func">apply_filters</span>( 'wp_upload_bits', <nobr><span class="arg-type">array|string</span> <span class="arg-name">$upload_bits_error</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Filters whether to treat the upload bits as an error.</p> </dd> </dl> </article> </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="5">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="wp_check_filetype.html">wp_check_filetype()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Retrieves the file type from the file name.</p> </td> </tr> <tr> <td class="related-title"> <a href="clean_dirsize_cache.html">clean_dirsize_cache()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Cleans directory size cache used by <a href="recurse_dirsize.html" rel="function">recurse_dirsize()</a> .</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_upload_dir.html">wp_upload_dir()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Returns an array containing the current upload directory’s path and URL.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_unique_filename.html">wp_unique_filename()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Gets a filename that is sanitized and unique for the given directory.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_mkdir_p.html">wp_mkdir_p()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Recursive directory creation based on full path.</p> </td> </tr> <tr> <td class="related-title"> <a href="current_user_can.html">current_user_can()</a> <span>wp-includes/capabilities.php</span> </td> <td class="related-desc"> <p>Returns whether the current user has the specified capability.</p> </td> </tr> <tr> <td class="related-title"> <a href="__.html">__()</a> <span>wp-includes/l10n.php</span> </td> <td class="related-desc"> <p>Retrieves the translation of $text.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_basename.html">wp_basename()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>i18n-friendly version of basename().</p> </td> </tr> <tr> <td class="related-title"> <a href="is_multisite.html">is_multisite()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>If Multisite is enabled.</p> </td> </tr> <tr> <td class="related-title"> <a href="_deprecated_argument.html">_deprecated_argument()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Marks a function argument as deprecated and inform when it has been used.</p> </td> </tr> <tr> <td class="related-title"> <a href="apply_filters.html">apply_filters()</a> <span>wp-includes/plugin.php</span> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to a filter hook.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="wp_generate_attachment_metadata.html">wp_generate_attachment_metadata()</a> <span>wp-admin/includes/image.php</span> </td> <td class="related-desc"> <p>Generates attachment meta data and create image sub-sizes for images.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_xmlrpc_server/mw_newmediaobject.html">wp_xmlrpc_server::mw_newMediaObject()</a> <span>wp-includes/class-wp-xmlrpc-server.php</span> </td> <td class="related-desc"> <p>Uploads a file, following your settings.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/2.0.0/" alt="WordPress 2.0.0">2.0.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/wp_upload_bits" class="_attribution-link">https://developer.wordpress.org/reference/functions/wp_upload_bits</a>
  </p>
</div>
