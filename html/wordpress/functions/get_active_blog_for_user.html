<h1>get_active_blog_for_user( int $user_id ): WP_Site|void</h1>  <section> <p>Gets one of a user’s active blogs.</p> </section>   <section> <header class="toc-header"><h2 id="description">Description</h2></header> <p>Returns the user’s primary blog, if they have one and it is active. If it’s inactive, function returns another active blog of the user. If none are found, the user is added as a Subscriber to the Dashboard Blog and that blog is returned.</p> </section>  <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$user_id</code> <span class="type"><span class="int">int</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">The unique ID of the user</span> </div> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type"><a href="../classes/wp_site.html" rel="class">WP_Site</a>|void</span> The blog object</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/ms-functions.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/ms-functions.php/">View all references</a> </p> <pre class="wp-block-code" data-start="45" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function get_active_blog_for_user( $user_id ) {
	$blogs = get_blogs_of_user( $user_id );
	if ( empty( $blogs ) ) {
		return;
	}

	if ( ! is_multisite() ) {
		return $blogs[ get_current_blog_id() ];
	}

	$primary_blog = get_user_meta( $user_id, 'primary_blog', true );
	$first_blog   = current( $blogs );
	if ( false !== $primary_blog ) {
		if ( ! isset( $blogs[ $primary_blog ] ) ) {
			update_user_meta( $user_id, 'primary_blog', $first_blog-&gt;userblog_id );
			$primary = get_site( $first_blog-&gt;userblog_id );
		} else {
			$primary = get_site( $primary_blog );
		}
	} else {
		// TODO: Review this call to add_user_to_blog too - to get here the user must have a role on this blog?
		$result = add_user_to_blog( $first_blog-&gt;userblog_id, $user_id, 'subscriber' );

		if ( ! is_wp_error( $result ) ) {
			update_user_meta( $user_id, 'primary_blog', $first_blog-&gt;userblog_id );
			$primary = $first_blog;
		}
	}

	if ( ( ! is_object( $primary ) ) || ( 1 == $primary-&gt;archived || 1 == $primary-&gt;spam || 1 == $primary-&gt;deleted ) ) {
		$blogs = get_blogs_of_user( $user_id, true ); // If a user's primary blog is shut down, check their other blogs.
		$ret   = false;
		if ( is_array( $blogs ) &amp;&amp; count( $blogs ) &gt; 0 ) {
			foreach ( (array) $blogs as $blog_id =&gt; $blog ) {
				if ( get_current_network_id() != $blog-&gt;site_id ) {
					continue;
				}
				$details = get_site( $blog_id );
				if ( is_object( $details ) &amp;&amp; 0 == $details-&gt;archived &amp;&amp; 0 == $details-&gt;spam &amp;&amp; 0 == $details-&gt;deleted ) {
					$ret = $details;
					if ( get_user_meta( $user_id, 'primary_blog', true ) != $blog_id ) {
						update_user_meta( $user_id, 'primary_blog', $blog_id );
					}
					if ( ! get_user_meta( $user_id, 'source_domain', true ) ) {
						update_user_meta( $user_id, 'source_domain', $details-&gt;domain );
					}
					break;
				}
			}
		} else {
			return;
		}
		return $ret;
	} else {
		return $primary;
	}
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="5">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="get_current_network_id.html">get_current_network_id()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>Retrieves the current network ID.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_site.html">get_site()</a> <span>wp-includes/ms-site.php</span> </td> <td class="related-desc"> <p>Retrieves site data given a site ID or site object.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_blogs_of_user.html">get_blogs_of_user()</a> <span>wp-includes/user.php</span> </td> <td class="related-desc"> <p>Gets the sites a user belongs to.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_user_meta.html">get_user_meta()</a> <span>wp-includes/user.php</span> </td> <td class="related-desc"> <p>Retrieves user meta field for a user.</p> </td> </tr> <tr> <td class="related-title"> <a href="update_user_meta.html">update_user_meta()</a> <span>wp-includes/user.php</span> </td> <td class="related-desc"> <p>Updates user meta field based on user ID.</p> </td> </tr> <tr> <td class="related-title"> <a href="add_user_to_blog.html">add_user_to_blog()</a> <span>wp-includes/ms-functions.php</span> </td> <td class="related-desc"> <p>Adds a user to a blog, along with specifying the user’s role.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_multisite.html">is_multisite()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>If Multisite is enabled.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_current_blog_id.html">get_current_blog_id()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>Retrieve the current site ID.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_wp_error.html">is_wp_error()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>Checks whether the given variable is a WordPress Error.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="get_dashboard_url.html">get_dashboard_url()</a> <span>wp-includes/link-template.php</span> </td> <td class="related-desc"> <p>Retrieves the URL to the user’s dashboard.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_admin_bar/initialize.html">WP_Admin_Bar::initialize()</a> <span>wp-includes/class-wp-admin-bar.php</span> </td> <td class="related-desc"> <p>Initializes the admin bar.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_xmlrpc_server/wp_getusersblogs.html">wp_xmlrpc_server::wp_getUsersBlogs()</a> <span>wp-includes/class-wp-xmlrpc-server.php</span> </td> <td class="related-desc"> <p>Retrieve the blogs of the user.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/mu.3.0.0/" alt="WordPress MU (3.0.0)">MU (3.0.0)</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/get_active_blog_for_user" class="_attribution-link">https://developer.wordpress.org/reference/functions/get_active_blog_for_user</a>
  </p>
</div>
