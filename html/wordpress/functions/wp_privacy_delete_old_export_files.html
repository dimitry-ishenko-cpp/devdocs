<h1>wp_privacy_delete_old_export_files()</h1>  <section> <p>Cleans up export files older than three days old.</p> </section>   <section> <header class="toc-header"><h2 id="description">Description</h2></header> <p>The export files are stored in <code>wp-content/uploads</code>, and are therefore publicly accessible. A CSPRN is appended to the filename to mitigate the risk of an unauthorized person downloading the file, but it is still possible. Deleting the file after the data subject has had a chance to delete it adds an additional layer of protection.</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/functions.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/functions.php/">View all references</a> </p> <pre class="wp-block-code" data-start="7907" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function wp_privacy_delete_old_export_files() {
	$exports_dir = wp_privacy_exports_dir();
	if ( ! is_dir( $exports_dir ) ) {
		return;
	}

	require_once ABSPATH . 'wp-admin/includes/file.php';
	$export_files = list_files( $exports_dir, 100, array( 'index.php' ) );

	/**
	 * Filters the lifetime, in seconds, of a personal data export file.
	 *
	 * By default, the lifetime is 3 days. Once the file reaches that age, it will automatically
	 * be deleted by a cron job.
	 *
	 * @since 4.9.6
	 *
	 * @param int $expiration The expiration age of the export, in seconds.
	 */
	$expiration = apply_filters( 'wp_privacy_export_expiration', 3 * DAY_IN_SECONDS );

	foreach ( (array) $export_files as $export_file ) {
		$file_age_in_seconds = time() - filemtime( $export_file );

		if ( $expiration &lt; $file_age_in_seconds ) {
			unlink( $export_file );
		}
	}
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="hooks">Hooks</h2></header> <article class="hooks"> <dl> <dt class="signature-highlight"> <a href="../hooks/wp_privacy_export_expiration.html" style="text-decoration: none"> <span class="hook-func">apply_filters</span>( 'wp_privacy_export_expiration', <nobr><span class="arg-type">int</span> <span class="arg-name">$expiration</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Filters the lifetime, in seconds, of a personal data export file.</p> </dd> </dl> </article> </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="2">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="wp_privacy_exports_dir.html">wp_privacy_exports_dir()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Returns the directory used to store personal data export files.</p> </td> </tr> <tr> <td class="related-title"> <a href="list_files.html">list_files()</a> <span>wp-admin/includes/file.php</span> </td> <td class="related-desc"> <p>Returns a listing of all files in the specified folder and all subdirectories up to 100 levels deep.</p> </td> </tr> <tr> <td class="related-title"> <a href="apply_filters.html">apply_filters()</a> <span>wp-includes/plugin.php</span> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to a filter hook.</p> </td> </tr> </tbody>

</table>   </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/4.9.6/" alt="WordPress 4.9.6">4.9.6</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/wp_privacy_delete_old_export_files" class="_attribution-link">https://developer.wordpress.org/reference/functions/wp_privacy_delete_old_export_files</a>
  </p>
</div>
