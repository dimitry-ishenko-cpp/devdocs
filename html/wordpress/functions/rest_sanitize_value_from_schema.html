<h1>rest_sanitize_value_from_schema( mixed $value, array $args, string $param = '' ): mixed|WP_Error</h1>  <section> <p>Sanitize a value based on a schema.</p> </section>   <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$value</code> <span class="type"><span class="mixed">mixed</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">The value to sanitize.</span> </div> </dd> <dt> <code>$args</code> <span class="type"><span class="array">array</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Schema array to use for sanitization.</span> </div> </dd> <dt> <code>$param</code> <span class="type"><span class="string">string</span></span> <span class="required">Optional</span> </dt> <dd> <div class="desc"> <span class="description">The parameter name, used in error messages.</span> </div> <p class="default">Default: <code>''</code></p> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type">mixed|<a href="../classes/wp_error.html" rel="class">WP_Error</a></span> The sanitized value or a <a href="../classes/wp_error.html" rel="class">WP_Error</a> instance if the value cannot be safely sanitized.</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/rest-api.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/rest-api.php/">View all references</a> </p> <pre class="wp-block-code" data-start="2685" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function rest_sanitize_value_from_schema( $value, $args, $param = '' ) {
	if ( isset( $args['anyOf'] ) ) {
		$matching_schema = rest_find_any_matching_schema( $value, $args, $param );
		if ( is_wp_error( $matching_schema ) ) {
			return $matching_schema;
		}

		if ( ! isset( $args['type'] ) ) {
			$args['type'] = $matching_schema['type'];
		}

		$value = rest_sanitize_value_from_schema( $value, $matching_schema, $param );
	}

	if ( isset( $args['oneOf'] ) ) {
		$matching_schema = rest_find_one_matching_schema( $value, $args, $param );
		if ( is_wp_error( $matching_schema ) ) {
			return $matching_schema;
		}

		if ( ! isset( $args['type'] ) ) {
			$args['type'] = $matching_schema['type'];
		}

		$value = rest_sanitize_value_from_schema( $value, $matching_schema, $param );
	}

	$allowed_types = array( 'array', 'object', 'string', 'number', 'integer', 'boolean', 'null' );

	if ( ! isset( $args['type'] ) ) {
		/* translators: %s: Parameter. */
		_doing_it_wrong( __FUNCTION__, sprintf( __( 'The "type" schema keyword for %s is required.' ), $param ), '5.5.0' );
	}

	if ( is_array( $args['type'] ) ) {
		$best_type = rest_handle_multi_type_schema( $value, $args, $param );

		if ( ! $best_type ) {
			return null;
		}

		$args['type'] = $best_type;
	}

	if ( ! in_array( $args['type'], $allowed_types, true ) ) {
		_doing_it_wrong(
			__FUNCTION__,
			/* translators: 1: Parameter, 2: The list of allowed types. */
			wp_sprintf( __( 'The "type" schema keyword for %1$s can only be one of the built-in types: %2$l.' ), $param, $allowed_types ),
			'5.5.0'
		);
	}

	if ( 'array' === $args['type'] ) {
		$value = rest_sanitize_array( $value );

		if ( ! empty( $args['items'] ) ) {
			foreach ( $value as $index =&gt; $v ) {
				$value[ $index ] = rest_sanitize_value_from_schema( $v, $args['items'], $param . '[' . $index . ']' );
			}
		}

		if ( ! empty( $args['uniqueItems'] ) &amp;&amp; ! rest_validate_array_contains_unique_items( $value ) ) {
			/* translators: %s: Parameter. */
			return new WP_Error( 'rest_duplicate_items', sprintf( __( '%s has duplicate items.' ), $param ) );
		}

		return $value;
	}

	if ( 'object' === $args['type'] ) {
		$value = rest_sanitize_object( $value );

		foreach ( $value as $property =&gt; $v ) {
			if ( isset( $args['properties'][ $property ] ) ) {
				$value[ $property ] = rest_sanitize_value_from_schema( $v, $args['properties'][ $property ], $param . '[' . $property . ']' );
				continue;
			}

			$pattern_property_schema = rest_find_matching_pattern_property_schema( $property, $args );
			if ( null !== $pattern_property_schema ) {
				$value[ $property ] = rest_sanitize_value_from_schema( $v, $pattern_property_schema, $param . '[' . $property . ']' );
				continue;
			}

			if ( isset( $args['additionalProperties'] ) ) {
				if ( false === $args['additionalProperties'] ) {
					unset( $value[ $property ] );
				} elseif ( is_array( $args['additionalProperties'] ) ) {
					$value[ $property ] = rest_sanitize_value_from_schema( $v, $args['additionalProperties'], $param . '[' . $property . ']' );
				}
			}
		}

		return $value;
	}

	if ( 'null' === $args['type'] ) {
		return null;
	}

	if ( 'integer' === $args['type'] ) {
		return (int) $value;
	}

	if ( 'number' === $args['type'] ) {
		return (float) $value;
	}

	if ( 'boolean' === $args['type'] ) {
		return rest_sanitize_boolean( $value );
	}

	// This behavior matches rest_validate_value_from_schema().
	if ( isset( $args['format'] )
		&amp;&amp; ( ! isset( $args['type'] ) || 'string' === $args['type'] || ! in_array( $args['type'], $allowed_types, true ) )
	) {
		switch ( $args['format'] ) {
			case 'hex-color':
				return (string) sanitize_hex_color( $value );

			case 'date-time':
				return sanitize_text_field( $value );

			case 'email':
				// sanitize_email() validates, which would be unexpected.
				return sanitize_text_field( $value );

			case 'uri':
				return sanitize_url( $value );

			case 'ip':
				return sanitize_text_field( $value );

			case 'uuid':
				return sanitize_text_field( $value );

			case 'text-field':
				return sanitize_text_field( $value );

			case 'textarea-field':
				return sanitize_textarea_field( $value );
		}
	}

	if ( 'string' === $args['type'] ) {
		return (string) $value;
	}

	return $value;
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="5">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="rest_find_any_matching_schema.html">rest_find_any_matching_schema()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Finds the matching schema among the “anyOf” schemas.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_sanitize_boolean.html">rest_sanitize_boolean()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Changes a boolean-like value into the proper boolean value.</p> </td> </tr> <tr> <td class="related-title"> <a href="sanitize_url.html">sanitize_url()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Sanitizes a URL for database or redirect usage.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_sprintf.html">wp_sprintf()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>WordPress implementation of PHP sprintf() with filters.</p> </td> </tr> <tr> <td class="related-title"> <a href="sanitize_text_field.html">sanitize_text_field()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Sanitizes a string from user input or from the database.</p> </td> </tr> <tr> <td class="related-title"> <a href="sanitize_hex_color.html">sanitize_hex_color()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Sanitizes a hex color.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_find_one_matching_schema.html">rest_find_one_matching_schema()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Finds the matching schema among the “oneOf” schemas.</p> </td> </tr> <tr> <td class="related-title"> <a href="sanitize_textarea_field.html">sanitize_textarea_field()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Sanitizes a multiline string from user input or from the database.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_sanitize_value_from_schema.html">rest_sanitize_value_from_schema()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Sanitize a value based on a schema.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_sanitize_object.html">rest_sanitize_object()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Converts an object-like value to an object.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_validate_array_contains_unique_items.html">rest_validate_array_contains_unique_items()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Checks if an array is made up of unique items.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_sanitize_array.html">rest_sanitize_array()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Converts an array-like value to an array.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_handle_multi_type_schema.html">rest_handle_multi_type_schema()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Handles getting the best type for a multi-type schema.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_find_matching_pattern_property_schema.html">rest_find_matching_pattern_property_schema()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Finds the schema for a property using the patternProperties keyword.</p> </td> </tr> <tr> <td class="related-title"> <a href="__.html">__()</a> <span>wp-includes/l10n.php</span> </td> <td class="related-desc"> <p>Retrieves the translation of $text.</p> </td> </tr> <tr> <td class="related-title"> <a href="_doing_it_wrong.html">_doing_it_wrong()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Marks something as being incorrectly called.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_wp_error.html">is_wp_error()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>Checks whether the given variable is a WordPress Error.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_error/__construct.html">WP_Error::__construct()</a> <span>wp-includes/class-wp-error.php</span> </td> <td class="related-desc"> <p>Initializes the error.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="../classes/wp_rest_widget_types_controller/prepare_item_for_response.html">WP_REST_Widget_Types_Controller::prepare_item_for_response()</a> <span>wp-includes/rest-api/endpoints/class-wp-rest-widget-types-controller.php</span> </td> <td class="related-desc"> <p>Prepares a widget type object for serialization.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_validate_enum.html">rest_validate_enum()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Validates that the given value is a member of the JSON Schema “enum”.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_themes_controller/prepare_theme_support.html">WP_REST_Themes_Controller::prepare_theme_support()</a> <span>wp-includes/rest-api/endpoints/class-wp-rest-themes-controller.php</span> </td> <td class="related-desc"> <p>Prepares the theme support value for inclusion in the REST API response.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_block_types_controller/prepare_item_for_response.html">WP_REST_Block_Types_Controller::prepare_item_for_response()</a> <span>wp-includes/rest-api/endpoints/class-wp-rest-block-types-controller.php</span> </td> <td class="related-desc"> <p>Prepares a block type object for serialization.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_block_renderer_controller/register_routes.html">WP_REST_Block_Renderer_Controller::register_routes()</a> <span>wp-includes/rest-api/endpoints/class-wp-rest-block-renderer-controller.php</span> </td> <td class="related-desc"> <p>Registers the necessary REST API routes, one for each dynamic block.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_widget_media/update.html">WP_Widget_Media::update()</a> <span>wp-includes/widgets/class-wp-widget-media.php</span> </td> <td class="related-desc"> <p>Sanitizes the widget form values as they are saved.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_sanitize_value_from_schema.html">rest_sanitize_value_from_schema()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Sanitize a value based on a schema.</p> </td> </tr> <tr> <td class="related-title"> <a href="rest_sanitize_request_arg.html">rest_sanitize_request_arg()</a> <span>wp-includes/rest-api.php</span> </td> <td class="related-desc"> <p>Sanitize a request argument based on details registered to the route.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_meta_fields/prepare_value.html">WP_REST_Meta_Fields::prepare_value()</a> <span>wp-includes/rest-api/fields/class-wp-rest-meta-fields.php</span> </td> <td class="related-desc"> <p>Prepares a meta value for output.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_meta_fields/update_value.html">WP_REST_Meta_Fields::update_value()</a> <span>wp-includes/rest-api/fields/class-wp-rest-meta-fields.php</span> </td> <td class="related-desc"> <p>Updates meta values.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_settings_controller/prepare_value.html">WP_REST_Settings_Controller::prepare_value()</a> <span>wp-includes/rest-api/endpoints/class-wp-rest-settings-controller.php</span> </td> <td class="related-desc"> <p>Prepares a value for output based off a schema array.</p> </td> </tr> </tbody>

</table>   </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/5.9.0/" alt="WordPress 5.9.0">5.9.0</a></td> <td><span class="since-description">Added <code>text-field</code> and <code>textarea-field</code> formats.</span></td> </tr> <tr> <td><a href="https://developer.wordpress.org/reference/since/5.6.0/" alt="WordPress 5.6.0">5.6.0</a></td> <td><span class="since-description">Support the "anyOf" and "oneOf" keywords.</span></td> </tr> <tr> <td><a href="https://developer.wordpress.org/reference/since/5.5.0/" alt="WordPress 5.5.0">5.5.0</a></td> <td><span class="since-description">Added the <code>$param</code> parameter.</span></td> </tr> <tr> <td><a href="https://developer.wordpress.org/reference/since/4.7.0/" alt="WordPress 4.7.0">4.7.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/rest_sanitize_value_from_schema" class="_attribution-link">https://developer.wordpress.org/reference/functions/rest_sanitize_value_from_schema</a>
  </p>
</div>
