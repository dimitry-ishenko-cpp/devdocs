<h1>update_metadata( string $meta_type, int $object_id, string $meta_key, mixed $meta_value, mixed $prev_value = '' ): int|bool</h1>  <section> <p>Updates metadata for the specified object. If no value already exists for the specified object ID and metadata key, the metadata will be added.</p> </section>   <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$meta_type</code> <span class="type"><span class="string">string</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Type of object metadata is for. Accepts <code>'post'</code>, <code>'comment'</code>, <code>'term'</code>, <code>'user'</code>, or any other object type with an associated meta table.</span> </div> </dd> <dt> <code>$object_id</code> <span class="type"><span class="int">int</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">ID of the object metadata is for.</span> </div> </dd> <dt> <code>$meta_key</code> <span class="type"><span class="string">string</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Metadata key.</span> </div> </dd> <dt> <code>$meta_value</code> <span class="type"><span class="mixed">mixed</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Metadata value. Must be serializable if non-scalar.</span> </div> </dd> <dt> <code>$prev_value</code> <span class="type"><span class="mixed">mixed</span></span> <span class="required">Optional</span> </dt> <dd> <div class="desc"> <span class="description"> Previous value to check before updating.<br> If specified, only update existing metadata entries with this value. Otherwise, update all entries. </span> </div> <p class="default">Default: <code>''</code></p> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type">int|bool</span> The new meta field ID if a field with the given key didn't exist and was therefore added, true on successful update, false on failure or if the value passed to the function is the same as the one that is already in the database.</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/meta.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/meta.php/">View all references</a> </p> <pre class="wp-block-code" data-start="180" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function update_metadata( $meta_type, $object_id, $meta_key, $meta_value, $prev_value = '' ) {
	global $wpdb;

	if ( ! $meta_type || ! $meta_key || ! is_numeric( $object_id ) ) {
		return false;
	}

	$object_id = absint( $object_id );
	if ( ! $object_id ) {
		return false;
	}

	$table = _get_meta_table( $meta_type );
	if ( ! $table ) {
		return false;
	}

	$meta_subtype = get_object_subtype( $meta_type, $object_id );

	$column    = sanitize_key( $meta_type . '_id' );
	$id_column = ( 'user' === $meta_type ) ? 'umeta_id' : 'meta_id';

	// expected_slashed ($meta_key)
	$raw_meta_key = $meta_key;
	$meta_key     = wp_unslash( $meta_key );
	$passed_value = $meta_value;
	$meta_value   = wp_unslash( $meta_value );
	$meta_value   = sanitize_meta( $meta_key, $meta_value, $meta_type, $meta_subtype );

	/**
	 * Short-circuits updating metadata of a specific type.
	 *
	 * The dynamic portion of the hook name, `$meta_type`, refers to the meta object type
	 * (post, comment, term, user, or any other type with an associated meta table).
	 * Returning a non-null value will effectively short-circuit the function.
	 *
	 * Possible hook names include:
	 *
	 *  - `update_post_metadata`
	 *  - `update_comment_metadata`
	 *  - `update_term_metadata`
	 *  - `update_user_metadata`
	 *
	 * @since 3.1.0
	 *
	 * @param null|bool $check      Whether to allow updating metadata for the given type.
	 * @param int       $object_id  ID of the object metadata is for.
	 * @param string    $meta_key   Metadata key.
	 * @param mixed     $meta_value Metadata value. Must be serializable if non-scalar.
	 * @param mixed     $prev_value Optional. Previous value to check before updating.
	 *                              If specified, only update existing metadata entries with
	 *                              this value. Otherwise, update all entries.
	 */
	$check = apply_filters( "update_{$meta_type}_metadata", null, $object_id, $meta_key, $meta_value, $prev_value );
	if ( null !== $check ) {
		return (bool) $check;
	}

	// Compare existing value to new value if no prev value given and the key exists only once.
	if ( empty( $prev_value ) ) {
		$old_value = get_metadata_raw( $meta_type, $object_id, $meta_key );
		if ( is_countable( $old_value ) &amp;&amp; count( $old_value ) === 1 ) {
			if ( $old_value[0] === $meta_value ) {
				return false;
			}
		}
	}

	$meta_ids = $wpdb-&gt;get_col( $wpdb-&gt;prepare( "SELECT $id_column FROM $table WHERE meta_key = %s AND $column = %d", $meta_key, $object_id ) );
	if ( empty( $meta_ids ) ) {
		return add_metadata( $meta_type, $object_id, $raw_meta_key, $passed_value );
	}

	$_meta_value = $meta_value;
	$meta_value  = maybe_serialize( $meta_value );

	$data  = compact( 'meta_value' );
	$where = array(
		$column    =&gt; $object_id,
		'meta_key' =&gt; $meta_key,
	);

	if ( ! empty( $prev_value ) ) {
		$prev_value          = maybe_serialize( $prev_value );
		$where['meta_value'] = $prev_value;
	}

	foreach ( $meta_ids as $meta_id ) {
		/**
		 * Fires immediately before updating metadata of a specific type.
		 *
		 * The dynamic portion of the hook name, `$meta_type`, refers to the meta object type
		 * (post, comment, term, user, or any other type with an associated meta table).
		 *
		 * Possible hook names include:
		 *
		 *  - `update_post_meta`
		 *  - `update_comment_meta`
		 *  - `update_term_meta`
		 *  - `update_user_meta`
		 *
		 * @since 2.9.0
		 *
		 * @param int    $meta_id     ID of the metadata entry to update.
		 * @param int    $object_id   ID of the object metadata is for.
		 * @param string $meta_key    Metadata key.
		 * @param mixed  $_meta_value Metadata value.
		 */
		do_action( "update_{$meta_type}_meta", $meta_id, $object_id, $meta_key, $_meta_value );

		if ( 'post' === $meta_type ) {
			/**
			 * Fires immediately before updating a post's metadata.
			 *
			 * @since 2.9.0
			 *
			 * @param int    $meta_id    ID of metadata entry to update.
			 * @param int    $object_id  Post ID.
			 * @param string $meta_key   Metadata key.
			 * @param mixed  $meta_value Metadata value. This will be a PHP-serialized string representation of the value
			 *                           if the value is an array, an object, or itself a PHP-serialized string.
			 */
			do_action( 'update_postmeta', $meta_id, $object_id, $meta_key, $meta_value );
		}
	}

	$result = $wpdb-&gt;update( $table, $data, $where );
	if ( ! $result ) {
		return false;
	}

	wp_cache_delete( $object_id, $meta_type . '_meta' );

	foreach ( $meta_ids as $meta_id ) {
		/**
		 * Fires immediately after updating metadata of a specific type.
		 *
		 * The dynamic portion of the hook name, `$meta_type`, refers to the meta object type
		 * (post, comment, term, user, or any other type with an associated meta table).
		 *
		 * Possible hook names include:
		 *
		 *  - `updated_post_meta`
		 *  - `updated_comment_meta`
		 *  - `updated_term_meta`
		 *  - `updated_user_meta`
		 *
		 * @since 2.9.0
		 *
		 * @param int    $meta_id     ID of updated metadata entry.
		 * @param int    $object_id   ID of the object metadata is for.
		 * @param string $meta_key    Metadata key.
		 * @param mixed  $_meta_value Metadata value.
		 */
		do_action( "updated_{$meta_type}_meta", $meta_id, $object_id, $meta_key, $_meta_value );

		if ( 'post' === $meta_type ) {
			/**
			 * Fires immediately after updating a post's metadata.
			 *
			 * @since 2.9.0
			 *
			 * @param int    $meta_id    ID of updated metadata entry.
			 * @param int    $object_id  Post ID.
			 * @param string $meta_key   Metadata key.
			 * @param mixed  $meta_value Metadata value. This will be a PHP-serialized string representation of the value
			 *                           if the value is an array, an object, or itself a PHP-serialized string.
			 */
			do_action( 'updated_postmeta', $meta_id, $object_id, $meta_key, $meta_value );
		}
	}

	return true;
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="hooks">Hooks</h2></header> <article class="hooks"> <dl> <dt class="signature-highlight"> <a href="../hooks/updated_postmeta.html" style="text-decoration: none"> <span class="hook-func">do_action</span>( 'updated_postmeta', <nobr><span class="arg-type">int</span> <span class="arg-name">$meta_id</span></nobr>, <nobr><span class="arg-type">int</span> <span class="arg-name">$object_id</span></nobr>, <nobr><span class="arg-type">string</span> <span class="arg-name">$meta_key</span></nobr>, <nobr><span class="arg-type">mixed</span> <span class="arg-name">$meta_value</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Fires immediately after updating a post’s metadata.</p> </dd> </dl> <dl> <dt class="signature-highlight"> <a href="../hooks/updated_meta_type_meta.html" style="text-decoration: none"> <span class="hook-func">do_action</span>( "updated_{$meta_type}_meta", <nobr><span class="arg-type">int</span> <span class="arg-name">$meta_id</span></nobr>, <nobr><span class="arg-type">int</span> <span class="arg-name">$object_id</span></nobr>, <nobr><span class="arg-type">string</span> <span class="arg-name">$meta_key</span></nobr>, <nobr><span class="arg-type">mixed</span> <span class="arg-name">$_meta_value</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Fires immediately after updating metadata of a specific type.</p> </dd> </dl> <dl> <dt class="signature-highlight"> <a href="../hooks/update_postmeta.html" style="text-decoration: none"> <span class="hook-func">do_action</span>( 'update_postmeta', <nobr><span class="arg-type">int</span> <span class="arg-name">$meta_id</span></nobr>, <nobr><span class="arg-type">int</span> <span class="arg-name">$object_id</span></nobr>, <nobr><span class="arg-type">string</span> <span class="arg-name">$meta_key</span></nobr>, <nobr><span class="arg-type">mixed</span> <span class="arg-name">$meta_value</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Fires immediately before updating a post’s metadata.</p> </dd> </dl> <dl> <dt class="signature-highlight"> <a href="../hooks/update_meta_type_meta.html" style="text-decoration: none"> <span class="hook-func">do_action</span>( "update_{$meta_type}_meta", <nobr><span class="arg-type">int</span> <span class="arg-name">$meta_id</span></nobr>, <nobr><span class="arg-type">int</span> <span class="arg-name">$object_id</span></nobr>, <nobr><span class="arg-type">string</span> <span class="arg-name">$meta_key</span></nobr>, <nobr><span class="arg-type">mixed</span> <span class="arg-name">$_meta_value</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Fires immediately before updating metadata of a specific type.</p> </dd> </dl> <dl> <dt class="signature-highlight"> <a href="../hooks/update_meta_type_metadata.html" style="text-decoration: none"> <span class="hook-func">apply_filters</span>( "update_{$meta_type}_metadata", <nobr><span class="arg-type">null|bool</span> <span class="arg-name">$check</span></nobr>, <nobr><span class="arg-type">int</span> <span class="arg-name">$object_id</span></nobr>, <nobr><span class="arg-type">string</span> <span class="arg-name">$meta_key</span></nobr>, <nobr><span class="arg-type">mixed</span> <span class="arg-name">$meta_value</span></nobr>, <nobr><span class="arg-type">mixed</span> <span class="arg-name">$prev_value</span></nobr> ) </a> </dt> <dd class="hook-desc"> 
<p>Short-circuits updating metadata of a specific type.</p> </dd> </dl> </article> </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="5">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="get_metadata_raw.html">get_metadata_raw()</a> <span>wp-includes/meta.php</span> </td> <td class="related-desc"> <p>Retrieves raw metadata value for the specified object.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_object_subtype.html">get_object_subtype()</a> <span>wp-includes/meta.php</span> </td> <td class="related-desc"> <p>Returns the object subtype for a given object ID of a specific type.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_cache_delete.html">wp_cache_delete()</a> <span>wp-includes/cache.php</span> </td> <td class="related-desc"> <p>Removes the cache contents matching key and group.</p> </td> </tr> <tr> <td class="related-title"> <a href="maybe_serialize.html">maybe_serialize()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Serializes data, if needed.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wpdb/get_col.html">wpdb::get_col()</a> <span>wp-includes/class-wpdb.php</span> </td> <td class="related-desc"> <p>Retrieves one column from the database.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wpdb/update.html">wpdb::update()</a> <span>wp-includes/class-wpdb.php</span> </td> <td class="related-desc"> <p>Updates a row in the table.</p> </td> </tr> <tr> <td class="related-title"> <a href="_get_meta_table.html">_get_meta_table()</a> <span>wp-includes/meta.php</span> </td> <td class="related-desc"> <p>Retrieves the name of the metadata table for the specified object type.</p> </td> </tr> <tr> <td class="related-title"> <a href="sanitize_meta.html">sanitize_meta()</a> <span>wp-includes/meta.php</span> </td> <td class="related-desc"> <p>Sanitizes meta value.</p> </td> </tr> <tr> <td class="related-title"> <a href="add_metadata.html">add_metadata()</a> <span>wp-includes/meta.php</span> </td> <td class="related-desc"> <p>Adds metadata for the specified object.</p> </td> </tr> <tr> <td class="related-title"> <a href="wp_unslash.html">wp_unslash()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Removes slashes from a string or recursively removes slashes from strings within an array.</p> </td> </tr> <tr> <td class="related-title"> <a href="sanitize_key.html">sanitize_key()</a> <span>wp-includes/formatting.php</span> </td> <td class="related-desc"> <p>Sanitizes a string key.</p> </td> </tr> <tr> <td class="related-title"> <a href="absint.html">absint()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Converts a value to non-negative integer.</p> </td> </tr> <tr> <td class="related-title"> <a href="apply_filters.html">apply_filters()</a> <span>wp-includes/plugin.php</span> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to a filter hook.</p> </td> </tr> <tr> <td class="related-title"> <a href="do_action.html">do_action()</a> <span>wp-includes/plugin.php</span> </td> <td class="related-desc"> <p>Calls the callback functions that have been added to an action hook.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wpdb/prepare.html">wpdb::prepare()</a> <span>wp-includes/class-wpdb.php</span> </td> <td class="related-desc"> <p>Prepares a SQL query for safe execution.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="update_site_meta.html">update_site_meta()</a> <span>wp-includes/ms-site.php</span> </td> <td class="related-desc"> <p>Updates metadata for a site.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_rest_meta_fields/update_meta_value.html">WP_REST_Meta_Fields::update_meta_value()</a> <span>wp-includes/rest-api/fields/class-wp-rest-meta-fields.php</span> </td> <td class="related-desc"> <p>Updates a meta value for an object.</p> </td> </tr> <tr> <td class="related-title"> <a href="update_term_meta.html">update_term_meta()</a> <span>wp-includes/taxonomy.php</span> </td> <td class="related-desc"> <p>Updates term metadata.</p> </td> </tr> <tr> <td class="related-title"> <a href="update_user_meta.html">update_user_meta()</a> <span>wp-includes/user.php</span> </td> <td class="related-desc"> <p>Updates user meta field based on user ID.</p> </td> </tr> <tr> <td class="related-title"> <a href="update_post_meta.html">update_post_meta()</a> <span>wp-includes/post.php</span> </td> <td class="related-desc"> <p>Updates a post meta field based on the given post ID.</p> </td> </tr> <tr> <td class="related-title"> <a href="update_comment_meta.html">update_comment_meta()</a> <span>wp-includes/comment.php</span> </td> <td class="related-desc"> <p>Updates comment meta field based on comment ID.</p> </td> </tr> </tbody>

</table>   </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/2.9.0/" alt="WordPress 2.9.0">2.9.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/update_metadata" class="_attribution-link">https://developer.wordpress.org/reference/functions/update_metadata</a>
  </p>
</div>
