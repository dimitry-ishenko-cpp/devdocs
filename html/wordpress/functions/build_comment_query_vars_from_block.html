<h1>build_comment_query_vars_from_block( WP_Block $block ): array</h1>  <section> <p>Helper function that constructs a comment query vars array from the passed block properties.</p> </section>   <section> <header class="toc-header"><h2 id="description">Description</h2></header> <p>It’s used with the Comment Query Loop inner blocks.</p> </section>  <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$block</code> <span class="type"><span class="WP_Block"><a href="../classes/wp_block.html" rel="class">WP_Block</a></span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">Block instance.</span> </div> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type">array</span> Returns the comment query parameters to use with the <a href="../classes/wp_comment_query.html" rel="class">WP_Comment_Query</a> constructor.</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/blocks.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/blocks.php/">View all references</a> </p> <pre class="wp-block-code" data-start="1419" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">function build_comment_query_vars_from_block( $block ) {

	$comment_args = array(
		'orderby'       =&gt; 'comment_date_gmt',
		'order'         =&gt; 'ASC',
		'status'        =&gt; 'approve',
		'no_found_rows' =&gt; false,
	);

	if ( is_user_logged_in() ) {
		$comment_args['include_unapproved'] = array( get_current_user_id() );
	} else {
		$unapproved_email = wp_get_unapproved_comment_author_email();

		if ( $unapproved_email ) {
			$comment_args['include_unapproved'] = array( $unapproved_email );
		}
	}

	if ( ! empty( $block-&gt;context['postId'] ) ) {
		$comment_args['post_id'] = (int) $block-&gt;context['postId'];
	}

	if ( get_option( 'thread_comments' ) ) {
		$comment_args['hierarchical'] = 'threaded';
	} else {
		$comment_args['hierarchical'] = false;
	}

	if ( get_option( 'page_comments' ) === '1' || get_option( 'page_comments' ) === true ) {
		$per_page     = get_option( 'comments_per_page' );
		$default_page = get_option( 'default_comments_page' );
		if ( $per_page &gt; 0 ) {
			$comment_args['number'] = $per_page;

			$page = (int) get_query_var( 'cpage' );
			if ( $page ) {
				$comment_args['paged'] = $page;
			} elseif ( 'oldest' === $default_page ) {
				$comment_args['paged'] = 1;
			} elseif ( 'newest' === $default_page ) {
				$max_num_pages = (int) ( new WP_Comment_Query( $comment_args ) )-&gt;max_num_pages;
				if ( 0 !== $max_num_pages ) {
					$comment_args['paged'] = $max_num_pages;
				}
			}
			// Set the `cpage` query var to ensure the previous and next pagination links are correct
			// when inheriting the Discussion Settings.
			if ( 0 === $page &amp;&amp; isset( $comment_args['paged'] ) &amp;&amp; $comment_args['paged'] &gt; 0 ) {
				set_query_var( 'cpage', $comment_args['paged'] );
			}
		}
	}

	return $comment_args;
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="4">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="wp_get_unapproved_comment_author_email.html">wp_get_unapproved_comment_author_email()</a> <span>wp-includes/comment.php</span> </td> <td class="related-desc"> <p>Gets unapproved comment author’s email.</p> </td> </tr> <tr> <td class="related-title"> <a href="../classes/wp_comment_query/__construct.html">WP_Comment_Query::__construct()</a> <span>wp-includes/class-wp-comment-query.php</span> </td> <td class="related-desc"> <p>Constructor.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_query_var.html">get_query_var()</a> <span>wp-includes/query.php</span> </td> <td class="related-desc"> <p>Retrieves the value of a query variable in the <a href="../classes/wp_query.html" rel="class">WP_Query</a> class.</p> </td> </tr> <tr> <td class="related-title"> <a href="set_query_var.html">set_query_var()</a> <span>wp-includes/query.php</span> </td> <td class="related-desc"> <p>Sets the value of a query variable in the <a href="../classes/wp_query.html" rel="class">WP_Query</a> class.</p> </td> </tr> <tr> <td class="related-title"> <a href="is_user_logged_in.html">is_user_logged_in()</a> <span>wp-includes/pluggable.php</span> </td> <td class="related-desc"> <p>Determines whether the current visitor is a logged in user.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_option.html">get_option()</a> <span>wp-includes/option.php</span> </td> <td class="related-desc"> <p>Retrieves an option value based on an option name.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_current_user_id.html">get_current_user_id()</a> <span>wp-includes/user.php</span> </td> <td class="related-desc"> <p>Gets the current user’s ID.</p> </td> </tr> </tbody>

</table>   </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/6.0.0/" alt="WordPress 6.0.0">6.0.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/functions/build_comment_query_vars_from_block" class="_attribution-link">https://developer.wordpress.org/reference/functions/build_comment_query_vars_from_block</a>
  </p>
</div>
