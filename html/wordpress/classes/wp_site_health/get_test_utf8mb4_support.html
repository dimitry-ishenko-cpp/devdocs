<h1>WP_Site_Health::get_test_utf8mb4_support(): array</h1>  <section> <p>Tests if the database server is capable of using utf8mb4.</p> </section>   <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type">array</span> The test results.</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-admin/includes/class-wp-site-health.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-admin/includes/class-wp-site-health.php/">View all references</a> </p> <pre class="wp-block-code" data-start="1289" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">public function get_test_utf8mb4_support() {
	global $wpdb;

	if ( ! $this-&gt;mysql_server_version ) {
		$this-&gt;prepare_sql_data();
	}

	$result = array(
		'label'       =&gt; __( 'UTF8MB4 is supported' ),
		'status'      =&gt; 'good',
		'badge'       =&gt; array(
			'label' =&gt; __( 'Performance' ),
			'color' =&gt; 'blue',
		),
		'description' =&gt; sprintf(
			'&lt;p&gt;%s&lt;/p&gt;',
			__( 'UTF8MB4 is the character set WordPress prefers for database storage because it safely supports the widest set of characters and encodings, including Emoji, enabling better support for non-English languages.' )
		),
		'actions'     =&gt; '',
		'test'        =&gt; 'utf8mb4_support',
	);

	if ( ! $this-&gt;is_mariadb ) {
		if ( version_compare( $this-&gt;mysql_server_version, '5.5.3', '&lt;' ) ) {
			$result['status'] = 'recommended';

			$result['label'] = __( 'utf8mb4 requires a MySQL update' );

			$result['description'] .= sprintf(
				'&lt;p&gt;%s&lt;/p&gt;',
				sprintf(
					/* translators: %s: Version number. */
					__( 'WordPress&amp;#8217; utf8mb4 support requires MySQL version %s or greater. Please contact your server administrator.' ),
					'5.5.3'
				)
			);
		} else {
			$result['description'] .= sprintf(
				'&lt;p&gt;%s&lt;/p&gt;',
				__( 'Your MySQL version supports utf8mb4.' )
			);
		}
	} else { // MariaDB introduced utf8mb4 support in 5.5.0.
		if ( version_compare( $this-&gt;mysql_server_version, '5.5.0', '&lt;' ) ) {
			$result['status'] = 'recommended';

			$result['label'] = __( 'utf8mb4 requires a MariaDB update' );

			$result['description'] .= sprintf(
				'&lt;p&gt;%s&lt;/p&gt;',
				sprintf(
					/* translators: %s: Version number. */
					__( 'WordPress&amp;#8217; utf8mb4 support requires MariaDB version %s or greater. Please contact your server administrator.' ),
					'5.5.0'
				)
			);
		} else {
			$result['description'] .= sprintf(
				'&lt;p&gt;%s&lt;/p&gt;',
				__( 'Your MariaDB version supports utf8mb4.' )
			);
		}
	}

	if ( $wpdb-&gt;use_mysqli ) {
		// phpcs:ignore WordPress.DB.RestrictedFunctions.mysql_mysqli_get_client_info
		$mysql_client_version = mysqli_get_client_info();
	} else {
		// phpcs:ignore WordPress.DB.RestrictedFunctions.mysql_mysql_get_client_info,PHPCompatibility.Extensions.RemovedExtensions.mysql_DeprecatedRemoved
		$mysql_client_version = mysql_get_client_info();
	}

	/*
	 * libmysql has supported utf8mb4 since 5.5.3, same as the MySQL server.
	 * mysqlnd has supported utf8mb4 since 5.0.9.
	 */
	if ( false !== strpos( $mysql_client_version, 'mysqlnd' ) ) {
		$mysql_client_version = preg_replace( '/^\D+([\d.]+).*/', '$1', $mysql_client_version );
		if ( version_compare( $mysql_client_version, '5.0.9', '&lt;' ) ) {
			$result['status'] = 'recommended';

			$result['label'] = __( 'utf8mb4 requires a newer client library' );

			$result['description'] .= sprintf(
				'&lt;p&gt;%s&lt;/p&gt;',
				sprintf(
					/* translators: 1: Name of the library, 2: Number of version. */
					__( 'WordPress&amp;#8217; utf8mb4 support requires MySQL client library (%1$s) version %2$s or newer. Please contact your server administrator.' ),
					'mysqlnd',
					'5.0.9'
				)
			);
		}
	} else {
		if ( version_compare( $mysql_client_version, '5.5.3', '&lt;' ) ) {
			$result['status'] = 'recommended';

			$result['label'] = __( 'utf8mb4 requires a newer client library' );

			$result['description'] .= sprintf(
				'&lt;p&gt;%s&lt;/p&gt;',
				sprintf(
					/* translators: 1: Name of the library, 2: Number of version. */
					__( 'WordPress&amp;#8217; utf8mb4 support requires MySQL client library (%1$s) version %2$s or newer. Please contact your server administrator.' ),
					'libmysql',
					'5.5.3'
				)
			);
		}
	}

	return $result;
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="2">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="prepare_sql_data.html">WP_Site_Health::prepare_sql_data()</a> <span>wp-admin/includes/class-wp-site-health.php</span> </td> <td class="related-desc"> <p>Runs the SQL version checks.</p> </td> </tr> <tr> <td class="related-title"> <a href="../../functions/__.html">__()</a> <span>wp-includes/l10n.php</span> </td> <td class="related-desc"> <p>Retrieves the translation of $text.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/5.2.0/" alt="WordPress 5.2.0">5.2.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/classes/wp_site_health/get_test_utf8mb4_support" class="_attribution-link">https://developer.wordpress.org/reference/classes/wp_site_health/get_test_utf8mb4_support</a>
  </p>
</div>
