<h1>Requests_IDNAEncoder::punycode_encode( string $input ): string</h1>  <section> <p>RFC3492-compliant encoder</p> </section>   <section> <header class="toc-header"><h2 id="parameters">Parameters</h2></header> <dl> <dt> <code>$input</code> <span class="type"><span class="string">string</span></span> <span class="required">Required</span> </dt> <dd> <div class="desc"> <span class="description">UTF-8 encoded string to encode</span> </div> </dd> </dl> </section>  <section> <header class="toc-header"><h2 id="return">Return</h2></header> <p><span class="return-type">string</span> Punycode-encoded string</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/Requests/IDNAEncoder.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/requests/idnaencoder.php/">View all references</a> </p> <pre class="wp-block-code" data-start="229" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">public static function punycode_encode($input) {
	$output = '';
	// let n = initial_n
	$n = self::BOOTSTRAP_INITIAL_N;
	// let delta = 0
	$delta = 0;
	// let bias = initial_bias
	$bias = self::BOOTSTRAP_INITIAL_BIAS;
	// let h = b = the number of basic code points in the input
	$h = 0;
	$b = 0; // see loop
	// copy them to the output in order
	$codepoints = self::utf8_to_codepoints($input);
	$extended   = array();

	foreach ($codepoints as $char) {
		if ($char &lt; 128) {
			// Character is valid ASCII
			// TODO: this should also check if it's valid for a URL
			$output .= chr($char);
			$h++;
		}
		// Check if the character is non-ASCII, but below initial n
		// This never occurs for Punycode, so ignore in coverage
		// @codeCoverageIgnoreStart
		elseif ($char &lt; $n) {
			throw new Requests_Exception('Invalid character', 'idna.character_outside_domain', $char);
		}
		// @codeCoverageIgnoreEnd
		else {
			$extended[$char] = true;
		}
	}
	$extended = array_keys($extended);
	sort($extended);
	$b = $h;
	// [copy them] followed by a delimiter if b &gt; 0
	if (strlen($output) &gt; 0) {
		$output .= '-';
	}
	// {if the input contains a non-basic code point &lt; n then fail}
	// while h &lt; length(input) do begin
	$codepointcount = count($codepoints);
	while ($h &lt; $codepointcount) {
		// let m = the minimum code point &gt;= n in the input
		$m = array_shift($extended);
		//printf('next code point to insert is %s' . PHP_EOL, dechex($m));
		// let delta = delta + (m - n) * (h + 1), fail on overflow
		$delta += ($m - $n) * ($h + 1);
		// let n = m
		$n = $m;
		// for each code point c in the input (in order) do begin
		for ($num = 0; $num &lt; $codepointcount; $num++) {
			$c = $codepoints[$num];
			// if c &lt; n then increment delta, fail on overflow
			if ($c &lt; $n) {
				$delta++;
			}
			// if c == n then begin
			elseif ($c === $n) {
				// let q = delta
				$q = $delta;
				// for k = base to infinity in steps of base do begin
				for ($k = self::BOOTSTRAP_BASE; ; $k += self::BOOTSTRAP_BASE) {
					// let t = tmin if k &lt;= bias {+ tmin}, or
					//     tmax if k &gt;= bias + tmax, or k - bias otherwise
					if ($k &lt;= ($bias + self::BOOTSTRAP_TMIN)) {
						$t = self::BOOTSTRAP_TMIN;
					}
					elseif ($k &gt;= ($bias + self::BOOTSTRAP_TMAX)) {
						$t = self::BOOTSTRAP_TMAX;
					}
					else {
						$t = $k - $bias;
					}
					// if q &lt; t then break
					if ($q &lt; $t) {
						break;
					}
					// output the code point for digit t + ((q - t) mod (base - t))
					$digit   = $t + (($q - $t) % (self::BOOTSTRAP_BASE - $t));
					$output .= self::digit_to_char($digit);
					// let q = (q - t) div (base - t)
					$q = floor(($q - $t) / (self::BOOTSTRAP_BASE - $t));
				} // end
				// output the code point for digit q
				$output .= self::digit_to_char($q);
				// let bias = adapt(delta, h + 1, test h equals b?)
				$bias = self::adapt($delta, $h + 1, $h === $b);
				// let delta = 0
				$delta = 0;
				// increment h
				$h++;
			} // end
		} // end
		// increment delta and n
		$delta++;
		$n++;
	} // end

	return $output;
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="4">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="../requests_exception/__construct.html">Requests_Exception::__construct()</a> <span>wp-includes/Requests/Exception.php</span> </td> <td class="related-desc"> <p>Create a new exception</p> </td> </tr> <tr> <td class="related-title"> <a href="utf8_to_codepoints.html">Requests_IDNAEncoder::utf8_to_codepoints()</a> <span>wp-includes/Requests/IDNAEncoder.php</span> </td> <td class="related-desc"> <p>Convert a UTF-8 string to a UCS-4 codepoint array</p> </td> </tr> <tr> <td class="related-title"> <a href="digit_to_char.html">Requests_IDNAEncoder::digit_to_char()</a> <span>wp-includes/Requests/IDNAEncoder.php</span> </td> <td class="related-desc"> <p>Convert a digit to its respective character</p> </td> </tr> <tr> <td class="related-title"> <a href="adapt.html">Requests_IDNAEncoder::adapt()</a> <span>wp-includes/Requests/IDNAEncoder.php</span> </td> <td class="related-desc"> <p>Adapt the bias</p> </td> </tr> </tbody>

</table> </article> <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="to_ascii.html">Requests_IDNAEncoder::to_ascii()</a> <span>wp-includes/Requests/IDNAEncoder.php</span> </td> <td class="related-desc"> <p>Convert a UTF-8 string to an ASCII string using Punycode</p> </td> </tr> </tbody>

</table> </article> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/classes/requests_idnaencoder/punycode_encode" class="_attribution-link">https://developer.wordpress.org/reference/classes/requests_idnaencoder/punycode_encode</a>
  </p>
</div>
