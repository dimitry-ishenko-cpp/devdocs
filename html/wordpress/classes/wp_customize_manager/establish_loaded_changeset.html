<h1>WP_Customize_Manager::establish_loaded_changeset()</h1>  <section> <p>Establishes the loaded changeset.</p> </section>   <section> <header class="toc-header"><h2 id="description">Description</h2></header> <p>This method runs right at after_setup_theme and applies the ‘customize_changeset_branching’ filter to determine whether concurrent changesets are allowed. Then if the Customizer is not initialized with a <code>changeset_uuid</code> param, this method will determine which UUID should be used. If changeset branching is disabled, then the most saved changeset will be loaded by default. Otherwise, if there are no existing saved changesets or if changeset branching is enabled, then a new UUID will be generated.</p> </section>  <section> <header class="toc-header"><h2 id="source">Source</h2></header> <p> File: <code>wp-includes/class-wp-customize-manager.php</code>. <a href="https://developer.wordpress.org/reference/files/wp-includes/class-wp-customize-manager.php/">View all references</a> </p> <pre class="wp-block-code" data-start="613" aria-label="Function source code" data-language="php"><code lang="php" class="language-php line-numbers">public function establish_loaded_changeset() {
	global $pagenow;

	if ( empty( $this-&gt;_changeset_uuid ) ) {
		$changeset_uuid = null;

		if ( ! $this-&gt;branching() &amp;&amp; $this-&gt;is_theme_active() ) {
			$unpublished_changeset_posts = $this-&gt;get_changeset_posts(
				array(
					'post_status'               =&gt; array_diff( get_post_stati(), array( 'auto-draft', 'publish', 'trash', 'inherit', 'private' ) ),
					'exclude_restore_dismissed' =&gt; false,
					'author'                    =&gt; 'any',
					'posts_per_page'            =&gt; 1,
					'order'                     =&gt; 'DESC',
					'orderby'                   =&gt; 'date',
				)
			);
			$unpublished_changeset_post  = array_shift( $unpublished_changeset_posts );
			if ( ! empty( $unpublished_changeset_post ) &amp;&amp; wp_is_uuid( $unpublished_changeset_post-&gt;post_name ) ) {
				$changeset_uuid = $unpublished_changeset_post-&gt;post_name;
			}
		}

		// If no changeset UUID has been set yet, then generate a new one.
		if ( empty( $changeset_uuid ) ) {
			$changeset_uuid = wp_generate_uuid4();
		}

		$this-&gt;_changeset_uuid = $changeset_uuid;
	}

	if ( is_admin() &amp;&amp; 'customize.php' === $pagenow ) {
		$this-&gt;set_changeset_lock( $this-&gt;changeset_post_id() );
	}
}
</code></pre>  </section>  <section> <header class="toc-header"><h2 id="related">Related</h2></header> <article class="uses"> <header class="toc-header"><h3 id="uses">Uses</h3></header> <table id="uses-table" data-show="5">  <thead> <tr> <th>Uses</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="set_changeset_lock.html">WP_Customize_Manager::set_changeset_lock()</a> <span>wp-includes/class-wp-customize-manager.php</span> </td> <td class="related-desc"> <p>Marks the changeset post as being currently edited by the current user.</p> </td> </tr> <tr> <td class="related-title"> <a href="get_changeset_posts.html">WP_Customize_Manager::get_changeset_posts()</a> <span>wp-includes/class-wp-customize-manager.php</span> </td> <td class="related-desc"> <p>Gets changeset posts.</p> </td> </tr> <tr> <td class="related-title"> <a href="branching.html">WP_Customize_Manager::branching()</a> <span>wp-includes/class-wp-customize-manager.php</span> </td> <td class="related-desc"> <p>Whether the changeset branching is allowed.</p> </td> </tr> <tr> <td class="related-title"> <a href="../../functions/wp_is_uuid.html">wp_is_uuid()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Validates that a UUID is valid.</p> </td> </tr> <tr> <td class="related-title"> <a href="changeset_post_id.html">WP_Customize_Manager::changeset_post_id()</a> <span>wp-includes/class-wp-customize-manager.php</span> </td> <td class="related-desc"> <p>Gets the changeset post ID for the loaded changeset.</p> </td> </tr> <tr> <td class="related-title"> <a href="../../functions/wp_generate_uuid4.html">wp_generate_uuid4()</a> <span>wp-includes/functions.php</span> </td> <td class="related-desc"> <p>Generates a random UUID (version 4).</p> </td> </tr> <tr> <td class="related-title"> <a href="is_theme_active.html">WP_Customize_Manager::is_theme_active()</a> <span>wp-includes/class-wp-customize-manager.php</span> </td> <td class="related-desc"> <p>Checks if the current theme is active.</p> </td> </tr> <tr> <td class="related-title"> <a href="../../functions/get_post_stati.html">get_post_stati()</a> <span>wp-includes/post.php</span> </td> <td class="related-desc"> <p>Gets a list of post statuses.</p> </td> </tr> <tr> <td class="related-title"> <a href="../../functions/is_admin.html">is_admin()</a> <span>wp-includes/load.php</span> </td> <td class="related-desc"> <p>Determines whether the current request is for an administrative interface page.</p> </td> </tr> </tbody>

</table>   </article>  <article class="used-by"> <header class="toc-header"><h3 id="used-by">Used By</h3></header> <table id="used-by-table" data-show="5">  <thead> <tr> <th>Used By</th> <th class="related-desc">Description</th> </tr> </thead> <tbody> <tr> <td class="related-title"> <a href="changeset_uuid.html">WP_Customize_Manager::changeset_uuid()</a> <span>wp-includes/class-wp-customize-manager.php</span> </td> <td class="related-desc"> <p>Gets the changeset UUID.</p> </td> </tr> </tbody>

</table> </article> </section>  <section> <header class="toc-header"><h2 id="changelog">Changelog</h2></header> <table>  <thead> <tr> <th class="changelog-version">Version</th> <th class="changelog-desc">Description</th> </tr> </thead> <tbody> <tr> <td><a href="https://developer.wordpress.org/reference/since/4.9.0/" alt="WordPress 4.9.0">4.9.0</a></td> <td>Introduced.</td> </tr> </tbody> </table> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2003&ndash;2022 WordPress Foundation<br>Licensed under the GNU GPLv2+ License.<br>
    <a href="https://developer.wordpress.org/reference/classes/wp_customize_manager/establish_loaded_changeset" class="_attribution-link">https://developer.wordpress.org/reference/classes/wp_customize_manager/establish_loaded_changeset</a>
  </p>
</div>
