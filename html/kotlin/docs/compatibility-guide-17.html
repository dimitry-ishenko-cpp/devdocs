<h1 data-toc="compatibility-guide-17" id="compatibility-guide-17.md">Compatibility guide for Kotlin 1.7</h1>
<p id="965a864a"><em id="130dc811" class=""><a href="kotlin-evolution.html" id="f837bf7">Keeping the Language Modern</a></em> and <em id="6746700e" class=""><a href="kotlin-evolution.html" id="50ce1f94">Comfortable Updates</a></em> are among the fundamental principles in Kotlin Language Design. The former says that constructs which obstruct language evolution should be removed, and the latter says that this removal should be well-communicated beforehand to make code migration as smooth as possible.</p>
<p id="88eca36">While most of the language changes were already announced through other channels, like update changelogs or compiler warnings, this document summarizes them all, providing a complete reference for migration from Kotlin 1.6 to Kotlin 1.7.</p>
<section class="chapter"><h2 id="basic-terms" data-toc="basic-terms">Basic terms</h2>
<p id="f9455a20">In this document we introduce several kinds of compatibility:</p>
<ul class="list _bullet" id="882c0225">
<li class="list__item" id="d4af9d19"><p><em id="2f8148b8" class="">source</em>: source-incompatible change stops code that used to compile fine (without errors or warnings) from compiling anymore</p></li>
<li class="list__item" id="a524c1d1"><p><em id="3ae9f2f3" class="">binary</em>: two binary artifacts are said to be binary-compatible if interchanging them doesn't lead to loading or linkage errors</p></li>
<li class="list__item" id="725c2579"><p><em id="45142e3" class="">behavioral</em>: a change is said to be behavioral-incompatible if the same program demonstrates different behavior before and after applying the change</p></li>
</ul>
<p id="774a406b">Remember that those definitions are given only for pure Kotlin. Compatibility of Kotlin code from the other languages perspective (for example, from Java) is out of the scope of this document.</p></section><section class="chapter"><h2 id="language" data-toc="language">Language</h2>
<section class="chapter"><h3 id="make-safe-call-result-always-nullable" data-toc="make-safe-call-result-always-nullable">Make safe call result always nullable</h3>
<aside data-type="tip" class="prompt" data-title="" id="eb1877f7"><p id="4b88fbbe"><b id="a2c3139d" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-46860" id="e7b64633" data-external="true" rel="noopener noreferrer">KT-46860</a></p>
<p id="84d94036"><b id="fac71e6" class="">Component</b>: Core language</p>
<p id="52354b94"><b id="a445c67b" class="">Incompatible change type</b>: source</p>
<p id="f1dffb97"><b id="7ba4ff9e" class="">Short summary</b>: Kotlin 1.7 will consider the type of safe call result always nullable, even when the receiver of the safe call is non-nullable</p>
<p id="f2e97ab6"><b id="cc9e3603" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="dfab836e">
<li class="list__item" id="daf48150"><p>&lt;1.3: report a warning on an unnecessary safe call on non-nullable receivers</p></li>
<li class="list__item" id="ce8b9ce6"><p>1.6.20: warn additionally that the result of an unnecessary safe call will change its type in the next version</p></li>
<li class="list__item" id="b5708b9c"><p>1.7.0: change the type of safe call result to nullable,<br><code class="code ">-XXLanguage:-SafeCallsAreAlwaysNullable</code> can be used to temporarily revert to the pre-1.7 behavior</p></li>
</ul></aside></section><section class="chapter"><h3 id="prohibit-the-delegation-of-super-calls-to-an-abstract-superclass-member" data-toc="prohibit-the-delegation-of-super-calls-to-an-abstract-superclass-member">Prohibit the delegation of super calls to an abstract superclass member</h3>
<aside data-type="tip" class="prompt" data-title="" id="d771dec"><p id="1559270e"><b id="57ef6943" class="">Issues</b>: <a href="https://youtrack.jetbrains.com/issue/KT-45508" id="c133bdb1" data-external="true" rel="noopener noreferrer">KT-45508</a>, <a href="https://youtrack.jetbrains.com/issue/KT-49017" id="36b3a8ac" data-external="true" rel="noopener noreferrer">KT-49017</a>, <a href="https://youtrack.jetbrains.com/issue/KT-38078" id="c19cc23b" data-external="true" rel="noopener noreferrer">KT-38078</a></p>
<p id="f1fdd7d6"><b id="9fdaa36d" class="">Component</b>: Core language</p>
<p id="4993359a"><b id="8260d083" class="">Incompatible change type</b>: source</p>
<p id="782aadf3"><b id="fe0a2b05" class="">Short summary</b>: Kotlin will report a compile error when an explicit or implicit super call is delegated to an <em id="807e0c6d" class="">abstract</em> member of the superclass, even if there's a default implementation in a super interface</p>
<p id="f6fff06a"><b id="cd1bf890" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="8e6bf276">
<li class="list__item" id="ec10ad12"><p>1.5.20: introduce a warning when non-abstract classes that do not override all abstract members are used</p></li>
<li class="list__item" id="da015378"><p>1.7.0: report an error if a super call, in fact, accesses an abstract member from a superclass</p></li>
<li class="list__item" id="a6ccfbcf"><p>1.7.0: report an error if the <code class="code ">-Xjvm-default=all</code> or <code class="code ">-Xjvm-default=all-compatibility</code> compatibility modes are enabled; report an error in the progressive mode</p></li>
<li class="list__item" id="2b444060"><p>&gt;=1.8.0: report an error in all cases</p></li>
</ul></aside></section><section class="chapter"><h3 id="prohibit-exposing-non-public-types-through-public-properties-declared-in-a-non-public-primary-constructor" data-toc="prohibit-exposing-non-public-types-through-public-properties-declared-in-a-non-public-primary-constructor">Prohibit exposing non-public types through public properties declared in a non-public primary constructor</h3>
<aside data-type="tip" class="prompt" data-title="" id="cb30f44f"><p id="40b33dee"><b id="ea4e0d18" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-28078" id="3c5f1364" data-external="true" rel="noopener noreferrer">KT-28078</a></p>
<p id="c33019bf"><b id="6f892591" class="">Component</b>: Core language</p>
<p id="cbdd8b7d"><b id="514360f7" class="">Incompatible change type</b>: source</p>
<p id="ded9b6b3"><b id="c319c28c" class="">Short summary</b>: Kotlin will prevent declaring public properties having non-public types in a private primary constructor. Accessing such properties from another package could lead to an <code class="code ">IllegalAccessError</code></p>
<p id="642f1ea3"><b id="b7ff69ba" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="d26bad57">
<li class="list__item" id="29e122dd"><p>1.3.20: report a warning on a public property that has a non-public type and is declared in a non-public constructor</p></li>
<li class="list__item" id="aa0cf62c"><p>1.6.20: raise this warning to an error in the progressive mode</p></li>
<li class="list__item" id="f71ae3af"><p>1.7.0: raise this warning to an error</p></li>
</ul></aside></section><section class="chapter"><h3 id="prohibit-access-to-uninitialized-enum-entries-qualified-with-the-enum-name" data-toc="prohibit-access-to-uninitialized-enum-entries-qualified-with-the-enum-name">Prohibit access to uninitialized enum entries qualified with the enum name</h3>
<aside data-type="tip" class="prompt" data-title="" id="8f3db0cb"><p id="acf9ec25"><b id="21e426f6" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-41124" id="6aa0b74f" data-external="true" rel="noopener noreferrer">KT-41124</a></p>
<p id="4f38242d"><b id="63d59f5b" class="">Component</b>: Core language</p>
<p id="d91a99a3"><b id="c7f80e0c" class="">Incompatible change type</b>: source</p>
<p id="d4b616a"><b id="d1222e79" class="">Short summary</b>: Kotlin 1.7 will prohibit access to uninitialized enum entries from the enum static initializer block when these entries are qualified with the enum name</p>
<p id="95520a00"><b id="8785620" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="be88dba4"><li class="list__item" id="4419e81"><p>1.7.0: report an error when uninitialized enum entries are accessed from the enum static initializer block</p></li></ul></aside></section><section class="chapter"><h3 id="prohibit-computing-constant-values-of-complex-boolean-expressions-in-when-condition-branches-and-conditions-of-loops" data-toc="prohibit-computing-constant-values-of-complex-boolean-expressions-in-when-condition-branches-and-conditions-of-loops">Prohibit computing constant values of complex boolean expressions in when condition branches and conditions of loops</h3>
<aside data-type="tip" class="prompt" data-title="" id="5dd36b21"><p id="f14b3de4"><b id="be9899ed" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-39883" id="784b64f6" data-external="true" rel="noopener noreferrer">KT-39883</a></p>
<p id="6809e9ca"><b id="34229061" class="">Component</b>: Core language</p>
<p id="d1c51a51"><b id="60c1a88e" class="">Incompatible change type</b>: source</p>
<p id="56c13110"><b id="cd96c727" class="">Short summary</b>: Kotlin will no longer make exhaustiveness and control flow assumptions based on constant boolean expressions other than literal <code class="code ">true</code> and <code class="code ">false</code></p>
<p id="90f0d53f"><b id="fdfc655d" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="5e81384e">
<li class="list__item" id="518f52f3"><p>1.5.30: report a warning when exhaustiveness of <code class="code ">when</code> or control flow reachability is determined based on a complex constant boolean expression in <code class="code ">when</code> branch or loop condition</p></li>
<li class="list__item" id="f459e37c"><p>1.7.0: raise this warning to an error</p></li>
</ul></aside></section><section class="chapter"><h3 id="make-when-statements-with-enum-sealed-and-boolean-subjects-exhaustive-by-default" data-toc="make-when-statements-with-enum-sealed-and-boolean-subjects-exhaustive-by-default">Make when statements with enum, sealed, and Boolean subjects exhaustive by default</h3>
<aside data-type="tip" class="prompt" data-title="" id="69440101"><p id="f7d300b1"><b id="e49597f1" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-47709" id="6615cbb7" data-external="true" rel="noopener noreferrer">KT-47709</a></p>
<p id="44da32d8"><b id="b979a81e" class="">Component</b>: Core language</p>
<p id="7c3ce7d2"><b id="9402e7e2" class="">Incompatible change type</b>: source</p>
<p id="b5f5197b"><b id="a5f58e52" class="">Short summary</b>: Kotlin 1.7 will report an error about the <code class="code ">when</code> statement with an enum, sealed, or Boolean subject being non-exhaustive</p>
<p id="e33fe52e"><b id="885c9f98" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="ad012bc5">
<li class="list__item" id="163e8cbd"><p>1.6.0: introduce a warning when the <code class="code ">when</code> statement with an enum, sealed, or Boolean subject is non-exhaustive (error in the progressive mode)</p></li>
<li class="list__item" id="95e90f9"><p>1.7.0: raise this warning to an error</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-confusing-grammar-in-when-with-subject" data-toc="deprecate-confusing-grammar-in-when-with-subject">Deprecate confusing grammar in when-with-subject</h3>
<aside data-type="tip" class="prompt" data-title="" id="ee8e6bc"><p id="33607a3d"><b id="fdc5c58" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48385" id="c6d64540" data-external="true" rel="noopener noreferrer">KT-48385</a></p>
<p id="c1c79ee"><b id="11228319" class="">Component</b>: Core language</p>
<p id="5c32404e"><b id="19f7c1d3" class="">Incompatible change type</b>: source</p>
<p id="631da16a"><b id="383c6414" class="">Short summary</b>: Kotlin 1.6 deprecated several confusing grammar constructs in <code class="code ">when</code> condition expressions</p>
<p id="2568714"><b id="f2b231b7" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="f0951b7b">
<li class="list__item" id="d0451dc6"><p>1.6.20: introduce a deprecation warning on the affected expressions</p></li>
<li class="list__item" id="a86f7cd5"><p>1.8.0: raise this warning to an error</p></li>
<li class="list__item" id="cbfdfd3c"><p>&gt;= 1.8: repurpose some deprecated constructs for new language features</p></li>
</ul></aside></section><section class="chapter"><h3 id="type-nullability-enhancement-improvements" data-toc="type-nullability-enhancement-improvements">Type nullability enhancement improvements</h3>
<aside data-type="tip" class="prompt" data-title="" id="6a916cc1"><p id="d06fe06d"><b id="c780b20b" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48623" id="eb8b2be2" data-external="true" rel="noopener noreferrer">KT-48623</a></p>
<p id="98e894a"><b id="4a576927" class="">Component</b>: Kotlin/JVM</p>
<p id="63f0e3c1"><b id="e78de8f7" class="">Incompatible change type</b>: source</p>
<p id="6b1df286"><b id="18f81036" class="">Short summary</b>: Kotlin 1.7 will change how it loads and interprets type nullability annotations in Java code</p>
<p id="f133ff4e"><b id="7f1a8b55" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="4254e942">
<li class="list__item" id="25cb7013"><p>1.4.30: introduce warnings for cases where more precise type nullability could lead to an error</p></li>
<li class="list__item" id="2f3913ca"><p>1.7.0: infer more precise nullability of Java types, <code class="code ">-XXLanguage:-TypeEnhancementImprovementsInStrictMode</code> can be used to temporarily revert to the pre-1.7 behavior</p></li>
</ul></aside></section><section class="chapter"><h3 id="prevent-implicit-coercions-between-different-numeric-types" data-toc="prevent-implicit-coercions-between-different-numeric-types">Prevent implicit coercions between different numeric types</h3>
<aside data-type="tip" class="prompt" data-title="" id="90d2fe3a"><p id="36e8ec6f"><b id="174166bd" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48645" id="c0075d9a" data-external="true" rel="noopener noreferrer">KT-48645</a></p>
<p id="854897f2"><b id="c1f92574" class="">Component</b>: Kotlin/JVM</p>
<p id="a1c7a019"><b id="c08abdab" class="">Incompatible change type</b>: behavioral</p>
<p id="ba7f81c5"><b id="b1d6db4f" class="">Short summary</b>: Kotlin will avoid converting numeric values automatically to a primitive numeric type where only a downcast to that type was needed semantically</p>
<p id="ae19416a"><b id="9619cb60" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="7774d83e">
<li class="list__item" id="b15c05f2"><p>&lt; 1.5.30: the old behavior in all affected cases</p></li>
<li class="list__item" id="ffb3dc4b"><p>1.5.30: fix the downcast behavior in generated property delegate accessors, <code class="code ">-Xuse-old-backend</code> can be used to temporarily revert to the pre-1.5.30 fix behavior</p></li>
<li class="list__item" id="3a34e6a6"><p>&gt;= 1.7.20: fix the downcast behavior in other affected cases</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-the-enable-and-the-compatibility-modes-of-the-compiler-option-xjvm-default" data-toc="deprecate-the-enable-and-the-compatibility-modes-of-the-compiler-option-xjvm-default">Deprecate the enable and the compatibility modes of the compiler option -Xjvm-default</h3>
<aside data-type="tip" class="prompt" data-title="" id="70822516"><p id="f09abc1b"><b id="3a6dd8f8" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-46329" id="691ec9dd" data-external="true" rel="noopener noreferrer">KT-46329</a></p>
<p id="d5e90c7f"><b id="e9f0f6f1" class="">Component</b>: Kotlin/JVM</p>
<p id="e5540677"><b id="ba3eec6d" class="">Incompatible change type</b>: source</p>
<p id="647b083"><b id="e86f19cc" class="">Short summary</b>: Kotlin 1.6.20 warns about the usage of <code class="code ">enable</code> and <code class="code ">compatibility</code> modes of the <code class="code ">-Xjvm-default</code> compiler option</p>
<p id="b80ae40e"><b id="b7b0fe66" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="5cc8d740">
<li class="list__item" id="723ccf5c"><p>1.6.20: introduce a warning on the <code class="code ">enable</code> and <code class="code ">compatibility</code> modes of the <code class="code ">-Xjvm-default</code> compiler option</p></li>
<li class="list__item" id="dda119d1"><p>&gt;= 1.8.0: raise this warning to an error</p></li>
</ul></aside></section><section class="chapter"><h3 id="prohibit-calls-to-functions-named-suspend-with-a-trailing-lambda" data-toc="prohibit-calls-to-functions-named-suspend-with-a-trailing-lambda">Prohibit calls to functions named suspend with a trailing lambda</h3>
<aside data-type="tip" class="prompt" data-title="" id="c3a6179d"><p id="a225488b"><b id="a089ee5a" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-22562" id="14481aea" data-external="true" rel="noopener noreferrer">KT-22562</a></p>
<p id="792e381b"><b id="c4c35500" class="">Component</b>: Core language</p>
<p id="3e18ecc8"><b id="51f40649" class="">Incompatible change type</b>: source</p>
<p id="ed4c1009"><b id="a5b4d0e5" class="">Short summary</b>: Kotlin 1.6 no longer allows calling user functions named <code class="code ">suspend</code> that have the single argument of a functional type passed as a trailing lambda</p>
<p id="14c9607a"><b id="7640a431" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="62130767">
<li class="list__item" id="8d2754f2"><p>1.3.0: introduce a warning on such function calls</p></li>
<li class="list__item" id="5d253d33"><p>1.6.0: raise this warning to an error</p></li>
<li class="list__item" id="494eb0b3"><p>1.7.0: introduce changes to the language grammar so that <code class="code ">suspend</code> before <code class="code ">{</code> is parsed as a keyword</p></li>
</ul></aside></section><section class="chapter"><h3 id="prohibit-smart-cast-on-a-base-class-property-if-the-base-class-is-from-another-module" data-toc="prohibit-smart-cast-on-a-base-class-property-if-the-base-class-is-from-another-module">Prohibit smart cast on a base class property if the base class is from another module</h3>
<aside data-type="tip" class="prompt" data-title="" id="bba29ddd"><p id="df9e7f3a"><b id="36cbff57" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-52629" id="839290f1" data-external="true" rel="noopener noreferrer">KT-52629</a></p>
<p id="d838b452"><b id="32cc6c70" class="">Component</b>: Core language</p>
<p id="c0f9682e"><b id="e505438" class="">Incompatible change type</b>: source</p>
<p id="3bb40de8"><b id="81d5d0b3" class="">Short summary</b>: Kotlin 1.7 will no longer allow smart casts on properties of a superclass if that class is located in another module</p>
<p id="cd9eb17b"><b id="6be2a5f6" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="e868eaae">
<li class="list__item" id="fa1f4008"><p>1.6.0: report a warning on a smart cast on a property declared in the superclass located in another module</p></li>
<li class="list__item" id="91b44491"><p>1.7.0: raise this warning to an error,<br><code class="code ">-XXLanguage:-ProhibitSmartcastsOnPropertyFromAlienBaseClass</code> can be used to temporarily revert to the pre-1.7 behavior</p></li>
</ul></aside></section><section class="chapter"><h3 id="do-not-neglect-meaningful-constraints-during-type-inference" data-toc="do-not-neglect-meaningful-constraints-during-type-inference">Do not neglect meaningful constraints during type inference</h3>
<aside data-type="tip" class="prompt" data-title="" id="ac8a554f"><p id="263671a0"><b id="b11af383" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-52668" id="780d4d12" data-external="true" rel="noopener noreferrer">KT-52668</a></p>
<p id="3407cb8"><b id="1c51db12" class="">Component</b>: Core language</p>
<p id="268c714f"><b id="60d55d61" class="">Incompatible change type</b>: source</p>
<p id="8d3b7175"><b id="c160b338" class="">Short summary</b>: Kotlin 1.4−1.6 neglected some type constraints during type inference due to an incorrect optimization. It could allow writing unsound code, causing <code class="code ">ClassCastException</code> at runtime. Kotlin 1.7 takes these constraints into account, thus prohibiting the unsound code</p>
<p id="eb38aa8b"><b id="6feb62b1" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="70cbb025">
<li class="list__item" id="f9c71927"><p>1.5.20: report a warning on expressions where a type mismatch would happen if all the type inference constraints were taken into account</p></li>
<li class="list__item" id="246c340c"><p>1.7.0: take all the constraints into account, thus raising this warning to an error,<br><code class="code ">-XXLanguage:-ProperTypeInferenceConstraintsProcessing</code> can be used to temporarily revert to the pre-1.7 behavior</p></li>
</ul></aside></section></section><section class="chapter"><h2 id="standard-library" data-toc="standard-library">Standard library</h2>
<section class="chapter"><h3 id="gradually-change-the-return-type-of-collection-min-and-max-functions-to-non-nullable" data-toc="gradually-change-the-return-type-of-collection-min-and-max-functions-to-non-nullable">Gradually change the return type of collection min and max functions to non-nullable</h3>
<aside data-type="tip" class="prompt" data-title="" id="befb90eb"><p id="2901b8ef"><b id="60888b97" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-38854" id="dc3896a3" data-external="true" rel="noopener noreferrer">KT-38854</a></p>
<p id="de915809"><b id="1d06b4dc" class="">Component</b>: kotlin-stdlib</p>
<p id="ee2ba77d"><b id="bddf99bf" class="">Incompatible change type</b>: source</p>
<p id="ee2c1df1"><b id="7ea7a954" class="">Short summary</b>: the return type of collection <code class="code ">min</code> and <code class="code ">max</code> functions will be changed to non-nullable in Kotlin 1.7</p>
<p id="d1b5d7ce"><b id="6ee8373a" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="84eab730">
<li class="list__item" id="fcf0e847"><p>1.4.0: introduce <code class="code ">...OrNull</code> functions as synonyms and deprecate the affected API (see details in the issue)</p></li>
<li class="list__item" id="9604cc94"><p>1.5.0: raise the deprecation level of the affected API to an error</p></li>
<li class="list__item" id="3f30fb00"><p>1.6.0: hide the deprecated functions from the public API</p></li>
<li class="list__item" id="4516e30"><p>1.7.0: reintroduce the affected API but with non-nullable return type</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-floating-point-array-functions-contains-indexof-lastindexof" data-toc="deprecate-floating-point-array-functions-contains-indexof-lastindexof">Deprecate floating-point array functions: contains, indexOf, lastIndexOf</h3>
<aside data-type="tip" class="prompt" data-title="" id="ffa6c7e4"><p id="871aea93"><b id="b36edf0f" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-28753" id="c5537c72" data-external="true" rel="noopener noreferrer">KT-28753</a></p>
<p id="e88b1c43"><b id="b50147d0" class="">Component</b>: kotlin-stdlib</p>
<p id="ff3a5291"><b id="e3338964" class="">Incompatible change type</b>: source</p>
<p id="ffc97bcc"><b id="690952d8" class="">Short summary</b>: Kotlin deprecates floating-point array functions <code class="code ">contains</code>, <code class="code ">indexOf</code>, <code class="code ">lastIndexOf</code> that compare values using the IEEE-754 order instead of the total order</p>
<p id="bff7d8ea"><b id="12a6942a" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="e98fab4c">
<li class="list__item" id="d927599b"><p>1.4.0: deprecate the affected functions with a warning</p></li>
<li class="list__item" id="821ad4fe"><p>1.6.0: raise the deprecation level to an error</p></li>
<li class="list__item" id="1e051fb1"><p>1.7.0: hide the deprecated functions from the public API</p></li>
</ul></aside></section><section class="chapter"><h3 id="migrate-declarations-from-kotlin-dom-and-kotlin-browser-packages-to-kotlinx" data-toc="migrate-declarations-from-kotlin-dom-and-kotlin-browser-packages-to-kotlinx">Migrate declarations from kotlin.dom and kotlin.browser packages to kotlinx.*</h3>
<aside data-type="tip" class="prompt" data-title="" id="d01d0cf2"><p id="b3aeec73"><b id="53eab09" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-39330" id="94bcc633" data-external="true" rel="noopener noreferrer">KT-39330</a></p>
<p id="47990e32"><b id="79de187d" class="">Component</b>: kotlin-stdlib (JS)</p>
<p id="faa5537f"><b id="defeafe4" class="">Incompatible change type</b>: source</p>
<p id="3048a3fe"><b id="1b93e52a" class="">Short summary</b>: declarations from the <code class="code ">kotlin.dom</code> and <code class="code ">kotlin.browser</code> packages are moved to the corresponding <code class="code ">kotlinx.*</code> packages to prepare for extracting them from stdlib</p>
<p id="5be94f2e"><b id="53c5dad8" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="f7435c27">
<li class="list__item" id="8d20a71e"><p>1.4.0: introduce the replacement API in <code class="code ">kotlinx.dom</code> and <code class="code ">kotlinx.browser</code> packages</p></li>
<li class="list__item" id="604ab9fc"><p>1.4.0: deprecate the API in <code class="code ">kotlin.dom</code> and <code class="code ">kotlin.browser</code> packages and propose the new API above as a replacement</p></li>
<li class="list__item" id="c1f25e09"><p>1.6.0: raise the deprecation level to an error</p></li>
<li class="list__item" id="54281eb3"><p>&gt;= 1.8: remove the deprecated functions from stdlib</p></li>
<li class="list__item" id="f16fcd09"><p>&gt;= 1.8: move the API in kotlinx.* packages to a separate library</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-some-js-only-api" data-toc="deprecate-some-js-only-api">Deprecate some JS-only API</h3>
<aside data-type="tip" class="prompt" data-title="" id="6170a32d"><p id="2880ec8b"><b id="f6344cd2" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48587" id="cb372bb1" data-external="true" rel="noopener noreferrer">KT-48587</a></p>
<p id="217b63d7"><b id="1c568318" class="">Component</b>: kotlin-stdlib (JS)</p>
<p id="e8e4c276"><b id="2f056119" class="">Incompatible change type</b>: source</p>
<p id="c950e2e3"><b id="b00b8917" class="">Short summary</b>: a number of JS-only functions in stdlib are deprecated for removal. They include: <code class="code ">String.concat(String)</code>, <code class="code ">String.match(regex: String)</code>, <code class="code ">String.matches(regex: String)</code>, and the <code class="code ">sort</code> functions on arrays taking a comparison function, for example, <code class="code ">Array&lt;out T&gt;.sort(comparison: (a: T, b: T) -&gt; Int)</code></p>
<p id="ef4db3cc"><b id="a1e0a8e6" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="ebfe12e8">
<li class="list__item" id="8336d2fa"><p>1.6.0: deprecate the affected functions with a warning</p></li>
<li class="list__item" id="a062e15d"><p>1.8.0: raise the deprecation level to an error</p></li>
<li class="list__item" id="fc359c15"><p>1.9.0: remove the deprecated functions from the public API</p></li>
</ul></aside></section></section><section class="chapter"><h2 id="tools" data-toc="tools">Tools</h2>
<section class="chapter"><h3 id="remove-kotlingradlesubplugin-class" data-toc="remove-kotlingradlesubplugin-class">Remove KotlinGradleSubplugin class</h3>
<aside data-type="tip" class="prompt" data-title="" id="88b04f8"><p id="3c100be4"><b id="47581b44" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48831" id="493fca7d" data-external="true" rel="noopener noreferrer">KT-48831</a></p>
<p id="644c333d"><b id="a4d1c69a" class="">Component</b>: Gradle</p>
<p id="2f67b35b"><b id="b1e0e72a" class="">Incompatible change type</b>: source</p>
<p id="3bc53d67"><b id="c1446170" class="">Short summary</b>: remove the <code class="code ">KotlinGradleSubplugin</code> class. Use the <code class="code ">KotlinCompilerPluginSupportPlugin</code> class instead</p>
<p id="a07c9019"><b id="cc2ff037" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="d901015b">
<li class="list__item" id="ed1e15a4"><p>1.6.0: raise the deprecation level to an error</p></li>
<li class="list__item" id="56f1d7f0"><p>1.7.0: remove the deprecated class</p></li>
</ul></aside></section><section class="chapter"><h3 id="remove-useir-compiler-option" data-toc="remove-useir-compiler-option">Remove useIR compiler option</h3>
<aside data-type="tip" class="prompt" data-title="" id="a450ccf6"><p id="f092903f"><b id="9084a6aa" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48847" id="a95a20c4" data-external="true" rel="noopener noreferrer">KT-48847</a></p>
<p id="5537ffd9"><b id="e342fecc" class="">Component</b>: Gradle</p>
<p id="7627b14d"><b id="3168252d" class="">Incompatible change type</b>: source</p>
<p id="beb5b269"><b id="6cac4aba" class="">Short summary</b>: remove the deprecated and hidden <code class="code ">useIR</code> compiler option</p>
<p id="9acb9249"><b id="2c9b21fd" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="7939147d">
<li class="list__item" id="9ca1d782"><p>1.5.0: raise the deprecation level to a warning</p></li>
<li class="list__item" id="897a43bb"><p>1.6.0: hide the option</p></li>
<li class="list__item" id="fb84c570"><p>1.7.0: remove the deprecated option</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-kapt-use-worker-api-gradle-property" data-toc="deprecate-kapt-use-worker-api-gradle-property">Deprecate kapt.use.worker.api Gradle property</h3>
<aside data-type="tip" class="prompt" data-title="" id="c80664eb"><p id="1270d136"><b id="3e82bbf6" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48826" id="b5349a13" data-external="true" rel="noopener noreferrer">KT-48826</a></p>
<p id="a769a921"><b id="f7d997b4" class="">Component</b>: Gradle</p>
<p id="ec575cba"><b id="1b0fcbe5" class="">Incompatible change type</b>: source</p>
<p id="798008a7"><b id="9a9699df" class="">Short summary</b>: deprecate the <code class="code ">kapt.use.worker.api</code> property that allowed to run kapt via Gradle Workers API (default: true)</p>
<p id="8ed22d01"><b id="3cda79d2" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="b321a1ea">
<li class="list__item" id="5c48f050"><p>1.6.20: raise the deprecation level to a warning</p></li>
<li class="list__item" id="13bd3057"><p>&gt;= 1.8.0: remove this property</p></li>
</ul></aside></section><section class="chapter"><h3 id="remove-kotlin-experimental-coroutines-gradle-dsl-option-and-kotlin-coroutines-gradle-property" data-toc="remove-kotlin-experimental-coroutines-gradle-dsl-option-and-kotlin-coroutines-gradle-property">Remove kotlin.experimental.coroutines Gradle DSL option and kotlin.coroutines Gradle property</h3>
<aside data-type="tip" class="prompt" data-title="" id="78ac386a"><p id="4a43b12e"><b id="da56935a" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-50494" id="94af5b9e" data-external="true" rel="noopener noreferrer">KT-50494</a></p>
<p id="ca17828b"><b id="aea6453e" class="">Component</b>: Gradle</p>
<p id="5f9d3226"><b id="40ec6489" class="">Incompatible change type</b>: source</p>
<p id="338ebfd0"><b id="d78b5a37" class="">Short summary</b>: remove the <code class="code ">kotlin.experimental.coroutines</code> Gradle DSL option and the <code class="code ">kotlin.coroutines</code> property</p>
<p id="e5fe76ad"><b id="ae52be5b" class="">Deprecation cycle</b>:</p>
<ul class="list _bullet" id="5ad075e9">
<li class="list__item" id="41413f1"><p>1.6.20: raise the deprecation level to a warning</p></li>
<li class="list__item" id="d7d6b41c"><p>1.7.0: remove the DSL option, its enclosing <code class="code ">experimental</code> block, and the property</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-useexperimentalannotation-compiler-option" data-toc="deprecate-useexperimentalannotation-compiler-option">Deprecate useExperimentalAnnotation compiler option</h3>
<aside data-type="tip" class="prompt" data-title="" id="eebae9ba"><p id="4b924a0f"><b id="5650c97b" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-47763" id="a9a1d606" data-external="true" rel="noopener noreferrer">KT-47763</a></p>
<p id="18c7abca"><b id="17842639" class="">Component</b>: Gradle</p>
<p id="2bb884b4"><b id="e149f267" class="">Incompatible change type</b>: source</p>
<p id="6cd6cc21"><b id="3d825d7" class="">Short summary</b>: remove the hidden <code class="code ">useExperimentalAnnotation()</code> Gradle function used to opt in to using an API in a module. <code class="code ">optIn()</code> function can be used instead</p>
<p id="2c2decff"><b id="957591c2" class="">Deprecation cycle:</b></p>
<ul class="list _bullet" id="d4c99ba2">
<li class="list__item" id="a7084fd9"><p>1.6.0: hide the deprecation option</p></li>
<li class="list__item" id="d47f4620"><p>1.7.0: remove the deprecated option</p></li>
</ul></aside></section><section class="chapter"><h3 id="deprecate-kotlin-compiler-execution-strategy-system-property" data-toc="deprecate-kotlin-compiler-execution-strategy-system-property">Deprecate kotlin.compiler.execution.strategy system property</h3>
<aside data-type="tip" class="prompt" data-title="" id="67d7fa3a"><p id="cbda3aa1"><b id="8243a76a" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-51830" id="65471840" data-external="true" rel="noopener noreferrer">KT-51830</a></p>
<p id="a151fe1c"><b id="957f8e15" class="">Component</b>: Gradle</p>
<p id="7b61189c"><b id="df8e54e0" class="">Incompatible change type</b>: source</p>
<p id="dc58d154"><b id="91ed2b75" class="">Short summary</b>: deprecate the <code class="code ">kotlin.compiler.execution.strategy</code> system property used to choose a compiler execution strategy. Use the Gradle property <code class="code ">kotlin.compiler.execution.strategy</code> or the compile task property <code class="code ">compilerExecutionStrategy</code> instead</p>
<p id="bc34dcde"><b id="a40f6ee6" class="">Deprecation cycle:</b></p>
<ul class="list _bullet" id="477703d3">
<li class="list__item" id="3bcde035"><p>1.7.0: raise the deprecation level to a warning</p></li>
<li class="list__item" id="55520ef"><p>&gt; 1.7.0: remove the property</p></li>
</ul></aside></section><section class="chapter"><h3 id="remove-kotlinoptions-jdkhome-compiler-option" data-toc="remove-kotlinoptions-jdkhome-compiler-option">Remove kotlinOptions.jdkHome compiler option</h3>
<aside data-type="tip" class="prompt" data-title="" id="4cb92806"><p id="cc909e60"><b id="ca2a6c96" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-46541" id="b8d544f4" data-external="true" rel="noopener noreferrer">KT-46541</a></p>
<p id="d6dd6843"><b id="1417712a" class="">Component</b>: Gradle</p>
<p id="3bcd7163"><b id="53067d45" class="">Incompatible change type</b>: source</p>
<p id="e137f983"><b id="433af2c5" class="">Short summary</b>: remove the <code class="code ">kotlinOptions.jdkHome</code> compiler option used to include a custom JDK from the specified location into the classpath instead of the default <code class="code ">JAVA_HOME</code>. Use <a href="gradle-configure-project.html#gradle-java-toolchains-support" id="dbc7a413">Java toolchains</a> instead</p>
<p id="5c16e25d"><b id="c18a9f55" class="">Deprecation cycle:</b></p>
<ul class="list _bullet" id="1d7f6595">
<li class="list__item" id="828ca7b9"><p>1.5.30: raise the deprecation level to a warning</p></li>
<li class="list__item" id="9804cd43"><p>&gt; 1.7.0: remove the option</p></li>
</ul></aside></section><section class="chapter"><h3 id="remove-nostdlib-compiler-option" data-toc="remove-nostdlib-compiler-option">Remove noStdlib compiler option</h3>
<aside data-type="tip" class="prompt" data-title="" id="29c6d54c"><p id="b14b5491"><b id="ce8d3209" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-49011" id="f641e8a7" data-external="true" rel="noopener noreferrer">KT-49011</a></p>
<p id="d4dbdef9"><b id="84ffba5f" class="">Component</b>: Gradle</p>
<p id="17a65f7"><b id="ca7243a7" class="">Incompatible change type</b>: source</p>
<p id="33962074"><b id="786f573a" class="">Short summary</b>: remove the <code class="code ">noStdlib</code> compiler option. The Gradle plugin uses the <code class="code ">kotlin.stdlib.default.dependency=true</code> property to control whether the Kotlin standard library is present</p>
<p id="88985a2e"><b id="6497a005" class="">Deprecation cycle:</b></p>
<ul class="list _bullet" id="24a0279f">
<li class="list__item" id="619a2c42"><p>1.5.0: raise the deprecation level to a warning</p></li>
<li class="list__item" id="bfc4cf22"><p>1.7.0: remove the option</p></li>
</ul></aside></section><section class="chapter"><h3 id="remove-kotlin2js-and-kotlin-dce-plugin-plugins" data-toc="remove-kotlin2js-and-kotlin-dce-plugin-plugins">Remove kotlin2js and kotlin-dce-plugin plugins</h3>
<aside data-type="tip" class="prompt" data-title="" id="9ba8ba6f"><p id="fbd84bdb"><b id="ddf2bf41" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-48276" id="7e561a4b" data-external="true" rel="noopener noreferrer">KT-48276</a></p>
<p id="724e9752"><b id="f210ea5" class="">Component</b>: Gradle</p>
<p id="53242a6a"><b id="7ab6755" class="">Incompatible change type</b>: source</p>
<p id="8386cf5c"><b id="bbeba342" class="">Short summary</b>: remove the <code class="code ">kotlin2js</code> and <code class="code ">kotlin-dce-plugin</code> plugins. Instead of <code class="code ">kotlin2js</code>, use the new <code class="code ">org.jetbrains.kotlin.js</code> plugin. Dead code elimination (DCE) works when the Kotlin/JS Gradle plugin is <a href="http://javascript-dce.md" id="e24bcaf7" data-external="true" rel="noopener noreferrer">properly configured</a></p></aside><aside data-type="tip" class="prompt" data-title="" id="ee19743f"><p id="92e2d64e"><b id="f12be0e7" class="">Deprecation cycle:</b></p>
<ul class="list _bullet" id="bebc521">
<li class="list__item" id="5f929ace"><p>1.4.0: raise the deprecation level to a warning</p></li>
<li class="list__item" id="1ff30ef0"><p>1.7.0: remove the plugins</p></li>
</ul></aside></section><section class="chapter"><h3 id="changes-in-compile-tasks" data-toc="changes-in-compile-tasks">Changes in compile tasks</h3>
<aside data-type="tip" class="prompt" data-title="" id="9d2d8489"><p id="ec7ab0c6"><b id="26f578c7" class="">Issue</b>: <a href="https://youtrack.jetbrains.com/issue/KT-32805" id="47d93f37" data-external="true" rel="noopener noreferrer">KT-32805</a></p>
<p id="a53db79f"><b id="d6486e21" class="">Component</b>: Gradle</p>
<p id="c57aa9a2"><b id="c5641b47" class="">Incompatible change type</b>: source</p>
<p id="ccf282b6"><b id="794bd139" class="">Short summary</b>: Kotlin compile tasks no longer inherit the Gradle <code class="code ">AbstractCompile</code> task and that's why the <code class="code ">sourceCompatibility</code> and <code class="code ">targetCompatibility</code> inputs are no longer available in Kotlin users' scripts. The <code class="code ">SourceTask.stableSources</code> input is no longer available. The <code class="code ">sourceFilesExtensions</code> input was removed. The deprecated <code class="code ">Gradle destinationDir: File</code> output was replaced with the <code class="code ">destinationDirectory: DirectoryProperty</code> output. The <code class="code ">classpath</code> property of the <code class="code ">KotlinCompile</code> task is deprecated</p>
<p id="179557ed"><b id="584d16d0" class="">Deprecation cycle:</b></p>
<ul class="list _bullet" id="c81ed061"><li class="list__item" id="1379cfa7"><p>1.7.0: inputs are not available, the output is replaced, the <code class="code ">classpath</code> property is deprecated</p></li></ul></aside></section></section><div class="last-modified"> Last modified: 28 December 2022</div>

<div class="navigation-links _bottom"> <a class="navigation-links__prev" href="compatibility-guide-1720.html">Compatibility guide for Kotlin 1.7.20</a> <a class="navigation-links__next" href="compatibility-guide-16.html">Compatibility guide for Kotlin 1.6</a> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2023 JetBrains s.r.o. and Kotlin Programming Language contributors<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://kotlinlang.org/docs/compatibility-guide-17.html" class="_attribution-link">https://kotlinlang.org/docs/compatibility-guide-17.html</a>
  </p>
</div>
