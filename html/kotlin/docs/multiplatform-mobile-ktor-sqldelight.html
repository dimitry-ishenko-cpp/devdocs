<h1 data-toc="multiplatform-mobile-ktor-sqldelight" id="multiplatform-mobile-ktor-sqldelight.md">Create a multiplatform app using Ktor and SQLDelight â€“ tutorial</h1>
<p id="d47b6123">This tutorial demonstrates how to use Android Studio to create a mobile application for iOS and Android using Kotlin Multiplatform Mobile with Ktor and SQLDelight.</p>
<p id="93d1f2f3">The application will include a module with shared code for both the iOS and Android platforms. The business logic and data access layers will be implemented only once in the shared module, while the UI of both applications will be native.</p>
<p id="c84f3a23">The output will be an app that retrieves data over the internet from the public <a href="https://docs.spacexdata.com/?version=latest" id="86b06597" data-external="true" rel="noopener noreferrer">SpaceX API</a>, saves it in a local database, and displays a list of SpaceX rocket launches together with the launch date, results, and a detailed description of the launch:</p>
<figure class=" " id="87b9cc58"><img alt="Emulator and Simulator" title="Emulator and Simulator" src="https://kotlinlang.org/docs/images/android-and-ios.png" class=" " width="600" height="594"></figure><p id="61e1dfe7">You will use the following multiplatform libraries in the project:</p>
<ul class="list _bullet" id="c8702d5f">
<li class="list__item" id="beb23adb"><p><a href="https://ktor.io/docs/create-client.html" id="50d540bc" data-external="true" rel="noopener noreferrer">Ktor</a> as an HTTP client for retrieving data over the internet.</p></li>
<li class="list__item" id="23d38821"><p><a href="https://github.com/Kotlin/kotlinx.serialization" id="2fe800c8" data-external="true" rel="noopener noreferrer"><code class="code ">kotlinx.serialization</code></a> to deserialize JSON responses into objects of entity classes.</p></li>
<li class="list__item" id="1084cf26"><p><a href="https://github.com/Kotlin/kotlinx.coroutines" id="e5aa96fc" data-external="true" rel="noopener noreferrer"><code class="code ">kotlinx.coroutines</code></a> to write asynchronous code.</p></li>
<li class="list__item" id="8f39d0bb"><p><a href="https://github.com/cashapp/sqldelight" id="270c0014" data-external="true" rel="noopener noreferrer">SQLDelight</a> to generate Kotlin code from SQL queries and create a type-safe database API.</p></li>
</ul>
<aside data-type="note" class="prompt" data-title="" id="f16a4174"><p id="f59001e">You can find the <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage" id="487eb27f" data-external="true" rel="noopener noreferrer">template project</a> as well as the source code of the <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="b57aeb4" data-external="true" rel="noopener noreferrer">final application</a> on the corresponding GitHub repository.</p></aside><section class="chapter"><h2 id="before-you-start" data-toc="before-you-start">Before you start</h2>
<ol class="list _decimal" id="64f2bb06" type="1">
<li class="list__item" id="4afbd82a"><p id="b717513">Download and install <a href="https://developer.android.com/studio/" id="5594d80d" data-external="true" rel="noopener noreferrer">Android Studio</a>.</p></li>
<li class="list__item" id="7a3901d9">
<p id="e5e5470e">Search for the <a href="https://plugins.jetbrains.com/plugin/14936-kotlin-multiplatform-mobile" id="3f9d476" data-external="true" rel="noopener noreferrer">Kotlin Multiplatform Mobile plugin</a> in the Android Studio Marketplace and install it.</p>
<figure class=" " id="f0e7b634"><img alt="Kotlin Multiplatform Mobile plugin" title="Kotlin Multiplatform Mobile plugin" src="https://kotlinlang.org/docs/images/multiplatform-marketplace.png" class=" " width="700" height="394"></figure>
</li>
<li class="list__item" id="caef57de"><p id="4f6d0c1f">Download and install <a href="https://developer.apple.com/xcode/" id="8c1e5521" data-external="true" rel="noopener noreferrer">Xcode</a>.</p></li>
</ol>
<p id="b17622c2">For more details, see the <a href="multiplatform-mobile-setup.html" id="ef295f4">Set up the environment</a> section.</p></section><section class="chapter"><h2 id="create-a-multiplatform-project" data-toc="create-a-multiplatform-project">Create a Multiplatform project</h2>
<ol class="list _decimal" id="22beec35" type="1">
<li class="list__item" id="101ecae6">
<p id="db6cce5d">In Android Studio, select <b id="81bb624b" class="">File</b> | <b id="a62a3e15" class="">New</b> | <b id="753eb6f5" class="">New Project</b>. In the list of project templates, select <b id="d1bd6b16" class="">Kotlin Multiplatform App</b> and then click <b id="49acc4ed" class="">Next</b>.</p>
<figure class=" " id="7600eb02"><img alt="Kotlin Multiplatform Mobile plugin wizard" title="Kotlin Multiplatform Mobile plugin wizard" src="https://kotlinlang.org/docs/images/multiplatform-mobile-project-wizard-1.png" class=" " width="700" height="526"></figure>
</li>
<li class="list__item" id="3354f0ee"><p id="ed546eeb">Name your application and click <b id="e1485a2d" class="">Next</b>.</p></li>
<li class="list__item" id="3194a294">
<p id="16ce464e">Select <b id="f272cf53" class="">Regular framework</b> in the list of <b id="bc1b90d4" class="">iOS framework distribution</b> options.</p>
<figure class=" " id="ff4f4b3a"><img alt="Kotlin Multiplatform Mobile plugin wizard. Final step" title="Kotlin Multiplatform Mobile plugin wizard. Final step" src="https://kotlinlang.org/docs/images/multiplatform-mobile-project-wizard-3.png" class=" " width="700" height="524"></figure>
</li>
<li class="list__item" id="d8a61951"><p id="b194c2c0">Keep all other options default. Click <b id="673bbe28" class="">Finish</b>.</p></li>
<li class="list__item" id="9a3f77e9">
<p id="d5db255d">To view the complete structure of the multiplatform mobile project, switch the view from <b id="cde3f570" class="">Android</b> to <b id="69332800" class="">Project</b>.</p>
<figure class=" " id="bd24524e"><img alt="Project view" title="Project view" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYoAAAHyCAMAAADC0XmOAAAB41BMVEUmdb/x8fHy8vLv7+/R0dGuucDw8PD////z8/MAAADu7u7t7e3r6+vs7OyM0+zq6urp6enm5ubk5OTo6Ojn5+fg4ODl5eWDnbM1nNKZmZmkpKT0rz1AtuAdHR26urrh4eHAwMCtra1mZmZiYmKJiYnc3d093ITBwcEuLi5sbGwfHx+9vb13d3e+vr6cnJyjo6P39/eioqLOzs5QUFDa2trj4+N5zOlS3ZCXl5enp6dycnJLS0uPj4/09fX6+/s/Pz+UlJQ8PDyAgIB+fn7ExMRwcHC0tLReXl4lJSWEhIT+/v7V1dVaWlpISEiqqqryZSJitUNERERU4JIqKirS0tIWFhevr6+3t7fe39/KysrLy8s1NTXIyMifn59VVVXZo0OxsbFjY2OMjIzJyckyMjJ7e3vY2Njz9fmRqdO95vWmpqbR2eo5OTnAzOPY3+29xsx9m822wMfHx8jGxsat7crHz9OnuNrW8Pgkcbnf5fCx2qH5spHr7vZy5aVbiMXl6fOL57VbweUJDRDJ0+e5xuCe2u8KITUiaawdWpOvv92dsdb2vFuF0OuwsLDi8/Bvk8nv8vfm++8SN1tH3ovC8tj4yn76156AzuoYS3rR7ez98+L97tb74beK0uz86MdIf8Lx8u899S4RAAAgAElEQVR42uxXbU8UyRamqjc1nX5JT083c6+TlDOwEDSAKDBBV64vwEpgvJswITKKENDoEozGXImJyaIk7hdNZPfDfvHb/tT7nFMzwwwgL+ImEOtMd09XPadO1Zynzjk1HT9YOSXSYV1wiqhwrZwCsVRYKqxYKiwVViwVlgorlgpLhRVLhaXCiqXCUmHFUmGpsGKpsFRYsVRAakVLxMFU/LW53drc3vxrX7X08ePaIbN0Lf90ADo4d/3xkZW/SyrEVnWrtb2r2ZQ7Wl86ZJZrevUA9JLW146s/H1Gxedq9XNba3tftQmtp72TUDE88KRiqTiQiv9sVTd3WptfCIrKotZ68CRUnET5eynbf1erGxtbm9Xq5tbGRrX6975K63p6Uo+3dY22lOGkkrZ7t9Jrvsu9e23tUbZUNAT+HxsbM4+xjf11Lupzn/T1uvNfLa8mV7uRsbpM++Hkor49MGW8C7D30V3dQ3xcGrh94eerploPLy+P7lG2VDRE0scwMVZno7rhClcq6Qq+zEf8T+uHtTm9wj2iT8890iwFas8v8/vtHr0KvKRvTqLVI2Rvt1EaGRZCSJiowGJlR7nFPnAIDhErk7tkpR3n1t71nVL8cCqgT8OUwu1uMAmNB+4N2YZjCqGu6otK9ugn0lVKyhJ8eetBsX9aX6+5svizvl14MLw+p/Uq8EGAMwvDFbc4QP2VrmU9XYGVV6BCyDKUhx78cI2UW+zjidUr/KD1J21MrMt2nOffu75Tj+9DhSAeHFcKVsa1Qe6naKgnKHw2WnGpMCS7rJdcd0EvVng8vP2I8PNaT0mFY+461uCuaNroiArd49H483R6xfj+RV0A/hBUSNjQ6zT/J6Nct09byKVFY+1Lk5M7bCx5u/Hd6z9LeJMKCUSZiKCfDBbB5DZTUK2HRdVwsb2Dkzkl4NVh7OgRfYXH92ndT3hZ6zvCXdLT0MKO+Akb3SWwj8cv6R/N+AlkK1dRVLjonDbzQ3nHvhlv1uffYhKYjlvhXrx9/WcON1Gh0JCCbuYIb67cIipc1YgKVxIvWzu4YDZnNP01VuP6Io9HVIwyPqI/kadnFFscJ+8KgL08fkbPmPGX9I/1qBBQnjDz30Jhado34+vrSx41YmI82Q9vW/+Zw+sJilBBrCnGQNk2R4PrmhQ1NibM2+cGTnlOyd6bWi9Dbmv9SpioqDEOKoTq1leZdRx44V3UdN3J9tFvxndpXXYVlW0h0GnmL1Bhqdt3zfjG+oo9home8v54y/rPHm4SFEhhTJpehA+dnszxqfWJyk0BJhwhFFfNX3RTbgnl0MavMQ4qpKSoQIFyBDa6EgxygKLfjF/Sd4FPaT3vqkk94wiKWyg37QszHtUN42F/dIYy1MTTL+FKtq/vNOLGv8KckQQfqtj/zbLNlYUh1pdb7P4GA82XTSUNLpniAT1w/wHJuF6OMRiVuZNxosI9p7uFcDDTAKJCUFSAJ4xf0t1mPDIVcHOYZWXaKQN8mDX2XTNeml+Ae34CXMx/GVft6zvdOPFAxdv4v14rBGcxQA4fvaQjN8da/lI06ahWGzg4Vs6w1l10FnAUdvaCy97uZXxE33MUTk5ddFY4f4GigrJXJ9vHYekTjZ+6qZeAo2zPCzpu3aP5F6DcsA/LwtgXFNi0vseTk/fVAXjb+s4GLo3/mwmKw4poBE3EX7UeFU0i6nQ0cEGUXtI3e2GQwnGV8wsnKMKpVri9q3ru09PRlRH+q8Blm+3XLuq5e6O189N6edhVDlEh1SiUu57WWLlhH0t36/ab6+vv35l/P7x1fWcGRy4SJiooK1EIKRfhpMxIkKM8UAfiJBoOtR3pOYg4xUaVCqb1RAM/p28+VQ7lIMZH9Ar0H17XenFRX8AfaIf/4tXM+PlprS+gvvx3iuzTYRb277coiyPNf4ZxLgREDoJAGv8zFfC8Q38/BPOHGHI8oXA5EqHFFhz8NcN/KpIWHI5faeAPkIyUKpkc5HjLyDboH7wIh3ffWaCN7tVrBeH3x7u1vttTYvtEBdk3ygt3QMXR5j/7OFVz3vlO/TAL6gRxJHmQ4mrD9QXpzKEu9KHfEzDh+dQFZTCKvkPxylRlfxw7YM/4+anKce2fNXyXf4kbYfxfrxUcUkA8yUnNcTzHUWyI2ADiK+70cSJwlMW/Bc61A95WfM6VplZIz/UE8yPqJnwlfE9JGPBCnyz4oJYyn++hhU5Hhb4jQsfix8N3+xf1BMcr8r+hwhPSxJRP6gIhRN+e75NVfGCYWPVgFh3Kdyx+clxR3vL4SGv8b8o2AgSjqLgj14G4kC+8+r6vfDLp+2QGTOLb8wK+LP51eMO/TBNKCWcwxzNlmzqFrzxcIZ6wghAzJkIM9cMgDGE8DDw/8tADQQt9YRgE/LT4YbgTwI+Oj2fdv5SxQJePUk/+NycoRAjHBQNgIoApGk9vCCqahZCATFJHFIYWPxnucT+lLo/PVijVhgpEEmgKPdQajMALRtGAKIj8KAhwR0E2jHyPGx51BKHFvxY3/g0oacHr5HYcgX2mIlSo/JSHQAhM+GQmCjyYC7NBEIVZGI3QleU7IbtBFpNEgcWPixMndf9S7FC8OAH539QKqi6eB7aCgDMeCERQRFmylM0mdMFEGuAbZqMs3gBlkyhILH483MdGjxLyL3HElQVJi0q6Uy/bSEpUZCiUwCO4yKawGSUR7ARgNI6SBGbRTtJsNptGSUyzpNk0sfjR8WyQQCeiwEmiMKBIiUIq4lTMTVRQGaGAorgJWNfYhIUgycdJSu/ZOGbTMazG2TSN+Suy+NFx2toRc2U4SSh3IW0FVMFNrQg9uB8pLsDIENaShBiNEVBxigniNInzedhOc2k+m+c+0J5P0iRv8ePg+SSO0IKLsdvTiDJYRCUe6SowVESBT9UegrwGHqI4gYE87OIB87l8mpJRkjymSnJxPs7n4lxi8WPhaco0IXLAB66IchqqC52mmArOTchjMaIHIUE85pI8SM3nyjAU59IcrMW5MuzSFGiV01wOWhY/Lk5bHDq0yVHfQQuSUUKHLRMVqNNZym5gDEzm43JczpXL+XIRRovlYmc5X8wVy2Vc5c5isVjuNF8AyrlisbNGKPVALN6O7/Yf3fkiPjkEDsiiCpDnbGWoeDgF6aMbUuKrr29wENdgP+4SP3H34S7RO7pK5tXix8NLfYMlgOTn0lSJvuu+f/WKqbjTde0XfEgK19YL64VCYQiPoQLJUOEKXUOFIdz0MjSExxW8XSENNCx+NNx408gQuXl9HR6nG97vWmAqOqycArFUWCqsWCosFVYsFWebin8dINZllgpLxbeh4u2zN6+ts/9BKl68Y3nzfu2waZ5nMn9aZ/+DVPyaacifL78FFWsvXry2VHwlFTd+g1yePZSLoyWo15nMc0vFLiq+pL6bCrPVP/6Wybz5BouxVJyYio6XlzO/7qSZDyZC3q59eP3H3vj4+OHj29b22oc1S8WBVPx7H/kiFR1vMhk4dG129vdnKCDvycUvbqCGzL77yPgfs7PPOpq9N940KDLty++IjfezVHVmZ59bKk5CxbNM5ndQkcm8I3cSFe/qBf0G7/mXmf+zd+4/aSxtHD960Olzqmlt60napHDEksqKvitgIigXb4igJEQ5UG9pvVBTtbVtbDRp2gSNt6Rp40/97fyr79wW2AEUFZHFedIUZhlmcT478zzP7HwBURTa0e85hNRU7En2+fN9ieJ6oyKyTVGgyN7WAe799wi93f+yhbv+7XYOBT76det06xdC71k0jF/e+LJPauE6pzjO2jg93ZYoroFi3U99BUbhP2AH8IW+zi/7jSwKfPQXmZq2f6HIT15/nQ+WA+krKoDi59ZbdpmvZ2eeLa1Tf/rpIYYCHz3RXj7Jr4UTConimigiqqr6ibv9/o2h2PhDm3n4PPMVqVkU+OjWAbF95hHeU2cvg9mKoNB88943Pi3tawD8Oce8raH4inK2p6slUVwbhX+D2BeeKBRDwa58DUXkl2bvJYqbiaBEFKUmqIgu57vJCWr37PDwWKI4x20fCIuErNb2xsZJhVEcwuZzOJYoSgSzpzzL+GP/7duD4sHsXoX+riOwo8ZwZleiIHPPL5zi7RWkeL+21k/eR5D6jSfpOMUjtdT/WC3/RpF1qyvYMfQhFILfEkVuiUPNX/j4L7sccqBf+PCfcMdSoYWP3WN4hjN/5XBXosguB7LbFNoa1M89uhz4fV1XK1teJy9XCMUQbtgBR3WAorhd5t72t9OTL9s5SBvZo+tCrfzyt+31PyqCIvMGo3gNv3clCr3tVzlj2D1KdGEUFjg7Oj4+MjSKyu74OPnuR5HT6qI4hAbMIpPIAMDvI5xknO1KFDRQqliUWi6KM0jis27CTLI7DhkIBCCxa0AUlbat73sHVf67jo7BgVFYSUzbBvADoRicHSbOju44iluw3ePEDEYxAB78vwL3cJgGkJmGQ4mimnZ8mDn8jZ3FXwh9hkWMIp4h+coqONFyDUe3dYjiGBJLChyegRmh5nAPhjAyQVB0dpH8+3hXoqja1HSYaEH+SeyqXyC94fSxu4YTjTpEkVki/d4LMIEKTKKobnKnkMUU5IXNQhRJiaK6GYWXTkerCn1oRKixBSHfQ1KK1ToKVEfm/9scgBh51uwm/9vnEZrA48NOYlsUhO7GSI1+8rpDEfnT2adkcn/SBB4bSxhD53NEl2pNPomiWijU/p7lTFgtjmLweVRFEkW1WPjcITusFUVxLxN3Gw9FE7ePO81G8xbNsx3zEOUlgiCLYgiW2/2GRYEtZTQWDxaCmQAvvMlD0Z+Y6XlsaBRGYxFRLeYpWGYFK0YwFaYo/POZZWdDxNAoDMeiMRrrgnf0+TjG8KaLBrMOsCYtNesqLnLbatuHJr1d/VQdnldVm6IejvWG6fo48rUh9Gc/9thtbtiMzTZHjIoCW7o0it4X1IZCtnJO1QVPqzdFpcxDinC+UQh+fuhHxkKhj57cJVF0gmbjD2sKBYrccyeDM3yOQq3ziQXsvBPmdjViUBTcS7hLo9h0OBzeqTCA/UFNoUD+hnRy4Pk8K7iA5HyDirOGp6eLUQgeW0RhZ3OYA+gOsBpCQViENhMhc3c3TvimJ2AwNp+o3fSuLBR6FsVRoAcu7eZAi8nZkO/2ba8sJVEIdVtNzr90IYN7Je3LKzc6Ta2Xy/QCfPocDg4s4YeMzW9sFLrJqQQKFAQgXd5jx3/xzJvXWmf2TuOya9KSj8IZVwLRwrrtk3iaU9aiHiVOy76ncdqJGqyX1hlc9n66BAvLD4fdarXaRxZDyf+98I7GUncBxTOAMYTGwvwyXGRHl3nRZcqhcAZgeAUV1G2ws1JgGYbpgRf85UnW1DsFIEHYvSwfRetcR9/i4mJfx5jbtvDjWexl211AMQTKE5SKw2rM6VwchMQjcnARYMJjCo3wW5sUBSYRIOmFWBf3vLVjNrRGRgJ/r9fsNo8D9NLJaxWmxhrSHqXYXdKSEe2TtMnpdJrST3y+Fls03e+L1D8KWwCsCK04HElS8gDZbIFSAIPU0UzSIUNRaCTEurMAS23kSl5jKFIJGCeOo8UKYfLYDdBDR994OWGzNiz8PvITvvdUfyTiV31MSlvfKBp6pvjFy+yJQktm1ssI9ff2chTOOCch1n0NwGaeB/MUBX7vAi0nAVbYw8BV0gtqBlmuuSaKsMvlGlTIlM7jRPernmRHmHqFpwD9+mB2LQ7Dc7kDeXWDkOCJiZ2i6AWgX7PegxmRu6O2VTLZzfpRHds1UXALDFEStuU4P0C61wGDQl6BbVCjo6/rBRfSXP0wfW/O6BJriMRiEB+wSBQlUAz2YYs52ZBIk86NT9jXWPeuwbSIAv/zFq07Ctr9hRGOQrFqxqa+1r5OMvrmYxLF+REU4u55iFy1Kpt08CTTrkdhtXgBgsXq4oCJLylOURRPYeZ+wWdtM+PBEk5LFBejcEGc3nz9zK50HPXQIAk99HjmeATV7wJ4XaRuD5Dd99g+KZrbHiv2cZ9qbUoUehNQdEKARJqNfNKxJCBu4zlDTzavWIWuucK6/ZsQJn1vm2bBrBvgDfXjr6emyHuDVhbE/qtFWhLFuSgGAEbG2ru93BWjPhz1xGbNOOde8mez7RBOvi2Fdc0K9g5D3hkIsBQPv25PplYWFVhqZMGu16S2JKdhWpUoLkYRneY3Lwb5wt8Qj4GmF/LWoIK4gq+wbh8rvwgyFP5JLTj7hxSbrWTRIwGwGpJuuxgKqx4FcntxiDQz9GSJJ3xsOXB6lHnkeXZU9dKBINZFK8te+/JLxFGg5iBZVw2McG/u63WRNRGvCUkU5d3XbjSZmvUL3XO2cusyG4Ul/syX1r/3sTON6tkqjOKqZrFa2b2n9HAZN6HuEIpbsHGcZ4y19oeWtIUrieK27LN2x03pQxLF7VpqhMAYHr+rY6K2dpK3v0qjO2z1t6lfopAmUUgU0iQKiUKaRCFRSJMoJAppEoU0icIQKIz7TQZ1i8KA32RQxygqxEJ9tzx7/VZ8z4boV3dUUQFeSyjOY1G+btsMMH6FT8dPQIzsKUwC+wK06gosawfFOVsNytdtl4fCMjAQRcVPQL8eU6Jour5uW/UMRS/+ME5xj0EnzHu5vcuboCSKIiguo9u+Egp7sXoSRUkUebptbLaFv9lIsL2KFu7MF9XY+cruy6MQWruktLseUXDdtkVRejxTAB1kMqGbNMMjbF66H1bY99AIaux8Zfe/Ct18o4RKotBa0VAIrV1e2l2PKJhuOwVAdx0TFJru2kWjqxYgPwNVoMbWKbs7+PPSKLRWNBT61q4g7a5HFFS3TVBAV9A8lqKaFGvMZMad1fk414mCGluv7G6J4jgrFo22lotC39pVpN11iILptgmKeSYWSjEVBb3s+7KdKKqxRWV3EV8x9Q+zT4UohNauJO2uNxRZ3Tbu2pFsHtFNnzQM0kOsE0U1tqjsLoJCM1chCqG1K0q76waFXreNUXh4mgzAwijkoJv0WSeKamxR2X05FEJrhpd2Vybb5rrtFPPYKF+zPUChsE4U1diisrsICmsbsweFKMTWjC7tviYKnW67FIpHORR6Nbao7L4orxBRCNpug0u7KxRBiSjw5NGmQXFlO1FUY4vK7suhKKbtNrK0+4ZQmHk4U+C2dWpsUdntFFXZ56Iooe02rLT7hlCQYLa/IJgV1diisntW+66DslAIrRle2n1DKGiK1zHbjft4Ii/FE9TYorK7NQHTsfx1q/NTPH1rhpd23xSK4gsfghpbVHazoKjshQ99a4aXdl8LhajbtuShYEt14dGorhMFNbag7EYp8nKo5AnuJ1jewhXgQmtGl3bf4OYb1T0325IbL884IkGNLSi7fW2PLnMOoTVDS7urtA8qpLvYpd0aCufIJihR2dk1gMIDRl+qqxsU5pGBMdnVNeIrpEkUEoU0iUKikCZRSBTSJAqJQppEIVFIMyYK28emj27ZlbWAYqepqWlHdmUtoCA/PvxBduXtolBtKmrcofe8dxqQ3+aTHXpbKPB42MluQMDPPlTu17YWPB3/Z+/sfptG1jAuUIo1cGj5liBSoZAICAWyKYuAQMMp323VXdSWpnQ5h2VppaLeAFpVOlzvVffsXUEHFv7W4/F4xvPtCbGbcf2+FyxmM+/Y84vnK3789PJxqpgsK4rDyvMg+keHe/PlJkHf2O8YVEdcVhTUof73enhHvF0bMfVPvfly94KCKb3LjuIfb6OXsuAH/fYes3yuN1/uXlCwB57L3kEFTXxfnKBHk8OfPg1PalH0ru/uEQVMZjEK1vh/XQ/jLwsKN333gUrroA2FVemtk4uPLJ8uG4pNjGLThiJV3x0ER2rzCC2uzhAUy40GeVak1WicJy2tV3ozYbiQDle0dDbsF9sPS9FB4VFifTOYXv8To/hzfTrYXDehSNN3B3dukcOnxDXyF/qE/jIVbBiU3rIwnKQLK7o7T/5hbHejiIftSXw/DA9fjwP/bdOAIk3fjR8tPzfXYr7bCgqT0jtGIaXDFXXmKpUbDfT04K5GQSazb6eDr9evf7rOx1c9ilR990zYl2BNWHNcj8Ko9I6F4VI6XNHzmPDzEizxrpFBAt8P6+v03tjUoHDQdy/Rpj3xWovCqPRmCjMhXVjRanR8vwCPT2ew8XEomPwjav5wlAhHjOivf0yKKFz13UTPiuOsFoVR6c2E4UK6sKIXZBpdgMGi/+3AO7jVMYDhaANqGt8X64bVdqq+OzmuaVEYld5UjSymYxV1dz2KgJ/HkvaPbotNGYWrvjsNhVHprUFxpOwoAi0KV333DdbDsA6KdP7xy1SMSm/WQQnpyogirYNy1Xc/pE1/mAzbC/STV8gHjUpvNmxflobtkqFIH7Zd9d0z8Wx0Mp7MNlfQePS5CdLIRqV3Mpn9UZzMlgyF42RWg0LWd+MFQHi8dC9e4gUXEbrdWngWzoLJ992k9OaWeFy6EnZQX69L8dWxg1I2PvZejOdarwiK31bid9LRrseg9DZufJQNRcrGh7u+O/x/Tx4jtDi+8AZ1ouPLeDdv44c6Qme47UBF6U0l3WI6VtHpEg3b1u3AlMUJp++Ouv1WhT8MDrbWmtLnbUpvOV1hIsunA42b5BA7jcL40xHETqMw/qAKsdMoSExDo/qCAgJQAAoIQAEoIAAFoIAAFIACAlAACkABKCAABaCAABQlQ/EB//EfaM/Bo/jwE/7zZz2L2zU+zkOj54niw08EhZ7Fa8THG2smxXIbUPRKIkahZbGK/bIvItSOjLPt4t7dpP4dAApMgqL42TReHHJ7Qzyg6JsEQ2FiIaAw22QLKAptnz0AFIREgsLAgkNhtskWLLcLbp+98yhiEhwKPQsOhdkmm7fcLrp99o6joCR4FFoWCQqLTTYnxC68ffZOo2AkBBQ6FgyF3SabjRWFt88uAAq7TTZDsVQ6T56d76DsNtkMReHtswswbNttspPJbNHtswswmbXbZHPrioLbZxdgiWe3yRZX20W2zy7AxofdJlux3C6sffZAUKRtB4oo7DbZTIhdePvswaBI2SSXlnhWm2wmxC68ffaAUNh/OpJQ2G2yqRC78PbZg0KR/oPqyCJbslltspnldtHtsweGorew2mQnQuxC22cXBAUEoAAUEIACUEAACkABASgABQSgABQQgAJQQAAKQAEBKCAARVFQDNNYh7fG+oJiePh/0ES+oPiaDYvmm1cL31143041BvXEHbu57CMKGwt3H+1RhB581/mtnRxvo4l7Vw/kc/lXEj35y8Qp+gI66SGKEIZwNMx/zt1H2w2FKto+34krOJfPsx/JFaCa/yiGbShcfbSbN13ssBWl8FIjbJwrY3cfIdTp5oNi5VYcb5IOqpAoevfR7gnFLGpEDiD7arFpS/YoLmr+tcAo3Hy04/tDlGxb3bMPI1rBgQ76lSsxYx06uBM4banZBYVZYO4rilQfbWaHLUq2Te7ZdMwmuiQcv41eimc5fF7Zjps/AT61pmYdCnqWFIVZYO4xijQfbdkV6klczuCeTSeX86gjD9dCXo3xMDsBPrWmZh0KepYUhVlg7jGKNB/t+CJFybbZPZvGKkIrN4TTE/NqUNATEFKrNbugsAjM/UWR6qMdOwiKkm2zezbrodrR97q2ROfKUl4NiuQE+NRyzckVzJ4h8U5BYReY+4nCwUeb+Wrykm2zezaLIzXyMqmV20d0eTUokhPgU8s1q+uKCQWFXWDuHQpXH23mNstLts3u2VwcevkkujXaa5q8GhQ3WUfGp5ZrdkFhF5h7h8LVR5t6MIuSbaN7thTP787H62AprwaFcgLxoVhzcgVnD5MYUVDYBebeoXD10aYoRMm20T1bXfxtkNtBymtGIaVWxOIOw7ZdYO7tDEpGIRtfk4uUJdtG9+w4Ro6zb2C4cHmn5pXtuIUTOC5MvOYPpK+2RRR2gXlhUMjG12zYFiTbRvdsNkVGrWQB0lLzynbcyQlIqQ1icSsKu8C8MChk42tykZJk2+yeHUf4pR8nX8y1Dnp9UM0r23EnJyCllmt2QWEXmBcGhWx8HV+kKNk2u2cn24FodmlmT2Vug+43SnklO27uBKTUcs0uSzyrwLw4KPQbH6JkOzC6Z9NYeJTMYfbo8kp23PwJiKmVmh1Q2AXmfqFw99GmFylKto3u2Unj1KLfjhZnTf7coh03fwJSarlm3RVQ0+6VeHfEKjDfGRTZBG983WW/N0iS7TT37HCYGB17P2LKG6h23ObUUs0uYRWYFwcFHw/FLzvEoFC0pjZQYwYa2wMUN1Hp3snoK4rRqRv3oak9GSsgAAWggAAUgAICUAAKCEABKCAABaCAABSAAsJTFENxvP19H7SQHyjC6EIT+YIiIxZ96bb7jYLovlNR2Fjkrtu+UrvLHiE4U6sd6z1DgXTf6Sik4D+Xu277HCcSOoVQzw9sFEr33SeKnHXb4ZU+Xu4DRaF0332iyFm3jb90swe+H0WhdN+ZoMhLt03u/9sKCjXzyLJOgKLVfafKvgel+84GRU66bSwKekQf42coxMy4ziX8tGZbfeZNo/sWC3ul+84IRT667bCCB6151P5RQCFmDuvE8jBarTi5VHXfYmGvdN8ZochJtx2iwE/n3+NRSJlxnZ25SuVGAz1Vbn5F9y0V9kr3nQ2KvHTbGEUzvJT/JijkzLjO5+TbgJ4rPZSk+5YLe6X7dkKRMn/IT7eNUQTX/ok21hgKOXNY52p0fF/3hLSk+5YLe6X77hNFzrrtCAXW+1xsUhRy5rDOF3SMxl38tfE44kyC7lsu7JXu2xHFv7nQnEheum2CIpjC3UmMQs7M6oz/0qIVcOsIpvuWC3ul++4TRc667RjFiTaab+lQHFFR1KfiuCRkJrpvubBXuu8sxgoWWeu2KYrgzCJ69IJ1UEJmGYWw8JN133Jhr3TfOaHIRrfNUOCW7LBh+7z4rAkAAA7JSURBVLI0bBtRKLpvubBXuu8+O6h8ddsJiv2RVLWuyWxDoei+5cJe6b5zQpGRbpuhCFrziFvicZltKFTdt1TYK913Th1URrrtBAVuGtPGhxmFqvsWC3ul++4LRe667bPkp5jok+Giu6vJzOo8rUGh6r4l2bdPum/Hh2/0HVTK79nZ6LZTMqf/pCrpvuXC3ui+c0TBB+i2v/Ono6wDdNveoADddoYo+uugQLftDQoIbzooCEABKCAABaCAABSAAgJQAAoIQAEoIAAFoLB+4ts3aCU/UExvbU1DM3mB4mO1+jGDemQp82AsrQuNolkNw+TX4K7bVpSCg3GMLTSKbYxi2/A/3XXbgKJvFF+qUXwxoXDVbQOKvlFsERRbJhTOum1A0SeKv6tx/G1F4aDbjpp+srKwX0GhyKG7LfJ+lPpz7j0puTpdFwDFZHhT4P+Gt8WkFUWqbhs3fXfqKULztcMCCkHajMs/exSWun1wcqwdfvhsXDpnp2v/UUyHE9kYhX5C667bDpv+Vfwo8XiTRyFIm7EGu0EOX5B/Js6peTtd+4/iczVBUf1sRZGm2w6bHqF7S625c7GEQittxuUnHrZehDfE4tNnlbGzRPKYu9O19yimt3kU2zYUqbptjGIVd3LdNnk2XyttDkt1cJf0MuyjsFxojQiBc3e69h7FtyqPovrNiMJBtx02/QZpxiWit9NKm7txR7V/IyIbKdSDHXC69h3F9JaIQrMV5a7bDps+voG6hJpW2szKT+AXXQX4VQIYRe5O176j+FgVUWhGbnfddtj0dOHRiTodrbSZlZ+IxdEERe5O156jaFZlFOpWlLtu24hCkDabUOTtdO05iu2qEtvmGZSMQhZIGzooSdpsRBHk63TtN4ovVU18cUYhC6STYXtUGrbvO6IIcnS69hvFVlXtoJStKHfdNp7MRm91Oi5MZiVpswFF7k7XXqNgm08CCnkryl23HS3xppYWxn4Vl3iitNmAInena59RTG7pUUhbUe667bDpb0xoNj5EabMBRe5O1x6jmP5Y1aOQJrTuuu1gBc1dW+3g7cAT8bFG2nxaRRFtdeTtdO0xis9VY3x2T62qq5szmp1uNzl0rk7X/qKY3jaj2A4gBrAzq90OgSbzBQUEoAAUEIACUEAACghAASggAAWggAAUgAICUOxaFHX+BcDQXANEUR8CFH6gqA8BCj9Q1IcAhR8o6kNuKJp7Mz+t/pyrdx2K+pADir0Pb000Gu0Hz/b3eSJZOlfvNhT1IQcUlQn6IHi7z69vls7VuwxFfcgBxfsNhFZqV6++6iD0+nKfKLJzrt61SzwzigP/QuhB9IjZofHwvjjWH4rsnKtLiOIKVdwFwdFZwTJqpDXDjeWKNFtjj52lc/UuQ5FmZYtjFl2gZmfBzAZ5uBhrr1u3FhHaoDbTijRba4+dpXN1+VBUUOIKFRkqvw+Ip+lrweFSkWZr7bGzdK4uH4qHQp90hTRuN5oDXWqdmoiNX1VpttYeO0vn6vKhuInQs+RoNGnrSHZXWUEX7uik2Xp77Cydq8uH4iRC3GJihiAI23qWDK+nqFemJM3W22Nn6VxdPhQ/CO6z90kDdVGsuQ7eIfRSJ80W7LGdUPTqXF0+FM9os9Lu6mbAO+AdjYYSkzS7q6DIzrm6fCjOs/dIxJOcUQHFoRiFXpqtosjOubp8KPZtoDabBe2ZRfNHNR2USZrdC4penatLuMSb4m6L8KYYD/TD9v1+UfTqXF1CFJXHrDeaQ6ixHDcxWW2Ek9nXd8zS7F5Q9OpcXUIUeGrTePL+/+2d208TSxjAo6eHzViISoSEk6akWKpUQCzq4VLaCsit0KQCFkQIcmmCITnhCI8k8uAbL6Qk5989s7szuzPfzHQLBaz2+14osDN7+e3OZbu//Tqf7Mbn+HTPmeLtDKS+brEpnkHNvgqKq2aubkYUmS5/aJMb4od4Mine+DCo2VdCccXM1c2IwrIGxtxj1BcVOoMBe5Kwwe/d6dVsmB77JjNXNycK2pA/i8UGyqBf7k6tCG8mvU6mahhXyVzdrChArOmSwWMgCkSBcZMorhut6fQuHtaGQIGBKBAFBqJAFBiIAlFgIApEgYEoEAWiaGgU170ViIEofmcU/4SPEEVjoAhbE0eIoiFQHE1AFuYqWm5wc27T0/48qvtO60HDbLupr1BY6IuXu/rHyfDUy/AN7c5tapA58g785dFfPUVS3N9MNcS2G7ttyEJb+lmWPZ/09GrPX3SPjOR/PoppvvXLsYZG8edRxmphGI5OXq/pCpeShIwNxnKzhGTXrrLWlGRm/CQUL5YJGc+N5vpIYIrqn4zijbVw4nw4CZtez79Iks751BL3np39dVA8GSdk3ukpSu9u5OHbW0PBSRz9YSz7mPAn+sJZ8oX9cagXONk8/XZrKHVPi0Is4ezOUKrsG0XQ+dYL22LldshieDiUalNQjBAyy2r6xnJiWSBJuKYqefVqSnHdNtfomJtQcBIn9KAsHJyfRSJn5wfg6ih7PrC1G3VTpg45WbaH552tF9NvD9jNwPKXbfvvH51napPJGaWEvTsr/fbbKjbdXQG+tkHYFitXxfD2OC2zup8HKIbJhtdf9ZOk8+ihnCRcrUpevZpSXLfNNTvmBhQeCXr0DygHN84OpMUmlkkWdNc73Kez6xTSb0/PsX/YxliMfZ5RStDdiQ9771yxoK9tELalyhUxfII91VuclFCkmA/iHvT19Qfi6txcWUpVYPVKZq36HHMDinzmhHXdCz8iQvyQLox9evqOiKU3bV8xNDNJHKPaT7+9ViR7hZSdSHu1nbYm+SghhXy+TSlh52ybG/xWjmXJ6roFfW2DsC1XrojhaTq+K6Rm9u0zVSg1o9FcQZJwWBVYvZpSvD7H3DivcHpseqpIJCgLqYUad06KeInp03Tbx52R1DxPSs/Sb+/295fsn6Osj/D6ClCC7k6yxA7UK8XXNgjbcuVQDM/TNXTYDWG/jGLU0dOkgEnCYVXy6jUpxetzzKveDjyhrRND8PYt+yC1Ue1x9x0SG2k7ZS1PymlZbwYHp8X0296oJeme3h4KUILujnvyZJbtFgr42gHCtls5FMNLfA2dexIKWTrnGyMlCddUNWJeum7HvCqKsLXA+4kFi/cXct/9aHveuTTGy+7uvZHPslH/t9frA6XYnHsReyhACbuvcD9s2bsHfO0qwrZfORTDWWZjyzY4RBSv+JH0AyYJh1XJq9ekFK/PMa+G4mjBuygiFkchXxZOfLI7tzFLTO3MUfBpbO9OkXVmMgpQwh8QztoooK9tELalyqHW5K8hLqH4yJoVIWCScMWQklavSSlen2NeDQVtn85VFOe6KduhszX7ZEmPomwfq+Js3z5EAUooKICvrRW25cprRTHgDcv0KNp1spq4ek1K8foc84AvVM9UFGf+5Kej25/Jkn+di7NDi4J2yml72SHYQIESAIXO11aFbblyePxGvHZEbqDCe2TLn3IWCt1qknCtN+itXpNSvD7HPABFREUR8f6ZdsRsPp9IOcOFktuDjI5+EvdgmBRb2LSWo3AXBCUACoOvDYRtuXJ4/GZ4n/BY7rbtkTi/8zSxSN49UpOEmxROd/WalOL1Oea1oljwR7X+FwB0luSeAeUs2aMj7+5VUuxlsxzR0baekqw9lLvPG6gVrhaDEgAF8LUNwrZcOTx+eTbmzIDBrLWe5O/emci5mwOThMOq5NVrUorX55jX2kD957E4E28HksVS/l6ocMjOMDosmS2sROnGbWVEFLSVmJzueDHGu+22VbJUcO7eyCUACuBrG4RtuXLlVE47mb9LU2CK5/zjeS7Uli/1ELLXyydtQpJwWBVYvZpSvD7HPACF1237LIRue2XWHyzc47vnxNJn6brOL7l/fj/ODnW/d+NDKgFRyL62QdiWK1dQ3O9jVewAFEM73tYvpixLe+NDqgquXn/j49qOeQCKg4jAInMGB7Otcefbl9VF3pS6N/eWpmRHm162Y8/pFqWfbDEPe832sGeUEp6nTVsdZ3wj+9oGYVuqXBXDu+fn6Cb2r3wlWbB32+5LqIrxh7zTkJKEK1WB1SspxetzzANQeFM8m8VbzRTPKkdj3x6K59prvaN9PxSSvgSfeNweUIItB5xvrbANK4e30FOhVv1/VqKxqFS9miRcDnn1hqWv55gHPR14EAFxYGHcTgQ+qFntdiDGnaLIVLlJjnGnKKp8dYRx1yiMX6hi3DkKDESBKDAQBaJAFIgCA1EgCgxEgSgwEAWiwEAUiALjV0Shl6b94Plray6AKNSIxeM12KmqNC0Hz+pcc4FmQnF5eiH+enF6qT+di4S8RBS3iuI08V389XviVLtYlJBa8mcGHVmlgUIUwmWQSFyYfhNiiiT9p5ivj6L+Ar9zXyFeBwvgGvGic5nkNsSstlawNM1NbtWRNhRoehSZSuL4+PRDpfLh9Pg48bfeYSoQkp8nRSaMB0nTosktW888wbbJsm7yEdRxQohj/TI95IstSbB3EwRJ04LJDR7+5XmmDJZ1k6O4rIgoKtoBVN4ePtFB1KSHoqo07Zvc0HrmKAyWdXOjkK4J03XRRVZ77eO3/JijqCpN+yY3tJ4ZCpNl3dQoLhNKqNdFZpi8txz1qsAPcFVp2je5ofXMUJgs62ZGcVFRUVSU4ey0y4AS6eMoqkrTvskNrWeGwmRZNzOK7/axtyxOwf2kjGdpS5/bpEEHRXmGoqqp63tI0HpmKExqbxOjuEjoUMBZXtuhr4t31YGiHVGYURwntAF67m063OlzIkuGM1awNO2jgNaz30B1YgMFbkBpA9yGGiN7zP3adG3lIGnaRwGtZ4bCaFkjChAfpIV6k96bbfLuu7SCpGkfBbSe/cGs3rJuXhQVPYqKtNAr4Q2APeQwHCxNC68FANazMMXTW9bNfeMjKGZJ1ntLxldnIhEkTYtvaNDf+DBa1oiiSqz4b3GkBzlpT+6CpGkxybZsPfME21Usa0RRb5ilaYP1bC6AKDAQBaLAQBSIAlEgCgxEgSgwEAWiwEAUvy4KjMYIRNEw8T/BSKKf11yCtwAAAABJRU5ErkJggg==" class=" " width="200" height="253"></figure>
</li>
</ol>
<p id="25211bc4">For more on project features and how to use them, see <a href="multiplatform-mobile-understand-project-structure.html" id="edd5a9f0">Understand the project structure</a>.</p>
<aside data-type="note" class="prompt" data-title="" id="b458776d"><p id="6a675e2">You can find the configured project <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage" id="e32d5dc1" data-external="true" rel="noopener noreferrer">on the <code class="code ">master</code> branch</a>.</p></aside></section><section class="chapter"><h2 id="add-dependencies-to-the-multiplatform-library" data-toc="add-dependencies-to-the-multiplatform-library">Add dependencies to the multiplatform library</h2>
<p id="7f05680f">To add a multiplatform library to the shared module, you need to add dependency instructions (<code class="code ">implementation</code>) for all libraries to the <code class="code ">dependencies</code> block of the relevant source sets in the <code class="code ">build.gradle.kts</code> file.</p>
<p id="e2819f3d">Both the <code class="code ">kotlinx.serialization</code> and SQLDelight libraries also require additional configurations.</p>
<ol class="list _decimal" id="bda7a15b" type="1">
<li class="list__item" id="d478f710">
<p id="c2541268">In the <code class="code ">shared</code> directory, specify the dependencies on all the required libraries in the <code class="code ">build.gradle.kts</code> file:</p>
<pre class="code" data-language="kotlin">val coroutinesVersion = "1.7.1"
val ktorVersion = "2.3.2"
val sqlDelightVersion = "1.5.5"
val dateTimeVersion = "0.4.0"

sourceSets {
    val commonMain by getting {
        dependencies {
            implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:$coroutinesVersion")
            implementation("io.ktor:ktor-client-core:$ktorVersion")
            implementation("io.ktor:ktor-client-content-negotiation:$ktorVersion")
            implementation("io.ktor:ktor-serialization-kotlinx-json:$ktorVersion")
            implementation("com.squareup.sqldelight:runtime:$sqlDelightVersion")
            implementation("org.jetbrains.kotlinx:kotlinx-datetime:$dateTimeVersion")
            }
        }
    val androidMain by getting {
        dependencies {
            implementation("io.ktor:ktor-client-android:$ktorVersion")
            implementation("com.squareup.sqldelight:android-driver:$sqlDelightVersion")
        }
    }
    val iosMain by getting {
        // ...
        dependencies {
            implementation("io.ktor:ktor-client-darwin:$ktorVersion")
            implementation("com.squareup.sqldelight:native-driver:$sqlDelightVersion")
        }
    }
}
</pre>
<ul class="list _bullet" id="a64cd647">
<li class="list__item" id="bf7e3975"><p>Each library requires a core artifact in the common source set.</p></li>
<li class="list__item" id="ef1d4f6f"><p>Both the SQLDelight and Ktor libraries need platform drivers in the iOS and Android source sets, as well.</p></li>
<li class="list__item" id="8a48516b"><p>In addition, Ktor needs the <a href="https://ktor.io/docs/serialization-client.html" id="840007ca" data-external="true" rel="noopener noreferrer">serialization feature</a> to use <code class="code ">kotlinx.serialization</code> for processing network requests and responses.</p></li>
</ul>
</li>
<li class="list__item" id="94b25f54">
<p id="db762304">At the very beginning of the <code class="code ">build.gradle.kts</code> file in the same <code class="code ">shared</code> directory, add the following lines to the <code class="code ">plugins</code> block:</p>
<pre class="code" data-language="kotlin">    plugins {
    // ...
    kotlin("plugin.serialization") version "1.9.0"
    id("com.squareup.sqldelight")
}
</pre>
</li>
<li class="list__item" id="f041f8fa">
<p id="41b32369">Now go to the <code class="code ">build.gradle.kts</code> file in the project <em id="d2f9ef79" class="">root directory</em> and specify the classpath for the plugin in the build system dependencies:</p>
<pre class="code" data-language="kotlin">buildscript {

    dependencies {
        // ...
        classpath("com.squareup.sqldelight:gradle-plugin:1.5.5")
    }
}
</pre>
</li>
<li class="list__item" id="64af41c5">
<p id="3f0ec406">Finally, define the SQLDelight version in the <code class="code ">gradle.properties</code> file in the project <em id="9bfdeeb0" class="">root directory</em> to ensure that the SQLDelight versions of the plugin and the libraries are the same:</p>
<pre class="code" data-language="none">sqlDelightVersion=1.5.5
</pre>
</li>
<li class="list__item" id="3ff8f6f3"><p id="81d72631">Sync the Gradle project.</p></li>
</ol>
<p id="3c1e4216">Learn more about adding <a href="multiplatform-add-dependencies.html" id="74e00c3d">dependencies on multiplatform libraries</a>.</p>
<aside data-type="note" class="prompt" data-title="" id="7cf2ea1d"><p id="ea246336">You can find this state of the project <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="4812d41b" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section><section class="chapter"><h2 id="create-an-application-data-model" data-toc="create-an-application-data-model">Create an application data model</h2>
<p id="d3557542">The Kotlin Multiplatform app will contain the public <code class="code ">SpaceXSDK</code> class, the facade over networking and cache services. The application data model will have three entity classes with:</p>
<ul class="list _bullet" id="80fede">
<li class="list__item" id="12d98b36"><p>General information about the launch</p></li>
<li class="list__item" id="874b56d3"><p>A URL to external information</p></li>
<li class="list__item" id="d6423027"><p>Information about the rocket</p></li>
</ul>
<ol class="list _decimal" id="fa20d159" type="1">
<li class="list__item" id="1cc6382b"><p id="3d73e20c">In <code class="code ">shared/src/commonMain/kotlin</code>, add the <code class="code ">com.jetbrains.handson.kmm.shared.entity</code> package.</p></li>
<li class="list__item" id="d9196675"><p id="24b9fa45">Create the <code class="code ">Entity.kt</code> file inside the package.</p></li>
<li class="list__item" id="f4d07600">
<p id="416cbbd7">Declare all the data classes for basic entities:</p>
<div class="code-collapse" data-lang="kotlin" data-is-expanded="false" data-anchors="[c34eef88]" data-synopsis="data class RocketLaunch" data-disable-link-processing="true">import kotlinx.datetime.TimeZone import kotlinx.datetime.toInstant import kotlinx.datetime.toLocalDateTime import kotlinx.serialization.SerialName import kotlinx.serialization.Serializable @Serializable data class RocketLaunch( @SerialName("flight_number") val flightNumber: Int, @SerialName("name") val missionName: String, @SerialName("date_utc") val launchDateUTC: String, @SerialName("details") val details: String?, @SerialName("success") val launchSuccess: Boolean?, @SerialName("links") val links: Links ) { var launchYear = launchDateUTC.toInstant().toLocalDateTime(TimeZone.UTC).year } @Serializable data class Links( @SerialName("patch") val patch: Patch?, @SerialName("article") val article: String? ) @Serializable data class Patch( @SerialName("small") val small: String?, @SerialName("large") val large: String? )</div>
</li>
</ol>
<p id="25d7c981">Each serializable class must be marked with the <code class="code ">@Serializable</code> annotation. The <code class="code ">kotlinx.serialization</code> plugin automatically generates a default serializer for <code class="code ">@Serializable</code> classes unless you explicitly pass a link to a serializer through the annotation argument.</p>
<p id="39a7193a">However, you don't need to do that in this case. The <code class="code ">@SerialName</code> annotation allows you to redefine field names, which helps to declare properties in data classes with more easily readable names.</p>
<aside data-type="note" class="prompt" data-title="" id="3f8a256f"><p id="e0704fe">You can find the state of the project after this section <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="7b9af770" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section><section class="chapter"><h2 id="configure-sqldelight-and-implement-cache-logic" data-toc="configure-sqldelight-and-implement-cache-logic">Configure SQLDelight and implement cache logic</h2>
<section class="chapter"><h3 id="configure-sqldelight" data-toc="configure-sqldelight">Configure SQLDelight</h3>
<p id="6e25c297">The SQLDelight library allows you to generate a type-safe Kotlin database API from SQL queries. During compilation, the generator validates the SQL queries and turns them into Kotlin code that can be used in the shared module.</p>
<p id="567a476f">The library is already in the project. To configure it, go to the <code class="code ">shared</code> directory and add the <code class="code ">sqldelight</code> block to the end of the <code class="code ">build.gradle.kts</code> file. The block will contain a list of databases and their parameters:</p>
<pre class="code" data-language="kotlin">sqldelight {
    database("AppDatabase") {
        packageName = "com.jetbrains.handson.kmm.shared.cache"
    }
}
</pre>
<p id="6bf9e70b">The <code class="code ">packageName</code> parameter specifies the package name for the generated Kotlin sources.</p>
<aside data-type="tip" class="prompt" data-title="" id="67e02638"><p id="ec893681">Consider installing the official <a href="https://cashapp.github.io/sqldelight/multiplatform_sqlite/intellij_plugin/" id="142faa67" data-external="true" rel="noopener noreferrer">SQLite plugin</a> for working with <code class="code ">.sq</code> files.</p></aside></section><section class="chapter"><h3 id="generate-the-database-api" data-toc="generate-the-database-api">Generate the database API</h3>
<p id="79108986">First, create the <code class="code ">.sq</code> file, which will contain all the needed SQL queries. By default, the SQLDelight plugin reads <code class="code ">.sq</code> from the <code class="code ">sqldelight</code> folder:</p>
<ol class="list _decimal" id="9d0bca2" type="1">
<li class="list__item" id="b6fa2406"><p id="f6bb5bf8">In <code class="code ">shared/src/commonMain</code>, create a new <code class="code ">sqldelight</code> directory and add the <code class="code ">com.jetbrains.handson.kmm.shared.cache</code> package.</p></li>
<li class="list__item" id="5f1534d0"><p id="91150ebf">Inside the package, create an <code class="code ">.sq</code> file with the name of the database, <code class="code ">AppDatabase.sq</code>. All the SQL queries for the application will be in this file.</p></li>
<li class="list__item" id="6b5fee38">
<p id="5964f26f">The database will contain a table with data about launches. To create the table, add the following code to the <code class="code ">AppDatabase.sq</code> file:</p>
<pre class="code" data-language="plaintext">CREATE TABLE Launch (
    flightNumber INTEGER NOT NULL,
    missionName TEXT NOT NULL,
    details TEXT,
    launchSuccess INTEGER AS Boolean DEFAULT NULL,
    launchDateUTC TEXT NOT NULL,
    patchUrlSmall TEXT,
    patchUrlLarge TEXT,
    articleUrl TEXT
);
</pre>
</li>
<li class="list__item" id="2520f5c8">
<p id="7618539d">To insert data into the tables, declare an SQL insert function:</p>
<pre class="code" data-language="plaintext">insertLaunch:
INSERT INTO Launch(flightNumber, missionName, details, launchSuccess, launchDateUTC, patchUrlSmall, patchUrlLarge, articleUrl)
VALUES(?, ?, ?, ?, ?, ?, ?, ?);
</pre>
</li>
<li class="list__item" id="e29d57b9">
<p id="87cb99c1">To clear data in the tables, declare an SQL delete function:</p>
<pre class="code" data-language="plaintext">removeAllLaunches:
DELETE FROM Launch;
</pre>
</li>
<li class="list__item" id="5864a5d6">
<p id="d631ed83">In the same way, declare a function to retrieve data:</p>
<pre class="code" data-language="plaintext">selectAllLaunchesInfo:
SELECT Launch.*
FROM Launch;
</pre>
</li>
</ol>
<p id="1a7b18de">After the project is compiled, the generated Kotlin code will be stored in the <code class="code ">shared/build/generated/sqldelight</code> directory. The generator will create an interface named <code class="code ">AppDatabase</code>, as specified in <code class="code ">build.gradle.kts</code>.</p></section><section class="chapter"><h3 id="create-platform-database-drivers" data-toc="create-platform-database-drivers">Create platform database drivers</h3>
<p id="6da5b2f0">To initialize <code class="code ">AppDatabase</code>, pass an <code class="code ">SqlDriver</code> instance to it. SQLDelight provides multiple platform-specific implementations of the SQLite driver, so you need to create them for each platform separately. You can do this by using <a href="multiplatform-connect-to-apis.html" id="48dd4844">expected and actual declarations</a>.</p>
<ol class="list _decimal" id="75003fab" type="1">
<li class="list__item" id="d515b9">
<p id="b0acef73">Create an abstract factory for database drivers. To do this, in <code class="code ">shared/src/commonMain/kotlin</code>, create the <code class="code ">com.jetbrains.handson.kmm.shared.cache</code> package and the <code class="code ">DatabaseDriverFactory</code> class inside it:</p>
<pre class="code" data-language="kotlin">package com.jetbrains.handson.kmm.shared.cache

import com.squareup.sqldelight.db.SqlDriver

expect class DatabaseDriverFactory {
    fun createDriver(): SqlDriver
}
</pre>
<p id="173e322f">Now provide <code class="code ">actual</code> implementations for this expected class.</p>
</li>
<li class="list__item" id="4b007a01">
<p id="704a94fd">On Android, the <code class="code ">AndroidSqliteDriver</code> class implements the SQLite driver. Pass the database information and the link to the context to the <code class="code ">AndroidSqliteDriver</code> class constructor.</p>
<p id="2b306feb">For this, in the <code class="code ">shared/src/androidMain/kotlin</code> directory, create the <code class="code ">com.jetbrains.handson.kmm.shared.cache</code> package and a <code class="code ">DatabaseDriverFactory</code> class inside it with the actual implementation:</p>
<pre class="code" data-language="kotlin">package com.jetbrains.handson.kmm.shared.cache

import android.content.Context
import com.squareup.sqldelight.android.AndroidSqliteDriver
import com.squareup.sqldelight.db.SqlDriver

actual class DatabaseDriverFactory(private val context: Context) {
    actual fun createDriver(): SqlDriver {
        return AndroidSqliteDriver(AppDatabase.Schema, context, "test.db")
    }
}
</pre>
</li>
<li class="list__item" id="18330d63">
<p id="efddecb5">On iOS, the SQLite driver implementation is the <code class="code ">NativeSqliteDriver</code> class. In the <code class="code ">shared/src/iosMain/kotlin</code> directory, create a <code class="code ">com.jetbrains.handson.kmm.shared.cache</code> package and a <code class="code ">DatabaseDriverFactory</code> class inside it with the actual implementation:</p>
<pre class="code" data-language="kotlin">package com.jetbrains.handson.kmm.shared.cache

import com.squareup.sqldelight.db.SqlDriver
import com.squareup.sqldelight.drivers.native.NativeSqliteDriver

actual class DatabaseDriverFactory {
    actual fun createDriver(): SqlDriver {
        return NativeSqliteDriver(AppDatabase.Schema, "test.db")
    }
}
</pre>
</li>
</ol>
<p id="ea601c22">Instances of these factories will be created later in the code of your Android and iOS projects.</p>
<p id="9fba605c">You can navigate through the <code class="code ">expect</code> declarations and <code class="code ">actual</code> implementations by clicking the handy gutter icon:</p>
<figure class=" " id="7d20e59a"><img alt="Expect/Actual gutter" title="Expect/Actual gutter" src="data:image/png;base64,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" class=" " width="500" height="39"></figure></section><section class="chapter"><h3 id="implement-cache" data-toc="implement-cache">Implement cache</h3>
<p id="ff9807ba">So far, you have added platform database drivers and an <code class="code ">AppDatabase</code> class to perform database operations. Now create a <code class="code ">Database</code> class, which will wrap the <code class="code ">AppDatabase</code> class and contain the caching logic.</p>
<ol class="list _decimal" id="dc969ec5" type="1">
<li class="list__item" id="436ab8f5"><p id="faab1473">In the common source set <code class="code ">shared/src/commonMain/kotlin</code>, create a new <code class="code ">Database</code> class in the <code class="code ">com.jetbrains.handson.kmm.shared.cache</code> package. It will be common to both platform logics.</p></li>
<li class="list__item" id="a616c664">
<p id="3da8f2fa">To provide a driver for <code class="code ">AppDatabase</code>, pass an abstract <code class="code ">DatabaseDriverFactory</code> to the <code class="code ">Database</code> class constructor:</p>
<pre class="code" data-language="kotlin">package com.jetbrains.handson.kmm.shared.cache

import com.jetbrains.handson.kmm.shared.entity.Links
import com.jetbrains.handson.kmm.shared.entity.Patch
import com.jetbrains.handson.kmm.shared.entity.RocketLaunch

internal class Database(databaseDriverFactory: DatabaseDriverFactory) {
    private val database = AppDatabase(databaseDriverFactory.createDriver())
    private val dbQuery = database.appDatabaseQueries
}
</pre>
<p id="de0961d2">This class's <a href="visibility-modifiers.html#class-members" id="3c37bd32">visibility</a> is set to internal, which means it is only accessible from within the multiplatform module.</p>
</li>
<li class="list__item" id="59e944e4">
<p id="c6ea81f3">Inside the <code class="code ">Database</code> class, implement some data handling operations. Add a function to clear all the tables in the database in a single SQL transaction:</p>
<pre class="code" data-language="kotlin">internal fun clearDatabase() {
    dbQuery.transaction {
        dbQuery.removeAllLaunches()
    }
 }
</pre>
</li>
<li class="list__item" id="e4a65bd4">
<p id="60282c9f">Create a function to get a list of all the rocket launches:</p>
<pre class="code" data-language="kotlin">import com.jetbrains.handson.kmm.shared.entity.Links
import com.jetbrains.handson.kmm.shared.entity.Patch
import com.jetbrains.handson.kmm.shared.entity.RocketLaunch

internal fun getAllLaunches(): List&lt;RocketLaunch&gt; {
    return dbQuery.selectAllLaunchesInfo(::mapLaunchSelecting).executeAsList()
}

private fun mapLaunchSelecting(
    flightNumber: Long,
    missionName: String,
    details: String?,
    launchSuccess: Boolean?,
    launchDateUTC: String,
    patchUrlSmall: String?,
    patchUrlLarge: String?,
    articleUrl: String?
): RocketLaunch {
    return RocketLaunch(
        flightNumber = flightNumber.toInt(),
        missionName = missionName,
        details = details,
        launchDateUTC = launchDateUTC,
        launchSuccess = launchSuccess,
        links = Links(
            patch = Patch(
                small = patchUrlSmall,
                large = patchUrlLarge
            ),
            article = articleUrl
        )
    )
}
</pre>
<p id="89e6de1a">The argument passed to <code class="code ">selectAllLaunchesInfo</code> is a function that maps the database entity class to another type, which in this case is the <code class="code ">RocketLaunch</code> data model class.</p>
</li>
<li class="list__item" id="1c6d8319">
<p id="e24d2d59">Add a function to insert data into the database:</p>
<pre class="code" data-language="kotlin">internal fun createLaunches(launches: List&lt;RocketLaunch&gt;) {
    dbQuery.transaction {
        launches.forEach { launch -&gt;
            insertLaunch(launch)
        }
    }
}

private fun insertLaunch(launch: RocketLaunch) {
    dbQuery.insertLaunch(
        flightNumber = launch.flightNumber.toLong(),
        missionName = launch.missionName,
        details = launch.details,
        launchSuccess = launch.launchSuccess ?: false,
        launchDateUTC = launch.launchDateUTC,
        patchUrlSmall = launch.links.patch?.small,
        patchUrlLarge = launch.links.patch?.large,
        articleUrl = launch.links.article
    )
}
</pre>
</li>
</ol>
<p id="7b467c33">The <code class="code ">Database</code> class instance will be created later, along with the SDK facade class.</p>
<aside data-type="note" class="prompt" data-title="" id="e55c6a37"><p id="97317a7b">You can find the state of the project after this section <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="793f30e7" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section></section><section class="chapter"><h2 id="implement-an-api-service" data-toc="implement-an-api-service">Implement an API service</h2>
<p id="f07a30f3">To retrieve data over the internet, you'll need the <a href="https://github.com/r-spacex/SpaceX-API/tree/master/docs#rspacex-api-docs" id="852ec2c2" data-external="true" rel="noopener noreferrer">SpaceX public API</a> and a single method to retrieve the list of all launches from the <code class="code ">v5/launches</code> endpoint.</p>
<p id="cf5baa5c">Create a class that will connect the application to the API:</p>
<ol class="list _decimal" id="ca7c30fe" type="1">
<li class="list__item" id="d2ecfa38">
<p id="a1111d2a">In the common source set <code class="code ">shared/src/commonMain/kotlin</code>, create the <code class="code ">com.jetbrains.handson.kmm.shared.network</code> package and the <code class="code ">SpaceXApi</code> class inside it:</p>
<pre class="code" data-language="kotlin">package com.jetbrains.handson.kmm.shared.network

import com.jetbrains.handson.kmm.shared.entity.RocketLaunch
import io.ktor.client.*
import io.ktor.client.call.*
import io.ktor.client.plugins.contentnegotiation.*
import io.ktor.client.request.*
import io.ktor.serialization.kotlinx.json.*
import kotlinx.serialization.json.Json

class SpaceXApi {
    private val httpClient = HttpClient {
        install(ContentNegotiation) {
            json(Json {
                ignoreUnknownKeys = true
                useAlternativeNames = false
            })
        }
    }
}
</pre>
<ul class="list _bullet" id="d07ee8e1">
<li class="list__item" id="b9de1efb"><p>This class executes network requests and deserializes JSON responses into entities from the <code class="code ">entity</code> package. The Ktor <code class="code ">HttpClient</code> instance initializes and stores the <code class="code ">httpClient</code> property.</p></li>
<li class="list__item" id="c5c2d679"><p>This code uses the <a href="https://ktor.io/docs/serialization-client.html" id="9ef71565" data-external="true" rel="noopener noreferrer">Ktor <code class="code ">ContentNegotiation</code> plugin</a> to deserialize the <code class="code ">GET</code> request result. The plugin processes the request and the response payload as JSON, serializing and deserializing them using a special serializer.</p></li>
</ul>
</li>
<li class="list__item" id="4d454c49">
<p id="72693dd5">Declare the data retrieval function that will return the list of <code class="code ">RocketLaunch</code>es:</p>
<pre class="code" data-language="kotlin">suspend fun getAllLaunches(): List&lt;RocketLaunch&gt; {
    return httpClient.get("https://api.spacexdata.com/v5/launches").body()
}
</pre>
<ul class="list _bullet" id="5f22d841">
<li class="list__item" id="2db86431"><p>The <code class="code ">getAllLaunches</code> function has the <code class="code ">suspend</code> modifier because it contains a call of the suspend function <code class="code ">get()</code>, which includes an asynchronous operation to retrieve data over the internet and can only be called from a coroutine or another suspend function. The network request will be executed in the HTTP client's thread pool.</p></li>
<li class="list__item" id="479a88f2"><p>The URL is defined inside the <code class="code ">get()</code> function to send requests.</p></li>
</ul>
</li>
</ol>
<section class="chapter"><h3 id="add-internet-access-permission" data-toc="add-internet-access-permission">Add internet access permission</h3>
<p id="3c83a8d6">To access the internet, the Android application needs the appropriate permission. Since all network requests are made from the shared module, adding the internet access permission to this module's manifest makes sense.</p>
<p id="c28a5bd5">In the <code class="code ">androidApp/src/main/AndroidManifest.xml</code> file, add the following permission to the manifest:</p>
<pre class="code" data-language="markup">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android" package="com.jetbrains.handson.androidApp"&gt;
    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;
    
&lt;/manifest&gt;
</pre>
<aside data-type="note" class="prompt" data-title="" id="60b5ced8"><p id="dca32637">You can find the state of the project after this section <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="15eada74" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section></section><section class="chapter"><h2 id="build-an-sdk" data-toc="build-an-sdk">Build an SDK</h2>
<p id="c130f5be">Your iOS and Android applications will communicate with the SpaceX API through the shared module, which will provide a public class.</p>
<ol class="list _decimal" id="d003beb5" type="1">
<li class="list__item" id="8554565d">
<p id="1962b63e">In the <code class="code ">com.jetbrains.handson.kmm.shared</code> package of the common source set, create the <code class="code ">SpaceXSDK</code> class:</p>
<pre class="code" data-language="kotlin">package com.jetbrains.handson.kmm.shared

import com.jetbrains.handson.kmm.shared.cache.Database
import com.jetbrains.handson.kmm.shared.cache.DatabaseDriverFactory
import com.jetbrains.handson.kmm.shared.network.SpaceXApi

class SpaceXSDK (databaseDriverFactory: DatabaseDriverFactory) {
    private val database = Database(databaseDriverFactory)
    private val api = SpaceXApi()
}
</pre>
<p id="d7674e59">This class will be the facade over the <code class="code ">Database</code> and <code class="code ">SpaceXApi</code> classes.</p>
</li>
<li class="list__item" id="d4ff0baf">
<p id="d942e9e6">To create a <code class="code ">Database</code> class instance, you'll need to provide the <code class="code ">DatabaseDriverFactory</code> platform instance to it, so you'll inject it from the platform code through the <code class="code ">SpaceXSDK</code> class constructor.</p>
<pre class="code" data-language="kotlin">import com.jetbrains.handson.kmm.shared.entity.RocketLaunch

@Throws(Exception::class)
suspend fun getLaunches(forceReload: Boolean): List&lt;RocketLaunch&gt; {
    val cachedLaunches = database.getAllLaunches()
    return if (cachedLaunches.isNotEmpty() &amp;&amp; !forceReload) {
        cachedLaunches
    } else {
        api.getAllLaunches().also {
            database.clearDatabase()
            database.createLaunches(it)
        }
    }
}
</pre>
<ul class="list _bullet" id="850d1535">
<li class="list__item" id="a60cb47a"><p>The class contains one function for getting all launch information. Depending on the value of <code class="code ">forceReload</code>, it returns cached values or loads the data from the internet and then updates the cache with the results. If there is no cached data, it loads the data from the internet independently of the <code class="code ">forceReload</code> flagâ€™s value.</p></li>
<li class="list__item" id="6097a1c0"><p>Clients of your SDK could use a <code class="code ">forceReload</code> flag to load the latest information about the launches, which would allow the user to use the pull-to-refresh gesture.</p></li>
<li class="list__item" id="43a0e406"><p>To handle exceptions produced by the Ktor client in Swift, the function is marked with the <code class="code ">@Throws</code> annotation.</p></li>
</ul>
<p id="142737ec">All Kotlin exceptions are unchecked, while Swift has only checked errors. Thus, to make your Swift code aware of expected exceptions, Kotlin functions should be marked with the <code class="code ">@Throws</code> annotation specifying a list of potential exception classes.</p>
</li>
</ol>
<aside data-type="note" class="prompt" data-title="" id="904354e9"><p id="63344824">You can find the state of the project after this section <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="22437d89" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section><section class="chapter"><h2 id="create-the-android-application" data-toc="create-the-android-application">Create the Android application</h2>
<p id="ea6877de">The Kotlin Multiplatform Mobile plugin for Android Studio has already handled the configuration for you, so the Kotlin Multiplatform shared module is already connected to your Android application.</p>
<p id="bd78778">Before implementing the UI and the presentation logic, add all the required dependencies to the <code class="code ">androidApp/build.gradle.kts</code>:</p>
<pre class="code" data-language="kotlin">// ...
dependencies {
    implementation(project(":shared"))
    implementation("com.google.android.material:material:1.9.0")
    implementation("androidx.appcompat:appcompat:1.6.1")
    implementation("androidx.constraintlayout:constraintlayout:2.1.4")
    implementation("androidx.swiperefreshlayout:swiperefreshlayout:1.1.0")
    implementation("org.jetbrains.kotlinx:kotlinx-coroutines-android:1.7.1")
    implementation("androidx.core:core-ktx:1.10.1")
    implementation("androidx.recyclerview:recyclerview:1.3.0")
    implementation("androidx.cardview:cardview:1.0.0")
}
// ...
</pre>
<section class="chapter"><h3 id="implement-the-ui-display-the-list-of-rocket-launches" data-toc="implement-the-ui-display-the-list-of-rocket-launches">Implement the UI: display the list of rocket launches</h3>
<ol class="list _decimal" id="97ca61da" type="1">
<li class="list__item" id="a5143197">
<p id="65b13491">To implement the UI, create the <code class="code ">layout/activity_main.xml</code> file in <code class="code ">androidApp/src/main/res</code>.</p>
<p id="307e9bb5">The screen is based on the <code class="code ">ConstraintLayout</code> with the <code class="code ">SwipeRefreshLayout</code> inside it, which contains <code class="code ">RecyclerView</code> and <code class="code ">FrameLayout</code> with a background with a <code class="code ">ProgressBar</code> across its center:</p>
<div class="code-collapse" data-lang="markup" data-is-expanded="false" data-anchors="[df6634f8]" data-synopsis="androidx.constraintlayout.widget.ConstraintLayout xmlns:android" data-disable-link-processing="true">&lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" android:layout_width="match_parent" android:layout_height="match_parent"&gt; &lt;androidx.swiperefreshlayout.widget.SwipeRefreshLayout android:id="@+id/swipeContainer" android:layout_width="match_parent" android:layout_height="match_parent" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent"&gt; &lt;androidx.recyclerview.widget.RecyclerView android:id="@+id/launchesListRv" android:layout_width="match_parent" android:layout_height="match_parent" /&gt; &lt;/androidx.swiperefreshlayout.widget.SwipeRefreshLayout&gt; &lt;FrameLayout android:id="@+id/progressBar" android:layout_width="0dp" android:layout_height="0dp" android:background="#fff" app:layout_constraintBottom_toBottomOf="parent" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent"&gt; &lt;ProgressBar android:layout_width="wrap_content" android:layout_height="wrap_content" android:layout_gravity="center" /&gt; &lt;/FrameLayout&gt; &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt;</div>
</li>
<li class="list__item" id="5e4935dc">
<p id="32958342">In <code class="code ">androidApp/src/main/java</code>, replace the implementation of the <code class="code ">MainActivity</code> class, adding the properties for the UI elements:</p>
<pre class="code" data-language="kotlin">class MainActivity : AppCompatActivity() {
    private lateinit var launchesRecyclerView: RecyclerView
    private lateinit var progressBarView: FrameLayout
    private lateinit var swipeRefreshLayout: SwipeRefreshLayout

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        title = "SpaceX Launches"
        setContentView(R.layout.activity_main)

        launchesRecyclerView = findViewById(R.id.launchesListRv)
        progressBarView = findViewById(R.id.progressBar)
        swipeRefreshLayout = findViewById(R.id.swipeContainer)
    }
}
</pre>
</li>
<li class="list__item" id="ec8e05f4">
<p id="48757d02">For the <code class="code ">RecyclerView</code> element to work, you need to create an adapter (as a subclass of <code class="code ">RecyclerView.Adapter</code>) that will convert raw data into list item views. To do this, create a separate <code class="code ">LaunchesRvAdapter</code> class:</p>
<pre class="code" data-language="kotlin">class LaunchesRvAdapter(var launches: List&lt;RocketLaunch&gt;) : RecyclerView.Adapter&lt;LaunchesRvAdapter.LaunchViewHolder&gt;() {

    override fun onCreateViewHolder(parent: ViewGroup, viewType: Int): LaunchViewHolder {
        return LayoutInflater.from(parent.context)
            .inflate(R.layout.item_launch, parent, false)
            .run(::LaunchViewHolder)
    }

    override fun getItemCount(): Int = launches.count()

    override fun onBindViewHolder(holder: LaunchViewHolder, position: Int) {
        holder.bindData(launches[position])
    }

    inner class LaunchViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {
        // ...
        fun bindData(launch: RocketLaunch) {
            // ...
        }
    }
}
</pre>
</li>
<li class="list__item" id="4cce7fe6">
<p id="71fc2552">Create an <code class="code ">item_launch.xml</code> resource file in <code class="code ">androidApp/src/main/res/layout/</code> with the items view layout:</p>
<div class="code-collapse" data-lang="markup" data-is-expanded="false" data-anchors="[1ba990d5]" data-synopsis="androidx.cardview.widget.CardView xmlns:android" data-disable-link-processing="true">&lt;?xml version="1.0" encoding="utf-8"?&gt; &lt;androidx.cardview.widget.CardView xmlns:android="http://schemas.android.com/apk/res/android" xmlns:app="http://schemas.android.com/apk/res-auto" xmlns:card_view="http://schemas.android.com/tools" android:layout_width="match_parent" android:layout_height="wrap_content" android:layout_marginHorizontal="16dp" android:layout_marginVertical="8dp" card_view:cardCornerRadius="8dp"&gt; &lt;androidx.constraintlayout.widget.ConstraintLayout android:layout_width="match_parent" android:layout_height="wrap_content" android:paddingBottom="16dp"&gt; &lt;TextView android:id="@+id/missionName" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_margin="8dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toTopOf="parent" /&gt; &lt;TextView android:id="@+id/launchSuccess" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_margin="8dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@+id/missionName" /&gt; &lt;TextView android:id="@+id/launchYear" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_margin="8dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@+id/launchSuccess" /&gt; &lt;TextView android:id="@+id/details" android:layout_width="0dp" android:layout_height="wrap_content" android:layout_margin="8dp" app:layout_constraintEnd_toEndOf="parent" app:layout_constraintStart_toStartOf="parent" app:layout_constraintTop_toBottomOf="@+id/launchYear" /&gt; &lt;/androidx.constraintlayout.widget.ConstraintLayout&gt; &lt;/androidx.cardview.widget.CardView&gt;</div>
</li>
<li class="list__item" id="b23de740">
<p id="33525e5">In <code class="code ">androidApp/src/main/res/values/</code>, either create your appearance of the app or copy the following styles:</p>
<div class="tabs" id="ebf9ff77" data-anchors="[8e6cdb0,773a90ce,3ad37243,fa668027,4f109aa8,44e47a0e,ebf9ff77]">
<div class="tabs__content" data-gtm="tab" id="8e6cdb0" data-title="colors.xml"><pre class="code" data-language="markup">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;resources&gt;
    &lt;color name="colorPrimary"&gt;#37474f&lt;/color&gt;
    &lt;color name="colorPrimaryDark"&gt;#102027&lt;/color&gt;
    &lt;color name="colorAccent"&gt;#62727b&lt;/color&gt;

    &lt;color name="colorSuccessful"&gt;#4BB543&lt;/color&gt;
    &lt;color name="colorUnsuccessful"&gt;#FC100D&lt;/color&gt;
    &lt;color name="colorNoData"&gt;#615F5F&lt;/color&gt;
&lt;/resources&gt;
</pre></div>
<div class="tabs__content" data-gtm="tab" id="3ad37243" data-title="strings.xml"><pre class="code" data-language="markup">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;resources&gt;
    &lt;string name="app_name"&gt;SpaceLaunches&lt;/string&gt;

    &lt;string name="successful"&gt;Successful&lt;/string&gt;
    &lt;string name="unsuccessful"&gt;Unsuccessful&lt;/string&gt;
    &lt;string name="no_data"&gt;No data&lt;/string&gt;

    &lt;string name="launch_year_field"&gt;Launch year: %s&lt;/string&gt;
    &lt;string name="mission_name_field"&gt;Launch name: %s&lt;/string&gt;
    &lt;string name="launch_success_field"&gt;Launch success: %s&lt;/string&gt;
    &lt;string name="details_field"&gt;Launch details: %s&lt;/string&gt;
&lt;/resources&gt;
</pre></div>
<div class="tabs__content" data-gtm="tab" id="4f109aa8" data-title="styles.xml"><pre class="code" data-language="markup">&lt;resources&gt;
    &lt;!-- Base application theme. --&gt;
    &lt;style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar"&gt;
        &lt;!-- Customize your theme here. --&gt;
        &lt;item name="colorPrimary"&gt;@color/colorPrimary&lt;/item&gt;
        &lt;item name="colorPrimaryDark"&gt;@color/colorPrimaryDark&lt;/item&gt;
        &lt;item name="colorAccent"&gt;@color/colorAccent&lt;/item&gt;
    &lt;/style&gt;
&lt;/resources&gt;
</pre></div>
</div>
</li>
<li class="list__item" id="4868d61d">
<p id="42676693">Complete the implementation of the <code class="code ">RecyclerView.Adapter</code>:</p>
<pre class="code" data-language="kotlin">class LaunchesRvAdapter(var launches: List&lt;RocketLaunch&gt;) : RecyclerView.Adapter&lt;LaunchesRvAdapter.LaunchViewHolder&gt;() {
    // ...
    inner class LaunchViewHolder(itemView: View) : RecyclerView.ViewHolder(itemView) {
        private val missionNameTextView = itemView.findViewById&lt;TextView&gt;(R.id.missionName)
        private val launchYearTextView = itemView.findViewById&lt;TextView&gt;(R.id.launchYear)
        private val launchSuccessTextView = itemView.findViewById&lt;TextView&gt;(R.id.launchSuccess)
        private val missionDetailsTextView = itemView.findViewById&lt;TextView&gt;(R.id.details)

        fun bindData(launch: RocketLaunch) {
            val ctx = itemView.context
            missionNameTextView.text = ctx.getString(R.string.mission_name_field, launch.missionName)
            launchYearTextView.text = ctx.getString(R.string.launch_year_field, launch.launchYear.toString())
            missionDetailsTextView.text = ctx.getString(R.string.details_field, launch.details ?: "")
            val launchSuccess = launch.launchSuccess
            if (launchSuccess != null ) {
                if (launchSuccess) {
                    launchSuccessTextView.text = ctx.getString(R.string.successful)
                    launchSuccessTextView.setTextColor((ContextCompat.getColor(itemView.context, R.color.colorSuccessful)))
                } else {
                    launchSuccessTextView.text = ctx.getString(R.string.unsuccessful)
                    launchSuccessTextView.setTextColor((ContextCompat.getColor(itemView.context, R.color.colorUnsuccessful)))
                }
            } else {
                launchSuccessTextView.text = ctx.getString(R.string.no_data)
                launchSuccessTextView.setTextColor((ContextCompat.getColor(itemView.context, R.color.colorNoData)))
            }
        }
    }
}
</pre>
</li>
<li class="list__item" id="25b4ce27">
<p id="3f854547">Update the <code class="code ">MainActivity</code> class as follows:</p>
<pre class="code" data-language="kotlin">class MainActivity : AppCompatActivity() {
    // ...
    private val launchesRvAdapter = LaunchesRvAdapter(listOf())

    override fun onCreate(savedInstanceState: Bundle?) {
        // ...
        launchesRecyclerView.adapter = launchesRvAdapter
        launchesRecyclerView.layoutManager = LinearLayoutManager(this)

        swipeRefreshLayout.setOnRefreshListener {
            swipeRefreshLayout.isRefreshing = false
            displayLaunches(true)
        }

        displayLaunches(false)
    }

    private fun displayLaunches(needReload: Boolean) {
        // TODO: Presentation logic
    }
}
</pre>
<p id="1d3c6116">Here you create an instance of <code class="code ">LaunchesRvAdapter</code>, configure the <code class="code ">RecyclerView</code> component, and implement all the <code class="code ">LaunchesListView</code> interface functions. To catch the screen refresh gesture, you add a listener to the <code class="code ">SwipeRefreshLayout</code>.</p>
</li>
</ol></section><section class="chapter"><h3 id="implement-the-presentation-logic" data-toc="implement-the-presentation-logic">Implement the presentation logic</h3>
<ol class="list _decimal" id="d318656" type="1">
<li class="list__item" id="46549325">
<p id="346b65bd">Create an instance of the <code class="code ">SpaceXSDK</code> class from the shared module and inject an instance of <code class="code ">DatabaseDriverFactory</code> in it:</p>
<pre class="code" data-language="kotlin">class MainActivity : AppCompatActivity() {
    // ...
    private val sdk = SpaceXSDK(DatabaseDriverFactory(this))
}
</pre>
</li>
<li class="list__item" id="4e437a81">
<p id="57fcf3a9">Implement the private function <code class="code ">displayLaunches(needReload: Boolean)</code>. It runs the <code class="code ">getLaunches()</code> function inside the coroutine launched in the main <code class="code ">CoroutineScope</code>, handles exceptions, and displays the error text in the toast message:</p>
<pre class="code" data-language="kotlin">class MainActivity : AppCompatActivity() {
    private val mainScope = MainScope()
    // ...
    override fun onDestroy() {
        super.onDestroy()
        mainScope.cancel()
    }
    // ...
    private fun displayLaunches(needReload: Boolean) {
        progressBarView.isVisible = true
        mainScope.launch {
            kotlin.runCatching {
                sdk.getLaunches(needReload)
            }.onSuccess {
                launchesRvAdapter.launches = it
                launchesRvAdapter.notifyDataSetChanged()
            }.onFailure {
                Toast.makeText(this@MainActivity, it.localizedMessage, Toast.LENGTH_SHORT).show()
            }
            progressBarView.isVisible = false
        }
    }
}
</pre>
</li>
<li class="list__item" id="cf789f25"><p id="39877725">Select <b id="917bbb8d" class="">androidApp</b> from the run configurations menu, choose an emulator, and click the run button:</p></li>
</ol>
<figure class=" " id="dc09e754"><img alt="Android application" title="Android application" src="https://kotlinlang.org/docs/images/android-application.png" class=" " width="350" height="727"></figure><p id="6ee1373c">You've just created an Android application that has its business logic implemented in the Kotlin Multiplatform Mobile module.</p>
<aside data-type="note" class="prompt" data-title="" id="a4f2b42d"><p id="3e97a68f">You can find the state of the project after this section <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="aa74a38a" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section></section><section class="chapter"><h2 id="create-the-ios-application" data-toc="create-the-ios-application">Create the iOS application</h2>
<p id="8f53f08">For the iOS part of the project, you'll make use of <a href="https://developer.apple.com/xcode/swiftui/" id="9e414dbc" data-external="true" rel="noopener noreferrer">SwiftUI</a> to build the user interface and the "Model View View-Model" pattern to connect the UI to the shared module, which contains all the business logic.</p>
<p id="5218125b">The shared module is already connected to the iOS project because the Android Studio plugin wizard has done all the configuration. You can import it the same way you would regular iOS dependencies: <code class="code ">import shared</code>.</p>
<section class="chapter"><h3 id="implement-the-ui" data-toc="implement-the-ui">Implement the UI</h3>
<p id="f7b2181c">First, you'll create a <code class="code ">RocketLaunchRow</code> SwiftUI view for displaying an item from the list. It will be based on the <code class="code ">HStack</code> and <code class="code ">VStack</code> views. There will be extensions on the <code class="code ">RocketLaunchRow</code> structure with useful helpers for displaying the data.</p>
<ol class="list _decimal" id="deadacbb" type="1">
<li class="list__item" id="a558ea5b"><p id="df941c95">Launch your Xcode app and select <b id="7b0f5348" class="">Open a project or file</b>.</p></li>
<li class="list__item" id="2ad93ac0"><p id="a54b86da">Navigate to your project and select the <code class="code ">iosApp</code> folder. Click <b id="e071d868" class="">Open</b>.</p></li>
<li class="list__item" id="4ef4e235">
<p id="c5ee3073">In your Xcode project, create a new Swift file with the type <b id="ce2bf228" class="">SwiftUI View</b>, name it <code class="code ">RocketLaunchRow</code>, and update it with the following code:</p>
<pre class="code" data-language="swift">import SwiftUI
import shared

struct RocketLaunchRow: View {
    var rocketLaunch: RocketLaunch

    var body: some View {
        HStack() {
            VStack(alignment: .leading, spacing: 10.0) {
                Text("Launch name: \(rocketLaunch.missionName)")
                Text(launchText).foregroundColor(launchColor)
                Text("Launch year: \(String(rocketLaunch.launchYear))")
                Text("Launch details: \(rocketLaunch.details ?? "")")
            }
            Spacer()
        }
    }
}

extension RocketLaunchRow {
    private var launchText: String {
        if let isSuccess = rocketLaunch.launchSuccess {
            return isSuccess.boolValue ? "Successful" : "Unsuccessful"
        } else {
            return "No data"
        }
    }

    private var launchColor: Color {
        if let isSuccess = rocketLaunch.launchSuccess {
            return isSuccess.boolValue ? Color.green : Color.red
        } else {
            return Color.gray
        }
    }
}
</pre>
<p id="91206716">The list of launches will be displayed in the <code class="code ">ContentView</code>, which the project wizard has already created.</p>
</li>
<li class="list__item" id="49e69992">
<p id="fa6a7f83">Create a <code class="code ">ViewModel</code> class for the <code class="code ">ContentView</code>, which will prepare and manage the data. Declare it as an extension to the <code class="code ">ContentView</code>, as they are closely connected, and then add the following code to <code class="code ">ContentView.swift</code>:</p>
<pre class="code" data-language="swift">// ...
extension ContentView {
    enum LoadableLaunches {
        case loading
        case result([RocketLaunch])
        case error(String)
    }

   @MainActor
   class ViewModel: ObservableObject {
       @Published var launches = LoadableLaunches.loading
   }
}
</pre>
<ul class="list _bullet" id="23cd30">
<li class="list__item" id="beeb8db4"><p>The <a href="https://developer.apple.com/documentation/combine" id="5c90fdbf" data-external="true" rel="noopener noreferrer">Combine framework</a> connects the view model (<code class="code ">ContentView.ViewModel</code>) with the view (<code class="code ">ContentView</code>).</p></li>
<li class="list__item" id="488b6a5e"><p><code class="code ">ContentView.ViewModel</code> is declared as an <code class="code ">ObservableObject</code> and <code class="code ">@Published</code> wrapper is used for the <code class="code ">launches</code> property, so the view model will emit signals whenever this property changes.</p></li>
</ul>
</li>
<li class="list__item" id="c43d7247">
<p id="bfea7f">Implement the body of the <code class="code ">ContentView</code> file and display the list of launches:</p>
<pre class="code" data-language="swift">struct ContentView: View {
 @ObservedObject private(set) var viewModel: ViewModel

     var body: some View {
         NavigationView {
             listView()
             .navigationBarTitle("SpaceX Launches")
             .navigationBarItems(trailing:
                 Button("Reload") {
                     self.viewModel.loadLaunches(forceReload: true)
             })
         }
     }

     private func listView() -&gt; AnyView {
         switch viewModel.launches {
         case .loading:
             return AnyView(Text("Loading...").multilineTextAlignment(.center))
         case .result(let launches):
             return AnyView(List(launches) { launch in
                 RocketLaunchRow(rocketLaunch: launch)
             })
         case .error(let description):
             return AnyView(Text(description).multilineTextAlignment(.center))
         }
     }
 }
</pre>
<p id="71cdd618">The <code class="code ">@ObservedObject</code> property wrapper is used to subscribe to the view model.</p>
</li>
<li class="list__item" id="ad6ceb58">
<p id="53e63fd8">To make it compile, the <code class="code ">RocketLaunch</code> class needs to confirm the <code class="code ">Identifiable</code> protocol, as it is used as a parameter for initializing the <code class="code ">List</code> Swift UIView. The <code class="code ">RocketLaunch</code> class already has a property named <code class="code ">id</code>, so add the following to the bottom of <code class="code ">ContentView.swift</code>:</p>
<pre class="code" data-language="swift">extension RocketLaunch: Identifiable { }
</pre>
</li>
</ol></section><section class="chapter"><h3 id="load-the-data" data-toc="load-the-data">Load the data</h3>
<p id="93583c25">To retrieve the data about the rocket launches in the view model, you'll need an instance of <code class="code ">SpaceXSDK</code> from the Multiplatform library.</p>
<ol class="list _decimal" id="458d63e" type="1">
<li class="list__item" id="66471521">
<p id="eb640b1a">In <code class="code ">ContentView.swift</code>, pass it in through the constructor:</p>
<pre class="code" data-language="swift">extension ContentView {
    // ...
    @MainActor
    class ViewModel: ObservableObject {
        let sdk: SpaceXSDK
        @Published var launches = LoadableLaunches.loading

        init(sdk: SpaceXSDK) {
            self.sdk = sdk
            self.loadLaunches(forceReload: false)
        }

        func loadLaunches(forceReload: Bool) {
            // TODO: retrieve data
        }
    }
}
</pre>
</li>
<li class="list__item" id="45ac26fd">
<p id="303e501">Call the <code class="code ">getLaunches()</code> function from the <code class="code ">SpaceXSDK</code> class and save the result in the <code class="code ">launches</code> property:</p>
<pre class="code" data-language="swift">func loadLaunches(forceReload: Bool) {
    Task {
        do {
            self.launches = .loading
            let launches = try await sdk.getLaunches(forceReload: forceReload)
            self.launches = .result(launches)
        } catch {
            self.launches = .error(error.localizedDescription)
        }
    }
}
</pre>
<ul class="list _bullet" id="e42afe6e">
<li class="list__item" id="121fec4a"><p>When you compile a Kotlin module into an Apple framework, <a href="whatsnew14.html#support-for-kotlin-s-suspending-functions-in-swift-and-objective-c" id="2ff9d448">suspending functions</a> are available in it as Swift's <code class="code ">async</code>/<code class="code ">await</code> mechanism.</p></li>
<li class="list__item" id="b9f804cd"><p>Since the <code class="code ">getLaunches</code> function is marked with the <code class="code ">@Throws(Exception::class)</code> annotation, any exceptions that are instances of the <code class="code ">Exception</code> class or its subclass will be propagated as <code class="code ">NSError</code>. Therefore, all such errors can be caught by the <code class="code ">loadLaunches()</code> function.</p></li>
</ul>
</li>
<li class="list__item" id="c8b4589c">
<p id="be41c511">Go to the entry point of the app, <code class="code ">iOSApp.swift</code>, and initialize the SDK, view, and view model:</p>
<pre class="code" data-language="swift">import SwiftUI
import shared

@main
struct iOSApp: App {
    let sdk = SpaceXSDK(databaseDriverFactory: DatabaseDriverFactory())
    var body: some Scene {
        WindowGroup {
            ContentView(viewModel: .init(sdk: sdk))
        }
    }
}
</pre>
</li>
<li class="list__item" id="f738d421"><p id="c954040d">In Android Studio, switch to the <b id="6709246d" class="">iosApp</b> configuration, choose an emulator, and run it to see the result:</p></li>
</ol>
<figure class=" " id="b8855bca"><img alt="iOS Application" title="iOS Application" src="https://kotlinlang.org/docs/images/ios-application.png" class=" " width="350" height="687"></figure><aside data-type="note" class="prompt" data-title="" id="b1ce871f"><p id="3d5ca846">You can find the final version of the project <a href="https://github.com/kotlin-hands-on/kmm-networking-and-data-storage/tree/final" id="b8fd8616" data-external="true" rel="noopener noreferrer">on the <code class="code ">final</code> branch</a>.</p></aside></section></section><section class="chapter"><h2 id="what-s-next" data-toc="what-s-next">What's next?</h2>
<p id="bf23c71d">This tutorial features some potentially resource-heavy operations, like parsing JSON and making requests to the database in the main thread. To learn about how to write concurrent code and optimize your app, see <a href="multiplatform-mobile-concurrency-overview.html" id="4d02b9d1">How to work with concurrency</a>.</p>
<p id="3456197d">You can also check out these additional learning materials:</p>
<ul class="list _bullet" id="b2473465">
<li class="list__item" id="64a3dd02"><p><a href="https://ktor.io/docs/http-client-engines.html#mpp-config" id="ea792b56" data-external="true" rel="noopener noreferrer">Use the Ktor HTTP client in multiplatform projects</a></p></li>
<li class="list__item" id="4a5c4472"><p><a href="multiplatform-mobile-integrate-in-existing-app.html" id="59a024ce">Make your Android application work on iOS</a></p></li>
<li class="list__item" id="3ecb4f48"><p><a href="multiplatform-mobile-introduce-your-team.html" id="a72364c9">Introduce your team to Kotlin Multiplatform Mobile</a></p></li>
</ul></section><div class="last-modified"> Last modified: 26 June 2023</div>

<div class="navigation-links _bottom"> <a class="navigation-links__prev" href="multiplatform-mobile-publish-apps.html">Publish your application</a> <a class="navigation-links__next" href="multiplatform-get-started.html">Get started with Kotlin Multiplatform</a> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2023 JetBrains s.r.o. and Kotlin Programming Language contributors<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://kotlinlang.org/docs/multiplatform-mobile-ktor-sqldelight.html" class="_attribution-link">https://kotlinlang.org/docs/multiplatform-mobile-ktor-sqldelight.html</a>
  </p>
</div>
