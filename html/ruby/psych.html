<h1 id="module-Psych" class="module"> module Psych </h1> <section class="description"> <h1 id="module-Psych-label-Overview">Overview</h1> <p><a href="psych.html"><code>Psych</code></a> is a <a href="yaml.html"><code>YAML</code></a> parser and emitter. <a href="psych.html"><code>Psych</code></a> leverages libyaml [Home page: <a href="https://pyyaml.org/wiki/LibYAML">pyyaml.org/wiki/LibYAML</a>] or [git repo: <a href="https://github.com/yaml/libyaml">github.com/yaml/libyaml</a>] for its <a href="yaml.html"><code>YAML</code></a> parsing and emitting capabilities. In addition to wrapping libyaml, <a href="psych.html"><code>Psych</code></a> also knows how to serialize and de-serialize most Ruby objects to and from the <a href="yaml.html"><code>YAML</code></a> format.</p> <h1 id="module-Psych-label-I+NEED+TO+PARSE+OR+EMIT+YAML+RIGHT+NOW-21">I NEED TO PARSE OR EMIT <a href="yaml.html"><code>YAML</code></a> RIGHT NOW!</h1> <pre class="ruby" data-language="ruby"># Parse some YAML
Psych.load("--- foo") # =&gt; "foo"

# Emit some YAML
Psych.dump("foo")     # =&gt; "--- foo\n...\n"
{ :a =&gt; 'b'}.to_yaml  # =&gt; "---\n:a: b\n"
</pre> <p>Got more time on your hands? Keep on reading!</p> <h2 id="module-Psych-label-YAML+Parsing">
<a href="yaml.html"><code>YAML</code></a> Parsing</h2> <p><a href="psych.html"><code>Psych</code></a> provides a range of interfaces for parsing a <a href="yaml.html"><code>YAML</code></a> document ranging from low level to high level, depending on your parsing needs. At the lowest level, is an event based parser. Mid level is access to the raw <a href="yaml.html"><code>YAML</code></a> AST, and at the highest level is the ability to unmarshal <a href="yaml.html"><code>YAML</code></a> to Ruby objects.</p> <h2 id="module-Psych-label-YAML+Emitting">
<a href="yaml.html"><code>YAML</code></a> Emitting</h2> <p><a href="psych.html"><code>Psych</code></a> provides a range of interfaces ranging from low to high level for producing <a href="yaml.html"><code>YAML</code></a> documents. Very similar to the <a href="yaml.html"><code>YAML</code></a> parsing interfaces, <a href="psych.html"><code>Psych</code></a> provides at the lowest level, an event based system, mid-level is building a <a href="yaml.html"><code>YAML</code></a> AST, and the highest level is converting a Ruby object straight to a <a href="yaml.html"><code>YAML</code></a> document.</p> <h2 id="module-Psych-label-High-level+API">High-level API</h2> <h3 id="module-Psych-label-Parsing">Parsing</h3> <p>The high level <a href="yaml.html"><code>YAML</code></a> parser provided by <a href="psych.html"><code>Psych</code></a> simply takes <a href="yaml.html"><code>YAML</code></a> as input and returns a Ruby data structure. For information on using the high level parser see <a href="psych.html#method-c-load"><code>Psych.load</code></a></p> <h4 id="module-Psych-label-Reading+from+a+string">Reading from a string</h4> <pre class="ruby" data-language="ruby">Psych.safe_load("--- a")             # =&gt; 'a'
Psych.safe_load("---\n - a\n - b")   # =&gt; ['a', 'b']
# From a trusted string:
Psych.load("--- !ruby/range\nbegin: 0\nend: 42\nexcl: false\n") # =&gt; 0..42
</pre> <h4 id="module-Psych-label-Reading+from+a+file">Reading from a file</h4> <pre class="ruby" data-language="ruby">Psych.safe_load_file("data.yml", permitted_classes: [Date])
Psych.load_file("trusted_database.yml")
</pre> <h4 id="module-Psych-label-Exception+handling"> handling</h4> <pre class="ruby" data-language="ruby">begin
  # The second argument changes only the exception contents
  Psych.parse("--- `", "file.txt")
rescue Psych::SyntaxError =&gt; ex
  ex.file    # =&gt; 'file.txt'
  ex.message # =&gt; "(file.txt): found character that cannot start any token"
end
</pre> <h3 id="module-Psych-label-Emitting">Emitting</h3> <p>The high level emitter has the easiest interface. <a href="psych.html"><code>Psych</code></a> simply takes a Ruby data structure and converts it to a <a href="yaml.html"><code>YAML</code></a> document. See <a href="psych.html#method-c-dump"><code>Psych.dump</code></a> for more information on dumping a Ruby data structure.</p> <h4 id="module-Psych-label-Writing+to+a+string">Writing to a string</h4> <pre class="ruby" data-language="ruby"># Dump an array, get back a YAML string
Psych.dump(['a', 'b'])  # =&gt; "---\n- a\n- b\n"

# Dump an array to an IO object
Psych.dump(['a', 'b'], StringIO.new)  # =&gt; #&lt;StringIO:0x000001009d0890&gt;

# Dump an array with indentation set
Psych.dump(['a', ['b']], :indentation =&gt; 3) # =&gt; "---\n- a\n-  - b\n"

# Dump an array to an IO with indentation set
Psych.dump(['a', ['b']], StringIO.new, :indentation =&gt; 3)
</pre> <h4 id="module-Psych-label-Writing+to+a+file">Writing to a file</h4> <p>Currently there is no direct API for dumping Ruby structure to file:</p> <pre class="ruby" data-language="ruby">File.open('database.yml', 'w') do |file|
  file.write(Psych.dump(['a', 'b']))
end
</pre> <h2 id="module-Psych-label-Mid-level+API">Mid-level API</h2> <h3 id="module-Psych-label-Parsing">Parsing</h3> <p><a href="psych.html"><code>Psych</code></a> provides access to an AST produced from parsing a <a href="yaml.html"><code>YAML</code></a> document. This tree is built using the <span><code>Psych::Parser</code></span> and <span><code>Psych::TreeBuilder</code></span>. The AST can be examined and manipulated freely. Please see <a href="psych.html#method-c-parse_stream"><code>Psych::parse_stream</code></a>, <span><code>Psych::Nodes</code></span>, and <span><code>Psych::Nodes::Node</code></span> for more information on dealing with <a href="yaml.html"><code>YAML</code></a> syntax trees.</p> <h4 id="module-Psych-label-Reading+from+a+string">Reading from a string</h4> <pre class="ruby" data-language="ruby"># Returns Psych::Nodes::Stream
Psych.parse_stream("---\n - a\n - b")

# Returns Psych::Nodes::Document
Psych.parse("---\n - a\n - b")
</pre> <h4 id="module-Psych-label-Reading+from+a+file">Reading from a file</h4> <pre class="ruby" data-language="ruby"># Returns Psych::Nodes::Stream
Psych.parse_stream(File.read('database.yml'))

# Returns Psych::Nodes::Document
Psych.parse_file('database.yml')
</pre> <h4 id="module-Psych-label-Exception+handling"> handling</h4> <pre class="ruby" data-language="ruby">begin
  # The second argument changes only the exception contents
  Psych.parse("--- `", "file.txt")
rescue Psych::SyntaxError =&gt; ex
  ex.file    # =&gt; 'file.txt'
  ex.message # =&gt; "(file.txt): found character that cannot start any token"
end
</pre> <h3 id="module-Psych-label-Emitting">Emitting</h3> <p>At the mid level is building an AST. This AST is exactly the same as the AST used when parsing a <a href="yaml.html"><code>YAML</code></a> document. Users can build an AST by hand and the AST knows how to emit itself as a <a href="yaml.html"><code>YAML</code></a> document. See <span><code>Psych::Nodes</code></span>, <span><code>Psych::Nodes::Node</code></span>, and <span><code>Psych::TreeBuilder</code></span> for more information on building a <a href="yaml.html"><code>YAML</code></a> AST.</p> <h4 id="module-Psych-label-Writing+to+a+string">Writing to a string</h4> <pre class="ruby" data-language="ruby"># We need Psych::Nodes::Stream (not Psych::Nodes::Document)
stream = Psych.parse_stream("---\n - a\n - b")

stream.to_yaml # =&gt; "---\n- a\n- b\n"
</pre> <h4 id="module-Psych-label-Writing+to+a+file">Writing to a file</h4> <pre class="ruby" data-language="ruby"># We need Psych::Nodes::Stream (not Psych::Nodes::Document)
stream = Psych.parse_stream(File.read('database.yml'))

File.open('database.yml', 'w') do |file|
  file.write(stream.to_yaml)
end
</pre> <h2 id="module-Psych-label-Low-level+API">Low-level API</h2> <h3 id="module-Psych-label-Parsing">Parsing</h3> <p>The lowest level parser should be used when the <a href="yaml.html"><code>YAML</code></a> input is already known, and the developer does not want to pay the price of building an AST or automatic detection and conversion to Ruby objects. See <span><code>Psych::Parser</code></span> for more information on using the event based parser.</p> <h4 id="module-Psych-label-Reading+to+Psych-3A-3ANodes-3A-3AStream+structure">Reading to  structure</h4> <pre class="ruby" data-language="ruby">parser = Psych::Parser.new(TreeBuilder.new) # =&gt; #&lt;Psych::Parser&gt;
parser = Psych.parser                       # it's an alias for the above

parser.parse("---\n - a\n - b")             # =&gt; #&lt;Psych::Parser&gt;
parser.handler                              # =&gt; #&lt;Psych::TreeBuilder&gt;
parser.handler.root                         # =&gt; #&lt;Psych::Nodes::Stream&gt;
</pre> <h4 id="module-Psych-label-Receiving+an+events+stream">Receiving an events stream</h4> <pre class="ruby" data-language="ruby">recorder = Psych::Handlers::Recorder.new
parser = Psych::Parser.new(recorder)

parser.parse("---\n - a\n - b")
recorder.events # =&gt; [list of [event, args] lists]
                # event is one of: Psych::Handler::EVENTS
                # args are the arguments passed to the event
</pre> <h3 id="module-Psych-label-Emitting">Emitting</h3> <p>The lowest level emitter is an event based system. Events are sent to a <span><code>Psych::Emitter</code></span> object. That object knows how to convert the events to a <a href="yaml.html"><code>YAML</code></a> document. This interface should be used when document format is known in advance or speed is a concern. See <span><code>Psych::Emitter</code></span> for more information.</p> <h4 id="module-Psych-label-Writing+to+a+Ruby+structure">Writing to a Ruby structure</h4> <pre class="ruby" data-language="ruby">Psych.parser.parse("--- a")       # =&gt; #&lt;Psych::Parser&gt;

parser.handler.first              # =&gt; #&lt;Psych::Nodes::Stream&gt;
parser.handler.first.to_ruby      # =&gt; ["a"]

parser.handler.root.first         # =&gt; #&lt;Psych::Nodes::Document&gt;
parser.handler.root.first.to_ruby # =&gt; "a"

# You can instantiate an Emitter manually
Psych::Visitors::ToRuby.new.accept(parser.handler.root.first)
# =&gt; "a"
</pre> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="DEFAULT_SNAKEYAML_VERSION">DEFAULT_SNAKEYAML_VERSION </dt>

<dt id="LIBYAML_VERSION">LIBYAML_VERSION </dt>
<dd>
<p>The version of libyaml <a href="psych.html"><code>Psych</code></a> is using</p> </dd>
<dt id="VERSION">VERSION </dt>
<dd>
<p>The version of <a href="psych.html"><code>Psych</code></a> you are using</p> </dd>
</dl> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-dump"> <span class="method-callseq"> dump(o) → string of yaml </span> <a class="method-click-advice">Show source</a> </div> <div class="method-heading"> <span class="method-callseq"> dump(o, options) → string of yaml </span> </div> <div class="method-heading"> <span class="method-callseq"> dump(o, io) → io object passed in </span> </div> <div class="method-heading"> <span class="method-callseq"> dump(o, io, options) → io object passed in </span> </div> </div> <div class="method-description">
<div class="method-source-code" id="dump-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 505
def self.dump o, io = nil, options = {}
  if Hash === io
    options = io
    io      = nil
  end

  visitor = Psych::Visitors::YAMLTree.create options
  visitor &lt;&lt; o
  visitor.tree.yaml io, options
end</pre> </div> <p>Dump Ruby object <code>o</code> to a <a href="yaml.html"><code>YAML</code></a> string. Optional <code>options</code> may be passed in to control the output format. If an <a href="io.html"><code>IO</code></a> object is passed in, the <a href="yaml.html"><code>YAML</code></a> will be dumped to that <a href="io.html"><code>IO</code></a> object.</p> <p>Currently supported options are:</p> <dl class="rdoc-list label-list">
<dt>
<code>:indentation</code> </dt>
<dd> <p>Number of space characters used to indent. Acceptable value should be in <code>0..9</code> range, otherwise option is ignored.</p> <p>Default: <code>2</code>.</p> </dd>
<dt>
<code>:line_width</code> </dt>
<dd> <p>Max character to wrap line at.</p> <p>Default: <code>0</code> (meaning “wrap at 81”).</p> </dd>
<dt>
<code>:canonical</code> </dt>
<dd> <p>Write “canonical” <a href="yaml.html"><code>YAML</code></a> form (very verbose, yet strictly formal).</p> <p>Default: <code>false</code>.</p> </dd>
<dt>
<code>:header</code> </dt>
<dd> <p>Write <code>%YAML [version]</code> at the beginning of document.</p> <p>Default: <code>false</code>.</p> </dd>
</dl> <p>Example:</p> <pre class="ruby" data-language="ruby"># Dump an array, get back a YAML string
Psych.dump(['a', 'b'])  # =&gt; "---\n- a\n- b\n"

# Dump an array to an IO object
Psych.dump(['a', 'b'], StringIO.new)  # =&gt; #&lt;StringIO:0x000001009d0890&gt;

# Dump an array with indentation set
Psych.dump(['a', ['b']], indentation: 3) # =&gt; "---\n- a\n-  - b\n"

# Dump an array to an IO with indentation set
Psych.dump(['a', ['b']], StringIO.new, indentation: 3)
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-dump_stream"> <span class="method-name">dump_stream</span><span class="method-args">(*objects)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="dump_stream-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 595
def self.dump_stream *objects
  visitor = Psych::Visitors::YAMLTree.create({})
  objects.each do |o|
    visitor &lt;&lt; o
  end
  visitor.tree.yaml
end</pre> </div> <p>Dump a list of objects as separate documents to a document stream.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">Psych.dump_stream("foo\n  ", {}) # =&gt; "--- ! \"foo\\n  \"\n--- {}\n"
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-libyaml_version"> <span class="method-callseq"> libyaml_version </span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="libyaml_version-source"> <pre class="c" data-language="c">static VALUE libyaml_version(VALUE module)
{
    int major, minor, patch;
    VALUE list[3];

    yaml_get_version(&amp;major, &amp;minor, &amp;patch);

    list[0] = INT2NUM(major);
    list[1] = INT2NUM(minor);
    list[2] = INT2NUM(patch);

    return rb_ary_new4((long)3, list);
}</pre> </div> <p>Returns the version of libyaml being used</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-load"> <span class="method-name">load</span><span class="method-args">(yaml, permitted_classes: [Symbol], permitted_symbols: [], aliases: false, filename: nil, fallback: nil, symbolize_names: false, freeze: false, strict_integer: false)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="load-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 368
def self.load yaml, permitted_classes: [Symbol], permitted_symbols: [], aliases: false, filename: nil, fallback: nil, symbolize_names: false, freeze: false, strict_integer: false
  safe_load yaml, permitted_classes: permitted_classes,
                  permitted_symbols: permitted_symbols,
                  aliases: aliases,
                  filename: filename,
                  fallback: fallback,
                  symbolize_names: symbolize_names,
                  freeze: freeze,
                  strict_integer: strict_integer
end</pre> </div> <p>Load <code>yaml</code> in to a Ruby data structure. If multiple documents are provided, the object contained in the first document will be returned. <code>filename</code> will be used in the exception message if any exception is raised while parsing. If <code>yaml</code> is empty, it returns the specified <code>fallback</code> return value, which defaults to <code>false</code>.</p> <p>Raises a <span><code>Psych::SyntaxError</code></span> when a <a href="yaml.html"><code>YAML</code></a> syntax error is detected.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">Psych.load("--- a")             # =&gt; 'a'
Psych.load("---\n - a\n - b")   # =&gt; ['a', 'b']

begin
  Psych.load("--- `", filename: "file.txt")
rescue Psych::SyntaxError =&gt; ex
  ex.file    # =&gt; 'file.txt'
  ex.message # =&gt; "(file.txt): found character that cannot start any token"
end
</pre> <p>When the optional <code>symbolize_names</code> keyword argument is set to a true value, returns symbols for keys in <a href="hash.html"><code>Hash</code></a> objects (default: strings).</p> <pre class="ruby" data-language="ruby">Psych.load("---\n foo: bar")                         # =&gt; {"foo"=&gt;"bar"}
Psych.load("---\n foo: bar", symbolize_names: true)  # =&gt; {:foo=&gt;"bar"}
</pre> <p>Raises a <a href="typeerror.html"><code>TypeError</code></a> when ‘yaml` parameter is <a href="nilclass.html"><code>NilClass</code></a>. This method is similar to `safe_load` except that `Symbol` objects are allowed by default.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-load_file"> <span class="method-name">load_file</span><span class="method-args">(filename, **kwargs)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="load_file-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 669
def self.load_file filename, **kwargs
  File.open(filename, 'r:bom|utf-8') { |f|
    self.load f, filename: filename, **kwargs
  }
end</pre> </div> <p>Loads the document contained in <code>filename</code>. Returns the yaml contained in <code>filename</code> as a Ruby object, or if the file is empty, it returns the specified <code>fallback</code> return value, which defaults to <code>false</code>. See load for options.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-load_stream"> <span class="method-name">load_stream</span><span class="method-args">(yaml, filename: nil, fallback: [], **kwargs) { |to_ruby(**kwargs)| ... }</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="load_stream-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 626
def self.load_stream yaml, filename: nil, fallback: [], **kwargs
  result = if block_given?
             parse_stream(yaml, filename: filename) do |node|
               yield node.to_ruby(**kwargs)
             end
           else
             parse_stream(yaml, filename: filename).children.map { |node| node.to_ruby(**kwargs) }
           end

  return fallback if result.is_a?(Array) &amp;&amp; result.empty?
  result
end</pre> </div> <p>Load multiple documents given in <code>yaml</code>. Returns the parsed documents as a list. If a block is given, each document will be converted to Ruby and passed to the block during parsing</p> <p>Example:</p> <pre class="ruby" data-language="ruby">Psych.load_stream("--- foo\n...\n--- bar\n...") # =&gt; ['foo', 'bar']

list = []
Psych.load_stream("--- foo\n...\n--- bar\n...") do |ruby|
  list &lt;&lt; ruby
end
list # =&gt; ['foo', 'bar']
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-parse"> <span class="method-name">parse</span><span class="method-args">(yaml, filename: nil)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="parse-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 398
def self.parse yaml, filename: nil
  parse_stream(yaml, filename: filename) do |node|
    return node
  end

  false
end</pre> </div> <p>Parse a <a href="yaml.html"><code>YAML</code></a> string in <code>yaml</code>. Returns the <span><code>Psych::Nodes::Document</code></span>. <code>filename</code> is used in the exception message if a <span><code>Psych::SyntaxError</code></span> is raised.</p> <p>Raises a <span><code>Psych::SyntaxError</code></span> when a <a href="yaml.html"><code>YAML</code></a> syntax error is detected.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">Psych.parse("---\n - a\n - b") # =&gt; #&lt;Psych::Nodes::Document:0x00&gt;

begin
  Psych.parse("--- `", filename: "file.txt")
rescue Psych::SyntaxError =&gt; ex
  ex.file    # =&gt; 'file.txt'
  ex.message # =&gt; "(file.txt): found character that cannot start any token"
end
</pre> <p>See <span><code>Psych::Nodes</code></span> for more information about <a href="yaml.html"><code>YAML</code></a> AST.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-parse_file"> <span class="method-name">parse_file</span><span class="method-args">(filename, fallback: false)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="parse_file-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 410
def self.parse_file filename, fallback: false
  result = File.open filename, 'r:bom|utf-8' do |f|
    parse f, filename: filename
  end
  result || fallback
end</pre> </div> <p>Parse a file at <code>filename</code>. Returns the <span><code>Psych::Nodes::Document</code></span>.</p> <p>Raises a <span><code>Psych::SyntaxError</code></span> when a <a href="yaml.html"><code>YAML</code></a> syntax error is detected.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-parse_stream"> <span class="method-name">parse_stream</span><span class="method-args">(yaml, filename: nil, &amp;block)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="parse_stream-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 452
def self.parse_stream yaml, filename: nil, &amp;block
  if block_given?
    parser = Psych::Parser.new(Handlers::DocumentStream.new(&amp;block))
    parser.parse yaml, filename
  else
    parser = self.parser
    parser.parse yaml, filename
    parser.handler.root
  end
end</pre> </div> <p>Parse a <a href="yaml.html"><code>YAML</code></a> string in <code>yaml</code>. Returns the <span><code>Psych::Nodes::Stream</code></span>. This method can handle multiple <a href="yaml.html"><code>YAML</code></a> documents contained in <code>yaml</code>. <code>filename</code> is used in the exception message if a <span><code>Psych::SyntaxError</code></span> is raised.</p> <p>If a block is given, a <span><code>Psych::Nodes::Document</code></span> node will be yielded to the block as it’s being parsed.</p> <p>Raises a <span><code>Psych::SyntaxError</code></span> when a <a href="yaml.html"><code>YAML</code></a> syntax error is detected.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">Psych.parse_stream("---\n - a\n - b") # =&gt; #&lt;Psych::Nodes::Stream:0x00&gt;

Psych.parse_stream("--- a\n--- b") do |node|
  node # =&gt; #&lt;Psych::Nodes::Document:0x00&gt;
end

begin
  Psych.parse_stream("--- `", filename: "file.txt")
rescue Psych::SyntaxError =&gt; ex
  ex.file    # =&gt; 'file.txt'
  ex.message # =&gt; "(file.txt): found character that cannot start any token"
end
</pre> <p>Raises a <a href="typeerror.html"><code>TypeError</code></a> when <a href="nilclass.html"><code>NilClass</code></a> is passed.</p> <p>See <span><code>Psych::Nodes</code></span> for more information about <a href="yaml.html"><code>YAML</code></a> AST.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-parser"> <span class="method-name">parser</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="parser-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 419
def self.parser
  Psych::Parser.new(TreeBuilder.new)
end</pre> </div> <p>Returns a default parser</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-safe_dump"> <span class="method-callseq"> safe_dump(o) → string of yaml </span> <a class="method-click-advice">Show source</a> </div> <div class="method-heading"> <span class="method-callseq"> safe_dump(o, options) → string of yaml </span> </div> <div class="method-heading"> <span class="method-callseq"> safe_dump(o, io) → io object passed in </span> </div> <div class="method-heading"> <span class="method-callseq"> safe_dump(o, io, options) → io object passed in </span> </div> </div> <div class="method-description">
<div class="method-source-code" id="safe_dump-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 578
def self.safe_dump o, io = nil, options = {}
  if Hash === io
    options = io
    io      = nil
  end

  visitor = Psych::Visitors::RestrictedYAMLTree.create options
  visitor &lt;&lt; o
  visitor.tree.yaml io, options
end</pre> </div> <p>Safely dump Ruby object <code>o</code> to a <a href="yaml.html"><code>YAML</code></a> string. Optional <code>options</code> may be passed in to control the output format. If an <a href="io.html"><code>IO</code></a> object is passed in, the <a href="yaml.html"><code>YAML</code></a> will be dumped to that <a href="io.html"><code>IO</code></a> object. By default, only the following classes are allowed to be serialized:</p> <ul>
<li> <p><a href="trueclass.html"><code>TrueClass</code></a></p> </li>
<li> <p><a href="falseclass.html"><code>FalseClass</code></a></p> </li>
<li> <p><a href="nilclass.html"><code>NilClass</code></a></p> </li>
<li> <p><a href="integer.html"><code>Integer</code></a></p> </li>
<li> <p><a href="float.html"><code>Float</code></a></p> </li>
<li> <p><a href="string.html"><code>String</code></a></p> </li>
<li> <p><a href="array.html"><code>Array</code></a></p> </li>
<li> <p><a href="hash.html"><code>Hash</code></a></p> </li>
</ul> <p>Arbitrary classes can be allowed by adding those classes to the <code>permitted_classes</code> keyword argument. They are additive. For example, to allow <a href="date.html"><code>Date</code></a> serialization:</p> <pre class="ruby" data-language="ruby">Psych.safe_dump(yaml, permitted_classes: [Date])
</pre> <p>Now the <a href="date.html"><code>Date</code></a> class can be dumped in addition to the classes listed above.</p> <p>A <span><code>Psych::DisallowedClass</code></span> exception will be raised if the object contains a class that isn’t in the <code>permitted_classes</code> list.</p> <p>Currently supported options are:</p> <dl class="rdoc-list label-list">
<dt>
<code>:indentation</code> </dt>
<dd> <p>Number of space characters used to indent. Acceptable value should be in <code>0..9</code> range, otherwise option is ignored.</p> <p>Default: <code>2</code>.</p> </dd>
<dt>
<code>:line_width</code> </dt>
<dd> <p>Max character to wrap line at.</p> <p>Default: <code>0</code> (meaning “wrap at 81”).</p> </dd>
<dt>
<code>:canonical</code> </dt>
<dd> <p>Write “canonical” <a href="yaml.html"><code>YAML</code></a> form (very verbose, yet strictly formal).</p> <p>Default: <code>false</code>.</p> </dd>
<dt>
<code>:header</code> </dt>
<dd> <p>Write <code>%YAML [version]</code> at the beginning of document.</p> <p>Default: <code>false</code>.</p> </dd>
</dl> <p>Example:</p> <pre class="ruby" data-language="ruby"># Dump an array, get back a YAML string
Psych.safe_dump(['a', 'b'])  # =&gt; "---\n- a\n- b\n"

# Dump an array to an IO object
Psych.safe_dump(['a', 'b'], StringIO.new)  # =&gt; #&lt;StringIO:0x000001009d0890&gt;

# Dump an array with indentation set
Psych.safe_dump(['a', ['b']], indentation: 3) # =&gt; "---\n- a\n-  - b\n"

# Dump an array to an IO with indentation set
Psych.safe_dump(['a', ['b']], StringIO.new, indentation: 3)
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-safe_load"> <span class="method-name">safe_load</span><span class="method-args">(yaml, permitted_classes: [], permitted_symbols: [], aliases: false, filename: nil, fallback: nil, symbolize_names: false, freeze: false, strict_integer: false)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="safe_load-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 322
def self.safe_load yaml, permitted_classes: [], permitted_symbols: [], aliases: false, filename: nil, fallback: nil, symbolize_names: false, freeze: false, strict_integer: false
  result = parse(yaml, filename: filename)
  return fallback unless result

  class_loader = ClassLoader::Restricted.new(permitted_classes.map(&amp;:to_s),
                                             permitted_symbols.map(&amp;:to_s))
  scanner      = ScalarScanner.new class_loader, strict_integer: strict_integer
  visitor = if aliases
              Visitors::ToRuby.new scanner, class_loader, symbolize_names: symbolize_names, freeze: freeze
            else
              Visitors::NoAliasRuby.new scanner, class_loader, symbolize_names: symbolize_names, freeze: freeze
            end
  result = visitor.accept result
  result
end</pre> </div> <p>Safely load the yaml string in <code>yaml</code>. By default, only the following classes are allowed to be deserialized:</p> <ul>
<li> <p><a href="trueclass.html"><code>TrueClass</code></a></p> </li>
<li> <p><a href="falseclass.html"><code>FalseClass</code></a></p> </li>
<li> <p><a href="nilclass.html"><code>NilClass</code></a></p> </li>
<li> <p><a href="integer.html"><code>Integer</code></a></p> </li>
<li> <p><a href="float.html"><code>Float</code></a></p> </li>
<li> <p><a href="string.html"><code>String</code></a></p> </li>
<li> <p><a href="array.html"><code>Array</code></a></p> </li>
<li> <p><a href="hash.html"><code>Hash</code></a></p> </li>
</ul> <p>Recursive data structures are not allowed by default. Arbitrary classes can be allowed by adding those classes to the <code>permitted_classes</code> keyword argument. They are additive. For example, to allow <a href="date.html"><code>Date</code></a> deserialization:</p> <pre class="ruby" data-language="ruby">Psych.safe_load(yaml, permitted_classes: [Date])
</pre> <p>Now the <a href="date.html"><code>Date</code></a> class can be loaded in addition to the classes listed above.</p> <p>Aliases can be explicitly allowed by changing the <code>aliases</code> keyword argument. For example:</p> <pre class="ruby" data-language="ruby">x = []
x &lt;&lt; x
yaml = Psych.dump x
Psych.safe_load yaml               # =&gt; raises an exception
Psych.safe_load yaml, aliases: true # =&gt; loads the aliases
</pre> <p>A <span><code>Psych::DisallowedClass</code></span> exception will be raised if the yaml contains a class that isn’t in the <code>permitted_classes</code> list.</p> <p>A <span><code>Psych::AliasesNotEnabled</code></span> exception will be raised if the yaml contains aliases but the <code>aliases</code> keyword argument is set to false.</p> <p><code>filename</code> will be used in the exception message if any exception is raised while parsing.</p> <p>When the optional <code>symbolize_names</code> keyword argument is set to a true value, returns symbols for keys in <a href="hash.html"><code>Hash</code></a> objects (default: strings).</p> <pre class="ruby" data-language="ruby">Psych.safe_load("---\n foo: bar")                         # =&gt; {"foo"=&gt;"bar"}
Psych.safe_load("---\n foo: bar", symbolize_names: true)  # =&gt; {:foo=&gt;"bar"}
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-safe_load_file"> <span class="method-name">safe_load_file</span><span class="method-args">(filename, **kwargs)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="safe_load_file-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 658
def self.safe_load_file filename, **kwargs
  File.open(filename, 'r:bom|utf-8') { |f|
    self.safe_load f, filename: filename, **kwargs
  }
end</pre> </div> <p>Safely loads the document contained in <code>filename</code>. Returns the yaml contained in <code>filename</code> as a Ruby object, or if the file is empty, it returns the specified <code>fallback</code> return value, which defaults to <code>false</code>. See <a href="psych.html#method-c-safe_load"><code>safe_load</code></a> for options.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-to_json"> <span class="method-name">to_json</span><span class="method-args">(object)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="to_json-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 605
def self.to_json object
  visitor = Psych::Visitors::JSONTree.create
  visitor &lt;&lt; object
  visitor.tree.yaml
end</pre> </div> <p>Dump Ruby <code>object</code> to a <span><code>JSON</code></span> string.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-unsafe_load"> <span class="method-name">unsafe_load</span><span class="method-args">(yaml, filename: nil, fallback: false, symbolize_names: false, freeze: false, strict_integer: false)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="unsafe_load-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 271
def self.unsafe_load yaml, filename: nil, fallback: false, symbolize_names: false, freeze: false, strict_integer: false
  result = parse(yaml, filename: filename)
  return fallback unless result
  result.to_ruby(symbolize_names: symbolize_names, freeze: freeze, strict_integer: strict_integer)
end</pre> </div> <p>Load <code>yaml</code> in to a Ruby data structure. If multiple documents are provided, the object contained in the first document will be returned. <code>filename</code> will be used in the exception message if any exception is raised while parsing. If <code>yaml</code> is empty, it returns the specified <code>fallback</code> return value, which defaults to <code>false</code>.</p> <p>Raises a <span><code>Psych::SyntaxError</code></span> when a <a href="yaml.html"><code>YAML</code></a> syntax error is detected.</p> <p>Example:</p> <pre class="ruby" data-language="ruby">Psych.unsafe_load("--- a")             # =&gt; 'a'
Psych.unsafe_load("---\n - a\n - b")   # =&gt; ['a', 'b']

begin
  Psych.unsafe_load("--- `", filename: "file.txt")
rescue Psych::SyntaxError =&gt; ex
  ex.file    # =&gt; 'file.txt'
  ex.message # =&gt; "(file.txt): found character that cannot start any token"
end
</pre> <p>When the optional <code>symbolize_names</code> keyword argument is set to a true value, returns symbols for keys in <a href="hash.html"><code>Hash</code></a> objects (default: strings).</p> <pre class="ruby" data-language="ruby">Psych.unsafe_load("---\n foo: bar")                         # =&gt; {"foo"=&gt;"bar"}
Psych.unsafe_load("---\n foo: bar", symbolize_names: true)  # =&gt; {:foo=&gt;"bar"}
</pre> <p>Raises a <a href="typeerror.html"><code>TypeError</code></a> when ‘yaml` parameter is <a href="nilclass.html"><code>NilClass</code></a></p> <p>NOTE: This method *should not* be used to parse untrusted documents, such as <a href="yaml.html"><code>YAML</code></a> documents that are supplied via user input. Instead, please use the load method or the <a href="psych.html#method-c-safe_load"><code>safe_load</code></a> method.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-c-unsafe_load_file"> <span class="method-name">unsafe_load_file</span><span class="method-args">(filename, **kwargs)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="unsafe_load_file-source"> <pre class="ruby" data-language="ruby"># File ext/psych/lib/psych.rb, line 647
def self.unsafe_load_file filename, **kwargs
  File.open(filename, 'r:bom|utf-8') { |f|
    self.unsafe_load f, filename: filename, **kwargs
  }
end</pre> </div> <p>Load the document contained in <code>filename</code>. Returns the yaml contained in <code>filename</code> as a Ruby object, or if the file is empty, it returns the specified <code>fallback</code> return value, which defaults to <code>false</code>.</p> <p>NOTE: This method *should not* be used to parse untrusted documents, such as <a href="yaml.html"><code>YAML</code></a> documents that are supplied via user input. Instead, please use the <a href="psych.html#method-c-safe_load_file"><code>safe_load_file</code></a> method.</p>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2022 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
