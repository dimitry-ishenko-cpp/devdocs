<h1 id="class-URI::Generic" class="anchor-link class"> class URI::Generic </h1>
<dl class="meta">
<dt>Parent:</dt>
<dd class="meta-parent"><a href="../object.html">Object</a></dd>
<dt>Included modules:</dt>
<dd class="meta-includes"><a class="include" href="../uri.html">URI</a></dd>
</dl> <section class="description"> <p>Base class for all <a href="../uri.html"><code>URI</code></a> classes. Implements generic <a href="../uri.html"><code>URI</code></a> syntax as per RFC 2396.</p> </section> <section id="5Buntitled-5D" class="documentation-section anchor-link"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="COMPONENT">COMPONENT </dt>
<dd> <p>An <a href="../array.html"><code>Array</code></a> of the available components for <a href="generic.html"><code>URI::Generic</code></a>.</p> </dd>
<dt id="DEFAULT_PORT">DEFAULT_PORT </dt>
<dd> <p>A Default port of nil for <a href="generic.html"><code>URI::Generic</code></a>.</p> </dd>
</dl> </section> <section class="attribute-method-details"> <header> <h3>Attributes</h3> </header> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-fragment"> <a href="#attribute-i-fragment" title="Link to this attribute"> <span class="method-name">fragment</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the fragment component of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("http://foo/bar/baz?search=FooBar#ponies").fragment #=&gt; "ponies"
</pre> </div> </div> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-host"> <a href="#attribute-i-host" title="Link to this attribute"> <span class="method-name">host</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the host component of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("http://foo/bar/baz").host #=&gt; "foo"
</pre> <p>It returns nil if no host component exists.</p> <pre class="ruby" data-language="ruby">URI("mailto:foo@example.org").host #=&gt; nil
</pre> <p>The component does not contain the port number.</p> <pre class="ruby" data-language="ruby">URI("http://foo:8080/bar/baz").host #=&gt; "foo"
</pre> <p>Since IPv6 addresses are wrapped with brackets in URIs, this method returns IPv6 addresses wrapped with brackets. This form is not appropriate to pass to socket methods such as <a href="../io.html#method-c-open"><code>TCPSocket.open</code></a>. If unwrapped host names are required, use the <a href="generic.html#method-i-hostname"><code>hostname</code></a> method.</p> <pre class="ruby" data-language="ruby">URI("http://[::1]/bar/baz").host     #=&gt; "[::1]"
URI("http://[::1]/bar/baz").hostname #=&gt; "::1"
</pre> </div> </div> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-opaque"> <a href="#attribute-i-opaque" title="Link to this attribute"> <span class="method-name">opaque</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the opaque part of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("mailto:foo@example.org").opaque #=&gt; "foo@example.org"
URI("http://foo/bar/baz").opaque     #=&gt; nil
</pre> <p>The portion of the path that does not make use of the slash ‘/’. The path typically refers to an absolute path or an opaque part. (See RFC2396 Section 3 and 5.2.)</p> </div> </div> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-path"> <a href="#attribute-i-path" title="Link to this attribute"> <span class="method-name">path</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the path component of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("http://foo/bar/baz").path #=&gt; "/bar/baz"
</pre> </div> </div> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-port"> <a href="#attribute-i-port" title="Link to this attribute"> <span class="method-name">port</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the port component of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("http://foo/bar/baz").port      #=&gt; 80
URI("http://foo:8080/bar/baz").port #=&gt; 8080
</pre> </div> </div> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-query"> <a href="#attribute-i-query" title="Link to this attribute"> <span class="method-name">query</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the query component of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("http://foo/bar/baz?search=FooBar").query #=&gt; "search=FooBar"
</pre> </div> </div> <div class="method-detail anchor-link"> <div class="method-heading attribute-method-heading" id="attribute-i-scheme"> <a href="#attribute-i-scheme" title="Link to this attribute"> <span class="method-name">scheme</span> <span class="attribute-access-type">[R]</span> </a> </div> <div class="method-description"> <p>Returns the scheme component of the <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">URI("http://foo/bar/baz").scheme #=&gt; "http"
</pre> </div> </div> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section anchor-link"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-build"> <a href="#method-c-build" title="Link to this method"> <span class="method-name">build</span> <span class="method-args">(args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="build-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 116
def self.build(args)
  if args.kind_of?(Array) &amp;&amp;
      args.size == ::URI::Generic::COMPONENT.size
    tmp = args.dup
  elsif args.kind_of?(Hash)
    tmp = ::URI::Generic::COMPONENT.collect do |c|
      if args.include?(c)
        args[c]
      else
        nil
      end
    end
  else
    component = self.class.component rescue ::URI::Generic::COMPONENT
    raise ArgumentError,
    "expected Array of or Hash of components of #{self.class} (#{component.join(', ')})"
  end

  tmp &lt;&lt; nil
  tmp &lt;&lt; true
  return self.new(*tmp)
end</pre> </div>  <h2 id="method-c-build-label-Synopsis">Synopsis</h2> <p>See <a href="generic.html#method-c-new"><code>::new</code></a>.</p> <h2 id="method-c-build-label-Description">Description</h2> <p>Creates a new <a href="generic.html"><code>URI::Generic</code></a> instance from components of <a href="generic.html"><code>URI::Generic</code></a> with check. Components are: scheme, userinfo, host, port, registry, path, opaque, query, and fragment. You can provide arguments either by an <a href="../array.html"><code>Array</code></a> or a <a href="../hash.html"><code>Hash</code></a>. See <a href="generic.html#method-c-new"><code>::new</code></a> for hash keys to use or for order of array items.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-build2"> <a href="#method-c-build2" title="Link to this method"> <span class="method-name">build2</span> <span class="method-args">(args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="build2-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 78
def self.build2(args)
  begin
    return self.build(args)
  rescue InvalidComponentError
    if args.kind_of?(Array)
      return self.build(args.collect{|x|
        if x.is_a?(String)
          URI::RFC2396_PARSER.escape(x)
        else
          x
        end
      })
    elsif args.kind_of?(Hash)
      tmp = {}
      args.each do |key, value|
        tmp[key] = if value
            URI::RFC2396_PARSER.escape(value)
          else
            value
          end
      end
      return self.build(tmp)
    end
  end
end</pre> </div>  <h2 id="method-c-build2-label-Synopsis">Synopsis</h2> <p>See <a href="generic.html#method-c-new"><code>::new</code></a>.</p> <h2 id="method-c-build2-label-Description">Description</h2> <p>At first, tries to create a new <a href="generic.html"><code>URI::Generic</code></a> instance using <a href="generic.html#method-c-build"><code>URI::Generic::build</code></a>. But, if exception <a href="invalidcomponenterror.html"><code>URI::InvalidComponentError</code></a> is raised, then it does URI::Escape.escape all <a href="../uri.html"><code>URI</code></a> components and tries again.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-component"> <a href="#method-c-component" title="Link to this method"> <span class="method-name">component</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="component-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 57
def self.component
  self::COMPONENT
end</pre> </div>  <p>Components of the <a href="../uri.html"><code>URI</code></a> in the order.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-default_port"> <a href="#method-c-default_port" title="Link to this method"> <span class="method-name">default_port</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="default_port-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 32
def self.default_port
  self::DEFAULT_PORT
end</pre> </div>  <p>Returns default port.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-new"> <a href="#method-c-new" title="Link to this method"> <span class="method-name">new</span> <span class="method-args">(scheme, userinfo, host, port, registry, path, opaque, query, fragment, parser = DEFAULT_PARSER, arg_check = false)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="new-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 169
def initialize(scheme,
               userinfo, host, port, registry,
               path, opaque,
               query,
               fragment,
               parser = DEFAULT_PARSER,
               arg_check = false)
  @scheme = nil
  @user = nil
  @password = nil
  @host = nil
  @port = nil
  @path = nil
  @query = nil
  @opaque = nil
  @fragment = nil
  @parser = parser == DEFAULT_PARSER ? nil : parser

  if arg_check
    self.scheme = scheme
    self.userinfo = userinfo
    self.hostname = host
    self.port = port
    self.path = path
    self.query = query
    self.opaque = opaque
    self.fragment = fragment
  else
    self.set_scheme(scheme)
    self.set_userinfo(userinfo)
    self.set_host(host)
    self.set_port(port)
    self.set_path(path)
    self.query = query
    self.set_opaque(opaque)
    self.fragment=(fragment)
  end
  if registry
    raise InvalidURIError,
      "the scheme #{@scheme} does not accept registry part: #{registry} (or bad hostname?)"
  end

  @scheme&amp;.freeze
  self.set_path('') if !@path &amp;&amp; !@opaque # (see RFC2396 Section 5.2)
  self.set_port(self.default_port) if self.default_port &amp;&amp; !@port
end</pre> </div>  <h2 id="method-c-new-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>scheme</code></dt> <dd> <p>Protocol scheme, i.e. ‘http’,‘ftp’,‘mailto’ and so on.</p> </dd>
<dt><code>userinfo</code></dt> <dd> <p>User name and password, i.e. ‘sdmitry:bla’.</p> </dd>
<dt><code>host</code></dt> <dd> <p>Server host name.</p> </dd>
<dt><code>port</code></dt> <dd> <p>Server port.</p> </dd>
<dt><code>registry</code></dt> <dd> <p>Registry of naming authorities.</p> </dd>
<dt><code>path</code></dt> <dd> <p>Path on server.</p> </dd>
<dt><code>opaque</code></dt> <dd> <p>Opaque part.</p> </dd>
<dt><code>query</code></dt> <dd> <p>Query data.</p> </dd>
<dt><code>fragment</code></dt> <dd> <p>Part of the <a href="../uri.html"><code>URI</code></a> after ‘#’ character.</p> </dd>
<dt><code>parser</code></dt> <dd> <p>Parser for internal use [URI::DEFAULT_PARSER by default].</p> </dd>
<dt><code>arg_check</code></dt> <dd> <p>Check arguments [false by default].</p> </dd>
</dl> <h2 id="method-c-new-label-Description">Description</h2> <p>Creates a new <a href="generic.html"><code>URI::Generic</code></a> instance from “generic” components without check.</p> </div> </div> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section anchor-link"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail anchor-link method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-2B"> <a href="#method-i-2B" title="Link to this method"> <span class="method-name">+</span> <span class="method-args">(oth)</span> </a> </div> </div>  <div class="aliases"> Alias for: <a href="generic.html#method-i-merge">merge</a> </div> </div> <div class="method-detail anchor-link method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-2D"> <a href="#method-i-2D" title="Link to this method"> <span class="method-name">-</span> <span class="method-args">(oth)</span> </a> </div> </div>  <div class="aliases"> Alias for: <a href="generic.html#method-i-route_from">route_from</a> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-3D-3D"> <a href="#method-i-3D-3D" title="Link to this method"> <span class="method-name">==</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="3D-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1387
def ==(oth)
  if self.class == oth.class
    self.normalize.component_ary == oth.normalize.component_ary
  else
    false
  end
end</pre> </div>  <p>Compares two URIs.</p> </div> </div> <div class="method-detail anchor-link method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-absolute"> <a href="#method-i-absolute" title="Link to this method"> <span class="method-name">absolute</span> <span class="method-args">()</span> </a> </div> </div>  <div class="aliases"> Alias for: <a href="generic.html#method-i-absolute-3F">absolute?</a> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-absolute-3F"> <a href="#method-i-absolute-3F" title="Link to this method"> <span class="method-name">absolute?</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="absolute-3F-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 972
def absolute?
  if @scheme
    true
  else
    false
  end
end</pre> </div>  <p>Returns true if <a href="../uri.html"><code>URI</code></a> has a scheme (e.g. http:// or https://) specified.</p> </div> <div class="aliases"> Also aliased as: <a href="generic.html#method-i-absolute">absolute</a> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-coerce"> <a href="#method-i-coerce" title="Link to this method"> <span class="method-name">coerce</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="coerce-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1464
def coerce(oth)
  case oth
  when String
    oth = parser.parse(oth)
  else
    super
  end

  return oth, self
end</pre> </div>  <h2 id="method-i-coerce-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../uri.html"><code>URI</code></a> or <a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-coerce-label-Description">Description</h2> <p>Attempts to parse other <a href="../uri.html"><code>URI</code></a> <code>oth</code>, returns [parsed_oth, self].</p> <h2 id="method-i-coerce-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com")
uri.coerce("http://foo.com")
#=&gt; [#&lt;URI::HTTP http://foo.com&gt;, #&lt;URI::HTTP http://my.example.com&gt;]
</pre> <div class="method-calls-super"> Calls superclass method </div> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-component"> <a href="#method-i-component" title="Link to this method"> <span class="method-name">component</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="component-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 313
def component
  self.class.component
end</pre> </div>  <p>Components of the <a href="../uri.html"><code>URI</code></a> in the order.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-decoded_password"> <a href="#method-i-decoded_password" title="Link to this method"> <span class="method-name">decoded_password</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="decoded_password-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 583
def decoded_password
  URI.decode_uri_component(@password) if @password
end</pre> </div>  <p>Returns the password component after <a href="../uri.html"><code>URI</code></a> decoding.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-decoded_user"> <a href="#method-i-decoded_user" title="Link to this method"> <span class="method-name">decoded_user</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="decoded_user-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 578
def decoded_user
  URI.decode_uri_component(@user) if @user
end</pre> </div>  <p>Returns the user component after <a href="../uri.html"><code>URI</code></a> decoding.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-default_port"> <a href="#method-i-default_port" title="Link to this method"> <span class="method-name">default_port</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="default_port-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 39
def default_port
  self.class.default_port
end</pre> </div>  <p>Returns default port.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-eql-3F"> <a href="#method-i-eql-3F" title="Link to this method"> <span class="method-name">eql?</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="eql-3F-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1399
def eql?(oth)
  self.class == oth.class &amp;&amp;
  parser == oth.parser &amp;&amp;
  self.component_ary.eql?(oth.component_ary)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-find_proxy"> <a href="#method-i-find_proxy" title="Link to this method"> <span class="method-name">find_proxy</span> <span class="method-args">(env=ENV)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="find_proxy-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1490
def find_proxy(env=ENV)
  raise BadURIError, "relative URI: #{self}" if self.relative?
  name = self.scheme.downcase + '_proxy'
  proxy_uri = nil
  if name == 'http_proxy' &amp;&amp; env.include?('REQUEST_METHOD') # CGI?
    # HTTP_PROXY conflicts with *_proxy for proxy settings and
    # HTTP_* for header information in CGI.
    # So it should be careful to use it.
    pairs = env.reject {|k, v| /\Ahttp_proxy\z/i !~ k }
    case pairs.length
    when 0 # no proxy setting anyway.
      proxy_uri = nil
    when 1
      k, _ = pairs.shift
      if k == 'http_proxy' &amp;&amp; env[k.upcase] == nil
        # http_proxy is safe to use because ENV is case sensitive.
        proxy_uri = env[name]
      else
        proxy_uri = nil
      end
    else # http_proxy is safe to use because ENV is case sensitive.
      proxy_uri = env.to_hash[name]
    end
    if !proxy_uri
      # Use CGI_HTTP_PROXY.  cf. libwww-perl.
      proxy_uri = env["CGI_#{name.upcase}"]
    end
  elsif name == 'http_proxy'
    if RUBY_ENGINE == 'jruby' &amp;&amp; p_addr = ENV_JAVA['http.proxyHost']
      p_port = ENV_JAVA['http.proxyPort']
      if p_user = ENV_JAVA['http.proxyUser']
        p_pass = ENV_JAVA['http.proxyPass']
        proxy_uri = "http://#{p_user}:#{p_pass}@#{p_addr}:#{p_port}"
      else
        proxy_uri = "http://#{p_addr}:#{p_port}"
      end
    else
      unless proxy_uri = env[name]
        if proxy_uri = env[name.upcase]
          warn 'The environment variable HTTP_PROXY is discouraged.  Use http_proxy.', uplevel: 1
        end
      end
    end
  else
    proxy_uri = env[name] || env[name.upcase]
  end

  if proxy_uri.nil? || proxy_uri.empty?
    return nil
  end

  if self.hostname
    begin
      addr = IPSocket.getaddress(self.hostname)
      return nil if /\A127\.|\A::1\z/ =~ addr
    rescue SocketError
    end
  end

  name = 'no_proxy'
  if no_proxy = env[name] || env[name.upcase]
    return nil unless URI::Generic.use_proxy?(self.hostname, addr, self.port, no_proxy)
  end
  URI.parse(proxy_uri)
end</pre> </div>  <p>Returns a proxy <a href="../uri.html"><code>URI</code></a>. The proxy <a href="../uri.html"><code>URI</code></a> is obtained from environment variables such as http_proxy, ftp_proxy, no_proxy, etc. If there is no proper proxy, nil is returned.</p> <p>If the optional parameter <code>env</code> is specified, it is used instead of <a href="../env.html"><code>ENV</code></a>.</p> <p>Note that capitalized variables (HTTP_PROXY, FTP_PROXY, NO_PROXY, etc.) are examined, too.</p> <p>But http_proxy and HTTP_PROXY is treated specially under <a href="../cgi.html"><code>CGI</code></a> environment. It’s because HTTP_PROXY may be set by Proxy: header. So HTTP_PROXY is not used. http_proxy is not used too if the variable is case insensitive. CGI_HTTP_PROXY can be used instead.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-fragment-3D"> <a href="#method-i-fragment-3D" title="Link to this method"> <span class="method-name">fragment=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="fragment-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 929
def fragment=(v)
  return @fragment = nil unless v

  x = v.to_str
  v = x.dup if x.equal? v
  v.encode!(Encoding::UTF_8) rescue nil
  v.delete!("\t\r\n")
  v.force_encoding(Encoding::ASCII_8BIT)
  v.gsub!(/(?!%\h\h|[!-~])./n){'%%%02X' % $&amp;.ord}
  v.force_encoding(Encoding::US_ASCII)
  @fragment = v
end</pre> </div>  <p>Checks the fragment <code>v</code> component against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :FRAGMENT.</p> <h2 id="method-i-fragment-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-fragment-3D-label-Description">Description</h2> <p>Public setter for the fragment component <code>v</code> (with validation).</p> <h2 id="method-i-fragment-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com/?id=25#time=1305212049")
uri.fragment = "time=1305212086"
uri.to_s  #=&gt; "http://my.example.com/?id=25#time=1305212086"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-hash"> <a href="#method-i-hash" title="Link to this method"> <span class="method-name">hash</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="hash-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1395
def hash
  self.component_ary.hash
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-hierarchical-3F"> <a href="#method-i-hierarchical-3F" title="Link to this method"> <span class="method-name">hierarchical?</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="hierarchical-3F-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 961
def hierarchical?
  if @path
    true
  else
    false
  end
end</pre> </div>  <p>Returns true if <a href="../uri.html"><code>URI</code></a> is hierarchical.</p> <h2 id="method-i-hierarchical-3F-label-Description">Description</h2> <p><a href="../uri.html"><code>URI</code></a> has components listed in order of decreasing significance from left to right, see RFC3986 <a href="https://www.rfc-editor.org/rfc/rfc3986">www.rfc-editor.org/rfc/rfc3986</a> 1.2.3.</p> <h2 id="method-i-hierarchical-3F-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com/")
uri.hierarchical?
#=&gt; true
uri = URI.parse("mailto:joe@example.com")
uri.hierarchical?
#=&gt; false
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-host-3D"> <a href="#method-i-host-3D" title="Link to this method"> <span class="method-name">host=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="host-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 639
def host=(v)
  check_host(v)
  set_host(v)
  v
end</pre> </div>  <h2 id="method-i-host-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-host-3D-label-Description">Description</h2> <p>Public setter for the host component <code>v</code> (with validation).</p> <p>See also <a href="generic.html#method-i-check_host"><code>URI::Generic.check_host</code></a>.</p> <h2 id="method-i-host-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com")
uri.host = "foo.com"
uri.to_s  #=&gt; "http://foo.com"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-hostname"> <a href="#method-i-hostname" title="Link to this method"> <span class="method-name">hostname</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="hostname-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 654
def hostname
  v = self.host
  v&amp;.start_with?('[') &amp;&amp; v.end_with?(']') ? v[1..-2] : v
end</pre> </div>  <p>Extract the host part of the <a href="../uri.html"><code>URI</code></a> and unwrap brackets for IPv6 addresses.</p> <p>This method is the same as <a href="generic.html#attribute-i-host"><code>URI::Generic#host</code></a> except brackets for IPv6 (and future IP) addresses are removed.</p> <pre class="ruby" data-language="ruby">uri = URI("http://[::1]/bar")
uri.hostname      #=&gt; "::1"
uri.host          #=&gt; "[::1]"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-hostname-3D"> <a href="#method-i-hostname-3D" title="Link to this method"> <span class="method-name">hostname=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="hostname-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 671
def hostname=(v)
  v = "[#{v}]" if !(v&amp;.start_with?('[') &amp;&amp; v&amp;.end_with?(']')) &amp;&amp; v&amp;.index(':')
  self.host = v
end</pre> </div>  <p>Sets the host part of the <a href="../uri.html"><code>URI</code></a> as the argument with brackets for IPv6 addresses.</p> <p>This method is the same as <a href="generic.html#method-i-host-3D"><code>URI::Generic#host=</code></a> except the argument can be a bare IPv6 address.</p> <pre class="ruby" data-language="ruby">uri = URI("http://foo/bar")
uri.hostname = "::1"
uri.to_s  #=&gt; "http://[::1]/bar"
</pre> <p>If the argument seems to be an IPv6 address, it is wrapped with brackets.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-inspect"> <a href="#method-i-inspect" title="Link to this method"> <span class="method-name">inspect</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="inspect-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1441
def inspect
  "#&lt;#{self.class} #{self}&gt;"
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-merge"> <a href="#method-i-merge" title="Link to this method"> <span class="method-name">merge</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="merge-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1109
def merge(oth)
  rel = parser.__send__(:convert_to_uri, oth)

  if rel.absolute?
    #raise BadURIError, "both URI are absolute" if absolute?
    # hmm... should return oth for usability?
    return rel
  end

  unless self.absolute?
    raise BadURIError, "both URI are relative"
  end

  base = self.dup

  authority = rel.userinfo || rel.host || rel.port

  # RFC2396, Section 5.2, 2)
  if (rel.path.nil? || rel.path.empty?) &amp;&amp; !authority &amp;&amp; !rel.query
    base.fragment=(rel.fragment) if rel.fragment
    return base
  end

  base.query = nil
  base.fragment=(nil)

  # RFC2396, Section 5.2, 4)
  if !authority
    base.set_path(merge_path(base.path, rel.path)) if base.path &amp;&amp; rel.path
  else
    # RFC2396, Section 5.2, 4)
    base.set_path(rel.path) if rel.path
  end

  # RFC2396, Section 5.2, 7)
  base.set_userinfo(rel.userinfo) if rel.userinfo
  base.set_host(rel.host)         if rel.host
  base.set_port(rel.port)         if rel.port
  base.query = rel.query       if rel.query
  base.fragment=(rel.fragment) if rel.fragment

  return base
end</pre> </div>  <h2 id="method-i-merge-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>oth</code></dt> <dd> <p><a href="../uri.html"><code>URI</code></a> or <a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-merge-label-Description">Description</h2> <p>Merges two URIs.</p> <h2 id="method-i-merge-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com")
uri.merge("/main.rbx?page=1")
# =&gt; "http://my.example.com/main.rbx?page=1"
</pre> </div> <div class="aliases"> Also aliased as: <a href="generic.html#method-i-2B">+</a> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-merge-21"> <a href="#method-i-merge-21" title="Link to this method"> <span class="method-name">merge!</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="merge-21-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1081
def merge!(oth)
  t = merge(oth)
  if self == t
    nil
  else
    replace!(t)
    self
  end
end</pre> </div>  <h2 id="method-i-merge-21-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>oth</code></dt> <dd> <p><a href="../uri.html"><code>URI</code></a> or <a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-merge-21-label-Description">Description</h2> <p>Destructive form of <a href="generic.html#method-i-merge"><code>merge</code></a>.</p> <h2 id="method-i-merge-21-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com")
uri.merge!("/main.rbx?page=1")
uri.to_s  # =&gt; "http://my.example.com/main.rbx?page=1"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-normalize"> <a href="#method-i-normalize" title="Link to this method"> <span class="method-name">normalize</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="normalize-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1319
def normalize
  uri = dup
  uri.normalize!
  uri
end</pre> </div>  <p>Returns normalized <a href="../uri.html"><code>URI</code></a>.</p> <pre class="ruby" data-language="ruby">require 'uri'

URI("HTTP://my.EXAMPLE.com").normalize
#=&gt; #&lt;URI::HTTP http://my.example.com/&gt;
</pre> <p>Normalization here means:</p> <ul>
<li> <p>scheme and host are converted to lowercase,</p> </li>
<li> <p>an empty path component is set to “/”.</p> </li>
</ul> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-normalize-21"> <a href="#method-i-normalize-21" title="Link to this method"> <span class="method-name">normalize!</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="normalize-21-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1328
def normalize!
  if path&amp;.empty?
    set_path('/')
  end
  if scheme &amp;&amp; scheme != scheme.downcase
    set_scheme(self.scheme.downcase)
  end
  if host &amp;&amp; host != host.downcase
    set_host(self.host.downcase)
  end
end</pre> </div>  <p>Destructive version of <a href="generic.html#method-i-normalize"><code>normalize</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-opaque-3D"> <a href="#method-i-opaque-3D" title="Link to this method"> <span class="method-name">opaque=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="opaque-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 901
def opaque=(v)
  check_opaque(v)
  set_opaque(v)
  v
end</pre> </div>  <h2 id="method-i-opaque-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-opaque-3D-label-Description">Description</h2> <p>Public setter for the opaque component <code>v</code> (with validation).</p> <p>See also <a href="generic.html#method-i-check_opaque"><code>URI::Generic.check_opaque</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-parser"> <a href="#method-i-parser" title="Link to this method"> <span class="method-name">parser</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="parser-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 289
def parser
  if !defined?(@parser) || !@parser
    DEFAULT_PARSER
  else
    @parser || DEFAULT_PARSER
  end
end</pre> </div>  <p>Returns the parser to be used.</p> <p>Unless a URI::Parser is defined, DEFAULT_PARSER is used.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-password"> <a href="#method-i-password" title="Link to this method"> <span class="method-name">password</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="password-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 573
def password
  @password
end</pre> </div>  <p>Returns the password component (without <a href="../uri.html"><code>URI</code></a> decoding).</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-password-3D"> <a href="#method-i-password-3D" title="Link to this method"> <span class="method-name">password=</span> <span class="method-args">(password)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="password-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 498
def password=(password)
  check_password(password)
  set_password(password)
  # returns password
end</pre> </div>  <h2 id="method-i-password-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-password-3D-label-Description">Description</h2> <p>Public setter for the <code>password</code> component (with validation).</p> <p>See also <a href="generic.html#method-i-check_password"><code>URI::Generic.check_password</code></a>.</p> <h2 id="method-i-password-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://john:S3nsit1ve@my.example.com")
uri.password = "V3ry_S3nsit1ve"
uri.to_s  #=&gt; "http://john:V3ry_S3nsit1ve@my.example.com"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-path-3D"> <a href="#method-i-path-3D" title="Link to this method"> <span class="method-name">path=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="path-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 815
def path=(v)
  check_path(v)
  set_path(v)
  v
end</pre> </div>  <h2 id="method-i-path-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-path-3D-label-Description">Description</h2> <p>Public setter for the path component <code>v</code> (with validation).</p> <p>See also <a href="generic.html#method-i-check_path"><code>URI::Generic.check_path</code></a>.</p> <h2 id="method-i-path-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com/pub/files")
uri.path = "/faq/"
uri.to_s  #=&gt; "http://my.example.com/faq/"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-port-3D"> <a href="#method-i-port-3D" title="Link to this method"> <span class="method-name">port=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="port-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 729
def port=(v)
  check_port(v)
  set_port(v)
  port
end</pre> </div>  <h2 id="method-i-port-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-port-3D-label-Description">Description</h2> <p>Public setter for the port component <code>v</code> (with validation).</p> <p>See also <a href="generic.html#method-i-check_port"><code>URI::Generic.check_port</code></a>.</p> <h2 id="method-i-port-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com")
uri.port = 8080
uri.to_s  #=&gt; "http://my.example.com:8080"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-query-3D"> <a href="#method-i-query-3D" title="Link to this method"> <span class="method-name">query=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="query-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 839
def query=(v)
  return @query = nil unless v
  raise InvalidURIError, "query conflicts with opaque" if @opaque

  x = v.to_str
  v = x.dup if x.equal? v
  v.encode!(Encoding::UTF_8) rescue nil
  v.delete!("\t\r\n")
  v.force_encoding(Encoding::ASCII_8BIT)
  raise InvalidURIError, "invalid percent escape: #{$1}" if /(%\H\H)/n.match(v)
  v.gsub!(/(?!%\h\h|[!$-&amp;(-;=?-_a-~])./n.freeze){'%%%02X' % $&amp;.ord}
  v.force_encoding(Encoding::US_ASCII)
  @query = v
end</pre> </div>  <h2 id="method-i-query-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-query-3D-label-Description">Description</h2> <p>Public setter for the query component <code>v</code>.</p> <h2 id="method-i-query-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com/?id=25")
uri.query = "id=1"
uri.to_s  #=&gt; "http://my.example.com/?id=1"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-registry-3D"> <a href="#method-i-registry-3D" title="Link to this method"> <span class="method-name">registry=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="registry-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 745
def registry=(v)
  raise InvalidURIError, "cannot set registry"
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-relative-3F"> <a href="#method-i-relative-3F" title="Link to this method"> <span class="method-name">relative?</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="relative-3F-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 984
def relative?
  !absolute?
end</pre> </div>  <p>Returns true if <a href="../uri.html"><code>URI</code></a> does not have a scheme (e.g. http:// or https://) specified.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-route_from"> <a href="#method-i-route_from" title="Link to this method"> <span class="method-name">route_from</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="route_from-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1262
def route_from(oth)
  # you can modify `rel', but cannot `oth'.
  begin
    oth, rel = route_from0(oth)
  rescue
    raise $!.class, $!.message
  end
  if oth == rel
    return rel
  end

  rel.set_path(route_from_path(oth.path, self.path))
  if rel.path == './' &amp;&amp; self.query
    # "./?foo" -&gt; "?foo"
    rel.set_path('')
  end

  return rel
end</pre> </div>  <h2 id="method-i-route_from-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>oth</code></dt> <dd> <p><a href="../uri.html"><code>URI</code></a> or <a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-route_from-label-Description">Description</h2> <p>Calculates relative path from oth to self.</p> <h2 id="method-i-route_from-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse('http://my.example.com/main.rbx?page=1')
uri.route_from('http://my.example.com')
#=&gt; #&lt;URI::Generic /main.rbx?page=1&gt;
</pre> </div> <div class="aliases"> Also aliased as: <a href="generic.html#method-i-2D">-</a> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-route_to"> <a href="#method-i-route_to" title="Link to this method"> <span class="method-name">route_to</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="route_to-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1302
def route_to(oth)
  parser.__send__(:convert_to_uri, oth).route_from(self)
end</pre> </div>  <h2 id="method-i-route_to-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>oth</code></dt> <dd> <p><a href="../uri.html"><code>URI</code></a> or <a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-route_to-label-Description">Description</h2> <p>Calculates relative path to oth from self.</p> <h2 id="method-i-route_to-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse('http://my.example.com')
uri.route_to('http://my.example.com/main.rbx?page=1')
#=&gt; #&lt;URI::Generic /main.rbx?page=1&gt;
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-scheme-3D"> <a href="#method-i-scheme-3D" title="Link to this method"> <span class="method-name">scheme=</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="scheme-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 360
def scheme=(v)
  check_scheme(v)
  set_scheme(v)
  v
end</pre> </div>  <h2 id="method-i-scheme-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-scheme-3D-label-Description">Description</h2> <p>Public setter for the scheme component <code>v</code> (with validation).</p> <p>See also <a href="generic.html#method-i-check_scheme"><code>URI::Generic.check_scheme</code></a>.</p> <h2 id="method-i-scheme-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://my.example.com")
uri.scheme = "https"
uri.to_s  #=&gt; "https://my.example.com"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-select"> <a href="#method-i-select" title="Link to this method"> <span class="method-name">select</span> <span class="method-args">(*components)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="select-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1430
def select(*components)
  components.collect do |c|
    if component.include?(c)
      self.__send__(c)
    else
      raise ArgumentError,
        "expected of components of #{self.class} (#{self.class.component.join(', ')})"
    end
  end
end</pre> </div>  <h2 id="method-i-select-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>components</code></dt> <dd> <p>Multiple <a href="../symbol.html"><code>Symbol</code></a> arguments defined in <a href="http"><code>URI::HTTP</code></a>.</p> </dd>
</dl> <h2 id="method-i-select-label-Description">Description</h2> <p>Selects specified components from <a href="../uri.html"><code>URI</code></a>.</p> <h2 id="method-i-select-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse('http://myuser:mypass@my.example.com/test.rbx')
uri.select(:userinfo, :host, :path)
# =&gt; ["myuser:mypass", "my.example.com", "/test.rbx"]
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-to_s"> <a href="#method-i-to_s" title="Link to this method"> <span class="method-name">to_s</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="to_s-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1343
def to_s
  str = ''.dup
  if @scheme
    str &lt;&lt; @scheme
    str &lt;&lt; ':'
  end

  if @opaque
    str &lt;&lt; @opaque
  else
    if @host || %w[file postgres].include?(@scheme)
      str &lt;&lt; '//'
    end
    if self.userinfo
      str &lt;&lt; self.userinfo
      str &lt;&lt; '@'
    end
    if @host
      str &lt;&lt; @host
    end
    if @port &amp;&amp; @port != self.default_port
      str &lt;&lt; ':'
      str &lt;&lt; @port.to_s
    end
    if (@host || @port) &amp;&amp; !@path.empty? &amp;&amp; !@path.start_with?('/')
      str &lt;&lt; '/'
    end
    str &lt;&lt; @path
    if @query
      str &lt;&lt; '?'
      str &lt;&lt; @query
    end
  end
  if @fragment
    str &lt;&lt; '#'
    str &lt;&lt; @fragment
  end
  str
end</pre> </div>  <p>Constructs <a href="../string.html"><code>String</code></a> from <a href="../uri.html"><code>URI</code></a>.</p> </div> <div class="aliases"> Also aliased as: <a href="generic.html#method-i-to_str">to_str</a> </div> </div> <div class="method-detail anchor-link method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-to_str"> <a href="#method-i-to_str" title="Link to this method"> <span class="method-name">to_str</span> <span class="method-args">()</span> </a> </div> </div>  <div class="aliases"> Alias for: <a href="generic.html#method-i-to_s">to_s</a> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-user"> <a href="#method-i-user" title="Link to this method"> <span class="method-name">user</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="user-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 568
def user
  @user
end</pre> </div>  <p>Returns the user component (without <a href="../uri.html"><code>URI</code></a> decoding).</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-user-3D"> <a href="#method-i-user-3D" title="Link to this method"> <span class="method-name">user=</span> <span class="method-args">(user)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="user-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 471
def user=(user)
  check_user(user)
  set_user(user)
  # returns user
end</pre> </div>  <h2 id="method-i-user-3D-label-Args">Args</h2> <dl class="rdoc-list note-list">
<dt><code>v</code></dt> <dd> <p><a href="../string.html"><code>String</code></a></p> </dd>
</dl> <h2 id="method-i-user-3D-label-Description">Description</h2> <p>Public setter for the <code>user</code> component (with validation).</p> <p>See also <a href="generic.html#method-i-check_user"><code>URI::Generic.check_user</code></a>.</p> <h2 id="method-i-user-3D-label-Usage">Usage</h2> <pre class="ruby" data-language="ruby">require 'uri'

uri = URI.parse("http://john:S3nsit1ve@my.example.com")
uri.user = "sam"
uri.to_s  #=&gt; "http://sam:V3ry_S3nsit1ve@my.example.com"
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-userinfo"> <a href="#method-i-userinfo" title="Link to this method"> <span class="method-name">userinfo</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="userinfo-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 557
def userinfo
  if @user.nil?
    nil
  elsif @password.nil?
    @user
  else
    @user + ':' + @password
  end
end</pre> </div>  <p>Returns the userinfo, either as ‘user’ or ‘user:password’.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-userinfo-3D"> <a href="#method-i-userinfo-3D" title="Link to this method"> <span class="method-name">userinfo=</span> <span class="method-args">(userinfo)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="userinfo-3D-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 441
def userinfo=(userinfo)
  if userinfo.nil?
    return nil
  end
  check_userinfo(*userinfo)
  set_userinfo(*userinfo)
  # returns userinfo
end</pre> </div>  <p>Sets userinfo, argument is string like ‘name:pass’.</p> </div> </div> </section> <section id="protected-instance-5Buntitled-5D-method-details" class="method-section anchor-link"> <header> <h3>Protected Instance Methods</h3> </header> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-component_ary"> <a href="#method-i-component_ary" title="Link to this method"> <span class="method-name">component_ary</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="component_ary-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1406
def component_ary
  component.collect do |x|
    self.__send__(x)
  end
end</pre> </div>  <p>Returns an <a href="../array.html"><code>Array</code></a> of the components defined from the <a href="generic.html#COMPONENT"><code>COMPONENT</code></a> <a href="../array.html"><code>Array</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_host"> <a href="#method-i-set_host" title="Link to this method"> <span class="method-name">set_host</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_host-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 613
def set_host(v)
  @host = v
end</pre> </div>  <p>Protected setter for the host component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-host-3D"><code>URI::Generic.host=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_opaque"> <a href="#method-i-set_opaque" title="Link to this method"> <span class="method-name">set_opaque</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_opaque-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 883
def set_opaque(v)
  @opaque = v
end</pre> </div>  <p>Protected setter for the opaque component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-opaque-3D"><code>URI::Generic.opaque=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_password"> <a href="#method-i-set_password" title="Link to this method"> <span class="method-name">set_password</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_password-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 534
def set_password(v)
  @password = v
  # returns v
end</pre> </div>  <p>Protected setter for the password component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-password-3D"><code>URI::Generic.password=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_path"> <a href="#method-i-set_path" title="Link to this method"> <span class="method-name">set_path</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_path-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 789
def set_path(v)
  @path = v
end</pre> </div>  <p>Protected setter for the path component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-path-3D"><code>URI::Generic.path=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_port"> <a href="#method-i-set_port" title="Link to this method"> <span class="method-name">set_port</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_port-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 702
def set_port(v)
  v = v.empty? ? nil : v.to_i unless !v || v.kind_of?(Integer)
  @port = v
end</pre> </div>  <p>Protected setter for the port component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-port-3D"><code>URI::Generic.port=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_scheme"> <a href="#method-i-set_scheme" title="Link to this method"> <span class="method-name">set_scheme</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_scheme-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 334
def set_scheme(v)
  @scheme = v&amp;.downcase
end</pre> </div>  <p>Protected setter for the scheme component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-scheme-3D"><code>URI::Generic.scheme=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_user"> <a href="#method-i-set_user" title="Link to this method"> <span class="method-name">set_user</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_user-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 524
def set_user(v)
  set_userinfo(v, @password)
  v
end</pre> </div>  <p>Protected setter for the user component <code>v</code>.</p> <p>See also <a href="generic.html#method-i-user-3D"><code>URI::Generic.user=</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-set_userinfo"> <a href="#method-i-set_userinfo" title="Link to this method"> <span class="method-name">set_userinfo</span> <span class="method-args">(user, password = nil)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="set_userinfo-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 509
def set_userinfo(user, password = nil)
  unless password
    user, password = split_userinfo(user)
  end
  @user     = user
  @password = password if password

  [@user, @password]
end</pre> </div>  <p>Protected setter for the <code>user</code> component, and <code>password</code> if available (with validation).</p> <p>See also <a href="generic.html#method-i-userinfo-3D"><code>URI::Generic.userinfo=</code></a>.</p> </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section anchor-link"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_host"> <a href="#method-i-check_host" title="Link to this method"> <span class="method-name">check_host</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_host-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 594
def check_host(v)
  return v unless v

  if @opaque
    raise InvalidURIError,
      "cannot set host with registry or opaque"
  elsif parser.regexp[:HOST] !~ v
    raise InvalidComponentError,
      "bad component(expected host component): #{v}"
  end

  return true
end</pre> </div>  <p>Checks the host <code>v</code> component for RFC2396 compliance and against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :HOST.</p> <p>Can not have a registry or opaque component defined, with a host component defined.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_opaque"> <a href="#method-i-check_opaque" title="Link to this method"> <span class="method-name">check_opaque</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_opaque-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 861
def check_opaque(v)
  return v unless v

  # raise if both hier and opaque are not nil, because:
  # absoluteURI   = scheme ":" ( hier_part | opaque_part )
  # hier_part     = ( net_path | abs_path ) [ "?" query ]
  if @host || @port || @user || @path  # userinfo = @user + ':' + @password
    raise InvalidURIError,
      "cannot set opaque with host, port, userinfo or path"
  elsif v &amp;&amp; parser.regexp[:OPAQUE] !~ v
    raise InvalidComponentError,
      "bad component(expected opaque component): #{v}"
  end

  return true
end</pre> </div>  <p>Checks the opaque <code>v</code> component for RFC2396 compliance and against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :OPAQUE.</p> <p>Can not have a host, port, user, or path component defined, with an opaque component defined.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_password"> <a href="#method-i-check_password" title="Link to this method"> <span class="method-name">check_password</span> <span class="method-args">(v, user = @user)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_password-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 417
def check_password(v, user = @user)
  if @opaque
    raise InvalidURIError,
      "cannot set password with opaque"
  end
  return v unless v

  if !user
    raise InvalidURIError,
      "password component depends user component"
  end

  if parser.regexp[:USERINFO] !~ v
    raise InvalidComponentError,
      "bad password component"
  end

  return true
end</pre> </div>  <p>Checks the password <code>v</code> component for RFC2396 compliance and against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :USERINFO.</p> <p>Can not have a registry or opaque component defined, with a user component defined.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_path"> <a href="#method-i-check_path" title="Link to this method"> <span class="method-name">check_path</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_path-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 757
def check_path(v)
  # raise if both hier and opaque are not nil, because:
  # absoluteURI   = scheme ":" ( hier_part | opaque_part )
  # hier_part     = ( net_path | abs_path ) [ "?" query ]
  if v &amp;&amp; @opaque
    raise InvalidURIError,
      "path conflicts with opaque"
  end

  # If scheme is ftp, path may be relative.
  # See RFC 1738 section 3.2.2, and RFC 2396.
  if @scheme &amp;&amp; @scheme != "ftp"
    if v &amp;&amp; v != '' &amp;&amp; parser.regexp[:ABS_PATH] !~ v
      raise InvalidComponentError,
        "bad component(expected absolute path component): #{v}"
    end
  else
    if v &amp;&amp; v != '' &amp;&amp; parser.regexp[:ABS_PATH] !~ v &amp;&amp;
       parser.regexp[:REL_PATH] !~ v
      raise InvalidComponentError,
        "bad component(expected relative path component): #{v}"
    end
  end

  return true
end</pre> </div>  <p>Checks the path <code>v</code> component for RFC2396 compliance and against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :ABS_PATH and :REL_PATH.</p> <p>Can not have a opaque component defined, with a path component defined.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_port"> <a href="#method-i-check_port" title="Link to this method"> <span class="method-name">check_port</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_port-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 683
def check_port(v)
  return v unless v

  if @opaque
    raise InvalidURIError,
      "cannot set port with registry or opaque"
  elsif !v.kind_of?(Integer) &amp;&amp; parser.regexp[:PORT] !~ v
    raise InvalidComponentError,
      "bad component(expected port component): #{v.inspect}"
  end

  return true
end</pre> </div>  <p>Checks the port <code>v</code> component for RFC2396 compliance and against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :PORT.</p> <p>Can not have a registry or opaque component defined, with a port component defined.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_scheme"> <a href="#method-i-check_scheme" title="Link to this method"> <span class="method-name">check_scheme</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_scheme-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 320
def check_scheme(v)
  if v &amp;&amp; parser.regexp[:SCHEME] !~ v
    raise InvalidComponentError,
      "bad component(expected scheme component): #{v}"
  end

  return true
end</pre> </div>  <p>Checks the scheme <code>v</code> component against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :SCHEME.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_user"> <a href="#method-i-check_user" title="Link to this method"> <span class="method-name">check_user</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_user-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 393
def check_user(v)
  if @opaque
    raise InvalidURIError,
      "cannot set user with opaque"
  end

  return v unless v

  if parser.regexp[:USERINFO] !~ v
    raise InvalidComponentError,
      "bad component(expected userinfo component or user component): #{v}"
  end

  return true
end</pre> </div>  <p>Checks the user <code>v</code> component for RFC2396 compliance and against the URI::Parser <a href="../regexp.html"><code>Regexp</code></a> for :USERINFO.</p> <p>Can not have a registry or opaque component defined, with a user component defined.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-check_userinfo"> <a href="#method-i-check_userinfo" title="Link to this method"> <span class="method-name">check_userinfo</span> <span class="method-args">(user, password = nil)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="check_userinfo-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 375
def check_userinfo(user, password = nil)
  if !password
    user, password = split_userinfo(user)
  end
  check_user(user)
  check_password(password, user)

  return true
end</pre> </div>  <p>Checks the <code>user</code> and <code>password</code>.</p> <p>If <code>password</code> is not provided, then <code>user</code> is split, using <a href="generic.html#method-i-split_userinfo"><code>URI::Generic.split_userinfo</code></a>, to pull <code>user</code> and +password.</p> <p>See also <a href="generic.html#method-i-check_user"><code>URI::Generic.check_user</code></a>, <a href="generic.html#method-i-check_password"><code>URI::Generic.check_password</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-escape_userpass"> <a href="#method-i-escape_userpass" title="Link to this method"> <span class="method-name">escape_userpass</span> <span class="method-args">(v)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="escape_userpass-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 551
def escape_userpass(v)
  parser.escape(v, /[@:\/]/o) # RFC 1738 section 3.1 #/
end</pre> </div>  <p>Escapes ‘user:password’ <code>v</code> based on RFC 1738 section 3.1.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-merge_path"> <a href="#method-i-merge_path" title="Link to this method"> <span class="method-name">merge_path</span> <span class="method-args">(base, rel)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="merge_path-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 1000
def merge_path(base, rel)

  # RFC2396, Section 5.2, 5)
  # RFC2396, Section 5.2, 6)
  base_path = split_path(base)
  rel_path  = split_path(rel)

  # RFC2396, Section 5.2, 6), a)
  base_path &lt;&lt; '' if base_path.last == '..'
  while i = base_path.index('..')
    base_path.slice!(i - 1, 2)
  end

  if (first = rel_path.first) and first.empty?
    base_path.clear
    rel_path.shift
  end

  # RFC2396, Section 5.2, 6), c)
  # RFC2396, Section 5.2, 6), d)
  rel_path.push('') if rel_path.last == '.' || rel_path.last == '..'
  rel_path.delete('.')

  # RFC2396, Section 5.2, 6), e)
  tmp = []
  rel_path.each do |x|
    if x == '..' &amp;&amp;
        !(tmp.empty? || tmp.last == '..')
      tmp.pop
    else
      tmp &lt;&lt; x
    end
  end

  add_trailer_slash = !tmp.empty?
  if base_path.empty?
    base_path = [''] # keep '/' for root directory
  elsif add_trailer_slash
    base_path.pop
  end
  while x = tmp.shift
    if x == '..'
      # RFC2396, Section 4
      # a .. or . in an absolute path has no special meaning
      base_path.pop if base_path.size &gt; 1
    else
      # if x == '..'
      #   valid absolute (but abnormal) path "/../..."
      # else
      #   valid absolute path
      # end
      base_path &lt;&lt; x
      tmp.each {|t| base_path &lt;&lt; t}
      add_trailer_slash = false
      break
    end
  end
  base_path.push('') if add_trailer_slash

  return base_path.join('/')
end</pre> </div>  <p>Merges a base path <code>base</code>, with relative path <code>rel</code>, returns a modified base path.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-replace-21"> <a href="#method-i-replace-21" title="Link to this method"> <span class="method-name">replace!</span> <span class="method-args">(oth)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="replace-21-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 299
def replace!(oth)
  if self.class != oth.class
    raise ArgumentError, "expected #{self.class} object"
  end

  component.each do |c|
    self.__send__("#{c}=", oth.__send__(c))
  end
end</pre> </div>  <p>Replaces self by other <a href="../uri.html"><code>URI</code></a> object.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-split_path"> <a href="#method-i-split_path" title="Link to this method"> <span class="method-name">split_path</span> <span class="method-args">(path)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="split_path-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 991
def split_path(path)
  path.split("/", -1)
end</pre> </div>  <p>Returns an <a href="../array.html"><code>Array</code></a> of the path split on ‘/’.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-i-split_userinfo"> <a href="#method-i-split_userinfo" title="Link to this method"> <span class="method-name">split_userinfo</span> <span class="method-args">(ui)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="split_userinfo-source"> <pre class="ruby" data-language="ruby"># File lib/uri/generic.rb, line 542
def split_userinfo(ui)
  return nil, nil unless ui
  user, password = ui.split(':', 2)

  return user, password
end</pre> </div>  <p>Returns the userinfo <code>ui</code> as <code>[user, password]</code> if properly formatted as ‘user:password’.</p> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2024 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
