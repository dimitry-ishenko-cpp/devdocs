<h1 id="module-Bundler" class="anchor-link module"> module Bundler </h1> <section class="description"> <p><a href="bundler.html"><code>Bundler</code></a> provides a consistent environment for Ruby projects by tracking and installing the exact gems and versions that are needed.</p> <p><a href="bundler.html"><code>Bundler</code></a> is a part of Ruby’s standard library.</p> <p><a href="bundler.html"><code>Bundler</code></a> is used by creating <em>gemfiles</em> listing all the project dependencies and (optionally) their versions and then using</p> <pre class="ruby" data-language="ruby">require 'bundler/setup'
</pre> <p>or <a href="bundler.html#method-c-setup"><code>Bundler.setup</code></a> to setup environment where only specified gems and their specified versions could be used.</p> <p>See <a href="https://bundler.io/docs.html">Bundler website</a> for extensive documentation on gemfiles creation and <a href="bundler.html"><code>Bundler</code></a> usage.</p> <p>As a standard library inside project, <a href="bundler.html"><code>Bundler</code></a> could be used for introspection of loaded and required modules.</p> </section> <section id="5Buntitled-5D" class="documentation-section anchor-link"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="ORIGINAL_ENV">ORIGINAL_ENV </dt>

<dt id="SUDO_MUTEX">SUDO_MUTEX </dt>

</dl> </section> <section id="public-class-5Buntitled-5D-method-details" class="method-section anchor-link"> <header> <h3>Public Class Methods</h3> </header> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-app_cache"> <a href="#method-c-app_cache" title="Link to this method"> <span class="method-name">app_cache</span> <span class="method-args">(custom_path = nil)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="app_cache-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 345
def app_cache(custom_path = nil)
  path = custom_path || root
  Pathname.new(path).join(settings.app_cache_path)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-app_config_path"> <a href="#method-c-app_config_path" title="Link to this method"> <span class="method-name">app_config_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="app_config_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 331
def app_config_path
  if app_config = ENV["BUNDLE_APP_CONFIG"]
    app_config_pathname = Pathname.new(app_config)

    if app_config_pathname.absolute?
      app_config_pathname
    else
      app_config_pathname.expand_path(root)
    end
  else
    root.join(".bundle")
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-auto_install"> <a href="#method-c-auto_install" title="Link to this method"> <span class="method-name">auto_install</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="auto_install-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 183
def auto_install
  return unless settings[:auto_install]

  begin
    definition.specs
  rescue GemNotFound, GitError
    ui.info "Automatically installing missing gems."
    reset!
    CLI::Install.new({}).run
    reset!
  end
end</pre> </div>  <p>Automatically install dependencies if <a href="bundler.html#method-c-settings"><code>Bundler.settings[:auto_install]</code></a> exists. This is set through config cmd ‘bundle config set –global <a href="bundler.html#method-c-auto_install"><code>auto_install</code></a> 1`.</p> <p>Note that this method ‘nil`s out the global Definition object, so it should be called first, before you instantiate anything like an `Installer` that’ll keep a reference to the old one instead.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-auto_switch"> <a href="#method-c-auto_switch" title="Link to this method"> <span class="method-name">auto_switch</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="auto_switch-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 173
def auto_switch
  self_manager.restart_with_locked_bundler_if_needed
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-bin_path"> <a href="#method-c-bin_path" title="Link to this method"> <span class="method-name">bin_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="bin_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 121
def bin_path
  @bin_path ||= begin
    path = settings[:bin] || "bin"
    path = Pathname.new(path).expand_path(root).expand_path
    mkdir_p(path)
    path
  end
end</pre> </div>  <p>Returns absolute location of where binstubs are installed to.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-bundle_path"> <a href="#method-c-bundle_path" title="Link to this method"> <span class="method-name">bundle_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="bundle_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 103
def bundle_path
  @bundle_path ||= Pathname.new(configured_bundle_path.path).expand_path(root)
end</pre> </div>  <p>Returns absolute path of where gems are installed on the filesystem.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-clean_env"> <a href="#method-c-clean_env" title="Link to this method"> <span class="method-name">clean_env</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="clean_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 371
def clean_env
  message =
    "`Bundler.clean_env` has been deprecated in favor of `Bundler.unbundled_env`. " \
    "If you instead want the environment before bundler was originally loaded, use `Bundler.original_env`"
  removed_message =
    "`Bundler.clean_env` has been removed in favor of `Bundler.unbundled_env`. " \
    "If you instead want the environment before bundler was originally loaded, use `Bundler.original_env`"
  Bundler::SharedHelpers.major_deprecation(2, message, removed_message: removed_message, print_caller_location: true)
  unbundled_env
end</pre> </div>  <p>@deprecated Use ‘unbundled_env` instead</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-clean_exec"> <a href="#method-c-clean_exec" title="Link to this method"> <span class="method-name">clean_exec</span> <span class="method-args">(*args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="clean_exec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 442
def clean_exec(*args)
  message =
    "`Bundler.clean_exec` has been deprecated in favor of `Bundler.unbundled_exec`. " \
    "If you instead want to exec to a command in the environment before bundler was originally loaded, use `Bundler.original_exec`"
  removed_message =
    "`Bundler.clean_exec` has been removed in favor of `Bundler.unbundled_exec`. " \
    "If you instead want to exec to a command in the environment before bundler was originally loaded, use `Bundler.original_exec`"
  Bundler::SharedHelpers.major_deprecation(2, message, removed_message: removed_message, print_caller_location: true)
  with_env(unbundled_env) { Kernel.exec(*args) }
end</pre> </div>  <p>@deprecated Use ‘unbundled_exec` instead</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-clean_system"> <a href="#method-c-clean_system" title="Link to this method"> <span class="method-name">clean_system</span> <span class="method-args">(*args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="clean_system-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 420
def clean_system(*args)
  message =
    "`Bundler.clean_system` has been deprecated in favor of `Bundler.unbundled_system`. " \
    "If you instead want to run the command in the environment before bundler was originally loaded, use `Bundler.original_system`"
  removed_message =
    "`Bundler.clean_system` has been removed in favor of `Bundler.unbundled_system`. " \
    "If you instead want to run the command in the environment before bundler was originally loaded, use `Bundler.original_system`"
  Bundler::SharedHelpers.major_deprecation(2, message, removed_message: removed_message, print_caller_location: true)
  with_env(unbundled_env) { Kernel.system(*args) }
end</pre> </div>  <p>@deprecated Use ‘unbundled_system` instead</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-clear_gemspec_cache"> <a href="#method-c-clear_gemspec_cache" title="Link to this method"> <span class="method-name">clear_gemspec_cache</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="clear_gemspec_cache-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 566
def clear_gemspec_cache
  @gemspec_cache = {}
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-configure"> <a href="#method-c-configure" title="Link to this method"> <span class="method-name">configure</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="configure-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 89
def configure
  @configure ||= configure_gem_home_and_path
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-configure_gem_home_and_path"> <a href="#method-c-configure_gem_home_and_path" title="Link to this method"> <span class="method-name">configure_gem_home_and_path</span> <span class="method-args">(path = bundle_path)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="configure_gem_home_and_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 629
def configure_gem_home_and_path(path = bundle_path)
  configure_gem_path
  configure_gem_home(path)
  Bundler.rubygems.clear_paths
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-configured_bundle_path"> <a href="#method-c-configured_bundle_path" title="Link to this method"> <span class="method-name">configured_bundle_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="configured_bundle_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 116
def configured_bundle_path
  @configured_bundle_path ||= settings.path.tap(&amp;:validate!)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-create_bundle_path"> <a href="#method-c-create_bundle_path" title="Link to this method"> <span class="method-name">create_bundle_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="create_bundle_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 107
def create_bundle_path
  mkdir_p(bundle_path) unless bundle_path.exist?

  @bundle_path = bundle_path.realpath
rescue Errno::EEXIST
  raise PathError, "Could not install to path `#{bundle_path}` " \
    "because a file already exists at that path. Either remove or rename the file so the directory can be created."
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-default_bundle_dir"> <a href="#method-c-default_bundle_dir" title="Link to this method"> <span class="method-name">default_bundle_dir</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="default_bundle_dir-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 471
def default_bundle_dir
  SharedHelpers.default_bundle_dir
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-default_gemfile"> <a href="#method-c-default_gemfile" title="Link to this method"> <span class="method-name">default_gemfile</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="default_gemfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 463
def default_gemfile
  SharedHelpers.default_gemfile
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-default_lockfile"> <a href="#method-c-default_lockfile" title="Link to this method"> <span class="method-name">default_lockfile</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="default_lockfile-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 467
def default_lockfile
  SharedHelpers.default_lockfile
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-definition"> <a href="#method-c-definition" title="Link to this method"> <span class="method-name">definition</span> <span class="method-args">(unlock = nil, lockfile = default_lockfile)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="definition-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 234
def definition(unlock = nil, lockfile = default_lockfile)
  @definition = nil if unlock
  @definition ||= begin
    configure
    Definition.build(default_gemfile, lockfile, unlock)
  end
end</pre> </div>  <p>Returns an instance of Bundler::Definition for given Gemfile and lockfile</p> <p>@param unlock [Hash, Boolean, nil] Gems that have been requested</p> <pre class="ruby" data-language="ruby">to be updated or true if all gems should be updated
</pre> <p>@param lockfile [Pathname] Path to Gemfile.lock @return [Bundler::Definition]</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-environment"> <a href="#method-c-environment" title="Link to this method"> <span class="method-name">environment</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="environment-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 223
def environment
  SharedHelpers.major_deprecation 2, "Bundler.environment has been removed in favor of Bundler.load", print_caller_location: true
  load
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-feature_flag"> <a href="#method-c-feature_flag" title="Link to this method"> <span class="method-name">feature_flag</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="feature_flag-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 575
def feature_flag
  @feature_flag ||= FeatureFlag.new(VERSION)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-find_executable"> <a href="#method-c-find_executable" title="Link to this method"> <span class="method-name">find_executable</span> <span class="method-args">(path)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="find_executable-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 512
def find_executable(path)
  extensions = RbConfig::CONFIG["EXECUTABLE_EXTS"]&amp;.split
  extensions = [RbConfig::CONFIG["EXEEXT"]] unless extensions&amp;.any?
  candidates = extensions.map {|ext| "#{path}#{ext}" }

  candidates.find {|candidate| File.file?(candidate) &amp;&amp; File.executable?(candidate) }
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-frozen_bundle-3F"> <a href="#method-c-frozen_bundle-3F" title="Link to this method"> <span class="method-name">frozen_bundle?</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="frozen_bundle-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 242
def frozen_bundle?
  frozen = settings[:frozen]
  return frozen unless frozen.nil?

  settings[:deployment]
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-git_present-3F"> <a href="#method-c-git_present-3F" title="Link to this method"> <span class="method-name">git_present?</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="git_present-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 570
def git_present?
  return @git_present if defined?(@git_present)
  @git_present = Bundler.which("git")
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-home"> <a href="#method-c-home" title="Link to this method"> <span class="method-name">home</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="home-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 309
def home
  bundle_path.join("bundler")
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-install_path"> <a href="#method-c-install_path" title="Link to this method"> <span class="method-name">install_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="install_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 313
def install_path
  home.join("gems")
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-load"> <a href="#method-c-load" title="Link to this method"> <span class="method-name">load</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="load-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 219
def load
  @load ||= Runtime.new(root, definition)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-load_gemspec"> <a href="#method-c-load_gemspec" title="Link to this method"> <span class="method-name">load_gemspec</span> <span class="method-args">(file, validate = false)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="load_gemspec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 539
def load_gemspec(file, validate = false)
  @gemspec_cache ||= {}
  key = File.expand_path(file)
  @gemspec_cache[key] ||= load_gemspec_uncached(file, validate)
  # Protect against caching side-effected gemspecs by returning a
  # new instance each time.
  @gemspec_cache[key]&amp;.dup
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-load_gemspec_uncached"> <a href="#method-c-load_gemspec_uncached" title="Link to this method"> <span class="method-name">load_gemspec_uncached</span> <span class="method-args">(file, validate = false)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="load_gemspec_uncached-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 548
def load_gemspec_uncached(file, validate = false)
  path = Pathname.new(file)
  contents = read_file(file)
  spec = if contents.start_with?("---") # YAML header
    eval_yaml_gemspec(path, contents)
  else
    # Eval the gemspec from its parent directory, because some gemspecs
    # depend on "./" relative paths.
    SharedHelpers.chdir(path.dirname.to_s) do
      eval_gemspec(path, contents)
    end
  end
  return unless spec
  spec.loaded_from = path.expand_path.to_s
  Bundler.rubygems.validate(spec) if validate
  spec
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-load_plugins"> <a href="#method-c-load_plugins" title="Link to this method"> <span class="method-name">load_plugins</span> <span class="method-args">(definition = Bundler.definition)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="load_plugins-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 579
def load_plugins(definition = Bundler.definition)
  return if defined?(@load_plugins_ran)

  Bundler.rubygems.load_plugins

  requested_path_gems = definition.requested_specs.select {|s| s.source.is_a?(Source::Path) }
  path_plugin_files = requested_path_gems.flat_map do |spec|
    spec.matches_for_glob("rubygems_plugin#{Bundler.rubygems.suffix_pattern}")
  rescue TypeError
    error_message = "#{spec.name} #{spec.version} has an invalid gemspec"
    raise Gem::InvalidSpecificationException, error_message
  end
  Bundler.rubygems.load_plugin_files(path_plugin_files)
  Bundler.rubygems.load_env_plugins
  @load_plugins_ran = true
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-local_platform"> <a href="#method-c-local_platform" title="Link to this method"> <span class="method-name">local_platform</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="local_platform-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 458
def local_platform
  return Gem::Platform::RUBY if settings[:force_ruby_platform]
  Gem::Platform.local
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-locked_gems"> <a href="#method-c-locked_gems" title="Link to this method"> <span class="method-name">locked_gems</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="locked_gems-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 249
def locked_gems
  @locked_gems ||=
    if defined?(@definition) &amp;&amp; @definition
      definition.locked_gems
    elsif Bundler.default_lockfile.file?
      lock = Bundler.read_file(Bundler.default_lockfile)
      LockfileParser.new(lock)
    end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-mkdir_p"> <a href="#method-c-mkdir_p" title="Link to this method"> <span class="method-name">mkdir_p</span> <span class="method-args">(path)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="mkdir_p-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 492
def mkdir_p(path)
  SharedHelpers.filesystem_access(path, :create) do |p|
    FileUtils.mkdir_p(p)
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-original_env"> <a href="#method-c-original_env" title="Link to this method"> <span class="method-name">original_env</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="original_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 366
def original_env
  ORIGINAL_ENV.clone
end</pre> </div>  <p>@return [Hash] Environment present before <a href="bundler.html"><code>Bundler</code></a> was activated</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-original_exec"> <a href="#method-c-original_exec" title="Link to this method"> <span class="method-name">original_exec</span> <span class="method-args">(*args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="original_exec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 437
def original_exec(*args)
  with_original_env { Kernel.exec(*args) }
end</pre> </div>  <p>Run a ‘Kernel.exec` to a subcommand with the environment present before <a href="bundler.html"><code>Bundler</code></a> was activated</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-original_system"> <a href="#method-c-original_system" title="Link to this method"> <span class="method-name">original_system</span> <span class="method-args">(*args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="original_system-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 415
def original_system(*args)
  with_original_env { Kernel.system(*args) }
end</pre> </div>  <p>Run subcommand with the environment present before <a href="bundler.html"><code>Bundler</code></a> was activated</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-preferred_gemfile_name"> <a href="#method-c-preferred_gemfile_name" title="Link to this method"> <span class="method-name">preferred_gemfile_name</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="preferred_gemfile_name-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 484
def preferred_gemfile_name
  Bundler.settings[:init_gems_rb] ? "gems.rb" : "Gemfile"
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-read_file"> <a href="#method-c-read_file" title="Link to this method"> <span class="method-name">read_file</span> <span class="method-args">(file)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="read_file-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 520
def read_file(file)
  SharedHelpers.filesystem_access(file, :read) do
    File.open(file, "r:UTF-8", &amp;:read)
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-require"> <a href="#method-c-require" title="Link to this method"> <span class="method-name">require</span> <span class="method-args">(*groups)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="require-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 214
def require(*groups)
  load_plugins
  setup(*groups).require(*groups)
end</pre> </div>  <p>Setups <a href="bundler.html"><code>Bundler</code></a> environment (see <a href="bundler.html#method-c-setup"><code>Bundler.setup</code></a>) if it is not already set, and loads all gems from groups specified. Unlike <a href="bundler.html#method-c-setup"><code>::setup</code></a>, can be called multiple times with different groups (if they were allowed by setup).</p> <p>Assuming Gemfile</p> <pre class="ruby" data-language="ruby">gem 'first_gem', '= 1.0'
group :test do
  gem 'second_gem', '= 1.0'
end
</pre> <p>The code will work as follows:</p> <pre class="ruby" data-language="ruby">Bundler.setup # allow all groups
Bundler.require(:default) # requires only first_gem
# ...later
Bundler.require(:test)   # requires second_gem
</pre> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-reset-21"> <a href="#method-c-reset-21" title="Link to this method"> <span class="method-name">reset!</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="reset-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 596
def reset!
  reset_paths!
  Plugin.reset!
  reset_rubygems!
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-reset_paths-21"> <a href="#method-c-reset_paths-21" title="Link to this method"> <span class="method-name">reset_paths!</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="reset_paths-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 607
def reset_paths!
  @bin_path = nil
  @bundler_major_version = nil
  @bundle_path = nil
  @configure = nil
  @configured_bundle_path = nil
  @definition = nil
  @load = nil
  @locked_gems = nil
  @root = nil
  @settings = nil
  @setup = nil
  @user_home = nil
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-reset_rubygems-21"> <a href="#method-c-reset_rubygems-21" title="Link to this method"> <span class="method-name">reset_rubygems!</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="reset_rubygems-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 622
def reset_rubygems!
  return unless defined?(@rubygems) &amp;&amp; @rubygems
  rubygems.undo_replacements
  rubygems.reset
  @rubygems = nil
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-reset_settings_and_root-21"> <a href="#method-c-reset_settings_and_root-21" title="Link to this method"> <span class="method-name">reset_settings_and_root!</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="reset_settings_and_root-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 602
def reset_settings_and_root!
  @settings = nil
  @root = nil
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-rm_rf"> <a href="#method-c-rm_rf" title="Link to this method"> <span class="method-name">rm_rf</span> <span class="method-args">(path)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="rm_rf-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 355
def rm_rf(path)
  FileUtils.remove_entry_secure(path) if path &amp;&amp; File.exist?(path)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-root"> <a href="#method-c-root" title="Link to this method"> <span class="method-name">root</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="root-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 321
def root
  @root ||= begin
              SharedHelpers.root
            rescue GemfileNotFound
              bundle_dir = default_bundle_dir
              raise GemfileNotFound, "Could not locate Gemfile or .bundle/ directory" unless bundle_dir
              Pathname.new(File.expand_path("..", bundle_dir))
            end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-ruby_scope"> <a href="#method-c-ruby_scope" title="Link to this method"> <span class="method-name">ruby_scope</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="ruby_scope-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 259
def ruby_scope
  "#{Bundler.rubygems.ruby_engine}/#{RbConfig::CONFIG["ruby_version"]}"
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-safe_load_marshal"> <a href="#method-c-safe_load_marshal" title="Link to this method"> <span class="method-name">safe_load_marshal</span> <span class="method-args">(data)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="safe_load_marshal-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 526
def safe_load_marshal(data)
  if Gem.respond_to?(:load_safe_marshal)
    Gem.load_safe_marshal
    begin
      Gem::SafeMarshal.safe_load(data)
    rescue Gem::SafeMarshal::Reader::Error, Gem::SafeMarshal::Visitors::ToRuby::Error =&gt; e
      raise MarshalError, "#{e.class}: #{e.message}"
    end
  else
    load_marshal(data, marshal_proc: SafeMarshal.proc)
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-self_manager"> <a href="#method-c-self_manager" title="Link to this method"> <span class="method-name">self_manager</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="self_manager-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 635
def self_manager
  @self_manager ||= begin
                      require_relative "bundler/self_manager"
                      Bundler::SelfManager.new
                    end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-settings"> <a href="#method-c-settings" title="Link to this method"> <span class="method-name">settings</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="settings-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 359
def settings
  @settings ||= Settings.new(app_config_path)
rescue GemfileNotFound
  @settings = Settings.new
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-setup"> <a href="#method-c-setup" title="Link to this method"> <span class="method-name">setup</span> <span class="method-args">(*groups)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="setup-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 157
def setup(*groups)
  # Return if all groups are already loaded
  return @setup if defined?(@setup) &amp;&amp; @setup

  definition.validate_runtime!

  SharedHelpers.print_major_deprecations!

  if groups.empty?
    # Load all groups, but only once
    @setup = load.setup
  else
    load.setup(*groups)
  end
end</pre> </div>  <p>Turns on the <a href="bundler.html"><code>Bundler</code></a> runtime. After <a href="bundler.html#method-c-setup"><code>Bundler.setup</code></a> call, all <code>load</code> or <code>require</code> of the gems would be allowed only if they are part of the Gemfile or Ruby’s standard library. If the versions specified in Gemfile, only those versions would be loaded.</p> <p>Assuming Gemfile</p> <pre class="ruby" data-language="ruby">gem 'first_gem', '= 1.0'
group :test do
  gem 'second_gem', '= 1.0'
end
</pre> <p>The code using <a href="bundler.html#method-c-setup"><code>Bundler.setup</code></a> works as follows:</p> <pre class="ruby" data-language="ruby">require 'third_gem' # allowed, required from global gems
require 'first_gem' # allowed, loads the last installed version
Bundler.setup
require 'fourth_gem' # fails with LoadError
require 'second_gem' # loads exactly version 1.0
</pre> <p><a href="bundler.html#method-c-setup"><code>Bundler.setup</code></a> can be called only once, all subsequent calls are no-op.</p> <p>If <em>groups</em> list is provided, only gems from specified groups would be allowed (gems specified outside groups belong to special <code>:default</code> group).</p> <p>To require all gems from Gemfile (or only some groups), see <a href="bundler.html#method-c-require"><code>Bundler.require</code></a>.</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-specs_path"> <a href="#method-c-specs_path" title="Link to this method"> <span class="method-name">specs_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="specs_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 317
def specs_path
  bundle_path.join("specifications")
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-system_bindir"> <a href="#method-c-system_bindir" title="Link to this method"> <span class="method-name">system_bindir</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="system_bindir-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 475
def system_bindir
  # Gem.bindir doesn't always return the location that RubyGems will install
  # system binaries. If you put '-n foo' in your .gemrc, RubyGems will
  # install binstubs there instead. Unfortunately, RubyGems doesn't expose
  # that directory at all, so rather than parse .gemrc ourselves, we allow
  # the directory to be set as well, via `bundle config set --local bindir foo`.
  Bundler.settings[:system_bindir] || Bundler.rubygems.gem_bindir
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-tmp"> <a href="#method-c-tmp" title="Link to this method"> <span class="method-name">tmp</span> <span class="method-args">(name = Process.pid.to_s)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="tmp-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 350
def tmp(name = Process.pid.to_s)
  Kernel.send(:require, "tmpdir")
  Pathname.new(Dir.mktmpdir(["bundler", name]))
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-ui"> <a href="#method-c-ui" title="Link to this method"> <span class="method-name">ui</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="ui-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 93
def ui
  (defined?(@ui) &amp;&amp; @ui) || (self.ui = UI::Shell.new)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-ui-3D"> <a href="#method-c-ui-3D" title="Link to this method"> <span class="method-name">ui=</span> <span class="method-args">(ui)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="ui-3D-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 97
def ui=(ui)
  Bundler.rubygems.ui = UI::RGProxy.new(ui)
  @ui = ui
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-unbundle_env-21"> <a href="#method-c-unbundle_env-21" title="Link to this method"> <span class="method-name">unbundle_env!</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="unbundle_env-21-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 388
def unbundle_env!
  ENV.replace(unbundle_env(ENV))
end</pre> </div>  <p>Remove all bundler-related variables from <a href="env.html"><code>ENV</code></a></p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-unbundled_env"> <a href="#method-c-unbundled_env" title="Link to this method"> <span class="method-name">unbundled_env</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="unbundled_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 383
def unbundled_env
  unbundle_env(original_env)
end</pre> </div>  <p>@return [Hash] Environment with all bundler-related variables removed</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-unbundled_exec"> <a href="#method-c-unbundled_exec" title="Link to this method"> <span class="method-name">unbundled_exec</span> <span class="method-args">(*args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="unbundled_exec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 454
def unbundled_exec(*args)
  with_env(unbundled_env) { Kernel.exec(*args) }
end</pre> </div>  <p>Run a ‘Kernel.exec` to a subcommand in an environment with all bundler related variables removed</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-unbundled_system"> <a href="#method-c-unbundled_system" title="Link to this method"> <span class="method-name">unbundled_system</span> <span class="method-args">(*args)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="unbundled_system-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 432
def unbundled_system(*args)
  with_unbundled_env { Kernel.system(*args) }
end</pre> </div>  <p>Run subcommand in an environment with all bundler related variables removed</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-use_system_gems-3F"> <a href="#method-c-use_system_gems-3F" title="Link to this method"> <span class="method-name">use_system_gems?</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="use_system_gems-3F-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 488
def use_system_gems?
  configured_bundle_path.use_system_gems?
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-user_bundle_path"> <a href="#method-c-user_bundle_path" title="Link to this method"> <span class="method-name">user_bundle_path</span> <span class="method-args">(dir = "home")</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="user_bundle_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 287
def user_bundle_path(dir = "home")
  env_var, fallback = case dir
                      when "home"
                        ["BUNDLE_USER_HOME", proc { Pathname.new(user_home).join(".bundle") }]
                      when "cache"
                        ["BUNDLE_USER_CACHE", proc { user_bundle_path.join("cache") }]
                      when "config"
                        ["BUNDLE_USER_CONFIG", proc { user_bundle_path.join("config") }]
                      when "plugin"
                        ["BUNDLE_USER_PLUGIN", proc { user_bundle_path.join("plugin") }]
                      else
                        raise BundlerError, "Unknown user path requested: #{dir}"
  end
  # `fallback` will already be a Pathname, but Pathname.new() is
  # idempotent so it's OK
  Pathname.new(ENV.fetch(env_var, &amp;fallback))
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-user_cache"> <a href="#method-c-user_cache" title="Link to this method"> <span class="method-name">user_cache</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="user_cache-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 305
def user_cache
  user_bundle_path("cache")
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-user_home"> <a href="#method-c-user_home" title="Link to this method"> <span class="method-name">user_home</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="user_home-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 263
def user_home
  @user_home ||= begin
    home = Bundler.rubygems.user_home
    bundle_home = home ? File.join(home, ".bundle") : nil

    warning = if home.nil?
      "Your home directory is not set."
    elsif !File.directory?(home)
      "`#{home}` is not a directory."
    elsif !File.writable?(home) &amp;&amp; (!File.directory?(bundle_home) || !File.writable?(bundle_home))
      "`#{home}` is not writable."
    end

    if warning
      Bundler.ui.warn "#{warning}\n"
      user_home = tmp_home_path
      Bundler.ui.warn "Bundler will use `#{user_home}' as your home directory temporarily.\n"
      user_home
    else
      Pathname.new(home)
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-which"> <a href="#method-c-which" title="Link to this method"> <span class="method-name">which</span> <span class="method-args">(executable)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="which-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 498
def which(executable)
  executable_path = find_executable(executable)
  return executable_path if executable_path

  if (paths = ENV["PATH"])
    quote = '"'
    paths.split(File::PATH_SEPARATOR).find do |path|
      path = path[1..-2] if path.start_with?(quote) &amp;&amp; path.end_with?(quote)
      executable_path = find_executable(File.expand_path(executable, path))
      return executable_path if executable_path
    end
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-with_clean_env"> <a href="#method-c-with_clean_env" title="Link to this method"> <span class="method-name">with_clean_env</span> <span class="method-args">() { || ... }</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="with_clean_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 398
def with_clean_env
  message =
    "`Bundler.with_clean_env` has been deprecated in favor of `Bundler.with_unbundled_env`. " \
    "If you instead want the environment before bundler was originally loaded, use `Bundler.with_original_env`"
  removed_message =
    "`Bundler.with_clean_env` has been removed in favor of `Bundler.with_unbundled_env`. " \
    "If you instead want the environment before bundler was originally loaded, use `Bundler.with_original_env`"
  Bundler::SharedHelpers.major_deprecation(2, message, removed_message: removed_message, print_caller_location: true)
  with_env(unbundled_env) { yield }
end</pre> </div>  <p>@deprecated Use ‘with_unbundled_env` instead</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-with_original_env"> <a href="#method-c-with_original_env" title="Link to this method"> <span class="method-name">with_original_env</span> <span class="method-args">() { || ... }</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="with_original_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 393
def with_original_env
  with_env(original_env) { yield }
end</pre> </div>  <p>Run block with environment present before <a href="bundler.html"><code>Bundler</code></a> was activated</p> </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-with_unbundled_env"> <a href="#method-c-with_unbundled_env" title="Link to this method"> <span class="method-name">with_unbundled_env</span> <span class="method-args">() { || ... }</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="with_unbundled_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 410
def with_unbundled_env
  with_env(unbundled_env) { yield }
end</pre> </div>  <p>Run block with all bundler-related variables removed</p> </div> </div> </section> <section id="private-class-5Buntitled-5D-method-details" class="method-section anchor-link"> <header> <h3>Private Class Methods</h3> </header> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-configure_gem_home"> <a href="#method-c-configure_gem_home" title="Link to this method"> <span class="method-name">configure_gem_home</span> <span class="method-args">(path)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="configure_gem_home-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 699
def configure_gem_home(path)
  Bundler::SharedHelpers.set_env "GEM_HOME", path.to_s
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-configure_gem_path"> <a href="#method-c-configure_gem_path" title="Link to this method"> <span class="method-name">configure_gem_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="configure_gem_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 690
def configure_gem_path
  unless use_system_gems?
    # this needs to be empty string to cause
    # PathSupport.split_gem_path to only load up the
    # Bundler --path setting as the GEM_PATH.
    Bundler::SharedHelpers.set_env "GEM_PATH", ""
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-eval_gemspec"> <a href="#method-c-eval_gemspec" title="Link to this method"> <span class="method-name">eval_gemspec</span> <span class="method-args">(path, contents)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="eval_gemspec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 682
def eval_gemspec(path, contents)
  eval(contents, TOPLEVEL_BINDING.dup, path.expand_path.to_s)
rescue ScriptError, StandardError =&gt; e
  msg = "There was an error while loading `#{path.basename}`: #{e.message}"

  raise GemspecError, Dsl::DSLError.new(msg, path.to_s, e.backtrace, contents)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-eval_yaml_gemspec"> <a href="#method-c-eval_yaml_gemspec" title="Link to this method"> <span class="method-name">eval_yaml_gemspec</span> <span class="method-args">(path, contents)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="eval_yaml_gemspec-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 674
def eval_yaml_gemspec(path, contents)
  Kernel.require "psych"

  Gem::Specification.from_yaml(contents)
rescue ::Psych::SyntaxError, ArgumentError, Gem::EndOfYAMLException, Gem::Exception
  eval_gemspec(path, contents)
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-load_marshal"> <a href="#method-c-load_marshal" title="Link to this method"> <span class="method-name">load_marshal</span> <span class="method-args">(data, marshal_proc: nil)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="load_marshal-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 668
def load_marshal(data, marshal_proc: nil)
  Marshal.load(data, marshal_proc)
rescue TypeError =&gt; e
  raise MarshalError, "#{e.class}: #{e.message}"
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-tmp_home_path"> <a href="#method-c-tmp_home_path" title="Link to this method"> <span class="method-name">tmp_home_path</span> <span class="method-args">()</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="tmp_home_path-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 703
def tmp_home_path
  Kernel.send(:require, "tmpdir")
  SharedHelpers.filesystem_access(Dir.tmpdir) do
    path = Bundler.tmp
    at_exit { Bundler.rm_rf(path) }
    path
  end
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-unbundle_env"> <a href="#method-c-unbundle_env" title="Link to this method"> <span class="method-name">unbundle_env</span> <span class="method-args">(env)</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="unbundle_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 644
def unbundle_env(env)
  if env.key?("BUNDLER_ORIG_MANPATH")
    env["MANPATH"] = env["BUNDLER_ORIG_MANPATH"]
  end

  env.delete_if {|k, _| k[0, 7] == "BUNDLE_" }
  env.delete("BUNDLER_SETUP")

  if env.key?("RUBYOPT")
    rubyopt = env["RUBYOPT"].split(" ")
    rubyopt.delete("-r#{File.expand_path("bundler/setup", __dir__)}")
    rubyopt.delete("-rbundler/setup")
    env["RUBYOPT"] = rubyopt.join(" ")
  end

  if env.key?("RUBYLIB")
    rubylib = env["RUBYLIB"].split(File::PATH_SEPARATOR)
    rubylib.delete(__dir__)
    env["RUBYLIB"] = rubylib.join(File::PATH_SEPARATOR)
  end

  env
end</pre> </div>  </div> </div> <div class="method-detail anchor-link "> <div class="method-header"> <div class="method-heading" id="method-c-with_env"> <a href="#method-c-with_env" title="Link to this method"> <span class="method-name">with_env</span> <span class="method-args">(env) { || ... }</span> </a> </div> </div> <div class="method-controls"> <details class="method-source-toggle"> <summary>Source</summary> </details> </div> <div class="method-description">
<div class="method-source-code" id="with_env-source"> <pre class="ruby" data-language="ruby"># File lib/bundler.rb, line 713
def with_env(env)
  backup = ENV.to_hash
  ENV.replace(env)
  yield
ensure
  ENV.replace(backup)
end</pre> </div>  <p>@param env [Hash]</p> </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2024 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
