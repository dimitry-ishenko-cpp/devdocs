<div class="subsection-level-extent" id="Recovering-From-Errors"> <div class="nav-panel"> <p> Previous: <a href="catching-errors.html" accesskey="p" rel="prev">Catching Errors</a>, Up: <a href="handling-errors.html" accesskey="u" rel="up">Handling Errors</a> [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="concept-index.html" title="Index" rel="index">Index</a>]</p> </div>  <h1 class="subsection" id="Recovering-From-Errors-1"><span>12.1.3 Recovering From Errors<a class="copiable-link" href="#Recovering-From-Errors-1"> ¶</a></span></h1> <p>Octave provides several ways of recovering from errors. There are <code class="code">try</code>/<code class="code">catch</code> blocks, <code class="code">unwind_protect</code>/<code class="code">unwind_protect_cleanup</code> blocks, and finally the <code class="code">onCleanup</code> command. </p> <p>The <code class="code">onCleanup</code> command associates an ordinary Octave variable (the trigger) with an arbitrary function (the action). Whenever the Octave variable ceases to exist—whether due to a function return, an error, or simply because the variable has been removed with <code class="code">clear</code>—then the assigned function is executed. </p> <p>The function can do anything necessary for cleanup such as closing open file handles, printing an error message, or restoring global variables to their initial values. The last example is a very convenient idiom for Octave code. For example: </p> <pre class="example" data-language="matlab">function rand42
  old_state = rand ("state");
  restore_state = onCleanup (@() rand ("state", old_state));
  rand ("state", 42);
  ...
endfunction  # rand generator state restored by onCleanup</pre>  <dl class="first-deftypefn"> <dt class="deftypefn" id="index-onCleanup">
<span class="category-def">: </span><span><code class="def-type"><var class="var">obj</var> =</code> <strong class="def-name">onCleanup</strong> <code class="def-code-arguments">(<var class="var">function</var>)</code><a class="copiable-link" href="#index-onCleanup"> ¶</a></span>
</dt> <dd>
<p>Create a special object that executes a given <var class="var">function</var> upon destruction. </p> <p>If the object is copied to multiple variables (or cell or struct array elements) or returned from a function, then <var class="var">function</var> will be executed only after the last copy of the object is cleared. </p> <p>The input <var class="var">function</var> is a handle to a function. The handle may point to an anonymous function in order to directly place commands in the <code class="code">onCleanup</code> call. </p> <p>Programming Note: If multiple local <code class="code">onCleanup</code> variables are created, the order in which they are called is unspecified. For similar functionality See <a class="xref" href="the-unwind_005fprotect-statement.html">The unwind_protect Statement</a>. </p> <p>Example </p> <pre class="example" data-language="matlab">octave:1&gt; trigger = onCleanup (@() disp ('onCleanup was executed'));
octave:2&gt; clear trigger
onCleanup was executed
octave:3</pre> </dd>
</dl> </div>  <div class="nav-panel"> <p> Previous: <a href="catching-errors.html">Catching Errors</a>, Up: <a href="handling-errors.html">Handling Errors</a> [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="concept-index.html" title="Index" rel="index">Index</a>]</p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1996–2023 The Octave Project Developers<br>Permission is granted to make and distribute verbatim copies of this manual provided the copyright notice and this permission notice are preserved on all copies.<br/>Permission is granted to copy and distribute modified versions of this manual under the conditions for verbatim copying, provided that the entire resulting derived work is distributed under the terms of a permission notice identical to this one.</br>Permission is granted to copy and distribute translations of this manual into another language, under the above conditions for modified versions.<br>
    <a href="https://docs.octave.org/v9.2.0/Recovering-From-Errors.html" class="_attribution-link">https://docs.octave.org/v9.2.0/Recovering-From-Errors.html</a>
  </p>
</div>
