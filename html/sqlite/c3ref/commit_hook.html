      <h1>Commit And Rollback Notification Callbacks</h1>  <pre data-language="sql">
void *sqlite3_commit_hook(sqlite3*, int(*)(void*), void*);
void *sqlite3_rollback_hook(sqlite3*, void(*)(void *), void*);
</pre> <p> The sqlite3_commit_hook() interface registers a callback function to be invoked whenever a transaction is <a href="../lang_transaction.html">committed</a>. Any callback set by a previous call to sqlite3_commit_hook() for the same database connection is overridden. The sqlite3_rollback_hook() interface registers a callback function to be invoked whenever a transaction is <a href="../lang_transaction.html">rolled back</a>. Any callback set by a previous call to sqlite3_rollback_hook() for the same database connection is overridden. The pArg argument is passed through to the callback. If the callback on a commit hook function returns non-zero, then the commit is converted into a rollback.</p> <p>The sqlite3_commit_hook(D,C,P) and sqlite3_rollback_hook(D,C,P) functions return the P argument from the previous call of the same function on the same <a href="sqlite3.html">database connection</a> D, or NULL for the first call for each function on D.</p> <p>The commit and rollback hook callbacks are not reentrant. The callback implementation must not do anything that will modify the database connection that invoked the callback. Any actions to modify the database connection must be deferred until after the completion of the <a href="step.html">sqlite3_step()</a> call that triggered the commit or rollback hook in the first place. Note that running any other SQL statements, including SELECT statements, or merely calling <a href="prepare.html">sqlite3_prepare_v2()</a> and <a href="step.html">sqlite3_step()</a> will modify the database connections for the meaning of "modify" in this paragraph.</p> <p>Registering a NULL function disables the callback.</p> <p>When the commit hook callback routine returns zero, the <a href="../lang_transaction.html">COMMIT</a> operation is allowed to continue normally. If the commit hook returns non-zero, then the <a href="../lang_transaction.html">COMMIT</a> is converted into a <a href="../lang_transaction.html">ROLLBACK</a>. The rollback hook is invoked on a rollback that results from a commit hook returning non-zero, just as it would be with any other rollback.</p> <p>For the purposes of this API, a transaction is said to have been rolled back if an explicit "ROLLBACK" statement is executed, or an error or constraint causes an implicit rollback to occur. The rollback callback is not invoked if a transaction is automatically rolled back because the database connection is closed.</p> <p>See also the <a href="update_hook.html">sqlite3_update_hook()</a> interface. </p>
<p>See also lists of <a href="objlist.html">Objects</a>, <a href="constlist.html">Constants</a>, and <a href="funclist.html">Functions</a>.</p> <div class="_attribution">
  <p class="_attribution-p">
    SQLite is in the Public Domain.<br>
    <a href="https://sqlite.org/c3ref/commit_hook.html" class="_attribution-link">https://sqlite.org/c3ref/commit_hook.html</a>
  </p>
</div>
