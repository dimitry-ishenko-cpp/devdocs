<h1 id="_top" class="astro-556cgime">Authentication</h1> <div class="content-panel astro-ayt3hsza"> <div class="sl-container astro-ayt3hsza"> <div class="sl-markdown-content astro-klj6ju3r"> <p>Authentication and authorization are two security processes that manage access to your website or app. Authentication verifies a visitor’s identity, while authorization grants access to protected areas and resources.</p> <p>Authentication allows you to customize areas of your site for logged-in individuals and provides the greatest protection for personal or private information. Authentication libraries (e.g. <a href="https://lucia-auth.com/">Lucia Auth</a>, <a href="https://authjs.dev/">Auth.js</a>, <a href="https://clerk.com">Clerk</a>) provide utilities for multiple authentication methods such as email sign-in and OAuth providers.</p> <aside aria-label="Tip" class="starlight-aside starlight-aside--tip"><p class="starlight-aside__title" aria-hidden="true">Tip</p>
<section class="starlight-aside__content"><p>There is no official authentication solution for Astro, but you can find <a href="https://astro.build/integrations/?search=auth">community “auth” integrations</a> in the integrations directory.</p></section></aside> <div class="read-more astro-szj46hnz">  <span class="astro-szj46hnz">See how to <a href="../backend/supabase/index.html#adding-authentication-with-supabase">add authentication with Supabase</a> or <a href="../backend/google-firebase/index.html#adding-authentication-with-firebase">add authentication with Firebase</a> in our dedicated guides for these backend services.</span> </div> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="lucia">Lucia</h2></div> <p>Lucia is a framework-agnostic, session-based authentication library with great Astro support.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="installation">Installation</h3></div> <p>Install Lucia using the package manager of your choice.</p> <starlight-tabs data-sync-key="package-managers" class="astro-tx2opqu5"> <div class="tablist-wrapper not-content astro-tx2opqu5"> <ul role="tablist" class="astro-tx2opqu5"> <li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-151" id="tab-151" aria-selected="true" tabindex="0" class="astro-tx2opqu5"> npm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-152" id="tab-152" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> pnpm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-153" id="tab-153" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> Yarn </a> </li> </ul> </div> <section id="tab-panel-151" aria-labelledby="tab-151" role="tabpanel"> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">npm install lucia</pre>

</div> </section> <section id="tab-panel-152" aria-labelledby="tab-152" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">pnpm add lucia</pre>

</div> </section> <section id="tab-panel-153" aria-labelledby="tab-153" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">yarn add lucia</pre>

</div> </section> </starlight-tabs>  <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="configuration">Configuration</h3></div> <p>Use <a href="https://lucia-auth.com/getting-started/astro">Lucia’s “Getting started in Astro”</a> guide to initialize Lucia with an adapter and set up a database to store users and sessions.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="usage">Usage</h3></div> <aside aria-label="Tip" class="starlight-aside starlight-aside--tip"><p class="starlight-aside__title" aria-hidden="true">Tip</p>
<section class="starlight-aside__content"><p>Follow one of Lucia’s complete Astro tutorials to add <a href="https://lucia-auth.com/tutorials/username-and-password/astro">username and password authentication</a> or <a href="https://lucia-auth.com/tutorials/github-oauth/astro">GitHub OAuth</a> to your Astro project.</p></section></aside> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="next-steps">Next Steps</h3></div> <ul> <li><a href="https://github.com/lucia-auth/examples/tree/main/astro/github-oauth">Example Astro + Lucia OAuth project</a></li> <li><a href="https://github.com/lucia-auth/examples/tree/main/astro/username-and-password">Example Astro + Lucia username and password project</a></li> </ul> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="authjs">Auth.js</h2></div> <p>Auth.js is a framework agnostic solution for authentication. A community framework adapter <a href="https://www.npmjs.com/package/auth-astro"><code dir="auto">auth-astro</code></a> is available for Astro.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="installation-1">Installation</h3></div> <p>Use the <code dir="auto">astro add</code> command for your preferred package manager to add the <code dir="auto">auth-astro</code> integration.</p> <starlight-tabs data-sync-key="package-managers" class="astro-tx2opqu5"> <div class="tablist-wrapper not-content astro-tx2opqu5"> <ul role="tablist" class="astro-tx2opqu5"> <li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-154" id="tab-154" aria-selected="true" tabindex="0" class="astro-tx2opqu5"> npm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-155" id="tab-155" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> pnpm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-156" id="tab-156" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> Yarn </a> </li> </ul> </div> <section id="tab-panel-154" aria-labelledby="tab-154" role="tabpanel"> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">npx astro add auth-astro</pre>

</div> </section> <section id="tab-panel-155" aria-labelledby="tab-155" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">pnpm astro add auth-astro</pre>

</div> </section> <section id="tab-panel-156" aria-labelledby="tab-156" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">yarn astro add auth-astro</pre>

</div> </section> </starlight-tabs> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="manual-installation">Manual installation</h4></div> <p>To install <code dir="auto">auth-astro</code> manually, install the required package for your package manager:</p> <starlight-tabs data-sync-key="package-managers" class="astro-tx2opqu5"> <div class="tablist-wrapper not-content astro-tx2opqu5"> <ul role="tablist" class="astro-tx2opqu5"> <li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-157" id="tab-157" aria-selected="true" tabindex="0" class="astro-tx2opqu5"> npm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-158" id="tab-158" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> pnpm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-159" id="tab-159" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> Yarn </a> </li> </ul> </div> <section id="tab-panel-157" aria-labelledby="tab-157" role="tabpanel"> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">npm install auth-astro @auth/core@^0.18.6</pre>

</div> </section> <section id="tab-panel-158" aria-labelledby="tab-158" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">pnpm add auth-astro @auth/core@^0.18.6</pre>

</div> </section> <section id="tab-panel-159" aria-labelledby="tab-159" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">yarn add auth-astro @auth/core@^0.18.6</pre>

</div> </section> </starlight-tabs> <p>Then, apply the integration to your <code dir="auto">astro.config.*</code> file using the <code dir="auto">integrations</code> property:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">astro.config.mjs</span></div>
<pre data-language="ts">import { defineConfig } from 'astro/config';
import auth from 'auth-astro';


export default defineConfig({
  // ...
  integrations: [auth()],
});</pre>

</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="configuration-1">Configuration</h3></div> <p>Create an <code dir="auto">auth.config.mjs</code> file in your project’s root directory. Add any auth <a href="https://authjs.dev/getting-started/providers">providers</a> or methods you wish to support, along with any environment variables they require.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">auth.config.mjs</span></div>
<pre data-language="ts">import GitHub from '@auth/core/providers/github';
import { defineConfig } from 'auth-astro';


export default defineConfig({
  providers: [
    GitHub({
      clientId: import.meta.env.GITHUB_CLIENT_ID,
      clientSecret: import.meta.env.GITHUB_CLIENT_SECRET,
    }),
  ],
});</pre>

</div> <p>Create a <code dir="auto">.env</code> file in the root of your project if it does not already exist. Add the following two environment variables. <code dir="auto">AUTH_SECRET</code> should be a private string with a minimum of 32 characters.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">.env</span></div>
<pre data-language="sh">AUTH_TRUST_HOST=true
AUTH_SECRET=&lt;my-auth-secret&gt;</pre>

</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="usage-1">Usage</h3></div> <p>You can add sign-in and sign-out buttons using the <code dir="auto">auth-astro/client</code> module in a script tag or client-side framework component.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>
<pre data-language="astro">---
import Layout from 'src/layouts/Base.astro';
---
&lt;Layout&gt;
  &lt;button id="login"&gt;Login&lt;/button&gt;
  &lt;button id="logout"&gt;Logout&lt;/button&gt;


  &lt;script&gt;
    const { signIn, signOut } = await import("auth-astro/client")
    document.querySelector("#login").onclick = () =&gt; signIn("github")
    document.querySelector("#logout").onclick = () =&gt; signOut()
  &lt;/script&gt;
&lt;/Layout&gt;</pre>

</div> <p>You can fetch the user’s session using the <code dir="auto">getSession</code> method.</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>
<pre data-language="astro">---
import Layout from 'src/layouts/Base.astro';
import { getSession } from 'auth-astro/server';


const session = await getSession(Astro.request);
---
&lt;Layout&gt;
  {
    session ? (
      &lt;p&gt;Welcome {session.user?.name}&lt;/p&gt;
    ) : (
      &lt;p&gt;Not logged in&lt;/p&gt;
    )
  }
&lt;/Layout&gt;</pre>

</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="next-steps-1">Next Steps</h3></div> <ul> <li><a href="https://github.com/nowaythatworked/auth-astro?tab=readme-ov-file#auth-astro"><code dir="auto">auth-astro</code> on GitHub</a></li> <li><a href="https://authjs.dev/">Auth.js documentation</a></li> </ul> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="clerk">Clerk</h2></div> <p>Clerk is a complete suite of embeddable UIs, flexible APIs, and admin dashboards to authenticate and manage your users. An <a href="https://clerk.com/docs/references/astro/overview">official Clerk SDK for Astro</a> is available.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="installation-2">Installation</h3></div> <p>Install <code dir="auto">@clerk/astro</code> using the package manager of your choice.</p> <starlight-tabs data-sync-key="package-managers" class="astro-tx2opqu5"> <div class="tablist-wrapper not-content astro-tx2opqu5"> <ul role="tablist" class="astro-tx2opqu5"> <li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-160" id="tab-160" aria-selected="true" tabindex="0" class="astro-tx2opqu5"> npm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-161" id="tab-161" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> pnpm </a> </li>
<li role="presentation" class="tab astro-tx2opqu5"> <a role="tab" href="#tab-panel-162" id="tab-162" aria-selected="false" tabindex="-1" class="astro-tx2opqu5"> Yarn </a> </li> </ul> </div> <section id="tab-panel-160" aria-labelledby="tab-160" role="tabpanel"> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">npm install @clerk/astro</pre>

</div> </section> <section id="tab-panel-161" aria-labelledby="tab-161" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">pnpm add @clerk/astro</pre>

</div> </section> <section id="tab-panel-162" aria-labelledby="tab-162" role="tabpanel" hidden> <div class="expressive-code">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>
<pre data-language="shell">yarn add @clerk/astro</pre>

</div> </section> </starlight-tabs> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="configuration-2">Configuration</h3></div> <p>Follow <a href="https://clerk.com/docs/quickstarts/astro">Clerk’s own Astro Quickstart guide</a> to set up Clerk integration and middleware in your Astro project.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="usage-2">Usage</h3></div> <p>Clerk provides components that allow you to control the visibility of pages based on your user’s authentication state. Show logged out users a sign in button instead of the content available to users who are logged in:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>
<pre data-language="astro">---
import Layout from 'src/layouts/Base.astro';
import { SignedIn, SignedOut, UserButton, SignInButton } from '@clerk/astro/components';
---


&lt;Layout&gt;
    &lt;SignedIn&gt;
        &lt;UserButton /&gt;
    &lt;/SignedIn&gt;
    &lt;SignedOut&gt;
        &lt;SignInButton /&gt;
    &lt;/SignedOut&gt;
&lt;/Layout&gt;</pre>

</div> <p>Clerk also allows you to protect routes on the server using middleware. Specify which routes are protected, and prompt unauthenticated users to sign in:</p> <div class="expressive-code">
<div class="_pre-heading"><span class="title">src/middleware.ts</span></div>
<pre data-language="ts">import { clerkMiddleware, createRouteMatcher } from '@clerk/astro/server';


const isProtectedRoute = createRouteMatcher([
  '/dashboard(.*)',
  '/forum(.*)',
]);


export const onRequest = clerkMiddleware((auth, context) =&gt; {
  if (!auth().userId &amp;&amp; isProtectedRoute(context.request)) {
    return auth().redirectToSignIn();
  }
});</pre>

</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="next-steps-2">Next Steps</h3></div> <ul> <li>Read the <a href="https://clerk.com/docs/references/astro/overview">official <code dir="auto">@clerk/astro</code> documentation</a>
</li> <li>Start from a template with the <a href="https://github.com/clerk/clerk-astro-quickstart">Clerk + Astro Quickstart project</a>
</li> </ul> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="community-resources">Community Resources</h2></div> <ul> <li><a href="https://agramont.net/blog/entra-id-easyauth-with-astro/">Using Microsoft Entra Id EasyAuth with Astro and Azure Static Web App</a></li> </ul> <span id="docsearch-lvl0" hidden class="astro-klj6ju3r">Learn</span> </div>   </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/guides/authentication/" class="_attribution-link">https://docs.astro.build/en/guides/authentication/</a>
  </p>
</div>
