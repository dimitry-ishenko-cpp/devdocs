<h1 class="content-title astro-j75b3yus" id="overview">Kontent.ai &amp; Astro</h1> <p><a href="https://www.kontent.ai/">Kontent.ai</a> is a headless CMS that allows you to manage content in a structured and modular way, supported by AI capabilities.</p> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="integrating-with-astro">Integrating with Astro</h2></div> <p>In this section, you’ll use the <a href="https://github.com/kontent-ai/delivery-sdk-js">Kontent.ai TypeScript SDK</a> to connect your Kontent.ai project to your Astro application.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="prerequisites">Prerequisites</h3></div> <p>To get started, you’ll need the following:</p> <ol> <li> <p><strong>Kontent.ai project</strong> - If you don’t have a Kontent.ai account yet, <a href="https://app.kontent.ai/sign-up">sign up for free</a> and create a new project.</p> </li> <li> <p><strong>Delivery API keys</strong> - You will need the Environment ID for published content and the Preview API key for fetching drafts (optional). Both keys are located in the <strong>Environment Settings -&gt; API keys</strong> tab in Kontent.ai.</p> </li> </ol> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="setting-up-credentials">Setting up credentials</h3></div> <p>To add your Kontent.ai credentials to Astro, create a <code>.env</code> file in the root of your project with the following variables:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">.env</span></div>


</div> <p>Now, these environment variables can be used in your Astro project.</p> <p>If you would like to get <a href="../../environment-variables/index.html#intellisense-for-typescript">TypeScript IntelliSense for these environment variables</a>, you can create a new <code>env.d.ts</code> file in the <code>src/</code> directory and configure <code>ImportMetaEnv</code> like this:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/env.d.ts</span></div>


</div> <p>Your root directory should now include these new files:</p> <docs-file-tree><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>src/ </span> </span></summary><ul><li class="file" data-filetype="ts"><span class="tree-entry"><span class="highlight"><strong>env.d.ts</strong></span></span></li></ul></details></li>
<li class="file" data-filetype="env"><span class="tree-entry"><span class="highlight"><strong>.env</strong></span></span></li>
<li class="file" data-filetype="mjs"><span class="tree-entry"><span class="">astro.config.mjs</span> </span></li>
<li class="file" data-filetype="json"><span class="tree-entry"><span class="">package.json</span> </span></li>
</ul></docs-file-tree> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="installing-dependencies">Installing dependencies</h3></div> <p>To connect Astro with your Kontent.ai project, install the <a href="https://github.com/kontent-ai/delivery-sdk-js">Kontent.ai TypeScript SDK</a>:</p> <astro-island uid="10rJih" component-url="/_astro/Tabs.3d721b18.js" component-export="default" renderer-url="/_astro/client.d87097da.js" props='{"sharedStore":[0,"package-managers"]}' ssr="" client="idle" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_1kkny_1">
<div class="_tab-scroll-overflow_1kkny_6"><div class="_tablist_1kkny_30 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_1kkny_6" id="76-tab.npm"><astro-slot name="tab.npm">npm</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_1kkny_6" id="76-tab.pnpm"><astro-slot name="tab.pnpm">pnpm</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_1kkny_6" id="76-tab.yarn"><astro-slot name="tab.yarn">Yarn</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="76-tab.npm" class="_tabpanel_1kkny_26"><astro-slot name="panel.npm"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="76-tab.pnpm" class="_tabpanel_1kkny_26"><astro-slot name="panel.pnpm"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="76-tab.yarn" class="_tabpanel_1kkny_26"><astro-slot name="panel.yarn"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
</div></astro-island> <p>Next, create a new file called <code>kontent.ts</code> in the <code>src/lib/</code> directory of your Astro project.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/lib/kontent.ts</span></div>


</div> <aside class="content note astro-duqfclob" aria-label="Note"> <p class="title astro-duqfclob" aria-hidden="true">  Note </p> <section class="astro-duqfclob"> <p>Read more on <a href="../../environment-variables/index.html#getting-environment-variables">getting environment variables in Astro</a>.</p> </section> </aside> <p>This implementation creates a new <code>DeliveryClient</code> object using credentials from the <code>.env</code> file.</p> <aside class="content note astro-duqfclob" aria-label="previews"> <p class="title astro-duqfclob" aria-hidden="true">  previews </p> <section class="astro-duqfclob"> <p>The <code>previewApiKey</code> is optional. When used, you can <a href="https://github.com/kontent-ai/delivery-sdk-js#enable-preview-mode-per-query">configure each query</a> to the Delivery API endpoint to return the latest versions of content items regardless of their state in the workflow. Otherwise, only published items are returned.</p> </section> </aside> <p>Finally, the root directory of your Astro project should now include these new files:</p> <docs-file-tree><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>src/ </span> </span></summary><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>lib/ </span> </span></summary><ul><li class="file" data-filetype="ts"><span class="tree-entry"><span class="highlight"><strong>kontent.ts</strong></span></span></li></ul></details></li>
<li class="file" data-filetype="ts"><span class="tree-entry"><span class="">env.d.ts</span> </span></li>
</ul></details></li>
<li class="file" data-filetype="env"><span class="tree-entry"><span class="">.env</span> </span></li>
<li class="file" data-filetype="mjs"><span class="tree-entry"><span class="">astro.config.mjs</span> </span></li>
<li class="file" data-filetype="json"><span class="tree-entry"><span class="">package.json</span> </span></li>
</ul></docs-file-tree> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="fetching-data">Fetching data</h3></div> <p>The <code>DeliveryClient</code> is now available to all components. To fetch content, use the <code>DeliveryClient</code> and method chaining to define your desired items. This example shows a basic fetch of blog posts and renders their titles in a list:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>


</div> <p>You can find more querying options in the <a href="https://kontent.ai/learn/develop/hello-world/get-content/javascript">Kontent.ai documentation</a>.</p> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="making-a-blog-with-astro-and-kontentai">Making a blog with Astro and Kontent.ai</h2></div> <p>With the setup above, you are now able to create a blog that uses Kontent.ai as the source of content.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="prerequisites-1">Prerequisites</h3></div> <ol> <li> <p><strong>Kontent.ai project</strong> - For this tutorial, using a blank project is recommended. If you already have some content types in your content model, you may use them, but you will need to modify the code snippets to match your content model.</p> </li> <li> <p><strong>Astro project configured for content fetching from Kontent.ai</strong> - see above for more details on how to set up an Astro project with Kontent.ai</p> </li> </ol> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="setting-up-content-model">Setting up content model</h3></div> <p>In Kontent.ai, navigate to <strong>Content model</strong> and create a new content type with the following fields and values:</p> <ul> <li>
<strong>Name:</strong> Blog Post</li> <li>Elements: <ul> <li>Text field <ul> <li>
<strong>Name:</strong> Title</li> <li>
<strong>Element Required:</strong> yes</li> </ul> </li> <li>Rich text field <ul> <li>
<strong>Name:</strong> Teaser</li> <li>
<strong>Element Required:</strong> yes</li> <li>
<strong>Allowed in this element:</strong> only check Text</li> </ul> </li> <li>Rich text field <ul> <li>
<strong>Name:</strong> Content</li> <li>
<strong>Element Required:</strong> yes</li> </ul> </li> <li>Date &amp; time field <ul> <li>
<strong>Name:</strong> Date</li> </ul> </li> <li>URL slug field <ul> <li>
<strong>Name:</strong> URL slug</li> <li>
<strong>Element Required:</strong> yes</li> <li>
<strong>Auto-generate from:</strong> select “Title”</li> </ul> </li> </ul> </li> </ul> <p>Then, click on <strong>Save Changes</strong>.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="creating-content">Creating content</h3></div> <p>Now, navigate to <strong>Content &amp; assets</strong> tab and create a new content item of type <strong>Blog Post</strong>. Fill the fields using these values:</p> <ul> <li>
<strong>Content item name:</strong> Astro</li> <li>
<strong>Title:</strong> Astro is amazing</li> <li>
<strong>Teaser:</strong> Astro is an all-in-one framework for building fast websites faster.</li> <li>
<strong>Content:</strong> You can use JavaScript to implement the website functionality, but no client bundle is necessary.</li> <li>
<strong>Date &amp; time:</strong> select today</li> <li>
<strong>URL slug:</strong> astro-is-amazing</li> </ul> <p>When you’re finished, publish the blog post using the <strong>Publish</strong> button at the top.</p> <p><em>Note: Feel free to create as many blog posts as you like before moving to the next step.</em></p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="generating-content-model-in-typescript">Generating content model in TypeScript</h3></div> <p>Next, you’ll generate TypeScript types out of your content model.</p> <aside class="content note astro-duqfclob" aria-label="Note"> <p class="title astro-duqfclob" aria-hidden="true">  Note </p> <section class="astro-duqfclob"> <p>This step is optional but provides a much better developer experience and allows you to discover potential problems at build time rather than at runtime.</p> </section> </aside> <p>First, install the <a href="https://github.com/kontent-ai/model-generator-js">Kontent.ai JS model generator</a>, <a href="https://github.com/TypeStrong/ts-node">ts-node</a>, and <a href="https://github.com/motdotla/dotenv">dotenv</a>:</p> <astro-island uid="ZK48TT" component-url="/_astro/Tabs.3d721b18.js" component-export="default" renderer-url="/_astro/client.d87097da.js" props='{"sharedStore":[0,"package-managers"]}' ssr="" client="idle" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_1kkny_1">
<div class="_tab-scroll-overflow_1kkny_6"><div class="_tablist_1kkny_30 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_1kkny_6" id="77-tab.npm"><astro-slot name="tab.npm">npm</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_1kkny_6" id="77-tab.pnpm"><astro-slot name="tab.pnpm">pnpm</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_1kkny_6" id="77-tab.yarn"><astro-slot name="tab.yarn">Yarn</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="77-tab.npm" class="_tabpanel_1kkny_26"><astro-slot name="panel.npm"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="77-tab.pnpm" class="_tabpanel_1kkny_26"><astro-slot name="panel.pnpm"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="77-tab.yarn" class="_tabpanel_1kkny_26"><astro-slot name="panel.yarn"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
</div></astro-island> <p>Then, add the following script to package.json:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">package.json</span></div>


</div> <p>Because the types require structural information about your project that is not available in the public API, you also need to add a Content Management API key to the <code>.env</code> file. You can generate the key under <strong>Environment settings -&gt; API keys -&gt; Management API</strong>.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">.env</span></div>


</div> <p>Finally, add the script <code>generate-models.ts</code> that configures the model generator to generate the models:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">generate-models.ts</span></div>


</div> <p>Now, execute it:</p> <astro-island uid="Z1kaaTE" component-url="/_astro/Tabs.3d721b18.js" component-export="default" renderer-url="/_astro/client.d87097da.js" props='{"sharedStore":[0,"package-managers"]}' ssr="" client="idle" opts='{"name":"Tabs","value":true}' await-children=""><div class="_container_1kkny_1">
<div class="_tab-scroll-overflow_1kkny_6"><div class="_tablist_1kkny_30 TabGroup no-flex" role="tablist">
<button aria-selected="true" tabindex="0" role="tab" type="button" class="_tab_1kkny_6" id="78-tab.npm"><astro-slot name="tab.npm">npm</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_1kkny_6" id="78-tab.pnpm"><astro-slot name="tab.pnpm">pnpm</astro-slot></button><button aria-selected="false" tabindex="-1" role="tab" type="button" class="_tab_1kkny_6" id="78-tab.yarn"><astro-slot name="tab.yarn">Yarn</astro-slot></button>
</div></div>
<div role="tabpanel" aria-labelledby="78-tab.npm" class="_tabpanel_1kkny_26"><astro-slot name="panel.npm"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="78-tab.pnpm" class="_tabpanel_1kkny_26"><astro-slot name="panel.pnpm"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
<div hidden role="tabpanel" aria-labelledby="78-tab.yarn" class="_tabpanel_1kkny_26"><astro-slot name="panel.yarn"> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> </astro-slot></div>
</div></astro-island> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="displaying-a-list-of-blog-posts">Displaying a list of blog posts</h3></div> <p>Now you’re ready to fetch some content. Go to the Astro page where you want to display a list of all blog posts, for example, the homepage <code>index.astro</code> in <code>src/pages</code>.</p> <p>Fetch all blog posts in the frontmatter of the Astro page:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>


</div> <p>If you skipped the model generation, you can also use an untyped object and string literal to define the type:</p>  <p>The fetch call will return a <code>response</code> object which contains a list of all blog posts in <code>data.items</code>. In the HTML section of the Astro page, you can use the <code>map()</code> function to list the blog posts:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>


</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="generating-individual-blog-posts">Generating individual blog posts</h3></div> <p>The last step of the tutorial is to generate detailed blog post pages.</p> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="static-site-generation">Static site generation</h4></div> <p>In this section, you’ll use the <a href="../../../core-concepts/routing/index.html#static-ssg-mode">Static (SSG) Mode</a> with Astro.</p> <p>First, create a file <code>[slug].astro</code> in <code>/src/pages/blog/</code> which needs to export a function <code>getStaticPaths</code> that collects all data from the CMS:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/blog/[slug].astro</span></div>


</div> <p>So far, the function fetches all blog posts from Kontent.ai. The code snippet is exactly the same as what you used on the home page.</p> <p>Next, the function must export paths and data for each blog post. You named the file <code>[slug].astro</code>, so the param which represents the URL slug is called <code>slug</code>:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/blog/[slug].astro</span></div>


</div> <p>The last part is to provide the HTML template and display each blog post:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/blog/[slug].astro</span></div>


</div> <p>Navigate to your Astro preview (<a href="http://localhost:4321/blog/astro-is-amazing/">http://localhost:4321/blog/astro-is-amazing/</a> by default) to see the rendered blog post.</p> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="server-side-rendering">Server-side rendering</h4></div> <p>If you’ve opted into SSR mode, you will use dynamic routes to fetch the page data from Kontent.ai.</p> <p>Create a new file <code>[slug].astro</code> in <code>/src/pages/blog/</code> and add the following code. The data fetching is very similar to previous use cases but adds an <code>equalsFilter</code> that lets us find the right blog post based on the used URL:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/blog/[slug].astro</span></div>


</div> <p>If you’re not using generated types, you can instead use string literals to define the content item type and the filtered element codename:</p>  <p>Lastly, add the HTML code to render the blog post. This part is the same as with static generation:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/blog/[slug].astro</span></div>


</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="publishing-your-site">Publishing your site</h3></div> <p>To deploy your website, visit the <a href="../../deploy/index.html">deployment guides</a> and follow the instructions for your preferred hosting provider.</p> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="rebuild-on-kontentai-changes">Rebuild on Kontent.ai changes</h4></div> <p>If your project is using Astro’s default static mode, you will need to set up a webhook to trigger a new build when your content changes. If you are using Netlify or Vercel as your hosting provider, you can use its webhook feature to trigger a new build from Kontent.ai events.</p> <div tabindex="-1" class="heading-wrapper level-h5"><h5 id="netlify">Netlify</h5></div> <p>To set up a webhook in Netlify:</p> <ol> <li>Go to your site dashboard and click on <strong>Build &amp; deploy</strong>.</li> <li>Under the <strong>Continuous Deployment</strong> tab, find the <strong>Build hooks</strong> section and click on <strong>Add build hook</strong>.</li> <li>Provide a name for your webhook and select the branch you want to trigger the build on. Click on <strong>Save</strong> and copy the generated URL.</li> </ol> <div tabindex="-1" class="heading-wrapper level-h5"><h5 id="vercel">Vercel</h5></div> <p>To set up a webhook in Vercel:</p> <ol> <li>Go to your project dashboard and click on <strong>Settings</strong>.</li> <li>Under the <strong>Git</strong> tab, find the <strong>Deploy Hooks</strong> section.</li> <li>Provide a name for your webhook and the branch you want to trigger the build on. Click <strong>Add</strong> and copy the generated URL.</li> </ol> <p>Adding a webhook to Kontent.ai</p> <p>In the <a href="https://kontent.ai/learn/docs/webhooks/javascript">Kontent.ai app</a>, go to <strong>Environment settings -&gt; Webhooks</strong>. Click on <strong>Create new webhook</strong> and provide a name for your new webhook. Paste in the URL you copied from Netlify or Vercel and select which events should trigger the webhook. By default, for rebuilding your site when published content changes, you only need <strong>Publish</strong> and <strong>Unpublish</strong> events under <strong>Delivery API triggers</strong>. When you’re finished, click on Save.</p> <p>Now, whenever you publish a new blog post in Kontent.ai, a new build will be triggered and your blog will be updated.</p> <h2 class="astro-ngaa6bbg">More CMS guides</h2><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/guides/cms/kontent-ai/" class="_attribution-link">https://docs.astro.build/en/guides/cms/kontent-ai/</a>
  </p>
</div>
