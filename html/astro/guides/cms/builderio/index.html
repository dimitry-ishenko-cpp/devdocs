<h1 class="content-title astro-j75b3yus" id="overview">Builder.io &amp; Astro</h1> <p><a href="https://www.builder.io/">Builder.io</a> is a visual CMS that supports drag-and-drop content editing for building websites.</p> <p>This recipe will show you how to connect your Builder space to Astro with zero client-side JavaScript.</p> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="prerequisites">Prerequisites</h2></div> <p>To get started, you will need to have the following:</p> <ul> <li>
<strong>A Builder account and space</strong> - If you don’t have an account yet, <a href="https://www.builder.io/">sign up for free</a> and create a new space. If you already have a space with Builder, feel free to use it, but you will need to modify the code to match the model name (<code>blogpost</code>) and custom data fields.</li> <li>
<strong>A Builder API key</strong> - This public key will be used to fetch your content from Builder. <a href="https://www.builder.io/c/docs/using-your-api-key#finding-your-public-api-key">Read Builder’s guide on how to find your key</a>.</li> </ul> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="setting-up-credentials">Setting up credentials</h2></div> <p>To add your Builder API key and your Builder model name to Astro, create a <code>.env</code> file in the root of your project (if one does not already exist) and add the following variables:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">.env</span></div>


</div> <p>Now, you should be able to use this API key in your project.</p> <aside class="content note astro-duqfclob" aria-label="Note"> <p class="title astro-duqfclob" aria-hidden="true">  Note </p> <section class="astro-duqfclob"> <p>At the time of writing, <a href="https://www.builder.io/c/docs/using-your-api-key#prerequisites">this key is public</a>, so you don’t have to worry about hiding or encrypting it.</p> </section> </aside> <p>If you would like to have IntelliSense for your environment variables, you can create a <code>env.d.ts</code> file in the <code>src/</code> directory and configure <code>ImportMetaEnv</code> like this:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/env.d.ts</span></div>


</div> <p>Your project should now include these files:</p> <docs-file-tree><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>src/ </span> </span></summary><ul><li class="file" data-filetype="ts"><span class="tree-entry"><span class="highlight"><strong>env.d.ts</strong></span></span></li></ul></details></li>
<li class="file" data-filetype="env"><span class="tree-entry"><span class="highlight"><strong>.env</strong></span></span></li>
<li class="file" data-filetype="mjs"><span class="tree-entry"><span class="">astro.config.mjs</span> </span></li>
<li class="file" data-filetype="json"><span class="tree-entry"><span class="">package.json</span> </span></li>
</ul></docs-file-tree> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="making-a-blog-with-astro-and-builder">Making a blog with Astro and Builder</h2></div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="creating-a-model-for-a-blog-post">Creating a model for a blog post</h3></div> <p>The instructions below create an Astro blog using a Builder model (Type: “Section”) called <code>blogpost</code> that contains two required text fields: <code>title</code> and <code>slug</code>.</p> <aside class="content tip astro-duqfclob" aria-label="For visual types"> <p class="title astro-duqfclob" aria-hidden="true">  For visual types </p> <section class="astro-duqfclob"> <p>You can find videos showing this procedure in one of <a href="https://www.builder.io/blog/creating-blog#creating-a-blog-article-model">Builder’s official tutorials</a>.</p> </section> </aside> <p>In the Builder app create the model that will represent a blog post: go to the <strong>Models</strong> tab and click the <strong>+ Create Model</strong> button to create model with the following fields and values:</p> <ul> <li>
<strong>Type:</strong> Section</li> <li>
<strong>Name:</strong> “blogpost”</li> <li>
<strong>Description:</strong> “This model is for a blog post”</li> </ul> <p>In your new model use the <strong>+ New Custom Field</strong> button to create 2 new fields:</p> <ol> <li> <p>Text field</p> <ul> <li>
<strong>Name:</strong> “title”</li> <li>
<strong>Required:</strong> Yes</li> <li>
<strong>Default value</strong> “I forgot to give this a title”</li> </ul> <p>(leave the other parameters as their defaults)</p> </li> <li> <p>Text field</p> <ul> <li>
<strong>Name:</strong> “slug”</li> <li>
<strong>Required:</strong> Yes</li> <li>
<strong>Default value</strong> “some-slugs-take-their-time”</li> </ul> <p>(leave the other parameters as their defaults)</p> </li> </ol> <p>Then click the <strong>Save</strong> button in the upper right.</p> <aside class="content caution astro-duqfclob" aria-label="slugs"> <p class="title astro-duqfclob" aria-hidden="true">  slugs </p> <section class="astro-duqfclob"> <p>There are some pitfalls with the <code>slug</code> field:</p>
<ul> <li> <p>Make sure your slug is not just a number. This seems to break the fetch request to Builder’s API.</p> </li> <li> <p>Make sure your slugs are unique, since your site’s routing will depend on that.</p> </li> </ul> </section> </aside> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="setting-up-the-preview">Setting up the preview</h3></div> <p>To use Builder’s visual editor, create the page <code>src/pages/builder-preview.astro</code> that will render the special <code>&lt;builder-component&gt;</code>:</p> <docs-file-tree><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>src/ </span> </span></summary><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>pages/ </span> </span></summary><ul><li class="file" data-filetype="astro"><span class="tree-entry"><span class="highlight"><strong>builder-preview.astro</strong></span></span></li></ul></details></li>
<li class="file" data-filetype="ts"><span class="tree-entry"><span class="">env.d.ts</span> </span></li>
</ul></details></li>
<li class="file" data-filetype="env"><span class="tree-entry"><span class="">.env</span> </span></li>
<li class="file" data-filetype="mjs"><span class="tree-entry"><span class="">astro.config.mjs</span> </span></li>
<li class="file" data-filetype="json"><span class="tree-entry"><span class="">package.json</span> </span></li>
</ul></docs-file-tree> <p>Then add the following content:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/builder-preview.astro</span></div>


</div> <p>In the above example, <code>&lt;builder-component&gt;</code> tells Builder where to insert the content from its CMS.</p> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="setting-the-new-route-as-the-preview-url">Setting the new route as the preview URL</h4></div> <ol> <li> <p>Copy the full URL of your preview, including the protocol, to your clipboard (e.g. <code>https://{your host}/builder-preview</code>).</p> </li> <li> <p>Go to the <strong>Models</strong> tab in your Builder space, pick the model you’ve created and paste the URL from step 1 into the <strong>Preview URL</strong> field. Make sure the URL is complete and includes the protocol, for example <code>https://</code>.</p> </li> <li> <p>Click the <strong>Save</strong> button in the upper right.</p> </li> </ol> <aside class="content tip astro-duqfclob" aria-label="Tip"> <p class="title astro-duqfclob" aria-hidden="true">  Tip </p> <section class="astro-duqfclob"> <p>When you deploy your site, change the preview URL to match your production URL, for example <code>https://myAwesomeAstroBlog.com/builder-preview</code>.</p> </section> </aside> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="testing-the-preview-url-setup">Testing the preview URL setup</h4></div> <ol> <li> <p>Make sure your site is live (e.g. your dev server is running) and the <code>/builder-preview</code> route is working.</p> </li> <li> <p>In your Builder space under the <strong>Content</strong> tab, click on <strong>New</strong> to create a new content entry for your <code>blogpost</code> model.</p> </li> <li> <p>In the Builder editor that just opened, you should be able to see the <code>builder-preview.astro</code> page with a big <strong>Add Block</strong> in the middle.</p> </li> </ol> <aside class="content tip astro-duqfclob" aria-label="Troubleshooting"> <p class="title astro-duqfclob" aria-hidden="true">  Troubleshooting </p> <section class="astro-duqfclob"> <p>Things can sometimes go wrong when setting up the preview. If something’s not right, you can try one of these things:</p>
<ul> <li>Make sure the site is live - for example, your dev server is running.</li> <li>Make sure that the URLs match exactly - the one in your Astro project and the one set in the Builder app.</li> <li>Make sure it’s the full URL including the protocol, for example <code>https://</code>.</li> <li>If you’re working in a virtual environment like <a href="https://stackblitz.com/">StackBlitz</a> or <a href="https://www.gitpod.io/">Gitpod</a>, you might have to copy and paste the URL again when you restart your workspace, since this usually generates a new URL for your project.</li> </ul>
<p>For more ideas, read <a href="https://www.builder.io/c/docs/guides/preview-url-working">Builder’s troubleshooting guide</a>.</p> </section> </aside> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="creating-a-blog-post">Creating a blog post</h3></div> <ol> <li>In Builder’s visual editor, create a new content entry with the following values: <ul> <li>
<strong>title:</strong> ‘First post, woohoo!’</li> <li>
<strong>slug:</strong> ‘first-post-woohoo’</li> </ul> </li> <li>Complete your post using the <strong>Add Block</strong> button and add a text field with some post content.</li> <li>In the text field above the editor, give your entry a name. This is how it will be listed in the Builder app.</li> <li>When you’re ready click the <strong>Publish</strong> button in the upper right corner.</li> <li>Create as many posts as you like, ensuring that all content entries contain a <code>title</code> and a <code>slug</code> as well as some post content.</li> </ol> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="displaying-a-list-of-blog-posts">Displaying a list of blog posts</h3></div> <p>Add the following content to <code>src/pages/index.astro</code> in order to fetch and display a list of all post titles, each linking to its own page:</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/index.astro</span></div>


</div> <p>Fetching via the content API returns an array of objects containing data for each post. The <code>fields</code> query parameter tells Builder which data is included (see highlighted code). <code>slug</code> and <code>title</code> should match the names of the custom data fields you’ve added to your Builder model.</p> <p>The <code>posts</code> array returned from the fetch displays a list of blog post titles on the home page. The individual page routes will be created in the next step.</p> <aside class="content tip astro-duqfclob" aria-label="framework integrations"> <p class="title astro-duqfclob" aria-hidden="true">  framework integrations </p> <section class="astro-duqfclob"> <p>If you are using a JavaScript framework (e.g. Svelte, Vue, or React) in your Astro project you can use <a href="https://www.builder.io/m/integrations">one of Builder’s integrations</a> as an alternative to making raw fetch calls through the REST API.</p> </section> </aside> <p>Go to your index route and you should be able to see a list of links each with the title of a blog post!</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="displaying-a-single-blog-post">Displaying a single blog post</h3></div> <p>Create the page <code>src/pages/posts/[slug].astro</code> that will <a href="../../../core-concepts/routing/index.html#dynamic-routes">dynamically generate a page</a> for each post.</p> <docs-file-tree><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>src/ </span> </span></summary><ul>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>pages/ </span> </span></summary><ul>
<li class="file" data-filetype="astro"><span class="tree-entry"><span class="">index.astro</span> </span></li>
<li class="directory" data-filetype="dir"><details open><summary><span class="tree-entry"><span class=""><span><span class="sr-only">Directory</span></span>posts/ </span> </span></summary><ul><li class="file" data-filetype="astro"><span class="tree-entry"><span class="highlight"><strong>[slug].astro</strong></span></span></li></ul></details></li>
</ul></details></li>
<li class="file" data-filetype="ts"><span class="tree-entry"><span class="">env.d.ts</span> </span></li>
</ul></details></li>
<li class="file" data-filetype="env"><span class="tree-entry"><span class="">.env</span> </span></li>
<li class="file" data-filetype="mjs"><span class="tree-entry"><span class="">astro.config.mjs</span> </span></li>
<li class="file" data-filetype="json"><span class="tree-entry"><span class="">package.json</span> </span></li>
</ul></docs-file-tree> <p>This file must contain:</p> <ul> <li>A <a href="../../../reference/api-reference/index.html#getstaticpaths"><code>getStaticPaths()</code></a> function to fetch <code>slug</code> information from Builder and create a static route for each blog post.</li> <li>A <code>fetch()</code> to the Builder API using the <code>slug</code> identifier to return post content and metadata (e.g. a <code>title</code>).</li> <li>A <code>&lt;Fragment /&gt;</code> in the template to render the post content as HTML.</li> </ul> <p>Each of these is highlighted in the following code snippet.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">src/pages/posts/[slug].astro</span></div>


</div> <aside class="content note astro-duqfclob" aria-label="Note"> <p class="title astro-duqfclob" aria-hidden="true">  Note </p> <section class="astro-duqfclob"> <p>The variables <code>builderModel</code> and <code>builderAPIpublicKey</code> need to be created twice, since <a href="../../../reference/api-reference/index.html#getstaticpaths"><code>getStaticPaths()</code> runs in its own isolated scope</a>.</p> </section> </aside> <p>Now when you click on a link on your index route, you will be taken to the individual blog post page.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="publishing-your-site">Publishing your site</h3></div> <p>To deploy your website, visit our <a href="../../deploy/index.html">deployment guides</a> and follow the instructions for your preferred hosting provider.</p> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="rebuild-on-builder-changes">Rebuild on Builder changes</h4></div> <p>If your project is using Astro’s default static mode, you will need to set up a webhook to trigger a new build when your content changes. If you are using Netlify or Vercel as your hosting provider, you can use its webhook feature to trigger a new build whenever you click <strong>Publish</strong> in the Builder editor.</p> <div tabindex="-1" class="heading-wrapper level-h5"><h5 id="netlify">Netlify</h5></div> <ol> <li>Go to your site dashboard, then <strong>Site Settings</strong> and click on <strong>Build &amp; deploy</strong>.</li> <li>Under the <strong>Continuous Deployment</strong> tab, find the <strong>Build hooks</strong> section and click on <strong>Add build hook</strong>.</li> <li>Provide a name for your webhook and select the branch you want to trigger the build on. Click on <strong>Save</strong> and copy the generated URL.</li> </ol> <div tabindex="-1" class="heading-wrapper level-h5"><h5 id="vercel">Vercel</h5></div> <ol> <li>Go to your project dashboard and click on <strong>Settings</strong>.</li> <li>Under the <strong>Git</strong> tab, find the <strong>Deploy Hooks</strong> section.</li> <li>Provide a name for your webhook and the branch you want to trigger the build on. Click <strong>Add</strong> and copy the generated URL.</li> </ol> <div tabindex="-1" class="heading-wrapper level-h5"><h5 id="adding-a-webhook-to-builder">Adding a webhook to Builder</h5></div> <aside class="content tip astro-duqfclob" aria-label="Official resource"> <p class="title astro-duqfclob" aria-hidden="true">  Official resource </p> <section class="astro-duqfclob"> <p>See <a href="https://www.builder.io/c/docs/webhooks">Builder’s guide on adding webhooks</a> for more information.</p> </section> </aside> <ol> <li>In your Builder dashboard, go into your <strong><code>blogpost</code></strong> model. Under <strong>Show More Options</strong>, select <strong>Edit Webhooks</strong> at the bottom.</li> <li>Add a new webhook by clicking on <strong>Webhook</strong>. Paste the URL generated by your hosting provider into the <strong>Url</strong> field.</li> <li>Click on <strong>Show Advanced</strong> under the URL field and toggle the option to select <strong>Disable Payload</strong>. With the payload disabled, Builder sends a simpler POST request to your hosting provider, which can be helpful as your site grows. Click <strong>Done</strong> to save this selection.</li> </ol> <p>With this webhook in place, whenever you click the <strong>Publish</strong> button in the Builder editor, your hosting provider rebuilds your site - and Astro fetches the newly published data for you. Nothing to do but lean back and pump out that sweet sweet content!</p> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="official-resources">Official resources</h2></div> <ul> <li>Check out <a href="https://github.com/BuilderIO/builder/tree/main/examples/astro-solidjs">the official Builder.io starter project</a>, which uses Astro and SolidJS.</li> <li>The <a href="https://www.builder.io/c/docs/quickstart#step-1-add-builder-as-a-dependency">official Builder quickstart guide</a> covers both the use of the REST API as well as data fetching through an integration with a JavaScript framework like Qwik, React or Vue.</li> <li>
<a href="https://builder.io/api-explorer">Builder’s API explorer</a> can help if you need to troubleshoot your API calls.</li> </ul> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="community-resources">Community resources</h2></div> <ul> <li>Read <a href="https://www.hamatoyogi.dev/blog/astro-log/connecting-builderio-to-astro">Connecting Builder.io’s Visual CMS to Astro</a> by Yoav Ganbar.</li> </ul> <h2 class="astro-ngaa6bbg">More CMS guides</h2><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/guides/cms/builderio/" class="_attribution-link">https://docs.astro.build/en/guides/cms/builderio/</a>
  </p>
</div>
