<h1 class="content-title astro-j75b3yus" id="overview">Build your Astro Site with Docker</h1> <p><a href="https://docker.com">Docker</a> is a tool to build, deploy, and run applications using containers.</p> <p>Docker images and containers can be deployed to many different platforms, like AWS, Azure, and <a href="../../guides/deploy/google-cloud/index.html#cloud-run-ssr-and-static">Google Cloud</a>. This recipe won’t cover how to deploy your site to a specific platform but will show you how to set up Docker for your project.</p> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="prerequisites">Prerequisites</h2></div> <ul> <li>Docker installed on your local machine. You can find <a href="https://docs.docker.com/get-docker/">installation instructions for your operating system here</a>.</li> <li>A Dockerfile in your project. You can <a href="https://docs.docker.com/engine/reference/builder/">learn more about Dockerfiles here</a> and use the Dockerfiles in the following section as a starting point.</li> </ul> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="creating-a-dockerfile">Creating a Dockerfile</h2></div> <p>Create a file called <code>Dockerfile</code> in your project’s root directory. This file contains the instructions to build your site, which will differ depending on your needs. This guide can’t show all possible options but will give you starting points for SSR and static mode.</p> <p>If you’re using another package manager than npm, you’ll need to adjust the commands accordingly.</p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="ssr">SSR</h3></div> <p>This Dockerfile will build your site and serve it using Node.js on port <code>4321</code> and therefore requires the <a href="../../guides/integrations-guide/node/index.html">Node adapter</a> installed in your Astro project.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">Dockerfile</span></div>


</div> <aside class="content tip astro-duqfclob" aria-label="Keep this in mind"> <p class="title astro-duqfclob" aria-hidden="true">  Keep this in mind </p> <section class="astro-duqfclob"> <p>These are just examples of Dockerfiles. You can customize them to your needs. For example, you could use another image, like <code>node:lts-alpine</code>:</p>
<div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">Dockerfile</span></div>


</div> </section> </aside> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="adding-a-dockerignore">Adding a .dockerignore</h3></div> <p>Adding a <code>.dockerignore</code> file to your project is best practice. This file describes which files or folders should be ignored in the Docker <code>COPY</code> or <code>ADD</code> commands, very similar to how <code>.gitignore</code> works. This speeds up the build process and reduces the size of the final image.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">.dockerignore</span></div>


</div> <p>This file should go in the same directory as the <code>Dockerfile</code> itself. <a href="https://docs.docker.com/engine/reference/builder/#dockerignore-file">Read the <code>.dockerignore</code> documentation for extra info</a></p> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="static">Static</h3></div> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="apache-httpd">Apache (httpd)</h4></div> <p>The following Dockerfile will build your site and serve it using Apache htppd on port <code>80</code> with the default configuration.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">Dockerfile</span></div>


</div> <aside class="content caution astro-duqfclob" aria-label="Recommendation"> <p class="title astro-duqfclob" aria-hidden="true">  Recommendation </p> <section class="astro-duqfclob"> <p>Use this approach for simple websites that don’t need any special configuration. For more complex websites, it is recommended to use a custom configuration, either in Apache or NGINX.</p> </section> </aside> <div tabindex="-1" class="heading-wrapper level-h4"><h4 id="nginx">NGINX</h4></div> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">Dockerfile</span></div>


</div> <p>In order to build the Dockerfile above, you’ll also need to create a configuration file for NGINX. Create a folder called <code>nginx</code> in your project’s root directory and create a file called <code>nginx.conf</code> inside.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">nginx.conf</span></div>


</div> <div tabindex="-1" class="heading-wrapper level-h3"><h3 id="multi-stage-build-using-ssr">Multi-stage build (using SSR)</h3></div> <p>Here’s an example of a more advanced Dockerfile that, thanks to Docker’s <a href="https://docs.docker.com/build/building/multi-stage/">multi-stage builds</a>, optimizes the build process for your site by not reinstalling the npm dependencies when only the source code changes. This can reduce the build time even by minutes, depending on the size of your dependencies.</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading"><span class="title">Dockerfile</span></div>


</div> <div tabindex="-1" class="heading-wrapper level-h2"><h2 id="recipe">Recipe</h2></div> <ol> <li>Build your container by running the following command in your project’s root directory. Use any name for <code>&lt;your-astro-image-name&gt;</code>:</li> </ol> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> <p>This will output an image, which you can run locally or deploy to a platform of your choice.</p> <ol start="2"> <li>To run your image as a local container, use the following command.</li> </ol> <p>Replace <code>&lt;local-port&gt;</code> with an open port on your machine. Replace <code>&lt;container-port&gt;</code> with the port exposed by your Docker container (<code>4321</code>, <code>80</code>, or <code>8080</code> in the above examples.)</p> <div class="expressive-code ec ec-s1gwf">
<div class="_pre-heading">
<span class="sr-only">Terminal window</span>
</div>


</div> <p>You should be able to access your site at <code>http://localhost:&lt;local-port&gt;</code>.</p> <ol start="3"> <li>Now that your website is successfully built and packaged in a container, you can deploy it to a cloud provider. See the <a href="../../guides/deploy/google-cloud/index.html#cloud-run-ssr-and-static">Google Cloud</a> deployment guide for one example, and the <a href="https://docs.docker.com/language/nodejs/deploy/">Deploy your app</a> page in the Docker docs.</li> </ol> <hr class="astro-763jalmv"> <h2 class="astro-763jalmv">More recipes</h2> <div class="astro-t6xftchq"> <section class="cards-nav astro-t6xftchq astro-kq5jy4fu"> <ul class="fluid-grid astro-oxk5cgh7"> <li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../../core-concepts/sharing-state/index.html" aria-current="false" class="astro-har75nup"> Share State Between Islands </a> </h3> <p class="description astro-kq5jy4fu">Learn how to share state across framework components with Nano Stores.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../../guides/rss/index.html" aria-current="false" class="astro-har75nup"> Add an RSS feed </a> </h3> <p class="description astro-kq5jy4fu">Add an RSS feed to your Astro site to let users subscribe to your content.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../add-yaml-support/index.html" aria-current="false" class="astro-har75nup"> Installing a Vite or Rollup plugin </a> </h3> <p class="description astro-kq5jy4fu">Learn how you can import YAML data by adding a Rollup plugin to your project.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../build-forms-api/index.html" aria-current="false" class="astro-har75nup"> Build Forms With API Routes </a> </h3> <p class="description astro-kq5jy4fu">Learn how to use JavaScript to send form submissions to an API Route</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../build-forms/index.html" aria-current="false" class="astro-har75nup"> Build HTML Forms in Astro Pages </a> </h3> <p class="description astro-kq5jy4fu">Learn how to build HTML forms and handle submissions in your frontmatter</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../bun/index.html" aria-current="false" class="astro-har75nup"> Use Bun with Astro </a> </h3> <p class="description astro-kq5jy4fu">Learn how to use Bun with your Astro site.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../call-endpoints/index.html" aria-current="false" class="astro-har75nup"> Call endpoints from the server </a> </h3> <p class="description astro-kq5jy4fu">Learn how to call endpoints from the server in Astro.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../captcha/index.html" aria-current="false" class="astro-har75nup"> Verify a Captcha </a> </h3> <p class="description astro-kq5jy4fu">Learn how to create an API route and fetch it from the client.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="index.html" aria-current="page" class="astro-har75nup"> Build your Astro Site with Docker </a> </h3> <p class="description astro-kq5jy4fu">Learn how to build your Astro site using Docker.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../external-links/index.html" aria-current="false" class="astro-har75nup"> Add icons to external links </a> </h3> <p class="description astro-kq5jy4fu">Learn how to install a rehype plugin to add icons to external links in your Markdown files</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../i18n/index.html" aria-current="false" class="astro-har75nup"> Add i18n features </a> </h3> <p class="description astro-kq5jy4fu">Use dynamic routing and content collections to add internationalization support to your Astro site.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../modified-time/index.html" aria-current="false" class="astro-har75nup"> Add Last Modified Time </a> </h3> <p class="description astro-kq5jy4fu">Build a remark plugin to add the last modified time to your Markdown and MDX.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../reading-time/index.html" aria-current="false" class="astro-har75nup"> Add Reading Time </a> </h3> <p class="description astro-kq5jy4fu">Build a remark plugin to add reading time to your Markdown or MDX files.</p> </div> </li>
<li class="card card--maximal  astro-kq5jy4fu astro-har75nup"> <div class="stack astro-har75nup"> <h3 class="astro-har75nup"> <a href="../sharing-state/index.html" aria-current="false" class="astro-har75nup"> Share State Between Astro Components </a> </h3> <p class="description astro-kq5jy4fu">Learn how to share state across Astro components with Nano Stores.</p> </div> </li> </ul> </section> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2021 Fred K. Schott<br>Licensed under the MIT License.<br>
    <a href="https://docs.astro.build/en/recipes/docker/" class="_attribution-link">https://docs.astro.build/en/recipes/docker/</a>
  </p>
</div>
