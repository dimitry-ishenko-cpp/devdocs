<h1 id="page-subtitle">function hook_field_storage_config_update_forbid</h1>     <pre class="signature">hook_field_storage_config_update_forbid(\Drupal\field\FieldStorageConfigInterface $field_storage, \Drupal\field\FieldStorageConfigInterface $prior_field_storage)</pre> <p>Forbid a field storage update from occurring.</p> <p>Any module may forbid any update for any reason. For example, the field's storage module might forbid an update if it would change the storage schema while data for the field exists. A field type module might forbid an update if it would change existing data's semantics, or if there are external dependencies on field settings that cannot be updated.</p> <p>To forbid the update from occurring, throw a <a href="../../../core-lib-drupal-core-entity-exception-fieldstoragedefinitionupdateforbiddenexception.php/class/fieldstoragedefinitionupdateforbiddenexception/8.1.x.html" title="Exception thrown when a storage definition update is forbidden." class="local">\Drupal\Core\Entity\Exception\FieldStorageDefinitionUpdateForbiddenException</a>.</p> <h3>Parameters</h3> <p> <strong><a href="https://api.drupal.org/api/drupal/core%21modules%21field%21src%21FieldStorageConfigInterface.php/interface/FieldStorageConfigInterface/8.1.x" title="Provides an interface defining a field storage entity." class="local">\Drupal\field\FieldStorageConfigInterface</a> $field_storage</strong>: The field storage as it will be post-update.</p> <p><strong><a href="https://api.drupal.org/api/drupal/core%21modules%21field%21src%21FieldStorageConfigInterface.php/interface/FieldStorageConfigInterface/8.1.x" title="Provides an interface defining a field storage entity." class="local">\Drupal\field\FieldStorageConfigInterface</a> $prior_field_storage</strong>: The field storage as it is pre-update.</p> <h3>See also</h3> <p> <a href="../../../core-lib-drupal-core-entity-entity.api.php/group/entity_crud/8.1.x.html" title="Hooks used in various entity operations." class="local">Entity CRUD, editing, and view hooks</a></p> <h3>Related topics</h3>   <dl api-related-topics> <dt><a href="../../group/field_types/8.1.x.html">Field Types API</a></dt> <dd>Defines field, widget, display formatter, and storage types.</dd> <dt><a href="../../../core-core.api.php/group/hooks/8.1.x.html">Hooks</a></dt> <dd>Define functions that alter the behavior of Drupal core.</dd> </dl>    <h3>File</h3> 
<dl> <dt>core/modules/field/<a href="https://api.drupal.org/api/drupal/core%21modules%21field%21field.api.php/8.1.x">field.api.php</a>, line 81</dt> <dd>Field API documentation.</dd> </dl> <h3>Code</h3> <pre class="php" data-language="php">function hook_field_storage_config_update_forbid(\Drupal\field\FieldStorageConfigInterface $field_storage, \Drupal\field\FieldStorageConfigInterface $prior_field_storage) {
  if ($field_storage-&gt;module == 'options' &amp;&amp; $field_storage-&gt;hasData()) {
    // Forbid any update that removes allowed values with actual data.
    $allowed_values = $field_storage-&gt;getSetting('allowed_values');
    $prior_allowed_values = $prior_field_storage-&gt;getSetting('allowed_values');
    $lost_keys = array_keys(array_diff_key($prior_allowed_values, $allowed_values));
    if (_options_values_in_use($field_storage-&gt;getTargetEntityTypeId(), $field_storage-&gt;getName(), $lost_keys)) {
      throw new \Drupal\Core\Entity\Exception\FieldStorageDefinitionUpdateForbiddenException(t('A list field (@field_name) with existing data cannot have its keys changed.', array('@field_name' =&gt; $field_storage-&gt;getName())));
    }
  }
}
</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!modules!field!field.api.php/function/hook_field_storage_config_update_forbid/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!modules!field!field.api.php/function/hook_field_storage_config_update_forbid/8.1.x</a>
  </p>
</div>
