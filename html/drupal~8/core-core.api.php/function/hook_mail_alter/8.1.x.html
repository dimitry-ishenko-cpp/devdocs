<h1 id="page-subtitle">function hook_mail_alter</h1>     <pre class="signature">hook_mail_alter(&amp;<del>$message</del>)</pre> <p>Alter an email message created with MailManagerInterface-&gt;mail().</p> <p><a href="8.1.x.html" title="Alter an email message created with MailManagerInterface-&gt;mail()." class="local active">hook_mail_alter</a>() allows modification of email messages created and sent with MailManagerInterface-&gt;mail(). Usage examples include adding and/or changing message text, message fields, and message headers.</p> <p>Email messages sent using functions other than MailManagerInterface-&gt;mail() will not invoke <a href="8.1.x.html" title="Alter an email message created with MailManagerInterface-&gt;mail()." class="local active">hook_mail_alter</a>(). For example, a contributed module directly calling the MailInterface-&gt;mail() or PHP <a href="http://php.net/mail" title="bool mail(string $to, string $subject, string $message [, string $additional_headers = '' [, string $additional_parameters = '']])
  Send mail" class="php-manual">mail</a>() function will not invoke this hook. All core modules use MailManagerInterface-&gt;mail() for messaging, it is best practice but not mandatory in contributed modules.</p> <h3>Parameters</h3> <p> <strong>$message</strong>: An array containing the message data. Keys in this array include:</p> <ul> <li>'id': The MailManagerInterface-&gt;mail() id of the message. Look at module source code or MailManagerInterface-&gt;mail() for possible id values.</li> <li>'to': The address or addresses the message will be sent to. The formatting of this string must comply with RFC 2822.</li> <li>'from': The address the message will be marked as being from, which is either a custom address or the site-wide default email address.</li> <li>'subject': Subject of the email to be sent. This must not contain any newline characters, or the email may not be sent properly.</li> <li>'body': An array of strings or objects that implement <a href="../../../core-lib-drupal-component-render-markupinterface.php/interface/markupinterface/8.1.x.html" title="Marks an object's __toString() method as returning markup." class="local">\Drupal\Component\Render\MarkupInterface</a> containing the message text. The message body is created by concatenating the individual array strings into a single text string using "\n\n" as a separator.</li> <li>'headers': Associative array containing mail headers, such as From, Sender, MIME-Version, Content-Type, etc.</li> <li>'params': An array of optional parameters supplied by the caller of MailManagerInterface-&gt;mail() that is used to build the message before <a href="8.1.x.html" title="Alter an email message created with MailManagerInterface-&gt;mail()." class="local active">hook_mail_alter</a>() is invoked.</li> <li>'language': The language object used to build the message before <a href="8.1.x.html" title="Alter an email message created with MailManagerInterface-&gt;mail()." class="local active">hook_mail_alter</a>() is invoked.</li> <li>'send': Set to FALSE to abort sending this email message.</li> </ul> <h3>See also</h3> <p> <a href="../../../core-lib-drupal-core-mail-mailmanagerinterface.php/function/mailmanagerinterface-mail/8.1.x.html" title="Composes and optionally sends an email message." class="local">\Drupal\Core\Mail\MailManagerInterface::mail</a>()</p> <h3>Related topics</h3>   <dl api-related-topics> <dt><a href="../../group/hooks/8.1.x.html">Hooks</a></dt> <dd>Define functions that alter the behavior of Drupal core.</dd> </dl>    <h3>File</h3> 
<dl> <dt>core/<a href="https://api.drupal.org/api/drupal/core%21core.api.php/8.1.x">core.api.php</a>, line 1993</dt> <dd>Documentation landing page and topics, plus core library hooks.</dd> </dl> <h3>Code</h3> <pre class="php" data-language="php">function hook_mail_alter(&amp;$message) {
  if ($message['id'] == 'modulename_messagekey') {
    if (!example_notifications_optin($message['to'], $message['id'])) {
      // If the recipient has opted to not receive such messages, cancel
      // sending.
      $message['send'] = FALSE;
      return;
    }
    $message['body'][] = "--\nMail sent out from " . \Drupal::config('system.site')-&gt;get('name');
  }
}
</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!core.api.php/function/hook_mail_alter/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!core.api.php/function/hook_mail_alter/8.1.x</a>
  </p>
</div>
