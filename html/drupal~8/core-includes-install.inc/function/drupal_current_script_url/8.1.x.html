<h1 id="page-subtitle">function drupal_current_script_url</h1>     <pre class="signature">drupal_current_script_url($query = array())</pre> <p>Returns the URL of the current script, with modified query parameters.</p> <p>This function can be called by low-level scripts (such as <a href="https://api.drupal.org/api/drupal/core%21install.php/8.1.x" title="Initiates a browser-based installation of Drupal." class="local">install.php</a> and <a href="https://api.drupal.org/api/drupal/update.php/8.1.x" title="The PHP page that handles updating the Drupal installation." class="local">update.php</a>) and returns the URL of the current script. Existing query parameters are preserved by default, but new ones can optionally be merged in.</p> <p>This function is used when the script must maintain certain query parameters over multiple page requests in order to work correctly. In such cases (for example, <a href="https://api.drupal.org/api/drupal/update.php/8.1.x" title="The PHP page that handles updating the Drupal installation." class="local">update.php</a>, which requires the 'continue=1' parameter to remain in the URL throughout the update process if there are any requirement warnings that need to be bypassed), using this function to generate the URL for links to the next steps of the script ensures that the links will work correctly.</p> <h3>Parameters</h3> <p> <strong>$query</strong>: (optional) An array of query parameters to merge in to the existing ones.</p> <h3>Return value</h3> <p> The URL of the current script, with query parameters modified by the passed-in $query. The URL is not sanitized, so it still needs to be run through <a href="../../../core-lib-drupal-component-utility-urlhelper.php/function/urlhelper-filterbadprotocol/8.1.x.html" title="Processes an HTML attribute value and strips dangerous protocols from URLs." class="local">\Drupal\Component\Utility\UrlHelper::filterBadProtocol</a>() if it will be used as an HTML attribute value.</p> <h3>See also</h3> <p> <a href="../drupal_requirements_url/8.1.x.html" title="Returns a URL for proceeding to the next page after a requirements problem." class="local">drupal_requirements_url</a>()</p> <p><a href="../../../core-lib-drupal-component-utility-urlhelper.php/function/urlhelper-filterbadprotocol/8.1.x.html" title="Processes an HTML attribute value and strips dangerous protocols from URLs." class="local">Drupal\Component\Utility\UrlHelper::filterBadProtocol</a>()</p>  <h3>File</h3> 
<dl> <dt>core/includes/<a href="../../8.1.x.html">install.inc</a>, line 883</dt> <dd>API functions for installing modules and themes.</dd> </dl> <h3>Code</h3> <pre class="php" data-language="php">function drupal_current_script_url($query = array()) {
  $uri = $_SERVER['SCRIPT_NAME'];
  $query = array_merge(UrlHelper::filterQueryParameters(\Drupal::request()-&gt;query-&gt;all()), $query);
  if (!empty($query)) {
    $uri .= '?' . UrlHelper::buildQuery($query);
  }
  return $uri;
}
</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!includes!install.inc/function/drupal_current_script_url/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!includes!install.inc/function/drupal_current_script_url/8.1.x</a>
  </p>
</div>
