<h1 id="page-subtitle">public static function Datetime::processDatetime</h1>     <pre class="signature">public static <a href="../../class/datetime/8.1.x.html">Datetime</a>::processDatetime(&amp;$element, FormStateInterface $form_state, &amp;$complete_form)</pre> <p>Expands a datetime element type into date and/or time elements.</p> <p>All form elements are designed to have sane defaults so any or all can be omitted. Both the date and time components are configurable so they can be output as HTML5 datetime elements or not, as desired.</p> <p>Examples of possible configurations include: HTML5 date and time: #date_date_element = 'date'; #date_time_element = 'time'; HTML5 datetime: #date_date_element = 'datetime'; #date_time_element = 'none'; HTML5 time only: #date_date_element = 'none'; #date_time_element = 'time' Non-HTML5: #date_date_element = 'text'; #date_time_element = 'text';</p> <p>Required settings:</p> <ul> <li>
<strong>#default_value</strong>: A DrupalDateTime object, adjusted to the proper local timezone. Converting a date stored in the database from UTC to the local zone and converting it back to UTC before storing it is not handled here. This element accepts a date as the default value, and then converts the user input strings back into a new date object on submission. No timezone adjustment is performed.</li> </ul> <p>Optional properties include:</p> <ul> <li>
<strong>#date_date_format</strong>: A date format string that describes the format that should be displayed to the end user for the date. When using HTML5 elements the format MUST use the appropriate HTML5 format for that element, no other format will work. See the <a href="../../../core-includes-common.inc/function/format_date/8.1.x.html" title="Formats a date, using a date type or a custom date format string." class="local">format_date</a>() function for a list of the possible formats and HTML5 standards for the HTML5 requirements. Defaults to the right HTML5 format for the chosen element if a HTML5 element is used, otherwise defaults to <a href="../../../core-includes-entity.inc/function/entity_load/8.1.x.html" title="Loads an entity from the database." class="local">entity_load</a>('date_format', 'html_date')-&gt;getPattern().</li> <li>
<strong>#date_date_element</strong>: The date element. Options are: <ul> <li>
<strong>datetime</strong>: Use the HTML5 datetime element type.</li> <li>
<strong>datetime-local</strong>: Use the HTML5 datetime-local element type.</li> <li>
<strong>date</strong>: Use the HTML5 date element type.</li> <li>
<strong>text</strong>: No HTML5 element, use a normal text field.</li> <li>
<strong>none</strong>: Do not display a date element.</li> </ul> </li> <li>
<strong>#date_date_callbacks</strong>: Array of optional callbacks for the date element. Can be used to add a jQuery datepicker.</li> <li>
<strong>#date_time_element</strong>: The time element. Options are: <ul> <li>
<strong>time</strong>: Use a HTML5 time element type.</li> <li>
<strong>text</strong>: No HTML5 element, use a normal text field.</li> <li>
<strong>none</strong>: Do not display a time element.</li> </ul> </li> <li>
<strong>#date_time_format</strong>: A date format string that describes the format that should be displayed to the end user for the time. When using HTML5 elements the format MUST use the appropriate HTML5 format for that element, no other format will work. See the <a href="../../../core-includes-common.inc/function/format_date/8.1.x.html" title="Formats a date, using a date type or a custom date format string." class="local">format_date</a>() function for a list of the possible formats and HTML5 standards for the HTML5 requirements. Defaults to the right HTML5 format for the chosen element if a HTML5 element is used, otherwise defaults to <a href="../../../core-includes-entity.inc/function/entity_load/8.1.x.html" title="Loads an entity from the database." class="local">entity_load</a>('date_format', 'html_time')-&gt;getPattern().</li> <li>
<strong>#date_time_callbacks</strong>: An array of optional callbacks for the time element. Can be used to add a jQuery timepicker or an 'All day' checkbox.</li> <li>
<strong>#date_year_range</strong>: A description of the range of years to allow, like '1900:2050', '-3:+3' or '2000:+3', where the first value describes the earliest year and the second the latest year in the range. A year in either position means that specific year. A +/- value describes a dynamic value that is that many years earlier or later than the current year at the time the form is displayed. Used in jQueryUI datepicker year range and HTML5 min/max date settings. Defaults to '1900:2050'.</li> <li>
<strong>#date_increment</strong>: The increment to use for minutes and seconds, i.e. '15' would show only :00, :15, :30 and :45. Used for HTML5 step values and jQueryUI datepicker settings. Defaults to 1 to show every minute.</li> <li>
<strong>#date_timezone</strong>: The local timezone to use when creating dates. Generally this should be left empty and it will be set correctly for the user using the form. Useful if the default value is empty to designate a desired timezone for dates created in form processing. If a default date is provided, this value will be ignored, the timezone in the default date takes precedence. Defaults to the value returned by <a href="../../../core-includes-bootstrap.inc/function/drupal_get_user_timezone/8.1.x.html" title="Returns the time zone of the current user." class="local">drupal_get_user_timezone</a>().</li> </ul> <p>Example usage:</p> <pre class="php" data-language="php">  $form = array(
    '#type' =&gt; 'datetime',
    '#default_value' =&gt; new DrupalDateTime('2000-01-01 00:00:00'),
    '#date_date_element' =&gt; 'date',
    '#date_time_element' =&gt; 'none',
    '#date_year_range' =&gt; '2010:+3',
  );
</pre> <h3>Parameters</h3> <p> <strong>array $element</strong>: The form element whose value is being processed.</p> <p><strong><a href="../../../core-lib-drupal-core-form-formstateinterface.php/interface/formstateinterface/8.1.x.html" title="Provides an interface for an object containing the current state of a form." class="local">\Drupal\Core\Form\FormStateInterface</a> $form_state</strong>: The current state of the form.</p> <p><strong>array $complete_form</strong>: The complete form structure.</p> <h3>Return value</h3> <p> array The form element whose value has been processed.</p> <h3>File</h3> 
<dl> <dt>core/lib/Drupal/Core/Datetime/Element/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Datetime%21Element%21Datetime.php/8.1.x">Datetime.php</a>, line 215</dt>  </dl> <h3>Class</h3> 
<dl> <dt>
<a href="../../class/datetime/8.1.x.html">Datetime</a> </dt> <dd>Provides a datetime element.</dd> </dl> <h3>Namespace</h3> <a href="https://api.drupal.org/api/drupal/namespace/Drupal%21Core%21Datetime%21Element/8.1.x">Drupal\Core\Datetime\Element</a> <h3>Code</h3> <pre class="php" data-language="php">public static function processDatetime(&amp;$element, FormStateInterface $form_state, &amp;$complete_form) {
  $format_settings = array();
  // The value callback has populated the #value array.
  $date = !empty($element['#value']['object']) ? $element['#value']['object'] : NULL;

  // Set a fallback timezone.
  if ($date instanceof DrupalDateTime) {
    $element['#date_timezone'] = $date-&gt;getTimezone()-&gt;getName();
  }
  elseif (empty($element['#timezone'])) {
    $element['#date_timezone'] = drupal_get_user_timezone();
  }

  $element['#tree'] = TRUE;

  if ($element['#date_date_element'] != 'none') {

    $date_format = $element['#date_date_element'] != 'none' ? static::getHtml5DateFormat($element) : '';
    $date_value = !empty($date) ? $date-&gt;format($date_format, $format_settings) : $element['#value']['date'];

    // Creating format examples on every individual date item is messy, and
    // placeholders are invalid for HTML5 date and datetime, so an example
    // format is appended to the title to appear in tooltips.
    $extra_attributes = array(
      'title' =&gt; t('Date (e.g. @format)', array('@format' =&gt; static::formatExample($date_format))),
      'type' =&gt; $element['#date_date_element'],
    );

    // Adds the HTML5 date attributes.
    if ($date instanceof DrupalDateTime &amp;&amp; !$date-&gt;hasErrors()) {
      $html5_min = clone($date);
      $range = static::datetimeRangeYears($element['#date_year_range'], $date);
      $html5_min-&gt;setDate($range[0], 1, 1)-&gt;setTime(0, 0, 0);
      $html5_max = clone($date);
      $html5_max-&gt;setDate($range[1], 12, 31)-&gt;setTime(23, 59, 59);

      $extra_attributes += array(
        'min' =&gt; $html5_min-&gt;format($date_format, $format_settings),
        'max' =&gt; $html5_max-&gt;format($date_format, $format_settings),
      );
    }

    $element['date'] = array(
      '#type' =&gt; 'date',
      '#title' =&gt; t('Date'),
      '#title_display' =&gt; 'invisible',
      '#value' =&gt; $date_value,
      '#attributes' =&gt; $element['#attributes'] + $extra_attributes,
      '#required' =&gt; $element['#required'],
      '#size' =&gt; max(12, strlen($element['#value']['date'])),
      '#error_no_message' =&gt; TRUE,
      '#date_date_format' =&gt; $element['#date_date_format'],
    );

    // Allows custom callbacks to alter the element.
    if (!empty($element['#date_date_callbacks'])) {
      foreach ($element['#date_date_callbacks'] as $callback) {
        if (function_exists($callback)) {
          $callback($element, $form_state, $date);
        }
      }
    }
  }

  if ($element['#date_time_element'] != 'none') {

    $time_format = $element['#date_time_element'] != 'none' ? static::getHtml5TimeFormat($element) : '';
    $time_value = !empty($date) ? $date-&gt;format($time_format, $format_settings) : $element['#value']['time'];

    // Adds the HTML5 attributes.
    $extra_attributes = array(
      'title' =&gt; t('Time (e.g. @format)', array('@format' =&gt; static::formatExample($time_format))),
      'type' =&gt; $element['#date_time_element'],
      'step' =&gt; $element['#date_increment'],
    );
    $element['time'] = array(
      '#type' =&gt; 'date',
      '#title' =&gt; t('Time'),
      '#title_display' =&gt; 'invisible',
      '#value' =&gt; $time_value,
      '#attributes' =&gt; $element['#attributes'] + $extra_attributes,
      '#required' =&gt; $element['#required'],
      '#size' =&gt; 12,
      '#error_no_message' =&gt; TRUE,
    );

    // Allows custom callbacks to alter the element.
    if (!empty($element['#date_time_callbacks'])) {
      foreach ($element['#date_time_callbacks'] as $callback) {
        if (function_exists($callback)) {
          $callback($element, $form_state, $date);
        }
      }
    }
  }

  return $element;
}
</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Datetime!Element!Datetime.php/function/Datetime::processDatetime/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Datetime!Element!Datetime.php/function/Datetime::processDatetime/8.1.x</a>
  </p>
</div>
