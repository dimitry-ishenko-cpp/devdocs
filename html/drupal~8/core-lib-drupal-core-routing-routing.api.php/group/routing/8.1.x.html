<h1 id="page-subtitle">Routing API</h1>      <p>Route page requests to code based on URLs.</p> <h3 id="sec_overview">Overview and terminology</h3> <p>The Drupal routing system defines how Drupal responds to URL requests that the web server passes on to Drupal. The routing system is based on the <a href="http://symfony.com">Symfony framework.</a> The central idea is that Drupal subsystems and modules can register routes (basically, URL paths and context); they can also register to respond dynamically to routes, for more flexibility. When Drupal receives a URL request, it will attempt to match the request to a registered route, and query dynamic responders. If a match is made, Drupal will then instantiate the required classes, gather the data, format it, and send it back to the web browser. Otherwise, Drupal will return a 404 or 403 response.</p> <p>The following sections of this topic provide an overview of the routing API. For more detailed information, see <a href="https://www.drupal.org/developing/api/8/routing">https://www.drupal.org/developing/api/8/routing</a></p> <h3 id="sec_register">Registering simple routes</h3> <p>To register a route, add lines similar to this to a module_name.routing.yml file in your top-level module directory:</p> <pre class="php" data-language="php">dblog.overview:
  path: '/admin/reports/dblog'
  defaults:
    _controller: '\Drupal\dblog\Controller\DbLogController::overview'
    _title: 'Recent log messages'
  requirements:
    _permission: 'access site reports'
</pre>
<p> Some notes:</p> <ul> <li>The first line is the machine name of the route. Typically, it is prefixed by the machine name of the module that defines the route, or the name of a subsystem.</li> <li>The 'path' line gives the URL path of the route (relative to the site's base URL). Note: The path in Drupal is treated case insensitive so /example and /EXAmplE should return the same page. @todo Fix <a href="https://www.drupal.org/node/2075889">https://www.drupal.org/node/2075889</a> to actually get this behaviour.</li> <li>The 'defaults' section tells how to build the main content of the route, and can also give other information, such as the page title and additional arguments for the route controller method. There are several possibilities for how to build the main content, including: <ul> <li>
<strong>_controller</strong>: A callable, usually a method on a page controller class (see <a href="#sec_controller">Route controllers for simple routes</a> below for details).</li> <li>
<strong>_form</strong>: A form controller class. See the <a href="../../../core-core.api.php/group/form_api/8.1.x.html" title="Describes how to generate and manipulate forms and process form submissions." class="local">Form API topic</a> for more information about form controllers.</li> <li>
<strong>_entity_form</strong>: A form for editing an entity. See the <a href="../../../core-lib-drupal-core-entity-entity.api.php/group/entity_api/8.1.x.html" title="Describes how to define and manipulate content and configuration entities." class="local">Entity API topic</a> for more information.</li> </ul> </li> <li>The 'requirements' section is used in Drupal to give access permission instructions (it has other uses in the Symfony framework). Most routes have a simple permission-based access scheme, as shown in this example. See the <a href="../../../core-core.api.php/group/user_api/8.1.x.html" title="API for user accounts, access checking, roles, and permissions." class="local">Permission system topic</a> for more information about permissions.</li> </ul> <p>See <a href="https://www.drupal.org/node/2092643">https://www.drupal.org/node/2092643</a> for more details about *.routing.yml files, and <a href="https://www.drupal.org/node/2122201">https://www.drupal.org/node/2122201</a> for information on how to set up dynamic routes. The <a href="../../../core-core.api.php/group/events/8.1.x.html" title="Overview of event dispatch and subscribing" class="local">Events topic</a> is also relevant to dynamic routes.</p> <h3 id="sec_placeholders">Defining routes with placeholders</h3> <p>Some routes have placeholders in them, and these can also be defined in a module_name.routing.yml file, as in this example from the Block module:</p> <pre class="php" data-language="php">entity.block.edit_form:
  path: '/admin/structure/block/manage/{block}'
  defaults:
    _entity_form: 'block.default'
    _title: 'Configure block'
  requirements:
    _entity_access: 'block.update'
</pre>
<p> In the path, '{block}' is a placeholder - it will be replaced by the ID of the block that is being configured by the entity system. See the <a href="../../../core-lib-drupal-core-entity-entity.api.php/group/entity_api/8.1.x.html" title="Describes how to define and manipulate content and configuration entities." class="local">Entity API topic</a> for more information.</p> <h3 id="sec_controller">Route controllers for simple routes</h3> <p>For simple routes, after you have defined the route in a *.routing.yml file (see <a href="#sec_register">Registering simple routes</a> above), the next step is to define a page controller class and method. Page controller classes do not necessarily need to implement any particular interface or extend any particular base class. The only requirement is that the method specified in your *.routing.yml file returns:</p> <ul> <li>A render array (see the <a href="../../../core-lib-drupal-core-render-theme.api.php/group/theme_render/8.1.x.html" title="Overview of the Theme system and Render API." class="local">Theme and render topic</a> for more information). This render array is then rendered in the requested format (HTML, dialog, modal, AJAX are supported by default). In the case of HTML, it will be surrounded by blocks by default: the Block module is enabled by default, and hence its Page Display Variant that surrounds the main content with blocks is also used by default.</li> <li>A <a href="https://api.drupal.org/api/drupal/vendor%21symfony%21http-foundation%21Response.php/class/Response/8.1.x" title="Response represents an HTTP response." class="local">\Symfony\Component\HttpFoundation\Response</a> object.</li> </ul> <p>As a note, if your module registers multiple simple routes, it is usual (and usually easiest) to put all of their methods on one controller class.</p> <p>If the route has placeholders (see <a href="#sec_placeholders">Defining routes with placeholders</a> above) the placeholders will be passed to the method (using reflection) by name. For example, the placeholder '{myvar}' in a route will become the $myvar parameter to the method.</p> <p>Additionally, if a parameter is typed to one of the following special classes the system will pass those values as well.</p> <ul> <li>
<strong><a href="https://api.drupal.org/api/drupal/vendor%21symfony%21http-foundation%21Request.php/class/Request/8.1.x" title="Request represents an HTTP request." class="local">\Symfony\Component\HttpFoundation\Request</a></strong>: The raw Symfony request object. It is generally only useful if the controller needs access to the query parameters of the request. By convention, this parameter is usually named $request.</li> <li>
<strong><a href="https://api.drupal.org/api/drupal/vendor%21psr%21http-message%21src%21ServerRequestInterface.php/interface/ServerRequestInterface/8.1.x" title="Representation of an incoming, server-side HTTP request." class="local">\Psr\Http\Message\ServerRequestInterface</a></strong>: The raw request, represented using the PSR-7 ServerRequest format. This object is derived as necessary from the Symfony request, so if either will suffice the Symfony request will be slightly more performant. By convention this parameter is usually named $request.</li> <li>
<strong><a href="../../../core-lib-drupal-core-routing-routematchinterface.php/interface/routematchinterface/8.1.x.html" title="Provides an interface for classes representing the result of routing." class="local">\Drupal\Core\Routing\RouteMatchInterface</a></strong>: The "route match" data from this request. This object contains various standard data derived from the request and routing process. Consult the interface for details.</li> </ul> <p>Most controllers will need to display some information stored in the Drupal database, which will involve using one or more Drupal services (see the <a href="../../../core-core.api.php/group/container/8.1.x.html" title="Overview of the Dependency Injection Container and Services." class="local">Services and container topic</a>). In order to properly inject services, a controller should implement <a href="../../../core-lib-drupal-core-dependencyinjection-containerinjectioninterface.php/interface/containerinjectioninterface/8.1.x.html" title="Defines a common interface for dependency container injection." class="local">\Drupal\Core\DependencyInjection\ContainerInjectionInterface</a>; simple controllers can do this by extending the <a href="../../../core-lib-drupal-core-controller-controllerbase.php/class/controllerbase/8.1.x.html" title="Utility base class for thin controllers." class="local">\Drupal\Core\Controller\ControllerBase</a> class. See <a href="https://api.drupal.org/api/drupal/core%21modules%21dblog%21src%21Controller%21DbLogController.php/class/DbLogController/8.1.x" title="Returns responses for dblog routes." class="local">\Drupal\dblog\Controller\DbLogController</a> for a straightforward example of a controller class.</p> <h3>File</h3> 
<dl> <dt>core/lib/Drupal/Core/Routing/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Routing%21routing.api.php/8.1.x">routing.api.php</a>, line 8</dt> <dd>Hooks and documentation related to the routing system.</dd> </dl> <h3>Classes</h3>  <table> <thead> <tr> <th scope="col"> Name </th> <th scope="col"> Location </th> <th scope="col"> Description </th> </tr> </thead> <tbody> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-controller-controllerbase.php/class/controllerbase/8.1.x.html">ControllerBase</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Controller/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Controller%21ControllerBase.php/8.1.x">ControllerBase.php</a> </td> <td data-th="Description"> Utility base class for thin controllers. </td> </tr> </tbody> </table>  <h3>Interfaces</h3>  <table> <thead> <tr> <th scope="col"> Name </th> <th scope="col"> Location </th> <th scope="col"> Description </th> </tr> </thead> <tbody> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-routing-routebuilderinterface.php/interface/routebuilderinterface/8.1.x.html">RouteBuilderInterface</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Routing/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Routing%21RouteBuilderInterface.php/8.1.x">RouteBuilderInterface.php</a> </td> <td data-th="Description"> Rebuilds the route information and dumps it. </td> </tr> <tr> <td data-th="Name"> <a href="../../../core-lib-drupal-core-routing-routematchinterface.php/interface/routematchinterface/8.1.x.html">RouteMatchInterface</a> </td> <td data-th="Location"> core/lib/Drupal/Core/Routing/<a href="https://api.drupal.org/api/drupal/core%21lib%21Drupal%21Core%21Routing%21RouteMatchInterface.php/8.1.x">RouteMatchInterface.php</a> </td> <td data-th="Description"> Provides an interface for classes representing the result of routing. </td> </tr> </tbody> </table><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2001&ndash;2016 by the original authors<br>Licensed under the GNU General Public License, version 2 and later.<br>Drupal is a registered trademark of Dries Buytaert.<br>
    <a href="https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Routing!routing.api.php/group/routing/8.1.x" class="_attribution-link">https://api.drupal.org/api/drupal/core!lib!Drupal!Core!Routing!routing.api.php/group/routing/8.1.x</a>
  </p>
</div>
