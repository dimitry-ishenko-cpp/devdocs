<h1>SSL/TLS Strong Encryption: An Introduction</h1>  <p>As an introduction this chapter is aimed at readers who are familiar with the Web, HTTP, and Apache, but are not security experts. It is not intended to be a definitive guide to the SSL protocol, nor does it discuss specific techniques for managing certificates in an organization, or the important legal issues of patents and import and export restrictions. Rather, it is intended to provide a common background to <code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code> users by pulling together various concepts, definitions, and examples as a starting point for further exploration.</p>     <h2 id="cryptographictech">Cryptographic Techniques</h2> <p>Understanding SSL requires an understanding of cryptographic algorithms, message digest functions (aka. one-way or hash functions), and digital signatures. These techniques are the subject of entire books (see for instance [<a href="#AC96">AC96</a>]) and provide the basis for privacy, integrity, and authentication.</p> <h3><a name="cryptographicalgo" id="cryptographicalgo">Cryptographic Algorithms</a></h3> <p>Suppose Alice wants to send a message to her bank to transfer some money. Alice would like the message to be private, since it will include information such as her account number and transfer amount. One solution is to use a cryptographic algorithm, a technique that would transform her message into an encrypted form, unreadable until it is decrypted. Once in this form, the message can only be decrypted by using a secret key. Without the key the message is useless: good cryptographic algorithms make it so difficult for intruders to decode the original text that it isn't worth their effort.</p> <p>There are two categories of cryptographic algorithms: conventional and public key.</p> <dl> <dt>Conventional cryptography</dt> <dd>also known as symmetric cryptography, requires the sender and receiver to share a key: a secret piece of information that may be used to encrypt or decrypt a message. As long as this key is kept secret, nobody other than the sender or recipient can read the message. If Alice and the bank know a secret key, then they can send each other private messages. The task of sharing a key between sender and recipient before communicating, while also keeping it secret from others, can be problematic.</dd> <dt>Public key cryptography</dt> <dd>also known as asymmetric cryptography, solves the key exchange problem by defining an algorithm which uses two keys, each of which may be used to encrypt a message. If one key is used to encrypt a message then the other must be used to decrypt it. This makes it possible to receive secure messages by simply publishing one key (the public key) and keeping the other secret (the private key).</dd> </dl> <p>Anyone can encrypt a message using the public key, but only the owner of the private key will be able to read it. In this way, Alice can send private messages to the owner of a key-pair (the bank), by encrypting them using their public key. Only the bank will be able to decrypt them.</p> <h3><a name="messagedigests" id="messagedigests">Message Digests</a></h3> <p>Although Alice may encrypt her message to make it private, there is still a concern that someone might modify her original message or substitute it with a different one, in order to transfer the money to themselves, for instance. One way of guaranteeing the integrity of Alice's message is for her to create a concise summary of her message and send this to the bank as well. Upon receipt of the message, the bank creates its own summary and compares it with the one Alice sent. If the summaries are the same then the message has been received intact.</p> <p>A summary such as this is called a <dfn>message digest</dfn>, <em>one-way function</em> or <em>hash function</em>. Message digests are used to create a short, fixed-length representation of a longer, variable-length message. Digest algorithms are designed to produce a unique digest for each message. Message digests are designed to make it impractically difficult to determine the message from the digest and (in theory) impossible to find two different messages which create the same digest -- thus eliminating the possibility of substituting one message for another while maintaining the same digest.</p> <p>Another challenge that Alice faces is finding a way to send the digest to the bank securely; if the digest is not sent securely, its integrity may be compromised and with it the possibility for the bank to determine the integrity of the original message. Only if the digest is sent securely can the integrity of the associated message be determined.</p> <p>One way to send the digest securely is to include it in a digital signature.</p> <h3><a name="digitalsignatures" id="digitalsignatures">Digital Signatures</a></h3> <p>When Alice sends a message to the bank, the bank needs to ensure that the message is really from her, so an intruder cannot request a transaction involving her account. A <em>digital signature</em>, created by Alice and included with the message, serves this purpose.</p> <p>Digital signatures are created by encrypting a digest of the message and other information (such as a sequence number) with the sender's private key. Though anyone can <em>decrypt</em> the signature using the public key, only the sender knows the private key. This means that only the sender can have signed the message. Including the digest in the signature means the signature is only good for that message; it also ensures the integrity of the message since no one can change the digest and still sign it.</p> <p>To guard against interception and reuse of the signature by an intruder at a later date, the signature contains a unique sequence number. This protects the bank from a fraudulent claim from Alice that she did not send the message -- only she could have signed it (non-repudiation).</p>   <h2 id="certificates">Certificates</h2> <p>Although Alice could have sent a private message to the bank, signed it and ensured the integrity of the message, she still needs to be sure that she is really communicating with the bank. This means that she needs to be sure that the public key she is using is part of the bank's key-pair, and not an intruder's. Similarly, the bank needs to verify that the message signature really was signed by the private key that belongs to Alice.</p> <p>If each party has a certificate which validates the other's identity, confirms the public key and is signed by a trusted agency, then both can be assured that they are communicating with whom they think they are. Such a trusted agency is called a <em>Certificate Authority</em> and certificates are used for authentication.</p> <h3><a name="certificatecontents" id="certificatecontents">Certificate Contents</a></h3> <p>A certificate associates a public key with the real identity of an individual, server, or other entity, known as the subject. As shown in <a href="#table1">Table 1</a>, information about the subject includes identifying information (the distinguished name) and the public key. It also includes the identification and signature of the Certificate Authority that issued the certificate and the period of time during which the certificate is valid. It may have additional information (or extensions) as well as administrative information for the Certificate Authority's use, such as a serial number.</p> <h4><a name="table1" id="table1">Table 1: Certificate Information</a></h4> <table> <tr>
<th>Subject</th> <td>Distinguished Name, Public Key</td>
</tr> <tr>
<th>Issuer</th> <td>Distinguished Name, Signature</td>
</tr> <tr>
<th>Period of Validity</th> <td>Not Before Date, Not After Date</td>
</tr> <tr>
<th>Administrative Information</th> <td>Version, Serial Number</td>
</tr> <tr>
<th>Extended Information</th> <td>Basic Constraints, Netscape Flags, etc.</td>
</tr> </table> <p>A distinguished name is used to provide an identity in a specific context -- for instance, an individual might have a personal certificate as well as one for their identity as an employee. Distinguished names are defined by the X.509 standard [<a href="#X509">X509</a>], which defines the fields, field names and abbreviations used to refer to the fields (see <a href="#table2">Table 2</a>).</p> <h4><a name="table2" id="table2">Table 2: Distinguished Name Information</a></h4> <table class="bordered"> <tr>
<th>DN Field</th> <th>Abbrev.</th> <th>Description</th> <th>Example</th>
</tr> <tr>
<td>Common Name</td> <td>CN</td> <td>Name being certified</td> <td>CN=Joe Average</td>
</tr> <tr>
<td>Organization or Company</td> <td>O</td> <td>Name is associated with this<br>organization</td> <td>O=Snake Oil, Ltd.</td>
</tr> <tr>
<td>Organizational Unit</td> <td>OU</td> <td>Name is associated with this <br>organization unit, such as a department</td> <td>OU=Research Institute</td>
</tr> <tr>
<td>City/Locality</td> <td>L</td> <td>Name is located in this City</td> <td>L=Snake City</td>
</tr> <tr>
<td>State/Province</td> <td>ST</td> <td>Name is located in this State/Province</td> <td>ST=Desert</td>
</tr> <tr>
<td>Country</td> <td>C</td> <td>Name is located in this Country (ISO code)</td> <td>C=XZ</td>
</tr> </table> <p>A Certificate Authority may define a policy specifying which distinguished field names are optional and which are required. It may also place requirements upon the field contents, as may users of certificates. For example, a Netscape browser requires that the Common Name for a certificate representing a server matches a wildcard pattern for the domain name of that server, such as <code>*.snakeoil.com</code>.</p> <p>The binary format of a certificate is defined using the ASN.1 notation [<a href="#ASN1">ASN1</a>] [<a href="#PKCS">PKCS</a>]. This notation defines how to specify the contents and encoding rules define how this information is translated into binary form. The binary encoding of the certificate is defined using Distinguished Encoding Rules (DER), which are based on the more general Basic Encoding Rules (BER). For those transmissions which cannot handle binary, the binary form may be translated into an ASCII form by using Base64 encoding [<a href="#MIME">MIME</a>]. When placed between begin and end delimiter lines (as below), this encoded version is called a PEM ("Privacy Enhanced Mail") encoded certificate.</p> <div class="example">
<h3>Example of a PEM-encoded certificate (snakeoil.crt)</h3>
<pre>-----BEGIN CERTIFICATE-----
MIIC7jCCAlegAwIBAgIBATANBgkqhkiG9w0BAQQFADCBqTELMAkGA1UEBhMCWFkx
FTATBgNVBAgTDFNuYWtlIERlc2VydDETMBEGA1UEBxMKU25ha2UgVG93bjEXMBUG
A1UEChMOU25ha2UgT2lsLCBMdGQxHjAcBgNVBAsTFUNlcnRpZmljYXRlIEF1dGhv
cml0eTEVMBMGA1UEAxMMU25ha2UgT2lsIENBMR4wHAYJKoZIhvcNAQkBFg9jYUBz
bmFrZW9pbC5kb20wHhcNOTgxMDIxMDg1ODM2WhcNOTkxMDIxMDg1ODM2WjCBpzEL
MAkGA1UEBhMCWFkxFTATBgNVBAgTDFNuYWtlIERlc2VydDETMBEGA1UEBxMKU25h
a2UgVG93bjEXMBUGA1UEChMOU25ha2UgT2lsLCBMdGQxFzAVBgNVBAsTDldlYnNl
cnZlciBUZWFtMRkwFwYDVQQDExB3d3cuc25ha2VvaWwuZG9tMR8wHQYJKoZIhvcN
AQkBFhB3d3dAc25ha2VvaWwuZG9tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKB
gQDH9Ge/s2zcH+da+rPTx/DPRp3xGjHZ4GG6pCmvADIEtBtKBFAcZ64n+Dy7Np8b
vKR+yy5DGQiijsH1D/j8HlGE+q4TZ8OFk7BNBFazHxFbYI4OKMiCxdKzdif1yfaa
lWoANFlAzlSdbxeGVHoT0K+gT5w3UxwZKv2DLbCTzLZyPwIDAQABoyYwJDAPBgNV
HRMECDAGAQH/AgEAMBEGCWCGSAGG+EIBAQQEAwIAQDANBgkqhkiG9w0BAQQFAAOB
gQAZUIHAL4D09oE6Lv2k56Gp38OBDuILvwLg1v1KL8mQR+KFjghCrtpqaztZqcDt
2q2QoyulCgSzHbEGmi0EsdkPfg6mp0penssIFePYNI+/8u9HT4LuKMJX15hxBam7
dUHzICxBVC1lnHyYGjDuAMhe396lYAn8bCld1/L4NMGBCQ==
-----END CERTIFICATE-----</pre>
</div> <h3><a name="certificateauthorities" id="certificateauthorities">Certificate Authorities</a></h3> <p>By verifying the information in a certificate request before granting the certificate, the Certificate Authority assures itself of the identity of the private key owner of a key-pair. For instance, if Alice requests a personal certificate, the Certificate Authority must first make sure that Alice really is the person the certificate request claims she is.</p> <h4><a name="certificatechains" id="certificatechains">Certificate Chains</a></h4> <p>A Certificate Authority may also issue a certificate for another Certificate Authority. When examining a certificate, Alice may need to examine the certificate of the issuer, for each parent Certificate Authority, until reaching one which she has confidence in. She may decide to trust only certificates with a limited chain of issuers, to reduce her risk of a "bad" certificate in the chain.</p> <h4><a name="rootlevelca" id="rootlevelca">Creating a Root-Level CA</a></h4> <p>As noted earlier, each certificate requires an issuer to assert the validity of the identity of the certificate subject, up to the top-level Certificate Authority (CA). This presents a problem: who can vouch for the certificate of the top-level authority, which has no issuer? In this unique case, the certificate is "self-signed", so the issuer of the certificate is the same as the subject. Browsers are preconfigured to trust well-known certificate authorities, but it is important to exercise extra care in trusting a self-signed certificate. The wide publication of a public key by the root authority reduces the risk in trusting this key -- it would be obvious if someone else publicized a key claiming to be the authority.</p> <p>A number of companies, such as <a href="http://www.thawte.com/">Thawte</a> and <a href="http://www.verisign.com/">VeriSign</a> have established themselves as Certificate Authorities. These companies provide the following services:</p> <ul> <li>Verifying certificate requests</li> <li>Processing certificate requests</li> <li>Issuing and managing certificates</li> </ul> <p>It is also possible to create your own Certificate Authority. Although risky in the Internet environment, it may be useful within an Intranet where the organization can easily verify the identities of individuals and servers.</p> <h4><a name="certificatemanagement" id="certificatemanagement">Certificate Management</a></h4> <p>Establishing a Certificate Authority is a responsibility which requires a solid administrative, technical and management framework. Certificate Authorities not only issue certificates, they also manage them -- that is, they determine for how long certificates remain valid, they renew them and keep lists of certificates that were issued in the past but are no longer valid (Certificate Revocation Lists, or CRLs).</p> <p>For example, if Alice is entitled to a certificate as an employee of a company but has now left that company, her certificate may need to be revoked. Because certificates are only issued after the subject's identity has been verified and can then be passed around to all those with whom the subject may communicate, it is impossible to tell from the certificate alone that it has been revoked. Therefore when examining certificates for validity it is necessary to contact the issuing Certificate Authority to check CRLs -- this is usually not an automated part of the process.</p> <div class="note">
<p><strong>Note</strong></p> <p>If you use a Certificate Authority that browsers are not configured to trust by default, it is necessary to load the Certificate Authority certificate into the browser, enabling the browser to validate server certificates signed by that Certificate Authority. Doing so may be dangerous, since once loaded, the browser will accept all certificates signed by that Certificate Authority.</p> </div>   <h2 id="ssl">Secure Sockets Layer (SSL)</h2> <p>The Secure Sockets Layer protocol is a protocol layer which may be placed between a reliable connection-oriented network layer protocol (e.g. TCP/IP) and the application protocol layer (e.g. HTTP). SSL provides for secure communication between client and server by allowing mutual authentication, the use of digital signatures for integrity and encryption for privacy.</p> <p>The protocol is designed to support a range of choices for specific algorithms used for cryptography, digests and signatures. This allows algorithm selection for specific servers to be made based on legal, export or other concerns and also enables the protocol to take advantage of new algorithms. Choices are negotiated between client and server when establishing a protocol session.</p> <h3><a name="table4" id="table4">Table 4: Versions of the SSL protocol</a></h3> <table class="bordered"> <tr>
<th>Version</th> <th>Source</th> <th>Description</th> </tr> <tr>
<td>SSL v2.0</td> <td>Vendor Standard (from Netscape Corp.)</td> <td>First SSL protocol for which implementations exist</td> </tr> <tr>
<td>SSL v3.0</td> <td>Expired Internet Draft (from Netscape Corp.) [<a href="#SSL3">SSL3</a>]</td> <td>Revisions to prevent specific security attacks, add non-RSA ciphers and support for certificate chains</td> </tr> <tr>
<td>TLS v1.0</td> <td>Proposed Internet Standard (from IETF) [<a href="#TLS1">TLS1</a>]</td> <td>Revision of SSL 3.0 to update the MAC layer to HMAC, add block padding for block ciphers, message order standardization and more alert messages.</td> </tr> <tr>
<td>TLS v1.1</td> <td>Proposed Internet Standard (from IETF) [<a href="#TLS11">TLS11</a>]</td> <td>Update of TLS 1.0 to add protection against Cipher block chaining (CBC) attacks.</td> </tr> <tr>
<td>TLS v1.2</td> <td>Proposed Internet Standard (from IETF) [<a href="#TLS12">TLS12</a>]</td> <td>Update of TLS 1.1 deprecating MD5 as hash, and adding incompatibility to SSL so it will never negotiate the use of SSLv2.</td> </tr> </table> <p>There are a number of versions of the SSL protocol, as shown in <a href="#table4">Table 4</a>. As noted there, one of the benefits in SSL 3.0 is that it adds support of certificate chain loading. This feature allows a server to pass a server certificate along with issuer certificates to the browser. Chain loading also permits the browser to validate the server certificate, even if Certificate Authority certificates are not installed for the intermediate issuers, since they are included in the certificate chain. SSL 3.0 is the basis for the Transport Layer Security [<a href="#TLS1">TLS</a>] protocol standard, currently in development by the Internet Engineering Task Force (IETF).</p> <h3><a name="session" id="session">Establishing a Session</a></h3> <p>The SSL session is established by following a handshake sequence between client and server, as shown in <a href="#figure1">Figure 1</a>. This sequence may vary, depending on whether the server is configured to provide a server certificate or request a client certificate. Although cases exist where additional handshake steps are required for management of cipher information, this article summarizes one common scenario. See the SSL specification for the full range of possibilities.</p> <div class="note">
<p><strong>Note</strong></p> <p>Once an SSL session has been established, it may be reused. This avoids the performance penalty of repeating the many steps needed to start a session. To do this, the server assigns each SSL session a unique session identifier which is cached in the server and which the client can use in future connections to reduce the handshake time (until the session identifier expires from the cache of the server).</p> </div> <p class="figure"> <img src="data:image/gif;base64,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" alt="" width="423" height="327"><br> <a id="figure1" name="figure1"><dfn>Figure 1</dfn></a>: Simplified SSL Handshake Sequence</p> <p>The elements of the handshake sequence, as used by the client and server, are listed below:</p> <ol> <li>Negotiate the Cipher Suite to be used during data transfer</li> <li>Establish and share a session key between client and server</li> <li>Optionally authenticate the server to the client</li> <li>Optionally authenticate the client to the server</li> </ol> <p>The first step, Cipher Suite Negotiation, allows the client and server to choose a Cipher Suite supported by both of them. The SSL3.0 protocol specification defines 31 Cipher Suites. A Cipher Suite is defined by the following components:</p> <ul> <li>Key Exchange Method</li> <li>Cipher for Data Transfer</li> <li>Message Digest for creating the Message Authentication Code (MAC)</li> </ul> <p>These three elements are described in the sections that follow.</p> <h3><a name="keyexchange" id="keyexchange">Key Exchange Method</a></h3> <p>The key exchange method defines how the shared secret symmetric cryptography key used for application data transfer will be agreed upon by client and server. SSL 2.0 uses RSA key exchange only, while SSL 3.0 supports a choice of key exchange algorithms including RSA key exchange (when certificates are used), and Diffie-Hellman key exchange (for exchanging keys without certificates, or without prior communication between client and server).</p> <p>One variable in the choice of key exchange methods is digital signatures -- whether or not to use them, and if so, what kind of signatures to use. Signing with a private key provides protection against a man-in-the-middle-attack during the information exchange used to generating the shared key [<a href="#AC96">AC96</a>, p516].</p> <h3><a name="ciphertransfer" id="ciphertransfer">Cipher for Data Transfer</a></h3> <p>SSL uses conventional symmetric cryptography, as described earlier, for encrypting messages in a session. There are nine choices of how to encrypt, including the option not to encrypt:</p> <ul> <li>No encryption</li> <li>Stream Ciphers <ul> <li>RC4 with 40-bit keys</li> <li>RC4 with 128-bit keys</li> </ul>
</li> <li>CBC Block Ciphers <ul>
<li>RC2 with 40 bit key</li> <li>DES with 40 bit key</li> <li>DES with 56 bit key</li> <li>Triple-DES with 168 bit key</li> <li>Idea (128 bit key)</li> <li>Fortezza (96 bit key)</li> </ul>
</li> </ul> <p>"CBC" refers to Cipher Block Chaining, which means that a portion of the previously encrypted cipher text is used in the encryption of the current block. "DES" refers to the Data Encryption Standard [<a href="#AC96">AC96</a>, ch12], which has a number of variants (including DES40 and 3DES_EDE). "Idea" is currently one of the best and cryptographically strongest algorithms available, and "RC2" is a proprietary algorithm from RSA DSI [<a href="#AC96">AC96</a>, ch13].</p> <h3><a name="digestfunction" id="digestfunction">Digest Function</a></h3> <p>The choice of digest function determines how a digest is created from a record unit. SSL supports the following:</p> <ul> <li>No digest (Null choice)</li> <li>MD5, a 128-bit hash</li> <li>Secure Hash Algorithm (SHA-1), a 160-bit hash</li> </ul> <p>The message digest is used to create a Message Authentication Code (MAC) which is encrypted with the message to verify integrity and to protect against replay attacks.</p> <h3><a name="handshake" id="handshake">Handshake Sequence Protocol</a></h3> <p>The handshake sequence uses three protocols:</p> <ul> <li>The <dfn>SSL Handshake Protocol</dfn> for performing the client and server SSL session establishment.</li> <li>The <dfn>SSL Change Cipher Spec Protocol</dfn> for actually establishing agreement on the Cipher Suite for the session.</li> <li>The <dfn>SSL Alert Protocol</dfn> for conveying SSL error messages between client and server.</li> </ul> <p>These protocols, as well as application protocol data, are encapsulated in the <dfn>SSL Record Protocol</dfn>, as shown in <a href="#figure2">Figure 2</a>. An encapsulated protocol is transferred as data by the lower layer protocol, which does not examine the data. The encapsulated protocol has no knowledge of the underlying protocol.</p> <p class="figure"> <img src="data:image/gif;base64,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" alt="" width="428" height="217"><br> <a id="figure2" name="figure2"><dfn>Figure 2</dfn></a>: SSL Protocol Stack </p> <p>The encapsulation of SSL control protocols by the record protocol means that if an active session is renegotiated the control protocols will be transmitted securely. If there was no previous session, the Null cipher suite is used, which means there will be no encryption and messages will have no integrity digests, until the session has been established.</p> <h3><a name="datatransfer" id="datatransfer">Data Transfer</a></h3> <p>The SSL Record Protocol, shown in <a href="#figure3">Figure 3</a>, is used to transfer application and SSL Control data between the client and server, where necessary fragmenting this data into smaller units, or combining multiple higher level protocol data messages into single units. It may compress, attach digest signatures, and encrypt these units before transmitting them using the underlying reliable transport protocol (Note: currently, no major SSL implementations include support for compression).</p> <p class="figure"> <img src="data:image/gif;base64,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" alt="" width="423" height="323"><br> <a id="figure3" name="figure3"><dfn>Figure 3</dfn></a>: SSL Record Protocol </p> <h3><a name="securehttp" id="securehttp">Securing HTTP Communication</a></h3> <p>One common use of SSL is to secure Web HTTP communication between a browser and a webserver. This does not preclude the use of non-secured HTTP - the secure version (called HTTPS) is the same as plain HTTP over SSL, but uses the URL scheme <code>https</code> rather than <code>http</code>, and a different server port (by default, port 443). This functionality is a large part of what <code class="module"><a href="../mod/mod_ssl.html">mod_ssl</a></code> provides for the Apache webserver.</p>   <h2 id="references">References</h2> <dl> <dt><a id="AC96" name="AC96">[AC96]</a></dt> <dd>Bruce Schneier, <q>Applied Cryptography</q>, 2nd Edition, Wiley, 1996. See <a href="http://www.counterpane.com/">http://www.counterpane.com/</a> for various other materials by Bruce Schneier.</dd> <dt><a id="ASN1" name="ASN1">[ASN1]</a></dt> <dd>ITU-T Recommendation X.208, <q>Specification of Abstract Syntax Notation One (ASN.1)</q>, last updated 2008. See <a href="http://www.itu.int/ITU-T/asn1/">http://www.itu.int/ITU-T/asn1/</a>. </dd> <dt><a id="X509" name="X509">[X509]</a></dt> <dd>ITU-T Recommendation X.509, <q>The Directory - Authentication Framework</q>. For references, see <a href="http://en.wikipedia.org/wiki/X.509">http://en.wikipedia.org/wiki/X.509</a>. </dd> <dt><a id="PKCS" name="PKCS">[PKCS]</a></dt> <dd>
<q>Public Key Cryptography Standards (PKCS)</q>, RSA Laboratories Technical Notes, See <a href="http://www.rsasecurity.com/rsalabs/pkcs/">http://www.rsasecurity.com/rsalabs/pkcs/</a>.</dd> <dt><a id="MIME" name="MIME">[MIME]</a></dt> <dd>N. Freed, N. Borenstein, <q>Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</q>, RFC2045. See for instance <a href="http://tools.ietf.org/html/rfc2045">http://tools.ietf.org/html/rfc2045</a>.</dd> <dt><a id="SSL3" name="SSL3">[SSL3]</a></dt> <dd>Alan O. Freier, Philip Karlton, Paul C. Kocher, <q>The SSL Protocol Version 3.0</q>, 1996. See <a href="http://www.netscape.com/eng/ssl3/draft302.txt">http://www.netscape.com/eng/ssl3/draft302.txt</a>.</dd> <dt><a id="TLS1" name="TLS1">[TLS1]</a></dt> <dd>Tim Dierks, Christopher Allen, <q>The TLS Protocol Version 1.0</q>, 1999. See <a href="http://ietf.org/rfc/rfc2246.txt">http://ietf.org/rfc/rfc2246.txt</a>.</dd> <dt><a id="TLS11" name="TLS11">[TLS11]</a></dt> <dd>
<q>The TLS Protocol Version 1.1</q>, 2006. See <a href="http://tools.ietf.org/html/rfc4346">http://tools.ietf.org/html/rfc4346</a>.</dd> <dt><a id="TLS12" name="TLS12">[TLS12]</a></dt> <dd>
<q>The TLS Protocol Version 1.2</q>, 2008. See <a href="http://tools.ietf.org/html/rfc5246">http://tools.ietf.org/html/rfc5246</a>.</dd> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018 The Apache Software Foundation<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://httpd.apache.org/docs/2.4/en/ssl/ssl_intro.html" class="_attribution-link">https://httpd.apache.org/docs/2.4/en/ssl/ssl_intro.html</a>
  </p>
</div>
