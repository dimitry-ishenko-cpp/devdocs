<h1 id="id1">15. Eventlog encodings</h1>
<div class="_sphinx"> <div itemprop="articleBody">   <p id="eventlog-encodings">This section documents the encodings of the events emitted to GHC’s <a class="reference internal" href="runtime_control.html#rts-eventlog"><span class="std std-ref">event log</span></a>. These events can include information about the thread scheduling events, garbage collection statistics, profiling information, user-defined tracing events.</p> <p>This section is intended for implementors of tooling which consume these events. GHC ships with a C header file (<code>EventlogFormat.h</code>) which provides symbolic names for the event type IDs described in this file.</p>  <h2 id="event-log-format">15.1. Event log format</h2> <p>The log format is designed to be extensible: old tools should be able to parse (but not necessarily understand all of) new versions of the format, and new tools will be able to understand old log files.</p> <ul class="simple"> <li>The format is endian-independent: all values are represented in big-endian order.</li> <li>The format is extensible:<ul> <li>The header describes each event type and its length. Tools that don’t recognise a particular event type can skip those events.</li> <li>There is room for extra information in the event type specification, which can be ignored by older tools.</li> <li>Events can have extra information added, but existing fields cannot be changed. Tools should ignore extra fields at the end of the event record.</li> </ul> </li> </ul> <p>The event-log stream begins with a header describing the event types (<code>EventType</code>) present in the file. The header is followed by the event records (<code>Event</code>) themselves, each of which start with the event type id and a 64-bit timestamp:</p> <pre data-language="none">EventLog :
      EVENT_HEADER_BEGIN
      EventType*
      EVENT_HEADER_END
      EVENT_DATA_BEGIN
      Event*
      EVENT_DATA_END

EventType :
      EVENT_ET_BEGIN
      Word16         -- event type id, unique identifier for this event
      Int16          -- &gt;=0  size of the event record in bytes (minus the event type id and timestamp fields)
                     -- -1   variable size
      Word32         -- size of the event description in bytes
      Word8*         -- event description, UTF8 encoded string describing the event
      Word32         -- size of the extra info in bytes
      Word8*         -- extra info (for future extensions)
      EVENT_ET_END

Event :
      Word16         -- event type id, as included in the event log header
      Word64         -- timestamp (nanoseconds)
      [Word16]       -- length of the rest (optional, for variable-sized events only)
      ... event specific info ...
</pre> <p>There are two classes of event types:</p>  <ul class="simple"> <li>
<em>Fixed size</em>: All event records of a fixed-sized type are of the same length, the size given in the header event-log header.</li> <li>
<em>Variable size</em>: Each event record includes a length field.</li> </ul>    <h2 id="runtime-system-diagnostics">15.2. Runtime system diagnostics</h2>  <ul class="simple"> <li><code>ThreadId ~ Word32</code></li> <li><code>CapNo ~ Word16</code></li> <li><code>CapSetId ~ Word32</code></li> </ul>   <h3 id="capability-sets">15.2.1. Capability sets</h3> <p>TODO</p>   <h3 id="environment-information">15.2.2. Environment information</h3> <p>These events are typically produced during program startup and describe the environment which the program is being run in.</p> <dl class="event-type"> <dt id="event-type-RTS_IDENTIFIER">
<code>RTS_IDENTIFIER</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">29</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">Capability set</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">Runtime system name and version.</td> </tr>  </table> <p>Describes the name and version of the runtime system responsible for the indicated capability set.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-PROGRAM_ARGS">
<code>PROGRAM_ARGS</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">30</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">Capability set</td> </tr> <tr>
<th class="field-name">Field [String]:</th>
<td class="field-body">The command-line arguments passed to the program</td> </tr>  </table> <p>Describes the command-line used to start the program.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-PROGRAM_ENV">
<code>PROGRAM_ENV</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">31</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">Capability set</td> </tr> <tr>
<th class="field-name">Field [String]:</th>
<td class="field-body">The environment variable name/value pairs. (TODO: encoding?)</td> </tr>  </table> <p>Describes the environment variables present in the program’s environment.</p> </dd>
</dl>   <h3 id="thread-and-scheduling-events">15.2.3. Thread and scheduling events</h3> <dl class="event-type"> <dt id="event-type-CREATE_THREAD">
<code>CREATE_THREAD</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">0</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">thread id</td> </tr>  </table> <p>Marks the creation of a Haskell thread.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-RUN_THREAD">
<code>RUN_THREAD</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">1</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">thread id</td> </tr>  </table> <p>The indicated thread has started running.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-STOP_THREAD">
<code>STOP_THREAD</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">
<p class="first">2</p> </td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">
<p class="first">fixed</p> </td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">
<p class="first">thread id</p> </td> </tr> <tr>
<th class="field-name">Field Word16:</th>
<td class="field-body">
<p class="first">status</p> <ul class="simple"> <li>1: HeapOverflow</li> <li>2: StackOverflow</li> <li>3: ThreadYielding</li> <li>4: ThreadBlocked</li> <li>5: ThreadFinished</li> <li>6: ForeignCall</li> <li>7: BlockedOnMVar</li> <li>8: BlockedOnBlackHole</li> <li>9: BlockedOnRead</li> <li>10: BlockedOnWrite</li> <li>11: BlockedOnDelay</li> <li>12: BlockedOnSTM</li> <li>13: BlockedOnDoProc</li> <li>16: BlockedOnMsgThrowTo</li> </ul> </td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">
<p class="first last">thread id of thread being blocked on (only for some status values)</p> </td> </tr>  </table> <p>The indicated thread has stopped running for the reason given by <code>status</code>.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-THREAD_RUNNABLE">
<code>THREAD_RUNNABLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">3</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">thread id</td> </tr>  </table> <p>The indicated thread is has been marked as ready to run.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-MIGRATE_THREAD">
<code>MIGRATE_THREAD</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">4</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">thread id</td> </tr> <tr>
<th class="field-name">Field CapNo:</th>
<td class="field-body">capability</td> </tr>  </table> <p>The indicated thread has been migrated to a new capability.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-THREAD_WAKEUP">
<code>THREAD_WAKEUP</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">8</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">thread id</td> </tr> <tr>
<th class="field-name">Field CapNo:</th>
<td class="field-body">other capability</td> </tr>  </table> <p>The indicated thread has been woken up on another capability.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-THREAD_LABEL">
<code>THREAD_LABEL</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">44</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field ThreadId:</th>
<td class="field-body">thread id</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">label</td> </tr>  </table> <p>The indicated thread has been given a label (e.g. with <a class="reference external" href="../libraries/base-4.17.0.0/ghc-conc.html#v:labelThread">GHC.Conc.labelThread</a>).</p> </dd>
</dl>   <h3 id="gc-events">15.2.4. Garbage collector events</h3> <p id="garbage-collector-events">The following events mark various points of the lifecycle of a moving garbage collection.</p> <p>A typical garbage collection will look something like the following:</p> <ol class="arabic simple"> <li>A capability realizes that it needs a garbage collection (e.g. as a result of running out of nursery) and requests a garbage collection. This is marked by <a class="reference internal" href="#event-type-REQUEST_SEQ_GC"><code>REQUEST_SEQ_GC</code></a> or <a class="reference internal" href="#event-type-REQUEST_PAR_GC"><code>REQUEST_PAR_GC</code></a>.</li> <li>As other capabilities reach yield points and suspend execution they emit <a class="reference internal" href="#event-type-STOP_THREAD"><code>STOP_THREAD</code></a> events.</li> <li>When all capabilities have suspended execution, collection will begin, marked by a <a class="reference internal" href="#event-type-GC_START"><code>GC_START</code></a> event.</li> <li>As individual parallel GC threads commence with scavenging they will emit <a class="reference internal" href="#event-type-GC_WORK"><code>GC_WORK</code></a> events.</li> <li>If a parallel GC thread runs out of work it will emit a <a class="reference internal" href="#event-type-GC_IDLE"><code>GC_IDLE</code></a> event. If it is later handed more work it will emit another <a class="reference internal" href="#event-type-GC_WORK"><code>GC_WORK</code></a> event.</li> <li>Eventually when scavenging has finished a <a class="reference internal" href="#event-type-GC_DONE"><code>GC_DONE</code></a> event will be emitted by each GC thread.</li> <li>A bit of book-keeping is performed.</li> <li>A <a class="reference internal" href="#event-type-GC_END"><code>GC_END</code></a> event will be emitted marking the end of the GC cycle.</li> <li>A <a class="reference internal" href="#event-type-HEAP_SIZE"><code>HEAP_SIZE</code></a> event will be emitted giving the current size of the heap, in bytes, calculated by how many megablocks are allocated.</li> <li>A <a class="reference internal" href="#event-type-BLOCKS_SIZE"><code>BLOCKS_SIZE</code></a> event will be emitted giving the current size of the heap, in bytes, calculated by how many blocks are allocated.</li> <li>A <a class="reference internal" href="#event-type-GC_STATS_GHC"><code>GC_STATS_GHC</code></a> event will be emitted containing various details of the collection and heap state.</li> <li>In the case of a major collection, a <a class="reference internal" href="#event-type-HEAP_LIVE"><code>HEAP_LIVE</code></a> event will be emitted describing the current size of the live on-heap data.</li> <li>In the case of the <a class="reference internal" href="phases.html#ghc-flag--threaded"><code>-threaded</code></a> RTS, a <a class="reference internal" href="#event-type-SPARK_COUNTERS"><code>SPARK_COUNTERS</code></a> event will be emitted giving details on how many sparks have been created, evaluated, and GC’d.</li> <li>As mutator threads resume execution they will emit <a class="reference internal" href="#event-type-RUN_THREAD"><code>RUN_THREAD</code></a> events.</li> <li>A <a class="reference internal" href="#event-type-MEM_RETURN"><code>MEM_RETURN</code></a> event will be emitted containing details about currently live mblocks, how many we think we need and whether we could return excess to the OS.</li> </ol> <p>Note that in the case of the concurrent non-moving collector additional events will be emitted during the concurrent phase of collection. These are described in <a class="reference internal" href="#nonmoving-gc-events"><span class="std std-ref">Non-moving GC event output</span></a>.</p> <dl class="event-type"> <dt id="event-type-GC_START">
<code>GC_START</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">9</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A garbage collection pass has been started.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-GC_END">
<code>GC_END</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">10</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A garbage collection pass has been finished.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-REQUEST_SEQ_GC">
<code>REQUEST_SEQ_GC</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">11</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A sequential garbage collection has been requested by a capability.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-REQUEST_PAR_GC">
<code>REQUEST_PAR_GC</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">12</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A parallel garbage collection has been requested by a capability.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-GC_IDLE">
<code>GC_IDLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">20</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>An idle-time garbage collection has been started.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-GC_WORK">
<code>GC_WORK</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">21</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the start of concurrent scavenging.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-GC_DONE">
<code>GC_DONE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">22</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the end of concurrent scavenging.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-GC_STATS_GHC">
<code>GC_STATS_GHC</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">53</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word16:</th>
<td class="field-body">generation of collection</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">bytes copied</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">bytes of slop found</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">bytes of fragmentation, the difference between total mblock size and total block size. When all mblocks are full of full blocks, this number is 0.</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">number of parallel garbage collection threads</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">maximum number of bytes copied by any single collector thread</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">total bytes copied by all collector threads</td> </tr>  </table> <p>Report various information about a major collection.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-GC_GLOBAL_SYNC">
<code>GC_GLOBAL_SYNC</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">54</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>TODO</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-MEM_RETURN">
<code>MEM_RETURN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">90</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">currently allocated mblocks</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">the number of mblocks we would like to retain</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">the number of mblocks which we returned to the OS</td> </tr>  </table> <p>Report information about currently allocation megablocks and attempts made to return them to the operating system. If your heap is fragmented then the current value will be greater than needed value but returned will be less than the difference between the two.</p> </dd>
</dl>   <h3 id="heap-events-and-statistics">15.2.5. Heap events and statistics</h3> <dl class="event-type"> <dt id="event-type-HEAP_ALLOCATED">
<code>HEAP_ALLOCATED</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">49</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">allocated bytes</td> </tr>  </table> <p>A new chunk of heap has been allocated by the indicated capability set.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-HEAP_SIZE">
<code>HEAP_SIZE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">50</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">heap size in bytes</td> </tr>  </table> <p>Report the heap size, calculated by the number of megablocks currently allocated.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-BLOCKS_SIZE">
<code>BLOCKS_SIZE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">91</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">heap size in bytes</td> </tr>  </table> <p>Report the heap size, calculated by the number of blocks currently allocated.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-HEAP_LIVE">
<code>HEAP_LIVE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">51</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">heap size in bytes</td> </tr>  </table> <p>Report the live heap size.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-HEAP_INFO_GHC">
<code>HEAP_INFO_GHC</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">52</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapSetId:</th>
<td class="field-body">heap capability set</td> </tr> <tr>
<th class="field-name">Field Word16:</th>
<td class="field-body">number of garbage collection generations</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">maximum heap size</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">allocation area size</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">MBlock size</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">Block size</td> </tr>  </table> <p>Report various information about the heap configuration. Typically produced during RTS initialization..</p> </dd>
</dl>   <h3 id="spark-events">15.2.6. Spark events</h3> <dl class="event-type"> <dt id="event-type-CREATE_SPARK_THREAD">
<code>CREATE_SPARK_THREAD</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">15</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A thread has been created to perform spark evaluation.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_COUNTERS">
<code>SPARK_COUNTERS</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">34</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A periodic reporting of various statistics of spark evaluation.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_CREATE">
<code>SPARK_CREATE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">35</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A spark has been added to the spark pool.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_DUD">
<code>SPARK_DUD</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">36</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>TODO</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_OVERFLOW">
<code>SPARK_OVERFLOW</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">37</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>TODO</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_RUN">
<code>SPARK_RUN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">38</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Evaluation has started on a spark.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_STEAL">
<code>SPARK_STEAL</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">39</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word16:</th>
<td class="field-body">capability from which the spark was stolen</td> </tr>  </table> <p>A spark has been stolen from another capability for evaluation.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_FIZZLE">
<code>SPARK_FIZZLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">40</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A spark has been GC’d before being evaluated.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-SPARK_GC">
<code>SPARK_GC</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">41</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>An unevaluated spark has been garbage collected.</p> </dd>
</dl>   <h3 id="capability-events">15.2.7. Capability events</h3> <dl class="event-type"> <dt id="event-type-CAP_CREATE">
<code>CAP_CREATE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">45</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field CapNo:</th>
<td class="field-body">the capability number</td> </tr>  </table> <p>A capability has been started.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CAP_DELETE">
<code>CAP_DELETE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">46</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A capability has been deleted.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CAP_DISABLE">
<code>CAP_DISABLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">47</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A capability has been disabled.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CAP_ENABLE">
<code>CAP_ENABLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">48</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>A capability has been enabled.</p> </dd>
</dl>   <h3 id="task-events">15.2.8. Task events</h3> <dl class="event-type"> <dt id="event-type-TASK_CREATE">
<code>TASK_CREATE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">55</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field TaskId:</th>
<td class="field-body">task id</td> </tr> <tr>
<th class="field-name">Field CapNo:</th>
<td class="field-body">capability number</td> </tr> <tr><th class="field-name" colspan="2">Field KernelThreadId:</th></tr> <tr>
<td> </td>
<td class="field-body">The thread-id of the kernel thread which created the task.</td> </tr>  </table> <p>Marks the creation of a task.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-TASK_MIGRATE">
<code>TASK_MIGRATE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">56</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field TaskId:</th>
<td class="field-body">task id</td> </tr> <tr>
<th class="field-name">Field CapNo:</th>
<td class="field-body">old capability</td> </tr> <tr>
<th class="field-name">Field CapNo:</th>
<td class="field-body">new capability</td> </tr>  </table> <p>Marks the migration of a task to a new capability.</p> </dd>
</dl>   <h3 id="tracing-events">15.2.9. Tracing events</h3> <dl class="event-type"> <dt id="event-type-LOG_MSG">
<code>LOG_MSG</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">16</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">The message</td> </tr>  </table> <p>A log message from the runtime system.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-BLOCK_MARKER">
<code>BLOCK_MARKER</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">18</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">size</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">end time in nanoseconds</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">marker name</td> </tr>  </table> <p>TODO</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-USER_MSG">
<code>USER_MSG</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">19</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">message</td> </tr>  </table> <p>A user log message (from, e.g., <a class="reference external" href="../libraries/base-4.17.0.0/control-concurrent.html#v:traceEvent">Control.Concurrent.traceEvent</a>).</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-USER_MARKER">
<code>USER_MARKER</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">58</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">marker name</td> </tr>  </table> <p>A user marker (from <a class="reference external" href="../libraries/base-4.17.0.0/debug-trace.html#v:traceMarker">Debug.Trace.traceMarker</a>).</p> </dd>
</dl>    <h2 id="heap-profiler-events">15.3. Heap profiler event log output</h2> <p id="heap-profiler-event-log-output">The heap profiler can produce output to GHC’s event log, allowing samples to be correlated with other event log events over the program’s lifecycle.</p> <p>This section defines the layout of these events. The <code>String</code> type below is defined to be a UTF-8 encoded NUL-terminated string.</p>  <h3 id="metadata-event-types">15.3.1. Metadata event types</h3>  <h4 id="beginning-of-sample-stream">15.3.1.1. Beginning of sample stream</h4> <p>A single fixed-width event emitted during program start-up describing the samples that follow.</p> <dl class="event-type"> <dt id="event-type-HEAP_PROF_BEGIN">
<code>HEAP_PROF_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">
<p class="first">160</p> </td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">
<p class="first">variable</p> </td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">
<p class="first">profile ID</p> </td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">
<p class="first">sampling period in nanoseconds</p> </td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">
<p class="first">sample breadown type. One of,</p> <ul class="simple"> <li>
<code>HEAP_PROF_BREAKDOWN_COST_CENTER</code> (output from <a class="reference internal" href="profiling.html#rts-flag--hc"><code>-hc</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_CLOSURE_DESCR</code> (output from <a class="reference internal" href="profiling.html#rts-flag--hd"><code>-hd</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_RETAINER</code> (output from <a class="reference internal" href="profiling.html#rts-flag--hr"><code>-hr</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_MODULE</code> (output from <a class="reference internal" href="profiling.html#rts-flag--hm"><code>-hm</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_TYPE_DESCR</code> (output from <a class="reference internal" href="profiling.html#rts-flag--hy"><code>-hy</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_BIOGRAPHY</code> (output from <a class="reference internal" href="profiling.html#rts-flag--hb"><code>-hb</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_CLOSURE_TYPE</code> (output from <a class="reference internal" href="runtime_control.html#rts-flag--hT"><code>-hT</code></a>)</li> </ul> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">module filter</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">closure description filter</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">type description filter</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">cost centre filter</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">cost centre stack filter</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">retainer filter</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first last">biography filter</p> </td> </tr>  </table> </dd>
</dl>   <h4 id="cost-centre-definitions">15.3.1.2. Cost centre definitions</h4> <p>A variable-length packet produced once for each cost centre,</p> <dl class="event-type"> <dt id="event-type-HEAP_PROF_COST_CENTRE">
<code>HEAP_PROF_COST_CENTRE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">
<p class="first">161</p> </td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">
<p class="first">fixed</p> </td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">
<p class="first">cost centre number</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">label</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">module</p> </td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">
<p class="first">source location</p> </td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">
<p class="first">flags:</p> <ul class="last simple"> <li>bit 0: is the cost-centre a CAF?</li> </ul> </td> </tr>  </table> </dd>
</dl>   <h4 id="info-table-provenance-definitions">15.3.1.3. Info Table Provenance definitions</h4> <p>A message which describes an approximate source position for info tables. See <a class="reference internal" href="debug-info.html#ghc-flag--finfo-table-map"><code>-finfo-table-map</code></a> for more information.</p> <dl class="event-type"> <dt id="event-type-IPE">
<code>IPE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">169</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">info table address</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">table name</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">closure type</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">type</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">source position label</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">source position module</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">source position location</td> </tr>  </table> </dd>
</dl>   <h4 id="sample-event-types">15.3.1.4. Sample event types</h4> <p>A sample (consisting of a list of break-down classes, e.g. cost centres, and heap residency sizes), is to be encoded in the body of one or more events.</p> <p>We normally mark the beginning of a new sample with an <code>EVENT_HEAP_PROF_SAMPLE_BEGIN</code> event,</p> <dl class="event-type"> <dt id="event-type-HEAP_PROF_SAMPLE_BEGIN">
<code>HEAP_PROF_SAMPLE_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">sample number</td> </tr>  </table> <p>Marks the beginning of a heap profile sample.</p> </dd>
</dl> <p>Biographical profiling samples start with the <code>EVENT_HEAP_BIO_PROF_SAMPLE_BEGIN</code> event. These events also include a timestamp which indicates when the sample was taken. This is because all these samples will appear at the end of the eventlog due to how the biographical profiling mode works. You can use the timestamp to reorder the samples relative to the other events.</p> <dl class="event-type"> <dt id="event-type-HEAP_BIO_PROF_SAMPLE_BEGIN">
<code>HEAP_BIO_PROF_SAMPLE_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">166</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">sample number</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">eventlog timestamp in ns</td> </tr>  </table> </dd>
</dl> <p>A heap residency census will follow. Since events may only be up to 2^16^ bytes in length a single sample may need to be split among multiple <code>EVENT_HEAP_PROF_SAMPLE</code> events. The precise format of the census entries is determined by the break-down type.</p> <p>At the end of the sample period the <code>EVENT_HEAP_PROF_SAMPLE_END</code> event if emitted. This is useful to properly delimit the sampling period and to record the total time spent profiling.</p> <dl class="event-type"> <dt id="event-type-HEAP_PROF_SAMPLE_END">
<code>HEAP_PROF_SAMPLE_END</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">165</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">sample number</td> </tr>  </table> <p>Marks the end of a heap profile sample.</p> </dd>
</dl>   <h4 id="cost-centre-break-down">15.3.1.5. Cost-centre break-down</h4> <dl class="docutils"> <dt>A variable-length packet encoding a heap profile sample broken down by,</dt> <dd>
<ul class="first last simple"> <li>cost-centre (<a class="reference internal" href="profiling.html#rts-flag--hc"><code>-hc</code></a>)</li> </ul> </dd> </dl> <dl class="event-type"> <dt id="event-type-HEAP_PROF_SAMPLE_COST_CENTRE">
<code>HEAP_PROF_SAMPLE_COST_CENTRE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">163</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">profile ID</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">heap residency in bytes</td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">stack depth</td> </tr> <tr>
<th class="field-name">Field Word32[]:</th>
<td class="field-body">cost centre stack starting with inner-most (cost centre numbers)</td> </tr>  </table> </dd>
</dl>   <h4 id="string-break-down">15.3.1.6. String break-down</h4> <p>A variable-length event encoding a heap sample broken down by,</p>  <ul class="simple"> <li>type description (<a class="reference internal" href="profiling.html#rts-flag--hy"><code>-hy</code></a>)</li> <li>closure description (<a class="reference internal" href="profiling.html#rts-flag--hd"><code>-hd</code></a>)</li> <li>module (<a class="reference internal" href="profiling.html#rts-flag--hm"><code>-hm</code></a>)</li> </ul>  <dl class="event-type"> <dt id="event-type-HEAP_PROF_SAMPLE_STRING">
<code>HEAP_PROF_SAMPLE_STRING</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">164</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">profile ID</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">heap residency in bytes</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">type or closure description, or module name</td> </tr>  </table> </dd>
</dl>     <h2 id="time-profiler-events">15.4. Time profiler event log output</h2> <p id="time-profiler-event-log-output">The time profiling mode enabled by <a class="reference internal" href="profiling.html#rts-flag--p"><code>-p</code></a> also emits sample events to the eventlog. At the start of profiling the tick interval is emitted to the eventlog and then on each tick the current cost centre stack is emitted. Together these enable a user to construct an approximate track of the executation of their program.</p>  <h3 id="profile-begin-event">15.4.1. Profile begin event</h3> <dl class="event-type"> <dt id="event-type-PROF_BEGIN">
<code>PROF_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">168</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">tick interval, in nanoseconds</td> </tr>  </table> <p>Marks the beginning of a time profile.</p> </dd>
</dl>   <h3 id="profile-sample-event">15.4.2. Profile sample event</h3> <p>A variable-length packet encoding a profile sample.</p> <dl class="event-type"> <dt id="event-type-PROF_SAMPLE_COST_CENTRE">
<code>PROF_SAMPLE_COST_CENTRE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">167</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">capability</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">current profiling tick</td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">stack depth</td> </tr> <tr>
<th class="field-name">Field Word32[]:</th>
<td class="field-body">cost centre stack starting with inner-most (cost centre numbers)</td> </tr>  </table> </dd>
</dl>    <h2 id="biographical-profile-sample-event">15.5. Biographical profile sample event</h2> <p>A variable-length packet encoding a profile sample.</p> <dl class="event-type"> <dt id="event-type-BIO_PROF_SAMPLE_BEGIN">
<code>BIO_PROF_SAMPLE_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">166</td> </tr>  </table> <p>TODO</p> </dd>
</dl>   <h2 id="nonmoving-gc-events">15.6. Non-moving GC event output</h2> <p id="non-moving-gc-event-output">These events mark various stages of the <a class="reference internal" href="runtime_control.html#rts-flag---nonmoving-gc"><code>non-moving collection</code></a> lifecycle. These are enabled with the <code>+RTS -lg</code> event-set.</p> <p>A typical non-moving collection cycle will look something like the following:</p> <ol class="arabic simple"> <li>The preparatory phase of collection will emit the usual events associated with a moving collection. See <a class="reference internal" href="#gc-events"><span class="std std-ref">Garbage collector events</span></a> for details.</li> <li>The concurrent write barrier is enabled and the concurrent mark thread is started. From this point forward mutator threads may emit <a class="reference internal" href="#event-type-CONC_UPD_REM_SET_FLUSH"><code>CONC_UPD_REM_SET_FLUSH</code></a> events, indicating that they have flushed their capability-local update remembered sets.</li> <li>Concurrent marking begins, denoted by a <a class="reference internal" href="#event-type-CONC_MARK_BEGIN"><code>CONC_MARK_BEGIN</code></a> event.</li> <li>When the mark queue is depleted a <a class="reference internal" href="#event-type-CONC_MARK_END"><code>CONC_MARK_END</code></a> is emitted.</li> <li>If necessary (e.g. due to weak pointer marking), the marking process will continue, returning to step (3) above.</li> <li>When the collector has done as much concurrent marking as it can it will enter the post-mark synchronization phase of collection, denoted by a <a class="reference internal" href="#event-type-CONC_SYNC_BEGIN"><code>CONC_SYNC_BEGIN</code></a> event.</li> <li>Mutator threads will suspend execution and, if necessary, flush their update remembered sets (indicated by <a class="reference internal" href="#event-type-CONC_UPD_REM_SET_FLUSH"><code>CONC_UPD_REM_SET_FLUSH</code></a> events).</li> <li>The collector will do any final marking necessary (indicated by <a class="reference internal" href="#event-type-CONC_MARK_BEGIN"><code>CONC_MARK_BEGIN</code></a> and <a class="reference internal" href="#event-type-CONC_MARK_END"><code>CONC_MARK_END</code></a> events).</li> <li>The collector will do a small amount of sweeping, disable the write barrier, emit a <a class="reference internal" href="#event-type-CONC_SYNC_END"><code>CONC_SYNC_END</code></a> event, and allow mutators to resume</li> <li>The collector will begin the concurrent sweep phase, indicated by a <a class="reference internal" href="#event-type-CONC_SWEEP_BEGIN"><code>CONC_SWEEP_BEGIN</code></a> event.</li> <li>Once sweeping has concluded a <a class="reference internal" href="#event-type-CONC_SWEEP_END"><code>CONC_SWEEP_END</code></a> event will be emitted and the concurrent collector thread will terminate.</li> <li>A <a class="reference internal" href="#event-type-NONMOVING_HEAP_CENSUS"><code>NONMOVING_HEAP_CENSUS</code></a> event will be emitted describing the fragmentation state of the non-moving heap.</li> </ol> <dl class="event-type"> <dt id="event-type-CONC_MARK_BEGIN">
<code>CONC_MARK_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">200</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the beginning of marking by the concurrent collector.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CONC_MARK_END">
<code>CONC_MARK_END</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">201</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">number of objects which were marked in this marking phase.</td> </tr>  </table> <p>Marks the end of marking by the concurrent collector.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CONC_SYNC_BEGIN">
<code>CONC_SYNC_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">202</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the beginning of the concurrent garbage collector’s post-mark synchronization phase.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CONC_SYNC_END">
<code>CONC_SYNC_END</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">203</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the end of the concurrent garbage collector’s post-mark synchronization phase.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CONC_SWEEP_BEGIN">
<code>CONC_SWEEP_BEGIN</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">204</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the beginning of the concurrent garbage collector’s sweep phase.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CONC_SWEEP_END">
<code>CONC_SWEEP_END</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">205</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks the end of the concurrent garbage collector’s sweep phase.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-CONC_UPD_REM_SET_FLUSH">
<code>CONC_UPD_REM_SET_FLUSH</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">206</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Marks a capability flushing its local update remembered set accumulator.</p> </dd>
</dl>  <h3 id="non-moving-heap-census">15.6.1. Non-moving heap census</h3> <p>The non-moving heap census events (enabled with the <a class="reference internal" href="#"><code>+RTS -ln</code></a> event-set) are intended to provide insight into fragmentation of the non-moving heap.</p> <dl class="event-type"> <dt id="event-type-NONMOVING_HEAP_CENSUS">
<code>NONMOVING_HEAP_CENSUS</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">207</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word8:</th>
<td class="field-body">base-2 logarithm of <em>blk_sz</em>.</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">number of active segments.</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">number of filled segments.</td> </tr> <tr>
<th class="field-name">Field Word32:</th>
<td class="field-body">number of live blocks.</td> </tr>  </table> <p>Describes the occupancy of the <em>blk_sz</em> sub-heap.</p> </dd>
</dl>   <h3 id="ticky-event-format">15.6.2. Ticky counters</h3> <p id="ticky-counters">Programs compiled with <a class="reference internal" href="profiling.html#ghc-flag--ticky"><code>-ticky</code></a> and <a class="reference internal" href="phases.html#ghc-flag--eventlog"><code>-eventlog</code></a> and invoked with <a class="reference internal" href="#"><code>+RTS -lT</code></a> will emit periodic samples of the ticky entry counters to the eventlog.</p> <dl class="event-type"> <dt id="event-type-TICKY_COUNTER_DEF">
<code>TICKY_COUNTER_DEF</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">210</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">variable</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">counter ID</td> </tr> <tr>
<th class="field-name">Field Word16:</th>
<td class="field-body">arity/field count</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">argument kinds. This is the same as the synonymous field in the textual ticky summary.</td> </tr> <tr>
<th class="field-name">Field String:</th>
<td class="field-body">counter name</td> </tr>  </table> <p>Defines a ticky counter.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-TICKY_COUNTER_BEGIN_SAMPLE">
<code>TICKY_COUNTER_BEGIN_SAMPLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">212</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr>  </table> <p>Denotes the beginning of an atomic set of ticky-ticky profiler counter samples.</p> </dd>
</dl> <dl class="event-type"> <dt id="event-type-TICKY_COUNTER_SAMPLE">
<code>TICKY_COUNTER_SAMPLE</code> </dt> <dd>
<table class="docutils field-list" frame="void" rules="none"> <col class="field-name"> <col class="field-body">  <tr>
<th class="field-name">Tag:</th>
<td class="field-body">211</td> </tr> <tr>
<th class="field-name">Length:</th>
<td class="field-body">fixed</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">counter ID</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">number of times closures of this type has been entered.</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">number of allocations (words)</td> </tr> <tr>
<th class="field-name">Field Word64:</th>
<td class="field-body">number of times this has been allocated (words). Only produced for modules compiled with <a class="reference internal" href="profiling.html#ghc-flag--ticky-allocd"><code>-ticky-allocd</code></a>.</td> </tr>  </table> <p>Records the number of “ticks” recorded by a ticky-ticky counter single the last sample.</p> </dd>
</dl>    </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002&ndash;2007 The University Court of the University of Glasgow. All rights reserved.<br>Licensed under the Glasgow Haskell Compiler License.<br>
    <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/users_guide/eventlog-formats.html" class="_attribution-link">https://downloads.haskell.org/~ghc/9.4.2/docs/users_guide/eventlog-formats.html</a>
  </p>
</div>
