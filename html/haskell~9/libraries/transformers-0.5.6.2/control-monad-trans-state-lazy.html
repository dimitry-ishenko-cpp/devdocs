<h1 class="caption">Control.Monad.Trans.State.Lazy</h1>
<div class="_haskell-api">
<table class="info">
<tr>
<th valign="top">Copyright</th>
<td>(c) Andy Gill 2001<br>(c) Oregon Graduate Institute of Science and Technology 2001</td>
</tr>
<tr>
<th>License</th>
<td>BSD-style (see the file LICENSE)</td>
</tr>
<tr>
<th>Maintainer</th>
<td>R.Paterson@city.ac.uk</td>
</tr>
<tr>
<th>Stability</th>
<td>experimental</td>
</tr>
<tr>
<th>Portability</th>
<td>portable</td>
</tr>
<tr>
<th>Safe Haskell</th>
<td>Safe</td>
</tr>
<tr>
<th>Language</th>
<td>Haskell98</td>
</tr>
</table>
<div id="table-of-contents"><div id="contents-list">
<h4 class="caption" onclick="window.scrollTo(0,0)">Contents</h4>
<ul>
<li><a href="#g:1">The State monad</a></li>
<li><a href="#g:2">The StateT monad transformer</a></li>
<li><a href="#g:3">State operations</a></li>
<li><a href="#g:4">Lifting other operations</a></li>
<li>
<a href="#g:5">Examples</a><ul>
<li><a href="#g:6">State monads</a></li>
<li><a href="#g:7">Counting</a></li>
<li><a href="#g:8">Labelling trees</a></li>
</ul>
</li>
</ul>
</div></div>
<div id="description">
<h4 class="caption">Description</h4>
<p>Lazy state monads, passing an updatable state through a computation. See below for examples.</p>
<p>Some computations may not require the full power of state transformers:</p>
<ul>
<li>For a read-only state, see <a href="control-monad-trans-reader.html">Control.Monad.Trans.Reader</a>.</li>
<li>To accumulate a value without using it on the way, see <a href="control-monad-trans-writer.html">Control.Monad.Trans.Writer</a>.</li>
</ul>
<p>In this version, sequencing of computations is lazy, so that for example the following produces a usable result:</p>
<pre>evalState (sequence $ repeat $ do { n &lt;- get; put (n*2); return n }) 1</pre>
<p>For a strict version with the same interface, see <a href="control-monad-trans-state-strict.html">Control.Monad.Trans.State.Strict</a>.</p>
</div>
<a href="#g:1" id="g:1"><h2>The State monad</h2></a><p class="src">type <a id="t:State" class="def">State</a> s = <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s <a href="../base-4.17.0.0/data-functor-identity.html#t:Identity" title="Data.Functor.Identity">Identity</a> <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#State" class="link">Source</a> </p>
<p>A state monad parameterized by the type <code>s</code> of the state to carry.</p>
<p>The <code><a href="../base-4.17.0.0/control-monad.html#v:return" title="Control.Monad">return</a></code> function leaves the state unchanged, while <code>&gt;&gt;=</code> uses the final state of the first computation as the initial state of the second.</p>
<p class="src"><a id="v:state" class="def">state</a> <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#state" class="link">Source</a> </p>
<div class="subs arguments">
<h4 class="caption">Arguments</h4>
<table>
<tr>
<td class="src">:: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m</td>
<td class="doc empty"> </td>
</tr>
<tr>
<td class="src">=&gt; (s -&gt; (a, s))</td>
<td class="doc"><p>pure state transformer</p></td>
</tr>
<tr>
<td class="src">-&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a</td>
<td class="doc"><p>equivalent state-passing computation</p></td>
</tr>
</table>
</div>
<p>Construct a state monad computation from a function. (The inverse of <code><a href="control-monad-trans-state-lazy.html#v:runState" title="Control.Monad.Trans.State.Lazy">runState</a></code>.)</p>
<p class="src"><a id="v:runState" class="def">runState</a> <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#runState" class="link">Source</a> </p>
<div class="subs arguments">
<h4 class="caption">Arguments</h4>
<table>
<tr>
<td class="src">:: <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s a</td>
<td class="doc"><p>state-passing computation to execute</p></td>
</tr>
<tr>
<td class="src">-&gt; s</td>
<td class="doc"><p>initial state</p></td>
</tr>
<tr>
<td class="src">-&gt; (a, s)</td>
<td class="doc"><p>return value and final state</p></td>
</tr>
</table>
</div>
<p>Unwrap a state monad computation as a function. (The inverse of <code><a href="control-monad-trans-state-lazy.html#v:state" title="Control.Monad.Trans.State.Lazy">state</a></code>.)</p>
<p class="src"><a id="v:evalState" class="def">evalState</a> <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#evalState" class="link">Source</a> </p>
<div class="subs arguments">
<h4 class="caption">Arguments</h4>
<table>
<tr>
<td class="src">:: <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s a</td>
<td class="doc"><p>state-passing computation to execute</p></td>
</tr>
<tr>
<td class="src">-&gt; s</td>
<td class="doc"><p>initial value</p></td>
</tr>
<tr>
<td class="src">-&gt; a</td>
<td class="doc"><p>return value of the state computation</p></td>
</tr>
</table>
</div>
<p>Evaluate a state computation with the given initial state and return the final value, discarding the final state.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:evalState" title="Control.Monad.Trans.State.Lazy">evalState</a> m s = <a href="../base-4.17.0.0/data-tuple.html#v:fst" title="Data.Tuple">fst</a> (<a href="control-monad-trans-state-lazy.html#v:runState" title="Control.Monad.Trans.State.Lazy">runState</a> m s)</pre></li></ul>
<p class="src"><a id="v:execState" class="def">execState</a> <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#execState" class="link">Source</a> </p>
<div class="subs arguments">
<h4 class="caption">Arguments</h4>
<table>
<tr>
<td class="src">:: <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s a</td>
<td class="doc"><p>state-passing computation to execute</p></td>
</tr>
<tr>
<td class="src">-&gt; s</td>
<td class="doc"><p>initial value</p></td>
</tr>
<tr>
<td class="src">-&gt; s</td>
<td class="doc"><p>final state</p></td>
</tr>
</table>
</div>
<p>Evaluate a state computation with the given initial state and return the final state, discarding the final value.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:execState" title="Control.Monad.Trans.State.Lazy">execState</a> m s = <a href="../base-4.17.0.0/data-tuple.html#v:snd" title="Data.Tuple">snd</a> (<a href="control-monad-trans-state-lazy.html#v:runState" title="Control.Monad.Trans.State.Lazy">runState</a> m s)</pre></li></ul>
<p class="src"><a id="v:mapState" class="def">mapState</a> :: ((a, s) -&gt; (b, s)) -&gt; <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s a -&gt; <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#mapState" class="link">Source</a> </p>
<p>Map both the return value and final state of a computation using the given function.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:runState" title="Control.Monad.Trans.State.Lazy">runState</a> (<a href="control-monad-trans-state-lazy.html#v:mapState" title="Control.Monad.Trans.State.Lazy">mapState</a> f m) = f . <a href="control-monad-trans-state-lazy.html#v:runState" title="Control.Monad.Trans.State.Lazy">runState</a> m</pre></li></ul>
<p class="src"><a id="v:withState" class="def">withState</a> :: (s -&gt; s) -&gt; <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s a -&gt; <a href="control-monad-trans-state-lazy.html#t:State" title="Control.Monad.Trans.State.Lazy">State</a> s a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#withState" class="link">Source</a> </p>
<p><code><a href="control-monad-trans-state-lazy.html#v:withState" title="Control.Monad.Trans.State.Lazy">withState</a> f m</code> executes action <code>m</code> on a state modified by applying <code>f</code>.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:withState" title="Control.Monad.Trans.State.Lazy">withState</a> f m = <a href="control-monad-trans-state-lazy.html#v:modify" title="Control.Monad.Trans.State.Lazy">modify</a> f &gt;&gt; m</pre></li></ul>
<a href="#g:2" id="g:2"><h2>The StateT monad transformer</h2></a><p class="src">newtype <a id="t:StateT" class="def">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#StateT" class="link">Source</a> </p>
<p>A state transformer monad parameterized by:</p>
<ul>
<li>
<code>s</code> - The state.</li>
<li>
<code>m</code> - The inner monad.</li>
</ul>
<p>The <code><a href="../base-4.17.0.0/control-monad.html#v:return" title="Control.Monad">return</a></code> function leaves the state unchanged, while <code>&gt;&gt;=</code> uses the final state of the first computation as the initial state of the second.</p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table>
<tr>
<td class="src"><a id="v:StateT" class="def">StateT</a></td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><div class="subs fields">
<h4 class="caption">Fields</h4>
<ul><li>
<dfn class="src"><a id="v:runStateT" class="def">runStateT</a> :: s -&gt; m (a, s)</dfn> </li></ul>
</div></td></tr>
</table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:StateT">Instances</h5>
<details id="i:StateT" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="control-monad-trans-class.html#t:MonadTrans" title="Control.Monad.Trans.Class">MonadTrans</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-251" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:MonadTrans:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:lift">lift</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.Class.html#lift" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/control-monad-fail.html#t:MonadFail" title="Control.Monad.Fail">MonadFail</a> m =&gt; <a href="../base-4.17.0.0/control-monad-fail.html#t:MonadFail" title="Control.Monad.Fail">MonadFail</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-236" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:MonadFail:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:fail">fail</a> :: <a href="../base-4.17.0.0/data-string.html#t:String" title="Data.String">String</a> -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/Control.Monad.Fail.html#fail" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/control-monad-fix.html#t:MonadFix" title="Control.Monad.Fix">MonadFix</a> m =&gt; <a href="../base-4.17.0.0/control-monad-fix.html#t:MonadFix" title="Control.Monad.Fix">MonadFix</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-247" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:MonadFix:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:mfix">mfix</a> :: (a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/Control.Monad.Fix.html#mfix" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/control-monad-io-class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> m =&gt; <a href="../base-4.17.0.0/control-monad-io-class.html#t:MonadIO" title="Control.Monad.IO.Class">MonadIO</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-257" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:MonadIO:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:liftIO">liftIO</a> :: <a href="../base-4.17.0.0/system-io.html#t:IO" title="System.IO">IO</a> a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/Control.Monad.IO.Class.html#liftIO" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/data-functor-contravariant.html#t:Contravariant" title="Data.Functor.Contravariant">Contravariant</a> m =&gt; <a href="../base-4.17.0.0/data-functor-contravariant.html#t:Contravariant" title="Data.Functor.Contravariant">Contravariant</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-262" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:Contravariant:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:contramap">contramap</a> :: (a' -&gt; a) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a' <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/Data.Functor.Contravariant.html#contramap" class="link">Source</a> </p>
<p class="src"><a href="#v:-62--36-">(&gt;$)</a> :: b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/Data.Functor.Contravariant.html#%3E%24" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 (<a href="../base-4.17.0.0/data-functor.html#t:Functor" title="Data.Functor">Functor</a> m, <a href="../base-4.17.0.0/control-monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m) =&gt; <a href="../base-4.17.0.0/control-applicative.html#t:Alternative" title="Control.Applicative">Alternative</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-215" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:Alternative:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:empty">empty</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#empty" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--124--62-">(&lt;|&gt;)</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%3C%7C%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:some">some</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m [a] <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#some" class="link">Source</a> </p>
<p class="src"><a href="#v:many">many</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m [a] <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#many" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 (<a href="../base-4.17.0.0/data-functor.html#t:Functor" title="Data.Functor">Functor</a> m, <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m) =&gt; <a href="../base-4.17.0.0/control-applicative.html#t:Applicative" title="Control.Applicative">Applicative</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-204" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:Applicative:7"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:pure">pure</a> :: a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#pure" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--42--62-">(&lt;*&gt;)</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m (a -&gt; b) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%3C%2A%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:liftA2">liftA2</a> :: (a -&gt; b -&gt; c) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m c <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#liftA2" class="link">Source</a> </p>
<p class="src"><a href="#v:-42--62-">(*&gt;)</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%2A%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--42-">(&lt;*)</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%3C%2A" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/data-functor.html#t:Functor" title="Data.Functor">Functor</a> m =&gt; <a href="../base-4.17.0.0/data-functor.html#t:Functor" title="Data.Functor">Functor</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-199" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:Functor:8"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:fmap">fmap</a> :: (a -&gt; b) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#fmap" class="link">Source</a> </p>
<p class="src"><a href="#v:-60--36-">(&lt;$)</a> :: a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%3C%24" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-221" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:Monad:9"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:-62--62--61-">(&gt;&gt;=)</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; (a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%3E%3E%3D" class="link">Source</a> </p>
<p class="src"><a href="#v:-62--62-">(&gt;&gt;)</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#%3E%3E" class="link">Source</a> </p>
<p class="src"><a href="#v:return">return</a> :: a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#return" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="../base-4.17.0.0/control-monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> m =&gt; <a href="../base-4.17.0.0/control-monad.html#t:MonadPlus" title="Control.Monad">MonadPlus</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#line-241" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:StateT:MonadPlus:10"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="control-monad-trans-state-lazy.html">Control.Monad.Trans.State.Lazy</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:mzero">mzero</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#mzero" class="link">Source</a> </p>
<p class="src"><a href="#v:mplus">mplus</a> :: <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Base.html#mplus" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src"><a id="v:evalStateT" class="def">evalStateT</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; s -&gt; m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#evalStateT" class="link">Source</a> </p>
<p>Evaluate a state computation with the given initial state and return the final value, discarding the final state.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:evalStateT" title="Control.Monad.Trans.State.Lazy">evalStateT</a> m s = <a href="../base-4.17.0.0/control-monad.html#v:liftM" title="Control.Monad">liftM</a> <a href="../base-4.17.0.0/data-tuple.html#v:fst" title="Data.Tuple">fst</a> (<a href="control-monad-trans-state-lazy.html#v:runStateT" title="Control.Monad.Trans.State.Lazy">runStateT</a> m s)</pre></li></ul>
<p class="src"><a id="v:execStateT" class="def">execStateT</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; s -&gt; m s <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#execStateT" class="link">Source</a> </p>
<p>Evaluate a state computation with the given initial state and return the final state, discarding the final value.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:execStateT" title="Control.Monad.Trans.State.Lazy">execStateT</a> m s = <a href="../base-4.17.0.0/control-monad.html#v:liftM" title="Control.Monad">liftM</a> <a href="../base-4.17.0.0/data-tuple.html#v:snd" title="Data.Tuple">snd</a> (<a href="control-monad-trans-state-lazy.html#v:runStateT" title="Control.Monad.Trans.State.Lazy">runStateT</a> m s)</pre></li></ul>
<p class="src"><a id="v:mapStateT" class="def">mapStateT</a> :: (m (a, s) -&gt; n (b, s)) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s n b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#mapStateT" class="link">Source</a> </p>
<p>Map both the return value and final state of a computation using the given function.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:runStateT" title="Control.Monad.Trans.State.Lazy">runStateT</a> (<a href="control-monad-trans-state-lazy.html#v:mapStateT" title="Control.Monad.Trans.State.Lazy">mapStateT</a> f m) = f . <a href="control-monad-trans-state-lazy.html#v:runStateT" title="Control.Monad.Trans.State.Lazy">runStateT</a> m</pre></li></ul>
<p class="src"><a id="v:withStateT" class="def">withStateT</a> :: (s -&gt; s) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#withStateT" class="link">Source</a> </p>
<p><code><a href="control-monad-trans-state-lazy.html#v:withStateT" title="Control.Monad.Trans.State.Lazy">withStateT</a> f m</code> executes action <code>m</code> on a state modified by applying <code>f</code>.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:withStateT" title="Control.Monad.Trans.State.Lazy">withStateT</a> f m = <a href="control-monad-trans-state-lazy.html#v:modify" title="Control.Monad.Trans.State.Lazy">modify</a> f &gt;&gt; m</pre></li></ul>
<a href="#g:3" id="g:3"><h2>State operations</h2></a><p class="src"><a id="v:get" class="def">get</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m s <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#get" class="link">Source</a> </p>
<p>Fetch the current value of the state within the monad.</p>
<p class="src"><a id="v:put" class="def">put</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; s -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m () <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#put" class="link">Source</a> </p>
<p><code><a href="control-monad-trans-state-lazy.html#v:put" title="Control.Monad.Trans.State.Lazy">put</a> s</code> sets the state within the monad to <code>s</code>.</p>
<p class="src"><a id="v:modify" class="def">modify</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (s -&gt; s) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m () <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#modify" class="link">Source</a> </p>
<p><code><a href="control-monad-trans-state-lazy.html#v:modify" title="Control.Monad.Trans.State.Lazy">modify</a> f</code> is an action that updates the state to the result of applying <code>f</code> to the current state.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:modify" title="Control.Monad.Trans.State.Lazy">modify</a> f = <a href="control-monad-trans-state-lazy.html#v:get" title="Control.Monad.Trans.State.Lazy">get</a> &gt;&gt;= (<a href="control-monad-trans-state-lazy.html#v:put" title="Control.Monad.Trans.State.Lazy">put</a> . f)</pre></li></ul>
<p class="src"><a id="v:modify-39-" class="def">modify'</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (s -&gt; s) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m () <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#modify%27" class="link">Source</a> </p>
<p>A variant of <code><a href="control-monad-trans-state-lazy.html#v:modify" title="Control.Monad.Trans.State.Lazy">modify</a></code> in which the computation is strict in the new state.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:modify-39-" title="Control.Monad.Trans.State.Lazy">modify'</a> f = <a href="control-monad-trans-state-lazy.html#v:get" title="Control.Monad.Trans.State.Lazy">get</a> &gt;&gt;= ((<a href="../base-4.17.0.0/prelude.html#v:-36--33-" title="Prelude">$!</a>) <a href="control-monad-trans-state-lazy.html#v:put" title="Control.Monad.Trans.State.Lazy">put</a> . f)</pre></li></ul>
<p class="src"><a id="v:gets" class="def">gets</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; (s -&gt; a) -&gt; <a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#gets" class="link">Source</a> </p>
<p>Get a specific component of the state, using a projection function supplied.</p>
<ul><li><pre><a href="control-monad-trans-state-lazy.html#v:gets" title="Control.Monad.Trans.State.Lazy">gets</a> f = <a href="../base-4.17.0.0/control-monad.html#v:liftM" title="Control.Monad">liftM</a> f <a href="control-monad-trans-state-lazy.html#v:get" title="Control.Monad.Trans.State.Lazy">get</a></pre></li></ul>
<a href="#g:4" id="g:4"><h2>Lifting other operations</h2></a><p class="src"><a id="v:liftCallCC" class="def">liftCallCC</a> :: <a href="control-monad-signatures.html#t:CallCC" title="Control.Monad.Signatures">CallCC</a> m (a, s) (b, s) -&gt; <a href="control-monad-signatures.html#t:CallCC" title="Control.Monad.Signatures">CallCC</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) a b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#liftCallCC" class="link">Source</a> </p>
<p>Uniform lifting of a <code>callCC</code> operation to the new monad. This version rolls back to the original state on entering the continuation.</p>
<p class="src"><a id="v:liftCallCC-39-" class="def">liftCallCC'</a> :: <a href="control-monad-signatures.html#t:CallCC" title="Control.Monad.Signatures">CallCC</a> m (a, s) (b, s) -&gt; <a href="control-monad-signatures.html#t:CallCC" title="Control.Monad.Signatures">CallCC</a> (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) a b <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#liftCallCC%27" class="link">Source</a> </p>
<p>In-situ lifting of a <code>callCC</code> operation to the new monad. This version uses the current state on entering the continuation. It does not satisfy the uniformity property (see <a href="control-monad-signatures.html">Control.Monad.Signatures</a>).</p>
<p class="src"><a id="v:liftCatch" class="def">liftCatch</a> :: <a href="control-monad-signatures.html#t:Catch" title="Control.Monad.Signatures">Catch</a> e m (a, s) -&gt; <a href="control-monad-signatures.html#t:Catch" title="Control.Monad.Signatures">Catch</a> e (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#liftCatch" class="link">Source</a> </p>
<p>Lift a <code>catchE</code> operation to the new monad.</p>
<p class="src"><a id="v:liftListen" class="def">liftListen</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="control-monad-signatures.html#t:Listen" title="Control.Monad.Signatures">Listen</a> w m (a, s) -&gt; <a href="control-monad-signatures.html#t:Listen" title="Control.Monad.Signatures">Listen</a> w (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#liftListen" class="link">Source</a> </p>
<p>Lift a <code>listen</code> operation to the new monad.</p>
<p class="src"><a id="v:liftPass" class="def">liftPass</a> :: <a href="../base-4.17.0.0/control-monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; <a href="control-monad-signatures.html#t:Pass" title="Control.Monad.Signatures">Pass</a> w m (a, s) -&gt; <a href="control-monad-signatures.html#t:Pass" title="Control.Monad.Signatures">Pass</a> w (<a href="control-monad-trans-state-lazy.html#t:StateT" title="Control.Monad.Trans.State.Lazy">StateT</a> s m) a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/src/Control.Monad.Trans.State.Lazy.html#liftPass" class="link">Source</a> </p>
<p>Lift a <code>pass</code> operation to the new monad.</p>
<a href="#g:5" id="g:5"><h2>Examples</h2></a><a href="#g:6" id="g:6"><h3>State monads</h3></a><p>Parser from ParseLib with Hugs:</p>
<pre>type Parser a = StateT String [] a
   ==&gt; StateT (String -&gt; [(a,String)])</pre>
<p>For example, item can be written as:</p>
<pre>item = do (x:xs) &lt;- get
       put xs
       return x

type BoringState s a = StateT s Identity a
     ==&gt; StateT (s -&gt; Identity (a,s))

type StateWithIO s a = StateT s IO a
     ==&gt; StateT (s -&gt; IO (a,s))

type StateWithErr s a = StateT s Maybe a
     ==&gt; StateT (s -&gt; Maybe (a,s))</pre>
<a href="#g:7" id="g:7"><h3>Counting</h3></a><p>A function to increment a counter. Taken from the paper "Generalising Monads to Arrows", John Hughes (<a href="http://www.cse.chalmers.se/~rjmh/">http://www.cse.chalmers.se/~rjmh/</a>), November 1998:</p>
<pre>tick :: State Int Int
tick = do n &lt;- get
          put (n+1)
          return n</pre>
<p>Add one to the given number using the state monad:</p>
<pre>plusOne :: Int -&gt; Int
plusOne n = execState tick n</pre>
<p>A contrived addition example. Works only with positive numbers:</p>
<pre>plus :: Int -&gt; Int -&gt; Int
plus n x = execState (sequence $ replicate n tick) x</pre>
<a href="#g:8" id="g:8"><h3>Labelling trees</h3></a><p>An example from <em>The Craft of Functional Programming</em>, Simon Thompson (<a href="http://www.cs.kent.ac.uk/people/staff/sjt/">http://www.cs.kent.ac.uk/people/staff/sjt/</a>), Addison-Wesley 1999: "Given an arbitrary tree, transform it to a tree of integers in which the original elements are replaced by natural numbers, starting from 0. The same element has to be replaced by the same number at every occurrence, and when we meet an as-yet-unvisited element we have to find a 'new' number to match it with:"</p>
<pre>data Tree a = Nil | Node a (Tree a) (Tree a) deriving (Show, Eq)
type Table a = [a]</pre>
<pre>numberTree :: Eq a =&gt; Tree a -&gt; State (Table a) (Tree Int)
numberTree Nil = return Nil
numberTree (Node x t1 t2) = do
    num &lt;- numberNode x
    nt1 &lt;- numberTree t1
    nt2 &lt;- numberTree t2
    return (Node num nt1 nt2)
  where
    numberNode :: Eq a =&gt; a -&gt; State (Table a) Int
    numberNode x = do
        table &lt;- get
        case elemIndex x table of
            Nothing -&gt; do
                put (table ++ [x])
                return (length table)
            Just i -&gt; return i</pre>
<p>numTree applies numberTree with an initial state:</p>
<pre>numTree :: (Eq a) =&gt; Tree a -&gt; Tree Int
numTree t = evalState (numberTree t) []</pre>
<pre>testTree = Node "Zero" (Node "One" (Node "Two" Nil Nil) (Node "One" (Node "Zero" Nil Nil) Nil)) Nil
numTree testTree =&gt; Node 0 (Node 1 (Node 2 Nil Nil) (Node 1 (Node 0 Nil Nil) Nil)) Nil</pre>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; The University of Glasgow and others<br>Licensed under a BSD-style license (see top of the page).<br>
    <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/Control-Monad-Trans-State-Lazy.html" class="_attribution-link">https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/transformers-0.5.6.2/Control-Monad-Trans-State-Lazy.html</a>
  </p>
</div>
