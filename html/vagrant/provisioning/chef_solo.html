<h1 id="chef-solo-provisioner">  Chef Solo Provisioner </h1> <p><strong>Provisioner name: <code>chef_solo</code></strong></p> <p>The Vagrant Chef Solo provisioner allows you to provision the guest using <a href="https://www.chef.io/chef/">Chef</a>, specifically with <a href="https://docs.chef.io/chef_solo.html">Chef Solo</a>.</p> <p>Chef Solo is ideal for people who are already experienced with Chef, already have Chef cookbooks, or are looking to learn Chef. Specifically, this documentation page will not go into how to use Chef or how to write Chef cookbooks, since Chef is a complete system that is beyond the scope of a single page of documentation.</p> <blockquote class="alert alert-warning"> <p><strong>Warning:</strong> If you are not familiar with Chef and Vagrant already, I recommend starting with the <a href="shell.html">shell provisioner</a>. However, if you are comfortable with Vagrant already, Vagrant is the best way to learn Chef.</p> </blockquote>
<h2 id="options">  Options </h2> <p>This section lists the complete set of available options for the Chef Solo provisioner. More detailed examples of how to use the provisioner are available below this section.</p> <ul> <li>
<p><a href="#cookbooks_path"><code>cookbooks_path</code></a> (string or array) - A list of paths to where cookbooks are stored. By default this is "cookbooks", expecting a cookbooks folder relative to the Vagrantfile location.</p> </li> <li>
<p><a href="#data_bags_path"><code>data_bags_path</code></a> (string or array) - A path where data bags are stored. By default, no data bag path is set. Chef 12 or higher is required to use the array option. Chef 11 and lower only accept a string value.</p> </li> <li>
<p><a href="#environments_path"><code>environments_path</code></a> (string) - A path where environment definitions are located. By default, no environments folder is set.</p> </li> <li>
<p><a href="#nodes_path"><code>nodes_path</code></a> (string or array) - A list of paths where node objects (in JSON format) are stored. By default, no nodes path is set.</p> </li> <li>
<p><a href="#environment"><code>environment</code></a> (string) - The environment you want the Chef run to be a part of. This requires Chef 11.6.0 or later, and that <code>environments_path</code> is set.</p> </li> <li>
<p><a href="#recipe_url"><code>recipe_url</code></a> (string) - URL to an archive of cookbooks that Chef will download and use.</p> </li> <li>
<p><a href="#roles_path"><code>roles_path</code></a> (string or array) - A list of paths where roles are defined. By default this is empty. Multiple role directories are only supported by Chef 11.8.0 and later.</p> </li> <li>
<p><a href="#synced_folder_type"><code>synced_folder_type</code></a> (string) - The type of synced folders to use when sharing the data required for the provisioner to work properly. By default this will use the default synced folder type. For example, you can set this to "nfs" to use NFS synced folders.</p> </li> </ul> <p>In addition to all the options listed above, the Chef Solo provisioner supports the <a href="chef_common.html">common options for all Chef provisioners</a>.</p> <h2 id="specifying-a-run-list">  Specifying a Run List </h2> <p>The easiest way to get started with the Chef Solo provisioner is to just specify a <a href="https://docs.chef.io/nodes.html#about-run-lists">run list</a>. This looks like:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    chef.add_recipe "apache"
  end
end
</pre></div>
<p>This causes Vagrant to run Chef Solo with the "apache" cookbook. The cookbooks by default are looked for in the "cookbooks" directory relative to your project root. The directory structure ends up looking like this:</p> <div class="highlight"><pre class="highlight plaintext">$ tree
.
|-- Vagrantfile
|-- cookbooks
|   |-- apache
|       |-- recipes
|           |-- default.rb
</pre></div>
<p>The order of the calls to <code>add_recipe</code> will specify the order of the run list. Earlier recipes added with <code>add_recipe</code> are run before later recipes added.</p> <h2 id="custom-cookbooks-path">  Custom Cookbooks Path </h2> <p>Instead of using the default "cookbooks" directory, a custom cookbooks path can also be set via the <code>cookbooks_path</code> configuration directive:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    chef.cookbooks_path = "my_cookbooks"
  end
end
</pre></div>
<p>The path can be relative or absolute. If it is relative, it is relative to the project root.</p> <p>The configuration value can also be an array of paths:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    chef.cookbooks_path = ["cookbooks", "my_cookbooks"]
  end
end
</pre></div>
<h2 id="roles">  Roles </h2> <p>Vagrant also supports provisioning with <a href="https://docs.chef.io/roles.html">Chef roles</a>. This is done by specifying a path to a roles folder where roles are defined and by adding roles to your run list:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    chef.roles_path = "roles"
    chef.add_role("web")
  end
end
</pre></div>
<p>Just like the cookbooks path, the roles path is relative to the project root if a relative path is given.</p> <p>The configuration value can also be an array of paths on Chef 11.8.0 and newer. On older Chef versions only the first path is used.</p> <p><strong>Note:</strong> The name of the role file must be the same as the role name. For example the <code>web</code> role must be in the <code>roles_path</code> as web.json or web.rb. This is required by Chef itself, and is not a limitation imposed by Vagrant.</p> <h2 id="data-bags">  Data Bags </h2> <p><a href="https://docs.chef.io/data_bags.html">Data bags</a> are also supported by the Chef Solo provisioner. This is done by specifying a path to your data bags directory:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    chef.data_bags_path = "data_bags"
  end
end
</pre></div>
<h2 id="custom-json-data">  Custom JSON Data </h2> <p>Additional configuration data for Chef attributes can be passed in to Chef Solo. This is done by setting the <code>json</code> property with a Ruby hash (dictionary-like object), which is converted to JSON and passed in to Chef:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    # ...

    chef.json = {
      "apache" =&gt; {
        "listen_address" =&gt; "0.0.0.0"
      }
    }
  end
end
</pre></div>
<p>Hashes, arrays, etc. can be used with the JSON configuration object. Basically, anything that can be turned cleanly into JSON works.</p> <h2 id="custom-node-name">  Custom Node Name </h2> <p>You can specify a custom node name by setting the <code>node_name</code> property. This is useful for cookbooks that may depend on this being set to some sort of value. Example:</p> <div class="highlight"><pre class="highlight ruby" data-language="ruby">Vagrant.configure("2") do |config|
  config.vm.provision "chef_solo" do |chef|
    chef.node_name = "foo"
  end
end
</pre></div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2018 Mitchell Hashimoto<br>Licensed under the MPL 2.0 License.<br>
    <a href="https://www.vagrantup.com/docs/provisioning/chef_solo.html" class="_attribution-link">https://www.vagrantup.com/docs/provisioning/chef_solo.html</a>
  </p>
</div>
