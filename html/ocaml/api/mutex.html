<div class="api"> <h1>Module Mutex</h1> <pre id="MODULEMutex" data-type="module Mutex [Module Mutex]" data-language="ocaml">module Mutex: sig .. end</pre>
<div class="info module top"> <div class="info-desc"> <p>Locks for mutual exclusion.</p> <p>Mutexes (mutual-exclusion locks) are used to implement critical sections and protect shared mutable data structures against concurrent accesses. The typical use is (if <code class="code">m</code> is the mutex associated with the data structure <code class="code"><span class="constructor">D</span></code>):</p> <pre class="codepre" data-language="ocaml">     Mutex.lock m;
     (* Critical section that operates over D *);
     Mutex.unlock m
   </pre>
</div> </div>  <pre id="TYPEt" data-type="type t [Module Mutex]" data-language="ocaml">type t </pre> <div class="info "> <div class="info-desc"> <p>The type of mutexes.</p> </div> </div> <pre id="VALcreate" data-type="val create [Module Mutex]" data-language="ocaml">val create : unit -&gt; t</pre>
<div class="info "> <div class="info-desc"> <p>Return a new mutex.</p> </div> </div> <pre id="VALlock" data-type="val lock [Module Mutex]" data-language="ocaml">val lock : t -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p>Lock the given mutex. Only one thread can have the mutex locked at any time. A thread that attempts to lock a mutex already locked by another thread will suspend until the other thread unlocks the mutex.</p> </div> <ul class="info-attributes"> <li>
<b>Before 4.12 </b> <code class="code"><span class="constructor">Sys_error</span></code> was not raised for recursive locking (platform-dependent behaviour)</li> <li>
<b>Raises</b> <code>Sys_error</code> if the mutex is already locked by the thread calling <a href="mutex.html#VALlock"><code class="code"><span class="constructor">Mutex</span>.lock</code></a>.</li> </ul> </div> <pre id="VALtry_lock" data-type="val try_lock [Module Mutex]" data-language="ocaml">val try_lock : t -&gt; bool</pre>
<div class="info "> <div class="info-desc"> <p>Same as <a href="mutex.html#VALlock"><code class="code"><span class="constructor">Mutex</span>.lock</code></a>, but does not suspend the calling thread if the mutex is already locked: just return <code class="code"><span class="keyword">false</span></code> immediately in that case. If the mutex is unlocked, lock it and return <code class="code"><span class="keyword">true</span></code>.</p> </div> </div> <pre id="VALunlock" data-type="val unlock [Module Mutex]" data-language="ocaml">val unlock : t -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p>Unlock the given mutex. Other threads suspended trying to lock the mutex will restart. The mutex must have been previously locked by the thread that calls <a href="mutex.html#VALunlock"><code class="code"><span class="constructor">Mutex</span>.unlock</code></a>.</p> </div> <ul class="info-attributes"> <li>
<b>Before 4.12 </b> <code class="code"><span class="constructor">Sys_error</span></code> was not raised when unlocking an unlocked mutex or when unlocking a mutex from a different thread.</li> <li>
<b>Raises</b> <code>Sys_error</code> if the mutex is unlocked or was locked by another thread.</li> </ul> </div> <pre id="VALprotect" data-type="val protect [Module Mutex]" data-language="ocaml">val protect : t -&gt; (unit -&gt; 'a) -&gt; 'a</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">protect mutex f</code> runs <code class="code">f()</code> in a critical section where <code class="code">mutex</code> is locked (using <a href="mutex.html#VALlock"><code class="code"><span class="constructor">Mutex</span>.lock</code></a>); it then takes care of releasing <code class="code">mutex</code>, whether <code class="code">f()</code> returned a value or raised an exception.</p> <p>The unlocking operation is guaranteed to always takes place, even in the event an asynchronous exception (e.g. <a href="sys.html#EXCEPTIONBreak"><code class="code"><span class="constructor">Sys</span>.<span class="constructor">Break</span></code></a>) is raised in some signal handler.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.1</li> </ul> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1995-2024 INRIA.<br>
    <a href="https://ocaml.org/manual/5.2/api/Mutex.html" class="_attribution-link">https://ocaml.org/manual/5.2/api/Mutex.html</a>
  </p>
</div>
