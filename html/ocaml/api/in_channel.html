<div class="api"> <h1>Module In_channel</h1> <pre id="MODULEIn_channel" data-type="module In_channel [Module In_channel]" data-language="ocaml">module In_channel: sig .. end</pre>
<div class="info module top"> <div class="info-desc"> <p>Input channels.</p> <p>This module provides functions for working with input channels.</p> <p>See <a href="in_channel.html#examples"> the example section</a> below.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 4.14</li> </ul> </div>  <h2 id="channels">Channels</h2> <pre id="TYPEt" data-type="type t [Module In_channel]" data-language="ocaml">type t = in_channel </pre> <div class="info "> <div class="info-desc"> <p>The type of input channel.</p> </div> </div> <pre id="TYPEopen_flag" data-type="type open_flag [Module In_channel]" data-language="ocaml">type open_flag = open_flag = </pre>
<table class="typetable"> <tbody>
<tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_rdonly"><span class="constructor">Open_rdonly</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>open for reading.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_wronly"><span class="constructor">Open_wronly</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>open for writing.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_append"><span class="constructor">Open_append</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>open for appending: always write at end of file.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_creat"><span class="constructor">Open_creat</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>create the file if it does not exist.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_trunc"><span class="constructor">Open_trunc</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>empty the file if it already exists.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_excl"><span class="constructor">Open_excl</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>fail if Open_creat and the file already exists.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_binary"><span class="constructor">Open_binary</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>open in binary mode (no conversion).</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_text"><span class="constructor">Open_text</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>open in text mode (may perform conversions).</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr> <tr> <td align="left" valign="top"> <code><span class="keyword">|</span></code>
</td> <td align="left" valign="top"> <code><span id="TYPEELTopen_flag.Open_nonblock"><span class="constructor">Open_nonblock</span></span></code>
</td> <td class="typefieldcomment" align="left" valign="top"><code>(*</code></td>
<td class="typefieldcomment" align="left" valign="top">
<div class="info "> <div class="info-desc"> <p>open in non-blocking mode.</p> </div> </div> </td>
<td class="typefieldcomment" align="left" valign="bottom"><code>*)</code></td> </tr>
</tbody>
</table> <div class="info "> <div class="info-desc"> <p>Opening modes for <a href="in_channel.html#VALopen_gen"><code class="code"><span class="constructor">In_channel</span>.open_gen</code></a>.</p> </div> </div> <pre id="VALstdin" data-type="val stdin [Module In_channel]" data-language="ocaml">val stdin : t</pre>
<div class="info "> <div class="info-desc"> <p>The standard input for the process.</p> </div> </div> <pre id="VALopen_bin" data-type="val open_bin [Module In_channel]" data-language="ocaml">val open_bin : string -&gt; t</pre>
<div class="info "> <div class="info-desc"> <p>Open the named file for reading, and return a new input channel on that file, positioned at the beginning of the file.</p> </div> </div> <pre id="VALopen_text" data-type="val open_text [Module In_channel]" data-language="ocaml">val open_text : string -&gt; t</pre>
<div class="info "> <div class="info-desc"> <p>Same as <a href="in_channel.html#VALopen_bin"><code class="code"><span class="constructor">In_channel</span>.open_bin</code></a>, but the file is opened in text mode, so that newline translation takes place during reads. On operating systems that do not distinguish between text mode and binary mode, this function behaves like <a href="in_channel.html#VALopen_bin"><code class="code"><span class="constructor">In_channel</span>.open_bin</code></a>.</p> </div> </div> <pre id="VALopen_gen" data-type="val open_gen [Module In_channel]" data-language="ocaml">val open_gen : open_flag list -&gt; int -&gt; string -&gt; t</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">open_gen mode perm filename</code> opens the named file for reading, as described above. The extra arguments <code class="code">mode</code> and <code class="code">perm</code> specify the opening mode and file permissions. <a href="in_channel.html#VALopen_text"><code class="code"><span class="constructor">In_channel</span>.open_text</code></a> and <a href="in_channel.html#VALopen_bin"><code class="code"><span class="constructor">In_channel</span>.open_bin</code></a> are special cases of this function.</p> </div> </div> <pre id="VALwith_open_bin" data-type="val with_open_bin [Module In_channel]" data-language="ocaml">val with_open_bin : string -&gt; (t -&gt; 'a) -&gt; 'a</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">with_open_bin fn f</code> opens a channel <code class="code">ic</code> on file <code class="code">fn</code> and returns <code class="code">f<br>
    ic</code>. After <code class="code">f</code> returns, either with a value or by raising an exception, <code class="code">ic</code> is guaranteed to be closed.</p> </div> </div> <pre id="VALwith_open_text" data-type="val with_open_text [Module In_channel]" data-language="ocaml">val with_open_text : string -&gt; (t -&gt; 'a) -&gt; 'a</pre>
<div class="info "> <div class="info-desc"> <p>Like <a href="in_channel.html#VALwith_open_bin"><code class="code"><span class="constructor">In_channel</span>.with_open_bin</code></a>, but the channel is opened in text mode (see <a href="in_channel.html#VALopen_text"><code class="code"><span class="constructor">In_channel</span>.open_text</code></a>).</p> </div> </div> <pre id="VALwith_open_gen" data-type="val with_open_gen [Module In_channel]" data-language="ocaml">val with_open_gen : open_flag list -&gt; int -&gt; string -&gt; (t -&gt; 'a) -&gt; 'a</pre>
<div class="info "> <div class="info-desc"> <p>Like <a href="in_channel.html#VALwith_open_bin"><code class="code"><span class="constructor">In_channel</span>.with_open_bin</code></a>, but can specify the opening mode and file permission, in case the file must be created (see <a href="in_channel.html#VALopen_gen"><code class="code"><span class="constructor">In_channel</span>.open_gen</code></a>).</p> </div> </div> <pre id="VALclose" data-type="val close [Module In_channel]" data-language="ocaml">val close : t -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p>Close the given channel. Input functions raise a <code class="code"><span class="constructor">Sys_error</span></code> exception when they are applied to a closed input channel, except <a href="in_channel.html#VALclose"><code class="code"><span class="constructor">In_channel</span>.close</code></a>, which does nothing when applied to an already closed channel.</p> </div> </div> <pre id="VALclose_noerr" data-type="val close_noerr [Module In_channel]" data-language="ocaml">val close_noerr : t -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p>Same as <a href="in_channel.html#VALclose"><code class="code"><span class="constructor">In_channel</span>.close</code></a>, but ignore all errors.</p> </div> </div> <h2 id="input">Input</h2> <pre id="VALinput_char" data-type="val input_char [Module In_channel]" data-language="ocaml">val input_char : t -&gt; char option</pre>
<div class="info "> <div class="info-desc"> <p>Read one character from the given input channel. Returns <code class="code"><span class="constructor">None</span></code> if there are no more characters to read.</p> </div> </div> <pre id="VALinput_byte" data-type="val input_byte [Module In_channel]" data-language="ocaml">val input_byte : t -&gt; int option</pre>
<div class="info "> <div class="info-desc"> <p>Same as <a href="in_channel.html#VALinput_char"><code class="code"><span class="constructor">In_channel</span>.input_char</code></a>, but return the 8-bit integer representing the character. Returns <code class="code"><span class="constructor">None</span></code> if the end of file was reached.</p> </div> </div> <pre id="VALinput_line" data-type="val input_line [Module In_channel]" data-language="ocaml">val input_line : t -&gt; string option</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">input_line ic</code> reads characters from <code class="code">ic</code> until a newline or the end of file is reached. Returns the string of all characters read, without the newline (if any). Returns <code class="code"><span class="constructor">None</span></code> if the end of the file has been reached. In particular, this will be the case if the last line of input is empty.</p> <p>A newline is the character <code class="code">\n</code> unless the file is open in text mode and <a href="sys.html#VALwin32"><code class="code"><span class="constructor">Sys</span>.win32</code></a> is <code class="code"><span class="keyword">true</span></code> in which case it is the sequence of characters <code class="code">\r\n</code>.</p> </div> </div> <pre id="VALreally_input_string" data-type="val really_input_string [Module In_channel]" data-language="ocaml">val really_input_string : t -&gt; int -&gt; string option</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">really_input_string ic len</code> reads <code class="code">len</code> characters from channel <code class="code">ic</code> and returns them in a new string. Returns <code class="code"><span class="constructor">None</span></code> if the end of file is reached before <code class="code">len</code> characters have been read.</p> <p>If the same channel is read concurrently by multiple threads, the returned string is not guaranteed to contain contiguous characters from the input.</p> </div> </div> <pre id="VALinput_all" data-type="val input_all [Module In_channel]" data-language="ocaml">val input_all : t -&gt; string</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">input_all ic</code> reads all remaining data from <code class="code">ic</code>.</p> <p>If the same channel is read concurrently by multiple threads, the returned string is not guaranteed to contain contiguous characters from the input.</p> </div> </div> <pre id="VALinput_lines" data-type="val input_lines [Module In_channel]" data-language="ocaml">val input_lines : t -&gt; string list</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">input_lines ic</code> reads lines using <a href="in_channel.html#VALinput_line"><code class="code"><span class="constructor">In_channel</span>.input_line</code></a> until the end of file is reached. It returns the list of all lines read, in the order they were read. The newline characters that terminate lines are not included in the returned strings. Empty lines produce empty strings.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.1</li> </ul> </div> <h2 id="advanced_input">Advanced input</h2> <pre id="VALinput" data-type="val input [Module In_channel]" data-language="ocaml">val input : t -&gt; bytes -&gt; int -&gt; int -&gt; int</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">input ic buf pos len</code> reads up to <code class="code">len</code> characters from the given channel <code class="code">ic</code>, storing them in byte sequence <code class="code">buf</code>, starting at character number <code class="code">pos</code>. It returns the actual number of characters read, between 0 and <code class="code">len</code> (inclusive). A return value of 0 means that the end of file was reached.</p> <p>Use <a href="in_channel.html#VALreally_input"><code class="code"><span class="constructor">In_channel</span>.really_input</code></a> to read exactly <code class="code">len</code> characters.</p> </div> <ul class="info-attributes"> <li>
<b>Raises</b> <code>Invalid_argument</code> if <code class="code">pos</code> and <code class="code">len</code> do not designate a valid range of <code class="code">buf</code>.</li> </ul> </div> <pre id="VALinput_bigarray" data-type="val input_bigarray [Module In_channel]" data-language="ocaml">val input_bigarray : t -&gt;       ('a, Bigarray.int8_unsigned_elt, Bigarray.c_layout)       Bigarray.Array1.t -&gt; int -&gt; int -&gt; int</pre>
<div class="info "> <div class="info-desc"> <p>Same as <a href="in_channel.html#VALinput"><code class="code"><span class="constructor">In_channel</span>.input</code></a>, but read the data into a bigarray.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.2</li> </ul> </div> <pre id="VALreally_input" data-type="val really_input [Module In_channel]" data-language="ocaml">val really_input : t -&gt; bytes -&gt; int -&gt; int -&gt; unit option</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">really_input ic buf pos len</code> reads <code class="code">len</code> characters from channel <code class="code">ic</code>, storing them in byte sequence <code class="code">buf</code>, starting at character number <code class="code">pos</code>.</p> <p>Returns <code class="code"><span class="constructor">None</span></code> if the end of file is reached before <code class="code">len</code> characters have been read.</p> <p>If the same channel is read concurrently by multiple threads, the bytes read by <code class="code">really_input</code> are not guaranteed to be contiguous.</p> </div> <ul class="info-attributes"> <li>
<b>Raises</b> <code>Invalid_argument</code> if <code class="code">pos</code> and <code class="code">len</code> do not designate a valid range of <code class="code">buf</code>.</li> </ul> </div> <pre id="VALreally_input_bigarray" data-type="val really_input_bigarray [Module In_channel]" data-language="ocaml">val really_input_bigarray : t -&gt;       ('a, Bigarray.int8_unsigned_elt, Bigarray.c_layout)       Bigarray.Array1.t -&gt; int -&gt; int -&gt; unit option</pre>
<div class="info "> <div class="info-desc"> <p>Same as <a href="in_channel.html#VALreally_input"><code class="code"><span class="constructor">In_channel</span>.really_input</code></a>, but read the data into a bigarray.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.2</li> </ul> </div> <pre id="VALfold_lines" data-type="val fold_lines [Module In_channel]" data-language="ocaml">val fold_lines : ('acc -&gt; string -&gt; 'acc) -&gt; 'acc -&gt; t -&gt; 'acc</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">fold_lines f init ic</code> reads lines from <code class="code">ic</code> using <a href="in_channel.html#VALinput_line"><code class="code"><span class="constructor">In_channel</span>.input_line</code></a> until the end of file is reached, and successively passes each line to function <code class="code">f</code> in the style of a fold. More precisely, if lines <code class="code">l1, ..., lN</code> are read, <code class="code">fold_lines f init ic</code> computes <code class="code">f (... (f (f init l1) l2) ...) lN</code>. If <code class="code">f</code> has no side effects, this is equivalent to <code class="code"><span class="constructor">List</span>.fold_left f init (<span class="constructor">In_channel</span>.input_lines ic)</code>, but is more efficient since it does not construct the list of all lines read.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.1</li> </ul> </div> <h2 id="seeking">Seeking</h2> <pre id="VALseek" data-type="val seek [Module In_channel]" data-language="ocaml">val seek : t -&gt; int64 -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">seek chan pos</code> sets the current reading position to <code class="code">pos</code> for channel <code class="code">chan</code>. This works only for regular files. On files of other kinds, the behavior is unspecified.</p> </div> </div> <pre id="VALpos" data-type="val pos [Module In_channel]" data-language="ocaml">val pos : t -&gt; int64</pre>
<div class="info "> <div class="info-desc"> <p>Return the current reading position for the given channel. For files opened in text mode under Windows, the returned position is approximate (owing to end-of-line conversion); in particular, saving the current position with <a href="in_channel.html#VALpos"><code class="code"><span class="constructor">In_channel</span>.pos</code></a>, then going back to this position using <a href="in_channel.html#VALseek"><code class="code"><span class="constructor">In_channel</span>.seek</code></a> will not work. For this programming idiom to work reliably and portably, the file must be opened in binary mode.</p> </div> </div> <h2 id="attributes">Attributes</h2> <pre id="VALlength" data-type="val length [Module In_channel]" data-language="ocaml">val length : t -&gt; int64</pre>
<div class="info "> <div class="info-desc"> <p>Return the size (number of characters) of the regular file on which the given channel is opened. If the channel is opened on a file that is not a regular file, the result is meaningless. The returned size does not take into account the end-of-line translations that can be performed when reading from a channel opened in text mode.</p> </div> </div> <pre id="VALset_binary_mode" data-type="val set_binary_mode [Module In_channel]" data-language="ocaml">val set_binary_mode : t -&gt; bool -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">set_binary_mode ic <span class="keyword">true</span></code> sets the channel <code class="code">ic</code> to binary mode: no translations take place during input.</p> <p><code class="code">set_binary_mode ic <span class="keyword">false</span></code> sets the channel <code class="code">ic</code> to text mode: depending on the operating system, some translations may take place during input. For instance, under Windows, end-of-lines will be translated from <code class="code">\r\n</code> to <code class="code">\n</code>.</p> <p>This function has no effect under operating systems that do not distinguish between text mode and binary mode.</p> </div> </div> <pre id="VALis_binary_mode" data-type="val is_binary_mode [Module In_channel]" data-language="ocaml">val is_binary_mode : t -&gt; bool</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">is_binary_mode ic</code> returns whether the channel <code class="code">ic</code> is in binary mode (see <a href="in_channel.html#VALset_binary_mode"><code class="code"><span class="constructor">In_channel</span>.set_binary_mode</code></a>).</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.2</li> </ul> </div> <pre id="VALisatty" data-type="val isatty [Module In_channel]" data-language="ocaml">val isatty : t -&gt; bool</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">isatty ic</code> is <code class="code"><span class="keyword">true</span></code> if <code class="code">ic</code> refers to a terminal or console window, <code class="code"><span class="keyword">false</span></code> otherwise.</p> </div> <ul class="info-attributes"> <li>
<b>Since</b> 5.1</li> </ul> </div> <h2 id="examples">Examples</h2>
<p>Reading the contents of a file:</p> <pre class="codepre" data-language="ocaml">      let read_file file = In_channel.with_open_bin file In_channel.input_all
    </pre> <p>Reading a line from stdin:</p> <pre class="codepre" data-language="ocaml">      let user_input () = In_channel.input_line In_channel.stdin
    </pre> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1995-2024 INRIA.<br>
    <a href="https://ocaml.org/manual/5.2/api/In_channel.html" class="_attribution-link">https://ocaml.org/manual/5.2/api/In_channel.html</a>
  </p>
</div>
