<div class="api"> <h1>Module Local_store</h1> <pre id="MODULELocal_store" data-type="module Local_store [Module Local_store]" data-language="ocaml">module Local_store: sig .. end</pre>
<div class="info module top"> <div class="info-desc"> <p>This module provides some facilities for creating references (and hash tables) which can easily be snapshoted and restored to an arbitrary version.</p> <p>It is used throughout the frontend (read: typechecker), to register all (well, hopefully) the global state. Thus making it easy for tools like Merlin to go back and forth typechecking different files.</p> </div> </div>  <h2 id="1_Creators">Creators</h2> <pre id="VALs_ref" data-type="val s_ref [Module Local_store]" data-language="ocaml">val s_ref : 'a -&gt; 'a ref</pre>
<div class="info "> <div class="info-desc"> <p>Similar to <code class="code"><span class="constructor">Stdlib</span>.ref</code>, except the allocated reference is registered into the store.</p> </div> </div> <pre id="VALs_table" data-type="val s_table [Module Local_store]" data-language="ocaml">val s_table : ('a -&gt; 'b) -&gt; 'a -&gt; 'b ref</pre>
<div class="info "> <div class="info-desc"> <p>Used to register hash tables. Those also need to be placed into refs to be easily swapped out, but one can't just "snapshot" the initial value to create fresh instances, so instead an initializer is required.</p> <p>Use it like this:</p> <pre class="codepre" data-language="ocaml">      let my_table = s_table Hashtbl.create 42
    </pre>
</div> </div> <h2 id="1_Statemanagement">State management</h2> <p>Note: all the following functions are currently unused inside the compiler codebase. Merlin is their only user at the moment.</p> <pre id="TYPEstore" data-type="type store [Module Local_store]" data-language="ocaml">type store </pre> <pre id="VALfresh" data-type="val fresh [Module Local_store]" data-language="ocaml">val fresh : unit -&gt; store</pre>
<div class="info "> <div class="info-desc"> <p>Returns a fresh instance of the store.</p> <p>The first time this function is called, it snapshots the value of all the registered references, later calls to <code class="code">fresh</code> will return instances initialized to those values.</p> </div> </div> <pre id="VALwith_store" data-type="val with_store [Module Local_store]" data-language="ocaml">val with_store : store -&gt; (unit -&gt; 'a) -&gt; 'a</pre>
<div class="info "> <div class="info-desc"> <p><code class="code">with_store s f</code> resets all the registered references to the value they have in <code class="code">s</code> for the run of <code class="code">f</code>. If <code class="code">f</code> updates any of the registered refs, <code class="code">s</code> is updated to remember those changes.</p> </div> </div> <pre id="VALreset" data-type="val reset [Module Local_store]" data-language="ocaml">val reset : unit -&gt; unit</pre>
<div class="info "> <div class="info-desc"> <p>Resets all the references to the initial snapshot (i.e. to the same values that new instances start with).</p> </div> </div> <pre id="VALis_bound" data-type="val is_bound [Module Local_store]" data-language="ocaml">val is_bound : unit -&gt; bool</pre>
<div class="info "> <div class="info-desc"> <p>Returns <code class="code"><span class="keyword">true</span></code> when a store is active (i.e. when called from the callback passed to <a href="local_store.html#VALwith_store"><code class="code"><span class="constructor">Local_store</span>.with_store</code></a>), <code class="code"><span class="keyword">false</span></code> otherwise.</p> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 1995-2024 INRIA.<br>
    <a href="https://ocaml.org/manual/5.2/api/compilerlibref/Local_store.html" class="_attribution-link">https://ocaml.org/manual/5.2/api/compilerlibref/Local_store.html</a>
  </p>
</div>
