<div class="innertube"> <h1 id="Definition of Agent Configuration Files">6 Definition of Agent Configuration Files</h1> <p>All configuration data must be included in configuration files that are located in the configuration directory. The name of this directory is given in the <code>config_dir</code> configuration parameter. These files are read at start-up, and are used to initialize the SNMPv2-MIB or STANDARD-MIB, SNMP-FRAMEWORK-MIB, SNMP-MPD-MIB, SNMP-VIEW-BASED-ACM-MIB, SNMP-COMMUNITY-MIB, SNMP-USER-BASED-SM-MIB (adjusted according to SNMP-USM-HMAC-SHA2-MIB), SNMP-TARGET-MIB and SNMP-NOTIFICATION-MIB (refer to the <code><a href="snmp_agent_funct_descr.html#management">Management of the Agent</a></code> for a description of the MIBs). </p> <p>The files are: </p> <ul> <li> <p><code>agent.conf</code>: see <code><a href="#agent_information">Agent Information</a></code></p> </li> <li> <p><code>standard.conf</code>: see <code><a href="#system_information">System Information</a></code></p> </li> <li> <p><code>context.conf</code>: see <code><a href="#context">Contexts</a></code></p> </li> <li> <p><code>community.conf</code>: see <code><a href="#community">Communities</a></code></p> </li> <li> <p><code>target_addr.conf</code>: see <code><a href="#target_addr">Target Address Definitions</a></code></p> </li> <li> <p><code>target_params.conf</code>: see <code><a href="#target_params">Target Parameters Definitions</a></code></p> </li> <li> <p><code>vacm.conf</code>: see <code><a href="#vacm">MIB Views for VACM</a></code></p> </li> <li> <p><code>usm.conf</code>: see <code><a href="#usm">Security data for USM</a></code></p> </li> <li> <p><code>notify.conf</code>: see <code><a href="#notify">Notify Definitions</a></code></p> </li> </ul> <p>The directory where the configuration files are found is given as a parameter to the agent. </p> <p>The entry format in all files are Erlang terms, separated by a '<strong>.</strong>' and a <strong>newline</strong>. In the following sections, the formats of these terms are described. Comments may be specified as ordinary Erlang comments. </p> <p>Syntax errors in these files are discovered and reported with the function <code>config_err/2</code> of the error report module at start-up. </p>  <h2 id="agent-information" class="title-link"> <div class="title-name">6.1 Agent Information</div>  </h2> <p>The agent information should be stored in a file called <code>agent.conf</code>. </p> <p>Each entry is a tuple of size two:</p> <p><code>{AgentVariable, Value}.</code></p> <ul> <li> <p><code>AgentVariable</code> is one of the variables in SNMP-FRAMEWORK-MIB or one of the internal variables <code>intAgentUDPPort</code>, which defines which UDP port the agent listens to, or <code>intAgentTransports</code>, which defines the transport domains and addresses of the agent. </p> </li> <li> <p><code>Value</code> is the value for the variable.</p> </li> </ul> <p>The following example shows an <code>agent.conf</code> file: </p> <pre data-language="erlang">
{intAgentUDPPort, 4000}.
{intAgentTransports,
 [{transportDomainUdpIpv4, {141,213,11,24}},
  {transportDomainUdpIpv6, {0,0,0,0,0,0,0,1}}]}.
{snmpEngineID, "mbj's engine"}.
{snmpEngineMaxPacketSize, 484}.
    </pre> <p>These are the supported entries and their value types: </p> <pre data-language="erlang">
{snmpEngine,               string()}.             % Mandatory
{snmpEngineMaxMessageSize, non_neg_integer()}.    % Mandatory
{intAgentUDPPort,          pos_integer()}.        % Optional
{intAgentTransports,       intAgentTransports()}. % Mandatory
    </pre> <p>And here are the transport value types: </p> <pre data-language="erlang">
      intAgentTransports() :: [intAgentTransport()].
      intAgentTransport()  :: {TDomain, Addr} |
                              {TDomain, EAddr, Kind} |
{TDomain, EAddr, Opts} |
{TDomain, EAddr, Kind, Opts}
      TDomain      :: transportDomainUdpIpv4 | transportDomainUdpIpv6.
      Addr         :: {IpAddr, IpPort} | IpAddr.
      IpAddr       :: <code>inet:ip_address()</code> | snmpIpAddr().
      snmpIpAddr() :: [non_neg_integer()].
      IpPort       :: pos_integer().
      EAddr        :: {<code>inet:ip_address()</code>, PortInfo}.
      PortInfo     :: pos_integer() | system | range() | ranges().
      range()      :: {Min :: pos_integer(), Max :: pos_integer()}, Min &lt; Max
      ranges()     :: [pos_integer() | range()].
      Kind         :: req_responder | trap_sender.
      Opts         :: list().
    </pre> <p>If a "traditional" transport is specified (without explicit <code>Kind</code>, handling both requests and traps) for a transport domain, its <strong>not</strong> possible to also specify a transport (for that domain) with a specific <code>Kind</code>. This is for example <strong>not</strong> allowed:</p> <pre data-language="erlang">
[{transportDomainUdpIpv4, {{141,213,11,24}, 4000}},
 {transportDomainUdpIpv4, {{141,213,11,24}, 4001}, trap_sender}].
   </pre> <p>Note that only one transport per kind for each transport domain can be configured. </p> <p><code>PortInfo</code> <code>system</code> is used to indicate that the 'system' should choose (the way port number '0' (zero) is normally used). Port info '0' (zero) cannot be used for this, since it is (internally) used to represent the 'default' port number. </p> <p>In the traditional transport entries, when the <code>Addr</code> value does not contain a port number, the value of <code>intAgentUDPPort</code> is used.</p> <p>Note that the (new) extended transport entries (including <code>Kind</code> and <code>Opts</code>) <strong>must</strong> specify port-info as they ignore any value specified by <code>intAgentUDPPort</code>.</p> <p><code>Opts</code> is the same as for the <code><a href="snmp_config.html#agent_ni_opts">net-if</a></code> process <strong>and</strong> takes precedence (for that transport) if present. The point is that each transport can have its own socket options. </p> <p>The value of <code>snmpEngineID</code> is a string, which for a deployed agent should have a very specific structure. See RFC 2271/2571 for details.</p> <div class="note"> <div class="label">Note</div> <div class="content">

<p>The legacy and intermediate variables <code>intAgentIpAddress</code> and <code>intAgentTransportDomain</code> are still supported so old <code>agent.conf</code> files will work.</p> <p>But they <strong>cannot</strong> be combined with intAgentTransports.</p> </div> </div>  <h2 id="contexts" class="title-link"> <div class="title-name">6.2 Contexts</div>  </h2> <p>The context information should be stored in a file called <code>context.conf</code>. The default context <code>""</code> need not be present.</p> <p>Each row defines a context in the agent. This information is used in the table <code>vacmContextTable</code> in the SNMP-VIEW-BASED-ACM-MIB.</p> <p>Each entry is a term:</p> <p><code>ContextName.</code></p> <ul> <li> <p><code>ContextName</code> is a string.</p> </li> </ul>  <h2 id="system-information" class="title-link"> <div class="title-name">6.3 System Information</div>  </h2> <p>The system information should be stored in a file called <code>standard.conf</code>.</p> <p>Each entry is a tuple of size two:</p> <p><code>{SystemVariable, Value}.</code></p> <ul> <li> <p><code>SystemVariable</code> is one of the variables in the system group, or <code>snmpEnableAuthenTraps</code>. </p> </li> <li> <p><code>Value</code> is the value for the variable. </p> </li> </ul> <p>The following example shows a valid <code>standard.conf</code> file: </p> <pre data-language="erlang">
{sysDescr, "Erlang SNMP agent"}.
{sysObjectID, [1,2,3]}.
{sysContact, "(mbj,eklas)@erlang.ericsson.se"}.
{sysName, "test"}.
{sysServices, 72}.
{snmpEnableAuthenTraps, enabled}.
    </pre> <p>A value must be provided for all variables, which lack default values in the MIB. </p>  <h2 id="communities" class="title-link"> <div class="title-name">6.4 Communities</div>  </h2> <p>The community information should be stored in a file called <code>community.conf</code>. It must be present if the agent is configured for SNMPv1 or SNMPv2c. </p> <p>An SNMP <strong>community</strong> is a relationship between an SNMP agent and a set of SNMP managers that defines authentication, access control and proxy characteristics. </p> <p>The corresponding table is <code>snmpCommunityTable</code> in the SNMP-COMMUNITY-MIB. </p> <p>Each entry is a term: </p> <p><code>{CommunityIndex, CommunityName, SecurityName, ContextName, TransportTag}.</code> </p> <ul> <li> <p><code>CommunityIndex</code> is a non-empty string.</p> </li> <li> <p><code>CommunityName</code> is a string.</p> </li> <li> <p><code>SecurityName</code> is a string.</p> </li> <li> <p><code>ContextName</code> is a string.</p> </li> <li> <p><code>TransportTag</code> is a string.</p> </li> </ul>  <h2 id="mib-views-for-vacm" class="title-link"> <div class="title-name">6.5 MIB Views for VACM</div>  </h2> <p>The information about MIB Views for VACM should be stored in a file called <code>vacm.conf</code>.</p> <p>The corresponding tables are <code>vacmSecurityToGroupTable</code>, <code>vacmAccessTable</code> and <code>vacmViewTreeFamilyTable</code> in the SNMP-VIEW-BASED-ACM-MIB.</p> <p>Each entry is one of the terms, one entry corresponds to one row in one of the tables.</p> <p><code>{vacmSecurityToGroup, SecModel, SecName, GroupName}.</code></p> <p><code>{vacmAccess, GroupName, Prefix, SecModel, SecLevel, Match, ReadView, WriteView, NotifyView}.</code></p> <p><code>{vacmViewTreeFamily, ViewIndex, ViewSubtree, ViewStatus, ViewMask}.</code></p> <ul> <li> <p><code>SecModel</code> is <code>any</code>, <code>v1</code>, <code>v2c</code>, or <code>usm</code>.</p> </li> <li> <p><code>SecName</code> is a string.</p> </li> <li> <p><code>GroupName</code> is a string.</p> </li> <li> <p><code>Prefix</code> is a string.</p> </li> <li> <p><code>SecLevel</code> is <code>noAuthNoPriv</code>, <code>authNoPriv</code>, or <code>authPriv</code></p> </li> <li> <p><code>Match</code> is <code>prefix</code> or <code>exact</code>.</p> </li> <li> <p><code>ReadView</code> is a string.</p> </li> <li> <p><code>WriteView</code> is a string.</p> </li> <li> <p><code>NotifyView</code> is a string.</p> </li> <li> <p><code>ViewIndex</code> is an integer.</p> </li> <li> <p><code>ViewSubtree</code> is a list of integer.</p> </li> <li> <p><code>ViewStatus</code> is either <code>included</code> or <code>excluded</code></p> </li> <li> <p><code>ViewMask</code> is either <code>null</code> or a list of ones and zeros. Ones nominate that an exact match is used for this sub-identifier. Zeros are wild-cards which match any sub-identifier. If the mask is shorter than the sub-tree, the tail is regarded as all ones. <code>null</code> is shorthand for a mask with all ones. </p> </li> </ul>  <h2 id="security-data-for-usm" class="title-link"> <div class="title-name">6.6 Security data for USM</div>  </h2> <p>The information about Security data for USM should be stored in a file called <code>usm.conf</code>, which must be present if the agent is configured for SNMPv3. </p> <p>The corresponding table is <code>usmUserTable</code> in the SNMP-USER-BASED-SM-MIB (adjusted according to SNMP-USM-HMAC-SHA2-MIB).</p> <p>Each entry is a term:</p> <p><code>{EngineID, UserName, SecName, Clone, AuthP, AuthKeyC, OwnAuthKeyC, PrivP, PrivKeyC, OwnPrivKeyC, Public, AuthKey, PrivKey}.</code></p> <ul> <li> <p><code>EngineID</code> is a string.</p> </li> <li> <p><code>UserName</code> is a string.</p> </li> <li> <p><code>SecName</code> is a string.</p> </li> <li> <p><code>Clone</code> is <code>zeroDotZero</code> or a list of integers.</p> </li> <li> <p><code>AuthP</code> is a <code>usmNoAuthProtocol</code>, <code>usmHMACMD5AuthProtocol</code>, <code>usmHMACSHAAuthProtocol</code>, <code>usmHMAC128SHA224AuthProtocol</code>, <code>usmHMAC192SH256AuthProtocol</code>, <code>usmHMAC256SHA384AuthProtocol</code> or <code>usmHMAC384SHA512AuthProtocol</code>.</p> </li> <li> <p><code>AuthKeyC</code> is a string.</p> </li> <li> <p><code>OwnAuthKeyC</code> is a string.</p> </li> <li> <p><code>PrivP</code> is a <code>usmNoPrivProtocol</code>, <code>usmDESPrivProtocol</code> or <code>usmAesCfb128Protocol</code>.</p> </li> <li> <p><code>PrivKeyC</code> is a string.</p> </li> <li> <p><code>OwnPrivKeyC</code> is a string.</p> </li> <li> <p><code>Public</code> is a string.</p> </li> <li> <p><code>AuthKey</code> is a list (of integer). This is the User's secret localized authentication key. It is not visible in the MIB. The length (number of octets) of this key needs to be:</p> <ul> <li> <p>16 if <code>usmHMACMD5AuthProtocol</code>.</p> </li> <li> <p>20 if <code>usmHMACSHAAuthProtocol</code>.</p> </li> <li> <p>28 if <code>usmHMAC128SHA224AuthProtocol</code>.</p> </li> <li> <p>32 if <code>usmHMAC192SHA256AuthProtocol</code>.</p> </li> <li> <p>48 if <code>usmHMAC256SHA384AuthProtocol</code>.</p> </li> <li> <p>64 if <code>usmHMAC384SHA512AuthProtocol</code>.</p> </li> </ul> </li> <li> <p><code>PrivKey</code> is a list (of integer). This is the User's secret localized encryption key. It is not visible in the MIB. The length of this key needs to be 16 if <code>usmDESPrivProtocol</code> or <code>usmAesCfb128Protocol</code> is used. </p> </li> </ul>  <h2 id="notify-definitions" class="title-link"> <div class="title-name">6.7 Notify Definitions</div>  </h2> <p>The information about Notify Definitions should be stored in a file called <code>notify.conf</code>. </p> <p>The corresponding table is <code>snmpNotifyTable</code> in the SNMP-NOTIFICATION-MIB.</p> <p>Each entry is a term:</p> <p><code>{NotifyName, Tag, Type}.</code></p> <ul> <li> <p><code>NotifyName</code> is a unique non-empty string.</p> </li> <li> <p><code>Tag</code> is a string.</p> </li> <li> <p><code>Type</code> is <code>trap</code> or <code>inform</code>.</p> </li> </ul>  <h2 id="target-address-definitions" class="title-link"> <div class="title-name">6.8 Target Address Definitions</div>  </h2> <p>The information about Target Address Definitions should be stored in a file called <code>target_addr.conf</code>. </p> <p>The corresponding tables are <code>snmpTargetAddrTable</code> in the SNMP-TARGET-MIB and <code>snmpTargetAddrExtTable</code> in the SNMP-COMMUNITY-MIB. </p> <p>Each entry is a term: </p> <p><code>{TargetName, Domain, Addr, Timeout, RetryCount, TagList, ParamsName, EngineId}.</code> <br> or <br> <code>{TargetName, Domain, Addr, Timeout, RetryCount, TagList, ParamsName, EngineId, TMask, MaxMessageSize}.</code> </p> <ul> <li> <p><code>TargetName</code> is a unique non-empty string. </p> </li> <li> <p><code>Domain</code> is one of the atoms: <code>transportDomainUdpIpv4</code> | <code>transportDomainUdpIpv6</code>. </p> </li> <li> <p><code>Addr</code> is either an <code>IpAddr</code> or an <code>{IpAddr, IpPort}</code> tuple. <code>IpAddr</code> is either a regular Erlang/OTP <code>ip_address()</code> or a traditional SNMP integer list, and <code>IpPort</code> is an integer.</p> <p>If <code>IpPort</code> is omitted <code>162</code> is used.</p> </li> <li> <p><code>Timeout</code> is an integer. </p> </li> <li> <p><code>RetryCount</code> is an integer. </p> </li> <li> <p><code>TagList</code> is a string. </p> </li> <li> <p><code>ParamsName</code> is a string. </p> </li> <li> <p><code>EngineId</code> is a string or the atom <code>discovery</code>. </p> </li> <li> <p><code>TMask</code> is specified just as <code>Addr</code> or as <code>[]</code>. Note in particular that using a list of 6 bytes for IPv4 or 8 words plus 2 bytes for IPv6 are still valid address formats so old configurations will work.</p> </li> <li> <p><code>MaxMessageSize</code> is an integer (default: 2048). </p> </li> </ul> <p>The old tuple formats with <code>Ip</code> address and <code>Udp</code> port number found in old configurations still work.</p> <p>Note that if <code>EngineId</code> has the value <code>discovery</code>, the agent cannot send <code>inform</code> messages to that manager until it has performed the <strong>discovery</strong> process with that manager. </p>  <h2 id="target-parameters-definitions" class="title-link"> <div class="title-name">6.9 Target Parameters Definitions</div>  </h2> <p>The information about Target Parameters Definitions should be stored in a file called <code>target_params.conf</code>. </p> <p>The corresponding table is <code>snmpTargetParamsTable</code> in the SNMP-TARGET-MIB. </p> <p>Each entry is a term: </p> <p><code>{ParamsName, MPModel, SecurityModel, SecurityName, SecurityLevel}.</code></p> <ul> <li> <p><code>ParamsName</code> is a unique non-empty string. </p> </li> <li> <p><code>MPModel</code> is <code>v1</code>, <code>v2c</code> or <code>v3</code></p> </li> <li> <p><code>SecurityModel</code> is <code>v1</code>, <code>v2c</code>, or <code>usm</code>.</p> </li> <li> <p><code>SecurityName</code> is a string.</p> </li> <li> <p><code>SecurityLevel</code> is <code>noAuthNoPriv</code>, <code>authNoPriv</code> or <code>authPriv</code>. </p> </li> </ul> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010&ndash;2023 Ericsson AB<br>Licensed under the Apache License, Version 2.0.<br>
    
  </p>
</div>
