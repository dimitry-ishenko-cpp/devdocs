<h1 id="id1">17. Eventlog encodings</h1>
<div class="_sphinx"> <div itemprop="articleBody"> <section id="eventlog-encodings">  <p>This section documents the encodings of the events emitted to GHC’s <a class="reference internal" href="runtime_control.html#rts-eventlog"><span class="std std-ref">event log</span></a>. These events can include information about the thread scheduling events, garbage collection statistics, profiling information, user-defined tracing events.</p> <p>This section is intended for implementors of tooling which consume these events. GHC ships with a C header file (<code>EventlogFormat.h</code>) which provides symbolic names for the event type IDs described in this file.</p> <section id="event-log-format"> <h2>
<span class="section-number">17.1. </span>Event log format</h2> <p>The log format is designed to be extensible: old tools should be able to parse (but not necessarily understand all of) new versions of the format, and new tools will be able to understand old log files.</p> <ul class="simple"> <li>The format is endian-independent: all values are represented in big-endian order.</li> <li>
<p>The format is extensible:</p> <ul> <li>The header describes each event type and its length. Tools that don’t recognise a particular event type can skip those events.</li> <li>There is room for extra information in the event type specification, which can be ignored by older tools.</li> <li>Events can have extra information added, but existing fields cannot be changed. Tools should ignore extra fields at the end of the event record.</li> </ul> </li> </ul> <p>The event-log stream begins with a header describing the event types (<code>EventType</code>) present in the file. The header is followed by the event records (<code>Event</code>) themselves, each of which start with the event type id and a 64-bit timestamp:</p> <pre data-language="none">EventLog :
      EVENT_HEADER_BEGIN
      EVENT_HET_BEGIN -- header event types begin
      EventType*
      EVENT_HET_END -- header event types end
      EVENT_HEADER_END
      EVENT_DATA_BEGIN
      Event*
      EVENT_DATA_END

EventType :
      EVENT_ET_BEGIN
      Word16         -- event type id, unique identifier for this event
      Int16          -- &gt;=0  size of the event record in bytes (minus the event type id and timestamp fields)
                     -- -1   variable size
      Word32         -- size of the event description in bytes
      Word8*         -- event description, UTF8 encoded string describing the event
      Word32         -- size of the extra info in bytes
      Word8*         -- extra info (for future extensions)
      EVENT_ET_END

Event :
      Word16         -- event type id, as included in the event log header
      Word64         -- timestamp (nanoseconds)
      [Word16]       -- length of the rest (optional, for variable-sized events only)
      ... event specific info ...
</pre> <p>There are two classes of event types:</p>  <ul class="simple"> <li>
<em>Fixed size</em>: All event records of a fixed-sized type are of the same length, the size given in the header event-log header.</li> <li>
<em>Variable size</em>: Each event record includes a length field.</li> </ul>  </section> <section id="runtime-system-diagnostics"> <h2>
<span class="section-number">17.2. </span>Runtime system diagnostics</h2>  <ul class="simple"> <li><code>ThreadId ~ Word32</code></li> <li><code>CapNo ~ Word16</code></li> <li><code>CapSetId ~ Word32</code></li> </ul>  <section id="capability-sets"> <h3>
<span class="section-number">17.2.1. </span>Capability sets</h3> <p>TODO</p> </section> <section id="environment-information"> <h3>
<span class="section-number">17.2.2. </span>Environment information</h3> <p>These events are typically produced during program startup and describe the environment which the program is being run in.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-RTS_IDENTIFIER">
<code>RTS_IDENTIFIER</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>29</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Capability set</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Runtime system name and version.</p> </dd> </dl> <p>Describes the name and version of the runtime system responsible for the indicated capability set.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-PROGRAM_ARGS">
<code>PROGRAM_ARGS</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>30</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Capability set</p> </dd> <dt class="field-even">Field [String]<span class="colon">:</span>
</dt> <dd class="field-even">
<p>The command-line arguments passed to the program</p> </dd> </dl> <p>Describes the command-line used to start the program.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-PROGRAM_ENV">
<code>PROGRAM_ENV</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>31</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Capability set</p> </dd> <dt class="field-even">Field [String]<span class="colon">:</span>
</dt> <dd class="field-even">
<p>The environment variable name/value pairs. (TODO: encoding?)</p> </dd> </dl> <p>Describes the environment variables present in the program’s environment.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-WALL_CLOCK_TIME">
<code>WALL_CLOCK_TIME</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>43</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Capability set</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Unix epoch seconds</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Nanoseconds</p> </dd> </dl> <p>Records the wall clock time to make it possible to correlate events from elsewhere with the eventlog.</p> </dd>
</dl> </section> <section id="thread-and-scheduling-events"> <h3>
<span class="section-number">17.2.3. </span>Thread and scheduling events</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CREATE_THREAD">
<code>CREATE_THREAD</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>0</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> </dl> <p>Marks the creation of a Haskell thread.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-RUN_THREAD">
<code>RUN_THREAD</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>1</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> </dl> <p>The indicated thread has started running.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-STOP_THREAD">
<code>STOP_THREAD</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>2</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> <dt class="field-even">Field Word16<span class="colon">:</span>
</dt> <dd class="field-even">
<p>status</p> <ul class="simple"> <li>1: HeapOverflow</li> <li>2: StackOverflow</li> <li>3: ThreadYielding</li> <li>4: ThreadBlocked</li> <li>5: ThreadFinished</li> <li>6: ForeignCall</li> <li>7: BlockedOnMVar</li> <li>8: BlockedOnBlackHole</li> <li>9: BlockedOnRead</li> <li>10: BlockedOnWrite</li> <li>11: BlockedOnDelay</li> <li>12: BlockedOnSTM</li> <li>13: BlockedOnDoProc</li> <li>16: BlockedOnMsgThrowTo</li> <li>20: BlockedOnMVarRead</li> </ul> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id of thread being blocked on (only for some status values)</p> </dd> </dl> <p>The indicated thread has stopped running for the reason given by <code>status</code>.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-THREAD_RUNNABLE">
<code>THREAD_RUNNABLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>3</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> </dl> <p>The indicated thread is has been marked as ready to run.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-MIGRATE_THREAD">
<code>MIGRATE_THREAD</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>4</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> <dt class="field-even">Field CapNo<span class="colon">:</span>
</dt> <dd class="field-even">
<p>capability</p> </dd> </dl> <p>The indicated thread has been migrated to a new capability.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-THREAD_WAKEUP">
<code>THREAD_WAKEUP</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>8</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> <dt class="field-even">Field CapNo<span class="colon">:</span>
</dt> <dd class="field-even">
<p>other capability</p> </dd> </dl> <p>The indicated thread has been woken up on another capability.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-THREAD_LABEL">
<code>THREAD_LABEL</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>44</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field ThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>thread id</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>label</p> </dd> </dl> <p>The indicated thread has been given a label (e.g. with <a class="reference external" href="../libraries/base-4.21.0.0-8e62/ghc-conc.html#v:labelThread">GHC.Conc.labelThread</a>).</p> </dd>
</dl> </section> <section id="garbage-collector-events"> <h3 id="gc-events">
<span class="section-number">17.2.4. </span>Garbage collector events</h3> <p>The following events mark various points of the lifecycle of a moving garbage collection.</p> <p>A typical garbage collection will look something like the following:</p> <ol class="arabic simple"> <li>A capability realizes that it needs a garbage collection (e.g. as a result of running out of nursery) and requests a garbage collection. This is marked by <a class="reference internal" href="#event-type-REQUEST_SEQ_GC"><code>REQUEST_SEQ_GC</code></a> or <a class="reference internal" href="#event-type-REQUEST_PAR_GC"><code>REQUEST_PAR_GC</code></a>.</li> <li>As other capabilities reach yield points and suspend execution they emit <a class="reference internal" href="#event-type-STOP_THREAD"><code>STOP_THREAD</code></a> events.</li> <li>When all capabilities have suspended execution, collection will begin, marked by a <a class="reference internal" href="#event-type-GC_START"><code>GC_START</code></a> event.</li> <li>As individual parallel GC threads commence with scavenging they will emit <a class="reference internal" href="#event-type-GC_WORK"><code>GC_WORK</code></a> events.</li> <li>If a parallel GC thread runs out of work it will emit a <a class="reference internal" href="#event-type-GC_IDLE"><code>GC_IDLE</code></a> event. If it is later handed more work it will emit another <a class="reference internal" href="#event-type-GC_WORK"><code>GC_WORK</code></a> event.</li> <li>Eventually when scavenging has finished a <a class="reference internal" href="#event-type-GC_DONE"><code>GC_DONE</code></a> event will be emitted by each GC thread.</li> <li>A bit of book-keeping is performed.</li> <li>A <a class="reference internal" href="#event-type-GC_END"><code>GC_END</code></a> event will be emitted marking the end of the GC cycle.</li> <li>A <a class="reference internal" href="#event-type-HEAP_SIZE"><code>HEAP_SIZE</code></a> event will be emitted giving the current size of the heap, in bytes, calculated by how many megablocks are allocated.</li> <li>A <a class="reference internal" href="#event-type-BLOCKS_SIZE"><code>BLOCKS_SIZE</code></a> event will be emitted giving the current size of the heap, in bytes, calculated by how many blocks are allocated.</li> <li>A <a class="reference internal" href="#event-type-GC_STATS_GHC"><code>GC_STATS_GHC</code></a> event will be emitted containing various details of the collection and heap state.</li> <li>In the case of a major collection, a <a class="reference internal" href="#event-type-HEAP_LIVE"><code>HEAP_LIVE</code></a> event will be emitted describing the current size of the live on-heap data.</li> <li>In the case of the <a class="reference internal" href="phases.html#ghc-flag--single-threaded"><code>-threaded</code></a> RTS, a <a class="reference internal" href="#event-type-SPARK_COUNTERS"><code>SPARK_COUNTERS</code></a> event will be emitted giving details on how many sparks have been created, evaluated, and GC’d.</li> <li>As mutator threads resume execution they will emit <a class="reference internal" href="#event-type-RUN_THREAD"><code>RUN_THREAD</code></a> events.</li> <li>A <a class="reference internal" href="#event-type-MEM_RETURN"><code>MEM_RETURN</code></a> event will be emitted containing details about currently live mblocks, how many we think we need and whether we could return excess to the OS.</li> </ol> <p>Note that in the case of the concurrent non-moving collector additional events will be emitted during the concurrent phase of collection. These are described in <a class="reference internal" href="#nonmoving-gc-events"><span class="std std-ref">Non-moving GC event output</span></a>.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_START">
<code>GC_START</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>9</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A garbage collection pass has been started.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_END">
<code>GC_END</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>10</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A garbage collection pass has been finished.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-REQUEST_SEQ_GC">
<code>REQUEST_SEQ_GC</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>11</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A sequential garbage collection has been requested by a capability.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-REQUEST_PAR_GC">
<code>REQUEST_PAR_GC</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>12</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A parallel garbage collection has been requested by a capability.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_IDLE">
<code>GC_IDLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>20</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>An idle-time garbage collection has been started.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_WORK">
<code>GC_WORK</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>21</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the start of concurrent scavenging.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_DONE">
<code>GC_DONE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>22</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the end of concurrent scavenging.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_STATS_GHC">
<code>GC_STATS_GHC</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>53</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word16<span class="colon">:</span>
</dt> <dd class="field-even">
<p>generation of collection</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>bytes copied</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>bytes of slop found</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>bytes of fragmentation, the difference between total mblock size and total block size. When all mblocks are full of full blocks, this number is 0.</p> </dd> <dt class="field-even">Field Word32<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of parallel garbage collection threads</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>maximum number of bytes copied by any single collector thread</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>total bytes copied by all collector threads</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>the amount of balanced data copied by all threads</p> </dd> </dl> <p>Report various information about a major collection.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-GC_GLOBAL_SYNC">
<code>GC_GLOBAL_SYNC</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>54</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>TODO</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-MEM_RETURN">
<code>MEM_RETURN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>90</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word32<span class="colon">:</span>
</dt> <dd class="field-even">
<p>currently allocated mblocks</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>the number of mblocks we would like to retain</p> </dd> <dt class="field-even">Field Word32<span class="colon">:</span>
</dt> <dd class="field-even">
<p>the number of mblocks which we returned to the OS</p> </dd> </dl> <p>Report information about currently allocation megablocks and attempts made to return them to the operating system. If your heap is fragmented then the current value will be greater than needed value but returned will be less than the difference between the two.</p> </dd>
</dl> </section> <section id="heap-events-and-statistics"> <h3>
<span class="section-number">17.2.5. </span>Heap events and statistics</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_ALLOCATED">
<code>HEAP_ALLOCATED</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>49</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>allocated bytes</p> </dd> </dl> <p>A new chunk of heap has been allocated by the indicated capability set.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_SIZE">
<code>HEAP_SIZE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>50</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>heap size in bytes</p> </dd> </dl> <p>Report the heap size, calculated by the number of megablocks currently allocated.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-BLOCKS_SIZE">
<code>BLOCKS_SIZE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>91</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>heap size in bytes</p> </dd> </dl> <p>Report the heap size, calculated by the number of blocks currently allocated.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_LIVE">
<code>HEAP_LIVE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>51</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>heap size in bytes</p> </dd> </dl> <p>Report the live heap size.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_INFO_GHC">
<code>HEAP_INFO_GHC</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>52</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapSetId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>heap capability set</p> </dd> <dt class="field-even">Field Word16<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of garbage collection generations</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>maximum heap size</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>allocation area size</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>MBlock size</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Block size</p> </dd> </dl> <p>Report various information about the heap configuration. Typically produced during RTS initialization..</p> </dd>
</dl> </section> <section id="spark-events"> <h3>
<span class="section-number">17.2.6. </span>Spark events</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CREATE_SPARK_THREAD">
<code>CREATE_SPARK_THREAD</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>15</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A thread has been created to perform spark evaluation.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_COUNTERS">
<code>SPARK_COUNTERS</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>34</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A periodic reporting of various statistics of spark evaluation.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_CREATE">
<code>SPARK_CREATE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>35</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A spark has been added to the spark pool.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_DUD">
<code>SPARK_DUD</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>36</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>TODO</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_OVERFLOW">
<code>SPARK_OVERFLOW</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>37</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>TODO</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_RUN">
<code>SPARK_RUN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>38</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Evaluation has started on a spark.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_STEAL">
<code>SPARK_STEAL</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>39</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word16<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>capability from which the spark was stolen</p> </dd> </dl> <p>A spark has been stolen from another capability for evaluation.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_FIZZLE">
<code>SPARK_FIZZLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>40</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A spark has been GC’d before being evaluated.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-SPARK_GC">
<code>SPARK_GC</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>41</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>An unevaluated spark has been garbage collected.</p> </dd>
</dl> </section> <section id="capability-events"> <h3>
<span class="section-number">17.2.7. </span>Capability events</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CAP_CREATE">
<code>CAP_CREATE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>45</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field CapNo<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>the capability number</p> </dd> </dl> <p>A capability has been started.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CAP_DELETE">
<code>CAP_DELETE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>46</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A capability has been deleted.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CAP_DISABLE">
<code>CAP_DISABLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>47</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A capability has been disabled.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CAP_ENABLE">
<code>CAP_ENABLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>48</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>A capability has been enabled.</p> </dd>
</dl> </section> <section id="task-events"> <h3>
<span class="section-number">17.2.8. </span>Task events</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-TASK_CREATE">
<code>TASK_CREATE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>55</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field TaskId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>task id</p> </dd> <dt class="field-even">Field CapNo<span class="colon">:</span>
</dt> <dd class="field-even">
<p>capability number</p> </dd> <dt class="field-odd">Field KernelThreadId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>The thread-id of the kernel thread which created the task.</p> </dd> </dl> <p>Marks the creation of a task.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-TASK_MIGRATE">
<code>TASK_MIGRATE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>56</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field TaskId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>task id</p> </dd> <dt class="field-even">Field CapNo<span class="colon">:</span>
</dt> <dd class="field-even">
<p>old capability</p> </dd> <dt class="field-odd">Field CapNo<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>new capability</p> </dd> </dl> <p>Marks the migration of a task to a new capability.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-TASK_DELETE">
<code>TASK_DELETE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>57</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field TaskId<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>task id</p> </dd> </dl> <p>Marks the deletion of a task.</p> </dd>
</dl> </section> <section id="tracing-events"> <h3>
<span class="section-number">17.2.9. </span>Tracing events</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-LOG_MSG">
<code>LOG_MSG</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>16</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>The message</p> </dd> </dl> <p>A log message from the runtime system.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-BLOCK_MARKER">
<code>BLOCK_MARKER</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>18</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>block size</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>end time in nanoseconds</p> </dd> <dt class="field-odd">Field Word16<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>capability number, invalid if <code>0xffff</code>.</p> </dd> </dl> <p>Marks a chunk of events. The events that fit in the next <code>block size</code> bytes all belong to the block marker capability.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-USER_MSG">
<code>USER_MSG</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>19</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>message</p> </dd> </dl> <p>A user log message (from, e.g., <a class="reference external" href="../libraries/base-4.21.0.0-8e62/control-concurrent.html#v:traceEvent">Control.Concurrent.traceEvent</a>).</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-USER_MARKER">
<code>USER_MARKER</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>58</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>marker name</p> </dd> </dl> <p>A user marker (from <a class="reference external" href="../libraries/base-4.21.0.0-8e62/debug-trace.html#v:traceMarker">Debug.Trace.traceMarker</a>).</p> </dd>
</dl> </section> </section> <section id="heap-profiler-event-log-output"> <h2 id="heap-profiler-events">
<span class="section-number">17.3. </span>Heap profiler event log output</h2> <p>The heap profiler can produce output to GHC’s event log, allowing samples to be correlated with other event log events over the program’s lifecycle.</p> <p>This section defines the layout of these events. The <code>String</code> type below is defined to be a UTF-8 encoded NUL-terminated string.</p> <section id="metadata-event-types"> <h3>
<span class="section-number">17.3.1. </span>Metadata event types</h3> <section id="beginning-of-sample-stream"> <h4>
<span class="section-number">17.3.1.1. </span>Beginning of sample stream</h4> <p>A single fixed-width event emitted during program start-up describing the samples that follow.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_PROF_BEGIN">
<code>HEAP_PROF_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>160</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field Word8<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>profile ID</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>sampling period in nanoseconds</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>sample breadown type. One of,</p> <ul class="simple"> <li>
<code>HEAP_PROF_BREAKDOWN_COST_CENTER</code> (output from <a class="reference internal" href="profiling.html#rts-flag-hc"><code>-hc</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_CLOSURE_DESCR</code> (output from <a class="reference internal" href="profiling.html#rts-flag-hd"><code>-hd</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_RETAINER</code> (output from <a class="reference internal" href="profiling.html#rts-flag-hr"><code>-hr</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_MODULE</code> (output from <a class="reference internal" href="profiling.html#rts-flag-hm"><code>-hm</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_TYPE_DESCR</code> (output from <a class="reference internal" href="profiling.html#rts-flag-hy"><code>-hy</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_BIOGRAPHY</code> (output from <a class="reference internal" href="profiling.html#rts-flag-hb"><code>-hb</code></a>)</li> <li>
<code>HEAP_PROF_BREAKDOWN_CLOSURE_TYPE</code> (output from <a class="reference internal" href="runtime_control.html#rts-flag-hT"><code>-hT</code></a>)</li> </ul> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>module filter</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>closure description filter</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>type description filter</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>cost centre filter</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>cost centre stack filter</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>retainer filter</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>biography filter</p> </dd> </dl> </dd>
</dl> </section> <section id="cost-centre-definitions"> <h4>
<span class="section-number">17.3.1.2. </span>Cost centre definitions</h4> <p>A variable-length packet produced once for each cost centre,</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_PROF_COST_CENTRE">
<code>HEAP_PROF_COST_CENTRE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>161</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>cost centre number</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>label</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>module</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>source location</p> </dd> <dt class="field-odd">Field Word8<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>flags:</p> <ul class="simple"> <li>bit 0: is the cost-centre a CAF?</li> </ul> </dd> </dl> </dd>
</dl> </section> <section id="info-table-provenance-definitions"> <h4>
<span class="section-number">17.3.1.3. </span>Info Table Provenance definitions</h4> <p>A message which describes an approximate source position for info tables. See <a class="reference internal" href="debug-info.html#ghc-flag-finfo-table-map"><code>-finfo-table-map</code></a> for more information.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-IPE">
<code>IPE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>169</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>info table address</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>table name</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>closure type</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>type</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>source position label</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>source position module</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>source position location</p> </dd> </dl> </dd>
</dl> </section> <section id="sample-event-types"> <h4>
<span class="section-number">17.3.1.4. </span>Sample event types</h4> <p>A sample (consisting of a list of break-down classes, e.g. cost centres, and heap residency sizes), is to be encoded in the body of one or more events.</p> <p>We normally mark the beginning of a new sample with an <code>EVENT_HEAP_PROF_SAMPLE_BEGIN</code> event,</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_PROF_SAMPLE_BEGIN">
<code>HEAP_PROF_SAMPLE_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Length<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>fixed</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>sample number</p> </dd> </dl> <p>Marks the beginning of a heap profile sample.</p> </dd>
</dl> <p>Biographical profiling samples start with the <code>EVENT_HEAP_BIO_PROF_SAMPLE_BEGIN</code> event. These events also include a timestamp which indicates when the sample was taken. This is because all these samples will appear at the end of the eventlog due to how the biographical profiling mode works. You can use the timestamp to reorder the samples relative to the other events.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_BIO_PROF_SAMPLE_BEGIN">
<code>HEAP_BIO_PROF_SAMPLE_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>166</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>sample number</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>eventlog timestamp in ns</p> </dd> </dl> </dd>
</dl> <p>A heap residency census will follow. Since events may only be up to 2^16^ bytes in length a single sample may need to be split among multiple <code>EVENT_HEAP_PROF_SAMPLE</code> events. The precise format of the census entries is determined by the break-down type.</p> <p>At the end of the sample period the <code>EVENT_HEAP_PROF_SAMPLE_END</code> event if emitted. This is useful to properly delimit the sampling period and to record the total time spent profiling.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_PROF_SAMPLE_END">
<code>HEAP_PROF_SAMPLE_END</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>165</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>sample number</p> </dd> </dl> <p>Marks the end of a heap profile sample.</p> </dd>
</dl> </section> <section id="cost-centre-break-down"> <h4>
<span class="section-number">17.3.1.5. </span>Cost-centre break-down</h4> <dl class="simple"> <dt>A variable-length packet encoding a heap profile sample broken down by,</dt>
<dd>
<ul class="simple"> <li>cost-centre (<a class="reference internal" href="profiling.html#rts-flag-hc"><code>-hc</code></a>)</li> </ul> </dd> </dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_PROF_SAMPLE_COST_CENTRE">
<code>HEAP_PROF_SAMPLE_COST_CENTRE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>163</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field Word8<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>profile ID</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>heap residency in bytes</p> </dd> <dt class="field-odd">Field Word8<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>stack depth</p> </dd> <dt class="field-even">Field Word32[]<span class="colon">:</span>
</dt> <dd class="field-even">
<p>cost centre stack starting with inner-most (cost centre numbers)</p> </dd> </dl> </dd>
</dl> </section> <section id="string-break-down"> <h4>
<span class="section-number">17.3.1.6. </span>String break-down</h4> <p>A variable-length event encoding a heap sample broken down by,</p>  <ul class="simple"> <li>type description (<a class="reference internal" href="profiling.html#rts-flag-hy"><code>-hy</code></a>)</li> <li>closure description (<a class="reference internal" href="profiling.html#rts-flag-hd"><code>-hd</code></a>)</li> <li>module (<a class="reference internal" href="profiling.html#rts-flag-hm"><code>-hm</code></a>)</li> </ul>  <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-HEAP_PROF_SAMPLE_STRING">
<code>HEAP_PROF_SAMPLE_STRING</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>164</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field Word8<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>profile ID</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>heap residency in bytes</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>type or closure description, or module name</p> </dd> </dl> </dd>
</dl> </section> </section> </section> <section id="time-profiler-event-log-output"> <h2 id="time-profiler-events">
<span class="section-number">17.4. </span>Time profiler event log output</h2> <p>The time profiling mode enabled by <a class="reference internal" href="profiling.html#rts-flag-p"><code>-p</code></a> also emits sample events to the eventlog. At the start of profiling the tick interval is emitted to the eventlog and then on each tick the current cost centre stack is emitted. Together these enable a user to construct an approximate track of the executation of their program.</p> <section id="profile-begin-event"> <h3>
<span class="section-number">17.4.1. </span>Profile begin event</h3> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-PROF_BEGIN">
<code>PROF_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>168</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>tick interval, in nanoseconds</p> </dd> </dl> <p>Marks the beginning of a time profile.</p> </dd>
</dl> </section> <section id="profile-sample-event"> <h3>
<span class="section-number">17.4.2. </span>Profile sample event</h3> <p>A variable-length packet encoding a profile sample.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-PROF_SAMPLE_COST_CENTRE">
<code>PROF_SAMPLE_COST_CENTRE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>167</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>capability</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>current profiling tick</p> </dd> <dt class="field-odd">Field Word8<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>stack depth</p> </dd> <dt class="field-even">Field Word32[]<span class="colon">:</span>
</dt> <dd class="field-even">
<p>cost centre stack starting with inner-most (cost centre numbers)</p> </dd> </dl> </dd>
</dl> </section> </section> <section id="biographical-profile-sample-event"> <h2>
<span class="section-number">17.5. </span>Biographical profile sample event</h2> <p>A variable-length packet encoding a profile sample.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-BIO_PROF_SAMPLE_BEGIN">
<code>BIO_PROF_SAMPLE_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>166</p> </dd> </dl> <p>TODO</p> </dd>
</dl> </section> <section id="non-moving-gc-event-output"> <h2 id="nonmoving-gc-events">
<span class="section-number">17.6. </span>Non-moving GC event output</h2> <p>These events mark various stages of the <a class="reference internal" href="runtime_control.html#rts-flag-nonmoving-gc"><code>non-moving collection</code></a> lifecycle. These are enabled with the <code>+RTS -lg</code> event-set.</p> <p>A typical non-moving collection cycle will look something like the following:</p> <ol class="arabic simple"> <li>The preparatory phase of collection will emit the usual events associated with a moving collection. See <a class="reference internal" href="#gc-events"><span class="std std-ref">Garbage collector events</span></a> for details.</li> <li>The concurrent write barrier is enabled and the concurrent mark thread is started. From this point forward mutator threads may emit <a class="reference internal" href="#event-type-CONC_UPD_REM_SET_FLUSH"><code>CONC_UPD_REM_SET_FLUSH</code></a> events, indicating that they have flushed their capability-local update remembered sets.</li> <li>Concurrent marking begins, denoted by a <a class="reference internal" href="#event-type-CONC_MARK_BEGIN"><code>CONC_MARK_BEGIN</code></a> event.</li> <li>When the mark queue is depleted a <a class="reference internal" href="#event-type-CONC_MARK_END"><code>CONC_MARK_END</code></a> is emitted.</li> <li>If necessary (e.g. due to weak pointer marking), the marking process will continue, returning to step (3) above.</li> <li>When the collector has done as much concurrent marking as it can it will enter the post-mark synchronization phase of collection, denoted by a <a class="reference internal" href="#event-type-CONC_SYNC_BEGIN"><code>CONC_SYNC_BEGIN</code></a> event.</li> <li>Mutator threads will suspend execution and, if necessary, flush their update remembered sets (indicated by <a class="reference internal" href="#event-type-CONC_UPD_REM_SET_FLUSH"><code>CONC_UPD_REM_SET_FLUSH</code></a> events).</li> <li>The collector will do any final marking necessary (indicated by <a class="reference internal" href="#event-type-CONC_MARK_BEGIN"><code>CONC_MARK_BEGIN</code></a> and <a class="reference internal" href="#event-type-CONC_MARK_END"><code>CONC_MARK_END</code></a> events).</li> <li>The collector will do a small amount of sweeping, disable the write barrier, emit a <a class="reference internal" href="#event-type-CONC_SYNC_END"><code>CONC_SYNC_END</code></a> event, and allow mutators to resume</li> <li>The collector will begin the concurrent sweep phase, indicated by a <a class="reference internal" href="#event-type-CONC_SWEEP_BEGIN"><code>CONC_SWEEP_BEGIN</code></a> event.</li> <li>Once sweeping has concluded a <a class="reference internal" href="#event-type-CONC_SWEEP_END"><code>CONC_SWEEP_END</code></a> event will be emitted and the concurrent collector thread will terminate.</li> <li>A <a class="reference internal" href="#event-type-NONMOVING_HEAP_CENSUS"><code>NONMOVING_HEAP_CENSUS</code></a> event will be emitted describing the fragmentation state of the non-moving heap.</li> <li>A <a class="reference internal" href="#event-type-NONMOVING_PRUNED_SEGMENTS"><code>NONMOVING_PRUNED_SEGMENTS</code></a> event will be emitted showing information about freeing of segments.</li> </ol> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_MARK_BEGIN">
<code>CONC_MARK_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>200</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the beginning of marking by the concurrent collector.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_MARK_END">
<code>CONC_MARK_END</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>201</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>number of objects which were marked in this marking phase.</p> </dd> </dl> <p>Marks the end of marking by the concurrent collector.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_SYNC_BEGIN">
<code>CONC_SYNC_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>202</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the beginning of the concurrent garbage collector’s post-mark synchronization phase.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_SYNC_END">
<code>CONC_SYNC_END</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>203</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the end of the concurrent garbage collector’s post-mark synchronization phase.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_SWEEP_BEGIN">
<code>CONC_SWEEP_BEGIN</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>204</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the beginning of the concurrent garbage collector’s sweep phase.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_SWEEP_END">
<code>CONC_SWEEP_END</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>205</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks the end of the concurrent garbage collector’s sweep phase.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-CONC_UPD_REM_SET_FLUSH">
<code>CONC_UPD_REM_SET_FLUSH</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>206</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Marks a capability flushing its local update remembered set accumulator.</p> </dd>
</dl> <section id="non-moving-heap-census"> <h3>
<span class="section-number">17.6.1. </span>Non-moving heap census</h3> <p>The non-moving heap census events (enabled with the <a class="reference internal" href="runtime_control.html#rts-flag-l-flags"><code>+RTS -ln</code></a> event-set) are intended to provide insight into fragmentation of the non-moving heap.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-NONMOVING_HEAP_CENSUS">
<code>NONMOVING_HEAP_CENSUS</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>207</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word16<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><em>blk_sz</em> in bytes.</p> </dd> <dt class="field-even">Field Word32<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of active segments.</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>number of filled segments.</p> </dd> <dt class="field-even">Field Word32<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of live blocks.</p> </dd> </dl> <p>Describes the occupancy of the <em>blk_sz</em> sub-heap.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-NONMOVING_PRUNED_SEGMENTS">
<code>NONMOVING_PRUNED_SEGMENTS</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>208</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word32<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>number of pruned segments.</p> </dd> <dt class="field-even">Field Word32<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of segments remaining on the free list.</p> </dd> </dl> <p>Report the amount of segments pruned and those remaining on the nonmoving heap’s segment free list. Segments will be retained on the free list until the entire megablock containing them can be freed.</p> </dd>
</dl> </section> <section id="ticky-counters"> <h3 id="ticky-event-format">
<span class="section-number">17.6.2. </span>Ticky counters</h3> <p>Programs compiled with <a class="reference internal" href="profiling.html#ghc-flag-ticky"><code>-ticky</code></a> and <a class="reference internal" href="phases.html#ghc-flag-eventlog"><code>-eventlog</code></a> and invoked with <a class="reference internal" href="runtime_control.html#rts-flag-l-flags"><code>+RTS -lT</code></a> will emit periodic samples of the ticky entry counters to the eventlog.</p> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-TICKY_COUNTER_DEF">
<code>TICKY_COUNTER_DEF</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>210</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>variable</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>counter ID</p> </dd> <dt class="field-even">Field Word16<span class="colon">:</span>
</dt> <dd class="field-even">
<p>arity/field count</p> </dd> <dt class="field-odd">Field String<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>argument kinds. This is the same as the synonymous field in the textual ticky summary.</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>counter name</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>info table address</p> </dd> <dt class="field-even">Field String<span class="colon">:</span>
</dt> <dd class="field-even">
<p>json encoded information about the counter</p> </dd> </dl> <p>Defines a ticky counter.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-TICKY_COUNTER_BEGIN_SAMPLE">
<code>TICKY_COUNTER_BEGIN_SAMPLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>212</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> </dl> <p>Denotes the beginning of an atomic set of ticky-ticky profiler counter samples.</p> </dd>
</dl> <dl class="std event-type"> <dt class="sig sig-object std" id="event-type-TICKY_COUNTER_SAMPLE">
<code>TICKY_COUNTER_SAMPLE</code> </dt> <dd>
<dl class="field-list simple"> <dt class="field-odd">Tag<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>211</p> </dd> <dt class="field-even">Length<span class="colon">:</span>
</dt> <dd class="field-even">
<p>fixed</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>counter ID</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of times closures of this type has been entered.</p> </dd> <dt class="field-odd">Field Word64<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>number of allocations (words)</p> </dd> <dt class="field-even">Field Word64<span class="colon">:</span>
</dt> <dd class="field-even">
<p>number of times this has been allocated (words). Only produced for modules compiled with <a class="reference internal" href="profiling.html#ghc-flag-ticky-allocd"><code>-ticky-allocd</code></a>.</p> </dd> </dl> <p>Records the number of “ticks” recorded by a ticky-ticky counter single the last sample.</p> </dd>
</dl> </section> </section> </section> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2002&ndash;2007 The University Court of the University of Glasgow. All rights reserved.<br>Licensed under the Glasgow Haskell Compiler License.<br>
    <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/users_guide/eventlog-formats.html" class="_attribution-link">https://downloads.haskell.org/~ghc/9.12.1/docs/users_guide/eventlog-formats.html</a>
  </p>
</div>
