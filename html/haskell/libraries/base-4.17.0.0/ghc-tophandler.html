<h1 class="caption">GHC.TopHandler</h1>
<div class="_haskell-api">
<table class="info">
<tr>
<th valign="top">Copyright</th>
<td>(c) The University of Glasgow 2001-2002</td>
</tr>
<tr>
<th>License</th>
<td>see libraries/base/LICENSE</td>
</tr>
<tr>
<th>Maintainer</th>
<td>cvs-ghc@haskell.org</td>
</tr>
<tr>
<th>Stability</th>
<td>internal</td>
</tr>
<tr>
<th>Portability</th>
<td>non-portable (GHC Extensions)</td>
</tr>
<tr>
<th>Safe Haskell</th>
<td>Trustworthy</td>
</tr>
<tr>
<th>Language</th>
<td>Haskell2010</td>
</tr>
</table>
<div id="description">
<h4 class="caption">Description</h4>
<p>Support for catching exceptions raised during top-level computations (e.g. <code>Main.main</code>, <code><a href="control-concurrent.html#v:forkIO" title="Control.Concurrent">forkIO</a></code>, and foreign exports)</p>
</div>
<p class="src"><a id="v:runMainIO" class="def">runMainIO</a> :: <a href="system-io.html#t:IO" title="System.IO">IO</a> a -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#runMainIO" class="link">Source</a> </p>
<p><code><a href="ghc-tophandler.html#v:runMainIO" title="GHC.TopHandler">runMainIO</a></code> is wrapped around <code><a href="main.html#v:main" title="Main">main</a></code> (or whatever main is called in the program). It catches otherwise uncaught exceptions, and also flushes stdout/stderr before exiting.</p>
<p class="src"><a id="v:runIO" class="def">runIO</a> :: <a href="system-io.html#t:IO" title="System.IO">IO</a> a -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#runIO" class="link">Source</a> </p>
<p><code><a href="ghc-tophandler.html#v:runIO" title="GHC.TopHandler">runIO</a></code> is wrapped around every <code>foreign export</code> and <code>foreign
 import "wrapper"</code> to mop up any uncaught exceptions. Thus, the result of running <code><a href="system-exit.html#v:exitWith" title="System.Exit">exitWith</a></code> in a foreign-exported function is the same as in the main thread: it terminates the program.</p>
<p class="src"><a id="v:runIOFastExit" class="def">runIOFastExit</a> :: <a href="system-io.html#t:IO" title="System.IO">IO</a> a -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#runIOFastExit" class="link">Source</a> </p>
<p>Like <code><a href="ghc-tophandler.html#v:runIO" title="GHC.TopHandler">runIO</a></code>, but in the event of an exception that causes an exit, we don't shut down the system cleanly, we just exit. This is useful in some cases, because the safe exit version will give other threads a chance to clean up first, which might shut down the system in a different way. For example, try</p>
<p>main = forkIO (runIO (exitWith (ExitFailure 1))) &gt;&gt; threadDelay 10000</p>
<p>This will sometimes exit with "interrupted" and code 0, because the main thread is given a chance to shut down when the child thread calls safeExit. There is a race to shut down between the main and child threads.</p>
<p class="src"><a id="v:runNonIO" class="def">runNonIO</a> :: a -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#runNonIO" class="link">Source</a> </p>
<p>The same as <code><a href="ghc-tophandler.html#v:runIO" title="GHC.TopHandler">runIO</a></code>, but for non-IO computations. Used for wrapping <code>foreign export</code> and <code>foreign import "wrapper"</code> when these are used to export Haskell functions with non-IO types.</p>
<p class="src"><a id="v:topHandler" class="def">topHandler</a> :: <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#topHandler" class="link">Source</a> </p>
<p class="src"><a id="v:topHandlerFastExit" class="def">topHandlerFastExit</a> :: <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> a <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#topHandlerFastExit" class="link">Source</a> </p>
<p class="src"><a id="v:reportStackOverflow" class="def">reportStackOverflow</a> :: <a href="system-io.html#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Conc.Sync.html#reportStackOverflow" class="link">Source</a> </p>
<p class="src"><a id="v:reportError" class="def">reportError</a> :: <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/Control-Exception-Base.html#t:SomeException" title="Control.Exception.Base">SomeException</a> -&gt; <a href="system-io.html#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.Conc.Sync.html#reportError" class="link">Source</a> </p>
<p class="src"><a id="v:flushStdHandles" class="def">flushStdHandles</a> :: <a href="system-io.html#t:IO" title="System.IO">IO</a> () <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/src/GHC.TopHandler.html#flushStdHandles" class="link">Source</a> </p>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; The University of Glasgow and others<br>Licensed under a BSD-style license (see top of the page).<br>
    <a href="https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/GHC-TopHandler.html" class="_attribution-link">https://downloads.haskell.org/~ghc/9.4.2/docs/libraries/base-4.17.0.0/GHC-TopHandler.html</a>
  </p>
</div>
