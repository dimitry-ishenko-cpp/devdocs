<h1 class="caption">GHC.IO.Handle.Lock</h1>
<div class="_haskell-api">
<table class="info">
<tr>
<th>Safe Haskell</th>
<td>None</td>
</tr>
<tr>
<th>Language</th>
<td>Haskell2010</td>
</tr>
</table>
<p class="src">data <a id="t:FileLockingNotSupported" class="def">FileLockingNotSupported</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.Common.html#FileLockingNotSupported" class="link">Source</a> </p>
<p>Exception thrown by <code class="inline-code">hLock</code> on non-Windows platforms that don't support <code class="inline-code">flock</code>.</p>
<p><span class="version">Since: base-4.10.0.0</span></p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table><tr>
<td class="src"><a id="v:FileLockingNotSupported" class="def">FileLockingNotSupported</a></td>
<td class="doc empty"> </td>
</tr></table>
</div>
<div class="subs instances">
<h5 class="instances details-toggle-control details-toggle" data-details-id="i:FileLockingNotSupported">Instances</h5>
<details id="i:FileLockingNotSupported" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table>
<tr>
<td class="src clearfix">
 <a href="control-exception.html#t:Exception" title="Control.Exception">Exception</a> <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.Common.html#line-18" class="link">Source</a> </td>
<td class="doc empty"> </td>
</tr>
<tr><td colspan="2"><details id="i:id:FileLockingNotSupported:Exception:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/GHC-Internal-IO-Handle-Lock-Common.html">GHC.Internal.IO.Handle.Lock.Common</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:toException">toException</a> :: <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> -&gt; <a href="control-exception.html#t:SomeException" title="Control.Exception">SomeException</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Exception.Type.html#toException" class="link">Source</a> </p>
<p class="src"><a href="#v:fromException">fromException</a> :: <a href="control-exception.html#t:SomeException" title="Control.Exception">SomeException</a> -&gt; <a href="data-maybe.html#t:Maybe" title="Data.Maybe">Maybe</a> <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Exception.Type.html#fromException" class="link">Source</a> </p>
<p class="src"><a href="#v:displayException">displayException</a> :: <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> -&gt; <a href="data-string.html#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Exception.Type.html#displayException" class="link">Source</a> </p>
<p class="src"><a href="#v:backtraceDesired">backtraceDesired</a> :: <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> -&gt; <a href="data-bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Exception.Type.html#backtraceDesired" class="link">Source</a> </p>
</div></details></td></tr>
<tr>
<td class="src clearfix">
 <a href="prelude.html#t:Show" title="Prelude">Show</a> <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.Common.html#line-15" class="link">Source</a> </td>
<td class="doc"><p><span class="version">Since: base-4.10.0.0</span></p></td>
</tr>
<tr><td colspan="2"><details id="i:id:FileLockingNotSupported:Show:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/GHC-Internal-IO-Handle-Lock-Common.html">GHC.Internal.IO.Handle.Lock.Common</a></p> <div class="subs methods">
<h4 class="caption">Methods</h4>
<p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="data-int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> -&gt; <a href="prelude.html#t:ShowS" title="Prelude">ShowS</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Show.html#showsPrec" class="link">Source</a> </p>
<p class="src"><a href="#v:show">show</a> :: <a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a> -&gt; <a href="data-string.html#t:String" title="Data.String">String</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Show.html#show" class="link">Source</a> </p>
<p class="src"><a href="#v:showList">showList</a> :: [<a href="ghc-io-handle-lock.html#t:FileLockingNotSupported" title="GHC.IO.Handle.Lock">FileLockingNotSupported</a>] -&gt; <a href="prelude.html#t:ShowS" title="Prelude">ShowS</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.Show.html#showList" class="link">Source</a> </p>
</div></details></td></tr>
</table></details>
</div>
<p class="src">data <a id="t:LockMode" class="def">LockMode</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.Common.html#LockMode" class="link">Source</a> </p>
<p>Indicates a mode in which a file should be locked.</p>
<div class="subs constructors">
<h4 class="caption">Constructors</h4>
<table>
<tr>
<td class="src"><a id="v:SharedLock" class="def">SharedLock</a></td>
<td class="doc empty"> </td>
</tr>
<tr>
<td class="src"><a id="v:ExclusiveLock" class="def">ExclusiveLock</a></td>
<td class="doc empty"> </td>
</tr>
</table>
</div>
<p class="src"><a id="v:hLock" class="def">hLock</a> :: <a href="ghc-io-handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="ghc-io-handle-lock.html#t:LockMode" title="GHC.IO.Handle.Lock">LockMode</a> -&gt; <a href="prelude.html#t:IO" title="Prelude">IO</a> () <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.html#hLock" class="link">Source</a> </p>
<p>If a <code><a href="ghc-io-handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code> references a file descriptor, attempt to lock contents of the underlying file in appropriate mode. If the file is already locked in incompatible mode, this function blocks until the lock is established. The lock is automatically released upon closing a <code><a href="ghc-io-handle.html#t:Handle" title="GHC.IO.Handle">Handle</a></code>.</p>
<p>Things to be aware of:</p>
<p>1) This function may block inside a C call. If it does, in order to be able to interrupt it with asynchronous exceptions and/or for other threads to continue working, you MUST use threaded version of the runtime system.</p>
<p>2) The implementation uses <code class="inline-code">LockFileEx</code> on Windows and <code class="inline-code">flock</code> otherwise, hence all of their caveats also apply here.</p>
<p>3) On non-Windows platforms that don't support <code class="inline-code">flock</code> (e.g. Solaris) this function throws <code class="inline-code">FileLockingNotImplemented</code>. We deliberately choose to not provide fcntl based locking instead because of its broken semantics.</p>
<p><span class="version">Since: base-4.10.0.0</span></p>
<p class="src"><a id="v:hTryLock" class="def">hTryLock</a> :: <a href="ghc-io-handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="ghc-io-handle-lock.html#t:LockMode" title="GHC.IO.Handle.Lock">LockMode</a> -&gt; <a href="prelude.html#t:IO" title="Prelude">IO</a> <a href="data-bool.html#t:Bool" title="Data.Bool">Bool</a> <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.html#hTryLock" class="link">Source</a> </p>
<p>Non-blocking version of <code><a href="ghc-io-handle-lock.html#v:hLock" title="GHC.IO.Handle.Lock">hLock</a></code>.</p>
<p>Returns <code><a href="data-bool.html#v:True" title="Data.Bool">True</a></code> if taking the lock was successful and <code><a href="data-bool.html#v:False" title="Data.Bool">False</a></code> otherwise.</p>
<p><span class="version">Since: base-4.10.0.0</span></p>
<p class="src"><a id="v:hUnlock" class="def">hUnlock</a> :: <a href="ghc-io-handle.html#t:Handle" title="GHC.IO.Handle">Handle</a> -&gt; <a href="prelude.html#t:IO" title="Prelude">IO</a> () <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/ghc-internal-9.1201.0-3ad5/src/GHC.Internal.IO.Handle.Lock.html#hUnlock" class="link">Source</a> </p>
<p>Release a lock taken with <code><a href="ghc-io-handle-lock.html#v:hLock" title="GHC.IO.Handle.Lock">hLock</a></code> or <code><a href="ghc-io-handle-lock.html#v:hTryLock" title="GHC.IO.Handle.Lock">hTryLock</a></code>.</p>
<p><span class="version">Since: base-4.11.0.0</span></p>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; The University of Glasgow and others<br>Licensed under a BSD-style license (see top of the page).<br>
    <a href="https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/base-4.21.0.0-8e62/GHC-IO-Handle-Lock.html" class="_attribution-link">https://downloads.haskell.org/~ghc/9.12.1/docs/libraries/base-4.21.0.0-8e62/GHC-IO-Handle-Lock.html</a>
  </p>
</div>
