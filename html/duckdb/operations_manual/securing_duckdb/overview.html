<h1 class="title">Securing DuckDB</h1>  <p>DuckDB is quite powerful, which can be problematic, especially if untrusted SQL queries are run, e.g., from public-facing user inputs. This page lists some options to restrict the potential fallout from malicious SQL queries.</p> <p>The approach to securing DuckDB varies depending on your use case, environment, and potential attack models. Therefore, consider the security-related configuration options carefully, especially when working with confidential data sets.</p> <p>If you plan to embed DuckDB in your application, please consult the <a href="../embedding_duckdb.html">“Embedding DuckDB”</a> page.</p> <h2 id="reporting-vulnerabilities"> <a style="text-decoration: none;" href="#reporting-vulnerabilities">Reporting Vulnerabilities</a> </h2> <p>If you discover a potential vulnerability, please <a href="https://github.com/duckdb/duckdb/security/advisories/new">report it confidentially via GitHub</a>.</p> <h2 id="disabling-file-access"> <a style="text-decoration: none;" href="#disabling-file-access">Disabling File Access</a> </h2> <p>DuckDB can list directories and read arbitrary files via its CSV parser’s <a href="../../data/csv/overview.html"><code class="language-plaintext highlighter-rouge">read_csv</code> function</a> or read text via the <a href="../../sql/functions/char.html#read_textsource.html"><code class="language-plaintext highlighter-rouge">read_text</code> function</a>. For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_csv('/etc/passwd', sep = ':');</pre> <p>This can be disabled either by disabling external access altogether (<code class="language-plaintext highlighter-rouge">enable_external_access</code>) or disabling individual file systems. For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SET disabled_filesystems = 'LocalFileSystem';</pre> <h2 id="secrets"> <a style="text-decoration: none;" href="#secrets">Secrets</a> </h2> <p><a href="../../configuration/secrets_manager.html">Secrets</a> are used to manage credentials to log into third party services like AWS or Azure. DuckDB can show a list of secrets using the <code class="language-plaintext highlighter-rouge">duckdb_secrets()</code> table function. This will redact any sensitive information such as security keys by default. The <code class="language-plaintext highlighter-rouge">allow_unredacted_secrets</code> option can be set to show all information contained within a security key. It is recommended not to turn on this option if you are running untrusted SQL input.</p> <p>Queries can access the secrets defined in the Secrets Manager. For example, if there is a secret defined to authenticate with a user, who has write privileges to a given AWS S3 bucket, queries may write to that bucket. This is applicable for both persistent and temporary secrets.</p> <p><a href="../../configuration/secrets_manager.html#persistent-secrets.html">Persistent secrets</a> are stored in unencrypted binary format on the disk. These have the same permissions as SSH keys, <code class="language-plaintext highlighter-rouge">600</code>, i.e., only user who is running the DuckDB (parent) process can read and write them.</p> <h2 id="locking-configurations"> <a style="text-decoration: none;" href="#locking-configurations">Locking Configurations</a> </h2> <p>Security-related configuration settings generally lock themselves for safety reasons. For example, while we can disable <a href="../../extensions/community_extensions.html">community extensions</a> using the <code class="language-plaintext highlighter-rouge">SET allow_community_extensions = false</code>, we cannot re-enable them again after the fact without restarting the database. Trying to do so will result in an error:</p> <pre class="language-console highlighter-rouge" data-language="console">Invalid Input Error: Cannot upgrade allow_community_extensions setting while database is running</pre> <p>This prevents untrusted SQL input from re-enabling settings that were explicitly disabled for security reasons.</p> <p>Nevertheless, many configuration settings do not disable themselves, such as the resource constraints. If you allow users to run SQL statements unrestricted on your own hardware, it is recommended that you lock the configuration after your own configuration has finished using the following command:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SET lock_configuration = true;</pre> <p>This prevents any configuration settings from being modified from that point onwards.</p> <h2 id="constrain-resource-usage"> <a style="text-decoration: none;" href="#constrain-resource-usage">Constrain Resource Usage</a> </h2> <p>DuckDB can use quite a lot of CPU, RAM, and disk space. To avoid denial of service attacks, these resources can be limited.</p> <p>The number of CPU threads that DuckDB can use can be set using, for example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SET threads = 4;</pre> <p>Where 4 is the number of allowed threads.</p> <p>The maximum amount of memory (RAM) can also be limited, for example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SET memory_limit = '4GB';</pre> <p>The size of the temporary file directory can be limited with:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SET max_temp_directory_size = '4GB';</pre> <h2 id="extensions"> <a style="text-decoration: none;" href="#extensions">Extensions</a> </h2> <p>DuckDB has a powerful extension mechanism, which have the same privileges as the user running DuckDB's (parent) process. This introduces security considerations. Therefore, we recommend reviewing the configuration options for <a href="securing_extensions.html">securing extensions</a>.</p> <h2 id="generic-solutions"> <a style="text-decoration: none;" href="#generic-solutions">Generic Solutions</a> </h2> <p>Securing DuckDB can also be supported via proven means, for example:</p> <ul> <li>Scoping user privileges via <a href="https://en.wikipedia.org/wiki/Chroot"><code class="language-plaintext highlighter-rouge">chroot</code></a>, relying on the operating system</li> <li>Containerization, e.g., Docker and Podman</li> <li>Running DuckDB in WebAssembly</li> </ul> <div> <h2 id="pages-in-this-section">Pages in This Section</h2> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/operations_manual/securing_duckdb/overview.html" class="_attribution-link">https://duckdb.org/docs/operations_manual/securing_duckdb/overview.html</a>
  </p>
</div>
