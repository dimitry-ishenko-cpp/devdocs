<h1 class="title">Executing SQL in Python</h1>  <p>SQL queries can be executed using the <code class="language-plaintext highlighter-rouge">duckdb.sql</code> function.</p> <pre class="language-python highlighter-rouge" data-language="python">import duckdb

duckdb.sql("SELECT 42").show()</pre> <p>By default this will create a relation object. The result can be converted to various formats using the result conversion functions. For example, the <code class="language-plaintext highlighter-rouge">fetchall</code> method can be used to convert the result to Python objects.</p> <pre class="language-python highlighter-rouge" data-language="python">results = duckdb.sql("SELECT 42").fetchall()
print(results)</pre> <pre class="language-text highlighter-rouge" data-language="text">[(42,)]</pre> <p>Several other result objects exist. For example, you can use <code class="language-plaintext highlighter-rouge">df</code> to convert the result to a Pandas DataFrame.</p> <pre class="language-python highlighter-rouge" data-language="python">results = duckdb.sql("SELECT 42").df()
print(results)</pre> <pre class="language-text highlighter-rouge" data-language="text">42
 0  42</pre> <p>By default, a global in-memory connection will be used. Any data stored in files will be lost after shutting down the program. A connection to a persistent database can be created using the <code class="language-plaintext highlighter-rouge">connect</code> function.</p> <p>After connecting, SQL queries can be executed using the <code class="language-plaintext highlighter-rouge">sql</code> command.</p> <pre class="language-python highlighter-rouge" data-language="python">con = duckdb.connect("file.db")
con.sql("CREATE TABLE integers (i INTEGER)")
con.sql("INSERT INTO integers VALUES (42)")
con.sql("SELECT * FROM integers").show()</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/guides/python/execute_sql.html" class="_attribution-link">https://duckdb.org/docs/guides/python/execute_sql.html</a>
  </p>
</div>
