<h1 class="title">Reading Multiple Files</h1>  <p>DuckDB can read multiple files of different types (CSV, Parquet, JSON files) at the same time using either the glob syntax, or by providing a list of files to read. See the <a href="combining_schemas.html">combining schemas</a> page for tips on reading files with different schemas.</p> <h2 id="csv"> <a style="text-decoration: none;" href="#csv">CSV</a> </h2> <p>Read all files with a name ending in <code class="language-plaintext highlighter-rouge">.csv</code> in the folder <code class="language-plaintext highlighter-rouge">dir</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM 'dir/*.csv';</pre> <p>Read all files with a name ending in <code class="language-plaintext highlighter-rouge">.csv</code>, two directories deep:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM '*/*/*.csv';</pre> <p>Read all files with a name ending in <code class="language-plaintext highlighter-rouge">.csv</code>, at any depth in the folder <code class="language-plaintext highlighter-rouge">dir</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM 'dir/**/*.csv';</pre> <p>Read the CSV files <code class="language-plaintext highlighter-rouge">flights1.csv</code> and <code class="language-plaintext highlighter-rouge">flights2.csv</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_csv(['flights1.csv', 'flights2.csv']);</pre> <p>Read the CSV files <code class="language-plaintext highlighter-rouge">flights1.csv</code> and <code class="language-plaintext highlighter-rouge">flights2.csv</code>, unifying schemas by name and outputting a <code class="language-plaintext highlighter-rouge">filename</code> column:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_csv(['flights1.csv', 'flights2.csv'], union_by_name = true, filename = true);</pre> <h2 id="parquet"> <a style="text-decoration: none;" href="#parquet">Parquet</a> </h2> <p>Read all files that match the glob pattern:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM 'test/*.parquet';</pre> <p>Read three Parquet files and treat them as a single table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_parquet(['file1.parquet', 'file2.parquet', 'file3.parquet']);</pre> <p>Read all Parquet files from two specific folders:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_parquet(['folder1/*.parquet', 'folder2/*.parquet']);</pre> <p>Read all Parquet files that match the glob pattern at any depth:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_parquet('dir/**/*.parquet');</pre> <h2 id="multi-file-reads-and-globs"> <a style="text-decoration: none;" href="#multi-file-reads-and-globs">Multi-File Reads and Globs</a> </h2> <p>DuckDB can also read a series of Parquet files and treat them as if they were a single table. Note that this only works if the Parquet files have the same schema. You can specify which Parquet files you want to read using a list parameter, glob pattern matching syntax, or a combination of both.</p> <h3 id="list-parameter"> <a style="text-decoration: none;" href="#list-parameter">List Parameter</a> </h3> <p>The <code class="language-plaintext highlighter-rouge">read_parquet</code> function can accept a list of filenames as the input parameter.</p> <p>Read three Parquet files and treat them as a single table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_parquet(['file1.parquet', 'file2.parquet', 'file3.parquet']);</pre> <h3 id="glob-syntax"> <a style="text-decoration: none;" href="#glob-syntax">Glob Syntax</a> </h3> <p>Any file name input to the <code class="language-plaintext highlighter-rouge">read_parquet</code> function can either be an exact filename, or use a glob syntax to read multiple files that match a pattern.</p>  <table> <thead> <tr> <th>Wildcard</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">*</code></td> <td>matches any number of any characters (including none)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">**</code></td> <td>matches any number of subdirectories (including none)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">?</code></td> <td>matches any single character</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">[abc]</code></td> <td>matches one character given in the bracket</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">[a-z]</code></td> <td>matches one character from the range given in the bracket</td> </tr> </tbody> </table> <p>Note that the <code class="language-plaintext highlighter-rouge">?</code> wildcard in globs is not supported for reads over S3 due to HTTP encoding issues.</p> <p>Here is an example that reads all the files that end with <code class="language-plaintext highlighter-rouge">.parquet</code> located in the <code class="language-plaintext highlighter-rouge">test</code> folder:</p> <p>Read all files that match the glob pattern:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_parquet('test/*.parquet');</pre> <h3 id="list-of-globs"> <a style="text-decoration: none;" href="#list-of-globs">List of Globs</a> </h3> <p>The glob syntax and the list input parameter can be combined to scan files that meet one of multiple patterns.</p> <p>Read all Parquet files from 2 specific folders.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_parquet(['folder1/*.parquet', 'folder2/*.parquet']);</pre> <p>DuckDB can read multiple CSV files at the same time using either the glob syntax, or by providing a list of files to read.</p> <h2 id="filename"> <a style="text-decoration: none;" href="#filename">Filename</a> </h2> <p>The <code class="language-plaintext highlighter-rouge">filename</code> argument can be used to add an extra <code class="language-plaintext highlighter-rouge">filename</code> column to the result that indicates which row came from which file. For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM read_csv(['flights1.csv', 'flights2.csv'], union_by_name = true, filename = true);</pre>  <table> <thead> <tr> <th>FlightDate</th> <th>OriginCityName</th> <th>DestCityName</th> <th>UniqueCarrier</th> <th>filename</th> </tr> </thead> <tbody> <tr> <td>1988-01-01</td> <td>New York, NY</td> <td>Los Angeles, CA</td> <td>NULL</td> <td>flights1.csv</td> </tr> <tr> <td>1988-01-02</td> <td>New York, NY</td> <td>Los Angeles, CA</td> <td>NULL</td> <td>flights1.csv</td> </tr> <tr> <td>1988-01-03</td> <td>New York, NY</td> <td>Los Angeles, CA</td> <td>AA</td> <td>flights2.csv</td> </tr> </tbody> </table> <h2 id="glob-function-to-find-filenames"> <a style="text-decoration: none;" href="#glob-function-to-find-filenames">Glob Function to Find Filenames</a> </h2> <p>The glob pattern matching syntax can also be used to search for filenames using the <code class="language-plaintext highlighter-rouge">glob</code> table function. It accepts one parameter: the path to search (which may include glob patterns).</p> <p>Search the current directory for all files.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM glob('*');</pre>  <table> <thead> <tr> <th>file</th> </tr> </thead> <tbody> <tr> <td>test.csv</td> </tr> <tr> <td>test.json</td> </tr> <tr> <td>test.parquet</td> </tr> <tr> <td>test2.csv</td> </tr> <tr> <td>test2.parquet</td> </tr> <tr> <td>todos.json</td> </tr> </tbody> </table> <div> <h2 id="pages-in-this-section">Pages in This Section</h2> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/data/multiple_files/overview.html" class="_attribution-link">https://duckdb.org/docs/data/multiple_files/overview.html</a>
  </p>
</div>
