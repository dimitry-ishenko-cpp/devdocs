<h1 class="title">ALTER TABLE Statement</h1>  <p>The <code class="language-plaintext highlighter-rouge">ALTER TABLE</code> statement changes the schema of an existing table in the catalog.</p> <h2 id="examples"> <a style="text-decoration: none;" href="#examples">Examples</a> </h2> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE integers (i INTEGER, j INTEGER);</pre> <p>Add a new column with name <code class="language-plaintext highlighter-rouge">k</code> to the table <code class="language-plaintext highlighter-rouge">integers</code>, it will be filled with the default value <code class="language-plaintext highlighter-rouge">NULL</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD COLUMN k INTEGER;</pre> <p>Add a new column with name <code class="language-plaintext highlighter-rouge">l</code> to the table integers, it will be filled with the default value 10:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD COLUMN l INTEGER DEFAULT 10;</pre> <p>Drop the column <code class="language-plaintext highlighter-rouge">k</code> from the table integers:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers DROP k;</pre> <p>Change the type of the column <code class="language-plaintext highlighter-rouge">i</code> to the type <code class="language-plaintext highlighter-rouge">VARCHAR</code> using a standard cast:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER i TYPE VARCHAR;</pre> <p>Change the type of the column <code class="language-plaintext highlighter-rouge">i</code> to the type <code class="language-plaintext highlighter-rouge">VARCHAR</code>, using the specified expression to convert the data for each row:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER i SET DATA TYPE VARCHAR USING concat(i, '_', j);</pre> <p>Set the default value of a column:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER COLUMN i SET DEFAULT 10;</pre> <p>Drop the default value of a column:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER COLUMN i DROP DEFAULT;</pre> <p>Make a column not nullable:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER COLUMN i SET NOT NULL;</pre> <p>Drop the not-<code class="language-plaintext highlighter-rouge">NULL</code> constraint:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER COLUMN i DROP NOT NULL;</pre> <p>Rename a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers RENAME TO integers_old;</pre> <p>Rename a column of a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers RENAME i TO ii;</pre> <p>Add a primary key to a column of a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD PRIMARY KEY (i);</pre> <h2 id="syntax"> <a style="text-decoration: none;" href="#syntax">Syntax</a> </h2>  <p><code class="language-plaintext highlighter-rouge">ALTER TABLE</code> changes the schema of an existing table. All the changes made by <code class="language-plaintext highlighter-rouge">ALTER TABLE</code> fully respect the transactional semantics, i.e., they will not be visible to other transactions until committed, and can be fully reverted through a rollback.</p> <h2 id="rename-table"> <a style="text-decoration: none;" href="#rename-table"><code class="language-plaintext highlighter-rouge">RENAME TABLE</code></a> </h2> <p>Rename a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers RENAME TO integers_old;</pre> <p>The <code class="language-plaintext highlighter-rouge">RENAME TO</code> clause renames an entire table, changing its name in the schema. Note that any views that rely on the table are <strong>not</strong> automatically updated.</p> <h2 id="rename-column"> <a style="text-decoration: none;" href="#rename-column"><code class="language-plaintext highlighter-rouge">RENAME COLUMN</code></a> </h2> <p>Rename a column of a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers RENAME i TO j;
ALTER TABLE integers RENAME COLUMN j TO k;</pre> <p>The <code class="language-plaintext highlighter-rouge">RENAME COLUMN</code> clause renames a single column within a table. Any constraints that rely on this name (e.g., <code class="language-plaintext highlighter-rouge">CHECK</code> constraints) are automatically updated. However, note that any views that rely on this column name are <strong>not</strong> automatically updated.</p> <h2 id="add-column"> <a style="text-decoration: none;" href="#add-column"><code class="language-plaintext highlighter-rouge">ADD COLUMN</code></a> </h2> <p>Add a new column with name <code class="language-plaintext highlighter-rouge">k</code> to the table <code class="language-plaintext highlighter-rouge">integers</code>, it will be filled with the default value NULL:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD COLUMN k INTEGER;</pre> <p>Add a new column with name <code class="language-plaintext highlighter-rouge">l</code> to the table integers, it will be filled with the default value 10:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD COLUMN l INTEGER DEFAULT 10;</pre> <p>The <code class="language-plaintext highlighter-rouge">ADD COLUMN</code> clause can be used to add a new column of a specified type to a table. The new column will be filled with the specified default value, or <code class="language-plaintext highlighter-rouge">NULL</code> if none is specified.</p> <h2 id="drop-column"> <a style="text-decoration: none;" href="#drop-column"><code class="language-plaintext highlighter-rouge">DROP COLUMN</code></a> </h2> <p>Drop the column <code class="language-plaintext highlighter-rouge">k</code> from the table <code class="language-plaintext highlighter-rouge">integers</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers DROP k;</pre> <p>The <code class="language-plaintext highlighter-rouge">DROP COLUMN</code> clause can be used to remove a column from a table. Note that columns can only be removed if they do not have any indexes that rely on them. This includes any indexes created as part of a <code class="language-plaintext highlighter-rouge">PRIMARY KEY</code> or <code class="language-plaintext highlighter-rouge">UNIQUE</code> constraint. Columns that are part of multi-column check constraints cannot be dropped either. If you attempt to drop a column with an index on it, DuckDB will return the following error message:</p> <pre class="language-console highlighter-rouge" data-language="console">Dependency Error: Cannot alter entry "..." because there are entries that depend on it.</pre> <h2 id="alter-type"> <a style="text-decoration: none;" href="#alter-type"><code class="language-plaintext highlighter-rouge">ALTER TYPE</code></a> </h2> <p>Change the type of the column <code class="language-plaintext highlighter-rouge">i</code> to the type <code class="language-plaintext highlighter-rouge">VARCHAR</code> using a standard cast:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER i TYPE VARCHAR;</pre> <p>Change the type of the column <code class="language-plaintext highlighter-rouge">i</code> to the type <code class="language-plaintext highlighter-rouge">VARCHAR</code>, using the specified expression to convert the data for each row:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER i SET DATA TYPE VARCHAR USING concat(i, '_', j);</pre> <p>The <code class="language-plaintext highlighter-rouge">SET DATA TYPE</code> clause changes the type of a column in a table. Any data present in the column is converted according to the provided expression in the <code class="language-plaintext highlighter-rouge">USING</code> clause, or, if the <code class="language-plaintext highlighter-rouge">USING</code> clause is absent, cast to the new data type. Note that columns can only have their type changed if they do not have any indexes that rely on them and are not part of any <code class="language-plaintext highlighter-rouge">CHECK</code> constraints.</p> <h2 id="set--drop-default"> <a style="text-decoration: none;" href="#set--drop-default"><code class="language-plaintext highlighter-rouge">SET</code> / <code class="language-plaintext highlighter-rouge">DROP DEFAULT</code></a> </h2> <p>Set the default value of a column:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER COLUMN i SET DEFAULT 10;</pre> <p>Drop the default value of a column:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ALTER COLUMN i DROP DEFAULT;</pre> <p>The <code class="language-plaintext highlighter-rouge">SET/DROP DEFAULT</code> clause modifies the <code class="language-plaintext highlighter-rouge">DEFAULT</code> value of an existing column. Note that this does not modify any existing data in the column. Dropping the default is equivalent to setting the default value to NULL.</p> <blockquote> <p>Warning At the moment DuckDB will not allow you to alter a table if there are any dependencies. That means that if you have an index on a column you will first need to drop the index, alter the table, and then recreate the index. Otherwise, you will get a <code class="language-plaintext highlighter-rouge">Dependency Error</code>.</p> </blockquote> <h2 id="add-primary-key"> <a style="text-decoration: none;" href="#add-primary-key"><code class="language-plaintext highlighter-rouge">ADD PRIMARY KEY</code></a> </h2> <p>Add a primary key to a column of a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD PRIMARY KEY (i);</pre> <p>Add a primary key to multiple columns of a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE integers ADD PRIMARY KEY (i, j);</pre> <h2 id="add--drop-constraint"> <a style="text-decoration: none;" href="#add--drop-constraint"><code class="language-plaintext highlighter-rouge">ADD</code> / <code class="language-plaintext highlighter-rouge">DROP CONSTRAINT</code></a> </h2> <blockquote> <p><code class="language-plaintext highlighter-rouge">ADD CONSTRAINT</code> and <code class="language-plaintext highlighter-rouge">DROP CONSTRAINT</code> clauses are not yet supported in DuckDB.</p> </blockquote><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/sql/statements/alter_table.html" class="_attribution-link">https://duckdb.org/docs/sql/statements/alter_table.html</a>
  </p>
</div>
