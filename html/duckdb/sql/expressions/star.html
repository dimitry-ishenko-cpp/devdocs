<h1 class="title">Star Expression</h1>  <h2 id="examples"> <a style="text-decoration: none;" href="#examples">Examples</a> </h2> <p>Select all columns present in the <code class="language-plaintext highlighter-rouge">FROM</code> clause:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * FROM table_name;</pre> <p>Count the number of rows in a table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT count(*) FROM table_name;</pre> <p>DuckDB offers a shorthand for <code class="language-plaintext highlighter-rouge">count(*)</code> expressions where the <code class="language-plaintext highlighter-rouge">*</code> may be omitted:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT count() FROM table_name;</pre> <p>Select all columns from the table called <code class="language-plaintext highlighter-rouge">table_name</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT table_name.*
FROM table_name
JOIN other_table_name USING (id);</pre> <p>Select all columns except the city column from the addresses table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * EXCLUDE (city)
FROM addresses;</pre> <p>Select all columns from the addresses table, but replace city with <code class="language-plaintext highlighter-rouge">lower(city)</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * REPLACE (lower(city) AS city)
FROM addresses;</pre> <p>Select all columns matching the given expression:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS(c -&gt; c LIKE '%num%')
FROM addresses;</pre> <p>Select all columns matching the given regex from the table:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS('number\d+')
FROM addresses;</pre> <p>Select columns using a list:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS(['city', 'zip_code'])
FROM addresses;</pre> <h2 id="syntax"> <a style="text-decoration: none;" href="#syntax">Syntax</a> </h2>  <h2 id="star-expression"> <a style="text-decoration: none;" href="#star-expression">Star Expression</a> </h2> <p>The <code class="language-plaintext highlighter-rouge">*</code> expression can be used in a <code class="language-plaintext highlighter-rouge">SELECT</code> statement to select all columns that are projected in the <code class="language-plaintext highlighter-rouge">FROM</code> clause.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM tbl;</pre> <p>The <code class="language-plaintext highlighter-rouge">*</code> expression can be modified using the <code class="language-plaintext highlighter-rouge">EXCLUDE</code> and <code class="language-plaintext highlighter-rouge">REPLACE</code>.</p> <h3 id="exclude-clause"> <a style="text-decoration: none;" href="#exclude-clause"><code class="language-plaintext highlighter-rouge">EXCLUDE</code> Clause</a> </h3> <p><code class="language-plaintext highlighter-rouge">EXCLUDE</code> allows us to exclude specific columns from the <code class="language-plaintext highlighter-rouge">*</code> expression.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * EXCLUDE (col)
FROM tbl;</pre> <h3 id="replace-clause"> <a style="text-decoration: none;" href="#replace-clause"><code class="language-plaintext highlighter-rouge">REPLACE</code> Clause</a> </h3> <p><code class="language-plaintext highlighter-rouge">REPLACE</code> allows us to replace specific values in columns as specified by an expression.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * REPLACE (col / 1_000 AS col)
FROM tbl;</pre> <h2 id="columns-expression"> <a style="text-decoration: none;" href="#columns-expression"><code class="language-plaintext highlighter-rouge">COLUMNS</code> Expression</a> </h2> <p>The <code class="language-plaintext highlighter-rouge">COLUMNS</code> expression can be used to execute the same expression on the values in multiple columns. For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE numbers (id INTEGER, number INTEGER);
INSERT INTO numbers VALUES (1, 10), (2, 20), (3, NULL);
SELECT min(COLUMNS(*)), count(COLUMNS(*)) FROM numbers;</pre>  <table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">number</th> <th style="text-align: right">id</th> <th style="text-align: right">number</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">10</td> <td style="text-align: right">3</td> <td style="text-align: right">2</td> </tr> </tbody> </table> <p>The <code class="language-plaintext highlighter-rouge">*</code> expression in the <code class="language-plaintext highlighter-rouge">COLUMNS</code> statement can also contain <code class="language-plaintext highlighter-rouge">EXCLUDE</code> or <code class="language-plaintext highlighter-rouge">REPLACE</code>, similar to regular star expressions.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT
    min(COLUMNS(* REPLACE (number + id AS number))),
    count(COLUMNS(* EXCLUDE (number)))
FROM numbers;</pre>  <table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">min(number := (number + id))</th> <th style="text-align: right">id</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">11</td> <td style="text-align: right">3</td> </tr> </tbody> </table> <p><code class="language-plaintext highlighter-rouge">COLUMNS</code> expressions can also be combined, as long as the <code class="language-plaintext highlighter-rouge">COLUMNS</code> contains the same (star) expression:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS(*) + COLUMNS(*) FROM numbers;</pre>  <table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">number</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">2</td> <td style="text-align: right">20</td> </tr> <tr> <td style="text-align: right">4</td> <td style="text-align: right">40</td> </tr> <tr> <td style="text-align: right">6</td> <td style="text-align: right">NULL</td> </tr> </tbody> </table> <p><code class="language-plaintext highlighter-rouge">COLUMNS</code> expressions can also be used in <code class="language-plaintext highlighter-rouge">WHERE</code> clauses. The conditions are applied to all columns and are combined using the logical <code class="language-plaintext highlighter-rouge">AND</code> operator.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT *
FROM (
    SELECT 0 AS x, 1 AS y, 2 AS z
    UNION ALL
    SELECT 1 AS x, 2 AS y, 3 AS z
    UNION ALL
    SELECT 2 AS x, 3 AS y, 4 AS z
)
WHERE COLUMNS(*) &gt; 1; -- equivalent to: x &gt; 1 AND y &gt; 1 AND z &gt; 1</pre>  <table> <thead> <tr> <th style="text-align: right">x</th> <th style="text-align: right">y</th> <th style="text-align: right">z</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">2</td> <td style="text-align: right">3</td> <td style="text-align: right">4</td> </tr> </tbody> </table> <h2 id="columns-regular-expression"> <a style="text-decoration: none;" href="#columns-regular-expression"><code class="language-plaintext highlighter-rouge">COLUMNS</code> Regular Expression</a> </h2> <p><code class="language-plaintext highlighter-rouge">COLUMNS</code> supports passing a regex in as a string constant:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS('(id|numbers?)') FROM numbers;</pre>  <table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">number</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">10</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">20</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">NULL</td> </tr> </tbody> </table> <h3 id="renaming-columns-using-a-columns-expression"> <a style="text-decoration: none;" href="#renaming-columns-using-a-columns-expression">Renaming Columns Using a <code class="language-plaintext highlighter-rouge">COLUMNS</code> Expression</a> </h3> <p>The matches of capture groups can be used to rename columns selected by a regular expression. The capture groups are one-indexed; <code class="language-plaintext highlighter-rouge">\0</code> is the original column name.</p> <p>For example, to select the first three letters of colum names, run:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS('(\w{3}).*') AS '\1' FROM numbers;</pre>  <table> <thead> <tr> <th style="text-align: right">id</th> <th style="text-align: right">num</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">10</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">20</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">NULL</td> </tr> </tbody> </table> <p>To remove a colon (<code class="language-plaintext highlighter-rouge">:</code>) character in the middle of a column name, run:</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE tbl ("Foo:Bar" INTEGER, "Foo:Baz" INTEGER, "Foo:Qux" INTEGER);
SELECT COLUMNS('(\w*):(\w*)') AS '\1\2' FROM tbl;</pre> <h2 id="columns-lambda-function"> <a style="text-decoration: none;" href="#columns-lambda-function"><code class="language-plaintext highlighter-rouge">COLUMNS</code> Lambda Function</a> </h2> <p><code class="language-plaintext highlighter-rouge">COLUMNS</code> also supports passing in a lambda function. The lambda function will be evaluated for all columns present in the <code class="language-plaintext highlighter-rouge">FROM</code> clause, and only columns that match the lambda function will be returned. This allows the execution of arbitrary expressions in order to select and rename columns.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT COLUMNS(c -&gt; c LIKE '%num%') FROM numbers;</pre>  <table> <thead> <tr> <th style="text-align: right">number</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">10</td> </tr> <tr> <td style="text-align: right">20</td> </tr> <tr> <td style="text-align: right">NULL</td> </tr> </tbody> </table> <h2 id="columns-unpacked-columns"> <a style="text-decoration: none;" href="#columns-unpacked-columns"><code class="language-plaintext highlighter-rouge">*COLUMNS</code> Unpacked Columns</a> </h2> <p>The <code class="language-plaintext highlighter-rouge">*COLUMNS</code> clause is a variation of <code class="language-plaintext highlighter-rouge">COLUMNS</code>, which supports all of the previously mentioned capabilities. The difference is in how the expression expands.</p> <p><code class="language-plaintext highlighter-rouge">*COLUMNS</code> will expand in-place, much like the <a href="https://peps.python.org/pep-3132/">iterable unpacking behavior in Python</a>, which inspired the <code class="language-plaintext highlighter-rouge">*</code> syntax. This implies that the expression expands into the parent expression. An example that shows this difference between <code class="language-plaintext highlighter-rouge">COLUMNS</code> and <code class="language-plaintext highlighter-rouge">*COLUMNS</code>:</p> <p>With <code class="language-plaintext highlighter-rouge">COLUMNS</code>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT coalesce(COLUMNS(['a', 'b', 'c'])) AS result
FROM (SELECT NULL a, 42 b, true c);</pre> <table> <thead> <tr> <th>result</th> <th style="text-align: right">result</th> <th style="text-align: right">result</th> </tr> </thead> <tbody> <tr> <td>NULL</td> <td style="text-align: right">42</td> <td style="text-align: right">true</td> </tr> </tbody> </table> <p>With <code class="language-plaintext highlighter-rouge">*COLUMNS</code>, the expression expands in its parent expression <code class="language-plaintext highlighter-rouge">coalesce</code>, resulting in a single result column:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT coalesce(*COLUMNS(['a', 'b', 'c'])) AS result
FROM (SELECT NULL AS a, 42 AS b, true AS c);</pre> <table> <thead> <tr> <th style="text-align: right">result</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">42</td> </tr> </tbody> </table> <p><code class="language-plaintext highlighter-rouge">*COLUMNS</code> also works with the <code class="language-plaintext highlighter-rouge">(*)</code> argument:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT coalesce(*COLUMNS(*)) AS result
FROM (SELECT NULL a, 42 AS b, true AS c);</pre> <table> <thead> <tr> <th style="text-align: right">result</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">42</td> </tr> </tbody> </table> <h2 id="struct"> <a style="text-decoration: none;" href="#struct"><code class="language-plaintext highlighter-rouge">STRUCT.*</code></a> </h2> <p>The <code class="language-plaintext highlighter-rouge">*</code> expression can also be used to retrieve all keys from a struct as separate columns. This is particularly useful when a prior operation creates a struct of unknown shape, or if a query must handle any potential struct keys. See the <a href="../data_types/struct.html"><code class="language-plaintext highlighter-rouge">STRUCT</code> data type</a> and <a href="../functions/struct.html"><code class="language-plaintext highlighter-rouge">STRUCT</code> functions</a> pages for more details on working with structs.</p> <p>For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT st.* FROM (SELECT {'x': 1, 'y': 2, 'z': 3} AS st);</pre>  <table> <thead> <tr> <th style="text-align: right">x</th> <th style="text-align: right">y</th> <th style="text-align: right">z</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">2</td> <td style="text-align: right">3</td> </tr> </tbody> </table><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/sql/expressions/star.html" class="_attribution-link">https://duckdb.org/docs/sql/expressions/star.html</a>
  </p>
</div>
