<h1 class="title">CASE Statement</h1>   <p>The <code class="language-plaintext highlighter-rouge">CASE</code> statement performs a switch based on a condition. The basic form is identical to the ternary condition used in many programming languages (<code class="language-plaintext highlighter-rouge">CASE WHEN cond THEN a ELSE b END</code> is equivalent to <code class="language-plaintext highlighter-rouge">cond ? a : b</code>). With a single condition this can be expressed with <code class="language-plaintext highlighter-rouge">IF(cond, a, b)</code>.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;
SELECT i, CASE WHEN i &gt; 2 THEN 1 ELSE 0 END AS test
FROM integers;</pre> <table> <thead> <tr> <th style="text-align: right">i</th> <th style="text-align: right">test</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">0</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">1</td> </tr> </tbody> </table> <p>This is equivalent to:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT i, IF(i &gt; 2, 1, 0) AS test
FROM integers;</pre> <p>The <code class="language-plaintext highlighter-rouge">WHEN cond THEN expr</code> part of the <code class="language-plaintext highlighter-rouge">CASE</code> statement can be chained, whenever any of the conditions returns true for a single tuple, the corresponding expression is evaluated and returned.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;
SELECT i, CASE WHEN i = 1 THEN 10 WHEN i = 2 THEN 20 ELSE 0 END AS test
FROM integers;</pre> <table> <thead> <tr> <th style="text-align: right">i</th> <th style="text-align: right">test</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">10</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">20</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">0</td> </tr> </tbody> </table> <p>The <code class="language-plaintext highlighter-rouge">ELSE</code> part of the <code class="language-plaintext highlighter-rouge">CASE</code> statement is optional. If no else statement is provided and none of the conditions match, the <code class="language-plaintext highlighter-rouge">CASE</code> statement will return <code class="language-plaintext highlighter-rouge">NULL</code>.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;
SELECT i, CASE WHEN i = 1 THEN 10 END AS test
FROM integers;</pre> <table> <thead> <tr> <th style="text-align: right">i</th> <th style="text-align: right">test</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">10</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">NULL</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">NULL</td> </tr> </tbody> </table> <p>It is also possible to provide an individual expression after the <code class="language-plaintext highlighter-rouge">CASE</code> but before the <code class="language-plaintext highlighter-rouge">WHEN</code>. When this is done, the <code class="language-plaintext highlighter-rouge">CASE</code> statement is effectively transformed into a switch statement.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE OR REPLACE TABLE integers AS SELECT unnest([1, 2, 3]) AS i;
SELECT i, CASE i WHEN 1 THEN 10 WHEN 2 THEN 20 WHEN 3 THEN 30 END AS test
FROM integers;</pre> <table> <thead> <tr> <th style="text-align: right">i</th> <th style="text-align: right">test</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">1</td> <td style="text-align: right">10</td> </tr> <tr> <td style="text-align: right">2</td> <td style="text-align: right">20</td> </tr> <tr> <td style="text-align: right">3</td> <td style="text-align: right">30</td> </tr> </tbody> </table> <p>This is equivalent to:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT i, CASE WHEN i = 1 THEN 10 WHEN i = 2 THEN 20 WHEN i = 3 THEN 30 END AS test
FROM integers;</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/sql/expressions/case.html" class="_attribution-link">https://duckdb.org/docs/sql/expressions/case.html</a>
  </p>
</div>
