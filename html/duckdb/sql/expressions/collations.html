<h1 class="title">Collations</h1>   <p>Collations provide rules for how text should be sorted or compared in the execution engine. Collations are useful for localization, as the rules for how text should be ordered are different for different languages or for different countries. These orderings are often incompatible with one another. For example, in English the letter <code class="language-plaintext highlighter-rouge">y</code> comes between <code class="language-plaintext highlighter-rouge">x</code> and <code class="language-plaintext highlighter-rouge">z</code>. However, in Lithuanian the letter <code class="language-plaintext highlighter-rouge">y</code> comes between the <code class="language-plaintext highlighter-rouge">i</code> and <code class="language-plaintext highlighter-rouge">j</code>. For that reason, different collations are supported. The user must choose which collation they want to use when performing sorting and comparison operations.</p> <p>By default, the <code class="language-plaintext highlighter-rouge">BINARY</code> collation is used. That means that strings are ordered and compared based only on their binary contents. This makes sense for standard ASCII characters (i.e., the letters A-Z and numbers 0-9), but generally does not make much sense for special unicode characters. It is, however, by far the fastest method of performing ordering and comparisons. Hence it is recommended to stick with the <code class="language-plaintext highlighter-rouge">BINARY</code> collation unless required otherwise.</p> <blockquote> <p>Warning Collation support in DuckDB has <a href="https://github.com/duckdb/duckdb/issues?q=is%3Aissue+is%3Aopen+collation+">some known limitations</a> and has <a href="https://github.com/duckdb/duckdb/issues/604">several planned improvements</a>.</p> </blockquote> <h2 id="using-collations"> <a style="text-decoration: none;" href="#using-collations">Using Collations</a> </h2> <p>In the stand-alone installation of DuckDB three collations are included: <code class="language-plaintext highlighter-rouge">NOCASE</code>, <code class="language-plaintext highlighter-rouge">NOACCENT</code> and <code class="language-plaintext highlighter-rouge">NFC</code>. The <code class="language-plaintext highlighter-rouge">NOCASE</code> collation compares characters as equal regardless of their casing. The <code class="language-plaintext highlighter-rouge">NOACCENT</code> collation compares characters as equal regardless of their accents. The <code class="language-plaintext highlighter-rouge">NFC</code> collation performs NFC-normalized comparisons, see <a href="https://en.wikipedia.org/wiki/Unicode_equivalence#Normalization">Unicode normalization</a> for more information.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' = 'hElLO';</pre> <pre class="language-text highlighter-rouge" data-language="text">false</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' COLLATE NOCASE = 'hElLO';</pre> <pre class="language-text highlighter-rouge" data-language="text">true</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' = 'hëllo';</pre> <pre class="language-text highlighter-rouge" data-language="text">false</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' COLLATE NOACCENT = 'hëllo';</pre> <pre class="language-text highlighter-rouge" data-language="text">true</pre> <p>Collations can be combined by chaining them using the dot operator. Note, however, that not all collations can be combined together. In general, the <code class="language-plaintext highlighter-rouge">NOCASE</code> collation can be combined with any other collator, but most other collations cannot be combined.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' COLLATE NOCASE = 'hElLÖ';</pre> <pre class="language-text highlighter-rouge" data-language="text">false</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' COLLATE NOACCENT = 'hElLÖ';</pre> <pre class="language-text highlighter-rouge" data-language="text">false</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT 'hello' COLLATE NOCASE.NOACCENT = 'hElLÖ';</pre> <pre class="language-text highlighter-rouge" data-language="text">true</pre> <h2 id="default-collations"> <a style="text-decoration: none;" href="#default-collations">Default Collations</a> </h2> <p>The collations we have seen so far have all been specified <em>per expression</em>. It is also possible to specify a default collator, either on the global database level or on a base table column. The <code class="language-plaintext highlighter-rouge">PRAGMA</code> <code class="language-plaintext highlighter-rouge">default_collation</code> can be used to specify the global default collator. This is the collator that will be used if no other one is specified.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SET default_collation = NOCASE;
SELECT 'hello' = 'HeLlo';</pre> <pre class="language-text highlighter-rouge" data-language="text">true</pre> <p>Collations can also be specified per-column when creating a table. When that column is then used in a comparison, the per-column collation is used to perform that comparison.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE names (name VARCHAR COLLATE NOACCENT);
INSERT INTO names VALUES ('hännes');</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT name
FROM names
WHERE name = 'hannes';</pre> <pre class="language-text highlighter-rouge" data-language="text">hännes</pre> <p>Be careful here, however, as different collations cannot be combined. This can be problematic when you want to compare columns that have a different collation specified.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT name
FROM names
WHERE name = 'hannes' COLLATE NOCASE;</pre> <pre class="language-console highlighter-rouge" data-language="console">ERROR: Cannot combine types with different collation!</pre> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE other_names (name VARCHAR COLLATE NOCASE);
INSERT INTO other_names VALUES ('HÄNNES');</pre> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT names.name AS name, other_names.name AS other_name
FROM names, other_names
WHERE names.name = other_names.name;</pre> <pre class="language-console highlighter-rouge" data-language="console">ERROR: Cannot combine types with different collation!</pre> <p>We need to manually overwrite the collation:</p> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT names.name AS name, other_names.name AS other_name
FROM names, other_names
WHERE names.name COLLATE NOACCENT.NOCASE = other_names.name COLLATE NOACCENT.NOCASE;</pre> <table> <thead> <tr> <th>name</th> <th>other_name</th> </tr> </thead> <tbody> <tr> <td>hännes</td> <td>HÄNNES</td> </tr> </tbody> </table> <h2 id="icu-collations"> <a style="text-decoration: none;" href="#icu-collations">ICU Collations</a> </h2> <p>The collations we have seen so far are not region-dependent, and do not follow any specific regional rules. If you wish to follow the rules of a specific region or language, you will need to use one of the ICU collations. For that, you need to <a href="../../extensions/icu.html#installing-and-loading.html">load the ICU extension</a>.</p> <p>If you are using the C++ API, you may find the extension in the <code class="language-plaintext highlighter-rouge">extension/icu</code> folder of the DuckDB project. Using the C++ API, the extension can be loaded as follows:</p> <pre class="language-cpp highlighter-rouge" data-language="cpp">DuckDB db;
db.LoadExtension&lt;ICUExtension&gt;();</pre> <p>Loading this extension will add a number of language and region specific collations to your database. These can be queried using <code class="language-plaintext highlighter-rouge">PRAGMA collations</code> command, or by querying the <code class="language-plaintext highlighter-rouge">pragma_collations</code> function.</p> <pre class="language-sql highlighter-rouge" data-language="sql">PRAGMA collations;
SELECT * FROM pragma_collations();</pre> <pre class="language-text highlighter-rouge" data-language="text">[af, am, ar, as, az, be, bg, bn, bo, bs, bs, ca, ceb, chr, cs, cy, da, de, de_AT, dsb, dz, ee, el, en, en_US, en_US, eo, es, et, fa, fa_AF, fi, fil, fo, fr, fr_CA, ga, gl, gu, ha, haw, he, he_IL, hi, hr, hsb, hu, hy, id, id_ID, ig, is, it, ja, ka, kk, kl, km, kn, ko, kok, ku, ky, lb, lkt, ln, lo, lt, lv, mk, ml, mn, mr, ms, mt, my, nb, nb_NO, ne, nl, nn, om, or, pa, pa, pa_IN, pl, ps, pt, ro, ru, se, si, sk, sl, smn, sq, sr, sr, sr_BA, sr_ME, sr_RS, sr, sr_BA, sr_RS, sv, sw, ta, te, th, tk, to, tr, ug, uk, ur, uz, vi, wae, wo, xh, yi, yo, zh, zh, zh_CN, zh_SG, zh, zh_HK, zh_MO, zh_TW, zu]</pre> <p>These collations can then be used as the other collations would be used before. They can also be combined with the <code class="language-plaintext highlighter-rouge">NOCASE</code> collation. For example, to use the German collation rules you could use the following code snippet:</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE strings (s VARCHAR COLLATE DE);
INSERT INTO strings VALUES ('Gabel'), ('Göbel'), ('Goethe'), ('Goldmann'), ('Göthe'), ('Götz');
SELECT * FROM strings ORDER BY s;</pre> <pre class="language-text highlighter-rouge" data-language="text">"Gabel", "Göbel", "Goethe", "Goldmann", "Göthe", "Götz"</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/sql/expressions/collations.html" class="_attribution-link">https://duckdb.org/docs/sql/expressions/collations.html</a>
  </p>
</div>
