<h1 class="title">Constraints</h1>  <p>In SQL, constraints can be specified for tables. Constraints enforce certain properties over data that is inserted into a table. Constraints can be specified along with the schema of the table as part of the <a href="statements/create_table.html"><code class="language-plaintext highlighter-rouge">CREATE TABLE</code> statement</a>. In certain cases, constraints can also be added to a table using the <a href="statements/alter_table.html"><code class="language-plaintext highlighter-rouge">ALTER TABLE</code> statement</a>, but this is not currently supported for all constraints.</p> <blockquote> <p>Warning Constraints have a strong impact on performance: they slow down loading and updates but speed up certain queries. Please consult the <a href="../guides/performance/schema.html#constraints.html">Performance Guide</a> for details.</p> </blockquote> <h2 id="syntax"> <a style="text-decoration: none;" href="#syntax">Syntax</a> </h2>  <h2 id="check-constraint"> <a style="text-decoration: none;" href="#check-constraint">Check Constraint</a> </h2> <p>Check constraints allow you to specify an arbitrary Boolean expression. Any columns that <em>do not</em> satisfy this expression violate the constraint. For example, we could enforce that the <code class="language-plaintext highlighter-rouge">name</code> column does not contain spaces using the following <code class="language-plaintext highlighter-rouge">CHECK</code> constraint.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE students (name VARCHAR CHECK (NOT contains(name, ' ')));
INSERT INTO students VALUES ('this name contains spaces');</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: CHECK constraint failed: students</pre> <h2 id="not-null-constraint"> <a style="text-decoration: none;" href="#not-null-constraint">Not Null Constraint</a> </h2> <p>A not-null constraint specifies that the column cannot contain any <code class="language-plaintext highlighter-rouge">NULL</code> values. By default, all columns in tables are nullable. Adding <code class="language-plaintext highlighter-rouge">NOT NULL</code> to a column definition enforces that a column cannot contain <code class="language-plaintext highlighter-rouge">NULL</code> values.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE students (name VARCHAR NOT NULL);
INSERT INTO students VALUES (NULL);</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: NOT NULL constraint failed: students.name</pre> <h2 id="primary-key-and-unique-constraint"> <a style="text-decoration: none;" href="#primary-key-and-unique-constraint">Primary Key and Unique Constraint</a> </h2> <p>Primary key or unique constraints define a column, or set of columns, that are a unique identifier for a row in the table. The constraint enforces that the specified columns are <em>unique</em> within a table, i.e., that at most one row contains the given values for the set of columns.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE students (id INTEGER PRIMARY KEY, name VARCHAR);
INSERT INTO students VALUES (1, 'Student 1');
INSERT INTO students VALUES (1, 'Student 2');</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: Duplicate key "id: 1" violates primary key constraint</pre> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE students (id INTEGER, name VARCHAR, PRIMARY KEY (id, name));
INSERT INTO students VALUES (1, 'Student 1');
INSERT INTO students VALUES (1, 'Student 2');
INSERT INTO students VALUES (1, 'Student 1');</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: Duplicate key "id: 1, name: Student 1" violates primary key constraint</pre> <p>In order to enforce this property efficiently, an <a href="indexes.html">ART index is automatically created</a> for every primary key or unique constraint that is defined in the table.</p> <p>Primary key constraints and unique constraints are identical except for two points:</p> <ul> <li>A table can only have one primary key constraint defined, but many unique constraints</li> <li>A primary key constraint also enforces the keys to not be <code class="language-plaintext highlighter-rouge">NULL</code>.</li> </ul> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE students(id INTEGER PRIMARY KEY, name VARCHAR, email VARCHAR UNIQUE);
INSERT INTO students VALUES (1, 'Student 1', 'student1@uni.com');
INSERT INTO students values (2, 'Student 2', 'student1@uni.com');</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: Duplicate key "email: student1@uni.com" violates unique constraint.</pre> <pre class="language-sql highlighter-rouge" data-language="sql">INSERT INTO students(id, name) VALUES (3, 'Student 3');
INSERT INTO students(name, email) VALUES ('Student 3', 'student3@uni.com');</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: NOT NULL constraint failed: students.id</pre> <blockquote> <p>Warning Indexes have certain limitations that might result in constraints being evaluated too eagerly, leading to constraint errors such as <code class="language-plaintext highlighter-rouge">violates primary key constraint</code> and <code class="language-plaintext highlighter-rouge">violates unique constraint</code>. See the <a href="indexes.html#index-limitations.html">indexes section for more details</a>.</p> </blockquote> <h2 id="foreign-keys"> <a style="text-decoration: none;" href="#foreign-keys">Foreign Keys</a> </h2> <p>Foreign keys define a column, or set of columns, that refer to a primary key or unique constraint from <em>another</em> table. The constraint enforces that the key exists in the other table.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE students (id INTEGER PRIMARY KEY, name VARCHAR);
CREATE TABLE exams (exam_id INTEGER REFERENCES students(id), grade INTEGER);
INSERT INTO students VALUES (1, 'Student 1');
INSERT INTO exams VALUES (1, 10);
INSERT INTO exams VALUES (2, 10);</pre> <pre class="language-console highlighter-rouge" data-language="console">Constraint Error: Violates foreign key constraint because key "id: 2" does not exist in the referenced table</pre> <p>In order to enforce this property efficiently, an <a href="indexes.html">ART index is automatically created</a> for every foreign key constraint that is defined in the table.</p> <blockquote> <p>Warning Indexes have certain limitations that might result in constraints being evaluated too eagerly, leading to constraint errors such as <code class="language-plaintext highlighter-rouge">violates primary key constraint</code> and <code class="language-plaintext highlighter-rouge">violates unique constraint</code>. See the <a href="indexes.html#index-limitations.html">indexes section for more details</a>.</p> </blockquote><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/sql/constraints.html" class="_attribution-link">https://duckdb.org/docs/sql/constraints.html</a>
  </p>
</div>
