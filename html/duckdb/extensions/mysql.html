<h1 class="title">MySQL Extension</h1>  <p>The <a href="https://github.com/duckdb/duckdb_mysql"><code class="language-plaintext highlighter-rouge">mysql</code> extension</a> allows DuckDB to directly read and write data from/to a running MySQL instance. The data can be queried directly from the underlying MySQL database. Data can be loaded from MySQL tables into DuckDB tables, or vice versa.</p> <h2 id="installing-and-loading"> <a style="text-decoration: none;" href="#installing-and-loading">Installing and Loading</a> </h2> <p>To install the <code class="language-plaintext highlighter-rouge">mysql</code> extension, run:</p> <pre class="language-sql highlighter-rouge" data-language="sql">INSTALL mysql;</pre> <p>The extension is loaded automatically upon first use. If you prefer to load it manually, run:</p> <pre class="language-sql highlighter-rouge" data-language="sql">LOAD mysql;</pre> <h2 id="reading-data-from-mysql"> <a style="text-decoration: none;" href="#reading-data-from-mysql">Reading Data from MySQL</a> </h2> <p>To make a MySQL database accessible to DuckDB use the <code class="language-plaintext highlighter-rouge">ATTACH</code> command with the <code class="language-plaintext highlighter-rouge">MYSQL</code> or the <code class="language-plaintext highlighter-rouge">MYSQL_SCANNER</code> type:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH 'host=localhost user=root port=0 database=mysql' AS mysqldb (TYPE MYSQL);
USE mysqldb;</pre> <h3 id="configuration"> <a style="text-decoration: none;" href="#configuration">Configuration</a> </h3> <p>The connection string determines the parameters for how to connect to MySQL as a set of <code class="language-plaintext highlighter-rouge">key=value</code> pairs. Any options not provided are replaced by their default values, as per the table below. Connection information can also be specified with <a href="https://dev.mysql.com/doc/refman/8.3/en/environment-variables.html">environment variables</a>. If no option is provided explicitly, the MySQL extension tries to read it from an environment variable.</p>  <table> <thead> <tr> <th>Setting</th> <th>Default</th> <th>Environment variable</th> </tr> </thead> <tbody> <tr> <td>database</td> <td>NULL</td> <td>MYSQL_DATABASE</td> </tr> <tr> <td>host</td> <td>localhost</td> <td>MYSQL_HOST</td> </tr> <tr> <td>password</td> <td> </td> <td>MYSQL_PWD</td> </tr> <tr> <td>port</td> <td>0</td> <td>MYSQL_TCP_PORT</td> </tr> <tr> <td>socket</td> <td>NULL</td> <td>MYSQL_UNIX_PORT</td> </tr> <tr> <td>user</td> <td>⟨current user⟩</td> <td>MYSQL_USER</td> </tr> <tr> <td>ssl_mode</td> <td>preferred</td> <td> </td> </tr> <tr> <td>ssl_ca</td> <td> </td> <td> </td> </tr> <tr> <td>ssl_capath</td> <td> </td> <td> </td> </tr> <tr> <td>ssl_cert</td> <td> </td> <td> </td> </tr> <tr> <td>ssl_cipher</td> <td> </td> <td> </td> </tr> <tr> <td>ssl_crl</td> <td> </td> <td> </td> </tr> <tr> <td>ssl_crlpath</td> <td> </td> <td> </td> </tr> <tr> <td>ssl_key</td> <td> </td> <td> </td> </tr> </tbody> </table> <h3 id="configuring-via-secrets"> <a style="text-decoration: none;" href="#configuring-via-secrets">Configuring via Secrets</a> </h3> <p>MySQL connection information can also be specified with <a href="../configuration/secrets_manager.html">secrets</a>. The following syntax can be used to create a secret.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE SECRET (
    TYPE MYSQL,
    HOST '127.0.0.1',
    PORT 0,
    DATABASE mysql,
    USER 'mysql',
    PASSWORD ''
);</pre> <p>The information from the secret will be used when <code class="language-plaintext highlighter-rouge">ATTACH</code> is called. We can leave the connection string empty to use all of the information stored in the secret.</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH '' AS mysql_db (TYPE MYSQL);</pre> <p>We can use the connection string to override individual options. For example, to connect to a different database while still using the same credentials, we can override only the database name in the following manner.</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH 'database=my_other_db' AS mysql_db (TYPE MYSQL);</pre> <p>By default, created secrets are temporary. Secrets can be persisted using the <a href="../configuration/secrets_manager.html#persistent-secrets.html"><code class="language-plaintext highlighter-rouge">CREATE PERSISTENT SECRET</code> command</a>. Persistent secrets can be used across sessions.</p> <h4 id="managing-multiple-secrets"> <a style="text-decoration: none;" href="#managing-multiple-secrets">Managing Multiple Secrets</a> </h4> <p>Named secrets can be used to manage connections to multiple MySQL database instances. Secrets can be given a name upon creation.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE SECRET mysql_secret_one (
    TYPE MYSQL,
    HOST '127.0.0.1',
    PORT 0,
    DATABASE mysql,
    USER 'mysql',
    PASSWORD ''
);</pre> <p>The secret can then be explicitly referenced using the <code class="language-plaintext highlighter-rouge">SECRET</code> parameter in the <code class="language-plaintext highlighter-rouge">ATTACH</code>.</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH '' AS mysql_db_one (TYPE MYSQL, SECRET mysql_secret_one);</pre> <h3 id="ssl-connections"> <a style="text-decoration: none;" href="#ssl-connections">SSL Connections</a> </h3> <p>The <a href="https://dev.mysql.com/doc/refman/8.4/en/using-encrypted-connections.html"><code class="language-plaintext highlighter-rouge">ssl</code> connection parameters</a> can be used to make SSL connections. Below is a description of the supported parameters.</p> <table> <thead> <tr> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>ssl_mode</td> <td>The security state to use for the connection to the server: <code class="language-plaintext highlighter-rouge">disabled, required, verify_ca, verify_identity or preferred</code> (default: <code class="language-plaintext highlighter-rouge">preferred</code>)</td> </tr> <tr> <td>ssl_ca</td> <td>The path name of the Certificate Authority (CA) certificate file.</td> </tr> <tr> <td>ssl_capath</td> <td>The path name of the directory that contains trusted SSL CA certificate files.</td> </tr> <tr> <td>ssl_cert</td> <td>The path name of the client public key certificate file.</td> </tr> <tr> <td>ssl_cipher</td> <td>The list of permissible ciphers for SSL encryption.</td> </tr> <tr> <td>ssl_crl</td> <td>The path name of the file containing certificate revocation lists.</td> </tr> <tr> <td>ssl_crlpath</td> <td>The path name of the directory that contains files containing certificate revocation lists.</td> </tr> <tr> <td>ssl_key</td> <td>The path name of the client private key file.</td> </tr> </tbody> </table> <h3 id="reading-mysql-tables"> <a style="text-decoration: none;" href="#reading-mysql-tables">Reading MySQL Tables</a> </h3> <p>The tables in the MySQL database can be read as if they were normal DuckDB tables, but the underlying data is read directly from MySQL at query time.</p> <pre class="language-sql highlighter-rouge" data-language="sql">SHOW ALL TABLES;</pre>  <table> <thead> <tr> <th>name</th> </tr> </thead> <tbody> <tr> <td>signed_integers</td> </tr> </tbody> </table> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * FROM signed_integers;</pre>  <table> <thead> <tr> <th style="text-align: right">t</th> <th style="text-align: right">s</th> <th style="text-align: right">m</th> <th style="text-align: right">i</th> <th style="text-align: right">b</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">-128</td> <td style="text-align: right">-32768</td> <td style="text-align: right">-8388608</td> <td style="text-align: right">-2147483648</td> <td style="text-align: right">-9223372036854775808</td> </tr> <tr> <td style="text-align: right">127</td> <td style="text-align: right">32767</td> <td style="text-align: right">8388607</td> <td style="text-align: right">2147483647</td> <td style="text-align: right">9223372036854775807</td> </tr> <tr> <td style="text-align: right">NULL</td> <td style="text-align: right">NULL</td> <td style="text-align: right">NULL</td> <td style="text-align: right">NULL</td> <td style="text-align: right">NULL</td> </tr> </tbody> </table> <p>It might be desirable to create a copy of the MySQL databases in DuckDB to prevent the system from re-reading the tables from MySQL continuously, particularly for large tables.</p> <p>Data can be copied over from MySQL to DuckDB using standard SQL, for example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE duckdb_table AS FROM mysqlscanner.mysql_table;</pre> <h2 id="writing-data-to-mysql"> <a style="text-decoration: none;" href="#writing-data-to-mysql">Writing Data to MySQL</a> </h2> <p>In addition to reading data from MySQL, create tables, ingest data into MySQL and make other modifications to a MySQL database using standard SQL queries.</p> <p>This allows you to use DuckDB to, for example, export data that is stored in a MySQL database to Parquet, or read data from a Parquet file into MySQL.</p> <p>Below is a brief example of how to create a new table in MySQL and load data into it.</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH 'host=localhost user=root port=0 database=mysqlscanner' AS mysql_db (TYPE MYSQL);
CREATE TABLE mysql_db.tbl (id INTEGER, name VARCHAR);
INSERT INTO mysql_db.tbl VALUES (42, 'DuckDB');</pre> <p>Many operations on MySQL tables are supported. All these operations directly modify the MySQL database, and the result of subsequent operations can then be read using MySQL. Note that if modifications are not desired, <code class="language-plaintext highlighter-rouge">ATTACH</code> can be run with the <code class="language-plaintext highlighter-rouge">READ_ONLY</code> property which prevents making modifications to the underlying database. For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH 'host=localhost user=root port=0 database=mysqlscanner' AS mysql_db (TYPE MYSQL, READ_ONLY);</pre> <h2 id="supported-operations"> <a style="text-decoration: none;" href="#supported-operations">Supported Operations</a> </h2> <p>Below is a list of supported operations.</p> <h3 id="create-table"> <a style="text-decoration: none;" href="#create-table"><code class="language-plaintext highlighter-rouge">CREATE TABLE</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE mysql_db.tbl (id INTEGER, name VARCHAR);</pre> <h3 id="insert-into"> <a style="text-decoration: none;" href="#insert-into"><code class="language-plaintext highlighter-rouge">INSERT INTO</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">INSERT INTO mysql_db.tbl VALUES (42, 'DuckDB');</pre> <h3 id="select"> <a style="text-decoration: none;" href="#select"><code class="language-plaintext highlighter-rouge">SELECT</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">SELECT * FROM mysql_db.tbl;</pre> <table> <thead> <tr> <th style="text-align: right">id</th> <th>name</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">42</td> <td>DuckDB</td> </tr> </tbody> </table> <h3 id="copy"> <a style="text-decoration: none;" href="#copy"><code class="language-plaintext highlighter-rouge">COPY</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">COPY mysql_db.tbl TO 'data.parquet';
COPY mysql_db.tbl FROM 'data.parquet';</pre> <p>You may also create a full copy of the database using the <a href="../sql/statements/copy.html#copy-from-database--to.html"><code class="language-plaintext highlighter-rouge">COPY FROM DATABASE</code> statement</a>:</p> <pre class="language-sql highlighter-rouge" data-language="sql">COPY FROM DATABASE mysql_db TO my_duckdb_db;</pre> <h3 id="update"> <a style="text-decoration: none;" href="#update"><code class="language-plaintext highlighter-rouge">UPDATE</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">UPDATE mysql_db.tbl
SET name = 'Woohoo'
WHERE id = 42;</pre> <h3 id="delete"> <a style="text-decoration: none;" href="#delete"><code class="language-plaintext highlighter-rouge">DELETE</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">DELETE FROM mysql_db.tbl
WHERE id = 42;</pre> <h3 id="alter-table"> <a style="text-decoration: none;" href="#alter-table"><code class="language-plaintext highlighter-rouge">ALTER TABLE</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">ALTER TABLE mysql_db.tbl
ADD COLUMN k INTEGER;</pre> <h3 id="drop-table"> <a style="text-decoration: none;" href="#drop-table"><code class="language-plaintext highlighter-rouge">DROP TABLE</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">DROP TABLE mysql_db.tbl;</pre> <h3 id="create-view"> <a style="text-decoration: none;" href="#create-view"><code class="language-plaintext highlighter-rouge">CREATE VIEW</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE VIEW mysql_db.v1 AS SELECT 42;</pre> <h3 id="create-schema-and-drop-schema"> <a style="text-decoration: none;" href="#create-schema-and-drop-schema"><code class="language-plaintext highlighter-rouge">CREATE SCHEMA</code> and <code class="language-plaintext highlighter-rouge">DROP SCHEMA</code></a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE SCHEMA mysql_db.s1;
CREATE TABLE mysql_db.s1.integers (i INTEGER);
INSERT INTO mysql_db.s1.integers VALUES (42);
SELECT * FROM mysql_db.s1.integers;</pre> <table> <thead> <tr> <th style="text-align: right">i</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">42</td> </tr> </tbody> </table> <pre class="language-sql highlighter-rouge" data-language="sql">DROP SCHEMA mysql_db.s1;</pre> <h3 id="transactions"> <a style="text-decoration: none;" href="#transactions">Transactions</a> </h3> <pre class="language-sql highlighter-rouge" data-language="sql">CREATE TABLE mysql_db.tmp (i INTEGER);
BEGIN;
INSERT INTO mysql_db.tmp VALUES (42);
SELECT * FROM mysql_db.tmp;</pre> <p>This returns:</p> <table> <thead> <tr> <th style="text-align: right">i</th> </tr> </thead> <tbody> <tr> <td style="text-align: right">42</td> </tr> </tbody> </table> <pre class="language-sql highlighter-rouge" data-language="sql">ROLLBACK;
SELECT * FROM mysql_db.tmp;</pre> <p>This returns an empty table.</p> <blockquote> <p>The DDL statements are not transactional in MySQL.</p> </blockquote> <h2 id="running-sql-queries-in-mysql"> <a style="text-decoration: none;" href="#running-sql-queries-in-mysql">Running SQL Queries in MySQL</a> </h2> <h3 id="the-mysql_query-table-function"> <a style="text-decoration: none;" href="#the-mysql_query-table-function">The <code class="language-plaintext highlighter-rouge">mysql_query</code> Table Function</a> </h3> <p>The <code class="language-plaintext highlighter-rouge">mysql_query</code> table function allows you to run arbitrary read queries within an attached database. <code class="language-plaintext highlighter-rouge">mysql_query</code> takes the name of the attached MySQL database to execute the query in, as well as the SQL query to execute. The result of the query is returned. Single-quote strings are escaped by repeating the single quote twice.</p> <pre class="language-sql highlighter-rouge" data-language="sql">mysql_query(attached_database::VARCHAR, query::VARCHAR)</pre> <p>For example:</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH 'host=localhost database=mysql' AS mysqldb (TYPE MYSQL);
SELECT * FROM mysql_query('mysqldb', 'SELECT * FROM cars LIMIT 3');</pre> <h3 id="the-mysql_execute-function"> <a style="text-decoration: none;" href="#the-mysql_execute-function">The <code class="language-plaintext highlighter-rouge">mysql_execute</code> Function</a> </h3> <p>The <code class="language-plaintext highlighter-rouge">mysql_execute</code> function allows running arbitrary queries within MySQL, including statements that update the schema and content of the database.</p> <pre class="language-sql highlighter-rouge" data-language="sql">ATTACH 'host=localhost database=mysql' AS mysqldb (TYPE MYSQL);
CALL mysql_execute('mysqldb', 'CREATE TABLE my_table (i INTEGER)');</pre> <h2 id="settings"> <a style="text-decoration: none;" href="#settings">Settings</a> </h2> <table> <thead> <tr> <th>Name</th> <th>Description</th> <th>Default</th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">mysql_bit1_as_boolean</code></td> <td>Whether or not to convert <code class="language-plaintext highlighter-rouge">BIT(1)</code> columns to <code class="language-plaintext highlighter-rouge">BOOLEAN</code>
</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">mysql_debug_show_queries</code></td> <td>DEBUG SETTING: print all queries sent to MySQL to stdout</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">mysql_experimental_filter_pushdown</code></td> <td>Whether or not to use filter pushdown (currently experimental)</td> <td><code class="language-plaintext highlighter-rouge">false</code></td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">mysql_tinyint1_as_boolean</code></td> <td>Whether or not to convert <code class="language-plaintext highlighter-rouge">TINYINT(1)</code> columns to <code class="language-plaintext highlighter-rouge">BOOLEAN</code>
</td> <td><code class="language-plaintext highlighter-rouge">true</code></td> </tr> </tbody> </table> <h2 id="schema-cache"> <a style="text-decoration: none;" href="#schema-cache">Schema Cache</a> </h2> <p>To avoid having to continuously fetch schema data from MySQL, DuckDB keeps schema information – such as the names of tables, their columns, etc. – cached. If changes are made to the schema through a different connection to the MySQL instance, such as new columns being added to a table, the cached schema information might be outdated. In this case, the function <code class="language-plaintext highlighter-rouge">mysql_clear_cache</code> can be executed to clear the internal caches.</p> <pre class="language-sql highlighter-rouge" data-language="sql">CALL mysql_clear_cache();</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/extensions/mysql.html" class="_attribution-link">https://duckdb.org/docs/extensions/mysql.html</a>
  </p>
</div>
