<h1 class="title">Building Extensions</h1>  <p><a href="../../extensions/overview.html">Extensions</a> can be built from source and installed from the resulting local binary.</p> <h2 id="building-extensions-using-build-flags"> <a style="text-decoration: none;" href="#building-extensions-using-build-flags">Building Extensions Using Build Flags</a> </h2> <p>To build using extension flags, set the <code class="language-plaintext highlighter-rouge">CORE_EXTENSIONS</code> flag to the list of extensions that you want to be buiold.</p> <p>Extension will in most cases by directly linked the resulting DuckDB executable.</p> <p>For example, to build DuckDB with the <a href="../../extensions/httpfs/overview.html"><code class="language-plaintext highlighter-rouge">httpfs</code> extension</a>, run the following script:</p> <pre class="language-bash highlighter-rouge" data-language="bash">GEN=ninja CORE_EXTENSIONS='httpfs' make</pre> <h3 id="special-extension-flags"> <a style="text-decoration: none;" href="#special-extension-flags">Special Extension Flags</a> </h3> <h4 id="build_jemalloc"> <a style="text-decoration: none;" href="#build_jemalloc"><code class="language-plaintext highlighter-rouge">BUILD_JEMALLOC</code></a> </h4> <p>When this flag is set, the <a href="../../extensions/jemalloc.html"><code class="language-plaintext highlighter-rouge">jemalloc</code> extension</a> is built.</p> <h4 id="build_tpce"> <a style="text-decoration: none;" href="#build_tpce"><code class="language-plaintext highlighter-rouge">BUILD_TPCE</code></a> </h4> <p>When this flag is set, the <a href="https://www.tpc.org/tpce/">TPCE</a> libray is built. Unlike TPC-H and TPC-DS this is not a proper extension and it's not distributed as such. Enablign this allows TPC-E enabled queries through our test suite.</p> <h3 id="debug-flags"> <a style="text-decoration: none;" href="#debug-flags">Debug Flags</a> </h3> <h4 id="crash_on_assert"> <a style="text-decoration: none;" href="#crash_on_assert"><code class="language-plaintext highlighter-rouge">CRASH_ON_ASSERT</code></a> </h4> <p><code class="language-plaintext highlighter-rouge">D_ASSERT(condition)</code> is used all throughout the code, these will throw an InternalException in debug builds. With this flag enabled, when the assertion triggers it will instead directly cause a crash.</p> <h4 id="disable_string_inline"> <a style="text-decoration: none;" href="#disable_string_inline"><code class="language-plaintext highlighter-rouge">DISABLE_STRING_INLINE</code></a> </h4> <p>In our execution format <code class="language-plaintext highlighter-rouge">string_t</code> has the feature to “inline” strings that are under a certain length (12 bytes), this means they don't require a separate allocation. When this flag is set, we disable this and don't inline small strings.</p> <h4 id="disable_memory_safety"> <a style="text-decoration: none;" href="#disable_memory_safety"><code class="language-plaintext highlighter-rouge">DISABLE_MEMORY_SAFETY</code></a> </h4> <p>Our data structures that are used extensively throughout the non-performance-critical code have extra checks to ensure memory safety, these checks include:</p> <ul> <li>Making sure <code class="language-plaintext highlighter-rouge">nullptr</code> is never dereferenced.</li> <li>Making sure index out of bounds accesses don't trigger a crash.</li> </ul> <p>With this flag enabled we remove these checks, this is mostly done to check that the performance hit of these checks is negligible.</p> <h4 id="destroy_unpinned_blocks"> <a style="text-decoration: none;" href="#destroy_unpinned_blocks"><code class="language-plaintext highlighter-rouge">DESTROY_UNPINNED_BLOCKS</code></a> </h4> <p>When previously pinned blocks in the BufferManager are unpinned, with this flag enabled we destroy them instantly to make sure that there aren't situations where this memory is still being used, despite not being pinned.</p> <h4 id="debug_stacktrace"> <a style="text-decoration: none;" href="#debug_stacktrace"><code class="language-plaintext highlighter-rouge">DEBUG_STACKTRACE</code></a> </h4> <p>When a crash or assertion hit occurs in a test, print a stack trace. This is useful when debugging a crash that is hard to pinpoint with a debugger attached.</p> <h2 id="using-a-cmake-configuration-file"> <a style="text-decoration: none;" href="#using-a-cmake-configuration-file">Using a CMake Configuration File</a> </h2> <p>To build using a CMake configuration file, create an extension configuration file named <code class="language-plaintext highlighter-rouge">extension_config.cmake</code> with e.g., the following content:</p> <pre class="language-cmake highlighter-rouge" data-language="cmake">duckdb_extension_load(autocomplete)
duckdb_extension_load(fts)
duckdb_extension_load(inet)
duckdb_extension_load(icu)
duckdb_extension_load(json)
duckdb_extension_load(parquet)</pre> <p>Build DuckDB as follows:</p> <pre class="language-bash highlighter-rouge" data-language="bash">GEN=ninja EXTENSION_CONFIGS="extension_config.cmake" make</pre> <p>Then, to install the extensions in one go, run:</p> <pre class="language-bash highlighter-rouge" data-language="bash"># for release builds
cd build/release/extension/
# for debug builds
cd build/debug/extension/
# install extensions
for EXTENSION in *; do
    ../duckdb -c "INSTALL '${EXTENSION}/${EXTENSION}.duckdb_extension';"
done</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/dev/building/building_extensions.html" class="_attribution-link">https://duckdb.org/docs/dev/building/building_extensions.html</a>
  </p>
</div>
