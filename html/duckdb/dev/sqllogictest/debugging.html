<h1 class="title">Debugging</h1>  <p>The purpose of the tests is to figure out when things break. Inevitably changes made to the system will cause one of the tests to fail, and when that happens the test needs to be debugged.</p> <p>First, it is always recommended to run in debug mode. This can be done by compiling the system using the command <code class="language-plaintext highlighter-rouge">make debug</code>. Second, it is recommended to only run the test that breaks. This can be done by passing the filename of the breaking test to the test suite as a command line parameter (e.g., <code class="language-plaintext highlighter-rouge">build/debug/test/unittest test/sql/projection/test_simple_projection.test</code>). For more options on running a subset of the tests see the <a href="#triggering-which-tests-to-run">Triggering which tests to run</a> section.</p> <p>After that, a debugger can be attached to the program and the test can be debugged. In the sqllogictests it is normally difficult to break on a specific query, however, we have expanded the test suite so that a function called <code class="language-plaintext highlighter-rouge">query_break</code> is called with the line number <code class="language-plaintext highlighter-rouge">line</code> as parameter for every query that is run. This allows you to put a conditional breakpoint on a specific query. For example, if we want to break on line number 43 of the test file we can create the following break point:</p> <pre class="language-text highlighter-rouge" data-language="text">gdb: break query_break if line==43
lldb: break s -n query_break -c line==43</pre> <p>You can also skip certain queries from executing by placing <code class="language-plaintext highlighter-rouge">mode skip</code> in the file, followed by an optional <code class="language-plaintext highlighter-rouge">mode unskip</code>. Any queries between the two statements will not be executed.</p> <h2 id="triggering-which-tests-to-run"> <a style="text-decoration: none;" href="#triggering-which-tests-to-run">Triggering Which Tests to Run</a> </h2> <p>When running the unittest program, by default all the fast tests are run. A specific test can be run by adding the name of the test as an argument. For the sqllogictests, this is the relative path to the test file. To run only a single test:</p> <pre class="language-bash highlighter-rouge" data-language="bash">build/debug/test/unittest test/sql/projection/test_simple_projection.test</pre> <p>All tests in a given directory can be executed by providing the directory as a parameter with square brackets. To run all tests in the “projection” directory:</p> <pre class="language-bash highlighter-rouge" data-language="bash">build/debug/test/unittest "[projection]"</pre> <p>All tests, including the slow tests, can be run by running the tests with an asterisk. To run all tests, including the slow tests:</p> <pre class="language-bash highlighter-rouge" data-language="bash">build/debug/test/unittest "*"</pre> <p>We can run a subset of the tests using the <code class="language-plaintext highlighter-rouge">--start-offset</code> and <code class="language-plaintext highlighter-rouge">--end-offset</code> parameters. To run the tests 200..250:</p> <pre class="language-bash highlighter-rouge" data-language="bash">build/debug/test/unittest --start-offset=200 --end-offset=250</pre> <p>These are also available in percentages. To run tests 10% - 20%:</p> <pre class="language-bash highlighter-rouge" data-language="bash">build/debug/test/unittest --start-offset-percentage=10 --end-offset-percentage=20</pre> <p>The set of tests to run can also be loaded from a file containing one test name per line, and loaded using the <code class="language-plaintext highlighter-rouge">-f</code> command.</p> <pre class="language-bash highlighter-rouge" data-language="bash">cat test.list</pre> <pre class="language-text highlighter-rouge" data-language="text">test/sql/join/full_outer/test_full_outer_join_issue_4252.test
test/sql/join/full_outer/full_outer_join_cache.test
test/sql/join/full_outer/test_full_outer_join.test</pre> <p>To run only the tests labeled in the file:</p> <pre class="language-bash highlighter-rouge" data-language="bash">build/debug/test/unittest -f test.list</pre><div class="_attribution">
  <p class="_attribution-p">
    &copy; Copyright 2018&ndash;2024 Stichting DuckDB Foundation<br>Licensed under the MIT License.<br>
    <a href="https://duckdb.org/docs/dev/sqllogictest/debugging.html" class="_attribution-link">https://duckdb.org/docs/dev/sqllogictest/debugging.html</a>
  </p>
</div>
