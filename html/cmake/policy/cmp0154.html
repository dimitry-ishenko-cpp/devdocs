<h1 id="policy:CMP0154">CMP0154</h1> <div class="versionadded"> <p><span class="versionmodified added">Added in version 3.28.</span></p> </div> <p>Generated files are private by default in targets using <a class="reference internal" href="../command/target_sources.html#file-sets"><span class="std std-ref">File Sets</span></a>.</p> <p>CMake 3.27 and below assume that any file generated as an output or byproduct of <a class="reference internal" href="../command/add_custom_command.html#command:add_custom_command" title="add_custom_command" id="index-0-command:add_custom_command"><code>add_custom_command()</code></a> or <a class="reference internal" href="../command/add_custom_target.html#command:add_custom_target" title="add_custom_target" id="index-0-command:add_custom_target"><code>add_custom_target()</code></a> may be a public header file meant for inclusion by dependents' source files. This requires <a class="reference internal" href="../manual/cmake-generators.7.html#ninja-generators"><span class="std std-ref">Ninja Generators</span></a> to add conservative order-only dependencies that prevent a target's source files from compiling before custom commands from the target's dependencies are finished, even if those custom commands only produce sources private to their own target.</p> <p><a class="reference internal" href="../command/target_sources.html#file-sets"><span class="std std-ref">File Sets</span></a>, introduced by CMake 3.23, provide a way to express the visibility of generated header files. CMake 3.28 and above prefer to assume that, in targets using file sets, generated files are private to their own target by default. Generated public headers must be specified as members of a <code>PUBLIC</code> (or <code>INTERFACE</code>) <code>FILE_SET</code>, typically of type <code>HEADERS</code>. With this information, <a class="reference internal" href="../manual/cmake-generators.7.html#ninja-generators"><span class="std std-ref">Ninja Generators</span></a> may omit the above-mentioned conservative dependencies and produce more efficient build graphs.</p> <p>Additionally, if the custom command's output is a member of a file set of type <code>CXX_MODULES</code>, it will additionally not be required to exist before compiling other sources in the same target. Since these files should not be included at compile time directly, they may not be implicitly required to exist for other compilation rules.</p> <p>This policy provides compatibility for projects using file sets in targets with generated header files that have not been updated. Such projects should be updated to express generated public headers in a file set. For example:</p> <pre data-language="cmake">add_custom_command(
  OUTPUT ${CMAKE_CURRENT_BINARY_DIR}/foo.h
  ...
)
target_sources(foo
  PUBLIC FILE_SET HEADERS
    BASE_DIRS ${CMAKE_CURRENT_BINARY_DIR}
    FILES     ${CMAKE_CURRENT_BINARY_DIR}/foo.h
)
</pre> <p>The <code>OLD</code> behavior for this policy is to assume generated files are public, even in targets using file sets, and for <a class="reference internal" href="../manual/cmake-generators.7.html#ninja-generators"><span class="std std-ref">Ninja Generators</span></a> to produce conservative build graphs. The <code>NEW</code> behavior for this policy is to assume generated files are private in targets using file sets, and for <a class="reference internal" href="../manual/cmake-generators.7.html#ninja-generators"><span class="std std-ref">Ninja Generators</span></a> to produce more efficient build graphs.</p> <p>This policy was introduced in CMake version 3.28. It may be set by <a class="reference internal" href="../command/cmake_policy.html#command:cmake_policy" title="cmake_policy" id="index-0-command:cmake_policy"><code>cmake_policy()</code></a> or <a class="reference internal" href="../command/cmake_minimum_required.html#command:cmake_minimum_required" title="cmake_minimum_required" id="index-0-command:cmake_minimum_required"><code>cmake_minimum_required()</code></a>. If it is not set, CMake does <em>not</em> warn, and uses <code>OLD</code> behavior.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The <code>OLD</code> behavior of a policy is <a class="reference internal" href="../manual/cmake-policies.7.html#manual:cmake-policies(7)" title="cmake-policies(7)" id="index-0-manual:cmake-policies(7)"><code>deprecated by definition</code></a> and may be removed in a future version of CMake.</p> </div>  <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2000&ndash;2024 Kitware, Inc. and Contributors<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://cmake.org/cmake/help/latest/policy/CMP0154.html" class="_attribution-link">https://cmake.org/cmake/help/latest/policy/CMP0154.html</a>
  </p>
</div>
