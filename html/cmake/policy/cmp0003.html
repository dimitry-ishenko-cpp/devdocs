<h1 id="policy:CMP0003">CMP0003</h1> <p>Libraries linked via full path no longer produce linker search paths.</p> <p>This policy affects how libraries whose full paths are NOT known are found at link time, but was created due to a change in how CMake deals with libraries whose full paths are known. Consider the code</p> <pre data-language="none">target_link_libraries(myexe /path/to/libA.so)
</pre> <p>CMake 2.4 and below implemented linking to libraries whose full paths are known by splitting them on the link line into separate components consisting of the linker search path and the library name. The example code might have produced something like</p> <pre data-language="none">... -L/path/to -lA ...
</pre> <p>in order to link to library A. An analysis was performed to order multiple link directories such that the linker would find library A in the desired location, but there are cases in which this does not work. CMake versions 2.6 and above use the more reliable approach of passing the full path to libraries directly to the linker in most cases. The example code now produces something like</p> <pre data-language="none">... /path/to/libA.so ....
</pre> <p>Unfortunately this change can break code like</p> <pre data-language="none">target_link_libraries(myexe /path/to/libA.so B)
</pre> <p>where <code>B</code> is meant to find <code>/path/to/libB.so</code>. This code is wrong because the user is asking the linker to find library B but has not provided a linker search path (which may be added with the link_directories command). However, with the old linking implementation the code would work accidentally because the linker search path added for library A allowed library B to be found.</p> <p>In order to support projects depending on linker search paths added by linking to libraries with known full paths, the <code>OLD</code> behavior for this policy will add the linker search paths even though they are not needed for their own libraries. When this policy is set to <code>OLD</code>, CMake will produce a link line such as</p> <pre data-language="none">... -L/path/to /path/to/libA.so -lB ...
</pre> <p>which will allow library B to be found as it was previously. When this policy is set to NEW, CMake will produce a link line such as</p> <pre data-language="none">... /path/to/libA.so -lB ...
</pre> <p>which more accurately matches what the project specified.</p> <p>The setting for this policy used when generating the link line is that in effect when the target is created by an add_executable or add_library command. For the example described above, the code</p> <pre data-language="none">cmake_policy(SET CMP0003 OLD) # or cmake_policy(VERSION 2.4)
add_executable(myexe myexe.c)
target_link_libraries(myexe /path/to/libA.so B)
</pre> <p>will work and suppress the warning for this policy. It may also be updated to work with the corrected linking approach:</p> <pre data-language="none">cmake_policy(SET CMP0003 NEW) # or cmake_policy(VERSION 2.6)
link_directories(/path/to) # needed to find library B
add_executable(myexe myexe.c)
target_link_libraries(myexe /path/to/libA.so B)
</pre> <p>Even better, library B may be specified with a full path:</p> <pre data-language="none">add_executable(myexe myexe.c)
target_link_libraries(myexe /path/to/libA.so /path/to/libB.so)
</pre> <p>When all items on the link line have known paths CMake does not check this policy so it has no effect.</p> <p>Note that the warning for this policy will be issued for at most one target. This avoids flooding users with messages for every target when setting the policy once will probably fix all targets.</p> <p>This policy was introduced in CMake version 2.6.0. It may be set by <a class="reference internal" href="../command/cmake_policy.html#command:cmake_policy" title="cmake_policy" id="index-0-command:cmake_policy"><code>cmake_policy()</code></a> or <a class="reference internal" href="../command/cmake_minimum_required.html#command:cmake_minimum_required" title="cmake_minimum_required" id="index-0-command:cmake_minimum_required"><code>cmake_minimum_required()</code></a>. If it is not set, CMake warns, and uses <code>OLD</code> behavior.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The <code>OLD</code> behavior of a policy is <a class="reference internal" href="../manual/cmake-policies.7.html#manual:cmake-policies(7)" title="cmake-policies(7)" id="index-0-manual:cmake-policies(7)"><code>deprecated by definition</code></a> and may be removed in a future version of CMake.</p> </div>  <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2000&ndash;2024 Kitware, Inc. and Contributors<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://cmake.org/cmake/help/latest/policy/CMP0003.html" class="_attribution-link">https://cmake.org/cmake/help/latest/policy/CMP0003.html</a>
  </p>
</div>
