<h1 id="policy:CMP0157">CMP0157</h1> <div class="versionadded"> <p><span class="versionmodified added">Added in version 3.29.</span></p> </div> <p>Swift compilation mode is selected by an abstraction.</p> <p>The Swift compiler can compile modules in different modes. The desired build mode depends whether the developer is iterating and wants to incrementally make changes, or if they are building a release for distribution and want more optimizations applied to the resulting binary.</p> <p>CMake versions 3.26 through 3.28 build Swift binaries with whole-module optimizations enabled when configured in a non-debug build type. For CMake versions earlier than 3.26, the developer needs to specify the necessary flag manually for the <a class="reference internal" href="../manual/cmake-generators.7.html#ninja-generators"><span class="std std-ref">Ninja Generators</span></a>, and cannot not specify whole-module optimizations to the <a class="reference internal" href="https://cmake.org/cmake/help/latest/generator/Xcode.html#generator:Xcode" title="Xcode" id="index-0-generator:Xcode"><code>Xcode</code></a> generator.</p> <p>CMake versions 3.29 and above prefer to set the compilation mode using the <a class="reference internal" href="../prop_tgt/swift_compilation_mode.html#prop_tgt:Swift_COMPILATION_MODE" title="Swift_COMPILATION_MODE" id="index-0-prop_tgt:Swift_COMPILATION_MODE"><code>Swift_COMPILATION_MODE</code></a> target property, which can be initialized by the <a class="reference internal" href="../variable/cmake_swift_compilation_mode.html#variable:CMAKE_Swift_COMPILATION_MODE" title="CMAKE_Swift_COMPILATION_MODE" id="index-0-variable:CMAKE_Swift_COMPILATION_MODE"><code>CMAKE_Swift_COMPILATION_MODE</code></a> variable.</p> <p>This policy provides compatibility for projects that have not been updated. The policy setting takes effect as of the first <a class="reference internal" href="../command/project.html#command:project" title="project" id="index-0-command:project"><code>project()</code></a> or <a class="reference internal" href="../command/enable_language.html#command:enable_language" title="enable_language" id="index-0-command:enable_language"><code>enable_language()</code></a> command that enables the <code>Swift</code> language.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Once the policy has taken effect at the top of a project, that choice must be used throughout the tree. In projects that have nested projects in subdirectories, be sure to convert everything together.</p> </div> <p>The <code>OLD</code> behavior for this policy builds all Swift targets in <code>wholemodule</code> mode for non-debug configurations. <a class="reference internal" href="../manual/cmake-generators.7.html#ninja-generators"><span class="std std-ref">Ninja Generators</span></a> prepend the <code>-wmo</code> flag to the default set of Swift flags. The <a class="reference internal" href="https://cmake.org/cmake/help/latest/generator/Xcode.html#generator:Xcode" title="Xcode" id="index-1-generator:Xcode"><code>Xcode</code></a> generator sets the <code>SWIFT_COMPILATION_MODE</code> attribute to <code>wholemodule</code> in the generated Xcode project file.</p> <p>The <code>NEW</code> behavior for this policy is to apply the compilation mode specified in the <a class="reference internal" href="../prop_tgt/swift_compilation_mode.html#prop_tgt:Swift_COMPILATION_MODE" title="Swift_COMPILATION_MODE" id="index-1-prop_tgt:Swift_COMPILATION_MODE"><code>Swift_COMPILATION_MODE</code></a> target property, initialized as each target is created by the <a class="reference internal" href="../variable/cmake_swift_compilation_mode.html#variable:CMAKE_Swift_COMPILATION_MODE" title="CMAKE_Swift_COMPILATION_MODE" id="index-1-variable:CMAKE_Swift_COMPILATION_MODE"><code>CMAKE_Swift_COMPILATION_MODE</code></a> variable.</p> <p>This policy was introduced in CMake version 3.29. It may be set by <a class="reference internal" href="../command/cmake_policy.html#command:cmake_policy" title="cmake_policy" id="index-0-command:cmake_policy"><code>cmake_policy()</code></a> or <a class="reference internal" href="../command/cmake_minimum_required.html#command:cmake_minimum_required" title="cmake_minimum_required" id="index-0-command:cmake_minimum_required"><code>cmake_minimum_required()</code></a>. If it is not set, CMake does <em>not</em> warn, and uses <code>OLD</code> behavior.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The <code>OLD</code> behavior of a policy is <a class="reference internal" href="../manual/cmake-policies.7.html#manual:cmake-policies(7)" title="cmake-policies(7)" id="index-0-manual:cmake-policies(7)"><code>deprecated by definition</code></a> and may be removed in a future version of CMake.</p> </div>  <div class="_attribution">
  <p class="_attribution-p">
    &copy; 2000&ndash;2024 Kitware, Inc. and Contributors<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://cmake.org/cmake/help/latest/policy/CMP0157.html" class="_attribution-link">https://cmake.org/cmake/help/latest/policy/CMP0157.html</a>
  </p>
</div>
