<div id="col-content" data-swiftype-index="true"> <div id="chef-server-ctl-executable"><h1>chef-server-ctl (executable)</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-server/blob/main/docs-chef-io/content/server/ctl_chef_server.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>The Chef Infra Server includes a command-line utility named chef-server-ctl. This command-line tool is used to start and stop individual services, reconfigure the Chef Infra Server, run chef-pedant, and then tail Chef Infra Server log files.</p> <h2 id="backup--restore">Backup / Restore</h2> <p>Use the following commands to manage backups of Chef Infra Server data, and then to restore those backups.</p> <h3 id="backup">backup</h3> <p>The <code>backup</code> subcommand is used to back up all Chef Infra Server data. This subcommand:</p> <ul> <li>Requires rsync to be installed on the Chef Infra Server prior to running the command</li> <li>Requires a <code>chef-server-ctl reconfigure</code> prior to running the command</li> <li>Should not be run in a Chef Infra Server configuration with an external PostgreSQL database; <a href="https://github.com/chef/knife-ec-backup">use knife ec backup</a> instead</li> <li>Puts the initial backup in the <code>/var/opt/chef-backup</code> directory as a tar.gz file; move this backup to a new location for safe keeping</li> </ul> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-y</code>, <code>--yes</code>
</dt> <dd> <p>Use to specify if the Chef Infra Server can go offline during tar.gz-based backups.</p> </dd> <dt><code>--pg-options</code></dt> <dd> <p>Use to specify and pass additional options PostgreSQL during backups. See the <a href="https://www.postgresql.org/docs/13/runtime-config.html">PostgreSQL documentation</a> for more information.</p> </dd> <dt>
<code>-c</code>, <code>--config-only</code>
</dt> <dd> <p>Backup the Chef Infra Server configuration <strong>without</strong> backing up data.</p> </dd> <dt>
<code>-t</code>, <code>--timeout</code>
</dt> <dd> <p>Set the maximum amount of time in seconds to wait for shell commands (default 600). This option should be set to greater than 600 for backups taking longer than 10 minutes.</p> </dd> <dt>
<code>-h</code>, <code>--help</code>
</dt> <dd> <p>Show help message.</p> </dd> </dl> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl backup
</code></pre></div>
<h3 id="restore">restore</h3> <p>The <code>restore</code> subcommand is used to restore Chef Infra Server data from a backup that was created by the <code>backup</code> subcommand. This subcommand may also be used to add Chef Infra Server data to a newly-installed server. Do not run this command in a Chef Infra Server configuration that uses an external PostgreSQL database; <a href="https://github.com/chef/knife-ec-backup">use knife ec backup</a> instead. This subcommand:</p> <ul> <li>Requires rsync installed on the Chef Infra Server before running the command</li> <li>Requires a <code>chef-server-ctl reconfigure</code> before running the command</li> </ul> <p>Ideally, the restore server will have the same FQDN as the server that you backed up. If the restore server has a different FQDN, then:</p> <ol> <li>Replace the FQDN in the <code>/etc/opscode/chef-server.rb</code>.</li> <li>Replace the FQDN in the <code>/etc/opscode/chef-server-running.json</code>.</li> <li>Delete the old SSL certificate, key and <code>-ssl.conf</code> file from <code>/var/opt/opscode/nginx/ca</code>.</li> <li>If you use a CA-issued certificate instead of a self-signed certificate, copy the CA-issued certificate and key into <code>/var/opt/opscode/nginx/ca</code>.</li> <li>Update the <code>/etc/chef/client.rb</code> file on each client to point to the new server FQDN.</li> <li>Run <code>chef-server-ctl reconfigure</code>.</li> <li>Run ``chef-server-ctl restore`.</li> </ol> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-c</code>, <code>--cleanse</code>
</dt> <dd> <p>Use to remove all existing data on the Chef Infra Server; it will be replaced by the data in the backup archive.</p> </dd> <dt>
<code>-d DIRECTORY</code>, <code>--staging-dir DIRECTORY</code>
</dt> <dd> <p>Use to specify that the path to an empty directory to be used during the restore process. This directory must have enough disk space to expand all data in the backup archive.</p> </dd> </dl> <p><code>--pg-options</code></p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-suggestion" data-lang="suggestion">:   Use to specify and pass additional options PostgreSQL during backups. See the [PostgreSQL documentation](https://www.postgresql.org/docs/13/runtime-config.html) for more information.

`-t`, `--timeout`

:   Set the maximum amount of time in seconds to wait for shell commands. Set to greater than 600 for backups that take longer than 10 minutes. Default: 600.

`-h`, `--help`

:   Show help message.


**Syntax**

This subcommand has the following syntax:

```bash
chef-server-ctl restore PATH_TO_BACKUP (options)
</code></pre>
<p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl restore /path/to/tar/archive.tar.gz
</code></pre></div>
<h2 id="cleanse">cleanse</h2> <p>The <code>cleanse</code> subcommand is used to re-set the Chef Infra Server to the state it was in prior to the first time the <code>reconfigure</code> subcommand is run. This command will destroy all data, configuration files, and logs. The software that was put on-disk by the package installation will remain; re-run <code>chef-server-ctl reconfigure</code> to recreate the default data and configuration files.</p> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--with-external</code></dt> <dd> <p>Use to specify that Chef Infra Server data on an external PostgreSQL database should be removed.</p> </dd> </dl> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl cleanse
</code></pre></div>
<h2 id="gather-logs">gather-logs</h2> <p>The <code>gather-logs</code> subcommand is used to gather the Chef Infra Server log files into a tarball that contains all of the important log files and system information.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl gather-logs
</code></pre></div>
<h2 id="help">help</h2> <p>The <code>help</code> subcommand is used to print a list of all available chef-server-ctl commands.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl <span style="color:#007020">help</span>
</code></pre></div>
<h2 id="install">install</h2> <p>The <code>install</code> subcommand is used to install premium features of the Chef Infra Server: Chef management console and Chef Infra Client run reporting, high availability configurations, and Chef Infra Server replication.</p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> The <code>chef-server-ctl install</code> command no longer works in the 12.5 (and earlier) versions of the Chef Infra Server due to a change in how packages are downloaded from Chef. </div> </div> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl install name_of_addon <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p>where <code>name_of_addon</code> represents the command line value associated with the add-on or premium feature.</p> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--path PATH</code></dt> <dd> <p>Use to specify the location of a package. This option is not required when packages are downloaded from <a href="https://packages.chef.io/">https://packages.chef.io/</a>.</p> </dd> </dl> <h3 id="use-downloads">Use Downloads</h3> <p>The <code>install</code> subcommand downloads packages from <a href="https://packages.chef.io">https://packages.chef.io</a> by default. For systems that are not behind a firewall (and have connectivity to <a href="https://packages.chef.io">https://packages.chef.io</a>), these packages can be installed as described below.</p> <ol> <li> <p>Install add-ons</p> <p>Install Chef Manage with:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl install chef-manage
</code></pre></div>
</li> <li> <p>Reconfigure the server</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl reconfigure
</code></pre></div>
</li> <li> <p>Reconfigure add-ons</p> <p>Reconfigure Chef Manage with:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-manage-ctl reconfigure
</code></pre></div>
</li> </ol> <p>Finally, accept the <a href="chef_license/index.html">Chef License</a>:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-manage-ctl reconfigure --accept-license
</code></pre></div>
<h3 id="use-local-packages">Use Local Packages</h3> <p>Use the <code>install</code> subcommand with the <code>--path</code> option to install the Chef Manage (<code>chef-manage</code>) add-on for Chef Infra Server.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl install PACKAGE_NAME --path /path/to/package/directory
</code></pre></div>
<p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl install chef-manage --path /root/packages
</code></pre></div>
<p>The <code>chef-server-ctl</code> command will install the first <code>chef-manage</code> package found in the <code>/root/packages</code> directory.</p> <h2 id="key-rotation">Key Rotation</h2> <p>Use the following commands to manage public and private key rotation for users and clients.</p> <h3 id="add-client-key">add-client-key</h3> <p>Use the <code>add-client-key</code> subcommand to add a client key.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl add-client-key ORG_NAME CLIENT_NAME <span style="color:#666">[</span>--public-key-path PATH<span style="color:#666">]</span> <span style="color:#666">[</span>--expiration-date DATE<span style="color:#666">]</span> <span style="color:#666">[</span>--key-name NAME<span style="color:#666">]</span>
</code></pre></div>
<div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> All options for this subcommand must follow all arguments. </div> </div> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>CLIENT_NAME</code></dt> <dd> <p>The name of the client that you wish to add a key for.</p> </dd> <dt>
<code>-e DATE</code> <code>--expiration-date DATE</code>
</dt> <dd> <p>An ISO 8601 formatted string: <code>YYYY-MM-DDTHH:MM:SSZ</code>. For example: <code>2013-12-24T21:00:00Z</code>. If not passed, expiration will default to infinity.</p> </dd> <dt>
<code>-k NAME</code> <code>--key-name NAME</code>
</dt> <dd> <p>String defining the name of your new key for this client. If not passed, it will default to the fingerprint of the public key.</p> </dd> <dt><code>ORG_NAME</code></dt> <dd> <p>The short name for the organization to which the client belongs.</p> </dd> <dt>
<code>-p PATH</code> <code>--public-key-path PATH</code>
</dt> <dd> <p>The location to a file containing valid PKCS#1 public key to be added. If not passed, then the server will generate a new one for you and return the private key to STDOUT.</p> </dd> </dl> <h3 id="add-user-key">add-user-key</h3> <p>Use the <code>add-user-key</code> subcommand to add a user key.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl add-user-key USER_NAME <span style="color:#666">[</span>--public-key-path PATH<span style="color:#666">]</span> <span style="color:#666">[</span>--expiration-date DATE<span style="color:#666">]</span> <span style="color:#666">[</span>--key-name NAME<span style="color:#666">]</span>
</code></pre></div>
<div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> All options for this subcommand must follow all arguments. </div> </div> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-e DATE</code> <code>--expiration-date DATE</code>
</dt> <dd> <p>An ISO 8601 formatted string: <code>YYYY-MM-DDTHH:MM:SSZ</code>. For example: <code>2013-12-24T21:00:00Z</code>. If not passed, expiration will default to infinity.</p> </dd> <dt>
<code>-k NAME</code> <code>--key-name NAME</code>
</dt> <dd> <p>String defining the name of your new key for this user. If not passed, it will default to the fingerprint of the public key.</p> </dd> <dt>
<code>-p PATH</code> <code>--public-key-path PATH</code>
</dt> <dd> <p>The location to a file containing valid PKCS#1 public key to be added. If not passed, then the server will generate a new one for you and return the private key to STDOUT.</p> </dd> <dt><code>USER_NAME</code></dt> <dd> <p>The user name for the user for which a key is added.</p> </dd> </dl> <h3 id="delete-client-key">delete-client-key</h3> <p>Use the <code>delete-client-key</code> subcommand to delete a client key.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl delete-client-key ORG_NAME CLIENT_NAME KEY_NAME
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following arguments:</p> <dl> <dt><code>ORG_NAME</code></dt> <dd> <p>The short name for the organization to which the client belongs.</p> </dd> <dt><code>CLIENT_NAME</code></dt> <dd> <p>The name of the client.</p> </dd> <dt><code>KEY_NAME</code></dt> <dd> <p>The unique name to be assigned to the key you wish to delete.</p> </dd> </dl> <h3 id="delete-user-key">delete-user-key</h3> <p>Use the <code>delete-user-key</code> subcommand to delete a user key.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl delete-user-key USER_NAME KEY_NAME
</code></pre></div>
<div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> The parameters for this subcommand must be in the order specified above. </div> </div> <p><strong>Options</strong></p> <p>This subcommand has the following arguments:</p> <dl> <dt><code>USER_NAME</code></dt> <dd> <p>The user name.</p> </dd> <dt><code>KEY_NAME</code></dt> <dd> <p>The unique name to be assigned to the key you wish to delete.</p> </dd> </dl> <h3 id="list-client-keys">list-client-keys</h3> <p>Use the <code>list-client-keys</code> subcommand to list client keys.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl list-client-keys ORG_NAME CLIENT_NAME <span style="color:#666">[</span>--verbose<span style="color:#666">]</span>
</code></pre></div>
<div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> All options for this subcommand must follow all arguments. </div> </div> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>CLIENT_NAME</code></dt> <dd> <p>The name of the client.</p> </dd> <dt><code>ORG_NAME</code></dt> <dd> <p>The short name for the organization to which the client belongs.</p> </dd> <dt><code>--verbose</code></dt> <dd> <p>Use to show the full public key strings in command output.</p> </dd> </dl> <h3 id="list-user-keys">list-user-keys</h3> <p>Use the <code>list-user-keys</code> subcommand to list client keys.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl list-user-keys USER_NAME <span style="color:#666">[</span>--verbose<span style="color:#666">]</span>
</code></pre></div>
<div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> All options for this subcommand must follow all arguments. </div> </div> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>USER_NAME</code></dt> <dd> <p>The user name you wish to list keys for.</p> </dd> <dt><code>--verbose</code></dt> <dd> <p>Use to show the full public key strings in command output.</p> </dd> </dl> <p><strong>Example</strong></p> <p>To view a list of user keys (including public key output):</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl list-user-keys applejack --verbose
</code></pre></div>
<p>Returns:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash"><span style="color:#40a070">2</span> total key<span style="color:#666">(</span>s<span style="color:#666">)</span> found <span style="color:#007020;font-weight:700">for</span> user applejack

key_name: test-key
expires_at: Infinity
public_key:
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4q9Dh+bwJSjhU/VI4Y8s
9WsbIPfpmBpoZoZVPL7V6JDfIaPUkdcSdZpynhRLhQwv9ScTFh65JwxC7wNhVspB
4bKZeW6vugNGwCyBIemMfxMlpKZQDOc5dnBiRMMOgXSIimeiFtL+NmMXnGBBHDaE
b+XXI8oCZRx5MTnzEs90mkaCRSIUlWxOUFzZvnv4jBrhWsd/yBM/h7YmVfmwVAjL
VST0QG4MnbCjNtbzToMj55NAGwSdKHCzvvpWYkd62ZOquY9f2UZKxYCX0bFPNVQM
EvBQGdNG39XYSEeF4LneYQKPHEZDdqe7TZdVE8ooU/syxlZgADtvkqEoc4zp1Im3
2wIDAQAB
-----END PUBLIC KEY-----

key_name: default
expires_at: Infinity
public_key:
-----BEGIN PUBLIC KEY-----
MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA4q9Dh+bwJSjhU/VI4Y8s
9WsbIPfpmBpoZoZVPL7V6JDfIaPUkdcSdZpynhRLhQwv9ScTFh65JwxC7wNhVspB
4bKZeW6vugNGwCyBIemMfxMlpKZQDOc5dnBiRMMOgXSIimeiFtL+NmMXnGBBHDaE
b+XXI8oCZRx5MTnzEs90mkaCRSIUlWxOUFzZvnv4jBrhWsd/yBM/h7YmVfmwVAjL
VST0QG4MnbCjNtbzToMj55NAGwSdKHCzvvpWYkd62ZOquY9f2UZKxYCX0bFPNVQM
EvBQGdNG39XYSEeF4LneYQKPHEZDdqe7TZdVE8ooU/syxlZgADtvkqEoc4zp1Im3
2wIDAQAB
-----END PUBLIC KEY-----
</code></pre></div>
<h2 id="secrets-management">Secrets Management</h2> <p>Use the following commands to manage and rotate shared secrets and service credentials. The secrets file used for storing these is located at <code>/etc/opscode/private-chef-secrets.json</code> on your Chef Infra Server. It should be owned and readable only by <code>root</code>.</p> <h3 id="set-secret">set-secret</h3> <p>The <code>set-secret</code> subcommand allows storing shared secrets and service credentials. Only secrets known to Chef Infra Server can be stored.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl set-secret GROUP NAME
</code></pre></div>
<p>There are various ways to pass the secret to this command:</p> <ol> <li> <p>as a third argument:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl set-secret ldap bind_password secretpassword
</code></pre></div>
</li> <li> <p>via an environment variable:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash"><span style="color:#007020">export</span> LDAP.BIND_PASSWORD<span style="color:#666">=</span><span style="color:#4070a0">"secretpassword"</span>
chef-server-ctl set-secret ldap bind_password
</code></pre></div>
</li> <li> <p>via an interactive prompt:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl set-secret ldap bind_password
Enter ldap bind_password:    <span style="color:#666">(</span>no terminal output<span style="color:#666">)</span>
Re-enter ldap bind_password: <span style="color:#666">(</span>no terminal output<span style="color:#666">)</span>
</code></pre></div>
</li> </ol> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--with-restart</code></dt> <dd> <p>If any services depend on the secret being changed, attempt to restart them after changing the secret. Added in Chef Infra Server 12.16.2.</p> </dd> </dl> <h3 id="remove-secret">remove-secret</h3> <p>The <code>remove-secret</code> subcommand allows removing a stored shared secret and service credential.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl remove-secret GROUP NAME
</code></pre></div>
<p><strong>Example</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl remove-secret ldap bind_password
</code></pre></div>
<h3 id="show-secret">show-secret</h3> <p>The <code>show-secret</code> subcommand allows viewing a stored shared secret and service credential.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl show-secret GROUP NAME
</code></pre></div>
<h3 id="set-db-superuser-password">set-db-superuser-password</h3> <p>The <code>set-db-superuser-password</code> subcommand allows storing the database superuser password.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl set-db-superuser-password
</code></pre></div>
<p>Similar to <code>set-secret</code>, the superuser password can also be provided via the environment variable <code>DB_PASSWORD</code>.</p> <h3 id="set-actions-password">set-actions-password</h3> <p>The <code>set-actions-password</code> subcommand allows storing the RabbitMQ Actions password.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl set-actions-password
</code></pre></div>
<p>Similar to <code>set-secret</code>, the action password can also be provided via the environment variable <code>ACTIONS_PASSWORD</code>.</p> <h3 id="oc-id-show-app">oc-id-show-app</h3> <p>The <code>oc-id-show-app</code> subcommand allows for retrieving the client ID and client secret for applications known to <strong>oc-id</strong>. Note that with <code>insecure_addon_compat</code> <a href="server/server_security/index.html#chef-infra-server-credentials-management">disabled</a>, this data will no longer be written to <code>/etc/opscode/oc-id-applications/APP.json</code>.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl oc-id-show-app APP
</code></pre></div>
<p><strong>Example</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl oc-id-show-app supermarket
<span style="color:#666">{</span>
  <span style="color:#4070a0">"name"</span>: <span style="color:#4070a0">"supermarket"</span>,
  <span style="color:#4070a0">"uid"</span>: <span style="color:#4070a0">"0bad0f2eb04e935718e081fb71asdfec3681c81acb9968a8e1e32451d08b"</span>,
  <span style="color:#4070a0">"secret"</span>: <span style="color:#4070a0">"17cf1141cc971a10ce307611beda7ffadstr4f1bc98d9f9ca76b9b127879"</span>,
  <span style="color:#4070a0">"redirect_uri"</span>: <span style="color:#4070a0">"https://supermarket.mycompany.com/auth/chef_oauth2/callback"</span>
<span style="color:#666">}</span>
</code></pre></div>
<h3 id="require-credential-rotation">require-credential-rotation</h3> <p>The <code>require-credential-rotation</code> subcommand takes the Chef Infra Server offline and requires a complete service credential rotation before the Chef Infra Server(s) in your cluster can restart again. Run <code>rotate-shared-secrets</code> to create a new shared secret, salt, and generate the new service credentials. Then copy the secrets file to each Chef Infra Server and run <code>sudo chef-server-ctl reconfigure</code> on each server to complete the rotation process.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Credential rotation does not rotate the pivotal, user, or client keys, or remove any Chef Infra Server policy or cookbooks that have been uploaded. </div> </div> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl require-credential-rotation <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>-y, --yes</code></dt> <dd> <p>Bypass a prompt in the terminal and agree that you want to disable the Chef Infra Server, and require credential rotation.</p> </dd> </dl> <h3 id="rotate-all-credentials">rotate-all-credentials</h3> <p>The <code>rotate-all-credentials</code> subcommand generates new credential values for all service credentials by incrementing the credential version number and creating a new hash value. You can choose whether to copy the updated secrets file to each node in the cluster and reconfiguring or by running this subcommand on all the nodes.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl rotate-all-credentials
</code></pre></div>
<h3 id="rotate-credentials">rotate-credentials</h3> <p>The <code>rotate-credentials</code> subcommand generates new credential values for all credentials for a given service by incrementing the value and creating a new hash value. You can choose whether to copy the updated secrets file to each node in the cluster and reconfiguring or by running this subcommand for that specific service on all the nodes.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl rotate-credentials SERVICE_NAME
</code></pre></div>
<h3 id="rotate-shared-secrets">rotate-shared-secrets</h3> <p>The <code>rotate-shared-secrets</code> subcommand creates a new shared secret and salt, in addition to generating new service credentials. It also resets the <code>credential_version</code> number for the services to 0. After you have run this subcommand, a new shared secret has been created, so you must copy the secrets file to each Chef Infra Server and run <code>sudo chef-server-ctl reconfigure</code> on them to complete the rotation process.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl rotate-shared-secrets
</code></pre></div>
<h3 id="show-service-credentials">show-service-credentials</h3> <p>The <code>show-service-credentials</code> subcommand shows all of the service credentials for services running on the local Chef Infra Server.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl show-service-credentials
</code></pre></div>
<h3 id="cleanup-bifrost">cleanup-bifrost</h3> <p>The <code>cleanup-bifrost</code> subcommand removes unused authorization objects from the authorization database (called bifrost). These unused objects can accumulate on long-running Chef Infra Servers as a result of failed object creation requests. For most users, the unused authorization objects do not substantially affect the performance of Chef Infra Server; however in certain situations it can be helpful to clean them up. This command is primarily intended for use by Chef support.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl cleanup-bifrost OPTIONS
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--estimate-only</code></dt> <dd> <p>Provides an estimate of the number of unused objects that will be deleted, without deleting anything.</p> </dd> <dt><code>--wait-time SECONDS</code></dt> <dd> <p>The number of seconds to wait for in-flight requests to complete. Only decrease this value if you are running the command when the Chef Infra Server is not taking requests.</p> </dd> <dt><code>--force-cleanup</code></dt> <dd> <p>Removes internal tracking tables used during the cleanup process. Manual cleanup of these tables is only required if the cleanup command is killed unexpectedly.</p> </dd> <dt><code>--batch-size</code></dt> <dd> <p>The number of orphaned authorization actors to delete at a time.</p> </dd> </dl> <h2 id="manage-organizations">Manage Organizations</h2> <p>Use the <code>org-create</code>, <code>org-delete</code>, <code>org-list</code>, <code>org-show</code>, <code>org-user-add</code> and <code>org-user-remove</code> commands to manage organizations.</p> <h3 id="org-create">org-create</h3> <p>The <code>org-create</code> subcommand is used to create an organization. (The validation key for the organization is returned to <code>STDOUT</code> when creating an organization with this command.)</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-create ORG_NAME <span style="color:#4070a0">"ORG_FULL_NAME"</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p>where:</p> <ul> <li>The name must begin with a lower-case letter or digit, may only contain lower-case letters, digits, hyphens, and underscores, and must be between 1 and 255 characters. For example: <code>chef</code>.</li> <li>The full name must begin with a non-white space character and must be between 1 and 1023 characters. For example: <code>"Chef Software, Inc."</code>.</li> </ul> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-a USER_NAME</code>, <code>--association_user USER_NAME</code>
</dt> <dd> <p>Associate a user with an organization and add them to the <code>admins</code> and <code>billing_admins</code> security groups.</p> </dd> <dt>
<code>-f FILE_NAME</code>, <code>--filename FILE_NAME</code>
</dt> <dd> <p>Write the ORGANIZATION-validator.pem to <code>FILE_NAME</code> instead of printing it to <code>STDOUT</code>.</p> </dd> </dl> <p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-create prod Production
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-create staging Staging -a chef-admin
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-create dev Development -f /tmp/id-dev.key
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-create dev Development --association_user grantmc
</code></pre></div>
<h3 id="org-delete">org-delete</h3> <p>The <code>org-delete</code> subcommand is used to delete an organization.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-delete ORG_NAME
</code></pre></div>
<p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-delete infra-testing-20140909
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-delete pedant-testing-org
</code></pre></div>
<h3 id="org-list">org-list</h3> <p>The <code>org-list</code> subcommand is used to list all of the organizations currently present on the Chef Infra Server.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-list <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all-orgs</code>
</dt> <dd> <p>Show all organizations.</p> </dd> <dt>
<code>-w</code>, <code>--with-uri</code>
</dt> <dd> <p>Show the corresponding URIs.</p> </dd> </dl> <h3 id="org-show">org-show</h3> <p>The <code>org-show</code> subcommand is used to show the details for an organization.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-show ORG_NAME
</code></pre></div>
<h3 id="org-user-add">org-user-add</h3> <p>The <code>org-user-add</code> subcommand is used to add a user to an organization.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-add ORG_NAME USER_NAME <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--admin</code></dt> <dd> <p>Add the user to the <code>admins</code> group.</p> </dd> </dl> <p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-add prod john_smith
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-add preprod testmaster
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-add dev grantmc --admin
</code></pre></div>
<h3 id="org-user-remove">org-user-remove</h3> <p>The <code>org-user-remove</code> subcommand is used to remove a user from an organization.</p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> <p>A user who belongs to the <code>admins</code> group must be removed from the group before they may be removed from an organization. To remove a user from the <code>admins</code> group, run the following:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash"><span style="color:#bb60d5">EDITOR</span><span style="color:#666">=</span>vi knife edit /groups/admins.json
</code></pre></div>
<p>make the required changes, and then save the file.</p> </div> </div> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-remove ORG_NAME USER_NAME <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--force</code></dt> <dd> <p>Force the removal of a user from the organization’s <code>admins</code> and <code>billing-admins</code> groups.</p> </dd> </dl> <p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-remove prod john_smith
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-remove prod testmaster
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl org-user-remove grantmc --force
</code></pre></div>
<h2 id="password">password</h2> <p>The <code>password</code> subcommand is used to change a user’s password. When Active Directory or LDAP is enabled, this command enables (or disables) the system recovery password for that user. For example:</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl password USERNAME
</code></pre></div>
<p>This subcommand has the following options:</p> <dl> <dt><code>--disable</code></dt> <dd> <p>Use this option to disable a user’s system recovery password.</p> </dd> </dl> <p><strong>Examples</strong></p> <p>For example, to change a user’s password, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl password adamjacobs
</code></pre></div>
<p>and then enter the password and confirm it:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">Enter the new password:  ******
Enter the new password again:  ******
</code></pre></div>
<p>to return:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">Password <span style="color:#007020;font-weight:700">for</span> adamjacobs successfully set.
</code></pre></div>
<p>To disable a system recovery password:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl password adamjacobs --disable
</code></pre></div>
<p>to return:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">Password <span style="color:#007020;font-weight:700">for</span> adamjacobs successfully disabled <span style="color:#007020;font-weight:700">for</span> System Recovery.
</code></pre></div>
<h2 id="psql">psql</h2> <p>The <code>psql</code> subcommand is used to log into the PostgreSQL database associated with the named service. This subcommand:</p> <ul> <li>Uses <code>psql</code> (the interactive terminal for PostgreSQL)</li> <li>Has read-only access by default</li> <li>Is the recommended way to interact with any PostgreSQL database that is part of the Chef Infra Server</li> <li>Automatically handles authentication</li> </ul> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl psql SERVICE_NAME <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt><code>--write</code></dt> <dd> <p>Use to enable write access to the PostgreSQL database.</p> </dd> </dl> <h2 id="reconfigure">reconfigure</h2> <p>The <code>reconfigure</code> subcommand is used when changes are made to the chef-server.rb file to reconfigure the server. When changes are made to the chef-server.rb file, they will not be applied to the Chef Infra Server configuration until after this command is run. This subcommand will also restart any services for which the <code>service_name['enabled']</code> setting is set to <code>true</code>.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl reconfigure
</code></pre></div>
<h2 id="reindex">reindex</h2> <p>The <code>reindex</code> subcommand is used to reload Chef Infra Server data from PostgreSQL to Elasticsearch.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl reindex
</code></pre></div>
<div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Chef Infra Server versions earlier than 14.5 configured with <code>nginx['enable_non_ssl'] = false</code> and <code>fips = true</code> require <code>export CSC_LB_URL=https://127.0.0.1</code> to run the command <code>chef-server-ctl reindex &lt;options&gt;</code> </div> </div> <p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all-orgs</code>
</dt> <dd> <p>Use to reindex all organizations on the Chef Infra Server. This option will override any organization specified as part of the command, i.e. <code>chef-server-ctl reindex ORG_NAME -a</code> will reindex all organizations and not just the specified organization.</p> </dd> <dt>
<code>-d</code>, <code>--disable-api</code>
</dt> <dd> <p>Use to disable the Chef Infra Server API to prevent writes during reindexing.</p> </dd> <dt>
<code>-t</code>, <code>--with-timing</code>
</dt> <dd> <p>Use to print timing information for the reindex processes.</p> </dd> <dt>
<code>-w</code>, <code>--wait</code>
</dt> <dd> <p>Use to wait for the reindexing queue to clear before exiting. This option only works when run on a standalone Chef Infra Server or on a primary backend Chef server within a legacy tier.</p> </dd> </dl> <h2 id="server-admins">Server Admins</h2> <p>The <code>server-admins</code> group is a global group that grants its members permission to create, read, update, and delete user accounts, with the exception of superuser accounts. The <code>server-admins</code> group is useful for users who are responsible for day-to-day administration of the Chef Infra Server, especially user management via the <code>knife user</code> subcommand. Before members can be added to the <code>server-admins</code> group, they must already have a user account on the Chef Infra Server.</p> <h3 id="scenario">Scenario</h3> <p>The following user accounts exist on the Chef Infra Server: <code>pivotal</code> (a superuser account), <code>alice</code>, <code>bob</code>, <code>carol</code>, and <code>dan</code>. Run the following command to view a list of users on the Chef Infra Server:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-list
</code></pre></div>
<p>and it returns the same list of users:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">pivotal
alice
bob
carol
dan
</code></pre></div>
<p>Alice is a member of the IT team whose responsibilities include day-to-day administration of the Chef Infra Server, in particular managing the user accounts on the Chef Infra Server that are used by the rest of the organization. From a workstation, Alice runs the following command:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife user list -c ~/.chef/alice.rb
</code></pre></div>
<p>and it returns the following error:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ERROR: You authenticated successfully to &lt;chef_server_url&gt; as alice
       but you are not authorized <span style="color:#007020;font-weight:700">for</span> this action
Response: Missing <span style="color:#007020">read</span> permission
</code></pre></div>
<p>Alice is not a superuser and does not have permissions on other users because user accounts are global to organizations in the Chef Infra Server. Let’s add Alice to the <code>server-admins</code> group:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl grant-server-admin-permissions alice
</code></pre></div>
<p>and it returns the following response:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">User alice was added to server-admins.
</code></pre></div>
<p>Alice can now create, read, update, and delete user accounts on the Chef Infra Server, even for organizations to which Alice is not a member. From a workstation, Alice re-runs the following command:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife user list -c ~/.chef/alice.rb
</code></pre></div>
<p>which now returns:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">pivotal
alice
bob
carol
dan
</code></pre></div>
<p>Alice is now a server administrator and can use the following knife subcommands to manage users on the Chef Infra Server:</p> <ul> <li><code>knife user-create</code></li> <li><code>knife user-delete</code></li> <li><code>knife user-edit</code></li> <li><code>knife user-list</code></li> <li><code>knife user-show</code></li> </ul> <p>For example, Alice runs the following command:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife user edit carol -c ~/.chef/alice.rb
</code></pre></div>
<p>and the $EDITOR opens in which Alice makes changes, and then saves them.</p> <h4 id="superuser-accounts">Superuser Accounts</h4> <p>Superuser accounts may not be managed by users who belong to the <code>server-admins</code> group. For example, Alice attempts to delete the <code>pivotal</code> superuser account:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife user delete pivotal -c ~/.chef/alice.rb
</code></pre></div>
<p>and the following error is returned:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ERROR: You authenticated successfully to &lt;chef_server_url&gt; as user1
       but you are not authorized <span style="color:#007020;font-weight:700">for</span> this action
Response: Missing <span style="color:#007020">read</span> permission
</code></pre></div>
<p>Alice’s action is unauthorized even with membership in the <code>server-admins</code> group.</p> <h3 id="manage-server-admins-group">Manage server-admins Group</h3> <p>Membership of the <code>server-admins</code> group is managed with a set of <code>chef-server-ctl</code> subcommands:</p> <ul> <li><code>chef-server-ctl grant-server-admin-permissions</code></li> <li><code>chef-server-ctl list-server-admins</code></li> <li><code>chef-server-ctl remove-server-admin-permissions</code></li> </ul> <h4 id="add-members">Add Members</h4> <p>The <code>grant-server-admin-permissions</code> subcommand is used to add a user to the <code>server-admins</code> group. Run the command once per user added.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl grant-server-admin-permissions USER_NAME
</code></pre></div>
<p>where <code>USER_NAME</code> is the user to add to the list of server administrators.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl grant-server-admin-permissions bob
</code></pre></div>
<p>returns:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">User bob was added to server-admins. This user can now list,
read, and create users <span style="color:#666">(</span>even <span style="color:#007020;font-weight:700">for</span> orgs they are not members of<span style="color:#666">)</span>
<span style="color:#007020;font-weight:700">for</span> this Chef Infra Server.
</code></pre></div>
<h4 id="remove-members">Remove Members</h4> <p>The <code>remove-server-admin-permissions</code> subcommand is used to remove a user from the <code>server-admins</code> group. Run the command once per user removed.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl remove-server-admin-permissions USER_NAME
</code></pre></div>
<p>where <code>USER_NAME</code> is the user to remove from the list of server administrators.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl remove-server-admin-permissions bob
</code></pre></div>
<p>returns:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">User bob was removed from server-admins. This user can no longer
list, read, and create users <span style="color:#007020;font-weight:700">for</span> this Chef Infra Server except <span style="color:#007020;font-weight:700">for</span> where
they have default permissions <span style="color:#666">(</span>such as within an org<span style="color:#666">)</span>.
</code></pre></div>
<h4 id="list-membership">List Membership</h4> <p>The <code>list-server-admins</code> subcommand is used to return a list of users who are members of the <code>server-admins</code> group.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl list-server-admins
</code></pre></div>
<p>and will return a list of users similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">pivotal
alice
bob
carol
dan
</code></pre></div>
<h2 id="show-config">show-config</h2> <p>The <code>show-config</code> subcommand is used to view the configuration that will be generated by the <code>reconfigure</code> subcommand. This command is most useful in the early stages of a deployment to ensure that everything is built properly prior to installation.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl show-config
</code></pre></div>
<h2 id="uninstall">uninstall</h2> <p>The <code>uninstall</code> subcommand is used to remove the Chef Infra Server application, but without removing any of the data. This subcommand will shut down all services (including the <code>runit</code> process supervisor).</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl uninstall
</code></pre></div>
<div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>To revert the <code>uninstall</code> subcommand, run the <code>reconfigure</code> subcommand (because the <code>start</code> subcommand is disabled by the <code>uninstall</code> command).</p> </div> </div> <h2 id="upgrade">upgrade</h2> <p>The <code>upgrade</code> subcommand is used to upgrade the Chef Infra Server.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl upgrade <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-d DIRECTORY</code>, <code>--chef11-data-dir DIRECTORY</code>
</dt> <dd> <p>The directory in which Chef Infra Server 11 data is located. Default value: a temporary directory.</p> </dd> <dt>
<code>-e DIRECTORY</code>, <code>--chef12-data-dir DIRECTORY</code>
</dt> <dd> <p>The directory in which Chef Infra Server 12 data is located. Default value: a temporary directory.</p> </dd> <dt>
<code>-f FULL_NAME</code>, <code>--full-org-name FULL_NAME</code>
</dt> <dd> <p>The full name of the Chef Infra Server organization. The full name must begin with a non-white space character and must be between 1 and 1023 characters. For example: <code>Chef Software, Inc.</code>. If this option is not specified, the <code>upgrade</code> command will prompt for it.</p> </dd> <dt>
<code>-h</code>, <code>--help</code>
</dt> <dd> <p>Use to show help for the <code>chef-server-ctl upgrade</code> subcommand.</p> </dd> <dt>
<code>-k KEY_PATH</code>, <code>--key KEY_PATH</code>
</dt> <dd> <p>The Chef Infra Server 11 <code>admin.pem</code> key for the API client. This is the key used to download Chef Infra Server 11 data. Default value: <code>/etc/chef-server/admin.pem</code>.</p> </dd> <dt>
<code>-o ORG_NAME</code>, <code>--org-name ORG_NAME</code>
</dt> <dd> <p>The name of the Chef Infra Server organization. The name must begin with a lower-case letter or digit, may only contain lower-case letters, digits, hyphens, and underscores, and must be between 1 and 255 characters. For example: <code>chef</code>. If this option is not specified, the <code>upgrade</code> command will prompt for it.</p> </dd> <dt>
<code>-s URL</code>, <code>--chef11-server-url URL</code>
</dt> <dd> <p>The URL for the Chef Infra Server version 11. Default value: <code>https://localhost</code>.</p> </dd> <dt>
<code>-t NUMBER</code>, <code>--upload-threads NUMBER</code>
</dt> <dd> <p>The number of threads to use when migrating cookbooks. Default value: <code>10</code>.</p> </dd> <dt>
<code>-u USER</code>, <code>--user</code>
</dt> <dd> <p>Create a client as an admin client. This is required for any user to access Chef as an administrator.</p> </dd> <dt>
<code>-x URL</code>, <code>--chef12-server-url URL</code>
</dt> <dd> <p>The URL for the Chef Infra Server, version 12. Default value: <code>https://localhost</code>.</p> </dd> <dt>
<code>-y</code>, <code>--yes</code>
</dt> <dd> <p>Use to skip confirmation prompts during the upgrade process.</p> </dd> </dl> <h2 id="user-management">User Management</h2> <p>Use the <code>user-create</code>, <code>user-delete</code>, <code>user-edit</code>, <code>user-list</code> and <code>user-show</code> subcommands to manage users.</p> <h3 id="user-create">user-create</h3> <p>The <code>user-create</code> subcommand is used to create a user. (The validation key for the organization may be returned to <code>STDOUT</code> when creating a user with this command.)</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-create USER_NAME FIRST_NAME <span style="color:#666">[</span>MIDDLE_NAME<span style="color:#666">]</span> LAST_NAME EMAIL <span style="color:#4070a0">'PASSWORD'</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-f FILE_NAME</code>, <code>--filename FILE_NAME</code>
</dt> <dd> <p>Write the USER.pem to a file instead of <code>STDOUT</code>.</p> </dd> </dl> <p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-create john_smith John Smith john_smith@example.com p@s5w0rD!
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-create jane_doe Jane Doe jane_doe@example.com p@s5w0rD! -f /tmp/jane_doe.key
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-create waldendude Henry David Thoreau waldendude@example.com excursions
</code></pre></div>
<h3 id="user-delete">user-delete</h3> <p>The <code>user-delete</code> subcommand is used to delete a user.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-delete USER_NAME
</code></pre></div>
<p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-delete john_smith
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-delete jane_doe
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-R</code>, <code>--remove-from-admin-groups</code>
</dt> <dd> <p>Removes a user who is in one or more ‘admin’ groups unless that user is the only member of the ‘admin’ group(s).</p> </dd> </dl> <h3 id="user-edit">user-edit</h3> <p>The <code>user-edit</code> subcommand is used to edit the details for a user. The data will be made available in the $EDITOR for editing.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-edit USER_NAME
</code></pre></div>
<p><strong>Examples</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-edit john_smith
</code></pre></div>
<div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-edit jane_doe
</code></pre></div>
<h3 id="user-list">user-list</h3> <p>The <code>user-list</code> subcommand is used to view a list of users.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-list <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-w</code>, <code>--with-uri</code>
</dt> <dd> <p>Show the corresponding URIs.</p> </dd> </dl> <h3 id="user-show">user-show</h3> <p>The <code>user-show</code> subcommand is used to show the details for a user.</p> <p><strong>Syntax</strong></p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl user-show USER_NAME <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p><strong>Options</strong></p> <p>This subcommand has the following options:</p> <dl> <dt>
<code>-l</code>, <code>--with-orgs</code>
</dt> <dd> <p>Show all organizations.</p> </dd> </dl> <h2 id="service-subcommands">Service Subcommands</h2> <p>This command has a built in process supervisor that ensures all of the required services are in the appropriate state at any given time. The supervisor starts two processes per service and provides the following subcommands for managing services: <code>hup</code>, <code>int</code>, <code>kill</code>, <code>once</code>, <code>restart</code>, <code>service-list</code>, <code>start</code>, <code>status</code>, <code>stop</code>, <code>tail</code>, and <code>term</code>.</p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> The following commands are disabled when an external PostgreSQL database is configured for the Chef Infra Server: <code>hup</code>, <code>int</code>, <code>kill</code>, <code>once</code>, <code>restart</code>, <code>start</code>, <code>stop</code>, <code>tail</code>, and <code>term</code>. </div> </div> <h3 id="hup">hup</h3> <p>The <code>hup</code> subcommand is used to send a <code>SIGHUP</code> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl hup SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> <h3 id="int">int</h3> <p>The <code>int</code> subcommand is used to send a <code>SIGINT</code> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl int SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> <h3 id="kill">kill</h3> <p>The <code>kill</code> subcommand is used to send a <code>SIGKILL</code> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl <span style="color:#007020">kill</span> SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> <h3 id="once">once</h3> <p>The supervisor for the Chef Infra Server is configured to restart any service that fails, unless that service has been asked to change its state. The <code>once</code> subcommand is used to tell the supervisor to not attempt to restart any service that fails.</p> <p>This command is useful when troubleshooting configuration errors that prevent a service from starting. Run the <code>once</code> subcommand followed by the <code>status</code> subcommand to look for services in a down state and/or to identify which services are in trouble. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl once SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> <h3 id="restart">restart</h3> <p>The <code>restart</code> subcommand is used to restart all services enabled on the Chef Infra Server or to restart an individual service by specifying the name of that service in the command.</p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> <p>When running the Chef Infra Server in a high availability configuration, restarting all services may trigger failover.</p> </div> </div> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl restart SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand. When a service is successfully restarted the output should be similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ok: run: service_name: <span style="color:#666">(</span>pid 12345<span style="color:#666">)</span> 1s
</code></pre></div>
<h3 id="service-list">service-list</h3> <p>The <code>service-list</code> subcommand is used to display a list of all available services. A service that is enabled is labeled with an asterisk (*).</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl service-list
</code></pre></div>
<h3 id="start">start</h3> <p>The <code>start</code> subcommand is used to start all services that are enabled in the Chef Infra Server. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl start SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand. When a service is successfully started the output should be similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ok: run: service_name: <span style="color:#666">(</span>pid 12345<span style="color:#666">)</span> 1s
</code></pre></div>
<p>The supervisor for the Chef Infra Server is configured to wait seven seconds for a service to respond to a command from the supervisor. If you see output that references a timeout, it means that a signal has been sent to the process, but that the process has yet to actually comply. In general, processes that have timed out are not a big concern, unless they are failing to respond to the signals at all. If a process is not responding, use a command like the <code>kill</code> subcommand to stop the process, investigate the cause (if required), and then use the <code>start</code> subcommand to re-enable it.</p> <h3 id="status">status</h3> <p>The <code>status</code> subcommand is used to show the status of all services available to the Chef Infra Server. The results will vary based on the configuration of a given server. This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl status
</code></pre></div>
<p>and will return the status for all services. Status can be returned for individual services by specifying the name of the service as part of the command:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl status SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> <p>When service status is requested, the output should be similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">run: service_name: <span style="color:#666">(</span>pid 12345<span style="color:#666">)</span> 12345s; run: log: <span style="color:#666">(</span>pid 1234<span style="color:#666">)</span> 67890s
</code></pre></div>
<p>where</p> <ul> <li>
<code>run:</code> is the state of the service (<code>run:</code> or <code>down:</code>)</li> <li>
<code>service_name:</code> is the name of the service for which status is returned</li> <li>
<code>(pid 12345)</code> is the process identifier</li> <li>
<code>12345s</code> is the uptime of the service, in seconds</li> </ul> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">down: opscode-erchef: <span style="color:#666">(</span>pid 35546<span style="color:#666">)</span> 10s
</code></pre></div>
<p>By default, runit will restart services automatically when the services fail. Therefore, runit may report the status of a service as <code>run:</code> even when there is an issue with that service. When investigating why a particular service is not running as it should be, look for the services with the shortest uptimes. For example, the list below indicates that the <strong>opscode-erchef</strong> should be investigated further:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">run: oc-id
run: opscode-chef: <span style="color:#666">(</span>pid 4327<span style="color:#666">)</span> 13671s; run: log: <span style="color:#666">(</span>pid 4326<span style="color:#666">)</span> 13671s
run: opscode-erchef: <span style="color:#666">(</span>pid 5383<span style="color:#666">)</span> 5s; run: log: <span style="color:#666">(</span>pid 4382<span style="color:#666">)</span> 13669s
</code></pre></div>
<h4 id="log-files">Log Files</h4> <p>A typical status line for a service that is running any of the Chef Infra Server front-end services is similar to the following:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">run: name_of_service: <span style="color:#666">(</span>pid 1486<span style="color:#666">)</span> 7819s; run: log: <span style="color:#666">(</span>pid 1485<span style="color:#666">)</span> 7819s
</code></pre></div>
<p>where:</p> <ul> <li>
<code>run</code> describes the state in which the supervisor attempts to keep processes. This state is either <code>run</code> or <code>down</code>. If a service is in a <code>down</code> state, it should be stopped</li> <li>
<code>name_of_service</code> is the service name, for example: <code>opscode-erchef</code>
</li> <li>
<code>(pid 1486) 7819s;</code> is the process identifier followed by the amount of time (in seconds) the service has been running</li> <li>
<code>run: log: (pid 1485) 7819s</code> is the log process. It is typical for a log process to have a longer run time than a service; this is because the supervisor does not need to restart the log process in order to connect the supervised process</li> </ul> <p>If the service is down, the status line will appear similar to the following:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">down: opscode-erchef: 3s, normally up; run: log: <span style="color:#666">(</span>pid 1485<span style="color:#666">)</span> 8526s
</code></pre></div>
<p>where</p> <ul> <li>
<code>down</code> indicates that the service is in a down state</li> <li>
<code>3s, normally up;</code> indicates that the service is normally in a run state and that the supervisor would attempt to restart this service after a reboot</li> </ul> <h3 id="stop">stop</h3> <p>The <code>stop</code> subcommand is used to stop all services enabled on the Chef Infra Server. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl stop SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand. When a service is successfully stopped the output should be similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ok: down: service_name: 0s, normally up
</code></pre></div>
<p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl stop
</code></pre></div>
<p>will return something similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ok: down: nginx: 393s, normally up
ok: down: opscode-chef: 391s, normally up
ok: down: opscode-erchef: 391s, normally up
ok: down: opscode-solr4: 389s, normally up
ok: down: postgresql: 388s, normally up
ok: down: redis_lb: 387s, normally up
</code></pre></div>
<h3 id="tail">tail</h3> <p>The <code>tail</code> subcommand is used to follow all of the Chef Infra Server logs for all services. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl tail SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> <h3 id="term">term</h3> <p>The <code>term</code> subcommand is used to send a <code>SIGTERM</code> to all services. This command can also be run for an individual service by specifying the name of the service in the command.</p> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef-server-ctl term SERVICE_NAME
</code></pre></div>
<p>where <code>SERVICE_NAME</code> represents the name of any service that is listed after running the <code>service-list</code> subcommand.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/ctl_chef_server.html" class="_attribution-link">https://docs.chef.io/ctl_chef_server.html</a>
  </p>
</div>
