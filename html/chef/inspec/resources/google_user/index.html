<div id="col-content" data-swiftype-index="true"> <div id="google_user-resource"><h1>google_user resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/google_user.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>google_user</code> InSpec audit resource to test properties of a single GCP user.</p> <h2 id="syntax">Syntax</h2> <p>A <code>google_user</code> resource block declares the tests for a single GCP user by principal email address or immutable ID.</p> <pre class="highlight" data-language="ruby"><code>describe google_user(user_key: 'principal_email_address@domain.com') do
  it { should exist }
end
</code></pre> <h2 id="examples">Examples</h2> <p>The following examples show how to use this InSpec audit resource.</p> <h3 id="test-that-a-gcp-user-with-specified-id-exists">Test that a GCP user with specified ID exists</h3> <pre class="highlight" data-language="ruby"><code>describe google_user(user_key: '110491234567894702010') do
  it { should exist }
end
</code></pre> <h3 id="test-that-a-gcp-user-has-expected-full-name">Test that a GCP user has expected full name</h3> <pre class="highlight" data-language="ruby"><code>describe google_user(user_key: '110491234567894702010') do
  its('name.full_name') { should eq "Bill S. Preston Esq." }
end
</code></pre> <h3 id="test-that-a-gcp-user-has-mfa-enabled">Test that a GCP user has MFA enabled</h3> <pre class="highlight" data-language="ruby"><code>describe google_user(user_key: 'theodore_ted_logan@excellentadventure.com') do
  it { should have_mfa_enabled }
end
</code></pre> <h3 id="test-that-a-gcp-user-is-suspended-or-not">Test that a GCP user is suspended or not</h3> <pre class="highlight" data-language="ruby"><code>describe google_user(user_key: 'theodore_ted_logan@excellentadventure.com') do
  it { should_not be_suspended }
end
</code></pre> <h2 id="properties">Properties</h2> <ul> <li>
<code>agreed_to_terms</code>, <code>archived</code>, <code>change_password_at_next_login</code>, <code>creation_time</code>, <code>customer_id</code>, <code>emails</code>, <code>etag</code>, <code>id</code>, <code>include_in_global_address_list</code>, <code>ip_whitelisted</code>, <code>is_admin</code>, <code>is_delegated_admin</code>, <code>is_enforced_in2_sv</code>, <code>is_enrolled_in2_sv</code>, <code>is_mailbox_setup</code>, <code>kind</code>, <code>last_login_time</code>, <code>name</code>, <code>non_editable_aliases</code>, <code>org_unit_path</code>, <code>primary_email</code>, <code>suspended</code>
</li> </ul> <h2 id="gcp-permissions">GCP Permissions</h2> <p>Ensure the G Suite Admin SDK <a href="https://developers.google.com/admin-sdk/directory/">Directory API</a> is enabled and you have sufficient privileges to list users.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/google_user/" class="_attribution-link">https://docs.chef.io/inspec/resources/google_user/</a>
  </p>
</div>
