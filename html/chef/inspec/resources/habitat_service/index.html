<div id="col-content" data-swiftype-index="true"> <div id="habitat_service-resource"><h1>habitat_service resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/habitat_service.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>habitat_service</code> InSpec audit resource to test properties of a single Habitat service.</p> <h2 id="availability">Availability</h2> <h3 id="status-experimental">Status: EXPERIMENTAL</h3> <p>This resource, like all of the inspec-habitat resource pack, is in the early stages of research and development. Functionality may be defective, incomplete, or be withdrawn in the future. If you are interested in helping this project mature, please join the conversation or contribute code at the <a href="https://github.com/inspec/inspec-habitat">inspec-habitat project</a>.</p> <h3 id="connecting-to-habitat">Connecting to Habitat</h3> <p>To configure <code>inspec</code> to be able to communicate with Chef Habitat, be sure <a href="https://github.com/inspec/inspec-habitat#configuring-inspec-to-reach-habitat">to follow the instructions</a> regarding configuring the connection options. This will prevent ‘unsupported platform’ errors.</p> <h2 id="examples">Examples</h2> <h3 id="check-for-corehttpd-service">Check for core/httpd service</h3> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  it                     { should exist }
  its(<span style="color:#4070a0">'version'</span>)         { should eq <span style="color:#4070a0">'2.4.35'</span>}
  its(<span style="color:#4070a0">'topology'</span>)        { should eq <span style="color:#4070a0">'standalone'</span> }
  its(<span style="color:#4070a0">'update_strategy'</span>) { should eq <span style="color:#4070a0">'none'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h2 id="limitations">Limitations</h2> <h3 id="api-versus-cli-access">API versus CLI access</h3> <p>Habitat exposes certain data via the CLI, and other data via the HTTP Gateway API. To enjoy the full functionality of this resource, use a set of credentials that includes the API. Limited data is available by CLI. See the <a href="https://github.com/inspec/train-habitat">train-habitat</a> documentation for more details.</p> <p>If you use the CLI interface without the API, unavailable properties will behave as if the resource was not found (see below).</p> <h3 id="behavior-when-not-found">Behavior when not found</h3> <p>If the service is not found, then this resource behaves as follows:</p> <ul> <li>
<code>it { should exist }</code> will be a failing test. Check this test if you are unsure if the resource will exist; it is guaranteed to be reliable in the future.</li> <li>
<code>name</code> and <code>origin</code> will continue to return their values as set in the resource parameters. This allows output messaging to refer to the missing service clearly.</li> <li>All other single-value properties will return nil.</li> <li>All array and hash-valued properties will return empty objects.</li> <li>All matchers will return false.</li> </ul> <h2 id="availability-1">Availability</h2> <h3 id="installation">Installation</h3> <p>This resource is in the <code>inspec-habitat</code> resource pack. You can use the resource by setting an InSpec profile dependency on the resource pack. See <a href="https://github.com/inspec/inspec-habitat#installation">inspec-habitat instructions</a></p> <h3 id="version">Version</h3> <p>This resource was first available in version 0.1.0 of the resource pack.</p> <h2 id="resource-parameters">Resource Parameters</h2> <p>Use <a href="../../glossary/index.html#resource-parameter">resource parameters</a> to identify the particular service you wish to test.</p> <h3 id="origin">origin</h3> <p>Required string. The name of the <code>origin</code> (distribution facility) of the package that provides the service.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#60a0b0;font-style:italic"># Most common origin is 'core', publicly distributed packages created by Chef</span>
describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should exist }
<span style="color:#007020;font-weight:700">end</span>

<span style="color:#60a0b0;font-style:italic"># Your company might run a private origin</span>
describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'mycorp'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'secret-sauce'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should exist }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="name">name</h3> <p>Required string. The name (unique within the namespace of the origin) of the package that provides the service.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should exist }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h2 id="properties">Properties</h2> <p>Use <a href="../../glossary/index.html#property">properties</a> to create tests that compare an expected value to the actual value.</p> <h3 id="dependency_names">dependency_names</h3> <p>Array of strings. A list of the packages that this service depends on, in the form of <code>dep_origin/dep_name</code>. This property does not contain version information; see <code>dependency_ids</code> for that.</p> <p>Requires API connection; not available via CLI.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  its(<span style="color:#4070a0">'dependency_names'</span>) { should <span style="color:#007020">include</span> <span style="color:#4070a0">'core/pcre'</span> }
  its(<span style="color:#4070a0">'dependency_names'</span>) { should_not <span style="color:#007020">include</span> <span style="color:#4070a0">'core/nginx'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="dependency_ids">dependency_ids</h3> <p>Array of strings. A list of the packages that this service depends on, in the form of <code>dep_origin/dep_name/1.2.3/20190325123456</code>. This value may be difficult to compare, because the version identifier (<code>1.2.3</code>, the third component) may be formatted in any way the maintainer of the project chooses; they need not be of the form <code>1.2.3</code>.</p> <p>Requires API connection; not available via CLI.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  <span style="color:#60a0b0;font-style:italic"># Suppose this version was unwanted, for example</span>
  its(<span style="color:#4070a0">'dependency_names'</span>) { should_not <span style="color:#007020">include</span> <span style="color:#4070a0">'core/pcre/8.42/20190115012526'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="name-1">name</h3> <p>The name of the service, as passed in via the resource parameter. Always available, even if the resource was not found. See also <a href="#origin">origin</a> and <a href="#version">version</a>.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  its(<span style="color:#4070a0">'name'</span>) { should cmp <span style="color:#4070a0">'httpd'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="origin-1">origin</h3> <p>The origin name of the service, as passed in via the resource parameter. Always available, even if the resource was not found. See also <a href="#name">name</a> and <a href="#version">version</a>.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  its(<span style="color:#4070a0">'origin'</span>) { should cmp <span style="color:#4070a0">'core'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="pkg_id">pkg_id</h3> <p>String. The full package identifier of the package that supports the service, in the form <code>origin/name/version/release</code>. See also <a href="#name">name</a> and <a href="#version">version</a>.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  its(<span style="color:#4070a0">'pkg_id'</span>) { should cmp <span style="color:#4070a0">'core/httpd/2.4.35/20190307151146'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="release">release</h3> <p>String. The release number of the package that supports the service, as assigned by the packager. These values are always strings, but are 14-digit timestamps. See also <a href="#version">version</a>.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  its(<span style="color:#4070a0">'release'</span>) { should be <span style="color:#666">&gt;=</span> <span style="color:#4070a0">'20190307151146'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="version-1">version</h3> <p>The version of the package that supports the service, as assigned by the maintainer of the package project. While many versions are of the 3-digit form, there is no set rule, and exceptions are common. See also <a href="#release">release</a>.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  its(<span style="color:#4070a0">'version'</span>) { should be <span style="color:#666">&gt;=</span>  <span style="color:#4070a0">'2.2'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h2 id="matchers">Matchers</h2> <p>Use <a href="../../glossary/index.html#matcher">matchers</a> to create tests that test a true or false question.</p> <p>InSpec includes a number of <a href="../../matchers/index.html">universal matchers</a>. See below for matchers specific to this resource.</p> <h3 id="have_standalone_topology">have_standalone_topology</h3> <p>This matcher returns <code>true</code> if the service is configured in a <a href="https://www.habitat.sh/docs/using-habitat/#standalone"><code>standalone</code></a> topology.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should have_standalone_topology }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="have_leader_follower_topology">have_leader_follower_topology</h3> <p>This matcher returns <code>true</code> if the service is configured in a <a href="https://www.habitat.sh/docs/using-habitat/#leader-follower-topology"><code>leader-follower</code></a> topology.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'httpd'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should have_leader_follower_topology }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="be_updated_by_none">be_updated_by_none</h3> <p>This matcher returns <code>true</code> if the update strategy for the service is <a href="https://www.habitat.sh/docs/using-habitat/#none-strategy"><code>none</code></a>.</p> <p>Requires API connection; not available via CLI.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'postgresql'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should be_updated_by_none }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="be_updated_by_rolling">be_updated_by_rolling</h3> <p>This matcher returns <code>true</code> if the update strategy for the service is <a href="https://www.habitat.sh/docs/using-habitat/#rolling-strategy"><code>rolling</code></a>.</p> <p>Requires API connection; not available via CLI.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'postgresql'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should be_updated_by_rolling }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="be_updated_at_once">be_updated_at_once</h3> <p>This matcher returns <code>true</code> if the update strategy for the service is <a href="https://www.habitat.sh/docs/using-habitat/#at-once-strategy"><code>at once</code></a>.</p> <p>Requires API connection; not available via CLI.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe habitat_service(<span style="color:#517918">origin</span>: <span style="color:#4070a0">'core'</span>, <span style="color:#007020">name</span>: <span style="color:#4070a0">'nginx'</span>) <span style="color:#007020;font-weight:700">do</span>
  it { should be_updated_at_once }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/habitat_service/" class="_attribution-link">https://docs.chef.io/inspec/resources/habitat_service/</a>
  </p>
</div>
