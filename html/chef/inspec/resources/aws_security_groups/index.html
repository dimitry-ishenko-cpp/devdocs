<div id="col-content" data-swiftype-index="true"> <div id="aws_security_groups-resource"><h1>aws_security_groups resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/aws_security_groups.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>aws_security_groups</code> InSpec audit resource to test properties of some or all security groups.</p> <p>Security groups are a networking construct that contain ingress and egress rules for network communications. Security groups may be attached to EC2 instances, as well as certain other AWS resources. Along with Network Access Control Lists, Security Groups are one of the two main mechanisms of enforcing network-level security.</p> <h2 id="syntax">Syntax</h2> <p>An <code>aws_security_groups</code> resource block uses an optional filter to select a group of security groups and then tests that group.</p> <pre class="highlight" data-language="ruby"><code>describe aws_security_groups do
  its('entries.count') { should be &gt; 1 }
end
</code></pre> <h2 id="parameters">Parameters</h2> <p>This resource does not expect any parameters.</p> <p>See also the <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-network-security.html">AWS documentation on Security Groups</a>.</p> <h2 id="properties">Properties</h2> <table> <thead> <tr> <th>Property</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>group_ids</td> <td>The name of the auto scaling launch configuration associated with the auto scaling group</td> </tr> <tr> <td>group_names</td> <td>An integer indicating the maximum number of instances in the auto scaling group</td> </tr> <tr> <td>vpc_ids</td> <td>An integer indicating the desired number of instances in the auto scaling group</td> </tr> <tr> <td>tags</td> <td>An integer indicating the minimum number of instances in the auto scaling group</td> </tr> <tr> <td>entries</td> <td>Provides access to the raw results of the query, which can be treated as an array of hashes.</td> </tr> </tbody> </table> <h2 id="examples">Examples</h2> <p>The following examples show how to use this InSpec audit resource.</p> <h3 id="look-for-a-particular-security-group-in-just-one-vpc">Look for a particular security group in just one VPC</h3> <pre class="highlight" data-language="ruby"><code>describe aws_security_groups.where( vpc_id: 'vpc-12345678') do
  its('group_ids') { should include('sg-abcdef12')}
end
</code></pre> <h3 id="examine-the-default-security-group-in-all-vpcs">Examine the default security group in all VPCs</h3> <pre class="highlight" data-language="ruby"><code>describe aws_security_groups.where( group_name: 'default') do
  it { should exist }
end
</code></pre> <h3 id="allow-at-most-100-security-groups-on-the-account">Allow at most 100 security groups on the account</h3> <pre class="highlight" data-language="ruby"><code>describe aws_security_groups do
  its('entries.count') { should be &lt;= 100}
end
</code></pre> <h2 id="matchers">Matchers</h2> <p>This InSpec audit resource has the following special matchers. For a full list of available matchers, please visit our <a href="../../matchers/index.html">matchers page</a>.</p> <h3 id="exist">exist</h3> <p>The control will pass if the filter returns at least one result.</p> <p>Use <code>should_not</code> if you expect zero matches.</p> <pre class="highlight" data-language="ruby"><code># You will always have at least one SG, the VPC default SG
describe aws_security_groups
  it { should exist }
end
</code></pre> <h2 id="aws-permissions">AWS Permissions</h2> <p>Your <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/intro-structure.html#intro-structure-principal">Principal</a> will need the <code>ec2:DescribeSecurityGroups</code> action with Effect set to Allow.</p> <p>You can find detailed documentation at <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonec2.html">Actions, Resources, and Condition Keys for Amazon EC2</a>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/aws_security_groups/" class="_attribution-link">https://docs.chef.io/inspec/resources/aws_security_groups/</a>
  </p>
</div>
