<div id="col-content" data-swiftype-index="true"> <div id="about-knife"><h1>About Knife</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-workstation/blob/main/docs-chef-io/content/workstation/knife.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>knife is a command-line tool that provides an interface between a local chef-repo and the Chef Infra Server. knife helps users to manage:</p> <ul> <li>Nodes</li> <li>Cookbooks and recipes</li> <li>Roles, Environments, and Data Bags</li> <li>Resources within various cloud environments</li> <li>The installation of Chef Infra Client onto nodes</li> <li>Searching of indexed data on the Chef Infra Server</li> </ul> <p>The Knife Quick Reference provides an all-in-one quick reference of knife commands. You can view the <a href="https://github.com/chef/quick-reference/blob/main/qr_knife_web.png">overview</a> or download the <a href="https://github.com/chef/quick-reference">source files</a>.</p> <table> <col style="width:25%"> <col style="width:75%"> <thead> <tr class="header"> <th>Topic</th> <th>Description</th> </tr> </thead> <tbody> <tr class="odd"> <td><a href="../../knife_setup/index.html">Setting up Knife</a></td> <td>Configure knife to interact with your organization's Chef Infra Server and infrastructure.</td> </tr> <tr class="even"> <td><a href="../../knife_options/index.html">Knife Common Options</a></td> <td>Common options that are available for all knife subcommands.</td> </tr> <tr class="odd"> <td><a href="../../config_rb/index.html">config.rb</a></td> <td>Common options for the <code>config.rb</code> (knife.rb) file</td> </tr> <tr class="even"> <td><a href="../../config_rb_optional_settings/index.html">config.rb Optional Settings</a></td> <td>Additional options for your <code>config.rb</code> file</td> </tr> </tbody> </table> <h2 id="knife-subcommands">Knife Subcommands</h2> <p>knife includes a collection of built in subcommands that work together to provide all of the functionality required to take specific actions against any object in an organization, including cookbooks, nodes, roles, data bags, environments, and users.</p> <h3 id="knife-command-syntax">Knife Command Syntax</h3> <p>All knife subcommands have the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife subcommand <span style="color:#666">[</span>ARGUMENT<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<p>Each subcommand has its own set of arguments and options.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> All syntax examples in this document show variables in ALL_CAPS. For example <code>-u PORT_LIST</code> (where PORT_LIST is a comma-separated list of local and public UDP ports) or <code>-F FORMAT</code> (where FORMAT determines the output format, either <code>summary</code>, <code>text</code>, <code>json</code>, <code>yaml</code>, or <code>pp</code>). These variables often require specific values that are unique to each organization. </div> </div> <h3 id="built-in-subcommands">Built-in Subcommands</h3> <table> <col style="width:25%"> <col style="width:75%"> <thead> <tr class="header"> <th>Subcommand</th> <th>Description</th> </tr> </thead> <tbody> <tr class="odd"> <td><a href="../../knife_bootstrap/index.html">knife_bootstrap</a></td> <td>Use the `knife bootstrap` subcommand to run a bootstrap operation that installs Chef Infra Client on the target system. The bootstrap operation must specify the IP address or FQDN of the target system.</td> </tr> <tr class="even"> <td><a href="../../knife_client/index.html">knife_client</a></td> <td>Use the `knife client` subcommand to manage an API client list and their associated RSA public key-pairs. This allows authentication requests to be made to the Chef Infra Server by any entity that uses the Chef Infra Server API, such as Chef Infra Client and knife.</td> </tr> <tr class="odd"> <td><a href="../../knife_configure/index.html">knife configure</a></td> <td>Use the `knife configure` subcommand to create the [client.rb](/config_rb_client/) and credential files so that they can be distributed to workstations and nodes. </td> </tr> <tr class="even"> <td><a href="../../knife_cookbook/index.html">knife cookbook</a></td> <td>Use the `knife cookbook` subcommand to interact with cookbooks that are located on the Chef Infra Server or the local chef-repo.</td> </tr> <tr class="odd"> <td><a href="../../knife_data_bag/index.html">knife data bag</a></td> <td>Use the `knife data bag` subcommand to manage arbitrary stores of globally available JSON data.</td> </tr> <tr class="even"> <td><a href="../../knife_delete/index.html">knife delete</a></td> <td>Use the `knife delete` subcommand to delete an object from a Chef Infra Server. This subcommand works similar to `knife cookbook delete`, `knife data bag delete`, `knife environment delete`, `knife node delete`, and `knife role delete`, but with a single verb (and a single action).</td> </tr> <tr class="odd"> <td><a href="../../knife_deps/index.html">knife deps</a></td> <td>Use the `knife deps` subcommand to identify dependencies for a node, role, or cookbook.</td> </tr> <tr class="even"> <td><a href="../../knife_diff/index.html">knife diff</a></td> <td>Use the `knife diff` subcommand to compare the differences between files and directories on the Chef Infra Server and in the chef-repo. For example, to compare files on the Chef Infra Server prior to uploading or downloading files using the `knife download` and `knife upload` subcommands, or to ensure that certain files in multiple production environments are the same. This subcommand is similar to the `git diff` command that can be used to diff what is in the chef-repo with what is synced to a git repository.</td> </tr> <tr class="odd"> <td><a href="../../knife_download/index.html">knife download</a></td> <td>Use the `knife download` subcommand to download roles, cookbooks, environments, nodes, and data bags from the Chef Infra Server to the current working directory. It can be used to back up data on the Chef Infra Server, inspect the state of one or more files, or to extract out-of-process changes users may have made to files on the Chef Infra Server, such as if a user made a change that bypassed version source control. This subcommand is often used in conjunction with `knife diff`, which can be used to see exactly what changes will be downloaded, and then `knife upload`, which does the opposite of `knife download`.</td> </tr> <tr class="even"> <td><a href="../../knife_edit/index.html">knife edit</a></td> <td>Use the `knife edit` subcommand to edit objects on the Chef Infra Server. This subcommand works similar to `knife cookbook edit`, `knife data bag edit`, `knife environment edit`, `knife node edit`, and `knife role edit`, but with a single verb (and a single action).</td> </tr> <tr class="odd"> <td><a href="../../knife_environment/index.html">knife environment</a></td> <td>Use the `knife environment` subcommand to manage environments within a single organization on the Chef Infra Server.</td> </tr> <tr class="even"> <td><a href="../../knife_exec/index.html">knife exec</a></td> <td>Use the `knife exec` subcommand to execute Ruby scripts in the context of a fully configured Chef Infra Client. Use this subcommand to run scripts that will only access Chef Infra Server one time (or otherwise very infrequently) or any time that an operation does not warrant full usage of the knife subcommand library.</td> </tr> <tr class="odd"> <td><a href="../../knife_list/index.html">knife list</a></td> <td>Use the `knife list` subcommand to view a list of objects on the Chef Infra Server. This subcommand works similar to `knife cookbook list`, `knife data bag list`, `knife environment list`, `knife node list`, and `knife role list`, but with a single verb (and a single action).</td> </tr> <tr class="even"> <td><a href="../../knife_node/index.html">knife node</a></td> <td>Use the `knife node` subcommand to manage the nodes that exist on a Chef Infra Server.</td> </tr> <tr class="odd"> <td><a href="../../knife_raw/index.html">knife raw</a></td> <td>Use the `knife raw` subcommand to send a REST request to an endpoint in the Chef Infra Server API.</td> </tr> <tr class="even"> <td><a href="../../knife_recipe_list/index.html">knife recipe list</a></td> <td>Use the `knife recipe list` subcommand to view all of the recipes that are on a Chef Infra Server. A regular expression can be used to limit the results to recipes that match a specific pattern. The regular expression must be within quotes and not be surrounded by forward slashes (/).</td> </tr> <tr class="odd"> <td><a href="../../knife_role/index.html">knife role</a></td> <td>Use the `knife role` subcommand to manage the roles that are associated with one or more nodes on a Chef Infra Server.</td> </tr> <tr class="even"> <td><a href="../../knife_search/index.html">knife search</a></td> <td>Use the `knife search` subcommand to run a search query for information that is indexed on a Chef Infra Server.</td> </tr> <tr class="odd"> <td><a href="../../knife_serve/index.html">knife serve</a></td> <td>Use the `knife serve` subcommand to run a persistent chef-zero against the local chef-repo. (chef-zero is a lightweight Chef Infra Server that runs in-memory on the local machine.) This is the same as running the Chef Infra Client executable with the `--local-mode` option. The `chef_repo_path` is located automatically and the Chef Infra Server will bind to the first available port between `8889` and `9999`. `knife serve` will print the URL for the local Chef Infra Server, so that it may be added to the config.rb file.</td> </tr> <tr class="even"> <td><a href="../../knife_show/index.html">knife show</a></td> <td>Use the `knife show` subcommand to view the details of one (or more) objects on the Chef Infra Server. This subcommand works similar to `knife cookbook show`, `knife data bag show`, `knife environment show`, `knife node show`, and `knife role show`, but with a single verb (and a single action).</td> </tr> <tr class="odd"> <td><a href="../../knife_ssh/index.html">knife ssh</a></td> <td>Use the `knife ssh` subcommand to invoke SSH commands (in parallel) on a subset of nodes within an organization, based on the results of a [search query](/chef_search/) made to the Chef Infra Server.</td> </tr> <tr class="even"> <td><a href="../../knife_ssl_check/index.html">knife ssl check</a></td> <td>Use the `knife ssl check` subcommand to verify the SSL configuration for the Chef Infra Server or a location specified by a URL or URI. Invalid certificates will not be used by OpenSSL. <p>When this command is run, the certificate files (<code>*.crt</code> and/or <code>*.pem</code>) that are located in the <code>/.chef/trusted_certs</code> directory are checked to see if they have valid X.509 certificate properties. A warning is returned when certificates do not have valid X.509 certificate properties or if the <code>/.chef/trusted_certs</code> directory does not contain any certificates.</p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> <p>When verification of a remote server’s SSL certificate is disabled, Chef Infra Client will issue a warning similar to “SSL validation of HTTPS requests is disabled. HTTPS connections are still encrypted, but Chef Infra Client is not able to detect forged replies or man-in-the-middle attacks.” To configure SSL for Chef Infra Client, set <code>ssl_verify_mode</code> to <code>:verify_peer</code> (recommended) <strong>or</strong> <code>verify_api_cert</code> to <code>true</code> in the client.rb file.</p> </div> </div>
</td> </tr> <tr class="odd"> <td><a href="../../knife_ssl_fetch/index.html">knife ssl fetch</a></td> <td>Use the `knife ssl fetch` subcommand to copy SSL certificates from an HTTPS server to the `trusted_certs_dir` directory that is used by knife and Chef Infra Client to store trusted SSL certificates. When these certificates match the hostname of the remote server, running `knife ssl fetch` is the only step required to verify a remote server that is accessed by either knife or Chef Infra Client. <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> <p>It is the user’s responsibility to verify the authenticity of every SSL certificate before downloading it to the <code>/.chef/trusted_certs</code> directory. knife will use any certificate in that directory as if it is a 100% trusted and authentic SSL certificate. knife will not be able to determine if any certificate in this directory has been tampered with, is forged, malicious, or otherwise harmful. Therefore it is essential that users take the proper steps before downloading certificates into this directory.</p> </div> </div>
</td> </tr> <tr class="even"> <td><a href="../../knife_status/index.html">knife status</a></td> <td>Use the `knife status` subcommand to display a brief summary of the nodes on a Chef Infra Server, including the time of the most recent successful Chef Infra Client run.</td> </tr> <tr class="odd"> <td><a href="../../knife_tag/index.html">knife tag</a></td> <td>Use the `knife tag` subcommand to apply tags to nodes on a Chef Infra Server.</td> </tr> <tr class="even"> <td><a href="../../knife_supermarket/index.html">knife supermarket</a></td> <td>Use the <code>knife supermarket</code> subcommand to interact with cookbooks that are available in the <a href="https://supermarket.chef.io/">Chef Supermarket</a>. A user account is required for any community actions that write data to this site. The following arguments do not require a user account: <code>download</code>, <code>search</code>, <code>install</code>, and <code>list</code>.</td> </tr> <tr class="odd"> <td><a href="../../knife_upload/index.html">knife upload</a></td> <td>Use the `knife upload` subcommand to upload data to the Chef Infra Server from the current working directory in the chef-repo. The following types of data may be uploaded with this subcommand: <ul> <li>Cookbooks</li> <li>Data bags</li> <li>Roles stored as JSON data</li> <li>Environments stored as JSON data</li> </ul> <p>(Roles and environments stored as Ruby data will not be uploaded.) This subcommand is often used in conjunction with <code>knife diff</code>, which can be used to see exactly what changes will be uploaded, and then <code>knife download</code>, which does the opposite of <code>knife upload</code>.</p>
</td> </tr> <tr class="even"> <td><a href="../../knife_user/index.html">knife user</a></td> <td>Use the `knife user` subcommand to manage the list of users and their associated RSA public key-pairs.</td> </tr> <tr class="odd"> <td><a href="../../knife_xargs/index.html">knife xargs</a></td> <td>Use the `knife xargs` subcommand to take patterns from standard input, download as JSON, run a command against the downloaded JSON, and then upload any changes.</td> </tr> </tbody> </table> <h3 id="verb-subcommands">Verb Subcommands</h3> <p>knife includes a set of subcommands that are built around common verbs: <code>delete</code>, <code>deps</code>, <code>diff</code>, <code>download</code>, <code>edit</code>, <code>list</code>, <code>show</code>, <code>upload</code>, <code>xargs</code>. These subcommands allow knife to issue commands that interact with any object stored in the chef-repo or stored on the Chef Infra Server. Some important principles behind this group of subcommands includes:</p> <ul> <li>A command that works with each object in the chef-repo. The subcommands specify the desired action (the “verb”), and then directory in which that object resides (<code>clients</code>, <code>cookbooks/</code>, <code>data_bags/</code>, <code>environments/</code>, <code>nodes</code>, <code>roles/</code>, and <code>users</code>). For example: <code>download cookbooks/</code>
</li> <li>A command that works with certain objects in the Chef Infra Server, including <code>acls</code>, <code>groups</code>, and <code>containers</code>
</li> <li>Uses the Chef Infra Server as if it were a file system, allowing the chef-repo on the Chef Infra Server to behave like a mirror of the chef-repo on the workstation. The Chef Infra Server will have the same objects as the local chef-repo. To make changes to the files on the Chef Infra Server, just download files from the Chef Infra Server or upload files from the chef-repo</li> <li>The context from which a command is run matters. For example, when working in the <code>roles/</code> directory, knife will know what is being worked with. Enter <code>knife show base.json</code> and knife will return the base role from the Chef Infra Server. From the chef-repo root, enter <code>knife show roles/base.json</code> to get the same result</li> <li>Parallel requests can be made to the Chef Infra Server and are configurable on a per-command basis</li> </ul> <h3 id="wildcard-search">Wildcard Search</h3> <p>A wildcard matching pattern can be used for substring matches that replace zero (or more) characters. There are two types of wildcard patterns:</p> <ul> <li>A question mark ("?") can be used to replace exactly one character (as long as that character is not the first character)</li> <li>An asterisk ("*") can be used to replace any number of characters (including zero)</li> </ul> <p>Wildcard patterns must be escaped (using a backslash) so that the wildcard itself can reach the Chef Infra Server. If they are not escaped, the wildcard is expanded into the actual filenames and knife will not know the wildcard was intended to be used. For example, if the Chef Infra Server has data bags named <code>aardvarks</code>, <code>anagrams</code>, and <code>arp_tables</code>, but the local file system only has <code>aardvarks</code> and <code>anagrams</code>, escaping vs. not escaping the wildcard pattern will yield different results:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife list data_bags/a<span style="color:#4070a0;font-weight:700">\*</span>
</code></pre></div>
<p>asks the Chef Infra Server for everything starting with the letter “a” and will return:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">aardvarks/ anagrams/ arp_tables/
</code></pre></div>
<p>But, the following:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife list data_bags/a*
</code></pre></div>
<p>will return:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">aardvarks/ anagrams/
</code></pre></div>
<p>Which is the same as entering:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife list data_bags/aardvarks data_bags/anagrams
</code></pre></div>
<p>to return:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">aardvarks/ anagrams/
</code></pre></div>
<h2 id="knife-plug-ins">Knife Plug-ins</h2> <p>Knife functionality can be extended with plugins, which work the same as built-in subcommands (including common options). Knife plugins have been written to interact with common cloud providers, to simplify common Chef tasks, and to aid in Chef workflows.</p> <h3 id="plugin-installation">Plugin Installation</h3> <p>Knife plugins ship as RubyGems and are installed into the Chef Workstation installation using the <code>chef</code> command:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">chef gem install PLUGIN_NAME
</code></pre></div>
<p>Post installation you will also need to rehash the list of knife commands by running:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife rehash
</code></pre></div>
<h3 id="chef-maintained-knife-plugins">Chef Maintained Knife Plugins</h3> <p>Chef maintains the following plugins which ship with Chef Workstation:</p> <ul> <li><code>knife-acl</code></li> <li><code>knife-azure</code></li> <li><code>knife-ec2</code></li> <li><code>knife-google</code></li> <li><code>knife-lpar</code></li> <li><code>knife-opc</code></li> <li><code>knife-openstack</code></li> <li><code>knife-rackspace</code></li> <li><code>knife-reporting</code></li> <li><code>knife-vcenter</code></li> <li><code>knife-windows</code></li> </ul> <h3 id="community-knife-plugins">Community Knife Plugins</h3> <p>Knife plugins written by Chef community members can be found on Supermarket under <a href="https://supermarket.chef.io/tools?type=knife_plugin">Knife Plugins</a>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/workstation/knife/" class="_attribution-link">https://docs.chef.io/workstation/knife/</a>
  </p>
</div>
