<div id="col-content" data-swiftype-index="true"> <div id="knife-diff"><h1>knife diff</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-workstation/blob/main/docs-chef-io/content/workstation/knife_diff.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>knife diff</code> subcommand to compare the differences between files and directories on the Chef Infra Server and in the chef-repo. For example, to compare files on the Chef Infra Server prior to uploading or downloading files using the <code>knife download</code> and <code>knife upload</code> subcommands, or to ensure that certain files in multiple production environments are the same. This subcommand is similar to the <code>git diff</code> command that can be used to diff what is in the chef-repo with what is synced to a git repository.</p> <h2 id="syntax">Syntax</h2> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife diff <span style="color:#666">[</span>PATTERN...<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h2 id="options">Options</h2> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Review the list of <a href="../knife_options/index.html">common options</a> available to this (and all) knife subcommands and plugins. </div> </div> <p>This subcommand has the following options:</p> <dl> <dt><code>--chef-repo-path PATH</code></dt> <dd> <p>The path to the chef-repo. This setting will override the default path to the chef-repo. Default: same value as specified by <code>chef_repo_path</code> in client.rb.</p> </dd> <dt><code>--cookbook-version VERSION</code></dt> <dd> <p>The version of a cookbook to download.</p> </dd> <dt><code>--concurrency</code></dt> <dd> <p>The number of allowed concurrent connections. Default: <code>10</code>.</p> </dd> <dt><code>--diff-filter=[(A|D|M|T)...[*]]</code></dt> <dd> <p>Select only files that have been added (<code>A</code>), deleted (<code>D</code>), modified (<code>M</code>), and/or have had their type changed (<code>T</code>). Any combination of filter characters may be used, including no filter characters. Use <code>*</code> to select all paths if a file matches other criteria in the comparison. Default value: <code>nil</code>.</p> </dd> <dt><code>--name-only</code></dt> <dd> <p>Show only the names of modified files.</p> </dd> <dt><code>--name-status</code></dt> <dd> <p>Show only the names of files with a status of <code>Added</code>, <code>Deleted</code>, <code>Modified</code>, or <code>Type Changed</code>.</p> </dd> <dt><code>--no-recurse</code></dt> <dd> <p>Use <code>--no-recurse</code> to disable listing a directory recursively. Default: <code>--recurse</code>.</p> </dd> <dt><code>--repo-mode MODE</code></dt> <dd> <p>The layout of the local chef-repo. Possible values: <code>static</code>, <code>everything</code>, or <code>hosted_everything</code>. Use <code>static</code> for just roles, environments, cookbooks, and data bags. By default, <code>everything</code> and <code>hosted_everything</code> are dynamically selected depending on the server type. Default: <code>everything</code> / <code>hosted_everything</code>.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h2 id="examples">Examples</h2> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Compare files that contain JSON data</strong></p> <p>To compare the <code>base.json</code> role to a <code>webserver.json</code> role, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife diff roles/base.json roles/webserver.json
</code></pre></div>
<p><strong>Compare the chef-repo and the server</strong></p> <p>To compare the differences between the local chef-repo and the files that are on the Chef Infra Server, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife diff
</code></pre></div>
<p><strong>Compare, then return results</strong></p> <p>To diff a node named <code>node-lb</code> and then only return files that have been added, deleted, modified, or changed, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife diff --name-status node-lb
</code></pre></div>
<p>to return something like:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">node-lb/recipes/eip.rb
node-lb/recipes/heartbeat-int.rb
node-lb/templates/default/corpsite.conf.erb
node-lb/files/default/wildcard.node.com.crt
node-lb/files/default/wildcard.node.com.crt-2009
node-lb/files/default/wildcard.node.com.key
node-lb/.gitignore
node-lb/Rakefile
</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/workstation/knife_diff/" class="_attribution-link">https://docs.chef.io/workstation/knife_diff/</a>
  </p>
</div>
