<div id="col-content" data-swiftype-index="true"> <div id="knife-upload"><h1>knife upload</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-workstation/blob/main/docs-chef-io/content/workstation/knife_upload.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>knife upload</code> subcommand to upload data to the Chef Infra Server from the current working directory in the chef-repo. The following types of data may be uploaded with this subcommand:</p> <ul> <li>Cookbooks</li> <li>Data bags</li> <li>Roles stored as JSON data</li> <li>Environments stored as JSON data</li> </ul> <p>(Roles and environments stored as Ruby data will not be uploaded.) This subcommand is often used in conjunction with <code>knife diff</code>, which can be used to see exactly what changes will be uploaded, and then <code>knife download</code>, which does the opposite of <code>knife upload</code>.</p> <h2 id="syntax">Syntax</h2> <p>This subcommand has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload <span style="color:#666">[</span>PATTERN...<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h2 id="options">Options</h2> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Review the list of <a href="../knife_options/index.html">common options</a> available to this (and all) knife subcommands and plugins. </div> </div> <p>This subcommand has the following options:</p> <dl> <dt><code>--chef-repo-path PATH</code></dt> <dd> <p>The path to the chef-repo. This setting will override the default path to the chef-repo. Default: same value as specified by <code>chef_repo_path</code> in client.rb.</p> </dd> <dt><code>--concurrency</code></dt> <dd> <p>The number of allowed concurrent connections. Default: <code>10</code>.</p> </dd> <dt><code>--[no-]diff</code></dt> <dd> <p>Upload only new and modified files. Set to <code>false</code> to upload all files. Default: <code>true</code>.</p> </dd> <dt><code>--[no-]force</code></dt> <dd> <p>Use <code>--force</code> to upload roles, cookbooks, etc. even if the file in the directory is identical (by default, no <code>POST</code> or <code>PUT</code> is performed unless an actual change would be made). Default: <code>--no-force</code>.</p> </dd> <dt><code>--[no-]freeze</code></dt> <dd> <p>Require changes to a cookbook be included as a new version. Only the <code>--force</code> option can override this setting. Default: <code>false</code>.</p> </dd> <dt>
<code>-n</code>, <code>--dry-run</code>
</dt> <dd> <p>Take no action and only print out results. Default: <code>false</code>.</p> </dd> <dt><code>--[no-]purge</code></dt> <dd> <p>Use <code>--purge</code> to delete roles, cookbooks, etc. from the Chef Infra Server if their corresponding files do not exist in the chef-repo. By default, such objects are left alone and NOT purged. Default: <code>--no-purge</code>.</p> </dd> <dt><code>--[no-]recurse</code></dt> <dd> <p>Use <code>--no-recurse</code> to disable uploading a directory recursively. Default: <code>--recurse</code>.</p> </dd> <dt><code>--repo-mode MODE</code></dt> <dd> <p>The layout of the local chef-repo. Possible values: <code>static</code>, <code>everything</code>, or <code>hosted_everything</code>. Use <code>static</code> for just roles, environments, cookbooks, and data bags. By default, <code>everything</code> and <code>hosted_everything</code> are dynamically selected depending on the server type. Default: <code>everything</code> / <code>hosted_everything</code>.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h2 id="examples">Examples</h2> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Upload the entire chef-repo</strong></p> <p>Browse to the top level of the chef-repo and enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload .
</code></pre></div>
<p>or from anywhere in the chef-repo, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload /
</code></pre></div>
<p>to upload all cookbooks and data bags, plus all roles and environments that are stored as JSON data. (Roles and environments stored as Ruby data will not be uploaded.)</p> <p><strong>Upload the /cookbooks directory</strong></p> <p>Browse to the top level of the chef-repo and enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload cookbooks
</code></pre></div>
<p>or from anywhere in the chef-repo, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload /cookbooks
</code></pre></div>
<p><strong>Upload the /environments directory</strong></p> <p>Browse to the top level of the chef-repo and enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload environments
</code></pre></div>
<p>or from anywhere in the chef-repo, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload /environments
</code></pre></div>
<p>to upload all environments that are stored as JSON data. (Environments stored as Ruby data will not be uploaded.)</p> <p><strong>Upload a single environment</strong></p> <p>Browse to the top level of the chef-repo and enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload environments/production.json
</code></pre></div>
<p>or from the <code>environments/</code> directory, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload production.json
</code></pre></div>
<p><strong>Upload the /roles directory</strong></p> <p>Browse to the top level of the chef-repo and enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload roles
</code></pre></div>
<p>or from anywhere in the chef-repo, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload /roles
</code></pre></div>
<p>to upload all roles that are stored as JSON data. (Roles stored as Ruby data will not be uploaded.)</p> <p><strong>Upload cookbooks and roles</strong></p> <p>Browse to the top level of the chef-repo and enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload cookbooks/apache<span style="color:#4070a0;font-weight:700">\*</span> roles/webserver.json
</code></pre></div>
<p><strong>Use output of knife deps to pass command to knife upload</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife upload <span style="color:#4070a0">`</span>knife deps nodes/*.json<span style="color:#4070a0">`</span>
</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/workstation/knife_upload/" class="_attribution-link">https://docs.chef.io/workstation/knife_upload/</a>
  </p>
</div>
