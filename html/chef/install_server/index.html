<div id="col-content" data-swiftype-index="true"> <div id="install-the-chef-infra-server"><h1>Install the Chef Infra Server</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-server/blob/main/docs-chef-io/content/server/install_server.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>There are three configuration scenarios for the Chef Infra Server:</p> <ul> <li>
<a href="#standalone">Standalone</a> (everything on a single machine)</li> <li>
<a href="#high-availability">High availability</a> (machines configured for front-end and back-end, allowing for failover on the back-end and load-balancing on the front-end, as required)</li> <li>
<a href="#tiered-single-backend">Tiered</a> (machines configured for front-end and back-end, with a single back-end and load-balancing on the front-end, as required)</li> </ul> <h2 id="supported-platforms">Supported Platforms</h2> <p>The following table lists the commercially-supported platforms and versions for the Chef Infra Server:</p> <table> <col style="width:56%"> <col style="width:20%"> <col style="width:24%"> <thead> <tr class="header"> <th>Platform</th> <th>Architecture</th> <th>Version</th> </tr> </thead> <tbody> <tr> <td>Amazon Linux 2</td> <td><code>x86_64</code></td> <td><code>2.x</code></td> </tr> <tr> <td>CentOS</td> <td><code>x86_64</code></td> <td>
<code>7.x</code>, <code>8.x</code>
</td> </tr> <tr> <td>Oracle Enterprise Linux</td> <td><code>x86_64</code></td> <td>
<code>7.x</code>, <code>8.x</code>
</td> </tr> <tr> <td>Red Hat Enterprise Linux</td> <td><code>x86_64</code></td> <td>
<code>7.x</code>, <code>8.x</code>
</td> </tr> <tr> <td>SUSE Enterprise Linux Server</td> <td><code>x86_64</code></td> <td>
<code>12.x</code>, <code>15.x</code>
</td> </tr> <tr> <td>Ubuntu</td> <td><code>x86_64</code></td> <td>
<code>16.04</code>, <code>18.04</code>, <code>20.04</code>
</td> </tr> </tbody> </table> <h2 id="prerequisites">Prerequisites</h2> <p>The Chef Infra Server has the following prerequisites:</p> <ul> <li>An x86_64 compatible system architecture; Red Hat Enterprise Linux and CentOS may require updates prior to installation</li> <li>A resolvable hostname that is specified using a FQDN or an IP address</li> <li>A connection to Network Time Protocol (NTP) to prevent clock drift</li> <li>If host-based firewalls (iptables, ufw, etc.) are being used, ensure that ports 80 and 443 are open. See the <a href="../server/install_server_pre/index.html#firewalls">firewalls</a> section of the install prerequisites for additional details.</li> <li>A local mail transfer agent that allows the Chef Infra Server to send email notifications</li> <li>Using cron and the <code>/etc/cron.d</code> directory for periodic maintenance tasks</li> <li>Disabling the Apache Qpid daemon on CentOS and Red Hat systems. See the <a href="../server/install_server_pre/index.html#apache-qpid">Apache Qpid</a> of the prerequisite documentation for detailed steps.</li> <li>Optional. A local user account under which services will run, a local user account for PostgreSQL, and a group account under which services will run. See <a href="../server/install_server_pre/index.html#uids-and-gids">UIDs and GIDs</a> for more information.</li> </ul> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See the <a href="../server/install_server_pre/index.html">expanded list of prerequisites</a> for a detailed list of software and hardware requirements. </div> </div> <h2 id="standalone">Standalone</h2> <p>The standalone installation of Chef Infra Server creates a working installation on a single server. This installation is also useful when you are installing Chef Infra Server in a virtual machine, for proof-of-concept deployments, or as a part of a development or testing loop.</p> <p>To install Chef Infra Server:</p> <ol> <li> <p>Download the package from <a href="https://downloads.chef.io/chef-server/">https://downloads.chef.io/chef-server/</a>.</p> </li> <li> <p>Upload the package to the machine that will run the Chef Infra Server, and then record its location on the file system. The rest of these steps assume this location is in the <code>/tmp</code> directory.</p> </li> <li> <p>As a root user, install the Chef Infra Server package on the server, using the name of the package provided by Chef. For Red Hat Enterprise Linux and CentOS:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo rpm -Uvh /tmp/chef-server-core-&lt;version&gt;.rpm
</code></pre></div>
<p>For Ubuntu:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo dpkg -i /tmp/chef-server-core-&lt;version&gt;.deb
</code></pre></div>
<p>After a few minutes, the Chef Infra Server will be installed.</p> </li> <li> <p>Run the following to start all of the services:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl reconfigure
</code></pre></div>
<p>Because the Chef Infra Server is composed of many different services that work together to create a functioning system, this step may take a few minutes to complete.</p> </li> <li> <p>Run the following command to create an administrator:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl user-create USER_NAME FIRST_NAME LAST_NAME EMAIL <span style="color:#4070a0">'PASSWORD'</span> --filename FILE_NAME
</code></pre></div>
<p>An RSA private key is generated automatically. This is the user’s private key and should be saved to a safe location. The <code>--filename</code> option will save the RSA private key to the specified absolute path.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl user-create janedoe Jane Doe janed@example.com <span style="color:#4070a0">'abc123'</span> --filename /path/to/janedoe.pem
</code></pre></div> </li> <li> <p>Run the following command to create an organization:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl org-create short_name <span style="color:#4070a0">'full_organization_name'</span> --association_user user_name --filename ORGANIZATION-validator.pem
</code></pre></div>
<p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl org-create 4thcafe <span style="color:#4070a0">'Fourth Cafe, Inc.'</span> --association_user janedoe --filename /path/to/4thcafe-validator.pem
</code></pre></div>
<p>The name must begin with a lower-case letter or digit, may only contain lower-case letters, digits, hyphens, and underscores, and must be between 1 and 255 characters. For example: <code>4thcafe</code>.</p> <p>The full name must begin with a non-white space character and must be between 1 and 1023 characters. For example: <code>'Fourth Cafe, Inc.'</code>.</p> <p>The <code>--association_user</code> option will associate the <code>user_name</code> with the <code>admins</code> security group on the Chef Infra Server.</p> <p>An RSA private key is generated automatically. This is the chef-validator key and should be saved to a safe location. The <code>--filename</code> option will save the RSA private key to the specified absolute path.</p> </li> </ol> <h2 id="update-configuration-for-purchased-nodes">Update Configuration for Purchased Nodes</h2> <p>To use more than 25 nodes, you’ll need to change Chef Infra Server configuration for the server to recognize your purchased licenses. Edit your <code>/etc/opscode/chef-server.rb</code> file by following the process below:</p> <ol> <li> <p>On your Chef Infra Server, if the <code>chef-server.rb</code> file does not exist, create it.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo mkdir /etc/opscode <span style="color:#666">&amp;&amp;</span> sudo touch /etc/opscode/chef-server.rb
</code></pre></div>
</li> <li> <p>Open up the newly created <code>chef-server.rb</code> file in your favorite text editor, for example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo vi /etc/opscode/chef-server.rb
</code></pre></div>
</li> <li> <p>Paste or add the following text. Please note the placement of the single quotation (') marks. If you’re using the vi text editor, you’ll need to use the <span class="title-ref">i</span> key to insert the text.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">license<span style="color:#666">[</span><span style="color:#4070a0">'nodes'</span><span style="color:#666">]</span> <span style="color:#666">=</span> N where N is the number of licensed nodes you have purchased
</code></pre></div>
</li> <li> <p>Save the file. If you’re using vi, from the example above, use the <span class="title-ref">esc</span> key and then:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">:wq
</code></pre></div>
</li> <li> <p>Run <code>chef-server-ctl reconfigure</code> for the changes to be picked up by your Chef Infra Server.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">sudo chef-server-ctl reconfigure
</code></pre></div>
</li> </ol> <p>For more information on configuring your Chef Infra Server, see <a href="../server/config_rb_server/index.html">chef-server.rb Settings</a> and <a href="../server/config_rb_server_optional_settings/index.html">chef-server.rb Optional Settings</a>.</p> <h2 id="high-availability">High Availability</h2> <p>The following links describe how to configure the Chef Infra Server for high availability. The <strong>Backend Cluster</strong> setup is strongly recommended for new installations:</p> <ul> <li><a href="../server/install_server_ha/index.html">High Availability using Backend Cluster</a></li> </ul> <h2 id="tiered-single-backend">Tiered (Single Backend)</h2> <p>The following link describes how to configure the Chef Infra Server with a single backend machine and multiple frontend machines. Note that this process has been deprecated in favor of a <a href="../server/install_server_ha/index.html">Backend Cluster</a> setup:</p> <ul> <li><a href="../server/install_server_tiered/index.html">Tiered Installation</a></li> </ul> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/install_server/" class="_attribution-link">https://docs.chef.io/install_server/</a>
  </p>
</div>
