<div id="col-content" data-swiftype-index="true"> <div id="chef-and-google"><h1>Chef and Google</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/google.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Google Cloud Platform is a suite of cloud computing services that run on the same infrastructure that Google uses internally for its end-user products, such as Google Search and YouTube. Alongside a set of management tools, it provides a series of modular cloud services including computing, data storage, data analytics, and machine learning. This page outlines the different tools that can be used to integrate Chef with the Google Cloud Platform.</p> <h2 id="knife-google">knife-google</h2> <p><a href="https://github.com/chef/knife-google">[GitHub]</a></p> <p>This plugin gives knife the ability to create, bootstrap, and manage Google Compute Engine (GCE) instances.</p> <h3 id="authentication-and-authorization">Authentication and Authorization</h3> <p><code>knife-google</code> relies on the Google Auth Library to handle authentication to the Google Cloud API. The auth library expects to find a JSON credentials file located under <code>~/.config/gcloud/application_default_credentials.json</code>.</p> <p>The easiest way to create this is to download and install the <a href="https://cloud.google.com/sdk/">Google Cloud SDK</a> and run the <code>gcloud auth application-default login</code> command, which will create the credentials file for you.</p> <p>If you already have a file youâ€™d like to use that is in a different location, set the <code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable with the full path to that file.</p> <p>These are the necessary settings for your <code>config.rb</code> file:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">knife<span style="color:#666">[</span><span style="color:#517918">:gce_project</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">'my-test-project'</span>
knife<span style="color:#666">[</span><span style="color:#517918">:gce_zone</span><span style="color:#666">]</span>    <span style="color:#666">=</span> <span style="color:#4070a0">'us-east1-b'</span>
</code></pre></div>
<h3 id="usage-examples">Usage Examples</h3> <p><strong>Create a server:</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife google server create test-instance-1 --gce-image centos-7-v20160219 <span style="color:#4070a0;font-weight:700">\
</span>--gce-machine-type n1-standard-2 --gce-public-ip ephemeral --connection-user myuser <span style="color:#4070a0;font-weight:700">\
</span>--identity-file /Users/myuser/.ssh/google_compute_engine
</code></pre></div>
<p><strong>Delete multiple servers:</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife google server delete my-instance-1 my-instance-2 --purge
</code></pre></div>
<p><strong>List all servers:</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife google server list
</code></pre></div>
<h2 id="kitchen-google">kitchen-google</h2> <p><a href="https://github.com/test-kitchen/kitchen-google">[GitHub]</a></p> <p>A test kitchen driver for Google Cloud Platform.</p> <h3 id="usage-examples-1">Usage Examples</h3> <p>The following is a basic <code>kitchen.yml</code> example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-yaml" data-lang="yaml"><span style="color:#0e84b5;font-weight:700">---</span><span style="color:#062873;font-weight:700">driver</span>:<span style="color:#062873;font-weight:700">name</span>:gce<span style="color:#062873;font-weight:700">project</span>:mycompany-test<span style="color:#062873;font-weight:700">zone</span>:us-east1-c<span style="color:#062873;font-weight:700">email</span>:me@mycompany.com<span style="color:#062873;font-weight:700">tags</span>:- devteam- test-kitchen<span style="color:#062873;font-weight:700">service_account_scopes</span>:- devstorage.read_write- userinfo.email<span style="color:#062873;font-weight:700">provisioner</span>:<span style="color:#062873;font-weight:700">name</span>:chef_zero<span style="color:#062873;font-weight:700">transport</span>:<span style="color:#062873;font-weight:700">username</span>:chefuser<span style="color:#062873;font-weight:700">platforms</span>:- <span style="color:#062873;font-weight:700">name</span>:centos-7<span style="color:#062873;font-weight:700">driver</span>:<span style="color:#062873;font-weight:700">image_project</span>:centos-cloud<span style="color:#062873;font-weight:700">image_name</span>:centos-7-v20170124- <span style="color:#062873;font-weight:700">name</span>:ubuntu-18.04<span style="color:#062873;font-weight:700">driver</span>:<span style="color:#062873;font-weight:700">image_project</span>:ubuntu-os-cloud<span style="color:#062873;font-weight:700">image_family</span>:ubuntu-1804-lts- <span style="color:#062873;font-weight:700">name</span>:windows<span style="color:#062873;font-weight:700">driver</span>:<span style="color:#062873;font-weight:700">image_project</span>:windows-cloud<span style="color:#062873;font-weight:700">image_name</span>:windows-server-2012-r2-dc-v20170117<span style="color:#062873;font-weight:700">disk_size</span>:<span style="color:#40a070">50</span><span style="color:#062873;font-weight:700">suites</span>:- <span style="color:#062873;font-weight:700">name</span>:default<span style="color:#062873;font-weight:700">run_list</span>:- recipe[COOKBOOK::default]<span style="color:#062873;font-weight:700">attributes</span>:</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/google/" class="_attribution-link">https://docs.chef.io/google/</a>
  </p>
</div>
