<div id="col-content" data-swiftype-index="true"> <div id="airgapped-installation"><h1>Airgapped Installation</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/automate/blob/master/components/docs-chef-io/content/automate/airgapped_installation.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <h2 id="overview">Overview</h2> <p>An airgapped host is one that has no direct inbound or outbound internet traffic. To install or upgrade Chef Automate on an airgapped host, you will need to create an Airgap Installation Bundle (<code>.aib</code>) on an internet-connected host and then transfer both the Airgap Installation Bundle and the <code>chef-automate</code> binary that you used to create it to the airgapped host for use.</p> <h2 id="get-a-license">Get a License</h2> <p>To get a trial license for an airgapped host <a href="https://www.chef.io/contact-us/">contact Chef</a>.</p> <h2 id="create-an-airgap-installation-bundle">Create an Airgap Installation Bundle</h2> <p>On an internet-connected host, download the Chef Automate command-line tool and use it to prepare an Airgap Installation Bundle.</p> <h3 id="get-chef-automate-installer-and-admin-tool">Get Chef Automate Installer and Admin Tool</h3> <p>Download the Chef Automate command-line tool from the <code>current</code> <a href="../install/index.html#release-channels">release channel</a>.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">curl https://packages.chef.io/files/current/latest/chef-automate-cli/chef-automate_linux_amd64.zip | gunzip - &gt; chef-automate <span style="color:#666">&amp;&amp;</span> chmod +x chef-automate
</code></pre></div>
<h3 id="prepare-airgap-installation-bundle">Prepare Airgap Installation Bundle</h3> <p>To download and bundle the software included in the most recent Chef Automate release, run:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">./chef-automate airgap bundle create
</code></pre></div>
<p>To download and bundle the software included in a specific Chef Automate release, run</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">./chef-automate airgap bundle create --version VERSION
</code></pre></div>
<p>These commands produce an Airgap Installation Bundle named:</p> <p><code>automate-&lt;timestamp&gt;.aib</code>.</p> <h2 id="deploy-the-airgap-installation-bundle">Deploy the Airgap Installation Bundle</h2> <p>Transfer the <code>chef-automate</code> binary and the Airgap Installation Bundle to the airgapped host. Save the Chef Automate command-line tool in a directory that is not in your <code>$PATH</code>. The Chef Automate installation process puts a copy of <code>chef-automate</code> into <code>/bin</code> and manages it.</p> <h3 id="create-default-configuration">Create Default Configuration</h3> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">sudo ./chef-automate init-config --upgrade-strategy none
</code></pre></div>
<p>creates a <code>config.toml</code> file with default values. Setting an upgrade strategy of <code>none</code> prevents Chef Automate from checking its release channel for updates via the internet.</p> <p>Edit <code>config.toml</code> to make changes to FQDN and other configuration settings. See <a href="../configuration/index.html">Configuring Chef Automate</a> for more information on configuration settings.</p> <h3 id="deploy-chef-automate">Deploy Chef Automate</h3> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">sudo ./chef-automate deploy config.toml --airgap-bundle &lt;/path/to/airgap-install-bundle&gt;
</code></pre></div>
<p>Deploying Chef Automate takes ten minutes for a clean install. At the command prompt, accept the terms of service with a <code>y</code>, The installer then performs a series of pre-flight checks. Any unsuccessful checks offer information for resolving issues or skipping the check. After resolving any pre-flight issues, run the deploy command again.</p> <p>At the end of the deployment process you will see:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">Deploy <span style="color:#007020">complete</span>
</code></pre></div>
<p>The deployment process writes login credentials to the <code>automate-credentials.toml</code> in your current working directory.</p> <h3 id="open-chef-automate">Open Chef Automate</h3> <p>Navigate to <code>https://automate.example.com</code> in a browser and log in to Chef Automate with the credentials provided in <code>automate-credentials.toml</code>.</p> <p>Once you log in, Chef Automate prompts you for a license.</p> <h4 id="configure-data-collection">Configure Data Collection</h4> <p>To send data from your Chef Infra Server or Chef Infra Clients to Chef Automate 2, the process is the same as Chef Automate 1. See <a href="../data_collection/index.html">Configure Data Collection</a> for more information.</p> <h3 id="upgrades">Upgrades</h3> <p>Chef is committed to ensuring the stability of the upgrade and to supporting Chef Automate automatic upgrades.</p> <p>To upgrade an airgapped installation, you must first create an airgap bundle.</p> <p>Follow the steps in <a href="#create-an-airgap-installation-bundle">Create an Airgap Installation Bundle</a> on a machine that connects to the internet to upgrade your Chef Automate command-line tool and prepare an Airgap Installation Bundle. Transfer the bundle and Chef Automate command-line tool to the airgapped host and run:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">sudo chef-automate upgrade run --airgap-bundle &lt;/path/to/bundle&gt;
</code></pre></div>
<h3 id="common-problems">Common Problems</h3> <p>If you are unable to open Chef Automate, check that the <code>config.toml</code> lists the hostâ€™s public DNS name as the FQDN.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell"><span style="color:#60a0b0;font-style:italic"># This is a default Chef Automate configuration file. You can run</span>
<span style="color:#60a0b0;font-style:italic"># 'chef-automate deploy' with this config file and it should</span>
<span style="color:#60a0b0;font-style:italic"># successfully create a new Chef Automate instance with default settings.</span>

<span style="color:#666">[</span>global.v1<span style="color:#666">]</span>
<span style="color:#60a0b0;font-style:italic"># The external fully qualified domain name.</span>
<span style="color:#60a0b0;font-style:italic"># When the application is deployed you should be able to access 'https://&lt;fqdn&gt;/'</span>
<span style="color:#60a0b0;font-style:italic"># to login.</span>
<span style="color:#bb60d5">fqdn</span> <span style="color:#666">=</span> <span style="color:#4070a0">"&lt;_Public DNS_name_&gt;"</span>
</code></pre></div>
<p>Once you correct and save the FQDN, run</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-shell" data-lang="shell">sudo chef-automate config patch config.toml
</code></pre></div>
<p>and retry opening Chef Automate in your browser.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/automate/airgapped_installation/" class="_attribution-link">https://docs.chef.io/automate/airgapped_installation/</a>
  </p>
</div>
