<h1 id="using-galaxy">Galaxy User Guide</h1> <p id="galaxy-user-guide"><em class="dfn">Ansible Galaxy</em> refers to the <a class="reference external" href="https://galaxy.ansible.com">Galaxy</a> website, a free site for finding, downloading, and sharing community developed roles.</p> <p>Use Galaxy to jump-start your automation project with great content from the Ansible community. Galaxy provides pre-packaged units of work such as <a class="reference internal" href="../user_guide/playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">roles</span></a>, and new in Galaxy 3.2, <a class="reference internal" href="../user_guide/collections_using.html#collections"><span class="std std-ref">collections</span></a> You can find roles for provisioning infrastructure, deploying applications, and all of the tasks you do everyday. The collection format provides a comprehensive package of automation that may include multiple playbooks, roles, modules, and plugins.</p>  <ul class="simple"> <li><a class="reference internal" href="#finding-collections-on-galaxy" id="id6">Finding collections on Galaxy</a></li> <li>
<p><a class="reference internal" href="#installing-collections" id="id7">Installing collections</a></p> <ul> <li><a class="reference internal" href="#installing-a-collection-from-galaxy" id="id8">Installing a collection from Galaxy</a></li> <li><a class="reference internal" href="#downloading-a-collection-from-automation-hub" id="id9">Downloading a collection from Automation Hub</a></li> <li><a class="reference internal" href="#installing-an-older-version-of-a-collection" id="id10">Installing an older version of a collection</a></li> <li><a class="reference internal" href="#install-multiple-collections-with-a-requirements-file" id="id11">Install multiple collections with a requirements file</a></li> <li><a class="reference internal" href="#downloading-a-collection-for-offline-use" id="id12">Downloading a collection for offline use</a></li> <li><a class="reference internal" href="#installing-a-collection-from-a-git-repository" id="id13">Installing a collection from a git repository</a></li> <li><a class="reference internal" href="#listing-installed-collections" id="id14">Listing installed collections</a></li> <li><a class="reference internal" href="#configuring-the-ansible-galaxy-client" id="id15">Configuring the <code>ansible-galaxy</code> client</a></li> </ul> </li> <li>
<p><a class="reference internal" href="#finding-roles-on-galaxy" id="id16">Finding roles on Galaxy</a></p> <ul> <li><a class="reference internal" href="#get-more-information-about-a-role" id="id17">Get more information about a role</a></li> </ul> </li> <li>
<p><a class="reference internal" href="#installing-roles-from-galaxy" id="id18">Installing roles from Galaxy</a></p> <ul> <li><a class="reference internal" href="#installing-roles" id="id19">Installing roles</a></li> <li><a class="reference internal" href="#installing-a-specific-version-of-a-role" id="id20">Installing a specific version of a role</a></li> <li><a class="reference internal" href="#installing-multiple-roles-from-a-file" id="id21">Installing multiple roles from a file</a></li> <li><a class="reference internal" href="#installing-roles-and-collections-from-the-same-requirements-yml-file" id="id22">Installing roles and collections from the same requirements.yml file</a></li> <li><a class="reference internal" href="#installing-multiple-roles-from-multiple-files" id="id23">Installing multiple roles from multiple files</a></li> <li><a class="reference internal" href="#dependencies" id="id24">Dependencies</a></li> <li><a class="reference internal" href="#list-installed-roles" id="id25">List installed roles</a></li> <li><a class="reference internal" href="#remove-an-installed-role" id="id26">Remove an installed role</a></li> </ul> </li> </ul>   <h2 id="finding-galaxy-collections">Finding collections on Galaxy</h2> <p id="finding-collections-on-galaxy">To find collections on Galaxy:</p> <ol class="arabic simple"> <li>Click the <span class="guilabel">Search</span> icon in the left-hand navigation.</li> <li>Set the filter to <em>collection</em>.</li> <li>Set other filters and press <span class="guilabel">enter</span>.</li> </ol> <p>Galaxy presents a list of collections that match your search criteria.</p>   <h2 id="installing-galaxy-collections">Installing collections</h2>  <h3 id="installing-collections">Installing a collection from Galaxy</h3> <p>By default, <code>ansible-galaxy collection install</code> uses <a class="reference external" href="https://galaxy.ansible.com">https://galaxy.ansible.com</a> as the Galaxy server (as listed in the <code>ansible.cfg</code> file under <a class="reference internal" href="../reference_appendices/config.html#galaxy-server"><span class="std std-ref">GALAXY_SERVER</span></a>). You do not need any further configuration.</p> <p>See <a class="reference internal" href="../user_guide/collections_using.html#galaxy-server-config"><span class="std std-ref">Configuring the ansible-galaxy client</span></a> if you are using any other Galaxy server, such as Red Hat Automation Hub.</p> <p>To install a collection hosted in Galaxy:</p> <pre data-language="bash">ansible-galaxy collection install my_namespace.my_collection
</pre> <p>To upgrade a collection to the latest available version from the Galaxy server you can use the <code>--upgrade</code> option:</p> <pre data-language="bash">ansible-galaxy collection install my_namespace.my_collection --upgrade
</pre> <p>You can also directly use the tarball from your build:</p> <pre data-language="bash">ansible-galaxy collection install my_namespace-my_collection-1.0.0.tar.gz -p ./collections
</pre> <p>You can build and install a collection from a local source directory. The <code>ansible-galaxy</code> utility builds the collection using the <code>MANIFEST.json</code> or <code>galaxy.yml</code> metadata in the directory.</p> <pre data-language="bash">ansible-galaxy collection install /path/to/collection -p ./collections
</pre> <p>You can also install multiple collections in a namespace directory.</p> <pre data-language="text">ns/
├── collection1/
│   ├── MANIFEST.json
│   └── plugins/
└── collection2/
    ├── galaxy.yml
    └── plugins/
</pre> <pre data-language="bash">ansible-galaxy collection install /path/to/ns -p ./collections
</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The install command automatically appends the path <code>ansible_collections</code> to the one specified with the <code>-p</code> option unless the parent directory is already in a folder called <code>ansible_collections</code>.</p> </div> <p>When using the <code>-p</code> option to specify the install path, use one of the values configured in <a class="reference internal" href="../reference_appendices/config.html#collections-paths"><span class="std std-ref">COLLECTIONS_PATHS</span></a>, as this is where Ansible itself will expect to find collections. If you don’t specify a path, <code>ansible-galaxy collection install</code> installs the collection to the first path defined in <a class="reference internal" href="../reference_appendices/config.html#collections-paths"><span class="std std-ref">COLLECTIONS_PATHS</span></a>, which by default is <code>~/.ansible/collections</code></p> <p>You can also keep a collection adjacent to the current playbook, under a <code>collections/ansible_collections/</code> directory structure.</p> <pre data-language="text">./
├── play.yml
├── collections/
│   └── ansible_collections/
│               └── my_namespace/
│                   └── my_collection/&lt;collection structure lives here&gt;
</pre> <p>See <a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_collections_structure.html#collection-structure"><span class="std std-ref">Collection structure</span></a> for details on the collection directory structure.</p>   <h3 id="installing-ah-collection">Downloading a collection from Automation Hub</h3> <p id="downloading-a-collection-from-automation-hub">You can download collections from Automation Hub at the command line. Automation Hub content is available to subscribers only, so you must download an API token and configure your local environment to provide it before you can you download collections. To download a collection from Automation Hub with the <code>ansible-galaxy</code> command:</p> <ol class="arabic simple"> <li>Get your Automation Hub API token. Go to <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/token/">https://cloud.redhat.com/ansible/automation-hub/token/</a> and click <span class="guilabel">Get API token</span> from the version dropdown to copy your API token.</li> <li>Configure Red Hat Automation Hub server in the <code>server_list</code> option under the <code>[galaxy]</code> section in your <code>ansible.cfg</code> file.</li> </ol>  <pre data-language="ini">[galaxy]
server_list = automation_hub

[galaxy_server.automation_hub]
url=https://cloud.redhat.com/api/automation-hub/
auth_url=https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token
token=my_ah_token
</pre>  <ol class="arabic simple" start="3"> <li>Download the collection hosted in Automation Hub.</li> </ol>  <pre data-language="bash">ansible-galaxy collection install my_namespace.my_collection
</pre>  <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference external" href="https://www.ansible.com/blog/getting-started-with-ansible-hub">Getting started with Automation Hub</a></dt>
<dd>
<p>An introduction to Automation Hub</p> </dd> </dl> </div>   <h3 id="installing-an-older-version-of-a-collection">Installing an older version of a collection</h3> <p>You can only have one version of a collection installed at a time. By default <code>ansible-galaxy</code> installs the latest available version. If you want to install a specific version, you can add a version range identifier. For example, to install the 1.0.0-beta.1 version of the collection:</p> <pre data-language="bash">ansible-galaxy collection install my_namespace.my_collection:==1.0.0-beta.1
</pre> <p>You can specify multiple range identifiers separated by <code>,</code>. Use single quotes so the shell passes the entire command, including <code>&gt;</code>, <code>!</code>, and other operators, along. For example, to install the most recent version that is greater than or equal to 1.0.0 and less than 2.0.0:</p> <pre data-language="bash">ansible-galaxy collection install 'my_namespace.my_collection:&gt;=1.0.0,&lt;2.0.0'
</pre> <p>Ansible will always install the most recent version that meets the range identifiers you specify. You can use the following range identifiers:</p> <ul class="simple"> <li>
<code>*</code>: The most recent version. This is the default.</li> <li>
<code>!=</code>: Not equal to the version specified.</li> <li>
<code>==</code>: Exactly the version specified.</li> <li>
<code>&gt;=</code>: Greater than or equal to the version specified.</li> <li>
<code>&gt;</code>: Greater than the version specified.</li> <li>
<code>&lt;=</code>: Less than or equal to the version specified.</li> <li>
<code>&lt;</code>: Less than the version specified.</li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>By default <code>ansible-galaxy</code> ignores pre-release versions. To install a pre-release version, you must use the <code>==</code> range identifier to require it explicitly.</p> </div>   <h3 id="install-multiple-collections-with-a-requirements-file">Install multiple collections with a requirements file</h3> <p>You can set up a <code>requirements.yml</code> file to install multiple collections in one command. This file is a YAML file in the format:</p> <pre data-language="yaml+jinja">---
collections:
# With just the collection name
- my_namespace.my_collection

# With the collection name, version, and source options
- name: my_namespace.my_other_collection
  version: 'version range identifiers (default: ``*``)'
  source: 'The Galaxy URL to pull the collection from (default: ``--api-server`` from cmdline)'
</pre> <p>You can specify four keys for each collection entry:</p>  <ul class="simple"> <li><code>name</code></li> <li><code>version</code></li> <li><code>source</code></li> <li><code>type</code></li> </ul>  <p>The <code>version</code> key uses the same range identifier format documented in <a class="reference internal" href="../user_guide/collections_using.html#collections-older-version"><span class="std std-ref">Installing an older version of a collection</span></a>.</p> <p>The <code>type</code> key can be set to <code>galaxy</code>, <code>url</code>, <code>file</code>, and <code>git</code>. If <code>type</code> is omitted, the <code>name</code> key is used to implicitly determine the source of the collection.</p> <p>When you install a collection with <code>type: git</code>, the <code>version</code> key can refer to a branch or to a <a class="reference external" href="https://git-scm.com/docs/gitglossary#def_commit-ish">git commit-ish</a> object (commit or tag). For example:</p> <pre data-language="yaml">collections:
  - name: https://github.com/organization/repo_name.git
    type: git
    version: devel
</pre> <p>You can also add roles to a <code>requirements.yml</code> file, under the <code>roles</code> key. The values follow the same format as a requirements file used in older Ansible releases.</p> <pre data-language="yaml">---
roles:
  # Install a role from Ansible Galaxy.
  - name: geerlingguy.java
    version: 1.9.6

collections:
  # Install a collection from Ansible Galaxy.
  - name: geerlingguy.php_roles
    version: 0.9.3
    source: https://galaxy.ansible.com
</pre> <p>To install both roles and collections at the same time with one command, run the following:</p> <pre data-language="bash">$ ansible-galaxy install -r requirements.yml
</pre> <p>Running <code>ansible-galaxy collection install -r</code> or <code>ansible-galaxy role install -r</code> will only install collections, or roles respectively.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Installing both roles and collections from the same requirements file will not work when specifying a custom collection or role install path. In this scenario the collections will be skipped and the command will process each like <code>ansible-galaxy role install</code> would.</p> </div>   <h3 id="downloading-a-collection-for-offline-use">Downloading a collection for offline use</h3> <p>To download the collection tarball from Galaxy for offline use:</p> <ol class="arabic simple"> <li>Navigate to the collection page.</li> <li>Click on <span class="guilabel">Download tarball</span>.</li> </ol> <p>You may also need to manually download any dependent collections.</p>   <h3 id="installing-a-collection-from-a-git-repository">Installing a collection from a git repository</h3> <p>You can install a collection from a git repository instead of from Galaxy or Automation Hub. As a developer, installing from a git repository lets you review your collection before you create the tarball and publish the collection. As a user, installing from a git repository lets you use collections or versions that are not in Galaxy or Automation Hub yet.</p> <p>The repository must contain a <code>galaxy.yml</code> or <code>MANIFEST.json</code> file. This file provides metadata such as the version number and namespace of the collection.</p>  <h4 id="installing-a-collection-from-a-git-repository-at-the-command-line">Installing a collection from a git repository at the command line</h4> <p>To install a collection from a git repository at the command line, use the URI of the repository instead of a collection name or path to a <code>tar.gz</code> file. Prefix the URI with <code>git+</code> (or with <code>git@</code> to use a private repository with ssh authentication). You can specify a branch, commit, or tag using the comma-separated <a class="reference external" href="https://git-scm.com/docs/gitglossary#def_commit-ish">git commit-ish</a> syntax.</p> <p>For example:</p> <pre data-language="bash"># Install a collection in a repository using the latest commit on the branch 'devel'
ansible-galaxy collection install git+https://github.com/organization/repo_name.git,devel

# Install a collection from a private github repository
ansible-galaxy collection install git@github.com:organization/repo_name.git

# Install a collection from a local git repository
ansible-galaxy collection install git+file:///home/user/path/to/repo_name.git
</pre> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Embedding credentials into a git URI is not secure. Use safe authentication options to prevent your credentials from being exposed in logs or elsewhere.</p> <ul class="simple"> <li>Use <a class="reference external" href="https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh">SSH</a> authentication</li> <li>Use <a class="reference external" href="https://linux.die.net/man/5/netrc">netrc</a> authentication</li> <li>Use <a class="reference external" href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpextraHeader">http.extraHeader</a> in your git configuration</li> <li>Use <a class="reference external" href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-urlltbasegtpushInsteadOf">url.&lt;base&gt;.pushInsteadOf</a> in your git configuration</li> </ul> </div>   <h4 id="specifying-the-collection-location-within-the-git-repository">Specifying the collection location within the git repository</h4> <p>When you install a collection from a git repository, Ansible uses the collection <code>galaxy.yml</code> or <code>MANIFEST.json</code> metadata file to build the collection. By default, Ansible searches two paths for collection <code>galaxy.yml</code> or <code>MANIFEST.json</code> metadata files:</p> <ul class="simple"> <li>The top level of the repository.</li> <li>Each directory in the repository path (one level deep).</li> </ul> <p>If a <code>galaxy.yml</code> or <code>MANIFEST.json</code> file exists in the top level of the repository, Ansible uses the collection metadata in that file to install an individual collection.</p> <pre data-language="text">├── galaxy.yml
├── plugins/
│   ├── lookup/
│   ├── modules/
│   └── module_utils/
└─── README.md
</pre> <p>If a <code>galaxy.yml</code> or <code>MANIFEST.json</code> file exists in one or more directories in the repository path (one level deep), Ansible installs each directory with a metadata file as a collection. For example, Ansible installs both collection1 and collection2 from this repository structure by default:</p> <pre data-language="text">├── collection1
│   ├── docs/
│   ├── galaxy.yml
│   └── plugins/
│       ├── inventory/
│       └── modules/
└── collection2
    ├── docs/
    ├── galaxy.yml
    ├── plugins/
    |   ├── filter/
    |   └── modules/
    └── roles/
</pre> <p>If you have a different repository structure or only want to install a subset of collections, you can add a fragment to the end of your URI (before the optional comma-separated version) to indicate the location of the metadata file or files. The path should be a directory, not the metadata file itself. For example, to install only collection2 from the example repository with two collections:</p> <pre data-language="text">ansible-galaxy collection install git+https://github.com/organization/repo_name.git#/collection2/
</pre> <p>In some repositories, the main directory corresponds to the namespace:</p> <pre data-language="text">namespace/
├── collectionA/
|   ├── docs/
|   ├── galaxy.yml
|   ├── plugins/
|   │   ├── README.md
|   │   └── modules/
|   ├── README.md
|   └── roles/
└── collectionB/
    ├── docs/
    ├── galaxy.yml
    ├── plugins/
    │   ├── connection/
    │   └── modules/
    ├── README.md
    └── roles/
</pre> <p>You can install all collections in this repository, or install one collection from a specific commit:</p> <pre data-language="bash"># Install all collections in the namespace
ansible-galaxy collection install git+https://github.com/organization/repo_name.git#/namespace/

# Install an individual collection using a specific commit
ansible-galaxy collection install git+https://github.com/organization/repo_name.git#/namespace/collectionA/,7b60ddc245bc416b72d8ea6ed7b799885110f5e5
</pre>    <h3 id="listing-installed-collections">Listing installed collections</h3> <p>To list installed collections, run <code>ansible-galaxy collection list</code>. See <a class="reference internal" href="../user_guide/collections_using.html#collections-listing"><span class="std std-ref">Listing collections</span></a> for more details.</p>   <h3 id="configuring-the-ansible-galaxy-client">Configuring the <code>ansible-galaxy</code> client</h3> <p>By default, <code>ansible-galaxy</code> uses <a class="reference external" href="https://galaxy.ansible.com">https://galaxy.ansible.com</a> as the Galaxy server (as listed in the <code>ansible.cfg</code> file under <a class="reference internal" href="../reference_appendices/config.html#galaxy-server"><span class="std std-ref">GALAXY_SERVER</span></a>).</p> <p>You can use either option below to configure <code>ansible-galaxy collection</code> to use other servers (such as Red Hat Automation Hub or a custom Galaxy server):</p> <ul class="simple"> <li>Set the server list in the <a class="reference internal" href="../reference_appendices/config.html#galaxy-server-list"><span class="std std-ref">GALAXY_SERVER_LIST</span></a> configuration option in <a class="reference internal" href="../reference_appendices/config.html#ansible-configuration-settings-locations"><span class="std std-ref">The configuration file</span></a>.</li> <li>Use the <code>--server</code> command line argument to limit to an individual server.</li> </ul> <p>To configure a Galaxy server list in <code>ansible.cfg</code>:</p> <ol class="arabic simple"> <li>Add the <code>server_list</code> option under the <code>[galaxy]</code> section to one or more server names.</li> <li>Create a new section for each server name.</li> <li>Set the <code>url</code> option for each server name.</li> <li>Optionally, set the API token for each server name. Go to <a class="reference external" href="https://galaxy.ansible.com/me/preferences">https://galaxy.ansible.com/me/preferences</a> and click <span class="guilabel">Show API key</span>.</li> </ol> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The <code>url</code> option for each server name must end with a forward slash <code>/</code>. If you do not set the API token in your Galaxy server list, use the <code>--api-key</code> argument to pass in the token to the <code>ansible-galaxy collection publish</code> command.</p> </div> <p>For Automation Hub, you additionally need to:</p> <ol class="arabic simple"> <li>Set the <code>auth_url</code> option for each server name.</li> <li>Set the API token for each server name. Go to <a class="reference external" href="https://cloud.redhat.com/ansible/automation-hub/token/">https://cloud.redhat.com/ansible/automation-hub/token/</a> and click :<span class="guilabel">Get API token</span> from the version dropdown to copy your API token.</li> </ol> <p>The following example shows how to configure multiple servers:</p> <pre data-language="ini">[galaxy]
server_list = automation_hub, my_org_hub, release_galaxy, test_galaxy

[galaxy_server.automation_hub]
url=https://cloud.redhat.com/api/automation-hub/
auth_url=https://sso.redhat.com/auth/realms/redhat-external/protocol/openid-connect/token
token=my_ah_token

[galaxy_server.my_org_hub]
url=https://automation.my_org/
username=my_user
password=my_pass

[galaxy_server.release_galaxy]
url=https://galaxy.ansible.com/
token=my_token

[galaxy_server.test_galaxy]
url=https://galaxy-dev.ansible.com/
token=my_test_token
</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>You can use the <code>--server</code> command line argument to select an explicit Galaxy server in the <code>server_list</code> and the value of this argument should match the name of the server. To use a server not in the server list, set the value to the URL to access that server (all servers in the server list will be ignored). Also you cannot use the <code>--api-key</code> argument for any of the predefined servers. You can only use the <code>api_key</code> argument if you did not define a server list or if you specify a URL in the <code>--server</code> argument.</p> </div> <p><strong>Galaxy server list configuration options</strong></p> <p>The <a class="reference internal" href="../reference_appendices/config.html#galaxy-server-list"><span class="std std-ref">GALAXY_SERVER_LIST</span></a> option is a list of server identifiers in a prioritized order. When searching for a collection, the install process will search in that order, for example, <code>automation_hub</code> first, then <code>my_org_hub</code>, <code>release_galaxy</code>, and finally <code>test_galaxy</code> until the collection is found. The actual Galaxy instance is then defined under the section <code>[galaxy_server.{{ id }}]</code> where <code>{{ id }}</code> is the server identifier defined in the list. This section can then define the following keys:</p> <ul class="simple"> <li>
<code>url</code>: The URL of the Galaxy instance to connect to. Required.</li> <li>
<code>token</code>: An API token key to use for authentication against the Galaxy instance. Mutually exclusive with <code>username</code>.</li> <li>
<code>username</code>: The username to use for basic authentication against the Galaxy instance. Mutually exclusive with <code>token</code>.</li> <li>
<code>password</code>: The password to use, in conjunction with <code>username</code>, for basic authentication.</li> <li>
<code>auth_url</code>: The URL of a Keycloak server ‘token_endpoint’ if using SSO authentication (for example, Automation Hub). Mutually exclusive with <code>username</code>. Requires <code>token</code>.</li> </ul> <p>As well as defining these server options in the <code>ansible.cfg</code> file, you can also define them as environment variables. The environment variable is in the form <code>ANSIBLE_GALAXY_SERVER_{{ id }}_{{ key }}</code> where <code>{{ id }}</code> is the upper case form of the server identifier and <code>{{ key }}</code> is the key to define. For example I can define <code>token</code> for <code>release_galaxy</code> by setting <code>ANSIBLE_GALAXY_SERVER_RELEASE_GALAXY_TOKEN=secret_token</code>.</p> <p>For operations that use only one Galaxy server (for example, the <code>publish</code>, <code>info</code>, or <code>install</code> commands). the <code>ansible-galaxy collection</code> command uses the first entry in the <code>server_list</code>, unless you pass in an explicit server with the <code>--server</code> argument.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Once a collection is found, any of its requirements are only searched within the same Galaxy instance as the parent collection. The install process will not search for a collection requirement in a different Galaxy instance.</p> </div>    <h2 id="finding-galaxy-roles">Finding roles on Galaxy</h2> <p id="finding-roles-on-galaxy">Search the Galaxy database by tags, platforms, author and multiple keywords. For example:</p> <pre data-language="bash">$ ansible-galaxy search elasticsearch --author geerlingguy
</pre> <p>The search command will return a list of the first 1000 results matching your search:</p> <pre data-language="text">Found 2 roles matching your search:

Name                              Description
----                              -----------
geerlingguy.elasticsearch         Elasticsearch for Linux.
geerlingguy.elasticsearch-curator Elasticsearch curator for Linux.
</pre>  <h3 id="get-more-information-about-a-role">Get more information about a role</h3> <p>Use the <code>info</code> command to view more detail about a specific role:</p> <pre data-language="bash">$ ansible-galaxy info username.role_name
</pre> <p>This returns everything found in Galaxy for the role:</p> <pre data-language="text">Role: username.role_name
    description: Installs and configures a thing, a distributed, highly available NoSQL thing.
    active: True
    commit: c01947b7bc89ebc0b8a2e298b87ab416aed9dd57
    commit_message: Adding travis
    commit_url: https://github.com/username/repo_name/commit/c01947b7bc89ebc0b8a2e298b87ab
    company: My Company, Inc.
    created: 2015-12-08T14:17:52.773Z
    download_count: 1
    forks_count: 0
    github_branch:
    github_repo: repo_name
    github_user: username
    id: 6381
    is_valid: True
    issue_tracker_url:
    license: Apache
    min_ansible_version: 1.4
    modified: 2015-12-08T18:43:49.085Z
    namespace: username
    open_issues_count: 0
    path: /Users/username/projects/roles
    scm: None
    src: username.repo_name
    stargazers_count: 0
    travis_status_url: https://travis-ci.org/username/repo_name.svg?branch=main
    version:
    watchers_count: 1
</pre>    <h2 id="installing-galaxy-roles">Installing roles from Galaxy</h2> <p id="installing-roles-from-galaxy">The <code>ansible-galaxy</code> command comes bundled with Ansible, and you can use it to install roles from Galaxy or directly from a git based SCM. You can also use it to create a new role, remove roles, or perform tasks on the Galaxy website.</p> <p>The command line tool by default communicates with the Galaxy website API using the server address <em>https://galaxy.ansible.com</em>. If you run your own internal Galaxy server and want to use it instead of the default one, pass the <code>--server</code> option following the address of this galaxy server. You can set permanently this option by setting the Galaxy server value in your <code>ansible.cfg</code> file to use it . For information on setting the value in <em>ansible.cfg</em> see <a class="reference internal" href="../reference_appendices/config.html#galaxy-server"><span class="std std-ref">GALAXY_SERVER</span></a>.</p>  <h3 id="installing-roles">Installing roles</h3> <p>Use the <code>ansible-galaxy</code> command to download roles from the <a class="reference external" href="https://galaxy.ansible.com">Galaxy website</a></p> <pre data-language="bash">$ ansible-galaxy install namespace.role_name
</pre>  <h4 id="setting-where-to-install-roles">Setting where to install roles</h4> <p>By default, Ansible downloads roles to the first writable directory in the default list of paths <code>~/.ansible/roles:/usr/share/ansible/roles:/etc/ansible/roles</code>. This installs roles in the home directory of the user running <code>ansible-galaxy</code>.</p> <p>You can override this with one of the following options:</p> <ul class="simple"> <li>Set the environment variable <a class="reference internal" href="../reference_appendices/config.html#envvar-ANSIBLE_ROLES_PATH" id="index-0"><code>ANSIBLE_ROLES_PATH</code></a> in your session.</li> <li>Use the <code>--roles-path</code> option for the <code>ansible-galaxy</code> command.</li> <li>Define <code>roles_path</code> in an <code>ansible.cfg</code> file.</li> </ul> <p>The following provides an example of using <code>--roles-path</code> to install the role into the current working directory:</p> <pre data-language="bash">$ ansible-galaxy install --roles-path . geerlingguy.apache
</pre> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../installation_guide/intro_configuration.html#intro-configuration"><span class="std std-ref">Configuring Ansible</span></a></dt>
<dd>
<p>All about configuration files</p> </dd> </dl> </div>    <h3 id="installing-a-specific-version-of-a-role">Installing a specific version of a role</h3> <p>When the Galaxy server imports a role, it imports any git tags matching the <a class="reference external" href="https://semver.org/">Semantic Version</a> format as versions. In turn, you can download a specific version of a role by specifying one of the imported tags.</p> <p>To see the available versions for a role:</p> <ol class="arabic simple"> <li>Locate the role on the Galaxy search page.</li> <li>Click on the name to view more details, including the available versions.</li> </ol> <p>You can also navigate directly to the role using the /&lt;namespace&gt;/&lt;role name&gt;. For example, to view the role geerlingguy.apache, go to <a class="reference external" href="https://galaxy.ansible.com/geerlingguy/apache">https://galaxy.ansible.com/geerlingguy/apache</a>.</p> <p>To install a specific version of a role from Galaxy, append a comma and the value of a GitHub release tag. For example:</p> <pre data-language="bash">$ ansible-galaxy install geerlingguy.apache,1.0.0
</pre> <p>It is also possible to point directly to the git repository and specify a branch name or commit hash as the version. For example, the following will install a specific commit:</p> <pre data-language="bash">$ ansible-galaxy install git+https://github.com/geerlingguy/ansible-role-apache.git,0b7cd353c0250e87a26e0499e59e7fd265cc2f25
</pre>   <h3 id="installing-multiple-roles-from-a-file">Installing multiple roles from a file</h3> <p>You can install multiple roles by including the roles in a <code>requirements.yml</code> file. The format of the file is YAML, and the file extension must be either <em>.yml</em> or <em>.yaml</em>.</p> <p>Use the following command to install roles included in <code>requirements.yml:</code></p> <pre data-language="bash">$ ansible-galaxy install -r requirements.yml
</pre> <p>Again, the extension is important. If the <em>.yml</em> extension is left off, the <code>ansible-galaxy</code> CLI assumes the file is in an older, now deprecated, “basic” format.</p> <p>Each role in the file will have one or more of the following attributes:</p>  <dl class="simple"> <dt>src</dt>
<dd>
<p>The source of the role. Use the format <em>namespace.role_name</em>, if downloading from Galaxy; otherwise, provide a URL pointing to a repository within a git based SCM. See the examples below. This is a required attribute.</p> </dd> <dt>scm</dt>
<dd>
<p>Specify the SCM. As of this writing only <em>git</em> or <em>hg</em> are allowed. See the examples below. Defaults to <em>git</em>.</p> </dd> <dt>version:</dt>
<dd>
<p>The version of the role to download. Provide a release tag value, commit hash, or branch name. Defaults to the branch set as a default in the repository, otherwise defaults to the <em>master</em>.</p> </dd> <dt>name:</dt>
<dd>
<p>Download the role to a specific name. Defaults to the Galaxy name when downloading from Galaxy, otherwise it defaults to the name of the repository.</p> </dd> </dl>  <p>Use the following example as a guide for specifying roles in <em>requirements.yml</em>:</p> <pre data-language="yaml"># from galaxy
- name: yatesr.timezone

# from locally cloned git repository (git+file:// requires full paths)
- src: git+file:///home/bennojoy/nginx

# from GitHub
- src: https://github.com/bennojoy/nginx

# from GitHub, overriding the name and specifying a specific tag
- name: nginx_role
  src: https://github.com/bennojoy/nginx
  version: main

# from GitHub, specifying a specific commit hash
- src: https://github.com/bennojoy/nginx
  version: "ee8aa41"

# from a webserver, where the role is packaged in a tar.gz
- name: http-role-gz
  src: https://some.webserver.example.com/files/main.tar.gz

# from a webserver, where the role is packaged in a tar.bz2
- name: http-role-bz2
  src: https://some.webserver.example.com/files/main.tar.bz2

# from a webserver, where the role is packaged in a tar.xz (Python 3.x only)
- name: http-role-xz
  src: https://some.webserver.example.com/files/main.tar.xz

# from Bitbucket
- src: git+https://bitbucket.org/willthames/git-ansible-galaxy
  version: v1.4

# from Bitbucket, alternative syntax and caveats
- src: https://bitbucket.org/willthames/hg-ansible-galaxy
  scm: hg

# from GitLab or other git-based scm, using git+ssh
- src: git@gitlab.company.com:mygroup/ansible-core.git
  scm: git
  version: "0.1"  # quoted, so YAML doesn't parse this as a floating-point value
</pre> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Embedding credentials into a SCM URL is not secure. Make sure to use safe auth options for security reasons. For example, use <a class="reference external" href="https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh">SSH</a>, <a class="reference external" href="https://linux.die.net/man/5/netrc">netrc</a> or <a class="reference external" href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-httpextraHeader">http.extraHeader</a>/<a class="reference external" href="https://git-scm.com/docs/git-config#Documentation/git-config.txt-urlltbasegtpushInsteadOf">url.&lt;base&gt;.pushInsteadOf</a> in Git config to prevent your creds from being exposed in logs.</p> </div>   <h3 id="installing-roles-and-collections-from-the-same-requirements-yml-file">Installing roles and collections from the same requirements.yml file</h3> <p>You can install roles and collections from the same requirements files</p> <pre data-language="yaml">---
roles:
  # Install a role from Ansible Galaxy.
  - name: geerlingguy.java
    version: 1.9.6

collections:
  # Install a collection from Ansible Galaxy.
  - name: geerlingguy.php_roles
    version: 0.9.3
    source: https://galaxy.ansible.com
</pre>   <h3 id="installing-multiple-roles-from-multiple-files">Installing multiple roles from multiple files</h3> <p>For large projects, the <code>include</code> directive in a <code>requirements.yml</code> file provides the ability to split a large file into multiple smaller files.</p> <p>For example, a project may have a <code>requirements.yml</code> file, and a <code>webserver.yml</code> file.</p> <p>Below are the contents of the <code>webserver.yml</code> file:</p> <pre data-language="bash"># from github
- src: https://github.com/bennojoy/nginx

# from Bitbucket
- src: git+http://bitbucket.org/willthames/git-ansible-galaxy
  version: v1.4
</pre> <p>The following shows the contents of the <code>requirements.yml</code> file that now includes the <code>webserver.yml</code> file:</p> <pre data-language="bash"># from galaxy
- name: yatesr.timezone
- include: &lt;path_to_requirements&gt;/webserver.yml
</pre> <p>To install all the roles from both files, pass the root file, in this case <code>requirements.yml</code> on the command line, as follows:</p> <pre data-language="bash">$ ansible-galaxy install -r requirements.yml
</pre>   <h3 id="galaxy-dependencies">Dependencies</h3> <p id="dependencies">Roles can also be dependent on other roles, and when you install a role that has dependencies, those dependencies will automatically be installed to the <code>roles_path</code>.</p> <p>There are two ways to define the dependencies of a role:</p> <ul class="simple"> <li>using <code>meta/requirements.yml</code>
</li> <li>using <code>meta/main.yml</code>
</li> </ul>  <h4 id="using-meta-requirements-yml">Using <code>meta/requirements.yml</code>
</h4> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.10.</span></p> </div> <p>You can create the file <code>meta/requirements.yml</code> and define dependencies in the same format used for <code>requirements.yml</code> described in the <a class="reference internal" href="#installing-multiple-roles-from-a-file">Installing multiple roles from a file</a> section.</p> <p>From there, you can import or include the specified roles in your tasks.</p>   <h4 id="using-meta-main-yml">Using <code>meta/main.yml</code>
</h4> <p>Alternatively, you can specify role dependencies in the <code>meta/main.yml</code> file by providing a list of roles under the <code>dependencies</code> section. If the source of a role is Galaxy, you can simply specify the role in the format <code>namespace.role_name</code>. You can also use the more complex format in <code>requirements.yml</code>, allowing you to provide <code>src</code>, <code>scm</code>, <code>version</code>, and <code>name</code>.</p> <p>Dependencies installed that way, depending on other factors described below, will also be executed <strong>before</strong> this role is executed during play execution. To better understand how dependencies are handled during play execution, see <a class="reference internal" href="../user_guide/playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a>.</p> <p>The following shows an example <code>meta/main.yml</code> file with dependent roles:</p> <pre data-language="yaml">---
dependencies:
  - geerlingguy.java

galaxy_info:
  author: geerlingguy
  description: Elasticsearch for Linux.
  company: "Midwestern Mac, LLC"
  license: "license (BSD, MIT)"
  min_ansible_version: 2.4
  platforms:
  - name: EL
    versions:
    - all
  - name: Debian
    versions:
    - all
  - name: Ubuntu
    versions:
    - all
  galaxy_tags:
    - web
    - system
    - monitoring
    - logging
    - lucene
    - elk
    - elasticsearch
</pre> <p>Tags are inherited <em>down</em> the dependency chain. In order for tags to be applied to a role and all its dependencies, the tag should be applied to the role, not to all the tasks within a role.</p> <p>Roles listed as dependencies are subject to conditionals and tag filtering, and may not execute fully depending on what tags and conditionals are applied.</p> <p>If the source of a role is Galaxy, specify the role in the format <em>namespace.role_name</em>:</p> <pre data-language="yaml">dependencies:
  - geerlingguy.apache
  - geerlingguy.ansible
</pre> <p>Alternately, you can specify the role dependencies in the complex form used in <code>requirements.yml</code> as follows:</p> <pre data-language="yaml">dependencies:
  - name: geerlingguy.ansible
  - name: composer
    src: git+https://github.com/geerlingguy/ansible-role-composer.git
    version: 775396299f2da1f519f0d8885022ca2d6ee80ee8
</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Galaxy expects all role dependencies to exist in Galaxy, and therefore dependencies to be specified in the <code>namespace.role_name</code> format. If you import a role with a dependency where the <code>src</code> value is a URL, the import process will fail.</p> </div>    <h3 id="list-installed-roles">List installed roles</h3> <p>Use <code>list</code> to show the name and version of each role installed in the <em>roles_path</em>.</p> <pre data-language="bash">$ ansible-galaxy list
  - ansible-network.network-engine, v2.7.2
  - ansible-network.config_manager, v2.6.2
  - ansible-network.cisco_nxos, v2.7.1
  - ansible-network.vyos, v2.7.3
  - ansible-network.cisco_ios, v2.7.0
</pre>   <h3 id="remove-an-installed-role">Remove an installed role</h3> <p>Use <code>remove</code> to delete a role from <em>roles_path</em>:</p> <pre data-language="bash">$ ansible-galaxy remove namespace.role_name
</pre> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../user_guide/collections_using.html#collections"><span class="std std-ref">Using collections</span></a></dt>
<dd>
<p>Shareable collections of modules, playbooks and roles</p> </dd> <dt><a class="reference internal" href="../user_guide/playbooks_reuse_roles.html#playbooks-reuse-roles"><span class="std std-ref">Roles</span></a></dt>
<dd>
<p>Reusable tasks, handlers, and other files in a known directory structure</p> </dd> </dl> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/galaxy/user_guide.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/galaxy/user_guide.html</a>
  </p>
</div>
