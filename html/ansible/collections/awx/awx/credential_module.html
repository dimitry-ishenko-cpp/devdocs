<h1 id="awx-awx-credential-create-update-or-destroy-automation-platform-controller-credential">awx.awx.credential – create, update, or destroy Automation Platform Controller credential.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/awx/awx">awx.awx collection</a> (version 19.4.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install awx.awx</code>.</p> <p>To use it in a playbook, specify: <code>awx.awx.credential</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Create, update, or destroy Automation Platform Controller credentials. See <a class="reference external" href="https://www.ansible.com/tower">https://www.ansible.com/tower</a> for an overview.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>controller_config_file</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>Path to the controller config file.</div> <div>If provided, the other locations for config files will not be considered.</div> <div>
<br>aliases: tower_config_file</div> </td> </tr> <tr> <td colspan="1">  <b>controller_host</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>URL to your Automation Platform Controller instance.</div> <div>If value not set, will try environment variable <code>CONTROLLER_HOST</code> and then config files</div> <div>If value not specified by any means, the value of <code>127.0.0.1</code> will be used</div> <div>
<br>aliases: tower_host</div> </td> </tr> <tr> <td colspan="1">  <b>controller_oauthtoken</b>  <div> <span>raw</span> </div> <div> added in 3.7.0 of awx.awx </div> </td> <td> </td> <td> <div>The OAuth token to use.</div> <div>This value can be in one of two formats.</div> <div>A string which is the token itself. (i.e. bqV5txm97wqJqtkxlMkhQz0pKhRMMX)</div> <div>A dictionary structure as returned by the token module.</div> <div>If value not set, will try environment variable <code>CONTROLLER_OAUTH_TOKEN</code> and then config files</div> <div>
<br>aliases: tower_oauthtoken</div> </td> </tr> <tr> <td colspan="1">  <b>controller_password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Password for your controller instance.</div> <div>If value not set, will try environment variable <code>CONTROLLER_PASSWORD</code> and then config files</div> <div>
<br>aliases: tower_password</div> </td> </tr> <tr> <td colspan="1">  <b>controller_username</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Username for your controller instance.</div> <div>If value not set, will try environment variable <code>CONTROLLER_USERNAME</code> and then config files</div> <div>
<br>aliases: tower_username</div> </td> </tr> <tr> <td colspan="1">  <b>copy_from</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name or id to copy the credential from.</div> <div>This will copy an existing credential and change any parameters supplied.</div> <div>The new credential name will be the one provided in the name parameter.</div> <div>The organization parameter is not used in this, to facilitate copy from one organization to another.</div> <div>Provide the id or use the lookup plugin to provide the id if multiple credentials share the same name.</div> </td> </tr> <tr> <td colspan="1">  <b>credential_type</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The credential type being created.</div> <div>Can be a built-in credential type such as "Machine", or a custom credential type such as "My Credential Type"</div> <div>Choices include Amazon Web Services, Ansible Galaxy/Automation Hub API Token, Centrify Vault Credential Provider Lookup, Container Registry, CyberArk AIM Central Credential Provider Lookup, CyberArk Conjur Secret Lookup, Google Compute Engine, GitHub Personal Access Token, GitLab Personal Access Token, HashiCorp Vault Secret Lookup, HashiCorp Vault Signed SSH, Insights, Machine, Microsoft Azure Key Vault, Microsoft Azure Resource Manager, Network, OpenShift or Kubernetes API Bearer Token, OpenStack, Red Hat Ansible Automation Platform, Red Hat Satellite 6, Red Hat Virtualization, Source Control, Thycotic DevOps Secrets Vault, Thycotic Secret Server, Vault, VMware vCenter, or a custom credential type</div> </td> </tr> <tr> <td colspan="1">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The description to use for the credential.</div> </td> </tr> <tr> <td colspan="1">  <b>inputs</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Credential inputs where the keys are var names used in templating. Refer to the Automation Platform Controller documentation for example syntax.</div> <div>authorize (use this for net type)</div> <div>authorize_password (password for net credentials that require authorize)</div> <div>client (client or application ID for azure_rm type)</div> <div>security_token (STS token for aws type)</div> <div>secret (secret token for azure_rm type)</div> <div>tenant (tenant ID for azure_rm type)</div> <div>subscription (subscription ID for azure_rm type)</div> <div>domain (domain for openstack type)</div> <div>become_method (become method to use for privilege escalation; some examples are "None", "sudo", "su", "pbrun")</div> <div>become_username (become username; use "ASK" and launch job to be prompted)</div> <div>become_password (become password; use "ASK" and launch job to be prompted)</div> <div>vault_password (the vault password; use "ASK" and launch job to be prompted)</div> <div>project (project that should use this credential for GCP)</div> <div>host (the host for this credential)</div> <div>username (the username for this credential; ``access_key`` for AWS)</div> <div>password (the password for this credential; ``secret_key`` for AWS, ``api_key`` for RAX)</div> <div>ssh_key_data (SSH private key content; to extract the content from a file path, use the lookup function (see examples))</div> <div>vault_id (the vault identifier; this parameter is only valid if <code>kind</code> is specified as <code>vault</code>.)</div> <div>ssh_key_unlock (unlock password for ssh_key; use "ASK" and launch job to be prompted)</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name to use for the credential.</div> </td> </tr> <tr> <td colspan="1">  <b>new_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Setting this option will change the existing name (looked up via the name field.</div> </td> </tr> <tr> <td colspan="1">  <b>organization</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Organization that should own the credential.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>present</b> ←</div></li> <li>absent</li> </ul> </td> <td> <div>Desired state of the resource.</div> </td> </tr> <tr> <td colspan="1">  <b>team</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Team that should own this credential.</div> </td> </tr> <tr> <td colspan="1">  <b>update_secrets</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>
<code>true</code> will always update encrypted values.</div> <div>
<code>false</code> will only updated encrypted values if a change is absolutely known to be needed.</div> </td> </tr> <tr> <td colspan="1">  <b>user</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>User that should own this credential.</div> </td> </tr> <tr> <td colspan="1">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Whether to allow insecure connections to AWX.</div> <div>If <code>no</code>, SSL certificates will not be validated.</div> <div>This should only be used on personally controlled sites using self-signed certificates.</div> <div>If value not set, will try environment variable <code>CONTROLLER_VERIFY_SSL</code> and then config files</div> <div>
<br>aliases: tower_verify_ssl</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Values <code>inputs</code> and the other deprecated fields (such as <code>tenant</code>) are replacements of existing values. See the last 4 examples for details.</li> <li>If no <em>config_file</em> is provided we will attempt to use the tower-cli library defaults to find your host information.</li> <li>
<em>config_file</em> should be in the following format host=hostname username=username password=password</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Add machine credential
  credential:
    name: Team Name
    description: Team Description
    organization: test-org
    credential_type: Machine
    state: present
    controller_config_file: "~/tower_cli.cfg"

- name: Create a valid SCM credential from a private_key file
  credential:
    name: SCM Credential
    organization: Default
    state: present
    credential_type: Source Control
    inputs:
      username: joe
      password: secret
      ssh_key_data: "{{ lookup('file', '/tmp/id_rsa') }}"
      ssh_key_unlock: "passphrase"

- name: Fetch private key
  slurp:
    src: '$HOME/.ssh/aws-private.pem'
  register: aws_ssh_key

- name: Add Credential
  credential:
    name: Workshop Credential
    credential_type: Machine
    organization: Default
    inputs:
      ssh_key_data: "{{ aws_ssh_key['content'] | b64decode }}"
  run_once: true
  delegate_to: localhost

- name: Add Credential with Custom Credential Type
  credential:
    name: Workshop Credential
    credential_type: MyCloudCredential
    organization: Default
    controller_username: admin
    controller_password: ansible
    controller_host: https://localhost

- name: Create a Vaiult credential (example for notes)
  credential:
    name: Example password
    credential_type: Vault
    organization: Default
    inputs:
      vault_password: 'hello'
      vault_id: 'My ID'

- name: Bad password update (will replace vault_id)
  credential:
    name: Example password
    credential_type: Vault
    organization: Default
    inputs:
      vault_password: 'new_password'

- name: Another bad password update (will replace vault_id)
  credential:
    name: Example password
    credential_type: Vault
    organization: Default
    vault_password: 'new_password'

- name: A safe way to update a password and keep vault_id
  credential:
    name: Example password
    credential_type: Vault
    organization: Default
    inputs:
      vault_password: 'new_password'
      vault_id: 'My ID'

- name: Copy Credential
  credential:
    name: Copy password
    copy_from: Example password
    credential_type: Vault
    organization: Foo
</pre>  <h3 id="authors">Authors</h3> <ul class="simple"> <li>Wayne Witzel III (@wwitzel3)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/awx/awx/credential_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/awx/awx/credential_module.html</a>
  </p>
</div>
