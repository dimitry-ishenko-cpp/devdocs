<section id="splunk-es-splunk-data-inputs-monitor-module-splunk-data-inputs-of-type-monitor-resource-module"> <h1>splunk.es.splunk_data_inputs_monitor module – Splunk Data Inputs of type Monitor resource module</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/splunk/es/">splunk.es collection</a> (version 3.0.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install splunk.es</code>.</p> <p>To use it in a playbook, specify: <code>splunk.es.splunk_data_inputs_monitor</code>.</p> </div> <p class="ansible-version-added">New in splunk.es 2.1.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id3">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id4">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Module to add/modify or delete, File and Directory Monitor Data Inputs in Splunk.</li> <li>Tested against Splunk Enterprise Server 8.2.3</li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module has a corresponding <a class="reference internal" href="../../../plugins/action.html#action-plugins"><span class="std std-ref">action plugin</span></a>.</p> </div> <p>Aliases: data_inputs_monitor</p> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config"><strong>config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Configure file and directory monitoring on the system</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-blacklist"><strong>blacklist</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Specify a regular expression for a file path. The file path that matches this regular expression is not indexed.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-check-index"><strong>check_index</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>If set to <code>true</code>, the index value is checked to ensure that it is the name of a valid index.</p> <p>This parameter is not returned back by Splunk while obtaining object information. It is therefore left out while performing idempotency checks</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-check-path"><strong>check_path</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>If set to <code>true</code>, the name value is checked to ensure that it exists.</p> <p>This parameter is not returned back by Splunk while obtaining object information. It is therefore left out while performing idempotency checks</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-crc-salt"><strong>crc_salt</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A string that modifies the file tracking identity for files in this input. The magic value &lt;SOURCE&gt; invokes special behavior (see admin documentation).</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-disabled"><strong>disabled</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Indicates if input monitoring is disabled.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-follow-tail"><strong>follow_tail</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>If set to <code>true</code>, files that are seen for the first time is read from the end.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-host"><strong>host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The value to populate in the host field for events from this data input.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"$decideOnStartup"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-host-regex"><strong>host_regex</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Specify a regular expression for a file path. If the path for a file matches this regular expression, the captured value is used to populate the host field for events from this data input. The regular expression must have one capture group.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-host-segment"><strong>host_segment</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Use the specified slash-separate segment of the filepath as the host field value.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-ignore-older-than"><strong>ignore_older_than</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Specify a time value. If the modification time of a file being monitored falls outside of this rolling time window, the file is no longer being monitored.</p> <p>This parameter is not returned back by Splunk while obtaining object information. It is therefore left out while performing idempotency checks</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-index"><strong>index</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Which index events from this input should be stored in. Defaults to default.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"default"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The file or directory path to monitor on the system.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-recursive"><strong>recursive</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Setting this to False prevents monitoring of any subdirectories encountered within this data input.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-rename-source"><strong>rename_source</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The value to populate in the source field for events from this data input. The same source should not be used for multiple data inputs.</p> <p>This parameter is not returned back by Splunk while obtaining object information. It is therefore left out while performing idempotency checks</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-sourcetype"><strong>sourcetype</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The value to populate in the sourcetype field for incoming events.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-time-before-close"><strong>time_before_close</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>When Splunk software reaches the end of a file that is being read, the file is kept open for a minimum of the number of seconds specified in this value. After this period has elapsed, the file is checked again for more data.</p> <p>This parameter is not returned back by Splunk while obtaining object information. It is therefore left out while performing idempotency checks</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-config-whitelist"><strong>whitelist</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Specify a regular expression for a file path. Only file paths that match this regular expression are indexed.</p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-running-config"><strong>running_config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The module, by default, will connect to the remote device and retrieve the current running-config to use as a base for comparing against the contents of source. There are times when it is not desirable to have the task get the current running-config for every task in a playbook. The <em>running_config</em> argument allows the implementer to pass in the configuration to use as the base config for comparison. This value of this option should be the output received from device by executing command.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The state the configuration should be left in</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"merged"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"replaced"</code></li> <li><code>"deleted"</code></li> <li><code>"gathered"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># Using gathered
# --------------

- name: Gather config for specified Data inputs monitors
  splunk.es.splunk_data_inputs_monitor:
    config:
      - name: "/var/log"
      - name: "/var"
    state: gathered

# RUN output:
# -----------

# "gathered": [
#     {
#         "blacklist": "//var/log/[a-z0-9]/gm",
#         "crc_salt": "&lt;SOURCE&gt;",
#         "disabled": false,
#         "host": "$decideOnStartup",
#         "host_regex": "/(test_host)/gm",
#         "host_segment": 3,
#         "index": "default",
#         "name": "/var/log",
#         "recursive": true,
#         "sourcetype": "test_source",
#         "whitelist": "//var/log/[0-9]/gm"
#     }
# ]
#

# Using merged
# ------------

- name: Update Data inputs monitors config
  splunk.es.splunk_data_inputs_monitor:
    config:
      - name: "/var/log"
        blacklist: "//var/log/[a-z]/gm"
        check_index: true
        check_path: true
        crc_salt: &lt;SOURCE&gt;
        rename_source: "test"
        whitelist: "//var/log/[0-9]/gm"
    state: merged

# RUN output:
# -----------

# "after": [
#     {
#         "blacklist": "//var/log/[a-z]/gm",
#         "crc_salt": "&lt;SOURCE&gt;",
#         "disabled": false,
#         "host": "$decideOnStartup",
#         "host_regex": "/(test_host)/gm",
#         "host_segment": 3,
#         "index": "default",
#         "name": "/var/log",
#         "recursive": true,
#         "sourcetype": "test_source",
#         "whitelist": "//var/log/[0-9]/gm"
#     }
# ],
# "before": [
#     {
#         "blacklist": "//var/log/[a-z0-9]/gm",
#         "crc_salt": "&lt;SOURCE&gt;",
#         "disabled": false,
#         "host": "$decideOnStartup",
#         "host_regex": "/(test_host)/gm",
#         "host_segment": 3,
#         "index": "default",
#         "name": "/var/log",
#         "recursive": true,
#         "sourcetype": "test_source",
#         "whitelist": "//var/log/[0-9]/gm"
#     }
# ],

# Using replaced
# --------------

- name: To Replace Data inputs monitors config
  splunk.es.splunk_data_inputs_monitor:
    config:
      - name: "/var/log"
        blacklist: "//var/log/[a-z0-9]/gm"
        crc_salt: &lt;SOURCE&gt;
        index: default
    state: replaced

# RUN output:
# -----------

# "after": [
#     {
#         "blacklist": "//var/log/[a-z0-9]/gm",
#         "crc_salt": "&lt;SOURCE&gt;",
#         "disabled": false,
#         "host": "$decideOnStartup",
#         "index": "default",
#         "name": "/var/log"
#     }
# ],
# "before": [
#     {
#         "blacklist": "//var/log/[a-z0-9]/gm",
#         "crc_salt": "&lt;SOURCE&gt;",
#         "disabled": false,
#         "host": "$decideOnStartup",
#         "host_regex": "/(test_host)/gm",
#         "host_segment": 3,
#         "index": "default",
#         "name": "/var/log",
#         "recursive": true,
#         "sourcetype": "test_source",
#         "whitelist": "//var/log/[0-9]/gm"
#     }
# ],

# Using deleted
# -----------
- name: To Delete Data inpur monitor config
  splunk.es.splunk_data_inputs_monitor:
    config:
      - name: "/var/log"
    state: deleted

# RUN output:
# -----------
#
# "after": [],
# "before": [
#     {
#         "blacklist": "//var/log/[a-z0-9]/gm",
#         "crc_salt": "&lt;SOURCE&gt;",
#         "disabled": false,
#         "host": "$decideOnStartup",
#         "index": "default",
#         "name": "/var/log"
#     }
# ],
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-return-after"><strong>after</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The configuration as structured data after module completion.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when changed</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["The configuration returned will always be in the same format of the parameters above."]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-splunk-es-splunk-data-inputs-monitor-module-return-before"><strong>before</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The configuration as structured data prior to module invocation.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["The configuration returned will always be in the same format of the parameters above."]</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Ansible Security Automation Team (@pranav-bhatt) &lt;<a class="reference external" href="https://github.com/ansible-security">https://github.com/ansible-security</a>&gt;</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/splunk.es/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/splunk.es" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/splunk/es/splunk_data_inputs_monitor_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/splunk/es/splunk_data_inputs_monitor_module.html</a>
  </p>
</div>
