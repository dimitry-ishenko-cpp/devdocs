<section id="vyos-vyos-vyos-bgp-address-family-module-bgp-address-family-resource-module"> <h1>vyos.vyos.vyos_bgp_address_family module – BGP Address Family Resource Module.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/vyos/vyos/">vyos.vyos collection</a> (version 4.1.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install vyos.vyos</code>.</p> <p>To use it in a playbook, specify: <code>vyos.vyos.vyos_bgp_address_family</code>.</p> </div> <p class="ansible-version-added">New in vyos.vyos 2.1.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id3">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>This module manages BGP address family configuration of interfaces on devices running VYOS.</li> </ul> <p>Aliases: bgp_address_family</p> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config"><strong>config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A dict of BGP global configuration for interfaces.</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family"><strong>address_family</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>BGP address-family parameters.</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-afi"><strong>afi</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>BGP address family settings.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"ipv4"</code></li> <li><code>"ipv6"</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-aggregate-address"><strong>aggregate_address</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>BGP aggregate network.</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-aggregate-address-as-set"><strong>as_set</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Generate AS-set path information for this aggregate address.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-aggregate-address-prefix"><strong>prefix</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>BGP aggregate network.</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-aggregate-address-summary-only"><strong>summary_only</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Announce the aggregate summary network only.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-networks"><strong>networks</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>BGP network</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-networks-backdoor"><strong>backdoor</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Network as a backdoor route.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-networks-path-limit"><strong>path_limit</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>AS path hop count limit</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-networks-prefix"><strong>prefix</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>BGP network address</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-networks-route-map"><strong>route_map</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Route-map to modify route attributes</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-redistribute"><strong>redistribute</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Redistribute routes from other protocols into BGP</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-redistribute-metric"><strong>metric</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Metric for redistributed routes.</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-redistribute-protocol"><strong>protocol</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>types of routes to be redistributed.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"connected"</code></li> <li><code>"kernel"</code></li> <li><code>"ospf"</code></li> <li><code>"ospfv3"</code></li> <li><code>"rip"</code></li> <li><code>"ripng"</code></li> <li><code>"static"</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-redistribute-route-map"><strong>route_map</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Route map to filter redistributed routes</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-address-family-redistribute-table"><strong>table</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Redistribute non-main Kernel Routing Table.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-as-number"><strong>as_number</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>AS number.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors"><strong>neighbors</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>BGP neighbor</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family"><strong>address_family</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>address family.</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-afi"><strong>afi</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>BGP neighbor parameters.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"ipv4"</code></li> <li><code>"ipv6"</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-allowas-in"><strong>allowas_in</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Number of occurrences of AS number.</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-as-override"><strong>as_override</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>AS for routes sent to this neighbor to be the local AS.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-attribute-unchanged"><strong>attribute_unchanged</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>BGP attributes are sent unchanged.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-attribute-unchanged-as-path"><strong>as_path</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>as_path attribute</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-attribute-unchanged-med"><strong>med</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>med attribute</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-attribute-unchanged-next-hop"><strong>next_hop</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>next_hop attribute</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-capability"><strong>capability</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Advertise capabilities to this neighbor.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-capability-dynamic"><strong>dynamic</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Advertise dynamic capability to this neighbor.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-capability-orf"><strong>orf</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Advertise ORF capability to this neighbor.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"send"</code></li> <li><code>"receive"</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-default-originate"><strong>default_originate</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Send default route to this neighbor</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-distribute-list"><strong>distribute_list</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Access-list to filter route updates to/from this neighbor.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-distribute-list-acl"><strong>acl</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Access-list number.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-distribute-list-action"><strong>action</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Access-list to filter outgoing/incoming route updates to this neighbor</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"export"</code></li> <li><code>"import"</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-filter-list"><strong>filter_list</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>As-path-list to filter route updates to/from this neighbor.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-filter-list-action"><strong>action</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>filter outgoing/incoming route updates</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"export"</code></li> <li><code>"import"</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-filter-list-path-list"><strong>path_list</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>As-path-list to filter</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-maximum-prefix"><strong>maximum_prefix</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Maximum number of prefixes to accept from this neighbor nexthop-self Nexthop for routes sent to this neighbor to be the local router.</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-nexthop-local"><strong>nexthop_local</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Nexthop attributes.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-nexthop-self"><strong>nexthop_self</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Nexthop for routes sent to this neighbor to be the local router.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-peer-group"><strong>peer_group</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>IPv4 peer group for this peer</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-prefix-list"><strong>prefix_list</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Prefix-list to filter route updates to/from this neighbor.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-prefix-list-action"><strong>action</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>filter outgoing/incoming route updates</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"export"</code></li> <li><code>"import"</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-prefix-list-prefix-list"><strong>prefix_list</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Prefix-list to filter</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-remove-private-as"><strong>remove_private_as</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Remove private AS numbers from AS path in outbound route updates</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-route-map"><strong>route_map</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Route-map to filter route updates to/from this neighbor.</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-route-map-action"><strong>action</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>filter outgoing/incoming route updates</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"export"</code></li> <li><code>"import"</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-route-map-route-map"><strong>route_map</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>route-map to filter</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-route-reflector-client"><strong>route_reflector_client</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Neighbor as a route reflector client</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-route-server-client"><strong>route_server_client</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Neighbor is route server client</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-soft-reconfiguration"><strong>soft_reconfiguration</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Soft reconfiguration for neighbor</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-unsupress-map"><strong>unsupress_map</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Route-map to selectively unsuppress suppressed routes</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-address-family-weight"><strong>weight</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Default weight for routes from this neighbor</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-config-neighbors-neighbor-address"><strong>neighbor_address</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>BGP neighbor address (v4/v6).</p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-running-config"><strong>running_config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>This option is used only with state <em>parsed</em>.</p> <p>The value of this option should be the output received from the VYOS device by executing the command <strong>show configuration command | match bgp</strong>.</p> <p>The state <em>parsed</em> reads the configuration from <code>running_config</code> option and transforms it into Ansible structured data as per the resource module’s argspec and the value is then returned in the <em>parsed</em> key within the result.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-vyos-vyos-vyos-bgp-address-family-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The state the configuration should be left in.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"merged"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"replaced"</code></li> <li><code>"deleted"</code></li> <li><code>"gathered"</code></li> <li><code>"parsed"</code></li> <li><code>"rendered"</code></li> <li><code>"purged"</code></li> <li><code>"overridden"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># Using merged
# Before state
# vyos@vyos:~$ show configuration commands |  match "set protocols bgp"
# vyos@vyos:~$

  - name: Merge provided configuration with device configuration
    vyos.vyos.vyos_bgp_address_family:
      config:
        as_number: "100"
        address_family:
          - afi: "ipv4"
            redistribute:
              - protocol: "static"
                metric: 50
        neighbors:
          - neighbor_address: "20.33.1.1/24"
            address_family:
              - afi: "ipv4"
                allowas_in: 4
                as_override: True
                attribute_unchanged:
                  med: True
              - afi: "ipv6"
                default_originate: "map01"
                distribute_list:
                  - action: "export"
                    acl: 10
          - neighbor_address: "100.11.34.12"
            address_family:
              - afi: "ipv4"
                maximum_prefix: 45
                nexthop_self: True
                route_map:
                  - action: "export"
                    route_map: "map01"
                  - action: "import"
                    route_map: "map01"
                weight: 50

# After State:
# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast default-originate route-map 'map01'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast distribute-list export '10'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map export 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map import 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast weight '50'
# vyos@vyos:~$
#
# Module Execution:
#
# "after": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true,
#                         "route_map": [
#                             {
#                                 "action": "export",
#                                 "route_map": "map01"
#                             },
#                             {
#                                 "action": "import",
#                                 "route_map": "map01"
#                             }
#                         ],
#                         "weight": 50
#                     }
#                 ],
#                 "neighbor_address": "100.11.34.12"
#             },
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     },
#                     {
#                         "afi": "ipv6",
#                         "default_originate": "map01",
#                         "distribute_list": [
#                             {
#                                 "acl": 10,
#                                 "action": "export"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]
#     },
#     "before": {},
#     "changed": true,
#     "commands": [
#         "set protocols bgp 100 address-family ipv4-unicast redistribute static metric 50",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number 4",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast as-override",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv6-unicast default-originate route-map map01",
#         "set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast distribute-list export 10",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast maximum-prefix 45",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast nexthop-self",
#         "set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map export map01",
#         "set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map import map01",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast weight 50"
#     ],
#

# Using replaced:

# Before state:

# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast default-originate route-map 'map01'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast distribute-list export '10'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map export 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map import 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast weight '50'
# vyos@vyos:~$

  - name: Replace provided configuration with device configuration
    vyos.vyos.vyos_bgp_address_family:
      config:
        as_number: "100"
        neighbors:
          - neighbor_address: "100.11.34.12"
            address_family:
              - afi: "ipv4"
                allowas_in: 4
                as_override: True
                attribute_unchanged:
                  med: True
              - afi: "ipv6"
                default_originate: "map01"
                distribute_list:
                  - action: "export"
                    acl: 10
          - neighbor_address: "20.33.1.1/24"
            address_family:
              - afi: "ipv6"
                maximum_prefix: 45
                nexthop_self: True

      state: replaced

# After State:

# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast default-originate route-map 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast distribute-list export '10'
# vyos@vyos:~$
#
#
# # Module Execution:
# "after": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     },
#                     {
#                         "afi": "ipv6",
#                         "default_originate": "map01",
#                         "distribute_list": [
#                             {
#                                 "acl": 10,
#                                 "action": "export"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "100.11.34.12"
#             },
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4"
#                     },
#                     {
#                         "afi": "ipv6",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]
#     },
#     "before": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true,
#                         "route_map": [
#                             {
#                                 "action": "export",
#                                 "route_map": "map01"
#                             },
#                             {
#                                 "action": "import",
#                                 "route_map": "map01"
#                             }
#                         ],
#                         "weight": 50
#                     }
#                 ],
#                 "neighbor_address": "100.11.34.12"
#             },
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     },
#                     {
#                         "afi": "ipv6",
#                         "default_originate": "map01",
#                         "distribute_list": [
#                             {
#                                 "acl": 10,
#                                 "action": "export"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]
#     },
#     "changed": true,
#     "commands": [
#         "delete protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv6-unicast distribute-list",
#         "delete protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv6-unicast default-originate",
#         "delete protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged",
#         "delete protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast as-override",
#         "delete protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast weight",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast route-map",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast nexthop-self",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast maximum-prefix",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast allowas-in number 4",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast as-override",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast attribute-unchanged med",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv6-unicast default-originate route-map map01",
#         "set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast distribute-list export 10",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv6-unicast maximum-prefix 45",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv6-unicast nexthop-self"
#     ],


# Using overridden
# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast network 35.1.1.0/24 backdoor
# set protocols bgp 100 address-family ipv4-unicast redistribute static metric '50'
# set protocols bgp 100 address-family ipv6-unicast aggregate-address 6601:1:1:1::/64 summary-only
# set protocols bgp 100 address-family ipv6-unicast network 5001:1:1:1::/64 route-map 'map01'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast default-originate route-map 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast distribute-list export '10'
# vyos@vyos:~$

  - name: Override
    vyos.vyos.vyos_bgp_address_family:
      config:
        as_number: "100"
        neighbors:
          - neighbor_address: "100.11.34.12"
            address_family:
              - afi: "ipv6"
                maximum_prefix: 45
                nexthop_self: True
                route_map:
                  - action: "import"
                    route_map: "map01"
        address_family:
          - afi: "ipv4"
            aggregate_address:
              - prefix: "60.9.2.0/24"
                summary_only: True
          - afi: "ipv6"
            redistribute:
              - protocol: "static"
                metric: 50
      state: overridden

# Aft=validate-moduleser State

# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast aggregate-address 60.9.2.0/24 summary-only
# set protocols bgp 100 address-family ipv6-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast route-map import 'map01'
# vyos@vyos:~$


# Module Execution:

# "after": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "aggregate_address": [
#                     {
#                         "prefix": "60.9.2.0/24",
#                         "summary_only": true
#                     }
#                 ]
#             },
#             {
#                 "afi": "ipv6",
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4"
#                     },
#                     {
#                         "afi": "ipv6",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true,
#                         "route_map": [
#                             {
#                                 "action": "import",
#                                 "route_map": "map01"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "100.11.34.12"
#             }
#         ]
#     },
#     "before": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "networks": [
#                     {
#                         "backdoor": true,
#                         "prefix": "35.1.1.0/24"
#                     }
#                 ],
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             },
#             {
#                 "afi": "ipv6",
#                 "aggregate_address": [
#                     {
#                         "prefix": "6601:1:1:1::/64",
#                         "summary_only": true
#                     }
#                 ],
#                 "networks": [
#                     {
#                         "prefix": "5001:1:1:1::/64",
#                         "route_map": "map01"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     },
#                     {
#                         "afi": "ipv6",
#                         "default_originate": "map01",
#                         "distribute_list": [
#                             {
#                                 "acl": 10,
#                                 "action": "export"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "100.11.34.12"
#             },
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4"
#                     },
#                     {
#                         "afi": "ipv6",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]
#     },
#     "changed": true,
#     "commands": [
#         "delete protocols bgp 100 neighbor 20.33.1.1/24 address-family",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv6-unicast distribute-list",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv6-unicast default-originate",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast attribute-unchanged",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast as-override",
#         "delete protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast allowas-in",
#         "delete protocols bgp 100 address-family ipv6 aggregate-address",
#         "delete protocols bgp 100 address-family ipv6 network",
#         "delete protocols bgp 100 address-family ipv4 network",
#         "delete protocols bgp 100 address-family ipv4 redistribute",
#         "set protocols bgp 100 address-family ipv4-unicast aggregate-address 60.9.2.0/24 summary-only",
#         "set protocols bgp 100 address-family ipv6-unicast redistribute static metric 50",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv6-unicast maximum-prefix 45",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv6-unicast nexthop-self",
#         "set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast route-map import map01"
#     ],
#

# Using deleted:

# Before State:

# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast aggregate-address 60.9.2.0/24 summary-only
# set protocols bgp 100 address-family ipv4-unicast redistribute static metric '50'
# set protocols bgp 100 address-family ipv6-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast default-originate route-map 'map01'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast distribute-list export '10'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map export 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map import 'map01'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast weight '50'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast maximum-prefix '45'
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast nexthop-self
# set protocols bgp 100 neighbor 100.11.34.12 address-family ipv6-unicast route-map import 'map01'
# vyos@vyos:~$

  - name: Delete
    vyos.vyos.vyos_bgp_address_family:
      config:
        as_number: "100"
        neighbors:
          - neighbor_address: "20.33.1.1/24"
            address_family:
              - afi: "ipv6"
          - neighbor_address: "100.11.34.12"
        address_family:
          - afi: "ipv4"
      state: deleted


# After State:

# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv6-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 100.11.34.12
# vyos@vyos:~$
#
#
# Module Execution:
#
# "after": {
#         "address_family": [
#             {
#                 "afi": "ipv6",
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]
#     },
#     "before": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "aggregate_address": [
#                     {
#                         "prefix": "60.9.2.0/24",
#                         "summary_only": true
#                     }
#                 ],
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             },
#             {
#                 "afi": "ipv6",
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true,
#                         "route_map": [
#                             {
#                                 "action": "export",
#                                 "route_map": "map01"
#                             },
#                             {
#                                 "action": "import",
#                                 "route_map": "map01"
#                             }
#                         ],
#                         "weight": 50
#                     },
#                     {
#                         "afi": "ipv6",
#                         "maximum_prefix": 45,
#                         "nexthop_self": true,
#                         "route_map": [
#                             {
#                                 "action": "import",
#                                 "route_map": "map01"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "100.11.34.12"
#             },
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     },
#                     {
#                         "afi": "ipv6",
#                         "default_originate": "map01",
#                         "distribute_list": [
#                             {
#                                 "acl": 10,
#                                 "action": "export"
#                             }
#                         ]
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]
#     },
#     "changed": true,
#     "commands": [
#         "delete protocols bgp 100 address-family ipv4-unicast",
#         "delete protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast",
#         "delete protocols bgp 100 neighbor 100.11.34.12 address-family"
#     ],
#

# using parsed:

# parsed.cfg
# set protocols bgp 65536 address-family ipv4-unicast aggregate-address 192.0.2.0/24 as-set
# set protocols bgp 65536 address-family ipv4-unicast network 192.1.13.0/24 route-map 'map01'
# set protocols bgp 65536 address-family ipv4-unicast network 192.2.13.0/24 backdoor
# set protocols bgp 65536 address-family ipv6-unicast redistribute ripng metric '20'
# set protocols bgp 65536 neighbor 192.0.2.25 address-family ipv4-unicast route-map export 'map01'
# set protocols bgp 65536 neighbor 192.0.2.25 address-family ipv4-unicast soft-reconfiguration inbound
# set protocols bgp 65536 neighbor 203.0.113.5 address-family ipv6-unicast attribute-unchanged next-hop


  - name: parse configs
    vyos.vyos.vyos_bgp_address_family:
      running_config: "{{ lookup('file', './parsed.cfg') }}"
      state: parsed

# Module Execution:
# "parsed": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "aggregate_address": [
#                     {
#                         "as_set": true,
#                         "prefix": "192.0.2.0/24"
#                     }
#                 ],
#                 "networks": [
#                     {
#                         "prefix": "192.1.13.0/24",
#                         "route_map": "map01"
#                     },
#                     {
#                         "backdoor": true,
#                         "prefix": "192.2.13.0/24"
#                     }
#                 ]
#             },
#             {
#                 "afi": "ipv6",
#                 "redistribute": [
#                     {
#                         "metric": 20,
#                         "protocol": "ripng"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 65536,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "route_map": [
#                             {
#                                 "action": "export",
#                                 "route_map": "map01"
#                             }
#                         ],
#                         "soft_reconfiguration": true
#                     }
#                 ],
#                 "neighbor_address": "192.0.2.25"
#             },
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv6",
#                         "attribute_unchanged": {
#                             "next_hop": true
#                         }
#                     }
#                 ],
#                 "neighbor_address": "203.0.113.5"
#             }
#         ]
#

# Using gathered:

# Native config:

# vyos@vyos:~$ show configuration commands | match "set protocols bgp"
# set protocols bgp 100 address-family ipv4-unicast network 35.1.1.0/24 backdoor
# set protocols bgp 100 address-family ipv4-unicast redistribute static metric '50'
# set protocols bgp 100 address-family ipv6-unicast aggregate-address 6601:1:1:1::/64 summary-only
# set protocols bgp 100 address-family ipv6-unicast network 5001:1:1:1::/64 route-map 'map01'
# set protocols bgp 100 address-family ipv6-unicast redistribute static metric '50'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number '4'
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast as-override
# set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med
# set protocols bgp 100 neighbor 100.11.34.12

  - name: gather configs
    vyos.vyos.vyos_bgp_address_family:
      state: gathered

# Module Execution:

# "gathered": {
#         "address_family": [
#             {
#                 "afi": "ipv4",
#                 "networks": [
#                     {
#                         "backdoor": true,
#                         "prefix": "35.1.1.0/24"
#                     }
#                 ],
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             },
#             {
#                 "afi": "ipv6",
#                 "aggregate_address": [
#                     {
#                         "prefix": "6601:1:1:1::/64",
#                         "summary_only": true
#                     }
#                 ],
#                 "networks": [
#                     {
#                         "prefix": "5001:1:1:1::/64",
#                         "route_map": "map01"
#                     }
#                 ],
#                 "redistribute": [
#                     {
#                         "metric": 50,
#                         "protocol": "static"
#                     }
#                 ]
#             }
#         ],
#         "as_number": 100,
#         "neighbors": [
#             {
#                 "address_family": [
#                     {
#                         "afi": "ipv4",
#                         "allowas_in": 4,
#                         "as_override": true,
#                         "attribute_unchanged": {
#                             "med": true
#                         }
#                     }
#                 ],
#                 "neighbor_address": "20.33.1.1/24"
#             }
#         ]

# Using rendered:

  - name: Render
    vyos.vyos.vyos_bgp_address_family:
      config:
        as_number: "100"
        address_family:
          - afi: "ipv4"
            redistribute:
              - protocol: "static"
                metric: 50
        neighbors:
          - neighbor_address: "20.33.1.1/24"
            address_family:
              - afi: "ipv4"
                allowas_in: 4
                as_override: True
                attribute_unchanged:
                  med: True
              - afi: "ipv6"
                default_originate: "map01"
                distribute_list:
                  - action: "export"
                    acl: 10
          - neighbor_address: "100.11.34.12"
            address_family:
              - afi: "ipv4"
                maximum_prefix: 45
                nexthop_self: True
                route_map:
                  - action: "export"
                    route_map: "map01"
                  - action: "import"
                    route_map: "map01"
                weight: 50
      state: rendered

# Module Execution:

# "rendered": [
#         "set protocols bgp 100 address-family ipv4-unicast redistribute static metric 50",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast allowas-in number 4",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast as-override",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv4-unicast attribute-unchanged med",
#         "set protocols bgp 100  neighbor 20.33.1.1/24 address-family ipv6-unicast default-originate route-map map01",
#         "set protocols bgp 100 neighbor 20.33.1.1/24 address-family ipv6-unicast distribute-list export 10",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast maximum-prefix 45",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast nexthop-self",
#         "set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map export map01",
#         "set protocols bgp 100 neighbor 100.11.34.12 address-family ipv4-unicast route-map import map01",
#         "set protocols bgp 100  neighbor 100.11.34.12 address-family ipv4-unicast weight 50"
#     ]
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Gomathi Selvi Srinivasan (@GomathiselviS)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/vyos.vyos/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/vyos.vyos" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/vyos/vyos/vyos_bgp_address_family_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/vyos/vyos/vyos_bgp_address_family_module.html</a>
  </p>
</div>
