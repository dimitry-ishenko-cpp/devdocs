<section id="ansible-builtin-meta-module-execute-ansible-actions"> <h1>ansible.builtin.meta module – Execute Ansible ‘actions’</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of <code>ansible-core</code> and included in all Ansible installations. In most cases, you can use the short module name <code>meta</code> even without specifying the <a class="reference internal" href="../../../collections_guide/collections_using_playbooks.html#collections-keyword"><span class="std std-ref">collections keyword</span></a>. However, we recommend you use the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-Fully-Qualified-Collection-Name-FQCN"><span class="xref std std-term">Fully Qualified Collection Name (FQCN)</span></a> <code>ansible.builtin.meta</code> for easy linking to the module documentation and to avoid conflicting with other collections that may have the same module name.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#attributes" id="id3">Attributes</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Meta tasks are a special kind of task which can influence Ansible internal execution or state.</li> <li>Meta tasks can be used anywhere within your playbook.</li> <li>This module is also supported for Windows targets.</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-parameter-free-form"><strong>free_form</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>This module takes a free form command, as a string. There is not an actual option named “free form”. See the examples!</p> <p><code>flush_handlers</code> makes Ansible run any handler tasks which have thus far been notified. Ansible inserts these tasks internally at certain points to implicitly trigger handler runs (after pre/post tasks, the final role execution, and the main tasks section of your plays).</p> <p><code>refresh_inventory</code> (added in Ansible 2.0) forces the reload of the inventory, which in the case of dynamic inventory scripts means they will be re-executed. If the dynamic inventory script is using a cache, Ansible cannot know this and has no way of refreshing it (you can disable the cache or, if available for your specific inventory datasource (e.g. aws), you can use the an inventory plugin instead of an inventory script). This is mainly useful when additional hosts are created and users wish to use them instead of using the <a class="reference internal" href="add_host_module.html#ansible-collections-ansible-builtin-add-host-module"><span class="std std-ref">ansible.builtin.add_host</span></a> module.</p> <p><code>noop</code> (added in Ansible 2.0) This literally does ‘nothing’. It is mainly used internally and not recommended for general use.</p> <p><code>clear_facts</code> (added in Ansible 2.1) causes the gathered facts for the hosts specified in the play’s list of hosts to be cleared, including the fact cache.</p> <p><code>clear_host_errors</code> (added in Ansible 2.1) clears the failed state (if any) from hosts specified in the play’s list of hosts.</p> <p><code>end_play</code> (added in Ansible 2.2) causes the play to end without failing the host(s). Note that this affects all hosts.</p> <p><code>reset_connection</code> (added in Ansible 2.3) interrupts a persistent connection (i.e. ssh + control persist)</p> <p><code>end_host</code> (added in Ansible 2.8) is a per-host variation of <code>end_play</code>. Causes the play to end for the current host without failing it.</p> <p><code>end_batch</code> (added in Ansible 2.12) causes the current batch (see <code>serial</code>) to end without failing the host(s). Note that with <code>serial=0</code> or undefined this behaves the same as <code>end_play</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"clear_facts"</code></li> <li><code>"clear_host_errors"</code></li> <li><code>"end_host"</code></li> <li><code>"end_play"</code></li> <li><code>"flush_handlers"</code></li> <li><code>"noop"</code></li> <li><code>"refresh_inventory"</code></li> <li><code>"reset_connection"</code></li> <li><code>"end_batch"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="attributes"> <h2>Attributes</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Attribute</p></th> <th class="head"><p>Support</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-action"><strong>action</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Indicates this has a corresponding action plugin so some parts of the options can be executed on the controller</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-async"><strong>async</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Supports being used with the <code>async</code> keyword</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-become"><strong>become</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Is usable alongside become keywords</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-bypass-host-loop"><strong>bypass_host_loop</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-partial">partial</strong></p> <p>Some of the subactions ignore the host loop, see the description above for each specific action for the exceptions</p> </div></td> <td><div class="ansible-option-cell">
<p>Forces a ‘global’ task that does not execute per host, this bypasses per host templating and serial, throttle and other loop considerations</p> <p>Conditionals will work as if <code>run_once</code> is being used, variables used will be from the first available host</p> <p>This action will not work normally outside of lockstep strategies</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-bypass-task-loop"><strong>bypass_task_loop</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-partial">partial</strong></p> <p>Most of the subactions ignore the task loop, see the description above for each specific action for the exceptions</p> </div></td> <td><div class="ansible-option-cell">
<p>These tasks ignore the <code>loop</code> and <code>with_</code> keywords</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-check-mode"><strong>check_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-partial">partial</strong></p> <p>While these actions don’t modify the targets directly they do change possible states of the target within the run</p> </div></td> <td><div class="ansible-option-cell">
<p>Can run in check_mode and return changed status prediction without modifying target, if not supported the action will be skipped.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-connection"><strong>connection</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-partial">partial</strong></p> <p>Most options in this action do not use a connection, except <code>reset_connection</code> which still does not connect to the remote</p> </div></td> <td><div class="ansible-option-cell">
<p>Uses the target’s configured connection information to execute code on it</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-core"><strong>core</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-full">full</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>This is a ‘core engine’ feature and is not implemented like most task actions, so it is not overridable in any way via the plugin system.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-delegation"><strong>delegation</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Can be used in conjunction with delegate_to and related keywords</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-diff-mode"><strong>diff_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Will return details on what has changed (or possibly needs changing in check_mode), when in diff mode</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-ignore-conditional"><strong>ignore_conditional</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-partial">partial</strong></p> <p>Only some options support conditionals and when they do they act ‘bypassing the host loop’, taking the values from first available host</p> </div></td> <td><div class="ansible-option-cell">
<p>The action is not subject to conditional execution so it will ignore the <code>when:</code> keyword</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-platform"><strong>platform</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-property">Platforms:</strong> <strong class="ansible-attribute-support-full">all</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Target OS/families that can be operated against</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-tags"><strong>tags</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-full">full</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Allows for the ‘tags’ keyword to control the selection of this action for execution</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-meta-module-attribute-until"><strong>until</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Denotes if this action obeys until/retry/poll keywords</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>
<code>clear_facts</code> will remove the persistent facts from <a class="reference internal" href="set_fact_module.html#ansible-collections-ansible-builtin-set-fact-module"><span class="std std-ref">ansible.builtin.set_fact</span></a> using <code><a class="reference internal" href="set_fact_module.html#ansible-collections-ansible-builtin-set-fact-module-parameter-cacheable"><span class="std std-ref">cacheable=True</span></a></code>, but not the current host variable it creates for the current run.</li> <li>Skipping <a class="reference internal" href="#ansible-collections-ansible-builtin-meta-module"><span class="std std-ref">ansible.builtin.meta</span></a> tasks with tags is not supported before Ansible 2.11.</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="assert_module.html#ansible-collections-ansible-builtin-assert-module"><span class="std std-ref">ansible.builtin.assert</span></a></dt>
<dd>
<p>Asserts given expressions are true.</p> </dd> <dt><a class="reference internal" href="fail_module.html#ansible-collections-ansible-builtin-fail-module"><span class="std std-ref">ansible.builtin.fail</span></a></dt>
<dd>
<p>Fail with custom message.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># Example showing flushing handlers on demand, not at end of play
- ansible.builtin.template:
    src: new.j2
    dest: /etc/config.txt
  notify: myhandler

- name: Force all notified handlers to run at this point, not waiting for normal sync points
  ansible.builtin.meta: flush_handlers

# Example showing how to refresh inventory during play
- name: Reload inventory, useful with dynamic inventories when play makes changes to the existing hosts
  cloud_guest:            # this is fake module
    name: newhost
    state: present

- name: Refresh inventory to ensure new instances exist in inventory
  ansible.builtin.meta: refresh_inventory

# Example showing how to clear all existing facts of targeted hosts
- name: Clear gathered facts from all currently targeted hosts
  ansible.builtin.meta: clear_facts

# Example showing how to continue using a failed target
- name: Bring host back to play after failure
  ansible.builtin.copy:
    src: file
    dest: /etc/file
  remote_user: imightnothavepermission

- ansible.builtin.meta: clear_host_errors

# Example showing how to reset an existing connection
- ansible.builtin.user:
    name: '{{ ansible_user }}'
    groups: input

- name: Reset ssh connection to allow user changes to affect 'current login user'
  ansible.builtin.meta: reset_connection

# Example showing how to end the play for specific targets
- name: End the play for hosts that run CentOS 6
  ansible.builtin.meta: end_host
  when:
  - ansible_distribution == 'CentOS'
  - ansible_distribution_major_version == '6'
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Ansible Core Team</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible/ansible/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible/ansible" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-ansible-builtin"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/meta_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/meta_module.html</a>
  </p>
</div>
