<section id="ansible-builtin-winrm-connection-run-tasks-over-microsoft-s-winrm"> <h1>ansible.builtin.winrm connection – Run tasks over Microsoft’s WinRM</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This connection plugin is part of <code>ansible-core</code> and included in all Ansible installations. In most cases, you can use the short plugin name <code>winrm</code>. However, we recommend you use the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-Fully-Qualified-Collection-Name-FQCN"><span class="xref std std-term">Fully Qualified Collection Name (FQCN)</span></a> <code>ansible.builtin.winrm</code> for easy linking to the plugin documentation and to avoid conflicting with other collections that may have the same connection plugin name.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Run commands or put/fetch on a target via WinRM</li> <li>This plugin allows extra arguments to be passed that are supported by the protocol but not explicitly defined here. They should take the form of variables declared with the following pattern <code>ansible_winrm_&lt;option&gt;</code>.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-ansible-builtin-winrm-connection-requirements">Requirements</h2> <p>The below requirements are needed on the local controller node that executes this connection.</p> <ul class="simple"> <li>pywinrm (python library)</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-connection-timeout"><strong>connection_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Despite its name, sets both the ‘operation’ and ‘read’ timeout settings for the WinRM connection.</p> <p>The operation timeout belongs to the WS-Man layer and runs on the winRM-service on the managed windows host.</p> <p>The read timeout belongs to the underlying python Request call (http-layer) and runs on the ansible controller.</p> <p>The operation timeout sets the WS-Man ‘Operation timeout’ that runs on the managed windows host. The operation timeout specifies how long a command will run on the winRM-service before it sends the message ‘WinRMOperationTimeoutError’ back to the client. The client (silently) ignores this message and starts a new instance of the operation timeout, waiting for the command to finish (long running commands).</p> <p>The read timeout sets the client HTTP-request timeout and specifies how long the client (ansible controller) will wait for data from the server to come back over the HTTP-connection (timeout for waiting for in-between messages from the server). When this timer expires, an exception will be thrown and the ansible connection will be terminated with the error message ‘Read timed out’</p> <p>To avoid the above exception to be thrown, the read timeout will be set to 10 seconds higher than the WS-Man operation timeout, thus make the connection more robust on networks with long latency and/or many hops between server and client network wise.</p> <p>Setting the difference between the operation and the read timeout to 10 seconds aligns it to the defaults used in the winrm-module and the PSRP-module which also uses 10 seconds (30 seconds for read timeout and 20 seconds for operation timeout)</p> <p>Corresponds to the <code>operation_timeout_sec</code> and <code>read_timeout_sec</code> args in pywinrm so avoid setting these vars with this one.</p> <p>The default value is whatever is set in the installed version of pywinrm.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_connection_timeout</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-kerberos-command"><strong>kerberos_command</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>kerberos command to use to request a authentication ticket</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"kinit"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_kinit_cmd</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-kerberos-mode"><strong>kerberos_mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>kerberos usage mode.</p> <p>The managed option means Ansible will obtain kerberos ticket.</p> <p>While the manual one means a ticket must already have been obtained by the user.</p> <p>If having issues with Ansible freezing when trying to obtain the Kerberos ticket, you can either set this to <code>manual</code> and obtain it outside Ansible or install <code>pexpect</code> through pip and try again.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"managed"</code></li> <li><code>"manual"</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_kinit_mode</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-kinit-args"><strong>kinit_args</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.11</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Extra arguments to pass to <code>kinit</code> when getting the Kerberos authentication ticket.</p> <p>By default no extra arguments are passed into <code>kinit</code> unless <em>ansible_winrm_kerberos_delegation</em> is also set. In that case <code>-f</code> is added to the <code>kinit</code> args so a forwardable ticket is retrieved.</p> <p>If set, the args will overwrite any existing defaults for <code>kinit</code>, including <code>-f</code> for a delegated ticket.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_kinit_args</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-kinit-env-vars"><strong>kinit_env_vars</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.12</em></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of environment variables to pass through to <code>kinit</code> when getting the Kerberos authentication ticket.</p> <p>By default no environment variables are passed through and <code>kinit</code> is run with a blank slate.</p> <p>The environment variable <code>KRB5CCNAME</code> cannot be specified here as it’s used to store the temp Kerberos ticket used by WinRM.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[winrm]
kinit_env_vars =
</pre> </li> <li>Variable: ansible_winrm_kinit_env_vars</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-path"><strong>path</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>URI path to connect to</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"/wsman"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_path</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-pipelining"><strong>pipelining</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Pipelining reduces the number of connection operations required to execute a module on the remote server, by executing many Ansible modules without actual file transfers.</p> <p>This can result in a very significant performance improvement when enabled.</p> <p>However this can conflict with privilege escalation (become). For example, when using sudo operations you must first disable ‘requiretty’ in the sudoers file for the target hosts, which is why this feature is disabled by default.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
pipelining = false
</pre> <pre data-language="YAML+Jinja">[connection]
pipelining = false
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_PIPELINING" id="index-0"><code>ANSIBLE_PIPELINING</code></a>
</li> <li>Variable: ansible_pipelining</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-port"><strong>port</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>port for winrm to connect on remote target</p> <p>The default is the https (5986) port, if using http it should be 5985</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>5986</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_port</li> <li>Variable: ansible_winrm_port</li> <li>Keyword: port</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-remote-addr"><strong>remote_addr</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Address of the windows machine</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"inventory_hostname"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: inventory_hostname</li> <li>Variable: ansible_host</li> <li>Variable: ansible_winrm_host</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-remote-password"><strong id="ansible-collections-ansible-builtin-winrm-connection-parameter-password">remote_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: password</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Authentication password for the <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-winrm-connection-parameter-remote-user"><span class="std std-ref">remote_user</span></a></strong></code>. Can be supplied as CLI option.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_password</li> <li>Variable: ansible_winrm_pass</li> <li>Variable: ansible_winrm_password</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-remote-user"><strong>remote_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The user to log in as to the Windows machine</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_user</li> <li>Variable: ansible_winrm_user</li> <li>Keyword: remote_user</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-scheme"><strong>scheme</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>URI scheme to use</p> <p>If not set, then will default to <code>https</code> or <code>http</code> if <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-winrm-connection-parameter-port"><span class="std std-ref">port</span></a></strong></code> is <code>5985</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"http"</code></li> <li><code>"https"</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_scheme</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-winrm-connection-parameter-transport"><strong>transport</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of winrm transports to attempt to use (ssl, plaintext, kerberos, etc)</p> <p>If None (the default) the plugin will try to automatically guess the correct list</p> <p>The choices available depend on your version of pywinrm</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_winrm_transport</li> </ul> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Ansible Core Team</li> </ul> <div class="admonition hint"> <p class="admonition-title">Hint</p> <p>Configuration entries for each entry type have a low to high priority order. For example, a variable that is lower in the list will override a variable that is higher up.</p> </div> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible/ansible/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible/ansible" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-ansible-builtin"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/winrm_connection.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/winrm_connection.html</a>
  </p>
</div>
