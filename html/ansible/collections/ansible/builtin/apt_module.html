<section id="ansible-builtin-apt-module-manages-apt-packages"> <h1>ansible.builtin.apt module – Manages apt-packages</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of <code>ansible-core</code> and included in all Ansible installations. In most cases, you can use the short module name <code>apt</code> even without specifying the <a class="reference internal" href="../../../collections_guide/collections_using_playbooks.html#collections-keyword"><span class="std std-ref">collections keyword</span></a>. However, we recommend you use the <a class="reference internal" href="https://docs.ansible.com/ansible/latest/reference_appendices/glossary.html#term-Fully-Qualified-Collection-Name-FQCN"><span class="xref std std-term">Fully Qualified Collection Name (FQCN)</span></a> <code>ansible.builtin.apt</code> for easy linking to the module documentation and to avoid conflicting with other collections that may have the same module name.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id7">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id8">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id9">Parameters</a></li> <li><a class="reference internal" href="#attributes" id="id10">Attributes</a></li> <li><a class="reference internal" href="#notes" id="id11">Notes</a></li> <li><a class="reference internal" href="#examples" id="id12">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id13">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manages <em>apt</em> packages (such as for Debian/Ubuntu).</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-ansible-builtin-apt-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python-apt (python 2)</li> <li>python3-apt (python 3)</li> <li>aptitude (before 2.4)</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-allow-change-held-packages"><strong>allow_change_held_packages</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.13</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Allows changing the version of a package which is on the apt hold list</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">    
<p class="ansible-option-title" id="id2"><strong id="ansible-collections-ansible-builtin-apt-module-parameter-allow-downgrade">allow_downgrade</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: allow-downgrade, allow_downgrades, allow-downgrades</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.12</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Corresponds to the <code>--allow-downgrades</code> option for <em>apt</em>.</p> <p>This option enables the named package and version to replace an already installed higher version of that package.</p> <p>Note that setting <code><a class="reference internal" href="#id1"><span class="std std-ref">allow_downgrade=true</span></a></code> can make this module behave in a non-idempotent way.</p> <p>(The task could end up with a set of packages that does not match the complete list of specified packages to install).</p> <p><code><strong><a class="reference internal" href="#id1"><span class="std std-ref">allow_downgrade</span></a></strong></code> is only supported by <code>apt</code> and will be ignored if <code>aptitude</code> is detected or specified.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="id3"><strong id="ansible-collections-ansible-builtin-apt-module-parameter-allow-unauthenticated">allow_unauthenticated</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: allow-unauthenticated</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Ignore if packages cannot be authenticated. This is useful for bootstrapping environments that manage their own apt-key setup.</p> <p><code><strong><a class="reference internal" href="#id3"><span class="std std-ref">allow_unauthenticated</span></a></strong></code> is only supported with <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-state"><span class="std std-ref">state</span></a></strong></code>: <code>install</code>/<code>present</code></p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-autoclean"><strong>autoclean</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>true</code>, cleans the local repository of retrieved package files that can no longer be downloaded.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-autoremove"><strong>autoremove</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>true</code>, remove unused dependency packages for all module states except <code>build-dep</code>. It can also be used as the only option.</p> <p>Previous to version 2.4, autoclean was also an alias for autoremove, now it is its own separate command. See documentation for further information.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-cache-valid-time"><strong>cache_valid_time</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Update the apt cache if it is older than the <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-cache-valid-time"><span class="std std-ref">cache_valid_time</span></a></strong></code>. This option is set in seconds.</p> <p>As of Ansible 2.4, if explicitly set, this sets <code><a class="reference internal" href="#id6"><span class="std std-ref">update_cache=yes</span></a></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>0</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-clean"><strong>clean</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.13</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Run the equivalent of <code>apt-get clean</code> to clear out the local repository of retrieved package files. It removes everything but the lock file from /var/cache/apt/archives/ and /var/cache/apt/archives/partial/.</p> <p>Can be run as part of the package installation (clean runs before install) or as a separate step.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-deb"><strong>deb</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Path to a .deb package on the remote machine.</p> <p>If :// in the path, ansible will attempt to download deb before installing. (Version added 2.1)</p> <p>Requires the <code>xz-utils</code> package to extract the control file of the deb package to install.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="id4"><strong id="ansible-collections-ansible-builtin-apt-module-parameter-default-release">default_release</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: default-release</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Corresponds to the <code>-t</code> option for <em>apt</em> and sets pin priorities</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-dpkg-options"><strong>dpkg_options</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Add dpkg options to apt command. Defaults to ‘-o “Dpkg::Options::=–force-confdef” -o “Dpkg::Options::=–force-confold”’</p> <p>Options should be supplied as comma separated list</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"force-confdef,force-confold"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-fail-on-autoremove"><strong>fail_on_autoremove</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.11</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Corresponds to the <code>--no-remove</code> option for <code>apt</code>.</p> <p>If <code>true</code>, it is ensured that no packages will be removed or the task will fail.</p> <p><code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-fail-on-autoremove"><span class="std std-ref">fail_on_autoremove</span></a></strong></code> is only supported with <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-state"><span class="std std-ref">state</span></a></strong></code> except <code>absent</code>.</p> <p><code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-fail-on-autoremove"><span class="std std-ref">fail_on_autoremove</span></a></strong></code> is only supported by <code>apt</code> and will be ignored if <code>aptitude</code> is detected or specified.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-force"><strong>force</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Corresponds to the <code>--force-yes</code> to <em>apt-get</em> and implies <code><a class="reference internal" href="#id3"><span class="std std-ref">allow_unauthenticated=yes</span></a></code> and <code><a class="reference internal" href="#id1"><span class="std std-ref">allow_downgrade=yes</span></a></code></p> <p>This option will disable checking both the packages’ signatures and the certificates of the web servers they are downloaded from.</p> <p>This option *is not* the equivalent of passing the <code>-f</code> flag to <em>apt-get</em> on the command line</p> <p>**This is a destructive operation with the potential to destroy your system, and it should almost never be used.** Please also see <code>man apt-get</code> for more information.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-force-apt-get"><strong>force_apt_get</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Force usage of apt-get instead of aptitude</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="id5"><strong id="ansible-collections-ansible-builtin-apt-module-parameter-install-recommends">install_recommends</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: install-recommends</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Corresponds to the <code>--no-install-recommends</code> option for <em>apt</em>. <code>true</code> installs recommended packages. <code>false</code> does not install recommended packages. By default, Ansible will use the same defaults as the operating system. Suggested packages are never installed.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-lock-timeout"><strong>lock_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.12</em></p> </div></td> <td><div class="ansible-option-cell">
<p>How many seconds will this action wait to acquire a lock on the apt db.</p> <p>Sometimes there is a transitory lock and this will retry at least until timeout is hit.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>60</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">   
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-pkg"><strong id="ansible-collections-ansible-builtin-apt-module-parameter-name">name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: package, pkg</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of package names, like <code>foo</code>, or package specifier with version, like <code>foo=1.0</code> or <code>foo&gt;=1.0</code>. Name wildcards (fnmatch) like <code>apt*</code> and version wildcards like <code>foo=1.0*</code> are also supported.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-only-upgrade"><strong>only_upgrade</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Only upgrade a package if it is already installed.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-policy-rc-d"><strong>policy_rc_d</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in Ansible 2.8</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Force the exit code of /usr/sbin/policy-rc.d.</p> <p>For example, if <em>policy_rc_d=101</em> the installed package will not trigger a service start.</p> <p>If /usr/sbin/policy-rc.d already exists, it is backed up and restored after the package installation.</p> <p>If <code>null</code>, the /usr/sbin/policy-rc.d isn’t created/changed.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-purge"><strong>purge</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Will force purging of configuration files if <code><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-state"><span class="std std-ref">state=absent</span></a></code> or <code><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-autoremove"><span class="std std-ref">autoremove=yes</span></a></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Indicates the desired package state. <code>latest</code> ensures that the latest version is installed. <code>build-dep</code> ensures the package build dependencies are installed. <code>fixed</code> attempt to correct a system with broken dependencies in place.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"absent"</code></li> <li><code>"build-dep"</code></li> <li><code>"latest"</code></li> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"fixed"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="id6"><strong id="ansible-collections-ansible-builtin-apt-module-parameter-update-cache">update_cache</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: update-cache</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Run the equivalent of <code>apt-get update</code> before the operation. Can be run as part of the package installation or as a separate step.</p> <p>Default is not to update the cache.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-update-cache-retries"><strong>update_cache_retries</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in ansible-base 2.10</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Amount of retries if the cache update fails. Also see <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-update-cache-retry-max-delay"><span class="std std-ref">update_cache_retry_max_delay</span></a></strong></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>5</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-update-cache-retry-max-delay"><strong>update_cache_retry_max_delay</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in ansible-base 2.10</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Use an exponential backoff delay for each retry (see <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-update-cache-retries"><span class="std std-ref">update_cache_retries</span></a></strong></code>) up to this max delay in seconds.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>12</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-parameter-upgrade"><strong>upgrade</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If yes or safe, performs an aptitude safe-upgrade.</p> <p>If full, performs an aptitude full-upgrade.</p> <p>If dist, performs an apt-get dist-upgrade.</p> <p>Note: This does not upgrade a specific package, use state=latest for that.</p> <p>Note: Since 2.4, apt-get is used as a fall-back if aptitude is not present.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"dist"</code></li> <li><code>"full"</code></li> <li>
<code><strong>"no"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"safe"</code></li> <li><code>"yes"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="attributes"> <h2>Attributes</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Attribute</p></th> <th class="head"><p>Support</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-attribute-check-mode"><strong>check_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-full">full</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Can run in check_mode and return changed status prediction without modifying target, if not supported the action will be skipped.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-attribute-diff-mode"><strong>diff_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-full">full</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Will return details on what has changed (or possibly needs changing in check_mode), when in diff mode</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-attribute-platform"><strong>platform</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-property">Platform:</strong> <strong class="ansible-attribute-support-full">debian</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Target OS/families that can be operated against</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Three of the upgrade modes (<code>full</code>, <code>safe</code> and its alias <code>true</code>) required <code>aptitude</code> up to 2.3, since 2.4 <code>apt-get</code> is used as a fall-back.</li> <li>In most cases, packages installed with apt will start newly installed services by default. Most distributions have mechanisms to avoid this. For example when installing Postgresql-9.5 in Debian 9, creating an executable shell script (/usr/sbin/policy-rc.d) that throws a return code of 101 will stop Postgresql 9.5 starting up after install. Remove the file or its execute permission afterward.</li> <li>The apt-get commandline supports implicit regex matches here but we do not because it can let typos through easier (If you typo <code>foo</code> as <code>fo</code> apt-get would install packages that have “fo” in their name with a warning and a prompt for the user. Since we don’t have warnings and prompts before installing, we disallow this.Use an explicit fnmatch pattern if you want wildcarding)</li> <li>When used with a <code>loop:</code> each package will be processed individually, it is much more efficient to pass the list directly to the <code><strong><a class="reference internal" href="#ansible-collections-ansible-builtin-apt-module-parameter-name"><span class="std std-ref">name</span></a></strong></code> option.</li> <li>When <code><strong><a class="reference internal" href="#id4"><span class="std std-ref">default_release</span></a></strong></code> is used, an implicit priority of 990 is used. This is the same behavior as <code>apt-get -t</code>.</li> <li>When an exact version is specified, an implicit priority of 1001 is used.</li> <li>If the interpreter can’t import ``python-apt``/``python3-apt`` the module will check for it in system-owned interpreters as well. If the dependency can’t be found, the module will attempt to install it. If the dependency is found or installed, the module will be respawned under the correct interpreter.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Install apache httpd  (state=present is optional)
  ansible.builtin.apt:
    name: apache2
    state: present

- name: Update repositories cache and install "foo" package
  ansible.builtin.apt:
    name: foo
    update_cache: yes

- name: Remove "foo" package
  ansible.builtin.apt:
    name: foo
    state: absent

- name: Install the package "foo"
  ansible.builtin.apt:
    name: foo

- name: Install a list of packages
  ansible.builtin.apt:
    pkg:
    - foo
    - foo-tools

- name: Install the version '1.00' of package "foo"
  ansible.builtin.apt:
    name: foo=1.00

- name: Update the repository cache and update package "nginx" to latest version using default release squeeze-backport
  ansible.builtin.apt:
    name: nginx
    state: latest
    default_release: squeeze-backports
    update_cache: yes

- name: Install the version '1.18.0' of package "nginx" and allow potential downgrades
  ansible.builtin.apt:
    name: nginx=1.18.0
    state: present
    allow_downgrade: yes

- name: Install zfsutils-linux with ensuring conflicted packages (e.g. zfs-fuse) will not be removed.
  ansible.builtin.apt:
    name: zfsutils-linux
    state: latest
    fail_on_autoremove: yes

- name: Install latest version of "openjdk-6-jdk" ignoring "install-recommends"
  ansible.builtin.apt:
    name: openjdk-6-jdk
    state: latest
    install_recommends: no

- name: Update all packages to their latest version
  ansible.builtin.apt:
    name: "*"
    state: latest

- name: Upgrade the OS (apt-get dist-upgrade)
  ansible.builtin.apt:
    upgrade: dist

- name: Run the equivalent of "apt-get update" as a separate step
  ansible.builtin.apt:
    update_cache: yes

- name: Only run "update_cache=yes" if the last one is more than 3600 seconds ago
  ansible.builtin.apt:
    update_cache: yes
    cache_valid_time: 3600

- name: Pass options to dpkg on run
  ansible.builtin.apt:
    upgrade: dist
    update_cache: yes
    dpkg_options: 'force-confold,force-confdef'

- name: Install a .deb package
  ansible.builtin.apt:
    deb: /tmp/mypackage.deb

- name: Install the build dependencies for package "foo"
  ansible.builtin.apt:
    pkg: foo
    state: build-dep

- name: Install a .deb package from the internet
  ansible.builtin.apt:
    deb: https://example.com/python-ppq_0.1-1_all.deb

- name: Remove useless packages from the cache
  ansible.builtin.apt:
    autoclean: yes

- name: Remove dependencies that are no longer required
  ansible.builtin.apt:
    autoremove: yes

- name: Remove dependencies that are no longer required and purge their configuration files
  ansible.builtin.apt:
    autoremove: yes
    purge: true

- name: Run the equivalent of "apt-get clean" as a separate step
  ansible.builtin.apt:
    clean: yes
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-return-cache-update-time"><strong>cache_update_time</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>time of the last cache update (0 if unknown)</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success, in some cases</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>1425828348000</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-return-cache-updated"><strong>cache_updated</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>if the cache was updated or not</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success, in some cases</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>true</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-return-stderr"><strong>stderr</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>error output from apt</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success, when needed</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"AH00558: apache2: Could not reliably determine the server's fully qualified domain name, using 127.0.1.1. Set the 'ServerName' directive globally to ..."</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-builtin-apt-module-return-stdout"><strong>stdout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>output from apt</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success, when needed</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"Reading package lists...\nBuilding dependency tree...\nReading state information...\nThe following extra packages will be installed:\n  apache2-bin ..."</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Matthew Williams (@mgwilliams)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible/ansible/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible/ansible" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-ansible-builtin"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html</a>
  </p>
</div>
