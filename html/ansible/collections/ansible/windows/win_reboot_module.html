<section id="ansible-windows-win-reboot-module-reboot-a-windows-machine"> <h1>ansible.windows.win_reboot module â€“ Reboot a windows machine</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/ansible/windows/">ansible.windows collection</a> (version 2.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install ansible.windows</code>.</p> <p>To use it in a playbook, specify: <code>ansible.windows.win_reboot</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Unconditionally reboot a Windows machine, wait for it to go down, come back up, and respond to commands.</li> <li>For non-Windows targets, use the <a class="reference internal" href="../builtin/reboot_module.html#ansible-collections-ansible-builtin-reboot-module"><span class="std std-ref">ansible.builtin.reboot</span></a> module instead.</li> </ul> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module has a corresponding <a class="reference internal" href="../../../plugins/action.html#action-plugins"><span class="std std-ref">action plugin</span></a>.</p> </div> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-boot-time-command"><strong>boot_time_command</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Command to run that returns a unique string indicating the last time the system was booted.</p> <p>Setting this to a command that has different output each time it is run will cause the task to fail.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"(Get-CimInstance -ClassName Win32_OperatingSystem -Property LastBootUpTime).LastBootUpTime.ToFileTime()"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-connect-timeout-sec"><strong id="ansible-collections-ansible-windows-win-reboot-module-parameter-connect-timeout">connect_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: connect_timeout_sec</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Maximum seconds to wait for a single successful TCP connection to the WinRM endpoint before trying again.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>5.0</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-msg"><strong>msg</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Message to display to users.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"Reboot initiated by Ansible"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-post-reboot-delay-sec"><strong id="ansible-collections-ansible-windows-win-reboot-module-parameter-post-reboot-delay">post_reboot_delay</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: post_reboot_delay_sec</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Seconds to wait after the reboot command was successful before attempting to validate the system rebooted successfully.</p> <p>This is useful if you want wait for something to settle despite your connection already working.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>0.0</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-pre-reboot-delay-sec"><strong id="ansible-collections-ansible-windows-win-reboot-module-parameter-pre-reboot-delay">pre_reboot_delay</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: pre_reboot_delay_sec</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Seconds to wait before reboot. Passed as a parameter to the reboot command.</p> <p>The minimum version is <code>2</code> seconds and cannot be set lower.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>2.0</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-reboot-timeout-sec"><strong id="ansible-collections-ansible-windows-win-reboot-module-parameter-reboot-timeout">reboot_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: reboot_timeout_sec</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Maximum seconds to wait for machine to re-appear on the network and respond to a test command.</p> <p>This timeout is evaluated separately for both reboot verification and test command success so maximum clock time is actually twice this value.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>600.0</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-parameter-test-command"><strong>test_command</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Command to expect success for to determine the machine is ready for management.</p> <p>By default this test command is a custom one to detect when the Windows Logon screen is up and ready to accept credentials. Using a custom command will replace this behaviour and just run the command specified.</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>If a shutdown was already scheduled on the system, <a class="reference internal" href="#ansible-collections-ansible-windows-win-reboot-module"><span class="std std-ref">ansible.windows.win_reboot</span></a> will abort the scheduled shutdown and enforce its own shutdown.</li> <li>Beware that when <a class="reference internal" href="#ansible-collections-ansible-windows-win-reboot-module"><span class="std std-ref">ansible.windows.win_reboot</span></a> returns, the Windows system may not have settled yet and some base services could be in limbo. This can result in unexpected behavior. Check the examples for ways to mitigate this. This has been slightly mitigated in the <code>1.6.0</code> release of <code>ansible.windows</code> but it is not guranteed to always wait until the logon prompt is shown.</li> <li>The connection user must have the <code>SeRemoteShutdownPrivilege</code> privilege enabled, see <a class="reference external" href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/force-shutdown-from-a-remote-system">https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/force-shutdown-from-a-remote-system</a> for more information.</li> <li>This module is equivalent to using the /f forced option for reboot on a windows host</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../builtin/reboot_module.html#ansible-collections-ansible-builtin-reboot-module"><span class="std std-ref">ansible.builtin.reboot</span></a></dt>
<dd>
<p>Reboot a machine.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Reboot the machine with all defaults
  ansible.windows.win_reboot:

- name: Reboot a slow machine that might have lots of updates to apply
  ansible.windows.win_reboot:
    reboot_timeout: 3600

# Install a Windows feature and reboot if necessary
- name: Install IIS Web-Server
  ansible.windows.win_feature:
    name: Web-Server
  register: iis_install

- name: Reboot when Web-Server feature requires it
  ansible.windows.win_reboot:
  when: iis_install.reboot_required

# One way to ensure the system is reliable, is to set WinRM to a delayed startup
- name: Ensure WinRM starts when the system has settled and is ready to work reliably
  ansible.windows.win_service:
    name: WinRM
    start_mode: delayed

# Additionally, you can add a delay before running the next task
- name: Reboot a machine that takes time to settle after being booted
  ansible.windows.win_reboot:
    post_reboot_delay: 120

# Or you can make win_reboot validate exactly what you need to work before running the next task
- name: Validate that the netlogon service has started, before running the next task
  ansible.windows.win_reboot:
    test_command: 'exit (Get-Service -Name Netlogon).Status -ne "Running"'
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-return-elapsed"><strong>elapsed</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The number of seconds that elapsed waiting for the system to be rebooted.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>23.2</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-reboot-module-return-rebooted"><strong>rebooted</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>True if the machine was rebooted.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>true</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Matt Davis (@nitzmahone)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/ansible.windows/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/ansible.windows" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-ansible-windows"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_reboot_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_reboot_module.html</a>
  </p>
</div>
