<h1 id="ansible-windows-win-user-manages-local-windows-user-accounts">ansible.windows.win_user – Manages local Windows user accounts</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ansible/windows">ansible.windows collection</a> (version 1.7.3).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install ansible.windows</code>.</p> <p>To use it in a playbook, specify: <code>ansible.windows.win_user</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Manages local Windows user accounts.</li> <li>For non-Windows targets, use the <a class="reference internal" href="../builtin/user_module.html#ansible-collections-ansible-builtin-user-module"><span class="std std-ref">ansible.builtin.user</span></a> module instead.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>account_disabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<code>yes</code> will disable the user account.</div> <div>
<code>no</code> will clear the disabled flag.</div> </td> </tr> <tr> <td colspan="1">  <b>account_locked</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Only <code>no</code> can be set and it will unlock the user account if locked.</div> </td> </tr> <tr> <td colspan="1">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Description of the user.</div> </td> </tr> <tr> <td colspan="1">  <b>fullname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Full name of the user.</div> </td> </tr> <tr> <td colspan="1">  <b>groups</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Adds or removes the user from this comma-separated list of groups, depending on the value of <em>groups_action</em>.</div> <div>When <em>groups_action</em> is <code>replace</code> and <em>groups</em> is set to the empty string ('groups='), the user is removed from all groups.</div> <div>Since <code>ansible.windows v1.5.0</code> it is possible to specify a group using it's security identifier.</div> </td> </tr> <tr> <td colspan="1">  <b>groups_action</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>add</li> <li><div>
<b>replace</b> ←</div></li> <li>remove</li> </ul> </td> <td> <div>If <code>add</code>, the user is added to each group in <em>groups</em> where not already a member.</div> <div>If <code>replace</code>, the user is added as a member of each group in <em>groups</em> and removed from any other groups.</div> <div>If <code>remove</code>, the user is removed from each group in <em>groups</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>home_directory</b>  <div> <span>string</span> </div> <div> added in 1.0.0 of ansible.windows </div> </td> <td> </td> <td> <div>The designated home directory of the user.</div> </td> </tr> <tr> <td colspan="1">  <b>login_script</b>  <div> <span>string</span> </div> <div> added in 1.0.0 of ansible.windows </div> </td> <td> </td> <td> <div>The login script of the user.</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Name of the user to create, remove or modify.</div> </td> </tr> <tr> <td colspan="1">  <b>password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Optionally set the user's password to this (plain text) value.</div> </td> </tr> <tr> <td colspan="1">  <b>password_expired</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<code>yes</code> will require the user to change their password at next login.</div> <div>
<code>no</code> will clear the expired password flag.</div> </td> </tr> <tr> <td colspan="1">  <b>password_never_expires</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<code>yes</code> will set the password to never expire.</div> <div>
<code>no</code> will allow the password to expire.</div> </td> </tr> <tr> <td colspan="1">  <b>profile</b>  <div> <span>string</span> </div> <div> added in 1.0.0 of ansible.windows </div> </td> <td> </td> <td> <div>The profile path of the user.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li><div>
<b>present</b> ←</div></li> <li>query</li> </ul> </td> <td> <div>When <code>absent</code>, removes the user account if it exists.</div> <div>When <code>present</code>, creates or updates the user account.</div> <div>When <code>query</code>, retrieves the user account details without making any changes.</div> </td> </tr> <tr> <td colspan="1">  <b>update_password</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>always</b> ←</div></li> <li>on_create</li> </ul> </td> <td> <div>
<code>always</code> will update passwords if they differ.</div> <div>
<code>on_create</code> will only set the password for newly created users.</div> </td> </tr> <tr> <td colspan="1">  <b>user_cannot_change_password</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<code>yes</code> will prevent the user from changing their password.</div> <div>
<code>no</code> will allow the user to change their password.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>The return values are based on the user object after the module options have been set. When running in check mode the values will still reflect the existing user settings and not what they would have been changed to.</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../builtin/user_module.html#ansible-collections-ansible-builtin-user-module"><span class="std std-ref">ansible.builtin.user</span></a></dt>
<dd>
<p>The official documentation on the <strong>ansible.builtin.user</strong> module.</p> </dd> <dt><a class="reference internal" href="win_domain_membership_module.html#ansible-collections-ansible-windows-win-domain-membership-module"><span class="std std-ref">ansible.windows.win_domain_membership</span></a></dt>
<dd>
<p>The official documentation on the <strong>ansible.windows.win_domain_membership</strong> module.</p> </dd> <dt><a class="reference internal" href="../../community/windows/win_domain_user_module.html#ansible-collections-community-windows-win-domain-user-module"><span class="std std-ref">community.windows.win_domain_user</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.windows.win_domain_user</strong> module.</p> </dd> <dt><a class="reference internal" href="win_group_module.html#ansible-collections-ansible-windows-win-group-module"><span class="std std-ref">ansible.windows.win_group</span></a></dt>
<dd>
<p>The official documentation on the <strong>ansible.windows.win_group</strong> module.</p> </dd> <dt><a class="reference internal" href="win_group_membership_module.html#ansible-collections-ansible-windows-win-group-membership-module"><span class="std std-ref">ansible.windows.win_group_membership</span></a></dt>
<dd>
<p>The official documentation on the <strong>ansible.windows.win_group_membership</strong> module.</p> </dd> <dt><a class="reference internal" href="../../community/windows/win_user_profile_module.html#ansible-collections-community-windows-win-user-profile-module"><span class="std std-ref">community.windows.win_user_profile</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.windows.win_user_profile</strong> module.</p> </dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Ensure user bob is present
  ansible.windows.win_user:
    name: bob
    password: B0bP4ssw0rd
    state: present
    groups:
      - Users

- name: Ensure user bob is absent
  ansible.windows.win_user:
    name: bob
    state: absent
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>account_disabled</b>  <div> <span>boolean</span> </div> </td> <td>user exists</td> <td> <div>Whether the user is disabled.</div> <br> </td> </tr> <tr> <td colspan="1">  <b>account_locked</b>  <div> <span>boolean</span> </div> </td> <td>user exists</td> <td> <div>Whether the user is locked.</div> <br> </td> </tr> <tr> <td colspan="1">  <b>description</b>  <div> <span>string</span> </div> </td> <td>user exists</td> <td> <div>The description set for the user.</div> <br> <div><b>Sample:</b></div> <div>Username for test</div> </td> </tr> <tr> <td colspan="1">  <b>fullname</b>  <div> <span>string</span> </div> </td> <td>user exists</td> <td> <div>The full name set for the user.</div> <br> <div><b>Sample:</b></div> <div>Test Username</div> </td> </tr> <tr> <td colspan="1">  <b>groups</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td>user exists</td> <td> <div>A list of groups and their ADSI path the user is a member of.</div> <br> <div><b>Sample:</b></div> <div>[{'name': 'Administrators', 'path': 'WinNT://WORKGROUP/USER-PC/Administrators'}]</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>The name of the user</div> <br> <div><b>Sample:</b></div> <div>username</div> </td> </tr> <tr> <td colspan="1">  <b>password_expired</b>  <div> <span>boolean</span> </div> </td> <td>user exists</td> <td> <div>Whether the password is expired.</div> <br> </td> </tr> <tr> <td colspan="1">  <b>password_never_expires</b>  <div> <span>boolean</span> </div> </td> <td>user exists</td> <td> <div>Whether the password is set to never expire.</div> <br> <div><b>Sample:</b></div> <div>True</div> </td> </tr> <tr> <td colspan="1">  <b>path</b>  <div> <span>string</span> </div> </td> <td>user exists</td> <td> <div>The ADSI path for the user.</div> <br> <div><b>Sample:</b></div> <div>WinNT://WORKGROUP/USER-PC/username</div> </td> </tr> <tr> <td colspan="1">  <b>sid</b>  <div> <span>string</span> </div> </td> <td>user exists</td> <td> <div>The SID for the user.</div> <br> <div><b>Sample:</b></div> <div>S-1-5-21-3322259488-2828151810-3939402796-1001</div> </td> </tr> <tr> <td colspan="1">  <b>user_cannot_change_password</b>  <div> <span>boolean</span> </div> </td> <td>user exists</td> <td> <div>Whether the user can change their own password.</div> <br> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Paul Durivage (@angstwad)</li> <li>Chris Church (@cchurch)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_user_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_user_module.html</a>
  </p>
</div>
