<section id="ansible-windows-win-user-module-manages-local-windows-user-accounts"> <h1>ansible.windows.win_user module – Manages local Windows user accounts</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/ansible/windows/">ansible.windows collection</a> (version 2.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install ansible.windows</code>.</p> <p>To use it in a playbook, specify: <code>ansible.windows.win_user</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manages local Windows user accounts.</li> <li>For non-Windows targets, use the <a class="reference internal" href="../builtin/user_module.html#ansible-collections-ansible-builtin-user-module"><span class="std std-ref">ansible.builtin.user</span></a> module instead.</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-account-disabled"><strong>account_disabled</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>true</code> will disable the user account.</p> <p><code>false</code> will clear the disabled flag.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-account-expires"><strong>account_expires</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.windows 2.4.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Set the account expiration date for the user.</p> <p>This value should be in the format <code>%Y-%m-%d</code> or <code>%Y-%m-%dT%H:%M:%S%z</code>. The timezone can be omitted in the long format and will default to UTC. The format of <code>%z</code> is <code>±HHMM</code>, <code>±HH:MM</code>, or <code>Z</code> for UTC.</p> <p>Set the value to <code>never</code> to remove the account expiration date.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-account-locked"><strong>account_locked</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Only <code>false</code> can be set and it will unlock the user account if locked.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Description of the user.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-fullname"><strong>fullname</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Full name of the user.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-groups"><strong>groups</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Adds or removes the user from this comma-separated list of groups, depending on the value of <em>groups_action</em>.</p> <p>When <em>groups_action</em> is <code>replace</code> and <em>groups</em> is set to the empty string (‘groups=’), the user is removed from all groups.</p> <p>Since <code>ansible.windows v1.5.0</code> it is possible to specify a group using it’s security identifier.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-groups-action"><strong>groups_action</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>add</code>, the user is added to each group in <em>groups</em> where not already a member.</p> <p>If <code>replace</code>, the user is added as a member of each group in <em>groups</em> and removed from any other groups.</p> <p>If <code>remove</code>, the user is removed from each group in <em>groups</em>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"add"</code></li> <li>
<code><strong>"replace"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"remove"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-home-directory"><strong>home_directory</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.windows 1.0.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The designated home directory of the user.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-login-script"><strong>login_script</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.windows 1.0.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The login script of the user.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the user to create, remove or modify.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-password"><strong>password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Optionally set the user’s password to this (plain text) value.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-password-expired"><strong>password_expired</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>true</code> will require the user to change their password at next login.</p> <p><code>false</code> will clear the expired password flag.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-password-never-expires"><strong>password_never_expires</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>true</code> will set the password to never expire.</p> <p><code>false</code> will allow the password to expire.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-profile"><strong>profile</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.windows 1.0.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The profile path of the user.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>When <code>absent</code>, removes the user account if it exists.</p> <p>When <code>present</code>, creates or updates the user account.</p> <p>When <code>query</code>, retrieves the user account details without making any changes.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"absent"</code></li> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"query"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-update-password"><strong>update_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>always</code> will update passwords if they differ.</p> <p><code>on_create</code> will only set the password for newly created users.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"always"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"on_create"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-parameter-user-cannot-change-password"><strong>user_cannot_change_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>true</code> will prevent the user from changing their password.</p> <p><code>false</code> will allow the user to change their password.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>The return values are based on the user object after the module options have been set. When running in check mode the values will still reflect the existing user settings and not what they would have been changed to.</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../builtin/user_module.html#ansible-collections-ansible-builtin-user-module"><span class="std std-ref">ansible.builtin.user</span></a></dt>
<dd>
<p>Manage user accounts.</p> </dd> <dt><a class="reference internal" href="win_domain_membership_module.html#ansible-collections-ansible-windows-win-domain-membership-module"><span class="std std-ref">ansible.windows.win_domain_membership</span></a></dt>
<dd>
<p>Manage domain/workgroup membership for a Windows host.</p> </dd> <dt><a class="reference internal" href="../../community/windows/win_domain_user_module.html#ansible-collections-community-windows-win-domain-user-module"><span class="std std-ref">community.windows.win_domain_user</span></a></dt>
<dd>
<p>Manages Windows Active Directory user accounts.</p> </dd> <dt><a class="reference internal" href="win_group_module.html#ansible-collections-ansible-windows-win-group-module"><span class="std std-ref">ansible.windows.win_group</span></a></dt>
<dd>
<p>Add and remove local groups.</p> </dd> <dt><a class="reference internal" href="win_group_membership_module.html#ansible-collections-ansible-windows-win-group-membership-module"><span class="std std-ref">ansible.windows.win_group_membership</span></a></dt>
<dd>
<p>Manage Windows local group membership.</p> </dd> <dt><a class="reference internal" href="../../community/windows/win_user_profile_module.html#ansible-collections-community-windows-win-user-profile-module"><span class="std std-ref">community.windows.win_user_profile</span></a></dt>
<dd>
<p>Manages the Windows user profiles.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Ensure user bob is present
  ansible.windows.win_user:
    name: bob
    password: B0bP4ssw0rd
    state: present
    groups:
      - Users

- name: Ensure user bob is absent
  ansible.windows.win_user:
    name: bob
    state: absent

- name: Set an account expiration date to the 27th of October 2024 at 2:30PM UTC
  ansible.windows.win_user:
    name: bob
    state: present
    account_expires: '2024-10-27T14:30:00Z'

- name: Set an account expiration 30 days in the future
  ansible.windows.win_user:
    name: bob
    state: present
    account_expires: '{{ "%Y-%m-%dT%H:%M:%S%z" | ansible.builtin.strftime(now().timestamp() + (60 * 60 * 24 * 30)) }}'

- name: Remove account expiration date
  ansible.windows.win_user:
    name: bob
    state: present
    account_expires: never
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-account-disabled"><strong>account_disabled</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the user is disabled.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-account-locked"><strong>account_locked</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the user is locked.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The description set for the user.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"Username for test"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-fullname"><strong>fullname</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The full name set for the user.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"Test Username"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-groups"><strong>groups</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of groups and their ADSI path the user is a member of.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>[{"name": "Administrators", "path": "WinNT://WORKGROUP/USER-PC/Administrators"}]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The name of the user</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"username"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-password-expired"><strong>password_expired</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the password is expired.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-password-never-expires"><strong>password_never_expires</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the password is set to never expire.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>true</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-path"><strong>path</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The ADSI path for the user.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"WinNT://WORKGROUP/USER-PC/username"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-sid"><strong>sid</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The SID for the user.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"S-1-5-21-3322259488-2828151810-3939402796-1001"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-windows-win-user-module-return-user-cannot-change-password"><strong>user_cannot_change_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the user can change their own password.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> user exists</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Paul Durivage (@angstwad)</li> <li>Chris Church (@cchurch)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/ansible.windows/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/ansible.windows" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-ansible-windows"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_user_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/windows/win_user_module.html</a>
  </p>
</div>
