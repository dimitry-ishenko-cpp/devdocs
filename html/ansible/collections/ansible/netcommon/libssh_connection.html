<section id="ansible-netcommon-libssh-connection-run-tasks-using-libssh-for-ssh-connection"> <h1>ansible.netcommon.libssh connection – Run tasks using libssh for ssh connection</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This connection plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/ansible/netcommon/">ansible.netcommon collection</a> (version 6.1.3).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install ansible.netcommon</code>.</p> <p>To use it in a playbook, specify: <code>ansible.netcommon.libssh</code>.</p> </div> <p class="ansible-version-added">New in ansible.netcommon 1.1.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Use the ansible-pylibssh python bindings to connect to targets</li> <li>The python bindings use libssh C library (<a class="reference external" href="https://www.libssh.org/">https://www.libssh.org/</a>) to connect to targets</li> <li>This plugin borrows a lot of settings from the ssh plugin as they both cover the same protocol.</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-config-file"><strong>config_file</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> <p><em class="ansible-option-versionadded">added in ansible.netcommon 5.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Alternate SSH config file location</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[libssh_connection]
config_file = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_CONFIG_FILE" id="index-0"><code>ANSIBLE_LIBSSH_CONFIG_FILE</code></a>
</li> <li>Variable: ansible_libssh_config_file</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-host-key-auto-add"><strong>host_key_auto_add</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>TODO: write it</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[libssh_connection]
host_key_auto_add = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_HOST_KEY_AUTO_ADD" id="index-1"><code>ANSIBLE_LIBSSH_HOST_KEY_AUTO_ADD</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-host-key-checking"><strong>host_key_checking</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Set this to “False” if you want to avoid host key checking by the underlying tools Ansible uses to connect to the host</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
host_key_checking = true
</pre> <pre data-language="YAML+Jinja">[libssh_connection]
host_key_checking = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_HOST_KEY_CHECKING" id="index-2"><code>ANSIBLE_HOST_KEY_CHECKING</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_SSH_HOST_KEY_CHECKING" id="index-3"><code>ANSIBLE_SSH_HOST_KEY_CHECKING</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_HOST_KEY_CHECKING" id="index-4"><code>ANSIBLE_LIBSSH_HOST_KEY_CHECKING</code></a>
</li> <li>Variable: ansible_host_key_checking</li> <li>Variable: ansible_ssh_host_key_checking</li> <li>Variable: ansible_libssh_host_key_checking</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-look-for-keys"><strong>look_for_keys</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>TODO: write it</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[libssh_connection]
look_for_keys = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_LOOK_FOR_KEYS" id="index-5"><code>ANSIBLE_LIBSSH_LOOK_FOR_KEYS</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-password"><strong>password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Secret used to either login the ssh server or as a passphrase for ssh keys that require it</p> <p>Can be set from the CLI via the <code>--ask-pass</code> option.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_password</li> <li>Variable: ansible_ssh_pass</li> <li>Variable: ansible_ssh_password</li> <li>Variable: ansible_libssh_pass</li> <li>Variable: ansible_libssh_password</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-password-prompt"><strong>password_prompt</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.netcommon 3.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Text to match when using keyboard-interactive authentication to determine if the prompt is for the password.</p> <p>Requires ansible-pylibssh version &gt;= 1.0.0</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: ansible_libssh_password_prompt</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-proxy-command"><strong>proxy_command</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Proxy information for running the connection via a jumphost.</p> <p>Also this plugin will scan ‘ssh_args’, ‘ssh_extra_args’ and ‘ssh_common_args’ from the ‘ssh’ plugin settings for proxy information if set.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>""</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[libssh_connection]
proxy_command = ""
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_PROXY_COMMAND" id="index-6"><code>ANSIBLE_LIBSSH_PROXY_COMMAND</code></a>
</li> <li>Variable: ansible_paramiko_proxy_command</li> <li>Variable: ansible_libssh_proxy_command</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-pty"><strong>pty</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>TODO: write it</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[libssh_connection]
pty = true
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_PTY" id="index-7"><code>ANSIBLE_LIBSSH_PTY</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-remote-addr"><strong>remote_addr</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Address of the remote target</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"inventory_hostname"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Variable: inventory_hostname</li> <li>Variable: ansible_host</li> <li>Variable: ansible_ssh_host</li> <li>Variable: ansible_libssh_host</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-remote-user"><strong>remote_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>User to login/authenticate as</p> <p>Can be set from the CLI via the <code>--user</code> or <code>-u</code> options.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
remote_user = VALUE
</pre> <pre data-language="YAML+Jinja">[libssh_connection]
remote_user = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_REMOTE_USER" id="index-8"><code>ANSIBLE_REMOTE_USER</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_LIBSSH_REMOTE_USER" id="index-9"><code>ANSIBLE_LIBSSH_REMOTE_USER</code></a>
</li> <li>Variable: ansible_user</li> <li>Variable: ansible_ssh_user</li> <li>Variable: ansible_libssh_user</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-ssh-args"><strong>ssh_args</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.netcommon 3.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Arguments to pass to all ssh CLI tools.</p> <p>ProxyCommand is the only supported argument.</p> <p>This option is deprecated in favor of <em>proxy_command</em> and will be removed in a release after 2026-01-01.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[ssh_connection]
ssh_args = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_SSH_ARGS" id="index-10"><code>ANSIBLE_SSH_ARGS</code></a>
</li> <li>Variable: ansible_ssh_args</li> <li>CLI argument: –ssh-args</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-ssh-common-args"><strong>ssh_common_args</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.netcommon 3.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Common extra arguments for all ssh CLI tools.</p> <p>ProxyCommand is the only supported argument.</p> <p>This option is deprecated in favor of <em>proxy_command</em> and will be removed in a release after 2026-01-01.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[ssh_connection]
ssh_common_args = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_SSH_COMMON_ARGS" id="index-11"><code>ANSIBLE_SSH_COMMON_ARGS</code></a>
</li> <li>Variable: ansible_ssh_common_args</li> <li>CLI argument: –ssh-common-args</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-ssh-extra-args"><strong>ssh_extra_args</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible.netcommon 3.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Extra arguments exclusive to the ‘ssh’ CLI tool.</p> <p>ProxyCommand is the only supported argument.</p> <p>This option is deprecated in favor of <em>proxy_command</em> and will be removed in a release after 2026-01-01.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[ssh_connection]
ssh_extra_args = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_SSH_EXTRA_ARGS" id="index-12"><code>ANSIBLE_SSH_EXTRA_ARGS</code></a>
</li> <li>Variable: ansible_ssh_extra_args</li> <li>CLI argument: –ssh-extra-args</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-ansible-netcommon-libssh-connection-parameter-use-persistent-connections"><strong>use_persistent_connections</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Toggles the use of persistence for connections</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[defaults]
use_persistent_connections = false
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_USE_PERSISTENT_CONNECTIONS" id="index-13"><code>ANSIBLE_USE_PERSISTENT_CONNECTIONS</code></a>
</li> </ul> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Ansible Networking Team (@ansible-network)</li> </ul> <div class="admonition hint"> <p class="admonition-title">Hint</p> <p>Configuration entries for each entry type have a low to high priority order. For example, a variable that is lower in the list will override a variable that is higher up.</p> </div> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/ansible.netcommon/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/ansible.netcommon" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ansible/netcommon/libssh_connection.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ansible/netcommon/libssh_connection.html</a>
  </p>
</div>
