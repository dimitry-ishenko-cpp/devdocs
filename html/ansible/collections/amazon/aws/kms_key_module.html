<section id="amazon-aws-kms-key-module-perform-various-kms-key-management-tasks"> <h1>amazon.aws.kms_key module – Perform various KMS key management tasks</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/amazon/aws/">amazon.aws collection</a> (version 8.2.1).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install amazon.aws</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>amazon.aws.kms_key</code>.</p> </div> <p class="ansible-version-added">New in amazon.aws 5.0.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manage role/user access to a KMS key.</li> <li>Not designed for encrypting/decrypting.</li> <li>Prior to release 5.0.0 this module was called <a class="reference internal" href="../../community/aws/aws_kms_module.html#ansible-collections-community-aws-aws-kms-module"><span class="std std-ref">community.aws.aws_kms</span></a>. The usage did not change.</li> <li>This module was originally added to <code>community.aws</code> in release 1.0.0.</li> </ul> <p>Aliases: aws_kms</p> </section> <section id="requirements"> <h2 id="ansible-collections-amazon-aws-kms-key-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python &gt;= 3.6</li> <li>boto3 &gt;= 1.26.0</li> <li>botocore &gt;= 1.29.0</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell">    
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-ec2-access-key"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-access-key">access_key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: aws_access_key_id, aws_access_key, ec2_access_key</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>AWS access key ID.</p> <p>See the AWS documentation for more information about access tokens <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys">https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys</a>.</p> <p>The <code>AWS_ACCESS_KEY_ID</code>, <code>AWS_ACCESS_KEY</code> or <code>EC2_ACCESS_KEY</code> environment variables may also be used in decreasing order of preference.</p> <p>The <em>aws_access_key</em> and <em>profile</em> options are mutually exclusive.</p> <p>The <em>aws_access_key_id</em> alias was added in release 5.1.0 for consistency with the AWS botocore SDK.</p> <p>The <em>ec2_access_key</em> alias has been deprecated and will be removed in a release after 2024-12-01.</p> <p>Support for the <code>EC2_ACCESS_KEY</code> environment variable has been deprecated and will be removed in a release after 2024-12-01.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-key-alias"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-alias">alias</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: key_alias</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>An alias for a key.</p> <p>For safety, even though KMS does not require keys to have an alias, this module expects all new keys to be given an alias to make them easier to manage. Existing keys without an alias may be referred to by <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-key-id"><span class="std std-ref">key_id</span></a></strong></code>. Use <a class="reference internal" href="kms_key_info_module.html#ansible-collections-amazon-aws-kms-key-info-module"><span class="std std-ref">amazon.aws.kms_key_info</span></a> to find key ids.</p> <p>Note that passing a <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-key-id"><span class="std std-ref">key_id</span></a></strong></code> and <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-alias"><span class="std std-ref">alias</span></a></strong></code> will only cause a new alias to be added, an alias will never be renamed.</p> <p>The <code>alias/</code> prefix is optional.</p> <p>Required if <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-key-id"><span class="std std-ref">key_id</span></a></strong></code> is not given.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-aws-ca-bundle"><strong>aws_ca_bundle</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The location of a CA Bundle to use when validating SSL certificates.</p> <p>The <code>AWS_CA_BUNDLE</code> environment variable may also be used.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-aws-config"><strong>aws_config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A dictionary to modify the botocore configuration.</p> <p>Parameters can be found in the AWS documentation <a class="reference external" href="https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config">https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config</a>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-debug-botocore-endpoint-logs"><strong>debug_botocore_endpoint_logs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Use a <code>botocore.endpoint</code> logger to parse the unique (rather than total) <code>"resource:action"</code> API calls made during a task, outputing the set to the resource_actions key in the task results. Use the <code>aws_resource_action</code> callback to output to total list made during a playbook.</p> <p>The <code>ANSIBLE_DEBUG_BOTOCORE_LOGS</code> environment variable may also be used.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A description of the CMK.</p> <p>Use a description that helps you decide whether the CMK is appropriate for a task.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-enable-key-rotation"><strong>enable_key_rotation</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the key should be automatically rotated every year.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-enabled"><strong>enabled</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether or not a key is enabled.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">    
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-s3-url"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-aws-endpoint-url">endpoint_url</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: ec2_url, aws_endpoint_url, s3_url</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>URL to connect to instead of the default AWS endpoints. While this can be used to connection to other AWS-compatible services the amazon.aws and community.aws collections are only tested against AWS.</p> <p>The <code>AWS_URL</code> or <code>EC2_URL</code> environment variables may also be used, in decreasing order of preference.</p> <p>The <em>ec2_url</em> and <em>s3_url</em> aliases have been deprecated and will be removed in a release after 2024-12-01.</p> <p>Support for the <code>EC2_URL</code> environment variable has been deprecated and will be removed in a release after 2024-12-01.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-grants"><strong>grants</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of grants to apply to the key. Each item must contain <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-grantee-principal"><span class="std std-ref">grants.grantee_principal</span></a></strong></code>. Each item can optionally contain <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-retiring-principal"><span class="std std-ref">grants.retiring_principal</span></a></strong></code>, <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-operations"><span class="std std-ref">grants.operations</span></a></strong></code>, <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-constraints"><span class="std std-ref">grants.constraints</span></a></strong></code>, <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-name"><span class="std std-ref">grants.name</span></a></strong></code>.</p> <p><code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-grantee-principal"><span class="std std-ref">grants.grantee_principal</span></a></strong></code> and <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants-retiring-principal"><span class="std std-ref">grants.retiring_principal</span></a></strong></code> must be ARNs.</p> <p>For full documentation of suboptions see the boto3 documentation:</p> <p><a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/kms.html#KMS.Client.create_grant">https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/kms.html#KMS.Client.create_grant</a></p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-grants-constraints"><strong>constraints</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Constraints is a dict containing <code>encryption_context_subset</code> or <code>encryption_context_equals</code>, either or both being a dict specifying an encryption context match. See <a class="reference external" href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GrantConstraints.html">https://docs.aws.amazon.com/kms/latest/APIReference/API_GrantConstraints.html</a> or <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/kms.html#KMS.Client.create_grant">https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/kms.html#KMS.Client.create_grant</a></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-grants-grantee-principal"><strong>grantee_principal</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The full ARN of the principal being granted permissions.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-grants-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A friendly name for the grant.</p> <p>Use this value to prevent the unintended creation of duplicate grants when retrying this request.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-grants-operations"><strong>operations</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A list of operations that the grantee may perform using the CMK.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"Decrypt"</code></li> <li><code>"Encrypt"</code></li> <li><code>"GenerateDataKey"</code></li> <li><code>"GenerateDataKeyWithoutPlaintext"</code></li> <li><code>"ReEncryptFrom"</code></li> <li><code>"ReEncryptTo"</code></li> <li><code>"CreateGrant"</code></li> <li><code>"RetireGrant"</code></li> <li><code>"DescribeKey"</code></li> <li><code>"Verify"</code></li> <li><code>"Sign"</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-grants-retiring-principal"><strong>retiring_principal</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The full ARN of the principal permitted to revoke/retire the grant.</p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-key-id"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-key-arn">key_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: key_arn</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Key ID or ARN of the key.</p> <p>One of <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-alias"><span class="std std-ref">alias</span></a></strong></code> or <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-key-id"><span class="std std-ref">key_id</span></a></strong></code> are required.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-key-spec"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-customer-master-key-spec">key_spec</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: customer_master_key_spec</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.aws 2.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the type of KMS key to create.</p> <p>The specification is not changeable once the key is created.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"SYMMETRIC_DEFAULT"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"RSA_2048"</code></li> <li><code>"RSA_3072"</code></li> <li><code>"RSA_4096"</code></li> <li><code>"ECC_NIST_P256"</code></li> <li><code>"ECC_NIST_P384"</code></li> <li><code>"ECC_NIST_P521"</code></li> <li><code>"ECC_SECG_P256K1"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-key-usage"><strong>key_usage</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.aws 2.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Determines the cryptographic operations for which you can use the KMS key.</p> <p>The usage is not changeable once the key is created.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"ENCRYPT_DECRYPT"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"SIGN_VERIFY"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-multi-region"><strong>multi_region</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in amazon.aws 5.5.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether to create a multi-Region primary key or not.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-pending-window"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-deletion-delay">pending_window</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: deletion_delay</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in community.aws 1.4.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The number of days between requesting deletion of the CMK and when it will actually be deleted.</p> <p>Only used when <code><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-state"><span class="std std-ref">state=absent</span></a></code> and the CMK has not yet been deleted.</p> <p>Valid values are between <code>7</code> and <code>30</code> (inclusive).</p> <p>See also: <a class="reference external" href="https://docs.aws.amazon.com/kms/latest/APIReference/API_ScheduleKeyDeletion.html#KMS-ScheduleKeyDeletion-request-PendingWindowInDays">https://docs.aws.amazon.com/kms/latest/APIReference/API_ScheduleKeyDeletion.html#KMS-ScheduleKeyDeletion-request-PendingWindowInDays</a></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-policy"><strong>policy</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">json</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Policy to apply to the KMS key.</p> <p>See <a class="reference external" href="https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html">https://docs.aws.amazon.com/kms/latest/developerguide/key-policies.html</a></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-profile"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-aws-profile">profile</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: aws_profile</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A named AWS profile to use for authentication.</p> <p>See the AWS documentation for more information about named profiles <a class="reference external" href="https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html">https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-profiles.html</a>.</p> <p>The <code>AWS_PROFILE</code> environment variable may also be used.</p> <p>The <em>profile</em> option is mutually exclusive with the <em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> options.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-purge-grants"><strong>purge_grants</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the <code><strong><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-grants"><span class="std std-ref">grants</span></a></strong></code> argument should cause grants not in the list to be removed.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-purge-tags"><strong>purge_tags</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <em>purge_tags=true</em> and <em>tags</em> is set, existing tags will be purged from the resource to match exactly what is defined by <em>tags</em> parameter.</p> <p>If the <em>tags</em> parameter is not set then tags will not be modified, even if <em>purge_tags=True</em>.</p> <p>Tag keys beginning with <code>aws:</code> are reserved by Amazon and can not be modified. As such they will be ignored for the purposes of the <em>purge_tags</em> parameter. See the Amazon documentation for more information <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html#tag-conventions">https://docs.aws.amazon.com/general/latest/gr/aws_tagging.html#tag-conventions</a>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">   
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-region"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-aws-region">region</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: aws_region, ec2_region</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The AWS region to use.</p> <p>For global services such as IAM, Route53 and CloudFront, <em>region</em> is ignored.</p> <p>The <code>AWS_REGION</code> or <code>EC2_REGION</code> environment variables may also be used.</p> <p>See the Amazon AWS documentation for more information <a class="reference external" href="http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region">http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region</a>.</p> <p>The <code>ec2_region</code> alias has been deprecated and will be removed in a release after 2024-12-01</p> <p>Support for the <code>EC2_REGION</code> environment variable has been deprecated and will be removed in a release after 2024-12-01.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">    
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-secret-key"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-aws-secret-access-key">secret_key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: aws_secret_access_key, aws_secret_key, ec2_secret_key</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>AWS secret access key.</p> <p>See the AWS documentation for more information about access tokens <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys">https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys</a>.</p> <p>The <code>AWS_SECRET_ACCESS_KEY</code>, <code>AWS_SECRET_KEY</code>, or <code>EC2_SECRET_KEY</code> environment variables may also be used in decreasing order of preference.</p> <p>The <em>secret_key</em> and <em>profile</em> options are mutually exclusive.</p> <p>The <em>aws_secret_access_key</em> alias was added in release 5.1.0 for consistency with the AWS botocore SDK.</p> <p>The <em>ec2_secret_key</em> alias has been deprecated and will be removed in a release after 2024-12-01.</p> <p>Support for the <code>EC2_SECRET_KEY</code> environment variable has been deprecated and will be removed in a release after 2024-12-01.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">     
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-session-token"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-access-token">session_token</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: aws_session_token, security_token, aws_security_token, access_token</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>AWS STS session token for use with temporary credentials.</p> <p>See the AWS documentation for more information about access tokens <a class="reference external" href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys">https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys</a>.</p> <p>The <code>AWS_SESSION_TOKEN</code>, <code>AWS_SECURITY_TOKEN</code> or <code>EC2_SECURITY_TOKEN</code> environment variables may also be used in decreasing order of preference.</p> <p>The <em>security_token</em> and <em>profile</em> options are mutually exclusive.</p> <p>Aliases <em>aws_session_token</em> and <em>session_token</em> were added in release 3.2.0, with the parameter being renamed from <em>security_token</em> to <em>session_token</em> in release 6.0.0.</p> <p>The <em>security_token</em>, <em>aws_security_token</em>, and <em>access_token</em> aliases have been deprecated and will be removed in a release after 2024-12-01.</p> <p>Support for the <code>EC2_SECRET_KEY</code> and <code>AWS_SECURITY_TOKEN</code> environment variables has been deprecated and will be removed in a release after 2024-12-01.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether a key should be present or absent.</p> <p>Note that making an existing key <code>absent</code> only schedules a key for deletion.</p> <p>Passing a key that is scheduled for deletion with <code><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-parameter-state"><span class="std std-ref">state=present</span></a></code> will cancel key deletion.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"absent"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-tags"><strong id="ansible-collections-amazon-aws-kms-key-module-parameter-resource-tags">tags</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: resource_tags</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A dictionary representing the tags to be applied to the resource.</p> <p>If the <em>tags</em> parameter is not set then tags will not be modified.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-parameter-validate-certs"><strong>validate_certs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>When set to <code>false</code>, SSL certificates will not be validated for communication with the AWS APIs.</p> <p>Setting <em>validate_certs=false</em> is strongly discouraged, as an alternative, consider setting <em>aws_ca_bundle</em> instead.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>There are known inconsistencies in the amount of time required for updates of KMS keys to be fully reflected on AWS. This can cause issues when running duplicate tasks in succession or using the <a class="reference internal" href="kms_key_info_module.html#ansible-collections-amazon-aws-kms-key-info-module"><span class="std std-ref">amazon.aws.kms_key_info</span></a> module to fetch key metadata shortly after modifying keys. For this reason, it is recommended to use the return data from this module (<a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module"><span class="std std-ref">amazon.aws.kms_key</span></a>) to fetch a key’s metadata.</li> <li>The <code>policies</code> return key was removed in amazon.aws release 8.0.0.</li> <li>
<strong>Caution:</strong> For modules, environment variables and configuration files are read from the Ansible ‘host’ context and not the ‘controller’ context. As such, files may need to be explicitly copied to the ‘host’. For lookup and connection plugins, environment variables and configuration files are read from the Ansible ‘controller’ context and not the ‘host’ context.</li> <li>The AWS SDK (boto3) that Ansible uses may also read defaults for credentials and other settings, such as the region, from its configuration files in the Ansible ‘host’ context (typically <code>~/.aws/credentials</code>). See <a class="reference external" href="https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html">https://boto3.amazonaws.com/v1/documentation/api/latest/guide/credentials.html</a> for more information.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># Create a new KMS key
- amazon.aws.kms_key:
    alias: mykey
    tags:
      Name: myKey
      Purpose: protect_stuff

# Create a new multi-region KMS key
- amazon.aws.kms_key:
    alias: mykey
    multi_region: true
    tags:
      Name: myKey
      Purpose: protect_stuff

# Update previous key with more tags
- amazon.aws.kms_key:
    alias: mykey
    tags:
      Name: myKey
      Purpose: protect_stuff
      Owner: security_team

# Update a known key with grants allowing an instance with the billing-prod IAM profile
# to decrypt data encrypted with the environment: production, application: billing
# encryption context
- amazon.aws.kms_key:
    key_id: abcd1234-abcd-1234-5678-ef1234567890
    grants:
      - name: billing_prod
        grantee_principal: arn:aws:iam::123456789012:role/billing_prod
        constraints:
          encryption_context_equals:
            environment: production
            application: billing
        operations:
          - Decrypt
          - RetireGrant

- name: Update IAM policy on an existing KMS key
  amazon.aws.kms_key:
    alias: my-kms-key
    policy: '{"Version": "2012-10-17", "Id": "my-kms-key-permissions", "Statement": [ { &lt;SOME STATEMENT&gt; } ]}'
    state: present

- name: Example using lookup for policy json
  amazon.aws.kms_key:
    alias: my-kms-key
    policy: "{{ lookup('template', 'kms_iam_policy_template.json.j2') }}"
    state: present
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-aliases"><strong>aliases</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of aliases associated with the key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["aws/acm", "aws/ebs"]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-aws-account-id"><strong>aws_account_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The AWS Account ID that the key belongs to.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"1234567890123"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-changes-needed"><strong>changes_needed</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Grant types that would be changed/were changed.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"role": "add", "role grant": "add"}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-creation-date"><strong>creation_date</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Date and time of creation of the key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"2017-04-18T15:12:08.551000+10:00"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-customer-master-key-spec"><strong>customer_master_key_spec</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the type of KMS key to create.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"SYMMETRIC_DEFAULT"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-deletion-date"><strong>deletion_date</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.aws 3.3.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Date and time after which KMS deletes this KMS key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when <code><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-return-key-state"><span class="std std-ref">key_state</span></a></code> is PendingDeletion</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"2017-04-18T15:12:08.551000+10:00"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Description of the key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"My Key for Protecting important stuff"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-enable-key-rotation"><strong>enable_key_rotation</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the automatic annual key rotation is enabled. Returns None if key rotation status can’t be determined.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-enabled"><strong>enabled</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether the key is enabled. True if <code><a class="reference internal" href="#ansible-collections-amazon-aws-kms-key-module-return-key-state"><span class="std std-ref">key_state</span></a></code> is <code>Enabled</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-encryption-algorithms"><strong>encryption_algorithms</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The encryption algorithms that the KMS key supports.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["SYMMETRIC_DEFAULT"]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants"><strong>grants</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of grants associated with a key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-constraints"><strong>constraints</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Constraints on the encryption context that the grant allows. See <a class="reference external" href="https://docs.aws.amazon.com/kms/latest/APIReference/API_GrantConstraints.html">https://docs.aws.amazon.com/kms/latest/APIReference/API_GrantConstraints.html</a> for further details</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"encryption_context_equals": {"aws:lambda:_function_arn": "arn:aws:lambda:ap-southeast-2:123456789012:function:xyz"}}</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-creation-date"><strong>creation_date</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Date of creation of the grant.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"2017-04-18T15:12:08+10:00"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-grant-id"><strong>grant_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The unique ID for the grant.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"abcd1234abcd1234abcd1234abcd1234abcd1234abcd1234abcd1234abcd1234"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-grantee-principal"><strong>grantee_principal</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The principal that receives the grant’s permissions.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"arn:aws:sts::123456789012:assumed-role/lambda_xyz/xyz"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-issuing-account"><strong>issuing_account</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The AWS account under which the grant was issued.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"arn:aws:iam::123456789012:root"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-key-id"><strong>key_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The key ARN to which the grant applies.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"arn:aws:kms:ap-southeast-2:123456789012:key/abcd1234-abcd-1234-5678-ef1234567890"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The friendly name that identifies the grant.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"xyz"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-operations"><strong>operations</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The list of operations permitted by the grant.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["Decrypt", "RetireGrant"]</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-grants-retiring-principal"><strong>retiring_principal</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The principal that can retire the grant.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"arn:aws:sts::123456789012:assumed-role/lambda_xyz/xyz"</code></p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-had-invalid-entries"><strong>had_invalid_entries</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Whether there are invalid (non-ARN) entries in the KMS entry. These don’t count as a change, but will be removed if any changes are being made.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-arn"><strong>key_arn</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>ARN of key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"arn:aws:kms:ap-southeast-2:123456789012:key/abcd1234-abcd-1234-5678-ef1234567890"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-id"><strong>key_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>ID of key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"abcd1234-abcd-1234-5678-ef1234567890"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-manager"><strong>key_manager</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The manager of the KMS key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"AWS"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-policies"><strong>key_policies</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> <p><em class="ansible-option-versionadded">added in community.aws 3.3.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>List of policy documents for the key. Empty when access is denied even if there are policies.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"Id": "auto-ebs-2", "Statement": [{"Action": ["kms:Encrypt", "kms:Decrypt", "kms:ReEncrypt*", "kms:GenerateDataKey*", "kms:CreateGrant", "kms:DescribeKey"], "Condition": {"StringEquals": {"kms:CallerAccount": "123456789012", "kms:ViaService": "ec2.ap-southeast-2.amazonaws.com"}}, "Effect": "Allow", "Principal": {"AWS": "*"}, "Resource": "*", "Sid": "Allow access through EBS for all principals in the account that are authorized to use EBS"}, {"Action": ["kms:Describe*", "kms:Get*", "kms:List*", "kms:RevokeGrant"], "Effect": "Allow", "Principal": {"AWS": "arn:aws:iam::123456789012:root"}, "Resource": "*", "Sid": "Allow direct access to key metadata to the account"}], "Version": "2012-10-17"}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-spec"><strong>key_spec</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Specifies the type of KMS key to create.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"SYMMETRIC_DEFAULT"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-state"><strong>key_state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The state of the key.</p> <p>Will be one of <code>'Creating'</code>, <code>'Enabled'</code>, <code>'Disabled'</code>, <code>'PendingDeletion'</code>, <code>'PendingImport'</code>, <code>'PendingReplicaDeletion'</code>, <code>'Unavailable'</code>, or <code>'Updating'</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"PendingDeletion"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-key-usage"><strong>key_usage</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The cryptographic operations for which you can use the key.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"ENCRYPT_DECRYPT"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-multi-region"><strong>multi_region</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in amazon.aws 5.5.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Indicates whether the CMK is a multi-Region <code>True</code> or regional <code>False</code> key.</p> <p>This value is True for multi-Region primary and replica CMKs and False for regional CMKs.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-origin"><strong>origin</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The source of the key’s key material. When this value is <code>AWS_KMS</code>, AWS KMS created the key material. When this value is <code>EXTERNAL</code>, the key material was imported or the CMK lacks key material.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"AWS_KMS"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-amazon-aws-kms-key-module-return-tags"><strong>tags</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Dictionary of tags applied to the key. Empty when access is denied even if there are tags.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"Name": "myKey", "Purpose": "protecting_stuff"}</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Ted Timmons (@tedder)</li> <li>Will Thames (@willthames)</li> <li>Mark Chappell (@tremble)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/amazon.aws/issues?q=is%3Aissue+is%3Aopen+sort%3Aupdated-desc" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/amazon.aws" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-amazon-aws"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/amazon/aws/kms_key_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/amazon/aws/kms_key_module.html</a>
  </p>
</div>
