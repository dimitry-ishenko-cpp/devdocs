<h1 id="dellemc-openmanage-idrac-redfish-storage-controller-configures-the-storage-controller-settings">dellemc.openmanage.idrac_redfish_storage_controller – Configures the storage controller settings</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/dellemc/openmanage">dellemc.openmanage collection</a> (version 3.6.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install dellemc.openmanage</code>.</p> <p>To use it in a playbook, specify: <code>dellemc.openmanage.idrac_redfish_storage_controller</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.1.0: </span>of dellemc.openmanage</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This module configures the settings of the storage controller using Redfish.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python &gt;= 2.7.5</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>baseuri</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>IP address of the target out-of-band controller. For example- &lt;ipaddress&gt;:&lt;port&gt;.</div> </td> </tr> <tr> <td colspan="1">  <b>command</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>ResetConfig</li> <li><div>
<b>AssignSpare</b> ←</div></li> <li>SetControllerKey</li> <li>RemoveControllerKey</li> <li>ReKey</li> </ul> </td> <td> <div>These actions may require a system reset, depending on the controller's capabilities.</div> <div>
<code>ResetConfig</code> - Deletes all the virtual disks and unassigns all hot spares on physical disks.</div> <div>
<code>AssignSpare</code> - Assigns a physical disk as a dedicated or global hot spare for a virtual disk.</div> <div>
<code>SetControllerKey</code> - Sets the key on controllers, which is used to encrypt the drives in Local key Management(LKM).</div> <div>
<code>RemoveControllerKey</code> - Erases the encryption key on the controller.</div> <div>
<code>ReKey</code> - Resets the key on the controller.</div> </td> </tr> <tr> <td colspan="1">  <b>controller_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>FQDD of the storage controller. For example- 'RAID.Slot.1-1'.</div> <div>This option is mandatory when <em>command</em> is <code>ResetConfig</code>, <code>SetControllerKey</code>, <code>RemoveControllerKey</code> and <code>ReKey</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A new security key passphrase that the encryption-capable controller uses to create the encryption key. The controller uses the encryption key to lock or unlock access to the Self Encryption Disk(SED). Only one encryption key can be created for each controller.</div> <div>This is mandatory when <em>command</em> is <code>SetControllerKey</code> or <code>ReKey</code>, and when <em>mode</em> is <code>LKM</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>key_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>This is a user supplied text label associated with the passphrase.</div> <div>This is mandatory when <em>command</em> is <code>SetControllerKey</code> or <code>ReKey</code>, and when <em>mode</em> is <code>LKM</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>LKM</b> ←</div></li> <li>SEKM</li> </ul> </td> <td> <div>Encryption mode of the encryption-capable controller: 1 - Local Key Management (LKM), 2 - Security Enterprise Key Manager(SEKM).</div> <div>This option is applicable only when <em>command</em> is <code>ReKey</code>.</div> <div>
<code>SEKM</code> requires secure enterprise key manager license on the iDRAC.</div> </td> </tr> <tr> <td colspan="1">  <b>old_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Security key passphrase used by the encryption-capable controller..</div> <div>This option is mandatory when <em>command</em> is <code>ReKey</code> and <em>mode</em> is <code>LKM</code>.</div> </td> </tr> <tr> <td colspan="1">  <b>password</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Password of the target out-of-band controller.</div> </td> </tr> <tr> <td colspan="1">  <b>target</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Fully Qualified Device Descriptor (FQDD) of the target physical drive that is assigned as a spare.</div> <div>This is mandatory when <em>command</em> is <code>AssignSpare</code>.</div> <div>If <em>volume_id</em> is not specified or empty, this physical drive will be assigned as a global hot spare.</div> </td> </tr> <tr> <td colspan="1">  <b>username</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Username of the target out-of-band controller.</div> </td> </tr> <tr> <td colspan="1">  <b>volume_id</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>FQDD of the volumes to which a hot spare is assigned.</div> <div>Applicable if <em>command</em> is <code>AssignSpare</code>.</div> <div>To know the number of volumes to which a hot spare can be assigned, refer iDRAC Redfish API guide.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Run this module from a system that has direct access to DellEMC iDRAC.</li> <li>This module does not support <code>check_mode</code>.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">---
- name: Assign dedicated hot spare
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    volume_id:
      - "Disk.Virtual.0:RAID.Slot.1-1"
    target: "Disk.Bay.0:Enclosure.Internal.0-1:RAID.Slot.1-1"
  tags:
    - assign_dedicated_hot_spare

- name: Assign global hot spare
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    target: "Disk.Bay.0:Enclosure.Internal.0-1:RAID.Slot.1-1"
  tags:
    - assign_global_hot_spare

- name: Set controller encryption key
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    command: "SetControllerKey"
    controller_id: "RAID.Slot.1-1"
    key: "PassPhrase@123"
    key_id: "mykeyid123"
  tags:
    - set_controller_key

- name: Rekey in LKM mode
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    command: "ReKey"
    controller_id: "RAID.Slot.1-1"
    key: "NewPassPhrase@123"
    key_id: "newkeyid123"
    old_key: "OldPassPhrase@123"
  tags:
    - rekey_lkm

- name: Rekey in SEKM mode
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    command: "ReKey"
    controller_id: "RAID.Slot.1-1"
    mode: "SEKM"
  tags:
    - rekey_sekm

- name: Remove controller key
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    command: "RemoveControllerKey"
    controller_id: "RAID.Slot.1-1"
  tags:
    - remove_controller_key

- name: Reset controller configuration
  dellemc.openmanage.idrac_redfish_storage_controller:
    baseuri: "192.168.0.1:443"
    username: "user_name"
    password: "user_password"
    command: "ResetConfig"
    controller_id: "RAID.Slot.1-1"
  tags:
    - reset_config
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>error_info</b>  <div> <span>dictionary</span> </div> </td> <td>on http error</td> <td> <div>Details of a http error.</div> <br> <div><b>Sample:</b></div> <div>{'error': {'@Message.ExtendedInfo': [{'Message': 'Unable to run the method because the requested HTTP method is not allowed.', 'MessageArgs': [], 'MessageArgs@odata.count': 0, 'MessageId': 'iDRAC.1.6.SYS402', 'RelatedProperties': [], 'RelatedProperties@odata.count': 0, 'Resolution': 'Enter a valid HTTP method and retry the operation. For information about valid methods, see the Redfish Users Guide available on the support site.', 'Severity': 'Informational'}], 'code': 'Base.1.0.GeneralError', 'message': 'A general error has occurred. See ExtendedInfo for more information'}}</div> </td> </tr> <tr> <td colspan="1">  <b>msg</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Overall status of the storage controller configuration operation.</div> <br> <div><b>Sample:</b></div> <div>Successfully submitted the job that performs the AssignSpare operation</div> </td> </tr> <tr> <td colspan="1">  <b>task</b>  <div> <span>dictionary</span> </div> </td> <td>success</td> <td> <div>ID and URI resource of the job created.</div> <br> <div><b>Sample:</b></div> <div>{'id': 'JID_XXXXXXXXXXXXX', 'uri': '/redfish/v1/Managers/iDRAC.Embedded.1/Jobs/JID_XXXXXXXXXXXXX'}</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Jagadeesh N V (@jagadeeshnv)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/dellemc/openmanage/idrac_redfish_storage_controller_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/dellemc/openmanage/idrac_redfish_storage_controller_module.html</a>
  </p>
</div>
