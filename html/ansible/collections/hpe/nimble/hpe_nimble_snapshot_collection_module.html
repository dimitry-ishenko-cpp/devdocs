<h1 id="hpe-nimble-hpe-nimble-snapshot-collection-manage-the-hpe-nimble-storage-snapshot-collections">hpe.nimble.hpe_nimble_snapshot_collection â€“ Manage the HPE Nimble Storage snapshot collections</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/hpe/nimble">hpe.nimble collection</a> (version 1.1.3).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install hpe.nimble</code>.</p> <p>To use it in a playbook, specify: <code>hpe.nimble.hpe_nimble_snapshot_collection</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of hpe.nimble</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Manage the snapshot collections on an HPE Nimble Storage group.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>Ansible 2.9 or later</li> <li>Python 3.6 or later</li> <li>HPE Nimble Storage SDK for Python</li> <li>HPE Nimble Storage arrays running NimbleOS 5.0 or later</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>agent_type</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>External management agent type for snapshots being created as part of snapshot collection.</div> </td> </tr> <tr> <td colspan="1">  <b>allow_writes</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Allow applications to write to created snapshot(s). Mandatory and must be set to 'true' for VSS application synchronized snapshots.</div> </td> </tr> <tr> <td colspan="1">  <b>change_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Change name of the existing snapshot collection.</div> </td> </tr> <tr> <td colspan="1">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Text description of snapshot collection.</div> </td> </tr> <tr> <td colspan="1">  <b>disable_appsync</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Do not perform application synchronization for this snapshot. Create a crash-consistent snapshot instead.</div> </td> </tr> <tr> <td colspan="1">  <b>expiry_after</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of seconds after which this snapcoll is considered expired by the snapshot TTL. A value of 0 indicates that the snapshot never expires, 1 indicates that the snapshot uses a group-level configured TTL value and any other value indicates the number of seconds.</div> </td> </tr> <tr> <td colspan="1">  <b>force</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Forcibly delete the specified snapshot collection even if it is the last replicated snapshot. Doing so could lead to full re-seeding at the next replication.</div> </td> </tr> <tr> <td colspan="1">  <b>host</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>HPE Nimble Storage IP address.</div> </td> </tr> <tr> <td colspan="1">  <b>invoke_on_upstream_partner</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Invoke snapshot request on upstream partner. This operation is not supported for synchronous replication volume collections.</div> </td> </tr> <tr> <td colspan="1">  <b>is_external_trigger</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Is externally triggered.</div> </td> </tr> <tr> <td colspan="1">  <b>metadata</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Key-value pairs that augment a snapshot collection attributes. List of key-value pairs. Keys must be unique and non-empty.</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Name of the snapshot collection.</div> </td> </tr> <tr> <td colspan="1">  <b>password</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>HPE Nimble Storage password.</div> </td> </tr> <tr> <td colspan="1">  <b>replicate_to</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specifies the partner name that the snapshots in this snapshot collection are replicated to.</div> </td> </tr> <tr> <td colspan="1">  <b>skip_db_consistency_check</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Skip consistency check for database files on this snapshot. This option only applies to volume collections with application synchronization set to VSS, application ID set to MS Exchange 2010 or later with Database Availability Group (DAG), snap_verify option set to true, and disable_appsync option set to false.</div> </td> </tr> <tr> <td colspan="1">  <b>snap_verify</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Run verification tool on this snapshot. This option can only be used with a volume collection that has application synchronization.</div> </td> </tr> <tr> <td colspan="1">  <b>start_online</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Start with snapshot set online.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>present</li> <li>absent</li> <li>create</li> </ul> </td> <td> <div>The snapshot collection operation.</div> </td> </tr> <tr> <td colspan="1">  <b>username</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>HPE Nimble Storage user name.</div> </td> </tr> <tr> <td colspan="1">  <b>vol_snap_attr_list</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of snapshot attributes for snapshots being created as part of snapshot collection creation. List of volumes with per snapshot attributes.</div> </td> </tr> <tr> <td colspan="1">  <b>volcoll</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Parent volume collection name.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>This module does not support <code>check_mode</code>.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja"># if state is create , then create a snapshot collection if not present. Fails if already present.
# if state is present, then create a snapshot collection if not present. Succeeds if it already exists
- name: Create snapshot collection if not present
  hpe.nimble.hpe_nimble_snapshot_collection:
    host: "{{ host }}"
    username: "{{ username }}"
    password: "{{ password }}"
    state: "{{ state | default('present') }}"
    name: "{{ name | mandatory}}"
    volcoll: "{{ volcoll | mandatory}}"
    description: "{{ description }}"

- name: Delete snapshot collection (must be offline)
  hpe.nimble.hpe_nimble_snapshot_collection:
    host: "{{ host }}"
    username: "{{ username }}"
    password: "{{ password }}"
    name: "{{ name }}"
    volcoll: "{{ volcoll }}"
    state: absent
</pre>  <h3 id="authors">Authors</h3> <ul class="simple"> <li>HPE Nimble Storage Ansible Team (@ar-india) &lt;<a class="reference external" href="https://docs.ansible.com/cdn-cgi/l/email-protection#a7c9cecac5cbc28ac3c4d48ad4d3c8d5c6c0c28ac6d2d3c8cac6d3cec8c98ac2c9c0818494909c818492959c8184939f9ccfd7c2818493919cc4c8ca">nimble-dcs-storage-automation-eng<span>@</span>hpe<span>.</span>com</a>&gt;</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/hpe/nimble/hpe_nimble_snapshot_collection_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/hpe/nimble/hpe_nimble_snapshot_collection_module.html</a>
  </p>
</div>
