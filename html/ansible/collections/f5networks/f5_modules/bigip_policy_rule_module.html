<h1 id="f5networks-f5-modules-bigip-policy-rule-manage-ltm-policy-rules-on-a-big-ip">f5networks.f5_modules.bigip_policy_rule – Manage LTM policy rules on a BIG-IP</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/f5networks/f5_modules">f5networks.f5_modules collection</a> (version 1.12.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install f5networks.f5_modules</code>.</p> <p>To use it in a playbook, specify: <code>f5networks.f5_modules.bigip_policy_rule</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of f5networks.f5_modules</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This module manages LTM policy rules on a BIG-IP.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>BIG-IP &gt;= v12.1.0</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="3">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="3">  <b>actions</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The actions you want the policy rule to perform.</div> <div>The available attributes vary by the action, however, each action requires you specify a <code>type</code>.</div> <div>These conditions can be specified in any order. Despite the fact they are in a list, the order in the list does not matter to the BIG-IP.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>asm_policy</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>ASM policy to enable.</div> <div>This parameter is only valid with the <code>enable</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>cookie_expiry</b>  <div> <span>integer</span> </div> <div> added in 1.1.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>Optional argument, specifying the time for which the session is persisted.</div> <div>This parameter is only valid with the <code>persist</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>cookie_insert</b>  <div> <span>string</span> </div> <div> added in 1.1.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>Cookie name on which you want to persist.</div> <div>This parameter is only valid with the <code>persist</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>disable_target</b>  <div> <span>string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> <ul>
<b>Choices:</b> <li>server_ssl</li> <li>persist</li> </ul> </td> <td> <div>Target which you want to disable.</div> <div>This parameter is only valid with the <code>disable</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>event</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Events on which actions, such as reset and forward, can be triggered.</div> <div>With the <code>set_variable</code> action, it is used for specifying an action event, such as request or response.</div> <div>Valid event choices for <code>forward</code> action type are: client_accepted, proxy_request request, ssl_client_hello and ssl_client_server_hello_send.</div> <div>Valid event choices for <code>reset</code> acton type are: client_accepted, proxy_connect proxy_request, proxy_response, request, response, server_connected, ssl_client_hello, ssl_client_server_hello_send, ssl_server_handshake, ssl_server_hello, websocket_request, websocket_response.</div> <div>Valid event choices for <code>disable</code> acton type are: client_accepted, proxy_connect proxy_request, proxy_response, request, server_connected.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>expression</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A Tcl expression used with the <code>set_variable</code> action.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_connect</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>HTTP Connect header that you want to replace.</div> <div>This parameter is only valid with the <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>event</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>client_accepted</li> <li>proxy_connect</li> <li>proxy_request</li> <li>proxy_response</li> <li>request</li> <li>server_connected</li> <li>ssl_client_hello</li> </ul> </td> <td> <div>Type of event when the <code>http_connect</code> header is replaced.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>port</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The port number.</div> <div>If a port number is not provided, the value is set to 0 by default.</div> <div>Be explicit when defining rules, so the system does not override port values.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The value of <code>http_connect</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_cookie</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>HTTP Cookie header you want to remove or insert.</div> <div>This parameter is only valid with the <code>remove</code> and <code>insert</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>event</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>request</li> <li>proxy_connect</li> <li>proxy_request</li> </ul> </td> <td> <div>Type of event when the <code>http_cookie</code> is removed or inserted.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of <code>http_cookie</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The value of <code>http_cookie</code>.</div> <div>This is a mandatory parameter when configured with <code>insert</code> type action.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_header</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>HTTP Header that you want to remove or insert.</div> <div>This parameter is only valid with the <code>remove</code>, <code>insert</code> and <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>event</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>request</li> <li>response</li> <li>proxy_connect</li> <li>proxy_request</li> <li>proxy_response</li> </ul> </td> <td> <div>Type of event when the <code>http_header</code> is removed, replaced, or inserted.</div> <div>The <code>request</code> and <code>response</code> events are only choices with <code>remove</code> and <code>insert</code> type.</div> <div>All of events are valid with <code>replace</code> type action.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of <code>http_header</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The value of <code>http_header</code>.</div> <div>Mandatory parameter when configured with <code>insert</code> or <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_host</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>HTTP Host header you want to replace.</div> <div>This parameter is only valid with the <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>event</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>request</li> <li>proxy_connect</li> <li>proxy_request</li> </ul> </td> <td> <div>Type of event when the <code>http_host</code> is replaced.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The value of <code>http_host</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_referer</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>HTTP Referer header you want to remove, replace, or insert.</div> <div>This parameter is only valid with the <code>remove</code>, <code>insert</code> and <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>event</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>request</li> <li>proxy_connect</li> <li>proxy_request</li> </ul> </td> <td> <div>Type of event when the c(http_referer) is removed, replaced, or inserted.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The value of <code>http_referer</code>.</div> <div>This is a mandatory parameter when configured with <code>insert</code> type action.</div> <div>This parameter is ignored for the <code>remove</code> type.</div> <div>This parameter is optional for the <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_set_cookie</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>HTTP Set-Cookie header you want to remove or insert.</div> <div>This parameter is only valid with the <code>remove</code> or c(insert) type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of <code>http_set_cookie</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The value of <code>http_set_cookie</code>.</div> <div>This is a mandatory parameter when configured with <code>insert</code> type action.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>http_uri</b>  <div> <span>dictionary</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>Replaces HTTP URI, path, or string.</div> <div>This parameter is only valid with the <code>replace</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>event</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>request</li> <li>proxy_connect</li> <li>proxy_request</li> </ul> </td> <td> <div>Type of event when the <code>http_uri</code> is replaced.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>type</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>path</li> <li>query_string</li> <li>full_string</li> </ul> </td> <td> <div>Specifies the part of the <code>http_uri</code> to be replaced.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The value of <code>http_uri</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>location</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The new URL for which a redirect response is sent.</div> <div>A Tcl command substitution can be used for this field.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>node</b>  <div> <span>string</span> </div> <div> added in 1.2.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>Node to which you want to forward traffic.</div> <div>This parameter is only valid with the <code>forward</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>pool</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Pool to which you want to forward traffic.</div> <div>This parameter is only valid with the <code>forward</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>type</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>forward</li> <li>enable</li> <li>ignore</li> <li>redirect</li> <li>reset</li> <li>persist</li> <li>set_variable</li> <li>remove</li> <li>insert</li> <li>replace</li> <li>disable</li> </ul> </td> <td> <div>The action type. This value controls which of the following options are required.</div> <div>When <code>type</code> is <code>forward</code>, the system associates a given <code>pool</code>, or <code>virtual</code>, or <code>node</code> with this rule.</div> <div>When <code>type</code> is <code>enable</code>, the system associates a given <code>asm_policy</code> with this rule.</div> <div>When <code>type</code> is <code>ignore</code>, the system removes all existing actions from this rule.</div> <div>When <code>type</code> is <code>redirect</code>, the system redirects an HTTP request to a different URL.</div> <div>When <code>type</code> is <code>reset</code>, the system resets the connection upon <code>event</code>.</div> <div>When <code>type</code> is <code>persist</code>, the system associates <code>cookie_insert</code> and <code>cookie_expiry</code> with this rule.</div> <div>When <code>type</code> is <code>set_variable</code>, the system sets a variable based on the evaluated Tcl <code>expression</code> based on <code>event</code>.</div> <div>When <code>type</code> is <code>remove</code>, the system removes <code>http_set_cookie</code>, <code>http_referer</code>, <code>http_header</code> or <code>http_cookie</code> with this rule.</div> <div>When <code>type</code> is <code>insert</code>, the system inserts <code>http_set_cookie</code>, <code>http_referer</code>, <code>http_header</code> or <code>http_cookie</code> with this rule.</div> <div>When <code>type</code> is <code>replace</code>, the system replaces <code>http_connect</code>, <code>http_referer</code>, <code>http_header</code>, <code>http_uri</code> or <code>http_host</code> with this rule.</div> <div>When <code>type</code> is <code>disable</code>, the system disables <code>disable_target</code> with this rule.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>variable_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Variable name used with the <code>set_variable</code> action.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>virtual</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Virtual server to which you want to forward traffic.</div> <div>This parameter is only valid with the <code>forward</code> type.</div> </td> </tr> <tr> <td colspan="3">  <b>conditions</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of attributes that describe the condition.</div> <div>See suboptions for details on how to construct each list entry.</div> <div>The ordering of this list is important, the module ensures the order is kept when modifying the task.</div> <div>The suboption options below are not required for all condition types, read the description for more details.</div> <div>These conditions can be specified in any order. Despite the fact they are in a list, the order in the list does not matter to the BIG-IP.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>address_matches_with_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of IP Subnet address strings the IP address should match.</div> <div>This parameter is only valid with the <code>tcp</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>address_matches_with_datagroup</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of internal datagroup strings the IP address should match.</div> <div>This parameter is only valid with the <code>tcp</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>address_matches_with_external_datagroup</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.10.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of external datagroup strings the IP address should match.</div> <div>This parameter is only valid with the <code>tcp</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>event</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Events on which conditions type match rules can be triggered.</div> <div>Supported only for <code>http_header</code>, <code>http_method</code>, <code>ssl_extension</code> and <code>tcp</code>.</div> <div>Valid choices for <code>http_header</code> condition types are: <code>proxy_connect</code>, <code>proxy_request</code>, <code>proxy_response</code>, <code>request</code> and <code>response</code>.</div> <div>Valid choices for <code>http_method</code> condition types are: <code>proxy_connect</code>, <code>proxy_request</code>, <code>proxy_response</code>, <code>request</code> and <code>response</code>.</div> <div>Valid choices for <code>tcp</code> condition types are: <code>request</code>, <code>client_accepted</code>, <code>proxy_connect</code>, <code>proxy_request</code>, <code>proxy_response</code>, <code>ssl_client_hello</code>, and <code>ssl_client_server_hello_send</code>.</div> <div>Valid choices for <code>ssl_extension</code> are: <code>ssl_client_hello</code>, and <code>ssl_client_server_hello_send</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>header_is_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP Header value should match.</div> <div>This parameter is only valid with the <code>http_header</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>header_name</b>  <div> <span>string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A name of <code>http_header</code>.</div> <div>This parameter is only valid with the <code>http_header</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>host_begins_with_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP Host should start with.</div> <div>This parameter is only valid with the <code>http_host</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>host_ends_with_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP Host should end with.</div> <div>This parameter is only valid with the <code>http_host</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>host_is_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP Host should match.</div> <div>This parameter is only valid with the <code>http_host</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>host_is_not_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP Host should not match.</div> <div>This parameter is only valid with the <code>http_host</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>method_matches_with_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.10.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP Method value should match.</div> <div>This parameter is only valid with the <code>http_method</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>path_begins_with_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP URI should start with.</div> <div>This parameter is only valid with the <code>http_uri</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>path_contains</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP URI should contain.</div> <div>This parameter is only valid with the <code>http_uri</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>path_is_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> <div> added in 1.8.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A list of strings of characters the HTTP URI should match.</div> <div>This parameter is only valid with the <code>http_uri</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>server_name_is_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of strings of characters the SSL Extension should match.</div> <div>This parameter is only valid with the <code>ssl_extension</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>type</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>http_uri</li> <li>all_traffic</li> <li>http_host</li> <li>http_header</li> <li>http_method</li> <li>ssl_extension</li> <li>tcp</li> </ul> </td> <td> <div>The condition type. This value controls which of the following options are required.</div> <div>When <code>type</code> is <code>http_uri</code>, the valid choices are: <code>path_begins_with_any</code>, <code>path_contains</code> or <code>path_is_any</code>.</div> <div>When <code>type</code> is <code>http_host</code>, the valid choices are: <code>host_is_any</code>, <code>host_is_not_any</code>, <code>host_begins_with_any</code> or <code>host_ends_with_any</code>.</div> <div>When <code>type</code> is <code>http_header</code>, the <code>header_name</code> parameter is mandatory and the valid choice is: <code>header_is_any</code>.</div> <div>When <code>type</code> is <code>http_method</code>, the valid choices are: <code>method_matches_with_any</code>.</div> <div>When <code>type</code> is <code>all_traffic</code>, the system removes all existing conditions from this rule.</div> </td> </tr> <tr> <td colspan="3">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Description of the policy rule.</div> </td> </tr> <tr> <td colspan="3">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of the rule.</div> </td> </tr> <tr> <td colspan="3">  <b>partition</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"Common"</div> </td> <td> <div>Device partition to manage resources on.</div> </td> </tr> <tr> <td colspan="3">  <b>policy</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of the policy you want to associate this rule with.</div> </td> </tr> <tr> <td colspan="3">  <b>provider</b>  <div> <span>dictionary</span> </div> <div> added in 1.0.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>A dict object containing connection details.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>auth_provider</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Configures the auth provider for to obtain authentication tokens from the remote device.</div> <div>This option is really used when working with BIG-IQ devices.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>no_f5_teem</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <code>yes</code>, TEEM telemetry data is not sent to F5.</div> <div>You may omit this option by setting the environment variable <code>F5_TELEMETRY_OFF</code>.</div> <div>Previously used variable <code>F5_TEEM</code> is deprecated as its name was confusing.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>password</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The password for the user account used to connect to the BIG-IP.</div> <div>You may omit this option by setting the environment variable <code>F5_PASSWORD</code>.</div> <div>
<br>aliases: pass, pwd</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>server</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The BIG-IP host.</div> <div>You may omit this option by setting the environment variable <code>F5_SERVER</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>server_port</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>443</div> </td> <td> <div>The BIG-IP server port.</div> <div>You may omit this option by setting the environment variable <code>F5_SERVER_PORT</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>timeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Specifies the timeout in seconds for communicating with the network device for either connecting or sending commands. If the timeout is exceeded before the operation is completed, the module will error.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>transport</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>rest</b> ←</div></li> </ul> </td> <td> <div>Configures the transport connection to use when connecting to the remote device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>user</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The username to connect to the BIG-IP with. This user must have administrative privileges on the device.</div> <div>You may omit this option by setting the environment variable <code>F5_USER</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>If <code>no</code>, SSL certificates are not validated. Use this only on personally controlled sites using self-signed certificates.</div> <div>You may omit this option by setting the environment variable <code>F5_VALIDATE_CERTS</code>.</div> </td> </tr> <tr> <td colspan="3">  <b>replace_with</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Specifies if the conditions given by the user should overwrite what exists on the device.</div> <div>The option is useful when a subset of conditions needs to be removed. This option is similar to the replace-all-with flag available in TMSH commands.</div> <div>Using this option is not idempotent.</div> </td> </tr> <tr> <td colspan="3">  <b>rule_order</b>  <div> <span>integer</span> </div> <div> added in 1.10.0 of f5networks.f5_modules </div> </td> <td> </td> <td> <div>Specifies a number that indicates the order of this rule relative to other rules in the policy.</div> <div>When not set, the device sets the parameter to 0.</div> <div>If there are rules with the same rule order number, the device uses rule names to determine how the rules are ordered.</div> <div>The lower the number, the lower the rule is in the general order, with the lowest number <code>0</code> being the topmost one.</div> <div>Valid range of values is between <code>0</code> and <code>4294967295</code> inclusive.</div> </td> </tr> <tr> <td colspan="3">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>present</b> ←</div></li> <li>absent</li> </ul> </td> <td> <div>When <code>present</code>, ensures the key is uploaded to the device. When <code>absent</code>, ensures the key is removed from the device. If the key is currently in use, the module will not be able to remove the key.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>For more information on using Ansible to manage F5 Networks devices see <a class="reference external" href="https://www.ansible.com/integrations/networks/f5">https://www.ansible.com/integrations/networks/f5</a>.</li> <li>Requires BIG-IP software version &gt;= 12.</li> <li>The F5 modules only manipulate the running configuration of the F5 product. To ensure that BIG-IP specific configuration persists to disk, be sure to include at least one task that uses the <a class="reference internal" href="bigip_config_module.html#ansible-collections-f5networks-f5-modules-bigip-config-module"><span class="std std-ref">f5networks.f5_modules.bigip_config</span></a> module to save the running configuration. Refer to the module’s documentation for the correct usage of the module to save your running configuration.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Create policies
  bigip_policy:
    name: Policy-Foo
    state: present
    provider:
      server: lb.mydomain.com
      user: admin
      password: secret
  delegate_to: localhost

- name: Add a rule to the new policy
  bigip_policy_rule:
    policy: Policy-Foo
    name: rule3
    conditions:
      - type: http_uri
        path_begins_with_any:
          - /ABC
    actions:
      - type: forward
        pool: pool-svrs
    provider:
      server: lb.mydomain.com
      user: admin
      password: secret
  delegate_to: localhost

- name: Add multiple rules to the new policy
  bigip_policy_rule:
    policy: Policy-Foo
    name: "{{ item.name }}"
    conditions: "{{ item.conditions }}"
    actions: "{{ item.actions }}"
    provider:
      server: lb.mydomain.com
      user: admin
      password: secret
  delegate_to: localhost
  loop:
    - name: rule1
      actions:
        - type: forward
          pool: pool-svrs
      conditions:
        - type: http_uri
          path_begins_with_any:
            - /euro
    - name: rule2
      actions:
        - type: forward
          pool: pool-svrs
      conditions:
        - type: http_uri
          path_begins_with_any:
            - /HomePage/
    - name: rule3
      actions:
        - type: set_variable
          variable_name: user-agent
          expression: tcl:[HTTP::header User-Agent]
          event: request
      conditions:
        - type: http_uri
          path_begins_with_any:
            - /HomePage/

- name: Remove all rules and conditions from the rule
  bigip_policy_rule:
    policy: Policy-Foo
    name: rule1
    conditions:
      - type: all_traffic
    actions:
      - type: ignore
    provider:
      server: lb.mydomain.com
      user: admin
      password: secret
  delegate_to: localhost
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="2">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="2">  <b>actions</b>  <div> <span>complex</span> </div> </td> <td>changed</td> <td> <div>The new list of actions applied to the rule.</div> <br> <div><b>Sample:</b></div> <div>hash/dictionary of values</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>pool</b>  <div> <span>string</span> </div> </td> <td>changed</td> <td> <div>Pool for forwarding to.</div> <br> <div><b>Sample:</b></div> <div>foo-pool</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>type</b>  <div> <span>string</span> </div> </td> <td>changed</td> <td> <div>The action type.</div> <br> <div><b>Sample:</b></div> <div>forward</div> </td> </tr> <tr> <td colspan="2">  <b>conditions</b>  <div> <span>complex</span> </div> </td> <td>changed</td> <td> <div>The new list of conditions applied to the rule.</div> <br> <div><b>Sample:</b></div> <div>hash/dictionary of values</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>path_begins_with_any</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td>changed</td> <td> <div>List of strings the URI begins with.</div> <br> <div><b>Sample:</b></div> <div>['foo', 'bar']</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>type</b>  <div> <span>string</span> </div> </td> <td>changed</td> <td> <div>The condition type.</div> <br> <div><b>Sample:</b></div> <div>http_uri</div> </td> </tr> <tr> <td colspan="2">  <b>description</b>  <div> <span>string</span> </div> </td> <td>changed</td> <td> <div>The new description of the rule.</div> <br> <div><b>Sample:</b></div> <div>My rule</div> </td> </tr> <tr> <td colspan="2">  <b>rule_order</b>  <div> <span>integer</span> </div> </td> <td>changed</td> <td> <div>Specifies a number that indicates the order of this rule relative to other rules in the policy.</div> <br> <div><b>Sample:</b></div> <div>10</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Tim Rupp (@caphrim007)</li> <li>Wojciech Wypior (@wojtek0806)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/f5networks/f5_modules/bigip_policy_rule_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/f5networks/f5_modules/bigip_policy_rule_module.html</a>
  </p>
</div>
