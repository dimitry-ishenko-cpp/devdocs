<h1 id="ovirt-ovirt-ovirt-vm-module-to-manage-virtual-machines-in-ovirt-rhv">ovirt.ovirt.ovirt_vm – Module to manage Virtual Machines in oVirt/RHV</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ovirt/ovirt">ovirt.ovirt collection</a> (version 1.6.4).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install ovirt.ovirt</code>.</p> <p>To use it in a playbook, specify: <code>ovirt.ovirt.ovirt_vm</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of ovirt.ovirt</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This module manages whole lifecycle of the Virtual Machine(VM) in oVirt/RHV.</li> <li>Since VM can hold many states in oVirt/RHV, this see notes to see how the states of the VM are handled.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python &gt;= 2.7</li> <li>ovirt-engine-sdk-python &gt;= 4.4.0</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="2">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="2">  <b>affinity_group_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps affinity name between VM's OVF and the destination affinity this VM should be registered to, relevant when <code>state</code> is registered.</div> </td> </tr> <tr> <td colspan="2">  <b>affinity_label_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps affinity label name between VM's OVF and the destination label this VM should be registered to, relevant when <code>state</code> is registered.</div> </td> </tr> <tr> <td colspan="2">  <b>allow_partial_import</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Boolean indication whether to allow partial registration of Virtual Machine when <code>state</code> is registered.</div> </td> </tr> <tr> <td colspan="2">  <b>auth</b>  <div> <span>dictionary</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Dictionary with values needed to create HTTP/HTTPS connection to oVirt:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ca_file</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A PEM file containing the trusted CA certificates.</div> <div>The certificate presented by the server will be verified using these CA certificates.</div> <div>If <code>ca_file</code> parameter is not set, system wide CA certificate store is used.</div> <div>Default value is set by <code>OVIRT_CAFILE</code> environment variable.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>compress</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Flag indicating if compression is used for connection.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>headers</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of HTTP headers to be added to each API call.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>hostname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A string containing the hostname of the server, usually something like `<em>server.example.com</em>`.</div> <div>Default value is set by <code>OVIRT_HOSTNAME</code> environment variable.</div> <div>Either <code>url</code> or <code>hostname</code> is required.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>insecure</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>A boolean flag that indicates if the server TLS certificate and host name should be checked.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>kerberos</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>A boolean flag indicating if Kerberos authentication should be used instead of the default basic authentication.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The password of the user.</div> <div>Default value is set by <code>OVIRT_PASSWORD</code> environment variable.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>timeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of seconds to wait for response.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Token to be used instead of login with username/password.</div> <div>Default value is set by <code>OVIRT_TOKEN</code> environment variable.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A string containing the API URL of the server, usually something like `<em>https://server.example.com/ovirt-engine/api</em>`.</div> <div>Default value is set by <code>OVIRT_URL</code> environment variable.</div> <div>Either <code>url</code> or <code>hostname</code> is required.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>username</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the user, something like <em>admin@internal</em>.</div> <div>Default value is set by <code>OVIRT_USERNAME</code> environment variable.</div> </td> </tr> <tr> <td colspan="2">  <b>ballooning_enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, use memory ballooning.</div> <div>Memory balloon is a guest device, which may be used to re-distribute / reclaim the host memory based on VM needs in a dynamic way. In this way it's possible to create memory over commitment states.</div> </td> </tr> <tr> <td colspan="2">  <b>bios_type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>i440fx_sea_bios</li> <li>q35_ovmf</li> <li>q35_sea_bios</li> <li>q35_secure_boot</li> </ul> </td> <td> <div>Set bios type, necessary for some operating systems and secure boot.</div> <div>If no value is passed, default value is set from cluster.</div> <div>NOTE - Supported since oVirt 4.3.</div> </td> </tr> <tr> <td colspan="2">  <b>boot_devices</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>cdrom</li> <li>hd</li> <li>network</li> </ul> </td> <td> <div>List of boot devices which should be used to boot. For example <code>[ cdrom, hd ]</code>.</div> <div>Default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>boot_menu</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<em>True</em> enable menu to select boot device, <em>False</em> to disable it. By default is chosen by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>cd_iso</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>ISO file from ISO storage domain which should be attached to Virtual Machine.</div> <div>If you have multiple ISO disks with the same name use disk ID to specify which should be used or use <code>storage_domain</code> to filter disks.</div> <div>If you pass empty string the CD will be ejected from VM.</div> <div>If used with <code>state</code> <em>running</em> or <em>present</em> and VM is running the CD will be attached to VM.</div> <div>If used with <code>state</code> <em>running</em> or <em>present</em> and VM is down the CD will be attached to VM persistently.</div> </td> </tr> <tr> <td colspan="2">  <b>clone</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <em>yes</em> then the disks of the created virtual machine will be cloned and independent of the template.</div> <div>This parameter is used only when <code>state</code> is <em>running</em> or <em>present</em> and VM didn't exist before.</div> </td> </tr> <tr> <td colspan="2">  <b>clone_permissions</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <em>yes</em> then the permissions of the template (only the direct ones, not the inherited ones) will be copied to the created virtual machine.</div> <div>This parameter is used only when <code>state</code> is <em>running</em> or <em>present</em> and VM didn't exist before.</div> </td> </tr> <tr> <td colspan="2">  <b>cloud_init</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary with values for Unix-like Virtual Machine initialization using cloud init.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>authorized_ssh_keys</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Use this SSH keys to login to Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>custom_script</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Cloud-init script which will be executed on Virtual Machine when deployed.</div> <div>This is appended to the end of the cloud-init script generated by any other options.</div> <div>For further information, refer to cloud-init User-Data documentation.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dns_search</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>DNS search domains to be configured on Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dns_servers</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>DNS servers to be configured on Virtual Machine, maximum of two, space-separated.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>host_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Hostname to be set to Virtual Machine when deployed.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_boot_protocol</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>none</li> <li>dhcp</li> <li>static</li> </ul> </td> <td> <div>Set boot protocol of the network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_boot_protocol_v6</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>none</li> <li>dhcp</li> <li>static</li> </ul> </td> <td> <div>Set boot protocol of the network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_gateway</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this gateway to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_gateway_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this gateway to network interface of Virtual Machine.</div> <div>For IPv6 addresses the value is an integer in the range of 0-128, which represents the subnet prefix.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_ip_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this IP address to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_ip_address_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this IP address to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set name to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_netmask</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this netmask to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_netmask_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this netmask to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>regenerate_ssh_keys</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>True</em> SSH keys will be regenerated on Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>root_password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Password to be set for user specified by <code>user_name</code> parameter.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>timezone</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Timezone to be set to Virtual Machine when deployed.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>user_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Username to be used to set password to Virtual Machine when deployed.</div> </td> </tr> <tr> <td colspan="2">  <b>cloud_init_nics</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of dictionaries representing network interfaces to be setup by cloud init.</div> <div>This option is used, when user needs to setup more network interfaces via cloud init.</div> <div>If one network interface is enough, user should use <code>cloud_init</code> <em>nic_*</em> parameters. <code>cloud_init</code> <em>nic_*</em> parameters are merged with <code>cloud_init_nics</code> parameters.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_boot_protocol</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set boot protocol of the network interface of Virtual Machine. Can be one of <code>none</code>, <code>dhcp</code> or <code>static</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_boot_protocol_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set boot protocol of the network interface of Virtual Machine. Can be one of <code>none</code>, <code>dhcp</code> or <code>static</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_gateway</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this gateway to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_gateway_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this gateway to network interface of Virtual Machine.</div> <div>For IPv6 addresses the value is an integer in the range of 0-128, which represents the subnet prefix.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_ip_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this IP address to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_ip_address_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this IP address to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set name to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_netmask</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this netmask to network interface of Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>nic_netmask_v6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>If boot protocol is static, set this netmask to network interface of Virtual Machine.</div> </td> </tr> <tr> <td colspan="2">  <b>cloud_init_persist</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <em>yes</em> the <code>cloud_init</code> or <code>sysprep</code> parameters will be saved for the virtual machine and the virtual machine won't be started as run-once.</div> <div>
<br>aliases: sysprep_persist</div> </td> </tr> <tr> <td colspan="2">  <b>cluster</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the cluster, where Virtual Machine should be created.</div> <div>Required if creating VM.</div> </td> </tr> <tr> <td colspan="2">  <b>cluster_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps cluster name between VM's OVF and the destination cluster this VM should be registered to, relevant when <code>state</code> is registered. Cluster mapping is described by the following dictionary:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dest_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the destination cluster.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>source_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the source cluster.</div> </td> </tr> <tr> <td colspan="2">  <b>comment</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Comment of the Virtual Machine.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_cores</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of virtual CPUs cores of the Virtual Machine.</div> <div>Default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_mode</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CPU mode of the virtual machine. It can be some of the following: <em>host_passthrough</em>, <em>host_model</em> or <em>custom</em>.</div> <div>For <em>host_passthrough</em> CPU type you need to set <code>placement_policy</code> to <em>pinned</em>.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_pinning</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>CPU Pinning topology to map virtual machine CPU to host CPU.</div> <div>CPU Pinning topology is a list of dictionary which can have following values:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cpu</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Number of the host CPU.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>vcpu</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Number of the virtual machine CPU.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_shares</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Set a CPU shares for this Virtual Machine.</div> <div>Default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_sockets</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of virtual CPUs sockets of the Virtual Machine.</div> <div>Default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_threads</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of threads per core of the Virtual Machine.</div> <div>Default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>custom_compatibility_version</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Enables a virtual machine to be customized to its own compatibility version. If '<code>custom_compatibility_version</code>' is set, it overrides the cluster's compatibility version for this particular virtual machine.</div> </td> </tr> <tr> <td colspan="2">  <b>custom_emulated_machine</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Sets the value of the custom_emulated_machine attribute.</div> </td> </tr> <tr> <td colspan="2">  <b>custom_properties</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Properties sent to VDSM to configure various hooks.</div> <div>Custom properties is a list of dictionary which can have following values:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the custom property. For example: <em>hugepages</em>, <em>vhost</em>, <em>sap_agent</em>, etc.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>regexp</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Regular expression to set for custom property.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Value to set for custom property.</div> </td> </tr> <tr> <td colspan="2">  <b>delete_protected</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>yes</em> Virtual Machine will be set as delete protected.</div> <div>If <em>no</em> Virtual Machine won't be set as delete protected.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Description of the Virtual Machine.</div> </td> </tr> <tr> <td colspan="2">  <b>disk_format</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>cow</b> ←</div></li> <li>raw</li> </ul> </td> <td> <div>Specify format of the disk.</div> <div>If <code>cow</code> format is used, disk will by created as sparse, so space will be allocated for the volume as needed, also known as <em>thin provision</em>.</div> <div>If <code>raw</code> format is used, disk storage will be allocated right away, also known as <em>preallocated</em>.</div> <div>Note that this option isn't idempotent as it's not currently possible to change format of the disk via API.</div> <div>This parameter is considered only when <code>template</code> and <code>storage domain</code> is provided.</div> </td> </tr> <tr> <td colspan="2">  <b>disks</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of disks, which should be attached to Virtual Machine. Disk is described by following dictionary.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>activate</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<em>True</em> if the disk should be activated, default is activated.</div> <div>NOTE - This parameter is used only when <code>state</code> is <em>running</em> or <em>present</em> and is able to only attach disks. To manage disks of the VM in more depth please use <a href="ovirt_disk_module.html" class="module">ovirt.ovirt.ovirt_disk</a> module instead.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>bootable</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<em>True</em> if the disk should be bootable, default is non bootable.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>ID of the disk. Either <code>name</code> or <code>id</code> is required.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interface</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>virtio</b> ←</div></li> <li>ide</li> </ul> </td> <td> <div>Interface of the disk.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the disk. Either <code>name</code> or <code>id</code> is required.</div> </td> </tr> <tr> <td colspan="2">  <b>domain_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps aaa domain name between VM's OVF and the destination aaa domain this VM should be registered to, relevant when <code>state</code> is registered. The aaa domain mapping is described by the following dictionary:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dest_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the destination aaa domain.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>source_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the source aaa domain.</div> </td> </tr> <tr> <td colspan="2">  <b>exclusive</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>When <code>state</code> is <em>exported</em> this parameter indicates if the existing VM with the same name should be overwritten.</div> </td> </tr> <tr> <td colspan="2">  <b>export_domain</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>When <code>state</code> is <em>exported</em>this parameter specifies the name of the export storage domain.</div> </td> </tr> <tr> <td colspan="2">  <b>export_ova</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of values to be used to export VM as OVA.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>directory</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the directory where the OVA has to be exported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>filename</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the exported OVA file.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>host</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the destination host where the OVA has to be exported.</div> </td> </tr> <tr> <td colspan="2">  <b>fetch_nested</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <em>True</em> the module will fetch additional data from the API.</div> <div>It will fetch IDs of the VMs disks, snapshots, etc. User can configure to fetch other attributes of the nested entities by specifying <code>nested_attributes</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>force</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Please check to <em>Synopsis</em> to more detailed description of force parameter, it can behave differently in different situations.</div> </td> </tr> <tr> <td colspan="2">  <b>force_migrate</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, the VM will migrate when <em>placement_policy=user-migratable</em> but not when <em>placement_policy=pinned</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>graphical_console</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Assign graphical console to the virtual machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>disconnect_action</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Returns the action that will take place when the graphic console(SPICE only) is disconnected. The options are:</div> <div>
<em>none</em> No action is taken.</div> <div>
<em>lock_screen</em> Locks the currently active user session.</div> <div>
<em>logout</em> Logs out the currently active user session.</div> <div>
<em>reboot</em> Initiates a graceful virtual machine reboot.</div> <div>
<em>shutdown</em> Initiates a graceful virtual machine shutdown.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>headless_mode</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em> disable the graphics console for this virtual machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>keyboard_layout</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The keyboard layout to use with this graphic console.</div> <div>This option is only available for the VNC console type.</div> <div>If no keyboard is enabled then it won't be reported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>monitors</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The number of monitors opened for this graphic console.</div> <div>This option is only available for the SPICE protocol.</div> <div>Possible values are 1, 2 or 4.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>protocol</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Graphical protocol, a list of <em>spice</em>, <em>vnc</em>, or both.</div> </td> </tr> <tr> <td colspan="2">  <b>high_availability</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>yes</em> Virtual Machine will be set as highly available.</div> <div>If <em>no</em> Virtual Machine won't be set as highly available.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>high_availability_priority</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Indicates the priority of the virtual machine inside the run and migration queues. Virtual machines with higher priorities will be started and migrated before virtual machines with lower priorities. The value is an integer between 0 and 100. The higher the value, the higher the priority.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>host</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specify host where Virtual Machine should be running. By default the host is chosen by engine scheduler.</div> <div>This parameter is used only when <code>state</code> is <em>running</em> or <em>present</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>host_devices</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Single Root I/O Virtualization - technology that allows single device to expose multiple endpoints that can be passed to VMs</div> <div>host_devices is an list which contain dictionary with name and state of device</div> </td> </tr> <tr> <td colspan="2">  <b>id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>ID of the Virtual Machine to manage.</div> </td> </tr> <tr> <td colspan="2">  <b>initrd_path</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Path to an initial ramdisk to be used with the kernel specified by <code>kernel_path</code> option.</div> <div>Ramdisk image must be stored on either the ISO domain or on the host's storage.</div> </td> </tr> <tr> <td colspan="2">  <b>instance_type</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of virtual machine's hardware configuration.</div> <div>By default no instance type is used.</div> </td> </tr> <tr> <td colspan="2">  <b>io_threads</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of IO threads used by virtual machine. <em>0</em> means IO threading disabled.</div> </td> </tr> <tr> <td colspan="2">  <b>kernel_params</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Kernel command line parameters (formatted as string) to be used with the kernel specified by <code>kernel_path</code> option.</div> </td> </tr> <tr> <td colspan="2">  <b>kernel_params_persist</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em> <code>kernel_params</code>, <code>initrd_path</code> and <code>kernel_path</code> will persist in virtual machine configuration, if <em>False</em> it will be used for run once.</div> </td> </tr> <tr> <td colspan="2">  <b>kernel_path</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Path to a kernel image used to boot the virtual machine.</div> <div>Kernel image must be stored on either the ISO domain or on the host's storage.</div> </td> </tr> <tr> <td colspan="2">  <b>kvm</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of values to be used to connect to kvm and import a virtual machine to oVirt.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>drivers_iso</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the ISO containing drivers that can be used during the <em>virt-v2v</em> conversion process.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the KVM virtual machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The password to authenticate against the KVM.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>sparse</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Specifies the disk allocation policy of the resulting virtual machine. <em>true</em> for sparse, <em>false</em> for preallocated.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>storage_domain</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specifies the target storage domain for converted disks. This is required parameter.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The URL to be passed to the <em>virt-v2v</em> tool for conversion.</div> <div>For example <em>qemu:///system</em>. This is required parameter.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>username</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The username to authenticate against the KVM.</div> </td> </tr> <tr> <td colspan="2">  <b>lease</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the storage domain this virtual machine lease reside on. Pass an empty string to remove the lease.</div> <div>NOTE - Supported since oVirt 4.1.</div> </td> </tr> <tr> <td colspan="2">  <b>lun_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps lun between VM's OVF and the destination lun this VM should contain, relevant when <code>state</code> is registered. lun_mappings is described by the following dictionary:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The address of the block storage host.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The logical unit number to identify a logical unit,</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_password)</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Password to be used to connect to the block storage host.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_port</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The port being used to connect with the LUN disk.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_portal</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The portal being used to connect with the LUN disk.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_target</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The iSCSI specification located on an iSCSI server</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>logical_unit_username</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Username to be used to connect to the block storage host.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>storage_type</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The storage type which the LUN reside on (iscsi or fcp)"</div> </td> </tr> <tr> <td colspan="2">  <b>memory</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Amount of memory of the Virtual Machine. Prefix uses IEC 60027-2 standard (for example 1GiB, 1024MiB).</div> <div>Default value is set by engine.</div> </td> </tr> <tr> <td colspan="2">  <b>memory_guaranteed</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Amount of minimal guaranteed memory of the Virtual Machine. Prefix uses IEC 60027-2 standard (for example 1GiB, 1024MiB).</div> <div>
<code>memory_guaranteed</code> parameter can't be lower than <code>memory</code> parameter.</div> <div>Default value is set by engine.</div> </td> </tr> <tr> <td colspan="2">  <b>memory_max</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Upper bound of virtual machine memory up to which memory hot-plug can be performed. Prefix uses IEC 60027-2 standard (for example 1GiB, 1024MiB).</div> <div>Default value is set by engine.</div> </td> </tr> <tr> <td colspan="2">  <b>migrate</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, the VM will migrate to any available host.</div> </td> </tr> <tr> <td colspan="2">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the Virtual Machine to manage.</div> <div>If VM don't exists <code>name</code> is required. Otherwise <code>id</code> or <code>name</code> can be used.</div> </td> </tr> <tr> <td colspan="2">  <b>nested_attributes</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Specifies list of the attributes which should be fetched from the API.</div> <div>This parameter apply only when <code>fetch_nested</code> is <em>true</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>next_run</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, the update will not be applied to the VM immediately and will be only applied when virtual machine is restarted.</div> <div>NOTE - If there are multiple next run configuration changes on the VM, the first change may get reverted if this option is not passed.</div> </td> </tr> <tr> <td colspan="2">  <b>nics</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of NICs, which should be attached to Virtual Machine. NIC is described by following dictionary.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interface</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>virtio</b> ←</div></li> <li>e1000</li> <li>rtl8139</li> </ul> </td> <td> <div>Type of the network interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>mac_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Custom MAC address of the network interface, by default it's obtained from MAC pool.</div> <div>NOTE - This parameter is used only when <code>state</code> is <em>running</em> or <em>present</em> and is able to only create NICs. To manage NICs of the VM in more depth please use <a href="ovirt_nic_module.html" class="module">ovirt.ovirt.ovirt_nic</a> module instead.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the NIC.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>profile_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Profile name where NIC should be attached.</div> </td> </tr> <tr> <td colspan="2">  <b>numa_nodes</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of vNUMA Nodes to set for this VM and pin them to assigned host's physical NUMA node.</div> <div>Each vNUMA node is described by following dictionary:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cores</b>  <div> <span>list</span> / <span>elements=string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>List of VM CPU cores indexes to be included in this NUMA node.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>index</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The index of this NUMA node.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>memory</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Memory size of the NUMA node in MiB.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>numa_node_pins</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of physical NUMA node indexes to pin this virtual NUMA node to.</div> </td> </tr> <tr> <td colspan="2">  <b>numa_tune_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>interleave</li> <li>preferred</li> <li>strict</li> </ul> </td> <td> <div>Set how the memory allocation for NUMA nodes of this VM is applied (relevant if NUMA nodes are set for this VM).</div> <div>It can be one of the following: <em>interleave</em>, <em>preferred</em> or <em>strict</em>.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>operating_system</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Operating system of the Virtual Machine, for example 'rhel_8x64'.</div> <div>Default value is set by oVirt/RHV engine.</div> <div>Use the <a href="ovirt_vm_os_info_module.html" class="module">ovirt.ovirt.ovirt_vm_os_info</a> module to obtain the current list.</div> </td> </tr> <tr> <td colspan="2">  <b>placement_policy</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The configuration of the virtual machine's placement policy.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> <div>Placement policy can be one of the following values:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>migratable</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Allow manual and automatic migration.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>pinned</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Do not allow migration.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>user_migratable</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Allow manual migration only.</div> </td> </tr> <tr> <td colspan="2">  <b>placement_policy_hosts</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of host names.</div> </td> </tr> <tr> <td colspan="2">  <b>poll_interval</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>3</div> </td> <td> <div>Number of the seconds the module waits until another poll request on entity status is sent.</div> </td> </tr> <tr> <td colspan="2">  <b>quota_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Virtual Machine quota ID to be used for disk. By default quota is chosen by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>reassign_bad_macs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Boolean indication whether to reassign bad macs when <code>state</code> is registered.</div> </td> </tr> <tr> <td colspan="2">  <b>rng_device</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Random number generator (RNG). You can choose of one the following devices <em>urandom</em>, <em>random</em> or <em>hwrng</em>.</div> <div>In order to select <em>hwrng</em>, you must have it enabled on cluster first.</div> <div>/dev/urandom is used for cluster version &gt;= 4.1, and /dev/random for cluster version &lt;= 4.0</div> </td> </tr> <tr> <td colspan="2">  <b>role_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps role name between VM's OVF and the destination role this VM should be registered to, relevant when <code>state</code> is registered. Role mapping is described by the following dictionary:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dest_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the destination role.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>source_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the source role.</div> </td> </tr> <tr> <td colspan="2">  <b>serial_console</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<em>True</em> enable VirtIO serial console, <em>False</em> to disable it. By default is chosen by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>serial_policy</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>vm</li> <li>host</li> <li>custom</li> </ul> </td> <td> <div>Specify a serial number policy for the Virtual Machine.</div> <div>Following options are supported.</div> <div>
<code>vm</code> - Sets the Virtual Machine's UUID as its serial number.</div> <div>
<code>host</code> - Sets the host's UUID as the Virtual Machine's serial number.</div> <div>
<code>custom</code> - Allows you to specify a custom serial number in <code>serial_policy_value</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>serial_policy_value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Allows you to specify a custom serial number.</div> <div>This parameter is used only when <code>serial_policy</code> is <em>custom</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>smartcard_enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, use smart card authentication.</div> </td> </tr> <tr> <td colspan="2">  <b>snapshot_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Snapshot to clone VM from.</div> <div>Snapshot with description specified should exist.</div> <div>You have to specify <code>snapshot_vm</code> parameter with virtual machine name of this snapshot.</div> </td> </tr> <tr> <td colspan="2">  <b>snapshot_vm</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Source VM to clone VM from.</div> <div>VM should have snapshot specified by <code>snapshot</code>.</div> <div>If <code>snapshot_name</code> specified <code>snapshot_vm</code> is required.</div> </td> </tr> <tr> <td colspan="2">  <b>soundcard_enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, the sound card is added to the virtual machine.</div> </td> </tr> <tr> <td colspan="2">  <b>sso</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<em>True</em> enable Single Sign On by Guest Agent, <em>False</em> to disable it. By default is chosen by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li>next_run</li> <li><div>
<b>present</b> ←</div></li> <li>registered</li> <li>running</li> <li>stopped</li> <li>suspended</li> <li>exported</li> <li>reboot</li> </ul> </td> <td> <div>Should the Virtual Machine be running/stopped/present/absent/suspended/next_run/registered/exported/reboot. When <code>state</code> is <em>registered</em> and the unregistered VM's name belongs to an already registered in engine VM in the same DC then we fail to register the unregistered template.</div> <div>
<em>present</em> state will create/update VM and don't change its state if it already exists.</div> <div>
<em>running</em> state will create/update VM and start it.</div> <div>
<em>next_run</em> state updates the VM and if the VM has next run configuration it will be rebooted.</div> <div>Please check <em>notes</em> to more detailed description of states.</div> <div>
<em>exported</em> state will export the VM to export domain or as OVA.</div> <div>
<em>registered</em> is supported since 2.4.</div> <div>
<em>reboot</em> is supported since 2.10, virtual machine is rebooted only if it's in up state.</div> </td> </tr> <tr> <td colspan="2">  <b>stateless</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>yes</em> Virtual Machine will be set as stateless.</div> <div>If <em>no</em> Virtual Machine will be unset as stateless.</div> <div>If no value is passed, default value is set by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>storage_domain</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the storage domain where all template disks should be created.</div> <div>This parameter is considered only when <code>template</code> is provided.</div> <div>IMPORTANT - This parameter is not idempotent, if the VM exists and you specify different storage domain, disk won't move.</div> </td> </tr> <tr> <td colspan="2">  <b>sysprep</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary with values for Windows Virtual Machine initialization using sysprep.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>active_directory_ou</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Active Directory Organizational Unit, to be used for login of user.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>custom_script</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A custom Sysprep definition in the format of a complete unattended installation answer file.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>domain</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Domain to be set to Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>host_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Hostname to be set to Virtual Machine when deployed.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>input_locale</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Input localization of the Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>org_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Organization name to be set to Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>root_password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Password to be set for username to Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>system_locale</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>System localization of the Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>timezone</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Timezone to be set to Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ui_language</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>UI language of the Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>user_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Username to be used for set password to Windows Virtual Machine.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>windows_license_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>License key to be set to Windows Virtual Machine.</div> </td> </tr> <tr> <td colspan="2">  <b>template</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of the template, which should be used to create Virtual Machine.</div> <div>Required if creating VM.</div> <div>If template is not specified and VM doesn't exist, VM will be created from <em>Blank</em> template.</div> </td> </tr> <tr> <td colspan="2">  <b>template_version</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Version number of the template to be used for VM.</div> <div>By default the latest available version of the template is used.</div> </td> </tr> <tr> <td colspan="2">  <b>ticket</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>true</em>, in addition return <em>remote_vv_file</em> inside <em>vm</em> dictionary, which contains compatible content for remote-viewer application. Works only <code>state</code> is <em>running</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>timeout</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>180</div> </td> <td> <div>The amount of time in seconds the module should wait for the instance to get into desired state.</div> </td> </tr> <tr> <td colspan="2">  <b>timezone</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Sets time zone offset of the guest hardware clock.</div> <div>For example <code>Etc/GMT</code>
</div> </td> </tr> <tr> <td colspan="2">  <b>type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>desktop</li> <li>server</li> <li>high_performance</li> </ul> </td> <td> <div>Type of the Virtual Machine.</div> <div>Default value is set by oVirt/RHV engine.</div> <div>
<em>high_performance</em> is supported since Ansible 2.5 and oVirt/RHV 4.2.</div> </td> </tr> <tr> <td colspan="2">  <b>usb_support</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>
<em>True</em> enable USB support, <em>False</em> to disable it. By default is chosen by oVirt/RHV engine.</div> </td> </tr> <tr> <td colspan="2">  <b>use_latest_template_version</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Specify if latest template version should be used, when running a stateless VM.</div> <div>If this parameter is set to <em>yes</em> stateless VM is created.</div> </td> </tr> <tr> <td colspan="2">  <b>vmware</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of values to be used to connect to VMware and import a virtual machine to oVirt.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>drivers_iso</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the ISO containing drivers that can be used during the <em>virt-v2v</em> conversion process.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The password to authenticate against the VMware.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>sparse</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Specifies the disk allocation policy of the resulting virtual machine. <em>true</em> for sparse, <em>false</em> for preallocated.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>storage_domain</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specifies the target storage domain for converted disks. This is required parameter.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The URL to be passed to the <em>virt-v2v</em> tool for conversion.</div> <div>For example <em>vpx://wmware_user@vcenter-host/DataCenter/Cluster/esxi-host?no_verify=1</em>
</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>username</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The username to authenticate against the VMware.</div> </td> </tr> <tr> <td colspan="2">  <b>vnic_profile_mappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Mapper which maps an external virtual NIC profile to one that exists in the engine when <code>state</code> is registered. vnic_profile is described by the following dictionary:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>source_network_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The network name of the source network.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>source_profile_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The profile name related to the source network.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>target_profile_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The id of the target profile id to be mapped to in the engine.</div> </td> </tr> <tr> <td colspan="2">  <b>wait</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>
<code>yes</code> if the module should wait for the entity to get into desired state.</div> </td> </tr> <tr> <td colspan="2">  <b>watchdog</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Assign watchdog device for the virtual machine.</div> <div>Watchdogs is a dictionary which can have following values:</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>action</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Watchdog action to be performed when watchdog is triggered. For example: <em>none</em>, <em>reset</em>, <em>poweroff</em>, <em>pause</em> or <em>dump</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>model</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Model of the watchdog device. For example: <em>i6300esb</em>, <em>diag288</em> or <em>null</em>.</div> </td> </tr> <tr> <td colspan="2">  <b>xen</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of values to be used to connect to XEN and import a virtual machine to oVirt.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>drivers_iso</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the ISO containing drivers that can be used during the <em>virt-v2v</em> conversion process.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>sparse</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Specifies the disk allocation policy of the resulting virtual machine. <em>true</em> for sparse, <em>false</em> for preallocated.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>storage_domain</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specifies the target storage domain for converted disks. This is required parameter.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The URL to be passed to the <em>virt-v2v</em> tool for conversion.</div> <div>For example <em>xen+ssh://root@zen.server</em>. This is required parameter.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>If VM is in <em>UNASSIGNED</em> or <em>UNKNOWN</em> state before any operation, the module will fail. If VM is in <em>IMAGE_LOCKED</em> state before any operation, we try to wait for VM to be <em>DOWN</em>. If VM is in <em>SAVING_STATE</em> state before any operation, we try to wait for VM to be <em>SUSPENDED</em>. If VM is in <em>POWERING_DOWN</em> state before any operation, we try to wait for VM to be <em>UP</em> or <em>DOWN</em>. VM can get into <em>UP</em> state from <em>POWERING_DOWN</em> state, when there is no ACPI or guest agent running inside VM, or if the shutdown operation fails. When user specify <em>UP</em> <code>state</code>, we always wait to VM to be in <em>UP</em> state in case VM is <em>MIGRATING</em>, <em>REBOOTING</em>, <em>POWERING_UP</em>, <em>RESTORING_STATE</em>, <em>WAIT_FOR_LAUNCH</em>. In other states we run start operation on VM. When user specify <em>stopped</em> <code>state</code>, and If user pass <code>force</code> parameter set to <em>true</em> we forcibly stop the VM in any state. If user don’t pass <code>force</code> parameter, we always wait to VM to be in UP state in case VM is <em>MIGRATING</em>, <em>REBOOTING</em>, <em>POWERING_UP</em>, <em>RESTORING_STATE</em>, <em>WAIT_FOR_LAUNCH</em>. If VM is in <em>PAUSED</em> or <em>SUSPENDED</em> state, we start the VM. Then we gracefully shutdown the VM. When user specify <em>suspended</em> <code>state</code>, we always wait to VM to be in UP state in case VM is <em>MIGRATING</em>, <em>REBOOTING</em>, <em>POWERING_UP</em>, <em>RESTORING_STATE</em>, <em>WAIT_FOR_LAUNCH</em>. If VM is in <em>PAUSED</em> or <em>DOWN</em> state, we start the VM. Then we suspend the VM. When user specify <em>absent</em> <code>state</code>, we forcibly stop the VM in any state and remove it.</li> <li>If you update a VM parameter that requires a reboot, the oVirt engine always creates a new snapshot for the VM, and an Ansible playbook will report this as changed.</li> <li>In order to use this module you have to install oVirt Python SDK. To ensure it’s installed with correct version you can create the following task: <em>pip: name=ovirt-engine-sdk-python version=4.4.0</em>
</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja"># Examples don't contain auth parameter for simplicity,
# look at ovirt_auth module to see how to reuse authentication:

- name: Creates a new Virtual Machine from template named 'rhel7_template'
  ovirt.ovirt.ovirt_vm:
    state: present
    name: myvm
    template: rhel7_template
    cluster: mycluster

- name: Register VM
  ovirt.ovirt.ovirt_vm:
    state: registered
    storage_domain: mystorage
    cluster: mycluster
    name: myvm

- name: Register VM using id
  ovirt.ovirt.ovirt_vm:
    state: registered
    storage_domain: mystorage
    cluster: mycluster
    id: 1111-1111-1111-1111

- name: Register VM, allowing partial import
  ovirt.ovirt.ovirt_vm:
    state: registered
    storage_domain: mystorage
    allow_partial_import: "True"
    cluster: mycluster
    id: 1111-1111-1111-1111

- name: Register VM with vnic profile mappings and reassign bad macs
  ovirt.ovirt.ovirt_vm:
    state: registered
    storage_domain: mystorage
    cluster: mycluster
    id: 1111-1111-1111-1111
    vnic_profile_mappings:
    - source_network_name: mynetwork
      source_profile_name: mynetwork
      target_profile_id: 3333-3333-3333-3333
    - source_network_name: mynetwork2
      source_profile_name: mynetwork2
      target_profile_id: 4444-4444-4444-4444
    reassign_bad_macs: "True"

- name: Register VM with mappings
  ovirt.ovirt.ovirt_vm:
    state: registered
    storage_domain: mystorage
    cluster: mycluster
    id: 1111-1111-1111-1111
    role_mappings:
      - source_name: Role_A
        dest_name: Role_B
    domain_mappings:
      - source_name: Domain_A
        dest_name: Domain_B
    lun_mappings:
      - source_storage_type: iscsi
        source_logical_unit_id: 1IET_000d0001
        source_logical_unit_port: 3260
        source_logical_unit_portal: 1
        source_logical_unit_address: 10.34.63.203
        source_logical_unit_target: iqn.2016-08-09.brq.str-01:omachace
        dest_storage_type: iscsi
        dest_logical_unit_id: 1IET_000d0002
        dest_logical_unit_port: 3260
        dest_logical_unit_portal: 1
        dest_logical_unit_address: 10.34.63.204
        dest_logical_unit_target: iqn.2016-08-09.brq.str-02:omachace
    affinity_group_mappings:
      - source_name: Affinity_A
        dest_name: Affinity_B
    affinity_label_mappings:
      - source_name: Label_A
        dest_name: Label_B
    cluster_mappings:
      - source_name: cluster_A
        dest_name: cluster_B

- name: Creates a stateless VM which will always use latest template version
  ovirt.ovirt.ovirt_vm:
    name: myvm
    template: rhel7
    cluster: mycluster
    use_latest_template_version: true

# Creates a new server rhel7 Virtual Machine from Blank template
# on brq01 cluster with 2GiB memory and 2 vcpu cores/sockets
# and attach bootable disk with name rhel7_disk and attach virtio NIC
- ovirt.ovirt.ovirt_vm:
    state: present
    cluster: brq01
    name: myvm
    memory: 2GiB
    cpu_cores: 2
    cpu_sockets: 2
    cpu_shares: 1024
    type: server
    operating_system: rhel_7x64
    disks:
      - name: rhel7_disk
        bootable: True
    nics:
      - name: nic1

# Change VM Name
- ovirt.ovirt.ovirt_vm:
    id: 00000000-0000-0000-0000-000000000000
    name: "new_vm_name"

- name: Run VM with cloud init
  ovirt.ovirt.ovirt_vm:
    name: rhel7
    template: rhel7
    cluster: Default
    memory: 1GiB
    high_availability: true
    high_availability_priority: 50  # Available from Ansible 2.5
    cloud_init:
      dns_servers: '8.8.8.8 8.8.4.4'
      nic_boot_protocol: static
      nic_ip_address: 10.34.60.86
      nic_netmask: 255.255.252.0
      nic_gateway: 10.34.63.254
      nic_name: eth1
      host_name: example.com
      custom_script: |
        write_files:
         - content: |
             Hello, world!
           path: /tmp/greeting.txt
           permissions: '0644'
      user_name: root
      root_password: super_password

- name: Run VM with cloud init, with multiple network interfaces
  ovirt.ovirt.ovirt_vm:
    name: rhel7_4
    template: rhel7
    cluster: mycluster
    cloud_init_nics:
    - nic_name: eth0
      nic_boot_protocol: dhcp
    - nic_name: eth1
      nic_boot_protocol: static
      nic_ip_address: 10.34.60.86
      nic_netmask: 255.255.252.0
      nic_gateway: 10.34.63.254
    # IP version 6 parameters are supported since ansible 2.9
    - nic_name: eth2
      nic_boot_protocol_v6: static
      nic_ip_address_v6: '2620:52:0:2282:b898:1f69:6512:36c5'
      nic_gateway_v6: '2620:52:0:2282:b898:1f69:6512:36c9'
      nic_netmask_v6: '120'
    - nic_name: eth3
      nic_boot_protocol_v6: dhcp

- name: Run VM with sysprep
  ovirt.ovirt.ovirt_vm:
    name: windows2012R2_AD
    template: windows2012R2
    cluster: Default
    memory: 3GiB
    high_availability: true
    sysprep:
      host_name: windowsad.example.com
      user_name: Administrator
      root_password: SuperPassword123

- name: Migrate/Run VM to/on host named 'host1'
  ovirt.ovirt.ovirt_vm:
    state: running
    name: myvm
    host: host1

- name: Migrate/Run VM to/on host named 'host1' on cluster 'cluster1'
  ovirt.ovirt.ovirt_vm:
    state: running
    name: myvm
    host: host1
    cluster: cluster1

- name: Migrate VM to any available host
  ovirt.ovirt.ovirt_vm:
    state: running
    name: myvm
    migrate: true

- name: Change VMs CD
  ovirt.ovirt.ovirt_vm:
    name: myvm
    cd_iso: drivers.iso

- name: Eject VMs CD
  ovirt.ovirt.ovirt_vm:
    name: myvm
    cd_iso: ''

- name: Boot VM from CD
  ovirt.ovirt.ovirt_vm:
    name: myvm
    cd_iso: centos7_x64.iso
    boot_devices:
        - cdrom

- name: Stop vm
  ovirt.ovirt.ovirt_vm:
    state: stopped
    name: myvm

- name: Upgrade memory to already created VM
  ovirt.ovirt.ovirt_vm:
    name: myvm
    memory: 4GiB

- name: Hot plug memory to already created and running VM (VM won't be restarted)
  ovirt.ovirt.ovirt_vm:
    name: myvm
    memory: 4GiB

# Create/update a VM to run with two vNUMA nodes and pin them to physical NUMA nodes as follows:
# vnuma index 0-&gt; numa index 0, vnuma index 1-&gt; numa index 1
- name: Create a VM to run with two vNUMA nodes
  ovirt.ovirt.ovirt_vm:
    name: myvm
    cluster: mycluster
    numa_tune_mode: "interleave"
    numa_nodes:
    - index: 0
      cores: [0]
      memory: 20
      numa_node_pins: [0]
    - index: 1
      cores: [1]
      memory: 30
      numa_node_pins: [1]

- name: Update an existing VM to run without previously created vNUMA nodes (i.e. remove all vNUMA nodes+NUMA pinning setting)
  ovirt.ovirt.ovirt_vm:
    name: myvm
    cluster: mycluster
    state: "present"
    numa_tune_mode: "interleave"
    numa_nodes:
    - index: -1

# When change on the VM needs restart of the VM, use next_run state,
# The VM will be updated and rebooted if there are any changes.
# If present state would be used, VM won't be restarted.
- ovirt.ovirt.ovirt_vm:
    state: next_run
    name: myvm
    boot_devices:
      - network

- name: Import virtual machine from VMware
  ovirt.ovirt.ovirt_vm:
    state: stopped
    cluster: mycluster
    name: vmware_win10
    timeout: 1800
    poll_interval: 30
    vmware:
      url: vpx://user@1.2.3.4/Folder1/Cluster1/2.3.4.5?no_verify=1
      name: windows10
      storage_domain: mynfs
      username: user
      password: password

- name: Create vm from template and create all disks on specific storage domain
  ovirt.ovirt.ovirt_vm:
    name: vm_test
    cluster: mycluster
    template: mytemplate
    storage_domain: mynfs
    nics:
    - name: nic1

- name: Remove VM, if VM is running it will be stopped
  ovirt.ovirt.ovirt_vm:
    state: absent
    name: myvm

# Defining a specific quota for a VM:
# Since Ansible 2.5
- ovirt.ovirt.ovirt_quotas_info:
    data_center: Default
    name: myquota
  register: ovirt_quotas
- ovirt.ovirt.ovirt_vm:
    name: myvm
    sso: False
    boot_menu: True
    bios_type: q35_ovmf
    usb_support: True
    serial_console: True
    quota_id: "{{ ovirt_quotas[0]['id'] }}"

- name: Create a VM that has the console configured for both Spice and VNC
  ovirt.ovirt.ovirt_vm:
    name: myvm
    template: mytemplate
    cluster: mycluster
    graphical_console:
      protocol:
        - spice
        - vnc

# Execute remote viewer to VM
- block:
  - name: Create a ticket for console for a running VM
    ovirt.ovirt.ovirt_vm:
      name: myvm
      ticket: true
      state: running
    register: myvm

  - name: Save ticket to file
    ansible.builtin.copy:
      content: "{{ myvm.vm.remote_vv_file }}"
      dest: ~/vvfile.vv

  - name: Run remote viewer with file
    ansible.builtin.command: remote-viewer ~/vvfile.vv

# Default value of host_device state is present
- name: Attach host devices to virtual machine
  ovirt.ovirt.ovirt_vm:
    name: myvm
    host: myhost
    placement_policy: pinned
    host_devices:
      - name: pci_0000_00_06_0
      - name: pci_0000_00_07_0
        state: absent
      - name: pci_0000_00_08_0
        state: present

- name: Add placement policy with multiple hosts
  ovirt.ovirt.ovirt_vm:
    name: myvm
    placement_policy: migratable
    placement_policy_hosts:
      - host1
      - host2

- name: Export the VM as OVA
  ovirt.ovirt.ovirt_vm:
    name: myvm
    state: exported
    cluster: mycluster
    export_ova:
        host: myhost
        filename: myvm.ova
        directory: /tmp/

- name: Clone VM from snapshot
  ovirt.ovirt.ovirt_vm:
    snapshot_vm: myvm
    snapshot_name: myvm_snap
    name: myvm_clone
    state: present

- name: Import external ova VM
  ovirt.ovirt.ovirt_vm:
    cluster: mycluster
    name: myvm
    host: myhost
    timeout: 1800
    poll_interval: 30
    kvm:
      name: myvm
      url: ova:///path/myvm.ova
      storage_domain: mystorage

- name: Cpu pinning of 0#12_1#13_2#14_3#15
  ovirt.ovirt.ovirt_vm:
    state: present
    cluster: mycluster
    name: myvm
    cpu_pinning:
      - cpu: 12
        vcpu: 0
      - cpu: 13
        vcpu: 1
      - cpu: 14
        vcpu: 2
      - cpu: 15
        vcpu: 3
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>id</b>  <div> <span>string</span> </div> </td> <td>On success if VM is found.</td> <td> <div>ID of the VM which is managed</div> <br> <div><b>Sample:</b></div> <div>7de90f31-222c-436c-a1ca-7e655bd5b60c</div> </td> </tr> <tr> <td colspan="1">  <b>vm</b>  <div> <span>dictionary</span> </div> </td> <td>On success if VM is found.</td> <td> <div>Dictionary of all the VM attributes. VM attributes can be found on your oVirt/RHV instance at following url: http://ovirt.github.io/ovirt-engine-api-model/master/#types/vm. Additionally when user sent ticket=true, this module will return also remote_vv_file parameter in vm dictionary, which contains remote-viewer compatible file to open virtual machine console. Please note that this file contains sensible information.</div> <br> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Ondra Machacek (@machacekondra)</li> <li>Martin Necas (@mnecas)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/ovirt/ovirt/ovirt_vm_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/ovirt/ovirt/ovirt_vm_module.html</a>
  </p>
</div>
