<h1 id="community-postgresql-postgresql-sequence-create-drop-or-alter-a-postgresql-sequence">community.postgresql.postgresql_sequence – Create, drop, or alter a PostgreSQL sequence</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/postgresql">community.postgresql collection</a> (version 1.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.postgresql</code>.</p> <p>To use it in a playbook, specify: <code>community.postgresql.postgresql_sequence</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id7">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Allows to create, drop or change the definition of a sequence generator.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>psycopg2</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>ca_cert</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specifies the name of a file containing SSL certificate authority (CA) certificate(s).</div> <div>If the file exists, the server's certificate will be verified to be signed by one of these authorities.</div> <div>
<br>aliases: ssl_rootcert</div> </td> </tr> <tr> <td colspan="1">  <b>cache</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Cache specifies how many sequence numbers are to be preallocated and stored in memory for faster access. The minimum value is 1 (only one value can be generated at a time, i.e., no cache), and this is also the default.</div> </td> </tr> <tr> <td colspan="1">  <b>cascade</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Automatically drop objects that depend on the sequence, and in turn all objects that depend on those objects.</div> <div>Ignored if <em>state=present</em>.</div> <div>Only used with <em>state=absent</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>cycle</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>The cycle option allows the sequence to wrap around when the <em>maxvalue</em> or <em>minvalue</em> has been reached by an ascending or descending sequence respectively. If the limit is reached, the next number generated will be the minvalue or maxvalue, respectively.</div> <div>If <code>false</code> (NO CYCLE) is specified, any calls to nextval after the sequence has reached its maximum value will return an error. False (NO CYCLE) is the default.</div> </td> </tr> <tr> <td colspan="1">  <b>data_type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>bigint</li> <li>integer</li> <li>smallint</li> </ul> </td> <td> <div>Specifies the data type of the sequence. Valid types are bigint, integer, and smallint. bigint is the default. The data type determines the default minimum and maximum values of the sequence. For more info see the documentation <a href="https://www.postgresql.org/docs/current/sql-createsequence.html">https://www.postgresql.org/docs/current/sql-createsequence.html</a>.</div> <div>Supported from PostgreSQL 10.</div> </td> </tr> <tr> <td colspan="1">  <b>db</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of database to connect to and run queries against.</div> <div>
<br>aliases: database, login_db</div> </td> </tr> <tr> <td colspan="1">  <b>increment</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Increment specifies which value is added to the current sequence value to create a new value.</div> <div>A positive value will make an ascending sequence, a negative one a descending sequence. The default value is 1.</div> </td> </tr> <tr> <td colspan="1">  <b>login_host</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Host running the database.</div> <div>If you have connection issues when using <code>localhost</code>, try to use <code>127.0.0.1</code> instead.</div> </td> </tr> <tr> <td colspan="1">  <b>login_password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The password this module should use to establish its PostgreSQL session.</div> </td> </tr> <tr> <td colspan="1">  <b>login_unix_socket</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Path to a Unix domain socket for local connections.</div> </td> </tr> <tr> <td colspan="1">  <b>login_user</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"postgres"</div> </td> <td> <div>The username this module should use to establish its PostgreSQL session.</div> </td> </tr> <tr> <td colspan="1">  <b>maxvalue</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maxvalue determines the maximum value for the sequence. The default for an ascending sequence is the maximum value of the data type. The default for a descending sequence is -1.</div> <div>
<br>aliases: max</div> </td> </tr> <tr> <td colspan="1">  <b>minvalue</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Minvalue determines the minimum value a sequence can generate. The default for an ascending sequence is 1. The default for a descending sequence is the minimum value of the data type.</div> <div>
<br>aliases: min</div> </td> </tr> <tr> <td colspan="1">  <b>newschema</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The new schema for the <em>sequence</em>. Will be used for moving a <em>sequence</em> to another <em>schema</em>.</div> <div>Works only for existing sequences.</div> </td> </tr> <tr> <td colspan="1">  <b>owner</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set the owner for the <em>sequence</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>port</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>5432</div> </td> <td> <div>Database port to connect to.</div> <div>
<br>aliases: login_port</div> </td> </tr> <tr> <td colspan="1">  <b>rename_to</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The new name for the <em>sequence</em>.</div> <div>Works only for existing sequences.</div> </td> </tr> <tr> <td colspan="1">  <b>schema</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"public"</div> </td> <td> <div>The schema of the <em>sequence</em>. This is be used to create and relocate a <em>sequence</em> in the given schema.</div> </td> </tr> <tr> <td colspan="1">  <b>sequence</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of the sequence.</div> <div>
<br>aliases: name</div> </td> </tr> <tr> <td colspan="1">  <b>session_role</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Switch to session_role after connecting. The specified <em>session_role</em> must be a role that the current <em>login_user</em> is a member of.</div> <div>Permissions checking for SQL commands is carried out as though the <em>session_role</em> were the one that had logged in originally.</div> </td> </tr> <tr> <td colspan="1">  <b>ssl_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>disable</li> <li><div>
<b>prefer</b> ←</div></li> <li>require</li> <li>verify-ca</li> <li>verify-full</li> </ul> </td> <td> <div>Determines whether or with what priority a secure SSL TCP/IP connection will be negotiated with the server.</div> <div>See <a href="https://www.postgresql.org/docs/current/static/libpq-ssl.html">https://www.postgresql.org/docs/current/static/libpq-ssl.html</a> for more information on the modes.</div> <div>Default of <code>prefer</code> matches libpq default.</div> </td> </tr> <tr> <td colspan="1">  <b>start</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Start allows the sequence to begin anywhere. The default starting value is <em>minvalue</em> for ascending sequences and <em>maxvalue</em> for descending ones.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li><div>
<b>present</b> ←</div></li> </ul> </td> <td> <div>The sequence state.</div> <div>If <em>state=absent</em> other options will be ignored except of <em>name</em> and <em>schema</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>trust_input</b>  <div> <span>boolean</span> </div> <div> added in 0.2.0 of community.postgresql </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>If <code>no</code>, check whether values of parameters <em>sequence</em>, <em>schema</em>, <em>rename_to</em>, <em>owner</em>, <em>newschema</em>, <em>session_role</em> are potentially dangerous.</div> <div>It makes sense to use <code>no</code> only when SQL injections via the parameters are possible.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Supports <code>check_mode</code>.</li> <li>If you do not pass db parameter, sequence will be created in the database named postgres.</li> <li>The default authentication assumes that you are either logging in as or sudo’ing to the <code>postgres</code> account on the host.</li> <li>To avoid “Peer authentication failed for user postgres” error, use postgres user as a <em>become_user</em>.</li> <li>This module uses psycopg2, a Python PostgreSQL database adapter. You must ensure that psycopg2 is installed on the host before using this module.</li> <li>If the remote host is the PostgreSQL server (which is the default case), then PostgreSQL must also be installed on the remote host.</li> <li>For Ubuntu-based systems, install the postgresql, libpq-dev, and python-psycopg2 packages on the remote host before using this module.</li> <li>The ca_cert parameter requires at least Postgres version 8.4 and <em>psycopg2</em> version 2.4.3.</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="postgresql_table_module.html#ansible-collections-community-postgresql-postgresql-table-module"><span class="std std-ref">community.postgresql.postgresql_table</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.postgresql.postgresql_table</strong> module.</p> </dd> <dt><a class="reference internal" href="postgresql_owner_module.html#ansible-collections-community-postgresql-postgresql-owner-module"><span class="std std-ref">community.postgresql.postgresql_owner</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.postgresql.postgresql_owner</strong> module.</p> </dd> <dt><a class="reference internal" href="postgresql_privs_module.html#ansible-collections-community-postgresql-postgresql-privs-module"><span class="std std-ref">community.postgresql.postgresql_privs</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.postgresql.postgresql_privs</strong> module.</p> </dd> <dt><a class="reference internal" href="postgresql_tablespace_module.html#ansible-collections-community-postgresql-postgresql-tablespace-module"><span class="std std-ref">community.postgresql.postgresql_tablespace</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.postgresql.postgresql_tablespace</strong> module.</p> </dd> <dt><a class="reference external" href="https://www.postgresql.org/docs/current/sql-createsequence.html">CREATE SEQUENCE reference</a></dt>
<dd>
<p>Complete reference of the CREATE SEQUENCE command documentation.</p> </dd> <dt><a class="reference external" href="https://www.postgresql.org/docs/current/sql-altersequence.html">ALTER SEQUENCE reference</a></dt>
<dd>
<p>Complete reference of the ALTER SEQUENCE command documentation.</p> </dd> <dt><a class="reference external" href="https://www.postgresql.org/docs/current/sql-dropsequence.html">DROP SEQUENCE reference</a></dt>
<dd>
<p>Complete reference of the DROP SEQUENCE command documentation.</p> </dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Create an ascending bigint sequence called foobar in the default
        database
  community.postgresql.postgresql_sequence:
    name: foobar

- name: Create an ascending integer sequence called foobar, starting at 101
  community.postgresql.postgresql_sequence:
    name: foobar
    data_type: integer
    start: 101

- name: Create an descending sequence called foobar, starting at 101 and
        preallocated 10 sequence numbers in cache
  community.postgresql.postgresql_sequence:
    name: foobar
    increment: -1
    cache: 10
    start: 101

- name: Create an ascending sequence called foobar, which cycle between 1 to 10
  community.postgresql.postgresql_sequence:
    name: foobar
    cycle: yes
    min: 1
    max: 10

- name: Create an ascending bigint sequence called foobar in the default
        database with owner foobar
  community.postgresql.postgresql_sequence:
    name: foobar
    owner: foobar

- name: Rename an existing sequence named foo to bar
  community.postgresql.postgresql_sequence:
    name: foo
    rename_to: bar

- name: Change the schema of an existing sequence to foobar
  community.postgresql.postgresql_sequence:
    name: foobar
    newschema: foobar

- name: Change the owner of an existing sequence to foobar
  community.postgresql.postgresql_sequence:
    name: foobar
    owner: foobar

- name: Drop a sequence called foobar
  community.postgresql.postgresql_sequence:
    name: foobar
    state: absent

- name: Drop a sequence called foobar with cascade
  community.postgresql.postgresql_sequence:
    name: foobar
    cascade: yes
    state: absent
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>cycle</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Shows if the sequence cycle or not.</div> <br> <div><b>Sample:</b></div> <div>NO</div> </td> </tr> <tr> <td colspan="1">  <b>data_type</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Shows the current data type of the sequence.</div> <br> <div><b>Sample:</b></div> <div>bigint</div> </td> </tr> <tr> <td colspan="1">  <b>increment</b>  <div> <span>integer</span> </div> </td> <td>always</td> <td> <div>The value of increment of the sequence. A positive value will make an ascending sequence, a negative one a descending sequence.</div> <br> <div><b>Sample:</b></div> <div>-1</div> </td> </tr> <tr> <td colspan="1">  <b>maxvalue</b>  <div> <span>integer</span> </div> </td> <td>always</td> <td> <div>The value of maxvalue of the sequence.</div> <br> <div><b>Sample:</b></div> <div>9223372036854775807</div> </td> </tr> <tr> <td colspan="1">  <b>minvalue</b>  <div> <span>integer</span> </div> </td> <td>always</td> <td> <div>The value of minvalue of the sequence.</div> <br> <div><b>Sample:</b></div> <div>1</div> </td> </tr> <tr> <td colspan="1">  <b>newname</b>  <div> <span>string</span> </div> </td> <td>on success</td> <td> <div>Shows the new sequence name after rename.</div> <br> <div><b>Sample:</b></div> <div>barfoo</div> </td> </tr> <tr> <td colspan="1">  <b>newschema</b>  <div> <span>string</span> </div> </td> <td>on success</td> <td> <div>Shows the new schema of the sequence after schema change.</div> <br> <div><b>Sample:</b></div> <div>foobar</div> </td> </tr> <tr> <td colspan="1">  <b>owner</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Shows the current owner of the sequence after the successful run of the task.</div> <br> <div><b>Sample:</b></div> <div>postgres</div> </td> </tr> <tr> <td colspan="1">  <b>queries</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>List of queries that was tried to be executed.</div> <br> <div><b>Sample:</b></div> <div>['CREATE SEQUENCE "foo"']</div> </td> </tr> <tr> <td colspan="1">  <b>schema</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Name of the schema of the sequence.</div> <br> <div><b>Sample:</b></div> <div>foo</div> </td> </tr> <tr> <td colspan="1">  <b>sequence</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Sequence name.</div> <br> <div><b>Sample:</b></div> <div>foobar</div> </td> </tr> <tr> <td colspan="1">  <b>start</b>  <div> <span>integer</span> </div> </td> <td>always</td> <td> <div>The value of start of the sequence.</div> <br> <div><b>Sample:</b></div> <div>12</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Sequence state at the end of execution.</div> <br> <div><b>Sample:</b></div> <div>present</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Tobias Birkefeld (@tcraxs)</li> <li>Thomas O’Donnell (@andytom)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/postgresql/postgresql_sequence_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/postgresql/postgresql_sequence_module.html</a>
  </p>
</div>
