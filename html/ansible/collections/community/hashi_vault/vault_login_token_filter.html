<section id="community-hashi-vault-vault-login-token-filter-extracts-the-vault-token-from-a-login-or-token-creation"> <h1>community.hashi_vault.vault_login_token filter â€“ Extracts the Vault token from a login or token creation</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This filter plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/hashi_vault/">community.hashi_vault collection</a> (version 6.2.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.hashi_vault</code>.</p> <p>To use it in a playbook, specify: <code>community.hashi_vault.vault_login_token</code>.</p> </div> <p class="ansible-version-added">New in community.hashi_vault 2.2.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#input" id="id2">Input</a></li> <li><a class="reference internal" href="#keyword-parameters" id="id3">Keyword parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> <li><a class="reference internal" href="#return-value" id="id7">Return Value</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Extracts the token value from the structure returned by a Vault token creation operation.</li> </ul> </section> <section id="input"> <h2>Input</h2> <p>This describes the input of the filter, the value before <code>| community.hashi_vault.vault_login_token</code>.</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-hashi-vault-vault-login-token-filter-parameter-input"><strong>Input</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A dictionary matching the structure returned by a login or token creation.</p> </div></td> </tr>  </table> </section> <section id="keyword-parameters"> <h2>Keyword parameters</h2> <p>This describes keyword parameters of the filter. These are the values <code>key1=value1</code>, <code>key2=value2</code> and so on in the following example: <code>input | community.hashi_vault.vault_login_token(key1=value1, key2=value2, ...)</code></p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-hashi-vault-vault-login-token-filter-parameter-optional-field"><strong>optional_field</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If this field exists in the input dictionary, then the value of that field is used as the <em>_input</em> value.</p> <p>The default value deals with the difference between the output of lookup plugins, and does not need to be changed in most cases.</p> <p>See the examples or the Filter guide for more information.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"login"</code></p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>This filter is the same as reading into the <em>_input</em> dictionary directly, but it provides semantic meaning and automatically works with the differing output of the modules and lookups. See the Filter guide for more information.</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="vault_login_module.html#ansible-collections-community-hashi-vault-vault-login-module"><span class="std std-ref">community.hashi_vault.vault_login</span></a></dt>
<dd>
<p>Perform a login operation against HashiCorp Vault.</p> </dd> <dt><a class="reference internal" href="vault_token_create_module.html#ansible-collections-community-hashi-vault-vault-token-create-module"><span class="std std-ref">community.hashi_vault.vault_token_create</span></a></dt>
<dd>
<p>Create a HashiCorp Vault token.</p> </dd> <dt>
<a class="reference internal" href="vault_login_lookup.html#ansible-collections-community-hashi-vault-vault-login-lookup"><span class="std std-ref">community.hashi_vault.vault_login</span></a> lookup plugin</dt>
<dd>
<p>Perform a login operation against HashiCorp Vault.</p> </dd> <dt>
<a class="reference internal" href="vault_token_create_lookup.html#ansible-collections-community-hashi-vault-vault-token-create-lookup"><span class="std std-ref">community.hashi_vault.vault_token_create</span></a> lookup plugin</dt>
<dd>
<p>Create a HashiCorp Vault token.</p> </dd> <dt><a class="reference internal" href="docsite/filter_guide.html#ansible-collections-community-hashi-vault-docsite-filter-guide-vault-login-token"><span class="std std-ref">Filter Guide</span></a></dt>
<dd>
<p>The <code>community.hashi_vault</code> Filter Guide</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Set defaults
  vars:
    ansible_hashi_vault_url: https://vault:9801/
    ansible_hashi_vault_auth_method: userpass
    ansible_hashi_vault_username: user
    ansible_hashi_vault_password: "{{ lookup('env', 'MY_SECRET_PASSWORD') }}"
  module_defaults:
    community.hashi_vault.vault_login:
      url: '{{ ansible_hashi_vault_url }}'
      auth_method: '{{ ansible_hashi_vault_auth_method }}'
      username: '{{ ansible_hashi_vault_username }}'
      password: '{{ ansible_hashi_vault_password }}'
  block:
    - name: Perform a login with a lookup and display the token
      vars:
        login_response: "{{ lookup('community.hashi_vault.vault_login') }}"
      debug:
        msg: "The token is {{ login_response | community.hashi_vault.vault_login_token }}"

    - name: Perform a login with a module
      community.hashi_vault.vault_login:
      register: login_response

    - name: Display the token
      debug:
        msg: "The token is {{ login_response | community.hashi_vault.vault_login_token }}"

- name: Use of optional_field
  vars:
    lookup_login_response: "{{ lookup('community.hashi_vault.vault_login') }}"
    my_data:
      something: somedata
      vault_login: "{{ lookup_login_response }}"

    token_from_param: "{{ my_data | community.hashi_vault.vault_login_token(optional_field='vault_login') }}"
    token_from_deref: "{{ my_data['vault_login'] | community.hashi_vault.vault_login_token }}"
    # if the optional field doesn't exist, the dictionary itself is still checked
    unused_optional: "{{ my_data['vault_login'] | community.hashi_vault.vault_login_token(optional_field='missing') }}"
  block:
    - name: Display the variables
      ansible.builtin.debug:
        var: '{{ item }}'
      loop:
        - my_data
        - token_from_param
        - token_from_deref
        - unused_optional
</pre> </section> <section id="return-value"> <h2>Return Value</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-hashi-vault-vault-login-token-filter-return-value"><strong>Return value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The token value.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> always</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"s.nnrpog4i5gjizr6b8g1inwj3"</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Brian Scholer (@briantist)</li> </ul> <div class="admonition hint"> <p class="admonition-title">Hint</p> <p>Configuration entries for each entry type have a low to high priority order. For example, a variable that is lower in the list will override a variable that is higher up.</p> </div> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.hashi_vault/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.hashi_vault" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.hashi_vault/discussions" rel="noopener external" target="_blank">Discussion, Q&amp;A, troubleshooting</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-community-hashi-vault"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/hashi_vault/vault_login_token_filter.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/hashi_vault/vault_login_token_filter.html</a>
  </p>
</div>
