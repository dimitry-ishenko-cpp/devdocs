<section id="community-zabbix-zabbix-service-module-create-update-delete-zabbix-service"> <h1>community.zabbix.zabbix_service module – Create/update/delete Zabbix service</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/zabbix/">community.zabbix collection</a> (version 2.5.1).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.zabbix</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-community-zabbix-zabbix-service-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.zabbix.zabbix_service</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Create/update/delete Zabbix service.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-zabbix-zabbix-service-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python &gt;= 3.9</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-algorithm"><strong>algorithm</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Status calculation rule. Only applicable if child services exists.</p> <ul class="simple"> <li>
<code>status_to_ok</code>, set status to OK with</li> <li>
<code>most_crit_if_all_children</code>, most critical if all children have problems</li> <li>
<code>most_crit_of_child_serv</code>, most critical of child services with</li> </ul> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"status_to_ok"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"most_crit_if_all_children"</code></li> <li><code>"most_crit_of_child_serv"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-children"><strong>children</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Child services to be linked to the service.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Description of the service.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-http-login-password"><strong>http_login_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Basic Auth password</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-http-login-user"><strong>http_login_user</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Basic Auth login</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of Zabbix service</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-parents"><strong>parents</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Parent services to be linked to the service.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-problem-tags"><strong>problem_tags</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Problem tags to be created for the service.</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-problem-tags-operator"><strong>operator</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Mapping condition operator.</p> <p><code>equals</code></p> <p><code>like</code></p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"equals"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"like"</code></li> </ul> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-problem-tags-tag"><strong>tag</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Problem tag name.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-problem-tags-value"><strong>value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Problem tag value.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>""</code></p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-propagation-rule"><strong>propagation_rule</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Status propagation value. Must be set together with propagation_rule.</p> <p><code>as_is</code> propagate service status as is - without any changes</p> <p><code>increase</code> increase the propagated status by a given propagation_value (by 1 to 5 severities)</p> <p><code>decrease</code> decrease the propagated status by a given propagation_value (by 1 to 5 severities)</p> <p><code>ignore</code> ignore this service - the status is not propagated to the parent service at all</p> <p><code>fixed</code> set fixed service status using a given propagation_value</p> <p>Required with <code>propagation_value</code></p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"as_is"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-propagation-value"><strong>propagation_value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Status propagation value. Must be set together with propagation_rule.</p> <p>Possible values when <em>propagation_rule=as_is or ignore</em>:</p> <ul class="simple"> <li><code>not_classified</code></li> </ul> <p>Possible values when <em>propagation_rule=increase or decrease</em>:</p> <ul class="simple"> <li><code>information</code></li> <li><code>warning</code></li> <li><code>average</code></li> <li><code>high</code></li> <li><code>disaster</code></li> </ul> <p>Possible values when <em>propagation_rule=fixed</em>:</p> <ul class="simple"> <li><code>ok</code></li> <li><code>not_classified</code></li> <li><code>information</code></li> <li><code>warning</code></li> <li><code>average</code></li> <li><code>high</code></li> <li><code>disaster</code></li> </ul> <p>Required with <code>propagation_rule</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-sortorder"><strong>sortorder</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Position of the service used for sorting.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>State: present - create/update service; absent - delete service.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"absent"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-status-rules"><strong>status_rules</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Status rules for the service.</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-status-rules-limit-status"><strong>limit_status</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Limit status.</p> <p><code>ok</code> OK</p> <p><code>not_classified</code> Not classified</p> <p><code>information</code> Information</p> <p><code>warning</code> Warning</p> <p><code>average</code> Average</p> <p><code>high</code> High</p> <p><code>disaster</code> Disaster</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-status-rules-limit-value"><strong>limit_value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Limit value: N, N% or W</p> <p>Possible values: 1-100000 for N and W, 1-100 for N%</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-status-rules-new-status"><strong>new_status</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>New status value.</p> <p><code>not_classified</code> Not classified</p> <p><code>information</code> Information</p> <p><code>warning</code> Warning</p> <p><code>average</code> Average</p> <p><code>high</code> High</p> <p><code>disaster</code> Disaster</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-status-rules-type"><strong>type</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Condition for setting (New status) status.</p> <p><code>at_least_n_child_services_have_status_or_above</code> if at least (N) child services have (Status) status or above</p> <p><code>at_least_npct_child_services_have_status_or_above</code> if at least (N%) of child services have (Status) status or above</p> <p><code>less_than_n_child_services_have_status_or_below</code> if less than (N) child services have (Status) status or below</p> <p><code>less_than_npct_child_services_have_status_or_below</code> if less than (N%) of child services have (Status) status or below</p> <p><code>weight_child_services_with_status_or_above_at_least_w</code> if weight of child services with (Status) status or above is at least (W)</p> <p><code>weight_child_services_with_status_or_above_at_least_npct</code> if weight of child services with (Status) status or above is at least (N%)</p> <p><code>weight_child_services_with_status_or_below_less_w</code> if weight of child services with (Status) status or below is less than (W)</p> <p><code>weight_child_services_with_status_or_below_less_npct</code> if weight of child services with (Status) status or below is less than (N%)</p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-tags"><strong>tags</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Service tags to be created for the service.</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-tags-tag"><strong>tag</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Service tag name.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-tags-value"><strong>value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Service tag value.</p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-zabbix-zabbix-service-module-parameter-weight"><strong>weight</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Service weight.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"0"</code></p> </div></td> </tr>  </table> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">---
# If you want to use Username and Password to be authenticated by Zabbix Server
- name: Set credentials to access Zabbix Server API
  ansible.builtin.set_fact:
    ansible_user: Admin
    ansible_httpapi_pass: zabbix

# If you want to use API token to be authenticated by Zabbix Server
# https://www.zabbix.com/documentation/current/en/manual/web_interface/frontend_sections/administration/general#api-tokens
- name: Set API token
  ansible.builtin.set_fact:
    ansible_zabbix_auth_key: 8ec0d52432c15c91fcafe9888500cf9a607f44091ab554dbee860f6b44fac895

# Creates a new Zabbix service
- name: Create Zabbix service monitoring Apache2 in DCs in Toronto area
  # set task level variables
  vars:
    ansible_network_os: community.zabbix.zabbix
    ansible_connection: httpapi
    ansible_httpapi_port: 443
    ansible_httpapi_use_ssl: true
    ansible_httpapi_validate_certs: false
    ansible_zabbix_url_path: "zabbixeu"  # If Zabbix WebUI runs on non-default (zabbix) path ,e.g. http://&lt;FQDN&gt;/zabbixeu
    ansible_host: zabbix-example-fqdn.org
  community.zabbix.zabbix_service:
    name: "apache2 service Toronto"
    description: Apache2 services in Toronto area
    sortorder: 0
    propagation_rule: increase
    propagation_value: warning
    weight: 1
    state: present
    tags:
      - tag: zabbix_service
        value: apache2
      - tag: area
        value: Toronto
    problem_tags:
      - tag: service_name
        value: httpd
      - tag: area
        operator: like
        value: toronto
    status_rules:
      - type: at_least_n_child_services_have_status_or_above
        limit_value: 4242
        limit_status: ok
        new_status: average

- name: Create Zabbix service monitoring all Apache2 services
  # set task level variables as we change ansible_connection plugin here
  vars:
    ansible_network_os: community.zabbix.zabbix
    ansible_connection: httpapi
    ansible_httpapi_port: 443
    ansible_httpapi_use_ssl: true
    ansible_httpapi_validate_certs: false
    ansible_zabbix_url_path: "zabbixeu"  # If Zabbix WebUI runs on non-default (zabbix) path ,e.g. http://&lt;FQDN&gt;/zabbixeu
    ansible_host: zabbix-example-fqdn.org
  community.zabbix.zabbix_service:
    name: apache2 service
    description: Apache2 services
    tags:
      - tag: zabbix_service
        value: apache2
      - tag: area
        value: global
    children:
      - "apache2 service Toronto"
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Emmanuel Riviere (@emriver)</li> <li>Evgeny Yurchenko (@BGmot)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.zabbix/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.zabbix" rel="noopener external" target="_blank">Homepage</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.zabbix.git" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/zabbix/zabbix_service_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/zabbix/zabbix_service_module.html</a>
  </p>
</div>
