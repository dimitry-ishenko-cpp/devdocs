<h1 id="community-docker-docker-container-manage-docker-containers">community.docker.docker_container – manage docker containers</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/docker">community.docker collection</a> (version 1.10.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.docker</code>.</p> <p>To use it in a playbook, specify: <code>community.docker.docker_container</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id3">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id4">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id5">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id6">Notes</a></li> <li><a class="reference internal" href="#examples" id="id7">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id8">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Manage the life cycle of docker containers.</li> <li>Supports check mode. Run with <code>--check</code> and <code>--diff</code> to view config difference and list of actions to be taken.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>Docker API &gt;= 1.20</li> <li>Docker SDK for Python: Please note that the <a class="reference external" href="https://pypi.org/project/docker-py/">docker-py</a> Python module has been superseded by <a class="reference external" href="https://pypi.org/project/docker/">docker</a> (see <a class="reference external" href="https://github.com/docker/docker-py/issues/1310">here</a> for details). For Python 2.6, <code>docker-py</code> must be used. Otherwise, it is recommended to install the <code>docker</code> Python module. Note that both modules should <em>not</em> be installed at the same time. Also note that when both modules are installed and one of them is uninstalled, the other might no longer function and a reinstall of it is required.</li> <li>
<a class="reference external" href="https://docker-py.readthedocs.io/en/stable/">Docker SDK for Python</a> &gt;= 1.8.0 (use <a class="reference external" href="https://pypi.org/project/docker-py/">docker-py</a> for Python 2.6)</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="2">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="2">  <b>api_version</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"auto"</div> </td> <td> <div>The version of the Docker API running on the Docker Host.</div> <div>Defaults to the latest version of the API supported by Docker SDK for Python and the docker daemon.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_API_VERSION</code> will be used instead. If the environment variable is not set, the default value will be used.</div> <div>
<br>aliases: docker_api_version</div> </td> </tr> <tr> <td colspan="2">  <b>auto_remove</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Enable auto-removal of the container on daemon side when the container's process exits.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>blkio_weight</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Block IO (relative weight), between 10 and 1000.</div> </td> </tr> <tr> <td colspan="2">  <b>ca_cert</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>Use a CA certificate when performing server verification by providing the path to a CA certificate file.</div> <div>If the value is not specified in the task and the environment variable <code>DOCKER_CERT_PATH</code> is set, the file <code>ca.pem</code> from the directory specified in the environment variable <code>DOCKER_CERT_PATH</code> will be used.</div> <div>
<br>aliases: tls_ca_cert, cacert_path</div> </td> </tr> <tr> <td colspan="2">  <b>cap_drop</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of capabilities to drop from the container.</div> </td> </tr> <tr> <td colspan="2">  <b>capabilities</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of capabilities to add to the container.</div> </td> </tr> <tr> <td colspan="2">  <b>cgroup_parent</b>  <div> <span>string</span> </div> <div> added in 1.1.0 of community.docker </div> </td> <td> </td> <td> <div>Specify the parent cgroup for the container.</div> </td> </tr> <tr> <td colspan="2">  <b>cleanup</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use with <em>detach=false</em> to remove the container after successful execution.</div> </td> </tr> <tr> <td colspan="2">  <b>client_cert</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>Path to the client's TLS certificate file.</div> <div>If the value is not specified in the task and the environment variable <code>DOCKER_CERT_PATH</code> is set, the file <code>cert.pem</code> from the directory specified in the environment variable <code>DOCKER_CERT_PATH</code> will be used.</div> <div>
<br>aliases: tls_client_cert, cert_path</div> </td> </tr> <tr> <td colspan="2">  <b>client_key</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>Path to the client's TLS key file.</div> <div>If the value is not specified in the task and the environment variable <code>DOCKER_CERT_PATH</code> is set, the file <code>key.pem</code> from the directory specified in the environment variable <code>DOCKER_CERT_PATH</code> will be used.</div> <div>
<br>aliases: tls_client_key, key_path</div> </td> </tr> <tr> <td colspan="2">  <b>command</b>  <div> <span>raw</span> </div> </td> <td> </td> <td> <div>Command to execute when the container starts. A command may be either a string or a list.</div> <div>Prior to version 2.4, strings were split on commas.</div> <div>See <em>command_handling</em> for differences in how strings and lists are handled.</div> </td> </tr> <tr> <td colspan="2">  <b>command_handling</b>  <div> <span>string</span> </div> <div> added in 1.9.0 of community.docker </div> </td> <td> <ul>
<b>Choices:</b> <li>compatibility</li> <li>correct</li> </ul> </td> <td> <div>The default behavior for <em>command</em> (when provided as a list) and <em>entrypoint</em> is to convert them to strings without considering shell quoting rules. (For comparing idempotency, the resulting string is split considering shell quoting rules.)</div> <div>Also, setting <em>command</em> to an empty list of string, and setting <em>entrypoint</em> to an empty list will be handled as if these options are not specified. This is different from idempotency handling for other container-config related options.</div> <div>When this is set to <code>compatiblity</code>, which is the default until community.docker 3.0.0, the current behavior will be kept.</div> <div>When this is set to <code>correct</code>, these options are kept as lists, and an empty value or empty list will be handled correctly for idempotency checks.</div> <div>In community.docker 3.0.0, the default will change to <code>correct</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>comparisons</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Allows to specify how properties of existing containers are compared with module options to decide whether the container should be recreated / updated or not.</div> <div>Only options which correspond to the state of a container as handled by the Docker daemon can be specified, as well as <code>networks</code>.</div> <div>Must be a dictionary specifying for an option one of the keys <code>strict</code>, <code>ignore</code> and <code>allow_more_present</code>.</div> <div>If <code>strict</code> is specified, values are tested for equality, and changes always result in updating or restarting. If <code>ignore</code> is specified, changes are ignored.</div> <div>
<code>allow_more_present</code> is allowed only for lists, sets and dicts. If it is specified for lists or sets, the container will only be updated or restarted if the module option contains a value which is not present in the container's options. If the option is specified for a dict, the container will only be updated or restarted if the module option contains a key which isn't present in the container's option, or if the value of a key present differs.</div> <div>The wildcard option <code>*</code> can be used to set one of the default values <code>strict</code> or <code>ignore</code> to *all* comparisons which are not explicitly set to other values.</div> <div>See the examples for details.</div> </td> </tr> <tr> <td colspan="2">  <b>container_default_behavior</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>compatibility</li> <li>no_defaults</li> </ul> </td> <td> <div>Various module options used to have default values. This causes problems with containers which use different values for these options.</div> <div>The default value is <code>compatibility</code>, which will ensure that the default values are used when the values are not explicitly specified by the user.</div> <div>From community.docker 2.0.0 on, the default value will switch to <code>no_defaults</code>. To avoid deprecation warnings, please set <em>container_default_behavior</em> to an explicit value.</div> <div>This affects the <em>auto_remove</em>, <em>detach</em>, <em>init</em>, <em>interactive</em>, <em>memory</em>, <em>paused</em>, <em>privileged</em>, <em>read_only</em> and <em>tty</em> options.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_period</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Limit CPU CFS (Completely Fair Scheduler) period.</div> <div>See <em>cpus</em> for an easier to use alternative.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_quota</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Limit CPU CFS (Completely Fair Scheduler) quota.</div> <div>See <em>cpus</em> for an easier to use alternative.</div> </td> </tr> <tr> <td colspan="2">  <b>cpu_shares</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>CPU shares (relative weight).</div> </td> </tr> <tr> <td colspan="2">  <b>cpus</b>  <div> <span>float</span> </div> </td> <td> </td> <td> <div>Specify how much of the available CPU resources a container can use.</div> <div>A value of <code>1.5</code> means that at most one and a half CPU (core) will be used.</div> </td> </tr> <tr> <td colspan="2">  <b>cpuset_cpus</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CPUs in which to allow execution <code>1,3</code> or <code>1-3</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>cpuset_mems</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Memory nodes (MEMs) in which to allow execution <code>0-3</code> or <code>0,1</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>debug</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Debug mode</div> </td> </tr> <tr> <td colspan="2">  <b>default_host_ip</b>  <div> <span>string</span> </div> <div> added in 1.2.0 of community.docker </div> </td> <td> </td> <td> <div>Define the default host IP to use.</div> <div>Must be an empty string, an IPv4 address, or an IPv6 address.</div> <div>With Docker 20.10.2 or newer, this should be set to an empty string (<code>""</code>) to avoid the port bindings without an explicit IP address to only bind to IPv4. See <a href="https://github.com/ansible-collections/community.docker/issues/70">https://github.com/ansible-collections/community.docker/issues/70</a> for details.</div> <div>By default, the module will try to auto-detect this value from the <code>bridge</code> network's <code>com.docker.network.bridge.host_binding_ipv4</code> option. If it cannot auto-detect it, it will fall back to <code>0.0.0.0</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>detach</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Enable detached mode to leave the container running in background.</div> <div>If disabled, the task will reflect the status of the container run (failed if the command failed).</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>yes</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>device_read_bps</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of device path and read rate (bytes per second) from device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>path</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device path in the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>rate</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device read limit in format <code>&lt;number&gt;[&lt;unit&gt;]</code>.</div> <div>Number is a positive integer. Unit can be one of <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes.</div> </td> </tr> <tr> <td colspan="2">  <b>device_read_iops</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of device and read rate (IO per second) from device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>path</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device path in the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>rate</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device read limit.</div> <div>Must be a positive integer.</div> </td> </tr> <tr> <td colspan="2">  <b>device_requests</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> <div> added in 0.1.0 of community.docker </div> </td> <td> </td> <td> <div>Allows to request additional resources, such as GPUs.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>capabilities</b>  <div> <span>list</span> / <span>elements=list</span> </div> </td> <td> </td> <td> <div>List of lists of strings to request capabilities.</div> <div>The top-level list entries are combined by OR, and for every list entry, the entries in the list it contains are combined by AND.</div> <div>The driver tries to satisfy one of the sub-lists.</div> <div>Available capabilities for the <code>nvidia</code> driver can be found at <a href="https://github.com/NVIDIA/nvidia-container-runtime">https://github.com/NVIDIA/nvidia-container-runtime</a>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>count</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number or devices to request.</div> <div>Set to <code>-1</code> to request all available devices.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>device_ids</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of device IDs.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>driver</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Which driver to use for this device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>options</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Driver-specific options.</div> </td> </tr> <tr> <td colspan="2">  <b>device_write_bps</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of device and write rate (bytes per second) to device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>path</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device path in the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>rate</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device read limit in format <code>&lt;number&gt;[&lt;unit&gt;]</code>.</div> <div>Number is a positive integer. Unit can be one of <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes.</div> </td> </tr> <tr> <td colspan="2">  <b>device_write_iops</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of device and write rate (IO per second) to device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>path</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device path in the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>rate</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device read limit.</div> <div>Must be a positive integer.</div> </td> </tr> <tr> <td colspan="2">  <b>devices</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of host device bindings to add to the container.</div> <div>Each binding is a mapping expressed in the format <code>&lt;path_on_host&gt;:&lt;path_in_container&gt;:&lt;cgroup_permissions&gt;</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>dns_opts</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of DNS options.</div> </td> </tr> <tr> <td colspan="2">  <b>dns_search_domains</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of custom DNS search domains.</div> </td> </tr> <tr> <td colspan="2">  <b>dns_servers</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of custom DNS servers.</div> </td> </tr> <tr> <td colspan="2">  <b>docker_host</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"unix://var/run/docker.sock"</div> </td> <td> <div>The URL or Unix socket path used to connect to the Docker API. To connect to a remote host, provide the TCP connection string. For example, <code>tcp://192.0.2.23:2376</code>. If TLS is used to encrypt the connection, the module will automatically replace <code>tcp</code> in the connection URL with <code>https</code>.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_HOST</code> will be used instead. If the environment variable is not set, the default value will be used.</div> <div>
<br>aliases: docker_url</div> </td> </tr> <tr> <td colspan="2">  <b>domainname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Container domainname.</div> </td> </tr> <tr> <td colspan="2">  <b>entrypoint</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Command that overwrites the default <code>ENTRYPOINT</code> of the image.</div> <div>See <em>command_handling</em> for differences in how strings and lists are handled.</div> </td> </tr> <tr> <td colspan="2">  <b>env</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of key,value pairs.</div> <div>Values which might be parsed as numbers, booleans or other types by the YAML parser must be quoted (e.g. <code>"true"</code>) in order to avoid data loss.</div> <div>Please note that if you are passing values in with Jinja2 templates, like <code>"{{ value }}"</code>, you need to add <code>| string</code> to prevent Ansible to convert strings such as <code>"true"</code> back to booleans. The correct way is to use <code>"{{ value | string }}"</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>env_file</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>Path to a file, present on the target, containing environment variables <em>FOO=BAR</em>.</div> <div>If variable also present in <em>env</em>, then the <em>env</em> value will override.</div> </td> </tr> <tr> <td colspan="2">  <b>etc_hosts</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dict of host-to-IP mappings, where each host name is a key in the dictionary. Each host name will be added to the container's <code>/etc/hosts</code> file.</div> </td> </tr> <tr> <td colspan="2">  <b>exposed_ports</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of additional container ports which informs Docker that the container listens on the specified network ports at runtime.</div> <div>If the port is already exposed using <code>EXPOSE</code> in a Dockerfile, it does not need to be exposed again.</div> <div>
<br>aliases: exposed, expose</div> </td> </tr> <tr> <td colspan="2">  <b>force_kill</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use the kill command when stopping a running container.</div> <div>
<br>aliases: forcekill</div> </td> </tr> <tr> <td colspan="2">  <b>groups</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of additional group names and/or IDs that the container process will run as.</div> </td> </tr> <tr> <td colspan="2">  <b>healthcheck</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Configure a check that is run to determine whether or not containers for this service are "healthy".</div> <div>See the docs for the <a href="https://docs.docker.com/engine/reference/builder/#healthcheck">HEALTHCHECK Dockerfile instruction</a> for details on how healthchecks work.</div> <div>
<em>interval</em>, <em>timeout</em> and <em>start_period</em> are specified as durations. They accept duration as a string in a format that look like: <code>5h34m56s</code>, <code>1m30s</code> etc. The supported units are <code>us</code>, <code>ms</code>, <code>s</code>, <code>m</code> and <code>h</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interval</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Time between running the check.</div> <div>The default used by the Docker daemon is <code>30s</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>retries</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Consecutive number of failures needed to report unhealthy.</div> <div>The default used by the Docker daemon is <code>3</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>start_period</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Start period for the container to initialize before starting health-retries countdown.</div> <div>The default used by the Docker daemon is <code>0s</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>test</b>  <div> <span>raw</span> </div> </td> <td> </td> <td> <div>Command to run to check health.</div> <div>Must be either a string or a list. If it is a list, the first item must be one of <code>NONE</code>, <code>CMD</code> or <code>CMD-SHELL</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>timeout</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Maximum time to allow one check to run.</div> <div>The default used by the Docker daemon is <code>30s</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>hostname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The container's hostname.</div> </td> </tr> <tr> <td colspan="2">  <b>ignore_image</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>When <em>state</em> is <code>present</code> or <code>started</code>, the module compares the configuration of an existing container to requested configuration. The evaluation includes the image version. If the image version in the registry does not match the container, the container will be recreated. You can stop this behavior by setting <em>ignore_image</em> to <code>True</code>.</div> <div>*Warning:* This option is ignored if <code>image: ignore</code> or <code>*: ignore</code> is specified in the <em>comparisons</em> option.</div> </td> </tr> <tr> <td colspan="2">  <b>image</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Repository path and tag used to create the container. If an image is not found or pull is true, the image will be pulled from the registry. If no tag is included, <code>latest</code> will be used.</div> <div>Can also be an image ID. If this is the case, the image is assumed to be available locally. The <em>pull</em> option is ignored for this case.</div> </td> </tr> <tr> <td colspan="2">  <b>init</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Run an init inside the container that forwards signals and reaps processes.</div> <div>This option requires Docker API &gt;= 1.25.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>interactive</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Keep stdin open after a container is launched, even if not attached.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>ipc_mode</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set the IPC mode for the container.</div> <div>Can be one of <code>container:&lt;name|id&gt;</code> to reuse another container's IPC namespace or <code>host</code> to use the host's IPC namespace within the container.</div> </td> </tr> <tr> <td colspan="2">  <b>keep_volumes</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Retain anonymous volumes associated with a removed container.</div> </td> </tr> <tr> <td colspan="2">  <b>kernel_memory</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Kernel memory limit in format <code>&lt;number&gt;[&lt;unit&gt;]</code>. Number is a positive integer. Unit can be <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte). Minimum is <code>4M</code>.</div> <div>Omitting the unit defaults to bytes.</div> </td> </tr> <tr> <td colspan="2">  <b>kill_signal</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Override default signal used to kill a running container.</div> </td> </tr> <tr> <td colspan="2">  <b>labels</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of key value pairs.</div> </td> </tr> <tr> <td colspan="2">  <b>links</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of name aliases for linked containers in the format <code>container_name:alias</code>.</div> <div>Setting this will force container to be restarted.</div> </td> </tr> <tr> <td colspan="2">  <b>log_driver</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specify the logging driver. Docker uses <code>json-file</code> by default.</div> <div>See <a href="https://docs.docker.com/config/containers/logging/configure/">here</a> for possible choices.</div> </td> </tr> <tr> <td colspan="2">  <b>log_options</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of options specific to the chosen <em>log_driver</em>.</div> <div>See <a href="https://docs.docker.com/engine/admin/logging/overview/">https://docs.docker.com/engine/admin/logging/overview/</a> for details.</div> <div>
<br>aliases: log_opt</div> </td> </tr> <tr> <td colspan="2">  <b>mac_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Container MAC address (e.g. 92:d0:c6:0a:29:33).</div> </td> </tr> <tr> <td colspan="2">  <b>memory</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Memory limit in format <code>&lt;number&gt;[&lt;unit&gt;]</code>. Number is a positive integer. Unit can be <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>"0"</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>memory_reservation</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Memory soft limit in format <code>&lt;number&gt;[&lt;unit&gt;]</code>. Number is a positive integer. Unit can be <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes.</div> </td> </tr> <tr> <td colspan="2">  <b>memory_swap</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Total memory limit (memory + swap) in format <code>&lt;number&gt;[&lt;unit&gt;]</code>, or the special values <code>unlimited</code> or <code>-1</code> for unlimited swap usage. Number is a positive integer. Unit can be <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes.</div> </td> </tr> <tr> <td colspan="2">  <b>memory_swappiness</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Tune a container's memory swappiness behavior. Accepts an integer between 0 and 100.</div> <div>If not set, the value will be remain the same if container exists and will be inherited from the host machine if it is (re-)created.</div> </td> </tr> <tr> <td colspan="2">  <b>mounts</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Specification for mounts to be added to the container. More powerful alternative to <em>volumes</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>consistency</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>cached</li> <li>consistent</li> <li>default</li> <li>delegated</li> </ul> </td> <td> <div>The consistency requirement for the mount.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>labels</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>User-defined name and labels for the volume. Only valid for the <code>volume</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>no_copy</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>False if the volume should be populated with the data from the target. Only valid for the <code>volume</code> type.</div> <div>The default value is <code>false</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>propagation</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>private</li> <li>rprivate</li> <li>shared</li> <li>rshared</li> <li>slave</li> <li>rslave</li> </ul> </td> <td> <div>Propagation mode. Only valid for the <code>bind</code> type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>read_only</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Whether the mount should be read-only.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>source</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Mount source (e.g. a volume name or a host path).</div> <div>If not supplied when <em>type=volume</em> an anonymous volume will be created.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>target</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Path inside the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tmpfs_mode</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The permission mode for the tmpfs mount.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tmpfs_size</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The size for the tmpfs mount in bytes in format &lt;number&gt;[&lt;unit&gt;].</div> <div>Number is a positive integer. Unit can be one of <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>bind</li> <li>npipe</li> <li>tmpfs</li> <li><div>
<b>volume</b> ←</div></li> </ul> </td> <td> <div>The mount type.</div> <div>Note that <code>npipe</code> is only supported by Docker for Windows.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>volume_driver</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Specify the volume driver. Only valid for the <code>volume</code> type.</div> <div>See <a href="https://docs.docker.com/storage/volumes/#use-a-volume-driver">here</a> for details.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>volume_options</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of options specific to the chosen volume_driver. See <a href="https://docs.docker.com/storage/volumes/#use-a-volume-driver">here</a> for details.</div> </td> </tr> <tr> <td colspan="2">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Assign a name to a new container or match an existing container.</div> <div>When identifying an existing container name may be a name or a long or short container ID.</div> </td> </tr> <tr> <td colspan="2">  <b>network_mode</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Connect the container to a network. Choices are <code>bridge</code>, <code>host</code>, <code>none</code>, <code>container:&lt;name|id&gt;</code>, <code>&lt;network_name&gt;</code> or <code>default</code>.</div> <div>*Note* that from community.docker 2.0.0 on, if <em>networks_cli_compatible</em> is <code>true</code> and <em>networks</em> contains at least one network, the default value for <em>network_mode</em> will be the name of the first network in the <em>networks</em> list. You can prevent this by explicitly specifying a value for <em>network_mode</em>, like the default value <code>default</code> which will be used by Docker if <em>network_mode</em> is not specified.</div> </td> </tr> <tr> <td colspan="2">  <b>networks</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of networks the container belongs to.</div> <div>For examples of the data structure and usage see EXAMPLES below.</div> <div>To remove a container from one or more networks, use the <em>purge_networks</em> option.</div> <div>If <em>networks_cli_compatible</em> is set to <code>false</code>, this will not remove the default network if <em>networks</em> is specified. This is different from the behavior of <code>docker run ...</code>. You need to explicitly use <em>purge_networks</em> to enforce the removal of the default network (and all other networks not explicitly mentioned in <em>networks</em>) in that case.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>aliases</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of aliases for this container in this network. These names can be used in the network to reach this container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The container's IPv4 address in this network.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_address</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The container's IPv6 address in this network.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>links</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of containers to link to.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The network's name.</div> </td> </tr> <tr> <td colspan="2">  <b>networks_cli_compatible</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>If <em>networks_cli_compatible</em> is set to <code>yes</code> (default), this module will behave as <code>docker run --network</code> and will *not* add the default network if <em>networks</em> is specified. If <em>networks</em> is not specified, the default network will be attached.</div> <div>When <em>networks_cli_compatible</em> is set to <code>no</code> and networks are provided to the module via the <em>networks</em> option, the module behaves differently than <code>docker run --network</code>: <code>docker run --network other</code> will create a container with network <code>other</code> attached, but the default network not attached. This module with <em>networks: {name: other}</em> will create a container with both <code>default</code> and <code>other</code> attached. If <em>purge_networks</em> is set to <code>yes</code>, the <code>default</code> network will be removed afterwards.</div> <div>*Note* that docker CLI also sets <em>network_mode</em> to the name of the first network added if <code>--network</code> is specified. For more compatibility with docker CLI, you explicitly have to set <em>network_mode</em> to the name of the first network you're adding. This behavior will change for community.docker 2.0.0: then <em>network_mode</em> will automatically be set to the first network name in <em>networks</em> if <em>network_mode</em> is not specified, <em>networks</em> has at least one entry and <em>networks_cli_compatible</em> is <code>true</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>oom_killer</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Whether or not to disable OOM Killer for the container.</div> </td> </tr> <tr> <td colspan="2">  <b>oom_score_adj</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>An integer value containing the score given to the container in order to tune OOM killer preferences.</div> </td> </tr> <tr> <td colspan="2">  <b>output_logs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If set to true, output of the container command will be printed.</div> <div>Only effective when <em>log_driver</em> is set to <code>json-file</code> or <code>journald</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>paused</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Use with the started state to pause running processes inside the container.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>pid_mode</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set the PID namespace mode for the container.</div> <div>Note that Docker SDK for Python &lt; 2.0 only supports <code>host</code>. Newer versions of the Docker SDK for Python (docker) allow all values supported by the Docker daemon.</div> </td> </tr> <tr> <td colspan="2">  <b>pids_limit</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Set PIDs limit for the container. It accepts an integer value.</div> <div>Set <code>-1</code> for unlimited PIDs.</div> </td> </tr> <tr> <td colspan="2">  <b>privileged</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Give extended privileges to the container.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>publish_all_ports</b>  <div> <span>boolean</span> </div> <div> added in 1.8.0 of community.docker </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Publish all ports to the host.</div> <div>Any specified port bindings from <em>published_ports</em> will remain intact when <code>true</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>published_ports</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of ports to publish from the container to the host.</div> <div>Use docker CLI syntax: <code>8000</code>, <code>9000:8000</code>, or <code>0.0.0.0:9000:8000</code>, where 8000 is a container port, 9000 is a host port, and 0.0.0.0 is a host interface.</div> <div>Port ranges can be used for source and destination ports. If two ranges with different lengths are specified, the shorter range will be used. Since community.general 0.2.0, if the source port range has length 1, the port will not be assigned to the first port of the destination range, but to a free port in that range. This is the same behavior as for <code>docker</code> command line utility.</div> <div>Bind addresses must be either IPv4 or IPv6 addresses. Hostnames are *not* allowed. This is different from the <code>docker</code> command line utility. Use the <a href="../lookup/dig.html">dig lookup</a> to resolve hostnames.</div> <div>A value of <code>all</code> will publish all exposed container ports to random host ports, ignoring any other mappings. Use <em>publish_all_ports</em> instead as the use of <code>all</code> will be deprecated in version 2.0.0.</div> <div>If <em>networks</em> parameter is provided, will inspect each network to see if there exists a bridge network with optional parameter <code>com.docker.network.bridge.host_binding_ipv4</code>. If such a network is found, then published ports where no host IP address is specified will be bound to the host IP pointed to by <code>com.docker.network.bridge.host_binding_ipv4</code>. Note that the first bridge network with a <code>com.docker.network.bridge.host_binding_ipv4</code> value encountered in the list of <em>networks</em> is the one that will be used.</div> <div>
<br>aliases: ports</div> </td> </tr> <tr> <td colspan="2">  <b>pull</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If true, always pull the latest version of an image. Otherwise, will only pull an image when missing.</div> <div>*Note:* images are only pulled when specified by name. If the image is specified as a image ID (hash), it cannot be pulled.</div> </td> </tr> <tr> <td colspan="2">  <b>purge_networks</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Remove the container from ALL networks not included in <em>networks</em> parameter.</div> <div>Any default networks such as <code>bridge</code>, if not found in <em>networks</em>, will be removed as well.</div> </td> </tr> <tr> <td colspan="2">  <b>read_only</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Mount the container's root file system as read-only.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>recreate</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use with present and started states to force the re-creation of an existing container.</div> </td> </tr> <tr> <td colspan="2">  <b>removal_wait_timeout</b>  <div> <span>float</span> </div> </td> <td> </td> <td> <div>When removing an existing container, the docker daemon API call exists after the container is scheduled for removal. Removal usually is very fast, but it can happen that during high I/O load, removal can take longer. By default, the module will wait until the container has been removed before trying to (re-)create it, however long this takes.</div> <div>By setting this option, the module will wait at most this many seconds for the container to be removed. If the container is still in the removal phase after this many seconds, the module will fail.</div> </td> </tr> <tr> <td colspan="2">  <b>restart</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use with started state to force a matching container to be stopped and restarted.</div> </td> </tr> <tr> <td colspan="2">  <b>restart_policy</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>on-failure</li> <li>always</li> <li>unless-stopped</li> </ul> </td> <td> <div>Container restart policy.</div> <div>Place quotes around <code>no</code> option.</div> </td> </tr> <tr> <td colspan="2">  <b>restart_retries</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Use with restart policy to control maximum number of restart attempts.</div> </td> </tr> <tr> <td colspan="2">  <b>runtime</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Runtime to use for the container.</div> </td> </tr> <tr> <td colspan="2">  <b>security_opts</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of security options in the form of <code>"label:user:User"</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>shm_size</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Size of <code>/dev/shm</code> in format <code>&lt;number&gt;[&lt;unit&gt;]</code>. Number is positive integer. Unit can be <code>B</code> (byte), <code>K</code> (kibibyte, 1024B), <code>M</code> (mebibyte), <code>G</code> (gibibyte), <code>T</code> (tebibyte), or <code>P</code> (pebibyte).</div> <div>Omitting the unit defaults to bytes. If you omit the size entirely, Docker daemon uses <code>64M</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>ssl_version</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Provide a valid SSL version number. Default value determined by ssl.py module.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_SSL_VERSION</code> will be used instead.</div> </td> </tr> <tr> <td colspan="2">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>absent</li> <li>present</li> <li>stopped</li> <li><div>
<b>started</b> ←</div></li> </ul> </td> <td> <div>
<code>absent</code> - A container matching the specified name will be stopped and removed. Use <em>force_kill</em> to kill the container rather than stopping it. Use <em>keep_volumes</em> to retain anonymous volumes associated with the removed container.</div> <div>
<code>present</code> - Asserts the existence of a container matching the name and any provided configuration parameters. If no container matches the name, a container will be created. If a container matches the name but the provided configuration does not match, the container will be updated, if it can be. If it cannot be updated, it will be removed and re-created with the requested config.</div> <div>
<code>started</code> - Asserts that the container is first <code>present</code>, and then if the container is not running moves it to a running state. Use <em>restart</em> to force a matching container to be stopped and restarted.</div> <div>
<code>stopped</code> - Asserts that the container is first <code>present</code>, and then if the container is running moves it to a stopped state.</div> <div>To control what will be taken into account when comparing configuration, see the <em>comparisons</em> option. To avoid that the image version will be taken into account, you can also use the <em>ignore_image</em> option.</div> <div>Use the <em>recreate</em> option to always force re-creation of a matching container, even if it is running.</div> <div>If the container should be killed instead of stopped in case it needs to be stopped for recreation, or because <em>state</em> is <code>stopped</code>, please use the <em>force_kill</em> option. Use <em>keep_volumes</em> to retain anonymous volumes associated with a removed container.</div> <div>Use <em>keep_volumes</em> to retain anonymous volumes associated with a removed container.</div> </td> </tr> <tr> <td colspan="2">  <b>stop_signal</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Override default signal used to stop the container.</div> </td> </tr> <tr> <td colspan="2">  <b>stop_timeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Number of seconds to wait for the container to stop before sending <code>SIGKILL</code>. When the container is created by this module, its <code>StopTimeout</code> configuration will be set to this value.</div> <div>When the container is stopped, will be used as a timeout for stopping the container. In case the container has a custom <code>StopTimeout</code> configuration, the behavior depends on the version of the docker daemon. New versions of the docker daemon will always use the container's configured <code>StopTimeout</code> value if it has been configured.</div> </td> </tr> <tr> <td colspan="2">  <b>storage_opts</b>  <div> <span>dictionary</span> </div> <div> added in 1.3.0 of community.docker </div> </td> <td> </td> <td> <div>Storage driver options for this container as a key-value mapping.</div> </td> </tr> <tr> <td colspan="2">  <b>sysctls</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Dictionary of key,value pairs.</div> </td> </tr> <tr> <td colspan="2">  <b>timeout</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>60</div> </td> <td> <div>The maximum amount of time in seconds to wait on a response from the API.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_TIMEOUT</code> will be used instead. If the environment variable is not set, the default value will be used.</div> </td> </tr> <tr> <td colspan="2">  <b>tls</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Secure the connection to the API by using TLS without verifying the authenticity of the Docker host server. Note that if <em>validate_certs</em> is set to <code>yes</code> as well, it will take precedence.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_TLS</code> will be used instead. If the environment variable is not set, the default value will be used.</div> </td> </tr> <tr> <td colspan="2">  <b>tls_hostname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>When verifying the authenticity of the Docker Host server, provide the expected name of the server.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_TLS_HOSTNAME</code> will be used instead. If the environment variable is not set, the default value will be used.</div> <div>The current default value is <code>localhost</code>. This default is deprecated and will change in community.docker 2.0.0 to be a value computed from <em>docker_host</em>. Explicitly specify <code>localhost</code> to make sure this value will still be used, and to disable the deprecation message which will be shown otherwise.</div> </td> </tr> <tr> <td colspan="2">  <b>tmpfs</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Mount a tmpfs directory.</div> </td> </tr> <tr> <td colspan="2">  <b>tty</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Allocate a pseudo-TTY.</div> <div>If <em>container_default_behavior</em> is set to <code>compatiblity</code> (the default value), this option has a default of <code>no</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>ulimits</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of ulimit options. A ulimit is specified as <code>nofile:262144:262144</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>use_ssh_client</b>  <div> <span>boolean</span> </div> <div> added in 1.5.0 of community.docker </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>For SSH transports, use the <code>ssh</code> CLI tool instead of paramiko.</div> <div>Requires Docker SDK for Python 4.4.0 or newer.</div> </td> </tr> <tr> <td colspan="2">  <b>user</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Sets the username or UID used and optionally the groupname or GID for the specified command.</div> <div>Can be of the forms <code>user</code>, <code>user:group</code>, <code>uid</code>, <code>uid:gid</code>, <code>user:gid</code> or <code>uid:group</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>userns_mode</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set the user namespace mode for the container. Currently, the only valid value are <code>host</code> and the empty string.</div> </td> </tr> <tr> <td colspan="2">  <b>uts</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Set the UTS namespace mode for the container.</div> </td> </tr> <tr> <td colspan="2">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Secure the connection to the API by using TLS and verifying the authenticity of the Docker host server.</div> <div>If the value is not specified in the task, the value of environment variable <code>DOCKER_TLS_VERIFY</code> will be used instead. If the environment variable is not set, the default value will be used.</div> <div>
<br>aliases: tls_verify</div> </td> </tr> <tr> <td colspan="2">  <b>volume_driver</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The container volume driver.</div> </td> </tr> <tr> <td colspan="2">  <b>volumes</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of volumes to mount within the container.</div> <div>Use docker CLI-style syntax: <code>/host:/container[:mode]</code>
</div> <div>Mount modes can be a comma-separated list of various modes such as <code>ro</code>, <code>rw</code>, <code>consistent</code>, <code>delegated</code>, <code>cached</code>, <code>rprivate</code>, <code>private</code>, <code>rshared</code>, <code>shared</code>, <code>rslave</code>, <code>slave</code>, and <code>nocopy</code>. Note that the docker daemon might not support all modes and combinations of such modes.</div> <div>SELinux hosts can additionally use <code>z</code> or <code>Z</code> to use a shared or private label for the volume.</div> <div>Note that Ansible 2.7 and earlier only supported one mode, which had to be one of <code>ro</code>, <code>rw</code>, <code>z</code>, and <code>Z</code>.</div> </td> </tr> <tr> <td colspan="2">  <b>volumes_from</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>List of container names or IDs to get volumes from.</div> </td> </tr> <tr> <td colspan="2">  <b>working_dir</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Path to the working directory.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>For most config changes, the container needs to be recreated, i.e. the existing container has to be destroyed and a new one created. This can cause unexpected data loss and downtime. You can use the <em>comparisons</em> option to prevent this.</li> <li>If the module needs to recreate the container, it will only use the options provided to the module to create the new container (except <em>image</em>). Therefore, always specify <em>all</em> options relevant to the container.</li> <li>When <em>restart</em> is set to <code>true</code>, the module will only restart the container if no config changes are detected. Please note that several options have default values; if the container to be restarted uses different values for these options, it will be recreated instead. The options with default values which can cause this are <em>auto_remove</em>, <em>detach</em>, <em>init</em>, <em>interactive</em>, <em>memory</em>, <em>paused</em>, <em>privileged</em>, <em>read_only</em> and <em>tty</em>. This behavior can be changed by setting <em>container_default_behavior</em> to <code>no_defaults</code>, which will be the default value from community.docker 2.0.0 on.</li> <li>Connect to the Docker daemon by providing parameters with each task or by defining environment variables. You can define <code>DOCKER_HOST</code>, <code>DOCKER_TLS_HOSTNAME</code>, <code>DOCKER_API_VERSION</code>, <code>DOCKER_CERT_PATH</code>, <code>DOCKER_SSL_VERSION</code>, <code>DOCKER_TLS</code>, <code>DOCKER_TLS_VERIFY</code> and <code>DOCKER_TIMEOUT</code>. If you are using docker machine, run the script shipped with the product that sets up the environment. It will set these variables for you. See <a class="reference external" href="https://docs.docker.com/machine/reference/env/">https://docs.docker.com/machine/reference/env/</a> for more details.</li> <li>When connecting to Docker daemon with TLS, you might need to install additional Python packages. For the Docker SDK for Python, version 2.4 or newer, this can be done by installing <code>docker[tls]</code> with <a class="reference internal" href="../../ansible/builtin/pip_module.html#ansible-collections-ansible-builtin-pip-module"><span class="std std-ref">ansible.builtin.pip</span></a>.</li> <li>Note that the Docker SDK for Python only allows to specify the path to the Docker configuration for very few functions. In general, it will use <code>$HOME/.docker/config.json</code> if the <code>DOCKER_CONFIG</code> environment variable is not specified, and use <code>$DOCKER_CONFIG/config.json</code> otherwise.</li> <li>This module uses the <a class="reference external" href="https://docker-py.readthedocs.io/en/stable/">Docker SDK for Python</a> to communicate with the Docker daemon.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Create a data container
  community.docker.docker_container:
    name: mydata
    image: busybox
    volumes:
      - /data

- name: Re-create a redis container
  community.docker.docker_container:
    name: myredis
    image: redis
    command: redis-server --appendonly yes
    state: present
    recreate: yes
    exposed_ports:
      - 6379
    volumes_from:
      - mydata

- name: Restart a container
  community.docker.docker_container:
    name: myapplication
    image: someuser/appimage
    state: started
    restart: yes
    links:
     - "myredis:aliasedredis"
    devices:
     - "/dev/sda:/dev/xvda:rwm"
    ports:
     # Publish container port 9000 as host port 8080
     - "8080:9000"
     # Publish container UDP port 9001 as host port 8081 on interface 127.0.0.1
     - "127.0.0.1:8081:9001/udp"
     # Publish container port 9002 as a random host port
     - "9002"
     # Publish container port 9003 as a free host port in range 8000-8100
     # (the host port will be selected by the Docker daemon)
     - "8000-8100:9003"
     # Publish container ports 9010-9020 to host ports 7000-7010
     - "7000-7010:9010-9020"
    env:
        SECRET_KEY: "ssssh"
        # Values which might be parsed as numbers, booleans or other types by the YAML parser need to be quoted
        BOOLEAN_KEY: "yes"

- name: Container present
  community.docker.docker_container:
    name: mycontainer
    state: present
    image: ubuntu:14.04
    command: sleep infinity

- name: Stop a container
  community.docker.docker_container:
    name: mycontainer
    state: stopped

- name: Start 4 load-balanced containers
  community.docker.docker_container:
    name: "container{{ item }}"
    recreate: yes
    image: someuser/anotherappimage
    command: sleep 1d
  with_sequence: count=4

- name: Remove container
  community.docker.docker_container:
    name: ohno
    state: absent

- name: Syslogging output
  community.docker.docker_container:
    name: myservice
    image: busybox
    log_driver: syslog
    log_options:
      syslog-address: tcp://my-syslog-server:514
      syslog-facility: daemon
      # NOTE: in Docker 1.13+ the "syslog-tag" option was renamed to "tag" for
      # older docker installs, use "syslog-tag" instead
      tag: myservice

- name: Create db container and connect to network
  community.docker.docker_container:
    name: db_test
    image: "postgres:latest"
    networks:
      - name: "{{ docker_network_name }}"

- name: Start container, connect to network and link
  community.docker.docker_container:
    name: sleeper
    image: ubuntu:14.04
    networks:
      - name: TestingNet
        ipv4_address: "172.16.1.100"
        aliases:
          - sleepyzz
        links:
          - db_test:db
      - name: TestingNet2

- name: Start a container with a command
  community.docker.docker_container:
    name: sleepy
    image: ubuntu:14.04
    command: ["sleep", "infinity"]

- name: Add container to networks
  community.docker.docker_container:
    name: sleepy
    networks:
      - name: TestingNet
        ipv4_address: 172.16.1.18
        links:
          - sleeper
      - name: TestingNet2
        ipv4_address: 172.16.10.20

- name: Update network with aliases
  community.docker.docker_container:
    name: sleepy
    networks:
      - name: TestingNet
        aliases:
          - sleepyz
          - zzzz

- name: Remove container from one network
  community.docker.docker_container:
    name: sleepy
    networks:
      - name: TestingNet2
    purge_networks: yes

- name: Remove container from all networks
  community.docker.docker_container:
    name: sleepy
    purge_networks: yes

- name: Start a container and use an env file
  community.docker.docker_container:
    name: agent
    image: jenkinsci/ssh-slave
    env_file: /var/tmp/jenkins/agent.env

- name: Create a container with limited capabilities
  community.docker.docker_container:
    name: sleepy
    image: ubuntu:16.04
    command: sleep infinity
    capabilities:
      - sys_time
    cap_drop:
      - all

- name: Finer container restart/update control
  community.docker.docker_container:
    name: test
    image: ubuntu:18.04
    env:
      arg1: "true"
      arg2: "whatever"
    volumes:
      - /tmp:/tmp
    comparisons:
      image: ignore   # don't restart containers with older versions of the image
      env: strict   # we want precisely this environment
      volumes: allow_more_present   # if there are more volumes, that's ok, as long as `/tmp:/tmp` is there

- name: Finer container restart/update control II
  community.docker.docker_container:
    name: test
    image: ubuntu:18.04
    env:
      arg1: "true"
      arg2: "whatever"
    comparisons:
      '*': ignore  # by default, ignore *all* options (including image)
      env: strict   # except for environment variables; there, we want to be strict

- name: Start container with healthstatus
  community.docker.docker_container:
    name: nginx-proxy
    image: nginx:1.13
    state: started
    healthcheck:
      # Check if nginx server is healthy by curl'ing the server.
      # If this fails or timeouts, the healthcheck fails.
      test: ["CMD", "curl", "--fail", "http://nginx.host.com"]
      interval: 1m30s
      timeout: 10s
      retries: 3
      start_period: 30s

- name: Remove healthcheck from container
  community.docker.docker_container:
    name: nginx-proxy
    image: nginx:1.13
    state: started
    healthcheck:
      # The "NONE" check needs to be specified
      test: ["NONE"]

- name: Start container with block device read limit
  community.docker.docker_container:
    name: test
    image: ubuntu:18.04
    state: started
    device_read_bps:
      # Limit read rate for /dev/sda to 20 mebibytes per second
      - path: /dev/sda
        rate: 20M
    device_read_iops:
      # Limit read rate for /dev/sdb to 300 IO per second
      - path: /dev/sdb
        rate: 300

- name: Start container with GPUs
  community.docker.docker_container:
    name: test
    image: ubuntu:18.04
    state: started
    device_requests:
      - # Add some specific devices to this container
        device_ids:
          - '0'
          - 'GPU-3a23c669-1f69-c64e-cf85-44e9b07e7a2a'
      - # Add nVidia GPUs to this container
        driver: nvidia
        count: -1  # this means we want all
        capabilities:
          # We have one OR condition: 'gpu' AND 'utility'
          - - gpu
            - utility
          # See https://github.com/NVIDIA/nvidia-container-runtime#supported-driver-capabilities
          # for a list of capabilities supported by the nvidia driver

- name: Start container with storage options
  community.docker.docker_container:
    name: test
    image: ubuntu:18.04
    state: started
    storage_opts:
      # Limit root filesystem to 12 MB - note that this requires special storage backends
      # (https://fabianlee.org/2020/01/15/docker-use-overlay2-with-an-xfs-backing-filesystem-to-limit-rootfs-size/)
      size: 12m
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>container</b>  <div> <span>dictionary</span> </div> </td> <td>success; or when <em>state=started</em> and <em>detach=false</em>, and when waiting for the container result did not fail</td> <td> <div>Facts representing the current state of the container. Matches the docker inspection output.</div> <div>Empty if <em>state</em> is <code>absent</code>.</div> <div>If <em>detach=false</em>, will include <code>Output</code> attribute containing any output from container run.</div> <br> <div><b>Sample:</b></div> <div>{ "AppArmorProfile": "", "Args": [], "Config": { "AttachStderr": false, "AttachStdin": false, "AttachStdout": false, "Cmd": [ "/usr/bin/supervisord" ], "Domainname": "", "Entrypoint": null, "Env": [ "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" ], "ExposedPorts": { "443/tcp": {}, "80/tcp": {} }, "Hostname": "8e47bf643eb9", "Image": "lnmp_nginx:v1", "Labels": {}, "OnBuild": null, "OpenStdin": false, "StdinOnce": false, "Tty": false, "User": "", "Volumes": { "/tmp/lnmp/nginx-sites/logs/": {} }, ... }</div> </td> </tr> <tr> <td colspan="1">  <b>status</b>  <div> <span>integer</span> </div> </td> <td>when <em>state=started</em> and <em>detach=false</em>, and when waiting for the container result did not fail</td> <td> <div>In case a container is started without detaching, this contains the exit code of the process in the container.</div> <div>Before community.docker 1.1.0, this was only returned when non-zero.</div> <br> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Cove Schneider (@cove)</li> <li>Joshua Conner (@joshuaconner)</li> <li>Pavel Antonov (@softzilla)</li> <li>Thomas Steinbach (@ThomasSteinbach)</li> <li>Philippe Jandot (@zfil)</li> <li>Daan Oosterveld (@dusdanig)</li> <li>Chris Houseknecht (@chouseknecht)</li> <li>Kassian Sun (@kassiansun)</li> <li>Felix Fontein (@felixfontein)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/docker/docker_container_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/docker/docker_container_module.html</a>
  </p>
</div>
