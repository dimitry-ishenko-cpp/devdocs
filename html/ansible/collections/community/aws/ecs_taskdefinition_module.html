<h1 id="community-aws-ecs-taskdefinition-register-a-task-definition-in-ecs">community.aws.ecs_taskdefinition – register a task definition in ecs</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/aws">community.aws collection</a> (version 1.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.aws</code>.</p> <p>To use it in a playbook, specify: <code>community.aws.ecs_taskdefinition</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of community.aws</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Registers or deregisters task definitions in the Amazon Web Services (AWS) EC2 Container Service (ECS).</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>boto</li> <li>boto3</li> <li>botocore</li> <li>json</li> <li>python &gt;= 2.6</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="4">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="4">  <b>arn</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The ARN of the task description to delete.</div> </td> </tr> <tr> <td colspan="4">  <b>aws_access_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>AWS access key. If not set then the value of the AWS_ACCESS_KEY_ID, AWS_ACCESS_KEY or EC2_ACCESS_KEY environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>aws_access_key</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: ec2_access_key, access_key</div> </td> </tr> <tr> <td colspan="4">  <b>aws_ca_bundle</b>  <div> <span>path</span> </div> </td> <td> </td> <td> <div>The location of a CA Bundle to use when validating SSL certificates.</div> <div>Only used for boto3 based modules.</div> <div>Note: The CA Bundle is read 'module' side and may need to be explicitly copied from the controller if not run locally.</div> </td> </tr> <tr> <td colspan="4">  <b>aws_config</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A dictionary to modify the botocore configuration.</div> <div>Parameters can be found at <a href="https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config">https://botocore.amazonaws.com/v1/documentation/api/latest/reference/config.html#botocore.config.Config</a>.</div> <div>Only the 'user_agent' key is used for boto modules. See <a href="http://boto.cloudhackers.com/en/latest/boto_config_tut.html#boto">http://boto.cloudhackers.com/en/latest/boto_config_tut.html#boto</a> for more boto configuration.</div> </td> </tr> <tr> <td colspan="4">  <b>aws_secret_key</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>AWS secret key. If not set then the value of the AWS_SECRET_ACCESS_KEY, AWS_SECRET_KEY, or EC2_SECRET_KEY environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>aws_secret_key</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: ec2_secret_key, secret_key</div> </td> </tr> <tr> <td colspan="4">  <b>containers</b>  <div> <span>list</span> / <span>elements=dictionary</span> / <span>required</span> </div> </td> <td> </td> <td> <div>A list of containers definitions.</div> <div>See <a href="https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ecs.html">https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/ecs.html</a> for a complete list of parameters.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>command</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>The command that is passed to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>cpu</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The number of cpu units reserved for the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>dependsOn</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The dependencies defined for container startup and shutdown.</div> <div>When a dependency is defined for container startup, for container shutdown it is reversed.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>condition</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>start</li> <li>complete</li> <li>success</li> <li>healthy</li> </ul> </td> <td> <div>The dependency condition of the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>containerName</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of a container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>disableNetworking</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>When this parameter is <code>True</code>, networking is disabled within the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>dnsSearchDomains</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of DNS search domains that are presented to the container.</div> <div>This parameter is not supported for Windows containers.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>dnsServers</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of DNS servers that are presented to the container.</div> <div>This parameter is not supported for Windows containers.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>dockerLabels</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>A key/value map of labels to add to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>dockerSecurityOptions</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of strings to provide custom labels for SELinux and AppArmor multi-level security systems.</div> <div>This parameter is not supported for Windows containers.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>entryPoint</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The entry point that is passed to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>environment</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The environment variables to pass to a container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the key-value pair.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The value of the key-value pair.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>environmentFiles</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of files containing the environment variables to pass to a container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>type</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The file type to use. The only supported value is <code>s3</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The Amazon Resource Name (ARN) of the Amazon S3 object containing the environment variable file.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>essential</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>If <em>essential=True</em>, and the container fails or stops for any reason, all other containers that are part of the task are stopped.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>extraHosts</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of hostnames and IP address mappings to append to the /etc/hosts file on the container.</div> <div>This parameter is not supported for Windows containers or tasks that use <em>network_mode=awsvpc</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>hostname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The hostname to use in the /etc/hosts entry.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipAddress</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The IP address to use in the /etc/hosts entry.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>healthCheck</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The health check command and associated configuration parameters for the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>hostname</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The hostname to use for your container.</div> <div>This parameter is not supported if <em>network_mode=awsvpc</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>image</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The image used to start a container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>interactive</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>When <em>interactive=True</em>, it allows to deploy containerized applications that require stdin or a tty to be allocated.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>links</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Allows containers to communicate with each other without the need for port mappings.</div> <div>This parameter is only supported if <em>network_mode=bridge</em>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>linuxParameters</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Linux-specific modifications that are applied to the container, such as Linux kernel capabilities.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>capabilities</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The Linux capabilities for the container that are added to or dropped from the default configuration provided by Docker.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>add</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>ALL</li> <li>AUDIT_CONTROL</li> <li>AUDIT_WRITE</li> <li>BLOCK_SUSPEND</li> <li>CHOWN</li> <li>DAC_OVERRIDE</li> <li>DAC_READ_SEARCH</li> <li>FOWNER</li> <li>FSETID</li> <li>IPC_LOCK</li> <li>IPC_OWNER</li> <li>KILL</li> <li>LEASE</li> <li>LINUX_IMMUTABLE</li> <li>MAC_ADMIN</li> <li>MAC_OVERRIDE</li> <li>MKNOD</li> <li>NET_ADMIN</li> <li>NET_BIND_SERVICE</li> <li>NET_BROADCAST</li> <li>NET_RAW</li> <li>SETFCAP</li> <li>SETGID</li> <li>SETPCAP</li> <li>SETUID</li> <li>SYS_ADMIN</li> <li>SYS_BOOT</li> <li>SYS_CHROOT</li> <li>SYS_MODULE</li> <li>SYS_NICE</li> <li>SYS_PACCT</li> <li>SYS_PTRACE</li> <li>SYS_RAWIO</li> <li>SYS_RESOURCE</li> <li>SYS_TIME</li> <li>SYS_TTY_CONFIG</li> <li>SYSLOG</li> <li>WAKE_ALARM</li> </ul> </td> <td> <div>The Linux capabilities for the container that have been added to the default configuration provided by Docker.</div> <div>If <em>launch_type=FARGATE</em>, this parameter is not supported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>drop</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>ALL</li> <li>AUDIT_CONTROL</li> <li>AUDIT_WRITE</li> <li>BLOCK_SUSPEND</li> <li>CHOWN</li> <li>DAC_OVERRIDE</li> <li>DAC_READ_SEARCH</li> <li>FOWNER</li> <li>FSETID</li> <li>IPC_LOCK</li> <li>IPC_OWNER</li> <li>KILL</li> <li>LEASE</li> <li>LINUX_IMMUTABLE</li> <li>MAC_ADMIN</li> <li>MAC_OVERRIDE</li> <li>MKNOD</li> <li>NET_ADMIN</li> <li>NET_BIND_SERVICE</li> <li>NET_BROADCAST</li> <li>NET_RAW</li> <li>SETFCAP</li> <li>SETGID</li> <li>SETPCAP</li> <li>SETUID</li> <li>SYS_ADMIN</li> <li>SYS_BOOT</li> <li>SYS_CHROOT</li> <li>SYS_MODULE</li> <li>SYS_NICE</li> <li>SYS_PACCT</li> <li>SYS_PTRACE</li> <li>SYS_RAWIO</li> <li>SYS_RESOURCE</li> <li>SYS_TIME</li> <li>SYS_TTY_CONFIG</li> <li>SYSLOG</li> <li>WAKE_ALARM</li> </ul> </td> <td> <div>The Linux capabilities for the container that have been removed from the default configuration provided by Docker.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>devices</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Any host devices to expose to the container.</div> <div>If <em>launch_type=FARGATE</em>, this parameter is not supported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>containerPath</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The path inside the container at which to expose the host device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>hostPath</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The path for the device on the host container instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>permissions</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>The explicit permissions to provide to the container for the device.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>initProcessEnabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Run an init process inside the container that forwards signals and reaps processes.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>maxSwap</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The total amount of swap memory (in MiB) a container can use.</div> <div>If <em>launch_type=FARGATE</em>, this parameter is not supported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>sharedMemorySize</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The value for the size (in MiB) of the /dev/shm volume.</div> <div>If <em>launch_type=FARGATE</em>, this parameter is not supported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>swappiness</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>This allows you to tune a container's memory swappiness behavior.</div> <div>If <em>launch_type=FARGATE</em>, this parameter is not supported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>tmpfs</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The container path, mount options, and size (in MiB) of the tmpfs mount.</div> <div>If <em>launch_type=FARGATE</em>, this parameter is not supported.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>containerPath</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The absolute file path where the tmpfs volume is to be mounted.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>mountOptions</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>defaults</li> <li>ro</li> <li>rw</li> <li>suid</li> <li>nosuid</li> <li>dev</li> <li>nodev</li> <li>exec</li> <li>noexec</li> <li>sync</li> <li>async</li> <li>dirsync</li> <li>remount</li> <li>mand</li> <li>nomand</li> <li>atime</li> <li>noatime</li> <li>diratime</li> <li>nodiratime</li> <li>bind</li> <li>rbind</li> <li>unbindable</li> <li>runbindable</li> <li>private</li> <li>rprivate</li> <li>shared</li> <li>rshared</li> <li>slave</li> <li>rslave</li> <li>relatime</li> <li>norelatime</li> <li>strictatime</li> <li>nostrictatime</li> <li>mode</li> <li>uid</li> <li>gid</li> <li>nr_inodes</li> <li>nr_blocks</li> <li>mpol</li> </ul> </td> <td> <div>The list of tmpfs volume mount options.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>size</b>  <div> <span>integer</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The size (in MiB) of the tmpfs volume.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>logConfiguration</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The log configuration specification for the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>logDriver</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The log driver to use for the container.</div> <div>For tasks on AWS Fargate, the supported log drivers are <code>awslogs</code>, <code>splunk</code>, and <code>awsfirelens</code>.</div> <div>For tasks hosted on Amazon EC2 instances, the supported log drivers are <code>awslogs</code>, <code>fluentd</code>, <code>gelf</code>, <code>json-file</code>, <code>journald</code>, <code>logentries</code>, <code>syslog</code>, <code>splunk</code>, and <code>awsfirelens</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>memory</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The amount (in MiB) of memory to present to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>memoryReservation</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The soft limit (in MiB) of memory to reserve for the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>mountPoints</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The mount points for data volumes in your container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>containerPath</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The path on the container to mount the host volume at.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>readOnly</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If this value is <code>True</code>, the container has read-only access to the volume.</div> <div>If this value is <code>False</code>, then the container can write to the volume.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>sourceVolume</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the volume to mount.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of a container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>options</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The configuration options to send to the log driver.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>portMappings</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The list of port mappings for the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>containerPort</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The port number on the container that is bound to the user-specified or automatically assigned host port.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>hostPort</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The port number on the container instance to reserve for your container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>protocol</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>tcp</b> ←</div></li> <li>udp</li> </ul> </td> <td> <div>The protocol used for the port mapping.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>privileged</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>When this parameter is <code>True</code>, the container is given elevated privileges on the host container instance.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>pseudoTerminal</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>When this parameter is <code>True</code>, a TTY is allocated.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>readonlyRootFilesystem</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>When this parameter is <code>True</code>, the container is given read-only access to its root file system.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>repositoryCredentials</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>The private repository authentication credentials to use.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>credentialsParameter</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The Amazon Resource Name (ARN) of the secret containing the private repository credentials.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>resourceRequirements</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>The type and amount of a resource to assign to a container.</div> <div>The only supported resource is a <code>GPU</code>.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>secretOptions</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The secrets to pass to the log configuration.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of the secret.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>valueFrom</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The secret to expose to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>secrets</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>The secrets to pass to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The value to set as the environment variable on the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>size</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The secret to expose to the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>startTimeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Time duration (in seconds) to wait before giving up on resolving dependencies for a container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>stopTimeout</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Time duration (in seconds) to wait before the container is forcefully killed if it doesn't exit normally on its own.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>systemControls</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of namespaced kernel parameters to set in the container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>ulimits</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of ulimits to set in the container.</div> <div>This parameter is not supported for Windows containers.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>hardLimit</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The hard limit for the ulimit type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The type of the ulimit.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>softLimit</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The soft limit for the ulimit type.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>user</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The user to use inside the container.</div> <div>This parameter is not supported for Windows containers.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>volumesFrom</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>Data volumes to mount from another container.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>readOnly</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If this value is <code>True</code>, the container has read-only access to the volume.</div> <div>If this value is <code>False</code>, then the container can write to the volume.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="2">  <b>sourceContainer</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The name of another container within the same task definition from which to mount volumes.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>workingDirectory</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The working directory in which to run commands inside the container.</div> </td> </tr> <tr> <td colspan="4">  <b>cpu</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The number of cpu units used by the task. If <em>launch_type=EC2</em>, this field is optional and any value can be used.</div> <div>If <em>launch_type=FARGATE</em>, this field is required and you must use one of <code>256</code>, <code>512</code>, <code>1024</code>, <code>2048</code>, <code>4096</code>.</div> </td> </tr> <tr> <td colspan="4">  <b>debug_botocore_endpoint_logs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Use a botocore.endpoint logger to parse the unique (rather than total) "resource:action" API calls made during a task, outputing the set to the resource_actions key in the task results. Use the aws_resource_action callback to output to total list made during a playbook. The ANSIBLE_DEBUG_BOTOCORE_LOGS environment variable may also be used.</div> </td> </tr> <tr> <td colspan="4">  <b>ec2_url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Url to use to connect to EC2 or your Eucalyptus cloud (by default the module will use EC2 endpoints). Ignored for modules where region is required. Must be specified for all other modules if region is not used. If not set then the value of the EC2_URL environment variable, if any, is used.</div> <div>
<br>aliases: aws_endpoint_url, endpoint_url</div> </td> </tr> <tr> <td colspan="4">  <b>execution_role_arn</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The Amazon Resource Name (ARN) of the task execution role that the Amazon ECS container agent and the Docker daemon can assume.</div> </td> </tr> <tr> <td colspan="4">  <b>family</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A Name that would be given to the task definition.</div> </td> </tr> <tr> <td colspan="4">  <b>force_create</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Always create new task definition.</div> </td> </tr> <tr> <td colspan="4">  <b>launch_type</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>EC2</li> <li>FARGATE</li> </ul> </td> <td> <div>The launch type on which to run your task.</div> </td> </tr> <tr> <td colspan="4">  <b>memory</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The amount (in MiB) of memory used by the task. If <em>launch_type=EC2</em>, this field is optional and any value can be used.</div> <div>If <em>launch_type=FARGATE</em>, this field is required and is limited by the CPU.</div> </td> </tr> <tr> <td colspan="4">  <b>network_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>default</li> <li><div>
<b>bridge</b> ←</div></li> <li>host</li> <li>none</li> <li>awsvpc</li> </ul> </td> <td> <div>The Docker networking mode to use for the containers in the task.</div> <div>
<code>awsvpc</code> mode was added in Ansible 2.5</div> <div>Windows containers must use <em>network_mode=default</em>, which will utilize docker NAT networking.</div> <div>Setting <em>network_mode=default</em> for a Linux container will use <code>bridge</code> mode.</div> </td> </tr> <tr> <td colspan="4">  <b>profile</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Uses a boto profile. Only works with boto &gt;= 2.24.0.</div> <div>Using <em>profile</em> will override <em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> and support for passing them at the same time as <em>profile</em> has been deprecated.</div> <div>
<em>aws_access_key</em>, <em>aws_secret_key</em> and <em>security_token</em> will be made mutually exclusive with <em>profile</em> after 2022-06-01.</div> <div>
<br>aliases: aws_profile</div> </td> </tr> <tr> <td colspan="4">  <b>region</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The AWS region to use. If not specified then the value of the AWS_REGION or EC2_REGION environment variable, if any, is used. See <a href="http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region">http://docs.aws.amazon.com/general/latest/gr/rande.html#ec2_region</a>
</div> <div>
<br>aliases: aws_region, ec2_region</div> </td> </tr> <tr> <td colspan="4">  <b>revision</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>A revision number for the task definition.</div> </td> </tr> <tr> <td colspan="4">  <b>security_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>AWS STS security token. If not set then the value of the AWS_SECURITY_TOKEN or EC2_SECURITY_TOKEN environment variable is used.</div> <div>If <em>profile</em> is set this parameter is ignored.</div> <div>Passing the <em>security_token</em> and <em>profile</em> options at the same time has been deprecated and the options will be made mutually exclusive after 2022-06-01.</div> <div>
<br>aliases: aws_security_token, access_token</div> </td> </tr> <tr> <td colspan="4">  <b>state</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>present</li> <li>absent</li> </ul> </td> <td> <div>State whether the task definition should exist or be deleted.</div> </td> </tr> <tr> <td colspan="4">  <b>task_role_arn</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The Amazon Resource Name (ARN) of the IAM role that containers in this task can assume. All containers in this task are granted the permissions that are specified in this role.</div> </td> </tr> <tr> <td colspan="4">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>When set to "no", SSL certificates will not be validated for boto versions &gt;= 2.6.0.</div> </td> </tr> <tr> <td colspan="4">  <b>volumes</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of names of volumes to be attached.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="3">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The name of the volume.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>If parameters are not set within the module, the following environment variables can be used in decreasing order of precedence <code>AWS_URL</code> or <code>EC2_URL</code>, <code>AWS_PROFILE</code> or <code>AWS_DEFAULT_PROFILE</code>, <code>AWS_ACCESS_KEY_ID</code> or <code>AWS_ACCESS_KEY</code> or <code>EC2_ACCESS_KEY</code>, <code>AWS_SECRET_ACCESS_KEY</code> or <code>AWS_SECRET_KEY</code> or <code>EC2_SECRET_KEY</code>, <code>AWS_SECURITY_TOKEN</code> or <code>EC2_SECURITY_TOKEN</code>, <code>AWS_REGION</code> or <code>EC2_REGION</code>, <code>AWS_CA_BUNDLE</code>
</li> <li>Ansible uses the boto configuration file (typically ~/.boto) if no credentials are provided. See <a class="reference external" href="https://boto.readthedocs.io/en/latest/boto_config_tut.html">https://boto.readthedocs.io/en/latest/boto_config_tut.html</a>
</li> <li>
<code>AWS_REGION</code> or <code>EC2_REGION</code> can be typically be used to specify the AWS region, when required, but this can also be configured in the boto config file</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Create task definition
  community.aws.ecs_taskdefinition:
    containers:
    - name: simple-app
      cpu: 10
      essential: true
      image: "httpd:2.4"
      memory: 300
      mountPoints:
      - containerPath: /usr/local/apache2/htdocs
        sourceVolume: my-vol
      portMappings:
      - containerPort: 80
        hostPort: 80
      logConfiguration:
        logDriver: awslogs
        options:
          awslogs-group: /ecs/test-cluster-taskdef
          awslogs-region: us-west-2
          awslogs-stream-prefix: ecs
    - name: busybox
      command:
        - &gt;
          /bin/sh -c "while true; do echo '&lt;html&gt;&lt;head&gt;&lt;title&gt;Amazon ECS Sample App&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;div&gt;&lt;h1&gt;Amazon ECS Sample App&lt;/h1&gt;&lt;h2&gt;Congratulations!
          &lt;/h2&gt;&lt;p&gt;Your application is now running on a container in Amazon ECS.&lt;/p&gt;' &gt; top; /bin/date &gt; date ; echo '&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;' &gt; bottom;
          cat top date bottom &gt; /usr/local/apache2/htdocs/index.html ; sleep 1; done"
      cpu: 10
      entryPoint:
      - sh
      - "-c"
      essential: false
      image: busybox
      memory: 200
      volumesFrom:
      - sourceContainer: simple-app
    volumes:
    - name: my-vol
    family: test-cluster-taskdef
    state: present
  register: task_output

- name: Create task definition
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: "nginx"
      portMappings:
      - containerPort: 8080
        hostPort: 8080
      cpu: 512
      memory: 1024
    state: present

- name: Create task definition
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: "nginx"
      portMappings:
      - containerPort: 8080
        hostPort: 8080
    launch_type: FARGATE
    cpu: 512
    memory: 1024
    state: present
    network_mode: awsvpc

- name: Create task definition
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: "nginx"
      portMappings:
      - containerPort: 8080
        hostPort: 8080
      cpu: 512
      memory: 1024
      dependsOn:
      - containerName: "simple-app"
        condition: "start"

# Create Task Definition with Environment Variables and Secrets
- name: Create task definition
  community.aws.ecs_taskdefinition:
    family: nginx
    containers:
    - name: nginx
      essential: true
      image: "nginx"
      environment:
        - name: "PORT"
          value: "8080"
      secrets:
        # For variables stored in Secrets Manager
        - name: "NGINX_HOST"
          valueFrom: "arn:aws:secretsmanager:us-west-2:123456789012:secret:nginx/NGINX_HOST"
        # For variables stored in Parameter Store
        - name: "API_KEY"
          valueFrom: "arn:aws:ssm:us-west-2:123456789012:parameter/nginx/API_KEY"
    launch_type: FARGATE
    cpu: 512
    memory: 1GB
    state: present
    network_mode: awsvpc
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>taskdefinition</b>  <div> <span>dictionary</span> </div> </td> <td>always</td> <td> <div>a reflection of the input parameters</div> <br> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Mark Chance (@Java1Guy)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_taskdefinition_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/aws/ecs_taskdefinition_module.html</a>
  </p>
</div>
