<section id="community-general-onepassword-doc-lookup-fetch-documents-stored-in-1password"> <h1>community.general.onepassword_doc lookup â€“ Fetch documents stored in 1Password</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This lookup plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/general/">community.general collection</a> (version 9.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>. You need further requirements to be able to use this lookup plugin, see <a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.general.onepassword_doc</code>.</p> </div> <p class="ansible-version-added">New in community.general 8.1.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#terms" id="id3">Terms</a></li> <li><a class="reference internal" href="#keyword-parameters" id="id4">Keyword parameters</a></li> <li><a class="reference internal" href="#notes" id="id5">Notes</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> <li><a class="reference internal" href="#return-value" id="id7">Return Value</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>
<a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup"><span class="std std-ref">community.general.onepassword_doc</span></a> wraps <code>op</code> command line utility to fetch one or more documents from 1Password.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-general-onepassword-doc-lookup-requirements">Requirements</h2> <p>The below requirements are needed on the local controller node that executes this lookup.</p> <ul class="simple"> <li>
<code>op</code> 1Password command line utility version 2 or later.</li> <li>See <a class="reference external" href="https://support.1password.com/command-line/">https://support.1password.com/command-line/</a>
</li> </ul> </section> <section id="terms"> <h2>Terms</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-terms"><strong>Terms</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Identifier(s) (case-insensitive UUID or name) of item(s) to retrieve.</p> </div></td> </tr>  </table> </section> <section id="keyword-parameters"> <h2>Keyword parameters</h2> <p>This describes keyword parameters of the lookup. These are the values <code>key1=value1</code>, <code>key2=value2</code> and so on in the following examples: <code>lookup('community.general.onepassword_doc', key1=value1, key2=value2, ...)</code> and <code>query('community.general.onepassword_doc', key1=value1, key2=value2, ...)</code></p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-account-id"><strong>account_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The account ID to target.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-connect-host"><strong>connect_host</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.general 8.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The host for 1Password Connect. Must be used in combination with <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-connect-token"><span class="std std-ref">connect_token</span></a></strong></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-OP_CONNECT_HOST" id="index-0"><code>OP_CONNECT_HOST</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-connect-token"><strong>connect_token</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.general 8.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The token for 1Password Connect. Must be used in combination with <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-connect-host"><span class="std std-ref">connect_host</span></a></strong></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-OP_CONNECT_TOKEN" id="index-1"><code>OP_CONNECT_TOKEN</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-domain"><strong>domain</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Domain of 1Password.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"1password.com"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-vault-password"><strong id="ansible-collections-community-general-onepassword-doc-lookup-parameter-master-password">master_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: vault_password</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The password used to unlock the specified vault.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-secret-key"><strong>secret_key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The secret key used when performing an initial sign in.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-section"><strong>section</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Item section containing the field to retrieve (case-insensitive). If absent will return first match from any section.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-service-account-token"><strong>service_account_token</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The access key for a service account.</p> <p>Only works with 1Password CLI version 2 or later.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-OP_SERVICE_ACCOUNT_TOKEN" id="index-2"><code>OP_SERVICE_ACCOUNT_TOKEN</code></a></p> <p><em class="ansible-option-versionadded">added in community.general 8.2.0</em></p> </li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-subdomain"><strong>subdomain</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The 1Password subdomain to authenticate against.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-username"><strong>username</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The username used to sign in.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-parameter-vault"><strong>vault</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Vault containing the item to retrieve (case-insensitive). If absent will search all vaults.</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>When keyword and positional parameters are used together, positional parameters must be listed before keyword parameters: <code>lookup('community.general.onepassword_doc', term1, term2, key1=value1, key2=value2)</code> and <code>query('community.general.onepassword_doc', term1, term2, key1=value1, key2=value2)</code>
</li> <li>The document contents are a string exactly as stored in 1Password.</li> <li>This plugin requires <code>op</code> version 2 or later.</li> <li>This lookup will use an existing 1Password session if one exists. If not, and you have already performed an initial sign in (meaning <code>~/.op/config</code>, <code>~/.config/op/config</code> or <code>~/.config/.op/config</code> exists), then only the <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-master-password"><span class="std std-ref">master_password</span></a></strong></code> is required. You may optionally specify <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-subdomain"><span class="std std-ref">subdomain</span></a></strong></code> in this scenario, otherwise the last used subdomain will be used by <code>op</code>.</li> <li>This lookup can perform an initial login by providing <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-subdomain"><span class="std std-ref">subdomain</span></a></strong></code>, <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-username"><span class="std std-ref">username</span></a></strong></code>, <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-secret-key"><span class="std std-ref">secret_key</span></a></strong></code>, and <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-master-password"><span class="std std-ref">master_password</span></a></strong></code>.</li> <li>Can target a specific account by providing the <code><strong><a class="reference internal" href="#ansible-collections-community-general-onepassword-doc-lookup-parameter-account-id"><span class="std std-ref">account_id</span></a></strong></code>.</li> <li>Due to the <strong>very</strong> sensitive nature of these credentials, it is <strong>highly</strong> recommended that you only pass in the minimal credentials needed at any given time. Also, store these credentials in an Ansible Vault using a key that is equal to or greater in strength to the 1Password master password.</li> <li>This lookup stores potentially sensitive data from 1Password as Ansible facts. Facts are subject to caching if enabled, which means this data could be stored in clear text on disk or in a database.</li> <li>Tested with <code>op</code> version 2.7.2.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Retrieve a private key from 1Password
  ansible.builtin.debug:
    var: lookup('community.general.onepassword_doc', 'Private key')
</pre> </section> <section id="return-value"> <h2>Return Value</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-onepassword-doc-lookup-return-raw"><strong>Return value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Requested document</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Sam Doran (@samdoran)</li> </ul> <div class="admonition hint"> <p class="admonition-title">Hint</p> <p>Configuration entries for each entry type have a low to high priority order. For example, a variable that is lower in the list will override a variable that is higher up.</p> </div> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://forum.ansible.com/c/help/6/none" rel="noopener external" target="_blank">Ask for help</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=bug_report.yml" rel="noopener external" target="_blank">Submit a bug report</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=feature_request.yml" rel="noopener external" target="_blank">Request a feature</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-community-general"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/onepassword_doc_lookup.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/general/onepassword_doc_lookup.html</a>
  </p>
</div>
