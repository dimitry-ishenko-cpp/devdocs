<section id="community-general-ldap-entry-module-add-or-remove-ldap-entries"> <h1>community.general.ldap_entry module – Add or remove LDAP entries</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/general/">community.general collection</a> (version 9.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.general.ldap_entry</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#attributes" id="id4">Attributes</a></li> <li><a class="reference internal" href="#notes" id="id5">Notes</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Add or remove LDAP entries. This module only asserts the existence or non-existence of an LDAP entry, not its attributes. To assert the attribute values of an entry, see <a class="reference internal" href="ldap_attrs_module.html#ansible-collections-community-general-ldap-attrs-module"><span class="std std-ref">community.general.ldap_attrs</span></a>.</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-general-ldap-entry-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>python-ldap</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-attributes"><strong>attributes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-state"><span class="std std-ref">state=present</span></a></code>, attributes necessary to create an entry. Existing entries are never modified. To assert specific attribute values on an existing entry, use <a class="reference internal" href="ldap_attrs_module.html#ansible-collections-community-general-ldap-attrs-module"><span class="std std-ref">community.general.ldap_attrs</span></a> module instead.</p> <p>Each attribute value can be a string for single-valued attributes or a list of strings for multi-valued attributes.</p> <p>If you specify values for this option in YAML, please note that you can improve readability for long string values by using YAML block modifiers as seen in the examples for this module.</p> <p>Note that when using values that YAML/ansible-core interprets as other types, like <code>yes</code>, <code>no</code> (booleans), or <code>2.10</code> (float), make sure to quote them if these are meant to be strings. Otherwise the wrong values may be sent to LDAP.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>{}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-bind-dn"><strong>bind_dn</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A DN to bind with. If this is omitted, we’ll try a SASL bind with the EXTERNAL mechanism as default.</p> <p>If this is blank, we’ll use an anonymous bind.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-bind-pw"><strong>bind_pw</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The password to use with <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-bind-dn"><span class="std std-ref">bind_dn</span></a></strong></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>""</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-ca-path"><strong>ca_path</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> <p><em class="ansible-option-versionadded">added in community.general 6.5.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Set the path to PEM file with CA certs.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-client-cert"><strong>client_cert</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> <p><em class="ansible-option-versionadded">added in community.general 7.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>PEM formatted certificate chain file to be used for SSL client authentication.</p> <p>Required if <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-client-key"><span class="std std-ref">client_key</span></a></strong></code> is defined.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-client-key"><strong>client_key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">path</span></p> <p><em class="ansible-option-versionadded">added in community.general 7.1.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>PEM formatted file that contains your private key to be used for SSL client authentication.</p> <p>Required if <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-client-cert"><span class="std std-ref">client_cert</span></a></strong></code> is defined.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-dn"><strong>dn</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The DN of the entry to add or remove.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-objectclass"><strong>objectClass</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-state"><span class="std std-ref">state=present</span></a></code>, value or list of values to use when creating the entry. It can either be a string or an actual list of strings.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-recursive"><strong>recursive</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in community.general 4.6.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-state"><span class="std std-ref">state=delete</span></a></code>, a flag indicating whether a single entry or the whole branch must be deleted.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-referrals-chasing"><strong>referrals_chasing</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.general 2.0.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Set the referrals chasing behavior.</p> <p><code>anonymous</code> follow referrals anonymously. This is the default behavior.</p> <p><code>disabled</code> disable referrals chasing. This sets <code>OPT_REFERRALS</code> to off.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"disabled"</code></li> <li>
<code><strong>"anonymous"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-sasl-class"><strong>sasl_class</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.general 2.0.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>The class to use for SASL authentication.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"external"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"gssapi"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-server-uri"><strong>server_uri</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-server-uri"><span class="std std-ref">server_uri</span></a></strong></code> parameter may be a comma- or whitespace-separated list of URIs containing only the schema, the host, and the port fields.</p> <p>The default value lets the underlying LDAP client library look for a UNIX domain socket in its default location.</p> <p>Note that when using multiple URIs you cannot determine to which URI your client gets connected.</p> <p>For URIs containing additional fields, particularly when using commas, behavior is undefined.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"ldapi:///"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-start-tls"><strong>start_tls</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If true, we’ll use the START_TLS LDAP extension.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The target state of the entry.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"absent"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-validate-certs"><strong>validate_certs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If set to <code>false</code>, SSL certificates will not be validated.</p> <p>This should only be used on sites using self-signed certificates.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-parameter-xorder-discovery"><strong>xorder_discovery</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.general 6.4.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Set the behavior on how to process Xordered DNs.</p> <p><code>enable</code> will perform a <code>ONELEVEL</code> search below the superior RDN to find the matching DN.</p> <p><code>disable</code> will always use the DN unmodified (as passed by the <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-dn"><span class="std std-ref">dn</span></a></strong></code> parameter).</p> <p><code>auto</code> will only perform a search if the first RDN does not contain an index number (<code>{x}</code>).</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"enable"</code></li> <li>
<code><strong>"auto"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"disable"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="attributes"> <h2>Attributes</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Attribute</p></th> <th class="head"><p>Support</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-attribute-check-mode"><strong>check_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-full">full</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Can run in <code>check_mode</code> and return changed status prediction without modifying target.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-ldap-entry-module-attribute-diff-mode"><strong>diff_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Will return details on what has changed (or possibly needs changing in <code>check_mode</code>), when in diff mode.</p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>The default authentication settings will attempt to use a SASL EXTERNAL bind over a UNIX domain socket. This works well with the default Ubuntu install for example, which includes a cn=peercred,cn=external,cn=auth ACL rule allowing root to modify the server configuration. If you need to use a simple bind to access your server, pass the credentials in <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-bind-dn"><span class="std std-ref">bind_dn</span></a></strong></code> and <code><strong><a class="reference internal" href="#ansible-collections-community-general-ldap-entry-module-parameter-bind-pw"><span class="std std-ref">bind_pw</span></a></strong></code>.</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Make sure we have a parent entry for users
  community.general.ldap_entry:
    dn: ou=users,dc=example,dc=com
    objectClass: organizationalUnit

- name: Make sure we have an admin user
  community.general.ldap_entry:
    dn: cn=admin,dc=example,dc=com
    objectClass:
      - simpleSecurityObject
      - organizationalRole
    attributes:
      description: An LDAP administrator
      userPassword: "{SSHA}tabyipcHzhwESzRaGA7oQ/SDoBZQOGND"

- name: Set possible values for attributes elements
  community.general.ldap_entry:
    dn: cn=admin,dc=example,dc=com
    objectClass:
      - simpleSecurityObject
      - organizationalRole
    attributes:
      description: An LDAP Administrator
      roleOccupant:
      - cn=Chocs Puddington,ou=Information Technology,dc=example,dc=com
      - cn=Alice Stronginthebrain,ou=Information Technology,dc=example,dc=com
      olcAccess:
      - &gt;-
        {0}to attrs=userPassword,shadowLastChange
        by self write
        by anonymous auth
        by dn="cn=admin,dc=example,dc=com" write
        by * none'
      - &gt;-
        {1}to dn.base="dc=example,dc=com"
        by dn="cn=admin,dc=example,dc=com" write
        by * read

- name: Get rid of an old entry
  community.general.ldap_entry:
    dn: ou=stuff,dc=example,dc=com
    state: absent
    server_uri: ldap://localhost/
    bind_dn: cn=admin,dc=example,dc=com
    bind_pw: password

#
# The same as in the previous example but with the authentication details
# stored in the ldap_auth variable:
#
# ldap_auth:
#   server_uri: ldap://localhost/
#   bind_dn: cn=admin,dc=example,dc=com
#   bind_pw: password
#
# In the example below, 'args' is a task keyword, passed at the same level as the module
- name: Get rid of an old entry
  community.general.ldap_entry:
    dn: ou=stuff,dc=example,dc=com
    state: absent
  args: "{{ ldap_auth }}"
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Jiri Tyr (@jtyr)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://forum.ansible.com/c/help/6/none" rel="noopener external" target="_blank">Ask for help</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=bug_report.yml" rel="noopener external" target="_blank">Submit a bug report</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=feature_request.yml" rel="noopener external" target="_blank">Request a feature</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-community-general"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/ldap_entry_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/general/ldap_entry_module.html</a>
  </p>
</div>
