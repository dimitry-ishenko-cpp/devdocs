<h1 id="community-general-redis-various-redis-commands-replica-and-flush">community.general.redis – Various redis commands, replica and flush</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/general">community.general collection</a> (version 3.8.1).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>.</p> <p>To use it in a playbook, specify: <code>community.general.redis</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id5">See Also</a></li> <li><a class="reference internal" href="#examples" id="id6">Examples</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Unified utility to interact with redis instances.</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>redis</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>command</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>config</li> <li>flush</li> <li>replica</li> <li>slave</li> </ul> </td> <td> <div>The selected redis command</div> <div>
<code>config</code> ensures a configuration setting on an instance.</div> <div>
<code>flush</code> flushes all the instance or a specified db.</div> <div>
<code>replica</code> sets a redis instance in replica or master mode. (<code>slave</code> is an alias for <code>replica</code>.)</div> </td> </tr> <tr> <td colspan="1">  <b>db</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The database to flush (used in db mode) [flush command]</div> </td> </tr> <tr> <td colspan="1">  <b>flush_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>all</b> ←</div></li> <li>db</li> </ul> </td> <td> <div>Type of flush (all the dbs in a redis instance or a specific one) [flush command]</div> </td> </tr> <tr> <td colspan="1">  <b>login_host</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"localhost"</div> </td> <td> <div>The host running the database</div> </td> </tr> <tr> <td colspan="1">  <b>login_password</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The password used to authenticate with (usually not used)</div> </td> </tr> <tr> <td colspan="1">  <b>login_port</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>6379</div> </td> <td> <div>The port to connect to</div> </td> </tr> <tr> <td colspan="1">  <b>master_host</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The host of the master instance [replica command]</div> </td> </tr> <tr> <td colspan="1">  <b>master_port</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>The port of the master instance [replica command]</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A redis config key.</div> </td> </tr> <tr> <td colspan="1">  <b>replica_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>master</li> <li><div>
<b>replica</b> ←</div></li> <li>slave</li> </ul> </td> <td> <div>The mode of the redis instance [replica command]</div> <div>
<code>slave</code> is an alias for <code>replica</code>.</div> <div>
<br>aliases: slave_mode</div> </td> </tr> <tr> <td colspan="1">  <b>value</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>A redis config value. When memory size is needed, it is possible to specify it in the usal form of 1KB, 2M, 400MB where the base is 1024. Units are case insensitive i.e. 1m = 1mb = 1M = 1MB.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Requires the redis-py Python package on the remote host. You can install it with pip (pip install redis) or with a package manager. <a class="reference external" href="https://github.com/andymccurdy/redis-py">https://github.com/andymccurdy/redis-py</a>
</li> <li>If the redis master instance we are making replica of is password protected this needs to be in the redis.conf in the masterauth variable</li> </ul> </div>   <h2 id="see-also">See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="redis_info_module.html#ansible-collections-community-general-redis-info-module"><span class="std std-ref">community.general.redis_info</span></a></dt>
<dd>
<p>The official documentation on the <strong>community.general.redis_info</strong> module.</p> </dd> </dl> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Set local redis instance to be a replica of melee.island on port 6377
  community.general.redis:
    command: replica
    master_host: melee.island
    master_port: 6377

- name: Deactivate replica mode
  community.general.redis:
    command: replica
    replica_mode: master

- name: Flush all the redis db
  community.general.redis:
    command: flush
    flush_mode: all

- name: Flush only one db in a redis instance
  community.general.redis:
    command: flush
    db: 1
    flush_mode: db

- name: Configure local redis to have 10000 max clients
  community.general.redis:
    command: config
    name: maxclients
    value: 10000

- name: Configure local redis maxmemory to 4GB
  community.general.redis:
    command: config
    name: maxmemory
    value: 4GB

- name: Configure local redis to have lua time limit of 100 ms
  community.general.redis:
    command: config
    name: lua-time-limit
    value: 100
</pre>  <h3 id="authors">Authors</h3> <ul class="simple"> <li>Xabier Larrakoetxea (@slok)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/redis_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/general/redis_module.html</a>
  </p>
</div>
