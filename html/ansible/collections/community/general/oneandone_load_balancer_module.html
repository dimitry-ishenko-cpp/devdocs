<h1 id="community-general-oneandone-load-balancer-configure-1-1-load-balancer">community.general.oneandone_load_balancer – Configure 1&amp;1 load balancer.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/community/general">community.general collection</a> (version 3.8.1).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>.</p> <p>To use it in a playbook, specify: <code>community.general.oneandone_load_balancer</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id5">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Create, remove, update load balancers. This module has a dependency on 1and1 &gt;= 1.0</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>1and1</li> <li>python &gt;= 2.6</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="1">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="1">  <b>add_rules</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of rules that will be added to an existing load balancer. It is syntax is the same as the one used for rules parameter. Used in combination with update state.</div> </td> </tr> <tr> <td colspan="1">  <b>add_server_ips</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of server identifiers (id or name) to be assigned to a load balancer. Used in combination with update state.</div> </td> </tr> <tr> <td colspan="1">  <b>api_url</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Custom API URL. Overrides the ONEANDONE_API_URL environment variable.</div> </td> </tr> <tr> <td colspan="1">  <b>auth_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Authenticating API token provided by 1&amp;1.</div> </td> </tr> <tr> <td colspan="1">  <b>datacenter</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>US</li> <li>ES</li> <li>DE</li> <li>GB</li> </ul> </td> <td> <div>ID or country code of the datacenter where the load balancer will be created.</div> <div>If not specified, it defaults to <em>US</em>.</div> </td> </tr> <tr> <td colspan="1">  <b>description</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Description of the load balancer. maxLength=256</div> </td> </tr> <tr> <td colspan="1">  <b>health_check_interval</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Health check period in seconds. minimum=5, maximum=300, multipleOf=1</div> </td> </tr> <tr> <td colspan="1">  <b>health_check_parse</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Regular expression to check. Required for HTTP health check. maxLength=64</div> </td> </tr> <tr> <td colspan="1">  <b>health_check_path</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Url to call for checking. Required for HTTP health check. maxLength=1000</div> </td> </tr> <tr> <td colspan="1">  <b>health_check_test</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>NONE</li> <li>TCP</li> <li>HTTP</li> <li>ICMP</li> </ul> </td> <td> <div>Type of the health check. At the moment, HTTP is not allowed.</div> </td> </tr> <tr> <td colspan="1">  <b>load_balancer</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The identifier (id or name) of the load balancer used with update state.</div> </td> </tr> <tr> <td colspan="1">  <b>method</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>ROUND_ROBIN</li> <li>LEAST_CONNECTIONS</li> </ul> </td> <td> <div>Balancing procedure.</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Load balancer name used with present state. Used as identifier (id or name) when used with absent state. maxLength=128</div> </td> </tr> <tr> <td colspan="1">  <b>persistence</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Persistence.</div> </td> </tr> <tr> <td colspan="1">  <b>persistence_time</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Persistence time in seconds. Required if persistence is enabled. minimum=30, maximum=1200, multipleOf=1</div> </td> </tr> <tr> <td colspan="1">  <b>remove_rules</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of rule ids that will be removed from an existing load balancer. Used in combination with update state.</div> </td> </tr> <tr> <td colspan="1">  <b>remove_server_ips</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>A list of server IP ids to be unassigned from a load balancer. Used in combination with update state.</div> </td> </tr> <tr> <td colspan="1">  <b>rules</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>A list of rule objects that will be set for the load balancer. Each rule must contain protocol, port_balancer, and port_server parameters, in addition to source parameter, which is optional.</div> </td> </tr> <tr> <td colspan="1">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>present</b> ←</div></li> <li>absent</li> <li>update</li> </ul> </td> <td> <div>Define a load balancer state to create, remove, or update.</div> </td> </tr> <tr> <td colspan="1">  <b>wait</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>wait for the instance to be in state 'running' before returning</div> </td> </tr> <tr> <td colspan="1">  <b>wait_interval</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>5</div> </td> <td> <div>Defines the number of seconds to wait when using the _wait_for methods</div> </td> </tr> <tr> <td colspan="1">  <b>wait_timeout</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>600</div> </td> <td> <div>how long before wait gives up, in seconds</div> </td> </tr> </table> <br>  <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Create a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    name: ansible load balancer
    description: Testing creation of load balancer with ansible
    health_check_test: TCP
    health_check_interval: 40
    persistence: true
    persistence_time: 1200
    method: ROUND_ROBIN
    datacenter: US
    rules:
     -
       protocol: TCP
       port_balancer: 80
       port_server: 80
       source: 0.0.0.0
    wait: true
    wait_timeout: 500

- name: Destroy a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    name: ansible load balancer
    wait: true
    wait_timeout: 500
    state: absent

- name: Update a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    load_balancer: ansible load balancer
    name: ansible load balancer updated
    description: Testing the update of a load balancer with ansible
    wait: true
    wait_timeout: 500
    state: update

- name: Add server to a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    load_balancer: ansible load balancer updated
    description: Adding server to a load balancer with ansible
    add_server_ips:
     - server identifier (id or name)
    wait: true
    wait_timeout: 500
    state: update

- name: Remove server from a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    load_balancer: ansible load balancer updated
    description: Removing server from a load balancer with ansible
    remove_server_ips:
     - B2504878540DBC5F7634EB00A07C1EBD (server's ip id)
    wait: true
    wait_timeout: 500
    state: update

- name: Add rules to a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    load_balancer: ansible load balancer updated
    description: Adding rules to a load balancer with ansible
    add_rules:
     -
       protocol: TCP
       port_balancer: 70
       port_server: 70
       source: 0.0.0.0
     -
       protocol: TCP
       port_balancer: 60
       port_server: 60
       source: 0.0.0.0
    wait: true
    wait_timeout: 500
    state: update

- name: Remove rules from a load balancer
  community.general.oneandone_load_balancer:
    auth_token: oneandone_private_api_key
    load_balancer: ansible load balancer updated
    description: Adding rules to a load balancer with ansible
    remove_rules:
     - rule_id #1
     - rule_id #2
     - ...
    wait: true
    wait_timeout: 500
    state: update
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>load_balancer</b>  <div> <span>dictionary</span> </div> </td> <td>always</td> <td> <div>Information about the load balancer that was processed</div> <br> <div><b>Sample:</b></div> <div>{"id": "92B74394A397ECC3359825C1656D67A6", "name": "Default Balancer"}</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Amel Ajdinovic (@aajdinov)</li> <li>Ethan Devenport (@edevenport)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/oneandone_load_balancer_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/general/oneandone_load_balancer_module.html</a>
  </p>
</div>
