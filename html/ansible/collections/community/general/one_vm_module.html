<section id="community-general-one-vm-module-creates-or-terminates-opennebula-instances"> <h1>community.general.one_vm module – Creates or terminates OpenNebula instances</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/general/">community.general collection</a> (version 9.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.general</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-community-general-one-vm-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>community.general.one_vm</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#attributes" id="id4">Attributes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Manages OpenNebula instances</li> </ul> </section> <section id="requirements"> <h2 id="ansible-collections-community-general-one-vm-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>pyone</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-api-password"><strong>api_password</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Password of the user to login into OpenNebula RPC server. If not set then the value of the <a class="reference internal" href="../../environment_variables.html#envvar-ONE_PASSWORD"><code>ONE_PASSWORD</code></a> environment variable is used. if both <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-api-username"><span class="std std-ref">api_username</span></a></strong></code> or <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-api-password"><span class="std std-ref">api_password</span></a></strong></code> are not set, then it will try authenticate with ONE auth file. Default path is “~/.one/one_auth”.</p> <p>Set environment variable <a class="reference internal" href="../../environment_variables.html#envvar-ONE_AUTH"><code>ONE_AUTH</code></a> to override this path.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-api-url"><strong>api_url</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>URL of the OpenNebula RPC server.</p> <p>It is recommended to use HTTPS so that the username/password are not transferred over the network unencrypted.</p> <p>If not set then the value of the <a class="reference internal" href="../../environment_variables.html#envvar-ONE_URL"><code>ONE_URL</code></a> environment variable is used.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-api-username"><strong>api_username</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of the user to login into the OpenNebula RPC server. If not set then the value of the <a class="reference internal" href="../../environment_variables.html#envvar-ONE_USERNAME"><code>ONE_USERNAME</code></a> environment variable is used.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-attributes"><strong>attributes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A dictionary of key/value attributes to add to new instances, or for setting <code>state</code> of instances with these attributes.</p> <p>Keys are case insensitive and OpenNebula automatically converts them to upper case.</p> <p>Be aware <code>NAME</code> is a special attribute which sets the name of the VM when it’s deployed.</p> <p><code>#</code> character(s) can be appended to the <code>NAME</code> and the module will automatically add indexes to the names of VMs.</p> <p>For example’:’ <code>NAME':' foo-###</code> would create VMs with names <code>foo-000</code>, <code>foo-001</code>,…</p> <p>When used with <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-count-attributes"><span class="std std-ref">count_attributes</span></a></strong></code> and <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-exact-count"><span class="std std-ref">exact_count</span></a></strong></code> the module will match the base name without the index part.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>{}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-count"><strong>count</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Number of instances to launch</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>1</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-count-attributes"><strong>count_attributes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A dictionary of key/value attributes that can only be used with <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-exact-count"><span class="std std-ref">exact_count</span></a></strong></code> to determine how many nodes based on a specific attributes criteria should be deployed. This can be expressed in multiple ways and is shown in the EXAMPLES section.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-count-labels"><strong>count_labels</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of labels that can only be used with <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-exact-count"><span class="std std-ref">exact_count</span></a></strong></code> to determine how many nodes based on a specific labels criteria should be deployed. This can be expressed in multiple ways and is shown in the EXAMPLES section.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-cpu"><strong>cpu</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Percentage of CPU divided by 100 required for the new instance. Half a processor is written 0.5.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-datastore-id"><strong>datastore_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in community.general 0.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of Datastore to use to create a new instance</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-datastore-name"><strong>datastore_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in community.general 0.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of Datastore to use to create a new instance</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-disk-saveas"><strong>disk_saveas</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Creates an image from a VM disk.</p> <p>It is a dictionary where you have to specify <code>name</code> of the new image.</p> <p>Optionally you can specify <code>disk_id</code> of the disk you want to save. By default <code>disk_id</code> is 0.</p> <p><strong>NOTE:</strong> This operation will only be performed on the first VM (if more than one VM ID is passed) and the VM has to be in the <code>poweredoff</code> state.</p> <p>Also this operation will fail if an image with specified <code>name</code> already exists.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-disk-size"><strong>disk_size</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The size of the disk created for new instances (in MB, GB, TB,…).</p> <p><strong>NOTE:</strong> If The Template hats Multiple Disks the Order of the Sizes is matched against the order specified in <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-template-id"><span class="std std-ref">template_id</span></a></strong></code>/<code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-template-name"><span class="std std-ref">template_name</span></a></strong></code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-exact-count"><strong>exact_count</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Indicates how many instances that match <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-count-attributes"><span class="std std-ref">count_attributes</span></a></strong></code> and <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-count-labels"><span class="std std-ref">count_labels</span></a></strong></code> parameters should be deployed. Instances are either created or terminated based on this value.</p> <p><strong>NOTE:</strong> Instances with the least IDs will be terminated first.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-group-id"><strong>group_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>ID of the group which will be set as the group of the instance</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-hard"><strong>hard</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Reboot, power-off or terminate instances <code>hard</code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell">  
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-instance-ids"><strong id="ansible-collections-community-general-one-vm-module-parameter-ids">instance_ids</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-aliases">aliases: ids</span></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of instance ids used for states: <code>absent</code>, <code>running</code>, <code>rebooted</code>, <code>poweredoff</code>.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-labels"><strong>labels</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of labels to associate with new instances, or for setting <code>state</code> of instances with these labels.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-memory"><strong>memory</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The size of the memory for new instances (in MB, GB, …)</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-mode"><strong>mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Set permission mode of the instance in octet format, for example <code>0600</code> to give owner <code>use</code> and <code>manage</code> and nothing to group and others.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-networks"><strong>networks</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of dictionaries with network parameters. See examples for more details.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-owner-id"><strong>owner_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>ID of the user which will be set as the owner of the instance</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-persistent"><strong>persistent</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in community.general 0.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Create a private persistent copy of the template plus any image defined in DISK, and instantiate that copy.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p><code>present</code> - create instances from a template specified with <code>template_id</code>/<code>template_name</code>.</p> <p><code>running</code> - run instances</p> <p><code>poweredoff</code> - power-off instances</p> <p><code>rebooted</code> - reboot instances</p> <p><code>absent</code> - terminate instances</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"present"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"absent"</code></li> <li><code>"running"</code></li> <li><code>"rebooted"</code></li> <li><code>"poweredoff"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-template-id"><strong>template_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>ID of a VM template to use to create a new instance</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-template-name"><strong>template_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Name of VM template to use to create a new instance</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-updateconf"><strong>updateconf</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> <p><em class="ansible-option-versionadded">added in community.general 6.3.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>When <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-instance-ids"><span class="std std-ref">instance_ids</span></a></strong></code> is provided, updates running VMs with the <code>updateconf</code> API call.</p> <p>When new VMs are being created, emulates the <code>updateconf</code> API call via direct template merge.</p> <p>Allows for complete modifications of the <code>CONTEXT</code> attribute.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-vcpu"><strong>vcpu</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Number of CPUs (cores) new VM will have.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-vm-start-on-hold"><strong>vm_start_on_hold</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Set to true to put vm on hold while creating</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-wait"><strong>wait</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Wait for the instance to reach its desired state before returning. Keep in mind if you are waiting for instance to be in running state it doesn’t mean that you will be able to SSH on that machine only that boot process have started on that instance, see ‘wait_for’ example for details.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-parameter-wait-timeout"><strong>wait_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>How long before wait gives up, in seconds</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>300</code></p> </div></td> </tr>  </table> </section> <section id="attributes"> <h2>Attributes</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Attribute</p></th> <th class="head"><p>Support</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-attribute-check-mode"><strong>check_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-full">full</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Can run in <code>check_mode</code> and return changed status prediction without modifying target.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-attribute-diff-mode"><strong>diff_mode</strong></p> 
</div></td> <td><div class="ansible-option-cell">
<p><strong class="ansible-attribute-support-label">Support: </strong><strong class="ansible-attribute-support-none">none</strong></p> </div></td> <td><div class="ansible-option-cell">
<p>Will return details on what has changed (or possibly needs changing in <code>check_mode</code>), when in diff mode.</p> </div></td> </tr>  </table> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Create a new instance
  community.general.one_vm:
    template_id: 90
  register: result

- name: Print VM properties
  ansible.builtin.debug:
    msg: result

- name: Deploy a new VM on hold
  community.general.one_vm:
    template_name: 'app1_template'
    vm_start_on_hold: 'True'

- name: Deploy a new VM and set its name to 'foo'
  community.general.one_vm:
    template_name: 'app1_template'
    attributes:
      name: foo

- name: Deploy a new VM and set its group_id and mode
  community.general.one_vm:
    template_id: 90
    group_id: 16
    mode: 660

- name: Deploy a new VM  as persistent
  community.general.one_vm:
    template_id: 90
    persistent: true

- name: Change VM's permissions to 640
  community.general.one_vm:
    instance_ids: 5
    mode: 640

- name: Deploy 2 new instances and set memory, vcpu, disk_size and 3 networks
  community.general.one_vm:
    template_id: 15
    disk_size: 35.2 GB
    memory: 4 GB
    vcpu: 4
    count: 2
    networks:
      - NETWORK_ID: 27
      - NETWORK: "default-network"
        NETWORK_UNAME: "app-user"
        SECURITY_GROUPS: "120,124"
      - NETWORK_ID: 27
        SECURITY_GROUPS: "10"

- name: Deploy a new instance which uses a Template with two Disks
  community.general.one_vm:
    template_id: 42
    disk_size:
      - 35.2 GB
      - 50 GB
    memory: 4 GB
    vcpu: 4
    count: 1
    networks:
      - NETWORK_ID: 27

- name: "Deploy an new instance with attribute 'bar: bar1' and set its name to 'foo'"
  community.general.one_vm:
    template_id: 53
    attributes:
      name: foo
      bar: bar1

- name: "Enforce that 2 instances with attributes 'foo1: app1' and 'foo2: app2' are deployed"
  community.general.one_vm:
    template_id: 53
    attributes:
      foo1: app1
      foo2: app2
    exact_count: 2
    count_attributes:
      foo1: app1
      foo2: app2

- name: Enforce that 4 instances with an attribute 'bar' are deployed
  community.general.one_vm:
    template_id: 53
    attributes:
      name: app
      bar: bar2
    exact_count: 4
    count_attributes:
      bar:

# Deploy 2 new instances with attribute 'foo: bar' and labels 'app1' and 'app2' and names in format 'fooapp-##'
# Names will be: fooapp-00 and fooapp-01
- name: Deploy 2 new instances
  community.general.one_vm:
    template_id: 53
    attributes:
      name: fooapp-##
      foo: bar
    labels:
      - app1
      - app2
    count: 2

# Deploy 2 new instances with attribute 'app: app1' and names in format 'fooapp-###'
# Names will be: fooapp-002 and fooapp-003
- name: Deploy 2 new instances
  community.general.one_vm:
    template_id: 53
    attributes:
      name: fooapp-###
      app: app1
    count: 2

# Reboot all instances with name in format 'fooapp-#'
# Instances 'fooapp-00', 'fooapp-01', 'fooapp-002' and 'fooapp-003' will be rebooted
- name: Reboot all instances with names in a certain format
  community.general.one_vm:
    attributes:
      name: fooapp-#
    state: rebooted

# Enforce that only 1 instance with name in format 'fooapp-#' is deployed
# The task will delete oldest instances, so only the 'fooapp-003' will remain
- name: Enforce that only 1 instance with name in a certain format is deployed
  community.general.one_vm:
    template_id: 53
    exact_count: 1
    count_attributes:
      name: fooapp-#

- name: Deploy an new instance with a network
  community.general.one_vm:
    template_id: 53
    networks:
      - NETWORK_ID: 27
  register: vm

- name: Wait for SSH to come up
  ansible.builtin.wait_for_connection:
  delegate_to: '{{ vm.instances[0].networks[0].ip }}'

- name: Terminate VMs by ids
  community.general.one_vm:
    instance_ids:
      - 153
      - 160
    state: absent

- name: Reboot all VMs that have labels 'foo' and 'app1'
  community.general.one_vm:
    labels:
      - foo
      - app1
    state: rebooted

- name: "Fetch all VMs that have name 'foo' and attribute 'app: bar'"
  community.general.one_vm:
    attributes:
      name: foo
      app: bar
  register: results

- name: Deploy 2 new instances with labels 'foo1' and 'foo2'
  community.general.one_vm:
    template_name: app_template
    labels:
      - foo1
      - foo2
    count: 2

- name: Enforce that only 1 instance with label 'foo1' will be running
  community.general.one_vm:
    template_name: app_template
    labels:
      - foo1
    exact_count: 1
    count_labels:
      - foo1

- name: Terminate all instances that have attribute foo
  community.general.one_vm:
    template_id: 53
    exact_count: 0
    count_attributes:
      foo:

- name: "Power-off the VM and save VM's disk with id=0 to the image with name 'foo-image'"
  community.general.one_vm:
    instance_ids: 351
    state: poweredoff
    disk_saveas:
      name: foo-image

- name: "Save VM's disk with id=1 to the image with name 'bar-image'"
  community.general.one_vm:
    instance_ids: 351
    disk_saveas:
      name: bar-image
      disk_id: 1

- name: "Deploy 2 new instances with a custom 'start script'"
  community.general.one_vm:
    template_name: app_template
    count: 2
    updateconf:
      CONTEXT:
        START_SCRIPT: ip r r 169.254.16.86/32 dev eth0

- name: "Add a custom 'start script' to a running VM"
  community.general.one_vm:
    instance_ids: 351
    updateconf:
      CONTEXT:
        START_SCRIPT: ip r r 169.254.16.86/32 dev eth0

- name: "Update SSH public keys inside the VM's context"
  community.general.one_vm:
    instance_ids: 351
    updateconf:
      CONTEXT:
        SSH_PUBLIC_KEY: |-
          ssh-rsa ...
          ssh-ed25519 ...
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances"><strong>instances</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">complex</span></p> </div></td> <td><div class="ansible-option-cell">
<p>a list of instances info whose state is changed or which are fetched with <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-instance-ids"><span class="std std-ref">instance_ids</span></a></strong></code> option.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-attributes"><strong>attributes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A dictionary of key/values attributes that are associated with the instance</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"HYPERVISOR": "kvm", "LOGO": "images/logos/centos.png", "TE_GALAXY": "bar", "USER_INPUTS": null}</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-cpu"><strong>cpu</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Percentage of CPU divided by 100</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>0.2</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-disk-size"><strong>disk_size</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The size of the disk in MB</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"20480 MB"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-group-id"><strong>group_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s group id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>1</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-group-name"><strong>group_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s group name</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"one-users"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-labels"><strong>labels</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A list of string labels that are associated with the instance</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["foo", "spec-label"]</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-lcm-state"><strong>lcm_state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>lcm state of an instance that is only relevant when the state is ACTIVE</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"RUNNING"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-memory"><strong>memory</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The size of the memory in MB</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"4096 MB"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-mode"><strong>mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s mode</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"660"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-networks"><strong>networks</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>a list of dictionaries with info about IP, NAME, MAC, SECURITY_GROUPS for each NIC</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>[{"ip": "10.120.5.33", "mac": "02:00:0a:78:05:21", "name": "default-test-private", "security_groups": "0,10"}, {"ip": "10.120.5.34", "mac": "02:00:0a:78:05:22", "name": "default-test-private", "security_groups": "0"}]</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-owner-id"><strong>owner_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s owner id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>143</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-owner-name"><strong>owner_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s owner name</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"app-user"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>state of an instance</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"ACTIVE"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-template-id"><strong>template_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s template id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>153</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-updateconf"><strong>updateconf</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> <p><em class="ansible-option-versionadded">added in community.general 6.3.0</em></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A dictionary of key/values attributes that are set with the updateconf API call.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"CONTEXT": {"SSH_PUBLIC_KEY": "ssh-rsa ...\nssh-ed25519 ...", "START_SCRIPT": "ip r r 169.254.16.86/32 dev eth0"}, "OS": {"ARCH": "x86_64"}}</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-uptime-h"><strong>uptime_h</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Uptime of the instance in hours</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>35</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-vcpu"><strong>vcpu</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Number of CPUs (cores)</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>2</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-vm-id"><strong>vm_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>153</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-vm-name"><strong>vm_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm name</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"foo"</code></p> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-instances-ids"><strong>instances_ids</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>a list of instances ids whose state is changed or which are fetched with <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-instance-ids"><span class="std std-ref">instance_ids</span></a></strong></code> option.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>[1234, 1235]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances"><strong>tagged_instances</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">complex</span></p> </div></td> <td><div class="ansible-option-cell">
<p>A list of instances info based on a specific attributes and/or</p> <p>labels that are specified with <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-count-attributes"><span class="std std-ref">count_attributes</span></a></strong></code> and <code><strong><a class="reference internal" href="#ansible-collections-community-general-one-vm-module-parameter-count-labels"><span class="std std-ref">count_labels</span></a></strong></code></p> <p>options.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-attributes"><strong>attributes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A dictionary of key/values attributes that are associated with the instance</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"HYPERVISOR": "kvm", "LOGO": "images/logos/centos.png", "TE_GALAXY": "bar", "USER_INPUTS": null}</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-cpu"><strong>cpu</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">float</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Percentage of CPU divided by 100</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>0.2</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-disk-size"><strong>disk_size</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The size of the disk in MB</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["20480 MB", "10240 MB"]</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-group-id"><strong>group_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s group id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>1</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-group-name"><strong>group_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s group name</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"one-users"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-labels"><strong>labels</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A list of string labels that are associated with the instance</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["foo", "spec-label"]</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-lcm-state"><strong>lcm_state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>lcm state of an instance that is only relevant when the state is ACTIVE</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"RUNNING"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-memory"><strong>memory</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The size of the memory in MB</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"4096 MB"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-mode"><strong>mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s mode</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"660"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-networks"><strong>networks</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>a list of dictionaries with info about IP, NAME, MAC, SECURITY_GROUPS for each NIC</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>[{"ip": "10.120.5.33", "mac": "02:00:0a:78:05:21", "name": "default-test-private", "security_groups": "0,10"}, {"ip": "10.120.5.34", "mac": "02:00:0a:78:05:22", "name": "default-test-private", "security_groups": "0"}]</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-owner-id"><strong>owner_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s user id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>143</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-owner-name"><strong>owner_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s user name</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"app-user"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>state of an instance</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"ACTIVE"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-template-id"><strong>template_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm’s template id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>153</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-updateconf"><strong>updateconf</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> <p><em class="ansible-option-versionadded">added in community.general 6.3.0</em></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A dictionary of key/values attributes that are set with the updateconf API call</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>{"CONTEXT": {"SSH_PUBLIC_KEY": "ssh-rsa ...\nssh-ed25519 ...", "START_SCRIPT": "ip r r 169.254.16.86/32 dev eth0"}, "OS": {"ARCH": "x86_64"}}</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-uptime-h"><strong>uptime_h</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Uptime of the instance in hours</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>35</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-vcpu"><strong>vcpu</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Number of CPUs (cores)</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>2</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-vm-id"><strong>vm_id</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm id</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>153</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-general-one-vm-module-return-tagged-instances-vm-name"><strong>vm_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>vm name</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"foo"</code></p> </div>
</td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Milan Ilic (@ilicmilan)</li> <li>Jan Meerkamp (@meerkampdvv)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://forum.ansible.com/c/help/6/none" rel="noopener external" target="_blank">Ask for help</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=bug_report.yml" rel="noopener external" target="_blank">Submit a bug report</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.general/issues/new?assignees=&amp;labels=&amp;template=feature_request.yml" rel="noopener external" target="_blank">Request a feature</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-community-general"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/general/one_vm_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/general/one_vm_module.html</a>
  </p>
</div>
