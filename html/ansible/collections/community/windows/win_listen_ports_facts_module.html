<section id="community-windows-win-listen-ports-facts-module-recopilates-the-facts-of-the-listening-ports-of-the-machine"> <h1>community.windows.win_listen_ports_facts module – Recopilates the facts of the listening ports of the machine</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/community/windows/">community.windows collection</a> (version 2.3.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install community.windows</code>.</p> <p>To use it in a playbook, specify: <code>community.windows.win_listen_ports_facts</code>.</p> </div> <p class="ansible-version-added">New in community.windows 1.10.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#see-also" id="id4">See Also</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Recopilates the information of the TCP and UDP ports of the machine and the related processes.</li> <li>State of the TCP ports could be filtered, as well as the format of the date when the parent process was launched.</li> <li>The module’s goal is to replicate the functionality of the linux module listen_ports_facts, mantaining the format of the said module.</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-listen-ports-facts-module-parameter-date-format"><strong>date_format</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The format of the date when the process that owns the port started.</p> <p>The date specification is UFormat</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"%c"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-listen-ports-facts-module-parameter-tcp-filter"><strong>tcp_filter</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Filter for the state of the TCP ports that will be recopilated.</p> <p>Supports multiple states (Bound, Closed, CloseWait, Closing, DeleteTCB, Established, FinWait1, FinWait2, LastAck, Listen, SynReceived, SynSent and TimeWait), that can be used alone or combined. Note that the Bound state is only available on PowerShell version 4.0 or later.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>["Listen"]</code></p> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>The generated data (tcp_listen and udp_listen) and the fields within follows the listen_ports_facts schema to achieve compatibility with the said module output, even though this module if capable of extracting ports with a state other than Listen</li> </ul> </div> </section> <section id="see-also"> <h2>See Also</h2> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="../general/listen_ports_facts_module.html#ansible-collections-community-general-listen-ports-facts-module"><span class="std std-ref">community.general.listen_ports_facts</span></a></dt>
<dd>
<p>Gather facts on processes listening on TCP and UDP ports.</p> </dd> </dl> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja">- name: Recopilate ports facts
  community.windows.win_listen_ports_facts:

- name: Retrieve only ports with Closing and Established states
  community.windows.win_listen_ports_facts:
    tcp_filter:
      - Closing
      - Established

- name: Get ports facts with only the year within the date field
  community.windows.win_listen_ports_facts:
    date_format: '%Y'
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-listen-ports-facts-module-return-tcp-listen"><strong>tcp_listen</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of dicts with the detected TCP ports</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>[{"address": "127.0.0.1", "name": "python", "pid": 5332, "port": 82, "protocol": "tcp", "stime": "Thu Nov 18 15:27:42 2021", "user": "SERVER\\Administrator"}]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-community-windows-win-listen-ports-facts-module-return-udp-listen"><strong>udp_listen</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of dicts with the detected UDP ports</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> success</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>[{"address": "127.0.0.1", "name": "python", "pid": 5332, "port": 82, "protocol": "udp", "stime": "Thu Nov 18 15:27:42 2021", "user": "SERVER\\Administrator"}]</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>David Nieto (@david-ns)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.windows/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/community.windows" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> <li><span><a class="reference internal" href="index.html#communication-for-community-windows"><span class="std std-ref">Communication</span></a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/community/windows/win_listen_ports_facts_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/community/windows/win_listen_ports_facts_module.html</a>
  </p>
</div>
