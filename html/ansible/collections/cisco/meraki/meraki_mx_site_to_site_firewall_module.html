<h1 id="cisco-meraki-meraki-mx-site-to-site-firewall-manage-mx-appliance-firewall-rules-for-site-to-site-vpns">cisco.meraki.meraki_mx_site_to_site_firewall – Manage MX appliance firewall rules for site-to-site VPNs</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/cisco/meraki">cisco.meraki collection</a> (version 2.5.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install cisco.meraki</code>.</p> <p>To use it in a playbook, specify: <code>cisco.meraki.meraki_mx_site_to_site_firewall</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 1.0.0: </span>of cisco.meraki</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id3">Notes</a></li> <li><a class="reference internal" href="#examples" id="id4">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id5">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>Allows for creation, management, and visibility into firewall rules for site-to-site VPNs implemented on Meraki MX firewalls.</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="2">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="2">  <b>auth_key</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Authentication key provided by the dashboard. Required if environmental variable <code>MERAKI_KEY</code> is not set.</div> </td> </tr> <tr> <td colspan="2">  <b>host</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"api.meraki.com"</div> </td> <td> <div>Hostname for Meraki dashboard.</div> <div>Can be used to access regional Meraki environments, such as China.</div> </td> </tr> <tr> <td colspan="2">  <b>internal_error_retry_time</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>60</div> </td> <td> <div>Number of seconds to retry if server returns an internal server error.</div> </td> </tr> <tr> <td colspan="2">  <b>org_id</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>ID of organization.</div> </td> </tr> <tr> <td colspan="2">  <b>org_name</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Name of organization.</div> <div>
<br>aliases: organization</div> </td> </tr> <tr> <td colspan="2">  <b>output_format</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>snakecase</b> ←</div></li> <li>camelcase</li> </ul> </td> <td> <div>Instructs module whether response keys should be snake case (ex. <code>net_id</code>) or camel case (ex. <code>netId</code>).</div> </td> </tr> <tr> <td colspan="2">  <b>output_level</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>debug</li> <li><div>
<b>normal</b> ←</div></li> </ul> </td> <td> <div>Set amount of debug output during module execution.</div> </td> </tr> <tr> <td colspan="2">  <b>rate_limit_retry_time</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>165</div> </td> <td> <div>Number of seconds to retry if rate limiter is triggered.</div> </td> </tr> <tr> <td colspan="2">  <b>rules</b>  <div> <span>list</span> / <span>elements=dictionary</span> </div> </td> <td> </td> <td> <div>List of firewall rules.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>comment</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Optional comment to describe the firewall rule.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dest_cidr</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Comma separated list of CIDR notation destination networks.</div> <div>
<code>Any</code> must be capitalized.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>dest_port</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Comma separated list of destination port numbers to match against.</div> <div>
<code>Any</code> must be capitalized.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>policy</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>deny</li> </ul> </td> <td> <div>Policy to apply if rule is hit.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>protocol</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>any</li> <li>icmp</li> <li>tcp</li> <li>udp</li> </ul> </td> <td> <div>Protocol to match against.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>src_cidr</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Comma separated list of CIDR notation source networks.</div> <div>
<code>Any</code> must be capitalized.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>src_port</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Comma separated list of source port numbers to match against.</div> <div>
<code>Any</code> must be capitalized.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="1">  <b>syslog_enabled</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Whether to log hints against the firewall rule.</div> <div>Only applicable if a syslog server is specified against the network.</div> </td> </tr> <tr> <td colspan="2">  <b>state</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>present</b> ←</div></li> <li>query</li> </ul> </td> <td> <div>Create or modify an organization.</div> </td> </tr> <tr> <td colspan="2">  <b>syslog_default_rule</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li>yes</li> </ul> </td> <td> <div>Whether to log hits against the default firewall rule.</div> <div>Only applicable if a syslog server is specified against the network.</div> <div>This is not shown in response from Meraki. Instead, refer to the <code>syslog_enabled</code> value in the default rule.</div> </td> </tr> <tr> <td colspan="2">  <b>timeout</b>  <div> <span>integer</span> </div> </td> <td> <b>Default:</b><br><div>30</div> </td> <td> <div>Time to timeout for HTTP requests.</div> </td> </tr> <tr> <td colspan="2">  <b>use_https</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>If <code>no</code>, it will use HTTP. Otherwise it will use HTTPS.</div> <div>Only useful for internal Meraki developers.</div> </td> </tr> <tr> <td colspan="2">  <b>use_proxy</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>If <code>no</code>, it will not use a proxy, even if one is defined in an environment variable on the target hosts.</div> </td> </tr> <tr> <td colspan="2">  <b>validate_certs</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>no</li> <li><div>
<b>yes</b> ←</div></li> </ul> </td> <td> <div>Whether to validate HTTP certificates.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Module assumes a complete list of firewall rules are passed as a parameter.</li> <li>More information about the Meraki API can be found at <a class="reference external" href="https://dashboard.meraki.com/api_docs">https://dashboard.meraki.com/api_docs</a>.</li> <li>Some of the options are likely only used for developers within Meraki.</li> <li>As of Ansible 2.9, Meraki modules output keys as snake case. To use camel case, set the <code>ANSIBLE_MERAKI_FORMAT</code> environment variable to <code>camelcase</code>.</li> <li>Ansible’s Meraki modules will stop supporting camel case output in Ansible 2.13. Please update your playbooks.</li> <li>Check Mode downloads the current configuration from the dashboard, then compares changes against this download. Check Mode will report changed if there are differences in the configurations, but does not submit changes to the API for validation of change.</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- name: Query firewall rules
  meraki_mx_site_to_site_firewall:
    auth_key: abc123
    org_name: YourOrg
    state: query
  delegate_to: localhost

- name: Set two firewall rules
  meraki_mx_site_to_site_firewall:
    auth_key: abc123
    org_name: YourOrg
    state: present
    rules:
      - comment: Block traffic to server
        src_cidr: 192.0.1.0/24
        src_port: any
        dest_cidr: 192.0.2.2/32
        dest_port: any
        protocol: any
        policy: deny
      - comment: Allow traffic to group of servers
        src_cidr: 192.0.1.0/24
        src_port: any
        dest_cidr: 192.0.2.0/24
        dest_port: any
        protocol: any
        policy: permit
  delegate_to: localhost

- name: Set one firewall rule and enable logging of the default rule
  meraki_mx_site_to_site_firewall:
    auth_key: abc123
    org_name: YourOrg
    state: present
    rules:
      - comment: Block traffic to server
        src_cidr: 192.0.1.0/24
        src_port: any
        dest_cidr: 192.0.2.2/32
        dest_port: any
        protocol: any
        policy: deny
    syslog_default_rule: yes
  delegate_to: localhost
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="3">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="3">  <b>data</b>  <div> <span>complex</span> </div> </td> <td>success</td> <td> <div>Firewall rules associated to network.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td colspan="2">  <b>rules</b>  <div> <span>complex</span> </div> </td> <td>success</td> <td> <div>List of firewall rules associated to network.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>comment</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Comment to describe the firewall rule.</div> <br> <div><b>Sample:</b></div> <div>Block traffic to server</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>dest_cidr</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Comma separated list of CIDR notation destination networks.</div> <br> <div><b>Sample:</b></div> <div>192.0.1.1/32,192.0.1.2/32</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>dest_port</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Comma separated list of destination ports.</div> <br> <div><b>Sample:</b></div> <div>80,443</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>policy</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Action to take when rule is matched.</div> <br> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>protocol</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Network protocol for which to match against.</div> <br> <div><b>Sample:</b></div> <div>tcp</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>src_cidr</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Comma separated list of CIDR notation source networks.</div> <br> <div><b>Sample:</b></div> <div>192.0.1.1/32,192.0.1.2/32</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>src_port</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Comma separated list of source ports.</div> <br> <div><b>Sample:</b></div> <div>80,443</div> </td> </tr> <tr> <td class="elbow-placeholder"> </td> <td class="elbow-placeholder"> </td> <td colspan="1">  <b>syslog_enabled</b>  <div> <span>boolean</span> </div> </td> <td>always</td> <td> <div>Whether to log to syslog when rule is matched.</div> <br> <div><b>Sample:</b></div> <div>True</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Kevin Breit (@kbreit)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/cisco/meraki/meraki_mx_site_to_site_firewall_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/cisco/meraki/meraki_mx_site_to_site_firewall_module.html</a>
  </p>
</div>
