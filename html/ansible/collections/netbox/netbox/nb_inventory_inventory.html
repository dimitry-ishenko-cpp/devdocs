<section id="netbox-netbox-nb-inventory-inventory-netbox-inventory-source"> <h1>netbox.netbox.nb_inventory inventory – NetBox inventory source</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This inventory plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/netbox/netbox/">netbox.netbox collection</a> (version 3.20.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install netbox.netbox</code>.</p> <p>To use it in a playbook, specify: <code>netbox.netbox.nb_inventory</code>.</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#parameters" id="id2">Parameters</a></li> <li><a class="reference internal" href="#examples" id="id3">Examples</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>Get inventory hosts from NetBox</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-ansible-host-dns-name"><strong>ansible_host_dns_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, sets DNS Name (fetched from primary_ip) to be used in ansible_host variable, instead of IP Address.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-api-endpoint"><strong>api_endpoint</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Endpoint of the NetBox API</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-NETBOX_API" id="index-0"><code>NETBOX_API</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-ca-path"><strong>ca_path</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>CA path</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-cache"><strong>cache</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Toggle to enable/disable the caching of the inventory’s source data, requires a cache plugin setup to work.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[inventory]
cache = false
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_INVENTORY_CACHE" id="index-1"><code>ANSIBLE_INVENTORY_CACHE</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-cache-connection"><strong>cache_connection</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Cache connection data or path, read cache plugin documentation for specifics.</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
fact_caching_connection = VALUE
</pre> <pre data-language="YAML+Jinja">[inventory]
cache_connection = VALUE
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_CACHE_PLUGIN_CONNECTION" id="index-2"><code>ANSIBLE_CACHE_PLUGIN_CONNECTION</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_INVENTORY_CACHE_CONNECTION" id="index-3"><code>ANSIBLE_INVENTORY_CACHE_CONNECTION</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-cache-plugin"><strong>cache_plugin</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Cache plugin to use for the inventory’s source data.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"memory"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
fact_caching = memory
</pre> <pre data-language="YAML+Jinja">[inventory]
cache_plugin = memory
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_CACHE_PLUGIN" id="index-4"><code>ANSIBLE_CACHE_PLUGIN</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_INVENTORY_CACHE_PLUGIN" id="index-5"><code>ANSIBLE_INVENTORY_CACHE_PLUGIN</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-cache-prefix"><strong>cache_prefix</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Prefix to use for cache plugin files/tables</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"ansible_inventory_"</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
fact_caching_prefix = ansible_inventory_
</pre> <pre data-language="YAML+Jinja">[inventory]
cache_prefix = ansible_inventory_
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_CACHE_PLUGIN_PREFIX" id="index-6"><code>ANSIBLE_CACHE_PLUGIN_PREFIX</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_INVENTORY_CACHE_PLUGIN_PREFIX" id="index-7"><code>ANSIBLE_INVENTORY_CACHE_PLUGIN_PREFIX</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-cache-timeout"><strong>cache_timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Cache duration in seconds</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>3600</code></p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entries:</p> <pre data-language="YAML+Jinja">[defaults]
fact_caching_timeout = 3600
</pre> <pre data-language="YAML+Jinja">[inventory]
cache_timeout = 3600
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_CACHE_PLUGIN_TIMEOUT" id="index-8"><code>ANSIBLE_CACHE_PLUGIN_TIMEOUT</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../../reference_appendices/config.html#envvar-ANSIBLE_INVENTORY_CACHE_TIMEOUT" id="index-9"><code>ANSIBLE_INVENTORY_CACHE_TIMEOUT</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-cert"><strong>cert</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Certificate path</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-compose"><strong>compose</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of custom ansible host vars to create from the device object fetched from NetBox</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>{}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-config-context"><strong>config_context</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, it adds config_context in host vars.</p> <p>Config-context enables the association of arbitrary data to devices and virtual machines grouped by region, site, role, platform, and/or tenant. Please check official netbox docs for more info.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-device-query-filters"><strong>device_query_filters</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of parameters passed to the query string for devices (Multiple values may be separated by commas).</p> <p>You can also use Jinja2 templates.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-dns-name"><strong>dns_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Force IP Addresses to be fetched so that the dns_name for the primary_ip of each device or VM is set as a host_var.</p> <p>Setting interfaces will also fetch IP addresses and the dns_name host_var will be set.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-fetch-all"><strong>fetch_all</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.1</em></p> </div></td> <td><div class="ansible-option-cell">
<p>By default, fetching interfaces and services will get all of the contents of NetBox regardless of query_filters applied to devices and VMs.</p> <p>When set to False, separate requests will be made fetching interfaces, services, and IP addresses for each device_id and virtual_machine_id.</p> <p>If you are using the various query_filters options to reduce the number of devices, you may find querying NetBox faster with fetch_all set to False.</p> <p>For efficiency, when False, these requests will be batched, for example /api/dcim/interfaces?limit=0&amp;device_id=1&amp;device_id=2&amp;device_id=3</p> <p>These GET request URIs can become quite large for a large number of devices. If you run into HTTP 414 errors, you can adjust the max_uri_length option to suit your web server.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-flatten-config-context"><strong>flatten_config_context</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.1</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If <em>config_context</em> is enabled, by default it’s added as a host var named config_context.</p> <p>If flatten_config_context is set to True, the config context variables will be added directly to the host instead.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-flatten-custom-fields"><strong>flatten_custom_fields</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.1</em></p> </div></td> <td><div class="ansible-option-cell">
<p>By default, host custom fields are added as a dictionary host var named custom_fields.</p> <p>If flatten_custom_fields is set to True, the fields will be added directly to the host instead.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-flatten-local-context-data"><strong>flatten_local_context_data</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.3.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If <em>local_context_data</em> is enabled, by default it’s added as a host var named local_context_data.</p> <p>If flatten_local_context_data is set to True, the config context variables will be added directly to the host instead.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-follow-redirects"><strong>follow_redirects</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Determine how redirects are followed.</p> <p>By default, <em>follow_redirects</em> is set to uses urllib2 default behavior.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"urllib2"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"all"</code></li> <li><code>"yes"</code></li> <li><code>"safe"</code></li> <li><code>"none"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-group-by"><strong>group_by</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Keys used to create groups. The <em>plurals</em> and <em>racks</em> options control which of these are valid.</p> <p><em>rack_group</em> is supported on NetBox versions 2.10 or lower only</p> <p><em>location</em> is supported on NetBox versions 2.11 or higher only</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"sites"</code></li> <li><code>"site"</code></li> <li><code>"location"</code></li> <li><code>"tenants"</code></li> <li><code>"tenant"</code></li> <li><code>"racks"</code></li> <li><code>"rack"</code></li> <li><code>"rack_group"</code></li> <li><code>"rack_role"</code></li> <li><code>"tags"</code></li> <li><code>"tag"</code></li> <li><code>"device_roles"</code></li> <li><code>"role"</code></li> <li><code>"device_types"</code></li> <li><code>"device_type"</code></li> <li><code>"manufacturers"</code></li> <li><code>"manufacturer"</code></li> <li><code>"platforms"</code></li> <li><code>"platform"</code></li> <li><code>"region"</code></li> <li><code>"site_group"</code></li> <li><code>"cluster"</code></li> <li><code>"cluster_type"</code></li> <li><code>"cluster_group"</code></li> <li><code>"is_virtual"</code></li> <li><code>"services"</code></li> <li><code>"status"</code></li> <li><code>"time_zone"</code></li> <li><code>"utc_offset"</code></li> <li><code>"facility"</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-group-names-raw"><strong>group_names_raw</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Will not add the group_by choice name to the group names</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-groups"><strong>groups</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Add hosts to group based on Jinja2 conditionals.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>{}</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-hostname-field"><strong>hostname_field</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>By default, the inventory hostname is the netbox device name</p> <p>If set, sets the inventory hostname from this field in custom_fields instead</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-interfaces"><strong>interfaces</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.1.7</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, it adds the device or virtual machine interface information in host vars.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-key"><strong>key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Certificate key path</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>false</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups"><strong>keyed_groups</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Add hosts to group based on the values of a variable.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-default-value"><strong>default_value</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.12</em></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The default value when the host variable’s value is an empty string.</p> <p>This option is mutually exclusive with <code><strong><a class="reference internal" href="#ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-trailing-separator"><span class="std std-ref">keyed_groups[].trailing_separator</span></a></strong></code>.</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-key"><strong>key</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>The key from input dictionary used to generate groups</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-parent-group"><strong>parent_group</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>parent group for keyed group</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-prefix"><strong>prefix</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>A keyed group name will start with this prefix</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>""</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-separator"><strong>separator</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>separator used to build the keyed group name</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>"_"</code></p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-trailing-separator"><strong>trailing_separator</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.12</em></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Set this option to <code>False</code> to omit the <code><strong><a class="reference internal" href="#ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-separator"><span class="std std-ref">keyed_groups[].separator</span></a></strong></code> after the host variable when the value is an empty string.</p> <p>This option is mutually exclusive with <code><strong><a class="reference internal" href="#ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-keyed-groups-default-value"><span class="std std-ref">keyed_groups[].default_value</span></a></strong></code>.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-leading-separator"><strong>leading_separator</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.11</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Use in conjunction with keyed_groups.</p> <p>By default, a keyed group that does not have a prefix or a separator provided will have a name that starts with an underscore.</p> <p>This is because the default prefix is “” and the default separator is “_”.</p> <p>Set this option to False to omit the leading underscore (or other separator) if no prefix is given.</p> <p>If the group name is derived from a mapping the separator is still used to concatenate the items.</p> <p>To not use a separator in the group name at all, set the separator for the keyed group to an empty string instead.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-max-uri-length"><strong>max_uri_length</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.1</em></p> </div></td> <td><div class="ansible-option-cell">
<p>When fetch_all is False, GET requests to NetBox may become quite long and return a HTTP 414 (URI Too Long).</p> <p>You can adjust this option to be smaller to avoid 414 errors, or larger for a reduced number of requests.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>4000</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-oob-ip-as-primary-ip"><strong>oob_ip_as_primary_ip</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Use out of band IP as `ansible host`</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-plugin"><strong>plugin</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span> / <span class="ansible-option-required">required</span></p> </div></td> <td><div class="ansible-option-cell">
<p>token that ensures this is a source file for the ‘netbox’ plugin.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"netbox.netbox.nb_inventory"</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-plurals"><strong>plurals</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.1</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, all host vars are contained inside single-element arrays for legacy compatibility with old versions of this plugin.</p> <p>Group names will be plural (ie. “sites_mysite” instead of “site_mysite”)</p> <p>The choices of <em>group_by</em> will be changed by this option.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-prefixes"><strong>prefixes</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 3.5.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, it adds the device or virtual machine prefixes to hostvars nested under “site”.</p> <p>Must match selection for “site_data”, as this changes the structure of “site” in hostvars</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-query-filters"><strong>query_filters</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of parameters passed to the query string for both devices and VMs (Multiple values may be separated by commas).</p> <p>You can also use Jinja2 templates.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-racks"><strong>racks</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 3.6.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If False, skip querying the racks for information, which can be slow with great amounts of racks.</p> <p>The choices of <em>group_by</em> will be changed by this option.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-rename-variables"><strong>rename_variables</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Rename variables evaluated by nb_inventory, before writing them.</p> <p>Each list entry contains a dict with a ‘pattern’ and a ‘repl’.</p> <p>Both ‘pattern’ and ‘repl’ are regular expressions.</p> <p>The first matching expression is used, subsequent matches are ignored.</p> <p>Internally `re.sub` is used.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-services"><strong>services</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 0.2.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, it adds the device or virtual machine services information in host vars.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-site-data"><strong>site_data</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 3.5.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, sites’ full data structures returned from Netbox API are included in host vars.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-strict"><strong>strict</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>If <code>yes</code> make invalid entries a fatal error, otherwise skip and continue.</p> <p>Since it is possible to use facts in the expressions they might not always be available and we ignore those errors by default.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-timeout"><strong>timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Timeout for NetBox requests in seconds</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>60</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-token"><strong>token</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>NetBox API token to be able to read against NetBox.</p> <p>This may not be required depending on the NetBox setup.</p> <p>You can provide a “type” and “value” for a token if your NetBox deployment is using a more advanced authentication like OAUTH.</p> <p>If you do not provide a “type” and “value” parameter, the HTTP authorization header will be set to “Token”, which is the NetBox default</p> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul class="simple"> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-NETBOX_TOKEN" id="index-10"><code>NETBOX_TOKEN</code></a>
</li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-NETBOX_API_KEY" id="index-11"><code>NETBOX_API_KEY</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-use-extra-vars"><strong>use_extra_vars</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in ansible-core 2.11</em></p> </div></td> <td><div class="ansible-option-cell">
<p>Merge extra vars into the available variables for composition (highest precedence).</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> <p class="ansible-option-line"><strong class="ansible-option-configuration">Configuration:</strong></p> <ul> <li>
<p>INI entry:</p> <pre data-language="YAML+Jinja">[inventory_plugins]
use_extra_vars = false
</pre> </li> <li>Environment variable: <a class="reference internal" href="../../environment_variables.html#envvar-ANSIBLE_INVENTORY_USE_EXTRA_VARS" id="index-12"><code>ANSIBLE_INVENTORY_USE_EXTRA_VARS</code></a>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-validate-certs"><strong>validate_certs</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Allows connection when SSL certificates are not valid. Set to <code>false</code> when certificates are not trusted.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li>
<code><strong>true</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-virtual-chassis-name"><strong>virtual_chassis_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div></td> <td><div class="ansible-option-cell">
<p>When a device is part of a virtual chassis, use the virtual chassis name as the Ansible inventory hostname.</p> <p>The host var values will be from the virtual chassis master.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-virtual-disks"><strong>virtual_disks</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> <p><em class="ansible-option-versionadded">added in netbox.netbox 3.18.0</em></p> </div></td> <td><div class="ansible-option-cell">
<p>If True, it adds the virtual disks information in host vars.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>false</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>true</code></li> </ul> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-netbox-netbox-nb-inventory-inventory-parameter-vm-query-filters"><strong>vm_query_filters</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>List of parameters passed to the query string for VMs (Multiple values may be separated by commas).</p> <p>You can also use Jinja2 templates.</p> <p class="ansible-option-line"><strong class="ansible-option-default-bold">Default:</strong> <code>[]</code></p> </div></td> </tr>  </table> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># netbox_inventory.yml file in YAML format
# Example command line: ansible-inventory -v --list -i netbox_inventory.yml

plugin: netbox.netbox.nb_inventory
api_endpoint: http://localhost:8000
validate_certs: true
config_context: false
group_by:
  - device_roles
query_filters:
  - role: network-edge-router
device_query_filters:
  - has_primary_ip: 'true'
  - tenant__n: internal

# has_primary_ip is a useful way to filter out patch panels and other passive devices
# Adding '__n' to a field searches for the negation of the value.
# The above searches for devices that are NOT "tenant = internal"

# Query filters are passed directly as an argument to the fetching queries.
# You can repeat tags in the query string.

query_filters:
  - role: server
  - tag: web
  - tag: production

# See the NetBox documentation at https://netbox.readthedocs.io/en/stable/rest-api/overview/
# the query_filters work as a logical **OR**
#
# Prefix any custom fields with cf_ and pass the field value with the regular NetBox query string

query_filters:
  - cf_foo: bar

# NetBox inventory plugin also supports Constructable semantics
# You can fill your hosts vars using the compose option:

plugin: netbox.netbox.nb_inventory
compose:
  foo: last_updated
  bar: display_name
  nested_variable: rack.display_name

# You can use keyed_groups to group on properties of devices or VMs.
# NOTE: It's only possible to key off direct items on the device/VM objects.
plugin: netbox.netbox.nb_inventory
keyed_groups:
  - prefix: status
    key: status.value

# For use in Ansible Tower (AWX), please see this blog from RedHat: https://www.ansible.com/blog/using-an-inventory-plugin-from-a-collection-in-ansible-tower
# The credential for NetBox will need to expose NETBOX_API and NETBOX_TOKEN as environment variables.
# Example Ansible Tower credential Input Configuration:

fields:
  - id: NETBOX_API
    type: string
    label: NetBox Host URL
  - id: NETBOX_TOKEN
    type: string
    label: NetBox API Token
    secret: true
required:
  - NETBOX_API
  - NETBOX_TOKEN

# Example Ansible Tower credential Injector Configuration:

env:
  NETBOX_API: '{{ NETBOX_API }}'
  NETBOX_TOKEN: '{{ NETBOX_TOKEN }}'

# Example of time_zone and utc_offset usage

plugin: netbox.netbox.nb_inventory
api_endpoint: http://localhost:8000
token: &lt;insert token&gt;
validate_certs: true
config_context: true
group_by:
  - site
  - role
  - time_zone
  - utc_offset
device_query_filters:
  - has_primary_ip: 'true'
  - manufacturer_id: 1

# using group by time_zone, utc_offset it will group devices in ansible groups depending on time zone configured on site.
# time_zone gives grouping like:
# - "time_zone_Europe_Bucharest"
# - "time_zone_Europe_Copenhagen"
# - "time_zone_America_Denver"
# utc_offset gives grouping like:
# - "time_zone_utc_minus_7"
# - "time_zone_utc_plus_1"
# - "time_zone_utc_plus_10"

# Example of using a token type

plugin: netbox.netbox.nb_inventory
api_endpoint: http://localhost:8000
token:
  type: Bearer
  value: test123456
</pre> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Remy Leone (@sieben)</li> <li>Anthony Ruhier (@Anthony25)</li> <li>Nikhil Singh Baliyan (@nikkytub)</li> <li>Sander Steffann (@steffann)</li> <li>Douglas Heriot (@DouglasHeriot)</li> <li>Thore Knickrehm (@tkn2023)</li> </ul> <div class="admonition hint"> <p class="admonition-title">Hint</p> <p>Configuration entries for each entry type have a low to high priority order. For example, a variable that is lower in the list will override a variable that is higher up.</p> </div> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/netbox-community/ansible_modules/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/netbox-community/ansible_modules" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/netbox/netbox/nb_inventory_inventory.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/netbox/netbox/nb_inventory_inventory.html</a>
  </p>
</div>
