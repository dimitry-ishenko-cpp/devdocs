<h1 id="fortinet-fortios-fortios-system-np6-configure-np6-attributes-in-fortinet-s-fortios-and-fortigate">fortinet.fortios.fortios_system_np6 – Configure NP6 attributes in Fortinet’s FortiOS and FortiGate.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/fortinet/fortios">fortinet.fortios collection</a> (version 2.1.2).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install fortinet.fortios</code>.</p> <p>To use it in a playbook, specify: <code>fortinet.fortios.fortios_system_np6</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.10: </span>of fortinet.fortios</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify system feature and np6 category. Examples include all parameters and values need to be adjusted to datasources before usage. Tested with FOS v6.0.0</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>ansible&gt;=2.9.0</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="3">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="3">  <b>access_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Token-based authentication. Generated from GUI of Fortigate.</div> </td> </tr> <tr> <td colspan="3">  <b>enable_log</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Enable/Disable logging for task.</div> </td> </tr> <tr> <td colspan="3">  <b>state</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>present</li> <li>absent</li> </ul> </td> <td> <div>Indicates whether to create or remove the object.</div> </td> </tr> <tr> <td colspan="3">  <b>system_np6</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Configure NP6 attributes.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>fastpath</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable NP4 or NP6 offloading (also called fast path).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>fp_anomaly</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>NP6 IPv4 anomaly protection. trap-to-host forwards anomaly sessions to the CPU.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>icmp_csum_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Invalid IPv4 ICMP checksum anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>icmp_frag</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Layer 3 fragmented packets that could be part of layer 4 ICMP anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>icmp_land</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>ICMP land anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_csum_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Invalid IPv4 IP checksum anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_land</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Land anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_optlsrr</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Loose source record route option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_optrr</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Record route option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_optsecurity</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Security option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_optssrr</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Strict source record route option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_optstream</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Stream option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_opttimestamp</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Timestamp option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_proto_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Invalid layer 4 protocol anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv4_unknopt</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Unknown option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_daddr_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Destination address as unspecified or loopback address anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_land</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Land anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_optendpid</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>End point identification anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_opthomeaddr</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Home address option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_optinvld</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Invalid option anomalies.Invalid option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_optjumbo</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Jumbo options anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_optnsap</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Network service access point address option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_optralert</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Router alert option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_opttunnel</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Tunnel encapsulation limit option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_proto_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Layer 4 invalid protocol anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_saddr_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Source address as multicast anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ipv6_unknopt</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Unknown option anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_csum_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Invalid IPv4 TCP checksum anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_fin_noack</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP SYN flood with FIN flag set without ACK setting anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_fin_only</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP SYN flood with only FIN flag set anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_land</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP land anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_no_flag</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP SYN flood with no flag set anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_syn_data</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP SYN flood packets with data anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_syn_fin</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP SYN flood SYN/FIN flag set anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_winnuke</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>TCP WinNuke anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>udp_csum_err</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>Invalid IPv4 UDP checksum anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>udp_land</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>allow</li> <li>drop</li> <li>trap-to-host</li> </ul> </td> <td> <div>UDP land anomalies.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>garbage_session_collector</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable garbage session collector.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>hpe</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>HPE configuration.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>arp_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum ARP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>enable_shaper</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/Disable NPU host protection engine (HPE) shaper.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>esp_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum ESP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>icmp_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum ICMP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ip_frag_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum fragmented IP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>ip_others_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum IP packet rate for other packets (packet types that cannot be set with other options) (10G - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>l2_others_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum L2 packet rate for L2 packets that are not ARP packets (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>pri_type_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum overflow rate of priority type traffic(10K - 4G pps). Includes L2: HA, 802.3ad LACP, heartbeats. L3: OSPF. L4_TCP: BGP. L4_UDP: IKE, SLBC, BFD.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>sctp_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum SCTP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcp_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum TCP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcpfin_rst_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum TCP carries FIN or RST flags packet rate (1K - 1G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcpsyn_ack_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum TCP carries SYN and ACK flags packet rate (1K - 1G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>tcpsyn_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum TCP SYN packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>udp_max</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Maximum UDP packet rate (10K - 4G pps).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_ob_hash_function</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>global-hash</li> <li>round-robin-global</li> </ul> </td> <td> <div>Set hash function for IPSec outbound.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_outbound_hash</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable hash function for IPsec outbound traffic.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>low_latency_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable low latency mode.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>name</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Device Name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>per_session_accounting</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>traffic-log-only</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable per-session accounting.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>session_collector_interval</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Set garbage session collection cleanup interval (1 - 100 sec).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>session_timeout_fixed</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>{disable | enable} Toggle between using fixed or random timeouts for refreshing NP6 sessions.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>session_timeout_interval</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Set the fixed timeout for refreshing NP6 sessions (0 - 1000 sec).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>session_timeout_random_range</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Set the random timeout range for refreshing NP6 sessions (0 - 1000 sec).</div> </td> </tr> <tr> <td colspan="3">  <b>vdom</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"root"</div> </td> <td> <div>Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different unit.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Legacy fortiosapi has been deprecated, httpapi is the preferred way to run playbooks</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- hosts: fortigates
  collections:
    - fortinet.fortios
  connection: httpapi
  vars:
   vdom: "root"
   ansible_httpapi_use_ssl: yes
   ansible_httpapi_validate_certs: no
   ansible_httpapi_port: 443
  tasks:
  - name: Configure NP6 attributes.
    fortios_system_np6:
      vdom:  "{{ vdom }}"
      state: "present"
      access_token: "&lt;your_own_value&gt;"
      system_np6:
        fastpath: "disable"
        fp_anomaly:
            icmp_csum_err: "drop"
            icmp_frag: "allow"
            icmp_land: "allow"
            ipv4_csum_err: "drop"
            ipv4_land: "allow"
            ipv4_optlsrr: "allow"
            ipv4_optrr: "allow"
            ipv4_optsecurity: "allow"
            ipv4_optssrr: "allow"
            ipv4_optstream: "allow"
            ipv4_opttimestamp: "allow"
            ipv4_proto_err: "allow"
            ipv4_unknopt: "allow"
            ipv6_daddr_err: "allow"
            ipv6_land: "allow"
            ipv6_optendpid: "allow"
            ipv6_opthomeaddr: "allow"
            ipv6_optinvld: "allow"
            ipv6_optjumbo: "allow"
            ipv6_optnsap: "allow"
            ipv6_optralert: "allow"
            ipv6_opttunnel: "allow"
            ipv6_proto_err: "allow"
            ipv6_saddr_err: "allow"
            ipv6_unknopt: "allow"
            tcp_csum_err: "drop"
            tcp_fin_noack: "allow"
            tcp_fin_only: "allow"
            tcp_land: "allow"
            tcp_no_flag: "allow"
            tcp_syn_data: "allow"
            tcp_syn_fin: "allow"
            tcp_winnuke: "allow"
            udp_csum_err: "drop"
            udp_land: "allow"
        garbage_session_collector: "disable"
        hpe:
            arp_max: "42"
            enable_shaper: "disable"
            esp_max: "44"
            icmp_max: "45"
            ip_frag_max: "46"
            ip_others_max: "47"
            l2_others_max: "48"
            pri_type_max: "49"
            sctp_max: "50"
            tcp_max: "51"
            tcpfin_rst_max: "52"
            tcpsyn_ack_max: "53"
            tcpsyn_max: "54"
            udp_max: "55"
        ipsec_ob_hash_function: "global-hash"
        ipsec_outbound_hash: "disable"
        low_latency_mode: "disable"
        name: "default_name_59"
        per_session_accounting: "disable"
        session_collector_interval: "61"
        session_timeout_fixed: "disable"
        session_timeout_interval: "63"
        session_timeout_random_range: "64"
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>build</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Build number of the fortigate image</div> <br> <div><b>Sample:</b></div> <div>1547</div> </td> </tr> <tr> <td colspan="1">  <b>http_method</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Last method used to provision the content into FortiGate</div> <br> <div><b>Sample:</b></div> <div>PUT</div> </td> </tr> <tr> <td colspan="1">  <b>http_status</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Last result given by FortiGate on last operation applied</div> <br> <div><b>Sample:</b></div> <div>200</div> </td> </tr> <tr> <td colspan="1">  <b>mkey</b>  <div> <span>string</span> </div> </td> <td>success</td> <td> <div>Master key (id) used in the last call to FortiGate</div> <br> <div><b>Sample:</b></div> <div>id</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Name of the table used to fulfill the request</div> <br> <div><b>Sample:</b></div> <div>urlfilter</div> </td> </tr> <tr> <td colspan="1">  <b>path</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Path of the table used to fulfill the request</div> <br> <div><b>Sample:</b></div> <div>webfilter</div> </td> </tr> <tr> <td colspan="1">  <b>revision</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Internal revision number</div> <br> <div><b>Sample:</b></div> <div>17.0.2.10658</div> </td> </tr> <tr> <td colspan="1">  <b>serial</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Serial number of the unit</div> <br> <div><b>Sample:</b></div> <div>FGVMEVYYQT3AB5352</div> </td> </tr> <tr> <td colspan="1">  <b>status</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Indication of the operation's result</div> <br> <div><b>Sample:</b></div> <div>success</div> </td> </tr> <tr> <td colspan="1">  <b>vdom</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Virtual domain used</div> <br> <div><b>Sample:</b></div> <div>root</div> </td> </tr> <tr> <td colspan="1">  <b>version</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Version of the FortiGate</div> <br> <div><b>Sample:</b></div> <div>v5.6.3</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Link Zheng (@chillancezen)</li> <li>Jie Xue (@JieX19)</li> <li>Hongbin Lu (@fgtdev-hblu)</li> <li>Frank Shen (@frankshen01)</li> <li>Miguel Angel Munoz (@mamunozgonzalez)</li> <li>Nicolas Thomas (@thomnico)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/fortinet/fortios/fortios_system_np6_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/fortinet/fortios/fortios_system_np6_module.html</a>
  </p>
</div>
