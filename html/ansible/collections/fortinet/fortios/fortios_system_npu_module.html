<h1 id="fortinet-fortios-fortios-system-npu-configure-npu-attributes-in-fortinet-s-fortios-and-fortigate">fortinet.fortios.fortios_system_npu – Configure NPU attributes in Fortinet’s FortiOS and FortiGate.</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This plugin is part of the <a class="reference external" href="https://galaxy.ansible.com/fortinet/fortios">fortinet.fortios collection</a> (version 2.1.2).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install fortinet.fortios</code>.</p> <p>To use it in a playbook, specify: <code>fortinet.fortios.fortios_system_npu</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.10: </span>of fortinet.fortios</p> </div>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>   <h2 id="synopsis">Synopsis</h2> <ul class="simple"> <li>This module is able to configure a FortiGate or FortiOS (FOS) device by allowing the user to set and modify system feature and npu category. Examples include all parameters and values need to be adjusted to datasources before usage. Tested with FOS v6.0.0</li> </ul>   <h2 id="requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>ansible&gt;=2.9.0</li> </ul>   <h2 id="parameters">Parameters</h2> <table class="documentation-table"> <tr> <th colspan="3">Parameter</th> <th>Choices/Defaults</th> <th width="100%">Comments</th> </tr> <tr> <td colspan="3">  <b>access_token</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Token-based authentication. Generated from GUI of Fortigate.</div> </td> </tr> <tr> <td colspan="3">  <b>enable_log</b>  <div> <span>boolean</span> </div> </td> <td> <ul>
<b>Choices:</b> <li><div>
<b>no</b> ←</div></li> <li>yes</li> </ul> </td> <td> <div>Enable/Disable logging for task.</div> </td> </tr> <tr> <td colspan="3">  <b>system_npu</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Configure NPU attributes.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>capwap_offload</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable offloading managed FortiAP and FortiLink CAPWAP sessions.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>dedicated_management_cpu</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable to dedicate one CPU for GUI and CLI connections when NPs are busy.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>fastpath</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable NP6 offloading (also called fast path).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>gtp_enhanced_cpu_range</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>0</li> <li>1</li> <li>2</li> </ul> </td> <td> <div>GTP enhanced CPU range option.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>gtp_enhanced_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable GTP enhanced mode.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>intf_shaping_offload</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable NPU offload when doing interface-based traffic shaping according to the egress-shaping-profile.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_dec_subengine_mask</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>IPsec decryption subengine mask (0x1 - 0xff).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_enc_subengine_mask</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>IPsec encryption subengine mask (0x1 - 0xff).</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_inbound_cache</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable IPsec inbound cache for anti-replay.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_mtu_override</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable NP6 IPsec MTU override.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>ipsec_over_vlink</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable IPSEC over vlink.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>isf_np_queues</b>  <div> <span>dictionary</span> </div> </td> <td> </td> <td> <div>Configure queues of switch port connected to NP6 XAUI on ingress path.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos0</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 0. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos1</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 1. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos2</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 2. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos3</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 3. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos4</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 4. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos5</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 5. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos6</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 6. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cos7</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>CoS profile name for CoS 7. Source system.isf-queue-profile.name.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>lag_out_port_select</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable LAG outgoing port selection based on incoming traffic port.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>mcast_session_accounting</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>tpe-based</li> <li>session-based</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable traffic accounting for each multicast session through TAE counter.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>port_cpu_map</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Configure NPU interface to CPU core mapping.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>cpu_core</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>The CPU core to map to an interface.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interface</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>The interface to map to a CPU core.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>port_npu_map</b>  <div> <span>list</span> / <span>elements=string</span> </div> </td> <td> </td> <td> <div>Configure port to NPU group mapping.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>interface</b>  <div> <span>string</span> / <span>required</span> </div> </td> <td> </td> <td> <div>Set npu interface port to NPU group map.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>npu_group_index</b>  <div> <span>integer</span> </div> </td> <td> </td> <td> <div>Mapping NPU group index.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>priority_protocol</b>  <div> <span>string</span> </div> </td> <td> </td> <td> <div>Configure NPU priority protocol.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>bfd</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable NPU BFD priority protocol.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>bgp</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable NPU BGP priority protocol.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td class="elbow-placeholder"></td> <td colspan="1">  <b>slbc</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable NPU SLBC priority protocol.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>qos_mode</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>priority</li> <li>round-robin</li> </ul> </td> <td> <div>QoS mode on switch and NP.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>rdp_offload</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable rdp offload.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>session_denied_offload</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>disable</li> <li>enable</li> </ul> </td> <td> <div>Enable/disable offloading of denied sessions. Requires ses-denied-traffic to be set.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>sse_backpressure</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable sse backpressure.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>strip_clear_text_padding</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable stripping clear text padding.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>strip_esp_padding</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable stripping ESP padding.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>sw_np_bandwidth</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>0G</li> <li>2G</li> <li>4G</li> <li>5G</li> <li>6G</li> </ul> </td> <td> <div>Bandwidth from switch to NP.</div> </td> </tr> <tr> <td class="elbow-placeholder"></td> <td colspan="2">  <b>uesp_offload</b>  <div> <span>string</span> </div> </td> <td> <ul>
<b>Choices:</b> <li>enable</li> <li>disable</li> </ul> </td> <td> <div>Enable/disable UDP-encapsulated ESP offload .</div> </td> </tr> <tr> <td colspan="3">  <b>vdom</b>  <div> <span>string</span> </div> </td> <td> <b>Default:</b><br><div>"root"</div> </td> <td> <div>Virtual domain, among those defined previously. A vdom is a virtual instance of the FortiGate that can be configured and used as a different unit.</div> </td> </tr> </table> <br>  <h2 id="notes">Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>Legacy fortiosapi has been deprecated, httpapi is the preferred way to run playbooks</li> </ul> </div>   <h2 id="examples">Examples</h2> <pre data-language="yaml+jinja">- hosts: fortigates
  collections:
    - fortinet.fortios
  connection: httpapi
  vars:
   vdom: "root"
   ansible_httpapi_use_ssl: yes
   ansible_httpapi_validate_certs: no
   ansible_httpapi_port: 443
  tasks:
  - name: Configure NPU attributes.
    fortios_system_npu:
      vdom:  "{{ vdom }}"
      system_npu:
        capwap_offload: "enable"
        dedicated_management_cpu: "enable"
        fastpath: "disable"
        gtp_enhanced_cpu_range: "0"
        gtp_enhanced_mode: "enable"
        intf_shaping_offload: "enable"
        ipsec_dec_subengine_mask: "&lt;your_own_value&gt;"
        ipsec_enc_subengine_mask: "&lt;your_own_value&gt;"
        ipsec_inbound_cache: "enable"
        ipsec_mtu_override: "disable"
        ipsec_over_vlink: "enable"
        isf_np_queues:
            cos0: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos1: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos2: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos3: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos4: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos5: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos6: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
            cos7: "&lt;your_own_value&gt; (source system.isf-queue-profile.name)"
        lag_out_port_select: "disable"
        mcast_session_accounting: "tpe-based"
        port_cpu_map:
         -
            cpu_core: "&lt;your_own_value&gt;"
            interface: "&lt;your_own_value&gt;"
        port_npu_map:
         -
            interface: "&lt;your_own_value&gt;"
            npu_group_index: "30"
        priority_protocol:
            bfd: "enable"
            bgp: "enable"
            slbc: "enable"
        qos_mode: "disable"
        rdp_offload: "enable"
        session_denied_offload: "disable"
        sse_backpressure: "enable"
        strip_clear_text_padding: "enable"
        strip_esp_padding: "enable"
        sw_np_bandwidth: "0G"
        uesp_offload: "enable"
</pre>   <h2 id="return-values">Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="documentation-table"> <tr> <th colspan="1">Key</th> <th>Returned</th> <th width="100%">Description</th> </tr> <tr> <td colspan="1">  <b>build</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Build number of the fortigate image</div> <br> <div><b>Sample:</b></div> <div>1547</div> </td> </tr> <tr> <td colspan="1">  <b>http_method</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Last method used to provision the content into FortiGate</div> <br> <div><b>Sample:</b></div> <div>PUT</div> </td> </tr> <tr> <td colspan="1">  <b>http_status</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Last result given by FortiGate on last operation applied</div> <br> <div><b>Sample:</b></div> <div>200</div> </td> </tr> <tr> <td colspan="1">  <b>mkey</b>  <div> <span>string</span> </div> </td> <td>success</td> <td> <div>Master key (id) used in the last call to FortiGate</div> <br> <div><b>Sample:</b></div> <div>id</div> </td> </tr> <tr> <td colspan="1">  <b>name</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Name of the table used to fulfill the request</div> <br> <div><b>Sample:</b></div> <div>urlfilter</div> </td> </tr> <tr> <td colspan="1">  <b>path</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Path of the table used to fulfill the request</div> <br> <div><b>Sample:</b></div> <div>webfilter</div> </td> </tr> <tr> <td colspan="1">  <b>revision</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Internal revision number</div> <br> <div><b>Sample:</b></div> <div>17.0.2.10658</div> </td> </tr> <tr> <td colspan="1">  <b>serial</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Serial number of the unit</div> <br> <div><b>Sample:</b></div> <div>FGVMEVYYQT3AB5352</div> </td> </tr> <tr> <td colspan="1">  <b>status</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Indication of the operation's result</div> <br> <div><b>Sample:</b></div> <div>success</div> </td> </tr> <tr> <td colspan="1">  <b>vdom</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Virtual domain used</div> <br> <div><b>Sample:</b></div> <div>root</div> </td> </tr> <tr> <td colspan="1">  <b>version</b>  <div> <span>string</span> </div> </td> <td>always</td> <td> <div>Version of the FortiGate</div> <br> <div><b>Sample:</b></div> <div>v5.6.3</div> </td> </tr> </table> <br><br> <h3 id="authors">Authors</h3> <ul class="simple"> <li>Link Zheng (@chillancezen)</li> <li>Jie Xue (@JieX19)</li> <li>Hongbin Lu (@fgtdev-hblu)</li> <li>Frank Shen (@frankshen01)</li> <li>Miguel Angel Munoz (@mamunozgonzalez)</li> <li>Nicolas Thomas (@thomnico)</li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/fortinet/fortios/fortios_system_npu_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/fortinet/fortios/fortios_system_npu_module.html</a>
  </p>
</div>
