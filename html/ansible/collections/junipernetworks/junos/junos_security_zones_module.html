<section id="junipernetworks-junos-junos-security-zones-module-manage-security-zones-on-juniper-junos-devices"> <h1>junipernetworks.junos.junos_security_zones module – Manage security zones on Juniper JUNOS devices</h1> <div class="admonition note"> <p class="admonition-title">Note</p> <p>This module is part of the <a class="reference external" href="https://galaxy.ansible.com/ui/repo/published/junipernetworks/junos/">junipernetworks.junos collection</a> (version 8.0.0).</p> <p>You might already have this collection installed if you are using the <code>ansible</code> package. It is not included in <code>ansible-core</code>. To check whether it is installed, run <code>ansible-galaxy collection list</code>.</p> <p>To install it, use: <code>ansible-galaxy collection install junipernetworks.junos</code>. You need further requirements to be able to use this module, see <a class="reference internal" href="#ansible-collections-junipernetworks-junos-junos-security-zones-module-requirements"><span class="std std-ref">Requirements</span></a> for details.</p> <p>To use it in a playbook, specify: <code>junipernetworks.junos.junos_security_zones</code>.</p> </div> <p class="ansible-version-added">New in junipernetworks.junos 2.9.0</p>  <ul class="simple"> <li><a class="reference internal" href="#synopsis" id="id1">Synopsis</a></li> <li><a class="reference internal" href="#requirements" id="id2">Requirements</a></li> <li><a class="reference internal" href="#parameters" id="id3">Parameters</a></li> <li><a class="reference internal" href="#notes" id="id4">Notes</a></li> <li><a class="reference internal" href="#examples" id="id5">Examples</a></li> <li><a class="reference internal" href="#return-values" id="id6">Return Values</a></li> </ul>  <section id="synopsis"> <h2>Synopsis</h2> <ul class="simple"> <li>This module provides declarative management of security zones on Juniper JUNOS devices</li> </ul> <p>Aliases: security_zones</p> </section> <section id="requirements"> <h2 id="ansible-collections-junipernetworks-junos-junos-security-zones-module-requirements">Requirements</h2> <p>The below requirements are needed on the host that executes this module.</p> <ul class="simple"> <li>ncclient (&gt;=v0.6.4)</li> <li>xmltodict (&gt;=0.12.0)</li> </ul> </section> <section id="parameters"> <h2>Parameters</h2> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Parameter</p></th> <th class="head"><p>Comments</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config"><strong>config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Dictionary of security zone parameters</p> </div></td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management"><strong>functional_zone_management</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Functional zone to configure host for out of band management interfaces</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Text description of zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic"><strong>host_inbound_traffic</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Allowed system services &amp; protocols</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic-protocols"><strong>protocols</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Protocol type of incoming traffic to accept</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic-protocols-except"><strong>except</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Disallow the specified protocol traffic</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic-protocols-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Type of incoming protocol to accept</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic-system-services"><strong>system_services</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Type of incoming system-service traffic to accept</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic-system-services-except"><strong>except</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Disallow the specified incoming system-service traffic</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-host-inbound-traffic-system-services-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Type of incoming system-service traffic to accept</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-interfaces"><strong>interfaces</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Interfaces that are part of this zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-functional-zone-management-screen"><strong>screen</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Name of ids option object applied to the zone</p> </div>
</td> </tr> <tr>
<td>

<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones"><strong>zones</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>

<div class="ansible-option-cell">
<p>Security zones</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book"><strong>address_book</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Address book entries</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-address-sets"><strong>address_sets</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Define security address sets</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-address-sets-address-sets"><strong>address_sets</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Define an address-set name</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-address-sets-addresses"><strong>addresses</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Addresses to be included in this set</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-address-sets-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Text description of address set</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-address-sets-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Name of address set</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses"><strong>addresses</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Define security addresses</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Text description of address</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-dns-name"><strong>dns_name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>DNS address name</p> </div>
</td> </tr> <tr>
<td>





<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-dns-name-ipv4-only"><strong>ipv4_only</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>





<div class="ansible-option-cell">
<p>IPv4 dns address</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>





<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-dns-name-ipv6-only"><strong>ipv6_only</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>





<div class="ansible-option-cell">
<p>IPv6 dns address</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>





<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-dns-name-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>





<div class="ansible-option-cell">
<p>Fully qualified hostname</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-ip-prefix"><strong>ip_prefix</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Numeric IPv4 or IPv6 address with prefix</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Name of address</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-range-address"><strong>range_address</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Address range</p> </div>
</td> </tr> <tr>
<td>





<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-range-address-from"><strong>from</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>





<div class="ansible-option-cell">
<p>Start of address range</p> </div>
</td> </tr> <tr>
<td>





<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-range-address-to"><strong>to</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>





<div class="ansible-option-cell">
<p>End of address range</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-address-book-addresses-wildcard-address"><strong>wildcard_address</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Numeric IPv4 wildcard address with in the form of a.d.d.r/netmask</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-advance-policy-based-routing-profile"><strong>advance_policy_based_routing_profile</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Enable Advance Policy Based Routing on this zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-advanced-connection-tracking"><strong>advanced_connection_tracking</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Enable Advance Policy Based Routing on this zone</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-advanced-connection-tracking-mode"><strong>mode</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Set connection tracking mode</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>"allow-any-host"</code></li> <li><code>"allow-target-host"</code></li> <li><code>"allow-target-host-port"</code></li> </ul> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-advanced-connection-tracking-timeout"><strong>timeout</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">integer</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Timeout value in seconds for advanced-connection-tracking table for this zone</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-advanced-connection-tracking-track-all-policies-to-this-zone"><strong>track_all_policies_to_this_zone</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Mandate all policies with to-zone set to this zone to do connection track table lookup</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-application-tracking"><strong>application_tracking</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Enable Application tracking support for this zone</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-description"><strong>description</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Text description of zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-enable-reverse-reroute"><strong>enable_reverse_reroute</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Enable Reverse route lookup when there is change in ingress interface</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic"><strong>host_inbound_traffic</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Allowed system services &amp; protocols</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic-protocols"><strong>protocols</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Protocol type of incoming traffic to accept</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic-protocols-except"><strong>except</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Disallow the specified protocol traffic</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic-protocols-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Type of incoming protocol to accept</p> </div>
</td> </tr> <tr>
<td>



<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic-system-services"><strong>system_services</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=dictionary</span></p> </div>
</td> <td>



<div class="ansible-option-cell">
<p>Type of incoming system-service traffic to accept</p> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic-system-services-except"><strong>except</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Disallow the specified incoming system-service traffic</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>




<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-host-inbound-traffic-system-services-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>




<div class="ansible-option-cell">
<p>Type of incoming system-service traffic to accept</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-interfaces"><strong>interfaces</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Interfaces that are part of this zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-name"><strong>name</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Name of the security zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-screen"><strong>screen</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Name of ids option object applied to the zone</p> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-source-identity-log"><strong>source_identity_log</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Show user and group info in session log for this zone</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-tcp-rst"><strong>tcp_rst</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Send RST for NON-SYN packet not matching TCP session</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td>


<div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-config-zones-unidirectional-session-refreshing"><strong>unidirectional_session_refreshing</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">boolean</span></p> </div>
</td> <td>


<div class="ansible-option-cell">
<p>Enable unidirectional session refreshing on this zone</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li><code>false</code></li> <li><code>true</code></li> </ul> </div>
</td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-running-config"><strong>running_config</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>This option is used only with state <em>parsed</em>.</p> <p>The value of this option should be the output received from the JunOS device by executing the command <strong>show security policies</strong>.</p> <p>The state <em>parsed</em> reads the configuration from <code>running_config</code> option and transforms it into Ansible structured data as per the resource module’s argspec and the value is then returned in the <em>parsed</em> key within the result.</p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-parameter-state"><strong>state</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The state the configuration should be left in</p> <p>The states <em>rendered</em>, <em>gathered</em> and <em>parsed</em> does not perform any change on the device.</p> <p>The state <em>rendered</em> will transform the configuration in <code>config</code> option to platform specific CLI commands which will be returned in the <em>rendered</em> key within the result. For state <em>rendered</em> active connection to remote host is not required. behaviour for this module.</p> <p>The state <em>gathered</em> will fetch the running configuration from device and transform it into structured data in the format as per the resource module argspec and the value is returned in the <em>gathered</em> key within the result.</p> <p>The state <em>parsed</em> reads the configuration from <code>running_config</code> option and transforms it into JSON format as per the resource module parameters and the value is returned in the <em>parsed</em> key within the result. The value of <code>running_config</code> option should be the same format as the output of command <em>show security policies detail</em> executed on device. For state <em>parsed</em> active connection to remote host is not required.</p> <p class="ansible-option-line"><strong class="ansible-option-choices">Choices:</strong></p> <ul class="simple"> <li>
<code><strong>"merged"</strong></code> <span class="ansible-option-choices-default-mark">← (default)</span>
</li> <li><code>"replaced"</code></li> <li><code>"overridden"</code></li> <li><code>"deleted"</code></li> <li><code>"rendered"</code></li> <li><code>"gathered"</code></li> <li><code>"parsed"</code></li> </ul> </div></td> </tr>  </table> </section> <section id="notes"> <h2>Notes</h2> <div class="admonition note"> <p class="admonition-title">Note</p> <ul class="simple"> <li>This module requires the netconf system service be enabled on the device being managed.</li> <li>This module works with connection <code>netconf</code>.</li> <li>See <a class="reference external" href="../../../network/user_guide/platform_junos.html">the Junos OS Platform Options</a>.</li> <li>Tested against JunOS v18.4R1</li> </ul> </div> </section> <section id="examples"> <h2>Examples</h2> <pre data-language="yaml+jinja"># Using merged
#
# Before state
# ------------
#
# vagrant@vsrx# show security zones
#
# [edit]
# vagrant@vsrx# show security zones
#
- name: Merge the provided configuration with the exisiting running configuration
  junipernetworks.junos.junos_security_zones: &amp;merged
    config:
      functional_zone_management:
        description: test description
        host_inbound_traffic:
          protocols:
            - name: all
            - name: bgp
              except: true
          system_services:
            - name: all
            - except: true
              name: dhcp
        interfaces:
          - ge-0/0/1.0
          - ge-0/0/2.0
        screen: test_screen
      security_zones:
        - address_book:
            address_sets:
              - addresses:
                  - test_adr1
                  - test_adr2
                name: test_adrset1
              - addresses:
                  - test_adr3
                  - test_adr4
                name: test_adrset2
              - address_sets:
                  - test_adrset1
                  - test_adrset2
                addresses:
                  - test_adr5
                description: test description
                name: test_adrset3
            addresses:
              - description: test desc
                ip_prefix: 10.0.0.0/24
                name: test_adr1
              - dns_name:
                  ipv6_only: true
                  name: 1.1.1.1
                name: test_adr2
              - name: test_adr3
                range_address:
                  from: 10.2.0.1
                  to: 10.2.0.2
              - name: test_adr4
                wildcard_address: 10.3.0.1/24
              - description: test desc
                ip_prefix: 10.1.0.0/24
                name: test_adr5
          advance_policy_based_routing_profile: test_profile
          application_tracking: true
          description: test description
          enable_reverse_reroute: true
          host_inbound_traffic:
            protocols:
              - name: all
              - except: true
                name: bgp
            system_services:
              - name: all
              - except: true
                name: dhcp
          interfaces:
            - ge-0/0/3.0
            - ge-0/0/4.0
          name: test_sec_zone1
          screen: test_screen
          source_identity_log: true
          tcp_rst: true
    state: merged
#
# -------------------------
# Module Execution Result
# -------------------------
#   "after": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     },
#     "security_zones": [
#         {
#             "address_book": {
#                 "address_sets": [
#                     {
#                         "addresses": [
#                             "test_adr1",
#                             "test_adr2"
#                         ],
#                         "name": "test_adrset1"
#                     },
#                     {
#                         "addresses": [
#                             "test_adr3",
#                             "test_adr4"
#                         ],
#                         "name": "test_adrset2"
#                     },
#                     {
#                         "address_sets": [
#                             "test_adrset1",
#                             "test_adrset2"
#                         ],
#                         "addresses": [
#                             "test_adr5"
#                         ],
#                         "description": "test description",
#                         "name": "test_adrset3"
#                     }
#                 ],
#                 "addresses": [
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.0.0.0/24",
#                         "name": "test_adr1"
#                     },
#                     {
#                         "dns_name": {
#                             "ipv6_only": true,
#                             "name": "1.1.1.1"
#                         },
#                         "name": "test_adr2"
#                     },
#                     {
#                         "name": "test_adr3",
#                         "range_address": {
#                             "from": "10.2.0.1",
#                             "to": "10.2.0.2"
#                         }
#                     },
#                     {
#                         "name": "test_adr4",
#                         "wildcard_address": "10.3.0.1/24"
#                     },
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.1.0.0/24",
#                         "name": "test_adr5"
#                     }
#                 ]
#             },
#             "advance_policy_based_routing_profile": "test_profile",
#             "application_tracking": true,
#             "description": "test description",
#             "enable_reverse_reroute": true,
#             "host_inbound_traffic": {
#                 "protocols": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "bgp"
#                     }
#                 ],
#                 "system_services": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "dhcp"
#                     }
#                 ]
#             },
#             "interfaces": [
#                 "ge-0/0/3.0",
#                 "ge-0/0/4.0"
#             ],
#             "name": "test_sec_zone1",
#             "screen": "test_screen",
#             "source_identity_log": true,
#             "tcp_rst": true
#         }
#     ]
# },
# "before": {},
# "changed": true,
# "commands":
# '&lt;nc:security xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;nc:zones&gt;&lt;nc:functional-zone&gt;&lt;nc:management&gt;&lt;nc:description&gt;t'
# 'est description&lt;/nc:description&gt;&lt;nc:host-inbound-traffic&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:protocols&gt;&lt;nc:protocols&gt;&lt;nc:na'
# 'me&gt;bgp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:protocols&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:system-services&gt;&lt;nc:system-services&gt;&lt;n'
# 'c:name&gt;dhcp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:system-services&gt;&lt;/nc:host-inbound-traffic&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/1.0&lt;/nc:name&gt;&lt;/nc'
# ':interfaces&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/2.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:screen&gt;test_screen&lt;/nc:screen&gt;&lt;/nc:management&gt;&lt;/nc:f'
# 'unctional-zone&gt;&lt;nc:security-zone&gt;&lt;nc:name&gt;test_sec_zone1&lt;/nc:name&gt;&lt;nc:address-book&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr1&lt;/nc:name&gt;&lt;nc:i'
# 'p-prefix&gt;10.0.0.0/24&lt;/nc:ip-prefix&gt;&lt;nc:description&gt;test desc&lt;/nc:description&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr2&lt;/nc:nam'
# 'e&gt;&lt;nc:dns-name&gt;&lt;nc:name&gt;1.1.1.1&lt;/nc:name&gt;&lt;nc:ipv6-only/&gt;&lt;/nc:dns-name&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr3&lt;/nc:name&gt;&lt;nc:r'
# 'ange-address&gt;&lt;nc:name&gt;10.2.0.1&lt;/nc:name&gt;&lt;nc:to&gt;&lt;nc:range-high&gt;10.2.0.2&lt;/nc:range-high&gt;&lt;/nc:to&gt;&lt;/nc:range-address&gt;&lt;/nc:address&gt;&lt;n'
# 'c:address&gt;&lt;nc:name&gt;test_adr4&lt;/nc:name&gt;&lt;nc:wildcard-address&gt;&lt;nc:name&gt;10.3.0.1/24&lt;/nc:name&gt;&lt;/nc:wildcard-address&gt;&lt;/nc:address&gt;&lt;nc:'
# 'address&gt;&lt;nc:name&gt;test_adr5&lt;/nc:name&gt;&lt;nc:ip-prefix&gt;10.1.0.0/24&lt;/nc:ip-prefix&gt;&lt;nc:description&gt;test desc&lt;/nc:description&gt;&lt;/nc:addre'
# 'ss&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset1&lt;/nc:name&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr1&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test'
# '_adr2&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;/nc:address-set&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset2&lt;/nc:name&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr3&lt;/nc:n'
# 'ame&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr4&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;/nc:address-set&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset3&lt;/nc'
# ':name&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr5&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset1&lt;/nc:name&gt;&lt;/nc:address-set&gt;&lt;nc:a'
# 'ddress-set&gt;&lt;nc:name&gt;test_adrset2&lt;/nc:name&gt;&lt;/nc:address-set&gt;&lt;nc:description&gt;test description&lt;/nc:description&gt;&lt;/nc:address-set&gt;&lt;/n'
# 'c:address-book&gt;&lt;nc:advance-policy-based-routing-profile&gt;&lt;nc:profile&gt;test_profile&lt;/nc:profile&gt;&lt;/nc:advance-policy-based-routing-p'
# 'rofile&gt;&lt;nc:application-tracking/&gt;&lt;nc:description&gt;test description&lt;/nc:description&gt;&lt;nc:enable-reverse-reroute/&gt;&lt;nc:host-inbound-t'
# 'raffic&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:protocols&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;bgp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:protocols&gt;&lt;nc:sys'
# 'tem-services&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:system-services&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;dhcp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:system-servi'
# 'ces&gt;&lt;/nc:host-inbound-traffic&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/3.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/4.0&lt;/nc'
# ':name&gt;&lt;/nc:interfaces&gt;&lt;nc:screen&gt;test_screen&lt;/nc:screen&gt;&lt;nc:source-identity-log/&gt;&lt;nc:tcp-rst/&gt;&lt;/nc:security-zone&gt;&lt;/nc:zones&gt;&lt;/nc'
# ':security&gt;'

# After state
# -----------
#
# vagrant@vsrx# show system ntp
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
# security-zone test_sec_zone1 {
#     description "test description";
#     tcp-rst;
#     address-book {
#         address test_adr1 {
#             description "test desc";
#             10.0.0.0/24;
#         }
#         address test_adr2 {
#             dns-name 1.1.1.1 {
#                 ipv6-only;
#             }
#         }
#         address test_adr3 {
#             range-address 10.2.0.1 {
#                 to {
#                     10.2.0.2;
#                 }
#             }
#         }
#         address test_adr4 {
#             wildcard-address 10.3.0.1/24;
#         }
#         address test_adr5 {
#             description "test desc";
#             10.1.0.0/24;
#         }
#         address-set test_adrset1 {
#             address test_adr1;
#             address test_adr2;
#         }
#         address-set test_adrset2 {
#             address test_adr3;
#             address test_adr4;
#         }
#         address-set test_adrset3 {
#             description "test description";
#             address test_adr5;
#             address-set test_adrset1;
#             address-set test_adrset2;
#         }
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     interfaces {
#         ge-0/0/3.0;
#         ge-0/0/4.0;
#     }
#     application-tracking;
#     source-identity-log;
#     advance-policy-based-routing-profile {
#         test_profile;
#     }
#     enable-reverse-reroute;
# }
#
#
# Using Replaced
# Before state
# ------------
#
# vagrant@vsrx# show security zones
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
# security-zone test_sec_zone1 {
#     description "test description";
#     tcp-rst;
#     address-book {
#         address test_adr1 {
#             description "test desc";
#             10.0.0.0/24;
#         }
#         address test_adr2 {
#             dns-name 1.1.1.1 {
#                 ipv6-only;
#             }
#         }
#         address test_adr3 {
#             range-address 10.2.0.1 {
#                 to {
#                     10.2.0.2;
#                 }
#             }
#         }
#         address test_adr4 {
#             wildcard-address 10.3.0.1/24;
#         }
#         address test_adr5 {
#             description "test desc";
#             10.1.0.0/24;
#         }
#         address-set test_adrset1 {
#             address test_adr1;
#             address test_adr2;
#         }
#         address-set test_adrset2 {
#             address test_adr3;
#             address test_adr4;
#         }
#         address-set test_adrset3 {
#             description "test description";
#             address test_adr5;
#             address-set test_adrset1;
#             address-set test_adrset2;
#         }
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     interfaces {
#         ge-0/0/3.0;
#         ge-0/0/4.0;
#     }
#     application-tracking;
#     source-identity-log;
#     advance-policy-based-routing-profile {
#         test_profile;
#     }
#     enable-reverse-reroute;
# }
#
#

- name: Replaced running security zones configuration with provided configuration
  junipernetworks.junos.junos_security_zones:
    config:
      functional_zone_management:
        description: test description
        host_inbound_traffic:
          protocols:
            - name: all
            - name: bgp
              except: true
          system_services:
            - name: all
            - except: true
              name: dhcp
          interfaces:
            - ge-0/0/1.0
            - ge-0/0/2.0
        screen: test_screen
    state: replaced
#
# -------------------------
# Module Execution Result
# -------------------------
# "after": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     }
# },
# "before": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     },
#     "security_zones": [
#         {
#             "address_book": {
#                 "address_sets": [
#                     {
#                         "addresses": [
#                             "test_adr1",
#                             "test_adr2"
#                         ],
#                         "name": "test_adrset1"
#                     },
#                     {
#                         "addresses": [
#                             "test_adr3",
#                             "test_adr4"
#                         ],
#                         "name": "test_adrset2"
#                     },
#                     {
#                         "address_sets": [
#                             "test_adrset1",
#                             "test_adrset2"
#                         ],
#                         "addresses": [
#                             "test_adr5"
#                         ],
#                         "description": "test description",
#                         "name": "test_adrset3"
#                     }
#                 ],
#                 "addresses": [
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.0.0.0/24",
#                         "name": "test_adr1"
#                     },
#                     {
#                         "dns_name": {
#                             "ipv6_only": true,
#                             "name": "1.1.1.1"
#                         },
#                         "name": "test_adr2"
#                     },
#                     {
#                         "name": "test_adr3",
#                         "range_address": {
#                             "from": "10.2.0.1",
#                             "to": "10.2.0.2"
#                         }
#                     },
#                     {
#                         "name": "test_adr4",
#                         "wildcard_address": "10.3.0.1/24"
#                     },
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.1.0.0/24",
#                         "name": "test_adr5"
#                     }
#                 ]
#             },
#             "advance_policy_based_routing_profile": "test_profile",
#             "application_tracking": true,
#             "description": "test description",
#             "enable_reverse_reroute": true,
#             "host_inbound_traffic": {
#                 "protocols": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "bgp"
#                     }
#                 ],
#                 "system_services": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "dhcp"
#                     }
#                 ]
#             },
#             "interfaces": [
#                 "ge-0/0/3.0",
#                 "ge-0/0/4.0"
#             ],
#             "name": "test_sec_zone1",
#             "screen": "test_screen",
#             "source_identity_log": true,
#             "tcp_rst": true
#         }
#     ]
# },
# "changed": true,
# "commands":
# '&lt;nc:security xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;nc:zones delete="delete"/&gt;&lt;nc:zones&gt;&lt;nc:functional-zone&gt;&lt;nc'
# ':management&gt;&lt;nc:description&gt;test description&lt;/nc:description&gt;&lt;nc:host-inbound-traffic&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:p'
# 'rotocols&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;bgp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:protocols&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:system-se'
# 'rvices&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;dhcp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:system-services&gt;&lt;/nc:host-inbound-traffic&gt;&lt;nc:interfaces&gt;&lt;nc:'
# 'name&gt;ge-0/0/1.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/2.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:screen&gt;test_screen&lt;/nc:'
# 'screen&gt;&lt;/nc:management&gt;&lt;/nc:functional-zone&gt;&lt;/nc:zones&gt;&lt;/nc:security&gt;'
#
#
# After state
# -----------
#
# vagrant@vsrx# show system ntp
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
#
#
# Using overridden
#
# Before state
# ------------
#
# vagrant@vsrx# show security zones
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
# security-zone test_sec_zone1 {
#     description "test description";
#     tcp-rst;
#     address-book {
#         address test_adr1 {
#             description "test desc";
#             10.0.0.0/24;
#         }
#         address test_adr2 {
#             dns-name 1.1.1.1 {
#                 ipv6-only;
#             }
#         }
#         address test_adr3 {
#             range-address 10.2.0.1 {
#                 to {
#                     10.2.0.2;
#                 }
#             }
#         }
#         address test_adr4 {
#             wildcard-address 10.3.0.1/24;
#         }
#         address test_adr5 {
#             description "test desc";
#             10.1.0.0/24;
#         }
#         address-set test_adrset1 {
#             address test_adr1;
#             address test_adr2;
#         }
#         address-set test_adrset2 {
#             address test_adr3;
#             address test_adr4;
#         }
#         address-set test_adrset3 {
#             description "test description";
#             address test_adr5;
#             address-set test_adrset1;
#             address-set test_adrset2;
#         }
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     interfaces {
#         ge-0/0/3.0;
#         ge-0/0/4.0;
#     }
#     application-tracking;
#     source-identity-log;
#     advance-policy-based-routing-profile {
#         test_profile;
#     }
#     enable-reverse-reroute;
# }
#
#

- name: Override running security zones configuration with provided configuration
  junipernetworks.junos.junos_security_zones:
    config:
      functional_zone_management:
        description: test description
        host_inbound_traffic:
          protocols:
            - name: all
            - name: bgp
              except: true
          system_services:
            - name: all
            - except: true
              name: dhcp
        interfaces:
          - ge-0/0/1.0
          - ge-0/0/2.0
        screen: test_screen
    state: overridden
#
# -------------------------
# Module Execution Result
# -------------------------
# "after": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     }
# },
# "before": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     },
#     "security_zones": [
#         {
#             "address_book": {
#                 "address_sets": [
#                     {
#                         "addresses": [
#                             "test_adr1",
#                             "test_adr2"
#                         ],
#                         "name": "test_adrset1"
#                     },
#                     {
#                         "addresses": [
#                             "test_adr3",
#                             "test_adr4"
#                         ],
#                         "name": "test_adrset2"
#                     },
#                     {
#                         "address_sets": [
#                             "test_adrset1",
#                             "test_adrset2"
#                         ],
#                         "addresses": [
#                             "test_adr5"
#                         ],
#                         "description": "test description",
#                         "name": "test_adrset3"
#                     }
#                 ],
#                 "addresses": [
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.0.0.0/24",
#                         "name": "test_adr1"
#                     },
#                     {
#                         "dns_name": {
#                             "ipv6_only": true,
#                             "name": "1.1.1.1"
#                         },
#                         "name": "test_adr2"
#                     },
#                     {
#                         "name": "test_adr3",
#                         "range_address": {
#                             "from": "10.2.0.1",
#                             "to": "10.2.0.2"
#                         }
#                     },
#                     {
#                         "name": "test_adr4",
#                         "wildcard_address": "10.3.0.1/24"
#                     },
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.1.0.0/24",
#                         "name": "test_adr5"
#                     }
#                 ]
#             },
#             "advance_policy_based_routing_profile": "test_profile",
#             "application_tracking": true,
#             "description": "test description",
#             "enable_reverse_reroute": true,
#             "host_inbound_traffic": {
#                 "protocols": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "bgp"
#                     }
#                 ],
#                 "system_services": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "dhcp"
#                     }
#                 ]
#             },
#             "interfaces": [
#                 "ge-0/0/3.0",
#                 "ge-0/0/4.0"
#             ],
#             "name": "test_sec_zone1",
#             "screen": "test_screen",
#             "source_identity_log": true,
#             "tcp_rst": true
#         }
#     ]
# },
# "changed": true,
# "commands":
# '&lt;nc:security xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;nc:zones delete="delete"/&gt;&lt;nc:zones&gt;&lt;nc:functional-zone&gt;&lt;nc'
# ':management&gt;&lt;nc:description&gt;test description&lt;/nc:description&gt;&lt;nc:host-inbound-traffic&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:p'
# 'rotocols&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;bgp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:protocols&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:system-se'
# 'rvices&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;dhcp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:system-services&gt;&lt;/nc:host-inbound-traffic&gt;&lt;nc:interfaces&gt;&lt;nc:'
# 'name&gt;ge-0/0/1.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/2.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:screen&gt;test_screen&lt;/nc:'
# 'screen&gt;&lt;/nc:management&gt;&lt;/nc:functional-zone&gt;&lt;/nc:zones&gt;&lt;/nc:security&gt;'
#
#
# After state
# -----------
#
# vagrant@vsrx# show system ntp
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
#
#
# Using deleted
#
# Before state
# ------------
#
# vagrant@vsrx# show security zones
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
#
#
- name: Delete running security zones configuration
  junipernetworks.junos.junos_security_zones:
    config:
    state: deleted
#
# -------------------------
# Module Execution Result
# -------------------------
#     "after": {},
#     "before": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     }
# },
# "changed": true,
# "commands":
#   "&lt;nc:security xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;"
#   "&lt;nc:zones delete="delete"/&gt;&lt;/nc:security&gt;"
#
#
# After state
# -----------
#
# vagrant@vsrx# show security zones
#
# [edit]
# Using gathered
#
# Before state
# ------------
#
# vagrant@vsrx# show system ntp
# functional-zone management {
#     interfaces {
#         ge-0/0/1.0;
#         ge-0/0/2.0;
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     description "test description";
# }
# security-zone test_sec_zone1 {
#     description "test description";
#     tcp-rst;
#     address-book {
#         address test_adr1 {
#             description "test desc";
#             10.0.0.0/24;
#         }
#         address test_adr2 {
#             dns-name 1.1.1.1 {
#                 ipv6-only;
#             }
#         }
#         address test_adr3 {
#             range-address 10.2.0.1 {
#                 to {
#                     10.2.0.2;
#                 }
#             }
#         }
#         address test_adr4 {
#             wildcard-address 10.3.0.1/24;
#         }
#         address test_adr5 {
#             description "test desc";
#             10.1.0.0/24;
#         }
#         address-set test_adrset1 {
#             address test_adr1;
#             address test_adr2;
#         }
#         address-set test_adrset2 {
#             address test_adr3;
#             address test_adr4;
#         }
#         address-set test_adrset3 {
#             description "test description";
#             address test_adr5;
#             address-set test_adrset1;
#             address-set test_adrset2;
#         }
#     }
#     screen test_screen;
#     host-inbound-traffic {
#         system-services {
#             all;
#             dhcp {
#                 except;
#             }
#         }
#         protocols {
#             all;
#             bgp {
#                 except;
#             }
#         }
#     }
#     interfaces {
#         ge-0/0/3.0;
#         ge-0/0/4.0;
#     }
#     application-tracking;
#     source-identity-log;
#     advance-policy-based-routing-profile {
#         test_profile;
#     }
#     enable-reverse-reroute;
# }
- name: Gather running security zones configuration
  junipernetworks.junos.junos_security_zones:
    state: gathered
#
# -------------------------
# Module Execution Result
# -------------------------
# "gathered": {
#     "functional_zone_management": {
#         "description": "test description",
#         "host_inbound_traffic": {
#             "protocols": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "bgp"
#                 }
#             ],
#             "system_services": [
#                 {
#                     "name": "all"
#                 },
#                 {
#                     "except": true,
#                     "name": "dhcp"
#                 }
#             ]
#         },
#         "interfaces": [
#             "ge-0/0/1.0",
#             "ge-0/0/2.0"
#         ],
#         "screen": "test_screen"
#     },
#     "security_zones": [
#         {
#             "address_book": {
#                 "address_sets": [
#                     {
#                         "addresses": [
#                             "test_adr1",
#                             "test_adr2"
#                         ],
#                         "name": "test_adrset1"
#                     },
#                     {
#                         "addresses": [
#                             "test_adr3",
#                             "test_adr4"
#                         ],
#                         "name": "test_adrset2"
#                     },
#                     {
#                         "address_sets": [
#                             "test_adrset1",
#                             "test_adrset2"
#                         ],
#                         "addresses": [
#                             "test_adr5"
#                         ],
#                         "description": "test description",
#                         "name": "test_adrset3"
#                     }
#                 ],
#                 "addresses": [
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.0.0.0/24",
#                         "name": "test_adr1"
#                     },
#                     {
#                         "dns_name": {
#                             "ipv6_only": true,
#                             "name": "1.1.1.1"
#                         },
#                         "name": "test_adr2"
#                     },
#                     {
#                         "name": "test_adr3",
#                         "range_address": {
#                             "from": "10.2.0.1",
#                             "to": "10.2.0.2"
#                         }
#                     },
#                     {
#                         "name": "test_adr4",
#                         "wildcard_address": "10.3.0.1/24"
#                     },
#                     {
#                         "description": "test desc",
#                         "ip_prefix": "10.1.0.0/24",
#                         "name": "test_adr5"
#                     }
#                 ]
#             },
#             "advance_policy_based_routing_profile": "test_profile",
#             "application_tracking": true,
#             "description": "test description",
#             "enable_reverse_reroute": true,
#             "host_inbound_traffic": {
#                 "protocols": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "bgp"
#                     }
#                 ],
#                 "system_services": [
#                     {
#                         "name": "all"
#                     },
#                     {
#                         "except": true,
#                         "name": "dhcp"
#                     }
#                 ]
#             },
#             "interfaces": [
#                 "ge-0/0/3.0",
#                 "ge-0/0/4.0"
#             ],
#             "name": "test_sec_zone1",
#             "screen": "test_screen",
#             "source_identity_log": true,
#             "tcp_rst": true
#         }
#     ]
# }
# "changed": false,
#
#
# Using rendered
#
# Before state
# ------------
#
- name: Render xml for provided facts.
  junipernetworks.junos.junos_security_zones:
    config:
      functional_zone_management:
        description: test description
        host_inbound_traffic:
          protocols:
            - name: all
            - name: bgp
              except: true
          system_services:
            - name: all
            - except: true
              name: dhcp
        interfaces:
          - ge-0/0/1.0
          - ge-0/0/2.0
        screen: test_screen
      security_zones:
        - address_book:
            address_sets:
              - addresses:
                  - test_adr1
                  - test_adr2
                name: test_adrset1
              - addresses:
                  - test_adr3
                  - test_adr4
                name: test_adrset2
              - address_sets:
                  - test_adrset1
                  - test_adrset2
              - addresses:
                  - test_adr5
                description: test description
                name: test_adrset3
            addresses:
              - description: test desc
                ip_prefix: 10.0.0.0/24
                name: test_adr1
              - dns_name:
                  ipv6_only: true
                  name: 1.1.1.1
                name: test_adr2
              - name: test_adr3
                range_address:
                  from: 10.2.0.1
                  to: 10.2.0.2
              - name: test_adr4
                wildcard_address: 10.3.0.1/24
              - description: test desc
                ip_prefix: 10.1.0.0/24
                name: test_adr5
          advance_policy_based_routing_profile: test_profile
          application_tracking: true
          description: test description
          enable_reverse_reroute: true
          host_inbound_traffic:
            protocols:
              - name: all
              - except: true
                name: bgp
            system_services:
              - name: all
              - except: true
                name: dhcp
          interfaces:
            - ge-0/0/3.0
            - ge-0/0/4.0
          name: test_sec_zone1
          screen: test_screen
          source_identity_log: true
          tcp_rst: true
    state: rendered
#
# -------------------------
# Module Execution Result
# -------------------------
# "rendered":
# '&lt;nc:security xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;&lt;nc:zones&gt;&lt;nc:functional-zone&gt;&lt;nc:management&gt;&lt;nc:description&gt;t'
# 'est description&lt;/nc:description&gt;&lt;nc:host-inbound-traffic&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:protocols&gt;&lt;nc:protocols&gt;&lt;nc:na'
# 'me&gt;bgp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:protocols&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:system-services&gt;&lt;nc:system-services&gt;&lt;n'
# 'c:name&gt;dhcp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:system-services&gt;&lt;/nc:host-inbound-traffic&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/1.0&lt;/nc:name&gt;&lt;/nc'
# ':interfaces&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/2.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:screen&gt;test_screen&lt;/nc:screen&gt;&lt;/nc:management&gt;&lt;/nc:f'
# 'unctional-zone&gt;&lt;nc:security-zone&gt;&lt;nc:name&gt;test_sec_zone1&lt;/nc:name&gt;&lt;nc:address-book&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr1&lt;/nc:name&gt;&lt;nc:i'
# 'p-prefix&gt;10.0.0.0/24&lt;/nc:ip-prefix&gt;&lt;nc:description&gt;test desc&lt;/nc:description&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr2&lt;/nc:nam'
# 'e&gt;&lt;nc:dns-name&gt;&lt;nc:name&gt;1.1.1.1&lt;/nc:name&gt;&lt;nc:ipv6-only/&gt;&lt;/nc:dns-name&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr3&lt;/nc:name&gt;&lt;nc:r'
# 'ange-address&gt;&lt;nc:name&gt;10.2.0.1&lt;/nc:name&gt;&lt;nc:to&gt;&lt;nc:range-high&gt;10.2.0.2&lt;/nc:range-high&gt;&lt;/nc:to&gt;&lt;/nc:range-address&gt;&lt;/nc:address&gt;&lt;n'
# 'c:address&gt;&lt;nc:name&gt;test_adr4&lt;/nc:name&gt;&lt;nc:wildcard-address&gt;&lt;nc:name&gt;10.3.0.1/24&lt;/nc:name&gt;&lt;/nc:wildcard-address&gt;&lt;/nc:address&gt;&lt;nc:'
# 'address&gt;&lt;nc:name&gt;test_adr5&lt;/nc:name&gt;&lt;nc:ip-prefix&gt;10.1.0.0/24&lt;/nc:ip-prefix&gt;&lt;nc:description&gt;test desc&lt;/nc:description&gt;&lt;/nc:addre'
# 'ss&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset1&lt;/nc:name&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr1&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test'
# '_adr2&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;/nc:address-set&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset2&lt;/nc:name&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr3&lt;/nc:n'
# 'ame&gt;&lt;/nc:address&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr4&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;/nc:address-set&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset3&lt;/nc'
# ':name&gt;&lt;nc:address&gt;&lt;nc:name&gt;test_adr5&lt;/nc:name&gt;&lt;/nc:address&gt;&lt;nc:address-set&gt;&lt;nc:name&gt;test_adrset1&lt;/nc:name&gt;&lt;/nc:address-set&gt;&lt;nc:a'
# 'ddress-set&gt;&lt;nc:name&gt;test_adrset2&lt;/nc:name&gt;&lt;/nc:address-set&gt;&lt;nc:description&gt;test description&lt;/nc:description&gt;&lt;/nc:address-set&gt;&lt;/n'
# 'c:address-book&gt;&lt;nc:advance-policy-based-routing-profile&gt;&lt;nc:profile&gt;test_profile&lt;/nc:profile&gt;&lt;/nc:advance-policy-based-routing-p'
# 'rofile&gt;&lt;nc:application-tracking/&gt;&lt;nc:description&gt;test description&lt;/nc:description&gt;&lt;nc:enable-reverse-reroute/&gt;&lt;nc:host-inbound-t'
# 'raffic&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:protocols&gt;&lt;nc:protocols&gt;&lt;nc:name&gt;bgp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:protocols&gt;&lt;nc:sys'
# 'tem-services&gt;&lt;nc:name&gt;all&lt;/nc:name&gt;&lt;/nc:system-services&gt;&lt;nc:system-services&gt;&lt;nc:name&gt;dhcp&lt;/nc:name&gt;&lt;nc:except/&gt;&lt;/nc:system-servi'
# 'ces&gt;&lt;/nc:host-inbound-traffic&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/3.0&lt;/nc:name&gt;&lt;/nc:interfaces&gt;&lt;nc:interfaces&gt;&lt;nc:name&gt;ge-0/0/4.0&lt;/nc'
# ':name&gt;&lt;/nc:interfaces&gt;&lt;nc:screen&gt;test_screen&lt;/nc:screen&gt;&lt;nc:source-identity-log/&gt;&lt;nc:tcp-rst/&gt;&lt;/nc:security-zone&gt;&lt;/nc:zones&gt;&lt;/nc'
# ':security&gt;'
#
# Using parsed
# parsed.cfg
# ------------
# &lt;?xml version="1.0" encoding="UTF-8"?&gt;
# &lt;rpc-reply message-id="urn:uuid:0cadb4e8-5bba-47f4-986e-72906227007f"&gt;
#     &lt;configuration changed-seconds="1590139550" changed-localtime="2020-05-22 09:25:50 UTC"&gt;
#         &lt;version&gt;18.4R1-S2.4&lt;/version&gt;
#         &lt;security&gt;
#             &lt;zones&gt;
#                 &lt;functional-zone&gt;
#                     &lt;management&gt;
#                         &lt;description&gt;test description&lt;/description&gt;
#                         &lt;host-inbound-traffic&gt;
#                             &lt;protocols&gt;
#                                 &lt;name&gt;all&lt;/name&gt;
#                             &lt;/protocols&gt;
#                             &lt;protocols&gt;
#                                 &lt;name&gt;bgp&lt;/name&gt;
#                                 &lt;except /&gt;
#                             &lt;/protocols&gt;
#                             &lt;system-services&gt;
#                                 &lt;name&gt;all&lt;/name&gt;
#                             &lt;/system-services&gt;
#                             &lt;system-services&gt;
#                                 &lt;name&gt;dhcp&lt;/name&gt;
#                                 &lt;except /&gt;
#                             &lt;/system-services&gt;
#                         &lt;/host-inbound-traffic&gt;
#                         &lt;interfaces&gt;
#                             &lt;name&gt;ge-0/0/1.0&lt;/name&gt;
#                         &lt;/interfaces&gt;
#                         &lt;interfaces&gt;
#                             &lt;name&gt;ge-0/0/2.0&lt;/name&gt;
#                         &lt;/interfaces&gt;
#                         &lt;screen&gt;test_screen&lt;/screen&gt;
#                     &lt;/management&gt;
#                 &lt;/functional-zone&gt;
#                 &lt;security-zone&gt;
#                     &lt;name&gt;test_sec_zone1&lt;/name&gt;
#                     &lt;address-book&gt;
#                         &lt;address&gt;
#                             &lt;name&gt;test_adr1&lt;/name&gt;
#                             &lt;ip-prefix&gt;10.0.0.0/24&lt;/ip-prefix&gt;
#                             &lt;description&gt;test desc&lt;/description&gt;
#                         &lt;/address&gt;
#                         &lt;address&gt;
#                             &lt;name&gt;test_adr2&lt;/name&gt;
#                             &lt;dns-name&gt;
#                                 &lt;name&gt;1.1.1.1&lt;/name&gt;
#                                 &lt;ipv6-only /&gt;
#                             &lt;/dns-name&gt;
#                         &lt;/address&gt;
#                         &lt;address&gt;
#                             &lt;name&gt;test_adr3&lt;/name&gt;
#                             &lt;range-address&gt;
#                                 &lt;name&gt;10.2.0.1&lt;/name&gt;
#                                 &lt;to&gt;
#                                     &lt;range-high&gt;10.2.0.2&lt;/range-high&gt;
#                                 &lt;/to&gt;
#                             &lt;/range-address&gt;
#                         &lt;/address&gt;
#                         &lt;address&gt;
#                             &lt;name&gt;test_adr4&lt;/name&gt;
#                             &lt;wildcard-address&gt;
#                                 &lt;name&gt;10.3.0.1/24&lt;/name&gt;
#                             &lt;/wildcard-address&gt;
#                         &lt;/address&gt;
#                         &lt;address&gt;
#                             &lt;name&gt;test_adr5&lt;/name&gt;
#                             &lt;ip-prefix&gt;10.1.0.0/24&lt;/ip-prefix&gt;
#                             &lt;description&gt;test desc&lt;/description&gt;
#                         &lt;/address&gt;
#                         &lt;address-set&gt;
#                             &lt;name&gt;test_adrset1&lt;/name&gt;
#                             &lt;address&gt;
#                                 &lt;name&gt;test_adr1&lt;/name&gt;
#                             &lt;/address&gt;
#                             &lt;address&gt;
#                                 &lt;name&gt;test_adr2&lt;/name&gt;
#                             &lt;/address&gt;
#                         &lt;/address-set&gt;
#                         &lt;address-set&gt;
#                             &lt;name&gt;test_adrset2&lt;/name&gt;
#                             &lt;address&gt;
#                                 &lt;name&gt;test_adr3&lt;/name&gt;
#                             &lt;/address&gt;
#                             &lt;address&gt;
#                                 &lt;name&gt;test_adr4&lt;/name&gt;
#                             &lt;/address&gt;
#                         &lt;/address-set&gt;
#                         &lt;address-set&gt;
#                             &lt;name&gt;test_adrset3&lt;/name&gt;
#                             &lt;address&gt;
#                                 &lt;name&gt;test_adr5&lt;/name&gt;
#                             &lt;/address&gt;
#                             &lt;address-set&gt;
#                                 &lt;name&gt;test_adrset1&lt;/name&gt;
#                             &lt;/address-set&gt;
#                             &lt;address-set&gt;
#                                 &lt;name&gt;test_adrset2&lt;/name&gt;
#                             &lt;/address-set&gt;
#                             &lt;description&gt;test description&lt;/description&gt;
#                         &lt;/address-set&gt;
#                     &lt;/address-book&gt;
#                     &lt;advance-policy-based-routing-profile&gt;
#                         &lt;profile&gt;test_profile&lt;/profile&gt;
#                     &lt;/advance-policy-based-routing-profile&gt;
#                     &lt;application-tracking /&gt;
#                     &lt;description&gt;test description&lt;/description&gt;
#                     &lt;enable-reverse-reroute /&gt;
#                     &lt;host-inbound-traffic&gt;
#                         &lt;protocols&gt;
#                             &lt;name&gt;all&lt;/name&gt;
#                         &lt;/protocols&gt;
#                         &lt;protocols&gt;
#                             &lt;name&gt;bgp&lt;/name&gt;
#                             &lt;except /&gt;
#                         &lt;/protocols&gt;
#                         &lt;system-services&gt;
#                             &lt;name&gt;all&lt;/name&gt;
#                         &lt;/system-services&gt;
#                         &lt;system-services&gt;
#                             &lt;name&gt;dhcp&lt;/name&gt;
#                             &lt;except /&gt;
#                         &lt;/system-services&gt;
#                     &lt;/host-inbound-traffic&gt;
#                     &lt;interfaces&gt;
#                         &lt;name&gt;ge-0/0/3.0&lt;/name&gt;
#                     &lt;/interfaces&gt;
#                     &lt;interfaces&gt;
#                         &lt;name&gt;ge-0/0/4.0&lt;/name&gt;
#                     &lt;/interfaces&gt;
#                     &lt;screen&gt;test_screen&lt;/screen&gt;
#                     &lt;source-identity-log /&gt;
#                     &lt;tcp-rst /&gt;
#                 &lt;/security-zone&gt;
#             &lt;/zones&gt;
#         &lt;/security&gt;
#     &lt;/configuration&gt;
# &lt;/rpc-reply&gt;
#
- name: Parse security zones running config
  junipernetworks.junos.junos_security_zones:
    running_config: "{{ lookup('file', './parsed.cfg') }}"
    state: parsed
#
#
# -------------------------
# Module Execution Result
# -------------------------
#
#
# "parsed":  {
#     "functional_zone_management": {
#         "description": "test description 2",
#         "host_inbound_traffic": {
#             "protocols": [{"name": "all"}, {"except": True, "name": "bgp"}, {"except": True, "name": "bfd"}],
#             "system_services": [{"name": "all"}, {"except": True, "name": "dhcp"}, {"except": True, "name": "dhcpv6"}],
#         },
#         "interfaces": ["ge-0/0/1.0", "ge-0/0/2.0"],
#         "screen": "test_screen",
#     },
#     "security_zones": [
#         {
#             "address_book": {
#                 "address_sets": [
#                     {"addresses": ["test_adr1", "test_adr2"], "name": "test_adrset1"},
#                     {"addresses": ["test_adr3", "test_adr4"], "name": "test_adrset2"},
#                     {
#                         "address_sets": ["test_adrset1", "test_adrset2"],
#                         "addresses": ["test_adr5"],
#                         "description": "test description",
#                         "name": "test_adrset3",
#                     },
#                 ],
#                 "addresses": [
#                     {"description": "test desc", "ip_prefix": "10.0.0.0/24", "name": "test_adr1"},
#                     {"dns_name": {"ipv6_only": True, "name": "1.1.1.1"}, "name": "test_adr2"},
#                     {"name": "test_adr3", "range_address": {"from": "10.2.0.1", "to": "10.2.0.2"}},
#                     {"name": "test_adr4", "wildcard_address": "10.3.0.1/24"},
#                     {"description": "test desc", "ip_prefix": "10.1.0.0/24", "name": "test_adr5"},
#                 ],
#             },
#             "advance_policy_based_routing_profile": "test_profile",
#             "application_tracking": True,
#             "description": "test description",
#             "enable_reverse_reroute": True,
#             "host_inbound_traffic": {
#                 "protocols": [{"name": "all"}, {"except": True, "name": "bgp"}],
#                 "system_services": [{"name": "all"}, {"except": True, "name": "dhcp"}],
#             },
#             "interfaces": ["ge-0/0/3.0", "ge-0/0/4.0"],
#             "name": "test_sec_zone1",
#             "screen": "test_screen",
#             "source_identity_log": True,
#             "tcp_rst": True,
#         },
#         {"name": "test_sec_zone2", "source_identity_log": True, "tcp_rst": True},
#     ],
# }
#
#
</pre> </section> <section id="return-values"> <h2>Return Values</h2> <p>Common return values are documented <a class="reference internal" href="../../../reference_appendices/common_return_values.html#common-return-values"><span class="std std-ref">here</span></a>, the following are the fields unique to this module:</p> <table class="longtable ansible-option-table docutils align-default" style="width: 100%"> <thead> <tr>
<th class="head"><p>Key</p></th> <th class="head"><p>Description</p></th> </tr> </thead>  <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-return-after"><strong>after</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The resulting configuration after module execution.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when changed</p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"This output will always be in the same format as the module argspec.\n"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-return-before"><strong>before</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The configuration prior to the module execution.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when state is <em>merged</em>, <em>replaced</em>, <em>overridden</em>, <em>deleted</em> or <em>purged</em></p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"This output will always be in the same format as the module argspec.\n"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-return-commands"><strong>commands</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">list</span> / <span class="ansible-option-elements">elements=string</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The set of commands pushed to the remote device.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when state is <em>merged</em>, <em>replaced</em>, <em>overridden</em>, <em>deleted</em> or <em>purged</em></p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["&lt;rpc-reply&gt; &lt;configuration&gt; &lt;security&gt; &lt;policies&gt; &lt;global&gt; &lt;policy&gt; &lt;name&gt;test_glob_1&lt;/name&gt; &lt;match&gt; &lt;source-address&gt;any-ipv6&lt;/source-address&gt; &lt;destination-address&gt;any-ipv6&lt;/destination-address&gt; &lt;application&gt;any&lt;/application&gt; &lt;/match&gt; &lt;then&gt; &lt;deny /&gt; &lt;/then&gt; &lt;/policy&gt; &lt;/global&gt; &lt;/policies&gt; &lt;/security&gt; &lt;/configuration&gt; &lt;/rpc-reply&gt;"]</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-return-gathered"><strong>gathered</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>Facts about the network resource gathered from the remote device as structured data.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when state is <em>gathered</em></p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"This output will always be in the same format as the module argspec.\n"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-return-parsed"><strong>parsed</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The device native config provided in <em>running_config</em> option parsed into structured data as per module argspec.</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when state is <em>parsed</em></p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>"This output will always be in the same format as the module argspec.\n"</code></p> </div></td> </tr> <tr>
<td><div class="ansible-option-cell"> 
<p class="ansible-option-title" id="ansible-collections-junipernetworks-junos-junos-security-zones-module-return-rendered"><strong>rendered</strong></p> <p class="ansible-option-type-line"><span class="ansible-option-type">dictionary</span></p> </div></td> <td><div class="ansible-option-cell">
<p>The provided configuration in the task rendered in device-native format (offline).</p> <p class="ansible-option-line"><strong class="ansible-option-returned-bold">Returned:</strong> when state is <em>rendered</em></p> <p class="ansible-option-line ansible-option-sample"><strong class="ansible-option-sample-bold">Sample:</strong> <code>["&lt;rpc-reply&gt; &lt;configuration&gt; &lt;security&gt; &lt;policies&gt; &lt;global&gt; &lt;policy&gt; &lt;name&gt;test_glob_1&lt;/name&gt; &lt;match&gt; &lt;source-address&gt;any-ipv6&lt;/source-address&gt; &lt;destination-address&gt;any-ipv6&lt;/destination-address&gt; &lt;application&gt;any&lt;/application&gt; &lt;/match&gt; &lt;then&gt; &lt;deny /&gt; &lt;/then&gt; &lt;/policy&gt; &lt;/global&gt; &lt;/policies&gt; &lt;/security&gt; &lt;/configuration&gt; &lt;/rpc-reply&gt;"]</code></p> </div></td> </tr>  </table> <section id="authors"> <h3>Authors</h3> <ul class="simple"> <li>Pranav Bhatt (@pranav-bhatt)</li> </ul> </section> <section id="collection-links"> <h3>Collection links</h3> <ul class="ansible-links"> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/junipernetworks.junos/issues" rel="noopener external" target="_blank">Issue Tracker</a></span></li> <li><span><a aria-role="button" class="ansible-link reference external" href="https://github.com/ansible-collections/junipernetworks.junos" rel="noopener external" target="_blank">Repository (Sources)</a></span></li> </ul> </section> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/collections/junipernetworks/junos/junos_security_zones_module.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/collections/junipernetworks/junos/junos_security_zones_module.html</a>
  </p>
</div>
