<section id="ansible-base-2-10-porting-guide"> <h1 id="porting-2-10-guide-base">Ansible-base 2.10 Porting Guide</h1> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>In preparation for the release of 2.10, many plugins and modules have migrated to Collections on <a class="reference external" href="https://galaxy.ansible.com">Ansible Galaxy</a>. For the current development status of Collections and FAQ see <a class="reference external" href="https://github.com/ansible-collections/overview/blob/main/README.rst">Ansible Collections Community Guide</a>. We expect the 2.10 Porting Guide to change frequently up to the 2.10 release. Follow the conversations about collections on our various <a class="reference internal" href="https://docs.ansible.com/ansible/latest/community/communication.html#communication"><span class="std std-ref">Communicating with the Ansible community</span></a> channels for the latest information on the status of the <code>devel</code> branch.</p> </div> <p>This section discusses the behavioral changes between Ansible 2.9 and Ansible-base 2.10.</p> <p>It is intended to assist in updating your playbooks, plugins and other parts of your Ansible infrastructure so they will work with this version of Ansible-base.</p> <p>We suggest you read this page along with the <a class="reference external" href="https://github.com/ansible/ansible/blob/stable-2.10/changelogs/CHANGELOG-v2.10.rst">Ansible-base Changelog for 2.10</a> to understand what updates you may need to make.</p> <p>Ansible-base is mainly of interest for developers and users who only want to use a small, controlled subset of the available collections. Regular users should install ansible.</p> <p>The complete list of porting guides can be found at <a class="reference internal" href="porting_guides.html#porting-guides"><span class="std std-ref">porting guides</span></a>.</p>   <ul> <li><a class="reference internal" href="#playbook" id="id2">Playbook</a></li> <li><a class="reference internal" href="#command-line" id="id3">Command Line</a></li> <li><a class="reference internal" href="#deprecated" id="id4">Deprecated</a></li> <li>
<p><a class="reference internal" href="#modules" id="id5">Modules</a></p> <ul> <li><a class="reference internal" href="#noteworthy-module-changes" id="id6">Noteworthy module changes</a></li> </ul> </li> <li>
<p><a class="reference internal" href="#plugins" id="id7">Plugins</a></p> <ul> <li><a class="reference internal" href="#lookup-plugin-names-case-sensitivity" id="id8">Lookup plugin names case-sensitivity</a></li> <li><a class="reference internal" href="#noteworthy-plugin-changes" id="id9">Noteworthy plugin changes</a></li> <li><a class="reference internal" href="#action-plugins-which-execute-modules-should-use-fully-qualified-module-names" id="id10">Action plugins which execute modules should use fully-qualified module names</a></li> </ul> </li> <li><a class="reference internal" href="#porting-custom-scripts" id="id11">Porting custom scripts</a></li> </ul>
  <section id="playbook"> <h2>Playbook</h2> <ul class="simple"> <li>Fixed a bug on boolean keywords that made random strings return ‘False’, now they should return an error if they are not a proper boolean Example: <code>diff: yes-</code> was returning <code>False</code>.</li> <li>A new fact, <code>ansible_processor_nproc</code> reflects the number of vcpus available to processes (falls back to the number of vcpus available to the scheduler).</li> </ul> </section> <section id="command-line"> <h2>Command Line</h2> <ul class="simple"> <li>The <code>ansible-galaxy login</code> command has been removed, as the underlying API it used for GitHub auth is being shut down. Publishing roles or collections to Galaxy through <code>ansible-galaxy</code> now requires that a Galaxy API token be passed to the CLI through a token file (default location <code>~/.ansible/galaxy_token</code>) or (insecurely) through the <code>--token</code> argument to <code>ansible-galaxy</code>.</li> </ul> </section> <section id="deprecated"> <h2>Deprecated</h2> <ul class="simple"> <li>Windows Server 2008 and 2008 R2 will no longer be supported or tested in the next Ansible release, see <a class="reference external" href="https://docs.ansible.com/ansible-core/2.15/os_guide/windows_faq.html#are-server-2008-2008-r2-and-windows-7-supported">Are Server 2008, 2008 R2 and Windows 7 supported?</a>.</li> </ul> </section> <section id="modules"> <h2>Modules</h2> <div class="admonition warning"> <p class="admonition-title">Warning</p> <p>Links on this page may not point to the most recent versions of modules. We will update them when we can.</p> </div> <ul class="simple"> <li>Version 2.10.0 of ansible-base changed the default mode of file-based tasks to <code>0o600 &amp; ~umask</code> when the user did not specify a <code>mode</code> parameter on file-based tasks. This was in response to a CVE report which we have reconsidered. As a result, the mode change has been reverted in 2.10.1, and mode will now default to <code>0o666 &amp; ~umask</code> as in previous versions of Ansible.</li> <li>If you changed any tasks to specify less restrictive permissions while using 2.10.0, those changes will be unnecessary (but will do no harm) in 2.10.1.</li> <li>To avoid the issue raised in CVE-2020-1736, specify a <code>mode</code> parameter in all file-based tasks that accept it.</li> <li>
<code>dnf</code> and <code>yum</code> - As of version 2.10.1, the <code>dnf</code> module (and <code>yum</code> action when it uses <code>dnf</code>) now correctly validates GPG signatures of packages (CVE-2020-14365). If you see an error such as <code>Failed to validate GPG signature for [package name]</code>, please ensure that you have imported the correct GPG key for the DNF repository and/or package you are using. One way to do this is with the <code>rpm_key</code> module. Although we discourage it, in some cases it may be necessary to disable the GPG check. This can be done by explicitly adding <code>disable_gpg_check: yes</code> in your <code>dnf</code> or <code>yum</code> task.</li> </ul> <section id="noteworthy-module-changes"> <h3>Noteworthy module changes</h3> <ul class="simple"> <li>Ansible modules created with <code>add_file_common_args=True</code> added a number of undocumented arguments which were mostly there to ease implementing certain action plugins. The undocumented arguments <code>src</code>, <code>follow</code>, <code>force</code>, <code>content</code>, <code>backup</code>, <code>remote_src</code>, <code>regexp</code>, <code>delimiter</code>, and <code>directory_mode</code> are now no longer added. Modules relying on these options to be added need to specify them by themselves.</li> <li>Ansible no longer looks for Python modules in the current working directory (typically the <code>remote_user</code>’s home directory) when an Ansible module is run. This is to fix becoming an unprivileged user on OpenBSD and to mitigate any attack vector if the current working directory is writable by a malicious user. Install any Python modules needed to run the Ansible modules on the managed node in a system-wide location or in another directory which is in the <code>remote_user</code>’s <code>$PYTHONPATH</code> and readable by the <code>become_user</code>.</li> </ul> </section> </section> <section id="plugins"> <h2>Plugins</h2> <section id="lookup-plugin-names-case-sensitivity"> <h3>Lookup plugin names case-sensitivity</h3> <ul class="simple"> <li>Prior to Ansible <code>2.10</code> lookup plugin names passed in as an argument to the <code>lookup()</code> function were treated as case-insensitive as opposed to lookups invoked through <code>with_&lt;lookup_name&gt;</code>. <code>2.10</code> brings consistency to <code>lookup()</code> and <code>with_</code> to be both case-sensitive.</li> </ul> </section> <section id="noteworthy-plugin-changes"> <h3>Noteworthy plugin changes</h3> <ul class="simple"> <li>Cache plugins in collections can be used to cache data from inventory plugins. Previously, cache plugins in collections could only be used for fact caching.</li> <li>Some undocumented arguments from <code>FILE_COMMON_ARGUMENTS</code> have been removed; plugins using these, in particular action plugins, need to be adjusted. The undocumented arguments which were removed are <code>src</code>, <code>follow</code>, <code>force</code>, <code>content</code>, <code>backup</code>, <code>remote_src</code>, <code>regexp</code>, <code>delimiter</code>, and <code>directory_mode</code>.</li> </ul> </section> <section id="action-plugins-which-execute-modules-should-use-fully-qualified-module-names"> <h3>Action plugins which execute modules should use fully-qualified module names</h3> <ul class="simple"> <li>Action plugins that call modules should pass explicit, fully-qualified module names to <code>_execute_module()</code> whenever possible (eg, <code>ansible.builtin.file</code> rather than <code>file</code>). This ensures that the task’s collection search order is not consulted to resolve the module. Otherwise, a module from a collection earlier in the search path could be used when not intended.</li> </ul> </section> </section> <section id="porting-custom-scripts"> <h2>Porting custom scripts</h2> <p>No notable changes</p> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/porting_guides/porting_guide_base_2.10.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/porting_guides/porting_guide_base_2.10.html</a>
  </p>
</div>
