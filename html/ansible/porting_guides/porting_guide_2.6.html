<section id="ansible-2-6-porting-guide"> <h1 id="porting-2-6-guide">Ansible 2.6 Porting Guide</h1> <p>This section discusses the behavioral changes between Ansible 2.5 and Ansible 2.6.</p> <p>It is intended to assist in updating your playbooks, plugins and other parts of your Ansible infrastructure so they will work with this version of Ansible.</p> <p>We suggest you read this page along with <a class="reference external" href="https://github.com/ansible/ansible/blob/stable-2.6/changelogs/CHANGELOG-v2.6.rst">Ansible Changelog for 2.6</a> to understand what updates you may need to make.</p> <p>This document is part of a collection on porting. The complete list of porting guides can be found at <a class="reference internal" href="porting_guides.html#porting-guides"><span class="std std-ref">porting guides</span></a>.</p>   <ul> <li><a class="reference internal" href="#playbook" id="id3">Playbook</a></li> <li><a class="reference internal" href="#deprecated" id="id4">Deprecated</a></li> <li>
<p><a class="reference internal" href="#modules" id="id5">Modules</a></p> <ul> <li><a class="reference internal" href="#modules-removed" id="id6">Modules removed</a></li> <li><a class="reference internal" href="#deprecation-notices" id="id7">Deprecation notices</a></li> <li><a class="reference internal" href="#noteworthy-module-changes" id="id8">Noteworthy module changes</a></li> </ul> </li> <li>
<p><a class="reference internal" href="#plugins" id="id9">Plugins</a></p> <ul> <li><a class="reference internal" href="#id1" id="id10">Deprecation notices</a></li> <li><a class="reference internal" href="#noteworthy-plugin-changes" id="id11">Noteworthy plugin changes</a></li> </ul> </li> <li><a class="reference internal" href="#porting-custom-scripts" id="id12">Porting custom scripts</a></li> <li><a class="reference internal" href="#networking" id="id13">Networking</a></li> <li><a class="reference internal" href="#dynamic-inventory-scripts" id="id14">Dynamic inventory scripts</a></li> </ul>
  <section id="playbook"> <h2>Playbook</h2> <ul class="simple"> <li>The deprecated task option <code>always_run</code> has been removed, please use <code>check_mode: no</code> instead.</li> </ul> </section> <section id="deprecated"> <h2>Deprecated</h2> <ul class="simple"> <li>In the <a class="reference external" href="https://docs.ansible.com/ansible/2.9/modules/nxos_igmp_interface_module.html#nxos-igmp-interface-module" title="(in Ansible v2.9)"><span class="xref std std-ref">nxos_igmp_interface module</span></a>, <code>oif_prefix</code> and <code>oif_source</code> properties are deprecated. Use <code>ois_ps</code> parameter with a dictionary of prefix and source to values instead.</li> </ul> </section> <section id="modules"> <h2>Modules</h2> <p>Major changes in popular modules are detailed here:</p> <section id="modules-removed"> <h3>Modules removed</h3> <p>The following modules no longer exist:</p> </section> <section id="deprecation-notices"> <h3>Deprecation notices</h3> <p>The following modules will be removed in Ansible 2.10. Please update your playbooks accordingly.</p> <ul class="simple"> <li>
<code>k8s_raw</code> use <a class="reference external" href="https://docs.ansible.com/ansible/2.9/modules/k8s_module.html#k8s-module" title="(in Ansible v2.9)"><span class="xref std std-ref">k8s</span></a> instead.</li> <li>
<code>openshift_raw</code> use <a class="reference external" href="https://docs.ansible.com/ansible/2.9/modules/k8s_module.html#k8s-module" title="(in Ansible v2.9)"><span class="xref std std-ref">k8s</span></a> instead.</li> <li>
<code>openshift_scale</code> use <a class="reference external" href="https://docs.ansible.com/ansible/2.9/modules/k8s_scale_module.html#k8s-scale-module" title="(in Ansible v2.9)"><span class="xref std std-ref">k8s_scale</span></a> instead.</li> </ul> </section> <section id="noteworthy-module-changes"> <h3>Noteworthy module changes</h3> <ul> <li>The <code>upgrade</code> module option for <code>win_chocolatey</code> has been removed; use <code>state: latest</code> instead.</li> <li>The <code>reboot</code> module option for <code>win_feature</code> has been removed; use the <code>win_reboot</code> action plugin instead.</li> <li>The <code>win_iis_webapppool</code> module no longer accepts a string for the <code>attributes</code> module option; use the free form dictionary value instead.</li> <li>The <code>name</code> module option for <code>win_package</code> has been removed; this is not used anywhere and should just be removed from your playbooks.</li> <li>The <code>win_regedit</code> module no longer automatically corrects the hive path <code>HCCC</code> to <code>HKCC</code>; use <code>HKCC</code> because this is the correct hive path.</li> <li>
<p>The <a class="reference external" href="https://docs.ansible.com/ansible/9/collections/ansible/builtin/file_module.html#file-module" title="(in Ansible v9)"><span class="xref std std-ref">file_module</span></a> now emits a deprecation warning when <code>src</code> is specified with a state other than <code>hard</code> or <code>link</code> as it is only supposed to be useful with those. This could have an effect on people who were depending on a buggy interaction between src and other stateâ€™s to place files into a subdirectory. For example:</p> <pre data-language="YAML+Jinja">$ ansible localhost -m file -a 'path=/var/lib src=/tmp/ state=directory'
</pre> <p>Would create a directory named <code>/tmp/lib</code>. Instead of the above, simply spell out the entire destination path like this:</p> <pre data-language="YAML+Jinja">$ ansible localhost -m file -a 'path=/tmp/lib state=directory'
</pre> </li> <li>The <code>k8s_raw</code> and <code>openshift_raw</code> modules have been aliased to the new <code>k8s</code> module.</li> <li>The <code>k8s</code> module supports all Kubernetes resources including those from Custom Resource Definitions and aggregated API servers. This includes all OpenShift resources.</li> <li>The <code>k8s</code> module will not accept resources where subkeys have been snake_cased. This was a workaround that was suggested with the <code>k8s_raw</code> and <code>openshift_raw</code> modules.</li> <li>The <code>k8s</code> module may not accept resources where the <code>api_version</code> has been changed to match the shortened version in the Kubernetes Python client. You should now specify the proper full Kubernetes <code>api_version</code> for a resource.</li> <li>The <code>k8s</code> module can now process multi-document YAML files if they are passed with the <code>src</code> parameter. It will process each document as a separate resource. Resources provided inline with the <code>resource_definition</code> parameter must still be a single document.</li> <li>The <code>k8s</code> module will not automatically change <code>Project</code> creation requests into <code>ProjectRequest</code> creation requests as the <code>openshift_raw</code> module did. You must now specify the <code>ProjectRequest</code> kind explicitly.</li> <li>The <code>k8s</code> module will not automatically remove secrets from the Ansible return values (and by extension the log). In order to prevent secret values in a task from being logged, specify the <code>no_log</code> parameter on the task block.</li> <li>The <code>k8s_scale</code> module now supports scalable OpenShift objects, such as <code>DeploymentConfig</code>.</li> <li>The <code>lineinfile</code> module was changed to show a warning when using an empty string as a regexp. Since an empty regexp matches every line in a file, it will replace the last line in a file rather than inserting. If this is the desired behavior, use <code>'^'</code> which will match every line and will not trigger the warning.</li> <li>Openstack modules are no longer using <code>shade</code> library. Instead <code>openstacksdk</code> is used. Since <code>openstacksdk</code> should be already present as a dependency to <code>shade</code> no additional actions are required.</li> </ul> </section> </section> <section id="plugins"> <h2>Plugins</h2> <section id="id1"> <h3>Deprecation notices</h3> <p>The following modules will be removed in Ansible 2.10. Please update your playbooks accordingly.</p> <ul class="simple"> <li>
<code>openshift</code> use <code>k8s</code> instead.</li> </ul> </section> <section id="noteworthy-plugin-changes"> <h3>Noteworthy plugin changes</h3> <ul class="simple"> <li>The <code>k8s</code> lookup plugin now supports all Kubernetes resources including those from Custom Resource Definitions and aggregated API servers. This includes all OpenShift resources.</li> <li>The <code>k8s</code> lookup plugin may not accept resources where the <code>api_version</code> has been changed to match the shortened version in the Kubernetes Python client. You should now specify the proper full Kubernetes <code>api_version</code> for a resource.</li> <li>The <code>k8s</code> lookup plugin will no longer remove secrets from the Ansible return values (and by extension the log). In order to prevent secret values in a task from being logged, specify the <code>no_log</code> parameter on the task block.</li> </ul> </section> </section> <section id="porting-custom-scripts"> <h2>Porting custom scripts</h2> <p>No notable changes.</p> </section> <section id="networking"> <h2>Networking</h2> <p>No notable changes.</p> </section> <section id="dynamic-inventory-scripts"> <h2>Dynamic inventory scripts</h2> <ul class="simple"> <li>
<code>contrib/inventory/openstack.py</code> has been renamed to <code>contrib/inventory/openstack_inventory.py</code>. If you have used <code>openstack.py</code> as a name for your OpenStack dynamic inventory file, change it to <code>openstack_inventory.py</code>. Otherwise the file name will conflict with imports from <code>openstacksdk</code>.</li> </ul> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/porting_guides/porting_guide_2.6.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/porting_guides/porting_guide_2.6.html</a>
  </p>
</div>
