<section id="ansible-core-2-13-porting-guide"> <h1 id="porting-2-13-guide-core">Ansible-core 2.13 Porting Guide</h1> <p>This section discusses the behavioral changes between <code>ansible-core</code> 2.12 and <code>ansible-core</code> 2.13.</p> <p>It is intended to assist in updating your playbooks, plugins and other parts of your Ansible infrastructure so they will work with this version of Ansible.</p> <p>We suggest you read this page along with <a class="reference external" href="https://github.com/ansible/ansible/blob/stable-2.13/changelogs/CHANGELOG-v2.13.rst">ansible-core Changelog for 2.13</a> to understand what updates you may need to make.</p> <p>This document is part of a collection on porting. The complete list of porting guides can be found at <a class="reference internal" href="porting_guides.html#porting-guides"><span class="std std-ref">porting guides</span></a>.</p>   <ul> <li><a class="reference internal" href="#playbook" id="id2">Playbook</a></li> <li><a class="reference internal" href="#command-line" id="id3">Command Line</a></li> <li><a class="reference internal" href="#deprecated" id="id4">Deprecated</a></li> <li>
<p><a class="reference internal" href="#modules" id="id5">Modules</a></p> <ul> <li><a class="reference internal" href="#modules-removed" id="id6">Modules removed</a></li> <li><a class="reference internal" href="#deprecation-notices" id="id7">Deprecation notices</a></li> <li><a class="reference internal" href="#noteworthy-module-changes" id="id8">Noteworthy module changes</a></li> <li><a class="reference internal" href="#breaking-changes" id="id9">Breaking Changes</a></li> </ul> </li> <li><a class="reference internal" href="#plugins" id="id10">Plugins</a></li> <li><a class="reference internal" href="#porting-custom-scripts" id="id11">Porting custom scripts</a></li> <li><a class="reference internal" href="#networking" id="id12">Networking</a></li> </ul>
  <section id="playbook"> <h2>Playbook</h2> <ul class="simple"> <li>Templating - You can no longer perform arithmetic and concatenation operations outside of the jinja template. The following statement will need to be rewritten to produce <code>[1, 2]</code>:</li> </ul>  <pre data-language="yaml">- name: Prior to 2.13
  debug:
    msg: '[1] + {{ [2] }}'

- name: 2.13 and forward
  debug:
    msg: '{{ [1] + [2] }}'
</pre>  <ul class="simple"> <li>The return value of the <code>__repr__</code> method of an undefined variable represented by the <code>AnsibleUndefined</code> object changed. <code>{{ '%r'|format(undefined_variable) }}</code> returns <code>AnsibleUndefined(hint=None, obj=missing, name='undefined_variable')</code> in 2.13 as opposed to just <code>AnsibleUndefined</code> in versions 2.12 and prior.</li> <li>The <code>finalize</code> method is no longer exposed in the globals for use in templating. To convert <code>None</code> to an empty string the following expression can be used: <code>{{ value if value is not none }}</code>.</li> </ul> </section> <section id="command-line"> <h2>Command Line</h2> <p>No notable changes</p> </section> <section id="deprecated"> <h2>Deprecated</h2> <p>No notable changes</p> </section> <section id="modules"> <h2>Modules</h2> <ul class="simple"> <li>To use ansible-core 2.13 for module execution, you must use Python 2 version 2.7 or Python 3 version 3.5 or newer. Any code utilizing <code>ansible.module_utils.basic</code> will not function with lower Python versions.</li> </ul> <section id="modules-removed"> <h3>Modules removed</h3> <p>The following modules no longer exist:</p> <ul class="simple"> <li>No notable changes</li> </ul> </section> <section id="deprecation-notices"> <h3>Deprecation notices</h3> <p>No notable changes</p> </section> <section id="noteworthy-module-changes"> <h3>Noteworthy module changes</h3> <p>No notable changes</p> </section> <section id="breaking-changes"> <h3>Breaking Changes</h3> <ul class="simple"> <li>
<code>ansible.module_utils.urls.fetch_url</code> will now return the captured <code>HTTPError</code> exception as <code>r</code>. <code>HTTPError</code> is a response like object that can offer more information to module authors. Modules should rely on <code>info['status'] &gt;= 400</code> to determine if there was a failure, instead of using <code>r is None</code> or catching <code>AttributeError</code> when attempting <code>r.read()</code>.</li> </ul> </section> </section> <section id="plugins"> <h2>Plugins</h2> <p>No notable changes</p> </section> <section id="porting-custom-scripts"> <h2>Porting custom scripts</h2> <p>No notable changes</p> </section> <section id="networking"> <h2>Networking</h2> <p>No notable changes</p> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/porting_guides/porting_guide_core_2.13.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/porting_guides/porting_guide_core_2.13.html</a>
  </p>
</div>
