<section id="working-with-playbooks"> <h1 id="id1">Working with playbooks</h1> <p>Playbooks record and execute Ansible’s configuration, deployment, and orchestration functions. They can describe a policy you want your remote systems to enforce, or a set of steps in a general IT process.</p> <p>If Ansible modules are the tools in your workshop, playbooks are your instruction manuals, and your inventory of hosts is your raw material.</p> <p>At a basic level, playbooks can be used to manage configurations of and deployments to remote machines. At a more advanced level, they can sequence multi-tier rollouts involving rolling updates and can delegate actions to other hosts, interacting with monitoring servers and load balancers along the way.</p> <p>Playbooks are designed to be human-readable and are developed in a basic text language. There are multiple ways to organize playbooks and the files they include, and we’ll offer up some suggestions on that and making the most out of Ansible.</p>  <ul> <li class="toctree-l1">
<a class="reference internal" href="playbooks_templating.html">Templating (Jinja2)</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_templating.html#jinja2-example">Jinja2 Example</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_filters.html">Using filters to manipulate data</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#handling-undefined-variables">Handling undefined variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#defining-different-values-for-true-false-null-ternary">Defining different values for true/false/null (ternary)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#managing-data-types">Managing data types</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#formatting-data-yaml-and-json">Formatting data: YAML and JSON</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#combining-and-selecting-data">Combining and selecting data</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#randomizing-data">Randomizing data</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#managing-list-variables">Managing list variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#selecting-from-sets-or-lists-set-theory">Selecting from sets or lists (set theory)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#calculating-numbers-math">Calculating numbers (math)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#managing-network-interactions">Managing network interactions</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#hashing-and-encrypting-strings-and-passwords">Hashing and encrypting strings and passwords</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#manipulating-text">Manipulating text</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#manipulating-strings">Manipulating strings</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#managing-uuids">Managing UUIDs</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#handling-dates-and-times">Handling dates and times</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_filters.html#getting-kubernetes-resource-names">Getting Kubernetes resource names</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_tests.html">Tests</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#test-syntax">Test syntax</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-strings">Testing strings</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#vault">Vault</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-truthiness">Testing truthiness</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#comparing-versions">Comparing versions</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#set-theory-tests">Set theory tests</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-if-a-list-contains-a-value">Testing if a list contains a value</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-if-a-list-value-is-true">Testing if a list value is True</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-paths">Testing paths</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-size-formats">Testing size formats</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#testing-task-results">Testing task results</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_tests.html#type-tests">Type Tests</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_lookups.html">Lookups</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_lookups.html#using-lookups-in-variables">Using lookups in variables</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_python_version.html">Python3 in templates</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_python_version.html#dictionary-views">Dictionary views</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_python_version.html#dict-iteritems">dict.iteritems()</a></li> </ul> </li> <li class="toctree-l1"><a class="reference internal" href="playbooks_templating_now.html">The now function: get the current time</a></li> <li class="toctree-l1"><a class="reference internal" href="playbooks_templating_undef.html">The undef function: add hint for undefined variables</a></li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_loops.html">Loops</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html#comparing-loops">Comparing loops</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html#using-loops">Using loops</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html#ensuring-list-input-for-loop-using-query-rather-than-lookup">Ensuring list input for <code>loop</code>: using <code>query</code> rather than <code>lookup</code></a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html#adding-controls-to-loops">Adding controls to loops</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html#nested-loops">Nested Loops</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_loops.html#migrating-from-with-x-to-loop">Migrating from with_X to loop</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_delegation.html">Controlling where tasks run: delegation and local actions</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html#tasks-that-cannot-be-delegated">Tasks that cannot be delegated</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html#delegating-tasks">Delegating tasks</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html#templating-in-delegation-context">Templating in delegation context</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html#delegation-and-parallel-execution">Delegation and parallel execution</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html#delegating-facts">Delegating facts</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_delegation.html#local-playbooks">Local playbooks</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_conditionals.html">Conditionals</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_conditionals.html#basic-conditionals-with-when">Basic conditionals with <code>when</code></a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_conditionals.html#debugging-conditionals">Debugging conditionals</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_conditionals.html#commonly-used-facts">Commonly-used facts</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_blocks.html">Blocks</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_blocks.html#grouping-tasks-with-blocks">Grouping tasks with blocks</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_blocks.html#handling-errors-with-blocks">Handling errors with blocks</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_handlers.html">Handlers: running operations on change</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#handler-example">Handler example</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#notifying-handlers">Notifying handlers</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#naming-handlers">Naming handlers</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#controlling-when-handlers-run">Controlling when handlers run</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#defining-when-tasks-change">Defining when tasks change</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#using-variables-with-handlers">Using variables with handlers</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#handlers-in-roles">Handlers in roles</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#includes-and-imports-in-handlers">Includes and imports in handlers</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#meta-tasks-as-handlers">Meta tasks as handlers</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_handlers.html#limitations">Limitations</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_error_handling.html">Error handling in playbooks</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#ignoring-failed-commands">Ignoring failed commands</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#ignoring-unreachable-host-errors">Ignoring unreachable host errors</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#resetting-unreachable-hosts">Resetting unreachable hosts</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#handlers-and-failure">Handlers and failure</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#defining-failure">Defining failure</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#defining-changed">Defining “changed”</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#ensuring-success-for-command-and-shell">Ensuring success for command and shell</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#aborting-a-play-on-all-hosts">Aborting a play on all hosts</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_error_handling.html#controlling-errors-in-blocks">Controlling errors in blocks</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_environment.html">Setting the remote environment</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_environment.html#setting-the-remote-environment-in-a-task">Setting the remote environment in a task</a></li> </ul> </li> <li class="toctree-l1"><a class="reference internal" href="playbooks_environment.html#working-with-language-specific-version-managers">Working with language-specific version managers</a></li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_reuse.html">Re-using Ansible artifacts</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse.html#creating-reusable-files-and-roles">Creating reusable files and roles</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse.html#re-using-playbooks">Re-using playbooks</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse.html#when-to-turn-a-playbook-into-a-role">When to turn a playbook into a role</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse.html#re-using-files-and-roles">Re-using files and roles</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse.html#re-using-tasks-as-handlers">Re-using tasks as handlers</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_reuse_roles.html">Roles</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#role-directory-structure">Role directory structure</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#storing-and-finding-roles">Storing and finding roles</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#using-roles">Using roles</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#role-argument-validation">Role argument validation</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#running-a-role-multiple-times-in-one-play">Running a role multiple times in one play</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#using-role-dependencies">Using role dependencies</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#embedding-modules-and-plugins-in-roles">Embedding modules and plugins in roles</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_reuse_roles.html#sharing-roles-ansible-galaxy">Sharing roles: Ansible Galaxy</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_module_defaults.html">Module defaults</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_module_defaults.html#module-defaults-groups">Module defaults groups</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_prompts.html">Interactive input: prompts</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_prompts.html#hashing-values-supplied-by-vars-prompt">Hashing values supplied by <code>vars_prompt</code></a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_prompts.html#allowing-special-characters-in-vars-prompt-values">Allowing special characters in <code>vars_prompt</code> values</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_variables.html">Using Variables</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#creating-valid-variable-names">Creating valid variable names</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#simple-variables">Simple variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#when-to-quote-variables-a-yaml-gotcha">When to quote variables (a YAML gotcha)</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#boolean-variables">Boolean variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#list-variables">List variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#dictionary-variables">Dictionary variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#combining-variables">Combining variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#registering-variables">Registering variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#referencing-nested-variables">Referencing nested variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#transforming-variables-with-jinja2-filters">Transforming variables with Jinja2 filters</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#where-to-set-variables">Where to set variables</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#variable-precedence-where-should-i-put-a-variable">Variable precedence: Where should I put a variable?</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_variables.html#using-advanced-variable-syntax">Using advanced variable syntax</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="playbooks_vars_facts.html">Discovering variables: facts and magic variables</a><ul> <li class="toctree-l2"><a class="reference internal" href="playbooks_vars_facts.html#ansible-facts">Ansible facts</a></li> <li class="toctree-l2"><a class="reference internal" href="playbooks_vars_facts.html#information-about-ansible-magic-variables">Information about Ansible: magic variables</a></li> </ul> </li> <li class="toctree-l1">
<a class="reference internal" href="guide_rolling_upgrade.html">Playbook Example: Continuous Delivery and Rolling Upgrades</a><ul> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#what-is-continuous-delivery">What is continuous delivery?</a></li> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#site-deployment">Site deployment</a></li> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#reusable-content-roles">Reusable content: roles</a></li> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#configuration-group-variables">Configuration: group variables</a></li> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#the-rolling-upgrade">The rolling upgrade</a></li> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#managing-other-load-balancers">Managing other load balancers</a></li> <li class="toctree-l2"><a class="reference internal" href="guide_rolling_upgrade.html#continuous-delivery-end-to-end">Continuous delivery end-to-end</a></li> </ul> </li> </ul>  </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/playbook_guide/playbooks.html</a>
  </p>
</div>
