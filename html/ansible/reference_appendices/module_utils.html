<section id="ansible-reference-module-utilities"> <h1 id="ansible-module-utils">Ansible Reference: Module Utilities</h1> <p>This page documents utilities intended to be helpful when writing Ansible modules in Python.</p> <section id="ansiblemodule"> <h2>AnsibleModule</h2> <p>To use this functionality, include <code>from ansible.module_utils.basic import AnsibleModule</code> in your module.</p> <dl class="py class"> <dt class="sig sig-object py"> <em class="property">class</em><span class="sig-prename descclassname">ansible.module_utils.basic.</span><span class="sig-name descname">AnsibleModule</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">argument_spec</span></em>, <em class="sig-param"><span class="n">bypass_checks</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">no_log</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">mutually_exclusive</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">required_together</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">required_one_of</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">add_file_common_args</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">supports_check_mode</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">required_if</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">required_by</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Common code for quickly building an ansible module in Python (although you can write modules with anything that can return JSON).</p> <p>See <a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_modules_general.html#developing-modules-general"><span class="std std-ref">Developing modules</span></a> for a general introduction and <a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_program_flow_modules.html#developing-program-flow-modules"><span class="std std-ref">Ansible module architecture</span></a> for more detailed explanation.</p> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">add_path_info</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">kwargs</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>for results that are files, supplement the info about the file in the return path with stats about the file path.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">atomic_move</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">src</span></em>, <em class="sig-param"><span class="n">dest</span></em>, <em class="sig-param"><span class="n">unsafe_writes</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">keep_dest_attrs</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>atomically move src to dest, copying attributes from dest, returns true on success it uses os.rename to ensure this as it is an atomic operation, rest of the function is to work around limitations, corner cases and ensure selinux context is saved if possible</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">backup_local</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">fn</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>make a date-marked backup of the specified file, return True or False on success or failure</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">boolean</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Convert the argument to a boolean</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">digest_from_file</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">algorithm</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Return hex digest of local file for a digest_method specified by name, or None if file is not present.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">exit_json</span><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>return from the module, without error</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">fail_json</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>return from the module, with an error message</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">find_mount_point</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span>
</dt> <dd> <p>Takes a path and returns its mount point</p>  <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>path</strong> – a string type with a filesystem path</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>the path to the mount point as a text type</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">get_bin_path</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">arg</span></em>, <em class="sig-param"><span class="n">required</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">opt_dirs</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Find system executable in PATH.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>arg</strong> – The executable to find.</li> <li>
<strong>required</strong> – if executable is not found and required is <code>True</code>, fail_json</li> <li>
<strong>opt_dirs</strong> – optional list of directories to search in addition to <code>PATH</code>
</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>if found return full path; otherwise return None</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">is_executable</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>is the given path executable?</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>path</strong> – The path of the file to check.</p> </dd> </dl> <p>Limitations:</p> <ul class="simple"> <li>Does not account for FSACLs.</li> <li>Most times we really want to know “Can the current user execute this file”. This function does not tell us that, only if any execute bit is set.</li> </ul> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">is_special_selinux_path</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Returns a tuple containing (True, selinux_context) if the given path is on a NFS or other ‘special’ fs mount point, otherwise the return will be (False, None).</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">load_file_common_arguments</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>many modules deal with files, this encapsulates common options that the file module accepts such that it is directly available to all modules and they can share code.</p> <p>Allows to overwrite the path/dest module argument by providing path.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">md5</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Return MD5 hex digest of local file using digest_from_file().</p> <dl class="simple"> <dt>Do not use this function unless you have no other choice for:</dt>
<dd>
<ol class="arabic simple"> <li>Optional backwards compatibility</li> <li>Compatibility with a third party protocol</li> </ol> </dd> </dl> <p>This function will not work on systems complying with FIPS-140-2.</p> <p>Most uses of this function can use the module.sha1 function instead.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">preserved_copy</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">src</span></em>, <em class="sig-param"><span class="n">dest</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Copy a file with preserved ownership, permissions and context</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">run_command</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">args</span></em>, <em class="sig-param"><span class="n">check_rc</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">close_fds</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">executable</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">data</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">binary_data</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">path_prefix</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cwd</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_unsafe_shell</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">prompt_regex</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">environ_update</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">umask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">encoding</span><span class="o">=</span><span class="default_value">'utf-8'</span></em>, <em class="sig-param"><span class="n">errors</span><span class="o">=</span><span class="default_value">'surrogate_or_strict'</span></em>, <em class="sig-param"><span class="n">expand_user_and_vars</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">pass_fds</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">before_communicate_callback</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ignore_invalid_cwd</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">handle_exceptions</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Execute a command, returns rc, stdout, and stderr.</p> <p>The mechanism of this method for reading stdout and stderr differs from that of CPython subprocess.Popen.communicate, in that this method will stop reading once the spawned command has exited and stdout and stderr have been consumed, as opposed to waiting until stdout/stderr are closed. This can be an important distinction, when taken into account that a forked or backgrounded process may hold stdout or stderr open for longer than the spawned command.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>args</strong> – is the command to run * If args is a list, the command will be run with shell=False. * If args is a string and use_unsafe_shell=False it will split args to a list and run with shell=False * If args is a string and use_unsafe_shell=True it runs with shell=True.</p> </dd> <dt class="field-even">Kw check_rc<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Whether to call fail_json in case of non zero RC. Default False</p> </dd> <dt class="field-odd">Kw close_fds<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>See documentation for subprocess.Popen(). Default True</p> </dd> <dt class="field-even">Kw executable<span class="colon">:</span>
</dt> <dd class="field-even">
<p>See documentation for subprocess.Popen(). Default None</p> </dd> <dt class="field-odd">Kw data<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>If given, information to write to the stdin of the command</p> </dd> <dt class="field-even">Kw binary_data<span class="colon">:</span>
</dt> <dd class="field-even">
<p>If False, append a newline to the data. Default False</p> </dd> <dt class="field-odd">Kw path_prefix<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>If given, additional path to find the command in. This adds to the PATH environment variable so helper commands in the same directory can also be found</p> </dd> <dt class="field-even">Kw cwd<span class="colon">:</span>
</dt> <dd class="field-even">
<p>If given, working directory to run the command inside</p> </dd> <dt class="field-odd">Kw use_unsafe_shell<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>See <code>args</code> parameter. Default False</p> </dd> <dt class="field-even">Kw prompt_regex<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Regex string (not a compiled regex) which can be used to detect prompts in the stdout which would otherwise cause the execution to hang (especially if no input data is specified)</p> </dd> <dt class="field-odd">Kw environ_update<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>dictionary to <em>update</em> environ variables with</p> </dd> <dt class="field-even">Kw umask<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Umask to be used when running the command. Default None</p> </dd> <dt class="field-odd">Kw encoding<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Since we return native strings, on python3 we need to know the encoding to use to transform from bytes to text. If you want to always get bytes back, use encoding=None. The default is “utf-8”. This does not affect transformation of strings given as args.</p> </dd> <dt class="field-even">Kw errors<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Since we return native strings, on python3 we need to transform stdout and stderr from bytes to text. If the bytes are undecodable in the <code>encoding</code> specified, then use this error handler to deal with them. The default is <code>surrogate_or_strict</code> which means that the bytes will be decoded using the surrogateescape error handler if available (available on all python3 versions we support) otherwise a UnicodeError traceback will be raised. This does not affect transformations of strings given as args.</p> </dd> <dt class="field-odd">Kw expand_user_and_vars<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>When <code>use_unsafe_shell=False</code> this argument dictates whether <code>~</code> is expanded in paths and environment variables are expanded before running the command. When <code>True</code> a string such as <code>$SHELL</code> will be expanded regardless of escaping. When <code>False</code> and <code>use_unsafe_shell=False</code> no path or variable expansion will be done.</p> </dd> <dt class="field-even">Kw pass_fds<span class="colon">:</span>
</dt> <dd class="field-even">
<p>When running on Python 3 this argument dictates which file descriptors should be passed to an underlying <code>Popen</code> constructor. On Python 2, this will set <code>close_fds</code> to False.</p> </dd> <dt class="field-odd">Kw before_communicate_callback<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>This function will be called after <code>Popen</code> object will be created but before communicating to the process. (<code>Popen</code> object will be passed to callback as a first argument)</p> </dd> <dt class="field-even">Kw ignore_invalid_cwd<span class="colon">:</span>
</dt> <dd class="field-even">
<p>This flag indicates whether an invalid <code>cwd</code> (non-existent or not a directory) should be ignored or should raise an exception.</p> </dd> <dt class="field-odd">Kw handle_exceptions<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>This flag indicates whether an exception will be handled inline and issue a failed_json or if the caller should handle it.</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>A 3-tuple of return code (integer), stdout (native string), and stderr (native string). On python2, stdout and stderr are both byte strings. On python3, stdout and stderr are text strings converted according to the encoding and errors parameters. If you want byte strings on python3, use encoding=None to turn decoding to text off.</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">sha1</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Return SHA1 hex digest of local file using digest_from_file().</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py"> <span class="sig-name descname">sha256</span><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span>
</dt> <dd>
<p>Return SHA-256 hex digest of local file using digest_from_file().</p> </dd>
</dl> </dd>
</dl> </section> <section id="basic"> <h2>Basic</h2> <p>To use this functionality, include <code>import ansible.module_utils.basic</code> in your module.</p> <dl class="py function" id="module-ansible.module_utils.basic"> <dt class="sig sig-object py" id="ansible.module_utils.basic.get_all_subclasses">
<code>ansible.module_utils.basic.get_all_subclasses(cls)</code> </dt> <dd>
<p><strong>Deprecated</strong>: Use ansible.module_utils.common._utils.get_all_subclasses instead</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.basic.get_platform">
<code>ansible.module_utils.basic.get_platform()</code> </dt> <dd>
<p><strong>Deprecated</strong> Use <a class="reference external" href="https://docs.python.org/3/library/platform.html#platform.system" title="(in Python v3.13)"><code>platform.system()</code></a> directly.</p> <dl class="field-list simple"> <dt class="field-odd">Returns<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Name of the platform the module is running on in a native string</p> </dd> </dl> <p>Returns a native string that labels the platform (“Linux”, “Solaris”, etc). Currently, this is the result of calling <a class="reference external" href="https://docs.python.org/3/library/platform.html#platform.system" title="(in Python v3.13)"><code>platform.system()</code></a>.</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.basic.heuristic_log_sanitize">
<code>ansible.module_utils.basic.heuristic_log_sanitize(data, no_log_values=None)</code> </dt> <dd>
<p>Remove strings that look like passwords from log messages</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.basic.load_platform_subclass">
<code>ansible.module_utils.basic.load_platform_subclass(cls, *args, **kwargs)</code> </dt> <dd>
<p><strong>Deprecated</strong>: Use ansible.module_utils.common.sys_info.get_platform_subclass instead</p> </dd>
</dl> </section> <section id="argument-spec"> <h2>Argument Spec</h2> <p>Classes and functions for validating parameters against an argument spec.</p> <section id="argumentspecvalidator"> <h3>ArgumentSpecValidator</h3> <dl class="py class"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ArgumentSpecValidator">
<code>class ansible.module_utils.common.arg_spec.ArgumentSpecValidator(argument_spec, mutually_exclusive=None, required_together=None, required_one_of=None, required_if=None, required_by=None)</code> </dt> <dd>
<p>Argument spec validation class</p> <p>Creates a validator based on the <code>argument_spec</code> that can be used to validate a number of parameters using the <a class="reference internal" href="#ansible.module_utils.common.arg_spec.ArgumentSpecValidator.validate" title="ansible.module_utils.common.arg_spec.ArgumentSpecValidator.validate"><code>validate()</code></a> method.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>argument_spec</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a><em>]</em>) – Specification of valid parameters and their type. May include nested argument specs.</li> <li>
<strong>mutually_exclusive</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>] or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>]</em><em>]</em>) – List or list of lists of terms that should not be provided together.</li> <li>
<strong>required_together</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>]</em><em>]</em>) – List of lists of terms that are required together.</li> <li>
<strong>required_one_of</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>]</em><em>]</em>) – List of lists of terms, one of which in each list is required.</li> <li>
<strong>required_if</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a>) – List of lists of <code>[parameter, value, [parameters]]</code> where one of <code>[parameters]</code> is required if <code>parameter == value</code>.</li> <li>
<strong>required_by</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)">list</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>]</em><em>]</em>) – Dictionary of parameter names that contain a list of parameters required by each key in the dictionary.</li> </ul> </dd> </dl> <dl class="py method"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ArgumentSpecValidator.validate">
<code>validate(parameters, *args, **kwargs)</code> </dt> <dd>
<p>Validate <code>parameters</code> against argument spec.</p> <p>Error messages in the <a class="reference internal" href="#ansible.module_utils.common.arg_spec.ValidationResult" title="ansible.module_utils.common.arg_spec.ValidationResult"><code>ValidationResult</code></a> may contain no_log values and should be sanitized with <a class="reference internal" href="#ansible.module_utils.common.parameters.sanitize_keys" title="ansible.module_utils.common.parameters.sanitize_keys"><code>sanitize_keys()</code></a> before logging or displaying.</p> <dl class="field-list"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a><em>]</em>) – Parameters to validate against the argument spec</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#ansible.module_utils.common.arg_spec.ValidationResult" title="ansible.module_utils.common.arg_spec.ValidationResult"><code>ValidationResult</code></a> containing validated parameters.</p> </dd> <dt class="field-odd">Simple Example<span class="colon">:</span>
</dt> <dd class="field-odd">
<pre data-language="text">argument_spec = {
    'name': {'type': 'str'},
    'age': {'type': 'int'},
}

parameters = {
    'name': 'bo',
    'age': '42',
}

validator = ArgumentSpecValidator(argument_spec)
result = validator.validate(parameters)

if result.error_messages:
    sys.exit("Validation failed: {0}".format(", ".join(result.error_messages))

valid_params = result.validated_parameters
</pre> </dd> </dl> </dd>
</dl> </dd>
</dl> </section> <section id="validationresult"> <h3>ValidationResult</h3> <dl class="py class"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ValidationResult">
<code>class ansible.module_utils.common.arg_spec.ValidationResult(parameters)</code> </dt> <dd>
<p>Result of argument spec validation.</p> <p>This is the object returned by <a class="reference internal" href="#ansible.module_utils.common.arg_spec.ArgumentSpecValidator.validate" title="ansible.module_utils.common.arg_spec.ArgumentSpecValidator.validate"><code>ArgumentSpecValidator.validate()</code></a> containing the validated parameters and any errors.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>) – Terms to be validated and coerced to the correct type.</p> </dd> </dl> <dl class="py attribute"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ValidationResult.errors">
<code>errors</code> </dt> <dd>
<p><a class="reference internal" href="#ansible.module_utils.errors.AnsibleValidationErrorMultiple" title="ansible.module_utils.errors.AnsibleValidationErrorMultiple"><code>AnsibleValidationErrorMultiple</code></a> containing all <a class="reference internal" href="#ansible.module_utils.errors.AnsibleValidationError" title="ansible.module_utils.errors.AnsibleValidationError"><code>AnsibleValidationError</code></a> objects if there were any failures during validation.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ValidationResult.validated_parameters">
<code>property validated_parameters</code> </dt> <dd>
<p>Validated and coerced parameters.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ValidationResult.unsupported_parameters">
<code>property unsupported_parameters</code> </dt> <dd>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.13)"><code>set</code></a> of unsupported parameter names.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="ansible.module_utils.common.arg_spec.ValidationResult.error_messages">
<code>property error_messages</code> </dt> <dd>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code>list</code></a> of all error messages from each exception in <a class="reference internal" href="#ansible.module_utils.common.arg_spec.ValidationResult.errors" title="ansible.module_utils.common.arg_spec.ValidationResult.errors"><code>errors</code></a>.</p> </dd>
</dl> </dd>
</dl> </section> <section id="module-ansible.module_utils.common.parameters"> <h3 id="parameters">Parameters</h3> <dl class="py data"> <dt class="sig sig-object py" id="ansible.module_utils.common.parameters.DEFAULT_TYPE_VALIDATORS">
<code>ansible.module_utils.common.parameters.DEFAULT_TYPE_VALIDATORS</code> </dt> <dd>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code>dict</code></a> of type names, such as <code>'str'</code>, and the default function used to check that type, <a class="reference internal" href="#ansible.module_utils.common.validation.check_type_str" title="ansible.module_utils.common.validation.check_type_str"><code>check_type_str()</code></a> in this case.</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.parameters.env_fallback">
<code>ansible.module_utils.common.parameters.env_fallback(*args, **kwargs)</code> </dt> <dd>
<p>Load value from environment variable</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.parameters.remove_values">
<code>ansible.module_utils.common.parameters.remove_values(value, no_log_strings)</code> </dt> <dd>
<p>Remove strings in <code>no_log_strings</code> from value.</p> <p>If value is a container type, then remove a lot more.</p> <p>Use of <code>deferred_removals</code> exists, rather than a pure recursive solution, because of the potential to hit the maximum recursion depth when dealing with large amounts of data (see <a class="reference external" href="https://github.com/ansible/ansible/issues/24560">issue #24560</a>).</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.parameters.sanitize_keys">
<code>ansible.module_utils.common.parameters.sanitize_keys(obj, no_log_strings, ignore_keys=frozenset({}))</code> </dt> <dd>
<p>Sanitize the keys in a container object by removing <code>no_log</code> values from key names.</p> <p>This is a companion function to the <a class="reference internal" href="#ansible.module_utils.common.parameters.remove_values" title="ansible.module_utils.common.parameters.remove_values"><code>remove_values()</code></a> function. Similar to that function, we make use of <code>deferred_removals</code> to avoid hitting maximum recursion depth in cases of large data structures.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>obj</strong> – The container object to sanitize. Non-container objects are returned unmodified.</li> <li>
<strong>no_log_strings</strong> – A set of string values we do not want logged.</li> <li>
<strong>ignore_keys</strong> – A set of string values of keys to not sanitize.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>An object with sanitized keys.</p> </dd> </dl> </dd>
</dl> </section> <section id="validation"> <h3>Validation</h3> <p>Standalone functions for validating various parameter types.</p> <dl class="py function" id="module-ansible.module_utils.common.validation"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_missing_parameters">
<code>ansible.module_utils.common.validation.check_missing_parameters(parameters, required_parameters=None)</code> </dt> <dd>
<p>This is for checking for required params when we can not check via argspec because we need more information than is simply given in the argspec.</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if any required parameters are missing</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>required_parameters</strong> – List of parameters to look for in the given parameters.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Empty list or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_mutually_exclusive">
<code>ansible.module_utils.common.validation.check_mutually_exclusive(terms, parameters, options_context=None)</code> </dt> <dd>
<p>Check mutually exclusive terms against argument parameters</p> <p>Accepts a single list or list of lists that are groups of terms that should be mutually exclusive with one another</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>terms</strong> – List of mutually exclusive parameters</li> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>options_context</strong> – List of strings of parent key names if <code>terms</code> are in a sub spec.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Empty list or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_required_arguments">
<code>ansible.module_utils.common.validation.check_required_arguments(argument_spec, parameters, options_context=None)</code> </dt> <dd>
<p>Check all parameters in argument_spec and return a list of parameters that are required but not present in parameters.</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>argument_spec</strong> – Argument spec dictionary containing all parameters and their specification</li> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>options_context</strong> – List of strings of parent key names if <code>argument_spec</code> are in a sub spec.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Empty list or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_required_by">
<code>ansible.module_utils.common.validation.check_required_by(requirements, parameters, options_context=None)</code> </dt> <dd>
<p>For each key in requirements, check the corresponding list to see if they exist in parameters.</p> <p>Accepts a single string or list of values for each key.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>requirements</strong> – Dictionary of requirements</li> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>options_context</strong> – List of strings of parent key names if <code>requirements</code> are in a sub spec.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Empty dictionary or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_required_if">
<code>ansible.module_utils.common.validation.check_required_if(requirements, parameters, options_context=None)</code> </dt> <dd>
<p>Check parameters that are conditionally required</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>requirements</strong> – List of lists specifying a parameter, value, parameters required when the given parameter is the specified value, and optionally a boolean indicating any or all parameters are required.</p> </dd> <dt class="field-even">Example<span class="colon">:</span>
</dt>  </dl> <pre data-language="python">required_if=[
    ['state', 'present', ('path',), True],
    ['someint', 99, ('bool_param', 'string_param')],
]
</pre> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>options_context</strong> – List of strings of parent key names if <code>requirements</code> are in a sub spec.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">

<p>Empty list or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails. The results attribute of the exception contains a list of dictionaries. Each dictionary is the result of evaluating each item in requirements. Each return dictionary contains the following keys:</p>  <dl class="field-list simple"> <dt class="field-odd">key missing<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>List of parameters that are required but missing</p> </dd> <dt class="field-even">key requires<span class="colon">:</span>
</dt> <dd class="field-even">
<p>’any’ or ‘all’</p> </dd> <dt class="field-odd">key parameter<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Parameter name that has the requirement</p> </dd> <dt class="field-even">key value<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Original value of the parameter</p> </dd> <dt class="field-odd">key requirements<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>Original required parameters</p> </dd> </dl>  <dl class="field-list simple"> <dt class="field-odd">Example<span class="colon">:</span>
</dt>  </dl> <pre data-language="python">[
    {
        'parameter': 'someint',
        'value': 99
        'requirements': ('bool_param', 'string_param'),
        'missing': ['string_param'],
        'requires': 'all',
    }
]
</pre> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_required_one_of">
<code>ansible.module_utils.common.validation.check_required_one_of(terms, parameters, options_context=None)</code> </dt> <dd>
<p>Check each list of terms to ensure at least one exists in the given module parameters</p> <p>Accepts a list of lists or tuples</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>terms</strong> – List of lists of terms to check. For each list of terms, at least one is required.</li> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>options_context</strong> – List of strings of parent key names if <code>terms</code> are in a sub spec.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Empty list or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_required_together">
<code>ansible.module_utils.common.validation.check_required_together(terms, parameters, options_context=None)</code> </dt> <dd>
<p>Check each list of terms to ensure every parameter in each list exists in the given parameters.</p> <p>Accepts a list of lists or tuples.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>terms</strong> – List of lists of terms to check. Each list should include parameters that are all required when at least one is specified in the parameters.</li> <li>
<strong>parameters</strong> – Dictionary of parameters</li> <li>
<strong>options_context</strong> – List of strings of parent key names if <code>terms</code> are in a sub spec.</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Empty list or raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if the check fails.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_bits">
<code>ansible.module_utils.common.validation.check_type_bits(value)</code> </dt> <dd>
<p>Convert a human-readable string bits value to bits in integer.</p> <p>Example: <code>check_type_bits('1Mb')</code> returns integer 1048576.</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert the value.</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_bool">
<code>ansible.module_utils.common.validation.check_type_bool(value)</code> </dt> <dd>
<p>Verify that the value is a bool or convert it to a bool and return it.</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert to a bool</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>value</strong> – String, int, or float to convert to bool. Valid booleans include: ‘1’, ‘on’, 1, ‘0’, 0, ‘n’, ‘f’, ‘false’, ‘true’, ‘y’, ‘t’, ‘yes’, ‘no’, ‘off’</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Boolean True or False</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_bytes">
<code>ansible.module_utils.common.validation.check_type_bytes(value)</code> </dt> <dd>
<p>Convert a human-readable string value to bytes</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert the value</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_dict">
<code>ansible.module_utils.common.validation.check_type_dict(value)</code> </dt> <dd>
<p>Verify that value is a dict or convert it to a dict and return it.</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert to a dict</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>value</strong> – Dict or string to convert to a dict. Accepts <code>k1=v2, k2=v2</code>.</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>value converted to a dictionary</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_float">
<code>ansible.module_utils.common.validation.check_type_float(value)</code> </dt> <dd>
<p>Verify that value is a float or convert it to a float and return it</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert to a float</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>value</strong> – float, int, str, or bytes to verify or convert and return.</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>float of given value.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_int">
<code>ansible.module_utils.common.validation.check_type_int(value)</code> </dt> <dd>
<p>Verify that the value is an integer and return it or convert the value to an integer and return it</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert to an int</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>value</strong> – String or int to convert of verify</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>int of given value</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_jsonarg">
<code>ansible.module_utils.common.validation.check_type_jsonarg(value)</code> </dt> <dd>
<p>Return a jsonified string. Sometimes the controller turns a json string into a dict/list so transform it back into json here</p> <p>Raises <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert the value</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_list">
<code>ansible.module_utils.common.validation.check_type_list(value)</code> </dt> <dd>
<p>Verify that the value is a list or convert to a list</p> <p>A comma separated string will be split into a list. Raises a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.13)"><code>TypeError</code></a> if unable to convert to a list.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>value</strong> – Value to validate or convert to a list</p> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Original value if it is already a list, single item list if a float, int, or string without commas, or a multi-item list if a comma-delimited string.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_path">
<code>ansible.module_utils.common.validation.check_type_path(value)</code> </dt> <dd>
<p>Verify the provided value is a string or convert it to a string, then return the expanded path</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_raw">
<code>ansible.module_utils.common.validation.check_type_raw(value)</code> </dt> <dd>
<p>Returns the raw value</p> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.check_type_str">
<code>ansible.module_utils.common.validation.check_type_str(value, allow_conversion=True, param=None, prefix='')</code> </dt> <dd>
<p>Verify that the value is a string or convert to a string.</p> <p>Since unexpected changes can sometimes happen when converting to a string, <code>allow_conversion</code> controls whether or not the value will be converted or a TypeError will be raised if the value is not a string and would be converted</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>value</strong> – Value to validate or convert to a string</li> <li>
<strong>allow_conversion</strong> – Whether to convert the string and return it or raise a TypeError</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>Original value if it is a string, the value converted to a string if allow_conversion=True, or raises a TypeError if allow_conversion=False.</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="ansible.module_utils.common.validation.count_terms">
<code>ansible.module_utils.common.validation.count_terms(terms, parameters)</code> </dt> <dd>
<p>Count the number of occurrences of a key in a given dictionary</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>terms</strong> – String or iterable of values to check</li> <li>
<strong>parameters</strong> – Dictionary of parameters</li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>An integer that is the number of occurrences of the terms values in the provided dictionary.</p> </dd> </dl> </dd>
</dl> </section> </section> <section id="module-ansible.module_utils.errors"> <h2 id="errors">Errors</h2> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleFallbackNotFound">
<code>exception ansible.module_utils.errors.AnsibleFallbackNotFound</code> </dt> <dd>
<p>Fallback validator was not found</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationError">
<code>exception ansible.module_utils.errors.AnsibleValidationError(message)</code> </dt> <dd>
<p>Single argument spec validation error</p> <dl class="py attribute"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationError.error_message">
<code>error_message</code> </dt> <dd>
<p>The error message passed in when the exception was raised.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationError.msg">
<code>property msg</code> </dt> <dd>
<p>The error message passed in when the exception was raised.</p> </dd>
</dl> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationErrorMultiple">
<code>exception ansible.module_utils.errors.AnsibleValidationErrorMultiple(errors=None)</code> </dt> <dd>
<p>Multiple argument spec validation errors</p> <dl class="py attribute"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationErrorMultiple.errors">
<code>errors</code> </dt> <dd>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code>list</code></a> of <a class="reference internal" href="#ansible.module_utils.errors.AnsibleValidationError" title="ansible.module_utils.errors.AnsibleValidationError"><code>AnsibleValidationError</code></a> objects</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationErrorMultiple.msg">
<code>property msg</code> </dt> <dd>
<p>The first message from the first error in <code>errors</code>.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationErrorMultiple.messages">
<code>property messages</code> </dt> <dd>
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.13)"><code>list</code></a> of each error message in <code>errors</code>.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationErrorMultiple.append">
<code>append(error)</code> </dt> <dd>
<p>Append a new error to <code>self.errors</code>.</p> <p>Only <a class="reference internal" href="#ansible.module_utils.errors.AnsibleValidationError" title="ansible.module_utils.errors.AnsibleValidationError"><code>AnsibleValidationError</code></a> should be added.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AnsibleValidationErrorMultiple.extend">
<code>extend(errors)</code> </dt> <dd>
<p>Append each item in <code>errors</code> to <code>self.errors</code>. Only <a class="reference internal" href="#ansible.module_utils.errors.AnsibleValidationError" title="ansible.module_utils.errors.AnsibleValidationError"><code>AnsibleValidationError</code></a> should be added.</p> </dd>
</dl> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.AliasError">
<code>exception ansible.module_utils.errors.AliasError(message)</code> </dt> <dd>
<p>Error handling aliases</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.ArgumentTypeError">
<code>exception ansible.module_utils.errors.ArgumentTypeError(message)</code> </dt> <dd>
<p>Error with parameter type</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.ArgumentValueError">
<code>exception ansible.module_utils.errors.ArgumentValueError(message)</code> </dt> <dd>
<p>Error with parameter value</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.DeprecationError">
<code>exception ansible.module_utils.errors.DeprecationError(message)</code> </dt> <dd>
<p>Error processing parameter deprecations</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.ElementError">
<code>exception ansible.module_utils.errors.ElementError(message)</code> </dt> <dd>
<p>Error when validating elements</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.MutuallyExclusiveError">
<code>exception ansible.module_utils.errors.MutuallyExclusiveError(message)</code> </dt> <dd>
<p>Mutually exclusive parameters were supplied</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.NoLogError">
<code>exception ansible.module_utils.errors.NoLogError(message)</code> </dt> <dd>
<p>Error converting no_log values</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.RequiredByError">
<code>exception ansible.module_utils.errors.RequiredByError(message)</code> </dt> <dd>
<p>Error with parameters that are required by other parameters</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.RequiredDefaultError">
<code>exception ansible.module_utils.errors.RequiredDefaultError(message)</code> </dt> <dd>
<p>A required parameter was assigned a default value</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.RequiredError">
<code>exception ansible.module_utils.errors.RequiredError(message)</code> </dt> <dd>
<p>Missing a required parameter</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.RequiredIfError">
<code>exception ansible.module_utils.errors.RequiredIfError(message)</code> </dt> <dd>
<p>Error with conditionally required parameters</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.RequiredOneOfError">
<code>exception ansible.module_utils.errors.RequiredOneOfError(message)</code> </dt> <dd>
<p>Error with parameters where at least one is required</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.RequiredTogetherError">
<code>exception ansible.module_utils.errors.RequiredTogetherError(message)</code> </dt> <dd>
<p>Error with parameters that are required together</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.SubParameterTypeError">
<code>exception ansible.module_utils.errors.SubParameterTypeError(message)</code> </dt> <dd>
<p>Incorrect type for subparameter</p> </dd>
</dl> <dl class="py exception"> <dt class="sig sig-object py" id="ansible.module_utils.errors.UnsupportedError">
<code>exception ansible.module_utils.errors.UnsupportedError(message)</code> </dt> <dd>
<p>Unsupported parameters were supplied</p> </dd>
</dl> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2024 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/reference_appendices/module_utils.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/reference_appendices/module_utils.html</a>
  </p>
</div>
