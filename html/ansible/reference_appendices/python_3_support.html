<h1 id="python-3-support">Python 3 Support</h1> <p>Ansible 2.5 and above work with Python 3. Previous to 2.5, using Python 3 was considered a tech preview. This topic discusses how to set up your controller and managed machines to use Python 3.</p> <div class="admonition note"> <p class="admonition-title">Note</p> <p>On the controller we support Python 3.5 or greater and Python 2.7 or greater. Module-side, we support Python 3.5 or greater and Python 2.6 or greater.</p> </div>  <h2 id="on-the-controller-side">On the controller side</h2> <p>The easiest way to run <strong class="command">/usr/bin/ansible</strong> under Python 3 is to install it with the Python3 version of pip. This will make the default <strong class="command">/usr/bin/ansible</strong> run with Python3:</p> <pre data-language="shell">$ pip3 install ansible
$ ansible --version | grep "python version"
  python version = 3.6.2 (default, Sep 22 2017, 08:28:09) [GCC 7.2.1 20170915 (Red Hat 7.2.1-2)]
</pre> <p>If you are running Ansible <a class="reference internal" href="../installation_guide/intro_installation.html#from-source"><span class="std std-ref">Running the devel branch from a clone</span></a> and want to use Python 3 with your source checkout, run your command via <code>python3</code>. For example:</p> <pre data-language="shell">$ source ./hacking/env-setup
$ python3 $(which ansible) localhost -m ping
$ python3 $(which ansible-playbook) sample-playbook.yml
</pre> <div class="admonition note"> <p class="admonition-title">Note</p> <p>Individual Linux distribution packages may be packaged for Python2 or Python3. When running from distro packages you’ll only be able to use Ansible with the Python version for which it was installed. Sometimes distros will provide a means of installing for several Python versions (via a separate package or via some commands that are run after install). You’ll need to check with your distro to see if that applies in your case.</p> </div>   <h2 id="using-python-3-on-the-managed-machines-with-commands-and-playbooks">Using Python 3 on the managed machines with commands and playbooks</h2> <ul class="simple"> <li>Ansible will automatically detect and use Python 3 on many platforms that ship with it. To explicitly configure a Python 3 interpreter, set the <code>ansible_python_interpreter</code> inventory variable at a group or host level to the location of a Python 3 interpreter, such as <strong class="command">/usr/bin/python3</strong>. The default interpreter path may also be set in <code>ansible.cfg</code>.</li> </ul> <div class="admonition seealso"> <p class="admonition-title">See also</p> <p><a class="reference internal" href="interpreter_discovery.html#interpreter-discovery"><span class="std std-ref">Interpreter Discovery</span></a> for more information.</p> </div> <pre data-language="ini"># Example inventory that makes an alias for localhost that uses Python3
localhost-py3 ansible_host=localhost ansible_connection=local ansible_python_interpreter=/usr/bin/python3

# Example of setting a group of hosts to use Python3
[py3-hosts]
ubuntu16
fedora27

[py3-hosts:vars]
ansible_python_interpreter=/usr/bin/python3
</pre> <div class="admonition seealso"> <p class="admonition-title">See also</p> <p><a class="reference internal" href="../user_guide/intro_inventory.html#intro-inventory"><span class="std std-ref">How to build your inventory</span></a> for more information.</p> </div> <ul class="simple"> <li>Run your command or playbook:</li> </ul> <pre data-language="shell">$ ansible localhost-py3 -m ping
$ ansible-playbook sample-playbook.yml
</pre> <p>Note that you can also use the <code>-e</code> command line option to manually set the python interpreter when you run a command. This can be useful if you want to test whether a specific module or playbook has any bugs under Python 3. For example:</p> <pre data-language="shell">$ ansible localhost -m ping -e 'ansible_python_interpreter=/usr/bin/python3'
$ ansible-playbook sample-playbook.yml -e 'ansible_python_interpreter=/usr/bin/python3'
</pre>   <h2 id="what-to-do-if-an-incompatibility-is-found">What to do if an incompatibility is found</h2> <p>We have spent several releases squashing bugs and adding new tests so that Ansible’s core feature set runs under both Python 2 and Python 3. However, bugs may still exist in edge cases and many of the modules shipped with Ansible are maintained by the community and not all of those may be ported yet.</p> <p>If you find a bug running under Python 3 you can submit a bug report on <a class="reference external" href="https://github.com/ansible/ansible/issues/">Ansible’s GitHub project</a>. Be sure to mention Python3 in the bug report so that the right people look at it.</p> <p>If you would like to fix the code and submit a pull request on github, you can refer to <a class="reference internal" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_python_3.html#developing-python-3"><span class="std std-ref">Ansible and Python 3</span></a> for information on how we fix common Python3 compatibility issues in the Ansible codebase.</p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2012&ndash;2018 Michael DeHaan<br>&copy; 2018&ndash;2021 Red Hat, Inc.<br>Licensed under the GNU General Public License version 3.<br>
    <a href="https://docs.ansible.com/ansible/latest/reference_appendices/python_3_support.html" class="_attribution-link">https://docs.ansible.com/ansible/latest/reference_appendices/python_3_support.html</a>
  </p>
</div>
