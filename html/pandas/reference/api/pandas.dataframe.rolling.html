<h1>pandas.DataFrame.rolling</h1> <dl class="py method"> <dt class="sig sig-object py" id="pandas.DataFrame.rolling"> <span class="sig-prename descclassname"><span class="pre">DataFrame.</span></span><span class="sig-name descname"><span class="pre">rolling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_periods</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">win_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">_NoDefault.no_default</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">closed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'single'</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/pandas-dev/pandas/blob/v2.2.2/pandas/core/generic.py#L12530-L12591"><span class="viewcode-link"><span class="pre">[source]</span></span></a>
</dt> <dd>
<p>Provide rolling window calculations.</p> <dl class="field-list"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<dl> <dt>
<strong>window</strong><span class="classifier">:int, timedelta, str, offset, or BaseIndexer subclass</span>
</dt>
<dd>
<p>Size of the moving window.</p> <p>If an integer, the fixed number of observations used for each window.</p> <p>If a timedelta, str, or offset, the time period of each window. Each window will be a variable sized based on the observations included in the time-period. This is only valid for datetimelike indexes. To learn more about the offsets &amp; frequency strings, please see <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#offset-aliases">this link</a>.</p> <p>If a BaseIndexer subclass, the window boundaries based on the defined <code class="docutils literal notranslate"><span class="pre">get_window_bounds</span></code> method. Additional rolling keyword arguments, namely <code class="docutils literal notranslate"><span class="pre">min_periods</span></code>, <code class="docutils literal notranslate"><span class="pre">center</span></code>, <code class="docutils literal notranslate"><span class="pre">closed</span></code> and <code class="docutils literal notranslate"><span class="pre">step</span></code> will be passed to <code class="docutils literal notranslate"><span class="pre">get_window_bounds</span></code>.</p> </dd> <dt>
<strong>min_periods</strong><span class="classifier">:int, default None</span>
</dt>
<dd>
<p>Minimum number of observations in window required to have a value; otherwise, result is <code class="docutils literal notranslate"><span class="pre">np.nan</span></code>.</p> <p>For a window that is specified by an offset, <code class="docutils literal notranslate"><span class="pre">min_periods</span></code> will default to 1.</p> <p>For a window that is specified by an integer, <code class="docutils literal notranslate"><span class="pre">min_periods</span></code> will default to the size of the window.</p> </dd> <dt>
<strong>center</strong><span class="classifier">:bool, default False</span>
</dt>
<dd>
<p>If False, set the window labels as the right edge of the window index.</p> <p>If True, set the window labels as the center of the window index.</p> </dd> <dt>
<strong>win_type</strong><span class="classifier">:str, default None</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">None</span></code>, all points are evenly weighted.</p> <p>If a string, it must be a valid <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/signal.windows.html#module-scipy.signal.windows">scipy.signal window function</a>.</p> <p>Certain Scipy window types require additional parameters to be passed in the aggregation function. The additional parameters must match the keywords specified in the Scipy window type method signature.</p> </dd> <dt>
<strong>on</strong><span class="classifier">:str, optional</span>
</dt>
<dd>
<p>For a DataFrame, a column label or Index level on which to calculate the rolling window, rather than the DataFrame’s index.</p> <p>Provided integer column is ignored and excluded from result since an integer index is not used to calculate the rolling window.</p> </dd> <dt>
<strong>axis</strong><span class="classifier">:int or str, default 0</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">'index'</span></code>, roll across the rows.</p> <p>If <code class="docutils literal notranslate"><span class="pre">1</span></code> or <code class="docutils literal notranslate"><span class="pre">'columns'</span></code>, roll across the columns.</p> <p>For <cite>Series</cite> this parameter is unused and defaults to 0.</p> <div class="deprecated"> <p><span class="versionmodified deprecated">Deprecated since version 2.1.0: </span>The axis keyword is deprecated. For <code class="docutils literal notranslate"><span class="pre">axis=1</span></code>, transpose the DataFrame first instead.</p> </div> </dd> <dt>
<strong>closed</strong><span class="classifier">:str, default None</span>
</dt>
<dd>
<p>If <code class="docutils literal notranslate"><span class="pre">'right'</span></code>, the first point in the window is excluded from calculations.</p> <p>If <code class="docutils literal notranslate"><span class="pre">'left'</span></code>, the last point in the window is excluded from calculations.</p> <p>If <code class="docutils literal notranslate"><span class="pre">'both'</span></code>, the no points in the window are excluded from calculations.</p> <p>If <code class="docutils literal notranslate"><span class="pre">'neither'</span></code>, the first and last points in the window are excluded from calculations.</p> <p>Default <code class="docutils literal notranslate"><span class="pre">None</span></code> (<code class="docutils literal notranslate"><span class="pre">'right'</span></code>).</p> </dd> <dt>
<strong>step</strong><span class="classifier">:int, default None</span>
</dt>
<dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 1.5.0.</span></p> </div> <p>Evaluate the window at every <code class="docutils literal notranslate"><span class="pre">step</span></code> result, equivalent to slicing as <code class="docutils literal notranslate"><span class="pre">[::step]</span></code>. <code class="docutils literal notranslate"><span class="pre">window</span></code> must be an integer. Using a step argument other than None or 1 will produce a result with a different shape than the input.</p> </dd> <dt>
<strong>method</strong><span class="classifier">:str {‘single’, ‘table’}, default ‘single’</span>
</dt>
<dd>
<div class="versionadded"> <p><span class="versionmodified added">New in version 1.3.0.</span></p> </div> <p>Execute the rolling operation per single column or row (<code class="docutils literal notranslate"><span class="pre">'single'</span></code>) or over the entire object (<code class="docutils literal notranslate"><span class="pre">'table'</span></code>).</p> <p>This argument is only implemented when specifying <code class="docutils literal notranslate"><span class="pre">engine='numba'</span></code> in the method call.</p> </dd> </dl> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<dl class="simple"> <dt>pandas.api.typing.Window or pandas.api.typing.Rolling</dt>
<dd>
<p>An instance of Window is returned if <code class="docutils literal notranslate"><span class="pre">win_type</span></code> is passed. Otherwise, an instance of Rolling is returned.</p> </dd> </dl> </dd> </dl> <div class="admonition seealso"> <p class="admonition-title">See also</p> <dl class="simple"> <dt><a class="reference internal" href="pandas.dataframe.expanding.html#pandas.DataFrame.expanding" title="pandas.DataFrame.expanding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">expanding</span></code></a></dt>
<dd>
<p>Provides expanding transformations.</p> </dd> <dt><a class="reference internal" href="pandas.dataframe.ewm.html#pandas.DataFrame.ewm" title="pandas.DataFrame.ewm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ewm</span></code></a></dt>
<dd>
<p>Provides exponential weighted functions.</p> </dd> </dl> </div> <p class="rubric">Notes</p> <p>See <a class="reference internal" href="../../user_guide/window.html#window-generic"><span class="std std-ref">Windowing Operations</span></a> for further usage details and examples.</p> <p class="rubric">Examples</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df = pd.DataFrame({'B': [0, 1, 2, np.nan, 4]})
&gt;&gt;&gt; df
     B
0  0.0
1  1.0
2  2.0
3  NaN
4  4.0
</pre></div> </div> <p><strong>window</strong></p> <p>Rolling sum with a window length of 2 observations.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling(2).sum()
     B
0  NaN
1  1.0
2  3.0
3  NaN
4  NaN
</pre></div> </div> <p>Rolling sum with a window span of 2 seconds.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df_time = pd.DataFrame({'B': [0, 1, 2, np.nan, 4]},
...                        index=[pd.Timestamp('20130101 09:00:00'),
...                               pd.Timestamp('20130101 09:00:02'),
...                               pd.Timestamp('20130101 09:00:03'),
...                               pd.Timestamp('20130101 09:00:05'),
...                               pd.Timestamp('20130101 09:00:06')])
</pre></div> </div> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df_time
                       B
2013-01-01 09:00:00  0.0
2013-01-01 09:00:02  1.0
2013-01-01 09:00:03  2.0
2013-01-01 09:00:05  NaN
2013-01-01 09:00:06  4.0
</pre></div> </div> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df_time.rolling('2s').sum()
                       B
2013-01-01 09:00:00  0.0
2013-01-01 09:00:02  1.0
2013-01-01 09:00:03  3.0
2013-01-01 09:00:05  NaN
2013-01-01 09:00:06  4.0
</pre></div> </div> <p>Rolling sum with forward looking windows with 2 observations.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; indexer = pd.api.indexers.FixedForwardWindowIndexer(window_size=2)
&gt;&gt;&gt; df.rolling(window=indexer, min_periods=1).sum()
     B
0  1.0
1  3.0
2  2.0
3  4.0
4  4.0
</pre></div> </div> <p><strong>min_periods</strong></p> <p>Rolling sum with a window length of 2 observations, but only needs a minimum of 1 observation to calculate a value.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling(2, min_periods=1).sum()
     B
0  0.0
1  1.0
2  3.0
3  2.0
4  4.0
</pre></div> </div> <p><strong>center</strong></p> <p>Rolling sum with the result assigned to the center of the window index.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling(3, min_periods=1, center=True).sum()
     B
0  1.0
1  3.0
2  3.0
3  6.0
4  4.0
</pre></div> </div> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling(3, min_periods=1, center=False).sum()
     B
0  0.0
1  1.0
2  3.0
3  3.0
4  6.0
</pre></div> </div> <p><strong>step</strong></p> <p>Rolling sum with a window length of 2 observations, minimum of 1 observation to calculate a value, and a step of 2.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling(2, min_periods=1, step=2).sum()
     B
0  0.0
2  3.0
4  4.0
</pre></div> </div> <p><strong>win_type</strong></p> <p>Rolling sum with a window length of 2, using the Scipy <code class="docutils literal notranslate"><span class="pre">'gaussian'</span></code> window type. <code class="docutils literal notranslate"><span class="pre">std</span></code> is required in the aggregation function.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling(2, win_type='gaussian').sum(std=3)
          B
0       NaN
1  0.986207
2  2.958621
3       NaN
4       NaN
</pre></div> </div> <p><strong>on</strong></p> <p>Rolling sum with a window length of 2 days.</p> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df = pd.DataFrame({
...     'A': [pd.to_datetime('2020-01-01'),
...           pd.to_datetime('2020-01-01'),
...           pd.to_datetime('2020-01-02'),],
...     'B': [1, 2, 3], },
...     index=pd.date_range('2020', periods=3))
</pre></div> </div> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df
                    A  B
2020-01-01 2020-01-01  1
2020-01-02 2020-01-01  2
2020-01-03 2020-01-02  3
</pre></div> </div> <div class="doctest highlight-default notranslate">
<div class="highlight"><pre data-language="python">&gt;&gt;&gt; df.rolling('2D', on='A').sum()
                    A    B
2020-01-01 2020-01-01  1.0
2020-01-02 2020-01-01  3.0
2020-01-03 2020-01-02  6.0
</pre></div> </div> </dd>
</dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2008&ndash;2022, AQR Capital Management, LLC, Lambda Foundry, Inc. and PyData Development Team<br>Licensed under the 3-clause BSD License.<br>
    <a href="https://pandas.pydata.org/pandas-docs/version/2.2.2/reference/api/pandas.DataFrame.rolling.html" class="_attribution-link">https://pandas.pydata.org/pandas-docs/version/2.2.2/reference/api/pandas.DataFrame.rolling.html</a>
  </p>
</div>
