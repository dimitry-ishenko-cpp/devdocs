<h1>AlertNode</h1>     <p>An <a href="index.html">AlertNode</a> can trigger an event of varying severity levels, and pass the event to alert handlers. The criteria for triggering an alert is specified via a <a href="https://docs.influxdata.com/kapacitor/latest/tick/expr/">lambda expression</a>. See <a href="index.html#info">AlertNode.Info,</a> <a href="index.html#warn">AlertNode.Warn,</a> and <a href="index.html#crit">AlertNode.Crit</a> below.</p> <p>Different event handlers can be configured for each <a href="index.html">AlertNode.</a> Some handlers like Email, HipChat, Sensu, Slack, OpsGenie, VictorOps, PagerDuty, Telegram and Talk have a configuration option 'global' that indicates that all alerts implicitly use the handler.</p> <p>Available event handlers:</p> <ul> <li>log – log alert data to file.</li> <li>post – HTTP POST data to a specified URL.</li> <li>tcp – Send data to a specified address via raw TCP.</li> <li>email – Send and email with alert data.</li> <li>exec – Execute a command passing alert data over STDIN.</li> <li>HipChat – Post alert message to HipChat room.</li> <li>Alerta – Post alert message to Alerta.</li> <li>Sensu – Post alert message to Sensu client.</li> <li>Slack – Post alert message to Slack channel.</li> <li>SNMPTraps – Trigger SNMP traps.</li> <li>OpsGenie – Send alert to OpsGenie.</li> <li>VictorOps – Send alert to VictorOps.</li> <li>PagerDuty – Send alert to PagerDuty.</li> <li>Pushover – Send alert to Pushover.</li> <li>Talk – Post alert message to Talk client.</li> <li>Telegram – Post alert message to Telegram client.</li> </ul> <p>See below for more details on configuring each handler.</p> <p>Each event that gets sent to a handler contains the following alert data:</p> <ul> <li>ID – the ID of the alert, user defined.</li> <li>Message – the alert message, user defined.</li> <li>Details – the alert details, user defined HTML content.</li> <li>Time – the time the alert occurred.</li> <li>Duration – the duration of the alert in nanoseconds.</li> <li>Level – one of OK, INFO, WARNING or CRITICAL.</li> <li>Data – influxql.Result containing the data that triggered the alert.</li> </ul> <p>Events are sent to handlers if the alert is in a state other than 'OK' or the alert just changed to the 'OK' state from a non 'OK' state (a.k.a. the alert recovered). Using the <a href="index.html#statechangesonly">AlertNode.StateChangesOnly</a> property events will only be sent to handlers if the alert changed state.</p> <p>It is valid to configure multiple alert handlers, even with the same type.</p> <p>Example:</p> <pre data-language="javascript">   stream
           .groupBy('service')
       |alert()
           .id('kapacitor/{{ index .Tags "service" }}')
           .message('{{ .ID }} is {{ .Level }} value:{{ index .Fields "value" }}')
           .info(lambda: "value" &gt; 10)
           .warn(lambda: "value" &gt; 20)
           .crit(lambda: "value" &gt; 30)
           .post("http://example.com/api/alert")
           .post("http://another.example.com/api/alert")
           .tcp("exampleendpoint.com:5678")
           .email('oncall@example.com')
</pre> <p>Each expression maintains its own state. The order of execution for the expressions is not considered to be deterministic. For each point an expression may or may not be evaluated. If no expression is true then the alert is considered to be in the OK state.</p> <p>Kapacitor supports alert reset expressions. This way when an alert enters a state, it can only be lowered in severity if its reset expression evaluates to true.</p> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
           .where(lambda: "host" == 'serverA')
           .groupBy('host')
       |alert()
           .info(lambda: "value" &gt; 60)
           .infoReset(lambda: "value" &lt; 50)
           .warn(lambda: "value" &gt; 70)
           .warnReset(lambda: "value" &lt; 60)
           .crit(lambda: "value" &gt; 80)
           .critReset(lambda: "value" &lt; 70)
</pre> <p>For example given the following values: 61 73 64 85 62 56 47 The corresponding alert states are: INFO WARNING WARNING CRITICAL INFO INFO OK</p> <p>Available Statistics:</p> <ul> <li>alerts_triggered – Total number of alerts triggered</li> <li>oks_triggered – Number of OK alerts triggered</li> <li>infos_triggered – Number of Info alerts triggered</li> <li>warns_triggered – Number of Warn alerts triggered</li> <li>crits_triggered – Number of Crit alerts triggered</li> </ul> <h2 id="index">Index</h2> <h3 id="properties">Properties</h3> <ul> <li><a href="index.html#alerta">Alerta</a></li> <li><a href="index.html#all">All</a></li> <li><a href="index.html#crit">Crit</a></li> <li><a href="index.html#critreset">CritReset</a></li> <li><a href="index.html#details">Details</a></li> <li><a href="index.html#durationfield">DurationField</a></li> <li><a href="index.html#email">Email</a></li> <li><a href="index.html#exec">Exec</a></li> <li><a href="index.html#flapping">Flapping</a></li> <li><a href="index.html#hipchat">HipChat</a></li> <li><a href="index.html#history">History</a></li> <li><a href="index.html#id">Id</a></li> <li><a href="index.html#idfield">IdField</a></li> <li><a href="index.html#idtag">IdTag</a></li> <li><a href="index.html#info">Info</a></li> <li><a href="index.html#inforeset">InfoReset</a></li> <li><a href="index.html#levelfield">LevelField</a></li> <li><a href="index.html#leveltag">LevelTag</a></li> <li><a href="index.html#log">Log</a></li> <li><a href="index.html#message">Message</a></li> <li><a href="index.html#messagefield">MessageField</a></li> <li><a href="index.html#norecoveries">NoRecoveries</a></li> <li><a href="index.html#opsgenie">OpsGenie</a></li> <li><a href="index.html#pagerduty">PagerDuty</a></li> <li><a href="index.html#post">Post</a></li> <li><a href="index.html#pushover">Pushover</a></li> <li><a href="index.html#sensu">Sensu</a></li> <li><a href="index.html#slack">Slack</a></li> <li><a href="index.html#snmptrap">SnmpTrap</a></li> <li><a href="index.html#statechangesonly">StateChangesOnly</a></li> <li><a href="index.html#talk">Talk</a></li> <li><a href="index.html#tcp">Tcp</a></li> <li><a href="index.html#telegram">Telegram</a></li> <li><a href="index.html#topic">Topic</a></li> <li><a href="index.html#victorops">VictorOps</a></li> <li><a href="index.html#warn">Warn</a></li> <li><a href="index.html#warnreset">WarnReset</a></li> </ul> <h3 id="chaining-methods">Chaining Methods</h3> <ul> <li><a href="index.html#alert">Alert</a></li> <li><a href="index.html#bottom">Bottom</a></li> <li><a href="index.html#combine">Combine</a></li> <li><a href="index.html#count">Count</a></li> <li><a href="index.html#cumulativesum">CumulativeSum</a></li> <li><a href="index.html#deadman">Deadman</a></li> <li><a href="index.html#default">Default</a></li> <li><a href="index.html#delete">Delete</a></li> <li><a href="index.html#derivative">Derivative</a></li> <li><a href="index.html#difference">Difference</a></li> <li><a href="index.html#distinct">Distinct</a></li> <li><a href="index.html#elapsed">Elapsed</a></li> <li><a href="index.html#eval">Eval</a></li> <li><a href="index.html#first">First</a></li> <li><a href="index.html#flatten">Flatten</a></li> <li><a href="index.html#groupby">GroupBy</a></li> <li><a href="index.html#holtwinters">HoltWinters</a></li> <li><a href="index.html#holtwinterswithfit">HoltWintersWithFit</a></li> <li><a href="index.html#httpout">HttpOut</a></li> <li><a href="index.html#httppost">HttpPost</a></li> <li><a href="index.html#influxdbout">InfluxDBOut</a></li> <li><a href="index.html#join">Join</a></li> <li><a href="index.html#k8sautoscale">K8sAutoscale</a></li> <li><a href="index.html#kapacitorloopback">KapacitorLoopback</a></li> <li><a href="index.html#last">Last</a></li> <li><a href="index.html#max">Max</a></li> <li><a href="index.html#mean">Mean</a></li> <li><a href="index.html#median">Median</a></li> <li><a href="index.html#min">Min</a></li> <li><a href="index.html#mode">Mode</a></li> <li><a href="index.html#movingaverage">MovingAverage</a></li> <li><a href="index.html#percentile">Percentile</a></li> <li><a href="index.html#sample">Sample</a></li> <li><a href="index.html#shift">Shift</a></li> <li><a href="index.html#spread">Spread</a></li> <li><a href="index.html#statecount">StateCount</a></li> <li><a href="index.html#stateduration">StateDuration</a></li> <li><a href="index.html#stats">Stats</a></li> <li><a href="index.html#stddev">Stddev</a></li> <li><a href="index.html#sum">Sum</a></li> <li><a href="index.html#top">Top</a></li> <li><a href="index.html#union">Union</a></li> <li><a href="index.html#where">Where</a></li> <li><a href="index.html#window">Window</a></li> </ul> <h2 id="properties-1">Properties</h2> <p>Property methods modify state on the calling node. They do not add another node to the pipeline, and always return a reference to the calling node. Property methods are marked using the <code>.</code> operator.</p> <h3 id="alerta">Alerta</h3> <p>Send the alert to Alerta.</p> <p>Example:</p> <pre data-language="javascript">    [alerta]
      enabled = true
      url = "https://alerta.yourdomain"
      token = "9hiWoDOZ9IbmHsOTeST123ABciWTIqXQVFDo63h9"
      environment = "Production"
      origin = "Kapacitor"
</pre> <p>In order to not post a message every alert interval use <a href="index.html#statechangesonly">AlertNode.StateChangesOnly</a> so that only events where the alert changed state are sent to Alerta.</p> <p>Send alerts to Alerta. The resource and event properties are required.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .alerta()
                 .resource('Hostname or service')
                 .event('Something went wrong')
</pre> <p>Alerta also accepts optional alert information.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .alerta()
                 .resource('Hostname or service')
                 .event('Something went wrong')
                 .environment('Development')
                 .group('Dev. Servers')
</pre> <p>NOTE: Alerta cannot be configured globally because of its required properties.</p> <pre data-language="javascript">node.alerta()
</pre> <h4 id="alerta-environment">Alerta Environment</h4> <p>Alerta environment. Can be a template and has access to the same data as the <a href="index.html#details">AlertNode.Details</a> property. Defaut is set from the configuration.</p> <pre data-language="javascript">node.alerta()
      .environment(value string)
</pre> <h4 id="alerta-event">Alerta Event</h4> <p>Alerta event. Can be a template and has access to the same data as the idInfo property. Default: {{ .ID }}</p> <pre data-language="javascript">node.alerta()
      .event(value string)
</pre> <h4 id="alerta-group">Alerta Group</h4> <p>Alerta group. Can be a template and has access to the same data as the <a href="index.html#details">AlertNode.Details</a> property. Default: {{ .Group }}</p> <pre data-language="javascript">node.alerta()
      .group(value string)
</pre> <h4 id="alerta-origin">Alerta Origin</h4> <p>Alerta origin. If empty uses the origin from the configuration.</p> <pre data-language="javascript">node.alerta()
      .origin(value string)
</pre> <h4 id="alerta-resource">Alerta Resource</h4> <p>Alerta resource. Can be a template and has access to the same data as the <a href="index.html#details">AlertNode.Details</a> property. Default: {{ .Name }}</p> <pre data-language="javascript">node.alerta()
      .resource(value string)
</pre> <h4 id="alerta-services">Alerta Services</h4> <p>List of effected services. If not specified defaults to the Name of the stream.</p> <pre data-language="javascript">node.alerta()
      .services(service ...string)
</pre> <h4 id="alerta-token">Alerta Token</h4> <p>Alerta authentication token. If empty uses the token from the configuration.</p> <pre data-language="javascript">node.alerta()
      .token(value string)
</pre> <h4 id="alerta-value">Alerta Value</h4> <p>Alerta value. Can be a template and has access to the same data as the <a href="index.html#details">AlertNode.Details</a> property. Default is an empty string.</p> <pre data-language="javascript">node.alerta()
      .value(value string)
</pre> <h3 id="all">All</h3> <p>Indicates an alert should trigger only if all points in a batch match the criteria. Does not apply to stream alerts.</p> <pre data-language="javascript">node.all()
</pre> <h3 id="crit">Crit</h3> <p>Filter expression for the CRITICAL alert level. An empty value indicates the level is invalid and is skipped.</p> <pre data-language="javascript">node.crit(value ast.LambdaNode)
</pre> <h3 id="critreset">CritReset</h3> <p>Filter expression for reseting the CRITICAL alert level to lower level.</p> <pre data-language="javascript">node.critReset(value ast.LambdaNode)
</pre> <h3 id="details">Details</h3> <p>Template for constructing a detailed HTML message for the alert. The same template data is available as the <a href="index.html#message">AlertNode.Message</a> property, in addition to a Message field that contains the rendered Message value.</p> <p>The intent is that the Message property be a single line summary while the Details property is a more detailed message possibly spanning multiple lines, and containing HTML formatting.</p> <p>This template is rendered using the html/template package in Go so that safe and valid HTML can be generated.</p> <p>The <code>json</code> method is available within the template to convert any variable to a valid JSON string.</p> <p>Example:</p> <pre data-language="javascript">    |alert()
       .id('{{ .Name }}')
       .details('''
&lt;h1&gt;{{ .ID }}&lt;/h1&gt;
&lt;b&gt;{{ .Message }}&lt;/b&gt;
Value: {{ index .Fields "value" }}
''')
       .email()
</pre> <p>Default: {{ json . }}</p> <pre data-language="javascript">node.details(value string)
</pre> <h3 id="durationfield">DurationField</h3> <p>Optional field key to add the alert duration to the data. The duration is always in units of nanoseconds.</p> <pre data-language="javascript">node.durationField(value string)
</pre> <h3 id="email">Email</h3> <p>Email the alert data.</p> <p>If the To list is empty, the To addresses from the configuration are used. The email subject is the <a href="index.html#message">AlertNode.Message</a> property. The email body is the <a href="index.html#details">AlertNode.Details</a> property. The emails are sent as HTML emails and so the body can contain html markup.</p> <p>If the 'smtp' section in the configuration has the option: global = true then all alerts are sent via email without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    |alert()
       .id('{{ .Name }}')
       // Email subject
       .message('{{ .ID }}:{{ .Level }}')
       //Email body as HTML
       .details('''
&lt;h1&gt;{{ .ID }}&lt;/h1&gt;
&lt;b&gt;{{ .Message }}&lt;/b&gt;
Value: {{ index .Fields "value" }}
''')
       .email()
</pre> <p>Send an email with custom subject and body.</p> <p>Example:</p> <pre data-language="javascript">     [smtp]
       enabled = true
       host = "localhost"
       port = 25
       username = ""
       password = ""
       from = "kapacitor@example.com"
       to = ["oncall@example.com"]
       # Set global to true so all alert trigger emails.
       global = true
       state-changes-only =  true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send email to 'oncall@example.com' from 'kapacitor@example.com'</p> <pre data-language="javascript">node.email(to ...string)
</pre> <h4 id="email-to">Email To</h4> <p>Define the To addresses for the email alert. Multiple calls append to the existing list of addresses. If empty uses the addresses from the configuration.</p> <p>Example:</p> <pre data-language="javascript">    |alert()
       .id('{{ .Name }}')
       // Email subject
       .message('{{ .ID }}:{{ .Level }}')
       //Email body as HTML
       .details('''
&lt;h1&gt;{{ .ID }}&lt;/h1&gt;
&lt;b&gt;{{ .Message }}&lt;/b&gt;
Value: {{ index .Fields "value" }}
''')
       .email('admin@example.com')
         .to('oncall@example.com')
         .to('support@example.com')
</pre> <p>All three email addresses will receive the alert message.</p> <p>Passing addresses to the <code>email</code> property directly or using the <code>email.to</code> property is the same.</p> <pre data-language="javascript">node.email(to ...string)
      .to(to ...string)
</pre> <h3 id="exec">Exec</h3> <p>Execute a command whenever an alert is triggered and pass the alert data over STDIN in JSON format.</p> <pre data-language="javascript">node.exec(executable string, args ...string)
</pre> <h3 id="flapping">Flapping</h3> <p>Perform flap detection on the alerts. The method used is similar method to Nagios: <a href="https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/3/en/flapping.html">https://assets.nagios.com/downloads/nagioscore/docs/nagioscore/3/en/flapping.html</a></p> <p>Each different alerting level is considered a different state. The low and high thresholds are inverted thresholds of a percentage of state changes. Meaning that if the percentage of state changes goes above the <code>high</code> threshold, the alert enters a flapping state. The alert remains in the flapping state until the percentage of state changes goes below the <code>low</code> threshold. Typical values are low: 0.25 and high: 0.5. The percentage values represent the number state changes over the total possible number of state changes. A percentage change of 0.5 means that the alert changed state in half of the recorded history, and remained the same in the other half of the history.</p> <pre data-language="javascript">node.flapping(low float64, high float64)
</pre> <h3 id="hipchat">HipChat</h3> <p>If the 'hipchat' section in the configuration has the option: global = true then all alerts are sent to HipChat without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    [hipchat]
      enabled = true
      url = "https://orgname.hipchat.com/v2/room"
      room = "Test Room"
      token = "9hiWoDOZ9IbmHsOTeST123ABciWTIqXQVFDo63h9"
      global = true
      state-changes-only = true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send alert to HipChat using default room 'Test Room'.</p> <pre data-language="javascript">node.hipChat()
</pre> <h4 id="hipchat-room">HipChat Room</h4> <p>HipChat room in which to post messages. If empty uses the channel from the configuration.</p> <pre data-language="javascript">node.hipChat()
      .room(value string)
</pre> <h4 id="hipchat-token">HipChat Token</h4> <p>HipChat authentication token. If empty uses the token from the configuration.</p> <pre data-language="javascript">node.hipChat()
      .token(value string)
</pre> <h3 id="history">History</h3> <p>Number of previous states to remember when computing flapping levels and checking for state changes. Minimum value is 2 in order to keep track of current and previous states.</p> <p>Default: 21</p> <pre data-language="javascript">node.history(value int64)
</pre> <h3 id="id">Id</h3> <p>Template for constructing a unique ID for a given alert.</p> <p>Available template data:</p> <ul> <li>Name – Measurement name.</li> <li>TaskName – The name of the task</li> <li>Group – Concatenation of all group-by tags of the form [key=value,]+. If no groupBy is performed equal to literal 'nil'.</li> <li>Tags – Map of tags. Use '{{ index .Tags "key" }}' to get a specific tag value.</li> <li>ServerInfo – Information about the running server. Available nested fields are: Hostname, ClusterID and ServerID.</li> </ul> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
           .groupBy('cpu')
       |alert()
           .id('kapacitor/{{ .Name }}/{{ .Group }}')
</pre> <p>ID: kapacitor/cpu/cpu=cpu0,</p> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
           .groupBy('service')
       |alert()
           .id('kapacitor/{{ index .Tags "service" }}')
</pre> <p>ID: kapacitor/authentication</p> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
           .groupBy('service', 'host')
       |alert()
           .id('kapacitor/{{ index .Tags "service" }}/{{ index .Tags "host" }}')
</pre> <p>ID: kapacitor/authentication/auth001.example.com</p> <p>Default: {{ .Name }}:{{ .Group }}</p> <pre data-language="javascript">node.id(value string)
</pre> <h3 id="idfield">IdField</h3> <p>Optional field key to add to the data, containing the alert ID as a string.</p> <pre data-language="javascript">node.idField(value string)
</pre> <h3 id="idtag">IdTag</h3> <p>Optional tag key to use when tagging the data with the alert ID.</p> <pre data-language="javascript">node.idTag(value string)
</pre> <h3 id="info">Info</h3> <p>Filter expression for the INFO alert level. An empty value indicates the level is invalid and is skipped.</p> <pre data-language="javascript">node.info(value ast.LambdaNode)
</pre> <h3 id="inforeset">InfoReset</h3> <p>Filter expression for reseting the INFO alert level to lower level.</p> <pre data-language="javascript">node.infoReset(value ast.LambdaNode)
</pre> <h3 id="levelfield">LevelField</h3> <p>Optional field key to add to the data, containing the alert level as a string.</p> <pre data-language="javascript">node.levelField(value string)
</pre> <h3 id="leveltag">LevelTag</h3> <p>Optional tag key to use when tagging the data with the alert level.</p> <pre data-language="javascript">node.levelTag(value string)
</pre> <h3 id="log">Log</h3> <p>Log JSON alert data to file. One event per line. Must specify the absolute path to the log file. It will be created if it does not exist. Example:</p> <pre data-language="javascript">    stream
         |alert()
             .log('/tmp/alert')
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .log('/tmp/alert')
             .mode(0644)
</pre> <pre data-language="javascript">node.log(filepath string)
</pre> <h4 id="log-mode">Log Mode</h4> <p>File's mode and permissions, default is 0600 NOTE: The leading 0 is required to interpret the value as an octal integer.</p> <pre data-language="javascript">node.log(filepath string)
      .mode(value int64)
</pre> <h3 id="message">Message</h3> <p>Template for constructing a meaningful message for the alert.</p> <p>Available template data:</p> <ul> <li>ID – The ID of the alert.</li> <li>Name – Measurement name.</li> <li>TaskName – The name of the task</li> <li>Group – Concatenation of all group-by tags of the form [key=value,]+. If no groupBy is performed equal to literal 'nil'.</li> <li>Tags – Map of tags. Use '{{ index .Tags "key" }}' to get a specific tag value.</li> <li>Level – Alert Level, one of: INFO, WARNING, CRITICAL.</li> <li>Fields – Map of fields. Use '{{ index .Fields "key" }}' to get a specific field value.</li> <li>Time – The time of the point that triggered the event.</li> </ul> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
           .groupBy('service', 'host')
       |alert()
           .id('{{ index .Tags "service" }}/{{ index .Tags "host" }}')
           .message('{{ .ID }} is {{ .Level}} value: {{ index .Fields "value" }}')
</pre> <p>Message: authentication/auth001.example.com is CRITICAL value:42</p> <p>Default: {{ .ID }} is {{ .Level }}</p> <pre data-language="javascript">node.message(value string)
</pre> <h3 id="messagefield">MessageField</h3> <p>Optional field key to add to the data, containing the alert message.</p> <pre data-language="javascript">node.messageField(value string)
</pre> <h3 id="norecoveries">NoRecoveries</h3> <p>Do not send recovery alerts.</p> <pre data-language="javascript">node.noRecoveries()
</pre> <h3 id="opsgenie">OpsGenie</h3> <p>Send alert to OpsGenie. To use OpsGenie alerting you must first enable the 'Alert Ingestion API' in the 'Integrations' section of OpsGenie. Then place the API key from the URL into the 'opsgenie' section of the Kapacitor configuration.</p> <p>Example:</p> <pre data-language="javascript">    [opsgenie]
      enabled = true
      api-key = "xxxxx"
      teams = ["everyone"]
      recipients = ["jim", "bob"]
</pre> <p>With the correct configuration you can now use OpsGenie in TICKscripts.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .opsGenie()
</pre> <p>Send alerts to OpsGenie using the teams and recipients in the configuration file.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .opsGenie()
             .teams('team_rocket','team_test')
</pre> <p>Send alerts to OpsGenie with team set to 'team_rocket' and 'team_test'</p> <p>If the 'opsgenie' section in the configuration has the option: global = true then all alerts are sent to OpsGenie without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    [opsgenie]
      enabled = true
      api-key = "xxxxx"
      recipients = ["johndoe"]
      global = true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send alert to OpsGenie using the default recipients, found in the configuration.</p> <pre data-language="javascript">node.opsGenie()
</pre> <h4 id="opsgenie-recipients">OpsGenie Recipients</h4> <p>The list of recipients to be alerted. If empty defaults to the recipients from the configuration.</p> <pre data-language="javascript">node.opsGenie()
      .recipients(recipients ...string)
</pre> <h4 id="opsgenie-teams">OpsGenie Teams</h4> <p>The list of teams to be alerted. If empty defaults to the teams from the configuration.</p> <pre data-language="javascript">node.opsGenie()
      .teams(teams ...string)
</pre> <h3 id="pagerduty">PagerDuty</h3> <p>Send the alert to PagerDuty. To use PagerDuty alerting you must first follow the steps to enable a new 'Generic API' service.</p> <p>From <a href="https://developer.pagerduty.com/documentation/integration/events">https://developer.pagerduty.com/documentation/integration/events</a></p> <ol> <li>In your account, under the Services tab, click "Add New Service".</li> <li>Enter a name for the service and select an escalation policy. Then, select "Generic API" for the Service Type.</li> <li>Click the "Add Service" button.</li> <li>Once the service is created, you'll be taken to the service page. On this page, you'll see the "Service key", which is needed to access the API</li> </ol> <p>Place the 'service key' into the 'pagerduty' section of the Kapacitor configuration as the option 'service-key'.</p> <p>Example:</p> <pre data-language="javascript">    [pagerduty]
      enabled = true
      service-key = "xxxxxxxxx"
</pre> <p>With the correct configuration you can now use PagerDuty in TICKscripts.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .pagerDuty()
</pre> <p>If the 'pagerduty' section in the configuration has the option: global = true then all alerts are sent to PagerDuty without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    [pagerduty]
      enabled = true
      service-key = "xxxxxxxxx"
      global = true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send alert to PagerDuty.</p> <pre data-language="javascript">node.pagerDuty()
</pre> <h4 id="pagerduty-servicekey">PagerDuty ServiceKey</h4> <p>The service key to use for the alert. Defaults to the value in the configuration if empty.</p> <pre data-language="javascript">node.pagerDuty()
      .serviceKey(value string)
</pre> <h3 id="post">Post</h3> <p>HTTP POST JSON alert data to a specified URL.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .post()
                 .endpoint('example')
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .post('http://example.com')
</pre> <pre data-language="javascript">node.post(urls ...string)
</pre> <h4 id="post-endpoint">Post Endpoint</h4> <p>Name of the endpoint to be used, as is defined in the configuration file</p> <pre data-language="javascript">node.post(urls ...string)
      .endpoint(value string)
</pre> <h4 id="post-header">Post Header</h4> <p>Set a header key and value on the post request. Setting the Authenticate header is not allowed from within TICKscript, please use the configuration file to specify sensitive headers.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .post()
                 .endpoint('example')
                 .header('a','b')
</pre> <pre data-language="javascript">node.post(urls ...string)
      .header(k string, v string)
</pre> <h3 id="pushover">Pushover</h3> <p>Send the alert to Pushover. Register your application with Pushover at <a href="https://pushover.net/apps/build">https://pushover.net/apps/build</a> to get a Pushover token.</p> <p>Alert Level Mapping: OK - Sends a -2 priority level. Info - Sends a -1 priority level. Warning - Sends a 0 priority level. Critical - Sends a 1 priority level.</p> <p>Example:</p> <pre data-language="javascript">    [pushover]
      enabled = true
      token = "9hiWoDOZ9IbmHsOTeST123ABciWTIqXQVFDo63h9"
      user_key = "Pushover"
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .pushover()
              .sound('siren')
              .user_key('other user')
              .device('mydev')
              .title('mytitle')
              .URL('myurl')
              .URLTitle('mytitle')
</pre> <p>Send alerts to Pushover.</p> <pre data-language="javascript">node.pushover()
</pre> <h4 id="pushover-device">Pushover Device</h4> <p>Users device name to send message directly to that device, rather than all of a user's devices (multiple device names may be separated by a comma)</p> <pre data-language="javascript">node.pushover()
      .device(value string)
</pre> <h4 id="pushover-sound">Pushover Sound</h4> <p>The name of one of the sounds supported by the device clients to override the user's default sound choice</p> <pre data-language="javascript">node.pushover()
      .sound(value string)
</pre> <h4 id="pushover-title">Pushover Title</h4> <p>Your message's title, otherwise your apps name is used</p> <pre data-language="javascript">node.pushover()
      .title(value string)
</pre> <h4 id="pushover-url">Pushover URL</h4> <p>A supplementary URL to show with your message</p> <pre data-language="javascript">node.pushover()
      .uRL(value string)
</pre> <h4 id="pushover-urltitle">Pushover URLTitle</h4> <p>A title for your supplementary URL, otherwise just URL is shown</p> <pre data-language="javascript">node.pushover()
      .uRLTitle(value string)
</pre> <h4 id="pushover-userkey">Pushover UserKey</h4> <p>User/Group key of your user (or you), viewable when logged into the Pushover dashboard. Often referred to as USER_KEY in the Pushover documentation. If empty uses the user from the configuration.</p> <pre data-language="javascript">node.pushover()
      .userKey(value string)
</pre> <h3 id="sensu">Sensu</h3> <p>Send the alert to Sensu.</p> <p>Example:</p> <pre data-language="javascript">    [sensu]
      enabled = true
      url = "http://sensu:3030"
      source = "Kapacitor"
      handlers = ["sns","slack"]
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .sensu()
</pre> <p>Send alerts to Sensu client.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .sensu()
             .handlers('sns','slack')
</pre> <p>Send alerts to Sensu specifying the handlers</p> <pre data-language="javascript">node.sensu()
</pre> <h4 id="sensu-handlers">Sensu Handlers</h4> <p>List of effected services. If not specified defaults to the Name of the stream.</p> <pre data-language="javascript">node.sensu()
      .handlers(handlers ...string)
</pre> <h4 id="sensu-source">Sensu Source</h4> <p>Sensu source in which to post messages. If empty uses the Source from the configuration.</p> <pre data-language="javascript">node.sensu()
      .source(value string)
</pre> <h3 id="slack">Slack</h3> <p>Send the alert to Slack. To allow Kapacitor to post to Slack, go to the URL <a href="https://slack.com/services/new/incoming-webhook">https://slack.com/services/new/incoming-webhook</a> and create a new incoming webhook and place the generated URL in the 'slack' configuration section.</p> <p>Example:</p> <pre data-language="javascript">    [slack]
      enabled = true
      url = "https://hooks.slack.com/services/xxxxxxxxx/xxxxxxxxx/xxxxxxxxxxxxxxxxxxxxxxxx"
      channel = "#general"
</pre> <p>In order to not post a message every alert interval use <a href="index.html#statechangesonly">AlertNode.StateChangesOnly</a> so that only events where the alert changed state are posted to the channel.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .slack()
</pre> <p>Send alerts to Slack channel in the configuration file.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .slack()
             .channel('#alerts')
</pre> <p>Send alerts to Slack channel '#alerts'</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .slack()
             .channel('@jsmith')
</pre> <p>Send alert to user '@jsmith'</p> <p>If the 'slack' section in the configuration has the option: global = true then all alerts are sent to Slack without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    [slack]
      enabled = true
      url = "https://hooks.slack.com/services/xxxxxxxxx/xxxxxxxxx/xxxxxxxxxxxxxxxxxxxxxxxx"
      channel = "#general"
      global = true
      state-changes-only = true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send alert to Slack using default channel '#general'.</p> <pre data-language="javascript">node.slack()
</pre> <h4 id="slack-channel">Slack Channel</h4> <p>Slack channel in which to post messages. If empty uses the channel from the configuration.</p> <pre data-language="javascript">node.slack()
      .channel(value string)
</pre> <h4 id="slack-iconemoji">Slack IconEmoji</h4> <p>IconEmoji is an emoji name surrounded in ':' characters. The emoji image will replace the normal user icon for the slack bot.</p> <pre data-language="javascript">node.slack()
      .iconEmoji(value string)
</pre> <h4 id="slack-username">Slack Username</h4> <p>Username of the Slack bot. If empty uses the username from the configuration.</p> <pre data-language="javascript">node.slack()
      .username(value string)
</pre> <h3 id="snmptrap">SnmpTrap</h3> <p>Send the alert using SNMP traps. To allow Kapacitor to post SNMP traps,</p> <p>Example:</p> <pre data-language="javascript">    [snmptrap]
      enabled = true
      addr = "127.0.0.1:9162"
      community = "public"
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .snmpTrap('1.1.1.1')
                 .data('1.3.6.1.2.1.1.7', 'i', '{{ index .Field "value" }}')
</pre> <p>Send alerts to <code>target-ip:target-port</code> on OID '1.3.6.1.2.1.1.7'</p> <pre data-language="javascript">node.snmpTrap(trapOid string)
</pre> <h4 id="snmptrap-data">SnmpTrap Data</h4> <p>Define Data for SNMP Trap alert. Multiple calls append to the existing list of data.</p> <p>Available types:</p> <p>| Abbreviation | Datatype | | ———— | ——– | | c | Counter | | i | Integer | | n | Null | | s | String | | t | Time ticks |</p> <p>Example:</p> <pre data-language="javascript">    |alert()
       .message('{{ .ID }}:{{ .Level }}')
       .snmpTrap('1.3.6.1.4.1.1')
          .data('1.3.6.1.4.1.1.5', 's', '{{ .Level }}' )
          .data('1.3.6.1.4.1.1.6', 'i', '50' )
          .data('1.3.6.1.4.1.1.7', 'c', '{{ index .Fields "num_requests" }}' )
          .data('1.3.6.1.4.1.1.8', 's', '{{ .Message }}' )
</pre> <pre data-language="javascript">node.snmpTrap(trapOid string)
      .data(oid string, typ string, value string)
</pre> <h3 id="statechangesonly">StateChangesOnly</h3> <p>Only sends events where the state changed. Each different alert level OK, INFO, WARNING, and CRITICAL are considered different states.</p> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
       |window()
            .period(10s)
            .every(10s)
       |alert()
           .crit(lambda: "value" &gt; 10)
           .stateChangesOnly()
           .slack()
</pre> <p>If the "value" is greater than 10 for a total of 60s, then only two events will be sent. First, when the value crosses the threshold, and second, when it falls back into an OK state. Without stateChangesOnly, the alert would have triggered 7 times: 6 times for each 10s period where the condition was met and once more for the recovery.</p> <p>An optional maximum interval duration can be provided. An event will not be ignore (aka trigger an alert) if more than the maximum interval has elapsed since the last alert.</p> <p>Example:</p> <pre data-language="javascript">   stream
       |from()
           .measurement('cpu')
       |window()
            .period(10s)
            .every(10s)
       |alert()
           .crit(lambda: "value" &gt; 10)
           .stateChangesOnly(10m)
           .slack()
</pre> <p>The above usage will only trigger alerts to slack on state changes or at least every 10 minutes.</p> <pre data-language="javascript">node.stateChangesOnly(maxInterval ...time.Duration)
</pre> <h3 id="talk">Talk</h3> <p>Send the alert to Talk. To use Talk alerting you must first follow the steps to create a new incoming webhook.</p> <ol> <li>Go to the URL https:/account.jianliao.com/signin.</li> <li>Sign in with you account. under the Team tab, click "Integrations".</li> <li>Select "Customize service", click incoming Webhook "Add" button.</li> <li>After choose the topic to connect with "xxx", click "Confirm Add" button.</li> <li>Once the service is created, you'll see the "Generate Webhook url".</li> </ol> <p>Place the 'Generate Webhook url' into the 'Talk' section of the Kapacitor configuration as the option 'url'.</p> <p>Example:</p> <pre data-language="javascript">    [talk]
      enabled = true
      url = "https://jianliao.com/v2/services/webhook/uuid"
      author_name = "Kapacitor"
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .talk()
</pre> <p>Send alerts to Talk client.</p> <pre data-language="javascript">node.talk()
</pre> <h3 id="tcp">Tcp</h3> <p>Send JSON alert data to a specified address over TCP.</p> <pre data-language="javascript">node.tcp(address string)
</pre> <h4 id="tcp-address">Tcp Address</h4> <p>The endpoint address.</p> <pre data-language="javascript">node.tcp(address string)
      .address(value string)
</pre> <h3 id="telegram">Telegram</h3> <p>Send the alert to Telegram. For step-by-step instructions on setting up Kapacitor with Telegram, see the Event Handler Setup Guide (<a href="https://docs.influxdata.com//kapacitor/latest/guides/event-handler-setup/#telegram-setup">https://docs.influxdata.com//kapacitor/latest/guides/event-handler-setup/#telegram-setup</a>). To allow Kapacitor to post to Telegram,</p> <p>Example:</p> <pre data-language="javascript">    [telegram]
      enabled = true
      token = "123456789:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
      chat-id = "xxxxxxxxx"
      parse-mode = "Markdown"
	disable-web-page-preview = true
	disable-notification = false
</pre> <p>In order to not post a message every alert interval use <a href="index.html#statechangesonly">AlertNode.StateChangesOnly</a> so that only events where the alert changed state are posted to the chat-id.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .telegram()
</pre> <p>Send alerts to Telegram chat-id in the configuration file.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .telegram()
             .chatId('xxxxxxx')
</pre> <p>Send alerts to Telegram user/group 'xxxxxx'</p> <p>If the 'telegram' section in the configuration has the option: global = true then all alerts are sent to Telegram without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    [telegram]
      enabled = true
      token = "123456789:xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
      chat-id = "xxxxxxxxx"
      global = true
      state-changes-only = true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send alert to Telegram using default chat-id 'xxxxxxxx'.</p> <pre data-language="javascript">node.telegram()
</pre> <h4 id="telegram-chatid">Telegram ChatId</h4> <p>Telegram user/group ID to post messages to. If empty uses the chati-d from the configuration.</p> <pre data-language="javascript">node.telegram()
      .chatId(value string)
</pre> <h4 id="telegram-disablenotification">Telegram DisableNotification</h4> <p>Disables the Notification. If empty defaults to the configuration.</p> <pre data-language="javascript">node.telegram()
      .disableNotification()
</pre> <h4 id="telegram-disablewebpagepreview">Telegram DisableWebPagePreview</h4> <p>Disables the WebPagePreview. If empty defaults to the configuration.</p> <pre data-language="javascript">node.telegram()
      .disableWebPagePreview()
</pre> <h4 id="telegram-parsemode">Telegram ParseMode</h4> <p>Parse node, defaults to Mardown If empty uses the parse-mode from the configuration.</p> <pre data-language="javascript">node.telegram()
      .parseMode(value string)
</pre> <h3 id="topic">Topic</h3> <p>Topic specifies the name of an alert topic to which, alerts will be published. Alert handlers can be configured per topic, see the API documentation.</p> <pre data-language="javascript">node.topic(value string)
</pre> <h3 id="victorops">VictorOps</h3> <p>Send alert to VictorOps. To use VictorOps alerting you must first enable the 'Alert Ingestion API' in the 'Integrations' section of VictorOps. Then place the API key from the URL into the 'victorops' section of the Kapacitor configuration.</p> <p>Example:</p> <pre data-language="javascript">    [victorops]
      enabled = true
      api-key = "xxxxx"
      routing-key = "everyone"
</pre> <p>With the correct configuration you can now use VictorOps in TICKscripts.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .victorOps()
</pre> <p>Send alerts to VictorOps using the routing key in the configuration file.</p> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
             .victorOps()
             .routingKey('team_rocket')
</pre> <p>Send alerts to VictorOps with routing key 'team_rocket'</p> <p>If the 'victorops' section in the configuration has the option: global = true then all alerts are sent to VictorOps without the need to explicitly state it in the TICKscript.</p> <p>Example:</p> <pre data-language="javascript">    [victorops]
      enabled = true
      api-key = "xxxxx"
      routing-key = "everyone"
      global = true
</pre> <p>Example:</p> <pre data-language="javascript">    stream
         |alert()
</pre> <p>Send alert to VictorOps using the default routing key, found in the configuration.</p> <pre data-language="javascript">node.victorOps()
</pre> <h4 id="victorops-routingkey">VictorOps RoutingKey</h4> <p>The routing key to use for the alert. Defaults to the value in the configuration if empty.</p> <pre data-language="javascript">node.victorOps()
      .routingKey(value string)
</pre> <h3 id="warn">Warn</h3> <p>Filter expression for the WARNING alert level. An empty value indicates the level is invalid and is skipped.</p> <pre data-language="javascript">node.warn(value ast.LambdaNode)
</pre> <h3 id="warnreset">WarnReset</h3> <p>Filter expression for reseting the WARNING alert level to lower level.</p> <pre data-language="javascript">node.warnReset(value ast.LambdaNode)
</pre> <h2 id="chaining-methods-1">Chaining Methods</h2> <p>Chaining methods create a new node in the pipeline as a child of the calling node. They do not modify the calling node. Chaining methods are marked using the <code>|</code> operator.</p> <h3 id="alert">Alert</h3> <p>Create an alert node, which can trigger alerts.</p> <pre data-language="javascript">node|alert()
</pre> <p>Returns: <a href="index.html">AlertNode</a></p> <h3 id="bottom">Bottom</h3> <p>Select the bottom <code>num</code> points for <code>field</code> and sort by any extra tags or fields.</p> <pre data-language="javascript">node|bottom(num int64, field string, fieldsAndTags ...string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="combine">Combine</h3> <p>Combine this node with itself. The data are combined on timestamp.</p> <pre data-language="javascript">node|combine(expressions ...ast.LambdaNode)
</pre> <p>Returns: <a href="../combine_node/index.html">CombineNode</a></p> <h3 id="count">Count</h3> <p>Count the number of points.</p> <pre data-language="javascript">node|count(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="cumulativesum">CumulativeSum</h3> <p>Compute a cumulative sum of each point that is received. A point is emitted for every point collected.</p> <pre data-language="javascript">node|cumulativeSum(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="deadman">Deadman</h3> <p>Helper function for creating an alert on low throughput, a.k.a. deadman's switch.</p> <ul> <li>Threshold – trigger alert if throughput drops below threshold in points/interval.</li> <li>Interval – how often to check the throughput.</li> <li>Expressions – optional list of expressions to also evaluate. Useful for time of day alerting.</li> </ul> <p>Example:</p> <pre data-language="javascript">    var data = stream
        |from()...
    // Trigger critical alert if the throughput drops below 100 points per 10s and checked every 10s.
    data
        |deadman(100.0, 10s)
    //Do normal processing of data
    data...
</pre> <p>The above is equivalent to this Example:</p> <pre data-language="javascript">    var data = stream
        |from()...
    // Trigger critical alert if the throughput drops below 100 points per 10s and checked every 10s.
    data
        |stats(10s)
            .align()
        |derivative('emitted')
            .unit(10s)
            .nonNegative()
        |alert()
            .id('node \'stream0\' in task \'{{ .TaskName }}\'')
            .message('{{ .ID }} is {{ if eq .Level "OK" }}alive{{ else }}dead{{ end }}: {{ index .Fields "emitted" | printf "%0.3f" }} points/10s.')
            .crit(lambda: "emitted" &lt;= 100.0)
    //Do normal processing of data
    data...
</pre> <p>The <code>id</code> and <code>message</code> alert properties can be configured globally via the 'deadman' configuration section.</p> <p>Since the <a href="index.html">AlertNode</a> is the last piece it can be further modified as usual. Example:</p> <pre data-language="javascript">    var data = stream
        |from()...
    // Trigger critical alert if the throughput drops below 100 points per 10s and checked every 10s.
    data
        |deadman(100.0, 10s)
            .slack()
            .channel('#dead_tasks')
    //Do normal processing of data
    data...
</pre> <p>You can specify additional lambda expressions to further constrain when the deadman's switch is triggered. Example:</p> <pre data-language="javascript">    var data = stream
        |from()...
    // Trigger critical alert if the throughput drops below 100 points per 10s and checked every 10s.
    // Only trigger the alert if the time of day is between 8am-5pm.
    data
        |deadman(100.0, 10s, lambda: hour("time") &gt;= 8 AND hour("time") &lt;= 17)
    //Do normal processing of data
    data...
</pre> <pre data-language="javascript">node|deadman(threshold float64, interval time.Duration, expr ...ast.LambdaNode)
</pre> <p>Returns: <a href="index.html">AlertNode</a></p> <h3 id="default">Default</h3> <p>Create a node that can set defaults for missing tags or fields.</p> <pre data-language="javascript">node|default()
</pre> <p>Returns: <a href="../default_node/index.html">DefaultNode</a></p> <h3 id="delete">Delete</h3> <p>Create a node that can delete tags or fields.</p> <pre data-language="javascript">node|delete()
</pre> <p>Returns: <a href="../delete_node/index.html">DeleteNode</a></p> <h3 id="derivative">Derivative</h3> <p>Create a new node that computes the derivative of adjacent points.</p> <pre data-language="javascript">node|derivative(field string)
</pre> <p>Returns: <a href="../derivative_node/index.html">DerivativeNode</a></p> <h3 id="difference">Difference</h3> <p>Compute the difference between points independent of elapsed time.</p> <pre data-language="javascript">node|difference(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="distinct">Distinct</h3> <p>Produce batch of only the distinct points.</p> <pre data-language="javascript">node|distinct(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="elapsed">Elapsed</h3> <p>Compute the elapsed time between points</p> <pre data-language="javascript">node|elapsed(field string, unit time.Duration)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="eval">Eval</h3> <p>Create an eval node that will evaluate the given transformation function to each data point. A list of expressions may be provided and will be evaluated in the order they are given. The results are available to later expressions.</p> <pre data-language="javascript">node|eval(expressions ...ast.LambdaNode)
</pre> <p>Returns: <a href="../eval_node/index.html">EvalNode</a></p> <h3 id="first">First</h3> <p>Select the first point.</p> <pre data-language="javascript">node|first(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="flatten">Flatten</h3> <p>Flatten points with similar times into a single point.</p> <pre data-language="javascript">node|flatten()
</pre> <p>Returns: <a href="../flatten_node/index.html">FlattenNode</a></p> <h3 id="groupby">GroupBy</h3> <p>Group the data by a set of tags.</p> <p>Can pass literal * to group by all dimensions. Example:</p> <pre data-language="javascript">    |groupBy(*)
</pre> <pre data-language="javascript">node|groupBy(tag ...interface{})
</pre> <p>Returns: <a href="../group_by_node/index.html">GroupByNode</a></p> <h3 id="holtwinters">HoltWinters</h3> <p>Compute the holt-winters (<a href="https://docs.influxdata.com/influxdb/latest/query_language/functions/#holt-winters">https://docs.influxdata.com/influxdb/latest/query_language/functions/#holt-winters</a>) forecast of a data set.</p> <pre data-language="javascript">node|holtWinters(field string, h int64, m int64, interval time.Duration)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="holtwinterswithfit">HoltWintersWithFit</h3> <p>Compute the holt-winters (<a href="https://docs.influxdata.com/influxdb/latest/query_language/functions/#holt-winters">https://docs.influxdata.com/influxdb/latest/query_language/functions/#holt-winters</a>) forecast of a data set. This method also outputs all the points used to fit the data in addition to the forecasted data.</p> <pre data-language="javascript">node|holtWintersWithFit(field string, h int64, m int64, interval time.Duration)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="httpout">HttpOut</h3> <p>Create an HTTP output node that caches the most recent data it has received. The cached data are available at the given endpoint. The endpoint is the relative path from the API endpoint of the running task. For example, if the task endpoint is at <code>/kapacitor/v1/tasks/&amp;lt;task_id&amp;gt;</code> and endpoint is <code>top10</code>, then the data can be requested from <code>/kapacitor/v1/tasks/&amp;lt;task_id&amp;gt;/top10</code>.</p> <pre data-language="javascript">node|httpOut(endpoint string)
</pre> <p>Returns: <a href="../http_out_node/index.html">HTTPOutNode</a></p> <h3 id="httppost">HttpPost</h3> <p>Creates an HTTP Post node that POSTS received data to the provided HTTP endpoint. HttpPost expects 0 or 1 arguments. If 0 arguments are provided, you must specify an endpoint property method.</p> <pre data-language="javascript">node|httpPost(url ...string)
</pre> <p>Returns: <a href="../http_post_node/index.html">HTTPPostNode</a></p> <h3 id="influxdbout">InfluxDBOut</h3> <p>Create an influxdb output node that will store the incoming data into InfluxDB.</p> <pre data-language="javascript">node|influxDBOut()
</pre> <p>Returns: <a href="../influx_d_b_out_node/index.html">InfluxDBOutNode</a></p> <h3 id="join">Join</h3> <p>Join this node with other nodes. The data are joined on timestamp.</p> <pre data-language="javascript">node|join(others ...Node)
</pre> <p>Returns: <a href="../join_node/index.html">JoinNode</a></p> <h3 id="k8sautoscale">K8sAutoscale</h3> <p>Create a node that can trigger autoscale events for a kubernetes cluster.</p> <pre data-language="javascript">node|k8sAutoscale()
</pre> <p>Returns: <a href="../k8s_autoscale_node/index.html">K8sAutoscaleNode</a></p> <h3 id="kapacitorloopback">KapacitorLoopback</h3> <p>Create an kapacitor loopback node that will send data back into Kapacitor as a stream.</p> <pre data-language="javascript">node|kapacitorLoopback()
</pre> <p>Returns: <a href="../kapacitor_loopback_node/index.html">KapacitorLoopbackNode</a></p> <h3 id="last">Last</h3> <p>Select the last point.</p> <pre data-language="javascript">node|last(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="max">Max</h3> <p>Select the maximum point.</p> <pre data-language="javascript">node|max(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="mean">Mean</h3> <p>Compute the mean of the data.</p> <pre data-language="javascript">node|mean(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="median">Median</h3> <p>Compute the median of the data. Note, this method is not a selector, if you want the median point use <code>.percentile(field, 50.0)</code>.</p> <pre data-language="javascript">node|median(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="min">Min</h3> <p>Select the minimum point.</p> <pre data-language="javascript">node|min(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="mode">Mode</h3> <p>Compute the mode of the data.</p> <pre data-language="javascript">node|mode(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="movingaverage">MovingAverage</h3> <p>Compute a moving average of the last window points. No points are emitted until the window is full.</p> <pre data-language="javascript">node|movingAverage(field string, window int64)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="percentile">Percentile</h3> <p>Select a point at the given percentile. This is a selector function, no interpolation between points is performed.</p> <pre data-language="javascript">node|percentile(field string, percentile float64)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="sample">Sample</h3> <p>Create a new node that samples the incoming points or batches.</p> <p>One point will be emitted every count or duration specified.</p> <pre data-language="javascript">node|sample(rate interface{})
</pre> <p>Returns: <a href="../sample_node/index.html">SampleNode</a></p> <h3 id="shift">Shift</h3> <p>Create a new node that shifts the incoming points or batches in time.</p> <pre data-language="javascript">node|shift(shift time.Duration)
</pre> <p>Returns: <a href="../shift_node/index.html">ShiftNode</a></p> <h3 id="spread">Spread</h3> <p>Compute the difference between <code>min</code> and <code>max</code> points.</p> <pre data-language="javascript">node|spread(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="statecount">StateCount</h3> <p>Create a node that tracks number of consecutive points in a given state.</p> <pre data-language="javascript">node|stateCount(expression ast.LambdaNode)
</pre> <p>Returns: <a href="../state_count_node/index.html">StateCountNode</a></p> <h3 id="stateduration">StateDuration</h3> <p>Create a node that tracks duration in a given state.</p> <pre data-language="javascript">node|stateDuration(expression ast.LambdaNode)
</pre> <p>Returns: <a href="../state_duration_node/index.html">StateDurationNode</a></p> <h3 id="stats">Stats</h3> <p>Create a new stream of data that contains the internal statistics of the node. The interval represents how often to emit the statistics based on real time. This means the interval time is independent of the times of the data points the source node is receiving.</p> <pre data-language="javascript">node|stats(interval time.Duration)
</pre> <p>Returns: <a href="../stats_node/index.html">StatsNode</a></p> <h3 id="stddev">Stddev</h3> <p>Compute the standard deviation.</p> <pre data-language="javascript">node|stddev(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="sum">Sum</h3> <p>Compute the sum of all values.</p> <pre data-language="javascript">node|sum(field string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="top">Top</h3> <p>Select the top <code>num</code> points for <code>field</code> and sort by any extra tags or fields.</p> <pre data-language="javascript">node|top(num int64, field string, fieldsAndTags ...string)
</pre> <p>Returns: <a href="../influx_q_l_node/index.html">InfluxQLNode</a></p> <h3 id="union">Union</h3> <p>Perform the union of this node and all other given nodes.</p> <pre data-language="javascript">node|union(node ...Node)
</pre> <p>Returns: <a href="../union_node/index.html">UnionNode</a></p> <h3 id="where">Where</h3> <p>Create a new node that filters the data stream by a given expression.</p> <pre data-language="javascript">node|where(expression ast.LambdaNode)
</pre> <p>Returns: <a href="../where_node/index.html">WhereNode</a></p> <h3 id="window">Window</h3> <p>Create a new node that windows the stream by time.</p> <p>NOTE: Window can only be applied to stream edges.</p> <pre data-language="javascript">node|window()
</pre> <p>Returns: <a href="../window_node/index.html">WindowNode</a></p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2015 InfluxData, Inc.<br>Licensed under the MIT license.<br>
    <a href="https://docs.influxdata.com/kapacitor/v1.3/nodes/alert_node/" class="_attribution-link">https://docs.influxdata.com/kapacitor/v1.3/nodes/alert_node/</a>
  </p>
</div>
