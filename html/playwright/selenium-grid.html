<header><h1>Selenium Grid (experimental)</h1></header><h2 id="introduction">Introduction<a href="#introduction" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a>
</h2> <p>Playwright can connect to <a href="https://www.selenium.dev/documentation/grid/" target="_blank" rel="noopener noreferrer">Selenium Grid Hub</a> that runs Selenium 4 to launch <strong>Google Chrome</strong> or <strong>Microsoft Edge</strong> browser, instead of running browser on the local machine. Note this feature is <strong>experimental</strong> and is prioritized accordingly.</p> <blockquote>
<div>
warning</div>
<div>
<p>There is a risk of Playwright integration with Selenium Grid Hub breaking in the future. Make sure you weight risks against benefits before using it.</p>
<blockquote data-collapsed="true">
<summary><span style="text-transform:uppercase;font-size:smaller;font-weight:bold;opacity:0.6">More details</span></summary><div><div><p>Internally, Playwright connects to the browser using <a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank" rel="noopener noreferrer">Chrome DevTools Protocol</a> websocket. Selenium 4 currently exposes this capability. However, this <a href="https://github.com/SeleniumHQ/selenium/issues/11590#issuecomment-1436113950" target="_blank" rel="noopener noreferrer">might not be the case in the future</a>. If Selenium drops this capability, Playwright will stop working with it.</p></div></div>
</blockquote>
</div>
</blockquote> <p>Before connecting Playwright to your Selenium Grid, make sure that grid works with <a href="https://www.selenium.dev/documentation/webdriver/" target="_blank" rel="noopener noreferrer">Selenium WebDriver</a>. For example, run <a href="https://github.com/SeleniumHQ/selenium/tree/trunk/javascript/node/selenium-webdriver/example" target="_blank" rel="noopener noreferrer">one of the examples</a> and pass <code>SELENIUM_REMOTE_URL</code> environment variable. If webdriver example does not work, look for any errors at your Selenium hub/node/standalone output and search <a href="https://github.com/SeleniumHQ/selenium/issues" target="_blank" rel="noopener noreferrer">Selenium issues</a> for a possible solution.</p> <h2 id="starting-selenium-grid">Starting Selenium Grid<a href="#starting-selenium-grid" aria-label="Direct link to Starting Selenium Grid" title="Direct link to Starting Selenium Grid">​</a>
</h2> <p>If you run distributed Selenium Grid, Playwright needs selenium nodes to be registered with an accessible address, so that it could connect to the browsers. To make sure it works as expected, set <code>SE_NODE_GRID_URL</code> environment variable pointing to the hub when running selenium nodes.</p> <pre tabindex="0" data-language="javascript"># Start selenium node
SE_NODE_GRID_URL="http://&lt;selenium-hub-ip&gt;:4444" java -jar selenium-server-&lt;version&gt;.jar node</pre> <h2 id="connecting-playwright-to-selenium-grid">Connecting Playwright to Selenium Grid<a href="#connecting-playwright-to-selenium-grid" aria-label="Direct link to Connecting Playwright to Selenium Grid" title="Direct link to Connecting Playwright to Selenium Grid">​</a>
</h2> <p>To connect Playwright to <strong>Selenium Grid 4</strong>, set <code>SELENIUM_REMOTE_URL</code> environment variable pointing to your Selenium Grid Hub. Note that this only works for Google Chrome and Microsoft Edge.</p> <pre tabindex="0" data-language="javascript">SELENIUM_REMOTE_URL=http://&lt;selenium-hub-ip&gt;:4444 npx playwright test</pre> <p>You don't have to change your code, just use your testing harness or <a href="api/class-browsertype.html#browser-type-launch">browserType.launch()</a> as usual.</p> <h3 id="passing-additional-capabilities">Passing additional capabilities<a href="#passing-additional-capabilities" aria-label="Direct link to Passing additional capabilities" title="Direct link to Passing additional capabilities">​</a>
</h3> <p>If your grid requires additional capabilities to be set (for example, you use an external service), you can set <code>SELENIUM_REMOTE_CAPABILITIES</code> environment variable to provide JSON-serialized capabilities.</p> <pre tabindex="0" data-language="javascript">SELENIUM_REMOTE_URL=http://&lt;selenium-hub-ip&gt;:4444 SELENIUM_REMOTE_CAPABILITIES="{'mygrid:options':{os:'windows',username:'John',password:'secure'}}" npx playwright test</pre> <h3 id="passing-additional-headers">Passing additional headers<a href="#passing-additional-headers" aria-label="Direct link to Passing additional headers" title="Direct link to Passing additional headers">​</a>
</h3> <p>If your grid requires additional headers to be set (for example, you should provide authorization token to use browsers in your cloud), you can set <code>SELENIUM_REMOTE_HEADERS</code> environment variable to provide JSON-serialized headers.</p> <pre tabindex="0" data-language="javascript">SELENIUM_REMOTE_URL=http://&lt;selenium-hub-ip&gt;:4444 SELENIUM_REMOTE_HEADERS="{'Authorization':'Basic b64enc'}" npx playwright test</pre> <h3 id="detailed-logs">Detailed logs<a href="#detailed-logs" aria-label="Direct link to Detailed logs" title="Direct link to Detailed logs">​</a>
</h3> <p>Run with <code>DEBUG=pw:browser*</code> environment variable to see how Playwright is connecting to Selenium Grid.</p> <pre tabindex="0" data-language="javascript">DEBUG=pw:browser* SELENIUM_REMOTE_URL=http://internal.grid:4444 npx playwright test</pre> <p>If you file an issue, please include this log.</p> <h2 id="using-selenium-docker">Using Selenium Docker<a href="#using-selenium-docker" aria-label="Direct link to Using Selenium Docker" title="Direct link to Using Selenium Docker">​</a>
</h2> <p>One easy way to use Selenium Grid is to run official docker containers. Read more in <a href="https://github.com/SeleniumHQ/docker-selenium" target="_blank" rel="noopener noreferrer">selenium docker images</a> documentation. For image tagging convention, <a href="https://github.com/SeleniumHQ/docker-selenium/wiki/Tagging-Convention#selenium-grid-4x-and-above" target="_blank" rel="noopener noreferrer">read more</a>.</p> <h3 id="standalone-mode">Standalone mode<a href="#standalone-mode" aria-label="Direct link to Standalone mode" title="Direct link to Standalone mode">​</a>
</h3> <p>Here is an example of running selenium standalone and connecting Playwright to it. Note that hub and node are on the same <code>localhost</code>, and we pass <code>SE_NODE_GRID_URL</code> environment variable pointing to it.</p> <p>First start Selenium.</p> <pre tabindex="0" data-language="javascript">docker run -d -p 4444:4444 --shm-size="2g" -e SE_NODE_GRID_URL="http://localhost:4444" selenium/standalone-chromium:latest</pre> <p>Then run Playwright.</p> <pre tabindex="0" data-language="javascript">SELENIUM_REMOTE_URL=http://localhost:4444 npx playwright test</pre> <h3 id="hub-and-nodes-mode">Hub and nodes mode<a href="#hub-and-nodes-mode" aria-label="Direct link to Hub and nodes mode" title="Direct link to Hub and nodes mode">​</a>
</h3> <p>Here is an example of running selenium hub and a single selenium node, and connecting Playwright to the hub. Note that hub and node have different IPs, and we pass <code>SE_NODE_GRID_URL</code> environment variable pointing to the hub when starting node containers.</p> <p>First start the hub container and one or more node containers.</p> <pre tabindex="0" data-language="javascript">docker run -d -p 4442-4444:4442-4444 --name selenium-hub selenium/hub:4.25.0
docker run -d -p 5555:5555 \
    --shm-size="2g" \
    -e SE_EVENT_BUS_HOST=&lt;selenium-hub-ip&gt; \
    -e SE_EVENT_BUS_PUBLISH_PORT=4442 \
    -e SE_EVENT_BUS_SUBSCRIBE_PORT=4443 \
    -e SE_NODE_GRID_URL="http://&lt;selenium-hub-ip&gt;:4444"
    selenium/node-chromium:4.25.0</pre> <p>Then run Playwright.</p> <pre tabindex="0" data-language="javascript">SELENIUM_REMOTE_URL=http://&lt;selenium-hub-ip&gt;:4444 npx playwright test</pre> <h2 id="selenium-3">Selenium 3<a href="#selenium-3" aria-label="Direct link to Selenium 3" title="Direct link to Selenium 3">​</a>
</h2> <p>Internally, Playwright connects to the browser using <a href="https://chromedevtools.github.io/devtools-protocol/" target="_blank" rel="noopener noreferrer">Chrome DevTools Protocol</a> websocket. Selenium 4 exposes this capability, while Selenium 3 does not.</p> <p>This means that Selenium 3 is supported in a best-effort manner, where Playwright tries to connect to the grid node directly. Grid nodes must be directly accessible from the machine that runs Playwright.</p><div class="_attribution">
  <p class="_attribution-p">
          &copy; 2024 Microsoft<br>Licensed under the Apache License, Version 2.0.<br>
    <a href="https://playwright.dev/docs/selenium-grid" class="_attribution-link">https://playwright.dev/docs/selenium-grid</a>
  </p>
</div>
