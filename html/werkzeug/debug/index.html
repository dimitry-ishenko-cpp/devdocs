<h1 id="debugging-applications">Debugging Applications</h1> <p>Depending on the WSGI gateway/server, exceptions are handled differently. Most of the time, exceptions go to stderr or the error log, and a generic “500 Internal Server Error” message is displayed.</p> <p>Since this is not the best debugging environment, Werkzeug provides a WSGI middleware that renders nice tracebacks, optionally with an interactive debug console to execute code in any frame.</p> <div class="admonition danger"> <p class="admonition-title">Danger</p> <p>The debugger allows the execution of arbitrary code which makes it a major security risk. <strong>The debugger must never be used on production machines. We cannot stress this enough. Do not enable the debugger in production.</strong> Production means anything that is not development, and anything that is publicly accessible.</p> </div> <div class="admonition note"> <p class="admonition-title">Note</p> <p>The interactive debugger does not work in forking environments, such as a server that starts multiple processes. Most such environments are production servers, where the debugger should not be enabled anyway.</p> </div> <section id="enabling-the-debugger"> <h2>Enabling the Debugger</h2> <p>Enable the debugger by wrapping the application with the <a class="reference internal" href="#werkzeug.debug.DebuggedApplication" title="werkzeug.debug.DebuggedApplication"><code>DebuggedApplication</code></a> middleware. Alternatively, you can pass <code>use_debugger=True</code> to <code>run_simple()</code> and it will do that for you.</p> <dl class="py class"> <dt class="sig sig-object py" id="werkzeug.debug.DebuggedApplication">
<code>class werkzeug.debug.DebuggedApplication(app, evalex=False, request_key='werkzeug.request', console_path='/console', console_init_func=None, show_hidden_frames=False, pin_security=True, pin_logging=True)</code> </dt> <dd>
<p>Enables debugging support for a given application:</p> <pre data-language="python">from werkzeug.debug import DebuggedApplication
from myapp import app
app = DebuggedApplication(app, evalex=True)
</pre> <p>The <code>evalex</code> argument allows evaluating expressions in any frame of a traceback. This works by preserving each frame with its local state. Some state, such as context globals, cannot be restored with the frame by default. When <code>evalex</code> is enabled, <code>environ["werkzeug.debug.preserve_context"]</code> will be a callable that takes a context manager, and can be called multiple times. Each context manager will be entered before evaluating code in the frame, then exited again, so they can perform setup and cleanup for each call.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>app</strong> (<em>WSGIApplication</em>) – the WSGI application to run debugged.</li> <li>
<strong>evalex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>) – enable exception evaluation feature (interactive debugging). This requires a non-forking server.</li> <li>
<strong>request_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>) – The key that points to the request object in this environment. This parameter is ignored in current versions.</li> <li>
<strong>console_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a>) – the URL for a general purpose console.</li> <li>
<strong>console_init_func</strong> (<em>t.Callable</em><em>[</em><em>[</em><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)">str</a><em>, </em><em>t.Any</em><em>]</em><em>] </em><em>| </em><em>None</em>) – the function that is executed before starting the general purpose console. The return value is used as initial namespace.</li> <li>
<strong>show_hidden_frames</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>) – by default hidden traceback frames are skipped. You can show them by setting this parameter to <code>True</code>.</li> <li>
<strong>pin_security</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>) – can be used to disable the pin based security system.</li> <li>
<strong>pin_logging</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.13)">bool</a>) – enables the logging of the pin system.</li> </ul> </dd> </dl> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.2: </span>Added the <code>werkzeug.debug.preserve_context</code> environ key.</p> </div> </details>
</dd>
</dl> </section> <section id="using-the-debugger"> <h2>Using the Debugger</h2> <p>Once enabled and an error happens during a request you will see a detailed traceback instead of a generic “internal server error”. The traceback is still output to the terminal as well.</p> <p>The error message is displayed at the top. Clicking it jumps to the bottom of the traceback. Frames that represent user code, as opposed to built-ins or installed packages, are highlighted blue. Clicking a frame will show more lines for context, clicking again will hide them.</p> <p>If you have the <code>evalex</code> feature enabled you can get a console for every frame in the traceback by hovering over a frame and clicking the console icon that appears at the right. Once clicked a console opens where you can execute Python code in:</p> <img alt="a screenshot of the interactive debugger" class="align-center" src="https://werkzeug.palletsprojects.com/en/latest/_images/debug-screenshot.png"> <p>Inside the interactive consoles you can execute any kind of Python code. Unlike regular Python consoles the output of the object reprs is colored and stripped to a reasonable size by default. If the output is longer than what the console decides to display a small plus sign is added to the repr and a click will expand the repr.</p> <p>To display all variables that are defined in the current frame you can use the <code>dump()</code> function. You can call it without arguments to get a detailed list of all variables and their values, or with an object as argument to get a detailed list of all the attributes it has.</p> </section> <section id="debugger-pin"> <h2>Debugger PIN</h2> <p>The debug console is protected by a PIN. This is a security helper to make it less likely for the debugger to be exploited if you forget to disable it when deploying to production. The PIN based authentication is enabled by default.</p> <p>The first time a console is opened, a dialog will prompt for a PIN that is printed to the command line. The PIN is generated in a stable way that is specific to the project. An explicit PIN can be provided through the environment variable <code>WERKZEUG_DEBUG_PIN</code>. This can be set to a number and will become the PIN. This variable can also be set to the value <code>off</code> to disable the PIN check entirely.</p> <p>If an incorrect PIN is entered too many times the server needs to be restarted.</p> <p><strong>This feature is not meant to entirely secure the debugger. It is intended to make it harder for an attacker to exploit the debugger. Never enable the debugger in production.</strong></p> </section> <section id="allowed-hosts"> <h2>Allowed Hosts</h2> <p>The debug console will only be served if the request comes from a trusted host. If a request comes from a browser page that is not served on a trusted URL, a 400 error will be returned.</p> <p>By default, <code>localhost</code>, any <code>.localhost</code> subdomain, and <code>127.0.0.1</code> are trusted. <code>run_simple</code> will trust its <code>hostname</code> argument as well. To change this further, use the debug middleware directly rather than through <code>use_debugger=True</code>.</p> <pre data-language="python">if os.environ.get("USE_DEBUGGER") in {"1", "true"}:
    app = DebuggedApplication(app, evalex=True)
    app.trusted_hosts = [...]

run_simple("localhost", 8080, app)
</pre> <p><strong>This feature is not meant to entirely secure the debugger. It is intended to make it harder for an attacker to exploit the debugger. Never enable the debugger in production.</strong></p> </section> <section id="pasting-errors"> <h2>Pasting Errors</h2> <p>If you click on the “Traceback (most recent call last)” header, the view switches to a traditional text-based traceback. You can copy and paste this in order to provide information when asking a question or reporting an issue.</p> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007 Pallets<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://werkzeug.palletsprojects.com/en/latest/debug/" class="_attribution-link">https://werkzeug.palletsprojects.com/en/latest/debug/</a>
  </p>
</div>
