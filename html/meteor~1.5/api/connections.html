<h1 class="title-page">Server Connections</h1> <div class="subtitle-page">Documentation on how to use Meteor's client-server connection.</div>    <p>These functions manage and inspect the network connection between the Meteor client and server.</p>  <h2 class="api-heading" id="Meteor-status"> <div class="locus"> Client </div> <code>Meteor.status()</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/ddp-client/livedata_connection.js#L1062" target="_blank"> (ddp-client/livedata_connection.js, line 1062) </a> </div> </h2>   <p>Get the current connection status. A reactive data source.</p>    <p>This method returns the status of the connection between the client and the server. The return value is an object with the following fields:</p> <dl class="objdesc"> <dt>
<span class="name">connected</span><span class="type">Boolean</span>
</dt>
<dd>
<p>True if currently connected to the server. If false, changes and method invocations will be queued up until the connection is reestablished.</p> </dd> <dt>
<span class="name">status</span><span class="type">String</span>
</dt>
<dd>
<p>Describes the current reconnection status. The possible values are <code>connected</code> (the connection is up and running), <code>connecting</code> (disconnected and trying to open a new connection), <code>failed</code> (permanently failed to connect; e.g., the client and server support different versions of DDP), <code>waiting</code> (failed to connect and waiting to try to reconnect) and <code>offline</code> (user has disconnected the connection).</p> </dd> <dt>
<span class="name">retryCount</span><span class="type">Number</span>
</dt>
<dd>
<p>The number of times the client has tried to reconnect since the connection was lost. 0 when connected.</p> </dd> <dt>
<span class="name">retryTime</span><span class="type">Number or undefined</span>
</dt>
<dd>
<p>The estimated time of the next reconnection attempt. To turn this into an interval until the next reconnection, use <code>retryTime - (new Date()).getTime()</code>. This key will be set only when <code>status</code> is <code>waiting</code>.</p> </dd> <dt>
<span class="name">reason</span><span class="type">String or undefined</span>
</dt>
<dd>
<p>If <code>status</code> is <code>failed</code>, a description of why the connection failed.</p> </dd> </dl> <p>Instead of using callbacks to notify you on changes, this is a <a href="#reactivity">reactive</a> data source. You can use it in a <a href="#livehtmltemplates">template</a> or <a href="#tracker_autorun">computation</a> to get realtime updates.</p>  <h2 class="api-heading" id="Meteor-reconnect"> <div class="locus"> Client </div> <code>Meteor.reconnect()</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/ddp-client/livedata_connection.js#L1075" target="_blank"> (ddp-client/livedata_connection.js, line 1075) </a> </div> </h2>   <p>Force an immediate reconnection attempt if the client is not connected to the server.</p> <p> This method does nothing if the client is already connected.</p>     <h2 class="api-heading" id="Meteor-disconnect"> <div class="locus"> Client </div> <code>Meteor.disconnect()</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/ddp-client/livedata_connection.js#L1086" target="_blank"> (ddp-client/livedata_connection.js, line 1086) </a> </div> </h2>   <p>Disconnect the client from the server.</p>    <p>Call this method to disconnect from the server and stop all live data updates. While the client is disconnected it will not receive updates to collections, method calls will be queued until the connection is reestablished, and hot code push will be disabled.</p> <p>Call <a href="#meteor_reconnect">Meteor.reconnect</a> to reestablish the connection and resume data transfer.</p> <p>This can be used to save battery on mobile devices when real time updates are not required.</p>  <h2 class="api-heading" id="Meteor-onConnection"> <div class="locus"> Server </div> <code>Meteor.onConnection(callback)</code> <div class="subtext-api"> <code>import { Meteor } from 'meteor/meteor'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/ddp-server/livedata_server.js#L1426" target="_blank"> (ddp-server/livedata_server.js, line 1426) </a> </div> </h2>   <p>Register a callback to be called when a new DDP connection is made to the server.</p>  <h4 class="subheading">Arguments</h4> <dl class="args"> <dt> <code>callback</code> <span class="type">Function</span> </dt> <dd> <p>The function to call when a new DDP connection is established.</p> </dd> </dl>   <p><code>onConnection</code> returns an object with a single method <code>stop</code>. Calling <code>stop</code> unregisters the callback, so that this callback will no longer be called on new connections.</p> <p>The callback is called with a single argument, the server-side <code>connection</code> representing the connection from the client. This object contains the following fields:</p> <dl class="objdesc"> <dt>
<span class="name">id</span><span class="type">String</span>
</dt>
<dd>
<p>A globally unique id for this connection.</p> </dd> <dt>
<span class="name">close</span><span class="type">Function</span>
</dt>
<dd>
<p>Close this DDP connection. The client is free to reconnect, but will receive a different connection with a new <code>id</code> if it does.</p> </dd> <dt>
<span class="name">onClose</span><span class="type">Function</span>
</dt>
<dd>
<p>Register a callback to be called when the connection is closed. If the connection is already closed, the callback will be called immediately.</p> </dd> <dt>
<span class="name">clientAddress</span><span class="type">String</span>
</dt>
<dd>
<p>The IP address of the client in dotted form (such as <code>127.0.0.1</code>).</p> <p>If you’re running your Meteor server behind a proxy (so that clients are connecting to the proxy instead of to your server directly), you’ll need to set the <code>HTTP_FORWARDED_COUNT</code> environment variable for the correct IP address to be reported by <code>clientAddress</code>.</p> <p>Set <code>HTTP_FORWARDED_COUNT</code> to an integer representing the number of proxies in front of your server. For example, you’d set it to <code>1</code> when your server was behind one proxy.</p> </dd> <dt>
<span class="name">httpHeaders</span><span class="type">Object</span>
</dt>
<dd>
<p>When the connection came in over an HTTP transport (such as with Meteor’s default SockJS implementation), this field contains whitelisted HTTP headers.</p> <p>Cookies are deliberately excluded from the headers as they are a security risk for this transport. For details and alternatives, see the <a href="https://github.com/sockjs/sockjs-node#authorisation" target="_blank" rel="external">SockJS documentation</a>.</p> </dd> </dl> <blockquote> <p>Currently when a client reconnects to the server (such as after temporarily losing its Internet connection), it will get a new connection each time. The <code>onConnection</code> callbacks will be called again, and the new connection will have a new connection <code>id</code>.</p> <p>In the future, when client reconnection is fully implemented, reconnecting from the client will reconnect to the same connection on the server: the <code>onConnection</code> callback won’t be called for that connection again, and the connection will still have the same connection <code>id</code>.</p> </blockquote>  <h2 class="api-heading" id="DDP-connect"> <div class="locus"> Anywhere </div> <code>DDP.connect(url)</code> <div class="subtext-api"> <code>import { DDP } from 'meteor/ddp-client'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/ddp-client/livedata_connection.js#L1758" target="_blank"> (ddp-client/livedata_connection.js, line 1758) </a> </div> </h2>   <p>Connect to the server of a different Meteor application to subscribe to its document sets and invoke its remote methods.</p>  <h4 class="subheading">Arguments</h4> <dl class="args"> <dt> <code>url</code> <span class="type">String</span> </dt> <dd> <p>The URL of another Meteor application.</p> </dd> </dl>   <p>To call methods on another Meteor application or subscribe to its data sets, call <code>DDP.connect</code> with the URL of the application. <code>DDP.connect</code> returns an object which provides:</p> <ul> <li>
<code>subscribe</code> - Subscribe to a record set. See <a href="#meteor_subscribe">Meteor.subscribe</a>.</li> <li>
<code>call</code> - Invoke a method. See <a href="#meteor_call">Meteor.call</a>.</li> <li>
<code>apply</code> - Invoke a method with an argument array. See <a href="#meteor_apply">Meteor.apply</a>.</li> <li>
<code>methods</code> - Define client-only stubs for methods defined on the remote server. See <a href="#meteor_methods">Meteor.methods</a>.</li> <li>
<code>status</code> - Get the current connection status. See <a href="#meteor_status">Meteor.status</a>.</li> <li>
<code>reconnect</code> - See <a href="#meteor_reconnect">Meteor.reconnect</a>.</li> <li>
<code>disconnect</code> - See <a href="#meteor_disconnect">Meteor.disconnect</a>.</li> </ul> <p>By default, clients open a connection to the server from which they’re loaded. When you call <code>Meteor.subscribe</code>, <code>Meteor.status</code>, <code>Meteor.call</code>, and <code>Meteor.apply</code>, you are using a connection back to that default server.</p>  <h2 class="api-heading" id="DDP-onReconnect"> <div class="locus"> Anywhere </div> <code>DDP.onReconnect(callback)</code> <div class="subtext-api"> <code>import { DDP } from 'meteor/ddp-client'</code> <a class="src-code link secondary" href="https://github.com/meteor/meteor/blob/master/packages/ddp-client/livedata_connection.js#L1775" target="_blank"> (ddp-client/livedata_connection.js, line 1775) </a> </div> </h2>   <p>Register a function to call as the first step of reconnecting. This function can call methods which will be executed before any other outstanding methods. For example, this can be used to re-establish the appropriate authentication context on the connection.</p>  <h4 class="subheading">Arguments</h4> <dl class="args"> <dt> <code>callback</code> <span class="type">Function</span> </dt> <dd> <p>The function to call. It will be called with a single argument, the <a href="#ddp_connect">connection object</a> that is reconnecting.</p> </dd> </dl><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2011&ndash;2017 Meteor Development Group, Inc.<br>Licensed under the MIT License.<br>
    <a href="https://docs.meteor.com/api/connections.html" class="_attribution-link">https://docs.meteor.com/api/connections.html</a>
  </p>
</div>
