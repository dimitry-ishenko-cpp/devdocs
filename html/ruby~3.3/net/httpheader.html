<h1 id="module-Net::HTTPHeader" class="module"> module Net::HTTPHeader </h1> <section class="description"> <p>The HTTPHeader module provides access to HTTP headers.</p> <p>The module is included in:</p> <ul>
<li> <p><a href="httpgenericrequest"><code>Net::HTTPGenericRequest</code></a> (and therefore <a href="httprequest"><code>Net::HTTPRequest</code></a>).</p> </li>
<li> <p><a href="httpresponse"><code>Net::HTTPResponse</code></a>.</p> </li>
</ul> <p>The headers are a hash-like collection of key/value pairs called <em>fields</em>.</p> <h2 id="module-Net::HTTPHeader-label-Request+and+Response+Fields">Request and Response Fields</h2> <p>Headers may be included in:</p> <ul>
<li> <p>A <a href="httprequest"><code>Net::HTTPRequest</code></a> object: the objectâ€™s headers will be sent with the request. Any fields may be defined in the request; see <a href="httpheader#module-Net::HTTPHeader-label-Setters">Setters</a>.</p> </li>
<li> <p>A <a href="httpresponse"><code>Net::HTTPResponse</code></a> object: the objects headers are usually those returned from the host. Fields may be retrieved from the object; see <a href="httpheader#module-Net::HTTPHeader-label-Getters">Getters</a> and <a href="httpheader#module-Net::HTTPHeader-label-Iterators">Iterators</a>.</p> </li>
</ul> <p>Exactly which fields should be sent or expected depends on the host; see:</p> <ul>
<li> <p><a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Request_fields">Request fields</a>.</p> </li>
<li> <p><a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#Response_fields">Response fields</a>.</p> </li>
</ul> <h2 id="module-Net::HTTPHeader-label-About+the+Examples">About the Examples</h2> <p>Examples here assume that <code>net/http</code> has been required (which also requires <code>uri</code>):</p> <pre class="ruby" data-language="ruby">require 'net/http'
</pre> <p>Many code examples here use these example websites:</p> <ul>
<li> <p><a href="https://jsonplaceholder.typicode.com">jsonplaceholder.typicode.com</a>.</p> </li>
<li> <p><a href="http://example.com">example.com</a>.</p> </li>
</ul> <p>Some examples also assume these variables:</p> <pre class="ruby" data-language="ruby">uri = URI('https://jsonplaceholder.typicode.com/')
uri.freeze # Examples may not modify.
hostname = uri.hostname # =&gt; "jsonplaceholder.typicode.com"
path = uri.path         # =&gt; "/"
port = uri.port         # =&gt; 443
</pre> <p>So that example requests may be written as:</p> <pre class="ruby" data-language="ruby">Net::HTTP.get(uri)
Net::HTTP.get(hostname, '/index.html')
Net::HTTP.start(hostname) do |http|
  http.get('/todos/1')
  http.get('/todos/2')
end
</pre> <p>An example that needs a modified <a href="../uri.html"><code>URI</code></a> first duplicates <code>uri</code>, then modifies the duplicate:</p> <pre class="ruby" data-language="ruby">_uri = uri.dup
_uri.path = '/todos/1'
</pre> <h2 id="module-Net::HTTPHeader-label-Fields">Fields</h2> <p>A header field is a key/value pair.</p> <h3 id="module-Net::HTTPHeader-label-Field+Keys">Field Keys</h3> <p>A field key may be:</p> <ul>
<li> <p>A string: Key <code>'Accept'</code> is treated as if it were <code>'Accept'.downcase</code>; i.e., <code>'accept'</code>.</p> </li>
<li> <p>A symbol: Key <code>:Accept</code> is treated as if it were <code>:Accept.to_s.downcase</code>; i.e., <code>'accept'</code>.</p> </li>
</ul> <p>Examples:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req[:accept]  # =&gt; "*/*"
req['Accept'] # =&gt; "*/*"
req['ACCEPT'] # =&gt; "*/*"

req['accept'] = 'text/html'
req[:accept] = 'text/html'
req['ACCEPT'] = 'text/html'
</pre> <h3 id="module-Net::HTTPHeader-label-Field+Values">Field Values</h3> <p>A field value may be returned as an array of strings or as a string:</p> <ul>
<li> <p>These methods return field values as arrays:</p> <ul>
<li> <p><a href="httpheader#method-i-get_fields"><code>get_fields</code></a>: Returns the array value for the given key, or <code>nil</code> if it does not exist.</p> </li>
<li> <p><a href="httpheader#method-i-to_hash"><code>to_hash</code></a>: Returns a hash of all header fields: each key is a field name; its value is the array value for the field.</p> </li>
</ul> </li>
<li> <p>These methods return field values as string; the string value for a field is equivalent to <code>self[key.downcase.to_s].join(', '))</code>:</p> <ul>
<li> <p><a href="httpheader#method-i-5B-5D"><code>[]</code></a>: Returns the string value for the given key, or <code>nil</code> if it does not exist.</p> </li>
<li> <p><a href="httpheader#method-i-fetch"><code>fetch</code></a>: Like <a href="httpheader#method-i-5B-5D"><code>[]</code></a>, but accepts a default value to be returned if the key does not exist.</p> </li>
</ul> </li>
</ul> <p>The field value may be set:</p> <ul>
<li> <p><a href="httpheader#method-i-5B-5D-3D"><code>[]=</code></a>: Sets the value for the given key; the given value may be a string, a symbol, an array, or a hash.</p> </li>
<li> <p><a href="httpheader#method-i-add_field"><code>add_field</code></a>: Adds a given value to a value for the given key (not overwriting the existing value).</p> </li>
<li> <p><a href="httpheader#method-i-delete"><code>delete</code></a>: Deletes the field for the given key.</p> </li>
</ul> <p>Example field values:</p> <ul>
<li> <p>String:</p> <pre class="ruby" data-language="ruby">req['Accept'] = 'text/html' # =&gt; "text/html"
req['Accept']               # =&gt; "text/html"
req.get_fields('Accept')    # =&gt; ["text/html"]
</pre> </li>
<li> <p>Symbol:</p> <pre class="ruby" data-language="ruby">req['Accept'] = :text    # =&gt; :text
req['Accept']            # =&gt; "text"
req.get_fields('Accept') # =&gt; ["text"]
</pre> </li>
<li> <p>Simple array:</p> <pre class="ruby" data-language="ruby">req[:foo] = %w[bar baz bat]
req[:foo]            # =&gt; "bar, baz, bat"
req.get_fields(:foo) # =&gt; ["bar", "baz", "bat"]
</pre> </li>
<li> <p>Simple hash:</p> <pre class="ruby" data-language="ruby">req[:foo] = {bar: 0, baz: 1, bat: 2}
req[:foo]            # =&gt; "bar, 0, baz, 1, bat, 2"
req.get_fields(:foo) # =&gt; ["bar", "0", "baz", "1", "bat", "2"]
</pre> </li>
<li> <p>Nested:</p> <pre class="ruby" data-language="ruby">req[:foo] = [%w[bar baz], {bat: 0, bam: 1}]
req[:foo]            # =&gt; "bar, baz, bat, 0, bam, 1"
req.get_fields(:foo) # =&gt; ["bar", "baz", "bat", "0", "bam", "1"]

req[:foo] = {bar: %w[baz bat], bam: {bah: 0, bad: 1}}
req[:foo]            # =&gt; "bar, baz, bat, bam, bah, 0, bad, 1"
req.get_fields(:foo) # =&gt; ["bar", "baz", "bat", "bam", "bah", "0", "bad", "1"]
</pre> </li>
</ul> <h2 id="module-Net::HTTPHeader-label-Convenience+Methods">Convenience Methods</h2> <p>Various convenience methods retrieve values, set values, query values, set form values, or iterate over fields.</p> <h3 id="module-Net::HTTPHeader-label-Setters">Setters</h3> <p>Method <a href="httpheader#method-i-5B-5D-3D"><code>[]=</code></a> can set any field, but does little to validate the new value; some of the other setter methods provide some validation:</p> <ul>
<li> <p><a href="httpheader#method-i-5B-5D-3D"><code>[]=</code></a>: Sets the string or array value for the given key.</p> </li>
<li> <p><a href="httpheader#method-i-add_field"><code>add_field</code></a>: Creates or adds to the array value for the given key.</p> </li>
<li> <p><a href="httpheader#method-i-basic_auth"><code>basic_auth</code></a>: Sets the string authorization header for <code>'Authorization'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-content_length-3D"><code>content_length=</code></a>: Sets the integer length for field <code>'Content-Length</code>.</p> </li>
<li> <p><a href="httpheader#method-i-content_type-3D"><code>content_type=</code></a>: Sets the string value for field <code>'Content-Type'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-proxy_basic_auth"><code>proxy_basic_auth</code></a>: Sets the string authorization header for <code>'Proxy-Authorization'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-set_range"><code>set_range</code></a>: Sets the value for field <code>'Range'</code>.</p> </li>
</ul> <h3 id="module-Net::HTTPHeader-label-Form+Setters">Form Setters</h3> <ul>
<li> <p><a href="httpheader#method-i-set_form"><code>set_form</code></a>: Sets an HTML form data set.</p> </li>
<li> <p><a href="httpheader#method-i-set_form_data"><code>set_form_data</code></a>: Sets header fields and a body from HTML form data.</p> </li>
</ul> <h3 id="module-Net::HTTPHeader-label-Getters">Getters</h3> <p>Method <a href="httpheader#method-i-5B-5D"><code>[]</code></a> can retrieve the value of any field that exists, but always as a string; some of the other getter methods return something different from the simple string value:</p> <ul>
<li> <p><a href="httpheader#method-i-5B-5D"><code>[]</code></a>: Returns the string field value for the given key.</p> </li>
<li> <p><a href="httpheader#method-i-content_length"><code>content_length</code></a>: Returns the integer value of field <code>'Content-Length'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-content_range"><code>content_range</code></a>: Returns the <a href="../range.html"><code>Range</code></a> value of field <code>'Content-Range'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-content_type"><code>content_type</code></a>: Returns the string value of field <code>'Content-Type'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-fetch"><code>fetch</code></a>: Returns the string field value for the given key.</p> </li>
<li> <p><a href="httpheader#method-i-get_fields"><code>get_fields</code></a>: Returns the array field value for the given <code>key</code>.</p> </li>
<li> <p><a href="httpheader#method-i-main_type"><code>main_type</code></a>: Returns first part of the string value of field <code>'Content-Type'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-sub_type"><code>sub_type</code></a>: Returns second part of the string value of field <code>'Content-Type'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-range"><code>range</code></a>: Returns an array of <a href="../range.html"><code>Range</code></a> objects of field <code>'Range'</code>, or <code>nil</code>.</p> </li>
<li> <p><a href="httpheader#method-i-range_length"><code>range_length</code></a>: Returns the integer length of the range given in field <code>'Content-Range'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-type_params"><code>type_params</code></a>: Returns the string parameters for <code>'Content-Type'</code>.</p> </li>
</ul> <h3 id="module-Net::HTTPHeader-label-Queries">Queries</h3> <ul>
<li> <p><a href="httpheader#method-i-chunked-3F"><code>chunked?</code></a>: Returns whether field <code>'Transfer-Encoding'</code> is set to <code>'chunked'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-connection_close-3F"><code>connection_close?</code></a>: Returns whether field <code>'Connection'</code> is set to <code>'close'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-connection_keep_alive-3F"><code>connection_keep_alive?</code></a>: Returns whether field <code>'Connection'</code> is set to <code>'keep-alive'</code>.</p> </li>
<li> <p><a href="httpheader#method-i-key-3F"><code>key?</code></a>: Returns whether a given key exists.</p> </li>
</ul> <h3 id="module-Net::HTTPHeader-label-Iterators">Iterators</h3> <ul>
<li> <p><a href="httpheader#method-i-each_capitalized"><code>each_capitalized</code></a>: Passes each field capitalized-name/value pair to the block.</p> </li>
<li> <p><a href="httpheader#method-i-each_capitalized_name"><code>each_capitalized_name</code></a>: Passes each capitalized field name to the block.</p> </li>
<li> <p><a href="httpheader#method-i-each_header"><code>each_header</code></a>: Passes each field name/value pair to the block.</p> </li>
<li> <p><a href="httpheader#method-i-each_name"><code>each_name</code></a>: Passes each field name to the block.</p> </li>
<li> <p><a href="httpheader#method-i-each_value"><code>each_value</code></a>: Passes each string field value to the block.</p> </li>
</ul> </section> <section id="5Buntitled-5D" class="documentation-section"> <section class="constants-list"> <header> <h3>Constants</h3> </header> <dl> <dt id="MAX_FIELD_LENGTH">MAX_FIELD_LENGTH </dt>

<dt id="MAX_KEY_LENGTH">MAX_KEY_LENGTH </dt>

</dl> </section> <section id="public-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Public Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-5B-5D"> <span class="method-name">[]</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="5B-5D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 224
def [](key)
  a = @header[key.downcase.to_s] or return nil
  a.join(', ')
end</pre> </div> <p>Returns the string field value for the case-insensitive field <code>key</code>, or <code>nil</code> if there is no such key; see <a href="httpheader#module-Net::HTTPHeader-label-Fields">Fields</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['Connection'] # =&gt; "keep-alive"
res['Nosuch']     # =&gt; nil
</pre> <p>Note that some field values may be retrieved via convenience methods; see <a href="httpheader#module-Net::HTTPHeader-label-Getters">Getters</a>.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-5B-5D-3D"> <span class="method-name">[]=</span><span class="method-args">(key, val)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="5B-5D-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 240
def []=(key, val)
  unless val
    @header.delete key.downcase.to_s
    return val
  end
  set_field(key, val)
end</pre> </div> <p>Sets the value for the case-insensitive <code>key</code> to <code>val</code>, overwriting the previous value if the field exists; see <a href="httpheader#module-Net::HTTPHeader-label-Fields">Fields</a>:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req['Accept'] # =&gt; "*/*"
req['Accept'] = 'text/html'
req['Accept'] # =&gt; "text/html"
</pre> <p>Note that some field values may be set via convenience methods; see <a href="httpheader#module-Net::HTTPHeader-label-Setters">Setters</a>.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-add_field"> <span class="method-name">add_field</span><span class="method-args">(key, val)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="add_field-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 261
def add_field(key, val)
  stringified_downcased_key = key.downcase.to_s
  if @header.key?(stringified_downcased_key)
    append_field_value(@header[stringified_downcased_key], val)
  else
    set_field(key, val)
  end
end</pre> </div> <p>Adds value <code>val</code> to the value array for field <code>key</code> if the field exists; creates the field with the given <code>key</code> and <code>val</code> if it does not exist. see <a href="httpheader#module-Net::HTTPHeader-label-Fields">Fields</a>:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req.add_field('Foo', 'bar')
req['Foo']            # =&gt; "bar"
req.add_field('Foo', 'baz')
req['Foo']            # =&gt; "bar, baz"
req.add_field('Foo', %w[baz bam])
req['Foo']            # =&gt; "bar, baz, baz, bam"
req.get_fields('Foo') # =&gt; ["bar", "baz", "baz", "bam"]
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-basic_auth"> <span class="method-name">basic_auth</span><span class="method-args">(account, password)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="basic_auth-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 945
def basic_auth(account, password)
  @header['authorization'] = [basic_encode(account, password)]
end</pre> </div> <p>Sets header <code>'Authorization'</code> using the given <code>account</code> and <code>password</code> strings:</p> <pre class="ruby" data-language="ruby">req.basic_auth('my_account', 'my_password')
req['Authorization']
# =&gt; "Basic bXlfYWNjb3VudDpteV9wYXNzd29yZA=="
</pre>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-canonical_each"> <span class="method-name">canonical_each</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-each_capitalized">each_capitalized</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-chunked-3F"> <span class="method-name">chunked?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="chunked-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 654
def chunked?
  return false unless @header['transfer-encoding']
  field = self['Transfer-Encoding']
  (/(?:\A|[^\-\w])chunked(?![\-\w])/i =~ field) ? true : false
end</pre> </div> <p>Returns <code>true</code> if field <code>'Transfer-Encoding'</code> exists and has value <code>'chunked'</code>, <code>false</code> otherwise; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#transfer-encoding-response-header">Transfer-Encoding response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['Transfer-Encoding'] # =&gt; "chunked"
res.chunked?             # =&gt; true
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-connection_close-3F"> <span class="method-name">connection_close?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="connection_close-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 966
def connection_close?
  token = /(?:\A|,)\s*close\s*(?:\z|,)/i
  @header['connection']&amp;.grep(token) {return true}
  @header['proxy-connection']&amp;.grep(token) {return true}
  false
end</pre> </div> <p>Returns whether the <a href="http"><code>HTTP</code></a> session is to be closed.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-connection_keep_alive-3F"> <span class="method-name">connection_keep_alive?</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="connection_keep_alive-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 974
def connection_keep_alive?
  token = /(?:\A|,)\s*keep-alive\s*(?:\z|,)/i
  @header['connection']&amp;.grep(token) {return true}
  @header['proxy-connection']&amp;.grep(token) {return true}
  false
end</pre> </div> <p>Returns whether the <a href="http"><code>HTTP</code></a> session is to be kept alive.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-content_length"> <span class="method-name">content_length</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="content_length-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 616
def content_length
  return nil unless key?('Content-Length')
  len = self['Content-Length'].slice(/\d+/) or
      raise Net::HTTPHeaderSyntaxError, 'wrong Content-Length format'
  len.to_i
end</pre> </div> <p>Returns the value of field <code>'Content-Length'</code> as an integer, or <code>nil</code> if there is no such field; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-length-request-header">Content-Length request header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/nosuch/1')
res.content_length # =&gt; 2
res = Net::HTTP.get_response(hostname, '/todos/1')
res.content_length # =&gt; nil
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-content_length-3D"> <span class="method-name">content_length=</span><span class="method-args">(len)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="content_length-3D-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 637
def content_length=(len)
  unless len
    @header.delete 'content-length'
    return nil
  end
  @header['content-length'] = [len.to_i.to_s]
end</pre> </div> <p>Sets the value of field <code>'Content-Length'</code> to the given numeric; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-length-response-header">Content-Length response header</a>:</p> <pre class="ruby" data-language="ruby">_uri = uri.dup
hostname = _uri.hostname           # =&gt; "jsonplaceholder.typicode.com"
_uri.path = '/posts'               # =&gt; "/posts"
req = Net::HTTP::Post.new(_uri)    # =&gt; #&lt;Net::HTTP::Post POST&gt;
req.body = '{"title": "foo","body": "bar","userId": 1}'
req.content_length = req.body.size # =&gt; 42
req.content_type = 'application/json'
res = Net::HTTP.start(hostname) do |http|
  http.request(req)
end # =&gt; #&lt;Net::HTTPCreated 201 Created readbody=true&gt;
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-content_range"> <span class="method-name">content_range</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="content_range-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 670
def content_range
  return nil unless @header['content-range']
  m = %r&lt;\A\s*(\w+)\s+(\d+)-(\d+)/(\d+|\*)&gt;.match(self['Content-Range']) or
      raise Net::HTTPHeaderSyntaxError, 'wrong Content-Range format'
  return unless m[1] == 'bytes'
  m[2].to_i .. m[3].to_i
end</pre> </div> <p>Returns a <a href="../range.html"><code>Range</code></a> object representing the value of field <code>'Content-Range'</code>, or <code>nil</code> if no such field exists; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-range-response-header">Content-Range response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['Content-Range'] # =&gt; nil
res['Content-Range'] = 'bytes 0-499/1000'
res['Content-Range'] # =&gt; "bytes 0-499/1000"
res.content_range    # =&gt; 0..499
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-content_type"> <span class="method-name">content_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="content_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 701
def content_type
  main = main_type()
  return nil unless main

  sub = sub_type()
  if sub
    "#{main}/#{sub}"
  else
    main
  end
end</pre> </div> <p>Returns the <a href="https://en.wikipedia.org/wiki/Media_type">media type</a> from the value of field <code>'Content-Type'</code>, or <code>nil</code> if no such field exists; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-type-response-header">Content-Type response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['content-type'] # =&gt; "application/json; charset=utf-8"
res.content_type    # =&gt; "application/json"
</pre>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-content_type-3D"> <span class="method-name">content_type=</span><span class="method-args">(type, params = {})</span> </div> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-set_content_type">set_content_type</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-delete"> <span class="method-name">delete</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="delete-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 453
def delete(key)
  @header.delete(key.downcase.to_s)
end</pre> </div> <p>Removes the header for the given case-insensitive <code>key</code> (see <a href="httpheader#module-Net::HTTPHeader-label-Fields">Fields</a>); returns the deleted value, or <code>nil</code> if no such field exists:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req.delete('Accept') # =&gt; ["*/*"]
req.delete('Nosuch') # =&gt; nil
</pre>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-each"> <span class="method-name">each</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-each_header">each_header</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-each_capitalized"> <span class="method-name">each_capitalized</span><span class="method-args">() { |capitalize(k), join(', ')| ... }</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="each_capitalized-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 484
def each_capitalized
  block_given? or return enum_for(__method__) { @header.size }
  @header.each do |k,v|
    yield capitalize(k), v.join(', ')
  end
end</pre> </div> <p>Like <a href="httpheader#method-i-each_header"><code>each_header</code></a>, but the keys are returned in capitalized form.</p> <p><a href="httpheader#method-i-canonical_each"><code>Net::HTTPHeader#canonical_each</code></a> is an alias for <a href="httpheader#method-i-each_capitalized"><code>Net::HTTPHeader#each_capitalized</code></a>.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-canonical_each">canonical_each</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-each_capitalized_name"> <span class="method-name">each_capitalized_name</span><span class="method-args">() { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="each_capitalized_name-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 417
def each_capitalized_name  #:yield: +key+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each_key do |k|
    yield capitalize(k)
  end
end</pre> </div> <p>Calls the block with each capitalized field name:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res.each_capitalized_name do |key|
  p key if key.start_with?('C')
end
</pre> <p>Output:</p> <pre class="ruby" data-language="ruby">"Content-Type"
"Connection"
"Cache-Control"
"Cf-Cache-Status"
"Cf-Ray"
</pre> <p>The capitalization is system-dependent; see <a href="../case_mapping_rdoc.html">Case Mapping</a>.</p> <p>Returns an enumerator if no block is given.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-each_header"> <span class="method-name">each_header</span><span class="method-args">() { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="each_header-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 364
def each_header   #:yield: +key+, +value+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each do |k,va|
    yield k, va.join(', ')
  end
end</pre> </div> <p>Calls the block with each key/value pair:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res.each_header do |key, value|
  p [key, value] if key.start_with?('c')
end
</pre> <p>Output:</p> <pre class="ruby" data-language="ruby">["content-type", "application/json; charset=utf-8"]
["connection", "keep-alive"]
["cache-control", "max-age=43200"]
["cf-cache-status", "HIT"]
["cf-ray", "771d17e9bc542cf5-ORD"]
</pre> <p>Returns an enumerator if no block is given.</p> <p><a href="httpheader#method-i-each"><code>Net::HTTPHeader#each</code></a> is an alias for <a href="httpheader#method-i-each_header"><code>Net::HTTPHeader#each_header</code></a>.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-each">each</a> </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-each_key"> <span class="method-name">each_key</span><span class="method-args">()</span> </div> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-each_name">each_name</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-each_name"> <span class="method-name">each_name</span><span class="method-args">() { |key| ... }</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="each_name-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 391
def each_name(&amp;block)   #:yield: +key+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each_key(&amp;block)
end</pre> </div> <p>Calls the block with each field key:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res.each_key do |key|
  p key if key.start_with?('c')
end
</pre> <p>Output:</p> <pre class="ruby" data-language="ruby">"content-type"
"connection"
"cache-control"
"cf-cache-status"
"cf-ray"
</pre> <p>Returns an enumerator if no block is given.</p> <p><a href="httpheader#method-i-each_name"><code>Net::HTTPHeader#each_name</code></a> is an alias for <a href="httpheader#method-i-each_key"><code>Net::HTTPHeader#each_key</code></a>.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-each_key">each_key</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-each_value"> <span class="method-name">each_value</span><span class="method-args">() { |value| ... }</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="each_value-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 438
def each_value   #:yield: +value+
  block_given? or return enum_for(__method__) { @header.size }
  @header.each_value do |va|
    yield va.join(', ')
  end
end</pre> </div> <p>Calls the block with each string field value:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res.each_value do |value|
  p value if value.start_with?('c')
end
</pre> <p>Output:</p> <pre class="ruby" data-language="ruby">"chunked"
"cf-q-config;dur=6.0000002122251e-06"
"cloudflare"
</pre> <p>Returns an enumerator if no block is given.</p>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-fetch"> <span class="method-callseq"> fetch(key, default_val = nil) {|key| ... } â†’ object </span> <a class="method-click-advice">Show source</a> </div> <div class="method-heading"> <span class="method-callseq"> fetch(key, default_val = nil) â†’ value or default_val </span> </div> </div> <div class="method-description">
<div class="method-source-code" id="fetch-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 341
def fetch(key, *args, &amp;block)   #:yield: +key+
  a = @header.fetch(key.downcase.to_s, *args, &amp;block)
  a.kind_of?(Array) ? a.join(', ') : a
end</pre> </div> <p>With a block, returns the string value for <code>key</code> if it exists; otherwise returns the value of the block; ignores the <code>default_val</code>; see <a href="httpheader#module-Net::HTTPHeader-label-Fields">Fields</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')

# Field exists; block not called.
res.fetch('Connection') do |value|
  fail 'Cannot happen'
end # =&gt; "keep-alive"

# Field does not exist; block called.
res.fetch('Nosuch') do |value|
  value.downcase
end # =&gt; "nosuch"
</pre> <p>With no block, returns the string value for <code>key</code> if it exists; otherwise, returns <code>default_val</code> if it was given; otherwise raises an exception:</p> <pre class="ruby" data-language="ruby">res.fetch('Connection', 'Foo') # =&gt; "keep-alive"
res.fetch('Nosuch', 'Foo')     # =&gt; "Foo"
res.fetch('Nosuch')            # Raises KeyError.
</pre>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-form_data-3D"> <span class="method-name">form_data=</span><span class="method-args">(params, sep = '&amp;')</span> </div> </div>  <div class="aliases"> Alias for: <a href="httpheader#method-i-set_form_data">set_form_data</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-get_fields"> <span class="method-name">get_fields</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="get_fields-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 306
def get_fields(key)
  stringified_downcased_key = key.downcase.to_s
  return nil unless @header[stringified_downcased_key]
  @header[stringified_downcased_key].dup
end</pre> </div> <p>Returns the array field value for the given <code>key</code>, or <code>nil</code> if there is no such field; see <a href="httpheader#module-Net::HTTPHeader-label-Fields">Fields</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res.get_fields('Connection') # =&gt; ["keep-alive"]
res.get_fields('Nosuch')     # =&gt; nil
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-key-3F"> <span class="method-name">key?</span><span class="method-args">(key)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="key-3F-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 463
def key?(key)
  @header.key?(key.downcase.to_s)
end</pre> </div> <p>Returns <code>true</code> if the field for the case-insensitive <code>key</code> exists, <code>false</code> otherwise:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req.key?('Accept') # =&gt; true
req.key?('Nosuch') # =&gt; false
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-main_type"> <span class="method-name">main_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="main_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 723
def main_type
  return nil unless @header['content-type']
  self['Content-Type'].split(';').first.to_s.split('/')[0].to_s.strip
end</pre> </div> <p>Returns the leading (â€˜typeâ€™) part of the <a href="https://en.wikipedia.org/wiki/Media_type">media type</a> from the value of field <code>'Content-Type'</code>, or <code>nil</code> if no such field exists; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-type-response-header">Content-Type response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['content-type'] # =&gt; "application/json; charset=utf-8"
res.main_type       # =&gt; "application"
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-proxy_basic_auth"> <span class="method-name">proxy_basic_auth</span><span class="method-args">(account, password)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="proxy_basic_auth-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 956
def proxy_basic_auth(account, password)
  @header['proxy-authorization'] = [basic_encode(account, password)]
end</pre> </div> <p>Sets header <code>'Proxy-Authorization'</code> using the given <code>account</code> and <code>password</code> strings:</p> <pre class="ruby" data-language="ruby">req.proxy_basic_auth('my_account', 'my_password')
req['Proxy-Authorization']
# =&gt; "Basic bXlfYWNjb3VudDpteV9wYXNzd29yZA=="
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-range"> <span class="method-name">range</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="range-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 509
def range
  return nil unless @header['range']

  value = self['Range']
  # byte-range-set = *( "," OWS ) ( byte-range-spec / suffix-byte-range-spec )
  #   *( OWS "," [ OWS ( byte-range-spec / suffix-byte-range-spec ) ] )
  # corrected collected ABNF
  # http://tools.ietf.org/html/draft-ietf-httpbis-p5-range-19#section-5.4.1
  # http://tools.ietf.org/html/draft-ietf-httpbis-p5-range-19#appendix-C
  # http://tools.ietf.org/html/draft-ietf-httpbis-p1-messaging-19#section-3.2.5
  unless /\Abytes=((?:,[ \t]*)*(?:\d+-\d*|-\d+)(?:[ \t]*,(?:[ \t]*\d+-\d*|-\d+)?)*)\z/ =~ value
    raise Net::HTTPHeaderSyntaxError, "invalid syntax for byte-ranges-specifier: '#{value}'"
  end

  byte_range_set = $1
  result = byte_range_set.split(/,/).map {|spec|
    m = /(\d+)?\s*-\s*(\d+)?/i.match(spec) or
            raise Net::HTTPHeaderSyntaxError, "invalid byte-range-spec: '#{spec}'"
    d1 = m[1].to_i
    d2 = m[2].to_i
    if m[1] and m[2]
      if d1 &gt; d2
        raise Net::HTTPHeaderSyntaxError, "last-byte-pos MUST greater than or equal to first-byte-pos but '#{spec}'"
      end
      d1..d2
    elsif m[1]
      d1..-1
    elsif m[2]
      -d2..-1
    else
      raise Net::HTTPHeaderSyntaxError, 'range is not specified'
    end
  }
  # if result.empty?
  # byte-range-set must include at least one byte-range-spec or suffix-byte-range-spec
  # but above regexp already denies it.
  if result.size == 1 &amp;&amp; result[0].begin == 0 &amp;&amp; result[0].end == -1
    raise Net::HTTPHeaderSyntaxError, 'only one suffix-byte-range-spec with zero suffix-length'
  end
  result
end</pre> </div> <p>Returns an array of <a href="../range.html"><code>Range</code></a> objects that represent the value of field <code>'Range'</code>, or <code>nil</code> if there is no such field; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#range-request-header">Range request header</a>:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req['Range'] = 'bytes=0-99,200-299,400-499'
req.range # =&gt; [0..99, 200..299, 400..499]
req.delete('Range')
req.range # # =&gt; nil
</pre>  </div> </div> <div class="method-detail method-alias"> <div class="method-header"> <div class="method-heading" id="method-i-range-3D"> <span class="method-name">range=</span> </div> </div> <div class="aliases"> Alias for: <a href="httpheader#method-i-set_range">set_range</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-range_length"> <span class="method-name">range_length</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="range_length-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 687
def range_length
  r = content_range() or return nil
  r.end - r.begin + 1
end</pre> </div> <p>Returns the integer representing length of the value of field <code>'Content-Range'</code>, or <code>nil</code> if no such field exists; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-range-response-header">Content-Range response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['Content-Range'] # =&gt; nil
res['Content-Range'] = 'bytes 0-499/1000'
res.range_length     # =&gt; 500
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-set_content_type"> <span class="method-name">set_content_type</span><span class="method-args">(type, params = {})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="set_content_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 772
def set_content_type(type, params = {})
  @header['content-type'] = [type + params.map{|k,v|"; #{k}=#{v}"}.join('')]
end</pre> </div> <p>Sets the value of field <code>'Content-Type'</code>; returns the new value; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-type-request-header">Content-Type request header</a>:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req.set_content_type('application/json') # =&gt; ["application/json"]
</pre> <p><a href="httpheader#method-i-content_type-3D"><code>Net::HTTPHeader#content_type=</code></a> is an alias for <a href="httpheader#method-i-set_content_type"><code>Net::HTTPHeader#set_content_type</code></a>.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-content_type-3D">content_type=</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-set_form"> <span class="method-name">set_form</span><span class="method-args">(params, enctype='application/x-www-form-urlencoded', formopt={})</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="set_form-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 924
def set_form(params, enctype='application/x-www-form-urlencoded', formopt={})
  @body_data = params
  @body = nil
  @body_stream = nil
  @form_option = formopt
  case enctype
  when /\Aapplication\/x-www-form-urlencoded\z/i,
    /\Amultipart\/form-data\z/i
    self.content_type = enctype
  else
    raise ArgumentError, "invalid enctype: #{enctype}"
  end
end</pre> </div> <p>Stores form data to be used in a <code>POST</code> or <code>PUT</code> request.</p> <p>The form data given in <code>params</code> consists of zero or more fields; each field is:</p> <ul>
<li> <p>A scalar value.</p> </li>
<li> <p>A name/value pair.</p> </li>
<li> <p>An <a href="../io.html"><code>IO</code></a> stream opened for reading.</p> </li>
</ul> <p>Argument <code>params</code> should be an <a href="../enumerable.html#module-Enumerable-label-Enumerable+in+Ruby+Classes">Enumerable</a> (method <code>params.map</code> will be called), and is often an array or hash.</p> <p>First, we set up a request:</p> <pre class="ruby" data-language="ruby">_uri = uri.dup
_uri.path ='/posts'
req = Net::HTTP::Post.new(_uri)
</pre> <p><strong>Argument <code>params</code> As an Array</strong></p> <p>When <code>params</code> is an array, each of its elements is a subarray that defines a field; the subarray may contain:</p> <ul>
<li> <p>One string:</p> <pre class="ruby" data-language="ruby">req.set_form([['foo'], ['bar'], ['baz']])
</pre> </li>
<li> <p>Two strings:</p> <pre class="ruby" data-language="ruby">req.set_form([%w[foo 0], %w[bar 1], %w[baz 2]])
</pre> </li>
<li> <p>When argument <code>enctype</code> (see below) is given as <code>'multipart/form-data'</code>:</p> <ul>
<li> <p>A string name and an <a href="../io.html"><code>IO</code></a> stream opened for reading:</p> <pre class="ruby" data-language="ruby">require 'stringio'
req.set_form([['file', StringIO.new('Ruby is cool.')]])
</pre> </li>
<li> <p>A string name, an <a href="../io.html"><code>IO</code></a> stream opened for reading, and an options hash, which may contain these entries:</p> <ul>
<li> <p><code>:filename</code>: The name of the file to use.</p> </li>
<li> <p><code>:content_type</code>: The content type of the uploaded file.</p> </li>
</ul> <p>Example:</p> <pre>req.set_form([['file', file, {filename: "other-filename.foo"}]]</pre> </li>
</ul> </li>
</ul> <p>The various forms may be mixed:</p> <pre class="ruby" data-language="ruby">req.set_form(['foo', %w[bar 1], ['file', file]])
</pre> <p><strong>Argument <code>params</code> As a Hash</strong></p> <p>When <code>params</code> is a hash, each of its entries is a name/value pair that defines a field:</p> <ul>
<li> <p>The name is a string.</p> </li>
<li> <p>The value may be:</p> <ul>
<li> <p><code>nil</code>.</p> </li>
<li> <p>Another string.</p> </li>
<li> <p>An <a href="../io.html"><code>IO</code></a> stream opened for reading (only when argument <code>enctype</code> â€“ see below â€“ is given as <code>'multipart/form-data'</code>).</p> </li>
</ul> </li>
</ul> <p>Examples:</p> <pre class="ruby" data-language="ruby"># Nil-valued fields.
req.set_form({'foo' =&gt; nil, 'bar' =&gt; nil, 'baz' =&gt; nil})

# String-valued fields.
req.set_form({'foo' =&gt; 0, 'bar' =&gt; 1, 'baz' =&gt; 2})

# IO-valued field.
require 'stringio'
req.set_form({'file' =&gt; StringIO.new('Ruby is cool.')})

# Mixture of fields.
req.set_form({'foo' =&gt; nil, 'bar' =&gt; 1, 'file' =&gt; file})
</pre> <p>Optional argument <code>enctype</code> specifies the value to be given to field <code>'Content-Type'</code>, and must be one of:</p> <ul>
<li> <p><code>'application/x-www-form-urlencoded'</code> (the default).</p> </li>
<li> <p><code>'multipart/form-data'</code>; see <a href="https://www.rfc-editor.org/rfc/rfc7578">RFC 7578</a>.</p> </li>
</ul> <p>Optional argument <code>formopt</code> is a hash of options (applicable only when argument <code>enctype</code> is <code>'multipart/form-data'</code>) that may include the following entries:</p> <ul>
<li> <p><code>:boundary</code>: The value is the boundary string for the multipart message. If not given, the boundary is a random string. See <a href="https://www.rfc-editor.org/rfc/rfc7578#section-4.1">Boundary</a>.</p> </li>
<li> <p><code>:charset</code>: Value is the character set for the form submission. Field names and values of non-file fields should be encoded with this charset.</p> </li>
</ul>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-set_form_data"> <span class="method-name">set_form_data</span><span class="method-args">(params, sep = '&amp;')</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="set_form_data-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 812
def set_form_data(params, sep = '&amp;')
  query = URI.encode_www_form(params)
  query.gsub!(/&amp;/, sep) if sep != '&amp;'
  self.body = query
  self.content_type = 'application/x-www-form-urlencoded'
end</pre> </div> <p>Sets the request body to a URL-encoded string derived from argument <code>params</code>, and sets request header field <code>'Content-Type'</code> to <code>'application/x-www-form-urlencoded'</code>.</p> <p>The resulting request is suitable for <a href="http"><code>HTTP</code></a> request <code>POST</code> or <code>PUT</code>.</p> <p>Argument <code>params</code> must be suitable for use as argument <code>enum</code> to <a href="../uri.html#method-c-encode_www_form"><code>URI.encode_www_form</code></a>.</p> <p>With only argument <code>params</code> given, sets the body to a URL-encoded string with the default separator <code>'&amp;'</code>:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Post.new('example.com')

req.set_form_data(q: 'ruby', lang: 'en')
req.body            # =&gt; "q=ruby&amp;lang=en"
req['Content-Type'] # =&gt; "application/x-www-form-urlencoded"

req.set_form_data([['q', 'ruby'], ['lang', 'en']])
req.body            # =&gt; "q=ruby&amp;lang=en"

req.set_form_data(q: ['ruby', 'perl'], lang: 'en')
req.body            # =&gt; "q=ruby&amp;q=perl&amp;lang=en"

req.set_form_data([['q', 'ruby'], ['q', 'perl'], ['lang', 'en']])
req.body            # =&gt; "q=ruby&amp;q=perl&amp;lang=en"
</pre> <p>With string argument <code>sep</code> also given, uses that string as the separator:</p> <pre class="ruby" data-language="ruby">req.set_form_data({q: 'ruby', lang: 'en'}, '|')
req.body # =&gt; "q=ruby|lang=en"
</pre> <p><a href="httpheader#method-i-form_data-3D"><code>Net::HTTPHeader#form_data=</code></a> is an alias for <a href="httpheader#method-i-set_form_data"><code>Net::HTTPHeader#set_form_data</code></a>.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-form_data-3D">form_data=</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-set_range"> <span class="method-callseq"> set_range(length) â†’ length </span> <a class="method-click-advice">Show source</a> </div> <div class="method-heading"> <span class="method-callseq"> set_range(offset, length) â†’ range </span> </div> <div class="method-heading"> <span class="method-callseq"> set_range(begin..length) â†’ range </span> </div> </div> <div class="method-description">
<div class="method-source-code" id="set_range-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 576
def set_range(r, e = nil)
  unless r
    @header.delete 'range'
    return r
  end
  r = (r...r+e) if e
  case r
  when Numeric
    n = r.to_i
    rangestr = (n &gt; 0 ? "0-#{n-1}" : "-#{-n}")
  when Range
    first = r.first
    last = r.end
    last -= 1 if r.exclude_end?
    if last == -1
      rangestr = (first &gt; 0 ? "#{first}-" : "-#{-first}")
    else
      raise Net::HTTPHeaderSyntaxError, 'range.first is negative' if first &lt; 0
      raise Net::HTTPHeaderSyntaxError, 'range.last is negative' if last &lt; 0
      raise Net::HTTPHeaderSyntaxError, 'must be .first &lt; .last' if first &gt; last
      rangestr = "#{first}-#{last}"
    end
  else
    raise TypeError, 'Range/Integer is required'
  end
  @header['range'] = ["bytes=#{rangestr}"]
  r
end</pre> </div> <p>Sets the value for field <code>'Range'</code>; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#range-request-header">Range request header</a>:</p> <p>With argument <code>length</code>:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req.set_range(100)      # =&gt; 100
req['Range']            # =&gt; "bytes=0-99"
</pre> <p>With arguments <code>offset</code> and <code>length</code>:</p> <pre class="ruby" data-language="ruby">req.set_range(100, 100) # =&gt; 100...200
req['Range']            # =&gt; "bytes=100-199"
</pre> <p>With argument <code>range</code>:</p> <pre class="ruby" data-language="ruby">req.set_range(100..199) # =&gt; 100..199
req['Range']            # =&gt; "bytes=100-199"
</pre> <p><a href="httpheader#method-i-range-3D"><code>Net::HTTPHeader#range=</code></a> is an alias for <a href="httpheader#method-i-set_range"><code>Net::HTTPHeader#set_range</code></a>.</p>  </div> <div class="aliases"> Also aliased as: <a href="httpheader#method-i-range-3D">range=</a> </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-sub_type"> <span class="method-name">sub_type</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="sub_type-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 738
def sub_type
  return nil unless @header['content-type']
  _, sub = *self['Content-Type'].split(';').first.to_s.split('/')
  return nil unless sub
  sub.strip
end</pre> </div> <p>Returns the trailing (â€˜subtypeâ€™) part of the <a href="https://en.wikipedia.org/wiki/Media_type">media type</a> from the value of field <code>'Content-Type'</code>, or <code>nil</code> if no such field exists; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-type-response-header">Content-Type response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['content-type'] # =&gt; "application/json; charset=utf-8"
res.sub_type        # =&gt; "json"
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-to_hash"> <span class="method-name">to_hash</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="to_hash-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 477
def to_hash
  @header.dup
end</pre> </div> <p>Returns a hash of the key/value pairs:</p> <pre class="ruby" data-language="ruby">req = Net::HTTP::Get.new(uri)
req.to_hash
# =&gt;
{"accept-encoding"=&gt;["gzip;q=1.0,deflate;q=0.6,identity;q=0.3"],
 "accept"=&gt;["*/*"],
 "user-agent"=&gt;["Ruby"],
 "host"=&gt;["jsonplaceholder.typicode.com"]}
</pre>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-type_params"> <span class="method-name">type_params</span><span class="method-args">()</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="type_params-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 753
def type_params
  result = {}
  list = self['Content-Type'].to_s.split(';')
  list.shift
  list.each do |param|
    k, v = *param.split('=', 2)
    result[k.strip] = v.strip
  end
  result
end</pre> </div> <p>Returns the trailing (â€˜parametersâ€™) part of the value of field <code>'Content-Type'</code>, or <code>nil</code> if no such field exists; see <a href="https://en.wikipedia.org/wiki/List_of_HTTP_header_fields#content-type-response-header">Content-Type response header</a>:</p> <pre class="ruby" data-language="ruby">res = Net::HTTP.get_response(hostname, '/todos/1')
res['content-type'] # =&gt; "application/json; charset=utf-8"
res.type_params     # =&gt; {"charset"=&gt;"utf-8"}
</pre>  </div> </div> </section> <section id="private-instance-5Buntitled-5D-method-details" class="method-section"> <header> <h3>Private Instance Methods</h3> </header> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-append_field_value"> <span class="method-name">append_field_value</span><span class="method-args">(ary, val)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="append_field_value-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 285
        def append_field_value(ary, val)
  case val
  when Enumerable
    val.each{|x| append_field_value(ary, x)}
  else
    val = val.to_s
    if /[\r\n]/n.match?(val.b)
      raise ArgumentError, 'header field value cannot include CR/LF'
    end
    ary.push val
  end
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-basic_encode"> <span class="method-name">basic_encode</span><span class="method-args">(account, password)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="basic_encode-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 960
def basic_encode(account, password)
  'Basic ' + ["#{account}:#{password}"].pack('m0')
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-capitalize"> <span class="method-name">capitalize</span><span class="method-args">(name)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="capitalize-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 493
def capitalize(name)
  name.to_s.split(/-/).map {|s| s.capitalize }.join('-')
end</pre> </div>  </div> </div> <div class="method-detail "> <div class="method-header"> <div class="method-heading" id="method-i-set_field"> <span class="method-name">set_field</span><span class="method-args">(key, val)</span> <a class="method-click-advice">Show source</a> </div> </div> <div class="method-description">
<div class="method-source-code" id="set_field-source"> <pre class="ruby" data-language="ruby"># File lib/net/http/header.rb, line 270
        def set_field(key, val)
  case val
  when Enumerable
    ary = []
    append_field_value(ary, val)
    @header[key.downcase.to_s] = ary
  else
    val = val.to_s # for compatibility use to_s instead of to_str
    if val.b.count("\r\n") &gt; 0
      raise ArgumentError, 'header field value cannot include CR/LF'
    end
    @header[key.downcase.to_s] = [val]
  end
end</pre> </div>  </div> </div> </section> </section><div class="_attribution">
  <p class="_attribution-p">
    Ruby Core &copy; 1993&ndash;2022 Yukihiro Matsumoto<br>Licensed under the Ruby License.<br>Ruby Standard Library &copy; contributors<br>Licensed under their own licenses.<br>
    
  </p>
</div>
