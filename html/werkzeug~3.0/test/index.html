<h1>Testing WSGI Applications</h1> <section id="test-client"> <h2>Test Client</h2> <p>Werkzeug provides a <a class="reference internal" href="#werkzeug.test.Client" title="werkzeug.test.Client"><code>Client</code></a> to simulate requests to a WSGI application without starting a server. The client has methods for making different types of requests, as well as managing cookies across requests.</p> <pre data-language="python">&gt;&gt;&gt; from werkzeug.test import Client
&gt;&gt;&gt; from werkzeug.testapp import test_app
&gt;&gt;&gt; c = Client(test_app)
&gt;&gt;&gt; response = c.get("/")
&gt;&gt;&gt; response.status_code
200
&gt;&gt;&gt; response.headers
Headers([('Content-Type', 'text/html; charset=utf-8'), ('Content-Length', '5211')])
&gt;&gt;&gt; response.get_data(as_text=True)
'&lt;!doctype html&gt;...'
</pre> <p>The client’s request methods return instances of <a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse"><code>TestResponse</code></a>. This provides extra attributes and methods on top of <a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Response" title="werkzeug.wrappers.Response"><code>Response</code></a> that are useful for testing.</p> </section> <section id="request-body"> <h2>Request Body</h2> <p>By passing a dict to <code>data</code>, the client will construct a request body with file and form data. It will set the content type to <code>application/x-www-form-urlencoded</code> if there are no files, or <code>multipart/form-data</code> there are.</p> <pre data-language="python">import io

response = client.post(data={
    "name": "test",
    "file": (BytesIO("file contents".encode("utf8")), "test.txt")
})
</pre> <p>Pass a string, bytes, or file-like object to <code>data</code> to use that as the raw request body. In that case, you should set the content type appropriately. For example, to post YAML:</p> <pre data-language="python">response = client.post(
    data="a: value\nb: 1\n", content_type="application/yaml"
)
</pre> <p>A shortcut when testing JSON APIs is to pass a dict to <code>json</code> instead of using <code>data</code>. This will automatically call <code>json.dumps()</code> and set the content type to <code>application/json</code>. Additionally, if the app returns JSON, <code>response.json</code> will automatically call <code>json.loads()</code>.</p> <pre data-language="python">response = client.post("/api", json={"a": "value", "b": 1})
obj = response.json()
</pre> </section> <section id="environment-builder"> <h2>Environment Builder</h2> <p><a class="reference internal" href="#werkzeug.test.EnvironBuilder" title="werkzeug.test.EnvironBuilder"><code>EnvironBuilder</code></a> is used to construct a WSGI environ dict. The test client uses this internally to prepare its requests. The arguments passed to the client request methods are the same as the builder.</p> <p>Sometimes, it can be useful to construct a WSGI environment manually. An environ builder or dict can be passed to the test client request methods in place of other arguments to use a custom environ.</p> <pre data-language="Python">from werkzeug.test import EnvironBuilder
builder = EnvironBuilder(...)
# build an environ dict
environ = builder.get_environ()
# build an environ dict wrapped in a request
request = builder.get_request()
</pre> <p>The test client responses make this available through <a class="reference internal" href="#werkzeug.test.TestResponse.request" title="werkzeug.test.TestResponse.request"><code>TestResponse.request</code></a> and <code>response.request.environ</code>.</p> </section> <section id="api"> <h2>API</h2> <dl class="py class"> <dt class="sig sig-object py" id="werkzeug.test.Client">
<code>class werkzeug.test.Client(application, response_wrapper=None, use_cookies=True, allow_subdomain_redirects=False)</code> </dt> <dd>
<p>Simulate sending requests to a WSGI application without running a WSGI or HTTP server.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>application</strong> (<em>WSGIApplication</em>) – The WSGI application to make requests to.</li> <li>
<strong>response_wrapper</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.11)">type</a><em>[</em><a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Response" title="werkzeug.wrappers.Response">Response</a><em>] </em><em>| </em><em>None</em>) – A <a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Response" title="werkzeug.wrappers.Response"><code>Response</code></a> class to wrap response data with. Defaults to <a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse"><code>TestResponse</code></a>. If it’s not a subclass of <code>TestResponse</code>, one will be created.</li> <li>
<strong>use_cookies</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – Persist cookies from <code>Set-Cookie</code> response headers to the <code>Cookie</code> header in subsequent requests. Domain and path matching is supported, but other cookie parameters are ignored.</li> <li>
<strong>allow_subdomain_redirects</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – Allow requests to follow redirects to subdomains. Enable this if the application handles subdomains and redirects between them.</li> </ul> </dd> </dl> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.3: </span>Simplify cookie implementation, support domain and path matching.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.1: </span>All data is available as properties on the returned response object. The response cannot be returned as a tuple.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.0: </span><code>response_wrapper</code> is always a subclass of :class:<code>TestResponse</code>.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 0.5: </span>Added the <code>use_cookies</code> parameter.</p> </div> </details><dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.get_cookie">
<code>get_cookie(key, domain='localhost', path='/')</code> </dt> <dd>
<p>Return a <a class="reference internal" href="#werkzeug.test.Cookie" title="werkzeug.test.Cookie"><code>Cookie</code></a> if it exists. Cookies are uniquely identified by <code>(domain, path, key)</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The decoded form of the key for the cookie.</li> <li>
<strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The domain the cookie was set for.</li> <li>
<strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The path the cookie was set for.</li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.Cookie" title="werkzeug.test.Cookie">Cookie</a> | None</p> </dd> </dl> <details class="changelog"> <summary>Changelog</summary><div class="versionadded"> <p><span class="versionmodified added">New in version 2.3.</span></p> </div> </details>
</dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.set_cookie">
<code>set_cookie(key, value='', *, domain='localhost', origin_only=True, path='/', **kwargs)</code> </dt> <dd>
<p>Set a cookie to be sent in subsequent requests.</p> <p>This is a convenience to skip making a test request to a route that would set the cookie. To test the cookie, make a test request to a route that uses the cookie value.</p> <p>The client uses <code>domain</code>, <code>origin_only</code>, and <code>path</code> to determine which cookies to send with a request. It does not use other cookie parameters that browsers use, since they’re not applicable in tests.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The key part of the cookie.</li> <li>
<strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The value part of the cookie.</li> <li>
<strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – Send this cookie with requests that match this domain. If <code>origin_only</code> is true, it must be an exact match, otherwise it may be a suffix match.</li> <li>
<strong>origin_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – Whether the domain must be an exact match to the request.</li> <li>
<strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – Send this cookie with requests that match this path either exactly or as a prefix.</li> <li>
<strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – Passed to <a class="reference internal" href="../http/index.html#werkzeug.http.dump_cookie" title="werkzeug.http.dump_cookie"><code>dump_cookie()</code></a>.</li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p>None</p> </dd> </dl> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3.0: </span>The parameter <code>server_name</code> is removed. The first parameter is <code>key</code>. Use the <code>domain</code> and <code>origin_only</code> parameters instead.</p> </div> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.3: </span>The <code>origin_only</code> parameter was added.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.3: </span>The <code>domain</code> parameter defaults to <code>localhost</code>.</p> </div> </details>
</dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.delete_cookie">
<code>delete_cookie(key, *, domain='localhost', path='/')</code> </dt> <dd>
<p>Delete a cookie if it exists. Cookies are uniquely identified by <code>(domain, path, key)</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The decoded form of the key for the cookie.</li> <li>
<strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The domain the cookie was set for.</li> <li>
<strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – The path the cookie was set for.</li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p>None</p> </dd> </dl> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3.0: </span>The <code>server_name</code> parameter is removed. The first parameter is <code>key</code>. Use the <code>domain</code> parameter instead.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3.0: </span>The <code>secure</code>, <code>httponly</code> and <code>samesite</code> parameters are removed.</p> </div> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.3: </span>The <code>domain</code> parameter defaults to <code>localhost</code>.</p> </div> </details>
</dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.open">
<code>open(*args, buffered=False, follow_redirects=False, **kwargs)</code> </dt> <dd>
<p>Generate an environ dict from the given arguments, make a request to the application using it, and return the response.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – Passed to <a class="reference internal" href="#werkzeug.test.EnvironBuilder" title="werkzeug.test.EnvironBuilder"><code>EnvironBuilder</code></a> to create the environ for the request. If a single arg is passed, it can be an existing <a class="reference internal" href="#werkzeug.test.EnvironBuilder" title="werkzeug.test.EnvironBuilder"><code>EnvironBuilder</code></a> or an environ dict.</li> <li>
<strong>buffered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – Convert the iterator returned by the app into a list. If the iterator has a <code>close()</code> method, it is called automatically.</li> <li>
<strong>follow_redirects</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – Make additional requests to follow HTTP redirects until a non-redirect status is returned. <a class="reference internal" href="#werkzeug.test.TestResponse.history" title="werkzeug.test.TestResponse.history"><code>TestResponse.history</code></a> lists the intermediate responses.</li> <li>
<strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.1: </span>Removed the <code>as_tuple</code> parameter.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.0: </span>The request input stream is closed when calling <code>response.close()</code>. Input streams for redirects are automatically closed.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 0.5: </span>If a dict is provided as file in the dict for the <code>data</code> parameter the content type has to be called <code>content_type</code> instead of <code>mimetype</code>. This change was made for consistency with <code>werkzeug.FileWrapper</code>.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 0.5: </span>Added the <code>follow_redirects</code> parameter.</p> </div> </details>
</dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.get">
<code>get(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>GET</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.post">
<code>post(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>POST</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.put">
<code>put(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>PUT</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.delete">
<code>delete(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>DELETE</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.patch">
<code>patch(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>PATCH</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.options">
<code>options(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>OPTIONS</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.head">
<code>head(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>HEAD</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.Client.trace">
<code>trace(*args, **kw)</code> </dt> <dd>
<p>Call <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>open()</code></a> with <code>method</code> set to <code>TRACE</code>.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> <li>
<strong>kw</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.11)">Any</a>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">TestResponse</a></p> </dd> </dl> </dd>
</dl> </dd>
</dl> <dl class="py class"> <dt class="sig sig-object py" id="werkzeug.test.TestResponse">
<code>class werkzeug.test.TestResponse(response, status, headers, request, history=(), **kwargs)</code> </dt> <dd>
<p><a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Response" title="werkzeug.wrappers.Response"><code>Response</code></a> subclass that provides extra information about requests made with the test <a class="reference internal" href="#werkzeug.test.Client" title="werkzeug.test.Client"><code>Client</code></a>.</p> <p>Test client requests will always return an instance of this class. If a custom response class is passed to the client, it is subclassed along with this to support test information.</p> <p>If the test request included large files, or if the application is serving a file, call <code>close()</code> to close any open files and prevent Python showing a <code>ResourceWarning</code>.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.2: </span>Set the <code>default_mimetype</code> to None to prevent a mimetype being assumed if missing.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.1: </span>Response instances cannot be treated as tuples.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.0: </span>Test client methods always return instances of this class.</p> </div> </details><dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>response</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)">Iterable</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.11)">Iterable</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)">bytes</a><em>]</em>) – </li> <li>
<strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>headers</strong> (<a class="reference internal" href="../datastructures/index.html#werkzeug.datastructures.Headers" title="werkzeug.datastructures.headers.Headers">Headers</a>) – </li> <li>
<strong>request</strong> (<a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Request" title="werkzeug.wrappers.request.Request">Request</a>) – </li> <li>
<strong>history</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a><em>[</em><a class="reference internal" href="#werkzeug.test.TestResponse" title="werkzeug.test.TestResponse">werkzeug.test.TestResponse</a><em>, </em><em>...</em><em>]</em>) – </li> <li>
<strong>kwargs</strong> (<em>t.Any</em>) – </li> </ul> </dd> </dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.TestResponse.default_mimetype">
<code>default_mimetype: str | None = None</code> </dt> <dd>
<p>the default mimetype if none is provided.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.TestResponse.request">
<code>request: Request</code> </dt> <dd>
<p>A request object with the environ used to make the request that resulted in this response.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.TestResponse.history">
<code>history: tuple[werkzeug.test.TestResponse, ...]</code> </dt> <dd>
<p>A list of intermediate responses. Populated when the test request is made with <code>follow_redirects</code> enabled.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.TestResponse.text">
<code>property text: str</code> </dt> <dd>
<p>The response data as text. A shortcut for <code>response.get_data(as_text=True)</code>.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionadded"> <p><span class="versionmodified added">New in version 2.1.</span></p> </div> </details>
</dd>
</dl> </dd>
</dl> <dl class="py class"> <dt class="sig sig-object py" id="werkzeug.test.Cookie">
<code>class werkzeug.test.Cookie(key, value, decoded_key, decoded_value, expires, max_age, domain, origin_only, path, secure, http_only, same_site)</code> </dt> <dd>
<p>A cookie key, value, and parameters.</p> <p>The class itself is not a public API. Its attributes are documented for inspection with <a class="reference internal" href="#werkzeug.test.Client.get_cookie" title="werkzeug.test.Client.get_cookie"><code>Client.get_cookie()</code></a> only.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionadded"> <p><span class="versionmodified added">New in version 2.3.</span></p> </div> </details><dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>decoded_key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>decoded_value</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>expires</strong> (<a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.11)">datetime</a><em> | </em><em>None</em>) – </li> <li>
<strong>max_age</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a><em> | </em><em>None</em>) – </li> <li>
<strong>domain</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>origin_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – </li> <li>
<strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – </li> <li>
<strong>secure</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a><em> | </em><em>None</em>) – </li> <li>
<strong>http_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a><em> | </em><em>None</em>) – </li> <li>
<strong>same_site</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em> | </em><em>None</em>) – </li> </ul> </dd> </dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.key">
<code>key: str</code> </dt> <dd>
<p>The cookie key, encoded as a client would see it.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.value">
<code>value: str</code> </dt> <dd>
<p>The cookie key, encoded as a client would see it.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.decoded_key">
<code>decoded_key: str</code> </dt> <dd>
<p>The cookie key, decoded as the application would set and see it.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.decoded_value">
<code>decoded_value: str</code> </dt> <dd>
<p>The cookie value, decoded as the application would set and see it.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.expires">
<code>expires: datetime | None</code> </dt> <dd>
<p>The time at which the cookie is no longer valid.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.max_age">
<code>max_age: int | None</code> </dt> <dd>
<p>The number of seconds from when the cookie was set at which it is no longer valid.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.domain">
<code>domain: str</code> </dt> <dd>
<p>The domain that the cookie was set for, or the request domain if not set.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.origin_only">
<code>origin_only: bool</code> </dt> <dd>
<p>Whether the cookie will be sent for exact domain matches only. This is <code>True</code> if the <code>Domain</code> parameter was not present.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.path">
<code>path: str</code> </dt> <dd>
<p>The path that the cookie was set for.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.secure">
<code>secure: bool | None</code> </dt> <dd>
<p>The <code>Secure</code> parameter.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.http_only">
<code>http_only: bool | None</code> </dt> <dd>
<p>The <code>HttpOnly</code> parameter.</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.Cookie.same_site">
<code>same_site: str | None</code> </dt> <dd>
<p>The <code>SameSite</code> parameter.</p> </dd>
</dl> </dd>
</dl> <dl class="py class"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder">
<code>class werkzeug.test.EnvironBuilder(path='/', base_url=None, query_string=None, method='GET', input_stream=None, content_type=None, content_length=None, errors_stream=None, multithread=False, multiprocess=False, run_once=False, headers=None, data=None, environ_base=None, environ_overrides=None, mimetype=None, json=None, auth=None)</code> </dt> <dd>
<p>This class can be used to conveniently create a WSGI environment for testing purposes. It can be used to quickly create WSGI environments or request objects from arbitrary data.</p> <p>The signature of this class is also used in some other places as of Werkzeug 0.5 (<a class="reference internal" href="#werkzeug.test.create_environ" title="werkzeug.test.create_environ"><code>create_environ()</code></a>, <code>Response.from_values()</code>, <a class="reference internal" href="#werkzeug.test.Client.open" title="werkzeug.test.Client.open"><code>Client.open()</code></a>). Because of this most of the functionality is available through the constructor alone.</p> <p>Files and regular form data can be manipulated independently of each other with the <a class="reference internal" href="#werkzeug.test.EnvironBuilder.form" title="werkzeug.test.EnvironBuilder.form"><code>form</code></a> and <a class="reference internal" href="#werkzeug.test.EnvironBuilder.files" title="werkzeug.test.EnvironBuilder.files"><code>files</code></a> attributes, but are passed with the same argument to the constructor: <code>data</code>.</p> <p><code>data</code> can be any of these values:</p> <ul class="simple"> <li>a <code>str</code> or <code>bytes</code> object: The object is converted into an <a class="reference internal" href="#werkzeug.test.EnvironBuilder.input_stream" title="werkzeug.test.EnvironBuilder.input_stream"><code>input_stream</code></a>, the <a class="reference internal" href="#werkzeug.test.EnvironBuilder.content_length" title="werkzeug.test.EnvironBuilder.content_length"><code>content_length</code></a> is set and you have to provide a <a class="reference internal" href="#werkzeug.test.EnvironBuilder.content_type" title="werkzeug.test.EnvironBuilder.content_type"><code>content_type</code></a>.</li> <li>
<p>a <code>dict</code> or <code>MultiDict</code>: The keys have to be strings. The values have to be either any of the following objects, or a list of any of the following objects:</p> <ul> <li>a <code>file</code>-like object: These are converted into <code>FileStorage</code> objects automatically.</li> <li>a <code>tuple</code>: The <code>add_file()</code> method is called with the key and the unpacked <code>tuple</code> items as positional arguments.</li> <li>a <code>str</code>: The string is set as form data for the associated key.</li> </ul> </li> <li>a file-like object: The object content is loaded in memory and then handled like a regular <code>str</code> or a <code>bytes</code>.</li> </ul> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – the path of the request. In the WSGI environment this will end up as <code>PATH_INFO</code>. If the <code>query_string</code> is not defined and there is a question mark in the <code>path</code> everything after it is used as query string.</li> <li>
<strong>base_url</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em> | </em><em>None</em>) – the base URL is a URL that is used to extract the WSGI URL scheme, host (server name + server port) and the script root (<code>SCRIPT_NAME</code>).</li> <li>
<strong>query_string</strong> (<em>t.Mapping</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em> | </em><em>None</em>) – an optional string or dict with URL parameters.</li> <li>
<strong>method</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>) – the HTTP method to use, defaults to <code>GET</code>.</li> <li>
<strong>input_stream</strong> (<em>t.IO</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)">bytes</a><em>] </em><em>| </em><em>None</em>) – an optional input stream. Do not specify this and <code>data</code>. As soon as an input stream is set you can’t modify <a class="reference internal" href="#werkzeug.test.EnvironBuilder.args" title="werkzeug.test.EnvironBuilder.args"><code>args</code></a> and <a class="reference internal" href="#werkzeug.test.EnvironBuilder.files" title="werkzeug.test.EnvironBuilder.files"><code>files</code></a> unless you set the <a class="reference internal" href="#werkzeug.test.EnvironBuilder.input_stream" title="werkzeug.test.EnvironBuilder.input_stream"><code>input_stream</code></a> to <code>None</code> again.</li> <li>
<strong>content_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em> | </em><em>None</em>) – The content type for the request. As of 0.5 you don’t have to provide this when specifying files and form data via <code>data</code>.</li> <li>
<strong>content_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.11)">int</a><em> | </em><em>None</em>) – The content length for the request. You don’t have to specify this when providing data via <code>data</code>.</li> <li>
<strong>errors_stream</strong> (<em>t.IO</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>] </em><em>| </em><em>None</em>) – an optional error stream that is used for <code>wsgi.errors</code>. Defaults to <code>stderr</code>.</li> <li>
<strong>multithread</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – controls <code>wsgi.multithread</code>. Defaults to <code>False</code>.</li> <li>
<strong>multiprocess</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – controls <code>wsgi.multiprocess</code>. Defaults to <code>False</code>.</li> <li>
<strong>run_once</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – controls <code>wsgi.run_once</code>. Defaults to <code>False</code>.</li> <li>
<strong>headers</strong> (<a class="reference internal" href="../datastructures/index.html#werkzeug.datastructures.Headers" title="werkzeug.datastructures.Headers">Headers</a><em> | </em><em>t.Iterable</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>]</em><em>] </em><em>| </em><em>None</em>) – an optional list or <code>Headers</code> object of headers.</li> <li>
<strong>data</strong> (<em>None</em><em> | </em><em>(</em><em>t.IO</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)">bytes</a><em>] </em><em>| </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)">bytes</a><em> | </em><em>t.Mapping</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><em>t.Any</em><em>]</em><em>)</em>) – a string or dict of form data or a file-object. See explanation above.</li> <li>
<strong>json</strong> (<em>t.Mapping</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><em>t.Any</em><em>] </em><em>| </em><em>None</em>) – An object to be serialized and assigned to <code>data</code>. Defaults the content type to <code>"application/json"</code>. Serialized with the function assigned to <a class="reference internal" href="#werkzeug.test.EnvironBuilder.json_dumps" title="werkzeug.test.EnvironBuilder.json_dumps"><code>json_dumps</code></a>.</li> <li>
<strong>environ_base</strong> (<em>t.Mapping</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><em>t.Any</em><em>] </em><em>| </em><em>None</em>) – an optional dict of environment defaults.</li> <li>
<strong>environ_overrides</strong> (<em>t.Mapping</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><em>t.Any</em><em>] </em><em>| </em><em>None</em>) – an optional dict of environment overrides.</li> <li>
<strong>auth</strong> (<a class="reference internal" href="../datastructures/index.html#werkzeug.datastructures.Authorization" title="werkzeug.datastructures.Authorization">Authorization</a><em> | </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em>] </em><em>| </em><em>None</em>) – An authorization object to use for the <code>Authorization</code> header value. A <code>(username, password)</code> tuple is a shortcut for <code>Basic</code> authorization.</li> <li>
<strong>mimetype</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a><em> | </em><em>None</em>) – </li> </ul> </dd> </dl> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 3.0: </span>The <code>charset</code> parameter was removed.</p> </div> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.1: </span><code>CONTENT_TYPE</code> and <code>CONTENT_LENGTH</code> are not duplicated as header keys in the environ.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.0: </span><code>REQUEST_URI</code> and <code>RAW_URI</code> is the full raw URI including the query string, not only the path.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.0: </span>The default <a class="reference internal" href="#werkzeug.test.EnvironBuilder.request_class" title="werkzeug.test.EnvironBuilder.request_class"><code>request_class</code></a> is <code>Request</code> instead of <code>BaseRequest</code>.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 2.0: </span>Added the <code>auth</code> parameter.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.15: </span>The <code>json</code> param and <a class="reference internal" href="#werkzeug.test.EnvironBuilder.json_dumps" title="werkzeug.test.EnvironBuilder.json_dumps"><code>json_dumps()</code></a> method.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.15: </span>The environ has keys <code>REQUEST_URI</code> and <code>RAW_URI</code> containing the path before percent-decoding. This is not part of the WSGI PEP, but many WSGI servers include it.</p> </div> <div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 0.6: </span><code>path</code> and <code>base_url</code> can now be unicode strings that are encoded with <code>iri_to_uri()</code>.</p> </div> </details><dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.server_protocol">
<code>server_protocol = 'HTTP/1.1'</code> </dt> <dd>
<p>the server protocol to use. defaults to HTTP/1.1</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.wsgi_version">
<code>wsgi_version = (1, 0)</code> </dt> <dd>
<p>the wsgi version to use. defaults to (1, 0)</p> </dd>
</dl> <dl class="py attribute"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.request_class">
<code>request_class</code> </dt> <dd>
<p>The default request class used by <a class="reference internal" href="#werkzeug.test.EnvironBuilder.get_request" title="werkzeug.test.EnvironBuilder.get_request"><code>get_request()</code></a>.</p> <p>alias of <a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Request" title="werkzeug.wrappers.request.Request"><code>Request</code></a></p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.json_dumps">
<code>static json_dumps(obj, *, skipkeys=False, ensure_ascii=True, check_circular=True, allow_nan=True, cls=None, indent=None, separators=None, default=None, sort_keys=False, **kw)</code> </dt> <dd>
<p>The serialization function used when <code>json</code> is passed.</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.from_environ">
<code>classmethod from_environ(environ, **kwargs)</code> </dt> <dd>
<p>Turn an environ dict back into a builder. Any extra kwargs override the args extracted from the environ.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 2.0: </span>Path and query values are passed through the WSGI decoding dance to avoid double encoding.</p> </div> <div class="versionadded"> <p><span class="versionmodified added">New in version 0.15.</span></p> </div> </details><dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>environ</strong> (<em>WSGIEnvironment</em>) – </li> <li>
<strong>kwargs</strong> (<em>t.Any</em>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="#werkzeug.test.EnvironBuilder" title="werkzeug.test.EnvironBuilder">EnvironBuilder</a></p> </dd> </dl> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.base_url">
<code>property base_url: str</code> </dt> <dd>
<p>The base URL is used to extract the URL scheme, host name, port, and root path.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.content_type">
<code>property content_type: str | None</code> </dt> <dd>
<p>The content type for the request. Reflected from and to the <code>headers</code>. Do not set if you set <a class="reference internal" href="#werkzeug.test.EnvironBuilder.files" title="werkzeug.test.EnvironBuilder.files"><code>files</code></a> or <a class="reference internal" href="#werkzeug.test.EnvironBuilder.form" title="werkzeug.test.EnvironBuilder.form"><code>form</code></a> for auto detection.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.mimetype">
<code>property mimetype: str | None</code> </dt> <dd>
<p>The mimetype (content type without charset etc.)</p> <details class="changelog"> <summary>Changelog</summary><div class="versionadded"> <p><span class="versionmodified added">New in version 0.14.</span></p> </div> </details>
</dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.mimetype_params">
<code>property mimetype_params: Mapping[str, str]</code> </dt> <dd>
<p>The mimetype parameters as dict. For example if the content type is <code>text/html; charset=utf-8</code> the params would be <code>{'charset': 'utf-8'}</code>.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionadded"> <p><span class="versionmodified added">New in version 0.14.</span></p> </div> </details>
</dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.content_length">
<code>property content_length: int | None</code> </dt> <dd>
<p>The content length as integer. Reflected from and to the <code>headers</code>. Do not set if you set <a class="reference internal" href="#werkzeug.test.EnvironBuilder.files" title="werkzeug.test.EnvironBuilder.files"><code>files</code></a> or <a class="reference internal" href="#werkzeug.test.EnvironBuilder.form" title="werkzeug.test.EnvironBuilder.form"><code>form</code></a> for auto detection.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.form">
<code>property form: MultiDict</code> </dt> <dd>
<p>A <code>MultiDict</code> of form values.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.files">
<code>property files: FileMultiDict</code> </dt> <dd>
<p>A <code>FileMultiDict</code> of uploaded files. Use <code>add_file()</code> to add new files.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.input_stream">
<code>property input_stream: IO[bytes] | None</code> </dt> <dd>
<p>An optional input stream. This is mutually exclusive with setting <a class="reference internal" href="#werkzeug.test.EnvironBuilder.form" title="werkzeug.test.EnvironBuilder.form"><code>form</code></a> and <a class="reference internal" href="#werkzeug.test.EnvironBuilder.files" title="werkzeug.test.EnvironBuilder.files"><code>files</code></a>, setting it will clear those. Do not provide this if the method is not <code>POST</code> or another method that has a body.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.query_string">
<code>property query_string: str</code> </dt> <dd>
<p>The query string. If you set this to a string <a class="reference internal" href="#werkzeug.test.EnvironBuilder.args" title="werkzeug.test.EnvironBuilder.args"><code>args</code></a> will no longer be available.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.args">
<code>property args: MultiDict</code> </dt> <dd>
<p>The URL arguments as <code>MultiDict</code>.</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.server_name">
<code>property server_name: str</code> </dt> <dd>
<p>The server name (read-only, use <code>host</code> to set)</p> </dd>
</dl> <dl class="py property"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.server_port">
<code>property server_port: int</code> </dt> <dd>
<p>The server port as integer (read-only, use <code>host</code> to set)</p> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.close">
<code>close()</code> </dt> <dd>
<p>Closes all files. If you put real <code>file</code> objects into the <a class="reference internal" href="#werkzeug.test.EnvironBuilder.files" title="werkzeug.test.EnvironBuilder.files"><code>files</code></a> dict you can call this method to automatically close them all in one go.</p> <dl class="field-list simple"> <dt class="field-odd">Return type<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>None</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.get_environ">
<code>get_environ()</code> </dt> <dd>
<p>Return the built environ.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 0.15: </span>The content type and length headers are set based on input stream detection. Previously this only set the WSGI keys.</p> </div> </details><dl class="field-list simple"> <dt class="field-odd">Return type<span class="colon">:</span>
</dt> <dd class="field-odd">
<p>WSGIEnvironment</p> </dd> </dl> </dd>
</dl> <dl class="py method"> <dt class="sig sig-object py" id="werkzeug.test.EnvironBuilder.get_request">
<code>get_request(cls=None)</code> </dt> <dd>
<p>Returns a request with the data. If the request class is not specified <a class="reference internal" href="#werkzeug.test.EnvironBuilder.request_class" title="werkzeug.test.EnvironBuilder.request_class"><code>request_class</code></a> is used.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><strong>cls</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.11)">type</a><em>[</em><a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Request" title="werkzeug.wrappers.request.Request">werkzeug.wrappers.request.Request</a><em>] </em><em>| </em><em>None</em>) – The request wrapper to use.</p> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p><a class="reference internal" href="../wrappers/index.html#werkzeug.wrappers.Request" title="werkzeug.wrappers.request.Request">Request</a></p> </dd> </dl> </dd>
</dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="werkzeug.test.create_environ">
<code>werkzeug.test.create_environ(*args, **kwargs)</code> </dt> <dd>
<p>Create a new WSGI environ dict based on the values passed. The first parameter should be the path of the request which defaults to ‘/’. The second one can either be an absolute path (in that case the host is localhost:80) or a full path to the request with scheme, netloc port and the path to the script.</p> <p>This accepts the same arguments as the <a class="reference internal" href="#werkzeug.test.EnvironBuilder" title="werkzeug.test.EnvironBuilder"><code>EnvironBuilder</code></a> constructor.</p> <details class="changelog"> <summary>Changelog</summary><div class="versionchanged"> <p><span class="versionmodified changed">Changed in version 0.5: </span>This function is now a thin wrapper over <a class="reference internal" href="#werkzeug.test.EnvironBuilder" title="werkzeug.test.EnvironBuilder"><code>EnvironBuilder</code></a> which was added in 0.5. The <code>headers</code>, <code>environ_base</code>, <code>environ_overrides</code> and <code>charset</code> parameters were added.</p> </div> </details><dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>args</strong> (<em>t.Any</em>) – </li> <li>
<strong>kwargs</strong> (<em>t.Any</em>) – </li> </ul> </dd> <dt class="field-even">Return type<span class="colon">:</span>
</dt> <dd class="field-even">
<p>WSGIEnvironment</p> </dd> </dl> </dd>
</dl> <dl class="py function"> <dt class="sig sig-object py" id="werkzeug.test.run_wsgi_app">
<code>werkzeug.test.run_wsgi_app(app, environ, buffered=False)</code> </dt> <dd>
<p>Return a tuple in the form (app_iter, status, headers) of the application output. This works best if you pass it an application that returns an iterator all the time.</p> <p>Sometimes applications may use the <code>write()</code> callable returned by the <code>start_response</code> function. This tries to resolve such edge cases automatically. But if you don’t get the expected output you should set <code>buffered</code> to <code>True</code> which enforces buffering.</p> <p>If passed an invalid WSGI application the behavior of this function is undefined. Never pass non-conforming WSGI applications to this function.</p> <dl class="field-list simple"> <dt class="field-odd">Parameters<span class="colon">:</span>
</dt> <dd class="field-odd">
<ul class="simple"> <li>
<strong>app</strong> (<em>WSGIApplication</em>) – the application to execute.</li> <li>
<strong>buffered</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.11)">bool</a>) – set to <code>True</code> to enforce buffering.</li> <li>
<strong>environ</strong> (<em>WSGIEnvironment</em>) – </li> </ul> </dd> <dt class="field-even">Returns<span class="colon">:</span>
</dt> <dd class="field-even">
<p>tuple in the form <code>(app_iter, status, headers)</code></p> </dd> <dt class="field-odd">Return type<span class="colon">:</span>
</dt> <dd class="field-odd">
<p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.11)">tuple</a>[t.Iterable[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bytes" title="(in Python v3.11)">bytes</a>], <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.11)">str</a>, <a class="reference internal" href="../datastructures/index.html#werkzeug.datastructures.Headers" title="werkzeug.datastructures.Headers">Headers</a>]</p> </dd> </dl> </dd>
</dl> </section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007 Pallets<br>Licensed under the BSD 3-clause License.<br>
    <a href="https://werkzeug.palletsprojects.com/en/3.0.x/test/" class="_attribution-link">https://werkzeug.palletsprojects.com/en/3.0.x/test/</a>
  </p>
</div>
