<h1 id="acceptance-tests">  Acceptance Tests </h1> <p>In order to deliver on our promise to be safe and predictable, we need to be able to easily and routinely verify that Terraform Plugins produce the expected outcome. The most common usage of an acceptance test is in Terraform Providers, where each Resource is tested with configuration files and the resulting infrastructure is verified. Terraform includes a framework for constructing acceptance tests that imitate the execution of one or more steps of applying one or more configuration files, allowing multiple scenarios to be tested.</p> <p>Terraform acceptance tests use real Terraform configurations to exercise the code in real plan, apply, refresh, and destroy life cycles. When run from the root of a Terraform Provider codebase, Terraform’s testing framework compiles the current provider in-memory and executes the provided configuration in developer defined steps, creating infrastructure along the way. At the conclusion of all the steps, Terraform automatically destroys the infrastructure. It’s important to note that during development, it’s possible for Terraform to leave orphaned or “dangling” resources behind, depending on the correctness of the code in development. The testing framework provides means to validate all resources are destroyed, alerting developers if any fail to destroy. It is the developer's responsibility to clean up any dangling resources left over fromduring testing and development.</p> <h2 id="test-files">  Test files </h2> <p>Terraform follows many of the Go programming language conventions with regards to testing, with both acceptance tests and unit tests being placed in a file that matches the file under test, with an added <code>_test.go</code> suffix. Here’s an example file structure:</p> <pre>terraform-plugin-example/
├── provider.go
├── provider_test.go
├── example/
│   ├── resource_example_compute.go
│   ├── resource_example_compute_test.go
</pre>
<p>To create an acceptance test in the example <code>resource_example_compute_test.go</code> file, the function name must begin with <code>TestAccXxx</code>, and have the following signature:</p> <pre>func TestAccXxx(*testing.T)
</pre>
<h2 id="running-acceptance-tests">  Running Acceptance Tests </h2> <p>Terraform requires an environment variable <code>TF_ACC</code> be set in order to run acceptance tests. This is by design, and intended to prevent developers from incurring unintended charges when running tests. The easiest way to run acceptance tests is to use the built in <code>make</code> step <code>testacc</code>, which explicitly sets the <code>TF_ACC</code> value for you. Example:</p> <pre>$ make testacc 
</pre>
<p><strong>It’s important to reiterate that acceptance tests create actual cloud resources</strong>, possibly incurring expenses which are the responsibility of the user running the tests. Creating real infrastructure in tests verifies the described behavior of Terraform Plugins in real world use cases against the actual APIs, and verifies both local state and remote values match. Acceptance tests require a network connection and often require credentials to access an account for the given API.</p> <blockquote class="alert alert-warning" role="alert"> <p>Note: When developing or testing Terraform plugins, we highly recommend running acceptance tests with an account dedicated to testing. This ensures no infrastructure is created or destroyed in error during development or validation of any Provider Resources in any environment that cannot be completely and safely destroyed.</p> </blockquote> <h2 id="next-steps">  Next Steps </h2> <p>Terraform relies heavily on acceptance tests to ensure we keep our promise of helping users safely and predictably create, change, and improve infrastructure. In our next section we detail how to create “Test Cases”, individual acceptance tests using Terraform’s testing framework, in order to build and verify real infrastructure. <a href="testcase.html">Proceed to Test Cases</a></p><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2018 HashiCorp</br>Licensed under the MPL 2.0 License.<br>
    <a href="https://www.terraform.io/docs/extend/testing/acceptance-tests/index.html" class="_attribution-link">https://www.terraform.io/docs/extend/testing/acceptance-tests/index.html</a>
  </p>
</div>
