<h1>User actions</h1>
<div class="section-content">
<p>Some WebExtension APIs perform functions that are generally performed as a result of a user action. For example:</p> <ul> <li>a browser action with a popup will display the popup when the user clicks it, but there's also a <a href="api/browseraction/openpopup.html"><code>browserAction.openPopup</code></a> API enabling an extension to open the popup programmatically.</li> <li>if an extension adds a sidebar, it is typically opened by the user via some part of the browser's built-in user interface, such as the View/Sidebar menu. But there's also a <a href="api/sidebaraction/open.html"><code>sidebarAction.open</code></a> API enabling an extension to open their sidebar programmatically.</li> </ul> <p>To follow the principle of "no surprises", APIs like this can only be called from inside the handler for a user action. User actions include the following:</p> <ul> <li>Clicking the extension's browser action or page action.</li> <li>Selecting a context menu item defined by the extension.</li> <li>Activating a keyboard shortcut defined by the extension (this only treated as a user action from Firefox 63 onwards).</li> <li>Clicking a button in a page bundled with the extension.</li> </ul> <p>For example:</p> <div class="code-example"><pre data-language="js"><span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  browser<span class="token punctuation">.</span>sidebarAction<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span>onClicked<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handleClick<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div> <p>Note that user actions in normal web pages are not treated as user actions for this purpose. For example, if a user clicks a button in a normal web page, and a content script has added a click handler for that button and in that handler sends a message to the extension's background page, then the background page message handler is not considered to be handling a user action.</p> <p>Also, if a user input handler waits on a <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">promise</a>, then its status as a user input handler is lost. For example:</p> <div class="code-example"><pre data-language="js"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">someAsyncFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// this will fail, because the handler lost its "user action handler" status</span>
  browser<span class="token punctuation">.</span>sidebarAction<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

browser<span class="token punctuation">.</span>browserAction<span class="token punctuation">.</span>onClicked<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span>handleClick<span class="token punctuation">)</span><span class="token punctuation">;</span>
</pre></div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2023 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/User_actions" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Mozilla/Add-ons/WebExtensions/User_actions</a>
  </p>
</div>
