<h1>Schema</h1>

<div class="api-content">
<h3 id="Schema()">Schema()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>[definition]</code> <span class="method-type">«Object|Schema|Array»</span> Can be one of: object describing schema paths, or schema to copy, or array of objects and schemas </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
</ul>
<h5>Inherits:</h5>
<ul><li><span class="method-type"><a href="https://nodejs.org/api/events.html#class-eventemitter">«NodeJS EventEmitter»</a></span></li></ul>
<div>
<p>Schema constructor.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> child = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> });
<span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span>, <span class="hljs-attr">children</span>: [child] });
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Tree</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Tree'</span>, schema);

<span class="hljs-comment">// setting schema options</span>
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> }, { <span class="hljs-attr">_id</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">autoIndex</span>: <span class="hljs-literal">false</span> })
</pre> <h4 id="options"> <a href="#options"> Options: </a> </h4> <ul> <li>
<a href="../guide.html#autoIndex">autoIndex</a>: bool - defaults to null (which means use the connection's autoIndex option)</li> <li>
<a href="../guide.html#autoCreate">autoCreate</a>: bool - defaults to null (which means use the connection's autoCreate option)</li> <li>
<a href="../guide.html#bufferCommands">bufferCommands</a>: bool - defaults to true</li> <li>
<a href="../guide.html#bufferTimeoutMS">bufferTimeoutMS</a>: number - defaults to 10000 (10 seconds). If <code>bufferCommands</code> is enabled, the amount of time Mongoose will wait for connectivity to be restablished before erroring out.</li> <li>
<a href="../guide.html#capped">capped</a>: bool | number | object - defaults to false</li> <li>
<a href="../guide.html#collection">collection</a>: string - no default</li> <li>
<a href="../guide.html#discriminatorKey">discriminatorKey</a>: string - defaults to <code>__t</code>
</li> <li>
<a href="../guide.html#id">id</a>: bool - defaults to true</li> <li>
<a href="../guide.html#_id">_id</a>: bool - defaults to true</li> <li>
<a href="../guide.html#minimize">minimize</a>: bool - controls <a href="document.html#Document.prototype.toObject()">document#toObject</a> behavior when called manually - defaults to true</li> <li>
<a href="../guide.html#read">read</a>: string</li> <li>
<a href="../guide.html#writeConcern">writeConcern</a>: object - defaults to null, use to override <a href="https://www.mongodb.com/docs/manual/reference/write-concern/">the MongoDB server's default write concern settings</a>
</li> <li>
<a href="../guide.html#shardKey">shardKey</a>: object - defaults to <code>null</code>
</li> <li>
<a href="../guide.html#strict">strict</a>: bool - defaults to true</li> <li>
<a href="../guide.html#strictQuery">strictQuery</a>: bool - defaults to false</li> <li>
<a href="../guide.html#toJSON">toJSON</a> - object - no default</li> <li>
<a href="../guide.html#toObject">toObject</a> - object - no default</li> <li>
<a href="../guide.html#typeKey">typeKey</a> - string - defaults to 'type'</li> <li>
<a href="../guide.html#validateBeforeSave">validateBeforeSave</a> - bool - defaults to <code>true</code>
</li> <li>
<a href="document.html#Document.prototype.validate()">validateModifiedOnly</a> - bool - defaults to <code>false</code>
</li> <li>
<a href="../guide.html#versionKey">versionKey</a>: string or object - defaults to "__v"</li> <li>
<a href="../guide.html#optimisticConcurrency">optimisticConcurrency</a>: bool - defaults to false. Set to true to enable <a href="https://thecodebarbarian.com/whats-new-in-mongoose-5-10-optimistic-concurrency.html">optimistic concurrency</a>.</li> <li>
<a href="../guide.html#collation">collation</a>: object - defaults to null (which means use no collation)</li> <li>
<a href="../guide.html#timeseries">timeseries</a>: object - defaults to null (which means this schema's collection won't be a timeseries collection)</li> <li>
<a href="../guide.html#selectPopulatedPaths">selectPopulatedPaths</a>: boolean - defaults to <code>true</code>
</li> <li>
<a href="../guide.html#skipVersioning">skipVersioning</a>: object - paths to exclude from versioning</li> <li>
<a href="../guide.html#timestamps">timestamps</a>: object or boolean - defaults to <code>false</code>. If true, Mongoose adds <code>createdAt</code> and <code>updatedAt</code> properties to your schema and manages those properties for you.</li> <li>
<a href="../guide.html#pluginTags">pluginTags</a>: array of strings - defaults to <code>undefined</code>. If set and plugin called with <code>tags</code> option, will only apply that plugin to schemas with a matching tag.</li> <li>
<a href="../tutorials/virtuals.html#virtuals-via-schema-options">virtuals</a>: object - virtuals to define, alias for <a href="#Schema.prototype.virtual()"><code>.virtual</code></a>
</li> <li>[collectionOptions]: object with options passed to <a href="https://www.mongodb.com/docs/manual/reference/method/db.createCollection/"><code>createCollection()</code></a> when calling <code>Model.createCollection()</code> or <code>autoCreate</code> set to true.</li> </ul> <h4 id="options-for-nested-schemas"> <a href="#options-for-nested-schemas"> Options for Nested Schemas: </a> </h4> <ul> <li>
<code>excludeIndexes</code>: bool - defaults to <code>false</code>. If <code>true</code>, skip building indexes on this schema's paths.</li> </ul> <h4 id="note"> <a href="#note"> Note: </a> </h4> <p><em>When nesting schemas, (<code>children</code> in the example above), always declare the child schema first before passing it into its parent.</em></p> </div>
<h3 id="Schema.Types">Schema.Types</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The various built-in Mongoose Schema Types.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> mongoose = <span class="hljs-built_in">require</span>(<span class="hljs-string">'mongoose'</span>);
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ObjectId</span> = mongoose.<span class="hljs-property">Schema</span>.<span class="hljs-property">Types</span>.<span class="hljs-property">ObjectId</span>;
</pre> <h4 id="types"> <a href="#types"> Types: </a> </h4> <ul> <li><a href="../schematypes.html#strings">String</a></li> <li><a href="../schematypes.html#numbers">Number</a></li> <li>
<a href="../schematypes.html#booleans">Boolean</a> | Bool</li> <li><a href="../schematypes.html#arrays">Array</a></li> <li><a href="../schematypes.html#buffers">Buffer</a></li> <li><a href="../schematypes.html#dates">Date</a></li> <li>
<a href="../schematypes.html#objectids">ObjectId</a> | Oid</li> <li><a href="../schematypes.html#mixed">Mixed</a></li> <li><a href="../schematypes.html#uuid">UUID</a></li> <li><a href="../schematypes.html#bigint">BigInt</a></li> </ul> <p>Using this exposed access to the <code>Mixed</code> SchemaType, we can use them in our schema.</p> <pre data-language="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">Mixed</span> = mongoose.<span class="hljs-property">Schema</span>.<span class="hljs-property">Types</span>.<span class="hljs-property">Mixed</span>;
<span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">_user</span>: <span class="hljs-title class_">Mixed</span> })
</pre> </div>
<h3 id="Schema.indexTypes">Schema.indexTypes</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The allowed index types</p> </div>
<h3 id="Schema.prototype.add()">Schema.prototype.add()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>obj</code> <span class="method-type">«Object|Schema»</span> plain object with paths to add, or another schema </li>
<li class="param">
<code>[prefix]</code> <span class="method-type">«String»</span> path to prefix the newly added paths with </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the Schema instance</li></ul>
<div>
<p>Adds key path / schema type pairs to this schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ToySchema</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>();
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">add</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'string'</span>, <span class="hljs-attr">color</span>: <span class="hljs-string">'string'</span>, <span class="hljs-attr">price</span>: <span class="hljs-string">'number'</span> });

<span class="hljs-keyword">const</span> <span class="hljs-title class_">TurboManSchema</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>();
<span class="hljs-comment">// You can also `add()` another schema and copy over all paths, virtuals,</span>
<span class="hljs-comment">// getters, setters, indexes, methods, and statics.</span>
<span class="hljs-title class_">TurboManSchema</span>.<span class="hljs-title function_">add</span>(<span class="hljs-title class_">ToySchema</span>).<span class="hljs-title function_">add</span>({ <span class="hljs-attr">year</span>: <span class="hljs-title class_">Number</span> });
</pre> </div>
<h3 id="Schema.prototype.alias()">Schema.prototype.alias()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String»</span> real path to alias </li>
<li class="param">
<code>alias</code> <span class="method-type">«String|Array[String]»</span> the path(s) to use as an alias for <code>path</code> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the Schema instance</li></ul>
<div>
<p>Add an alias for <code>path</code>. This means getting or setting the <code>alias</code> is equivalent to getting or setting the <code>path</code>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> toySchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">n</span>: <span class="hljs-title class_">String</span> });

<span class="hljs-comment">// Make 'name' an alias for 'n'</span>
toySchema.<span class="hljs-title function_">alias</span>(<span class="hljs-string">'n'</span>, <span class="hljs-string">'name'</span>);

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Toy</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Toy'</span>, toySchema);
<span class="hljs-keyword">const</span> turboMan = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Toy</span>({ <span class="hljs-attr">n</span>: <span class="hljs-string">'Turbo Man'</span> });

turboMan.<span class="hljs-property">name</span>; <span class="hljs-comment">// 'Turbo Man'</span>
turboMan.<span class="hljs-property">n</span>; <span class="hljs-comment">// 'Turbo Man'</span>

turboMan.<span class="hljs-property">name</span> = <span class="hljs-string">'Turbo Man Action Figure'</span>;
turboMan.<span class="hljs-property">n</span>; <span class="hljs-comment">// 'Turbo Man Action Figure'</span>

<span class="hljs-keyword">await</span> turboMan.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// Saves { _id: ..., n: 'Turbo Man Action Figure' }</span>
</pre> </div>
<h3 id="Schema.prototype.childSchemas">Schema.prototype.childSchemas</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Array of child schemas (from document arrays and single nested subdocs) and their corresponding compiled models. Each element of the array is an object with 2 properties: <code>schema</code> and <code>model</code>.</p> <p>This property is typically only useful for plugin authors and advanced users. You do not need to interact with this property at all to use mongoose.</p> </div>
<h3 id="Schema.prototype.clearIndexes()">Schema.prototype.clearIndexes()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the Schema instance</li></ul>
<div>
<p>Remove all indexes from this schema.</p> <p>clearIndexes only removes indexes from your schema object. Does <strong>not</strong> affect the indexes in MongoDB.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ToySchema</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">price</span>: <span class="hljs-title class_">Number</span> });
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">index</span>({ <span class="hljs-attr">name</span>: <span class="hljs-number">1</span> });
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">index</span>({ <span class="hljs-attr">color</span>: <span class="hljs-number">1</span> });

<span class="hljs-comment">// Remove all indexes on this schema</span>
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">clearIndexes</span>();

<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">indexes</span>(); <span class="hljs-comment">// []</span>
</pre> </div>
<h3 id="Schema.prototype.clone()">Schema.prototype.clone()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the cloned schema</li></ul>
<div>
<p>Returns a deep copy of the schema</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> });
<span class="hljs-keyword">const</span> clone = schema.<span class="hljs-title function_">clone</span>();
clone === schema; <span class="hljs-comment">// false</span>
clone.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// SchemaString { ... }</span>
</pre> </div>
<h3 id="Schema.prototype.discriminator()">Schema.prototype.discriminator()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>name</code> <span class="method-type">«String»</span> the name of the discriminator </li>
<li class="param">
<code>schema</code> <span class="method-type">«Schema»</span> the discriminated Schema </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the Schema instance</li></ul>
<div>
<p>Inherit a Schema by applying a discriminator on an existing Schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> eventSchema = <span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">timestamp</span>: <span class="hljs-title class_">Date</span> }, { <span class="hljs-attr">discriminatorKey</span>: <span class="hljs-string">'kind'</span> });

<span class="hljs-keyword">const</span> clickedEventSchema = <span class="hljs-keyword">new</span> mongoose.<span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">element</span>: <span class="hljs-title class_">String</span> }, { <span class="hljs-attr">discriminatorKey</span>: <span class="hljs-string">'kind'</span> });
<span class="hljs-keyword">const</span> <span class="hljs-title class_">ClickedModel</span> = eventSchema.<span class="hljs-title function_">discriminator</span>(<span class="hljs-string">'clicked'</span>, clickedEventSchema);

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Event</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Event'</span>, eventSchema);

<span class="hljs-title class_">Event</span>.<span class="hljs-property">discriminators</span>[<span class="hljs-string">'clicked'</span>]; <span class="hljs-comment">// Model { clicked }</span>

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Event</span>.<span class="hljs-title function_">create</span>({ <span class="hljs-attr">kind</span>: <span class="hljs-string">'clicked'</span>, <span class="hljs-attr">element</span>: <span class="hljs-string">'#hero'</span> });
doc.<span class="hljs-property">element</span>; <span class="hljs-comment">// '#hero'</span>
doc <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">ClickedModel</span>; <span class="hljs-comment">// true</span>
</pre> </div>
<h3 id="Schema.prototype.eachPath()">Schema.prototype.eachPath()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>fn</code> <span class="method-type">«Function»</span> callback function </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> this</li></ul>
<div>
<p>Iterates the schemas paths similar to Array#forEach.</p> <p>The callback is passed the pathname and the schemaType instance.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">registeredAt</span>: <span class="hljs-title class_">Date</span> });
userSchema.<span class="hljs-title function_">eachPath</span>(<span class="hljs-function">(<span class="hljs-params">pathname, schematype</span>) =&gt;</span> {
  <span class="hljs-comment">// Prints twice:</span>
  <span class="hljs-comment">// name SchemaString { ... }</span>
  <span class="hljs-comment">// registeredAt SchemaDate { ... }</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(pathname, schematype);
});
</pre> </div>
<h3 id="Schema.prototype.get()">Schema.prototype.get()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>key</code> <span class="method-type">«String»</span> The name of the Option to get the current value for </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Any»</span> the option's value</li></ul>
<div>
<p>Gets a schema option.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">schema.<span class="hljs-title function_">get</span>(<span class="hljs-string">'strict'</span>); <span class="hljs-comment">// true</span>
schema.<span class="hljs-title function_">set</span>(<span class="hljs-string">'strict'</span>, <span class="hljs-literal">false</span>);
schema.<span class="hljs-title function_">get</span>(<span class="hljs-string">'strict'</span>); <span class="hljs-comment">// false</span>
</pre> </div>
<h3 id="Schema.prototype.index()">Schema.prototype.index()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>fields</code> <span class="method-type">«Object»</span> The Fields to index, with the order, available values: <code>1 | -1 | '2d' | '2dsphere' | 'geoHaystack' | 'hashed' | 'text'</code> </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> Options to pass to <a href="https://mongodb.github.io/node-mongodb-native/4.9/classes/Collection.html#createIndex">MongoDB driver's <code>createIndex()</code> function</a> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.expires=null]</code> <span class="method-type">«String|number»</span> Mongoose-specific syntactic sugar, uses <a href="https://www.npmjs.com/package/ms">ms</a> to convert <code>expires</code> option into seconds for the <code>expireAfterSeconds</code> in the above link. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.language_override=null]</code> <span class="method-type">«String»</span> Tells mongodb to use the specified field instead of <code>language</code> for parsing text indexes. </li></ul>
</ul>
<div>
<p>Defines an index (most likely compound) for this schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">schema.<span class="hljs-title function_">index</span>({ <span class="hljs-attr">first</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">last</span>: -<span class="hljs-number">1</span> })
</pre> </div>
<h3 id="Schema.prototype.indexes()">Schema.prototype.indexes()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array»</span> list of indexes defined in the schema</li></ul>
<div>
<p>Returns a list of indexes that this schema declares, via <code>schema.index()</code> or by <code>index: true</code> in a path's options. Indexes are expressed as an array <code>[spec, options]</code>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({
  <span class="hljs-attr">email</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">unique</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">registeredAt</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">Date</span>, <span class="hljs-attr">index</span>: <span class="hljs-literal">true</span> }
});

<span class="hljs-comment">// [ [ { email: 1 }, { unique: true, background: true } ],</span>
<span class="hljs-comment">//   [ { registeredAt: 1 }, { background: true } ] ]</span>
userSchema.<span class="hljs-title function_">indexes</span>();
</pre> <p><a href="../plugins.html">Plugins</a> can use the return value of this function to modify a schema's indexes. For example, the below plugin makes every index unique by default.</p> <pre data-language="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">myPlugin</span>(<span class="hljs-params">schema</span>) {
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">const</span> index <span class="hljs-keyword">of</span> schema.<span class="hljs-title function_">indexes</span>()) {
    <span class="hljs-keyword">if</span> (index[<span class="hljs-number">1</span>].<span class="hljs-property">unique</span> === <span class="hljs-literal">undefined</span>) {
      index[<span class="hljs-number">1</span>].<span class="hljs-property">unique</span> = <span class="hljs-literal">true</span>;
    }
  }
}
</pre> </div>
<h3 id="Schema.prototype.loadClass()">Schema.prototype.loadClass()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>model</code> <span class="method-type">«Function»</span> The Class to load </li>
<li class="param">
<code>[virtualsOnly]</code> <span class="method-type">«Boolean»</span> if truthy, only pulls virtuals from the class, not methods or statics </li>
</ul>
<div>
<p>Loads an ES6 class into a schema. Maps <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/set">setters</a> + <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/get">getters</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/static">static methods</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes#Class_body_and_method_definitions">instance methods</a> to schema <a href="../guide.html#virtuals">virtuals</a>, <a href="../guide.html#statics">statics</a>, and <a href="../guide.html#methods">methods</a>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> md5 = <span class="hljs-built_in">require</span>(<span class="hljs-string">'md5'</span>);
<span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">email</span>: <span class="hljs-title class_">String</span> });
<span class="hljs-keyword">class</span> <span class="hljs-title class_">UserClass</span> {
  <span class="hljs-comment">// `gravatarImage` becomes a virtual</span>
  <span class="hljs-keyword">get</span> <span class="hljs-title function_">gravatarImage</span>() {
    <span class="hljs-keyword">const</span> hash = <span class="hljs-title function_">md5</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">email</span>.<span class="hljs-title function_">toLowerCase</span>());
    <span class="hljs-keyword">return</span> <span class="hljs-string">`https://www.gravatar.com/avatar/<span class="hljs-subst">${hash}</span>`</span>;
  }

  <span class="hljs-comment">// `getProfileUrl()` becomes a document method</span>
  <span class="hljs-title function_">getProfileUrl</span>() {
    <span class="hljs-keyword">return</span> <span class="hljs-string">`https://mysite.com/<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.email}</span>`</span>;
  }

  <span class="hljs-comment">// `findByEmail()` becomes a static</span>
  <span class="hljs-keyword">static</span> <span class="hljs-title function_">findByEmail</span>(<span class="hljs-params">email</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">findOne</span>({ email });
  }
}

<span class="hljs-comment">// `schema` will now have a `gravatarImage` virtual, a `getProfileUrl()` method,</span>
<span class="hljs-comment">// and a `findByEmail()` static</span>
userSchema.<span class="hljs-title function_">loadClass</span>(<span class="hljs-title class_">UserClass</span>);
</pre> </div>
<h3 id="Schema.prototype.method()">Schema.prototype.method()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>name</code> <span class="method-type">«String|Object»</span> The Method Name for a single function, or a Object of "string-function" pairs. </li>
<li class="param">
<code>[fn]</code> <span class="method-type">«Function»</span> The Function in a single-function definition. </li>
</ul>
<div>
<p>Adds an instance method to documents constructed from Models compiled from this schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = kittySchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>(..);

schema.<span class="hljs-title function_">method</span>(<span class="hljs-string">'meow'</span>, <span class="hljs-keyword">function</span> () {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'meeeeeoooooooooooow'</span>);
})

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Kitty</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Kitty'</span>, schema);

<span class="hljs-keyword">const</span> fizz = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Kitty</span>;
fizz.<span class="hljs-title function_">meow</span>(); <span class="hljs-comment">// meeeeeooooooooooooow</span>
</pre> <p>If a hash of name/fn pairs is passed as the only argument, each name/fn pair will be added as methods.</p> <pre data-language="javascript">schema.<span class="hljs-title function_">method</span>({
    <span class="hljs-attr">purr</span>: <span class="hljs-keyword">function</span> () {}
  , <span class="hljs-attr">scratch</span>: <span class="hljs-keyword">function</span> () {}
});

<span class="hljs-comment">// later</span>
<span class="hljs-keyword">const</span> fizz = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Kitty</span>;
fizz.<span class="hljs-title function_">purr</span>();
fizz.<span class="hljs-title function_">scratch</span>();
</pre> <p>NOTE: <code>Schema.method()</code> adds instance methods to the <code>Schema.methods</code> object. You can also add instance methods directly to the <code>Schema.methods</code> object as seen in the <a href="../guide.html#methods">guide</a></p> </div>
<h3 id="Schema.prototype.obj">Schema.prototype.obj</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The original object passed to the schema constructor</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">a</span>: <span class="hljs-title class_">String</span> }).<span class="hljs-title function_">add</span>({ <span class="hljs-attr">b</span>: <span class="hljs-title class_">String</span> });
schema.<span class="hljs-property">obj</span>; <span class="hljs-comment">// { a: String }</span>
</pre> </div>
<h3 id="Schema.prototype.omit()">Schema.prototype.omit()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>paths</code> <span class="method-type">«Array[String]»</span> List of Paths to omit for the new Schema </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> Options to pass to the new Schema Constructor (same as <code>new Schema(.., Options)</code>). Defaults to <code>this.options</code> if not set. </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> </li></ul>
<div>
<p>Returns a new schema that has the <code>paths</code> from the original schema, minus the omitted ones.</p> <p>This method is analagous to <a href="https://lodash.com/docs/#omit">Lodash's <code>omit()</code> function</a> for Mongoose schemas.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span> });
<span class="hljs-comment">// Creates a new schema omitting the `age` path</span>
<span class="hljs-keyword">const</span> newSchema = schema.<span class="hljs-title function_">omit</span>([<span class="hljs-string">'age'</span>]);

newSchema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// SchemaString { ... }</span>
newSchema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'age'</span>); <span class="hljs-comment">// undefined</span>
</pre> </div>
<h3 id="Schema.prototype.path()">Schema.prototype.path()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String»</span> The name of the Path to get / set </li>
<li class="param">
<code>[obj]</code> <span class="method-type">«Object»</span> The Type to set the path to, if provided the path will be SET, otherwise the path will be GET </li>
</ul>
<div>
<p>Gets/sets schema paths.</p> <p>Sets a path (if arity 2) Gets a path (if arity 1)</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>) <span class="hljs-comment">// returns a SchemaType</span>
schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>, <span class="hljs-title class_">Number</span>) <span class="hljs-comment">// changes the schemaType of `name` to Number</span>
</pre> </div>
<h3 id="Schema.prototype.pathType()">Schema.prototype.pathType()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«String»</span> </li></ul>
<div>
<p>Returns the pathType of <code>path</code> for this schema.</p> <p>Given a path, returns whether it is a real, virtual, nested, or ad-hoc/undefined path.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">nested</span>: { <span class="hljs-attr">foo</span>: <span class="hljs-title class_">String</span> } });
s.<span class="hljs-title function_">virtual</span>(<span class="hljs-string">'foo'</span>).<span class="hljs-title function_">get</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">42</span>);
s.<span class="hljs-title function_">pathType</span>(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// "real"</span>
s.<span class="hljs-title function_">pathType</span>(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// "nested"</span>
s.<span class="hljs-title function_">pathType</span>(<span class="hljs-string">'foo'</span>); <span class="hljs-comment">// "virtual"</span>
s.<span class="hljs-title function_">pathType</span>(<span class="hljs-string">'fail'</span>); <span class="hljs-comment">// "adhocOrUndefined"</span>
</pre> </div>
<h3 id="Schema.prototype.paths">Schema.prototype.paths</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The paths defined on this schema. The keys are the top-level paths in this schema, and the values are instances of the SchemaType class.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> }, { <span class="hljs-attr">_id</span>: <span class="hljs-literal">false</span> });
schema.<span class="hljs-property">paths</span>; <span class="hljs-comment">// { name: SchemaString { ... } }</span>

schema.<span class="hljs-title function_">add</span>({ <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span> });
schema.<span class="hljs-property">paths</span>; <span class="hljs-comment">// { name: SchemaString { ... }, age: SchemaNumber { ... } }</span>
</pre> </div>
<h3 id="Schema.prototype.pick()">Schema.prototype.pick()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>paths</code> <span class="method-type">«Array[String]»</span> List of Paths to pick for the new Schema </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> Options to pass to the new Schema Constructor (same as <code>new Schema(.., Options)</code>). Defaults to <code>this.options</code> if not set. </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> </li></ul>
<div>
<p>Returns a new schema that has the picked <code>paths</code> from this schema.</p> <p>This method is analagous to <a href="https://lodash.com/docs/4.17.15#pick">Lodash's <code>pick()</code> function</a> for Mongoose schemas.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span> });
<span class="hljs-comment">// Creates a new schema with the same `name` path as `schema`,</span>
<span class="hljs-comment">// but no `age` path.</span>
<span class="hljs-keyword">const</span> newSchema = schema.<span class="hljs-title function_">pick</span>([<span class="hljs-string">'name'</span>]);

newSchema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// SchemaString { ... }</span>
newSchema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'age'</span>); <span class="hljs-comment">// undefined</span>
</pre> </div>
<h3 id="Schema.prototype.plugin()">Schema.prototype.plugin()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>plugin</code> <span class="method-type">«Function»</span> The Plugin's callback </li>
<li class="param">
<code>[opts]</code> <span class="method-type">«Object»</span> Options to pass to the plugin </li>
<ul style="margin-top: 0.5em"><li>
<code>[opts.deduplicate=false]</code> <span class="method-type">«Boolean»</span> If true, ignore duplicate plugins (same <code>fn</code> argument using <code>===</code>) </li></ul>
</ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="../plugins.html">plugins</a></span></li></ul>
<div>
<p>Registers a plugin for this schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> });
s.<span class="hljs-title function_">plugin</span>(<span class="hljs-function"><span class="hljs-params">schema</span> =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>).<span class="hljs-property">path</span>));
mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, s); <span class="hljs-comment">// Prints 'name'</span>
</pre> <p>Or with Options:</p> <pre data-language="javascript"><span class="hljs-keyword">const</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> });
s.<span class="hljs-title function_">plugin</span>(<span class="hljs-function">(<span class="hljs-params">schema, opts</span>) =&gt;</span> <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(opts.<span class="hljs-property">text</span>, schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>).<span class="hljs-property">path</span>), { <span class="hljs-attr">text</span>: <span class="hljs-string">"Schema Path Name:"</span> });
mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, s); <span class="hljs-comment">// Prints 'Schema Path Name: name'</span>
</pre> </div>
<h3 id="Schema.prototype.post()">Schema.prototype.post()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>methodName</code> <span class="method-type">«String|RegExp|Array[String]»</span> The method name or regular expression to match method name </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.document]</code> <span class="method-type">«Boolean»</span> If <code>name</code> is a hook for both document and query middleware, set to <code>true</code> to run on document middleware. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.query]</code> <span class="method-type">«Boolean»</span> If <code>name</code> is a hook for both document and query middleware, set to <code>true</code> to run on query middleware. </li></ul>
<li class="param">
<code>fn</code> <span class="method-type">«Function»</span> callback </li>
</ul>
<h5>See:</h5>
<ul>
<li><span class="method-type"><a href="../middleware.html">middleware</a></span></li>
<li><span class="method-type"><a href="https://npmjs.org/package/kareem">kareem</a></span></li>
</ul>
<div>
<p>Defines a post hook for the document</p> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>(..);
schema.<span class="hljs-title function_">post</span>(<span class="hljs-string">'save'</span>, <span class="hljs-keyword">function</span> (<span class="hljs-params">doc</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this fired after a document was saved'</span>);
});

schema.<span class="hljs-title function_">post</span>(<span class="hljs-string">'find'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">docs</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this fired after you ran a find query'</span>);
});

schema.<span class="hljs-title function_">post</span>(<span class="hljs-regexp">/Many$/</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">res</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this fired after you ran `updateMany()` or `deleteMany()`'</span>);
});

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Model</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Model'</span>, schema);

<span class="hljs-keyword">const</span> m = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Model</span>(..);
m.<span class="hljs-title function_">save</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">err</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this fires after the `post` hook'</span>);
});

m.<span class="hljs-title function_">find</span>(<span class="hljs-keyword">function</span>(<span class="hljs-params">err, docs</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">'this fires after the post find hook'</span>);
});
</pre> </div>
<h3 id="Schema.prototype.pre()">Schema.prototype.pre()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>methodName</code> <span class="method-type">«String|RegExp|Array[String]»</span> The method name or regular expression to match method name </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.document]</code> <span class="method-type">«Boolean»</span> If <code>name</code> is a hook for both document and query middleware, set to <code>true</code> to run on document middleware. For example, set <code>options.document</code> to <code>true</code> to apply this hook to <code>Document#deleteOne()</code> rather than <code>Query#deleteOne()</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.query]</code> <span class="method-type">«Boolean»</span> If <code>name</code> is a hook for both document and query middleware, set to <code>true</code> to run on query middleware. </li></ul>
<li class="param">
<code>callback</code> <span class="method-type">«Function»</span> </li>
</ul>
<div>
<p>Defines a pre hook for the model.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> toySchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">created</span>: <span class="hljs-title class_">Date</span> });

toySchema.<span class="hljs-title function_">pre</span>(<span class="hljs-string">'save'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>) {
  <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">created</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">created</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Date</span>;
  <span class="hljs-title function_">next</span>();
});

toySchema.<span class="hljs-title function_">pre</span>(<span class="hljs-string">'validate'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>) {
  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> !== <span class="hljs-string">'Woody'</span>) <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'Woody'</span>;
  <span class="hljs-title function_">next</span>();
});

<span class="hljs-comment">// Equivalent to calling `pre()` on `find`, `findOne`, `findOneAndUpdate`.</span>
toySchema.<span class="hljs-title function_">pre</span>(<span class="hljs-regexp">/^find/</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFilter</span>());
});

<span class="hljs-comment">// Equivalent to calling `pre()` on `updateOne`, `findOneAndUpdate`.</span>
toySchema.<span class="hljs-title function_">pre</span>([<span class="hljs-string">'updateOne'</span>, <span class="hljs-string">'findOneAndUpdate'</span>], <span class="hljs-keyword">function</span>(<span class="hljs-params">next</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getFilter</span>());
});

toySchema.<span class="hljs-title function_">pre</span>(<span class="hljs-string">'deleteOne'</span>, <span class="hljs-keyword">function</span>() {
  <span class="hljs-comment">// Runs when you call `Toy.deleteOne()`</span>
});

toySchema.<span class="hljs-title function_">pre</span>(<span class="hljs-string">'deleteOne'</span>, { <span class="hljs-attr">document</span>: <span class="hljs-literal">true</span> }, <span class="hljs-keyword">function</span>() {
  <span class="hljs-comment">// Runs when you call `doc.deleteOne()`</span>
});
</pre> </div>
<h3 id="Schema.prototype.queue()">Schema.prototype.queue()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>name</code> <span class="method-type">«String»</span> name of the document method to call later </li>
<li class="param">
<code>args</code> <span class="method-type">«Array»</span> arguments to pass to the method </li>
</ul>
<div>
<p>Adds a method call to the queue.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">schema.<span class="hljs-property">methods</span>.<span class="hljs-property">print</span> = <span class="hljs-keyword">function</span>() { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>); };
schema.<span class="hljs-title function_">queue</span>(<span class="hljs-string">'print'</span>, []); <span class="hljs-comment">// Print the doc every one is instantiated</span>

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Model</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">new</span> <span class="hljs-title class_">Model</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'test'</span> }); <span class="hljs-comment">// Prints '{"_id": ..., "name": "test" }'</span>
</pre> </div>
<h3 id="Schema.prototype.remove()">Schema.prototype.remove()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String|Array»</span> The Path(s) to remove </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the Schema instance</li></ul>
<div>
<p>Removes the given <code>path</code> (or [<code>paths</code>]).</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span> });
schema.<span class="hljs-title function_">remove</span>(<span class="hljs-string">'name'</span>);
schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// Undefined</span>
schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'age'</span>); <span class="hljs-comment">// SchemaNumber { ... }</span>
</pre> <p>Or as a Array:</p> <pre data-language="javascript">schema.<span class="hljs-title function_">remove</span>([<span class="hljs-string">'name'</span>, <span class="hljs-string">'age'</span>]);
schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// Undefined</span>
schema.<span class="hljs-title function_">path</span>(<span class="hljs-string">'age'</span>); <span class="hljs-comment">// Undefined</span>
</pre> </div>
<h3 id="Schema.prototype.removeIndex()">Schema.prototype.removeIndex()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>index</code> <span class="method-type">«Object|string»</span> name or index specification </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Schema»</span> the Schema instance</li></ul>
<div>
<p>Remove an index by name or index specification.</p> <p>removeIndex only removes indexes from your schema object. Does <strong>not</strong> affect the indexes in MongoDB.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">ToySchema</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">color</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">price</span>: <span class="hljs-title class_">Number</span> });

<span class="hljs-comment">// Add a new index on { name, color }</span>
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">index</span>({ <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-number">1</span> });

<span class="hljs-comment">// Remove index on { name, color }</span>
<span class="hljs-comment">// Keep in mind that order matters! `removeIndex({ color: 1, name: 1 })` won't remove the index</span>
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">removeIndex</span>({ <span class="hljs-attr">name</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">color</span>: <span class="hljs-number">1</span> });

<span class="hljs-comment">// Add an index with a custom name</span>
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">index</span>({ <span class="hljs-attr">color</span>: <span class="hljs-number">1</span> }, { <span class="hljs-attr">name</span>: <span class="hljs-string">'my custom index name'</span> });
<span class="hljs-comment">// Remove index by name</span>
<span class="hljs-title class_">ToySchema</span>.<span class="hljs-title function_">removeIndex</span>(<span class="hljs-string">'my custom index name'</span>);
</pre> </div>
<h3 id="Schema.prototype.removeVirtual()">Schema.prototype.removeVirtual()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String|Array»</span> The virutal path(s) to remove. </li></ul>
<div>
<p>Removes the given virtual or virtuals from the schema.</p> </div>
<h3 id="Schema.prototype.requiredPaths()">Schema.prototype.requiredPaths()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>invalidate</code> <span class="method-type">«Boolean»</span> Refresh the cache </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array»</span> </li></ul>
<div>
<p>Returns an Array of path strings that are required by this schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> s = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({
  <span class="hljs-attr">name</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">age</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">notes</span>: <span class="hljs-title class_">String</span>
});
s.requiredPaths(); <span class="hljs-comment">// [ 'age', 'name' ]</span>
</pre> </div>
<h3 id="Schema.prototype.set()">Schema.prototype.set()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>key</code> <span class="method-type">«String»</span> The name of the option to set the value to </li>
<li class="param">
<code>[value]</code> <span class="method-type">«Object»</span> The value to set the option to, if not passed, the option will be reset to default </li>
<li class="param">
<code>[tags]</code> <span class="method-type">«Array&lt;string&gt;»</span> tags to add to read preference if key === 'read' </li>
</ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="#Schema()">Schema</a></span></li></ul>
<div>
<p>Sets a schema option.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">schema.<span class="hljs-title function_">set</span>(<span class="hljs-string">'strict'</span>); <span class="hljs-comment">// 'true' by default</span>
schema.<span class="hljs-title function_">set</span>(<span class="hljs-string">'strict'</span>, <span class="hljs-literal">false</span>); <span class="hljs-comment">// Sets 'strict' to false</span>
schema.<span class="hljs-title function_">set</span>(<span class="hljs-string">'strict'</span>); <span class="hljs-comment">// 'false'</span>
</pre> </div>
<h3 id="Schema.prototype.static()">Schema.prototype.static()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>name</code> <span class="method-type">«String|Object»</span> The Method Name for a single function, or a Object of "string-function" pairs. </li>
<li class="param">
<code>[fn]</code> <span class="method-type">«Function»</span> The Function in a single-function definition. </li>
</ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="../guide.html#statics">Statics</a></span></li></ul>
<div>
<p>Adds static "class" methods to Models compiled from this schema.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>(..);
<span class="hljs-comment">// Equivalent to `schema.statics.findByName = function(name) {}`;</span>
schema.<span class="hljs-title function_">static</span>(<span class="hljs-string">'findByName'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params">name</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">find</span>({ <span class="hljs-attr">name</span>: name });
});

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Drink</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Drink'</span>, schema);
<span class="hljs-keyword">await</span> <span class="hljs-title class_">Drink</span>.<span class="hljs-title function_">findByName</span>(<span class="hljs-string">'LaCroix'</span>);
</pre> <p>If a hash of name/fn pairs is passed as the only argument, each name/fn pair will be added as methods.</p> <pre data-language="javascript">schema.<span class="hljs-title function_">static</span>({
    <span class="hljs-attr">findByName</span>: <span class="hljs-keyword">function</span> () {..}
  , <span class="hljs-attr">findByCost</span>: <span class="hljs-keyword">function</span> () {..}
});

<span class="hljs-keyword">const</span> <span class="hljs-title class_">Drink</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Drink'</span>, schema);
<span class="hljs-keyword">await</span> <span class="hljs-title class_">Drink</span>.<span class="hljs-title function_">findByName</span>(<span class="hljs-string">'LaCroix'</span>);
<span class="hljs-keyword">await</span> <span class="hljs-title class_">Drink</span>.<span class="hljs-title function_">findByCost</span>(<span class="hljs-number">3</span>);
</pre> <p>If a hash of name/fn pairs is passed as the only argument, each name/fn pair will be added as statics.</p> </div>
<h3 id="Schema.prototype.virtual()">Schema.prototype.virtual()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>name</code> <span class="method-type">«String»</span> The name of the Virtual </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.ref]</code> <span class="method-type">«String|Model»</span> model name or model instance. Marks this as a <a href="../populate.html#populate-virtuals">populate virtual</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.localField]</code> <span class="method-type">«String|Function»</span> Required for populate virtuals. See <a href="../populate.html#populate-virtuals">populate virtual docs</a> for more information. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.foreignField]</code> <span class="method-type">«String|Function»</span> Required for populate virtuals. See <a href="../populate.html#populate-virtuals">populate virtual docs</a> for more information. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.justOne=false]</code> <span class="method-type">«Boolean|Function»</span> Only works with populate virtuals. If <a href="https://masteringjs.io/tutorials/fundamentals/truthy">truthy</a>, will be a single doc or <code>null</code>. Otherwise, the populate virtual will be an array. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.count=false]</code> <span class="method-type">«Boolean»</span> Only works with populate virtuals. If <a href="https://masteringjs.io/tutorials/fundamentals/truthy">truthy</a>, this populate virtual will contain the number of documents rather than the documents themselves when you <code>populate()</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.get=null]</code> <span class="method-type">«Function|null»</span> Adds a <a href="../tutorials/getters-setters.html">getter</a> to this virtual to transform the populated doc. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.match=null]</code> <span class="method-type">«Object|Function»</span> Apply a default <a href="../populate.html#match"><code>match</code> option to populate</a>, adding an additional filter to the populate query. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«VirtualType»</span> </li></ul>
<div>
<p>Creates a virtual type with the given name.</p> </div>
<h3 id="Schema.prototype.virtualpath()">Schema.prototype.virtualpath()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>name</code> <span class="method-type">«String»</span> The name of the Virtual to get </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«VirtualType,null»</span> </li></ul>
<div>
<p>Returns the virtual type with the given <code>name</code>.</p> </div>
<h3 id="Schema.prototype.virtuals">Schema.prototype.virtuals</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Object containing all virtuals defined on this schema. The objects' keys are the virtual paths and values are instances of <code>VirtualType</code>.</p> <p>This property is typically only useful for plugin authors and advanced users. You do not need to interact with this property at all to use mongoose.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({});
schema.<span class="hljs-title function_">virtual</span>(<span class="hljs-string">'answer'</span>).<span class="hljs-title function_">get</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-number">42</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(schema.<span class="hljs-property">virtuals</span>); <span class="hljs-comment">// { answer: VirtualType { path: 'answer', ... } }</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(schema.<span class="hljs-property">virtuals</span>[<span class="hljs-string">'answer'</span>].<span class="hljs-property">getters</span>[<span class="hljs-number">0</span>].<span class="hljs-title function_">call</span>()); <span class="hljs-comment">// 42</span>
</pre> </div>
<h3 id="Schema.reserved">Schema.reserved</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Reserved document keys.</p> <p>Keys in this object are names that are warned in schema declarations because they have the potential to break Mongoose/ Mongoose plugins functionality. If you create a schema using <code>new Schema()</code> with one of these property names, Mongoose will log a warning.</p> <ul> <li>_posts</li> <li>_pres</li> <li>collection</li> <li>emit</li> <li>errors</li> <li>get</li> <li>init</li> <li>isModified</li> <li>isNew</li> <li>listeners</li> <li>modelName</li> <li>on</li> <li>once</li> <li>populated</li> <li>prototype</li> <li>remove</li> <li>removeListener</li> <li>save</li> <li>schema</li> <li>toObject</li> <li>validate</li> </ul> <p><em>NOTE:</em> Use of these terms as method names is permitted, but play at your own risk, as they may be existing mongoose document methods you are stomping on.</p> <pre data-language="javascript"> <span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>(..);
 schema.<span class="hljs-property">methods</span>.<span class="hljs-property">init</span> = <span class="hljs-keyword">function</span> () {} <span class="hljs-comment">// potentially breaking</span>
</pre> </div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010 LearnBoost<br>Licensed under the MIT License.<br>
    <a href="https://mongoosejs.com/docs/api/schema.html" class="_attribution-link">https://mongoosejs.com/docs/api/schema.html</a>
  </p>
</div>
