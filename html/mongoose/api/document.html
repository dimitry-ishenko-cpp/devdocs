<h1>Document</h1>

<div class="api-content">
<h3 id="Document.prototype.$assertPopulated()">Document.prototype.$assertPopulated()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String|Array[String]»</span> path or array of paths to check. <code>$assertPopulated</code> throws if any of the given paths is not populated. </li>
<li class="param">
<code>[values]</code> <span class="method-type">«Object»</span> optional values to <code>$set()</code>. Convenient if you want to manually populate a path and assert that the path was populated in 1 call. </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this</li></ul>
<div>
<p>Throws an error if a given path is not populated</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Model</span>.<span class="hljs-title function_">findOne</span>().<span class="hljs-title function_">populate</span>(<span class="hljs-string">'author'</span>);

doc.$assertPopulated(<span class="hljs-string">'author'</span>); <span class="hljs-comment">// does not throw</span>
doc.$assertPopulated(<span class="hljs-string">'other path'</span>); <span class="hljs-comment">// throws an error</span>

<span class="hljs-comment">// Manually populate and assert in one call. The following does</span>
<span class="hljs-comment">// `doc.$set({ likes })` before asserting.</span>
doc.$assertPopulated(<span class="hljs-string">'likes'</span>, { likes });
</pre> </div>
<h3 id="Document.prototype.$clone()">Document.prototype.$clone()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> a copy of this document</li></ul>
<div>
<p>Returns a copy of this document with a deep clone of <code>_doc</code> and <code>$__</code>.</p> </div>
<h3 id="Document.prototype.$errors">Document.prototype.$errors</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Hash containing current validation $errors.</p> </div>
<h3 id="Document.prototype.$getAllSubdocs()">Document.prototype.$getAllSubdocs()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array»</span> </li></ul>
<div>
<p>Get all subdocs (by bfs)</p> </div>
<h3 id="Document.prototype.$getPopulatedDocs()">Document.prototype.$getPopulatedDocs()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array[Document]»</span> array of populated documents. Empty array if there are no populated documents associated with this document.</li></ul>
<div>
<p>Gets all populated documents associated with this document.</p> </div>
<h3 id="Document.prototype.$ignore()">Document.prototype.$ignore()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String»</span> the path to ignore </li></ul>
<div>
<p>Don't run validation on this path or persist changes to this path.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">doc.<span class="hljs-property">foo</span> = <span class="hljs-literal">null</span>;
doc.$ignore(<span class="hljs-string">'foo'</span>);
doc.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// changes to foo will not be persisted and validators won't be run</span>
</pre> </div>
<h3 id="Document.prototype.$inc()">Document.prototype.$inc()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String|Array»</span> path or paths to update </li>
<li class="param">
<code>val</code> <span class="method-type">«Number»</span> increment <code>path</code> by this value </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this</li></ul>
<div>
<p>Increments the numeric value at <code>path</code> by the given <code>val</code>. When you call <code>save()</code> on this document, Mongoose will send a <a href="https://www.mongodb.com/docs/manual/reference/operator/update/inc/"><code>$inc</code></a> as opposed to a <code>$set</code>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">counter</span>: <span class="hljs-title class_">Number</span> });
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Test</span> = db.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, schema);

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Test</span>.<span class="hljs-title function_">create</span>({ <span class="hljs-attr">counter</span>: <span class="hljs-number">0</span> });
doc.$inc(<span class="hljs-string">'counter'</span>, <span class="hljs-number">2</span>);
<span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// Sends a `{ $inc: { counter: 2 } }` to MongoDB</span>
doc.<span class="hljs-property">counter</span>; <span class="hljs-comment">// 2</span>

doc.<span class="hljs-property">counter</span> += <span class="hljs-number">2</span>;
<span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// Sends a `{ $set: { counter: 2 } }` to MongoDB</span>
</pre> </div>
<h3 id="Document.prototype.$init()">Document.prototype.$init()</h3>
<div>
<p>Alias for <a href="#Document.prototype.init()"><code>.init</code></a></p> </div>
<h3 id="Document.prototype.$isDefault()">Document.prototype.$isDefault()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[path]</code> <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if a path is set to its default.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-title class_">MyModel</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'test'</span>, { <span class="hljs-attr">name</span>: { <span class="hljs-attr">type</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">default</span>: <span class="hljs-string">'Val '</span>} });
<span class="hljs-keyword">const</span> m = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyModel</span>();
m.$isDefault(<span class="hljs-string">'name'</span>); <span class="hljs-comment">// true</span>
</pre> </div>
<h3 id="Document.prototype.$isDeleted()">Document.prototype.$isDeleted()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[val]</code> <span class="method-type">«Boolean»</span> optional, overrides whether mongoose thinks the doc is deleted </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean,Document»</span> whether mongoose thinks this doc is deleted.</li></ul>
<div>
<p>Getter/setter, determines whether the document was removed or not.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> product = <span class="hljs-keyword">await</span> product.<span class="hljs-title function_">remove</span>();
product.$isDeleted(); <span class="hljs-comment">// true</span>
product.<span class="hljs-title function_">remove</span>(); <span class="hljs-comment">// no-op, doesn't send anything to the db</span>

product.$isDeleted(<span class="hljs-literal">false</span>);
product.$isDeleted(); <span class="hljs-comment">// false</span>
product.<span class="hljs-title function_">remove</span>(); <span class="hljs-comment">// will execute a remove against the db</span>
</pre> </div>
<h3 id="Document.prototype.$isEmpty()">Document.prototype.$isEmpty()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[path]</code> <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if the given path is nullish or only contains empty objects. Useful for determining whether this subdoc will get stripped out by the <a href="../guide.html#minimize">minimize option</a>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">nested</span>: { <span class="hljs-attr">foo</span>: <span class="hljs-title class_">String</span> } });
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Model</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Model</span>({});
doc.$isEmpty(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// true</span>
doc.<span class="hljs-property">nested</span>.$isEmpty(); <span class="hljs-comment">// true</span>

doc.<span class="hljs-property">nested</span>.<span class="hljs-property">foo</span> = <span class="hljs-string">'bar'</span>;
doc.$isEmpty(<span class="hljs-string">'nested'</span>); <span class="hljs-comment">// false</span>
doc.<span class="hljs-property">nested</span>.$isEmpty(); <span class="hljs-comment">// false</span>
</pre> </div>
<h3 id="Document.prototype.$isModified()">Document.prototype.$isModified()</h3>
<div>
<p>Alias of <a href="#Document.prototype.isModified()"><code>.isModified</code></a></p> </div>
<h3 id="Document.prototype.$isNew">Document.prototype.$isNew</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Boolean flag specifying if the document is new. If you create a document using <code>new</code>, this document will be considered "new". <code>$isNew</code> is how Mongoose determines whether <code>save()</code> should use <code>insertOne()</code> to create a new document or <code>updateOne()</code> to update an existing document.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> user = <span class="hljs-keyword">new</span> <span class="hljs-title class_">User</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John Smith'</span> });
user.<span class="hljs-property">$isNew</span>; <span class="hljs-comment">// true</span>

<span class="hljs-keyword">await</span> user.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// Sends an `insertOne` to MongoDB</span>
</pre> <p>On the other hand, if you load an existing document from the database using <code>findOne()</code> or another <a href="../queries.html">query operation</a>, <code>$isNew</code> will be false.</p> <h4 id="example-1"> <a href="#example-1"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">findOne</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John Smith'</span> });
user.<span class="hljs-property">$isNew</span>; <span class="hljs-comment">// false</span>
</pre> <p>Mongoose sets <code>$isNew</code> to <code>false</code> immediately after <code>save()</code> succeeds. That means Mongoose sets <code>$isNew</code> to false <strong>before</strong> <code>post('save')</code> hooks run. In <code>post('save')</code> hooks, <code>$isNew</code> will be <code>false</code> if <code>save()</code> succeeded.</p> <h4 id="example-2"> <a href="#example-2"> Example: </a> </h4> <pre data-language="javascript">userSchema.<span class="hljs-title function_">post</span>(<span class="hljs-string">'save'</span>, <span class="hljs-keyword">function</span>() {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">$isNew</span>; <span class="hljs-comment">// false</span>
});
<span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">create</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John Smith'</span> });
</pre> <p>For subdocuments, <code>$isNew</code> is true if either the parent has <code>$isNew</code> set, or if you create a new subdocument.</p> <h4 id="example-3"> <a href="#example-3"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-comment">// Assume `Group` has a document array `users`</span>
<span class="hljs-keyword">const</span> group = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Group</span>.<span class="hljs-title function_">findOne</span>();
group.<span class="hljs-property">users</span>[<span class="hljs-number">0</span>].<span class="hljs-property">$isNew</span>; <span class="hljs-comment">// false</span>

group.<span class="hljs-property">users</span>.<span class="hljs-title function_">push</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John Smith'</span> });
group.<span class="hljs-property">users</span>[<span class="hljs-number">1</span>].<span class="hljs-property">$isNew</span>; <span class="hljs-comment">// true</span>
</pre> </div>
<h3 id="Document.prototype.$locals">Document.prototype.$locals</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Empty object that you can use for storing properties on the document. This is handy for passing data to middleware without conflicting with Mongoose internals.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">schema.<span class="hljs-title function_">pre</span>(<span class="hljs-string">'save'</span>, <span class="hljs-keyword">function</span>() {
  <span class="hljs-comment">// Mongoose will set `isNew` to `false` if `save()` succeeds</span>
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">$locals</span>.<span class="hljs-property">wasNew</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">isNew</span>;
});

schema.<span class="hljs-title function_">post</span>(<span class="hljs-string">'save'</span>, <span class="hljs-keyword">function</span>() {
  <span class="hljs-comment">// Prints true if `isNew` was set before `save()`</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">$locals</span>.<span class="hljs-property">wasNew</span>);
});
</pre> </div>
<h3 id="Document.prototype.$markValid()">Document.prototype.$markValid()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String»</span> the field to mark as valid </li></ul>
<div>
<p>Marks a path as valid, removing existing validation errors.</p> </div>
<h3 id="Document.prototype.$op">Document.prototype.$op</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>A string containing the current operation that Mongoose is executing on this document. May be <code>null</code>, <code>'save'</code>, <code>'validate'</code>, or <code>'remove'</code>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Model</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'test'</span> });
doc.<span class="hljs-property">$op</span>; <span class="hljs-comment">// null</span>

<span class="hljs-keyword">const</span> promise = doc.<span class="hljs-title function_">save</span>();
doc.<span class="hljs-property">$op</span>; <span class="hljs-comment">// 'save'</span>

<span class="hljs-keyword">await</span> promise;
doc.<span class="hljs-property">$op</span>; <span class="hljs-comment">// null</span>
</pre> </div>
<h3 id="Document.prototype.$parent()">Document.prototype.$parent()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> </li></ul>
<div>
<p>Alias for <a href="#Document.prototype.parent()"><code>parent()</code></a>. If this document is a subdocument or populated document, returns the document's parent. Returns <code>undefined</code> otherwise.</p> </div>
<h3 id="Document.prototype.$populated()">Document.prototype.$populated()</h3>
<div>
<p>Alias of <a href="#Document.prototype.populated()"><code>.populated</code></a>.</p> </div>
<h3 id="Document.prototype.$session()">Document.prototype.$session()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[session]</code> <span class="method-type">«ClientSession»</span> overwrite the current session </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«ClientSession»</span> </li></ul>
<div>
<p>Getter/setter around the session associated with this document. Used to automatically set <code>session</code> if you <code>save()</code> a doc that you got from a query with an associated session.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> session = <span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">startSession</span>();
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">MyModel</span>.<span class="hljs-title function_">findOne</span>().<span class="hljs-title function_">session</span>(session);
doc.$session() === session; <span class="hljs-comment">// true</span>
doc.$session(<span class="hljs-literal">null</span>);
doc.$session() === <span class="hljs-literal">null</span>; <span class="hljs-comment">// true</span>
</pre> <p>If this is a top-level document, setting the session propagates to all child docs.</p> </div>
<h3 id="Document.prototype.$set()">Document.prototype.$set()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String|Object»</span> path or object of key/vals to set </li>
<li class="param">
<code>val</code> <span class="method-type">«Any»</span> the value to set </li>
<li class="param">
<code>[type]</code> <span class="method-type">«Schema|String|Number|Buffer|[object Object]»</span> optionally specify a type for "on-the-fly" attributes </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> optionally specify options that modify the behavior of the set </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.merge=false]</code> <span class="method-type">«Boolean»</span> if true, setting a <a href="../subdocs.html#subdocuments-versus-nested-paths">nested path</a> will merge existing values rather than overwrite the whole object. So <code>doc.set('nested', { a: 1, b: 2 })</code> becomes <code>doc.set('nested.a', 1); doc.set('nested.b', 2);</code> </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this</li></ul>
<div>
<p>Alias for <code>set()</code>, used internally to avoid conflicts</p> </div>
<h3 id="Document.prototype.$timestamps()">Document.prototype.$timestamps()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[value]</code> <span class="method-type">«Boolean»</span> overwrite the current session </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document,boolean,undefined,void»</span> When used as a getter (no argument), a boolean will be returned indicating the timestamps option state or if unset "undefined" will be used, otherwise will return "this"</li></ul>
<div>
<p>Getter/setter around whether this document will apply timestamps by default when using <code>save()</code> and <code>bulkSave()</code>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> <span class="hljs-title class_">TestModel</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> }, { <span class="hljs-attr">timestamps</span>: <span class="hljs-literal">true</span> }));
<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestModel</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'John Smith'</span> });

doc.$timestamps(); <span class="hljs-comment">// true</span>

doc.$timestamps(<span class="hljs-literal">false</span>);
<span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// Does **not** apply timestamps</span>
</pre> </div>
<h3 id="Document.prototype.$validate()">Document.prototype.$validate()</h3>
<div>
<p>Alias of <a href="#Document.prototype.validate()"><code>.validate</code></a></p> </div>
<h3 id="Document.prototype.$where">Document.prototype.$where</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Set this property to add additional query filters when Mongoose saves this document and <code>isNew</code> is false.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-comment">// Make sure `save()` never updates a soft deleted document.</span>
schema.<span class="hljs-title function_">pre</span>(<span class="hljs-string">'save'</span>, <span class="hljs-keyword">function</span>() {
  <span class="hljs-variable language_">this</span>.<span class="hljs-property">$where</span> = { <span class="hljs-attr">isDeleted</span>: <span class="hljs-literal">false</span> };
});
</pre> </div>
<h3 id="Document.prototype.depopulate()">Document.prototype.depopulate()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[path]</code> <span class="method-type">«String|Array[String]»</span> Specific Path to depopulate. If unset, will depopulate all paths on the Document. Or multiple space-delimited paths. </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this</li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="#Document.prototype.populate()">Document.populate</a></span></li></ul>
<div>
<p>Takes a populated field and returns it to its unpopulated state.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-title class_">Model</span>.<span class="hljs-title function_">findOne</span>().<span class="hljs-title function_">populate</span>(<span class="hljs-string">'author'</span>).<span class="hljs-title function_">exec</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc.<span class="hljs-property">author</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// Dr.Seuss</span>
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc.<span class="hljs-title function_">depopulate</span>(<span class="hljs-string">'author'</span>));
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc.<span class="hljs-property">author</span>); <span class="hljs-comment">// '5144cf8050f071d979c118a7'</span>
})
</pre> <p>If the path was not provided, then all populated fields are returned to their unpopulated state.</p> </div>
<h3 id="Document.prototype.directModifiedPaths()">Document.prototype.directModifiedPaths()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array[String]»</span> </li></ul>
<div>
<p>Returns the list of paths that have been directly modified. A direct modified path is a path that you explicitly set, whether via <code>doc.foo = 'bar'</code>, <code>Object.assign(doc, { foo: 'bar' })</code>, or <code>doc.set('foo', 'bar')</code>.</p> <p>A path <code>a</code> may be in <code>modifiedPaths()</code> but not in <code>directModifiedPaths()</code> because a child of <code>a</code> was directly modified.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> schema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">foo</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">nested</span>: { <span class="hljs-attr">bar</span>: <span class="hljs-title class_">String</span> } });
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Model</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Test'</span>, schema);
<span class="hljs-keyword">await</span> <span class="hljs-title class_">Model</span>.<span class="hljs-title function_">create</span>({ <span class="hljs-attr">foo</span>: <span class="hljs-string">'original'</span>, <span class="hljs-attr">nested</span>: { <span class="hljs-attr">bar</span>: <span class="hljs-string">'original'</span> } });

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Model</span>.<span class="hljs-title function_">findOne</span>();
doc.<span class="hljs-property">nested</span>.<span class="hljs-property">bar</span> = <span class="hljs-string">'modified'</span>;
doc.<span class="hljs-title function_">directModifiedPaths</span>(); <span class="hljs-comment">// ['nested.bar']</span>
doc.<span class="hljs-title function_">modifiedPaths</span>(); <span class="hljs-comment">// ['nested', 'nested.bar']</span>
</pre> </div>
<h3 id="Document.prototype.equals()">Document.prototype.equals()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[doc]</code> <span class="method-type">«Document»</span> a document to compare. If falsy, will always return "false". </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if this document is equal to another document.</p> <p>Documents are considered equal when they have matching <code>_id</code>s, unless neither document has an <code>_id</code>, in which case this function falls back to using <code>deepEqual()</code>.</p> </div>
<h3 id="Document.prototype.errors">Document.prototype.errors</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>Hash containing current validation errors.</p> </div>
<h3 id="Document.prototype.get()">Document.prototype.get()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String»</span> </li>
<li class="param">
<code>[type]</code> <span class="method-type">«Schema|String|Number|Buffer|[object Object]»</span> optionally specify a type for on-the-fly attributes </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.virtuals=false]</code> <span class="method-type">«Boolean»</span> Apply virtuals before getting this path </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.getters=true]</code> <span class="method-type">«Boolean»</span> If false, skip applying getters and just get the raw value </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Any»</span> </li></ul>
<div>
<p>Returns the value of a path.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-comment">// path</span>
doc.<span class="hljs-title function_">get</span>(<span class="hljs-string">'age'</span>) <span class="hljs-comment">// 47</span>

<span class="hljs-comment">// dynamic casting to a string</span>
doc.<span class="hljs-title function_">get</span>(<span class="hljs-string">'age'</span>, <span class="hljs-title class_">String</span>) <span class="hljs-comment">// "47"</span>
</pre> </div>
<h3 id="Document.prototype.getChanges()">Document.prototype.getChanges()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Object»</span> </li></ul>
<div>
<p>Returns the changes that happened to the document in the format that will be sent to MongoDB.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> userSchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-title class_">Number</span>,
  <span class="hljs-attr">country</span>: <span class="hljs-title class_">String</span>
});
<span class="hljs-keyword">const</span> <span class="hljs-title class_">User</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'User'</span>, userSchema);
<span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-title class_">User</span>.<span class="hljs-title function_">create</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Hafez'</span>,
  <span class="hljs-attr">age</span>: <span class="hljs-number">25</span>,
  <span class="hljs-attr">country</span>: <span class="hljs-string">'Egypt'</span>
});

<span class="hljs-comment">// returns an empty object, no changes happened yet</span>
user.<span class="hljs-title function_">getChanges</span>(); <span class="hljs-comment">// { }</span>

user.<span class="hljs-property">country</span> = <span class="hljs-literal">undefined</span>;
user.<span class="hljs-property">age</span> = <span class="hljs-number">26</span>;

user.<span class="hljs-title function_">getChanges</span>(); <span class="hljs-comment">// { $set: { age: 26 }, { $unset: { country: 1 } } }</span>

<span class="hljs-keyword">await</span> user.<span class="hljs-title function_">save</span>();

user.<span class="hljs-title function_">getChanges</span>(); <span class="hljs-comment">// { }</span>
</pre> <p>Modifying the object that <code>getChanges()</code> returns does not affect the document's change tracking state. Even if you <code>delete user.getChanges().$set</code>, Mongoose will still send a <code>$set</code> to the server.</p> </div>
<h3 id="Document.prototype.id">Document.prototype.id</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="../guide.html#options">Schema options</a></span></li></ul>
<div>
<p>The string version of this documents _id.</p> <h4 id="note"> <a href="#note"> Note: </a> </h4> <p>This getter exists on all documents by default. The getter can be disabled by setting the <code>id</code> <a href="../guide.html#id">option</a> of its <code>Schema</code> to false at construction time.</p> <pre data-language="javascript"><span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span> }, { <span class="hljs-attr">id</span>: <span class="hljs-literal">false</span> });
</pre> </div>
<h3 id="Document.prototype.init()">Document.prototype.init()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>doc</code> <span class="method-type">«Object»</span> document returned by mongo </li>
<li class="param">
<code>[opts]</code> <span class="method-type">«Object»</span> </li>
<li class="param">
<code>[fn]</code> <span class="method-type">«Function»</span> </li>
</ul>
<div>
<p>Initializes the document without setters or marking anything modified.</p> <p>Called internally after a document is returned from mongodb. Normally, you do <strong>not</strong> need to call this function on your own.</p> <p>This function triggers <code>init</code> <a href="../middleware.html">middleware</a>. Note that <code>init</code> hooks are <a href="../middleware.html#synchronous">synchronous</a>.</p> </div>
<h3 id="Document.prototype.inspect()">Document.prototype.inspect()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«String»</span> </li></ul>
<div>
<p>Helper for console.log</p> </div>
<h3 id="Document.prototype.invalidate()">Document.prototype.invalidate()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String»</span> the field to invalidate. For array elements, use the <code>array.i.field</code> syntax, where <code>i</code> is the 0-based index in the array. </li>
<li class="param">
<code>err</code> <span class="method-type">«String|Error»</span> the error which states the reason <code>path</code> was invalid </li>
<li class="param">
<code>val</code> <span class="method-type">«Object|String|Number|any»</span> optional invalid value </li>
<li class="param">
<code>[kind]</code> <span class="method-type">«String»</span> optional <code>kind</code> property for the error </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«ValidationError»</span> the current ValidationError, with all currently invalidated paths</li></ul>
<div>
<p>Marks a path as invalid, causing validation to fail.</p> <p>The <code>errorMsg</code> argument will become the message of the <code>ValidationError</code>.</p> <p>The <code>value</code> argument (if passed) will be available through the <code>ValidationError.value</code> property.</p> <pre data-language="javascript">doc.<span class="hljs-title function_">invalidate</span>(<span class="hljs-string">'size'</span>, <span class="hljs-string">'must be less than 20'</span>, <span class="hljs-number">14</span>);

doc.<span class="hljs-title function_">validate</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err</span>) {
  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(err)
  <span class="hljs-comment">// prints</span>
  { <span class="hljs-attr">message</span>: <span class="hljs-string">'Validation failed'</span>,
    <span class="hljs-attr">name</span>: <span class="hljs-string">'ValidationError'</span>,
    <span class="hljs-attr">errors</span>:
     { <span class="hljs-attr">size</span>:
        { <span class="hljs-attr">message</span>: <span class="hljs-string">'must be less than 20'</span>,
          <span class="hljs-attr">name</span>: <span class="hljs-string">'ValidatorError'</span>,
          <span class="hljs-attr">path</span>: <span class="hljs-string">'size'</span>,
          <span class="hljs-attr">type</span>: <span class="hljs-string">'user defined'</span>,
          <span class="hljs-attr">value</span>: <span class="hljs-number">14</span> } } }
})
</pre> </div>
<h3 id="Document.prototype.isDirectModified()">Document.prototype.isDirectModified()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[path]</code> <span class="method-type">«String|Array[String]»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if <code>path</code> was directly set and modified, else false.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">doc.<span class="hljs-title function_">set</span>(<span class="hljs-string">'documents.0.title'</span>, <span class="hljs-string">'changed'</span>);
doc.<span class="hljs-title function_">isDirectModified</span>(<span class="hljs-string">'documents.0.title'</span>) <span class="hljs-comment">// true</span>
doc.<span class="hljs-title function_">isDirectModified</span>(<span class="hljs-string">'documents'</span>) <span class="hljs-comment">// false</span>
</pre> </div>
<h3 id="Document.prototype.isDirectSelected()">Document.prototype.isDirectSelected()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if <code>path</code> was explicitly selected. If no projection, always returns true.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-title class_">Thing</span>.<span class="hljs-title function_">findOne</span>().<span class="hljs-title function_">select</span>(<span class="hljs-string">'nested.name'</span>).<span class="hljs-title function_">exec</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">err, doc</span>) {
   doc.<span class="hljs-title function_">isDirectSelected</span>(<span class="hljs-string">'nested.name'</span>) <span class="hljs-comment">// true</span>
   doc.<span class="hljs-title function_">isDirectSelected</span>(<span class="hljs-string">'nested.otherName'</span>) <span class="hljs-comment">// false</span>
   doc.<span class="hljs-title function_">isDirectSelected</span>(<span class="hljs-string">'nested'</span>)  <span class="hljs-comment">// false</span>
})
</pre> </div>
<h3 id="Document.prototype.isInit()">Document.prototype.isInit()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[path]</code> <span class="method-type">«String»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if <code>path</code> is in the <code>init</code> state, that is, it was set by <code>Document#init()</code> and not modified since.</p> </div>
<h3 id="Document.prototype.isModified()">Document.prototype.isModified()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>[path]</code> <span class="method-type">«String»</span> optional </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Returns true if any of the given paths is modified, else false. If no arguments, returns <code>true</code> if any path in this document is modified.</p> <p>If <code>path</code> is given, checks if a path or any full path containing <code>path</code> as part of its path chain has been modified.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">doc.<span class="hljs-title function_">set</span>(<span class="hljs-string">'documents.0.title'</span>, <span class="hljs-string">'changed'</span>);
doc.<span class="hljs-title function_">isModified</span>()                      <span class="hljs-comment">// true</span>
doc.<span class="hljs-title function_">isModified</span>(<span class="hljs-string">'documents'</span>)           <span class="hljs-comment">// true</span>
doc.<span class="hljs-title function_">isModified</span>(<span class="hljs-string">'documents.0.title'</span>)   <span class="hljs-comment">// true</span>
doc.<span class="hljs-title function_">isModified</span>(<span class="hljs-string">'documents otherProp'</span>) <span class="hljs-comment">// true</span>
doc.<span class="hljs-title function_">isDirectModified</span>(<span class="hljs-string">'documents'</span>)     <span class="hljs-comment">// false</span>
</pre> </div>
<h3 id="Document.prototype.isNew">Document.prototype.isNew</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="#Document.prototype.$isNew">$isNew</a></span></li></ul>
<div>
<p>Legacy alias for <code>$isNew</code>.</p> </div>
<h3 id="Document.prototype.isSelected()">Document.prototype.isSelected()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String|Array[String]»</span> </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Boolean»</span> </li></ul>
<div>
<p>Checks if <code>path</code> was selected in the source query which initialized this document.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Thing</span>.<span class="hljs-title function_">findOne</span>().<span class="hljs-title function_">select</span>(<span class="hljs-string">'name'</span>);
doc.<span class="hljs-title function_">isSelected</span>(<span class="hljs-string">'name'</span>) <span class="hljs-comment">// true</span>
doc.<span class="hljs-title function_">isSelected</span>(<span class="hljs-string">'age'</span>)  <span class="hljs-comment">// false</span>
</pre> </div>
<h3 id="Document.prototype.markModified()">Document.prototype.markModified()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String»</span> the path to mark modified </li>
<li class="param">
<code>[scope]</code> <span class="method-type">«Document»</span> the scope to run validators with </li>
</ul>
<div>
<p>Marks the path as having pending changes to write to the db.</p> <p><em>Very helpful when using <a href="../schematypes.html#mixed">Mixed</a> types.</em></p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">doc.<span class="hljs-property">mixed</span>.<span class="hljs-property">type</span> = <span class="hljs-string">'changed'</span>;
doc.<span class="hljs-title function_">markModified</span>(<span class="hljs-string">'mixed.type'</span>);
doc.<span class="hljs-title function_">save</span>() <span class="hljs-comment">// changes to mixed.type are now persisted</span>
</pre> </div>
<h3 id="Document.prototype.modifiedPaths()">Document.prototype.modifiedPaths()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.includeChildren=false]</code> <span class="method-type">«Boolean»</span> if true, returns children of modified paths as well. For example, if false, the list of modified paths for <code>doc.colors = { primary: 'blue' };</code> will <strong>not</strong> contain <code>colors.primary</code>. If true, <code>modifiedPaths()</code> will return an array that contains <code>colors.primary</code>. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array[String]»</span> </li></ul>
<div>
<p>Returns the list of paths that have been modified.</p> </div>
<h3 id="Document.prototype.overwrite()">Document.prototype.overwrite()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>obj</code> <span class="method-type">«Object»</span> the object to overwrite this document with </li></ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this</li></ul>
<div>
<p>Overwrite all values in this document with the values of <code>obj</code>, except for immutable properties. Behaves similarly to <code>set()</code>, except for it unsets all properties that aren't in <code>obj</code>.</p> </div>
<h3 id="Document.prototype.parent()">Document.prototype.parent()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> </li></ul>
<div>
<p>If this document is a subdocument or populated document, returns the document's parent. Returns the original document if there is no parent.</p> </div>
<h3 id="Document.prototype.populate()">Document.prototype.populate()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String|Object|Array»</span> either the path to populate or an object specifying all parameters, or either an array of those </li>
<li class="param">
<code>[select]</code> <span class="method-type">«Object|String»</span> Field selection for the population query </li>
<li class="param">
<code>[model]</code> <span class="method-type">«Model»</span> The model you wish to use for population. If not specified, populate will look up the model by the name in the Schema's <code>ref</code> field. </li>
<li class="param">
<code>[match]</code> <span class="method-type">«Object»</span> Conditions for the population query </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> Options for the population query (sort, etc) </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.path=null]</code> <span class="method-type">«String»</span> The path to populate. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.populate=null]</code> <span class="method-type">«string|PopulateOptions»</span> Recursively populate paths in the populated documents. See <a href="../populate.html#deep-populate">deep populate docs</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.retainNullValues=false]</code> <span class="method-type">«boolean»</span> by default, Mongoose removes null and undefined values from populated arrays. Use this option to make <code>populate()</code> retain <code>null</code> and <code>undefined</code> array entries. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.getters=false]</code> <span class="method-type">«boolean»</span> if true, Mongoose will call any getters defined on the <code>localField</code>. By default, Mongoose gets the raw value of <code>localField</code>. For example, you would need to set this option to <code>true</code> if you wanted to <a href="../schematypes.html#schematype-options">add a <code>lowercase</code> getter to your <code>localField</code></a>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.clone=false]</code> <span class="method-type">«boolean»</span> When you do <code>BlogPost.find().populate('author')</code>, blog posts with the same author will share 1 copy of an <code>author</code> doc. Enable this option to make Mongoose clone populated docs before assigning them. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.match=null]</code> <span class="method-type">«Object|Function»</span> Add an additional filter to the populate query. Can be a filter object containing <a href="https://www.mongodb.com/docs/manual/tutorial/query-documents/">MongoDB query syntax</a>, or a function that returns a filter object. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.transform=null]</code> <span class="method-type">«Function»</span> Function that Mongoose will call on every populated document that allows you to transform the populated document. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.options=null]</code> <span class="method-type">«Object»</span> Additional options like <code>limit</code> and <code>lean</code>. </li></ul>
<li class="param">
<code>[callback]</code> <span class="method-type">«Function»</span> Callback </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise,null»</span> Returns a Promise if no <code>callback</code> is given.</li></ul>
<h5>See:</h5>
<ul>
<li><span class="method-type"><a href="../populate.html">population</a></span></li>
<li><span class="method-type"><a href="query.html#Query.prototype.select()">Query#select</a></span></li>
<li><span class="method-type"><a href="model.html#Model.populate()">Model.populate</a></span></li>
</ul>
<div>
<p>Populates paths on an existing document.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-comment">// Given a document, `populate()` lets you pull in referenced docs</span>
<span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">populate</span>([
  <span class="hljs-string">'stories'</span>,
  { <span class="hljs-attr">path</span>: <span class="hljs-string">'fans'</span>, <span class="hljs-attr">sort</span>: { <span class="hljs-attr">name</span>: -<span class="hljs-number">1</span> } }
]);
doc.<span class="hljs-title function_">populated</span>(<span class="hljs-string">'stories'</span>); <span class="hljs-comment">// Array of ObjectIds</span>
doc.<span class="hljs-property">stories</span>[<span class="hljs-number">0</span>].<span class="hljs-property">title</span>; <span class="hljs-comment">// 'Casino Royale'</span>
doc.<span class="hljs-title function_">populated</span>(<span class="hljs-string">'fans'</span>); <span class="hljs-comment">// Array of ObjectIds</span>

<span class="hljs-comment">// If the referenced doc has been deleted, `populate()` will</span>
<span class="hljs-comment">// remove that entry from the array.</span>
<span class="hljs-keyword">await</span> <span class="hljs-title class_">Story</span>.<span class="hljs-title function_">delete</span>({ <span class="hljs-attr">title</span>: <span class="hljs-string">'Casino Royale'</span> });
<span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">populate</span>(<span class="hljs-string">'stories'</span>); <span class="hljs-comment">// Empty array</span>

<span class="hljs-comment">// You can also pass additional query options to `populate()`,</span>
<span class="hljs-comment">// like projections:</span>
<span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">populate</span>(<span class="hljs-string">'fans'</span>, <span class="hljs-string">'-email'</span>);
doc.<span class="hljs-property">fans</span>[<span class="hljs-number">0</span>].<span class="hljs-property">email</span> <span class="hljs-comment">// undefined because of 2nd param `select`</span>
</pre> </div>
<h3 id="Document.prototype.populated()">Document.prototype.populated()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String»</span> </li>
<li class="param">
<code>[val]</code> <span class="method-type">«Any»</span> </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Array,ObjectId,Number,Buffer,String,undefined,void»</span> </li></ul>
<div>
<p>Gets _id(s) used during population of the given <code>path</code>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">await</span> <span class="hljs-title class_">Model</span>.<span class="hljs-title function_">findOne</span>().<span class="hljs-title function_">populate</span>(<span class="hljs-string">'author'</span>);

<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc.<span class="hljs-property">author</span>.<span class="hljs-property">name</span>); <span class="hljs-comment">// Dr.Seuss</span>
<span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(doc.<span class="hljs-title function_">populated</span>(<span class="hljs-string">'author'</span>)); <span class="hljs-comment">// '5144cf8050f071d979c118a7'</span>
</pre> <p>If the path was not populated, returns <code>undefined</code>.</p> </div>
<h3 id="Document.prototype.replaceOne()">Document.prototype.replaceOne()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>doc</code> <span class="method-type">«Object»</span> </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<li class="param">
<code>[callback]</code> <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Query»</span> </li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="model.html#Model.replaceOne()">Model.replaceOne</a></span></li></ul>
<div>
<p>Sends a replaceOne command with this document <code>_id</code> as the query selector.</p> <h4 id="valid-options"> <a href="#valid-options"> Valid options: </a> </h4> <ul> <li>same as in <a href="model.html#Model.replaceOne()">Model.replaceOne</a>
</li> </ul> </div>
<h3 id="Document.prototype.save()">Document.prototype.save()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> options optional options </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.session=null]</code> <span class="method-type">«Session»</span> the <a href="https://www.mongodb.com/docs/manual/reference/server-sessions/">session</a> associated with this save operation. If not specified, defaults to the <a href="#Document.prototype.$session()">document's associated session</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.safe]</code> <span class="method-type">«Object»</span> (DEPRECATED) overrides <a href="../guide.html#safe">schema's safe option</a>. Use the <code>w</code> option instead. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.validateBeforeSave]</code> <span class="method-type">«Boolean»</span> set to false to save without validating. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.validateModifiedOnly=false]</code> <span class="method-type">«Boolean»</span> If <code>true</code>, Mongoose will only validate modified paths, as opposed to modified paths and <code>required</code> paths. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.w]</code> <span class="method-type">«Number|String»</span> set the <a href="https://www.mongodb.com/docs/manual/reference/write-concern/#w-option">write concern</a>. Overrides the <a href="../guide.html#writeConcern">schema-level <code>writeConcern</code> option</a> </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.j]</code> <span class="method-type">«Boolean»</span> set to true for MongoDB to wait until this <code>save()</code> has been <a href="https://www.mongodb.com/docs/manual/reference/write-concern/#j-option">journaled before resolving the returned promise</a>. Overrides the <a href="../guide.html#writeConcern">schema-level <code>writeConcern</code> option</a> </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.wtimeout]</code> <span class="method-type">«Number»</span> sets a <a href="https://www.mongodb.com/docs/manual/reference/write-concern/#wtimeout">timeout for the write concern</a>. Overrides the <a href="../guide.html#writeConcern">schema-level <code>writeConcern</code> option</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.checkKeys=true]</code> <span class="method-type">«Boolean»</span> the MongoDB driver prevents you from saving keys that start with '$' or contain '.' by default. Set this option to <code>false</code> to skip that check. See <a href="https://www.mongodb.com/docs/manual/reference/limits/#Restrictions-on-Field-Names">restrictions on field names</a> </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.timestamps=true]</code> <span class="method-type">«Boolean»</span> if <code>false</code> and <a href="../guide.html#timestamps">timestamps</a> are enabled, skip timestamps for this <code>save()</code>. </li></ul>
<li class="param">
<code>[fn]</code> <span class="method-type">«Function»</span> optional callback </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise,undefined,void»</span> Returns undefined if used with callback or a Promise otherwise.</li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="../middleware.html">middleware</a></span></li></ul>
<div>
<p>Saves this document by inserting a new document into the database if <a href="#Document.prototype.isNew()">document.isNew</a> is <code>true</code>, or sends an <a href="#Document.prototype.updateOne()">updateOne</a> operation <strong>only</strong> with the modifications to the database, it does not replace the whole document in the latter case.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">product.<span class="hljs-property">sold</span> = <span class="hljs-title class_">Date</span>.<span class="hljs-title function_">now</span>();
product = <span class="hljs-keyword">await</span> product.<span class="hljs-title function_">save</span>();
</pre> <p>If save is successful, the returned promise will fulfill with the document saved.</p> <h4 id="example-1"> <a href="#example-1"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> newProduct = <span class="hljs-keyword">await</span> product.<span class="hljs-title function_">save</span>();
newProduct === product; <span class="hljs-comment">// true</span>
</pre> </div>
<h3 id="Document.prototype.schema">Document.prototype.schema</h3>
<h5>Type:</h5>
<ul><li><span class="method-type">«property»</span></li></ul>
<div>
<p>The document's schema.</p> </div>
<h3 id="Document.prototype.set()">Document.prototype.set()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>path</code> <span class="method-type">«String|Object»</span> path or object of key/vals to set </li>
<li class="param">
<code>val</code> <span class="method-type">«Any»</span> the value to set </li>
<li class="param">
<code>[type]</code> <span class="method-type">«Schema|String|Number|Buffer|[object Object]»</span> optionally specify a type for "on-the-fly" attributes </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> optionally specify options that modify the behavior of the set </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Document»</span> this</li></ul>
<div>
<p>Sets the value of a path, or many paths. Alias for <a href="#Document.prototype.$set()"><code>.$set</code></a>.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-comment">// path, value</span>
doc.<span class="hljs-title function_">set</span>(path, value)

<span class="hljs-comment">// object</span>
doc.<span class="hljs-title function_">set</span>({
    path  : value
  , path2 : {
       path  : value
    }
})

<span class="hljs-comment">// on-the-fly cast to number</span>
doc.<span class="hljs-title function_">set</span>(path, value, <span class="hljs-title class_">Number</span>)

<span class="hljs-comment">// on-the-fly cast to string</span>
doc.<span class="hljs-title function_">set</span>(path, value, <span class="hljs-title class_">String</span>)

<span class="hljs-comment">// changing strict mode behavior</span>
doc.<span class="hljs-title function_">set</span>(path, value, { <span class="hljs-attr">strict</span>: <span class="hljs-literal">false</span> });
</pre> </div>
<h3 id="Document.prototype.toJSON()">Document.prototype.toJSON()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>options</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.flattenMaps=true]</code> <span class="method-type">«Boolean»</span> if true, convert Maps to <a href="https://masteringjs.io/tutorials/fundamentals/pojo">POJOs</a>. Useful if you want to <code>JSON.stringify()</code> the result. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.flattenObjectIds=false]</code> <span class="method-type">«Boolean»</span> if true, convert any ObjectIds in the result to 24 character hex strings. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Object»</span> </li></ul>
<h5>See:</h5>
<ul>
<li><span class="method-type"><a href="#Document.prototype.toObject()">Document#toObject</a></span></li>
<li><span class="method-type"><a href="https://thecodebarbarian.com/the-80-20-guide-to-json-stringify-in-javascript.html">JSON.stringify() in JavaScript</a></span></li>
</ul>
<div>
<p>The return value of this method is used in calls to <a href="https://thecodebarbarian.com/the-80-20-guide-to-json-stringify-in-javascript#the-tojson-function"><code>JSON.stringify(doc)</code></a>.</p> <p>This method accepts the same options as <a href="#Document.prototype.toObject()">Document#toObject</a>. To apply the options to every document of your schema by default, set your <a href="schema.html#Schema()">schemas</a> <code>toJSON</code> option to the same argument.</p> <pre data-language="javascript">schema.<span class="hljs-title function_">set</span>(<span class="hljs-string">'toJSON'</span>, { <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> });
</pre> <p>There is one difference between <code>toJSON()</code> and <code>toObject()</code> options. When you call <code>toJSON()</code>, the <a href="#Document.prototype.toObject()"><code>flattenMaps</code> option</a> defaults to <code>true</code>, because <code>JSON.stringify()</code> doesn't convert maps to objects by default. When you call <code>toObject()</code>, the <code>flattenMaps</code> option is <code>false</code> by default.</p> <p>See <a href="../guide.html#toJSON">schema options</a> for more information on setting <code>toJSON</code> option defaults.</p> </div>
<h3 id="Document.prototype.toObject()">Document.prototype.toObject()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.getters=false]</code> <span class="method-type">«Boolean»</span> if true, apply all getters, including virtuals </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.virtuals=false]</code> <span class="method-type">«Boolean»</span> if true, apply virtuals, including aliases. Use <code>{ getters: true, virtuals: false }</code> to just apply getters, not virtuals </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.aliases=true]</code> <span class="method-type">«Boolean»</span> if <code>options.virtuals = true</code>, you can set <code>options.aliases = false</code> to skip applying aliases. This option is a no-op if <code>options.virtuals = false</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.minimize=true]</code> <span class="method-type">«Boolean»</span> if true, omit any empty objects from the output </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.transform=null]</code> <span class="method-type">«Function|null»</span> if set, mongoose will call this function to allow you to transform the returned object </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.depopulate=false]</code> <span class="method-type">«Boolean»</span> if true, replace any conventionally populated paths with the original id in the output. Has no affect on virtual populated paths. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.versionKey=true]</code> <span class="method-type">«Boolean»</span> if false, exclude the version key (<code>__v</code> by default) from the output </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.flattenMaps=false]</code> <span class="method-type">«Boolean»</span> if true, convert Maps to POJOs. Useful if you want to <code>JSON.stringify()</code> the result of <code>toObject()</code>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.flattenObjectIds=false]</code> <span class="method-type">«Boolean»</span> if true, convert any ObjectIds in the result to 24 character hex strings. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.useProjection=false]</code> <span class="method-type">«Boolean»</span> <ul> <li>If true, omits fields that are excluded in this document's projection. Unless you specified a projection, this will omit any field that has <code>select: false</code> in the schema.</li> </ul> </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Object»</span> js object (not a POJO)</li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="https://mongodb.github.io/node-mongodb-native/4.9/classes/Binary.html">mongodb.Binary</a></span></li></ul>
<div>
<p>Converts this document into a plain-old JavaScript object (<a href="https://masteringjs.io/tutorials/fundamentals/pojo">POJO</a>).</p> <p>Buffers are converted to instances of <a href="https://mongodb.github.io/node-mongodb-native/4.9/classes/Binary.html">mongodb.Binary</a> for proper storage.</p> <h4 id="gettersvirtuals"> <a href="#gettersvirtuals"> Getters/Virtuals </a> </h4> <p>Example of only applying path getters</p> <pre data-language="javascript">doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">getters</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">false</span> })
</pre> <p>Example of only applying virtual getters</p> <pre data-language="javascript">doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> })
</pre> <p>Example of applying both path and virtual getters</p> <pre data-language="javascript">doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">getters</span>: <span class="hljs-literal">true</span> })
</pre> <p>To apply these options to every document of your schema by default, set your <a href="schema.html#Schema()">schemas</a> <code>toObject</code> option to the same argument.</p> <pre data-language="javascript">schema.<span class="hljs-title function_">set</span>(<span class="hljs-string">'toObject'</span>, { <span class="hljs-attr">virtuals</span>: <span class="hljs-literal">true</span> })
</pre> <h4 id="transform"> <a href="#transform"> Transform: </a> </h4> <p>We may need to perform a transformation of the resulting object based on some criteria, say to remove some sensitive information or return a custom object. In this case we set the optional <code>transform</code> function.</p> <p>Transform functions receive three arguments</p> <pre data-language="javascript"><span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) {}
</pre> <ul> <li>
<code>doc</code> The mongoose document which is being converted</li> <li>
<code>ret</code> The plain object representation which has been converted</li> <li>
<code>options</code> The options in use (either schema options or the options passed inline)</li> </ul> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-comment">// specify the transform schema option</span>
<span class="hljs-keyword">if</span> (!schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span>) schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span> = {};
schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span>.<span class="hljs-property">transform</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) {
  <span class="hljs-comment">// remove the _id of every document before returning the result</span>
  <span class="hljs-keyword">delete</span> ret.<span class="hljs-property">_id</span>;
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-comment">// without the transformation in the schema</span>
doc.<span class="hljs-title function_">toObject</span>(); <span class="hljs-comment">// { _id: 'anId', name: 'Wreck-it Ralph' }</span>

<span class="hljs-comment">// with the transformation</span>
doc.<span class="hljs-title function_">toObject</span>(); <span class="hljs-comment">// { name: 'Wreck-it Ralph' }</span>
</pre> <p>With transformations we can do a lot more than remove properties. We can even return completely new customized objects:</p> <pre data-language="javascript"><span class="hljs-keyword">if</span> (!schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span>) schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span> = {};
schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span>.<span class="hljs-property">transform</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) {
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">movie</span>: ret.<span class="hljs-property">name</span> }
}

<span class="hljs-comment">// without the transformation in the schema</span>
doc.<span class="hljs-title function_">toObject</span>(); <span class="hljs-comment">// { _id: 'anId', name: 'Wreck-it Ralph' }</span>

<span class="hljs-comment">// with the transformation</span>
doc.<span class="hljs-title function_">toObject</span>(); <span class="hljs-comment">// { movie: 'Wreck-it Ralph' }</span>
</pre> <p><em>Note: if a transform function returns <code>undefined</code>, the return value will be ignored.</em></p> <p>Transformations may also be applied inline, overridding any transform set in the options:</p> <pre data-language="javascript"><span class="hljs-keyword">function</span> <span class="hljs-title function_">xform</span> (doc, ret, options) {
  <span class="hljs-keyword">return</span> { <span class="hljs-attr">inline</span>: ret.<span class="hljs-property">name</span>, <span class="hljs-attr">custom</span>: <span class="hljs-literal">true</span> }
}

<span class="hljs-comment">// pass the transform as an inline option</span>
doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">transform</span>: xform }); <span class="hljs-comment">// { inline: 'Wreck-it Ralph', custom: true }</span>
</pre> <p>If you want to skip transformations, use <code>transform: false</code>:</p> <pre data-language="javascript">schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span>.<span class="hljs-property">hide</span> = <span class="hljs-string">'_id'</span>;
schema.<span class="hljs-property">options</span>.<span class="hljs-property">toObject</span>.<span class="hljs-property">transform</span> = <span class="hljs-keyword">function</span> (<span class="hljs-params">doc, ret, options</span>) {
  <span class="hljs-keyword">if</span> (options.<span class="hljs-property">hide</span>) {
    options.<span class="hljs-property">hide</span>.<span class="hljs-title function_">split</span>(<span class="hljs-string">' '</span>).<span class="hljs-title function_">forEach</span>(<span class="hljs-keyword">function</span> (<span class="hljs-params">prop</span>) {
      <span class="hljs-keyword">delete</span> ret[prop];
    });
  }
  <span class="hljs-keyword">return</span> ret;
}

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Doc</span>({ <span class="hljs-attr">_id</span>: <span class="hljs-string">'anId'</span>, <span class="hljs-attr">secret</span>: <span class="hljs-number">47</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">'Wreck-it Ralph'</span> });
doc.<span class="hljs-title function_">toObject</span>();                                        <span class="hljs-comment">// { secret: 47, name: 'Wreck-it Ralph' }</span>
doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">hide</span>: <span class="hljs-string">'secret _id'</span>, <span class="hljs-attr">transform</span>: <span class="hljs-literal">false</span> });<span class="hljs-comment">// { _id: 'anId', secret: 47, name: 'Wreck-it Ralph' }</span>
doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">hide</span>: <span class="hljs-string">'secret _id'</span>, <span class="hljs-attr">transform</span>: <span class="hljs-literal">true</span> }); <span class="hljs-comment">// { name: 'Wreck-it Ralph' }</span>
</pre> <p>If you pass a transform in <code>toObject()</code> options, Mongoose will apply the transform to <a href="../subdocs.html">subdocuments</a> in addition to the top-level document. Similarly, <code>transform: false</code> skips transforms for all subdocuments. Note that this behavior is different for transforms defined in the schema: if you define a transform in <code>schema.options.toObject.transform</code>, that transform will <strong>not</strong> apply to subdocuments.</p> <pre data-language="javascript"><span class="hljs-keyword">const</span> memberSchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, <span class="hljs-attr">email</span>: <span class="hljs-title class_">String</span> });
<span class="hljs-keyword">const</span> groupSchema = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Schema</span>({ <span class="hljs-attr">members</span>: [memberSchema], <span class="hljs-attr">name</span>: <span class="hljs-title class_">String</span>, email });
<span class="hljs-keyword">const</span> <span class="hljs-title class_">Group</span> = mongoose.<span class="hljs-title function_">model</span>(<span class="hljs-string">'Group'</span>, groupSchema);

<span class="hljs-keyword">const</span> doc = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Group</span>({
  <span class="hljs-attr">name</span>: <span class="hljs-string">'Engineering'</span>,
  <span class="hljs-attr">email</span>: <span class="hljs-string">'dev@mongoosejs.io'</span>,
  <span class="hljs-attr">members</span>: [{ <span class="hljs-attr">name</span>: <span class="hljs-string">'Val'</span>, <span class="hljs-attr">email</span>: <span class="hljs-string">'val@mongoosejs.io'</span> }]
});

<span class="hljs-comment">// Removes `email` from both top-level document **and** array elements</span>
<span class="hljs-comment">// { name: 'Engineering', members: [{ name: 'Val' }] }</span>
doc.<span class="hljs-title function_">toObject</span>({ <span class="hljs-attr">transform</span>: <span class="hljs-function">(<span class="hljs-params">doc, ret</span>) =&gt;</span> { <span class="hljs-keyword">delete</span> ret.<span class="hljs-property">email</span>; <span class="hljs-keyword">return</span> ret; } });
</pre> <p>Transforms, like all of these options, are also available for <code>toJSON</code>. See <a href="https://thecodebarbarian.com/the-80-20-guide-to-json-stringify-in-javascript.html">this guide to <code>JSON.stringify()</code></a> to learn why <code>toJSON()</code> and <code>toObject()</code> are separate functions.</p> <p>See <a href="../guide.html#toObject">schema options</a> for some more details.</p> <p><em>During save, no custom options are applied to the document before being sent to the database.</em></p> </div>
<h3 id="Document.prototype.toString()">Document.prototype.toString()</h3>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«String»</span> </li></ul>
<div>
<p>Helper for console.log</p> </div>
<h3 id="Document.prototype.unmarkModified()">Document.prototype.unmarkModified()</h3>
<h5>Parameters:</h5>
<ul class="params"><li class="param">
<code>path</code> <span class="method-type">«String»</span> the path to unmark modified </li></ul>
<div>
<p>Clears the modified state on the specified path.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">doc.<span class="hljs-property">foo</span> = <span class="hljs-string">'bar'</span>;
doc.<span class="hljs-title function_">unmarkModified</span>(<span class="hljs-string">'foo'</span>);
doc.<span class="hljs-title function_">save</span>(); <span class="hljs-comment">// changes to foo will not be persisted</span>
</pre> </div>
<h3 id="Document.prototype.updateOne()">Document.prototype.updateOne()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>doc</code> <span class="method-type">«Object»</span> </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> optional see <a href="query.html#Query.prototype.setOptions()"><code>Query.prototype.setOptions()</code></a> </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.lean]</code> <span class="method-type">«Object»</span> if truthy, mongoose will return the document as a plain JavaScript object rather than a mongoose document. See <a href="query.html#Query.prototype.lean()"><code>Query.lean()</code></a> and the <a href="../tutorials/lean.html">Mongoose lean tutorial</a>. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.strict]</code> <span class="method-type">«Boolean|String»</span> overwrites the schema's <a href="../guide.html#strict">strict mode option</a> </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.timestamps=null]</code> <span class="method-type">«Boolean»</span> If set to <code>false</code> and <a href="../guide.html#timestamps">schema-level timestamps</a> are enabled, skip timestamps for this update. Note that this allows you to overwrite timestamps. Does nothing if schema-level timestamps are not set. </li></ul>
<li class="param">
<code>[callback]</code> <span class="method-type">«Function»</span> </li>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Query»</span> </li></ul>
<h5>See:</h5>
<ul><li><span class="method-type"><a href="model.html#Model.updateOne">Model.updateOne</a></span></li></ul>
<div>
<p>Sends an updateOne command with this document <code>_id</code> as the query selector.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript">weirdCar.<span class="hljs-title function_">updateOne</span>({<span class="hljs-attr">$inc</span>: {<span class="hljs-attr">wheels</span>:<span class="hljs-number">1</span>}}, { <span class="hljs-attr">w</span>: <span class="hljs-number">1</span> }, callback);
</pre> <h4 id="valid-options"> <a href="#valid-options"> Valid options: </a> </h4> <ul> <li>same as in <a href="model.html#Model.updateOne">Model.updateOne</a>
</li> </ul> </div>
<h3 id="Document.prototype.validate()">Document.prototype.validate()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>[pathsToValidate]</code> <span class="method-type">«Array|String»</span> list of paths to validate. If set, Mongoose will validate only the modified paths that are in the given list. </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> internal options </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.validateModifiedOnly=false]</code> <span class="method-type">«Boolean»</span> if <code>true</code> mongoose validates only modified paths. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.pathsToSkip]</code> <span class="method-type">«Array|string»</span> list of paths to skip. If set, Mongoose will validate every modified path that is not in this list. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«Promise»</span> Returns a Promise.</li></ul>
<div>
<p>Executes registered validation rules for this document.</p> <h4 id="note"> <a href="#note"> Note: </a> </h4> <p>This method is called <code>pre</code> save and if a validation rule is violated, <a href="model.html#Model.prototype.save()">save</a> is aborted and the error is thrown.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">await</span> doc.<span class="hljs-title function_">validate</span>({ <span class="hljs-attr">validateModifiedOnly</span>: <span class="hljs-literal">false</span>, <span class="hljs-attr">pathsToSkip</span>: [<span class="hljs-string">'name'</span>, <span class="hljs-string">'email'</span>]});
</pre> </div>
<h3 id="Document.prototype.validateSync()">Document.prototype.validateSync()</h3>
<h5>Parameters:</h5>
<ul class="params">
<li class="param">
<code>[pathsToValidate]</code> <span class="method-type">«Array|string»</span> only validate the given paths </li>
<li class="param">
<code>[options]</code> <span class="method-type">«Object»</span> options for validation </li>
<ul style="margin-top: 0.5em"><li>
<code>[options.validateModifiedOnly=false]</code> <span class="method-type">«Boolean»</span> If <code>true</code>, Mongoose will only validate modified paths, as opposed to modified paths and <code>required</code> paths. </li></ul>
<ul style="margin-top: 0.5em"><li>
<code>[options.pathsToSkip]</code> <span class="method-type">«Array|string»</span> list of paths to skip. If set, Mongoose will validate every modified path that is not in this list. </li></ul>
</ul>
<h5>Returns:</h5>
<ul><li>
<span class="method-type">«ValidationError,undefined,void»</span> ValidationError if there are errors during validation, or undefined if there is no error.</li></ul>
<div>
<p>Executes registered validation rules (skipping asynchronous validators) for this document.</p> <h4 id="note"> <a href="#note"> Note: </a> </h4> <p>This method is useful if you need synchronous validation.</p> <h4 id="example"> <a href="#example"> Example: </a> </h4> <pre data-language="javascript"><span class="hljs-keyword">const</span> err = doc.<span class="hljs-title function_">validateSync</span>();
<span class="hljs-keyword">if</span> (err) {
  <span class="hljs-title function_">handleError</span>(err);
} <span class="hljs-keyword">else</span> {
  <span class="hljs-comment">// validation passed</span>
}
</pre> </div>
</div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2010 LearnBoost<br>Licensed under the MIT License.<br>
    <a href="https://mongoosejs.com/docs/api/document.html" class="_attribution-link">https://mongoosejs.com/docs/api/document.html</a>
  </p>
</div>
