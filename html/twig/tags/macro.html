<h1 id="macro"><span class="pre">macro</span></h1> <p>Macros are comparable with functions in regular programming languages. They are useful to reuse template fragments to not repeat yourself.</p> <p>Macros are defined in regular templates.</p> <p>Imagine having a generic helper template that define how to render HTML forms via macros (called <code class="docutils literal notranslate"><span class="pre">forms.html</span></code>):</p> <div class="highlight-html+twig notranslate"><pre data-language="php" class="highlight"><span class="cp">{%</span> <span class="k">macro</span> <span class="nv">input</span><span class="o">(</span><span class="nv">name</span><span class="o">,</span> <span class="nv">value</span><span class="o">,</span> <span class="nv">type</span> <span class="o">=</span> <span class="s2">"text"</span><span class="o">,</span> <span class="nv">size</span> <span class="o">=</span> <span class="m">20</span><span class="o">)</span> <span class="cp">%}</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">type</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">name</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">value</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">value</span><span class="o">|</span><span class="nf">e</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">size</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">size</span> <span class="cp">}}</span><span class="s">"</span><span class="p">/&gt;</span>
<span class="cp">{%</span> <span class="k">endmacro</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">macro</span> <span class="nv">textarea</span><span class="o">(</span><span class="nv">name</span><span class="o">,</span> <span class="nv">value</span><span class="o">,</span> <span class="nv">rows</span> <span class="o">=</span> <span class="m">10</span><span class="o">,</span> <span class="nv">cols</span> <span class="o">=</span> <span class="m">40</span><span class="o">)</span> <span class="cp">%}</span>
    <span class="p">&lt;</span><span class="nt">textarea</span> <span class="na">name</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">rows</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">rows</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">cols</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">cols</span> <span class="cp">}}</span><span class="s">"</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">value</span><span class="o">|</span><span class="nf">e</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">textarea</span><span class="p">&gt;</span>
<span class="cp">{%</span> <span class="k">endmacro</span> <span class="cp">%}</span>
</pre></div> <p>Each macro argument can have a default value (here <code class="docutils literal notranslate"><span class="pre">text</span></code> is the default value for <code class="docutils literal notranslate"><span class="pre">type</span></code> if not provided in the call).</p> <p>Macros differ from native PHP functions in a few ways:</p> <ul class="simple"> <li>Arguments of a macro are always optional.</li> <li>If extra positional arguments are passed to a macro, they end up in the special <code class="docutils literal notranslate"><span class="pre">varargs</span></code> variable as a list of values.</li> </ul> <p>But as with PHP functions, macros don’t have access to the current template variables.</p> <div class="admonition tip"> <p class="first admonition-title">Tip</p> <p class="last">You can pass the whole context as an argument by using the special <code class="docutils literal notranslate"><span class="pre">_context</span></code> variable.</p> </div>  <h2 id="importing-macros">Importing Macros</h2> <p>There are two ways to import macros. You can import the complete template containing the macros into a local variable (via the <code class="docutils literal notranslate"><span class="pre">import</span></code> tag) or only import specific macros from the template (via the <code class="docutils literal notranslate"><span class="pre">from</span></code> tag).</p> <p>To import all macros from a template into a local variable, use the <code class="docutils literal notranslate"><span class="pre">import</span></code> tag:</p> <div class="highlight-twig notranslate"><pre data-language="php" class="highlight"><span class="cp">{%</span> <span class="k">import</span> <span class="s2">"forms.html"</span> <span class="nv">as</span> <span class="nv">forms</span> <span class="cp">%}</span>
</pre></div> <p>The above <code class="docutils literal notranslate"><span class="pre">import</span></code> call imports the <code class="docutils literal notranslate"><span class="pre">forms.html</span></code> file (which can contain only macros, or a template and some macros), and import the macros as items of the <code class="docutils literal notranslate"><span class="pre">forms</span></code> local variable.</p> <p>The macros can then be called at will in the <em>current</em> template:</p> <div class="highlight-html+twig notranslate"><pre data-language="php" class="highlight"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">forms.input</span><span class="o">(</span><span class="s1">'username'</span><span class="o">)</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">forms.input</span><span class="o">(</span><span class="s1">'password'</span><span class="o">,</span> <span class="kp">null</span><span class="o">,</span> <span class="s1">'password'</span><span class="o">)</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div> <p>Alternatively you can import names from the template into the current namespace via the <code class="docutils literal notranslate"><span class="pre">from</span></code> tag:</p> <div class="highlight-html+twig notranslate"><pre data-language="php" class="highlight"><span class="cp">{%</span> <span class="k">from</span> <span class="s1">'forms.html'</span> <span class="nv">import</span> <span class="nv">input</span> <span class="nv">as</span> <span class="nv">input_field</span><span class="o">,</span> <span class="nv">textarea</span> <span class="cp">%}</span>

<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">input_field</span><span class="o">(</span><span class="s1">'password'</span><span class="o">,</span> <span class="s1">''</span><span class="o">,</span> <span class="s1">'password'</span><span class="o">)</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">textarea</span><span class="o">(</span><span class="s1">'comment'</span><span class="o">)</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</pre></div> <div class="admonition tip"> <p class="first admonition-title">Tip</p> <p>When macro usages and definitions are in the same template, you don’t need to import the macros as they are automatically available under the special <code class="docutils literal notranslate"><span class="pre">_self</span></code> variable:</p> <div class="last highlight-html+twig notranslate"><pre data-language="php" class="highlight"><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span><span class="cp">{{</span> <span class="nv">_self.input</span><span class="o">(</span><span class="s1">'password'</span><span class="o">,</span> <span class="s1">''</span><span class="o">,</span> <span class="s1">'password'</span><span class="o">)</span> <span class="cp">}}</span><span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>

<span class="cp">{%</span> <span class="k">macro</span> <span class="nv">input</span><span class="o">(</span><span class="nv">name</span><span class="o">,</span> <span class="nv">value</span><span class="o">,</span> <span class="nv">type</span> <span class="o">=</span> <span class="s2">"text"</span><span class="o">,</span> <span class="nv">size</span> <span class="o">=</span> <span class="m">20</span><span class="o">)</span> <span class="cp">%}</span>
    <span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">type</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">name</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">name</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">value</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">value</span><span class="o">|</span><span class="nf">e</span> <span class="cp">}}</span><span class="s">"</span> <span class="na">size</span><span class="o">=</span><span class="s">"</span><span class="cp">{{</span> <span class="nv">size</span> <span class="cp">}}</span><span class="s">"</span><span class="p">/&gt;</span>
<span class="cp">{%</span> <span class="k">endmacro</span> <span class="cp">%}</span>
</pre></div> </div>   <h2 id="macros-scoping">Macros Scoping</h2> <p>The scoping rules are the same whether you imported macros via <code class="docutils literal notranslate"><span class="pre">import</span></code> or <code class="docutils literal notranslate"><span class="pre">from</span></code>.</p> <p>Imported macros are always <strong>local</strong> to the current template. It means that macros are available in all blocks and other macros defined in the current template, but they are not available in included templates or child templates; you need to explicitly re-import macros in each template.</p> <p>Imported macros are not available in the body of <code class="docutils literal notranslate"><span class="pre">embed</span></code> tags, you need to explicitly re-import macros inside the tag.</p> <p>When calling <code class="docutils literal notranslate"><span class="pre">import</span></code> or <code class="docutils literal notranslate"><span class="pre">from</span></code> from a <code class="docutils literal notranslate"><span class="pre">block</span></code> tag, the imported macros are only defined in the current block and they override macros defined at the template level with the same names.</p> <p>When calling <code class="docutils literal notranslate"><span class="pre">import</span></code> or <code class="docutils literal notranslate"><span class="pre">from</span></code> from a <code class="docutils literal notranslate"><span class="pre">macro</span></code> tag, the imported macros are only defined in the current macro and they override macros defined at the template level with the same names.</p>   <h2 id="checking-if-a-macro-is-defined">Checking if a Macro is defined</h2> <p>You can check if a macro is defined via the <code class="docutils literal notranslate"><span class="pre">defined</span></code> test:</p> <div class="highlight-twig notranslate"><pre data-language="php" class="highlight"><span class="cp">{%</span> <span class="k">import</span> <span class="s2">"macros.twig"</span> <span class="nv">as</span> <span class="nv">macros</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">from</span> <span class="s2">"macros.twig"</span> <span class="nv">import</span> <span class="nv">hello</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">macros.hello</span> <span class="k">is</span> <span class="nf">defined</span> -<span class="cp">%}</span>
<span class="x">    OK</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>

<span class="cp">{%</span> <span class="k">if</span> <span class="nv">hello</span> <span class="k">is</span> <span class="nf">defined</span> -<span class="cp">%}</span>
<span class="x">    OK</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span>
</pre></div>   <h2 id="named-macro-end-tags">Named Macro End-Tags</h2> <p>Twig allows you to put the name of the macro after the end tag for better readability (the name after the <code class="docutils literal notranslate"><span class="pre">endmacro</span></code> word must match the macro name):</p> <div class="highlight-twig notranslate"><pre data-language="php" class="highlight"><span class="cp">{%</span> <span class="k">macro</span> <span class="nv">input</span><span class="o">()</span> <span class="cp">%}</span>
<span class="x">    ...</span>
<span class="cp">{%</span> <span class="k">endmacro</span> <span class="nv">input</span> <span class="cp">%}</span>
</pre></div>    <div class="navigation" style="text-align: center"> <a accesskey="P" title="include" href="include.html"> « include </a> <span class="separator">|</span> <a accesskey="N" title="sandbox" href="sandbox.html"> sandbox » </a> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2009&ndash;2018 by the Twig Team<br>Licensed under the three clause BSD license.<br>The Twig logo is &copy; 2010&ndash;2020 Symfony<br>
    <a href="https://twig.symfony.com/doc/3.x/tags/macro.html" class="_attribution-link">https://twig.symfony.com/doc/3.x/tags/macro.html</a>
  </p>
</div>
