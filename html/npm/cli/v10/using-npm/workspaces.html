<div class="Box-sc-g0xbh4-0 goytIH">
<h1 class="components__StyledHeading-sc-13rww2g-0 components__h1-sc-13rww2g-1 cZjJlu jMmFmb components__StyledHeading-sc-13rww2g-0 cZjJlu">workspaces</h1>
<div class="Box-sc-g0xbh4-0 iLGAbu">Working with workspaces</div>
</div>


<h3 id="description" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#description" aria-label="Description permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Description</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF"><strong>Workspaces</strong> is a generic term that refers to the set of features in the npm cli that provides support to managing multiple packages from your local file system from within a singular top-level, root package.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">This set of features makes up for a much more streamlined workflow handling linked packages from the local file system. Automating the linking process as part of <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm install</code> and avoiding manually having to use <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm link</code> in order to add references to packages that should be symlinked into the current <code class="code__InlineCode-sc-izuaam-0 lnAgdq">node_modules</code> folder.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">We also refer to these packages being auto-symlinked during <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm install</code> as a single <strong>workspace</strong>, meaning it's a nested package within the current local file system that is explicitly defined in the <a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../configuring-npm/package-json.html#workspaces"><code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code></a> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspaces</code> configuration.</p> <h3 id="defining-workspaces" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#defining-workspaces" aria-label="Defining workspaces permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Defining workspaces</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Workspaces are usually defined via the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspaces</code> property of the <a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../configuring-npm/package-json.html#workspaces"><code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code></a> file, e.g:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-json" tabindex="0" data-language="javascript">{
  "name": "my-workspaces-powered-project",
  "workspaces": ["packages/a"]
}</pre></div>
</div></div> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Given the above <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code> example living at a current working directory <code class="code__InlineCode-sc-izuaam-0 lnAgdq">.</code> that contains a folder named <code class="code__InlineCode-sc-izuaam-0 lnAgdq">packages/a</code> that itself contains a <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code> inside it, defining a Node.js package, e.g:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">.
+-- package.json
`-- packages
   +-- a
   |   `-- package.json</pre></div>
</div></div> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">The expected result once running <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm install</code> in this current working directory <code class="code__InlineCode-sc-izuaam-0 lnAgdq">.</code> is that the folder <code class="code__InlineCode-sc-izuaam-0 lnAgdq">packages/a</code> will get symlinked to the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">node_modules</code> folder of the current working dir.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Below is a post <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm install</code> example, given that same previous example structure of files and folders:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">.
+-- node_modules
|  `-- a -&gt; ../packages/a
+-- package-lock.json
+-- package.json
`-- packages
   +-- a
   |   `-- package.json</pre></div>
</div></div> <h3 id="getting-started-with-workspaces" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#getting-started-with-workspaces" aria-label="Getting started with workspaces permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Getting started with workspaces</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">You may automate the required steps to define a new workspace using <a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../commands/npm-init.html">npm init</a>. For example in a project that already has a <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code> defined you can run:</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm init -w ./packages/a</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">This command will create the missing folders and a new <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code> file (if needed) while also making sure to properly configure the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">"workspaces"</code> property of your root project <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code>.</p> <h3 id="adding-dependencies-to-a-workspace" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#adding-dependencies-to-a-workspace" aria-label="Adding dependencies to a workspace permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Adding dependencies to a workspace</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">It's possible to directly add/remove/update dependencies of your workspaces using the <a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="config.html#workspace"><code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspace</code> config</a>.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">For example, assuming the following structure:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">.
+-- package.json
`-- packages
   +-- a
   |   `-- package.json
   `-- b
       `-- package.json</pre></div>
</div></div> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">If you want to add a dependency named <code class="code__InlineCode-sc-izuaam-0 lnAgdq">abbrev</code> from the registry as a dependency of your workspace <strong>a</strong>, you may use the workspace config to tell the npm installer that package should be added as a dependency of the provided workspace:</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm install abbrev -w a</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Note: other installing commands such as <code class="code__InlineCode-sc-izuaam-0 lnAgdq">uninstall</code>, <code class="code__InlineCode-sc-izuaam-0 lnAgdq">ci</code>, etc will also respect the provided <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspace</code> configuration.</p> <h3 id="using-workspaces" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#using-workspaces" aria-label="Using workspaces permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Using workspaces</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Given the <a href="https://nodejs.org/dist/latest-v14.x/docs/api/modules.html#modules_all_together" class="Link__StyledLink-sc-14289xe-0 kIxRcv">specifities of how Node.js handles module resolution</a> it's possible to consume any defined workspace by its declared <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">name</code>. Continuing from the example defined above, let's also create a Node.js script that will require the workspace <code class="code__InlineCode-sc-izuaam-0 lnAgdq">a</code> example module, e.g:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">// ./packages/a/index.js
module.exports = 'a'


// ./lib/index.js
const moduleA = require('a')
console.log(moduleA) // -&gt; a</pre></div>
</div></div> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">When running it with:</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF"><code class="code__InlineCode-sc-izuaam-0 lnAgdq">node lib/index.js</code></p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">This demonstrates how the nature of <code class="code__InlineCode-sc-izuaam-0 lnAgdq">node_modules</code> resolution allows for <strong>workspaces</strong> to enable a portable workflow for requiring each <strong>workspace</strong> in such a way that is also easy to <a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../commands/npm-publish.html">publish</a> these nested workspaces to be consumed elsewhere.</p> <h3 id="running-commands-in-the-context-of-workspaces" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#running-commands-in-the-context-of-workspaces" aria-label="Running commands in the context of workspaces permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Running commands in the context of workspaces</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">You can use the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspace</code> configuration option to run commands in the context of a configured workspace. Additionally, if your current directory is in a workspace, the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspace</code> configuration is implicitly set, and <code class="code__InlineCode-sc-izuaam-0 lnAgdq">prefix</code> is set to the root workspace.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Following is a quick example on how to use the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run</code> command in the context of nested workspaces. For a project containing multiple workspaces, e.g:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">.
+-- package.json
`-- packages
   +-- a
   |   `-- package.json
   `-- b
       `-- package.json</pre></div>
</div></div> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">By running a command using the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspace</code> option, it's possible to run the given command in the context of that specific workspace. e.g:</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run test --workspace=a</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">You could also run the command within the workspace.</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">cd packages/a &amp;&amp; npm run test</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Either will run the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">test</code> script defined within the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">./packages/a/package.json</code> file.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Please note that you can also specify this argument multiple times in the command-line in order to target multiple workspaces, e.g:</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run test --workspace=a --workspace=b</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Or run the command for each workspace within the 'packages' folder:</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run test --workspace=packages</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">It's also possible to use the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">workspaces</code> (plural) configuration option to enable the same behavior but running that command in the context of <strong>all</strong> configured workspaces. e.g:</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run test --workspaces</code> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Will run the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">test</code> script in both <code class="code__InlineCode-sc-izuaam-0 lnAgdq">./packages/a</code> and <code class="code__InlineCode-sc-izuaam-0 lnAgdq">./packages/b</code>.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Commands will be run in each workspace in the order they appear in your <code class="code__InlineCode-sc-izuaam-0 lnAgdq">package.json</code></p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">{
  "workspaces": [ "packages/a", "packages/b" ]
}</pre></div>
</div></div> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">Order of run is different with:</p> <div class="Box-sc-g0xbh4-0 eUKtPS"><div style="color:#393A34;background-color:#f6f8fa" class="Box-sc-g0xbh4-0 bdVWRk">
<div class="Box-sc-g0xbh4-0 kFQlqn"><pre class="Box-sc-g0xbh4-0 bfdbXb prism-code language-bash" tabindex="0" data-language="javascript">{
  "workspaces": [ "packages/b", "packages/a" ]
}</pre></div>
</div></div> <h3 id="ignoring-missing-scripts" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#ignoring-missing-scripts" aria-label="Ignoring missing scripts permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">Ignoring missing scripts</a></h3> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">It is not required for all of the workspaces to implement scripts run with the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run</code> command.</p> <p class="components__Paragraph-sc-13rww2g-11 cevAMF">By running the command with the <code class="code__InlineCode-sc-izuaam-0 lnAgdq">--if-present</code> flag, npm will ignore workspaces missing target script.</p> <code class="code__InlineCode-sc-izuaam-0 lnAgdq">npm run test --workspaces --if-present</code> <h3 id="see-also" class="components__StyledHeading-sc-13rww2g-0 components__h3-sc-13rww2g-3 cZjJlu Nafes components__StyledHeading-sc-13rww2g-0 cZjJlu"><a href="#see-also" aria-label="See also permalink" class="Link__StyledLink-sc-14289xe-0 hysCUZ">See also</a></h3> <ul class="components__UnorderedList-sc-13rww2g-10 fqlkab"> <li><a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../commands/npm-install.html">npm install</a></li> <li><a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../commands/npm-publish.html">npm publish</a></li> <li><a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="../commands/npm-run-script.html">npm run-script</a></li> <li><a class="Link__StyledLink-sc-14289xe-0 kIxRcv" href="config.html">config</a></li> </ul><div class="_attribution">
  <p class="_attribution-p">
    &copy; npm, Inc. and Contributors<br>Licensed under the npm License.<br>npm is a trademark of npm, Inc.<br>
    <a href="https://docs.npmjs.com/cli/v10/using-npm/workspaces" class="_attribution-link">https://docs.npmjs.com/cli/v10/using-npm/workspaces</a>
  </p>
</div>
