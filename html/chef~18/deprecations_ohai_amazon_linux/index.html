<div id="col-content" data-swiftype-index="true"> <div id="deprecation-amazon-linux-moved-to-the-amazon-platform_family-ohai-7"><h1>Deprecation: Amazon linux moved to the Amazon platform_family (OHAI-7)</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/deprecations_ohai_amazon_linux.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>In Ohai/Chef releases prior to Chef Client 13, Amazon Linux was identified as <code>platform_family 'rhel'</code>. In Ohai/Chef Client 13 and later, Amazon Linux will be identified as the <code>platform_family 'amazon'</code>. When Amazon Linux was created it closely mirrored the structure and package naming of RHEL 5, and with the release of RHEL 6 Amazon Linux moved to closely resemble RHEL 6. With the release of RHEL 7 Red Hat switched to the systemd init system, however Amazon Linux has not yet decided to make that same switch. In addition to the init system differences, Amazon Linux has added many critical packages with their own unique naming conventions. This makes it very hard for users to write cookbooks for RHEL that will work on Amazon Linux systems out of the box. In order to simplify multi-platform cookbook code and to make it more clear when cookbooks actually support Amazon Linux, we’ve created the ‘<code>amazon</code> platform family and removed Amazon Linux from the <code>rhel</code> platform family.</p> <h2 id="remediation">Remediation</h2> <p>If you have a cookbook that relies on <code>platform_family 'rhel'</code> to support Red Hat based distributions as well as Amazon Linux, you’ll need to modify your code to specifically check for the <code>'amazon'</code> platform family.</p> <p>Existing code only checking for the <code>rhel</code> platform family:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#007020;font-weight:700">if</span> platform_family?(<span style="color:#4070a0">'rhel'</span>)
  service <span style="color:#4070a0">'foo'</span> <span style="color:#007020;font-weight:700">do</span>
    action <span style="color:#517918">:start</span>
  <span style="color:#007020;font-weight:700">end</span>
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<p>Updated code to check for both <code>rhel</code> and <code>amazon</code> platform families:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#007020;font-weight:700">if</span> platform_family?(<span style="color:#4070a0">'rhel'</span>, <span style="color:#4070a0">'amazon'</span>)
  service <span style="color:#4070a0">'foo'</span> <span style="color:#007020;font-weight:700">do</span>
    action <span style="color:#517918">:start</span>
  <span style="color:#007020;font-weight:700">end</span>
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/deprecations_ohai_amazon_linux/" class="_attribution-link">https://docs.chef.io/deprecations_ohai_amazon_linux/</a>
  </p>
</div>
