<div id="col-content" data-swiftype-index="true"> <div id="metadatarb"><h1>metadata.rb</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/config_rb_metadata.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Every cookbook requires a small amount of metadata. The contents of the <code>metadata.rb</code> file provides information that helps Chef Infra Client and Server correctly deploy cookbooks to each node.</p> <p>A <code>metadata.rb</code> file is:</p> <ul> <li>Located at the top level of a cookbook’s directory structure.</li> <li>Compiled whenever a cookbook is uploaded to the Chef Infra Server or when the <code>knife cookbook metadata</code> subcommand is run, and then stored as JSON data.</li> <li>Created automatically by knife whenever the <code>knife cookbook create</code> subcommand is run.</li> <li>Edited using a text editor, and then re-uploaded to the Chef Infra Server as part of a cookbook upload.</li> </ul> <ul> <li>Located at the top level of a cookbook’s directory structure.</li> <li>Compiled whenever a cookbook is uploaded to the Chef Infra Server or when the <code>knife cookbook metadata</code> subcommand is run, and then stored as JSON data.</li> <li>Created automatically by knife whenever the <code>knife cookbook create</code> subcommand is run.</li> <li>Edited using a text editor, and then re-uploaded to the Chef Infra Server as part of a cookbook upload.</li> </ul> <h2 id="error-messages">Error Messages</h2> <p>The Chef Infra Server will only try to distribute the cookbooks that are needed to configure an individual node. This is determined by identifying the roles and recipes that are assigned directly to that system, and then to expand the list of dependencies, and then to deliver that entire set to the node. In some cases, if the dependency is not specified in the cookbook’s metadata, the Chef Infra Server may not treat that dependency as a requirement, which will result in an error message. If an error message is received from the Chef Infra Server about cookbook distribution, verify the <code>depends</code> entries in the <code>metadata.rb</code> file, and then try again.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> A metadata.json file can be edited directly, should temporary changes be required. Any subsequent upload or action that generates metadata will cause the existing metadata.json file to be overwritten with the newly generated metadata. Therefore, any permanent changes to cookbook metadata should be done in the <code>metadata.rb</code> file, and then re-uploaded to the Chef Infra Server. </div> </div> <h2 id="version-constraints">Version Constraints</h2> <p>Many fields in a cookbook’s metadata allow the user to constrain versions. There are a set of operators common to all fields:</p> <table> <col style="width:87%"> <col style="width:12%"> <thead> <tr class="header"> <th>Specification</th> <th>Operator</th> </tr> </thead> <tbody> <tr> <td>Pessimistic (see note below)</td> <td><code>~&gt;</code></td> </tr> <tr> <td>Equal to</td> <td><code>=</code></td> </tr> <tr> <td>Greater than or equal to</td> <td><code>&gt;=</code></td> </tr> <tr> <td>Greater than</td> <td><code>&gt;</code></td> </tr> <tr> <td>Less than</td> <td><code>&lt;</code></td> </tr> <tr> <td>Less than or equal to</td> <td><code>&lt;=</code></td> </tr> </tbody> </table> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Pessimistic locking is enabled by proper <a href="https://semver.org">semantic versioning</a> of cookbooks. If we’re on version 2.2.3 of a cookbook, we know that the API will be stable until the 3.0.0 release. Using traditional operators, we’d write this as <code>&gt;= 2.2.0, &lt; 3.0</code>. Instead, we can write this by combining a tilde “~” and right angle bracket “&gt;"–often called a tilde-rocket or “twiddle-wakka”–followed by the major and minor version numbers. For example: <code>~&gt; 2.2</code> </div> </div> <h2 id="settings">Settings</h2> <p>This configuration file has the following settings:</p> <dl> <dt><code>chef_version</code></dt> <dd> <p>A range of Chef Client versions that are supported by this cookbook. All <a href="#version-constraints">version constraint operators</a> are applicable to this field.</p> <p>For example, to match any 16.x version of the Chef Client, but not 15.x or 17.x:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_version <span style="color:#4070a0">'~&gt; 16.0'</span>
</code></pre></div>
<p>A more complex example where you set both a lower and upper bound of the Chef Infra Client version:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_version <span style="color:#4070a0">'&gt;= 17.2'</span>, <span style="color:#4070a0">'&lt; 17.4'</span>
</code></pre></div>
</dd> <dt><code>depends</code></dt> <dd> <p>This field requires that a cookbook with a matching name and version exists on the Chef Infra Server. When the match exists, the Chef Infra Server includes the dependency as part of the set of cookbooks that are sent to the node during a Chef Infra Client run. It is very important that the <code>depends</code> field contain accurate data. If a dependency statement is inaccurate, Chef Infra Client may not be able to complete the configuration of the system. All <a href="#version-constraints">version constraint operators</a> are applicable to this field.</p> <p>For example, to set a dependency a cookbook named <code>cats</code>:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">depends <span style="color:#4070a0">'cats'</span>
</code></pre></div>
<p>or, to set a dependency on the same cookbook, but only when the version is less than 1.0:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">depends <span style="color:#4070a0">'cats'</span>, <span style="color:#4070a0">'&lt; 1.0'</span>
</code></pre></div>
</dd> <dt><code>description</code></dt> <dd> <p>A short description of a cookbook and its functionality.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">description <span style="color:#4070a0">'A fancy cookbook that manages a herd of cats!'</span>
</code></pre></div>
</dd> <dt><code>gem</code></dt> <dd> <p>Specifies a gem dependency for installation in Chef Infra Client through bundler. The gem installation occurs after all cookbooks are synchronized but before loading any other cookbooks. Use this attribute one time for each gem dependency. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">gem <span style="color:#4070a0">'loofah'</span>
gem <span style="color:#4070a0">'chef-sugar'</span>
</code></pre></div>
<div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> <p>Use the <code>gem</code> setting only for making external chef libraries shipped as gems accessible in a Chef Infra Client run for libraries and attribute files. The <code>gem</code> setting in <code>metadata.rb</code> allows for the early installation of this specific type of gem, with the fundamental limitation that it cannot install native gems.</p> <p>Do not install native gems with the <code>gem</code> setting in <code>metadata.rb</code> . The <code>gem</code> setting is not a general purpose replacement for the <a href="../resources/chef_gem/index.html">chef_gem resource</a>, and does not internally re-use the <code>chef_gem</code> resource. Native gems require C compilation and must not be installed with <code>metadata.rb</code> because <code>metadata.rb</code> runs before any recipe code runs. Consequently, Chef Infra Client cannot install the C compilers before the gem installation occurs. Instead, install native gems with the <code>chef_gem</code> resource called from the recipe code. You’ll also need to use the <code>build_essential</code> resource in the recipe code to install the prerequisite compilers onto the system.</p> <p>Pure ruby gems can also be installed with <code>metadata.rb</code>.</p> </div> </div> </dd> <dt><code>issues_url</code></dt> <dd> <p>The URL for the location in which a cookbook’s issue tracking is maintained. This setting is also used by Chef Supermarket. In Chef Supermarket, this value is used to define the destination for the “View Issues” link.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">issues_url <span style="color:#4070a0">'https://github.com/chef-cookbooks/chef-client/issues'</span>
</code></pre></div>
</dd> <dt><code>license</code></dt> <dd> <p>The type of license under which a cookbook is distributed: <code>Apache v2.0</code>, <code>GPL v2</code>, <code>GPL v3</code>, <code>MIT</code>, or <code>license 'Proprietary - All Rights Reserved</code> (default). Please be aware of the licenses for files inside of a cookbook and be sure to follow any restrictions they describe.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">license <span style="color:#4070a0">'Apache-2.0'</span>
</code></pre></div>
<p>or:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">license <span style="color:#4070a0">'GPL-3.0'</span>
</code></pre></div>
<p>or:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">license <span style="color:#4070a0">'MIT'</span>
</code></pre></div>
<p>or:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">license <span style="color:#4070a0">'Proprietary - All Rights Reserved'</span>
</code></pre></div>
</dd> <dt><code>maintainer</code></dt> <dd> <p>The name of the person responsible for maintaining a cookbook, either an individual or an organization.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">maintainer <span style="color:#4070a0">'Bob Bobberson'</span>
</code></pre></div>
</dd> <dt><code>maintainer_email</code></dt> <dd> <p>The email address for the person responsible for maintaining a cookbook. Only one email can be listed here, so if this needs to be forwarded to multiple people consider using an email address that is already setup for mail forwarding.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">maintainer_email <span style="color:#4070a0">'bob@example.com'</span>
</code></pre></div>
</dd> <dt><code>name</code></dt> <dd> <p>Required. The name of the cookbook.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#007020">name</span> <span style="color:#4070a0">'cats'</span>
</code></pre></div>
</dd> <dt><code>ohai_version</code></dt> <dd> <p>A range of Ohai versions that are supported by this cookbook. All <a href="#version-constraints">version constraint operators</a> are applicable to this field.</p> <p>For example, to match any 8.x version of Ohai, but not 7.x or 9.x:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">ohai_version <span style="color:#4070a0">'~&gt; 8'</span>
</code></pre></div>
<div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> This setting is not visible in Chef Supermarket. </div> </div> </dd> <dt><code>privacy</code></dt> <dd> <p>Specify a cookbook as private.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">privacy <span style="color:#007020">true</span>
</code></pre></div>
</dd> <dt><code>source_url</code></dt> <dd> <p>The URL for the location in which a cookbook’s source code is maintained. This setting is also used by Chef Supermarket. In Chef Supermarket, this value is used to define the destination for the “View Source” link.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">source_url <span style="color:#4070a0">'https://github.com/chef-cookbooks/chef-client'</span>
</code></pre></div>
</dd> <dt><code>supports</code></dt> <dd> <p>Show that a cookbook has a supported platform. Use a version constraint to define dependencies for platform versions: <code>&lt;</code> (less than), <code>&lt;=</code> (less than or equal to), <code>=</code> (equal to), <code>&gt;=</code> (greater than or equal to), <code>~&gt;</code> (approximately greater than), or <code>&gt;</code> (greater than). To specify more than one platform, use more than one <code>supports</code> field, once for each platform.</p> <p>For example, to support every version of Ubuntu:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">supports <span style="color:#4070a0">'ubuntu'</span>
</code></pre></div>
<p>or, to support versions of Ubuntu greater than or equal to 20.04:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">supports <span style="color:#4070a0">'ubuntu'</span>, <span style="color:#4070a0">'&gt;= 20.04'</span>
</code></pre></div>
<p>or, to support only Ubuntu 20.04:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">supports <span style="color:#4070a0">'ubuntu'</span>, <span style="color:#4070a0">'= 20.04'</span>
</code></pre></div>
<p>Here is a list of all of the supported specific operating systems:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#c65d09">%w( aix amazon centos fedora freebsd debian oracle mac_os_x redhat suse opensuseleap ubuntu windowszlinux )</span><span style="color:#666">.</span>each <span style="color:#007020;font-weight:700">do</span> <span style="color:#666">|</span>os<span style="color:#666">|</span>
  supports os
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
</dd> <dt><code>version</code></dt> <dd> <p>The current version of a cookbook. Version numbers always follow a simple three-number version sequence.</p> <p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">version <span style="color:#4070a0">'2.0.0'</span>
</code></pre></div>
</dd> </dl> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/config_rb_metadata/" class="_attribution-link">https://docs.chef.io/config_rb_metadata/</a>
  </p>
</div>
