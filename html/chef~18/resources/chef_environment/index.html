<div id="col-content" data-swiftype-index="true"> <h1 id="chef_environment-resource">chef_environment Resource</h1>  <div class="prose"> <p data-swiftype-index="false"> <button onclick="resource_note_function('resource_note')" class="note-btn note-block note-left-align">Edit this page in the Chef repository</button> </p>
<div id="resource_note" class="note-container note-hide"> <p> This page is generated from the <a href="https://github.com/chef/chef">Chef Infra Client source code</a>. To suggest a change, edit the <a href="https://github.com/chef/chef/blob/main/lib/chef/resource/chef_environment.rb">chef_environment.rb</a> file and submit a pull request to the <a href="https://github.com/chef/chef">Chef Infra Client repository</a>. </p> </div> <p data-swiftype-index="false"><a href="../index.html">All Infra resources page</a></p> <hr> <p> An environment is a way to map an organization’s real-life workflow to what can be configured and managed when using Chef Infra. This mapping is accomplished by setting attributes and pinning cookbooks at the environment level. With environments, you can change cookbook configurations depending on the system’s designation. For example, by designating different staging and production environments, you can then define the correct URL of a database server for each environment. Environments also allow organizations to move new cookbook releases from staging to production with confidence by stepping releases through testing environments before entering production. </p> <p>Use the <strong>chef_environment</strong> resource to manage environments.</p> <h2 id="syntax">Syntax</h2> <hr> 
<p>The syntax for using the <strong>chef_environment</strong> resource in a recipe is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_environment <span style="color:#4070a0">'name'</span> <span style="color:#007020;font-weight:700">do</span>
  attribute <span style="color:#4070a0">'value'</span> <span style="color:#60a0b0;font-style:italic"># see properties section below</span>
  <span style="color:#666">...</span>
  action <span style="color:#517918">:action</span> <span style="color:#60a0b0;font-style:italic"># see actions section below</span>
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div> <p>where:</p> <ul> <li>
<code>chef_environment</code> tells Chef Infra Client to use the <code>Chef::Provider::ChefEnvironment</code> provider during a Chef Infra Client run</li> <li>
<code>name</code> is the name of the resource block; when the <code>name</code> property is not specified as part of a recipe, <code>name</code> is also the name of the environment</li> <li>
<code>attribute</code> is zero (or more) of the properties that are available for this resource</li> <li>
<code>action</code> identifies which steps Chef Infra Client will take to bring the node into the desired state</li> </ul> <h2 id="actions">Actions</h2> <hr> <p>The <strong>chef_environment</strong> resource has the following actions:</p> <dl> <dt><code>:create</code></dt> <dd>Default. Use to create an environment.</dd> <dt><code>:delete</code></dt> <dd>Use to delete an environment.</dd> <dt><code>:nothing</code></dt> <dd>This resource block does not act unless notified by another resource to take action. Once notified, this resource block either runs immediately or is queued up to run at the end of a Chef Infra Client run.</dd> </dl> <h2 id="properties">Properties</h2> <hr> <p>The <strong>chef_environment</strong> resource has the following properties:</p> <dl> <dt> <code>chef_server</code> </dt> <dd> <p>The URL for the Chef Infra Server.</p> </dd> </dl> <dl> <dt> <code>complete</code> </dt> <dd> <p>Use to specify if this resource defines an environment completely. When <code>true</code>, any property not specified by this resource will be reset to default property values.</p> </dd> </dl> <dl> <dt> <code>cookbook_versions</code> </dt> <dd> <p>The cookbook versions used with the environment. Default value: <code>{}</code>.</p> </dd> </dl> <dl> <dt> <code>default_attributes</code> </dt> <dd> <p> A <code>default</code> attribute is automatically reset at the start of every Chef Infra Client run and has the lowest attribute precedence. Use <code>default</code> attributes as often as possible in cookbooks. </p> <p>Default value: <code>{}</code>.</p> </dd> </dl> <dl> <dt> <code>description</code> </dt> <dd> <p>The description of the environment. This value populates the description field for the environment on the Chef Infra Server.</p> </dd> </dl> <dl> <dt> <code>ignore_failure</code> </dt> <dd> <strong>Ruby Type:</strong> true, false | <strong>Default Value:</strong> <code>false</code> <p>Continue running a recipe if a resource fails for any reason.</p> </dd> </dl> <dl> <dt> <code>name</code> </dt> <dd> <p>The name of the environment.</p> </dd> </dl> <dl> <dt> <code>notifies</code> </dt> <dd> <strong>Ruby Type:</strong> Symbol, Chef::Resource\[String\] 
<p>A resource may notify another resource to take action when its state changes. Specify a <code>'resource[name]'</code>, the <code>:action</code> that resource should take, and then the <code>:timer</code> for that action. A resource may notify more than one resource; use a <code>notifies</code> statement for each resource to be notified.</p> <p>If the referenced resource does not exist, an error is raised. In contrast, <code>subscribes</code> will not fail if the source resource is not found.</p>  
<p>A timer specifies the point during a Chef Infra Client run at which a notification is run. The following timers are available:</p> <dl> <dt><code>:before</code></dt> <dd> <p>Specifies that the action on a notified resource should be run before processing the resource block in which the notification is located.</p> </dd> <dt><code>:delayed</code></dt> <dd> <p>Default. Specifies that a notification should be queued up, and then executed at the end of a Chef Infra Client run.</p> </dd> <dt>
<code>:immediate</code>, <code>:immediately</code>
</dt> <dd> <p>Specifies that a notification should be run immediately, per resource notified.</p> </dd> </dl>  
<p>The syntax for <code>notifies</code> is:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">notifies <span style="color:#517918">:action</span>, <span style="color:#4070a0">'resource[name]'</span>, <span style="color:#517918">:timer</span>
</code></pre></div> </dd> </dl> <dl> <dt> <code>override_attributes</code> </dt> <dd> <p> An <code>override</code> attribute is automatically reset at the start of every Chef Infra Client run and has a higher attribute precedence than <code>default</code>, <code>force_default</code>, and <code>normal</code> attributes. An <code>override</code> attribute is most often specified in a recipe, but can be specified in an attribute file, for a role, and/or for an environment. A cookbook should be authored so that it uses <code>override</code> attributes only when required. </p> <p>Default value: <code>{}</code>.</p> </dd> </dl> <dl> <dt> <code>raw_json</code> </dt> <dd> 
<p>The environment as JSON data. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-javascript" data-lang="javascript">{
  <span style="color:#4070a0">"name"</span><span style="color:#666">:</span><span style="color:#4070a0">"backend"</span>,
  <span style="color:#4070a0">"description"</span><span style="color:#666">:</span><span style="color:#4070a0">""</span>,
  <span style="color:#4070a0">"cookbook_versions"</span><span style="color:#666">:</span>{},
  <span style="color:#4070a0">"json_class"</span><span style="color:#666">:</span><span style="color:#4070a0">"Chef::Environment"</span>,
  <span style="color:#4070a0">"chef_type"</span><span style="color:#666">:</span><span style="color:#4070a0">"environment"</span>,
  <span style="color:#4070a0">"default_attributes"</span><span style="color:#666">:</span>{},
  <span style="color:#4070a0">"override_attributes"</span><span style="color:#666">:</span>{}
}
</code></pre></div> </dd> </dl> <dl> <dt> <code>subscribes</code> </dt> <dd> <strong>Ruby Type:</strong> Symbol, Chef::Resource\[String\] 
<p>A resource may listen to another resource, and then take action if the state of the resource being listened to changes. Specify a <code>'resource[name]'</code>, the <code>:action</code> to be taken, and then the <code>:timer</code> for that action.</p> <p>Note that <code>subscribes</code> does not apply the specified action to the resource that it listens to - for example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">file <span style="color:#4070a0">'/etc/nginx/ssl/example.crt'</span> <span style="color:#007020;font-weight:700">do</span>
  mode <span style="color:#4070a0">'0600'</span>
  owner <span style="color:#4070a0">'root'</span>
<span style="color:#007020;font-weight:700">end</span>

service <span style="color:#4070a0">'nginx'</span> <span style="color:#007020;font-weight:700">do</span>
  subscribes <span style="color:#517918">:reload</span>, <span style="color:#4070a0">'file[/etc/nginx/ssl/example.crt]'</span>, <span style="color:#517918">:immediately</span>
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<p>In this case the <code>subscribes</code> property reloads the <code>nginx</code> service whenever its certificate file, located under <code>/etc/nginx/ssl/example.crt</code>, is updated. <code>subscribes</code> does not make any changes to the certificate file itself, it merely listens for a change to the file, and executes the <code>:reload</code> action for its resource (in this example <code>nginx</code>) when a change is detected.</p> <p>If the other resource does not exist, the subscription will not raise an error. Contrast this with the stricter semantics of <code>notifies</code>, which will raise an error if the other resource does not exist.</p>  
<p>A timer specifies the point during a Chef Infra Client run at which a notification is run. The following timers are available:</p> <dl> <dt><code>:before</code></dt> <dd> <p>Specifies that the action on a notified resource should be run before processing the resource block in which the notification is located.</p> </dd> <dt><code>:delayed</code></dt> <dd> <p>Default. Specifies that a notification should be queued up, and then executed at the end of a Chef Infra Client run.</p> </dd> <dt>
<code>:immediate</code>, <code>:immediately</code>
</dt> <dd> <p>Specifies that a notification should be run immediately, per resource notified.</p> </dd> </dl>  
<p>The syntax for <code>subscribes</code> is:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">subscribes <span style="color:#517918">:action</span>, <span style="color:#4070a0">'resource[name]'</span>, <span style="color:#517918">:timer</span>
</code></pre></div> </dd> </dl> <h2 id="examples">Examples</h2> <hr> <p>This resource does not have any examples.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/resources/chef_environment/" class="_attribution-link">https://docs.chef.io/resources/chef_environment/</a>
  </p>
</div>
