<div id="col-content" data-swiftype-index="true"> <h1 id="chef_client-resource">chef_client Resource</h1>  <div class="prose"> <p data-swiftype-index="false"> <button onclick="resource_note_function('resource_note')" class="note-btn note-block note-left-align">Edit this page in the Chef repository</button> </p>
<div id="resource_note" class="note-container note-hide"> <p> This page is generated from the <a href="https://github.com/chef/chef">Chef Infra Client source code</a>. To suggest a change, edit the <a href="https://github.com/chef/chef/blob/main/lib/chef/resource/chef_client.rb">chef_client.rb</a> file and submit a pull request to the <a href="https://github.com/chef/chef">Chef Infra Client repository</a>. </p> </div> <p data-swiftype-index="false"><a href="../index.html">All Infra resources page</a></p> <hr> <p>Use the <strong>chef_client</strong> resource to create clients on your Chef Infra Server from within Chef Infra cookbook code.</p> <h2 id="syntax">Syntax</h2> <hr> 
<p>The syntax for using the <strong>chef_client</strong> resource in a recipe is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_client <span style="color:#4070a0">'name'</span> <span style="color:#007020;font-weight:700">do</span>
  attribute <span style="color:#4070a0">'value'</span> <span style="color:#60a0b0;font-style:italic"># see properties section below</span>
  <span style="color:#666">...</span>
  action <span style="color:#517918">:action</span> <span style="color:#60a0b0;font-style:italic"># see actions section below</span>
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div> <p>where:</p> <ul> <li>
<code>chef_client</code> tells Chef Infra Client to use the <code>Chef::Provider::ChefClient</code> provider during a Chef Infra Client run</li> <li>
<code>name</code> is the name of the resource block; when the <code>name</code> property is not specified as part of a recipe, <code>name</code> is also the name of the Chef Infra Client</li> <li>
<code>attribute</code> is zero (or more) of the properties that are available for this resource</li> <li>
<code>action</code> identifies which steps Chef Infra Client will take to bring the node into the desired state</li> </ul> <h2 id="actions">Actions</h2> <hr> <p>The <strong>chef_client</strong> resource has the following actions:</p> <dl> <dt><code>:create</code></dt> <dd>Default. Use to create a chef-client.</dd> <dt><code>:delete</code></dt> <dd>Use to delete a chef-client.</dd> <dt><code>:nothing</code></dt> <dd>This resource block does not act unless notified by another resource to take action. Once notified, this resource block either runs immediately or is queued up to run at the end of a Chef Infra Client run.</dd> <dt><code>:regenerate_keys</code></dt> <dd>Use to regenerate the RSA public key for a chef-client.</dd> </dl> <h2 id="properties">Properties</h2> <hr> <p>The <strong>chef_client</strong> resource has the following properties:</p> <dl> <dt> <code>admin</code> </dt> <dd> <p>Use to specify whether Chef Infra Client is an API client.</p> </dd> </dl> <dl> <dt> <code>chef_server</code> </dt> <dd> <p>The URL for the Chef Infra Server.</p> </dd> </dl> <dl> <dt> <code>complete</code> </dt> <dd> <p>Use to specify if this resource defines a chef-client completely. When <code>true</code>, any property not specified by this resource will be reset to default property values.</p> </dd> </dl> <dl> <dt> <code>ignore_failure</code> </dt> <dd> <strong>Ruby Type:</strong> true, false | <strong>Default Value:</strong> <code>false</code> <p>Continue running a recipe if a resource fails for any reason.</p> </dd> </dl> <dl> <dt> <code>name</code> </dt> <dd> <p>The name of Chef Infra Client.</p> </dd> </dl> <dl> <dt> <code>notifies</code> </dt> <dd> <strong>Ruby Type:</strong> Symbol, Chef::Resource\[String\] 
<p>A resource may notify another resource to take action when its state changes. Specify a <code>'resource[name]'</code>, the <code>:action</code> that resource should take, and then the <code>:timer</code> for that action. A resource may notify more than one resource; use a <code>notifies</code> statement for each resource to be notified.</p> <p>If the referenced resource does not exist, an error is raised. In contrast, <code>subscribes</code> will not fail if the source resource is not found.</p>  
<p>A timer specifies the point during a Chef Infra Client run at which a notification is run. The following timers are available:</p> <dl> <dt><code>:before</code></dt> <dd> <p>Specifies that the action on a notified resource should be run before processing the resource block in which the notification is located.</p> </dd> <dt><code>:delayed</code></dt> <dd> <p>Default. Specifies that a notification should be queued up, and then executed at the end of a Chef Infra Client run.</p> </dd> <dt>
<code>:immediate</code>, <code>:immediately</code>
</dt> <dd> <p>Specifies that a notification should be run immediately, per resource notified.</p> </dd> </dl>  
<p>The syntax for <code>notifies</code> is:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">notifies <span style="color:#517918">:action</span>, <span style="color:#4070a0">'resource[name]'</span>, <span style="color:#517918">:timer</span>
</code></pre></div> </dd> </dl> <dl> <dt> <code>output_key_format</code> </dt> <dd> <p>Use to specify the format of a public key. Possible values: <code>pem</code>, <code>der</code>, or <code>openssh</code>. Default value: <code>openssh</code>.</p> </dd> </dl> <dl> <dt> <code>output_key_path</code> </dt> <dd> <p>Use to specify the path to the location in which a public key will be written.</p> </dd> </dl> <dl> <dt> <code>raw_json</code> </dt> <dd> 
<p>Chef Infra Client as JSON data. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-javascript" data-lang="javascript">{
  <span style="color:#4070a0">"clientname"</span><span style="color:#666">:</span> <span style="color:#4070a0">"client_name"</span>,
  <span style="color:#4070a0">"orgname"</span><span style="color:#666">:</span> <span style="color:#4070a0">"org_name"</span>,
  <span style="color:#4070a0">"validator"</span><span style="color:#666">:</span> <span style="color:#007020;font-weight:700">false</span>,
  <span style="color:#4070a0">"certificate"</span><span style="color:#666">:</span> <span style="color:#4070a0">"-----BEGIN CERTIFICATE-----\n
</span><span style="color:#4070a0">                  ...
</span><span style="color:#4070a0">                  1234567890abcdefghijklmnopq\n
</span><span style="color:#4070a0">                  ...
</span><span style="color:#4070a0">                  -----END CERTIFICATE-----\n"</span>,
  <span style="color:#4070a0">"name"</span><span style="color:#666">:</span> <span style="color:#4070a0">"node_name"</span>
}
</code></pre></div> </dd> </dl> <dl> <dt> <code>source_key</code> </dt> <dd> <p>Use to copy a public or private key, but apply a different <code>format</code> and <code>password</code>. Use in conjunction with <code>source_key_pass_phrase</code> and <code>source_key_path</code>.</p> </dd> </dl> <dl> <dt> <code>source_key_pass_phrase</code> </dt> <dd> <p>The pass phrase for the public key. Use in conjunction with <code>source_key</code> and <code>source_key_path</code>.</p> </dd> </dl> <dl> <dt> <code>source_key_path</code> </dt> <dd> <p>The path to the public key. Use in conjunction with <code>source_key</code> and <code>source_key_pass_phrase</code>.</p> </dd> </dl> <dl> <dt> <code>subscribes</code> </dt> <dd> <strong>Ruby Type:</strong> Symbol, Chef::Resource\[String\] 
<p>A resource may listen to another resource, and then take action if the state of the resource being listened to changes. Specify a <code>'resource[name]'</code>, the <code>:action</code> to be taken, and then the <code>:timer</code> for that action.</p> <p>Note that <code>subscribes</code> does not apply the specified action to the resource that it listens to - for example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">file <span style="color:#4070a0">'/etc/nginx/ssl/example.crt'</span> <span style="color:#007020;font-weight:700">do</span>
  mode <span style="color:#4070a0">'0600'</span>
  owner <span style="color:#4070a0">'root'</span>
<span style="color:#007020;font-weight:700">end</span>

service <span style="color:#4070a0">'nginx'</span> <span style="color:#007020;font-weight:700">do</span>
  subscribes <span style="color:#517918">:reload</span>, <span style="color:#4070a0">'file[/etc/nginx/ssl/example.crt]'</span>, <span style="color:#517918">:immediately</span>
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<p>In this case the <code>subscribes</code> property reloads the <code>nginx</code> service whenever its certificate file, located under <code>/etc/nginx/ssl/example.crt</code>, is updated. <code>subscribes</code> does not make any changes to the certificate file itself, it merely listens for a change to the file, and executes the <code>:reload</code> action for its resource (in this example <code>nginx</code>) when a change is detected.</p> <p>If the other resource does not exist, the subscription will not raise an error. Contrast this with the stricter semantics of <code>notifies</code>, which will raise an error if the other resource does not exist.</p>  
<p>A timer specifies the point during a Chef Infra Client run at which a notification is run. The following timers are available:</p> <dl> <dt><code>:before</code></dt> <dd> <p>Specifies that the action on a notified resource should be run before processing the resource block in which the notification is located.</p> </dd> <dt><code>:delayed</code></dt> <dd> <p>Default. Specifies that a notification should be queued up, and then executed at the end of a Chef Infra Client run.</p> </dd> <dt>
<code>:immediate</code>, <code>:immediately</code>
</dt> <dd> <p>Specifies that a notification should be run immediately, per resource notified.</p> </dd> </dl>  
<p>The syntax for <code>subscribes</code> is:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">subscribes <span style="color:#517918">:action</span>, <span style="color:#4070a0">'resource[name]'</span>, <span style="color:#517918">:timer</span>
</code></pre></div> </dd> </dl> <dl> <dt> <code>validator</code> </dt> <dd> <p>Use to specify if Chef Infra Client is a chef-validator.</p> </dd> </dl> <h2 id="examples">Examples</h2> <hr> <p>This resource does not have any examples.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/resources/chef_client/" class="_attribution-link">https://docs.chef.io/resources/chef_client/</a>
  </p>
</div>
