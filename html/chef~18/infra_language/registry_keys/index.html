<div id="col-content" data-swiftype-index="true"> <div id="chef-infra-language-reading-registry-keys"><h1>Chef Infra Language: Reading Registry Keys</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/infra_language/registry_keys.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Six methods are present in the Chef Infra Language to help verify the registry during a Chef Infra Client run on the Microsoft Windows platform—<code>registry_data_exists?</code>, <code>registry_get_subkeys</code>, <code>registry_get_values</code>, <code>registry_has_subkeys?</code>, <code>registry_key_exists?</code>, and <code>registry_value_exists?</code>—these helpers ensure the <strong>powershell_script</strong> resource is idempotent.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> The recommended order in which registry key-specific methods should be used within a recipe is: <code>key_exists?</code>, <code>value_exists?</code>, <code>data_exists?</code>, <code>get_values</code>, <code>has_subkeys?</code>, and then <code>get_subkeys</code>. </div> </div> <h2 id="registry_data_exists">registry_data_exists?</h2> <p>Use the <code>registry_data_exists?</code> method to find out if a Microsoft Windows registry key contains the specified data of the specified type under the value.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>This method can be used in recipes and from within the <code>not_if</code> and <code>only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> </div> <p>The syntax for the <code>registry_data_exists?</code> method is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">registry_data_exists?(
  <span style="color:#60add5">KEY_PATH</span>,
  { <span style="color:#007020">name</span>: <span style="color:#4070a0">'NAME'</span>, <span style="color:#517918">type</span>: <span style="color:#60add5">TYPE</span>, <span style="color:#517918">data</span>: <span style="color:#60add5">DATA</span> },
  <span style="color:#60add5">ARCHITECTURE</span>
)
</code></pre></div>
<p>where:</p> <ul> <li>
<code>KEY_PATH</code> is the path to the registry key value. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code>HKLM\SECURITY</code> and <code>HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code>HKEY_LOCAL_MACHINE</code>, <code>HKLM</code>, <code>HKEY_CURRENT_CONFIG</code>, <code>HKCC</code>, <code>HKEY_CLASSES_ROOT</code>, <code>HKCR</code>, <code>HKEY_USERS</code>, <code>HKU</code>, <code>HKEY_CURRENT_USER</code>, and <code>HKCU</code>.</li> <li>
<code>{ name: 'NAME', type: TYPE, data: DATA }</code> is a hash that contains the expected name, type, and data of the registry key value</li> <li>
<code>type:</code> represents the values available for registry keys in Microsoft Windows. Use <code>:binary</code> for REG_BINARY, <code>:string</code> for REG_SZ, <code>:multi_string</code> for REG_MULTI_SZ, <code>:expand_string</code> for REG_EXPAND_SZ, <code>:dword</code> for REG_DWORD, <code>:dword_big_endian</code> for REG_DWORD_BIG_ENDIAN, or <code>:qword</code> for REG_QWORD.</li> <li>
<code>ARCHITECTURE</code> is one of the following values: <code>:x86_64</code>, <code>:i386</code>, or <code>:machine</code>. Set to <code>:i386</code> to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows. Set to<code>:x86_64</code> to force write to a 64-bit registry location, however Chef Infra Client returns an exception if <code>:x86_64</code> is used on a 32-bit machine. Set to <code>:machine</code> to allow Chef Infra Client to allow Chef Infra Client to use the appropriate key location based on your node’s architecture. Default value: <code>:machine</code>.</li> </ul> <p>This method will return <code>true</code> or <code>false</code>.</p> <h2 id="registry_get_subkeys">registry_get_subkeys</h2> <p>Use the <code>registry_get_subkeys</code> method to get a list of registry key values that are present for a Microsoft Windows registry key.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>This method can be used in recipes and from within the <code>not_if</code> and <code>only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> </div> <p>The syntax for the <code>registry_get_subkeys</code> method is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">subkey_array <span style="color:#666">=</span> registry_get_subkeys(<span style="color:#60add5">KEY_PATH</span>, <span style="color:#60add5">ARCHITECTURE</span>)
</code></pre></div>
<p>where:</p> <ul> <li>
<code>KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code>HKLM\SECURITY</code> and <code>HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code>HKEY_LOCAL_MACHINE</code>, <code>HKLM</code>, <code>HKEY_CURRENT_CONFIG</code>, <code>HKCC</code>, <code>HKEY_CLASSES_ROOT</code>, <code>HKCR</code>, <code>HKEY_USERS</code>, <code>HKU</code>, <code>HKEY_CURRENT_USER</code>, and <code>HKCU</code>.</li> <li>
<code>ARCHITECTURE</code> is one of the following values: <code>:x86_64</code>, <code>:i386</code>, or <code>:machine</code>. Set to <code>:i386</code> to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows. Set to<code>:x86_64</code> to force write to a 64-bit registry location, however Chef Infra Client returns an exception if <code>:x86_64</code> is used on a 32-bit machine. Set to <code>:machine</code> to allow Chef Infra Client to allow Chef Infra Client to use the appropriate key location based on your node’s architecture. Default value: <code>:machine</code>.</li> </ul> <p>This returns an array of registry key values.</p> <h2 id="registry_get_values">registry_get_values</h2> <p>Use the <code>registry_get_values</code> method to get the registry key values (name, type, and data) for a Microsoft Windows registry key.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>This method can be used in recipes and from within the <code>not_if</code> and <code>only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> </div> <p>The syntax for the <code>registry_get_values</code> method is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">subkey_array <span style="color:#666">=</span> registry_get_values(<span style="color:#60add5">KEY_PATH</span>, <span style="color:#60add5">ARCHITECTURE</span>)
</code></pre></div>
<p>where:</p> <ul> <li>
<code>KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code>HKLM\SECURITY</code> and <code>HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code>HKEY_LOCAL_MACHINE</code>, <code>HKLM</code>, <code>HKEY_CURRENT_CONFIG</code>, <code>HKCC</code>, <code>HKEY_CLASSES_ROOT</code>, <code>HKCR</code>, <code>HKEY_USERS</code>, <code>HKU</code>, <code>HKEY_CURRENT_USER</code>, and <code>HKCU</code>.</li> <li>
<code>ARCHITECTURE</code> is one of the following values: <code>:x86_64</code>, <code>:i386</code>, or <code>:machine</code>. Set to <code>:i386</code> to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows. Set to<code>:x86_64</code> to force write to a 64-bit registry location, however Chef Infra Client returns an exception if <code>:x86_64</code> is used on a 32-bit machine. Set to <code>:machine</code> to allow Chef Infra Client to allow Chef Infra Client to use the appropriate key location based on your node’s architecture. Default value: <code>:machine</code>.</li> </ul> <p>This returns an array of registry key values.</p> <h2 id="registry_has_subkeys">registry_has_subkeys?</h2> <p>Use the <code>registry_has_subkeys?</code> method to find out if a Microsoft Windows registry key has one (or more) values.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>This method can be used in recipes and from within the <code>not_if</code> and <code>only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> </div> <p>The syntax for the <code>registry_has_subkeys?</code> method is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">registry_has_subkeys?(<span style="color:#60add5">KEY_PATH</span>, <span style="color:#60add5">ARCHITECTURE</span>)
</code></pre></div>
<p>where:</p> <ul> <li>
<code>KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code>HKLM\SECURITY</code> and <code>HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code>HKEY_LOCAL_MACHINE</code>, <code>HKLM</code>, <code>HKEY_CURRENT_CONFIG</code>, <code>HKCC</code>, <code>HKEY_CLASSES_ROOT</code>, <code>HKCR</code>, <code>HKEY_USERS</code>, <code>HKU</code>, <code>HKEY_CURRENT_USER</code>, and <code>HKCU</code>.</li> <li>
<code>ARCHITECTURE</code> is one of the following values: <code>:x86_64</code>, <code>:i386</code>, or <code>:machine</code>. Set to <code>:i386</code> to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows. Set to<code>:x86_64</code> to force write to a 64-bit registry location, however Chef Infra Client returns an exception if <code>:x86_64</code> is used on a 32-bit machine. Set to <code>:machine</code> to allow Chef Infra Client to allow Chef Infra Client to use the appropriate key location based on your node’s architecture. Default value: <code>:machine</code>.</li> </ul> <p>This method will return <code>true</code> or <code>false</code>.</p> <h2 id="registry_key_exists">registry_key_exists?</h2> <p>Use the <code>registry_key_exists?</code> method to find out if a Microsoft Windows registry key exists at the specified path.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>This method can be used in recipes and from within the <code>not_if</code> and <code>only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> </div> <p>The syntax for the <code>registry_key_exists?</code> method is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">registry_key_exists?(<span style="color:#60add5">KEY_PATH</span>, <span style="color:#60add5">ARCHITECTURE</span>)
</code></pre></div>
<p>where:</p> <ul> <li>
<code>KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code>HKLM\SECURITY</code> and <code>HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code>HKEY_LOCAL_MACHINE</code>, <code>HKLM</code>, <code>HKEY_CURRENT_CONFIG</code>, <code>HKCC</code>, <code>HKEY_CLASSES_ROOT</code>, <code>HKCR</code>, <code>HKEY_USERS</code>, <code>HKU</code>, <code>HKEY_CURRENT_USER</code>, and <code>HKCU</code>.</li> <li>
<code>ARCHITECTURE</code> is one of the following values: <code>:x86_64</code>, <code>:i386</code>, or <code>:machine</code>. Set to <code>:i386</code> to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows. Set to<code>:x86_64</code> to force write to a 64-bit registry location, however Chef Infra Client returns an exception if <code>:x86_64</code> is used on a 32-bit machine. Set to <code>:machine</code> to allow Chef Infra Client to allow Chef Infra Client to use the appropriate key location based on your node’s architecture. Default value: <code>:machine</code>.</li> </ul> <p>This method will return <code>true</code> or <code>false</code>. (Any registry key values that are associated with this registry key are ignored.)</p> <h2 id="registry_value_exists">registry_value_exists?</h2> <p>Use the <code>registry_value_exists?</code> method to find out if a registry key value exists. Use <code>registry_data_exists?</code> to test for the type and data of a registry key value.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>This method can be used in recipes and from within the <code>not_if</code> and <code>only_if</code> blocks in resources. This method is not designed to create or modify a registry key. If a registry key needs to be modified, use the <strong>registry_key</strong> resource.</p> </div> </div> <p>The syntax for the <code>registry_dvalue_exists?</code> method is as follows:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">registry_value_exists?(
  <span style="color:#60add5">KEY_PATH</span>,
  { <span style="color:#007020">name</span>: <span style="color:#4070a0">'NAME'</span> },
  <span style="color:#60add5">ARCHITECTURE</span>
)
</code></pre></div>
<p>where:</p> <ul> <li>
<code>KEY_PATH</code> is the path to the registry key. The path must include the registry hive, which can be specified either as its full name or as the 3- or 4-letter abbreviation. For example, both <code>HKLM\SECURITY</code> and <code>HKEY_LOCAL_MACHINE\SECURITY</code> are both valid and equivalent. The following hives are valid: <code>HKEY_LOCAL_MACHINE</code>, <code>HKLM</code>, <code>HKEY_CURRENT_CONFIG</code>, <code>HKCC</code>, <code>HKEY_CLASSES_ROOT</code>, <code>HKCR</code>, <code>HKEY_USERS</code>, <code>HKU</code>, <code>HKEY_CURRENT_USER</code>, and <code>HKCU</code>.</li> <li>
<code>{ name: 'NAME' }</code> is a hash that contains the name of the registry key value; if either <code>type:</code> or <code>:value</code> are specified in the hash, they are ignored</li> <li>
<code>type:</code> represents the values available for registry keys in Microsoft Windows. Use <code>:binary</code> for REG_BINARY, <code>:string</code> for REG_SZ, <code>:multi_string</code> for REG_MULTI_SZ, <code>:expand_string</code> for REG_EXPAND_SZ, <code>:dword</code> for REG_DWORD, <code>:dword_big_endian</code> for REG_DWORD_BIG_ENDIAN, or <code>:qword</code> for REG_QWORD.</li> <li>
<code>ARCHITECTURE</code> is one of the following values: <code>:x86_64</code>, <code>:i386</code>, or <code>:machine</code>. Set to <code>:i386</code> to read or write 32-bit registry keys on 64-bit machines running Microsoft Windows. Set to<code>:x86_64</code> to force write to a 64-bit registry location, however Chef Infra Client returns an exception if <code>:x86_64</code> is used on a 32-bit machine. Set to <code>:machine</code> to allow Chef Infra Client to allow Chef Infra Client to use the appropriate key location based on your node’s architecture. Default value: <code>:machine</code>.</li> </ul> <p>This method will return <code>true</code> or <code>false</code>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/infra_language/registry_keys/" class="_attribution-link">https://docs.chef.io/infra_language/registry_keys/</a>
  </p>
</div>
