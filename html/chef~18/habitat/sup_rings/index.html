<div id="col-content" data-swiftype-index="true"> <div id="setting-up-a-ring"><h1>Setting Up a Ring</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/habitat-sh/habitat/tree/main/components/docs-chef-io/content/habitat/sup_rings.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <h2 id="bastion-ring--permanent-peers">Bastion Ring / Permanent Peers</h2> <p>A “Bastion Ring” is a pattern for preventing rumor loss and a split brain in a network of Chef Habitat Supervisors - it is highly recommended for any real environment use case. Create a minimum of 3 Supervisors and join them together. They should not run any services and they should be marked as permanent peers - their only job is to spread rumors to each other. Then, when you provision additional Supervisors pass the network address of each Supervisor running in the Bastion Ring to the <code>--peer</code> argument of <code>hab sup run</code>. It’s recommended to create a Bastion Ring in any network zones which may become partitioned due to a hardware failure. For example, if you have a Chef Habitat ring spanning multiple data centers and clouds, each should have a bastion ring of a minimum of 3 Supervisors in addition to the Supervisors running your services.</p> <h2 id="using-a-scheduler">Using a Scheduler</h2> <p><strong>Note:</strong> If you are using a container scheduler such as the Kubernetes <code>kube-scheduler</code>, Docker Swarm mode, Mesos DC/OS’s Marathon or Chronos, or a PaaS such as Cloud Foundry, you should not follow the bastion ring pattern, because the scheduler handles persistence and orchestration on your behalf.</p> <p>More resources on schedulers:</p> <ul> <li><a href="../container_orchestration/index.html">Chef Habitat Container Orchestration</a></li> <li>Kubernetes <code>kube-scheduler</code>: <a href="https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler">https://kubernetes.io/docs/concepts/scheduling-eviction/kube-scheduler</a>
</li> <li>Docker Swarm mode: <a href="https://docs.docker.com/engine/swarm">https://docs.docker.com/engine/swarm</a>
</li> <li>Mesos DC/OS Marathon or Chronos: <a href="https://mesosphere.github.io/marathon/">https://mesosphere.github.io/marathon/</a>
</li> <li>Cloud Foundry: <a href="https://www.habitat.sh/get-started/cloudfoundry">https://www.habitat.sh/get-started/cloudfoundry</a>
</li> </ul> <h2 id="initial-peers">Initial Peer(s)</h2> <p>The initial peer(s) is a requirement of any distributed system. In Chef Habitat, a new Supervisor that is starting up looks for an initial peer(s) to join to begin sharing information about the health and status of peers and other services, to increase the health of the overall Ring.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/habitat/sup_rings/" class="_attribution-link">https://docs.chef.io/habitat/sup_rings/</a>
  </p>
</div>
