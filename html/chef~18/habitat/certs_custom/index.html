<div id="col-content" data-swiftype-index="true"> <div id="custom-certificates"><h1>Custom Certificates</h1></div> <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/habitat-sh/habitat/tree/main/components/docs-chef-io/content/habitat/certs_custom.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Many enterprise environments use custom certificates (for example, self-signed). For example, an on-premises Chef Habitat Builder Depot might have a self-signed SSL certificate.</p> <p>Attempting to perform an operation using the Habitat client to communicate with a service that has a custom certificate can produce an error, such as:</p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-output" data-lang="output">✗✗✗
✗✗✗ the handshake failed: The OpenSSL library reported an error: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed:s3_clnt.c:1269:: unable to get local issuer certificate
✗✗✗
</code></pre>
<p>One option to remediate this error is to define a <code>SSL_CERT_FILE</code> environment variable pointing to the custom certificate path before performing the client operation.</p> <p>The Habitat 0.85.0 release in September 2019 improved the handling of custom certificates. Now Habitat knows to look for custom certificates in the <code>~/.hab/cache/ssl</code> directory, which is <code>/hab/cache/ssl</code> when you are running as root. Copying multiple certificates–for example, a self-signed certificate and a custom certificate authority certificate–to the Chef Habitat cache directory makes them automatically available to the Habitat client.</p> <p>The <code>/hab/cache/ssl</code> directory is also available inside a Habitat Studio. As long as the certificates are inside the cache directory before you enter the Studio, you’ll also find them inside the Studio. In addition, if you’ve set the <code>SSL_CERT_FILE</code> environment variable, you’ll also find both it and the file that it points to inside the Studio<code>/hab/cache/ssl</code> directory.</p> <p>Note: The <code>cert.pem</code> file name is reserved for Habitat. Do not use <code>cert.pem</code> as a file name when copying certs into the cache directory.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/habitat/certs_custom/" class="_attribution-link">https://docs.chef.io/habitat/certs_custom/</a>
  </p>
</div>
