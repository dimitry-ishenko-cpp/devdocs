<div id="col-content" data-swiftype-index="true"> <div id="service-template-data"><h1>Service Template Data</h1></div>  <div class="prose"> <p>The following settings can be used during a Chef Habitat service’s lifecycle. This means that you can use these settings in any of the plan hooks, such as <code>init</code>, or <code>run</code>, and also in any templatized configuration file for your application or service.</p> <p>These configuration settings are referenced using the <a href="https://github.com/wycats/handlebars.js/">Handlebars.js</a> version of <a href="https://mustache.github.io/mustache.5.html">Mustache-style</a> tags.</p> <h2 id="sys">sys</h2> <p>System information</p> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>ctl_gateway_ip</td> <td>string</td> <td>Listening address for Supervisor’s Control Gateway.</td> </tr> <tr> <td>ctl_gateway_port</td> <td>integer</td> <td>Listening port for Supervisor’s Control Gateway.</td> </tr> <tr> <td>gossip_ip</td> <td>string</td> <td>Listening address for Supervisor’s gossip connection.</td> </tr> <tr> <td>gossip_port</td> <td>integer</td> <td>Listening port for Supervisor’s gossip connection.</td> </tr> <tr> <td>hostname</td> <td>string</td> <td>The hostname of the running service.</td> </tr> <tr> <td>http_gateway_ip</td> <td>string</td> <td>Listening address for Supervisor’s HTTP gateway.</td> </tr> <tr> <td>http_gateway_port</td> <td>integer</td> <td>Listening port for Supervisor’s HTTP gateway.</td> </tr> <tr> <td>ip</td> <td>string</td> <td>The IP address of the running service.</td> </tr> <tr> <td>member_id</td> <td>string</td> <td>The member’s Supervisor ID, e.g., <code>3d1e73ff19464a27aea3cdc5c2243f74</code>
</td> </tr> <tr> <td>permanent</td> <td>boolean</td> <td>Set to true if a Supervisor is being used as a permanent peer, to increase Ring network traffic stability.</td> </tr> <tr> <td>version</td> <td>string</td> <td>Version of the Habitat Supervisor, e.g., <code>0.54.0/20180221023448</code>
</td> </tr> </tbody> </table> <h2 id="pkg">pkg</h2> <p>Details about the package currently running the service</p> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>ident</td> <td>string</td> <td>The fully-qualified identifier of the running package, e.g., <code>core/redis/3.2.4/20170514150022</code>
</td> </tr> <tr> <td>origin</td> <td>string</td> <td>The origin of the Habitat package</td> </tr> <tr> <td>name</td> <td>string</td> <td>The name of the Habitat package</td> </tr> <tr> <td>version</td> <td>string</td> <td>The version of the Habitat package</td> </tr> <tr> <td>release</td> <td>string</td> <td>The release of the Habitat package</td> </tr> <tr> <td>deps</td> <td>array</td> <td>An array of runtime dependencies for your package based on the <code>pkg_deps</code> setting in a plan</td> </tr> <tr> <td>env</td> <td>object</td> <td>The runtime environment of your package, mirroring the contents of the <code>RUNTIME_ENVIRONMENT</code> metadata file. The <code>PATH</code> variable is set, containing all dependencies of your package, as well as any other runtime environment variables that have been set by the package. Individual variables can be accessed directly, like <code>{{pkg.env.PATH}}</code> (the keys are case sensitive).</td> </tr> <tr> <td>exposes</td> <td>array</td> <td>The array of ports to expose for an application or service. This value is pulled from the pkg_exposes setting in a plan.</td> </tr> <tr> <td>exports</td> <td>object</td> <td>A map of export key to internal configuration value key (i.e., the contents of <code>pkg_exports</code> in your plan). The key is what external services consume. The value is a key in your <code>default.toml</code> file that corresponds to the data being exported.</td> </tr> <tr> <td>path</td> <td>string</td> <td>The location where the package is installed locally, e.g., <code>/hab/pkgs/core/redis/3.2.4/20170514150022</code>. Note that this is <em>not</em> a <code>PATH</code> environment variable; for that, please see the <code>env</code> key above.</td> </tr> <tr> <td>svc_path</td> <td>string</td> <td>The root location of the source files for the Habitat service, e.g., <code>/hab/svc/redis</code>.</td> </tr> <tr> <td>svc_config_path</td> <td>string</td> <td>The location of any templated configuration files for the Habitat service, e.g., <code>/hab/svc/redis/config</code>.</td> </tr> <tr> <td>svc_data_path</td> <td>string</td> <td>The location of any data files for the Habitat service, e.g., <code>/hab/svc/redis/data</code>.</td> </tr> <tr> <td>svc_files_path</td> <td>string</td> <td>The location of any gossiped configuration files for the Habitat service, e.g., <code>/hab/svc/redis/files</code>.</td> </tr> <tr> <td>svc_static_path</td> <td>string</td> <td>The location of any static content for the Habitat service, e.g., <code>/hab/svc/redis/static</code>.</td> </tr> <tr> <td>svc_var_path</td> <td>string</td> <td>The location of any variable state data for the Habitat service, e.g., <code>/hab/svc/redis/var</code>.</td> </tr> <tr> <td>svc_pid_file</td> <td>string</td> <td>The location of the Habitat service pid file, e.g., <code>/hab/svc/redis/PID</code>.</td> </tr> <tr> <td>svc_run</td> <td>string</td> <td>The location of the rendered run hook for the Habitat service, e.g., <code>/hab/svc/redis/run</code>.</td> </tr> <tr> <td>svc_user</td> <td>string</td> <td>The value of <code>pkg_svc_user</code> specified in a plan.</td> </tr> <tr> <td>svc_group</td> <td>string</td> <td>The value of <code>pkg_svc_group</code> specified in a plan.</td> </tr> </tbody> </table> <h2 id="cfg">cfg</h2> <p>These are settings defined in your templatized configuration file. The values for those settings are pulled from the <code>default.toml</code> file included in your package.</p> <h2 id="svc">svc</h2> <p>Information about the current service’s service group</p> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>service</td> <td>string</td> <td>The name of the service. If the service is running from the package <code>core/redis</code>, the value will be <code>redis</code>.</td> </tr> <tr> <td>group</td> <td>string</td> <td>The group portion of the service’s complete group name. In the group name <code>redis.default</code>, the group’s value is <code>default</code>.</td> </tr> <tr> <td>org</td> <td>string</td> <td>The organization portion of a service group specification. Unused at this time.</td> </tr> <tr> <td>election_is_running</td> <td>boolean</td> <td>Whether a leader election is currently running for this service</td> </tr> <tr> <td>election_is_no_quorum</td> <td>boolean</td> <td>Whether there is quorum for a leader election for this service</td> </tr> <tr> <td>election_is_finished</td> <td>boolean</td> <td>Whether a leader election for this service has finished</td> </tr> <tr> <td>update_election_is_running</td> <td>boolean</td> <td>Whether an update leader election is currently running for this service</td> </tr> <tr> <td>update_election_is_no_quorum</td> <td>boolean</td> <td>Whether there is quorum for an update leader election for this service</td> </tr> <tr> <td>update_election_is_finished</td> <td>boolean</td> <td>Whether an update leader election for this service has finished</td> </tr> <tr> <td>me</td> <td><a href="#svc_member">svc_member</a></td> <td>An object that provides information about the service running on the local Supervisor</td> </tr> <tr> <td>first</td> <td><a href="#svc_member">svc_member</a></td> <td>The first member of this service group, or the leader, if running in a leader topology</td> </tr> <tr> <td>members</td> <td>array</td> <td>All active members (<code>alive</code> and <code>suspect</code>) of the service group, across the entire ring. As of 0.56.0, does <em>not</em> include <code>departed</code> or <code>confirmed</code> members</td> </tr> <tr> <td>leader</td> <td><a href="#svc_member">svc_member</a></td> <td>The current leader of the service group, if any (<code>null</code> otherwise)</td> </tr> <tr> <td>update_leader</td> <td><a href="#svc_member">svc_member</a></td> <td>The current update_leader of the service group, if any (<code>null</code> otherwise)</td> </tr> </tbody> </table> <h2 id="bind">bind</h2> <p>Exposes information about the service groups this service is bound to. Each key is the name of a bind, while each value is one of the objects described below</p> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>first</td> <td><a href="#svc_member">svc_member</a></td> <td>The first member of this service group. If the group is running in a leader topology, this will also be the leader.</td> </tr> <tr> <td>leader</td> <td><a href="#svc_member">svc_member</a></td> <td>The current leader of this service group, if running in a leader topology</td> </tr> <tr> <td>members</td> <td>array</td> <td>All active members (<code>alive</code> and <code>suspect</code>) of the service group, across the entire ring. As of 0.56.0, does <em>not</em> include <code>departed</code> or <code>confirmed</code> members</td> </tr> </tbody> </table> <h2 id="reference-objects">Reference Objects</h2> <p>Some of the template expressions referenced above return objects of a specific shape; for example, the <code>svc.me</code> and <code>svc.first</code> expressions return “service member” objects, and the <code>pkg</code> property of a service member returns a “package identifier” object. These are defined below.</p> <h2 id="package_identifier">package_identifier</h2> <p>A Habitat package identifier, split apart into its constituent components</p> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>origin</td> <td>string</td> <td>The origin of the Habitat package</td> </tr> <tr> <td>name</td> <td>string</td> <td>The name of the Habitat package</td> </tr> <tr> <td>version</td> <td>string</td> <td>The version of the Habitat package</td> </tr> <tr> <td>release</td> <td>string</td> <td>The release of the Habitat package</td> </tr> </tbody> </table> <h2 id="svc_member">svc_member</h2> <p>Represents a member of a service group</p> <table> <thead> <tr> <th>Property</th> <th>Type</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>member_id</td> <td>string</td> <td>the member’s Supervisor id, e.g., 3d1e73ff19464a27aea3cdc5c2243f74</td> </tr> <tr> <td>alive</td> <td>boolean</td> <td>Whether this member is considered alive and connected to the ring, from a network perspective.</td> </tr> <tr> <td>suspect</td> <td>boolean</td> <td>Whether this member is considered “suspect”, or possibly unreachable, from a network perspective.</td> </tr> <tr> <td>confirmed</td> <td>boolean</td> <td>Whether this member is confirmed dead / unreachable, from a network perspective.</td> </tr> <tr> <td>departed</td> <td>boolean</td> <td>Whether this member has been departed from the ring (i.e., permanently gone, never to return).</td> </tr> <tr> <td>election_is_running</td> <td>boolean</td> <td>Whether a leader election is currently running for this service</td> </tr> <tr> <td>election_is_no_quorum</td> <td>boolean</td> <td>Whether there is quorum for a leader election for this service</td> </tr> <tr> <td>election_is_finished</td> <td>boolean</td> <td>Whether a leader election for this service has finished</td> </tr> <tr> <td>update_election_is_running</td> <td>boolean</td> <td>Whether an update leader election is currently running for this service</td> </tr> <tr> <td>update_election_is_no_quorum</td> <td>boolean</td> <td>Whether there is quorum for an update leader election for this service</td> </tr> <tr> <td>update_election_is_finished</td> <td>boolean</td> <td>Whether an update leader election for this service has finished</td> </tr> <tr> <td>leader</td> <td>boolean</td> <td>Whether this member is the leader in the service group (only meaningful in a leader topology)</td> </tr> <tr> <td>follower</td> <td>boolean</td> <td>Whether this member is a follower in the service group (only meaningful in a leader topology)</td> </tr> <tr> <td>update_leader</td> <td>boolean</td> <td>Whether this member is the update leader in the service group (only meaningful in a leader topology)</td> </tr> <tr> <td>update_follower</td> <td>boolean</td> <td>Whether this member is an update follower in the service group (only meaningful in a leader topology)</td> </tr> <tr> <td>pkg</td> <td><a href="#package_identifier">package_identifier</a></td> <td>The identifier of the release the member is running</td> </tr> <tr> <td>package</td> <td>string</td> <td>The package identifier</td> </tr> <tr> <td>sys</td> <td>object</td> <td>An abbreviated version of the top-level {{sys}} object, containing networking information for the member.</td> </tr> <tr> <td>cfg</td> <td>object</td> <td>The configuration the member is currently exporting. This is constrained by what is defined in <code>pkg_exports</code>, where the values are replaced with the current values (e.g., taking into account things like user.toml, gossiped configuration values, etc.)</td> </tr> <tr> <td>persistent</td> <td>boolean</td> <td>A misspelling of <code>permanent</code>; indicates whether a member is a permanent peer or not</td> </tr> <tr> <td>service</td> <td>string</td> <td>The name of the service. If the service is running from the package <code>core/redis</code>, the value will be <code>redis</code>.</td> </tr> <tr> <td>group</td> <td>string</td> <td>The group portion of the service’s complete group name. In the group name <code>redis.default</code>, the group’s value is <code>default</code>.</td> </tr> <tr> <td>org</td> <td>string</td> <td>The organization portion of a service group specification. Unused at this time.</td> </tr> </tbody> </table> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/habitat/service_templates/" class="_attribution-link">https://docs.chef.io/habitat/service_templates/</a>
  </p>
</div>
