<div id="col-content" data-swiftype-index="true"> <div id="working-with-proxies"><h1>Working with Proxies</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/proxies.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>In an environment that requires proxies to reach the Internet, many Chef commands will not work until they are configured correctly. To configure Chef to work in an environment that requires proxies, set the <code>http_proxy</code>, <code>https_proxy</code>, <code>ftp_proxy</code>, and/or <code>no_proxy</code> environment variables to specify the proxy settings using a lowercase value.</p> <h2 id="microsoft-windows">Microsoft Windows</h2> <p>To determine the current proxy server on the Microsoft Windows platform:</p> <ol> <li>Open <strong>Internet Properties</strong>.</li> <li>Open <strong>Connections</strong>.</li> <li>Open <strong>LAN settings</strong>.</li> <li>View the <strong>Proxy server</strong> setting. If this setting is blank, then a proxy server may not be available.</li> </ol> <p>To configure proxy settings in Microsoft Windows:</p> <ol> <li>Open <strong>System Properties</strong>.</li> <li>Open <strong>Environment Variables</strong>.</li> <li>Open <strong>System variables</strong>.</li> <li>Set <code>http_proxy</code> and <code>https_proxy</code> to the location of your proxy server. This value <strong>MUST</strong> be lowercase.</li> </ol> <h2 id="linux">Linux</h2> <p>To determine the current proxy server on the macOS and Linux platforms, check the environment variables. Run the following:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">env | grep -i http_proxy
</code></pre></div>
<p>If an environment variable is set, it <strong>MUST</strong> be lowercase. If it is not, add a lowercase version of that proxy variable to the shell (e.g. <code>~/.bashrc</code>) using one (or more) the following commands.</p> <p>For HTTP:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash"><span style="color:#007020">export</span> <span style="color:#bb60d5">http_proxy</span><span style="color:#666">=</span>http://myproxy.com:3168
</code></pre></div>
<p>For HTTPS:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash"><span style="color:#007020">export</span> <span style="color:#bb60d5">https_proxy</span><span style="color:#666">=</span>http://myproxy.com:3168
</code></pre></div>
<p>For FTP:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash"><span style="color:#007020">export</span> <span style="color:#bb60d5">ftp_proxy</span><span style="color:#666">=</span>ftp://myproxy.com:3168
</code></pre></div>
<h2 id="proxy-settings">Proxy Settings</h2> <p>Proxy settings are defined in configuration files for Chef Infra Client and for knife and may be specified for HTTP, HTTPS, and FTP.</p> <h3 id="http">HTTP</h3> <p>Use the following settings in the client.rb or config.rb files for environments that use an HTTP proxy:</p> <table> <col style="width:40%"> <col style="width:60%"> <thead> <tr class="header"> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>http_proxy</code></td> <td>The proxy server for HTTP connections. Default value: <code>nil</code>.</td> </tr> <tr> <td><code>http_proxy_pass</code></td> <td>The password for the proxy server when the proxy server is using an HTTP connection. Default value: <code>nil</code>.</td> </tr> <tr> <td><code>http_proxy_user</code></td> <td>The user name for the proxy server when the proxy server is using an HTTP connection. Default value: <code>nil</code>.</td> </tr> </tbody> </table> <h3 id="https">HTTPS</h3> <p>Use the following settings in the client.rb or config.rb files for environments that use an HTTPS proxy:</p> <table> <col style="width:40%"> <col style="width:60%"> <thead> <tr class="header"> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>https_proxy</code></td> <td>The proxy server for HTTPS connections. Default value: <code>nil</code>.</td> </tr> <tr> <td><code>https_proxy_pass</code></td> <td>The password for the proxy server when the proxy server is using an HTTPS connection. Default value: <code>nil</code>.</td> </tr> <tr> <td><code>https_proxy_user</code></td> <td>The user name for the proxy server when the proxy server is using an HTTPS connection. Default value: <code>nil</code>.</td> </tr> </tbody> </table> <h3 id="ftp">FTP</h3> <p>Use the following settings in the client.rb or config.rb files for environments that use an FTP proxy:</p> <table> <col style="width:40%"> <col style="width:60%"> <thead> <tr class="header"> <th>Setting</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td><code>ftp_proxy</code></td> <td>The proxy server for FTP connections.</td> </tr> <tr> <td><code>ftp_proxy_pass</code></td> <td>The password for the proxy server when the proxy server is using an FTP connection. Default value: <code>nil</code>.</td> </tr> <tr> <td><code>ftp_proxy_user</code></td> <td>The user name for the proxy server when the proxy server is using an FTP connection. Default value: <code>nil</code>.</td> </tr> </tbody> </table> <h3 id="no-proxy">No Proxy</h3> <p>The <code>no_proxy</code> setting is used to specify addresses for which the proxy should not be used. This can be a single address or a comma-separated list of addresses.</p> <p>Example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">no_proxy <span style="color:#4070a0">'test.example.com,test.example2.com,test.example3.com'</span>
</code></pre></div>
<div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Wildcard matching may be used in the <code>no_proxy</code> list—such as <code>no_proxy '*.*.example.*'</code>—however, many situations require hostnames to be specified explicitly (i.e. “without wildcards”). </div> </div> <h2 id="environment-variables">Environment Variables</h2> <p>Consider the following for situations where environment variables are used to set the proxy:</p> <ul> <li>Proxy settings may not be honored by all applications. For example, proxy settings may be ignored by the underlying application when specifying a <code>ftp</code> source with a <code>remote_file</code> resource. Consider a workaround. For example, in this situation try doing a <code>wget</code> with an <code>ftp</code> URL instead.</li> <li>Proxy settings may be honored inconsistently by applications. For example, the behavior of the <code>no_proxy</code> setting may not work with certain applications when wildcards are specified. Consider specifying the hostnames without using wildcards.</li> </ul> <h3 id="env">ENV</h3> <p>If <code>http_proxy</code>, <code>https_proxy</code>, <code>ftp_proxy</code>, or <code>no_proxy</code> is set in the client.rb file but not set in the <code>ENV</code>, Chef Infra Client will configure the <code>ENV</code> variable based on these (and related) settings. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">http_proxy <span style="color:#4070a0">'http://proxy.example.org:8080'</span>
http_proxy_user <span style="color:#4070a0">'myself'</span>
http_proxy_pass <span style="color:#4070a0">'Password1'</span>
</code></pre></div>
<p>Or an alternative way to define the proxy (if the previous version does not work):</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">http_proxy <span style="color:#4070a0">'http://myself:Password1@proxy.example.org:8080'</span>
</code></pre></div>
<p>will be set to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#60add5">ENV</span><span style="color:#666">[</span><span style="color:#4070a0">'http_proxy'</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">'http://myself:Password1@proxy.example.org:8080'</span>
</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/proxies/" class="_attribution-link">https://docs.chef.io/proxies/</a>
  </p>
</div>
