<div id="col-content" data-swiftype-index="true"> <div id="clientrb"><h1>client.rb</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/config_rb_client.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>The client.rb file specifies how Chef Infra Client is configured on a node and has the following characteristics:</p> <ul> <li>This file is loaded every time the chef-client executable is run.</li> <li>On Microsoft Windows machines, the default location for this file is <code>C:\chef\client.rb</code>. On all other systems the default location for this file is <code>/etc/chef/client.rb</code>.</li> <li>Use the <code>--config</code> option from the command line to override the default location of the configuration file.</li> <li>This file is not created by default</li> </ul> <h2 id="settings">Settings</h2> <p>This configuration file has the following settings:</p> <dl> <dt><code>add_formatter</code></dt> <dd>A 3rd-party formatter. (See <a href="https://github.com/andreacampi/nyan-cat-chef-formatter">nyan-cat</a> for an example of a 3rd-party formatter.) Each formatter requires its own entry.</dd> <dt><code>allowed_automatic_attributes</code></dt> <dd>A hash that allows <code>default</code> attributes, preventing non-allowed attributes from being saved.</dd> <dt><code>allowed_default_attributes</code></dt> <dd>A hash that allows <code>default</code> attributes, preventing non-allowed attributes from being saved.</dd> <dt><code>allowed_normal_attributes</code></dt> <dd>A hash that allows <code>normal</code> attributes, preventing non-allowed attributes from being saved.</dd> <dt><code>allowed_override_attributes</code></dt> <dd>A hash that allows <code>override</code> attributes, preventing non-allowed attributes from being saved.</dd> <dt><code>authentication_protocol_version</code></dt> <dd>Sets the authentication protocol that is used to communicate with Chef Infra Server. For example, specify protocol version 1.3 to enable support for SHA-256 algorithms: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">knife<span style="color:#666">[</span><span style="color:#517918">:authentication_protocol_version</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">'1.3'</span>
</code></pre></div>
<div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Authentication protocol 1.3 is only supported on Chef Server versions 12.4.0 and above. </div> </div> </dd> <dt><code>automatic_attribute_blacklist</code></dt> <dd>A hash that blocks <code>automatic</code> attributes, preventing blocked attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>blocked_automatic_attributes</code>.</dd> <dt><code>automatic_attribute_whitelist</code></dt> <dd>A hash that allows <code>automatic</code> attributes, preventing non-allowed attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>allowed_automatic_attributes</code>.</dd> <dt><code>blocked_automatic_attributes</code></dt> <dd>A hash that blocks <code>automatic</code> attributes, preventing blocked attributes from being saved.</dd> <dt><code>blocked_default_attributes</code></dt> <dd>A hash that blocks <code>default</code> attributes, preventing block attributes from being saved.</dd> <dt><code>blocked_normal_attributes</code></dt> <dd>A hash that allows <code>automatic</code> attributes, preventing non-allowed attributes from being saved.</dd> <dt><code>blocked_override_attributes</code></dt> <dd>A hash that blocks <code>override</code> attributes, preventing blocked attributes from being saved.</dd> <dt><code>cache_path</code></dt> <dd>The home directory for the user that runs Chef Infra Client as a non-root user.</dd> <dt><code>checksum_path</code></dt> <dd>The location in which checksum files are stored. These are used to validate individual cookbook files, such as recipes. The checksum itself is stored in the Chef Infra Server database and is then compared to a file in the checksum path that has a filename identical to the checksum.</dd> <dt><code>chef_guid</code></dt> <dd>The node UUID used by Automate. Setting this allows the node UUID to be specified, and can be carried across instances of a node.</dd> <dt><code>chef_license</code></dt> <dd>Used to accept the Chef license. Can be set to <code>accept</code> or <code>accept-no-persist</code>, which persists the license acceptance to disk. If passed to versions where the license is not required this configuration option is a no-op.</dd> <dt><code>chef_repo_path</code></dt> <dd>The path to the chef-repo containing cookbooks and other files, such as environments or data bags, when running Chef Infra Client in local mode.</dd> <dt><code>chef_server_url</code></dt> <dd>The URL of the Chef Infra Server. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#517918">https</span>:<span style="color:#235388">//</span>localhost<span style="color:#666">/</span>organizations<span style="color:#666">/</span><span style="color:#60add5">ORG_NAME</span>
</code></pre></div>
</dd> <dt><code>chef_zero.enabled</code></dt> <dd>Enable chef-zero. This setting requires <code>local_mode</code> to be set to <code>true</code>. Default value: <code>true</code> if running in local-mode, otherwise <code>false</code>.</dd> <dt><code>chef_zero.port</code></dt> <dd>The port on which chef-zero is to listen. If specified as a range, Chef Infra Client will take the first available port in the range. For example <code>10,20,30</code> or <code>10000-20000</code>. Default value: <code>8889-9999</code>.</dd> <dt><code>clear_gem_sources</code></dt> <dd>Globally sets the default of the <code>clear_sources</code> property on the <code>gem_package</code> and <code>chef_gem</code> resources. Default value: <code>false</code>.</dd> <dt><code>client_fork</code></dt> <dd>Contain Chef Infra Client runs in a secondary process with dedicated RAM. When a Chef Infra Client run is complete, the RAM is returned to the master process. This setting helps ensure that a Chef Infra Client uses a steady amount of RAM over time because the master process does not run recipes. This setting also helps prevent memory leaks such as those that can be introduced by the code contained within a poorly designed cookbook. Default value: <code>true</code>. Set to <code>false</code> to disable running Chef Infra Client in fork node. <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Must be set to <code>false</code> up to Chef Client 13.11.3 to gather the standard return code offered by <code>exit_status true</code>. Later versions run as expected without changes to the configuration file. </div> </div> </dd> <dt><code>client_key</code></dt> <dd>The location of the file that contains the client key. Default value: <code>/etc/chef/client.pem</code>.</dd> <dt><code>client_registration_retries</code></dt> <dd>The number of times a Chef Infra Client will attempt to register with a Chef Infra Server. Default value: <code>5</code>.</dd> <dt><code>client_d_dir</code></dt> <dd>A directory that contains additional configuration files for Chef Infra Client.</dd> <dt><code>cookbook_path</code></dt> <dd>The sub-directory for Chef Infra Client cookbooks. This value can be a string or an array of file system locations, processed in the specified order. The last cookbook is considered to override local modifications.</dd> <dt><code>cookbook_sync_threads</code></dt> <dd>The number of helper threads available for parallel cookbook synchronization. Increasing this value <strong>may</strong> increase the frequency of gateway errors from the Chef Infra Server (503 and 504 errors). Decreasing this number reduces the frequency of gateway errors, if present. Default value: <code>10</code>.</dd> <dt><code>data_bag_decrypt_minimum_version</code></dt> <dd>The minimum required version of data bag encryption. Possible values: <code>1</code>, <code>2</code>, and <code>3</code>. It is recommended to use the default value of <code>3</code> for additional encrypted data bag security.</dd> <dt><code>data_bag_path</code></dt> <dd>The location from which a data bag is loaded. Default value: <code>/var/chef/data_bags</code>.</dd> <dt><code>data_collector.server_url</code></dt> <dd>The fully qualified URL to the data collector server API.</dd> <dt><code>data_collector.token</code></dt> <dd>The shared data collector security token. When configured, the token will be passed as an HTTP header named <code>x-data-collector-token</code> which the server can choose to accept or reject.</dd> <dt><code>data_collector.mode</code></dt> <dd>The Chef Infra Client mode in which the Data Collector will be enabled. Possible values: <code>:solo</code>, <code>:client</code>, or <code>:both</code>. The <code>:solo</code> value is used for Chef Infra Client operating in Chef Solo Mode or Chef Solo Legacy Mode. Default value: <code>both</code>.</dd> <dt><code>data_collector.raise_on_failure</code></dt> <dd>When enabled, Chef Infra Client raises an error if it cannot successfully POST to the data collector server. Default value: <code>false</code>.</dd> <dt><code>default_attribute_blacklist</code></dt> <dd>A hash that blocks <code>default</code> attributes, preventing block attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>blocked_default_attributes</code>.</dd> <dt><code>default_attribute_whitelist</code></dt> <dd>A hash that allows <code>default</code> attributes, preventing non-allowed attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>allowed_default_attributes</code>.</dd> <dt><code>diff_disabled</code></dt> <dd>Cause Chef Infra Client to create a diff when changes are made to a file. Default value: <code>false</code>.</dd> <dt><code>diff_filesize_threshold</code></dt> <dd>The maximum size (in bytes) of a file for which Chef Infra Client can create a diff. Default value: <code>10000000</code>.</dd> <dt><code>diff_output_threshold</code></dt> <dd>The maximum size (in bytes) of a diff file Chef Infra Client can create. Default value: <code>1000000</code>.</dd> <dt><code>disable_event_logger</code></dt> <dd>Enable or disable sending Chef Infra Client internal state events to the Microsoft Windows “Application” event log. Set to <code>false</code> to send events to the Microsoft Windows “Application” event log at the start and end of a Chef Infra Client run, and also if a Chef Infra Client run fails. Use <code>log_location</code> to set the destination of your Chef Infra Client logs to the Windows event log. Set to <code>true</code> to disable event logging. Default value: <code>false</code>.</dd> <dt><code>enable_reporting</code></dt> <dd>Cause Chef Infra Client to send run data to the Automate server.</dd> <dt><code>enable_reporting_url_fatals</code></dt> <dd>Cause a Chef Infra Client run to fail when run data cannot be sent to the Automate server (for any reason).</dd> <dt><code>enable_selinux_file_permission_fixup</code></dt> <dd>SELinux environments only. Cause Chef Infra Client to attempt to apply the correct file permissions to an updated file via the <code>restorecon</code> command. Set to <code>false</code> to prevent Chef Infra Client from attempting this action.</dd> <dt><code>encrypted_data_bag_secret</code></dt> <dd>The subdirectory in which encrypted data bag secrets are located.</dd> <dt><code>enforce_default_paths</code></dt> <dd>Turn on path sanity in resources that shellout so that expected paths like /sbin or /bin are added to the PATH. Disabled by default.</dd> <dt><code>enforce_path_sanity</code></dt> <dd>Turn on path sanity in resources that shellout so that expected paths like /sbin or /bin are added to the PATH. Disabled by default. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>enforce_default_paths</code>.</dd> <dt><code>environment</code></dt> <dd>The name of the Chef Infra environment.</dd> <dt><code>environment_path</code></dt> <dd>The path to the environment file. Default value: <code>/var/chef/environments</code>.</dd> <dt><code>exit_status</code></dt> <dd>When set to <code>:enabled</code>, Chef Infra Client will use <a href="https://github.com/chef/chef/blob/main/docs/dev/design_documents/client_exit_codes.md#exit-codes-in-use">standardized exit codes</a> for the Chef Infra Client run status, and any non-standard exit codes will be converted to <code>1</code> or <code>GENERIC_FAILURE</code>. This setting can also be set to <code>:disabled</code> to use the pre-Chef Infra Client 13 exit code behavior. Default value: <code>nil</code>.</dd> <dt><code>file_atomic_update</code></dt> <dd>Apply atomic file updates to all resources. Set to <code>true</code> for global atomic file updates. Set to <code>false</code> for global non-atomic file updates. (Use the <code>atomic_update</code> setting on a per-resource basis to override this setting.) Default value: <code>true</code>. <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> Changing this setting to <code>false</code> may cause file corruption, data loss, or instability. Use the <code>atomic_update</code> property on the <strong>cookbook_file</strong>, <strong>file</strong>, <strong>remote_file</strong>, and <strong>template</strong> resources to tune this behavior at the recipe level. </div> </div> </dd> <dt><code>file_backup_path</code></dt> <dd>The location in which backup files are stored. If this value is empty, backup files are stored in the directory of the target file. Default value: <code>/var/chef/backup</code>.</dd> <dt><code>file_cache_path</code></dt> <dd>The location in which cookbooks (and other transient data) files are stored when they are synchronized. This value can also be used in recipes to download files with the <strong>remote_file</strong> resource.</dd> <dt><code>file_staging_uses_destdir</code></dt> <dd>How file staging (via temporary files) is done. When <code>true</code>, temporary files are created in the directory in which files will reside. When <code>false</code>, temporary files are created under <code>ENV['TMP']</code>. Default value: <code>true</code>.</dd> <dt><code>fips</code></dt> <dd>Allows OpenSSL to enforce FIPS-validated security during a Chef Infra Client run. Set to <code>true</code> to enable FIPS-validated security.</dd> <dt><code>force_formatter</code></dt> <dd>Using <span class="title-ref">force_formatter</span> causes chef to default to formatter output when STDOUT is not a tty</dd> <dt><code>force_logger</code></dt> <dd>Using <span class="title-ref">force_logger</span> causes chef to default to logger output when STDOUT is a tty</dd> <dt><code>ftp_proxy</code></dt> <dd>The proxy server for FTP connections.</dd> <dt><code>ftp_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using an FTP connection. Default value: <code>nil</code>.</dd> <dt><code>ftp_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using an FTP connection. Default value: <code>nil</code>.</dd> <dt><code>group</code></dt> <dd>The group that owns a process. This is required when starting any executable as a daemon. Default value: <code>nil</code>.</dd> <dt><code>gem_installer_bundler_options</code></dt> <dd>Additional options to pass to bundler when installing metadata for cookbook. Default value: <code>nil</code>. For example <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">gem_installer_bundler_options <span style="color:#666">=</span> <span style="color:#666">[</span>
  <span style="color:#4070a0">"--local"</span>, <span style="color:#4070a0">"--clean"</span>
<span style="color:#666">]</span>
</code></pre></div>
<p>or</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">gem_installer_bundler_options <span style="color:#666">=</span> <span style="color:#4070a0">"--local"</span>
</code></pre></div>
</dd> <dt><code>http_proxy</code></dt> <dd>The proxy server for HTTP connections. Default value: <code>nil</code>.</dd> <dt><code>http_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using a HTTP connection. Default value: <code>nil</code>.</dd> <dt><code>http_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using a HTTP connection. Default value: <code>nil</code>.</dd> <dt><code>http_retry_count</code></dt> <dd>The number of retry attempts. Default value: <code>5</code>.</dd> <dt><code>http_retry_delay</code></dt> <dd>The delay (in seconds) between retry attempts. Default value: <code>5</code>.</dd> <dt><code>https_proxy</code></dt> <dd>The proxy server for HTTPS connections. Default value: <code>nil</code>.</dd> <dt><code>https_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using a HTTPS connection. Default value: <code>nil</code>.</dd> <dt><code>https_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using a HTTPS connection. Default value: <code>nil</code>.</dd> <dt><code>interval</code></dt> <dd>The frequency (in seconds) at which Chef Infra Client runs when running in daemonized mode. We do not recommend running in daemonized mode. Instead you should rely on scheduled execution from system schedulers like systemd timers, cron jobs, or Windows Scheduled Tasks. Default value: <code>1800</code>.</dd> <dt><code>json_attribs</code></dt> <dd>The path to a file that contains JSON data.</dd> <dt><code>listen</code></dt> <dd>Run chef-zero in socketless mode. Set to <code>false</code> to disable port binding and HTTP requests on localhost.</dd> <dt><code>local_key_generation</code></dt> <dd>Whether the Chef Infra Server or Chef Infra Client generates the private/public key pair. When <code>true</code>, Chef Infra Client generates the key pair, and then sends the public key to the Chef Infra Server. Default value: <code>true</code>.</dd> <dt><code>local_mode</code></dt> <dd>Run Chef Infra Client in local mode. This allows all commands that work against the Chef Infra Server to also work against the local chef-repo.</dd> <dt><code>lockfile</code></dt> <dd>The location of the Chef Infra Client lock file. This value is typically platform dependent, so it should be a location defined by <code>file_cache_path</code>. The default location of a lock file should not be on an NFS mount. Default value: a location defined by <code>file_cache_path</code>.</dd> <dt><code>log_level</code></dt> <dd>The level of logging to be stored in a log file. Possible levels: <code>:auto</code> (default), <code>:trace</code>, <code>:debug</code>, <code>:info</code>, <code>:warn</code>, <code>:error</code>, or <code>:fatal</code>. The <code>:auto</code> level will use <code>:warn</code> when a terminal is available or <code>:info</code> when a terminal is not available.</dd> <dt><code>log_location</code></dt> <dd>The location of the log file. Possible values: <code>/path/to/log_location</code>, <code>STDOUT</code>, <code>STDERR</code>, <code>:win_evt</code> (Windows Event Logger), or <code>:syslog</code> (writes to the syslog daemon facility with the originator set as <code>chef-client</code>). The application log will specify the source as <code>Chef</code>. Default value: <code>STDOUT</code>.</dd> <dt><code>minimal_ohai</code></dt> <dd>Run a minimal set of Ohai plugins providing data necessary for the execution of Chef Infra Client’s built-in resources. Setting this to true will skip many large and time consuming plugins such as <code>cloud</code> or <code>packages</code>. Setting this to true may break cookbooks that assume all Ohai data will be present.</dd> <dt><code>named_run_list</code></dt> <dd>A specific named runlist defined in the node’s applied Policyfile which should be used when running Chef Infra Client.</dd> <dt><code>no_lazy_load</code></dt> <dd>Download all cookbook files and templates at the beginning of a Chef Infra Client run. Default value: <code>true</code>.</dd> <dt><code>no_proxy</code></dt> <dd>A comma-separated list of URLs that do not need a proxy. Default value: <code>nil</code>.</dd> <dt><code>node_name</code></dt> <dd>The unique identifier of the node. This determines which configuration should be applied and sets the <code>client_name</code>, which is the name used when authenticating to a Chef Infra Server. By default, Chef Infra Client will use the system’s FQDN as the node name. In general, Chef recommends that you leave this setting blank and let the client assign the FQDN of the node as the <code>node_name</code> during each Chef Infra Client run.</dd> <dt><code>node_path</code></dt> <dd>The location in which nodes are stored during a Chef Infra Client run in local mode. Default value: <code>/var/chef/node</code>.</dd> <dt><code>normal_attribute_blacklist</code></dt> <dd>A hash that blocks <code>normal</code> attributes, preventing blocked attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>blocked_normal_attributes</code>.</dd> <dt><code>override_attribute_blacklist</code></dt> <dd>A hash that blocks <code>override</code> attributes, preventing blocked attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>blocked_override_attributes</code>.</dd> <dt><code>normal_attribute_whitelist</code></dt> <dd>A hash that allows <code>normal</code> attributes, preventing non-allowed attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>allowed_normal_attributes</code>.</dd> <dt><code>override_normal_attributes</code></dt> <dd>A hash that allows <code>override</code> attributes, preventing non-allowed attributes from being saved.</dd> <dt><code>override_attribute_whitelist</code></dt> <dd>A hash that allows <code>override</code> attributes, preventing non-allowed attributes from being saved. <strong>Deprecated. EOL Chef Infra Client 18 (April 2022)</strong>: Use <code>allowed_override_attributes</code>.</dd> <dt><code>pid_file</code></dt> <dd>The location in which a process identification number (pid) is saved. An executable, when started as a daemon, writes the pid to the specified file. Default value: <code>/tmp/name-of-executable.pid</code>.</dd> <dt><code>policy_group</code></dt> <dd>The name of a policy group that exists on the Chef Infra Server. <code>policy_name</code> must also be specified.</dd> <dt><code>policy_group_path</code></dt> <dd>The location of policy_groups on disk.</dd> <dt><code>policy_name</code></dt> <dd>The name of a policy, as identified by the <code>name</code> setting in a Policyfile.rb file. <code>policy_group</code> must also be specified.</dd> <dt><code>policy_path</code></dt> <dd>The location of policies on disk.</dd> <dt><code>recipe_url</code></dt> <dd>A URL to download recipes from when running in local mode.</dd> <dt><code>rest_timeout</code></dt> <dd>The time (in seconds) after which an HTTP REST request is to time out. Default value: <code>300</code>.</dd> <dt><code>role_path</code></dt> <dd>The location in which role files are located. Default value: <code>/var/chef/roles</code>.</dd> <dt><code>rubygems_url</code></dt> <dd>The location to source rubygems. It can be set to a string or array of strings for URIs to set as rubygems sources. This allows individuals to setup an internal mirror of rubygems for “airgapped” environments. Default value: <code>https://www.rubygems.org</code>. If a <code>source</code> is specified in either <code>gem_package</code> of <code>chef_gem</code> resources it will be added to the values provided here.</dd> <dt><code>run_lock_timeout</code></dt> <dd>The amount of time (in seconds) to wait for a Chef Infra Client lock file to be deleted. A Chef Infra Client run will not start when a lock file is present. If a lock file is not deleted before this time expires, the pending Chef Infra Client run will exit. Default value: not set (indefinite). Set to <code>0</code> to cause a second Chef Infra Client to exit immediately.</dd> <dt><code>script_path</code></dt> <dd>An array of paths to search for knife exec scripts if they aren’t in the current directory</dd> <dt><code>skip_gem_metadata_installation</code></dt> <dd>when <code>skip_gem_metadata_installation</code> is set to true, cookbook gem installation will be skipped. Default value: <code>false</code>
</dd> <dt><code>splay</code></dt> <dd>A random number between zero and <code>splay</code> that is added to <code>interval</code>. Use splay to help balance the load on the Chef Infra Server by ensuring that many Chef Infra Client runs are not occurring at the same interval. Default value: <code>nil</code>.</dd> <dt><code>stream_execute_output</code></dt> <dd>Always stream the output of <code>execute</code> resources even if the <code>live_stream</code> property isn’t set to true. Default value: <code>false</code>
</dd> <dt><code>show_download_progress</code></dt> <dd>Using show_download_progress will display the overall progress of a <code>remote_file</code> download. Default value: <code>false</code>
</dd> <dt><code>download_progress_interval</code></dt> <dd>When <code>show_download_progress</code> is set to true this is the interval in seconds to write out download progress. Default value: <code>10</code>
</dd> <dt><code>ssl_ca_file</code></dt> <dd>The file in which the OpenSSL key is saved. Chef Infra Client generates this setting automatically and most users do not need to modify it.</dd> <dt><code>ssl_ca_path</code></dt> <dd>The path to where the OpenSSL key is located. Chef Infra Client generates this setting automatically and most users do not need to modify it.</dd> <dt><code>ssl_client_cert</code></dt> <dd>The OpenSSL X.509 certificate used for mutual certificate validation. This setting is only necessary when mutual certificate validation is configured on the Chef Infra Server. Default value:<code>nil</code>.</dd> <dt><code>ssl_client_key</code></dt> <dd>The OpenSSL X.509 key used for mutual certificate validation. This setting is only necessary when mutual certificate validation is configured on the Chef Infra Server. Default value: <code>nil</code>.</dd> <dt><code>ssl_verify_mode</code></dt> <dd>Set the verify mode for HTTPS requests. <ul> <li>Use <code>:verify_none</code> for no validation of SSL certificates.</li> <li>Use <code>:verify_peer</code> for validation of all SSL certificates, including the Chef Infra Server connections, S3 connections, and any HTTPS <strong>remote_file</strong> resource URLs used in Chef Infra Client runs. This is the recommended setting.</li> </ul> <p>Depending on how OpenSSL is configured, the <code>ssl_ca_path</code> may nee to be specified. Default value: <code>:verify_peer</code>.</p> </dd> <dt><code>trusted_certs_dir</code></dt> <dd>A directory that contains additional SSL certificates to trust. Any certificates in this directory will be added to whatever CA bundle ruby is using. Use this to add self-signed certs for your Chef Infra Server or local HTTP file servers. Default value: <code>trusted_certs</code> directory in your chef configuration directory.</dd> <dt><code>umask</code></dt> <dd>The file mode creation mask, or umask. Default value: <code>0022</code>.</dd> <dt><code>use_policyfile</code></dt> <dd>Chef Infra Client automatically checks the configuration, node JSON, and the stored node on the Chef Infra Server to determine if Policyfile files are in use, and then automatically updates this flag. Default value: <code>false</code>.</dd> <dt><code>user</code></dt> <dd>The user that owns a process. This is required when starting any executable as a daemon. Default value: <code>nil</code>.</dd> <dt><code>validation_client_name</code></dt> <dd>The name of the chef-validator key that Chef Infra Client uses to access the Chef Infra Server during the initial Chef Infra Client run. This is only used by the legacy validator based bootstrapping.</dd> <dt><code>validation_key</code></dt> <dd>The location of the file that contains the key used when a Chef Infra Client is registered with a Chef Infra Server. A validation key is signed using the <code>validation_client_name</code> for authentication. Default value: <code>/etc/chef/validation.pem</code>. This is only used by the legacy validator based bootstrapping.</dd> <dt><code>verbose_logging</code></dt> <dd>Set the log level. Options: <code>true</code>, <code>nil</code>, and <code>false</code>. When this is set to <code>false</code>, notifications about individual resources being processed are suppressed (and are output at the <code>:info</code> logging level). Setting this to <code>false</code> can be useful when a Chef Infra Client is run as a daemon. Default value: <code>nil</code>.</dd> <dt><code>verify_api_cert</code></dt> <dd>Verify the SSL certificate on the Chef Infra Server. When <code>true</code>, Chef Infra Client always verifies the SSL certificate. When <code>false</code>, Chef Infra Client uses the value of <code>ssl_verify_mode</code> to determine if the SSL certificate requires verification. Default value: <code>false</code>. A job entry may also be <code>'job-name' =&gt; {:lock =&gt; true}</code>, which will check the <code>lockfile</code> setting in the client.rb file before starting the job.</dd> </dl> <h3 id="automatic-proxy-config">Automatic Proxy Config</h3> <p>If <code>http_proxy</code>, <code>https_proxy</code>, <code>ftp_proxy</code>, or <code>no_proxy</code> is set in the client.rb file but not set in the <code>ENV</code>, Chef Infra Client will configure the <code>ENV</code> variable based on these (and related) settings. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">http_proxy <span style="color:#4070a0">'http://proxy.example.org:8080'</span>
http_proxy_user <span style="color:#4070a0">'myself'</span>
http_proxy_pass <span style="color:#4070a0">'Password1'</span>
</code></pre></div>
<p>Or an alternative way to define the proxy (if the previous version does not work):</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">http_proxy <span style="color:#4070a0">'http://myself:Password1@proxy.example.org:8080'</span>
</code></pre></div>
<p>will be set to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#60add5">ENV</span><span style="color:#666">[</span><span style="color:#4070a0">'http_proxy'</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">'http://myself:Password1@proxy.example.org:8080'</span>
</code></pre></div>
<h2 id="d-directories">.d Directories</h2> <p>Chef Infra Client supports reading multiple configuration files by putting them inside a <code>.d</code> configuration directory. For example: <code>/etc/chef/client.d</code>. All files that end in <code>.rb</code> in the <code>.d</code> directory are loaded; other non-<code>.rb</code> files are ignored.</p> <p><code>.d</code> directories may exist in any location where the <code>client.rb</code>, <code>config.rb</code>, or <code>solo.rb</code> files are present, such as:</p> <ul> <li><code>/etc/chef/client.d</code></li> <li><code>/etc/chef/config.d</code></li> <li><code>~/chef/solo.d</code></li> </ul> <p>(There is no support for a <code>knife.d</code> directory; use <code>config.d</code> instead.)</p> <p>For example, when using knife, the following configuration files would be loaded:</p> <ul> <li><code>~/.chef/config.rb</code></li> <li><code>~/.chef/config.d/company_settings.rb</code></li> <li><code>~/.chef/config.d/ec2_configuration.rb</code></li> <li><code>~/.chef/config.d/old_settings.rb.bak</code></li> </ul> <p>The <code>old_settings.rb.bak</code> file is ignored because it’s not a configuration file. The <code>config.rb</code>, <code>company_settings.rb</code>, and <code>ec2_configuration</code> files are merged together as if they are a single configuration file.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>If multiple configuration files exists in a <code>.d</code> directory, ensure that the same setting has the same value in all files.</p> </div> </div> <h2 id="ohai-settings">Ohai Settings</h2> <p>Ohai configuration settings can be added to the client.rb file.</p> <dl> <dt><code>ohai.directory</code></dt> <dd> <p>The directory in which Ohai plugins are located.</p> </dd> <dt><code>ohai.disabled_plugins</code></dt> <dd> <p>An array of Ohai plugins to be disabled on a node. The list of plugins included in Ohai can be found in the <a href="https://github.com/chef/ohai/tree/main/lib/ohai/plugins">ohai/lib/ohai/plugins</a> source. For example, disabling a single plugin:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">ohai<span style="color:#666">.</span>disabled_plugins <span style="color:#666">=</span> <span style="color:#666">[</span>
  <span style="color:#517918">:MyPlugin</span>
<span style="color:#666">]</span>
</code></pre></div>
<p>or disabling multiple plugins:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">ohai<span style="color:#666">.</span>disabled_plugins <span style="color:#666">=</span> <span style="color:#666">[</span>
  <span style="color:#517918">:MyPlugin</span>,
  <span style="color:#517918">:MyPlugin2</span>,
  <span style="color:#517918">:MyPlugin3</span>
<span style="color:#666">]</span>
</code></pre></div>
<p>When a plugin is disabled, the Chef Infra Client log file will contain entries similar to:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#666">[</span><span style="color:#40a070">2014</span><span style="color:#666">-</span><span style="color:#40a070">06</span><span style="color:#666">-</span><span style="color:#40a070">13</span><span style="color:#517918">T23</span>:<span style="color:#40a070">49</span>:<span style="color:#40a070">12</span><span style="color:#666">+</span><span style="color:#40a070">00</span>:<span style="color:#40a070">00</span><span style="color:#666">]</span> <span style="color:#517918">DEBUG</span>: <span style="color:#60add5">Skipping</span> disabled plugin <span style="color:#60add5">MyPlugin</span>
</code></pre></div>
</dd> <dt><code>ohai.hints_path</code></dt> <dd> <p>The path to the file that contains hints for Ohai.</p> </dd> <dt><code>ohai.log_level</code></dt> <dd> <p>The level of logging to be stored in a log file.</p> </dd> <dt><code>ohai.log_location</code></dt> <dd> <p>The location of the log file.</p> </dd> <dt><code>ohai.plugin_path</code></dt> <dd> <p>An array of paths at which Ohai plugins are located. Default value: <code>[&lt;CHEF_GEM_PATH&gt;/ohai-9.9.9/lib/ohai/plugins]</code>. When custom Ohai plugins are added, the paths must be added to the array. For example, a single plugin:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">ohai<span style="color:#666">.</span>plugin_path <span style="color:#666">&lt;&lt;</span> <span style="color:#4070a0">'/etc/chef/ohai_plugins'</span>
</code></pre></div>
<p>and for multiple plugins:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">ohai<span style="color:#666">.</span>plugin_path <span style="color:#666">+=</span> <span style="color:#666">[</span>
  <span style="color:#4070a0">'/etc/chef/ohai_plugins'</span>,
  <span style="color:#4070a0">'/path/to/other/plugins'</span>
  <span style="color:#666">]</span>
</code></pre></div>
</dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>The Ohai executable ignores settings in the client.rb file when Ohai is run independently of Chef Infra Client.</p> </div> </div> <h2 id="example">Example</h2> <p>A sample client.rb file that contains the most simple way to connect to Hosted Chef</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_server_url  <span style="color:#4070a0">'https://api.chef.io/organizations/&lt;orgname&gt;'</span>
validation_client_name <span style="color:#4070a0">'&lt;orgname&gt;-validator'</span>
validation_key <span style="color:#4070a0">'/etc/chef/validator.pem'</span>
client_key <span style="color:#4070a0">'/etc/chef/client.pem'</span>
</code></pre></div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/config_rb_client/" class="_attribution-link">https://docs.chef.io/config_rb_client/</a>
  </p>
</div>
