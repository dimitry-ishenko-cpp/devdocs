<div id="col-content" data-swiftype-index="true"> <div id="chef-and-terraform"><h1>Chef and Terraform</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/terraform.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> Terraform deprecated the Chef Provisioner in the <a href="https://www.terraform.io/docs/language/resources/provisioners/chef.html">0.13.4</a> release and they will remove it in a future version. Terraform continues to support the Chef Provider. </div> </div> <p><a href="https://www.terraform.io/">Terraform</a> is an open-source infrastructure-as-code provisioning tool from <a href="https://www.hashicorp.com/">HashiCorp</a>. Terraform allows you to write code to define and provision infrastructure for the cloud, virtual machines, and on-premises machines. Terraform is not a configuration management tool, it is responsible for deploying, maintaining, and destroying the infrastructure that servers and applications run on. When Terraform creates cloud or virtual servers, it uses <a href="https://www.terraform.io/docs/provisioners/index.html">Provisioners</a> to enable configuration management to manage them. When Terraform talks to APIs to define or configure resources, it uses <a href="https://www.terraform.io/docs/providers/index.html">Providers</a> to request those resources.</p> <h2 id="chef-infra-provisioner">Chef Infra Provisioner</h2> <p>The <a href="https://www.terraform.io/docs/provisioners/chef.html">Terraform Chef Provisioner</a> bootstraps Terraform, provisioned with Chef Infra via SSH or WinRM, and configures them to work with a <a href="../server/index.html">Chef Infra Server</a>. Standard bootstrap options such as Chef Infra versions, secrets, proxies, and assigning run lists via Policyfiles or Roles and Environments are all supported. The referenced documentation provides a complete list of supported options and an example of usage. HashiCorp provides support for the <a href="https://www.terraform.io/docs/provisioners/chef.html">Terraform Chef Provisioner</a> and it is not officially supported by Chef Software.</p> <h3 id="terraform-and-chef-solo">Terraform and Chef Solo</h3> <p>If you are using <a href="../chef_solo/index.html">Chef Solo</a>, you will most likely want to use the <a href="https://www.terraform.io/docs/provisioners/remote-exec.html">Terraform remote-exec Provisioner</a> rather than the Terraform Chef Provisioner. The remote-exec Provisioner may be used to run a script or an inline set of commands on the newly created machine. Please refer to the <a href="https://www.terraform.io/docs/provisioners/remote-exec.html">Terraform remote-exec Provisioner documentation</a> for further options and examples.</p> <h4 id="example-remote-exec-inline">Example remote-exec inline</h4> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">resource <span style="color:#4070a0">"aws_instance"</span> <span style="color:#4070a0">"web"</span> <span style="color:#666">{</span>
  <span style="color:#60a0b0;font-style:italic"># ...</span>

  provisioner <span style="color:#4070a0">"remote-exec"</span> <span style="color:#666">{</span>
    <span style="color:#bb60d5">inline</span> <span style="color:#666">=</span> <span style="color:#666">[</span>
      <span style="color:#4070a0">"wget -O /tmp/chef.rpm https://MYSERVER/chef_installers/chef-15.8.23-1.el7.x86_64.rpm"</span>,
      <span style="color:#4070a0">"rpm -Uvh /tmp/chef.rpm"</span>,
      <span style="color:#4070a0">"wget -O /tmp/base.tgz https://MYSERVER/policyfiles/base.tgz"</span>,
      <span style="color:#4070a0">"tar -C /tmp -xzf /tmp/base.tgz"</span>,
      <span style="color:#4070a0">"PWD=/tmp/base chef-client -z"</span>,
    <span style="color:#666">]</span>
  <span style="color:#666">}</span>
<span style="color:#666">}</span>
</code></pre></div>
<h2 id="chef-infra-provider">Chef Infra Provider</h2> <p>The <a href="https://www.terraform.io/docs/providers/chef/index.html">Terraform Chef Provider</a> allows you to manage Chef Infra Server resources (nodes, data bags, etc.) using the Chef Infra Server API. Policyfiles, cookbooks, clients, and ACLs are not currently managed with the Provider. The <a href="https://www.terraform.io/docs/providers/chef/index.html">Terraform Chef Provider documentation</a> provides a complete list of supported options and an example of usage. HashiCorp provides support for the Terraform Chef Provider and it is not officially supported by Chef Software.</p> <h2 id="additional-terraform-integrations">Additional Terraform Integrations</h2> <ul> <li>The <a href="https://www.habitat.sh/docs/habitat-and-other-software/#habitat-and-provisioning">Habitat Provisioner</a> may be used to install and load the Chef Habitat Supervisor and configure the services to be managed by the supervisor.</li> <li>
<a href="https://newcontext-oss.github.io/kitchen-terraform/">Kitchen Terraform</a> is a community <a href="../kitchen/index.html">Test Kitchen</a> driver that allows for multi-node testing.</li> <li>
<a href="https://github.com/mattray/inspec-iggy/">InSpec-Iggy</a> is a community <a href="../inspec/index.html">InSpec</a> plugin that generates InSpec compliance controls and profiles from Terraform <code>tfstate</code> files and AWS CloudFormation templates.</li> </ul> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/terraform/" class="_attribution-link">https://docs.chef.io/terraform/</a>
  </p>
</div>
