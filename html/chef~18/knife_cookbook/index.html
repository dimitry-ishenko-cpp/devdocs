<div id="col-content" data-swiftype-index="true"> <div id="knife-cookbook"><h1>knife cookbook</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-workstation/blob/main/docs-chef-io/content/workstation/knife_cookbook.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>A cookbook is the fundamental unit of configuration and policy distribution in Chef Infra.</p> <p>A cookbook defines a scenario and contains everything that is required to support that scenario:</p> <ul> <li>Recipes that specify which Chef Infra built-in resources to use, as well as the order in which they are to be applied</li> <li>Attribute values, which allow environment-based configurations such as <code>dev</code> or <code>prodution</code>.</li> <li>Custom Resources for extending Chef Infra beyond the built-in resources.</li> <li>Files and Templates for distributing information to systems.</li> <li>Custom Ohai Plugins for extending system configuration collection beyond the Ohai defaults.</li> <li>The <code>metadata.rb</code> file, which describes the cookbook itself and any dependencies it may have.</li> </ul> <p>Use the <code>knife cookbook</code> subcommand to interact with cookbooks that are located on the Chef Infra Server or the local chef-repo.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Review the list of <a href="../workstation/knife_options/index.html">common options</a> available to this (and all) knife subcommands and plugins. </div> </div> <h2 id="bulk-delete">bulk delete</h2> <p>Use the <code>bulk delete</code> argument to delete cookbook files that match a pattern defined by a regular expression. The regular expression must be within quotes and not be surrounded by forward slashes (/).</p> <h3 id="syntax">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook bulk delete REGEX <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-p</code>, <code>--purge</code>
</dt> <dd> <p>Entirely remove a cookbook (or cookbook version) from the Chef Infra Server. Use this action carefully because only one copy of any single file is stored on the Chef Infra Server. Consequently, purging a cookbook disables any other cookbook that references one or more files from the cookbook that has been purged.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Bulk delete many cookbooks</strong></p> <p>Use a regular expression to define the pattern used to bulk delete cookbooks:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook bulk delete <span style="color:#4070a0">"^[0-9]{3}</span>$<span style="color:#4070a0">"</span> -p
</code></pre></div>
<h2 id="delete">delete</h2> <p>Use the <code>delete</code> argument to delete a specified cookbook or cookbook version on the Chef Infra Server (and not locally).</p> <h3 id="syntax-1">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook delete COOKBOOK_NAME <span style="color:#666">[</span>COOKBOOK_VERSION<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-1">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all</code>
</dt> <dd> <p>Delete all cookbooks (and cookbook versions).</p> </dd> <dt><code>COOKBOOK_VERSION</code></dt> <dd> <p>The version of a cookbook to be deleted. If a cookbook has only one version, this option does not need to be specified. If a cookbook has more than one version and this option is not specified, knife prompts for a version.</p> </dd> <dt>
<code>-p</code>, <code>--purge</code>
</dt> <dd> <p>Entirely remove a cookbook (or cookbook version) from the Chef Infra Server. Use this action carefully because only one copy of any single file is stored on the Chef Infra Server. Consequently, purging a cookbook disables any other cookbook that references one or more files from the cookbook that has been purged.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-1">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Delete a cookbook</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook delete cookbook_name version
</code></pre></div>
<p>For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook delete smartmon 0.8
</code></pre></div>
<p>Type <code>Y</code> to confirm a deletion.</p> <h2 id="download">download</h2> <p>Use the <code>download</code> argument to download a cookbook from the Chef Infra Server to the current working directory.</p> <h3 id="syntax-2">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook download COOKBOOK_NAME <span style="color:#666">[</span>COOKBOOK_VERSION<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-2">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-d DOWNLOAD_DIRECTORY</code>, <code>--dir DOWNLOAD_DIRECTORY</code>
</dt> <dd> <p>The directory in which cookbooks are located.</p> </dd> <dt>
<code>-f</code>, <code>--force</code>
</dt> <dd> <p>Overwrite an existing directory.</p> </dd> <dt>
<code>-N</code>, <code>--latest</code>
</dt> <dd> <p>Download the most recent version of a cookbook.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-2">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Download a cookbook</strong></p> <p>To download a cookbook named <code>smartmon</code>, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook download smartmon
</code></pre></div>
<h2 id="list">list</h2> <p>Use the <code>list</code> argument to view a list of cookbooks that are currently available on the Chef Infra Server. The list will contain only the most recent version for each cookbook by default.</p> <h3 id="syntax-3">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook list <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-3">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all</code>
</dt> <dd> <p>Return all available versions for every cookbook.</p> </dd> <dt>
<code>-w</code>, <code>--with-uri</code>
</dt> <dd> <p>Show the corresponding URIs.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-3">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>View a list of cookbooks</strong></p> <p>To view a list of cookbooks:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook list
</code></pre></div>
<h2 id="metadata">metadata</h2> <p>Use the <code>metadata</code> argument to generate the metadata for one or more cookbooks.</p> <h3 id="syntax-4">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook metadata <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-4">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all</code>
</dt> <dd> <p>Generate metadata for all cookbooks.</p> </dd> <dt>
<code>-o PATH:PATH</code>, <code>--cookbook-path PATH:PATH</code>
</dt> <dd> <p>The directory in which cookbooks are created. This can be a colon-separated path.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-4">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Generate metadata</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook metadata -a
</code></pre></div>
<h2 id="metadata-from-file">metadata from file</h2> <p>Use the <code>metadata from file</code> argument to load the metadata for a cookbook from a file.</p> <h3 id="syntax-5">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook metadata from file FILE
</code></pre></div>
<h3 id="options-5">Options</h3> <p>This command does not have any specific options.</p> <h3 id="examples-5">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>View metadata</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook metadata from file /path/to/file
</code></pre></div>
<h2 id="show">show</h2> <p>Use the <code>show</code> argument to view information about a cookbook, parts of a cookbook (attributes, definitions, files, libraries, providers, recipes, resources, and templates), or a file that is associated with a cookbook (including attributes such as checksum or specificity).</p> <h3 id="syntax-6">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook show COOKBOOK_NAME <span style="color:#666">[</span>COOKBOOK_VERSION<span style="color:#666">]</span> <span style="color:#666">[</span>PART...<span style="color:#666">]</span> <span style="color:#666">[</span>FILE_NAME<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-6">Options</h3> <p>This argument has the following options:</p> <dl> <dt><code>COOKBOOK_VERSION</code></dt> <dd> <p>The version of a cookbook to be shown. If a cookbook has only one version, this option does not need to be specified. If a cookbook has more than one version and this option is not specified, a list of cookbook versions is returned.</p> </dd> <dt>
<code>-f FQDN</code>, <code>--fqdn FQDN</code>
</dt> <dd> <p>The FQDN of the host.</p> </dd> <dt><code>FILE_NAME</code></dt> <dd> <p>The name of a file that is associated with a cookbook.</p> </dd> <dt>
<code>-p PLATFORM</code>, <code>--platform PLATFORM</code>
</dt> <dd> <p>The platform for which a cookbook is designed.</p> </dd> <dt><code>PART</code></dt> <dd> <p>The part of the cookbook to show: <code>attributes</code>, <code>definitions</code>, <code>files</code>, <code>libraries</code>, <code>providers</code>, <code>recipes</code>, <code>resources</code>, or <code>templates</code>. More than one part can be specified.</p> </dd> <dt>
<code>-V PLATFORM_VERSION</code>, <code>--platform-version PLATFORM_VERSION</code>
</dt> <dd> <p>The version of the platform.</p> </dd> <dt>
<code>-w</code>, <code>--with-uri</code>
</dt> <dd> <p>Show the corresponding URIs.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-6">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Show cookbook data</strong></p> <p>To get the list of available versions of a cookbook named <code>getting-started</code>, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook show getting-started
</code></pre></div>
<p>to return something like:</p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-none" data-lang="none">getting-started   0.3.0  0.2.0
</code></pre>
<p><strong>Show cookbook versions</strong></p> <p>To show a list of data about a cookbook using the name of the cookbook and the version, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook show getting-started 0.3.0
</code></pre></div>
<p>to return something like:</p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-none" data-lang="none">attributes:
  checksum:   fa0fc4abf3f6787aeb5c3c5c35de667c
  name:       default.rb
  path:       attributes/default.rb
  specificity:  default
  url:        https://somelongurlhere.com
chef_type:    cookbook_version
cookbook_name:  getting-started
definitions:  []
files:        []
frozen?:      false
json_class:   Chef::CookbookVersion
libraries:    []
</code></pre>
<p><strong>Show a cookbook version</strong></p> <p>To only view data about templates, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook show getting-started 0.3.0 templates
</code></pre></div>
<p>to return something like:</p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-none" data-lang="none">checksum:   a29d6f254577b830091f140c3a78b1fe
name:       chef-getting-started.txt.erb
path:       templates/default/chef-getting-started.txt.erb
specificity:  default
url:        https://someurlhere.com
</code></pre>
<p><strong>Show cookbook data as JSON</strong></p> <p>To view information in JSON format, use the <code>-F</code> common option as part of the command like this:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook show devops -F json
</code></pre></div>
<p>Other formats available include <code>text</code>, <code>yaml</code>, and <code>pp</code>.</p> <h2 id="test">test</h2> <p>Use the <code>test</code> argument to test a cookbook for syntax errors. This argument uses Ruby syntax checking to verify every file in a cookbook that ends in .rb and Embedded Ruby (ERB). This argument will respect chefignore files when determining which cookbooks to test for syntax errors.</p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> This feature is deprecated in favor of <a href="../workstation/cookstyle/index.html">Cookstyle</a> and <a href="../workstation/chefspec/index.html">ChefSpec</a> </div> </div> <h3 id="syntax-7">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook <span style="color:#007020">test</span> COOKBOOK_NAME <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-7">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all</code>
</dt> <dd> <p>Test all cookbooks.</p> </dd> <dt>
<code>-o PATH:PATH</code>, <code>--cookbook-path PATH:PATH</code>
</dt> <dd> <p>The directory in which cookbooks are created. This can be a colon-separated path.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-7">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Test a cookbook</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook <span style="color:#007020">test</span> cookbook_name
</code></pre></div>
<h2 id="upload">upload</h2> <p>Use the <code>upload</code> argument to upload one or more cookbooks (and any files that are associated with those cookbooks) from a local repository to the Chef Infra Server. Only files that do not already exist on the Chef Infra Server will be uploaded.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Use a chefignore file to prevent the upload of specific files and file types, such as temporary files or files placed in folders by version control systems. The chefignore file must be located in the root of the cookbook repository and must use rules similar to filename globbing (as defined by the Ruby <code>File.fnmatch</code> syntax). </div> </div> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> Empty directories are not uploaded to the Chef Infra Server. To upload an empty directory, create a “dot” file—e.g. <code>.keep</code>—in that directory to ensure that the directory itself is not empty. </div> </div> <h3 id="syntax-8">Syntax</h3> <p>This argument has the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook upload <span style="color:#666">[</span>COOKBOOK_NAME...<span style="color:#666">]</span> <span style="color:#666">(</span>options<span style="color:#666">)</span>
</code></pre></div>
<h3 id="options-8">Options</h3> <p>This argument has the following options:</p> <dl> <dt>
<code>-a</code>, <code>--all</code>
</dt> <dd> <p>Upload all cookbooks.</p> </dd> <dt><code>--concurrency</code></dt> <dd> <p>The number of allowed concurrent connections. Default: <code>10</code>.</p> </dd> <dt>
<code>-d</code>, <code>--include-dependencies</code>
</dt> <dd> <p>Ensure that when a cookbook has a dependency on one (or more) cookbooks, those cookbooks are also uploaded.</p> </dd> <dt>
<code>-E ENVIRONMENT</code>, <code>--environment ENVIRONMENT</code>
</dt> <dd> <p>Use to set the environment version dependency to the cookbook version being uploaded.</p> </dd> <dt><code>--force</code></dt> <dd> <p>Update a cookbook even if the <code>--freeze</code> flag has been set.</p> </dd> <dt><code>--freeze</code></dt> <dd> <p>Require changes to a cookbook be included as a new version. Only the <code>--force</code> option can override this setting.</p> </dd> <dt>
<code>-o PATH:PATH</code>, <code>--cookbook-path PATH:PATH</code>
</dt> <dd> <p>The directory in which cookbooks are created. This can be a colon-separated path.</p> </dd> </dl> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> See <a href="../workstation/config_rb_optional_settings/index.html">config.rb</a> for more information about how to add certain knife options as settings in the config.rb file. </div> </div> <h3 id="examples-8">Examples</h3> <p>The following examples show how to use this knife subcommand:</p> <p><strong>Upload a cookbook</strong></p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook upload cookbook_name
</code></pre></div>
<p><strong>Freeze a cookbook</strong></p> <p>To upload a cookbook, and then prevent other users from being able to make changes to it, enter:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">knife cookbook upload redis --freeze
</code></pre></div>
<p>to return something like:</p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-none" data-lang="none">Uploading redis...
Upload completed
</code></pre>
<p>If a cookbook is frozen and the <code>--force</code> option is not specified, knife will return an error message similar to the following:</p> <pre tabindex="0" class="highlight" data-language="ruby"><code class="language-none" data-lang="none">Uploading redis...
ERROR: Version 0.1.6 of cookbook redis is frozen. Use --force to override.
</code></pre> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/knife_cookbook/" class="_attribution-link">https://docs.chef.io/knife_cookbook/</a>
  </p>
</div>
