<div id="col-content" data-swiftype-index="true"> <div id="ibmdb2_session-resource"><h1>ibmdb2_session resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/ibmdb2_session.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>ibmdb2_session</code> Chef InSpec audit resource to test SQL commands run against an IBM Db2 database. Make sure you are using the IBM Db2 database instance user credentials to run the InSpec test.</p> <h2 id="availability">Availability</h2> <h3 id="installation">Installation</h3> <p>This resource is distributed along with Chef InSpec itself. You can use it automatically.</p> <h2 id="syntax">Syntax</h2> <p>A <code>ibmdb2_session</code> resource block declares the db2_executable_file_path, db_instance and db_name to use for the session, and then the query to be run:</p> <pre class="highlight" data-language="ruby"><code>describe ibmdb2_session(db2_executable_file_path: "/opt/ibm/db2/V11.5/bin/db2", db_instance: "db2inst1", db_name: "sample").query("select rolename from syscat.roleauth") do
  its("output") { should match(/SYSTS_MGR/) }
end
</code></pre> <p>Windows</p> <pre class="highlight" data-language="ruby"><code>describe ibmdb2_session(db_name: "sample").query("select rolename from syscat.roleauth") do
  its("output") { should match(/SYSTS_MGR/) }
end
</code></pre> <p>where</p> <ul> <li>
<code>ibmdb2_session</code> declares a db2_executable_file_path, db_instance and db_name to connect.</li> <li>
<code>db2_executable_file_path</code> is the path of the db2 binary file. For Windows this is not required.</li> <li>
<code>db_instance</code> is the name of the database instance. For Windows this is not required.</li> <li>
<code>db_name</code> is the name of the database to query on.</li> <li>
<code>query('QUERY')</code> contains the query to be run.</li> <li>
<code>its('output') { should eq(/expected-result/) }</code> compares the results of the query against the expected result in the test.</li> </ul> <h2 id="examples">Examples</h2> <p>The following examples show how to use this Chef InSpec audit resource.</p> <h3 id="test-for-matching-role-name">Test for matching role name</h3> <pre class="highlight" data-language="ruby"><code>describe ibmdb2_session(db2_executable_file_path: "/opt/ibm/db2/V11.5/bin/db2", db_instance: "db2inst1", db_name: "sample").query("select rolename from syscat.roleauth") do
  its("output") { should match(/SYSTS_MGR/) }
end
</code></pre> <h3 id="test-for-matching-database">Test for matching database</h3> <pre class="highlight" data-language="ruby"><code>describe ibmdb2_session(db2_executable_file_path: "/opt/ibm/db2/V11.5/bin/db2", db_instance: "db2inst1", db_name: "sample").query("list database directory") do
  its("output") { should match(/SAMPLE/) }
end
</code></pre> <h2 id="matchers">Matchers</h2> <p>For a full list of available matchers, please visit our <a href="../../matchers/index.html">matchers page</a>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/ibmdb2_session/" class="_attribution-link">https://docs.chef.io/inspec/resources/ibmdb2_session/</a>
  </p>
</div>
