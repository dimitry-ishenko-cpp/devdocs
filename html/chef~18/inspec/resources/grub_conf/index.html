<div id="col-content" data-swiftype-index="true"> <div id="grub_conf-resource"><h1>grub_conf resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/grub_conf.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Grub is a boot loader on the Linux platform used to load and then transfer control to an operating system kernel, after which that kernel initializes the rest of the operating system. Use the <code>grub_conf</code> Chef InSpec audit resource to test boot loader configuration settings that are defined in the <code>grub.conf</code> configuration file.</p> <h2 id="availability">Availability</h2> <h3 id="installation">Installation</h3> <p>This resource is distributed along with Chef InSpec itself. You can use it automatically.</p> <h3 id="version">Version</h3> <p>This resource first became available in v1.0.0 of InSpec.</p> <h2 id="syntax">Syntax</h2> <p>A <code>grub_conf</code> resource block declares a list of settings in a <code>grub.conf</code> file:</p> <pre class="highlight" data-language="ruby"><code>describe grub_conf('path', 'kernel') do
  its('setting') { should eq 'value' }
end
</code></pre> <p>or:</p> <pre class="highlight" data-language="ruby"><code>describe grub_conf('path') do
  its('default') { should eq '0' } #
  its('setting') { should eq 'value' }
end
</code></pre> <p>where</p> <ul> <li>
<code>'service_name'</code> is a service listed in the <code>grub.conf</code> file</li> <li>
<code>'path'</code> is the path to the <code>grub.conf</code> file</li> <li>
<code>'kernel'</code> specifies the default kernel (by using <code>'default'</code>) or a specific kernel; <code>'default'</code> defines the position in the list of kernels at which the default kernel is defined, i.e. <code>should eq '0'</code> for the first kernel listed or <code>'path', 'default'</code> to use the default kernel as specified in the <code>grub.conf</code> file</li> <li>
<code>'value'</code> is the value that is expected</li> </ul> <h2 id="examples">Examples</h2> <p>The following examples show how to use this Chef InSpec audit resource.</p> <h3 id="test-a-grubconf-file">Test a grub.conf file</h3> <p>A Grub configuration file located at <code>/etc/grub.conf</code> is similar to the following:</p> <pre class="highlight" data-language="ruby"><code># grub.conf generated by anaconda
#
# Note:  You do not need to rerun grub after making changes to this file
# NOTICE:  You have a /boot partition.  This means that
#          all kernel and initrd paths are relative to /boot/, eg.
#          root (hd0,0)
#          kernel /vmlinuz-version ro root=/dev/hda6
#          initrd /initrd-version.img
#boot=/dev/hda
default=0
timeout=10
splashimage=(hd0,0)/grub/splash.xpm.gz
title Red Hat Enterprise Linux ES (2.6.32-573.7.1.el6.x86_64)
    root (hd0,0)
    kernel /vmlinuz-2.6.32-573.7.1.el6.x86_64 ro root=/dev/hda6
    initrd /initrd-2.6.32-573.7.1.el6.x86_64.img
title Red Hat Enterprise Linux ES (2.6.32-358.14.1.el6.x86_64)
    root (hd0,0)
    kernel /vmlinuz-2.6.32-358.14.1.el6.x86_64 ro root=/dev/hda6 ramdisk_size=400000
    initrd /initrd-2.6.32-358.14.1.el6.x86_64.img
</code></pre> <p>This file defines two versions of RedHat Enterprise Linux, with version <code>2.6.32-573.7.1.el6.x86_64</code> specified as the default.</p> <p>The following test verifies the kernel, ensures that kernel is the default kernel, its initial RAM disk (<code>initrd</code>), and the timeout:</p> <pre class="highlight" data-language="ruby"><code>describe grub_conf('/etc/grub.conf',  'default') do
  its('kernel') { should include '/vmlinuz-2.6.32-573.7.1.el6.x86_64' }
  its('initrd') { should include '/initrd-2.6.32-573.7.1.el6.x86_64.img' }
  its('default') { should_not eq '1' }
  its('timeout') { should eq '10' }
end
</code></pre> <p>The following test verifies the <code>ramdisk_size</code> for the non-default kernel:</p> <pre class="highlight" data-language="ruby"><code>describe grub_conf('/etc/grub.conf',  'Red Hat Enterprise Linux ES (2.6.32-358.14.1.el6.x86_64)') do
   its('kernel') { should include 'ramdisk_size=400000' }
 end
</code></pre> <h3 id="test-a-configuration-file-and-boot-configuration">Test a configuration file and boot configuration</h3> <pre class="highlight" data-language="ruby"><code>describe grub_conf('/etc/grub.conf',  'default') do
  its('kernel') { should include '/vmlinuz-2.6.32-573.7.1.el6.x86_64' }
  its('initrd') { should include '/initramfs-2.6.32-573.el6.x86_64.img=1' }
  its('default') { should_not eq '1' }
  its('timeout') { should eq '5' }
end
</code></pre> <h3 id="test-a-specific-kernel">Test a specific kernel</h3> <pre class="highlight" data-language="ruby"><code>grub_conf('/etc/grub.conf',  'CentOS (2.6.32-573.12.1.el6.x86_64)') do
  its('kernel') { should include 'audit=1' }
end
</code></pre> <h2 id="matchers">Matchers</h2> <p>For a full list of available matchers, please visit our <a href="../../matchers/index.html">matchers page</a>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/grub_conf/" class="_attribution-link">https://docs.chef.io/inspec/resources/grub_conf/</a>
  </p>
</div>
