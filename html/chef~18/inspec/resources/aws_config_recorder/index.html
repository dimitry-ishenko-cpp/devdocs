<div id="col-content" data-swiftype-index="true"> <div id="aws_config_recorder-resource"><h1>aws_config_recorder resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/aws_config_recorder.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>Use the <code>aws_config_recorder</code> InSpec audit resource to test properties of your AWS Config Service.</p> <p>The AWS Config service can monitor and record changes to your AWS resource configurations. The Aws Config Recorder is used to detect changes in resource configurations and capture these changes as configuration items.</p> <p>As of April 2018, you are only permitted one configuration recorder per region.</p> <h2 id="syntax">Syntax</h2> <p>Ensure that an auto scaling group exists and has the correct scale sizes</p> <pre class="highlight" data-language="ruby"><code>describe aws_config_recorder('my-recorder') do
  it { should exist }
end
</code></pre> <p>You may also use hash syntax to pass the recorder name</p> <pre class="highlight" data-language="ruby"><code>describe aws_config_recorder(recorder_name: 'my-recorder') do
  it { should exist }
end
</code></pre> <p>Since you may only have one recorder per region, and InSpec connections are per-region, you may also omit the recorder name to obtain the one recorder (if any) that exists:</p> <pre class="highlight" data-language="ruby"><code>describe aws_config_recorder do
  it { should exist }
end
</code></pre> <h2 id="parameters">Parameters</h2> <h3 id="recorder_name-_optional_">recorder_name <em>(optional)</em>
</h3> <p>This resource accepts a single parameter, the Configuration Recorder Name. This can be passed either as a string or as a <code>recorder_name: 'value'</code> key-value entry in a hash.</p> <p>See also the <a href="https://docs.aws.amazon.com/config/latest/developerguide/aws-config-landing-page.html">AWS documentation on Configuration</a>.</p> <h2 id="properties">Properties</h2> <table> <thead> <tr> <th>Property</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>recorder_name</td> <td>The name of the recorder. By default, AWS Config automatically assigns the name “default” when creating the configuration recorder. You cannot change the assigned name.</td> </tr> <tr> <td>role_arn</td> <td>Amazon Resource Name (ARN) of the IAM role used to describe the AWS resources associated with the account.</td> </tr> <tr> <td>resource_types</td> <td>A comma-separated list that specifies the types of AWS resources for which AWS Config records configuration changes (i.e. AWS::EC2::Instance)</td> </tr> </tbody> </table> <h2 id="examples">Examples</h2> <h3 id="test-if-the-recorder-is-active-and-recording">Test if the recorder is active and recording</h3> <pre class="highlight" data-language="ruby"><code>describe aws_config_recorder do
  it { should be_recording }
end
</code></pre> <h3 id="ensure-the-role_arn-is-correct-for-the-recorder">Ensure the role_arn is correct for the recorder</h3> <p>The role is used to grant permissions to S3 Buckets, SNS topics and to get configuration details for supported AWS resources.</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">describe aws_config_recorder <span style="color:#007020;font-weight:700">do</span>
    its(<span style="color:#4070a0">'role_arn'</span>) { should eq <span style="color:#4070a0">'arn:aws:iam::721741954427:role/My_Recorder'</span> }
<span style="color:#007020;font-weight:700">end</span>
</code></pre></div>
<h3 id="test-the-recorder-is-monitoring-changes-to-the-correct-resources">Test the recorder is monitoring changes to the correct resources.</h3> <pre class="highlight" data-language="ruby"><code>describe aws_config_recorder do
  its('resource_types') { should include 'AWS::EC2::CustomerGateway' }
  its('resource_types') { should include 'AWS::EC2::EIP' }
end
</code></pre> <h2 id="matchers">Matchers</h2> <h3 id="be_recording">be_recording</h3> <p>Ensure the recorder is active</p> <pre class="highlight" data-language="ruby"><code>  it { should be_recording }
</code></pre> <h3 id="be_recording_all_resource_types">be_recording_all_resource_types</h3> <p>Indicates if the ConfigurationRecorder will record changes for all resources, regardless of type. If this is true, resource_types is ignored.</p> <pre class="highlight" data-language="ruby"><code>  it { should be_recording_all_resource_types }
</code></pre> <h3 id="be_recording_all_global_types">be_recording_all_global_types</h3> <p>Indicates whether the ConfigurationRecorder will record changes for global resource types (such as <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/intro-structure.html#intro-structure-principal">Principal</a>s).</p> <pre class="highlight" data-language="ruby"><code>  it { should be_recording_all_global_types }
</code></pre> <h2 id="aws-permissions">AWS Permissions</h2> <p>Your <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/intro-structure.html#intro-structure-principal">Principal</a> will need the <code>config:DescribeConfigurationRecorders</code> action with Effect set to Allow.</p> <p>You can find detailed documentation at <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_awsconfig.html">Actions, Resources, and Condition Keys for AWS Config</a>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/aws_config_recorder/" class="_attribution-link">https://docs.chef.io/inspec/resources/aws_config_recorder/</a>
  </p>
</div>
