<div id="col-content" data-swiftype-index="true"> <div id="aws_ecr-resource"><h1>aws_ecr resource</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/inspec/inspec/tree/main/docs-chef-io/content/inspec/resources/aws_ecr.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> <p>This resource is deprecated. Please use one of the following resources instead.</p> <ul> <li><code>aws_ecr_image</code></li> <li><code>aws_ecr_images</code></li> <li><code>aws_ecr_repository</code></li> <li><code>aws_ecr_repositories</code></li> </ul> </div> </div> <p>Use the <code>aws_ecr</code> InSpec audit resource to test properties of a single AWS Elastic Container Registry.</p> <h2 id="syntax">Syntax</h2> <p>An <code>aws_ecr</code> resource block declares the tests for a single AWS ECR by repository name.</p> <pre class="highlight" data-language="ruby"><code>  describe aws_ecr(repository_name: aws_ecr_name) do
    it                       { should exist }
    its ('repository_name')  { should eq aws_ecr_name }
  end
</code></pre> <h2 id="parameters">Parameters</h2> <p>The ECR repository_name must be provided.</p> <h3 id="repository_name-_required_">repository_name <em>(required)</em>
</h3> <p>The name of the repository This can be passed either as a string or as an <code>repository_name: 'value'</code> key-value entry in a hash.</p> <h2 id="properties">Properties</h2> <table> <thead> <tr> <th>Property</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td>registry_id</td> <td>The AWS account ID associated with the registry</td> </tr> <tr> <td>repository_arn</td> <td>The Amazon Resource Name of the repository</td> </tr> <tr> <td>repository_name</td> <td>The name of the repository</td> </tr> <tr> <td>repository_uri</td> <td>The uri of the repository</td> </tr> <tr> <td>image_tags</td> <td>The tags associated with the image</td> </tr> <tr> <td>image_digest</td> <td>A sha256 hash of the image</td> </tr> <tr> <td>image_size_in_bytes</td> <td>The size of the image in bytes.</td> </tr> <tr> <td>image_pushed_at</td> <td>The datetime as a string when the image was uploaded. ‘yyyy-mm-dd hh:mm:ss tz’</td> </tr> <tr> <td>image_uploaded_date</td> <td>The date as a string when the image was uploaded. ‘yyyy-mm-dd’</td> </tr> </tbody> </table> <h2 id="examples">Examples</h2> <h3 id="test-that-an-ecr-has-the-correct-image-properties">Test that an ECR has the correct image properties</h3> <pre class="highlight" data-language="ruby"><code>  describe aws_ecr(repository_name: aws_ecr_name).images do
    its ('image_tags')          { should include 'latest'}
    its ('image_digest')        { should eq 'sha256:6dce4a9c1635c4c9b6a2b645e6613fa0238182fe13929808ee2258370d0f3497'}
    its ('image_size_in_bytes') { should eq 764234}
    its ('image_uploaded_date') { should eq '2019-06-11'}
    its ('image_pushed_at')     { should eq '2019-06-11 15:08:29 +0100'}
  end
</code></pre> <h2 id="matchers">Matchers</h2> <p>This InSpec audit resource has the following special matchers. For a full list of available matchers, please visit our <a href="../../matchers/index.html">matchers page</a>.</p> <h3 id="exist">exist</h3> <p>The control will pass if the describe returns at least one result.</p> <p>Use <code>should_not</code> to test the entity should not exist.</p> <pre class="highlight" data-language="ruby"><code>  it { should exist }
  it { should_not exist }
</code></pre> <h2 id="aws-permissions">AWS Permissions</h2> <p>Your <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/intro-structure.html#intro-structure-principal">Principal</a> will need the <code>ecr:DescribeRepositories</code> and <code>ecr:DescribeImages</code> actions set to allow.</p> <p>You can find detailed documentation at <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_amazonelasticcontainerregistry.html">Actions, Resources, and Condition Keys for Amazon ECR</a>, and <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/list_identityandaccessmanagement.html">Actions, Resources, and Condition Keys for Identity And Access Management</a>.</p> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/inspec/resources/aws_ecr/" class="_attribution-link">https://docs.chef.io/inspec/resources/aws_ecr/</a>
  </p>
</div>
