<div id="col-content" data-swiftype-index="true"> <div id="configrb"><h1>config.rb</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-workstation/blob/main/docs-chef-io/content/workstation/config_rb.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> The <code>config.rb</code> file is a replacement for the <code>knife.rb</code> file. The <code>config.rb</code> file has identical settings and behavior to the <code>knife.rb</code> file. Chef Infra Client looks first for the presence of the <code>config.rb</code> file and if it is not found, then looks for the <code>knife.rb</code> file. </div> </div> <p>A <code>config.rb</code> file is used to specify configuration details for knife.</p> <p>A <code>config.rb</code> file:</p> <ul> <li>Is loaded every time the knife executable is run</li> <li>Is not created by default</li> <li>Is located by default at <code>~/.chef/config.rb</code> (macOS and Linux platforms) or <code>c:\Users\username\.chef\config.rb</code> (Microsoft Windows platform), use the <code>--config</code> option from the command line to change this location</li> <li>Will override the default configuration when a <code>config.rb</code> file exists at the default path or the path specified by the <code>--config</code> option</li> </ul> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> When running Microsoft Windows, the <code>config.rb</code> file is located at <code>%HOMEDRIVE%:%HOMEPATH%\.chef</code> (e.g. <code>c:\Users\&lt;username&gt;\.chef</code>). </div> </div> <h2 id="settings">Settings</h2> <p>This configuration file has the following settings:</p> <dl> <dt><code>bootstrap_template</code></dt> <dd>The path to a template file to be used during a bootstrap operation.</dd> <dt><code>chef_server_url</code></dt> <dd>The URL for the Chef Infra Server. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_server_url <span style="color:#4070a0">'https://localhost/organizations/ORG_NAME'</span>
</code></pre></div>
<div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> If changes need to be made to any global end points like user or user keys, use <a href="workstation/knife_exec/index.html"><code>knife exec</code></a> with the <code>--server-url</code> flag to set <code>chef_server_url</code> to <code>https://localhost/</code>. </div> </div> </dd> <dt><code>chef_zero.enabled</code></dt> <dd>Enable chef-zero. This setting requires <code>local_mode</code> to be set to <code>true</code>. Default value: <code>false</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_zero<span style="color:#666">.</span>enabled <span style="color:#007020">true</span>
</code></pre></div>
</dd> <dt><code>chef_zero[:port]</code></dt> <dd>The port on which chef-zero is to listen. Default value: <code>8889</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">chef_zero<span style="color:#666">[</span><span style="color:#517918">:port</span><span style="color:#666">]</span> <span style="color:#40a070">8889</span>
</code></pre></div>
</dd> <dt><code>client_d_dir</code></dt> <dd>A directory that contains additional configuration scripts to load for Chef Infra Client.</dd> <dt><code>client_key</code></dt> <dd>The location of the file that contains the client key, as an absolute path. Default value: <code>/etc/chef/client.pem</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">client_key <span style="color:#4070a0">'/etc/chef/client.pem'</span>
</code></pre></div>
</dd> <dt><code>cookbook_copyright</code></dt> <dd>The name of the copyright holder. This option places a copyright notice that contains the name of the copyright holder in each of the pre-created files. If this option is not specified, a copyright name of “COMPANY_NAME” is used instead; it can easily be modified later.</dd> <dt><code>cookbook_email</code></dt> <dd>The email address for the individual who maintains the cookbook. This option places an email address in each of the pre-created files. If not specified, an email name of “YOUR_EMAIL” is used instead; this can easily be modified later.</dd> <dt><code>cookbook_license</code></dt> <dd>The type of license under which a cookbook is distributed: <code>apachev2</code>, <code>gplv2</code>, <code>gplv3</code>, <code>mit</code>, or <code>none</code> (default). This option places the appropriate license notice in the pre-created files: <code>Apache v2.0</code> (for <code>apachev2</code>), <code>GPL v2</code> (for <code>gplv2</code>), <code>GPL v3</code> (for <code>gplv3</code>), <code>MIT</code> (for <code>mit</code>), or <code>license 'Proprietary - All Rights Reserved</code> (for <code>none</code>). Be aware of the licenses for files inside of a cookbook and be sure to follow any restrictions they describe.</dd> <dt><code>cookbook_path</code></dt> <dd>The Chef Infra Client sub-directory for storing cookbooks. This value can be a string or an array of file system locations, processed in the specified order. The last cookbook is considered to override local modifications. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">cookbook_path <span style="color:#666">[</span>
  <span style="color:#4070a0">'/var/chef/cookbooks'</span>,
  <span style="color:#4070a0">'/var/chef/site-cookbooks'</span>
<span style="color:#666">]</span>
</code></pre></div>
</dd> <dt><code>data_bag_encrypt_version</code></dt> <dd>The minimum required version of data bag encryption. Possible values: <code>1</code> or <code>2</code>. When all of the machines in an organization are running Chef Client 11.6 (or higher), it is recommended that this value be set to <code>2</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">data_bag_encrypt_version <span style="color:#40a070">2</span>
</code></pre></div>
</dd> <dt><code>fips</code></dt> <dd>Allows OpenSSL to enforce FIPS-validated security during a Chef Infra Client run. Set to <code>true</code> to enable FIPS-validated security. <p>The following operating systems are supported:</p> <ul> <li>Red Hat Enterprise Linux</li> <li>Oracle Enterprise Linux</li> <li>CentOS</li> <li>Windows</li> </ul> </dd> <dt><code>local_mode</code></dt> <dd>Run Chef Infra Client in local mode. This allows all commands that work against the Chef Infra Server to also work against the local chef-repo. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">local_mode <span style="color:#007020">true</span>
</code></pre></div>
</dd> <dt><code>node_name</code></dt> <dd> <p>The name of the node. This may be a username with permission to authenticate to the Chef Infra Server or it may be the name of the machine from which knife is run. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">node_name <span style="color:#4070a0">'user_name'</span>
</code></pre></div>
<p>or:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">node_name <span style="color:#4070a0">'machine_name'</span>
</code></pre></div>
</dd> <dt><code>no_proxy</code></dt> <dd> <p>A comma-separated list of URLs that do not need a proxy. Default value: <code>nil</code>. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">no_proxy <span style="color:#4070a0">'localhost, 10.0.1.35, *.example.com, *.dev.example.com'</span>
</code></pre></div>
</dd> <dt><code>ssh_agent_signing</code></dt> <dd>
<strong>New in 14.2</strong> Use <code>ssh-agent</code> to authenticate. When using this option, specify the location of the public key in <code>client_key</code>. Default value: <code>false</code>. Ensure the public key is in PKCS#1 format. You can convert an OpenSSH public key using <code>ssh-keygen</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-bash" data-lang="bash">ssh-keygen -f key.pub -e -m pem &gt; key.pem
</code></pre></div>
</dd> <dt><code>ssh_timeout</code></dt> <dd>The amount of time (in seconds) to wait for an SSH connection time out.</dd> <dt><code>ssl_verify_mode</code></dt> <dd>Set the verify mode for HTTPS requests. <ul> <li>Use <code>:verify_none</code> to do no validation of SSL certificates.</li> <li>Use <code>:verify_peer</code> to do validation of all SSL certificates, including the Chef Infra Server connections, S3 connections, and any HTTPS <strong>remote_file</strong> resource URLs used in a Chef Infra Client run. This is the recommended setting.</li> </ul> <p>Depending on how OpenSSL is configured, the <code>ssl_ca_path</code> may need to be specified. Default value: <code>:verify_peer</code>.</p> </dd> <dt><code>tmux_split</code></dt> <dd> <p>Split the Tmux window. Default value: <code>false</code>.</p> </dd> <dt><code>validation_client_name</code></dt> <dd> <p>The name of the chef-validator key that is used by Chef Infra Client to access the Chef Infra Server during the initial Chef Infra Client run when not using validatorless bootstrapping. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">validation_client_name <span style="color:#4070a0">'chef-validator'</span>
</code></pre></div>
</dd> <dt><code>validation_key</code></dt> <dd> <p>The location of the file that contains the key used when a Chef Infra Client is registered with a Chef Infra Server. A validation key is signed using the <code>validation_client_name</code> for authentication. Default value: <code>/etc/chef/validation.pem</code>. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">validation_key <span style="color:#4070a0">'/etc/chef/validation.pem'</span>
</code></pre></div>
</dd> <dt><code>verify_api_cert</code></dt> <dd>Verify the SSL certificate on the Chef Infra Server. When <code>true</code>, Chef Infra Client always verifies the SSL certificate. When <code>false</code>. Chef Infra Client uses the value of <code>ssl_verify_mode</code> to determine if the SSL certificate requires verification. Default value: <code>false</code>.</dd> <dt><code>versioned_cookbooks</code></dt> <dd>Append cookbook versions to cookbooks. Set to <code>false</code> to hide cookbook versions: <code>cookbooks/apache</code>. Set to <code>true</code> to show cookbook versions: <code>cookbooks/apache-1.0.0</code> and/or <code>cookbooks/apache-1.0.1</code>. When this setting is <code>true</code>, <code>knife download</code> downloads ALL cookbook versions, which can be useful if a full-fidelity backup of data on the Chef Infra Server is required. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">versioned_cookbooks <span style="color:#007020">true</span>
</code></pre></div>
</dd> <dt><code>config_log_level</code></dt> <dd>Sets the default value of <code>log_level</code> in the client.rb file of the node being bootstrapped. Possible values are <code>:debug</code>, <code>:info</code>, <code>:warn</code>, <code>:error</code> and <code>:fatal</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">config_log_level <span style="color:#517918">:debug</span>
</code></pre></div>
</dd> <dt><code>config_log_location</code></dt> <dd>Sets the default value of <code>log_location</code> in the client.rb file of the node being bootstrapped. Possible values are <code>/path/to/log_location</code>, <code>STDOUT</code>, <code>STDERR</code>, <code>:win_evt</code> and <code>:syslog</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">config_log_location <span style="color:#4070a0">"/path/to/log_location"</span>   <span style="color:#60a0b0;font-style:italic"># Please make sure that the path exists</span>
</code></pre></div>
</dd> </dl> <h3 id="proxy-settings">Proxy Settings</h3> <p>In certain situations the proxy used by the Chef Infra Server requires authentication. In this situation, three settings must be added to the configuration file. Which settings to add depends on the protocol used to access the Chef Infra Server: HTTP or HTTPS.</p> <p>If the Chef Infra Server is configured to use HTTP, add the following settings:</p> <dl> <dt><code>http_proxy</code></dt> <dd>The proxy server for HTTP connections. Default value: <code>nil</code>. For example: <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">http_proxy <span style="color:#4070a0">'http://proxy.example.com:3128'</span>
</code></pre></div>
</dd> <dt><code>http_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using an HTTP connection. Default value: <code>nil</code>.</dd> <dt><code>http_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using an HTTP connection. Default value: <code>nil</code>.</dd> </dl> <h4 id="https-proxy-settings-such-as-the-hosted-chef-infra-server">HTTPS Proxy Settings (such as the hosted Chef Infra Server)</h4> <dl> <dt><code>https_proxy</code></dt> <dd>The proxy server for HTTPS connections. (The hosted Chef Infra Server uses an HTTPS connection.) Default value: <code>nil</code>.</dd> <dt><code>https_proxy_user</code></dt> <dd>The user name for the proxy server when the proxy server is using an HTTPS connection. Default value: <code>nil</code>.</dd> <dt><code>https_proxy_pass</code></dt> <dd>The password for the proxy server when the proxy server is using an HTTPS connection. Default value: <code>nil</code>.</dd> </dl> <h4 id="settings-for-no-proxy-urls">Settings for No-proxy URLs</h4> <dl> <dt><code>no_proxy</code></dt> <dd>A comma-separated list of URLs that do not need a proxy. Default value: <code>nil</code>.</dd> </dl> <h2 id="d-directories">.d Directories</h2> <p>Chef Infra Client supports reading multiple configuration files by putting them inside a <code>.d</code> configuration directory. For example: <code>/etc/chef/client.d</code>. All files that end in <code>.rb</code> in the <code>.d</code> directory are loaded; other non-<code>.rb</code> files are ignored.</p> <p><code>.d</code> directories may exist in any location where the <code>client.rb</code>, <code>config.rb</code>, or <code>solo.rb</code> files are present, such as:</p> <ul> <li><code>/etc/chef/client.d</code></li> <li><code>/etc/chef/config.d</code></li> <li><code>~/chef/solo.d</code></li> </ul> <p>(There is no support for a <code>knife.d</code> directory; use <code>config.d</code> instead.)</p> <p>For example, when using knife, the following configuration files would be loaded:</p> <ul> <li><code>~/.chef/config.rb</code></li> <li><code>~/.chef/config.d/company_settings.rb</code></li> <li><code>~/.chef/config.d/ec2_configuration.rb</code></li> <li><code>~/.chef/config.d/old_settings.rb.bak</code></li> </ul> <p>The <code>old_settings.rb.bak</code> file is ignored because it’s not a configuration file. The <code>config.rb</code>, <code>company_settings.rb</code>, and <code>ec2_configuration</code> files are merged together as if they are a single configuration file.</p> <div class="admonition-note"> <p class="admonition-note-title">Note</p> <div class="admonition-note-text"> <p>If multiple configuration files exists in a <code>.d</code> directory, ensure that the same setting has the same value in all files.</p> </div> </div> <h2 id="optional-settings">Optional Settings</h2> <p>In addition to the default settings in a <code>config.rb</code> file, there are other subcommand-specific settings that can be added:</p> <ol> <li>A value passed via the command-line</li> <li>A value contained in the <code>config.rb</code> file</li> <li>The default value</li> </ol> <p>A value passed via the command line overrides a value in the <code>config.rb</code> file; a value in a <code>config.rb</code> file overrides a default value. Before adding any settings to the <code>config.rb</code> file:</p> <ul> <li>Verify the settings by reviewing the documentation for the knife subcommands and/or knife plugins</li> <li>Verify the use case(s) your organization has for adding them</li> </ul> <p>Also note that:</p> <ul> <li>Custom plugins can be configured to use the same settings as the core knife subcommands</li> <li>Many of these settings are used by more than one subcommand and/or plugin</li> <li>Some of the settings are included only because knife checks for a value in the <code>config.rb</code> file</li> </ul> <p>To add settings to the <code>config.rb</code> file, use the following syntax:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">knife<span style="color:#666">[</span><span style="color:#517918">:setting_name</span><span style="color:#666">]</span> <span style="color:#666">=</span> value
</code></pre></div>
<p>where <code>value</code> may require quotation marks (' ‘) if that value is a string. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">knife<span style="color:#666">[</span><span style="color:#517918">:ssh_port</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#40a070">22</span>
knife<span style="color:#666">[</span><span style="color:#517918">:bootstrap_template</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">'ubuntu14.04-gems'</span>
knife<span style="color:#666">[</span><span style="color:#517918">:bootstrap_version</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">''</span>
knife<span style="color:#666">[</span><span style="color:#517918">:bootstrap_proxy</span><span style="color:#666">]</span> <span style="color:#666">=</span> <span style="color:#4070a0">''</span>
</code></pre></div>
<h3 id="frequently-used">Frequently Used</h3> <p>Some of the optional <code>config.rb</code> settings are used often, such as the template file used in a bootstrap operation. The frequency of use of any option varies from organization to organization, so even though the following settings are often added to a <code>config.rb</code> file, they may not be the right settings to add for every organization:</p> <dl> <dt><code>knife[:bootstrap_proxy]</code></dt> <dd>The proxy server for the node that is the target of a bootstrap operation.</dd> <dt><code>knife[:bootstrap_template]</code></dt> <dd>The path to a template file to be used during a bootstrap operation.</dd> <dt><code>knife[:bootstrap_version]</code></dt> <dd>The version of Chef Infra Client to install.</dd> <dt><code>knife[:editor]</code></dt> <dd>The $EDITOR that is used for all interactive commands.</dd> <dt><code>knife[:ssh_gateway]</code></dt> <dd>The SSH tunnel or gateway that is used to run a bootstrap action on a machine that is not accessible from the workstation. Adding this setting can be helpful when a user cannot SSH directly into a host.</dd> <dt><code>knife[:ssh_port]</code></dt> <dd>The SSH port.</dd> </dl> <h3 id="additional-ssh-settings">Additional SSH Settings</h3> <p>Other SSH-related settings that are sometimes helpful when added to the <code>config.rb</code> file:</p> <dl> <dt><code>knife[:forward_agent]</code></dt> <dd>Enable SSH agent forwarding.</dd> <dt><code>knife[:ssh_attribute]</code></dt> <dd>The attribute used when opening an SSH connection.</dd> <dt><code>knife[:ssh_password]</code></dt> <dd>The SSH password. This can be used to pass the password directly on the command line. If this option is not specified (and a password is required) knife prompts for the password.</dd> <dt><code>knife[:ssh_user]</code></dt> <dd>The SSH user name.</dd> </dl> <h3 id="data-bag-settings">Data Bag Settings</h3> <p>Some organizations choose to have all data bags use the same secret and secret file, rather than have a unique secret and secret file for each data bag. To use the same secret and secret file for all data bags, add the following to <code>config.rb</code>:</p> <dl> <dt><code>knife[:secret]</code></dt> <dd>The encryption key that is used for values contained within a data bag item.</dd> <dt><code>knife[:secret_file]</code></dt> <dd>The path to the file that contains the encryption key.</dd> </dl> <h3 id="ohai-settings-not-recommended">Ohai Settings (Not Recommended)</h3> <p>Some settings are better left to Ohai, which gets the value at the start of a Chef Infra Client run:</p> <dl> <dt><code>knife[:server_name]</code></dt> <dd>Same as <code>node_name</code>. Recommended configuration is to allow Ohai to collect this value during each Chef Infra Client run.</dd> <dt><code>node_name</code></dt> <dd>Same as <code>knife[:server_name]</code>. Recommended configuration is to allow Ohai to collect this value during each Chef Infra Client run.</dd> </dl> <div class="admonition-warning"> <p class="admonition-warning-title">Warning</p> <div class="admonition-warning-text"> Review the full list of <a href="workstation/config_rb_optional_settings/index.html">optional settings</a> that can be added to the <code>config.rb</code> file. Many of these optional settings should not be added to the <code>config.rb</code> file. The reasons for not adding them can vary. For example, using <code>--yes</code> as a default in the <code>config.rb</code> file causes knife to always assume that “Y” is the response to any prompt, which may lead to undesirable outcomes. Other settings, such as <code>--hide-healthy</code>(used only with the <code>knife status</code> subcommand) or <code>--bare-directories</code> (used only with the <code>knife list</code> subcommand) probably aren’t used often enough (and in the same exact way) to justify adding them to the <code>config.rb</code> file. In general, if the optional settings are not listed on <span class="title-ref">the main </span><span class="title-ref">config.rb</span><a href="workstation/config_rb/index.html">topic</a>, then add settings only after careful consideration. Do not use optional settings in a production environment until after the setting’s performance has been validated in a safe testing environment. </div> </div> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/config_rb.html" class="_attribution-link">https://docs.chef.io/config_rb.html</a>
  </p>
</div>
