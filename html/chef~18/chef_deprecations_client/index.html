<div id="col-content" data-swiftype-index="true"> <div id="chef-deprecation-warnings"><h1>Chef Deprecation Warnings</h1></div>  <div class="prose"> <p data-swiftype-index="false"> <a href="https://github.com/chef/chef-web-docs/blob/main/content/chef_deprecations_client.md" alt="Link to page on GitHub repository">[edit on GitHub]</a> </p> <p>When we wish to remove a feature or an API in Chef, we try to first mark it with a deprecation warning that contains a link to a description of the change and how to fix it. For example:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby"><span style="color:#60add5">Deprecated</span> features used!
  <span style="color:#60add5">JSON</span> auto inflation is <span style="color:#007020;font-weight:700">not</span> supported (<span style="color:#60add5">CHEF</span><span style="color:#666">-</span><span style="color:#40a070">1</span>) at (irb):<span style="color:#40a070">7</span><span style="color:#517918">:in</span> <span style="color:#4070a0">`irb_binding`</span><span style="color:#666">.</span>
  <span style="color:#60add5">Please</span> see <span style="color:#235388">/chef-client/</span>deprecations<span style="color:#666">/</span>json_auto_inflate<span style="color:#666">.</span>html <span style="color:#007020;font-weight:700">for</span> further details <span style="color:#007020;font-weight:700">and</span> information on how to correct this problem<span style="color:#666">.</span>
</code></pre></div>
<h2 id="testing-for-deprecations">Testing for Deprecations</h2> <p>To test your code for deprecations, you can put Test Kitchen in a mode where any deprecations cause the chef run to fail. Ensure your <code>kitchen.yml</code> includes:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:700">provisioner</span>:<span style="color:#062873;font-weight:700">deprecations_as_errors</span>:<span style="color:#007020;font-weight:700">true</span></code></pre></div>
<p>and then run Test Kitchen as usual. Test Kitchen will fail if any deprecation errors are issued.</p> <h2 id="silencing-deprecation-warnings">Silencing deprecation warnings</h2> <p>Deprecation warnings are great for ensuring cookbooks are kept up-to-date and to prepare for major version upgrades, sometimes you just can’t fix a deprecation right away. Enabling <code>treat_deprecation_warnings_as_errors</code> mode in Test Kitchen integration tests often compounds the problem because it does not distinguish between deprecations from community cookbooks and those in your own code.</p> <p>Two new options are provided for silencing deprecation warnings: <code>silence_deprecation_warnings</code> and inline <code>chef:silence_deprecation</code> comments.</p> <p>The <code>silence_deprecation_warnings</code> configuration value can be set in your <code>client.rb</code> or <code>solo.rb</code> config file, either to <code>true</code> to silence all deprecation warnings or to an array of deprecations to silence. You can specify which to silence either by the deprecation key name (e.g. <code>"internal_api"</code>), the numeric deprecation ID (e.g. <code>25</code> or <span class="title-ref">“CHEF-25”</span>), or by specifying the filename and line number where the deprecation is being raised from (e.g. <code>"default.rb:67"</code>).</p> <p>An example of setting the <code>silence_deprecation_warnings</code> option in your <code>client.rb</code> or <code>solo.rb</code>:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">silence_deprecation_warnings <span style="color:#c65d09">%w{deploy_resource chef-23 recipes/install.rb:22}</span>
</code></pre></div>
<p>or in your `kitchen.yml`:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-yaml" data-lang="yaml"><span style="color:#062873;font-weight:700">provisioner</span>:<span style="color:#062873;font-weight:700">name</span>:chef_solo<span style="color:#062873;font-weight:700">solo_rb</span>:<span style="color:#062873;font-weight:700">treat_deprecation_warnings_as_errors</span>:<span style="color:#007020;font-weight:700">true</span><span style="color:#062873;font-weight:700">silence_deprecation_warnings</span>:- deploy_resource- chef-23- recipes/install.rb:22</code></pre></div>
<p>You can also silence deprecations using a comment on the line that is raising the warning:</p> <div class="highlight"><pre tabindex="0" class="highlight" data-language="ruby"><code class="language-ruby" data-lang="ruby">erl_call <span style="color:#4070a0">'something'</span> <span style="color:#007020;font-weight:700">do</span> <span style="color:#60a0b0;font-style:italic"># chef:silence_deprecation</span>
</code></pre></div>
<p>We advise caution in the use of this feature, as excessive or prolonged silencing can lead to difficulty upgrading when the next major release of Chef comes out.</p> <h2 id="all-deprecations">All Deprecations</h2> <table> <col style="width:12%"> <col style="width:57%"> <col style="width:10%"> <col style="width:20%"> <thead> <tr class="header"> <th>ID</th> <th>Description</th> <th>Deprecated</th> <th>Expected Removal</th> </tr> </thead> <tbody> <tr> <td><a href="../deprecations_internal_api/index.html">CHEF-0</a></td> <td>Many internal APIs have been improved.</td> <td>various</td> <td>varies</td> </tr> <tr> <td><a href="../deprecations_json_auto_inflate/index.html">CHEF-1</a></td> <td>Consumers of JSON are now required to be explicit in how it is turned in to a Chef object.</td> <td>12.7</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_exit_code/index.html">CHEF-2</a></td> <td>Chef's exit codes are now defined so that it's easy to understand why Chef exited.</td> <td>12.11</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_chef_gem_compile_time/index.html">CHEF-3</a></td> <td>When using the <code>chef_gem</code> resource, the phase to install the gem in must be specified.</td> <td>12.1</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_attributes/index.html">CHEF-4</a></td> <td>Various improvements have been made to attribute syntax.</td> <td>various</td> <td>varies</td> </tr> <tr> <td><a href="../deprecations_custom_resource_cleanups/index.html">CHEF-5</a></td> <td>Various improvements have been made to custom resource syntax.</td> <td>various</td> <td>varies</td> </tr> <tr> <td><a href="../deprecations_easy_install/index.html">CHEF-6</a></td> <td>The <code>easy_install</code> resource will be removed.</td> <td>12.10</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_verify_file/index.html">CHEF-7</a></td> <td>The <code>verify</code> metaproperty's <code>file</code> substitution will be removed.</td> <td>12.5</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_supports_property/index.html">CHEF-8</a></td> <td>The <code>supports</code> metaproperty will be removed.</td> <td>12.14</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_chef_rest/index.html">CHEF-9</a></td> <td>The <code>Chef::REST</code> API will be removed.</td> <td>12.7</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_dnf_package_allow_downgrade/index.html">CHEF-10</a></td> <td>DNF package provider and resource do not require <code>--allow-downgrade</code> anymore.</td> <td>12.18</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_property_name_collision/index.html">CHEF-11</a></td> <td>An exception will be raised if a resource property conflicts with an already-existing property or method.</td> <td>12.19</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_launchd_hash_property/index.html">CHEF-12</a></td> <td>An exception will be raised whenever the <code>hash</code> property in the launchd resource is used.</td> <td>12.19</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_chef_platform_methods/index.html">CHEF-13</a></td> <td>Deprecated <code>Chef::Platform</code> methods</td> <td>12.18</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_run_command/index.html">CHEF-14</a></td> <td>Deprecation of run_command</td> <td>12.18</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_local_listen/index.html">CHEF-18</a></td> <td>Deprecation of local mode listening.</td> <td>13.1</td> <td>15.0</td> </tr> <tr> <td><a href="../deprecations_namespace_collisions/index.html">CHEF-19</a></td> <td>Deprecation of <code>property_name</code> within actions.</td> <td>13.2</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_deploy_resource/index.html">CHEF-20</a></td> <td>Deprecation of the <code>deploy</code> resource.</td> <td>13.6</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_chocolatey_uninstall/index.html">CHEF-21</a></td> <td>Deprecation of the <code>:uninstall</code> action in the <code>chocolatey_package</code> resource.</td> <td>13.7</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_erl_call_resource/index.html">CHEF-22</a></td> <td>Deprecation of the <code>erl_call</code> resource.</td> <td>13.7</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_legacy_hwrp_mixins/index.html">CHEF-23</a></td> <td>Deprecation of legacy HWRP mixins.</td> <td>12.X</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_epic_fail/index.html">CHEF-24</a></td> <td>Deprecation of <code>epic_fail</code> in favor of <code>allow_failure</code>
</td> <td>13.7</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_map_collision/index.html">CHEF-25</a></td> <td>Resource(s) in a cookbook collide with the same resource(s) now included in Chef Infra Client.</td> <td>XX.X</td> <td>15.0</td> </tr> <tr> <td><a href="../deprecations_shell_out/index.html">CHEF-26</a></td> <td>Deprecation of legacy shell_out APIs.</td> <td>14.3</td> <td>15.0</td> </tr> <tr> <td><a href="../deprecations_locale_lc_all/index.html">CHEF-27</a></td> <td>Deprecation of lc_all from locale resource</td> <td>15.0</td> <td>16.0</td> </tr> <tr> <td><a href="../deprecations_resource_name_without_provides/index.html">CHEF-31</a></td> <td>Deprecation of resource_name declaration without provides</td> <td>15.13</td> <td>16.2</td> </tr> <tr> <td><a href="../deprecations_unified_mode/index.html">CHEF-33</a></td> <td>Enabling unified mode in custom resources</td> <td>17.0</td> </tr> <tr> <td><a href="../deprecations_resource_cloning/index.html">CHEF-3694</a></td> <td>Resource Cloning will no longer work.</td> <td>10.18</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_legacy_config/index.html">OHAI-1</a></td> <td>Ohai::Config removal.</td> <td>12.6</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_sigar_plugins/index.html">OHAI-2</a></td> <td>Sigar gem based plugins removal.</td> <td>12.19</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_run_command_helpers/index.html">OHAI-3</a></td> <td>run_command and popen4 helper method removal.</td> <td>12.8</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_libvirt_plugin/index.html">OHAI-4</a></td> <td>Libvirt plugin attributes changes.</td> <td>12.19</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_ohai_windows_cpu/index.html">OHAI-5</a></td> <td>Windows CPU plugin attribute changes.</td> <td>12.19</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_digitalocean/index.html">OHAI-6</a></td> <td>DigitalOcean plugin attribute changes.</td> <td>12.19</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_amazon_linux/index.html">OHAI-7</a></td> <td>Amazon linux moved to the Amazon platform_family.</td> <td>13.0</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_cloud/index.html">OHAI-8</a></td> <td>Cloud plugin replaced by the Cloud_V2 plugin.</td> <td>13.0</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_filesystem/index.html">OHAI-9</a></td> <td>Filesystem plugin replaced by the Filesystem V2 plugin.</td> <td>13.0</td> <td>13.0</td> </tr> <tr> <td><a href="../deprecations_ohai_v6_plugins/index.html">OHAI-10</a></td> <td>Removal of support for Ohai version 6 plugins.</td> <td>11.12</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_ohai_cloud_v2/index.html">OHAI-11</a></td> <td>Cloud_v2 attribute removal.</td> <td>13.1</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_ohai_filesystem_v2/index.html">OHAI-12</a></td> <td>Filesystem2 attribute removal.</td> <td>13.1</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_ohai_ipscopes/index.html">OHAI-13</a></td> <td>Removal of IpScopes plugin</td> <td>13.2</td> <td>14.0</td> </tr> <tr> <td><a href="../deprecations_ohai_system_profile/index.html">OHAI-14</a></td> <td>Removal of system_profile plugin</td> <td>14.6</td> <td>15.0</td> </tr> </tbody> </table> </div> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; Chef Software, Inc.<br>Licensed under the Creative Commons Attribution 3.0 Unported License.<br>The Chef&trade; Mark and Chef Logo are either registered trademarks/service marks or trademarks/servicemarks of Chef, in the United States and other countries and are used with Chef Inc's permission.<br>We are not affiliated with, endorsed or sponsored by Chef Inc.<br>
    <a href="https://docs.chef.io/chef_deprecations_client/" class="_attribution-link">https://docs.chef.io/chef_deprecations_client/</a>
  </p>
</div>
