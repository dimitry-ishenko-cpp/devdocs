<div class="section" id="Expressions">   <h3 class="section" id="Expressions">Expressions</h3>  <p>Synopsis, one of: </p>  <pre data-language="latex">\numexpr <var>expression</var> 
\dimexpr <var>expression</var>
\glueexpr <var>expression</var>
\muglue <var>expression</var>
</pre> <p>Any place where you may write an integer, or a TeX dimen, or TeX glue, or muglue, you can instead write an expression to compute that type of quantity. </p> <p>An example is that <code>\the\dimexpr\linewidth-4pt\relax</code> will produce as output the length that is four points less than width of a line (the only purpose of <code>\the</code> is to show the result in the document). Analogously, <code>\romannumeral\numexpr6+3\relax</code> will produce ‘<samp>ix</samp>’, and <code>\the\glueexpr 5pt plus 1pt * 2 \relax</code> will produce ‘<samp>10.0pt plus 2.0pt</samp>’. </p> <p>A convenience here over doing calculations by allocating registers and then using <code>\advance</code>, etc., is that the evaluation of expressions does not involve assignments and can therefore be performed in places where assignments are not allowed. The next example computes the width of the <code>\parbox</code>. </p>  <pre data-language="latex">\newlength{\offset}\setlength{\offset}{2em}
\begin{center}
\parbox{\dimexpr\linewidth-\offset*3}{With malice toward none
with charity for all with firmness in the right as God gives us to see
the right let us strive on to finish the work we are in to bind up the
nation's wounds, to care for him who shall have borne the battle and
for his widow and his orphan \textasciitilde\ to do all which may
achieve and cherish a just and lasting peace among ourselves and with
all nations.  ---Abraham Lincoln, Second Inaugural Address, from the
memorial}
\end{center}
</pre> <p>The <var>expression</var> consists of one or more terms of the same type (integer, dimension, etc.) that are added or subtracted. A term that is a type of number, dimension, etc., consists of a factor of that type, optionally multiplied or divided by factors. A factor of a type is either a quantity of that type or a parenthesized subexpression. The expression produces a result of the given type, so that <code>\numexpr</code> produces an integer, <code>\dimexpr</code> produces a dimension, etc. </p> <p>In the quotation example above, changing to <code>\dimexpr\linewidth-3*\offset</code> gives the error <code>Illegal unit
of measure (pt inserted)</code>. This is because for <code>\dimexpr</code> and <code>\glueexpr</code>, the input consists of a dimension or glue value followed by an optional multiplication factor, and not the other way around. Thus <code>\the\dimexpr 1pt*10\relax</code> is valid and produces ‘<samp>10.0pt</samp>’, but <code>\the\dimexpr 10*1pt\relax</code> gives the <code>Illegal unit</code> error. </p> <p>The expressions absorb tokens and carry out appropriate mathematics up to a <code>\relax</code> (which will be absorbed), or up to the first non-valid token. Thus, <code>\the\numexpr2+3px</code> will print ‘<samp>5px</samp>’, because LaTeX reads the <code>\numexpr2+3</code>, which is made up of numbers, and then finds the letter <code>p</code>, which cannot be part of a number. It therefore terminates the expression and produces the ‘<samp>5</samp>’, followed by the regular text ‘<samp>px</samp>’. </p> <p>This termination behavior is useful in comparisons. In <code>\ifnum\numexpr\parindent*2 &lt; 10pt Yes\else No\fi</code>, the less than sign terminates the expression and the result is ‘<samp>No</samp>’ (in a standard LaTeX article). </p> <p>Expressions may use the operators <code>+</code>, <code>-</code>, <code>*</code> and <code>/</code> along with parentheses for subexpressions, <code>(...)</code>. In glue expressions the <code>plus</code> and <code>minus</code> parts do not need parentheses to be affected by a factor. So <code>\the\glueexpr 5pt plus
1pt * 2 \relax</code> results in ‘<samp>10pt plus 2pt</samp>’. </p> <p>TeX will coerce other numerical types in the same way as it does when doing register assignment. Thus <code>\the\numexpr\dimexpr
1pt\relax\relax</code> will result in ‘<samp>65536</samp>’, which is <code>1pt</code> converted to scaled points (see <a href="units-of-length.html#units-of-length-sp"><code>sp</code></a>, TeX’s internal unit) and then coerced into an integer. With a <code>\glueexpr</code> here, the stretch and shrink would be dropped. Going the other way, a <code>\numexpr</code> inside a <code>\dimexpr</code> or <code>\glueexpr</code> will need appropriate units, as in <code>\the\dimexpr\numexpr 1 + 2\relax pt\relax</code>, which produces ‘<samp>3.0pt</samp>’. </p> <p>The details of the arithmetic: each factor is checked to be in the allowed range, numbers must be less than <em class="math">2^{31}</em> in absolute value, and dimensions or glue components must be less than <em class="math">2^{14}</em> points, or <code>mu</code>, or <code>fil</code>, etc. The arithmetic operations are performed individually, except for a scaling operation (a multiplication immediately followed by a division) which is done as one combined operation with a 64-bit product as intermediate value. The result of each operation is again checked to be in the allowed range. </p> <p>Finally, division and scaling take place with rounding (unlike TeX’s <code>\divide</code>, which truncates). Thus <code>\the\dimexpr 5pt*(3/2)\relax</code> puts ‘<samp>10.0pt</samp>’ in the document, because it rounds <code>3/2</code> to <code>2</code>, while <code>\the\dimexpr 5pt*(4/3)\relax</code> produces ‘<samp>5.0pt</samp>’. </p> </div><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2007–2018 Karl Berry<br>Public Domain Software<br>
    <a href="http://latexref.xyz/Expressions.html" class="_attribution-link">http://latexref.xyz/Expressions.html</a>
  </p>
</div>
