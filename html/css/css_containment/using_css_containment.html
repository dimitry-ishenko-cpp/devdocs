<header><h1>Using CSS containment</h1></header><div class="section-content">
<p>CSS containment improves the performance of web pages by allowing the browser to isolate a subtree of the page from the rest of the page. If the browser knows that a part of the page is independent from the rest of the content, rendering can be optimized and performance improved.</p> <p>The <a href="../contain.html"><code>contain</code></a> and <a href="../content-visibility.html"><code>content-visibility</code></a> properties enable developers to inform user agents whether or not an element should render its contents at all, and whether it should render its contents when it is offscreen. The user agent then applies containment to elements when appropriate, potentially deferring layout and rendering until needed.</p> <p>This guide describes the basic aims of CSS containment and how to leverage <code>contain</code> and <code>content-visibility</code> for a better user experience.</p>
</div>
<section aria-labelledby="basic_example"><h2 id="basic_example">Basic example</h2>
<div class="section-content">
<p>Web pages often contain multiple sections which are, logically, independent of each other. CSS containment enables them to be treated truly independently from each other when it comes to rendering.</p> <p>For example, blogs usually contain several articles, each containing a headline and content, as in the markup below.</p> <div class="code-example">
<div class="example-header"><span class="language-name">html</span></div>
<pre data-signature="/wX4gt0im96oC2lYVGgRn3Lf+2Pf0RmGXDIaX0/esjs=" data-language="html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>My blog<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Heading of a nice article<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Content here.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Another heading of another article<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>More content here.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">&gt;</span></span>
</pre>
</div> <p>With CSS, we apply the <a href="../contain.html"><code>contain</code></a> property with a value of <code>content</code> to each article. The <code>content</code> value is shorthand for <code>contain: layout paint style</code>:</p> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="1RayVnyFxauu/Q1ePpI9233A++3xa995x+HOna99edU=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p> Logically, each article is independent of the other articles on the page. This information is something that is usually known, and likely quite obvious, to the web developer creating the page. However, browsers don't know the intent of your content and cannot assume that an article or other section of content will be entirely self-contained. </p> <p> This property provides a way of explaining this to the browser and giving it explicit permission to make performance optimizations. It tells the browser that the internal layout of the element is completely separate from the rest of the page, and that everything about the element is painted inside its bounds. Nothing can visibly overflow. </p> <p>By setting <code>contain: content</code> on each <code>&lt;article&gt;</code> we have indicated this; we have told the browser that each article is independent. The browser can then use this information to make decisions about how to render each <code>&lt;article&gt;</code> of content. For example, it might not render articles that are outside the viewable area.</p> <p>When additional articles are appended at the end of the page, the browser does not need to recalculate layout or repaint the preceding content; it also doesn't need to touch any area outside of the containing element's subtree. If box model properties are dependent, however, the browser will need to recalculate layout and repaint. For example, if the <code>&lt;article&gt;</code> is styled such that its size depends on its contents (e.g. with <code>height: auto</code>), then the browser will need to account for its size changing.</p>
</div></section><section aria-labelledby="key_concepts_and_terminology"><h2 id="key_concepts_and_terminology">Key concepts and terminology</h2>
</section><section aria-labelledby="contain_values"><h3 id="contain_values">
<code>contain</code> values</h3>
<div class="section-content">
<p>There are four types of containment: layout, paint, size, and style. Use the <a href="../contain.html"><code>contain</code></a> property to specify the type or types you want to apply to an element by including any combination of these types.</p> <h4 id="layout_containment">Layout containment</h4> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="a795z6xYSKQkVWF9+ZuGEvzEjlXouzULglHpntQH+/g=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> layout<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>Layout is normally scoped to the entire document, which means that if you move one element the entire document needs to be treated as if things could have moved anywhere. By using <code>contain: layout</code> you can tell the browser it only needs to check this element — everything inside the element is scoped to that element and does not affect the rest of the page, with the containing box establishing an independent <a href="../css_flow_layout/introduction_to_formatting_contexts.html">formatting context</a>.</p> <p>In addition:</p> <ul> <li>
<a href="../float.html"><code>float</code></a> layout will be performed independently inside the specified element.</li> <li>Margins won't collapse across a layout containment boundary.</li> <li>The layout container is a <a href="../containing_block.html">containing block</a> for <code>absolute</code>- and <code>fixed</code>-positioned descendants.</li> <li>The containing box creates a <a href="../css_positioned_layout/understanding_z-index/stacking_context.html">stacking context</a>, therefore <a href="../z-index.html"><code>z-index</code></a> can be used.</li> </ul> <div class="notecard note" id="sect1"> <p><strong>Note:</strong> The <code>style</code> and <code>layout</code> values of <code>contain</code> are automatically applied when using the <a href="../container-type.html"><code>container-type</code></a> and <a href="../container-name.html"><code>container-name</code></a> properties.</p> </div> <h4 id="paint_containment">Paint containment</h4> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="dG8NAqiUDWIrNDmxb3ULZM5ArylNZ567HEhTO4+avQ0=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> paint<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>Paint containment essentially clips the box to the padding edge of the <a href="../visual_formatting_model.html#the_principal_box">principal box</a>. There can be no visible overflow. The same additional notes are true for <code>paint</code> containment as <code>layout</code> containment (see above).</p> <p>Another advantage is that if the element with containment applied is offscreen, the browser does not need to paint its child elements — these are also offscreen as they are contained completely by that box.</p> <h4 id="size_containment">Size containment</h4> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="MKIeZARMPB4d90sMwqz/UwMt3sO9IldWovhITruPlmU=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> size<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>Size containment does not offer much in the way of performance optimizations when used on its own. However, size containment means that the size of the size-contained element's children cannot affect the size of the element itself — its size is computed as if it had no children.</p> <p>If you set <code>contain: size</code> on an element, you need to specify the size of the element using <a href="../contain-intrinsic-size.html"><code>contain-intrinsic-size</code></a>, or the longhand properties <a href="../contain-intrinsic-width.html"><code>contain-intrinsic-width</code></a> and <a href="../contain-intrinsic-height.html"><code>contain-intrinsic-height</code></a>, in that order. If no size is set, the element risks being zero-sized in most cases.</p> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="r9ii++HZ9WPSym9MpmPgTt1FSiWJt49rPeOD/1lW7js=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> size<span class="token punctuation">;</span>
  <span class="token property">contain-intrinsic-size</span><span class="token punctuation">:</span> 100vw auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <h4 id="style_containment">Style containment</h4> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="zFUyvCqCdPyq1CuibHrn4B8CUcPZkQAUbB1R2xPznvQ=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> style<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p> Despite the name, style containment does not provide scoped styles such as you would get with the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_components/Using_shadow_DOM">Shadow DOM</a> or <a href="../@scope.html"><code>@scope</code></a>. The main use case for the <code>style</code> value is to prevent situations where a <a href="../css_counter_styles/using_css_counters.html">CSS counter</a> could be changed in an element, which could then affect the rest of the tree. </p> <p>Using <code>contain: style</code> ensures the <a href="../counter-increment.html"><code>counter-increment</code></a> and <a href="../counter-set.html"><code>counter-set</code></a> properties create new counters scoped to that subtree only.</p> <p>You can include more than one containment type by including multiple space-separated values, such as <code>contain: layout paint</code> or by using one of the two <a href="#special_values">special values</a>.</p> <h4 id="special_values">Special values</h4> <p>There are two special values of <code>contain</code> that are shorthand for the first three or all four of the containment types:</p> <ul> <li><code>content</code></li> <li><code>strict</code></li> </ul> <p>We encountered the first in the example above. Using <code>contain: content</code> turns on <code>layout</code>, <code>paint</code>, and <code>style</code> containment. As it omits <code>size</code>, it is a safe value to apply widely.</p> <p>The <code>contain: strict</code> declaration, which behaves the same as the declaration <code>contain: size layout paint style</code> (which includes four space-separated values), provides the most containment. It is riskier to use as it applies <code>size</code> containment; the risk exists that a box could end up zero-sized due to a reliance on the size of its children.</p> <p>To remove this risk, always set a size when using <code>strict</code>:</p> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="TUErmIws0et4cHKA3YzIIN+kHlg4c47zdVV0jXFTRYQ=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> strict<span class="token punctuation">;</span>
  <span class="token property">contain-intrinsic-size</span><span class="token punctuation">:</span> 80vw auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div> <p>The above is the same as:</p> <div class="code-example">
<div class="example-header"><span class="language-name">css</span></div>
<pre data-signature="deP042WPvkMHyw8QKQtnYPqr8gjTRkJCsZbYDESQHRE=" data-language="css"><span class="token selector">article</span> <span class="token punctuation">{</span>
  <span class="token property">contain</span><span class="token punctuation">:</span> size layout paint style<span class="token punctuation">;</span>
  <span class="token property">contain-intrinsic-size</span><span class="token punctuation">:</span> 80vw auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</pre>
</div>
</div></section><section aria-labelledby="content-visibility"><h3 id="content-visibility"><code>content-visibility</code></h3>
<div class="section-content">
<p>When you have a lot of content that would benefit from heavy containment that will often be offscreen — for example if all your blog posts are viewable on the blog home pages as an infinitely scrollable blog — <code>content-visibility: auto</code> can be used to apply all of the containments at once.</p> <p>The <a href="../content-visibility.html"><code>content-visibility</code></a> property controls whether or not an element renders its contents at all, along with forcing a strong set of containments, allowing user agents to potentially omit large swathes of layout and rendering work until it becomes needed. It enables the user agent to skip an element's rendering work (including layout and painting) until it is needed — which makes the initial page load much faster.</p> <p>Its possible values are:</p> <ul> <li>
<code>visible</code>: The default behavior — an element's contents are laid out and rendered as normal.</li> <li>
<code>hidden</code>: The element <a href="#skips_its_contents">skips its contents</a>. The skipped contents will not be accessible to user agent features such as find-in-page, tab-order navigation, etc., nor be selectable or focusable.</li> <li>
<code>auto</code>: The element turns on layout containment, style containment, and paint containment, as if <code>contain: content</code> was set. If the element is not <a href="#relevant_to_the_user">relevant to the user</a>, it also skips its contents. Unlike <code>hidden</code>, the skipped content is still available for user interactions, remaining focusable, selectable, in regular tab order, and available to in-content search.</li> </ul>
</div></section><section aria-labelledby="relevant_to_the_user"><h3 id="relevant_to_the_user">Relevant to the user</h3>
<div class="section-content">
<p>User-agents have a concept of content being <a href="https://drafts.csswg.org/css-contain/#relevant-to-the-user" target="_blank">relevant to the user</a>. An element becomes "relevant to the user" if any of the following are true:</p> <ul> <li>The element appears in the viewport, or a user-agent-defined margin around the viewport (50% of the viewport dimensions, to give the app time to prepare for when the element visibility changes).</li> <li>The element or its contents receive focus.</li> <li>The element or its contents are selected, for example by dragging over the text with the mouse cursor or by some other highlight operation.</li> <li>The element or its contents are placed in the <a href="https://developer.mozilla.org/en-US/docs/Glossary/Top_layer">top layer</a>.</li> </ul> <p>When <code>content-visibility: auto</code> is set, and the browser determines that content is relevant to the user, the browser will render that content.</p>
</div></section><section aria-labelledby="skips_its_contents"><h3 id="skips_its_contents">Skips its contents</h3>
<div class="section-content">
<p>When you set <code>content-visibility: hidden</code> on an element, you are telling the browser that it is not relevant to the user, and therefore its <a href="https://drafts.csswg.org/css-contain/#skips-its-contents" target="_blank">contents should be skipped</a> and not rendered. This helps to improve performance.</p> <p>The browser will also skip an element's contents when <code>content-visibility: auto</code> is set on it, and the browser determines that its content is <em>not</em> relevant to the user.</p> <p>When an element skips its contents:</p> <ul> <li>It has layout, style, paint, and size containment turned on.</li> <li>Its contents are not painted, as if <a href="../visibility.html"><code>visibility: hidden</code></a> was set on it.</li> <li>Its contents do not receive pointer events, as if <a href="../pointer-events.html"><code>pointer-events: none</code></a> was set on it.</li> </ul> <p>This happens in both the cases mentioned above, but with <code>content-visibility: auto</code> the content can be searched, receive focus, and otherwise move from not relevant to relevant. This is not the case for <code>content-visibility: hidden</code>.</p> <div class="notecard note" id="sect2"> <p><strong>Note:</strong> To animate the transition from <code>content-visibility: hidden</code> to a visible value, you will need to set <a href="../transition-behavior.html"><code>transition-behavior: allow-discrete</code></a> and <a href="../@starting-style.html"><code>@starting-style</code></a> styles. See <a href="../css_transitions/using_css_transitions.html#transitioning_display_and_content-visibility">transitioning <code>display</code> and <code>content-visibility</code></a> to learn more.</p> </div>
</div></section><section aria-labelledby="see_also"><h2 id="see_also">See also</h2>
<div class="section-content"><ul> <li><a href="../css_containment.html">CSS containment module</a></li> <li><a href="https://developer.mozilla.org/en-US/docs/Learn/Performance/CSS">Learn: CSS performance optimization</a></li> <li><a href="container_queries.html">CSS container queries</a></li> <li>
<a href="https://blogs.igalia.com/mrego/2019/01/11/an-introduction-to-css-containment/" target="_blank">An Introduction to CSS Containment</a> via Igalia.com (2019)</li> <li>The <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/contentvisibilityautostatechange_event"><code>contentvisibilityautostatechange</code></a> event</li> </ul></div></section><div class="_attribution">
  <p class="_attribution-p">
    &copy; 2005&ndash;2024 MDN contributors.<br>Licensed under the Creative Commons Attribution-ShareAlike License v2.5 or later.<br>
    <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_containment/Using_CSS_containment" class="_attribution-link">https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_containment/Using_CSS_containment</a>
  </p>
</div>
